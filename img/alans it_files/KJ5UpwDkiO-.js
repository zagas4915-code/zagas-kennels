;/*FB_PKG_DELIM*/

__d("WAArrayBuffersConcat",[],(function(a,b,c,d,e,f){"use strict";function a(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b.reduce(function(a,b){return a+b.byteLength},0),e=new Uint8Array(d),f=0;b.forEach(function(a){e.set(new Uint8Array(a),f),f+=a.byteLength});return e.buffer}f.concatArrayBuffers=a}),66);
__d("WAArrayMove",[],(function(a,b,c,d,e,f){"use strict";var g=function(a,b,c){c=c<0?a.length+c:c;b=a.splice(b,1)[0];a.splice(c,0,b)};a=function(a,b,c){a=a.slice();g(a,b,c);return a};f.arrayMoveMutate=g;f.arrayMove=a}),66);
__d("WAArrayMoveToFirst",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c,d=!1;for(c=0;c<a.length;c++)if(a[c]===b){d=!0;break}if(d){b=a[c];a.splice(c,1);a.unshift(b)}}f["default"]=a}),66);
__d("WAArraysShallowEqual",[],(function(a,b,c,d,e,f){"use strict";function g(a,b){return a===b}function a(a,b,c){c===void 0&&(c=g);if(a===b)return!0;return a.length!==b.length?!1:a.every(function(a,d){return c(a,b[d])})}f["default"]=a}),66);
__d("WAAsyncCache",["WAAbortError","WAMemoizeConcurrent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f){return c("WAMemoizeConcurrent")(a,function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(b!=null&&b.signal.aborted)throw new(d("WAAbortError").AbortError)();var c=a(b),g=(yield e.get(c,b));if(b!=null&&b.signal.aborted)throw new(d("WAAbortError").AbortError)();if(g!=null)return g;g=(yield f(b));if(b!=null&&b.signal.aborted)throw new(d("WAAbortError").AbortError)();yield e.set(c,g,b);return g});function g(a){return c.apply(this,arguments)}return g}())}g["default"]=a}),98);
__d("WABackoffDelay",["Promise","WAPromiseDelays","WARetryableError","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i={retries:Infinity};function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=babelHelpers["extends"]({},i,a);var f=a.delay,g=a.signal;a=a.retries;var j=0,k=Date.now(),l=null,m=function(a){return(h||(h=b("Promise"))).reject(new(c("WARetryableError"))(a))};try{k=Date.now();return yield e(m,j,g)}catch(a){j++;if(!(a instanceof c("WARetryableError")))throw a;l=a}while(j<=a){var n=Date.now()-k;n=f({iterationCount:j,taskDuration:n});yield d("WAPromiseDelays").delayMs(n,g);try{k=Date.now();return yield e(m,j,g)}catch(a){j++;if(!(a instanceof c("WARetryableError")))throw a;l=a}}if(!l)throw c("err")("assert: backoff completed without error or result");n=l.source;throw n});return j.apply(this,arguments)}g.backoff=a}),98);
__d("WABase64Equal",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=a.length,d=b.length;switch(c-d){case-2:return b.charCodeAt(c)===61&&b.charCodeAt(c+1)===61&&b.substr(0,c)===a;case-1:return b.charCodeAt(c)===61&&b.substr(0,c)===a;case 0:return a===b;case 1:return a.charCodeAt(d)===61&&a.substr(0,d)===b;case 2:return a.charCodeAt(d)===61&&a.charCodeAt(d+1)===61&&a.substr(0,d)===b;default:return!1}}f.b64Equal=a}),66);
__d("WABase64Modulo",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=atob(a);var c=0;for(var d=0;d<a.length;d++){var e=a.charCodeAt(d),f=e>>4;e=e&15;c=((c<<4)+f)%b;c=((c<<4)+e)%b}return c}f["default"]=a}),66);
__d("WABidiRangeData",[],(function(a,b,c,d,e,f){"use strict";a=[65,26,32,26,73,1,11,1,5,1,6,23,24,31,32,449,451,7,21,2,16,5,14,1,130,4,6,2,4,4,5,1,7,1,2,3,4,1,2,20,21,83,84,140,147,166,167,38,40,49,55,-1,46,-1,2,-1,3,-1,3,-1,2,-56,64,-1,3,-1,2,-1,14,-48,82,-3,4,-101,116,-2,9,-2,12,-23,24,-30,57,-91,102,-58,67,-2,6,-3,4,-24,28,-1,10,-1,4,-1,6,-43,46,-119,167,55,56,1,2,4,12,4,5,3,10,10,12,29,30,2,3,8,10,2,4,22,23,7,8,1,4,4,7,4,10,2,4,2,3,1,9,1,5,2,3,3,7,12,14,7,8,2,7,1,2,6,10,2,4,22,23,7,8,2,3,2,3,2,6,3,27,4,5,1,8,10,12,3,4,1,13,1,2,9,10,3,4,22,23,7,8,2,3,5,8,4,12,1,2,2,5,1,16,2,6,11,19,1,9,2,3,8,10,2,4,22,23,7,8,2,3,5,8,2,3,1,7,2,4,2,12,1,5,2,3,3,7,18,29,1,2,6,9,3,4,4,7,2,3,1,2,2,5,2,5,3,6,12,16,2,3,2,5,3,4,3,6,1,7,1,15,13,27,3,4,8,9,3,4,23,24,16,19,1,4,4,23,3,8,2,6,10,17,1,8,2,3,11,12,3,4,23,24,10,11,5,8,8,9,3,4,2,11,2,9,1,2,2,6,10,11,2,17,11,12,3,4,41,43,4,9,3,4,3,4,2,6,14,18,26,28,2,3,18,21,24,25,9,10,1,3,7,15,3,9,8,14,10,12,3,15,48,49,2,14,7,15,13,50,2,3,1,2,5,6,24,25,1,2,10,11,2,11,1,3,5,6,1,10,10,12,4,36,24,26,27,28,1,2,1,6,10,11,36,54,1,6,1,3,5,54,8,9,6,7,13,50,45,49,1,7,1,3,2,4,25,27,4,7,16,20,13,14,2,4,6,7,15,16,40,41,1,6,1,3,377,378,4,6,7,8,1,2,4,6,41,42,4,6,33,34,4,6,7,8,1,2,4,6,15,16,57,58,4,6,67,72,29,32,16,32,86,88,6,9,639,640,26,31,89,96,13,14,4,18,18,21,2,11,18,32,13,14,3,18,52,54,1,8,8,9,2,13,7,8,1,4,10,48,10,16,89,96,5,7,34,35,1,6,70,80,31,35,4,6,3,7,2,3,6,19,40,42,5,16,44,48,26,32,11,48,23,25,2,5,56,57,1,10,1,2,2,10,6,19,10,16,10,16,14,100,48,49,1,6,1,2,5,6,9,13,27,36,9,14,32,36,2,4,1,4,56,57,1,3,3,4,1,4,2,10,48,56,2,7,15,18,60,67,43,45,11,22,1,14,1,8,4,5,6,7,3,5,1,6,192,256,278,280,6,8,38,40,6,8,8,9,1,2,1,2,1,2,31,33,53,54,7,8,1,4,3,4,7,10,4,6,6,10,13,18,3,4,7,24,1,1,-1,98,1,14,1,17,13,114,1,5,1,3,10,11,1,4,5,11,1,2,1,2,1,2,4,5,11,13,4,9,5,9,2,18,41,470,69,95,1,263,78,528,1,340,256,1024,47,48,47,48,133,139,4,7,2,14,38,39,1,6,1,3,56,63,2,17,23,32,7,8,7,8,7,8,7,8,7,8,7,8,7,8,7,557,3,28,9,13,2,3,5,7,5,9,86,92,3,4,90,91,4,9,43,44,94,95,48,96,45,48,48,64,28,31,50,65,12,16,167,171,99,101,31,32,6592,6656,20989,20992,1165,1232,317,320,28,48,47,64,30,32,80,82,6,48,102,103,55,57,9,51,13,14,3,4,4,5,25,27,1,9,8,16,52,64,68,78,12,36,13,14,38,46,25,36,2,13,30,36,48,49,2,6,2,4,16,17,11,15,7,8,25,26,41,47,2,4,2,13,3,4,8,9,1,3,10,12,32,33,51,52,1,4,2,4,5,7,1,2,1,25,17,19,8,19,6,8,6,8,6,15,7,8,7,8,58,64,117,118,2,3,4,7,10,16,11172,11184,23,27,49,2101,6766,6768,106,144,7,19,5,10,-1,2,-10,11,-532,534,-144,176,-13,14,-2,114,-143,177,26,32,26,37,89,92,6,8,6,8,6,8,3,38,12,13,26,27,19,20,2,3,15,17,14,48,123,128,1,2,1,5,45,48,9,86,2,67,45,176,29,32,49,96,36,45,30,35,38,48,30,31,37,41,14,56,158,160,10,16,36,40,36,40,40,48,52,63,1,145,311,320,22,32,8,160,-287,288,-225,228,-1,3,-5,9,-40,43,-4,5,-165,167,-82,89,-484,488,-8,18,-294,325,-44,46,-153,164,-175,175,1,2,54,69,7,31,10,28,49,53,2,4,7,18,1,3,25,32,10,19,36,41,1,10,18,26,35,36,3,14,52,61,10,14,2,3,16,17,20,31,18,19,28,31,2,3,1,3,6,72,7,8,1,2,4,5,15,16,11,17,47,48,3,16,10,18,2,3,8,10,2,4,22,23,7,8,2,3,5,8,3,4,4,6,2,4,3,5,1,7,1,6,7,163,56,64,2,5,1,2,21,22,1,2,3,33,51,57,1,2,4,6,1,3,4,12,10,176,50,56,4,6,1,3,27,63,51,59,2,3,1,3,4,15,10,48,43,44,1,2,2,8,1,2,1,8,10,64,27,32,2,6,1,10,16,208,47,56,1,3,1,101,83,95,8,10,1,3,8,9,2,3,30,31,2,6,1,2,4,5,3,12,10,80,8,10,42,50,4,5,4,31,1,7,2,4,40,46,2,6,8,17,1,7,2,5,46,59,1,3,9,38,57,320,9,10,38,52,8,18,29,32,32,57,1,8,1,3,1,76,7,8,2,3,38,59,1,10,10,16,6,7,2,3,37,41,2,3,1,2,1,8,10,320,19,21,4,187,1,16,21,63,923,1025,111,112,5,16,196,2944,1071,1072,9,4048,583,9216,569,576,31,32,10,14,2,98,30,37,1,11,48,55,15,25,10,11,7,8,21,26,19,707,91,192,75,80,56,67,13,77,2,3,1,13,2,16,6136,6144,1238,1280,9,8960,287,336,3,20,4,12,396,2704,107,112,13,16,9,16,10,12,1,3,1,4961,246,256,39,41,62,65,9,25,2,9,30,34,59,306,20,128,25,160,85,86,71,72,2,4,1,3,2,4,4,5,12,13,1,2,7,8,65,66,4,6,8,9,7,8,28,29,4,5,5,6,1,4,7,8,340,342,51,52,57,58,57,58,57,58,57,58,8,60,512,567,4,54,8,9,14,15,7,1659,45,55,7,9,10,14,2,370,44,48,10,1296,-208,215,-109,116,-1445,1447,-270,542,31,32,58,64,61,118,29,42,44,48,9,16,2,3504,42718,42752,4149,4160,222,224,5762,5776,7473,10576,542,2048,4939,786432,65534,65536,65534];f.DATA=a}),66);
__d("WABidi",["WABidiRangeData"],(function(a,b,c,d,e,f){"use strict";var g,h;function i(){if(g)return;var a=b("WABidiRangeData").DATA,c=a.length/2;g=new Int32Array(c);h=new Int32Array(c);for(var d=0,e=0;d<c;d++,e+=2)g[d]=a[e]+(d===0?0:g[d-1]),h[d]=a[e+1]}function a(a){i();for(var b=0;b<a.length;b++){var c=a.charCodeAt(b)|0;if(55296<=c&&c<56320){if(++b===a.length)break;var d=a.charCodeAt(b);if(56320<=d&&d<57344)c=65536+((c&1023)<<10|d&1023);else continue}else if(56320<=c&&c<57344)continue;if(c<g[0])continue;d=g.length|0;var e=0;d=d-1|0;while(e<d){var f=d+e>>1;if(g[f]>c)d=f-1|0;else if(g[f+1]>c){d=f;break}else e=f+1|0}f=h[d];e=g[d]+Math.abs(f)|0;if(c<e)return f<0?"rtl":"ltr"}return void 0}f.dir=a}),66);
__d("WAConcurrentPriorityPromiseQueue",["Promise","WANullthrows","WAPriorityQueue","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b,c){c===void 0&&(c=0),this.$1=a,this.$2=b,this.$3=c,this.$4=new Map(),this.$5=new Map()}var d=a.prototype;d.clearQueue=function(){this.$5.clear(),this.$4.clear()};d.enqueue=function(a,c){var d,e,f=new(h||(h=b("Promise")))(function(a,b){d=a,e=b});this.$6(babelHelpers["extends"]({},c,{run:function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield a());d(b)}catch(a){e(a)}});function f(){return c.apply(this,arguments)}return f}()}));this.$7();return f};d.$6=function(a){var b=this.$8(a.group);b.push(a)};d.$9=function(){return this.$10()};d.$7=function(){while(this.$11()<this.$1){var a=this.$9();if(a==null)break;this.$12(a)}};d.$12=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=a.run,d=a.signal,e=a.group;e=this.$13(e);if(d!=null&&d.aborted){setTimeout(function(){return b.$7()},this.$3);return}e.add(a);try{yield c()}finally{e["delete"](a),setTimeout(function(){return b.$7()},this.$3)}});function c(b){return a.apply(this,arguments)}return c}();d.$10=function(){for(var a of this.$5.values()){var b=a.peek();if(!b)continue;if(this.$14(b.group))continue;return a.pull()}return null};d.$11=function(){var a=0;for(var b of this.$4.values())a+=b.size;return a};d.getEnqueuedTasksCount=function(){var a=0;for(var b of this.$5.values())a+=b.size();return a};d.$13=function(a){if(!this.$4.has(a)){var b=new Set();this.$4.set(a,b);return b}return c("WANullthrows")(this.$4.get(a))};d.$14=function(a){var b=this.$4.get(a);return b==null?!1:b.size>=this.$15(a)};d.$8=function(a){if(!this.$5.has(a)){var b=new(c("WAPriorityQueue"))(function(a){return a.priority});this.$5.set(a,b)}return c("WANullthrows")(this.$5.get(a))};d.$15=function(a){a=this.$2[a];return a==null?Infinity:a};return a}();g["default"]=a}),98);
__d("WACrypto",["Promise","WAArrayBufferUtils","WABase64","WABinary","WACryptoAesCbc","WACryptoHmac","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,c){return d("WACryptoAesCbc").aesCbcEncrypt(a,new Uint8Array(c)).then(function(a){return d("WACryptoHmac").hmacSha256(b,a).then(function(b){return d("WABinary").Binary.build(b,a).readBuffer()})})}function e(a,e,f){return(i||(i=b("Promise"))).resolve(new Uint8Array(f)).then(function(b){var f=d("WABase64").encodeB64(b.subarray(0,32)),g=b.subarray(32);return d("WACryptoHmac").hmacSha256(e,g).then(function(b){b=d("WABase64").encodeB64(b);if(f!==b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["crypto:macAndDecrypt HMAC don't match "," vs. ",""])),f,b);throw c("err")("macAndDecrypt HMAC mismatch")}return d("WACryptoAesCbc").aesCbcDecryptSplit(a,g)})})}function f(a,b){var c=a.slice(-b.byteLength);return d("WAArrayBufferUtils").arrayBuffersEqualUNSAFE(c,b)?a.slice(0,a.byteLength-b.byteLength):a}g.encryptAndMac=a;g.macAndDecrypt=e;g.removeEncryptedPadding=f}),98);
__d("WACryptoLtHash",["Promise","WACryptoHkdf","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=2,j=128;a=new ArrayBuffer(j);c=function(){function a(a){this.salt=a}var c=a.prototype;c.add=function(a,c){var d=this;return c.reduce(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d.$1(yield a,b)});return function(b,c){return a.apply(this,arguments)}}(),(h||(h=b("Promise"))).resolve(a))};c.subtract=function(a,c){var d=this;return c.reduce(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d.$2(yield a,b)});return function(b,c){return a.apply(this,arguments)}}(),(h||(h=b("Promise"))).resolve(a))};c.subtractThenAdd=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield this.subtract(a,c));c=(yield this.add(a,b));return{ltHash:c,subtractResult:a}});function c(b,c,d){return a.apply(this,arguments)}return c}();c.$1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WACryptoHkdf").extractAndExpand(b,this.salt,j));return this.performPointwiseWithOverflow(a,b,function(a,b){return a+b})});function c(b,c){return a.apply(this,arguments)}return c}();c.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WACryptoHkdf").extractAndExpand(b,this.salt,j));return this.performPointwiseWithOverflow(a,b,function(a,b){return a-b})});function c(b,c){return a.apply(this,arguments)}return c}();c.performPointwiseWithOverflow=function(a,b,c){a=new DataView(a);b=new DataView(b);var d=new ArrayBuffer(a.byteLength),e=new DataView(d);for(var f=0;f<a.byteLength;f+=i)e.setUint16(f,c(a.getUint16(f,!0),b.getUint16(f,!0)),!0);return d};return a}();e=new c("WhatsApp Patch Integrity");g.KEY_LENGTH_BYTES=j;g.EMPTY_LT_HASH=a;g.LtHash16=c;g.LT_HASH_ANTI_TAMPERING=e}),98);
__d("WAInOrderPromiseQueue",["Promise","WAAbortError","WAPromiseRaceAbort"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){this.$1=(h||(h=b("Promise"))).resolve(),this.$3=new AbortController(),this.$2=[]}var e=a.prototype;e.enqueue=function(a){var b=this;a["catch"](function(){});var e=function(){return a},f=this.$3.signal;this.$1=this.$1.then(e,e);var g=c("WAPromiseRaceAbort")(this.$1,f)["catch"](d("WAAbortError").catchAbort(function(a){var c;throw(c=b.$4)!=null?c:a}));this.$2.push(g);return g["finally"](function(){b.$2.length>0&&b.$2[0]===g&&b.$2.shift()})};e.cancelAll=function(a){this.$4=a,this.$2=[],this.$3.abort(),this.$3=new AbortController()};return a}();g["default"]=a}),98);
__d("WAIsMediaKeyReusable",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=2*d("WATimeUtils").DAY_SECONDS;function a(a){var b=Math.floor(Math.random()*d("WATimeUtils").DAY_SECONDS);return a!=null&&d("WATimeUtils").happenedWithin(a,h+b)}g.MMS_MEDIA_KEY_TTL=h;g.isMediaKeyReusable=a}),98);
__d("WAIsoToCc",[],(function(a,b,c,d,e,f){a={ES:34,DE:49,MX:52,GB:44,SA:966,IT:39,AF:93,AX:358,AL:355,DZ:213,AS:1,AD:376,AO:244,AI:1,AG:1,AR:54,AM:374,AW:297,AC:247,AU:61,AT:43,AZ:994,BS:1,BH:973,BD:880,BB:1,BY:375,BE:32,BZ:501,BJ:229,BM:1,BT:975,BO:591,BQ:599,BA:387,BW:267,BR:55,IO:246,VG:1,BN:673,BG:359,BF:226,BI:257,CI:225,KH:855,CM:237,CA:1,CV:238,KY:1,CF:236,TD:235,CL:56,CN:86,CX:61,CC:61,CO:57,KM:269,CG:242,CD:243,CK:682,CR:506,HR:385,CU:53,CW:599,CY:357,CZ:420,DK:45,DJ:253,DM:1,DO:1,EC:593,EG:20,SV:503,GQ:240,ER:291,EE:372,ET:251,FK:500,FO:298,FJ:679,FI:358,FR:33,GF:594,PF:689,GA:241,GM:220,GE:995,GH:233,GI:350,GR:30,GL:299,GD:1,GP:590,GU:1,GT:502,GG:44,GN:224,GW:245,GY:592,HT:509,HN:504,HK:852,HU:36,IS:354,IN:91,ID:62,IR:98,IQ:964,IE:353,IM:44,IL:972,JM:1,JP:81,JE:44,JO:962,KZ:7,KE:254,KI:686,KW:965,KG:996,LA:856,LV:371,LB:961,LS:266,LR:231,LY:218,LI:423,LT:370,LU:352,MO:853,MK:389,MG:261,MW:265,MY:60,MV:960,ML:223,MT:356,MH:692,MQ:596,MR:222,MU:230,YT:262,FM:691,MD:373,MC:377,MN:976,ME:382,MS:1,MA:212,MZ:258,MM:95,NA:264,NR:674,NP:977,NL:31,NC:687,NZ:64,NI:505,NE:227,NG:234,NU:683,NF:672,KP:850,MP:1,NO:47,OM:968,PK:92,PW:680,PS:970,PA:507,PG:675,PY:595,PE:51,PH:63,PL:48,PT:351,PR:1,QA:974,RO:40,RU:7,RW:250,RE:262,BL:590,SH:290,KN:1,LC:1,MF:590,PM:508,VC:1,WS:685,SM:378,SN:221,RS:381,SC:248,SL:232,SG:65,SX:1,SK:421,SI:386,SB:677,SO:252,ZA:27,KR:82,SS:211,LK:94,SD:249,SR:597,SJ:47,SZ:268,SE:46,CH:41,SY:963,ST:239,TW:886,TJ:992,TZ:255,TH:66,TL:670,TG:228,TK:690,TO:676,TT:1,TN:216,TR:90,TM:993,TC:1,TV:688,VI:1,UG:256,UA:380,AE:971,US:1,UY:598,UZ:998,VU:678,VA:379,VE:58,VN:84,WF:681,YE:967,ZM:260,ZW:263,XK:383};b=a;f["default"]=b}),66);
__d("WAMediaCalculateFilehash",["WACryptoDependencies","WACryptoSha256"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WACryptoSha256").sha256Base64(a)}function b(){var a=d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(20));a=a.buffer;return d("WACryptoSha256").sha256Base64(a)}g.calculateFilehash=a;g.getRandomFilehash=b}),98);
__d("WAPromiseProps",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a){var c=Object.keys(a),d=(g||(g=b("Promise"))).all(c.map(function(b){return a[b]}));function e(a){var b={};for(var d=0;d<a.length;d++)b[c[d]]=a[d];return b}return d.then(e)}f.promiseProps=a}),66);
__d("WARaceSignal",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";function a(a,b){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c,d=new AbortController();if(a.some(function(a){return a.aborted}))d.abort();else{c=function(){for(var b of a)b.removeEventListener("abort",e);c=null};var e=function(){c==null||c(),d.abort()};for(var f of a)f.addEventListener("abort",e)}try{return yield b(d.signal)}finally{c==null||c()}});return g.apply(this,arguments)}f["default"]=a}),66);
__d("WAReplaceRepeatingWhitespace",[],(function(a,b,c,d,e,f){"use strict";var g="\xa0";function a(a,b){var c=function(a){var c="";for(var d=0;d<a.length;d++){var e=b===!0&&a[d]==="\n";c+=e?"\n":g}return c};return/\s\s+/.test(a)?a.replace(/\s\s+/g,c):a}f["default"]=a}),66);
__d("WASmaxInBizSettingsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInBizSettingsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","feature-not-implemented");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",501);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);
__d("WASmaxInBizSettingsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInBizSettingsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInBizSettingsPrivacySettingErrors",["WAResultOrError","WASmaxInBizSettingsIQErrorBadRequestMixin","WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin","WASmaxInBizSettingsIQErrorInternalServerErrorMixin","WASmaxInBizSettingsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBizSettingsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInBizSettingsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:c.value});var e=d("WASmaxInBizSettingsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value});var f=d("WASmaxInBizSettingsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorInternalServerError"],[b,c,e,f])}g.parsePrivacySettingErrors=a}),98);
__d("WASmaxInBizSettingsGetPrivacySettingResponseError",["WAResultOrError","WASmaxInBizSettingsIQErrorResponseMixin","WASmaxInBizSettingsPrivacySettingErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBizSettingsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBizSettingsPrivacySettingErrors").parsePrivacySettingErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorPrivacySettingErrors:b.value}))}g.parseGetPrivacySettingResponseError=a}),98);
__d("WASmaxInBizSettingsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInBizSettingsEnums",[],(function(a,b,c,d,e,f){a={DISCOVERABLE:"DISCOVERABLE",HIDDEN:"HIDDEN",UNDEFINED:"UNDEFINED"};b={"false":"false",notset:"notset","true":"true"};c={"false":"false","true":"true"};f.ENUM_DISCOVERABLE_HIDDEN_UNDEFINED=a;f.ENUM_FALSE_NOTSET_TRUE=b;f.ENUM_FALSE_TRUE=c}),66);
__d("WASmaxInBizSettingsSmbDataSharingSettingValueMixin",["WAResultOrError","WASmaxInBizSettingsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrStringEnum(a,"value",d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE);return!a.success?a:d("WAResultOrError").makeResult({value:a.value})}g.parseSmbDataSharingSettingValueMixin=a}),98);
__d("WASmaxInBizSettingsSmbDataSharingSettingMixin",["WASmaxInBizSettingsSmbDataSharingSettingValueMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"privacy");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"smb_data_sharing_with_meta_consent");if(!b.success)return b;a=d("WASmaxInBizSettingsSmbDataSharingSettingValueMixin").parseSmbDataSharingSettingValueMixin(b.value);return!a.success?a:a}g.parseSmbDataSharingSettingMixin=a}),98);
__d("WASmaxInBizSettingsGetPrivacySettingResponseSuccess",["WAResultOrError","WASmaxInBizSettingsIQResultResponseMixin","WASmaxInBizSettingsSmbDataSharingSettingMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!c.success)return c;c=d("WASmaxInBizSettingsSmbDataSharingSettingMixin").parseSmbDataSharingSettingMixin(c.value);if(!c.success)return c;a=d("WASmaxInBizSettingsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({privacySmbDataSharingSettingMixin:c.value},a.value))}g.parseGetPrivacySettingResponseSuccess=a}),98);
__d("WASmaxOutBizSettingsBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutBizSettingsGetPrivacySettingRequest",["WASmaxJsx","WASmaxOutBizSettingsBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutBizSettingsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"w:biz",to:d("WAWap").S_WHATSAPP_NET,smax_id:d("WAWap").INT(109)},d("WASmaxJsx").smax("privacy",null)));return a}g.makeGetPrivacySettingRequest=a}),98);
__d("WASmaxBizSettingsGetPrivacySettingRPC",["WAComms","WASmaxInBizSettingsGetPrivacySettingResponseError","WASmaxInBizSettingsGetPrivacySettingResponseSuccess","WASmaxOutBizSettingsGetPrivacySettingRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WASmaxOutBizSettingsGetPrivacySettingRequest").makeGetPrivacySettingRequest();a=(yield d("WAComms").sendSmaxStanza(b,a));var c=d("WASmaxInBizSettingsGetPrivacySettingResponseSuccess").parseGetPrivacySettingResponseSuccess(a,b);if(c.success)return{name:"GetPrivacySettingResponseSuccess",value:c.value};a=d("WASmaxInBizSettingsGetPrivacySettingResponseError").parseGetPrivacySettingResponseError(a,b);if(a.success)return{name:"GetPrivacySettingResponseError",value:a.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetPrivacySetting",{Success:c,Error:a}))});return h.apply(this,arguments)}g.sendGetPrivacySettingRPC=a}),98);
__d("WASmaxInBizSettingsSetPrivacySettingResponseError",["WAResultOrError","WASmaxInBizSettingsIQErrorResponseMixin","WASmaxInBizSettingsPrivacySettingErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBizSettingsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBizSettingsPrivacySettingErrors").parsePrivacySettingErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorPrivacySettingErrors:b.value}))}g.parseSetPrivacySettingResponseError=a}),98);
__d("WASmaxInBizSettingsSetPrivacySettingResponseSuccess",["WAResultOrError","WASmaxInBizSettingsIQResultResponseMixin","WASmaxInBizSettingsSmbDataSharingSettingMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!c.success)return c;c=d("WASmaxInBizSettingsSmbDataSharingSettingMixin").parseSmbDataSharingSettingMixin(c.value);a=d("WASmaxInBizSettingsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({privacySmbDataSharingSettingMixin:c.success?c.value:null},a.value))}g.parseSetPrivacySettingResponseSuccess=a}),98);
__d("WASmaxOutBizSettingsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutBizSettingsSmbDataSharingSettingValueMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyValue;a=d("WASmaxJsx").smax("smax$any",{value:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSmbDataSharingSettingValueMixin=a}),98);
__d("WASmaxOutBizSettingsSmbDataSharingSettingMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBizSettingsSmbDataSharingSettingValueMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxJsx").smax("privacy",null,d("WASmaxOutBizSettingsSmbDataSharingSettingValueMixin").mergeSmbDataSharingSettingValueMixin(d("WASmaxJsx").smax("smb_data_sharing_with_meta_consent",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSmbDataSharingSettingMixin=a}),98);
__d("WASmaxOutBizSettingsSetPrivacySettingRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutBizSettingsBaseIQSetRequestMixin","WASmaxOutBizSettingsSmbDataSharingSettingMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.smbDataSharingSettingMixinArgs;a=d("WASmaxOutBizSettingsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{xmlns:"w:biz",to:d("WAWap").S_WHATSAPP_NET,smax_id:d("WAWap").INT(110)},d("WASmaxMixins").optionalMerge(d("WASmaxOutBizSettingsSmbDataSharingSettingMixin").mergeSmbDataSharingSettingMixin,d("WASmaxJsx").smax("privacy",null),a)));return a}g.makeSetPrivacySettingRequest=a}),98);
__d("WASmaxBizSettingsSetPrivacySettingRPC",["WAComms","WASmaxInBizSettingsSetPrivacySettingResponseError","WASmaxInBizSettingsSetPrivacySettingResponseSuccess","WASmaxOutBizSettingsSetPrivacySettingRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutBizSettingsSetPrivacySettingRequest").makeSetPrivacySettingRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInBizSettingsSetPrivacySettingResponseSuccess").parseSetPrivacySettingResponseSuccess(b,a);if(c.success)return{name:"SetPrivacySettingResponseSuccess",value:c.value};b=d("WASmaxInBizSettingsSetPrivacySettingResponseError").parseSetPrivacySettingResponseError(b,a);if(b.success)return{name:"SetPrivacySettingResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("SetPrivacySetting",{Success:c,Error:b}))});return h.apply(this,arguments)}g.sendSetPrivacySettingRPC=a}),98);
__d("WASmaxInBlocklistsGetBlockListResponseInternalServerError",["WAResultOrError","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxInBlocklistsServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseGetBlockListResponseInternalServerError=a}),98);
__d("WASmaxInBlocklistsGetBlockListResponseInvalidRequest",["WAResultOrError","WASmaxInBlocklistsGetBlocklistErrors","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsGetBlocklistErrors").parseGetBlocklistErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetBlocklistErrors:b.value}))}g.parseGetBlockListResponseInvalidRequest=a}),98);
__d("WASmaxInBlocklistsDisplayNameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"display_name");return!a.success?a:d("WAResultOrError").makeResult({displayName:a.value})}g.parseDisplayNameMixin=a}),98);
__d("WASmaxInBlocklistsPnJidMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrUserJid(a,"pn_jid");return!a.success?a:d("WAResultOrError").makeResult({pnJid:a.value})}g.parsePnJidMixin=a}),98);
__d("WASmaxInBlocklistsUnknownIdentifierMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"unknown_identifier","true");return!a.success?a:d("WAResultOrError").makeResult({unknownIdentifier:a.value})}g.parseUnknownIdentifierMixin=a}),98);
__d("WASmaxInBlocklistsUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"username");return!a.success?a:d("WAResultOrError").makeResult({username:a.value})}g.parseUsernameMixin=a}),98);
__d("WASmaxInBlocklistsBlocklistIds",["WAResultOrError","WASmaxInBlocklistsDisplayNameMixin","WASmaxInBlocklistsPnJidMixin","WASmaxInBlocklistsUnknownIdentifierMixin","WASmaxInBlocklistsUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBlocklistsUsernameMixin").parseUsernameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Username",value:b.value});var c=d("WASmaxInBlocklistsPnJidMixin").parsePnJidMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"PnJid",value:c.value});var e=d("WASmaxInBlocklistsDisplayNameMixin").parseDisplayNameMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"DisplayName",value:e.value});var f=d("WASmaxInBlocklistsUnknownIdentifierMixin").parseUnknownIdentifierMixin(a);return f.success?d("WAResultOrError").makeResult({name:"UnknownIdentifier",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Username","PnJid","DisplayName","UnknownIdentifier"],[b,c,e,f])}g.parseBlocklistIds=a}),98);
__d("WASmaxInBlocklistsBlocklistIdentifierMixin",["WAResultOrError","WASmaxInBlocklistsBlocklistIds"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInBlocklistsBlocklistIds").parseBlocklistIds(a);return!a.success?a:d("WAResultOrError").makeResult({blocklistIds:a.value})}g.parseBlocklistIdentifierMixin=a}),98);
__d("WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsBlocklistIdentifierMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrLidUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"active","true");if(!c.success)return c;a=d("WASmaxInBlocklistsBlocklistIdentifierMixin").parseBlocklistIdentifierMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value,active:c.value},a.value))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,c.value,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"addressing_mode","lid");if(!a.success)return a;c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"item",0,64e3,h);return!c.success?c:d("WAResultOrError").makeResult({type:e.value,listDhash:b.value,listAddressingMode:a.value,listItem:c.value})}g.parseGetBlockListResponseMigratedSuccessWithMismatchListItem=h;g.parseGetBlockListResponseMigratedSuccessWithMismatch=a}),98);
__d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);return!a.success?a:d("WAResultOrError").makeResult({type:c.value})}g.parseGetBlockListResponseSuccessWithMatch=a}),98);
__d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsDisplayNameMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrLidUserJid,a,"lid");if(!c.success)return c;a=d("WASmaxInBlocklistsDisplayNameMixin").parseDisplayNameMixin(a);return d("WAResultOrError").makeResult({jid:b.value,lid:c.value,displayNameMixin:a.success?a.value:null})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,c.value,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"addressing_mode","pn");if(!a.success)return a;c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"item",0,64e3,h);return!c.success?c:d("WAResultOrError").makeResult({type:e.value,listDhash:b.value,listAddressingMode:a.value,listItem:c.value})}g.parseGetBlockListResponseSuccessWithMismatchListItem=h;g.parseGetBlockListResponseSuccessWithMismatch=a}),98);
__d("WASmaxOutBlocklistsGetBlockListRequest",["WASmaxChildren","WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemDhash;a=d("WASmaxJsx").smax("item",{dhash:d("WAWap").CUSTOM_STRING(a)});return a}function a(a){a=a.itemArgs;a=d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"blocklist",type:"get",id:d("WAWap").generateId()},d("WASmaxChildren").OPTIONAL_CHILD(h,a));return a}g.makeGetBlockListRequestItem=h;g.makeGetBlockListRequest=a}),98);
__d("WASmaxBlocklistsGetBlockListRPC",["WAComms","WASmaxInBlocklistsGetBlockListResponseInternalServerError","WASmaxInBlocklistsGetBlockListResponseInvalidRequest","WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch","WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch","WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch","WASmaxOutBlocklistsGetBlockListRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutBlocklistsGetBlockListRequest").makeGetBlockListRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMismatch").parseGetBlockListResponseSuccessWithMismatch(b,a);if(c.success)return{name:"GetBlockListResponseSuccessWithMismatch",value:c.value};var e=d("WASmaxInBlocklistsGetBlockListResponseMigratedSuccessWithMismatch").parseGetBlockListResponseMigratedSuccessWithMismatch(b,a);if(e.success)return{name:"GetBlockListResponseMigratedSuccessWithMismatch",value:e.value};var f=d("WASmaxInBlocklistsGetBlockListResponseSuccessWithMatch").parseGetBlockListResponseSuccessWithMatch(b,a);if(f.success)return{name:"GetBlockListResponseSuccessWithMatch",value:f.value};var g=d("WASmaxInBlocklistsGetBlockListResponseInvalidRequest").parseGetBlockListResponseInvalidRequest(b,a);if(g.success)return{name:"GetBlockListResponseInvalidRequest",value:g.value};b=d("WASmaxInBlocklistsGetBlockListResponseInternalServerError").parseGetBlockListResponseInternalServerError(b,a);if(b.success)return{name:"GetBlockListResponseInternalServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetBlockList",{SuccessWithMismatch:c,MigratedSuccessWithMismatch:e,SuccessWithMatch:f,InvalidRequest:g,InternalServerError:b}))});return h.apply(this,arguments)}g.sendGetBlockListRPC=a}),98);
__d("WASmaxInBlocklistsEnums",[],(function(a,b,c,d,e,f){a={lid:"lid",pn:"pn"};f.ENUM_LID_PN=a}),66);
__d("WASmaxInBlocklistsIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","forbidden");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",403);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorForbiddenMixin=a}),98);
__d("WASmaxInBlocklistsIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInBlocklistsIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-allowed");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",405);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNotAllowedMixin=a}),98);
__d("WASmaxInBlocklistsUpdateBlocklistErrors",["WAResultOrError","WASmaxInBlocklistsIQErrorBadRequestMixin","WASmaxInBlocklistsIQErrorForbiddenMixin","WASmaxInBlocklistsIQErrorNotAcceptableMixin","WASmaxInBlocklistsIQErrorNotAllowedMixin","WASmaxInBlocklistsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInBlocklistsIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInBlocklistsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:c.value});var e=d("WASmaxInBlocklistsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:e.value});var f=d("WASmaxInBlocklistsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:f.value});var g=d("WASmaxInBlocklistsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(a);return g.success?d("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorBadRequest","IQErrorForbidden","IQErrorRateOverlimit","IQErrorNotAllowed"],[b,c,e,f,g])}g.parseUpdateBlocklistErrors=a}),98);
__d("WASmaxInBlocklistsUpdateBlockListResponseInvalidRequest",["WAResultOrError","WASmaxInBlocklistsEnums","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxInBlocklistsUpdateBlocklistErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,c.value,"addressing_mode",d("WASmaxInBlocklistsEnums").ENUM_LID_PN);if(!e.success)return e;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsUpdateBlocklistErrors").parseUpdateBlocklistErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorAddressingMode:e.value},a.value,{errorUpdateBlocklistErrors:b.value}))}g.parseUpdateBlockListResponseInvalidRequest=a}),98);
__d("WASmaxInBlocklistsUpdateBlockListResponseMigratedSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsBlocklistIdentifierMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrLidUserJid(a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"active","true");if(!c.success)return c;a=d("WASmaxInBlocklistsBlocklistIdentifierMixin").parseBlocklistIdentifierMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value,active:c.value},a.value))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;var f=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!f.success)return f;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",f.value);if(!a.success)return a;f=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"matched","false");if(!f.success)return f;a=d("WASmaxParseReference").optionalAttrStringFromReference(b,["item","dhash"]);if(!a.success)return a;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"c_dhash",a.value);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(c.value,"dhash");if(!a.success)return a;var g=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"addressing_mode","lid");if(!g.success)return g;c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"item",0,64e3,h);return!c.success?c:d("WAResultOrError").makeResult({type:e.value,listMatched:f.value,hasListCDhash:b.value!=null,listDhash:a.value,listAddressingMode:g.value,listItem:c.value})}g.parseUpdateBlockListResponseMigratedSuccessWithMismatchListItem=h;g.parseUpdateBlockListResponseMigratedSuccessWithMismatch=a}),98);
__d("WASmaxInBlocklistsUpdateBlockListResponseServerError",["WAResultOrError","WASmaxInBlocklistsIQErrorResponseMixin","WASmaxInBlocklistsServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInBlocklistsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInBlocklistsServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseUpdateBlockListResponseServerError=a}),98);
__d("WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMatch",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"matched","true");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(c.value,"dhash");return!a.success?a:d("WAResultOrError").makeResult({type:e.value,listMatched:b.value,listDhash:a.value})}g.parseUpdateBlockListResponseSuccessWithMatch=a}),98);
__d("WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMismatch",["WAResultOrError","WASmaxInBlocklistsDisplayNameMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"item");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxInBlocklistsDisplayNameMixin").parseDisplayNameMixin(a);return d("WAResultOrError").makeResult({jid:b.value,displayNameMixin:a.success?a.value:null})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;var f=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!f.success)return f;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",f.value);if(!a.success)return a;f=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"matched","false");if(!f.success)return f;a=d("WASmaxParseReference").optionalAttrStringFromReference(b,["item","dhash"]);if(!a.success)return a;b=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"c_dhash",a.value);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(c.value,"dhash");if(!a.success)return a;var g=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"addressing_mode","pn");if(!g.success)return g;c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"item",0,64e3,h);return!c.success?c:d("WAResultOrError").makeResult({type:e.value,listMatched:f.value,hasListCDhash:b.value!=null,listDhash:a.value,listAddressingMode:g.value,listItem:c.value})}g.parseUpdateBlockListResponseSuccessWithMismatchListItem=h;g.parseUpdateBlockListResponseSuccessWithMismatch=a}),98);
__d("WASmaxOutBlocklistsDisplayNameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyDisplayName;a=d("WASmaxJsx").smax("smax$any",{display_name:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDisplayNameMixin=a}),98);
__d("WASmaxOutBlocklistsPnJidMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPnJid;a=d("WASmaxJsx").smax("smax$any",{pn_jid:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePnJidMixin=a}),98);
__d("WASmaxOutBlocklistsUnknownIdentifierMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",{unknown_identifier:"true"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUnknownIdentifierMixin=a}),98);
__d("WASmaxOutBlocklistsUsernameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyUsername;a=d("WASmaxJsx").smax("smax$any",{username:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUsernameMixin=a}),98);
__d("WASmaxOutBlocklistsBlocklistIds",["WASmaxMixinGroupExhaustiveError","WASmaxOutBlocklistsDisplayNameMixin","WASmaxOutBlocklistsPnJidMixin","WASmaxOutBlocklistsUnknownIdentifierMixin","WASmaxOutBlocklistsUsernameMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.username)return d("WASmaxOutBlocklistsUsernameMixin").mergeUsernameMixin(a,b.username);if(b.pnJid)return d("WASmaxOutBlocklistsPnJidMixin").mergePnJidMixin(a,b.pnJid);if(b.displayName)return d("WASmaxOutBlocklistsDisplayNameMixin").mergeDisplayNameMixin(a,b.displayName);if(b.isUnknownIdentifier)return d("WASmaxOutBlocklistsUnknownIdentifierMixin").mergeUnknownIdentifierMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBlocklistIds=a}),98);
__d("WASmaxOutBlocklistsBlocklistIdentifierMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBlocklistsBlocklistIds"],(function(a,b,c,d,e,f,g){function h(a){a=a.blocklistIdsArgs;a=d("WASmaxOutBlocklistsBlocklistIds").mergeBlocklistIds(d("WASmaxJsx").smax("smax$any",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBlocklistIdentifierMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListMigratedBlockItemMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBlocklistsBlocklistIdentifierMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.itemJid;b=d("WASmaxOutBlocklistsBlocklistIdentifierMixin").mergeBlocklistIdentifierMixin(d("WASmaxJsx").smax("item",{jid:d("WAWap").JID(b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUpdateBlockListMigratedBlockItemMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListNonMigratedBlockItemMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemJid;a=d("WASmaxJsx").smax("item",{jid:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUpdateBlockListNonMigratedBlockItemMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutBlocklistsUpdateBlockListMigratedBlockItemMixin","WASmaxOutBlocklistsUpdateBlockListNonMigratedBlockItemMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.updateBlockListMigratedBlockItem)return d("WASmaxOutBlocklistsUpdateBlockListMigratedBlockItemMixin").mergeUpdateBlockListMigratedBlockItemMixin(a,b.updateBlockListMigratedBlockItem);if(b.updateBlockListNonMigratedBlockItem)return d("WASmaxOutBlocklistsUpdateBlockListNonMigratedBlockItemMixin").mergeUpdateBlockListNonMigratedBlockItemMixin(a,b.updateBlockListNonMigratedBlockItem);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUpdateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroup=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListBlockItemMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutBlocklistsUpdateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.updateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroupArgs;a=d("WASmaxOutBlocklistsUpdateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroup").mergeUpdateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroup(d("WASmaxJsx").smax("item",{action:"block"}),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUpdateBlockListBlockItemMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListUnblockItemMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.itemJid;a=d("WASmaxJsx").smax("item",{action:"unblock",jid:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUpdateBlockListUnblockItemMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListBlockOrUpdateBlockListUnblockItemMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutBlocklistsUpdateBlockListBlockItemMixin","WASmaxOutBlocklistsUpdateBlockListUnblockItemMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.updateBlockListBlockItem)return d("WASmaxOutBlocklistsUpdateBlockListBlockItemMixin").mergeUpdateBlockListBlockItemMixin(a,b.updateBlockListBlockItem);if(b.updateBlockListUnblockItem)return d("WASmaxOutBlocklistsUpdateBlockListUnblockItemMixin").mergeUpdateBlockListUnblockItemMixin(a,b.updateBlockListUnblockItem);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUpdateBlockListBlockOrUpdateBlockListUnblockItemMixinGroup=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListReportBlockEntryPointMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.entryPointSource;a=d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("entry_point",{source:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUpdateBlockListReportBlockEntryPointMixin=a}),98);
__d("WASmaxOutBlocklistsUpdateBlockListRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutBlocklistsUpdateBlockListBlockOrUpdateBlockListUnblockItemMixinGroup","WASmaxOutBlocklistsUpdateBlockListReportBlockEntryPointMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.bizOptOutReason,f=a.bizOptOutReasonDescription,g=a.bizOptOutEntryPoint,h=a.bizOptOutFirstMessage,i=a.bizOptOutBusinessDiscoveryEntryPoint,j=a.bizOptOutBusinessDiscoveryTimestamp;a=a.bizOptOutBusinessDiscoveryId;e=d("WASmaxJsx").smax("biz_opt_out",{reason:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,e),reason_description:b.OPTIONAL(c.CUSTOM_STRING,f),entry_point:b.OPTIONAL(c.CUSTOM_STRING,g),first_message:b.OPTIONAL(c.CUSTOM_STRING,h),business_discovery_entry_point:b.OPTIONAL(c.CUSTOM_STRING,i),business_discovery_timestamp:b.OPTIONAL(c.INT,j),business_discovery_id:b.OPTIONAL(c.CUSTOM_STRING,a)});return e}function a(a){var b=a.bizOptOutArgs,c=a.updateBlockListReportBlockEntryPointMixinArgs,e=a.itemDhash;a=a.updateBlockListBlockOrUpdateBlockListUnblockItemMixinGroupArgs;e=d("WASmaxMixins").optionalMerge(d("WASmaxOutBlocklistsUpdateBlockListReportBlockEntryPointMixin").mergeUpdateBlockListReportBlockEntryPointMixin,d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"blocklist",type:"set",id:d("WAWap").generateId()},d("WASmaxOutBlocklistsUpdateBlockListBlockOrUpdateBlockListUnblockItemMixinGroup").mergeUpdateBlockListBlockOrUpdateBlockListUnblockItemMixinGroup(d("WASmaxJsx").smax("item",{dhash:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,e)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),a)),c);return e}g.makeUpdateBlockListRequestItemBizOptOut=h;g.makeUpdateBlockListRequest=a}),98);
__d("WASmaxBlocklistsUpdateBlockListRPC",["WAComms","WASmaxInBlocklistsUpdateBlockListResponseInvalidRequest","WASmaxInBlocklistsUpdateBlockListResponseMigratedSuccessWithMismatch","WASmaxInBlocklistsUpdateBlockListResponseServerError","WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMatch","WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMismatch","WASmaxOutBlocklistsUpdateBlockListRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutBlocklistsUpdateBlockListRequest").makeUpdateBlockListRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMatch").parseUpdateBlockListResponseSuccessWithMatch(b,a);if(c.success)return{name:"UpdateBlockListResponseSuccessWithMatch",value:c.value};var e=d("WASmaxInBlocklistsUpdateBlockListResponseSuccessWithMismatch").parseUpdateBlockListResponseSuccessWithMismatch(b,a);if(e.success)return{name:"UpdateBlockListResponseSuccessWithMismatch",value:e.value};var f=d("WASmaxInBlocklistsUpdateBlockListResponseMigratedSuccessWithMismatch").parseUpdateBlockListResponseMigratedSuccessWithMismatch(b,a);if(f.success)return{name:"UpdateBlockListResponseMigratedSuccessWithMismatch",value:f.value};var g=d("WASmaxInBlocklistsUpdateBlockListResponseInvalidRequest").parseUpdateBlockListResponseInvalidRequest(b,a);if(g.success)return{name:"UpdateBlockListResponseInvalidRequest",value:g.value};b=d("WASmaxInBlocklistsUpdateBlockListResponseServerError").parseUpdateBlockListResponseServerError(b,a);if(b.success)return{name:"UpdateBlockListResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("UpdateBlockList",{SuccessWithMatch:c,SuccessWithMismatch:e,MigratedSuccessWithMismatch:f,InvalidRequest:g,ServerError:b}))});return h.apply(this,arguments)}g.sendUpdateBlockListRPC=a}),98);
__d("WASmaxInGroupsIQErrorAlreadyExistsMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","already-exists");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",304);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorAlreadyExistsMixin=a}),98);
__d("WASmaxInGroupsIQErrorConflictMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","conflict");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",409);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorConflictMixin=a}),98);
__d("WASmaxInGroupsAcceptGroupAddClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorAlreadyExistsMixin","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorConflictMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorGoneMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAllowedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxInGroupsIQErrorParentLinkedGroupsParticipantsResourceLimitMixin","WASmaxInGroupsIQErrorResourceConstraintMixin","WASmaxInGroupsIQErrorResourceLimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorAlreadyExistsMixin").parseIQErrorAlreadyExistsMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorAlreadyExists",value:b.value});var c=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:c.value});var e=d("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:e.value});var f=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:f.value});var g=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:g.value});var h=d("WASmaxInGroupsIQErrorConflictMixin").parseIQErrorConflictMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"IQErrorConflict",value:h.value});var i=d("WASmaxInGroupsIQErrorGoneMixin").parseIQErrorGoneMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"IQErrorGone",value:i.value});var j=d("WASmaxInGroupsIQErrorResourceLimitMixin").parseIQErrorResourceLimitMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"IQErrorResourceLimit",value:j.value});var k=d("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(a);if(k.success)return d("WAResultOrError").makeResult({name:"IQErrorLocked",value:k.value});var l=d("WASmaxInGroupsIQErrorResourceConstraintMixin").parseIQErrorResourceConstraintMixin(a);if(l.success)return d("WAResultOrError").makeResult({name:"IQErrorResourceConstraint",value:l.value});var m=d("WASmaxInGroupsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(a);if(m.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:m.value});var n=d("WASmaxInGroupsIQErrorParentLinkedGroupsParticipantsResourceLimitMixin").parseIQErrorParentLinkedGroupsParticipantsResourceLimitMixin(a);if(n.success)return d("WAResultOrError").makeResult({name:"IQErrorParentLinkedGroupsParticipantsResourceLimit",value:n.value});var o=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return o.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:o.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorAlreadyExists","IQErrorBadRequest","IQErrorNotAuthorized","IQErrorForbidden","IQErrorItemNotFound","IQErrorConflict","IQErrorGone","IQErrorResourceLimit","IQErrorLocked","IQErrorResourceConstraint","IQErrorNotAllowed","IQErrorParentLinkedGroupsParticipantsResourceLimit","IQErrorFallbackClient"],[b,c,e,f,g,h,i,j,k,l,m,n,o])}g.parseAcceptGroupAddClientErrors=a}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseClientError",["WAResultOrError","WASmaxInGroupsAcceptGroupAddClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsAcceptGroupAddClientErrors").parseAcceptGroupAddClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorAcceptGroupAddClientErrors:b.value}))}g.parseAcceptGroupAddResponseClientError=a}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess",["WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"membership_approval_request");if(!c.success)return c;c=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseAcceptGroupAddResponseGroupJoinRequestSuccess=a}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseAcceptGroupAddResponseServerError=a}),98);
__d("WASmaxInGroupsAcceptGroupAddResponseSuccess",["WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseAcceptGroupAddResponseSuccess=a}),98);
__d("WASmaxOutGroupsAcceptGroupAddRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.acceptCode,c=a.acceptExpiration,e=a.acceptAdmin;b=d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("accept",{code:d("WAWap").CUSTOM_STRING(b),expiration:d("WAWap").INT(c),admin:d("WAWap").USER_JID(e)})),a);return b}g.makeAcceptGroupAddRequest=a}),98);
__d("WASmaxGroupsAcceptGroupAddRPC",["WAComms","WASmaxInGroupsAcceptGroupAddResponseClientError","WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess","WASmaxInGroupsAcceptGroupAddResponseServerError","WASmaxInGroupsAcceptGroupAddResponseSuccess","WASmaxOutGroupsAcceptGroupAddRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutGroupsAcceptGroupAddRequest").makeAcceptGroupAddRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInGroupsAcceptGroupAddResponseGroupJoinRequestSuccess").parseAcceptGroupAddResponseGroupJoinRequestSuccess(b,a);if(c.success)return{name:"AcceptGroupAddResponseGroupJoinRequestSuccess",value:c.value};var e=d("WASmaxInGroupsAcceptGroupAddResponseSuccess").parseAcceptGroupAddResponseSuccess(b,a);if(e.success)return{name:"AcceptGroupAddResponseSuccess",value:e.value};var f=d("WASmaxInGroupsAcceptGroupAddResponseClientError").parseAcceptGroupAddResponseClientError(b,a);if(f.success)return{name:"AcceptGroupAddResponseClientError",value:f.value};b=d("WASmaxInGroupsAcceptGroupAddResponseServerError").parseAcceptGroupAddResponseServerError(b,a);if(b.success)return{name:"AcceptGroupAddResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AcceptGroupAdd",{GroupJoinRequestSuccess:c,Success:e,ClientError:f,ServerError:b}))});return h.apply(this,arguments)}g.sendAcceptGroupAddRPC=a}),98);
__d("WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:b.value});var c=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:c.value});var e=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:e.value});var f=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorItemNotFound","IQErrorBadRequest","IQErrorRateOverlimit","IQErrorFallbackClient"],[b,c,e,f])}g.parseIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup=a}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseClientError",["WAResultOrError","WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup").parseIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorIQErrorItemNotFoundOrBadRequestOrRateOverlimitOrFallbackClientMixinGroup:b.value}))}g.parseAcknowledgeGroupResponseClientError=a}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseAcknowledgeGroupResponseServerError=a}),98);
__d("WASmaxInGroupsAcknowledgeGroupResponseSuccess",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);return!a.success?a:d("WAResultOrError").makeResult({type:c.value})}g.parseAcknowledgeGroupResponseSuccess=a}),98);
__d("WASmaxOutGroupsAcknowledgeGroupRequest",["WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("ack",null)),a);return a}g.makeAcknowledgeGroupRequest=a}),98);
__d("WASmaxGroupsAcknowledgeGroupRPC",["WAComms","WASmaxInGroupsAcknowledgeGroupResponseClientError","WASmaxInGroupsAcknowledgeGroupResponseServerError","WASmaxInGroupsAcknowledgeGroupResponseSuccess","WASmaxOutGroupsAcknowledgeGroupRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutGroupsAcknowledgeGroupRequest").makeAcknowledgeGroupRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInGroupsAcknowledgeGroupResponseSuccess").parseAcknowledgeGroupResponseSuccess(b,a);if(c.success)return{name:"AcknowledgeGroupResponseSuccess",value:c.value};var e=d("WASmaxInGroupsAcknowledgeGroupResponseClientError").parseAcknowledgeGroupResponseClientError(b,a);if(e.success)return{name:"AcknowledgeGroupResponseClientError",value:e.value};b=d("WASmaxInGroupsAcknowledgeGroupResponseServerError").parseAcknowledgeGroupResponseServerError(b,a);if(b.success)return{name:"AcknowledgeGroupResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("AcknowledgeGroup",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendAcknowledgeGroupRPC=a}),98);
__d("WASmaxInGroupsGetGroupInfoClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorGoneMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorGoneMixin").parseIQErrorGoneMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorGone",value:b.value});var c=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:c.value});var e=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:e.value});var f=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:f.value});var g=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:g.value});var h=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return h.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorGone","IQErrorBadRequest","IQErrorForbidden","IQErrorItemNotFound","IQErrorRateOverlimit","IQErrorFallbackClient"],[b,c,e,f,g,h])}g.parseGetGroupInfoClientErrors=a}),98);
__d("WASmaxInGroupsGetGroupInfoResponseClientError",["WAResultOrError","WASmaxInGroupsGetGroupInfoClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsGetGroupInfoClientErrors").parseGetGroupInfoClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetGroupInfoClientErrors:b.value}))}g.parseGetGroupInfoResponseClientError=a}),98);
__d("WASmaxInGroupsGetGroupInfoResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseGetGroupInfoResponseServerError=a}),98);
__d("WASmaxInGroupsGetGroupInfoResponseSuccess",["WAResultOrError","WASmaxInGroupsDedupAttrsMixin","WASmaxInGroupsGroupInfoMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"group");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"size",0,19999);if(!b.success)return b;var c=d("WASmaxInGroupsGroupInfoMixin").parseGroupInfoMixin(a);if(!c.success)return c;a=d("WASmaxInGroupsDedupAttrsMixin").parseDedupAttrsMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({size:b.value},c.value,{dedupAttrsMixin:a.success?a.value:null}))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optionalChildWithTag(a,"group",h);if(!c.success)return c;var e=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",e.value);if(!e.success)return e;e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);return!a.success?a:d("WAResultOrError").makeResult({type:e.value,group:c.value})}g.parseGetGroupInfoResponseSuccessGroup=h;g.parseGetGroupInfoResponseSuccess=a}),98);
__d("WASmaxOutGroupsAddRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.addRequestAdmin;a=d("WASmaxJsx").smax("add_request",{admin:d("WAWap").USER_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAddRequestMixin=a}),98);
__d("WASmaxOutGroupsCodeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.addRequestCode;a=d("WASmaxJsx").smax("add_request",{code:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCodeMixin=a}),98);
__d("WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyRequest;a=d("WASmaxJsx").smax("smax$any",{request:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetGroupInfoRequestTypeAttributeMixin=a}),98);
__d("WASmaxOutGroupsGetGroupInfoRequestTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutGroupsGetGroupInfoRequestTypeAttributeMixin").mergeGetGroupInfoRequestTypeAttributeMixin(d("WASmaxJsx").smax("query",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetGroupInfoRequestTypeMixin=a}),98);
__d("WASmaxOutGroupsGetGroupInfoRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsAddRequestMixin","WASmaxOutGroupsBaseGetGroupMixin","WASmaxOutGroupsCodeMixin","WASmaxOutGroupsGetGroupInfoRequestTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.addRequestExpiration;b=d("WASmaxOutGroupsCodeMixin").mergeCodeMixin(d("WASmaxOutGroupsAddRequestMixin").mergeAddRequestMixin(d("WASmaxJsx").smax("add_request",{expiration:d("WAWap").INT(b)}),a),a);return b}function a(a){var b=a.addRequestArgs,c=a.queryPhash,e=a.getGroupInfoRequestTypeMixinArgs;c=d("WASmaxOutGroupsBaseGetGroupMixin").mergeBaseGetGroupMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsGetGroupInfoRequestTypeMixin").mergeGetGroupInfoRequestTypeMixin,d("WASmaxJsx").smax("query",{phash:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),e)),a);return c}g.makeGetGroupInfoRequestQueryAddRequest=h;g.makeGetGroupInfoRequest=a}),98);
__d("WASmaxGroupsGetGroupInfoRPC",["WAComms","WASmaxInGroupsGetGroupInfoResponseClientError","WASmaxInGroupsGetGroupInfoResponseServerError","WASmaxInGroupsGetGroupInfoResponseSuccess","WASmaxOutGroupsGetGroupInfoRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutGroupsGetGroupInfoRequest").makeGetGroupInfoRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInGroupsGetGroupInfoResponseSuccess").parseGetGroupInfoResponseSuccess(b,a);if(c.success)return{name:"GetGroupInfoResponseSuccess",value:c.value};var e=d("WASmaxInGroupsGetGroupInfoResponseClientError").parseGetGroupInfoResponseClientError(b,a);if(e.success)return{name:"GetGroupInfoResponseClientError",value:e.value};b=d("WASmaxInGroupsGetGroupInfoResponseServerError").parseGetGroupInfoResponseServerError(b,a);if(b.success)return{name:"GetGroupInfoResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetGroupInfo",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendGetGroupInfoRPC=a}),98);
__d("WASmaxInGroupsGetGroupProfilePictureClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorNotAllowedMixin","WASmaxInGroupsIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:b.value});var c=d("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorForbidden",value:c.value});var e=d("WASmaxInGroupsIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAllowed",value:e.value});var f=d("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:f.value});var g=d("WASmaxInGroupsIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:g.value});var h=d("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return h.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:h.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorItemNotFound","IQErrorForbidden","IQErrorNotAllowed","IQErrorBadRequest","IQErrorRateOverlimit","IQErrorFallbackClient"],[b,c,e,f,g,h])}g.parseGetGroupProfilePictureClientErrors=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseClientError",["WAResultOrError","WASmaxInGroupsGetGroupProfilePictureClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInGroupsGetGroupProfilePictureClientErrors").parseGetGroupProfilePictureClientErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetGroupProfilePictureClientErrors:b.value}))}g.parseGetGroupProfilePicturesResponseClientError=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(a,b);return!c.success?c:c}g.parseGetGroupProfilePicturesResponseServerError=a}),98);
__d("WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"status","405");return!b.success?b:d("WAResultOrError").makeResult({status:b.value})}g.parseBadLinkedGroupProfilePictureErrorMixin=a}),98);
__d("WASmaxInGroupsBadServerProfilePictureErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"status","500");return!b.success?b:d("WAResultOrError").makeResult({status:b.value})}g.parseBadServerProfilePictureErrorMixin=a}),98);
__d("WASmaxInGroupsPictureDidNotChangeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"status","304");return!b.success?b:d("WAResultOrError").makeResult({status:b.value})}g.parsePictureDidNotChangeMixin=a}),98);
__d("WASmaxInGroupsPictureNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"status","204");return!b.success?b:d("WAResultOrError").makeResult({status:b.value})}g.parsePictureNotFoundMixin=a}),98);
__d("WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup",["WAResultOrError","WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin","WASmaxInGroupsBadServerProfilePictureErrorMixin","WASmaxInGroupsPictureDidNotChangeMixin","WASmaxInGroupsPictureNotFoundMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsPictureDidNotChangeMixin").parsePictureDidNotChangeMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"PictureDidNotChange",value:b.value});var c=d("WASmaxInGroupsPictureNotFoundMixin").parsePictureNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"PictureNotFound",value:c.value});var e=d("WASmaxInGroupsBadServerProfilePictureErrorMixin").parseBadServerProfilePictureErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"BadServerProfilePictureError",value:e.value});var f=d("WASmaxInGroupsBadLinkedGroupProfilePictureErrorMixin").parseBadLinkedGroupProfilePictureErrorMixin(a);return f.success?d("WAResultOrError").makeResult({name:"BadLinkedGroupProfilePictureError",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["PictureDidNotChange","PictureNotFound","BadServerProfilePictureError","BadLinkedGroupProfilePictureError"],[b,c,e,f])}g.parsePictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin",["WAResultOrError","WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxInGroupsPictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup").parsePictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup(a);return d("WAResultOrError").makeResult({pictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup:b.success?b.value:null})}g.parseGetGroupProfilePicturesPartialProfilePictureResponseMixin=a}),98);
__d("WASmaxInGroupsProfilePictureIdMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");return!b.success?b:d("WAResultOrError").makeResult({id:b.value})}g.parseProfilePictureIdMixin=a}),98);
__d("WASmaxInGroupsProfilePictureTypeMixin",["WAResultOrError","WASmaxInGroupsEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInGroupsEnums").ENUM_IMAGE_PREVIEW);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseProfilePictureTypeMixin=a}),98);
__d("WASmaxInGroupsProfilePictureBlobResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,void 0);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseProfilePictureBlobResponseMixin=a}),98);
__d("WASmaxInGroupsProfilePictureUrlResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"url");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"direct_path");return!a.success?a:d("WAResultOrError").makeResult({url:b.value,directPath:a.value})}g.parseProfilePictureUrlResponseMixin=a}),98);
__d("WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup",["WAResultOrError","WASmaxInGroupsProfilePictureBlobResponseMixin","WASmaxInGroupsProfilePictureUrlResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsProfilePictureUrlResponseMixin").parseProfilePictureUrlResponseMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ProfilePictureUrlResponse",value:b.value});var c=d("WASmaxInGroupsProfilePictureBlobResponseMixin").parseProfilePictureBlobResponseMixin(a);return c.success?d("WAResultOrError").makeResult({name:"ProfilePictureBlobResponse",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ProfilePictureUrlResponse","ProfilePictureBlobResponse"],[b,c])}g.parseProfilePictureUrlOrBlobResponseMixinGroup=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin",["WAResultOrError","WASmaxInGroupsProfilePictureIdMixin","WASmaxInGroupsProfilePictureTypeMixin","WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxInGroupsProfilePictureIdMixin").parseProfilePictureIdMixin(a);if(!b.success)return b;var c=d("WASmaxInGroupsProfilePictureTypeMixin").parseProfilePictureTypeMixin(a);if(!c.success)return c;a=d("WASmaxInGroupsProfilePictureUrlOrBlobResponseMixinGroup").parseProfilePictureUrlOrBlobResponseMixinGroup(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{profilePictureUrlOrBlobResponseMixinGroup:a.success?a.value:null}))}g.parseGetGroupProfilePicturesSuccessProfilePictureResponseMixin=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin","WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsGetGroupProfilePicturesSuccessProfilePictureResponseMixin").parseGetGroupProfilePicturesSuccessProfilePictureResponseMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"GetGroupProfilePicturesSuccessProfilePictureResponse",value:b.value});var c=d("WASmaxInGroupsGetGroupProfilePicturesPartialProfilePictureResponseMixin").parseGetGroupProfilePicturesPartialProfilePictureResponseMixin(a);return c.success?d("WAResultOrError").makeResult({name:"GetGroupProfilePicturesPartialProfilePictureResponse",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["SuccessProfilePictureResponse","PartialProfilePictureResponse"],[b,c])}g.parseGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup=a}),98);
__d("WASmaxInGroupsSubGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrGroupJid(a,"sub_group_jid");return!a.success?a:d("WAResultOrError").makeResult({subGroupJid:a.value})}g.parseSubGroupMixin=a}),98);
__d("WASmaxInGroupsParentOrSubGroupMixinGroup",["WAResultOrError","WASmaxInGroupsParentGroupMixin","WASmaxInGroupsSubGroupMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInGroupsParentGroupMixin").parseParentGroupMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ParentGroup",value:b.value});var c=d("WASmaxInGroupsSubGroupMixin").parseSubGroupMixin(a);return c.success?d("WAResultOrError").makeResult({name:"SubGroup",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ParentGroup","SubGroup"],[b,c])}g.parseParentOrSubGroupMixinGroup=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup","WASmaxInGroupsParentOrSubGroupMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxInGroupsParentOrSubGroupMixinGroup").parseParentOrSubGroupMixinGroup(a);if(!b.success)return b;a=d("WASmaxInGroupsGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup").parseGetGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({parentOrSubGroupMixinGroup:b.value,getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup:a.value})}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"pictures");if(!a.success)return a;a=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"picture",1,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({picturesPicture:a.value})}g.parseGetGroupProfilePicturesProfilePicturesResponsePicturesPicture=h;g.parseGetGroupProfilePicturesProfilePicturesResponseMixin=a}),98);
__d("WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures",["WAResultOrError","WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!c.success)return c;b=d("WASmaxInGroupsGetGroupProfilePicturesProfilePicturesResponseMixin").parseGetGroupProfilePicturesProfilePicturesResponseMixin(a);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,b.value))}g.parseGetGroupProfilePicturesResponseSuccessGroupPictures=a}),98);
__d("WASmaxOutGroupsBaseGetGroupOrServerMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutGroupsBaseGetGroupMixin","WASmaxOutGroupsBaseGetServerMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.baseGetGroup)return d("WASmaxOutGroupsBaseGetGroupMixin").mergeBaseGetGroupMixin(a,b.baseGetGroup);if(b.isBaseGetServer)return d("WASmaxOutGroupsBaseGetServerMixin").mergeBaseGetServerMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBaseGetGroupOrServerMixinGroup=a}),98);
__d("WASmaxOutGroupsSubGroupMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anySubGroupJid;a=d("WASmaxJsx").smax("smax$any",{sub_group_jid:d("WAWap").GROUP_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSubGroupMixin=a}),98);
__d("WASmaxOutGroupsParentOrSubGroupMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutGroupsParentGroupMixin","WASmaxOutGroupsSubGroupMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.parentGroup)return d("WASmaxOutGroupsParentGroupMixin").mergeParentGroupMixin(a,b.parentGroup);if(b.subGroup)return d("WASmaxOutGroupsSubGroupMixin").mergeSubGroupMixin(a,b.subGroup);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeParentOrSubGroupMixinGroup=a}),98);
__d("WASmaxOutGroupsProfilePictureIdMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.pictureId;a=d("WASmaxJsx").smax("picture",{id:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeProfilePictureIdMixin=a}),98);
__d("WASmaxOutGroupsProfilePictureQueryMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.pictureQuery;a=d("WASmaxJsx").smax("picture",{query:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeProfilePictureQueryMixin=a}),98);
__d("WASmaxOutGroupsProfilePictureTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.pictureType;a=d("WASmaxJsx").smax("picture",{type:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeProfilePictureTypeMixin=a}),98);
__d("WASmaxOutGroupsSubGroupHintMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyLinkedGroupsMembershipHint;a=d("WASmaxJsx").smax("smax$any",{linked_groups_membership_hint:d("WAWap").GROUP_JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSubGroupHintMixin=a}),98);
__d("WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutGroupsParentOrSubGroupMixinGroup","WASmaxOutGroupsProfilePictureIdMixin","WASmaxOutGroupsProfilePictureQueryMixin","WASmaxOutGroupsProfilePictureTypeMixin","WASmaxOutGroupsSubGroupHintMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.profilePictureIdMixinArgs,c=a.profilePictureTypeMixinArgs,e=a.profilePictureQueryMixinArgs;a=a.parentOrSubGroupMixinGroupArgs;b=d("WASmaxOutGroupsParentOrSubGroupMixinGroup").mergeParentOrSubGroupMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsProfilePictureQueryMixin").mergeProfilePictureQueryMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsProfilePictureTypeMixin").mergeProfilePictureTypeMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsProfilePictureIdMixin").mergeProfilePictureIdMixin,d("WASmaxJsx").smax("picture",null),b),c),e),a);return b}function i(a){var b=a.pictureArgs;a=a.subGroupHintMixinArgs;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxMixins").optionalMerge(d("WASmaxOutGroupsSubGroupHintMixin").mergeSubGroupHintMixin,d("WASmaxJsx").smax("pictures",null,d("WASmaxChildren").REPEATED_CHILD(h,b,1,1e3)),a));return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeGetGroupProfilePicturesProfilePicturesRequestPicturesPicture=h;g.mergeGetGroupProfilePicturesProfilePicturesRequestMixin=a}),98);
__d("WASmaxOutGroupsGetGroupProfilePicturesRequest",["WASmaxJsx","WASmaxOutGroupsBaseGetGroupOrServerMixinGroup","WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=a.baseGetGroupOrServerMixinGroupArgs;a=d("WASmaxOutGroupsBaseGetGroupOrServerMixinGroup").mergeBaseGetGroupOrServerMixinGroup(d("WASmaxOutGroupsGetGroupProfilePicturesProfilePicturesRequestMixin").mergeGetGroupProfilePicturesProfilePicturesRequestMixin(d("WASmaxJsx").smax("iq",null),a),b);return a}g.makeGetGroupProfilePicturesRequest=a}),98);
__d("WASmaxGroupsGetGroupProfilePicturesRPC",["WAComms","WASmaxInGroupsGetGroupProfilePicturesResponseClientError","WASmaxInGroupsGetGroupProfilePicturesResponseServerError","WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures","WASmaxOutGroupsGetGroupProfilePicturesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutGroupsGetGroupProfilePicturesRequest").makeGetGroupProfilePicturesRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInGroupsGetGroupProfilePicturesResponseSuccessGroupPictures").parseGetGroupProfilePicturesResponseSuccessGroupPictures(b,a);if(c.success)return{name:"GetGroupProfilePicturesResponseSuccessGroupPictures",value:c.value};var e=d("WASmaxInGroupsGetGroupProfilePicturesResponseClientError").parseGetGroupProfilePicturesResponseClientError(b,a);if(e.success)return{name:"GetGroupProfilePicturesResponseClientError",value:e.value};b=d("WASmaxInGroupsGetGroupProfilePicturesResponseServerError").parseGetGroupProfilePicturesResponseServerError(b,a);if(b.success)return{name:"GetGroupProfilePicturesResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetGroupProfilePictures",{SuccessGroupPictures:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendGetGroupProfilePicturesRPC=a}),98);
__d("WASmaxInMessagePublishNewsletterSenderRCATAckMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"rcat");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytes(b.value);return!a.success?a:d("WAResultOrError").makeResult({rcatElementValue:a.value})}g.parseNewsletterSenderRCATAckMixin=a}),98);
__d("WASmaxInMessagePublishNewsletterMessageAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishNewsletterSenderRCATAckMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"server_id",99,2147476647);if(!c.success)return c;b=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);if(!b.success)return b;a=d("WASmaxInMessagePublishNewsletterSenderRCATAckMixin").parseNewsletterSenderRCATAckMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({serverId:c.value},b.value,{newsletterSenderRCATAckMixin:a.success?a.value:null}))}g.parseNewsletterMessageAckMixin=a}),98);
__d("WASmaxInMessagePublishNewsletterQuestionResponseAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(a,"response_server_id");if(!c.success)return c;a=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({responseServerId:c.value},a.value))}g.parseNewsletterQuestionResponseAckMixin=a}),98);
__d("WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup",["WAResultOrError","WASmaxInMessagePublishNewsletterMessageAckMixin","WASmaxInMessagePublishNewsletterQuestionResponseAckMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxInMessagePublishNewsletterQuestionResponseAckMixin").parseNewsletterQuestionResponseAckMixin(a,b);if(c.success)return d("WAResultOrError").makeResult({name:"NewsletterQuestionResponseAck",value:c.value});b=d("WASmaxInMessagePublishNewsletterMessageAckMixin").parseNewsletterMessageAckMixin(a,b);return b.success?d("WAResultOrError").makeResult({name:"NewsletterMessageAck",value:b.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["QuestionResponseAck","MessageAck"],[c,b])}g.parseNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup=a}),98);
__d("WASmaxInMessagePublishNewsletterResponseNegative",["WASmaxInMessagePublishNegativeAckMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInMessagePublishNegativeAckMixin").parseNegativeAckMixin(a,b);return!c.success?c:c}g.parseNewsletterResponseNegative=a}),98);
__d("WASmaxInMessagePublishNewsletterResponseSuccess",["WAResultOrError","WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInMessagePublishNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup").parseNewsletterQuestionResponseOrNewsletterMessageAckMixinGroup(a,b);return!c.success?c:d("WAResultOrError").makeResult({newsletterQuestionResponseOrNewsletterMessageAckMixinGroup:c.value})}g.parseNewsletterResponseSuccess=a}),98);
__d("WASmaxInNewslettersAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","3");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminEditMixin=a}),98);
__d("WASmaxInNewslettersAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","8");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAdminRevokeMixin=a}),98);
__d("WASmaxInNewslettersIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInNewslettersIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersBadRequestIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorBadRequestMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorBadRequestMixin:c.value},a.value))}g.parseBadRequestIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","rate-overlimit");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",429);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRateOverlimitMixin=a}),98);
__d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorRateOverlimitMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorRateOverlimitMixin:c.value},a.value))}g.parseRateLimitedIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(a,b);if(c.success)return d("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:c.value});b=d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(a,b);return b.success?d("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:b.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BadRequestIQErrorResponse","RateLimitedIQErrorResponse"],[c,b])}g.parseBadRequestOrRateLimitedIQErrorResponseMixinGroup=a}),98);
__d("WASmaxInNewslettersNewsletterCreationTimeMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"creation_time");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"value",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({creationTimeValue:a.value})}g.parseNewsletterCreationTimeMetadataMixin=a}),98);
__d("WASmaxInNewslettersQueryDescriptionResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"description");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"update_time",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").contentString(a);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,updateTime:c.value,elementValue:a.value})}g.parseQueryDescriptionResponseMixin=a}),98);
__d("WASmaxInNewslettersNewsletterDescriptionMetadataMixin",["WAResultOrError","WASmaxInNewslettersQueryDescriptionResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"description");if(!b.success)return b;a=d("WASmaxInNewslettersQueryDescriptionResponseMixin").parseQueryDescriptionResponseMixin(b.value);return d("WAResultOrError").makeResult({descriptionQueryDescriptionResponseMixin:a.success?a.value:null})}g.parseNewsletterDescriptionMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterInviteLinkMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"invite");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"code");return!a.success?a:d("WAResultOrError").makeResult({inviteCode:a.value})}g.parseNewsletterInviteLinkMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin",["WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"linked_accounts");return!b.success?b:d("WASmaxParseUtils").voidSuccess}g.parseNewsletterLinkedAccountsMetadataMixin=a}),98);
__d("WASmaxInNewslettersEnums",[],(function(a,b,c,d,e,f){a={"1p_sticker":"1p_sticker",audio:"audio",avatar_sticker:"avatar_sticker",cataloglink:"cataloglink",collection:"collection",document:"document",genai_sticker:"genai_sticker",gif:"gif",image:"image",motion_photo:"motion_photo",motion_video:"motion_video",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",sticker_pack:"sticker_pack",url:"url",user_created_sticker:"user_created_sticker",vcard:"vcard",video:"video"};b={active:"active",geosuspended:"geosuspended",suspended:"suspended"};c={admin:"admin",guest:"guest",owner:"owner",subscriber:"subscriber"};d={all:"all",basic:"basic",none:"none"};e={hd_image_dual_upload:"hd_image_dual_upload",hd_video_dual_upload:"hd_video_dual_upload",media_poll:"media_poll",motion_photo:"motion_photo",sticker_annotation:"sticker_annotation"};var g={image:"image",preview:"preview"},h={off:"off",on:"on",undefined:"undefined"},i={"private":"private","public":"public"},j={unverified:"unverified",verified:"verified"};f.ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO=a;f.ENUM_ACTIVE_GEOSUSPENDED_SUSPENDED=b;f.ENUM_ADMIN_GUEST_OWNER_SUBSCRIBER=c;f.ENUM_ALL_BASIC_NONE=d;f.ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION=e;f.ENUM_IMAGE_PREVIEW=g;f.ENUM_OFF_ON_UNDEFINED=h;f.ENUM_PRIVATE_PUBLIC=i;f.ENUM_UNVERIFIED_VERIFIED=j}),66);
__d("WASmaxInNewslettersNewsletterMembershipMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"membership");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInNewslettersEnums").ENUM_ADMIN_GUEST_OWNER_SUBSCRIBER);return!a.success?a:d("WAResultOrError").makeResult({membershipType:a.value})}g.parseNewsletterMembershipMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMutedMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"muted");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInNewslettersEnums").ENUM_OFF_ON_UNDEFINED);return!a.success?a:d("WAResultOrError").makeResult({mutedState:a.value})}g.parseNewsletterMutedMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterNameMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"id");if(!a.success)return a;var c=d("WASmaxParseUtils").attrIntRange(b.value,"update_time",0,void 0);if(!c.success)return c;b=d("WASmaxParseUtils").contentString(b.value);return!b.success?b:d("WAResultOrError").makeResult({nameId:a.value,nameUpdateTime:c.value,nameElementValue:b.value})}g.parseNewsletterNameMetadataMixin=a}),98);
__d("WASmaxInNewslettersQueryPictureDirectPathResponseMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInNewslettersEnums").ENUM_IMAGE_PREVIEW);if(!c.success)return c;a=d("WASmaxParseUtils").attrString(a,"direct_path");return!a.success?a:d("WAResultOrError").makeResult({id:b.value,type:c.value,directPath:a.value})}g.parseQueryPictureDirectPathResponseMixin=a}),98);
__d("WASmaxInNewslettersQueryPictureEmptyResponseMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"type",d("WASmaxInNewslettersEnums").ENUM_IMAGE_PREVIEW);return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseQueryPictureEmptyResponseMixin=a}),98);
__d("WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup",["WAResultOrError","WASmaxInNewslettersQueryPictureDirectPathResponseMixin","WASmaxInNewslettersQueryPictureEmptyResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNewslettersQueryPictureDirectPathResponseMixin").parseQueryPictureDirectPathResponseMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"QueryPictureDirectPathResponse",value:b.value});var c=d("WASmaxInNewslettersQueryPictureEmptyResponseMixin").parseQueryPictureEmptyResponseMixin(a);return c.success?d("WAResultOrError").makeResult({name:"QueryPictureEmptyResponse",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["QueryPictureDirectPathResponse","QueryPictureEmptyResponse"],[b,c])}g.parseQueryPictureDirectPathOrEmptyResponseMixinGroup=a}),98);
__d("WASmaxInNewslettersNewsletterPictureMetadataMixin",["WAResultOrError","WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"picture");if(!b.success)return b;b=d("WASmaxInNewslettersQueryPictureDirectPathOrEmptyResponseMixinGroup").parseQueryPictureDirectPathOrEmptyResponseMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({queryPictureDirectPathOrEmptyResponseMixinGroup:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"picture",0,2,h);return!b.success?b:d("WAResultOrError").makeResult({picture:b.value})}g.parseNewsletterPictureMetadataPicture=h;g.parseNewsletterPictureMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterPrivacyMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInNewslettersEnums").ENUM_PRIVATE_PUBLIC);return!a.success?a:d("WAResultOrError").makeResult({privacyType:a.value})}g.parseNewsletterPrivacyMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterStateMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"state");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"type",d("WASmaxInNewslettersEnums").ENUM_ACTIVE_GEOSUSPENDED_SUSPENDED);return!a.success?a:d("WAResultOrError").makeResult({stateType:a.value})}g.parseNewsletterStateMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterSubscribersMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"subscribers");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({subscribersCount:a.value})}g.parseNewsletterSubscribersMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterVerificationMetadataMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"verification");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"state",d("WASmaxInNewslettersEnums").ENUM_UNVERIFIED_VERIFIED);return!a.success?a:d("WAResultOrError").makeResult({verificationState:a.value})}g.parseNewsletterVerificationMetadataMixin=a}),98);
__d("WASmaxInNewslettersCommonNewsletterMetadataMixin",["WAResultOrError","WASmaxInNewslettersNewsletterCreationTimeMetadataMixin","WASmaxInNewslettersNewsletterDescriptionMetadataMixin","WASmaxInNewslettersNewsletterInviteLinkMetadataMixin","WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin","WASmaxInNewslettersNewsletterMembershipMetadataMixin","WASmaxInNewslettersNewsletterMutedMetadataMixin","WASmaxInNewslettersNewsletterNameMetadataMixin","WASmaxInNewslettersNewsletterPictureMetadataMixin","WASmaxInNewslettersNewsletterPrivacyMetadataMixin","WASmaxInNewslettersNewsletterStateMetadataMixin","WASmaxInNewslettersNewsletterSubscribersMetadataMixin","WASmaxInNewslettersNewsletterVerificationMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxInNewslettersNewsletterCreationTimeMetadataMixin").parseNewsletterCreationTimeMetadataMixin(a);var c=d("WASmaxInNewslettersNewsletterNameMetadataMixin").parseNewsletterNameMetadataMixin(a),e=d("WASmaxInNewslettersNewsletterPictureMetadataMixin").parseNewsletterPictureMetadataMixin(a),f=d("WASmaxInNewslettersNewsletterDescriptionMetadataMixin").parseNewsletterDescriptionMetadataMixin(a),g=d("WASmaxInNewslettersNewsletterInviteLinkMetadataMixin").parseNewsletterInviteLinkMetadataMixin(a),h=d("WASmaxInNewslettersNewsletterSubscribersMetadataMixin").parseNewsletterSubscribersMetadataMixin(a),i=d("WASmaxInNewslettersNewsletterPrivacyMetadataMixin").parseNewsletterPrivacyMetadataMixin(a),j=d("WASmaxInNewslettersNewsletterVerificationMetadataMixin").parseNewsletterVerificationMetadataMixin(a),k=d("WASmaxInNewslettersNewsletterLinkedAccountsMetadataMixin").parseNewsletterLinkedAccountsMetadataMixin(a),l=d("WASmaxInNewslettersNewsletterMembershipMetadataMixin").parseNewsletterMembershipMetadataMixin(a),m=d("WASmaxInNewslettersNewsletterMutedMetadataMixin").parseNewsletterMutedMetadataMixin(a);a=d("WASmaxInNewslettersNewsletterStateMetadataMixin").parseNewsletterStateMetadataMixin(a);return d("WAResultOrError").makeResult({newsletterCreationTimeMetadataMixin:b.success?b.value:null,newsletterNameMetadataMixin:c.success?c.value:null,newsletterPictureMetadataMixin:e.success?e.value:null,newsletterDescriptionMetadataMixin:f.success?f.value:null,newsletterInviteLinkMetadataMixin:g.success?g.value:null,newsletterSubscribersMetadataMixin:h.success?h.value:null,newsletterPrivacyMetadataMixin:i.success?i.value:null,newsletterVerificationMetadataMixin:j.success?j.value:null,hasNewsletterLinkedAccountsMetadataMixin:k.success,newsletterMembershipMetadataMixin:l.success?l.value:null,newsletterMutedMetadataMixin:m.success?m.value:null,newsletterStateMetadataMixin:a.success?a.value:null})}g.parseCommonNewsletterMetadataMixin=a}),98);
__d("WASmaxInNewslettersContentTypeMediaMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","media");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeMediaMixin=a}),98);
__d("WASmaxInNewslettersContentTypePollCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","creation");if(!c.success)return c;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"contenttype");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:c.value,metaContenttype:b.value})}g.parseContentTypePollCreationMixin=a}),98);
__d("WASmaxInNewslettersContentTypePollResultSnapshotMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","poll");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"polltype","result_snapshot");return!b.success?b:d("WAResultOrError").makeResult({type:a.value,metaPolltype:b.value})}g.parseContentTypePollResultSnapshotMixin=a}),98);
__d("WASmaxInNewslettersContentTypeTextMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","text");return!b.success?b:d("WAResultOrError").makeResult({type:b.value})}g.parseContentTypeTextMixin=a}),98);
__d("WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationMixinGroup",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxInNewslettersContentTypePollCreationMixin","WASmaxInNewslettersContentTypeTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"ContentTypeText",value:b.value});var c=d("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"ContentTypeMedia",value:c.value});var e=d("WASmaxInNewslettersContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);return e.success?d("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["ContentTypeText","ContentTypeMedia","ContentTypePollCreation"],[b,c,e])}g.parseContentTypeTextOrMediaOrPollCreationMixinGroup=a}),98);
__d("WASmaxInNewslettersCreateResponseClientError",["WAResultOrError","WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersBadRequestOrRateLimitedIQErrorResponseMixinGroup").parseBadRequestOrRateLimitedIQErrorResponseMixinGroup(a,b);return!c.success?c:d("WAResultOrError").makeResult({badRequestOrRateLimitedIQErrorResponseMixinGroup:c.value})}g.parseCreateResponseClientError=a}),98);
__d("WASmaxInNewslettersIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorInternalServerErrorMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorInternalServerErrorMixin:c.value},a.value))}g.parseInternalServerErrorIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersCreateResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(a,b);return!c.success?c:c}g.parseCreateResponseServerError=a}),98);
__d("WASmaxInNewslettersIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInNewslettersNewsletterIDMetadataMixin",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"id");if(!b.success)return b;a=d("WASmaxParseJid").attrNewsletterJid(b.value,"jid");return!a.success?a:d("WAResultOrError").makeResult({idJid:a.value})}g.parseNewsletterIDMetadataMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin",["WAResultOrError","WASmaxInNewslettersCommonNewsletterMetadataMixin","WASmaxInNewslettersNewsletterIDMetadataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"metadata");if(!b.success)return b;b=d("WASmaxInNewslettersNewsletterIDMetadataMixin").parseNewsletterIDMetadataMixin(a);if(!b.success)return b;a=d("WASmaxInNewslettersCommonNewsletterMetadataMixin").parseCommonNewsletterMetadataMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,a.value))}g.parseNewsletterMetadataIQResponsePayloadMixin=a}),98);
__d("WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin",["WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"newsletter");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"metadata");if(!b.success)return b;a=d("WASmaxInNewslettersNewsletterMetadataIQResponsePayloadMixin").parseNewsletterMetadataIQResponsePayloadMixin(b.value);return!a.success?a:a}g.parseNewsletterWithMetadataIQResponsePayloadMixin=a}),98);
__d("WASmaxInNewslettersCreateResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"newsletter");if(!c.success)return c;c=d("WASmaxInNewslettersNewsletterWithMetadataIQResponsePayloadMixin").parseNewsletterWithMetadataIQResponsePayloadMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({newsletterNewsletterWithMetadataIQResponsePayloadMixin:c.value},a.value))}g.parseCreateResponseSuccess=a}),98);
__d("WASmaxInNewslettersIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorItemNotFoundMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorItemNotFoundMixin:c.value},a.value))}g.parseItemNotFoundIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersIQErrorLockedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","locked");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",423);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorLockedMixin=a}),98);
__d("WASmaxInNewslettersSuspendedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorLockedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorLockedMixin").parseIQErrorLockedMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorLockedMixin:c.value},a.value))}g.parseSuspendedIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","features-disabled");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",451);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorUnavailableForLegalReasonsGenericMixin=a}),98);
__d("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorResponseMixin","WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorUnavailableForLegalReasonsGenericMixin").parseIQErrorUnavailableForLegalReasonsGenericMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorUnavailableForLegalReasonsGenericMixin:c.value},a.value))}g.parseUnavailableForLegalReasonsResponseMixin=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersSuspendedIQErrorResponseMixin","WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(a,b);if(c.success)return d("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:c.value});var e=d("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin").parseUnavailableForLegalReasonsResponseMixin(a,b);if(e.success)return d("WAResultOrError").makeResult({name:"UnavailableForLegalReasonsResponse",value:e.value});var f=d("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(a,b);if(f.success)return d("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:f.value});var g=d("WASmaxInNewslettersSuspendedIQErrorResponseMixin").parseSuspendedIQErrorResponseMixin(a,b);if(g.success)return d("WAResultOrError").makeResult({name:"SuspendedIQErrorResponse",value:g.value});b=d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(a,b);return b.success?d("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:b.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BadRequestIQErrorResponse","UnavailableForLegalReasonsResponse","ItemNotFoundIQErrorResponse","SuspendedIQErrorResponse","RateLimitedIQErrorResponse"],[c,e,f,g,b])}g.parseGetNewsletterMessageUpdatesClientErrors=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError",["WAResultOrError","WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersGetNewsletterMessageUpdatesClientErrors").parseGetNewsletterMessageUpdatesClientErrors(a,b);return!c.success?c:d("WAResultOrError").makeResult({getNewsletterMessageUpdatesClientErrors:c.value})}g.parseGetNewsletterMessageUpdatesResponseClientError=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(a,b);return!c.success?c:c}g.parseGetNewsletterMessageUpdatesResponseServerError=a}),98);
__d("WASmaxInNewslettersMessageAssociationTypeMixin",["WAResultOrError","WASmaxInNewslettersEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrStringEnum(b.value,"message_association_type",d("WASmaxInNewslettersEnums").ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION);return!a.success?a:d("WAResultOrError").makeResult({metaMessageAssociationType:a.value})}g.parseMessageAssociationTypeMixin=a}),98);
__d("WASmaxInNewslettersPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,1,1048576);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parsePayloadMixin=a}),98);
__d("WASmaxInNewslettersWAMOSubMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"is_wamo_sub","true");return!a.success?a:d("WAResultOrError").makeResult({metaIsWamoSub:a.value})}g.parseWAMOSubMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMediaMixin",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxInNewslettersEnums","WASmaxInNewslettersMessageAssociationTypeMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;var c=d("WASmaxParseUtils").attrStringEnum(b.value,"mediatype",d("WASmaxInNewslettersEnums").ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO);if(!c.success)return c;b=d("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;var e=d("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(a);if(!e.success)return e;var f=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);a=d("WASmaxInNewslettersMessageAssociationTypeMixin").parseMessageAssociationTypeMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextMediatype:c.value,plaintextPayloadMixin:b.value},e.value,{wAMOSubMixin:f.success?f.value:null,messageAssociationTypeMixin:a.success?a.value:null}))}g.parseNewsletterMediaMixin=a}),98);
__d("WASmaxInNewslettersNewsletterTextMixin",["WAResultOrError","WASmaxInNewslettersContentTypeTextMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;var c=d("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(a);if(!c.success)return c;a=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},c.value,{wAMOSubMixin:a.success?a.value:null}))}g.parseNewsletterTextMixin=a}),98);
__d("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup",["WAResultOrError","WASmaxInNewslettersNewsletterMediaMixin","WASmaxInNewslettersNewsletterTextMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNewslettersNewsletterTextMixin").parseNewsletterTextMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:b.value});var c=d("WASmaxInNewslettersNewsletterMediaMixin").parseNewsletterMediaMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NewsletterMedia",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterText","NewsletterMedia"],[b,c])}g.parseNewsletterTextOrMediaMixinGroup=a}),98);
__d("WASmaxInNewslettersNewsletterEditMixin",["WAResultOrError","WASmaxInNewslettersAdminEditMixin","WASmaxInNewslettersNewsletterTextOrMediaMixinGroup","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersAdminEditMixin").parseAdminEditMixin(a);if(!b.success)return b;var c=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);a=d("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{wAMOSubMixin:c.success?c.value:null,newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterEditMixin=a}),98);
__d("WASmaxInNewslettersNewsletterPollCreationMixin",["WAResultOrError","WASmaxInNewslettersContentTypePollCreationMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;var c=d("WASmaxInNewslettersContentTypePollCreationMixin").parseContentTypePollCreationMixin(a);if(!c.success)return c;a=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},c.value,{wAMOSubMixin:a.success?a.value:null}))}g.parseNewsletterPollCreationMixin=a}),98);
__d("WASmaxInNewslettersNewsletterPollResultSnapshotMixin",["WAResultOrError","WASmaxInNewslettersContentTypePollResultSnapshotMixin","WASmaxInNewslettersPayloadMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInNewslettersPayloadMixin").parsePayloadMixin(b.value);if(!b.success)return b;var c=d("WASmaxInNewslettersContentTypePollResultSnapshotMixin").parseContentTypePollResultSnapshotMixin(a);if(!c.success)return c;a=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextPayloadMixin:b.value},c.value,{wAMOSubMixin:a.success?a.value:null}))}g.parseNewsletterPollResultSnapshotMixin=a}),98);
__d("WASmaxInNewslettersQuestionTypeQuestionMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"questiontype","question");return!a.success?a:d("WAResultOrError").makeResult({metaQuestiontype:a.value})}g.parseQuestionTypeQuestionMixin=a}),98);
__d("WASmaxInNewslettersNewsletterQuestionMixin",["WAResultOrError","WASmaxInNewslettersNewsletterTextOrMediaMixinGroup","WASmaxInNewslettersQuestionTypeQuestionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersQuestionTypeQuestionMixin").parseQuestionTypeQuestionMixin(a);if(!b.success)return b;a=d("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterQuestionMixin=a}),98);
__d("WASmaxInNewslettersQuestionTypeReplyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"questiontype","reply");return!a.success?a:d("WAResultOrError").makeResult({metaQuestiontype:a.value})}g.parseQuestionTypeReplyMixin=a}),98);
__d("WASmaxInNewslettersNewsletterQuestionReplyMixin",["WAResultOrError","WASmaxInNewslettersNewsletterTextOrMediaMixinGroup","WASmaxInNewslettersQuestionTypeReplyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersQuestionTypeReplyMixin").parseQuestionTypeReplyMixin(a);if(!b.success)return b;a=d("WASmaxInNewslettersNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{newsletterTextOrMediaMixinGroup:a.value}))}g.parseNewsletterQuestionReplyMixin=a}),98);
__d("WASmaxInNewslettersNewsletterRevokeMixin",["WAResultOrError","WASmaxInNewslettersAdminRevokeMixin","WASmaxInNewslettersContentTypeTextMixin","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInNewslettersAdminRevokeMixin").parseAdminRevokeMixin(a);if(!b.success)return b;var c=d("WASmaxInNewslettersContentTypeTextMixin").parseContentTypeTextMixin(a);if(!c.success)return c;a=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,{wAMOSubMixin:a.success?a.value:null}))}g.parseNewsletterRevokeMixin=a}),98);
__d("WASmaxInNewslettersNewsletterWAMOEmptyMixin",["WAResultOrError","WASmaxInNewslettersAdminEditMixin","WASmaxInNewslettersAdminRevokeMixin","WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationMixinGroup","WASmaxInNewslettersWAMOSubMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;b=d("WASmaxInNewslettersWAMOSubMixin").parseWAMOSubMixin(a);if(!b.success)return b;var c=d("WASmaxInNewslettersAdminRevokeMixin").parseAdminRevokeMixin(a),e=d("WASmaxInNewslettersAdminEditMixin").parseAdminEditMixin(a);a=d("WASmaxInNewslettersContentTypeTextOrMediaOrPollCreationMixinGroup").parseContentTypeTextOrMediaOrPollCreationMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{adminRevokeMixin:c.success?c.value:null,adminEditMixin:e.success?e.value:null,contentTypeTextOrMediaOrPollCreationMixinGroup:a.value}))}g.parseNewsletterWAMOEmptyMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryContent",["WAResultOrError","WASmaxInNewslettersNewsletterEditMixin","WASmaxInNewslettersNewsletterMediaMixin","WASmaxInNewslettersNewsletterPollCreationMixin","WASmaxInNewslettersNewsletterPollResultSnapshotMixin","WASmaxInNewslettersNewsletterQuestionMixin","WASmaxInNewslettersNewsletterQuestionReplyMixin","WASmaxInNewslettersNewsletterRevokeMixin","WASmaxInNewslettersNewsletterTextMixin","WASmaxInNewslettersNewsletterWAMOEmptyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInNewslettersNewsletterQuestionMixin").parseNewsletterQuestionMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"NewsletterQuestion",value:b.value});var c=d("WASmaxInNewslettersNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:c.value});var e=d("WASmaxInNewslettersNewsletterEditMixin").parseNewsletterEditMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"NewsletterEdit",value:e.value});var f=d("WASmaxInNewslettersNewsletterRevokeMixin").parseNewsletterRevokeMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"NewsletterRevoke",value:f.value});var g=d("WASmaxInNewslettersNewsletterTextMixin").parseNewsletterTextMixin(a);if(g.success)return d("WAResultOrError").makeResult({name:"NewsletterText",value:g.value});var h=d("WASmaxInNewslettersNewsletterMediaMixin").parseNewsletterMediaMixin(a);if(h.success)return d("WAResultOrError").makeResult({name:"NewsletterMedia",value:h.value});var i=d("WASmaxInNewslettersNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(a);if(i.success)return d("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:i.value});var j=d("WASmaxInNewslettersNewsletterPollResultSnapshotMixin").parseNewsletterPollResultSnapshotMixin(a);if(j.success)return d("WAResultOrError").makeResult({name:"NewsletterPollResultSnapshot",value:j.value});var k=d("WASmaxInNewslettersNewsletterWAMOEmptyMixin").parseNewsletterWAMOEmptyMixin(a);return k.success?d("WAResultOrError").makeResult({name:"NewsletterWAMOEmpty",value:k.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["NewsletterQuestion","NewsletterQuestionReply","NewsletterEdit","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterPollCreation","NewsletterPollResultSnapshot","NewsletterWAMOEmpty"],[b,c,e,f,g,h,i,j,k])}g.parseNewsletterMessageHistoryContent=a}),98);
__d("WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"msg_edit_t",15778656e5,41024736e5);return!a.success?a:d("WAResultOrError").makeResult({metaMsgEditT:a.value})}g.parseNewsletterMessageLastEditTimestampMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"meta");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"original_msg_t",1577865600,4102473600);return!a.success?a:d("WAResultOrError").makeResult({metaOriginalMsgT:a.value})}g.parseNewsletterMessageOriginalTimestampMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMessageHistoryContent","WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin","WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStanzaId,a,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_sender","true");if(!f.success)return f;var g=d("WASmaxInNewslettersNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(a),h=d("WASmaxInNewslettersNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(a);a=d("WASmaxInNewslettersNewsletterMessageHistoryContent").parseNewsletterMessageHistoryContent(a);return d("WAResultOrError").makeResult({id:b.value,serverId:c.value,t:e.value,isSender:f.value,newsletterMessageOriginalTimestampMixin:g.success?g.value:null,newsletterMessageLastEditTimestampMixin:h.success?h.value:null,newsletterMessageHistoryContent:a.success?a.value:null})}g.parseNewsletterMessageHistoryMixin=a}),98);
__d("WASmaxInNewslettersNewsletterPollVotesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"vote");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"count",1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({count:b.value,elementValue:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"votes");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"vote",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({votesVote:a.value})}g.parseNewsletterPollVotesVotesVote=h;g.parseNewsletterPollVotesMixin=a}),98);
__d("WASmaxInNewslettersNewsletterReactionsMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"reaction");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"code");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"count",1,void 0);return!a.success?a:d("WAResultOrError").makeResult({code:b.value,count:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reactions");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"reaction",0,1e3,h);return!a.success?a:d("WAResultOrError").makeResult({reactionsReaction:a.value})}g.parseNewsletterReactionsReactionsReaction=h;g.parseNewsletterReactionsMixin=a}),98);
__d("WASmaxInNewslettersNewsletterResponsesCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"responses_count");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({responsesCountCount:a.value})}g.parseNewsletterResponsesCountMixin=a}),98);
__d("WASmaxInNewslettersNewsletterViewsCountMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"views_count");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"count",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({viewsCountCount:a.value})}g.parseNewsletterViewsCountMixin=a}),98);
__d("WASmaxInNewslettersReceiverContentTypeMediaRCATMixin",["WAResultOrError","WASmaxInNewslettersContentTypeMediaMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"plaintext");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a,"rcat");if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,b.value,"mediatype","url");if(!b.success)return b;c=d("WASmaxParseUtils").contentBytes(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersContentTypeMediaMixin").parseContentTypeMediaMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({plaintextMediatype:b.value,rcatElementValue:c.value},a.value))}g.parseReceiverContentTypeMediaRCATMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMessageHistoryMixin","WASmaxInNewslettersNewsletterPollVotesMixin","WASmaxInNewslettersNewsletterReactionsMixin","WASmaxInNewslettersNewsletterResponsesCountMixin","WASmaxInNewslettersNewsletterViewsCountMixin","WASmaxInNewslettersReceiverContentTypeMediaRCATMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersNewsletterMessageHistoryMixin").parseNewsletterMessageHistoryMixin(a);if(!b.success)return b;var c=d("WASmaxInNewslettersNewsletterReactionsMixin").parseNewsletterReactionsMixin(a),e=d("WASmaxInNewslettersNewsletterViewsCountMixin").parseNewsletterViewsCountMixin(a),f=d("WASmaxInNewslettersNewsletterPollVotesMixin").parseNewsletterPollVotesMixin(a),g=d("WASmaxInNewslettersNewsletterResponsesCountMixin").parseNewsletterResponsesCountMixin(a);a=d("WASmaxInNewslettersReceiverContentTypeMediaRCATMixin").parseReceiverContentTypeMediaRCATMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{newsletterReactionsMixin:c.success?c.value:null,newsletterViewsCountMixin:e.success?e.value:null,newsletterPollVotesMixin:f.success?f.value:null,newsletterResponsesCountMixin:g.success?g.value:null,receiverContentTypeMediaRCATMixin:a.success?a.value:null}))}g.parseNewsletterMessageHistoryWithAddOnsMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersNewsletterMessageHistoryWithAddOnsMixin").parseNewsletterMessageHistoryWithAddOnsMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"messages");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrNewsletterJid,a,"jid");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!c.success)return c;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"message",0,300,h);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,t:c.value,message:a.value})}g.parseNewsletterMessageResponsePayloadMessage=h;g.parseNewsletterMessageResponsePayloadMixin=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterMessageResponsePayloadMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"message_updates");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(c.value,"messages");if(!c.success)return c;c=d("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin").parseNewsletterMessageResponsePayloadMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({messageUpdatesMessagesNewsletterMessageResponsePayloadMixin:c.value},a.value))}g.parseGetNewsletterMessageUpdatesResponseSuccess=a}),98);
__d("WASmaxInNewslettersIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-allowed");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",405);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNotAllowedMixin=a}),98);
__d("WASmaxInNewslettersNotAllowedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorNotAllowedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorNotAllowedMixin").parseIQErrorNotAllowedMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorNotAllowedMixin:c.value},a.value))}g.parseNotAllowedIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersNotAllowedIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersSuspendedIQErrorResponseMixin","WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(a,b);if(c.success)return d("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:c.value});var e=d("WASmaxInNewslettersUnavailableForLegalReasonsResponseMixin").parseUnavailableForLegalReasonsResponseMixin(a,b);if(e.success)return d("WAResultOrError").makeResult({name:"UnavailableForLegalReasonsResponse",value:e.value});var f=d("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(a,b);if(f.success)return d("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:f.value});var g=d("WASmaxInNewslettersSuspendedIQErrorResponseMixin").parseSuspendedIQErrorResponseMixin(a,b);if(g.success)return d("WAResultOrError").makeResult({name:"SuspendedIQErrorResponse",value:g.value});var h=d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(a,b);if(h.success)return d("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:h.value});b=d("WASmaxInNewslettersNotAllowedIQErrorResponseMixin").parseNotAllowedIQErrorResponseMixin(a,b);return b.success?d("WAResultOrError").makeResult({name:"NotAllowedIQErrorResponse",value:b.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BadRequestIQErrorResponse","UnavailableForLegalReasonsResponse","ItemNotFoundIQErrorResponse","SuspendedIQErrorResponse","RateLimitedIQErrorResponse","NotAllowedIQErrorResponse"],[c,e,f,g,h,b])}g.parseGetNewsletterMessagesClientErrors=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseClientError",["WAResultOrError","WASmaxInNewslettersGetNewsletterMessagesClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersGetNewsletterMessagesClientErrors").parseGetNewsletterMessagesClientErrors(a,b);return!c.success?c:d("WAResultOrError").makeResult({getNewsletterMessagesClientErrors:c.value})}g.parseGetNewsletterMessagesResponseClientError=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseServerError",["WAResultOrError","WASmaxInNewslettersIQErrorInternalServerErrorMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;c=d("WASmaxInNewslettersIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({from:b.value,type:a.value,errorIQErrorInternalServerErrorMixin:c.value})}g.parseGetNewsletterMessagesResponseServerError=a}),98);
__d("WASmaxInNewslettersGetNewsletterMessagesResponseSuccess",["WAResultOrError","WASmaxInNewslettersNewsletterMessageResponsePayloadMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"messages");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseJid").literalJid(d("WASmaxParseJid").attrDomainJid,a,"from","s.whatsapp.net");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!a.success)return a;c=d("WASmaxInNewslettersNewsletterMessageResponsePayloadMixin").parseNewsletterMessageResponsePayloadMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({from:b.value,type:a.value,messagesNewsletterMessageResponsePayloadMixin:c.value})}g.parseGetNewsletterMessagesResponseSuccess=a}),98);
__d("WASmaxInNewslettersIQErrorNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-authorized");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",401);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNotAuthorizedMixin=a}),98);
__d("WASmaxInNewslettersUnauthorizedIQErrorResponseMixin",["WAResultOrError","WASmaxInNewslettersIQErrorNotAuthorizedMixin","WASmaxInNewslettersIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInNewslettersIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(c.value);if(!c.success)return c;a=d("WASmaxInNewslettersIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorNotAuthorizedMixin:c.value},a.value))}g.parseUnauthorizedIQErrorResponseMixin=a}),98);
__d("WASmaxInNewslettersMyAddonsClientErrors",["WAResultOrError","WASmaxInNewslettersBadRequestIQErrorResponseMixin","WASmaxInNewslettersItemNotFoundIQErrorResponseMixin","WASmaxInNewslettersRateLimitedIQErrorResponseMixin","WASmaxInNewslettersUnauthorizedIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxInNewslettersBadRequestIQErrorResponseMixin").parseBadRequestIQErrorResponseMixin(a,b);if(c.success)return d("WAResultOrError").makeResult({name:"BadRequestIQErrorResponse",value:c.value});var e=d("WASmaxInNewslettersUnauthorizedIQErrorResponseMixin").parseUnauthorizedIQErrorResponseMixin(a,b);if(e.success)return d("WAResultOrError").makeResult({name:"UnauthorizedIQErrorResponse",value:e.value});var f=d("WASmaxInNewslettersItemNotFoundIQErrorResponseMixin").parseItemNotFoundIQErrorResponseMixin(a,b);if(f.success)return d("WAResultOrError").makeResult({name:"ItemNotFoundIQErrorResponse",value:f.value});b=d("WASmaxInNewslettersRateLimitedIQErrorResponseMixin").parseRateLimitedIQErrorResponseMixin(a,b);return b.success?d("WAResultOrError").makeResult({name:"RateLimitedIQErrorResponse",value:b.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["BadRequestIQErrorResponse","UnauthorizedIQErrorResponse","ItemNotFoundIQErrorResponse","RateLimitedIQErrorResponse"],[c,e,f,b])}g.parseMyAddonsClientErrors=a}),98);
__d("WASmaxInNewslettersMyAddOnsResponseClientError",["WAResultOrError","WASmaxInNewslettersMyAddonsClientErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersMyAddonsClientErrors").parseMyAddonsClientErrors(a,b);return!c.success?c:d("WAResultOrError").makeResult({myAddonsClientErrors:c.value})}g.parseMyAddOnsResponseClientError=a}),98);
__d("WASmaxInNewslettersMyAddOnsResponseServerError",["WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInNewslettersInternalServerErrorIQErrorResponseMixin").parseInternalServerErrorIQErrorResponseMixin(a,b);return!c.success?c:c}g.parseMyAddOnsResponseServerError=a}),98);
__d("WASmaxInNewslettersNewsletterMyPollVoteMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"vote");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"votes");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(b.value,"t",0,void 0);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(b.value,"vote",0,1e3,h);return!b.success?b:d("WAResultOrError").makeResult({votesT:a.value,votesVote:b.value})}g.parseNewsletterMyPollVoteVotesVote=h;g.parseNewsletterMyPollVoteMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMyReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"reaction");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"code");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"t",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({reactionCode:a.value,reactionT:b.value})}g.parseNewsletterMyReactionMixin=a}),98);
__d("WASmaxInNewslettersNewsletterMessageMyAddOnsMixin",["WAResultOrError","WASmaxInNewslettersNewsletterMyPollVoteMixin","WASmaxInNewslettersNewsletterMyReactionMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"server_id",99,2147476647);if(!b.success)return b;var c=d("WASmaxInNewslettersNewsletterMyReactionMixin").parseNewsletterMyReactionMixin(a);a=d("WASmaxInNewslettersNewsletterMyPollVoteMixin").parseNewsletterMyPollVoteMixin(a);return d("WAResultOrError").makeResult({serverId:b.value,newsletterMyReactionMixin:c.success?c.value:null,newsletterMyPollVoteMixin:a.success?a.value:null})}g.parseNewsletterMessageMyAddOnsMixin=a}),98);
__d("WASmaxInNewslettersMyAddOnsResponseSuccess",["WAResultOrError","WASmaxInNewslettersIQResultResponseMixin","WASmaxInNewslettersNewsletterMessageMyAddOnsMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"message");if(!b.success)return b;b=d("WASmaxInNewslettersNewsletterMessageMyAddOnsMixin").parseNewsletterMessageMyAddOnsMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"messages");if(!b.success)return b;b=d("WASmaxParseJid").attrNewsletterJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"message",0,5e3,h);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,message:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"my_addons");if(!c.success)return c;a=d("WASmaxInNewslettersIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"messages",0,5e3,i);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{myAddonsMessages:b.value}))}g.parseMyAddOnsResponseSuccessMyAddonsMessagesMessage=h;g.parseMyAddOnsResponseSuccessMyAddonsMessages=i;g.parseMyAddOnsResponseSuccess=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetch:b.value}))}g.parseFetchMissingPreKeysResponseRequestError=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchMissingPreKeysResponseServerError=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"code",500,599);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchMissingPreKeysUserErrorFallbackMixin=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,b.value,"code",500);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchMissingPreKeysUserErrorMixin=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysEnums","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",0,99);if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_cloud_api","true");if(!e.success)return e;var f=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!f.success)return f;var g=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a),h=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!h.success)return h;var i=d("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(a),j=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!j.success)return j;a=d("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value,t:c.value,isCloudApi:e.value},f.value,{keyTypeMixin:g.success?g.value:null},h.value,{preKeyMixin:i.success?i.value:null},j.value,{deviceIdentityMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"jid",d("WASmaxInPreKeysEnums").USERJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",1,100,h);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,device:a.value})}g.parseFetchMissingPreKeysUserSuccessDevice=h;g.parseFetchMissingPreKeysUserSuccessMixin=a}),98);
__d("WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin","WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin","WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysFetchMissingPreKeysUserSuccessMixin").parseFetchMissingPreKeysUserSuccessMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserSuccess",value:b.value});var c=d("WASmaxInPreKeysFetchMissingPreKeysUserErrorMixin").parseFetchMissingPreKeysUserErrorMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserError",value:c.value});var e=d("WASmaxInPreKeysFetchMissingPreKeysUserErrorFallbackMixin").parseFetchMissingPreKeysUserErrorFallbackMixin(a);return e.success?d("WAResultOrError").makeResult({name:"FetchMissingPreKeysUserErrorFallback",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserSuccess","UserError","UserErrorFallback"],[b,c,e])}g.parseUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup=a}),98);
__d("WASmaxInPreKeysFetchMissingPreKeysResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysResponsePaddingMixin","WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"jid",d("WASmaxInPreKeysEnums").USERJID_USERJID);if(!b.success)return b;a=d("WASmaxInPreKeysUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup").parseUserFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,userFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;b=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!b.success)return b;a=d("WASmaxInPreKeysResponsePaddingMixin").parseResponsePaddingMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,1e5,h);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{responsePaddingMixin:a.success?a.value:null,listUser:c.value}))}g.parseFetchMissingPreKeysResponseSuccessListUser=h;g.parseFetchMissingPreKeysResponseSuccess=a}),98);
__d("WASmaxInPrivacyPnJidMixin",["WAResultOrError","WASmaxParseJid"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseJid").attrUserJid(a,"pn_jid");return!a.success?a:d("WAResultOrError").makeResult({pnJid:a.value})}g.parsePnJidMixin=a}),98);
__d("WASmaxInPrivacyUsernameMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"username");return!a.success?a:d("WAResultOrError").makeResult({username:a.value})}g.parseUsernameMixin=a}),98);
__d("WASmaxInPrivacyContactListIds",["WAResultOrError","WASmaxInPrivacyPnJidMixin","WASmaxInPrivacyUsernameMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPrivacyUsernameMixin").parseUsernameMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"Username",value:b.value});var c=d("WASmaxInPrivacyPnJidMixin").parsePnJidMixin(a);return c.success?d("WAResultOrError").makeResult({name:"PnJid",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["Username","PnJid"],[b,c])}g.parseContactListIds=a}),98);
__d("WASmaxInPrivacyEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={all:"all",contact_blacklist:"contact_blacklist",contacts:"contacts",none:"none"};b={all:"all",contacts:"contacts"};c={all:"all",contacts:"contacts",known:"known"};e={all:"all",contacts:"contacts",none:"none"};f={all:"all",match_last_seen:"match_last_seen"};var h={all:"all",none:"none"},i={calladd:"calladd",defense:"defense",dependentaccountmessages:"dependentaccountmessages",groupadd:"groupadd",groupcreation:"groupcreation",last:"last",linked_profiles:"linked_profiles",messages:"messages",online:"online",pix:"pix",profile:"profile",readreceipts:"readreceipts",status:"status",stickers:"stickers"},j={contacts:"contacts",none:"none"},k={off:"off",on_standard:"on_standard"},l={validators:[(d=d("WAJids")).validateDomainJid,d.validateUserJid],typeName:"DomainJid|UserJid"};d={validators:[d.validateUserJid,d.validateUserJid],typeName:"UserJid|UserJid"};g.ENUM_ALL_CONTACTBLACKLIST_CONTACTS_NONE=a;g.ENUM_ALL_CONTACTS=b;g.ENUM_ALL_CONTACTS_KNOWN=c;g.ENUM_ALL_CONTACTS_NONE=e;g.ENUM_ALL_MATCHLASTSEEN=f;g.ENUM_ALL_NONE=h;g.ENUM_CALLADD_DEFENSE_DEPENDENTACCOUNTMESSAGES_GROUPADD_GROUPCREATION_LAST_LINKEDPROFILES_MESSAGES_ONLINE_PIX_PROFILE_READRECEIPTS_STATUS_STICKERS=i;g.ENUM_CONTACTS_NONE=j;g.ENUM_OFF_ONSTANDARD=k;g.DOMAINJID_USERJID=l;g.USERJID_USERJID=d}),98);
__d("WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin",["WAResultOrError","WASmaxInPrivacyEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInPrivacyEnums").DOMAINJID_USERJID);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!b.success?b:d("WAResultOrError").makeResult({from:c.value,type:b.value})}g.parseDeprecatedIQErrorResponseOptionalFromMixin=a}),98);
__d("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin",["WAResultOrError","WASmaxInPrivacyEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInPrivacyEnums").DOMAINJID_USERJID);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!b.success?b:d("WAResultOrError").makeResult({from:c.value,type:b.value})}g.parseDeprecatedIQResultResponseOptionalFromMixin=a}),98);
__d("WASmaxInPrivacyIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInPrivacyIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","feature-not-implemented");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",501);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFeatureNotImplementedMixin=a}),98);
__d("WASmaxInPrivacyIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInPrivacyIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","rate-overlimit");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",429);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRateOverlimitMixin=a}),98);
__d("WASmaxInPrivacyIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInPrivacyGetPrivacyListError",["WAResultOrError","WASmaxInPrivacyIQErrorBadRequestMixin","WASmaxInPrivacyIQErrorFeatureNotImplementedMixin","WASmaxInPrivacyIQErrorInternalServerErrorMixin","WASmaxInPrivacyIQErrorRateOverlimitMixin","WASmaxInPrivacyIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPrivacyIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInPrivacyIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:c.value});var e=d("WASmaxInPrivacyIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value});var f=d("WASmaxInPrivacyIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);if(f.success)return d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:f.value});var g=d("WASmaxInPrivacyIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);return g.success?d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:g.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable","IQErrorRateOverlimit","IQErrorInternalServerError"],[b,c,e,f,g])}g.parseGetPrivacyListError=a}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseError",["WAResultOrError","WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin","WASmaxInPrivacyGetPrivacyListError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPrivacyDeprecatedIQErrorResponseOptionalFromMixin").parseDeprecatedIQErrorResponseOptionalFromMixin(a,b);if(!a.success)return a;b=d("WASmaxInPrivacyGetPrivacyListError").parseGetPrivacyListError(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorGetPrivacyListError:b.value}))}g.parseGetContactBlacklistResponseError=a}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseSuccess",["WAResultOrError","WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrLidUserJid,a,"lid");return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,lid:a.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"list");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"user",0,64e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,user:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!c.success)return c;c=d("WASmaxParseUtils").optionalChildWithTag(c.value,"list",i);if(!c.success)return c;a=d("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin").parseDeprecatedIQResultResponseOptionalFromMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{privacyList:c.value}))}g.parseGetContactBlacklistResponseSuccessPrivacyListUser=h;g.parseGetContactBlacklistResponseSuccessPrivacyList=i;g.parseGetContactBlacklistResponseSuccess=a}),98);
__d("WASmaxInPrivacyPrivacyContactListIdentifierMixin",["WAResultOrError","WASmaxInPrivacyContactListIds"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxInPrivacyContactListIds").parseContactListIds(a);return!a.success?a:d("WAResultOrError").makeResult({contactListIds:a.value})}g.parsePrivacyContactListIdentifierMixin=a}),98);
__d("WASmaxInPrivacyGetContactBlacklistResponseSuccessLID",["WAResultOrError","WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin","WASmaxInPrivacyPrivacyContactListIdentifierMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrLidUserJid(a,"jid");if(!b.success)return b;a=d("WASmaxInPrivacyPrivacyContactListIdentifierMixin").parsePrivacyContactListIdentifierMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({jid:b.value},a.value))}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"list");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"dhash");if(!b.success)return b;a=d("WASmaxParseUtils").mapChildrenWithTag(a,"user",0,64e3,h);return!a.success?a:d("WAResultOrError").makeResult({dhash:b.value,user:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"privacy");if(!c.success)return c;var e=d("WASmaxParseUtils").optionalChildWithTag(c.value,"list",i);if(!e.success)return e;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,c.value,"addressing_mode","lid");if(!c.success)return c;a=d("WASmaxInPrivacyDeprecatedIQResultResponseOptionalFromMixin").parseDeprecatedIQResultResponseOptionalFromMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({privacyAddressingMode:c.value},a.value,{privacyList:e.value}))}g.parseGetContactBlacklistResponseSuccessLIDPrivacyListUser=h;g.parseGetContactBlacklistResponseSuccessLIDPrivacyList=i;g.parseGetContactBlacklistResponseSuccessLID=a}),98);
__d("WASmaxInPsaIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInPsaIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","rate-overlimit");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",429);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRateOverlimitMixin=a}),98);
__d("WASmaxInPsaIQErrorRequestTimeoutMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","request-timeout");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",408);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRequestTimeoutMixin=a}),98);
__d("WASmaxInPsaIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInPsaChatBlockError",["WAResultOrError","WASmaxInPsaIQErrorInternalServerErrorMixin","WASmaxInPsaIQErrorRateOverlimitMixin","WASmaxInPsaIQErrorRequestTimeoutMixin","WASmaxInPsaIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPsaIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInPsaIQErrorRequestTimeoutMixin").parseIQErrorRequestTimeoutMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorRequestTimeout",value:c.value});var e=d("WASmaxInPsaIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:e.value});var f=d("WASmaxInPsaIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);return f.success?d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorRequestTimeout","IQErrorServiceUnavailable","IQErrorRateOverlimit"],[b,c,e,f])}g.parseChatBlockError=a}),98);
__d("WASmaxInPsaIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInPsaChatBlockGetResponseServerError",["WAResultOrError","WASmaxInPsaChatBlockError","WASmaxInPsaIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPsaIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPsaChatBlockError").parseChatBlockError(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorChatBlockError:b.value}))}g.parseChatBlockGetResponseServerError=a}),98);
__d("WASmaxInPsaEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={blocked:"blocked",unblocked:"unblocked"};b={image:"image",video:"video"};c={validators:[d("WAJids").validateStatusJid,d("WAJids").validateUserJid],typeName:"StatusJid|UserJid"};g.ENUM_BLOCKED_UNBLOCKED=a;g.ENUM_IMAGE_VIDEO=b;g.STATUSJID_USERJID=c}),98);
__d("WASmaxInPsaIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInPsaChatBlockGetResponseSuccess",["WAResultOrError","WASmaxInPsaEnums","WASmaxInPsaIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"blocking");if(!c.success)return c;c=d("WASmaxParseUtils").attrStringEnum(c.value,"status",d("WASmaxInPsaEnums").ENUM_BLOCKED_UNBLOCKED);if(!c.success)return c;a=d("WASmaxInPsaIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({blockingStatus:c.value},a.value))}g.parseChatBlockGetResponseSuccess=a}),98);
__d("WASmaxInPsaChatBlockSetResponseServerError",["WAResultOrError","WASmaxInPsaChatBlockError","WASmaxInPsaIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPsaIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPsaChatBlockError").parseChatBlockError(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorChatBlockError:b.value}))}g.parseChatBlockSetResponseServerError=a}),98);
__d("WASmaxInPsaChatBlockSetResponseSuccess",["WAResultOrError","WASmaxInPsaEnums","WASmaxInPsaIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"blocking");if(!c.success)return c;c=d("WASmaxParseUtils").attrStringEnum(c.value,"status",d("WASmaxInPsaEnums").ENUM_BLOCKED_UNBLOCKED);if(!c.success)return c;a=d("WASmaxInPsaIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({blockingStatus:c.value},a.value))}g.parseChatBlockSetResponseSuccess=a}),98);
__d("WASmaxInSpamGroupReportResponseError",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamSpamIqErrors","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;c=d("WASmaxInSpamSpamIqErrors").parseSpamIqErrors(c.value);return!c.success?c:d("WAResultOrError").makeResult({from:b.value,type:a.value,errorSpamIqErrors:c.value})}g.parseGroupReportResponseError=a}),98);
__d("WASmaxInSpamGroupReportResponseSuccess",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamReportIdMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!b.success)return b;a=d("WASmaxInSpamReportIdMixin").parseReportIdMixin(a);return d("WAResultOrError").makeResult({from:c.value,type:b.value,reportIdMixin:a.success?a.value:null})}g.parseGroupReportResponseSuccess=a}),98);
__d("WASmaxInSpamNewsletterReportResponseError",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamSpamIqErrors","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;c=d("WASmaxInSpamSpamIqErrors").parseSpamIqErrors(c.value);return!c.success?c:d("WAResultOrError").makeResult({from:b.value,type:a.value,errorSpamIqErrors:c.value})}g.parseNewsletterReportResponseError=a}),98);
__d("WASmaxInSpamNewsletterReportResponseSuccess",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamReportIdMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!b.success)return b;a=d("WASmaxInSpamReportIdMixin").parseReportIdMixin(a);return d("WAResultOrError").makeResult({from:c.value,type:b.value,reportIdMixin:a.success?a.value:null})}g.parseNewsletterReportResponseSuccess=a}),98);
__d("WASmaxInSpamStatusReportResponseError",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamSpamIqErrors","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");if(!a.success)return a;c=d("WASmaxInSpamSpamIqErrors").parseSpamIqErrors(c.value);return!c.success?c:d("WAResultOrError").makeResult({from:b.value,type:a.value,errorSpamIqErrors:c.value})}g.parseStatusReportResponseError=a}),98);
__d("WASmaxInSpamStatusReportResponseSuccess",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamReportIdMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"from",d("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!b.success)return b;a=d("WASmaxInSpamReportIdMixin").parseReportIdMixin(a);return d("WAResultOrError").makeResult({from:c.value,type:b.value,reportIdMixin:a.success?a.value:null})}g.parseStatusReportResponseSuccess=a}),98);
__d("WASmaxOutMessagePublishNewsletterPollVoteMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollVoteMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.voteElementValue;a=d("WASmaxJsx").smax("vote",null,a);return a}function i(a){var b=a.voteArgs;b=d("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("votes",null,d("WASmaxChildren").REPEATED_CHILD(h,b,0,1e3))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeNewsletterPollVoteVotesVote=h;g.mergeNewsletterPollVoteMixin=a}),98);
__d("WASmaxOutMessagePublishPayloadMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.plaintextElementValue;a=d("WASmaxJsx").smax("plaintext",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePayloadMixin=a}),98);
__d("WASmaxOutMessagePublishQuestionTypeResponseMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{questiontype:"response"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQuestionTypeResponseMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishQuestionTypeResponseMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.payloadMixinArgs;a=d("WASmaxOutMessagePublishQuestionTypeResponseMixin").mergeQuestionTypeResponseMixin(d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",null),a))));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterQuestionResponsePublishMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterReactionMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeReactionMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.reactionCode;a=d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("reaction",{code:d("WAWap").CUSTOM_STRING(a)})));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterReactionMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterReactionRevokeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishRevokeMixin"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(d("WASmaxOutMessagePublishRevokeMixin").mergeRevokeMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("reaction",null))));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterReactionRevokeMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterPollVoteMixin","WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin","WASmaxOutMessagePublishNewsletterReactionMixin","WASmaxOutMessagePublishNewsletterReactionRevokeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterQuestionResponsePublish)return d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishMixin").mergeNewsletterQuestionResponsePublishMixin(a,b.newsletterQuestionResponsePublish);if(b.newsletterReaction)return d("WASmaxOutMessagePublishNewsletterReactionMixin").mergeNewsletterReactionMixin(a,b.newsletterReaction);if(b.isNewsletterReactionRevoke)return d("WASmaxOutMessagePublishNewsletterReactionRevokeMixin").mergeNewsletterReactionRevokeMixin(a);if(b.newsletterPollVote)return d("WASmaxOutMessagePublishNewsletterPollVoteMixin").mergeNewsletterPollVoteMixin(a,b.newsletterPollVote);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup=a}),98);
__d("WASmaxOutMessagePublishNewsletterClientAndServerIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageId,c=a.messageServerId;a=a.newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs;b=d("WASmaxOutMessagePublishNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup").mergeNewsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroup(d("WASmaxJsx").smax("message",{id:d("WAWap").STANZA_ID(b),server_id:d("WAWap").INT(c)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterClientAndServerIDMixin=a}),98);
__d("WASmaxOutMessagePublishAdminEditMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"3"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAdminEditMixin=a}),98);
__d("WASmaxOutMessagePublishWAMOSubMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{is_wamo_sub:"true"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeWAMOSubMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterMediaMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishMessageAssociationTypeMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub,c=a.messageAssociationTypeMixinArgs,e=a.plaintextMediatype;a=a.payloadMixinArgs;e=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishMessageAssociationTypeMixin").mergeMessageAssociationTypeMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",{mediatype:d("WAWap").CUSTOM_STRING(e)}),a))),b),c);return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMediaMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterTextMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub;a=a.payloadMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",null),a))),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterTextMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterText)return d("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(a,b.newsletterText);if(b.newsletterMedia)return d("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(a,b.newsletterMedia);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeNewsletterTextOrMediaMixinGroup=a}),98);
__d("WASmaxOutMessagePublishQuestionTypeReplyMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{questiontype:"reply"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQuestionTypeReplyMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup","WASmaxOutMessagePublishQuestionTypeReplyMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub;a=a.newsletterTextOrMediaMixinGroupArgs;b=d("WASmaxOutMessagePublishNewsletterTextOrMediaMixinGroup").mergeNewsletterTextOrMediaMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishQuestionTypeReplyMixin").mergeQuestionTypeReplyMixin(d("WASmaxJsx").smax("message",null)),b),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterQuestionReplyMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaMixin","WASmaxOutMessagePublishNewsletterQuestionReplyMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterQuestionReply)return d("WASmaxOutMessagePublishNewsletterQuestionReplyMixin").mergeNewsletterQuestionReplyMixin(a,b.newsletterQuestionReply);if(b.newsletterText)return d("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(a,b.newsletterText);if(b.newsletterMedia)return d("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(a,b.newsletterMedia);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeNewsletterQuestionReplyOrTextOrMediaMixinGroup=a}),98);
__d("WASmaxOutMessagePublishNewsletterEditMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAdminEditMixin","WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub;a=a.newsletterQuestionReplyOrTextOrMediaMixinGroupArgs;b=d("WASmaxOutMessagePublishNewsletterQuestionReplyOrTextOrMediaMixinGroup").mergeNewsletterQuestionReplyOrTextOrMediaMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishAdminEditMixin").mergeAdminEditMixin(d("WASmaxJsx").smax("message",null)),b),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterEditMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterMediaPublishMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterMediaMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageMediaId;b=d("WASmaxOutMessagePublishNewsletterMediaMixin").mergeNewsletterMediaMixin(d("WASmaxJsx").smax("message",{media_id:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMediaPublishMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterPollCreationMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub,c=a.payloadMixinArgs;c=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",null),c)),a),b);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterPollCreationMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePollResultSnapshotMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub;a=a.payloadMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin").mergeContentTypePollResultSnapshotMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",null),a))),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterPollResultSnapshotMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterMediaPublishMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterText)return d("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(a,b.newsletterText);if(b.newsletterMediaPublish)return d("WASmaxOutMessagePublishNewsletterMediaPublishMixin").mergeNewsletterMediaPublishMixin(a,b.newsletterMediaPublish);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeNewsletterTextOrMediaPublishMixinGroup=a}),98);
__d("WASmaxOutMessagePublishQuestionTypeQuestionMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{questiontype:"question"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQuestionTypeQuestionMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionPublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup","WASmaxOutMessagePublishQuestionTypeQuestionMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub;a=a.newsletterTextOrMediaPublishMixinGroupArgs;b=d("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup").mergeNewsletterTextOrMediaPublishMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishQuestionTypeQuestionMixin").mergeQuestionTypeQuestionMixin(d("WASmaxJsx").smax("message",null)),b),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterQuestionPublishMixin=a}),98);
__d("WASmaxOutMessagePublishParentAndResponseServerIDMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.metaParentServerId;a=a.metaResponseServerId;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{parent_server_id:d("WAWap").INT(b),response_server_id:d("WAWap").CUSTOM_STRING(a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeParentAndResponseServerIDMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup","WASmaxOutMessagePublishParentAndResponseServerIDMixin","WASmaxOutMessagePublishQuestionTypeReplyMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub,c=a.newsletterTextOrMediaPublishMixinGroupArgs;a=d("WASmaxOutMessagePublishNewsletterTextOrMediaPublishMixinGroup").mergeNewsletterTextOrMediaPublishMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishParentAndResponseServerIDMixin").mergeParentAndResponseServerIDMixin(d("WASmaxOutMessagePublishQuestionTypeReplyMixin").mergeQuestionTypeReplyMixin(d("WASmaxJsx").smax("message",null)),a),b),c);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterQuestionReplyPublishMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeQuizCreationMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaContenttype;a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"quiz_creation",contenttype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeQuizCreationMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterQuizCreationMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeQuizCreationMixin","WASmaxOutMessagePublishPayloadMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasWAMOSub,c=a.payloadMixinArgs;c=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypeQuizCreationMixin").mergeContentTypeQuizCreationMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishPayloadMixin").mergePayloadMixin(d("WASmaxJsx").smax("plaintext",null),c)),a),b);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterQuizCreationMixin=a}),98);
__d("WASmaxOutMessagePublishAdminRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"8"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAdminRevokeMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterRevokeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAdminRevokeMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishWAMOSubMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasWAMOSub;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWAMOSubMixin").mergeWAMOSubMixin,d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(d("WASmaxOutMessagePublishAdminRevokeMixin").mergeAdminRevokeMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("plaintext",null)))),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterRevokeMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterClientIdContent",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterEditMixin","WASmaxOutMessagePublishNewsletterMediaPublishMixin","WASmaxOutMessagePublishNewsletterPollCreationMixin","WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin","WASmaxOutMessagePublishNewsletterQuestionPublishMixin","WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin","WASmaxOutMessagePublishNewsletterQuizCreationMixin","WASmaxOutMessagePublishNewsletterRevokeMixin","WASmaxOutMessagePublishNewsletterTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterEdit)return d("WASmaxOutMessagePublishNewsletterEditMixin").mergeNewsletterEditMixin(a,b.newsletterEdit);if(b.newsletterQuestionPublish)return d("WASmaxOutMessagePublishNewsletterQuestionPublishMixin").mergeNewsletterQuestionPublishMixin(a,b.newsletterQuestionPublish);if(b.newsletterQuestionReplyPublish)return d("WASmaxOutMessagePublishNewsletterQuestionReplyPublishMixin").mergeNewsletterQuestionReplyPublishMixin(a,b.newsletterQuestionReplyPublish);if(b.newsletterText)return d("WASmaxOutMessagePublishNewsletterTextMixin").mergeNewsletterTextMixin(a,b.newsletterText);if(b.newsletterMediaPublish)return d("WASmaxOutMessagePublishNewsletterMediaPublishMixin").mergeNewsletterMediaPublishMixin(a,b.newsletterMediaPublish);if(b.newsletterRevoke)return d("WASmaxOutMessagePublishNewsletterRevokeMixin").mergeNewsletterRevokeMixin(a,b.newsletterRevoke);if(b.newsletterPollCreation)return d("WASmaxOutMessagePublishNewsletterPollCreationMixin").mergeNewsletterPollCreationMixin(a,b.newsletterPollCreation);if(b.newsletterPollResultSnapshot)return d("WASmaxOutMessagePublishNewsletterPollResultSnapshotMixin").mergeNewsletterPollResultSnapshotMixin(a,b.newsletterPollResultSnapshot);if(b.newsletterQuizCreation)return d("WASmaxOutMessagePublishNewsletterQuizCreationMixin").mergeNewsletterQuizCreationMixin(a,b.newsletterQuizCreation);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeNewsletterClientIdContent=a}),98);
__d("WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.plaintextContentId;a=d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("plaintext",{mediatype:"url",content_id:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderContentTypeMediaRCATMixin=a}),98);
__d("WASmaxOutMessagePublishNewsletterClientIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishMsgMetaOriginMixin","WASmaxOutMessagePublishNewsletterClientIdContent","WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageId,c=a.msgMetaOriginMixinArgs,e=a.senderContentTypeMediaRCATMixinArgs;a=a.newsletterClientIdContentArgs;b=d("WASmaxOutMessagePublishNewsletterClientIdContent").mergeNewsletterClientIdContent(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentTypeMediaRCATMixin").mergeSenderContentTypeMediaRCATMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishMsgMetaOriginMixin").mergeMsgMetaOriginMixin,d("WASmaxJsx").smax("message",{id:d("WAWap").STANZA_ID(b)}),c),e),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterClientIDMixin=a}),98);
__d("WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishNewsletterClientAndServerIDMixin","WASmaxOutMessagePublishNewsletterClientIDMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.newsletterClientAndServerID)return d("WASmaxOutMessagePublishNewsletterClientAndServerIDMixin").mergeNewsletterClientAndServerIDMixin(a,b.newsletterClientAndServerID);if(b.newsletterClientID)return d("WASmaxOutMessagePublishNewsletterClientIDMixin").mergeNewsletterClientIDMixin(a,b.newsletterClientID);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeClientNewsletterAndServerOrNewsletterIDMixinGroup=a}),98);
__d("WASmaxOutMessagePublishNewsletterRequest",["WASmaxJsx","WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageTo;a=a.clientNewsletterAndServerOrNewsletterIDMixinGroupArgs;b=d("WASmaxOutMessagePublishClientNewsletterAndServerOrNewsletterIDMixinGroup").mergeClientNewsletterAndServerOrNewsletterIDMixinGroup(d("WASmaxJsx").smax("message",{to:d("WAWap").JID(b)}),a);return b}g.makeNewsletterRequest=a}),98);
__d("WASmaxMessagePublishNewsletterRPC",["WAComms","WASmaxInMessagePublishNewsletterResponseNegative","WASmaxInMessagePublishNewsletterResponseSuccess","WASmaxOutMessagePublishNewsletterRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutMessagePublishNewsletterRequest").makeNewsletterRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInMessagePublishNewsletterResponseNegative").parseNewsletterResponseNegative(b,a);if(c.success)return{name:"NewsletterResponseNegative",value:c.value};b=d("WASmaxInMessagePublishNewsletterResponseSuccess").parseNewsletterResponseSuccess(b,a);if(b.success)return{name:"NewsletterResponseSuccess",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Negative:c,Success:b}))});return h.apply(this,arguments)}g.sendNewsletterRPC=a}),98);
__d("WASmaxOutNewslettersNewsletterCreationTimeFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("creation_time",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterCreationTimeFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterDescriptionFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("description",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterDescriptionFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterHandleFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("handle",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterHandleFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterIDFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("id",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterIDFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterInviteLinkFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("invite",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterInviteLinkFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("linked_accounts",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterLinkedAccountsFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterMembershipFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("membership",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMembershipFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterMutedFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("muted",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMutedFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterNameFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("name",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterNameFieldMixin=a}),98);
__d("WASmaxOutNewslettersBaseNewsletterPictureFieldMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.pictureId;a=d("WASmaxJsx").smax("picture",{id:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a),query:"direct_path"});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseNewsletterPictureFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterPictureFieldMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseNewsletterPictureFieldMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.pictureType;b=d("WASmaxOutNewslettersBaseNewsletterPictureFieldMixin").mergeBaseNewsletterPictureFieldMixin(d("WASmaxJsx").smax("picture",{type:d("WAWap").CUSTOM_STRING(b)}),a);return b}function i(a){a=a.pictureArgs;a=d("WASmaxJsx").smax("metadata",null,d("WASmaxChildren").REPEATED_CHILD(h,a,0,2));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeNewsletterPictureFieldPicture=h;g.mergeNewsletterPictureFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterPrivacyFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("privacy",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterPrivacyFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterStateFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("state",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterStateFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterSubscribersFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("subscribers",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterSubscribersFieldMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterVerificationFieldMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("verification",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterVerificationFieldMixin=a}),98);
__d("WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersNewsletterCreationTimeFieldMixin","WASmaxOutNewslettersNewsletterDescriptionFieldMixin","WASmaxOutNewslettersNewsletterHandleFieldMixin","WASmaxOutNewslettersNewsletterIDFieldMixin","WASmaxOutNewslettersNewsletterInviteLinkFieldMixin","WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin","WASmaxOutNewslettersNewsletterMembershipFieldMixin","WASmaxOutNewslettersNewsletterMutedFieldMixin","WASmaxOutNewslettersNewsletterNameFieldMixin","WASmaxOutNewslettersNewsletterPictureFieldMixin","WASmaxOutNewslettersNewsletterPrivacyFieldMixin","WASmaxOutNewslettersNewsletterStateFieldMixin","WASmaxOutNewslettersNewsletterSubscribersFieldMixin","WASmaxOutNewslettersNewsletterVerificationFieldMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.hasNewsletterCreationTimeField,e=a.hasNewsletterNameField,f=a.hasNewsletterDescriptionField,g=a.hasNewsletterInviteLinkField,h=a.hasNewsletterHandleField,i=a.hasNewsletterSubscribersField,j=a.hasNewsletterPrivacyField,k=a.hasNewsletterVerificationField,l=a.hasNewsletterLinkedAccountsField,m=a.hasNewsletterStateField,n=a.newsletterPictureFieldMixinArgs,o=a.hasNewsletterMembershipField;a=a.hasNewsletterMutedField;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutNewslettersNewsletterMutedFieldMixin").mergeNewsletterMutedFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterMembershipFieldMixin").mergeNewsletterMembershipFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterPictureFieldMixin").mergeNewsletterPictureFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterStateFieldMixin").mergeNewsletterStateFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterLinkedAccountsFieldMixin").mergeNewsletterLinkedAccountsFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterVerificationFieldMixin").mergeNewsletterVerificationFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterPrivacyFieldMixin").mergeNewsletterPrivacyFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterSubscribersFieldMixin").mergeNewsletterSubscribersFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterHandleFieldMixin").mergeNewsletterHandleFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterInviteLinkFieldMixin").mergeNewsletterInviteLinkFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterDescriptionFieldMixin").mergeNewsletterDescriptionFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterNameFieldMixin").mergeNewsletterNameFieldMixin,b.optionalMerge(d("WASmaxOutNewslettersNewsletterCreationTimeFieldMixin").mergeNewsletterCreationTimeFieldMixin,d("WASmaxOutNewslettersNewsletterIDFieldMixin").mergeNewsletterIDFieldMixin(d("WASmaxJsx").smax("metadata",null)),c),e),f),g),h),i),j),k),l),m),n),o),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAllNewsletterMetadataIQRequestPayloadMixin=a}),98);
__d("WASmaxOutNewslettersSetNameMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.nameElementValue;a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("name",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSetNameMixinMixin=a}),98);
__d("WASmaxOutNewslettersSetNewDescriptionMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.descriptionElementValue;a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("description",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSetNewDescriptionMixinMixin=a}),98);
__d("WASmaxOutNewslettersSetNewPictureMixinMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.pictureElementValue;a=d("WASmaxJsx").smax("metadata",null,d("WASmaxJsx").smax("picture",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSetNewPictureMixinMixin=a}),98);
__d("WASmaxOutNewslettersCreateRequestMixinMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin","WASmaxOutNewslettersSetNameMixinMixin","WASmaxOutNewslettersSetNewDescriptionMixinMixin","WASmaxOutNewslettersSetNewPictureMixinMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.setNameMixinMixinArgs,e=a.setNewDescriptionMixinMixinArgs,f=a.setNewPictureMixinMixinArgs;a=a.allNewsletterMetadataIQRequestPayloadMixinArgs;c=(b=d("WASmaxJsx")).smax("create",null,d("WASmaxMixins").optionalMerge(d("WASmaxOutNewslettersSetNewPictureMixinMixin").mergeSetNewPictureMixinMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutNewslettersSetNewDescriptionMixinMixin").mergeSetNewDescriptionMixinMixin,d("WASmaxOutNewslettersSetNameMixinMixin").mergeSetNameMixinMixin(b.smax("metadata",null),c),e),f),b.smax("query",null,d("WASmaxOutNewslettersAllNewsletterMetadataIQRequestPayloadMixin").mergeAllNewsletterMetadataIQRequestPayloadMixin(b.smax("metadata",null),a)));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCreateRequestMixinMixin=a}),98);
__d("WASmaxOutNewslettersBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutNewslettersSelfIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutNewslettersBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"newsletter"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSelfIQSetRequestMixin=a}),98);
__d("WASmaxOutNewslettersCreateRequest",["WASmaxJsx","WASmaxOutNewslettersCreateRequestMixinMixin","WASmaxOutNewslettersSelfIQSetRequestMixin"],(function(a,b,c,d,e,f,g){function a(a){a=a.createRequestMixinMixinArgs;a=d("WASmaxOutNewslettersSelfIQSetRequestMixin").mergeSelfIQSetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutNewslettersCreateRequestMixinMixin").mergeCreateRequestMixinMixin(d("WASmaxJsx").smax("create",null),a)));return a}g.makeCreateRequest=a}),98);
__d("WASmaxNewslettersCreateRPC",["WAComms","WASmaxInNewslettersCreateResponseClientError","WASmaxInNewslettersCreateResponseServerError","WASmaxInNewslettersCreateResponseSuccess","WASmaxOutNewslettersCreateRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutNewslettersCreateRequest").makeCreateRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInNewslettersCreateResponseSuccess").parseCreateResponseSuccess(b,a);if(c.success)return{name:"CreateResponseSuccess",value:c.value};var e=d("WASmaxInNewslettersCreateResponseClientError").parseCreateResponseClientError(b,a);if(e.success)return{name:"CreateResponseClientError",value:e.value};b=d("WASmaxInNewslettersCreateResponseServerError").parseCreateResponseServerError(b,a);if(b.success)return{name:"CreateResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Create",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendCreateRPC=a}),98);
__d("WASmaxOutNewslettersMessageUpdatesAfterMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageUpdatesAfter;a=d("WASmaxJsx").smax("message_updates",{after:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageUpdatesAfterMixinMixin=a}),98);
__d("WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageUpdatesBefore;a=d("WASmaxJsx").smax("message_updates",{before:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageUpdatesBeforeMixinMixin=a}),98);
__d("WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersMessageUpdatesAfterMixinMixin","WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.messageUpdatesBeforeMixin)return d("WASmaxOutNewslettersMessageUpdatesBeforeMixinMixin").mergeMessageUpdatesBeforeMixinMixin(a,b.messageUpdatesBeforeMixin);if(b.messageUpdatesAfterMixin)return d("WASmaxOutNewslettersMessageUpdatesAfterMixinMixin").mergeMessageUpdatesAfterMixinMixin(a,b.messageUpdatesAfterMixin);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeMessageUpdatesBeforeOrAfterMixinMixinGroup=a}),98);
__d("WASmaxOutNewslettersBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.iqTo;a=d("WASmaxOutNewslettersBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").JID(a),xmlns:"newsletter"}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterIQGetRequestMixin=a}),98);
__d("WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup","WASmaxOutNewslettersNewsletterIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageUpdatesCount,c=a.messageUpdatesSince,e=a.messageUpdatesBeforeOrAfterMixinMixinGroupArgs;b=d("WASmaxOutNewslettersNewsletterIQGetRequestMixin").mergeNewsletterIQGetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutNewslettersMessageUpdatesBeforeOrAfterMixinMixinGroup").mergeMessageUpdatesBeforeOrAfterMixinMixinGroup(d("WASmaxJsx").smax("message_updates",{count:d("WAWap").INT(b),since:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c)}),e)),a);return b}g.makeGetNewsletterMessageUpdatesRequest=a}),98);
__d("WASmaxNewslettersGetNewsletterMessageUpdatesRPC",["WAComms","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError","WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess","WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutNewslettersGetNewsletterMessageUpdatesRequest").makeGetNewsletterMessageUpdatesRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseSuccess").parseGetNewsletterMessageUpdatesResponseSuccess(b,a);if(c.success)return{name:"GetNewsletterMessageUpdatesResponseSuccess",value:c.value};var e=d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseClientError").parseGetNewsletterMessageUpdatesResponseClientError(b,a);if(e.success)return{name:"GetNewsletterMessageUpdatesResponseClientError",value:e.value};b=d("WASmaxInNewslettersGetNewsletterMessageUpdatesResponseServerError").parseGetNewsletterMessageUpdatesResponseServerError(b,a);if(b.success)return{name:"GetNewsletterMessageUpdatesResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetNewsletterMessageUpdates",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendGetNewsletterMessageUpdatesRPC=a}),98);
__d("WASmaxOutNewslettersAfterMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messagesAfter;a=d("WASmaxJsx").smax("messages",{after:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAfterMixinMixin=a}),98);
__d("WASmaxOutNewslettersBeforeMixinMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messagesBefore;a=d("WASmaxJsx").smax("messages",{before:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBeforeMixinMixin=a}),98);
__d("WASmaxOutNewslettersMessageDirections",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersAfterMixinMixin","WASmaxOutNewslettersBeforeMixinMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.beforeMixin)return d("WASmaxOutNewslettersBeforeMixinMixin").mergeBeforeMixinMixin(a,b.beforeMixin);if(b.afterMixin)return d("WASmaxOutNewslettersAfterMixinMixin").mergeAfterMixinMixin(a,b.afterMixin);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeMessageDirections=a}),98);
__d("WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersMessageDirections","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messagesCount;a=a.messageDirectionsArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutNewslettersMessageDirections").mergeMessageDirections,d("WASmaxJsx").smax("messages",{count:d("WAWap").INT(b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMessageRequestPayloadMixin=a}),98);
__d("WASmaxOutNewslettersQueryNewsletterInviteParamsMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.anyKey;a=a.anyViewRole;b=d("WASmaxJsx").smax("smax$any",{type:"invite",key:d("WAWap").CUSTOM_STRING(b),view_role:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQueryNewsletterInviteParamsMixin=a}),98);
__d("WASmaxOutNewslettersQueryNewsletterJIDParamsMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.anyJid;a=a.anyViewRole;b=d("WASmaxJsx").smax("smax$any",{type:"jid",jid:d("WAWap").JID(b),view_role:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQueryNewsletterJIDParamsMixin=a}),98);
__d("WASmaxOutNewslettersQueryNewsletterParams",["WASmaxMixinGroupExhaustiveError","WASmaxOutNewslettersQueryNewsletterInviteParamsMixin","WASmaxOutNewslettersQueryNewsletterJIDParamsMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.queryNewsletterJIDParams)return d("WASmaxOutNewslettersQueryNewsletterJIDParamsMixin").mergeQueryNewsletterJIDParamsMixin(a,b.queryNewsletterJIDParams);if(b.queryNewsletterInviteParams)return d("WASmaxOutNewslettersQueryNewsletterInviteParamsMixin").mergeQueryNewsletterInviteParamsMixin(a,b.queryNewsletterInviteParams);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeQueryNewsletterParams=a}),98);
__d("WASmaxOutNewslettersQueryNewsletterParamsMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersQueryNewsletterParams"],(function(a,b,c,d,e,f,g){function h(a){a=a.queryNewsletterParamsArgs;a=d("WASmaxOutNewslettersQueryNewsletterParams").mergeQueryNewsletterParams(d("WASmaxJsx").smax("smax$any",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQueryNewsletterParamsMixin=a}),98);
__d("WASmaxOutNewslettersSelfIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutNewslettersBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"newsletter"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSelfIQGetRequestMixin=a}),98);
__d("WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin","WASmaxOutNewslettersQueryNewsletterParamsMixin","WASmaxOutNewslettersSelfIQGetRequestMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.queryNewsletterParamsMixinArgs;a=a.newsletterMessageRequestPayloadMixinArgs;b=d("WASmaxOutNewslettersSelfIQGetRequestMixin").mergeSelfIQGetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutNewslettersNewsletterMessageRequestPayloadMixin").mergeNewsletterMessageRequestPayloadMixin(d("WASmaxOutNewslettersQueryNewsletterParamsMixin").mergeQueryNewsletterParamsMixin(d("WASmaxJsx").smax("messages",null),b),a)));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNewsletterMessageRequestIQPayloadMixin=a}),98);
__d("WASmaxOutNewslettersGetNewsletterMessagesRequest",["WASmaxJsx","WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutNewslettersNewsletterMessageRequestIQPayloadMixin").mergeNewsletterMessageRequestIQPayloadMixin(d("WASmaxJsx").smax("iq",null),a);return a}g.makeGetNewsletterMessagesRequest=a}),98);
__d("WASmaxNewslettersGetNewsletterMessagesRPC",["WAComms","WASmaxInNewslettersGetNewsletterMessagesResponseClientError","WASmaxInNewslettersGetNewsletterMessagesResponseServerError","WASmaxInNewslettersGetNewsletterMessagesResponseSuccess","WASmaxOutNewslettersGetNewsletterMessagesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutNewslettersGetNewsletterMessagesRequest").makeGetNewsletterMessagesRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInNewslettersGetNewsletterMessagesResponseSuccess").parseGetNewsletterMessagesResponseSuccess(b,a);if(c.success)return{name:"GetNewsletterMessagesResponseSuccess",value:c.value};var e=d("WASmaxInNewslettersGetNewsletterMessagesResponseClientError").parseGetNewsletterMessagesResponseClientError(b,a);if(e.success)return{name:"GetNewsletterMessagesResponseClientError",value:e.value};b=d("WASmaxInNewslettersGetNewsletterMessagesResponseServerError").parseGetNewsletterMessagesResponseServerError(b,a);if(b.success)return{name:"GetNewsletterMessagesResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetNewsletterMessages",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendGetNewsletterMessagesRPC=a}),98);
__d("WASmaxOutNewslettersMyAddOnsRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutNewslettersSelfIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.myAddonsLimit;a=a.myAddonsJid;b=d("WASmaxOutNewslettersSelfIQGetRequestMixin").mergeSelfIQGetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("my_addons",{limit:d("WAWap").INT(b),jid:d("WASmaxAttrs").OPTIONAL(d("WAWap").JID,a)})));return b}g.makeMyAddOnsRequest=a}),98);
__d("WASmaxNewslettersMyAddOnsRPC",["WAComms","WASmaxInNewslettersMyAddOnsResponseClientError","WASmaxInNewslettersMyAddOnsResponseServerError","WASmaxInNewslettersMyAddOnsResponseSuccess","WASmaxOutNewslettersMyAddOnsRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutNewslettersMyAddOnsRequest").makeMyAddOnsRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInNewslettersMyAddOnsResponseSuccess").parseMyAddOnsResponseSuccess(b,a);if(c.success)return{name:"MyAddOnsResponseSuccess",value:c.value};var e=d("WASmaxInNewslettersMyAddOnsResponseClientError").parseMyAddOnsResponseClientError(b,a);if(e.success)return{name:"MyAddOnsResponseClientError",value:e.value};b=d("WASmaxInNewslettersMyAddOnsResponseServerError").parseMyAddOnsResponseServerError(b,a);if(b.success)return{name:"MyAddOnsResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("MyAddOns",{Success:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendMyAddOnsRPC=a}),98);
__d("WASmaxOutPreKeysFetchMissingPreKeysRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WASmaxOutPreKeysRegistrationIDMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.deviceId;b=d("WASmaxOutPreKeysRegistrationIDMixin").mergeRegistrationIDMixin(d("WASmaxJsx").smax("device",{id:d("WAWap").INT(b)}),a);return b}function i(a){var b=a.deviceArgs,c=a.userJid;a=a.hasUserReasonIdentity;c=d("WASmaxJsx").smax("user",{jid:d("WAWap").JID(c),reason:d("WASmaxAttrs").OPTIONAL_LITERAL("identity",a)},d("WASmaxChildren").REPEATED_CHILD(h,b,0,100));return c}function a(a){a=a.userArgs;a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("key_fetch",null,d("WASmaxChildren").REPEATED_CHILD(i,a,1,1e5))));return a}g.makeFetchMissingPreKeysRequestKeyFetchUserDevice=h;g.makeFetchMissingPreKeysRequestKeyFetchUser=i;g.makeFetchMissingPreKeysRequest=a}),98);
__d("WASmaxOutPresencePrivacyTokenContentsMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d("WASmaxJsx").smax("smax$any",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePrivacyTokenContentsMixin=a}),98);
__d("WASmaxOutPresenceTCTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutPresencePrivacyTokenContentsMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.tctokenT;a=a.privacyTokenContentsMixinArgs;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutPresencePrivacyTokenContentsMixin").mergePrivacyTokenContentsMixin(d("WASmaxJsx").smax("tctoken",{t:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b)}),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTCTokenMixin=a}),98);
__d("WASmaxOutPresenceSubscribeRequest",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutPresenceTCTokenMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.presenceTo,c=a.presenceName,e=a.presenceContext;a=a.tCTokenMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutPresenceTCTokenMixin").mergeTCTokenMixin,d("WASmaxJsx").smax("presence",{type:"subscribe",to:d("WAWap").JID(b),name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c),context:d("WASmaxAttrs").OPTIONAL(d("WAWap").GROUP_JID,e)}),a);return b}g.makeSubscribeRequest=a}),98);
__d("WASmaxOutPrivacyBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyName;a=d("WASmaxJsx").smax("smax$any",{name:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeCategoryNamesForContactBlacklistMixin=a}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.categoryNamesForContactBlacklistMixinArgs;a=d("WASmaxJsx").smax("privacy",{addressing_mode:"lid"},d("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin").mergeCategoryNamesForContactBlacklistMixin(d("WASmaxJsx").smax("list",{value:"contact_blacklist"}),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetContactBlacklistGetContactBlacklistLIDMixin=a}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.categoryNamesForContactBlacklistMixinArgs;a=d("WASmaxJsx").smax("privacy",null,d("WASmaxOutPrivacyCategoryNamesForContactBlacklistMixin").mergeCategoryNamesForContactBlacklistMixin(d("WASmaxJsx").smax("list",{value:"contact_blacklist"}),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetContactBlacklistGetContactBlacklistPNMixin=a}),98);
__d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.getContactBlacklistGetContactBlacklistLID)return d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDMixin").mergeGetContactBlacklistGetContactBlacklistLIDMixin(a,b.getContactBlacklistGetContactBlacklistLID);if(b.getContactBlacklistGetContactBlacklistPN)return d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistPNMixin").mergeGetContactBlacklistGetContactBlacklistPNMixin(a,b.getContactBlacklistGetContactBlacklistPN);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup=a}),98);
__d("WASmaxOutPrivacyGetIQMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPrivacyBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxOutPrivacyBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"privacy"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGetIQMixin=a}),98);
__d("WASmaxOutPrivacyGetContactBlacklistRequest",["WASmaxJsx","WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup","WASmaxOutPrivacyGetIQMixin"],(function(a,b,c,d,e,f,g){function a(a){a=a.getContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroupArgs;a=d("WASmaxOutPrivacyGetIQMixin").mergeGetIQMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxOutPrivacyGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup").mergeGetContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroup(d("WASmaxJsx").smax("privacy",null),a)));return a}g.makeGetContactBlacklistRequest=a}),98);
__d("WASmaxOutPsaBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutPsaBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutPsaChatBlockGetRequest",["WASmaxJsx","WASmaxOutPsaBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPsaBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"w:comms:chat"},d("WASmaxJsx").smax("query",null,d("WASmaxJsx").smax("blocking_status",null))));return a}g.makeChatBlockGetRequest=a}),98);
__d("WASmaxOutPsaChatBlockSetRequest",["WASmaxJsx","WASmaxOutPsaBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.blockingAction;a=d("WASmaxOutPsaBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"w:comms:chat"},d("WASmaxJsx").smax("blocking",{action:d("WAWap").CUSTOM_STRING(a)})));return a}g.makeChatBlockSetRequest=a}),98);
__d("WASmaxOutSpamEntitySubjectMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.spamListSubject;a=d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("spam_list",{subject:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEntitySubjectMixin=a}),98);
__d("WASmaxOutSpamGroupReportRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamBaseIQSetRequestMixin","WASmaxOutSpamBaseReportMixin","WASmaxOutSpamCallReportMixin","WASmaxOutSpamEntitySubjectMixin","WASmaxOutSpamFRXMixin","WASmaxOutSpamMessageMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageFrom,c=a.messagePhash;b=d("WASmaxOutSpamMessageMixin").mergeMessageMixin(d("WASmaxJsx").smax("message",{from:d("WAWap").GROUP_JID(b),phash:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c)}),a);return b}function i(a){a=d("WASmaxOutSpamCallReportMixin").mergeCallReportMixin(d("WASmaxJsx").smax("call",null),a);return a}function a(a){var b=a.messageArgs,c=a.callArgs,e=a.fRXMixinArgs,f=a.spamListJid,g=a.spamListSource;f=d("WASmaxOutSpamEntitySubjectMixin").mergeEntitySubjectMixin(d("WASmaxMixins").optionalMerge(d("WASmaxOutSpamFRXMixin").mergeFRXMixin,d("WASmaxOutSpamBaseReportMixin").mergeBaseReportMixin(d("WASmaxOutSpamBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("spam_list",{jid:d("WAWap").GROUP_JID(f),source:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,g)},[].concat(d("WASmaxChildren").REPEATED_CHILD(h,b,0,210),d("WASmaxChildren").REPEATED_CHILD(i,c,0,5))))),a),e),a);return f}g.makeGroupReportRequestSpamListMessage=h;g.makeGroupReportRequestSpamListCall=i;g.makeGroupReportRequest=a}),98);
__d("WASmaxOutSpamNewsletterReportRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutSpamBaseIQSetRequestMixin","WASmaxOutSpamBaseReportMixin","WASmaxOutSpamEntitySubjectMixin","WASmaxOutSpamMessageMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageFrom;b=d("WASmaxOutSpamMessageMixin").mergeMessageMixin(d("WASmaxJsx").smax("message",{from:d("WAWap").JID(b)}),a);return b}function a(a){var b=a.messageArgs,c=a.spamListJid;c=d("WASmaxOutSpamEntitySubjectMixin").mergeEntitySubjectMixin(d("WASmaxOutSpamBaseReportMixin").mergeBaseReportMixin(d("WASmaxOutSpamBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("spam_list",{jid:d("WAWap").JID(c)},d("WASmaxChildren").REPEATED_CHILD(h,b,0,65)))),a),a);return c}g.makeNewsletterReportRequestSpamListMessage=h;g.makeNewsletterReportRequest=a}),98);
__d("WASmaxOutSpamStatusReportRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutSpamBaseIQSetRequestMixin","WASmaxOutSpamBaseReportMixin","WASmaxOutSpamBizOptOutMixin","WASmaxOutSpamBizReportMixin","WASmaxOutSpamFRXMixin","WASmaxOutSpamMessageMixin","WASmaxOutSpamMessageRecipientMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.fRXMixinArgs,e=a.spamListJid,f=a.bizOptOutMixinArgs,g=a.bizReportMixinArgs,h=a.messageFrom,i=a.messageMixinArgs,j=a.messageRecipientMixinArgs;e=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutSpamFRXMixin").mergeFRXMixin,d("WASmaxOutSpamBaseReportMixin").mergeBaseReportMixin(d("WASmaxOutSpamBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",null,b.optionalMerge(d("WASmaxOutSpamBizReportMixin").mergeBizReportMixin,b.optionalMerge(d("WASmaxOutSpamBizOptOutMixin").mergeBizOptOutMixin,d("WASmaxJsx").smax("spam_list",{jid:d("WAWap").JID(e)},b.optionalMerge(d("WASmaxOutSpamMessageRecipientMixin").mergeMessageRecipientMixin,d("WASmaxOutSpamMessageMixin").mergeMessageMixin(d("WASmaxJsx").smax("message",{from:d("WAWap").JID(h)}),i),j)),f),g))),a),c);return e}g.makeStatusReportRequest=a}),98);
__d("WASmaxPreKeysFetchMissingPreKeysRPC",["WAComms","WASmaxInPreKeysFetchMissingPreKeysResponseRequestError","WASmaxInPreKeysFetchMissingPreKeysResponseServerError","WASmaxInPreKeysFetchMissingPreKeysResponseSuccess","WASmaxOutPreKeysFetchMissingPreKeysRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutPreKeysFetchMissingPreKeysRequest").makeFetchMissingPreKeysRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInPreKeysFetchMissingPreKeysResponseSuccess").parseFetchMissingPreKeysResponseSuccess(b,a);if(c.success)return{name:"FetchMissingPreKeysResponseSuccess",value:c.value};var e=d("WASmaxInPreKeysFetchMissingPreKeysResponseRequestError").parseFetchMissingPreKeysResponseRequestError(b,a);if(e.success)return{name:"FetchMissingPreKeysResponseRequestError",value:e.value};b=d("WASmaxInPreKeysFetchMissingPreKeysResponseServerError").parseFetchMissingPreKeysResponseServerError(b,a);if(b.success)return{name:"FetchMissingPreKeysResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchMissingPreKeys",{Success:c,RequestError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendFetchMissingPreKeysRPC=a}),98);
__d("WASmaxPresenceSubscribeRPC",["WAComms","WASmaxOutPresenceSubscribeRequest","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WASmaxOutPresenceSubscribeRequest").makeSubscribeRequest(a);yield d("WAComms").castSmaxStanza(a)});return h.apply(this,arguments)}g.sendSubscribeRPC=a}),98);
__d("WASmaxPrivacyGetContactBlacklistRPC",["WAComms","WASmaxInPrivacyGetContactBlacklistResponseError","WASmaxInPrivacyGetContactBlacklistResponseSuccess","WASmaxInPrivacyGetContactBlacklistResponseSuccessLID","WASmaxOutPrivacyGetContactBlacklistRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutPrivacyGetContactBlacklistRequest").makeGetContactBlacklistRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInPrivacyGetContactBlacklistResponseSuccessLID").parseGetContactBlacklistResponseSuccessLID(b,a);if(c.success)return{name:"GetContactBlacklistResponseSuccessLID",value:c.value};var e=d("WASmaxInPrivacyGetContactBlacklistResponseSuccess").parseGetContactBlacklistResponseSuccess(b,a);if(e.success)return{name:"GetContactBlacklistResponseSuccess",value:e.value};b=d("WASmaxInPrivacyGetContactBlacklistResponseError").parseGetContactBlacklistResponseError(b,a);if(b.success)return{name:"GetContactBlacklistResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetContactBlacklist",{SuccessLID:c,Success:e,Error:b}))});return h.apply(this,arguments)}g.sendGetContactBlacklistRPC=a}),98);
__d("WASmaxPsaChatBlockGetRPC",["WAComms","WASmaxInPsaChatBlockGetResponseServerError","WASmaxInPsaChatBlockGetResponseSuccess","WASmaxOutPsaChatBlockGetRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WASmaxOutPsaChatBlockGetRequest").makeChatBlockGetRequest();a=(yield d("WAComms").sendSmaxStanza(b,a));var c=d("WASmaxInPsaChatBlockGetResponseSuccess").parseChatBlockGetResponseSuccess(a,b);if(c.success)return{name:"ChatBlockGetResponseSuccess",value:c.value};a=d("WASmaxInPsaChatBlockGetResponseServerError").parseChatBlockGetResponseServerError(a,b);if(a.success)return{name:"ChatBlockGetResponseServerError",value:a.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ChatBlockGet",{Success:c,ServerError:a}))});return h.apply(this,arguments)}g.sendChatBlockGetRPC=a}),98);
__d("WASmaxPsaChatBlockSetRPC",["WAComms","WASmaxInPsaChatBlockSetResponseServerError","WASmaxInPsaChatBlockSetResponseSuccess","WASmaxOutPsaChatBlockSetRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutPsaChatBlockSetRequest").makeChatBlockSetRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInPsaChatBlockSetResponseSuccess").parseChatBlockSetResponseSuccess(b,a);if(c.success)return{name:"ChatBlockSetResponseSuccess",value:c.value};b=d("WASmaxInPsaChatBlockSetResponseServerError").parseChatBlockSetResponseServerError(b,a);if(b.success)return{name:"ChatBlockSetResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("ChatBlockSet",{Success:c,ServerError:b}))});return h.apply(this,arguments)}g.sendChatBlockSetRPC=a}),98);
__d("WASmaxSpamGroupReportRPC",["WAComms","WASmaxInSpamGroupReportResponseError","WASmaxInSpamGroupReportResponseSuccess","WASmaxOutSpamGroupReportRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutSpamGroupReportRequest").makeGroupReportRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInSpamGroupReportResponseSuccess").parseGroupReportResponseSuccess(b,a);if(c.success)return{name:"GroupReportResponseSuccess",value:c.value};b=d("WASmaxInSpamGroupReportResponseError").parseGroupReportResponseError(b,a);if(b.success)return{name:"GroupReportResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GroupReport",{Success:c,Error:b}))});return h.apply(this,arguments)}g.sendGroupReportRPC=a}),98);
__d("WASmaxSpamNewsletterReportRPC",["WAComms","WASmaxInSpamNewsletterReportResponseError","WASmaxInSpamNewsletterReportResponseSuccess","WASmaxOutSpamNewsletterReportRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutSpamNewsletterReportRequest").makeNewsletterReportRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInSpamNewsletterReportResponseSuccess").parseNewsletterReportResponseSuccess(b,a);if(c.success)return{name:"NewsletterReportResponseSuccess",value:c.value};b=d("WASmaxInSpamNewsletterReportResponseError").parseNewsletterReportResponseError(b,a);if(b.success)return{name:"NewsletterReportResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("NewsletterReport",{Success:c,Error:b}))});return h.apply(this,arguments)}g.sendNewsletterReportRPC=a}),98);
__d("WASmaxSpamStatusReportRPC",["WAComms","WASmaxInSpamStatusReportResponseError","WASmaxInSpamStatusReportResponseSuccess","WASmaxOutSpamStatusReportRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutSpamStatusReportRequest").makeStatusReportRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInSpamStatusReportResponseSuccess").parseStatusReportResponseSuccess(b,a);if(c.success)return{name:"StatusReportResponseSuccess",value:c.value};b=d("WASmaxInSpamStatusReportResponseError").parseStatusReportResponseError(b,a);if(b.success)return{name:"StatusReportResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("StatusReport",{Success:c,Error:b}))});return h.apply(this,arguments)}g.sendStatusReportRPC=a}),98);
__d("WASyncdAction",["Promise","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){}var c=a.prototype;c.resolveConflicts=function(a,c){c=c.timestamp;return c>=a.timestamp?(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal):(h||(h=b("Promise"))).resolve(d("WASyncdConst").ConflictResolutionState.SkipRemote)};c.dropMutationDueToCrossIndexConflict=function(a,c){return(h||(h=b("Promise"))).resolve(!1)};return a}();g.SyncActionBase=a}),98);
__d("WAWebSyncdCryptoConst",[],(function(a,b,c,d,e,f){"use strict";a="WhatsApp Mutation Keys";b=160;c=32;d=32;e=32;var g=32,h=32;c=c;d=c+d;e=d+e;g=e+g;h=g+h;var i="0x01",j="0x02",k=0,l=32,m=8,n=16;f.HKDF_INFO=a;f.DERIVED_KEY_LENGTH=b;f.INDEX_KEY_END=c;f.VALUE_ENCRYPTION_KEY_END=d;f.VALUE_MAC_KEY_END=e;f.SNAPSHOT_MAC_KEY_END=g;f.PATCH_MAC_KEY_END=h;f.OPERATION_SET_HEX=i;f.OPERATION_REMOVE_HEX=j;f.MAX_OF_MIN_DATA_LENGTH=k;f.MAC_LENGTH=l;f.OCTET_LENGTH=m;f.IV_LENGTH=n}),66);
__d("WAWebSyncdError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="SyncdMissingKeyError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){function b(b,c){var d;d=a.call(this,b)||this;d.name="SyncdRetryableError";d.backoff=c;d.message=b;return d}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){function b(b){var c;c=a.call(this,b)||this;c.name="SyncdFatalError";c.message=b;return c}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));f.SyncdMissingKeyError=a;f.SyncdRetryableError=b;f.SyncdFatalError=c}),66);
__d("WAWebSyncdDecode",["WAServerSync.pb","WASyncAction.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").ExternalBlobReferenceSpec,b)}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("external blob reference protobuf deserialization failed")}}function b(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdSnapshotSpec,b)}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("snapshot protobuf deserialization failed")}}function c(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,b)}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_DESERIALIZATION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("patch protobuf deserialization failed")}}function e(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,b)}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("mutations protobuf deserialization failed")}}function f(a,b){try{return d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b)}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("action data protobuf deserialization failed")}}g.decodeExternalBlobReference=a;g.decodeSyncdSnapshot=b;g.decodeSyncdPatch=c;g.decodeSyncdMutations=e;g.decodeSyncActionData=f}),98);
__d("WAWebSyncdRequestEncode",["WAServerSync.pb","WASyncAction.pb","WAWebSyncdError","WAWebSyncdMetricFatalError","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdPatchSpec,a).readBuffer()}catch(a){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WAWebSyncdError").SyncdFatalError)("patch protobuf serialization failed")}}function b(a){try{return d("encodeProtobuf").encodeProtobuf(d("WAServerSync.pb").SyncdMutationsSpec,a).readBuffer()}catch(a){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MUTATIONS_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WAWebSyncdError").SyncdFatalError)("mutations protobuf serialization failed")}}function c(a){try{return d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a).readBuffer()}catch(a){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED);throw new(d("WAWebSyncdError").SyncdFatalError)("action data protobuf serialization failed")}}g.encodeSyncdPatch=a;g.encodeSyncdMutations=b;g.encodeSyncActionData=c}),98);
__d("WAWebSyncdValidateSyncActionProtobuf",["WAWebSyncdError","WAWebSyncdMetricFatalError"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.validateSyncActionDataProtobuf=function(a,b){var c=b.index,e=b.value,f=b.padding;b=b.version;if(!c){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_INDEX,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing action index")}if(b==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VERSION,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing action version")}return{index:c,value:e,padding:f,version:b}};return a}();g["default"]=a}),98);
__d("kotlin-kotlin-stdlib",[],(function(a,b,c,d,e,f){typeof Math.imul==="undefined"&&(Math.imul=function(a,b){return(a&4294901760)*(b&65535)+(a&65535)*(b|0)|0});typeof ArrayBuffer.isView==="undefined"&&(ArrayBuffer.isView=function(a){return a!=null&&a.__proto__!=null&&a.__proto__.__proto__===Int8Array.prototype.__proto__});typeof Array.prototype.fill==="undefined"&&Object.defineProperty(Array.prototype,"fill",{value:function(a){if(this==null)throw new TypeError("this is null or not defined");var b=Object(this),c=b.length>>>0,d=arguments[1],e=d>>0,f=e<0?Math.max(c+e,0):Math.min(e,c),g=arguments[2],h=g===void 0?c:g>>0,i=h<0?Math.max(c+h,0):Math.min(h,c);while(f<i)b[f]=a,f++;return b}});[Int8Array,Int16Array,Uint16Array,Int32Array,Float32Array,Float64Array].forEach(function(a){typeof a.prototype.fill==="undefined"&&Object.defineProperty(a.prototype,"fill",{value:Array.prototype.fill})});typeof Math.clz32==="undefined"&&(Math.clz32=function(a,b){return function(c){c=c>>>0;return c===0?32:31-(a(c)/b|0)|0}}(Math.log,Math.LN2));var g=Math.imul,h=ArrayBuffer.isView,i=Math.clz32;K(j,"CharSequence");J(k,"Number");J(oa,"Char");K(q,"Collection");K(p,"List",N,N,[q]);yc(e);function a(){return Ab(this)}K(ra,"Set",N,N,[q]);K(sa,"Entry");K(ta,"Map");yc(ua);J(r,"Enum");yc(wa);J(s,"Long",N,k);K(Ea,"FunctionAdapter");J(Eb,"JsSetView",Eb,Set);xc(Pc,"Digit");K(Sc,"Comparator");xc(Vc,"Unit");J(Y,"AbstractCollection",N,N,[q]);J(O,"AbstractMutableCollection",N,Y,[Y,q]);J(bd,"IteratorImpl");J(P,"AbstractMutableList",N,O,[O,p,q]);J(cd,"AbstractMutableSet",N,O,[O,ra,q]);yc(gd);J(Q,"ArrayList",kd,P,[P,p,q]);J(R,"HashSet",rd,cd,[cd,ra,q]);yc(Sd);J(Ud,"Itr");J(Vd,"KeysItr",N,Ud);J(Wd,"EntriesItr",N,Ud);J(Xd,"EntryRef",N,N,[sa]);function b(a){$l$block_0:{var b;M(a,q)?b=a.j():b=!1;if(b){b=!0;break $l$block_0}a=a.f();while(a.g()){var c=a.h();c=c;(c==null?!1:M(c,sa))?c=this.t3(c):c=!1;if(!c){b=!1;break $l$block_0}}b=!0}return b}K(Yd,"InternalMap");J(S,"InternalHashMap",zd,N,[Yd]);xc(fe,"EmptyHolder");J(ie,"LinkedHashSet",$d,R,[R,ra,q]);J(T,"Exception",ke,Error);J(W,"RuntimeException",ze,T);J(qe,"IllegalArgumentException",oe,W);J(ve,"IllegalStateException",se,W);J(ye,"UnsupportedOperationException",xe,W);J(De,"NoSuchElementException",X,W);J(Ie,"IndexOutOfBoundsException",Fe,W);J(Ne,"NumberFormatException",Ke,qe);J(Se,"ConcurrentModificationException",Pe,W);J(Ve,"NullPointerException",Ue,W);J(Ye,"NoWhenBranchMatchedException",Xe,W);J(af,"ClassCastException",$e,W);J(ff,"CharacterCodingException",ef,T);J(lf,"StringBuilder",kf,N,[j]);J(sf,"sam$kotlin_Comparator$0",N,N,[Sc,Ea]);J(Ef,"IteratorImpl");yc(Ff);J(Gf,"AbstractList",N,Y,[Y,p]);yc(Hf);xc(Lf,"EmptyIterator");xc(Nf,"EmptyList",N,N,[p]);xc($,"EmptySet",N,N,[ra]);J(Wf,"EnumEntriesList",N,Gf,[p,Gf]);function j(){}function k(){}function l(a){switch(a.length){case 0:return Rf();case 1:return Zc(a[0]);default:return m(a,ce($c(a.length)))}}function c(a,b){if(!(b>=0)){var c="Requested element count "+b+" is less than zero.";throw U(G(c))}if(b===0)return Kf();c=a.length;if(b>=c)return aa(a);if(b===1)return Yc(a[c-1|0]);var d=md(b);b=c-b|0;if(b<c)do{var e=b;b=b+1|0;d.d(a[e])}while(b<c);return d}function m(a,b){var c=0,d=a.length;while(c<d){var e=a[c];c=c+1|0;b.d(e)}return b}function aa(a){switch(a.length){case 0:return Kf();case 1:return Yc(a[0]);default:return ba(a)}}function ba(a){var b=md(a.length),c=0,d=a.length;while(c<d){var e=a[c];c=c+1|0;b.d(e)}return b}function ca(a,b){if(b==null){var c=0,d=a.length-1|0;if(c<=d)do{var e=c;c=c+1|0;if(a[e]==null)return e}while(c<=d)}else{e=0;c=a.length-1|0;if(e<=c)do{d=e;e=e+1|0;if(E(b,a[d]))return d}while(e<=c)}return-1}function da(a,b,c,d,e,f,g){b=b===N?", ":b;c=c===N?"":c;d=d===N?"":d;e=e===N?-1:e;f=f===N?"...":f;g=g===N?null:g;return ea(a,kf(),b,c,d,e,f,g).toString()}function ea(a,b,c,d,e,f,g,h){c=c===N?", ":c;d=d===N?"":d;e=e===N?"":e;f=f===N?-1:f;g=g===N?"...":g;h=h===N?null:h;b.e(d);d=0;var i=0,j=a.length;$l$loop:while(i<j){var k=a[i];i=i+1|0;d=d+1|0;d>1&&b.e(c);if(f<0||d<=f)Xf(b,k,h);else break $l$loop}f>=0&&d>f&&b.e(g);b.e(e);return b}function fa(a,b){return(0<=b?b<=(a.length-1|0):!1)?a[b]:null}function ga(a,b,c,d,e,f,g){b=b===N?", ":b;c=c===N?"":c;d=d===N?"":d;e=e===N?-1:e;f=f===N?"...":f;g=g===N?null:g;return ha(a,kf(),b,c,d,e,f,g).toString()}function ha(a,b,c,d,e,f,g,h){c=c===N?", ":c;d=d===N?"":d;e=e===N?"":e;f=f===N?-1:f;g=g===N?"...":g;h=h===N?null:h;b.e(d);d=0;a=a.f();$l$loop:while(a.g()){var i=a.h();d=d+1|0;d>1&&b.e(c);if(f<0||d<=f)Xf(b,i,h);else break $l$loop}f>=0&&d>f&&b.e(g);b.e(e);return b}function d(a){var b=new Int8Array(a.i()),c=0;a=a.f();while(a.g()){var d=a.h(),e=c;c=e+1|0;b[e]=d}return b}function ia(a,b){return a<b?b:a}function ja(a,b){return a>b?b:a}function n(a){return a}function ka(a){return a}function o(a,b){return ka(a)-ka(b)|0}function la(a,b){return ka(a)-ka(b)|0}function ma(a){return ka(a)}function na(a){return String.fromCharCode(ka(a))}function oa(){}function p(){}function q(){}I(e).fromJsSet=function(a){return Fb(a)};function e(){}var pa;function qa(){return pa}function ra(){}function sa(){}function ta(){}function ua(){}function r(a,b){this.q_1=a,this.r_1=b}I(r).s=function(){return this.q_1};I(r).t=function(){return this.r_1};I(r).u=function(a){return Tb(this.r_1,a.r_1)};I(r).v=function(a){return this.u(a instanceof r?a:rc())};I(r).equals=function(a){return this===a};I(r).hashCode=function(){return Xb(this)};I(r).toString=function(){return this.q_1};function va(a){a=a==null?null:G(a);return a==null?"null":a}function wa(){xa=this,this.w_1=new s(0,-2147483648),this.x_1=new s(-1,2147483647),this.y_1=8,this.z_1=64}var xa;function ya(){xa==null&&new wa();return xa}function s(a,b){ya(),k.call(this),this.a1_1=a,this.b1_1=b}I(s).c1=function(a){return bb(this,a)};I(s).v=function(a){return this.c1(a instanceof s?a:rc())};I(s).toString=function(){return lb(this,10)};I(s).equals=function(a){a instanceof s?a=x(this,a):a=!1;return a};I(s).hashCode=function(){return mb(this)};I(s).valueOf=function(){return kb(this)};function za(a){var b;a<0?b=-a:b=a;return b}function Aa(a){var b=1,c=[],d=0,e=a.length;while(d<e){var f=a[d];d=d+1|0;var g=b,h=f.prototype.$imask$;h=h==null?f.$imask$:h;h==null||(c.push(h),g=h.length);h=f.$metadata$.iid;h==null?f=null:f=Ba(h);h=f;h==null||(c.push(h),g=Math.max(g,h.length));g>b&&(b=g)}return Ca(b,c)}function Ba(a){var b=a>>5,c=new Int32Array(b+1|0);a=a&31;a=1<<a;c[b]=c[b]|a;return c}function Ca(a,b){var c=0,d=new Int32Array(a);while(c<a){var e=c,f=0,g=0,h=b.length;while(g<h){var i=b[g];g=g+1|0;e<i.length&&(f=f|i[e])}d[e]=f;c=c+1|0}return d}function Da(a,b){var c=b>>5;if(c>a.length)return!1;b=b&31;b=1<<b;return!((a[c]&b)===0)}function Ea(){}function Fa(){Ra();return Ga}var Ga;function Ha(){Ra();return Ia}var Ia;function Ja(){Ra();return Ka}var Ka;function La(){Ra();return Ma}var Ma;function Na(){Ra();return Oa}var Oa;function Pa(a){Ra();if((a|0)===a)return Ac(a);Ha()[0]=a;return g(Ja()[Na()],31)+Ja()[La()]|0}var Qa;function Ra(){Qa||(Qa=!0,Ga=new ArrayBuffer(8),Ia=new Float64Array(Fa()),new Float32Array(Fa()),Ka=new Int32Array(Fa()),Ha()[0]=-1,Ma=Ja()[0]===0?0:1,Oa=1-La()|0)}function t(){B();return Sa}var Sa;function Ta(){B();return Ua}var Ua;function Va(){B();return Wa}var Wa;function Xa(){B();return Ya}var Ya;function u(){B();return Za}var Za;function $a(){B();return ab}var ab;function bb(a,b){B();if(x(a,b))return 0;var c=z(a),d=z(b);return c&&!d?-1:!c&&d?1:z(db(a,b))?-1:1}function cb(a,b){B();var c=a.b1_1>>>16|0,d=a.b1_1&65535,e=a.a1_1>>>16|0;a=a.a1_1&65535;var f=b.b1_1>>>16|0,g=b.b1_1&65535,h=b.a1_1>>>16|0;b=b.a1_1&65535;var i=0,j=0,k=0,l=0;l=l+(a+b|0)|0;k=k+(l>>>16|0)|0;l=l&65535;k=k+(e+h|0)|0;j=j+(k>>>16|0)|0;k=k&65535;j=j+(d+g|0)|0;i=i+(j>>>16|0)|0;j=j&65535;i=i+(c+f|0)|0;i=i&65535;return new s(k<<16|l,i<<16|j)}function db(a,b){B();return cb(a,A(b))}function v(a,b){B();if(nb(a))return t();else if(nb(b))return t();if(x(a,u()))return ob(b)?u():t();else if(x(b,u()))return ob(a)?u():t();if(z(a)){var c;z(b)?c=v(A(a),A(b)):c=A(v(A(a),b));return c}else if(z(b))return A(v(a,A(b)));if(pb(a,$a())&&pb(b,$a()))return qb(kb(a)*kb(b));c=a.b1_1>>>16|0;var d=a.b1_1&65535,e=a.a1_1>>>16|0;a=a.a1_1&65535;var f=b.b1_1>>>16|0,h=b.b1_1&65535,i=b.a1_1>>>16|0;b=b.a1_1&65535;var j=0,k=0,l=0,m=0;m=m+g(a,b)|0;l=l+(m>>>16|0)|0;m=m&65535;l=l+g(e,b)|0;k=k+(l>>>16|0)|0;l=l&65535;l=l+g(a,i)|0;k=k+(l>>>16|0)|0;l=l&65535;k=k+g(d,b)|0;j=j+(k>>>16|0)|0;k=k&65535;k=k+g(e,i)|0;j=j+(k>>>16|0)|0;k=k&65535;k=k+g(a,h)|0;j=j+(k>>>16|0)|0;k=k&65535;j=j+(((g(c,b)+g(d,i)|0)+g(e,h)|0)+g(a,f)|0)|0;j=j&65535;return new s(l<<16|m,j<<16|k)}function w(a,b){B();if(nb(b))throw me("division by zero");else if(nb(a))return t();if(x(a,u()))if(x(b,Ta())||x(b,Va()))return u();else if(x(b,u()))return Ta();else{var c=fb(a,1);c=eb(w(c,b),1);if(x(c,t()))return z(b)?Ta():Va();else{var d=db(a,v(b,c));return cb(c,w(d,b))}}else if(x(b,u()))return t();if(z(a)){z(b)?c=w(A(a),A(b)):c=A(w(A(a),b));return c}else if(z(b))return A(w(a,A(b)));d=t();c=a;while(sb(c,b)){a=kb(c)/kb(b);a=Math.max(1,Math.floor(a));var e=Math.ceil(Math.log(a)/Math.LN2);e=e<=48?1:Math.pow(2,e-48);var f=qb(a),g=v(f,b);while(z(g)||rb(g,c))a=a-e,f=qb(a),g=v(f,b);nb(f)&&(f=Ta());d=cb(d,f);c=db(c,g)}return d}function eb(a,b){B();b=b&63;if(b===0)return a;else if(b<32)return new s(a.a1_1<<b,a.b1_1<<b|(a.a1_1>>>(32-b|0)|0));else return new s(0,a.a1_1<<(b-32|0))}function fb(a,b){B();b=b&63;if(b===0)return a;else if(b<32)return new s(a.a1_1>>>b|0|a.b1_1<<(32-b|0),a.b1_1>>b);else return new s(a.b1_1>>(b-32|0),a.b1_1>=0?0:-1)}function gb(a,b){B();return new s(a.a1_1&b.a1_1,a.b1_1&b.b1_1)}function hb(a){B();return new s(~a.a1_1,~a.b1_1)}function ib(a){B();return L(a.a1_1)}function jb(a){B();return a.a1_1}function kb(a){B();return a.b1_1*4294967296+tb(a)}function lb(a,b){B();if(nb(a))return"0";if(z(a))if(x(a,u())){var c=y(b),d=w(a,c);c=jb(db(v(d,c),a));d=lb(d,b);return d+c.toString(b)}else return"-"+lb(A(a),b);d=b===2?31:b<=10?9:b<=21?7:b<=35?6:5;c=qb(Math.pow(b,d));a=a;var e="";while(!0){var f=w(a,c),g=jb(db(a,v(f,c)));g=g.toString(b);a=f;if(nb(a))return g+e;else{while(g.length<d)g="0"+g;e=g+e}}}function x(a,b){B();return a.b1_1===b.b1_1&&a.a1_1===b.a1_1}function mb(a){B();return a.a1_1^a.b1_1}function y(a){B();return new s(a,a<0?-1:0)}function z(a){B();return a.b1_1<0}function nb(a){B();return a.b1_1===0&&a.a1_1===0}function ob(a){B();return(a.a1_1&1)===1}function A(a){B();return cb(hb(a),new s(1,0))}function pb(a,b){B();return bb(a,b)<0}function qb(a){B();if(Tc(a))return t();else if(a<=-9223372036854776e3)return u();else if(a+1>=9223372036854776e3)return Xa();else if(a<0)return A(qb(-a));else{var b=4294967296,c=a%b|0;a=a/b|0;return new s(c,a)}}function rb(a,b){B();return bb(a,b)>0}function sb(a,b){B();return bb(a,b)>=0}function tb(a){B();return a.a1_1>=0?a.a1_1:4294967296+a.a1_1}var ub;function B(){ub||(ub=!0,Sa=y(0),Ua=y(1),Wa=y(-1),Ya=new s(-1,2147483647),Za=new s(0,-2147483648),ab=y(16777216))}function C(a,b){return a.charCodeAt(b)}function vb(a,b){a=a;b=b;if(a===b)return!0;if(a==null||b==null||!Cc(b)||a.length!=b.length)return!1;var c=0,d=a.length;if(c<d)do{var e=c;c=c+1|0;if(!E(a[e],b[e]))return!1}while(c<d);return!0}function wb(a){a=a;if(a==null)return 0;var b=1,c=0,d=a.length;if(c<d)do{var e=c;c=c+1|0;b=g(b,31)+F(a[e])|0}while(c<d);return b}function xb(a){return da(a,", ","[","]",N,N,yb)}function yb(a){return G(a)}function zb(){throw xe()}function Ab(a){var b=Gb(a),c=Hb(),d=Ib(),e=Jb(),f=Kb(a),g=Lb(a);a=Nb(a);return Bb(b,c,d,e,f,g,a,Ob)}function Bb(a,b,c,d,e,f,g,h){var i=D(I(Eb));i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=f;$b(i,"size",a,N,!0);var j=i;return Object.assign(j,{add:function(a){b(a);return this},"delete":c,clear:d,has:e,keys:f,values:f,entries:g,forEach:function(a,b){h(a,j,b)}})}function Cb(a,b){var c;b===N?c=Pb:c=b;b=c;var d=Qb(a),e=Rb(a);c={next:function(){var a={done:!e()};a.done||(a.value=b(d()));return a}};c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=function(){return this};return c}function Db(a,b,c){c=c===N?void 0:c;var d=b.entries(),e=d.next();while(!e.done){var f=e.value;a.call(c,f[1],f[0],b);e=d.next()}}function Eb(){Set.call(this)}function Fb(a){var b=$d();Db(Sb(b),a);return b.f1()}function Gb(a){return function(){return a.i()}}function Hb(){var a=function(){zb();return Wc};a.callableName="UNSUPPORTED_OPERATION";return a}function Ib(){var a=function(){zb();return Wc};a.callableName="UNSUPPORTED_OPERATION";return a}function Jb(){var a=function(){zb();return Wc};a.callableName="UNSUPPORTED_OPERATION";return a}function Kb(a){return function(b){return a.k(b)}}function Lb(a){return function(){return Cb(a.f())}}function Mb(a){return[a,a]}function Nb(a){return function(){var b=a.f();return Cb(b,Mb)}}function Ob(a,b,c){Db(a,b,c);return Wc}function Pb(a){return a}function Qb(a){return function(){return a.h()}}function Rb(a){return function(){return a.g()}}function Sb(a){return function(b,c,d){a.d(c);return Wc}}function Tb(a,b){var c;switch(typeof a){case"number":var d;typeof b==="number"?d=Ub(a,b):b instanceof s?d=Ub(a,kb(b)):d=Vb(a,b);c=d;break;case"string":case"boolean":case"bigint":c=Vb(a,b);break;default:c=Wb(a,b);break}return c}function Ub(a,b){var c;if(a<b)c=-1;else if(a>b)c=1;else if(a===b){var d;if(a!==0)d=0;else{var e=1/a,f;e===1/b?f=0:e<0?f=-1:f=1;d=f}c=d}else a!==a?c=b!==b?0:1:c=-1;return c}function Vb(a,b){return a<b?-1:a>b?1:0}function Wb(a,b){return a.v(b)}function Xb(a){return Yb(a)}function Yb(b){if(!("kotlinHashCodeValue$"in b)){var a=Zb(),c=new Object();c.value=a;c.enumerable=!1;Object.defineProperty(b,"kotlinHashCodeValue$",c)}return b.kotlinHashCodeValue$}function Zb(){return Math.random()*4294967296|0}function D(a){a=a===N?null:a;return Object.create(a)}function $b(a,b,c,d,e){return Object.defineProperty(a,b,{configurable:!0,get:c,set:d,enumerable:e})}function E(a,b){if(a==null)return b==null;if(b==null)return!1;if(typeof a==="object"&&typeof a.equals==="function")return a.equals(b);if(a!==a)return b!==b;if(typeof a==="number"&&typeof b==="number"){if(a===b){var c;if(a!==0)c=!0;else{var d=1/a;c=d===1/b}d=c}else d=!1;return d}return a===b}function F(a){if(a==null)return 0;var b=typeof a,c;switch(b){case"object":c="function"===typeof a.hashCode?a.hashCode():Yb(a);break;case"function":c=Yb(a);break;case"number":c=Pa(a);break;case"boolean":c=ac(a);break;case"string":c=bc(String(a));break;case"bigint":c=cc(a);break;case"symbol":c=dc(a);break;default:c=function(){throw new Error("Unexpected typeof `"+b+"`")}();break}return c}function G(a){var b;a==null?b="null":Cc(a)?b="[...]":!(typeof a.toString==="function")?b=ec(a):b=a.toString();return b}function ac(a){return a?1231:1237}function bc(b){var a=0,c=b.length,d=0;c=c-1|0;if(d<=c)do{var e=d;d=d+1|0;var f=b.charCodeAt(e);a=g(a,31)+f|0}while(!(e===c));return a}function cc(b){var c=BigInt(32),d=BigInt(4294967295),e=za(b),a=0;b<0?b=-1:b=1;b=b;$l$loop:while(!0){if(e==0)break $l$loop;var f=e&d;f=Number(f);a=g(31,a)+f|0;e=e>>c}return g(a,b)}function dc(a){var b=fc(a)?gc():hc(),c=b.get(a);if(c!==N)return c;c=Zb();b.set(a,c);return c}function ec(a){return Object.prototype.toString.call(a)}function fc(a){return(typeof Symbol==="function"?Symbol.keyFor:"@@keyFor")(a)!=N}function gc(){ic===N&&(ic=new Map());return ic}function hc(){jc===N&&(jc=new WeakMap());return jc}var ic,jc;function H(a,b){Error.captureStackTrace!=null?Error.captureStackTrace(a,b):a.stack=new Error().stack}function I(a){return a.prototype}function kc(a,b){if(lc(a)){var c;if(lc(b))c=a;else{b=b==null?null:b.toString();c=b==null?N:b}b=c}else b=a==null?N:a;return b}function lc(a){return a===N}function mc(a,b,c){nc(a,"message",kc(b,c)),nc(a,"cause",c),nc(a,"name",Object.getPrototypeOf(a).constructor.name)}function nc(a,b,c){Object.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}function oc(a){var b;a==null?pc():b=a;return b}function pc(){throw Ue()}function qc(){throw Xe()}function rc(){throw $e()}function sc(a){throw U(a)}function tc(a,b,c,d,e,f){var g=N,h=a==="interface"?uc():N;return{kind:a,simpleName:b,associatedObjectKey:d,associatedObjects:e,suspendArity:f,$kClass$:g,defaultConstructor:c,iid:h}}function uc(){vc===N&&(vc=0);vc=vc+1|0;return vc}var vc;function J(a,b,c,d,e,f,g,h){var i="class";wc(i,a,b,c,d,e,f,g,h)}function wc(a,b,c,d,e,f,g,h,i){e==null||(b.prototype=Object.create(e.prototype),b.prototype.constructor=b);e=tc(a,c,d,h,i,g);b.$metadata$=e;if(!(f==null)){a=E(e.iid,N)?b.prototype:b;a.$imask$=Aa(f)}}function xc(a,b,c,d,e,f,g,h){var i="object";wc(i,a,b,c,d,e,f,g,h)}function K(a,b,c,d,e,f,g,h){var i="interface";wc(i,a,b,c,d,e,f,g,h)}function yc(a,b,c,d){xc(a,"Companion",N,b,c,d,N,N)}function zc(a){var b=0,c=0,d=a.length-1|0;if(c<=d)do{var e=c;c=c+1|0;var f=b;b=f+a[e].length|0}while(!(e===d));f=a[0];e=new f.constructor(b);f.$type$!=null&&(e.$type$=f.$type$);b=0;c=0;d=a.length-1|0;if(c<=d)do{f=c;c=c+1|0;var g=a[f],h=0,i=g.length-1|0;if(h<=i)do{var j=h;h=h+1|0;var k=b;b=k+1|0;e[k]=g[j]}while(!(j===i))}while(!(f===d));return e}function L(a){return a<<24>>24}function Ac(a){var b;a instanceof s?b=jb(a):b=Bc(a);return b}function Bc(a){var b;a>2147483647?b=2147483647:a<-2147483648?b=-2147483648:b=a|0;return b}function Cc(a){return Dc(a)||h(a)}function Dc(a){return Array.isArray(a)}function M(a,b){return Ec(a,b.$metadata$.iid)}function Ec(a,b){a=a.$imask$;if(a==null)return!1;else a=a;a=a;return Da(a,b)}function Fc(a){return typeof a==="string"||M(a,j)}var N,Gc;function Hc(){Gc||(Gc=!0,N=void 0)}function Hc(a,b){return vb(a,b)}function Ic(a){return wb(a)}function Jc(a,b,c){Z.h1(b,c,a.length);return a.slice(b,c)}function Kc(a,b){if(!(b>=0)){var c="Invalid new array size: "+b+".";throw U(G(c))}return bf(a,new Int8Array(b))}function Lc(a,b){if(!(b>=0)){var c="Invalid new array size: "+b+".";throw U(G(c))}return bf(a,new Int32Array(b))}function Mc(a,b){if(!(b>=0)){var c="Invalid new array size: "+b+".";throw U(G(c))}return cf(a,b,null)}function Nc(a){a=ma(a);var b=Oc(Rc().i1_1,a);a=a-Rc().i1_1[b]|0;return a<10?a:-1}function Oc(a,b){var c=0,d=a.length-1|0,e=-1,f=0;while(c<=d){e=(c+d|0)/2|0;f=a[e];if(b>f)c=e+1|0;else if(b===f)return e;else d=e-1|0}return e-(b<f?1:0)|0}function Pc(){Qc=this;var a=this;a.i1_1=new Int32Array([48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296])}var Qc;function Rc(){Qc==null&&new Pc();return Qc}function Sc(){}function Tc(a){return!(a===a)}function Uc(a){var b;a===0?b=0:b=1<<(31-i(a)|0);return b}function Vc(){}I(Vc).toString=function(){return"kotlin.Unit"};var Wc;function Xc(a){return Jf(a)}function Yc(a){a=[a];return new Q(a)}function Zc(a){return Uf([a])}function $c(a){return a}function ad(a,b,c,d,e){Z.h1(d,e,a.length);var f=e-d|0;Z.h1(c,c+f|0,b.length);if(h(b)&&h(a)){e=a.subarray(d,e);b.set(e,c)}else if(!(a===b)||c<=d){e=0;if(e<f)do{var g=e;e=e+1|0;b[c+g|0]=a[d+g|0]}while(e<f)}else{g=f-1|0;if(0<=g)do{e=g;g=g+-1|0;b[c+e|0]=a[d+e|0]}while(0<=g)}}function O(){Y.call(this)}I(O).toJSON=function(){return this.toArray()};I(O).j1=function(){};function bd(a){this.m1_1=a,this.k1_1=0,this.l1_1=-1}I(bd).g=function(){return this.k1_1<this.m1_1.i()};I(bd).h=function(){if(!this.g())throw X();var a=this,b=this.k1_1;this.k1_1=b+1|0;a.l1_1=b;return this.m1_1.l(this.l1_1)};function P(){O.call(this),this.n1_1=0}I(P).d=function(a){this.j1();this.o1(this.i(),a);return!0};I(P).f=function(){return new bd(this)};I(P).k=function(a){return this.p1(a)>=0};I(P).p1=function(a){$l$block:{var b=0,c=this.f();while(c.g()){var d=c.h();if(E(d,a)){d=b;break $l$block}b=b+1|0}d=-1}return d};I(P).equals=function(a){if(a===this)return!0;return!(a==null?!1:M(a,p))?!1:Z.q1(this,a)};I(P).hashCode=function(){return Z.r1(this)};function cd(){O.call(this)}I(cd).equals=function(a){if(a===this)return!0;return!(a==null?!1:M(a,ra))?!1:If.s1(this,a)};I(cd).hashCode=function(){return If.t1(this)};function dd(a){if(!(a>=0)){var b="capacity must be non-negative.";throw U(G(b))}return Array(a)}function ed(a,b,c){a.fill(null,b,c)}function fd(a,b){return Mc(a,b)}function gd(){hd=this;var a=this,b=md(0);b.c_1=!0;a.u1_1=b}var hd;function id(){hd==null&&new gd();return hd}function jd(a){var b=[];Q.call(a,b);return a}function kd(){return jd(D(I(Q)))}function ld(a,b){var c=[];Q.call(b,c);if(!(a>=0)){c="Negative initial capacity: "+a;throw U(G(c))}return b}function md(a){return ld(a,D(I(Q)))}function nd(a,b){Z.v1(b,a.i());return b}function od(a,b){Z.w1(b,a.i());return b}function Q(a){id(),P.call(this),this.b_1=a,this.c_1=!1}I(Q).i=function(){return this.b_1.length};I(Q).l=function(a){a=this.b_1[nd(this,a)];return(a==null?!0:!(a==null))?a:rc()};I(Q).d=function(a){this.j1();this.b_1.push(a);this.n1_1=this.n1_1+1|0;return!0};I(Q).o1=function(a,b){this.j1(),this.b_1.splice(od(this,a),0,b),this.n1_1=this.n1_1+1|0};I(Q).p1=function(a){return ca(this.b_1,a)};I(Q).toString=function(){return xb(this.b_1)};I(Q).x1=function(){return[].slice.call(this.b_1)};I(Q).toArray=function(){return this.x1()};I(Q).j1=function(){if(this.c_1)throw xe()};function pd(a,b){cd.call(b);R.call(b);b.y1_1=a;return b}function qd(a){pd(zd(),a);return a}function rd(){return qd(D(I(R)))}function sd(a,b,c){pd(Dd(a,b),c);return c}function td(a,b){sd(a,1,b);return b}function ud(a){return td(a,D(I(R)))}I(R).d=function(a){return this.y1_1.z1(a,!0)==null};I(R).k=function(a){return this.y1_1.a2(a)};I(R).j=function(){return this.y1_1.i()===0};I(R).f=function(){return this.y1_1.b2()};I(R).i=function(){return this.y1_1.i()};function R(){}function vd(a,b){return Uc(g(ia(b,1),3))}function wd(a,b){return i(b)+1|0}function xd(a){if(!(a.m2_1.j2_1===a.o2_1))throw Re("The backing map has been modified after this entry was obtained.")}function yd(a){Ad(8,a);return a}function zd(){return yd(D(I(S)))}function Ad(a,b){S.call(b,dd(a),null,new Int32Array(a),new Int32Array(vd(Td,a)),2,0);return b}function Bd(a){return Ad(a,D(I(S)))}function Cd(a,b,c){Ad(a,c);if(!(b>0)){a="Non-positive load factor: "+b;throw U(G(a))}return c}function Dd(a,b){return Cd(a,b,D(I(S)))}function Ed(a){return a.c2_1.length}function Fd(a){return a.f2_1.length}function Gd(a){a.j2_1=a.j2_1+1|0}function Hd(a,b){Id(a,b)?Md(a,!0):Jd(a,a.h2_1+b|0)}function Id(a,b){var c=Ed(a)-a.h2_1|0,d=a.h2_1-a.i()|0;return c<b&&(d+c|0)>=b&&d>=(Ed(a)/4|0)}function Jd(a,b){if(b<0)throw Be("too many elements");if(b>Ed(a)){b=Z.p2(Ed(a),b);a.c2_1=fd(a.c2_1,b);var c=a,d=a.d2_1;c.d2_1=d==null?null:fd(d,b);a.e2_1=Lc(a.e2_1,b);c=vd(Td,b);c>Fd(a)&&Nd(a,c)}}function Kd(a){var b=a.d2_1;if(!(b==null))return b;b=dd(Ed(a));a.d2_1=b;return b}function Ld(a,b){return b==null?0:g(F(b),-1640531527)>>>a.i2_1|0}function Md(b,c){var d=0,e=0,f=b.d2_1;while(d<b.h2_1){var a=b.e2_1[d];a>=0&&(b.c2_1[e]=b.c2_1[d],f==null||(f[e]=f[d]),c&&(b.e2_1[e]=a,b.f2_1[a]=e+1|0),e=e+1|0);d=d+1|0}ed(b.c2_1,e,b.h2_1);f==null?null:ed(f,e,b.h2_1);b.h2_1=e}function Nd(a,b){Gd(a);a.h2_1>a.k2_1&&Md(a,!1);a.f2_1=new Int32Array(b);a.i2_1=wd(Td,b);b=0;while(b<a.h2_1){var c=b;b=c+1|0;if(!Od(a,c))throw ue("This cannot happen with fixed magic multiplier and grow-only hash array. Have object hashCodes changed?")}}function Od(a,b){var c=Ld(a,a.c2_1[b]),d=a.g2_1;while(!0){var e=a.f2_1[c];if(e===0){a.f2_1[c]=b+1|0;a.e2_1[b]=c;return!0}d=d-1|0;if(d<0)return!1;e=c;c=e-1|0;e===0&&(c=Fd(a)-1|0)}}function Pd(a,b){var c=Ld(a,b),d=a.g2_1;while(!0){var e=a.f2_1[c];if(e===0)return-1;if(e>0&&E(a.c2_1[e-1|0],b))return e-1|0;d=d-1|0;if(d<0)return-1;e=c;c=e-1|0;e===0&&(c=Fd(a)-1|0)}}function Qd(a,b){a.q2();retry:while(!0){var c=Ld(a,b),d=ja(g(a.g2_1,2),Fd(a)/2|0),e=0;while(!0){var f=a.f2_1[c];if(f<=0){if(a.h2_1>=Ed(a)){Hd(a,1);continue retry}var h=a.h2_1;a.h2_1=h+1|0;h=h;a.c2_1[h]=b;a.e2_1[h]=c;a.f2_1[c]=h+1|0;a.k2_1=a.k2_1+1|0;Gd(a);e>a.g2_1&&(a.g2_1=e);return h}if(E(a.c2_1[f-1|0],b))return-f|0;e=e+1|0;if(e>d){Nd(a,g(Fd(a),2));continue retry}h=c;c=h-1|0;h===0&&(c=Fd(a)-1|0)}}}function Rd(a,b){return a.k2_1===b.i()&&a.r2(b.p())}function Sd(){this.s2_1=-1640531527,this.t2_1=8,this.u2_1=2,this.v2_1=-1}var Td;function Ud(a){this.w2_1=a,this.x2_1=0,this.y2_1=-1,this.z2_1=this.w2_1.j2_1,this.a3()}I(Ud).a3=function(){while(this.x2_1<this.w2_1.h2_1&&this.w2_1.e2_1[this.x2_1]<0)this.x2_1=this.x2_1+1|0};I(Ud).g=function(){return this.x2_1<this.w2_1.h2_1};I(Ud).b3=function(){if(!(this.w2_1.j2_1===this.z2_1))throw Pe()};function Vd(a){Ud.call(this,a)}I(Vd).h=function(){this.b3();if(this.x2_1>=this.w2_1.h2_1)throw X();var a=this,b=this.x2_1;this.x2_1=b+1|0;a.y2_1=b;a=this.w2_1.c2_1[this.y2_1];this.a3();return a};function Wd(a){Ud.call(this,a)}I(Wd).h=function(){this.b3();if(this.x2_1>=this.w2_1.h2_1)throw X();var a=this,b=this.x2_1;this.x2_1=b+1|0;a.y2_1=b;a=new Xd(this.w2_1,this.y2_1);this.a3();return a};I(Wd).k3=function(){if(this.x2_1>=this.w2_1.h2_1)throw X();var a=this,b=this.x2_1;this.x2_1=b+1|0;a.y2_1=b;a=this.w2_1.c2_1[this.y2_1];b=a==null?null:F(a);a=b==null?0:b;b=oc(this.w2_1.d2_1)[this.y2_1];b=b==null?null:F(b);a=a^(b==null?0:b);this.a3();return a};I(Wd).l3=function(a){if(this.x2_1>=this.w2_1.h2_1)throw X();var b=this,c=this.x2_1;this.x2_1=c+1|0;b.y2_1=c;b=this.w2_1.c2_1[this.y2_1];E(b,this.w2_1)?a.o3("(this Map)"):a.n3(b);a.p3(n(61));c=oc(this.w2_1.d2_1)[this.y2_1];E(c,this.w2_1)?a.o3("(this Map)"):a.n3(c);this.a3()};function Xd(a,b){this.m2_1=a,this.n2_1=b,this.o2_1=this.m2_1.j2_1}I(Xd).n=function(){xd(this);return this.m2_1.c2_1[this.n2_1]};I(Xd).o=function(){xd(this);return oc(this.m2_1.d2_1)[this.n2_1]};I(Xd).equals=function(a){var b;(a==null?!1:M(a,sa))?b=E(a.n(),this.n()):b=!1;b?b=E(a.o(),this.o()):b=!1;return b};I(Xd).hashCode=function(){var a=this.n();a=a==null?null:F(a);a=a==null?0:a;var b=this.o();b=b==null?null:F(b);return a^(b==null?0:b)};I(Xd).toString=function(){return va(this.n())+"="+va(this.o())};function S(a,b,c,d,e,f){this.c2_1=a,this.d2_1=b,this.e2_1=c,this.f2_1=d,this.g2_1=e,this.h2_1=f,this.i2_1=wd(Td,Fd(this)),this.j2_1=0,this.k2_1=0,this.l2_1=!1}I(S).i=function(){return this.k2_1};I(S).q3=function(){this.q2(),this.l2_1=!0};I(S).a2=function(a){return Pd(this,a)>=0};I(S).z1=function(a,b){a=Qd(this,a);var c=Kd(this);if(a<0){var d=c[(-a|0)-1|0];c[(-a|0)-1|0]=b;return d}else{c[a]=b;return null}};I(S).equals=function(a){var b;if(a===this)b=!0;else{(a==null?!1:M(a,ta))?a=Rd(this,a):a=!1;b=a}return b};I(S).hashCode=function(){var a=0,b=this.r3();while(b.g())a=a+b.k3()|0;return a};I(S).toString=function(){var a=hf(2+g(this.k2_1,3)|0);a.o3("{");var b=0,c=this.r3();while(c.g())b>0&&a.o3(", "),c.l3(a),b=b+1|0;a.o3("}");return a.toString()};I(S).q2=function(){if(this.l2_1)throw xe()};I(S).s3=function(a){var b=Pd(this,a.n());return b<0?!1:E(oc(this.d2_1)[b],a.o())};I(S).t3=function(a){return this.s3(M(a,sa)?a:rc())};I(S).b2=function(){return new Vd(this)};I(S).r3=function(){return new Wd(this)};function Yd(){}function Zd(a){qd(a);ie.call(a);return a}function $d(){return Zd(D(I(ie)))}function ae(a,b,c){sd(a,b,c);ie.call(c);return c}function be(a,b){ae(a,1,b);return b}function ce(a){return be(a,D(I(ie)))}function de(a,b){pd(a,b);ie.call(b);return b}function ee(a){return de(a,D(I(ie)))}function fe(){ge=this;var a=this,b=Bd(0);b.q3();a.u3_1=ee(b)}var ge;function he(){ge==null&&new fe();return ge}I(ie).f1=function(){this.y1_1.q3();return this.i()>0?this:he().u3_1};function ie(){}function je(a){mc(a);T.call(a);return a}function ke(){var a=je(D(I(T)));H(a,ke);return a}function le(a,b){mc(b,a);T.call(b);return b}function me(a){a=le(a,D(I(T)));H(a,me);return a}function T(){H(this,T)}function ne(a){V(a);qe.call(a);return a}function oe(){var a=ne(D(I(qe)));H(a,oe);return a}function pe(a,b){Ae(a,b);qe.call(b);return b}function U(a){a=pe(a,D(I(qe)));H(a,U);return a}function qe(){H(this,qe)}function re(a){V(a);ve.call(a);return a}function se(){var a=re(D(I(ve)));H(a,se);return a}function te(a,b){Ae(a,b);ve.call(b);return b}function ue(a){a=te(a,D(I(ve)));H(a,ue);return a}function ve(){H(this,ve)}function we(a){V(a);ye.call(a);return a}function xe(){var a=we(D(I(ye)));H(a,xe);return a}function ye(){H(this,ye)}function V(a){je(a);W.call(a);return a}function ze(){var a=V(D(I(W)));H(a,ze);return a}function Ae(a,b){le(a,b);W.call(b);return b}function Be(a){a=Ae(a,D(I(W)));H(a,Be);return a}function W(){H(this,W)}function Ce(a){V(a);De.call(a);return a}function X(){var a=Ce(D(I(De)));H(a,X);return a}function De(){H(this,De)}function Ee(a){V(a);Ie.call(a);return a}function Fe(){var a=Ee(D(I(Ie)));H(a,Fe);return a}function Ge(a,b){Ae(a,b);Ie.call(b);return b}function He(a){a=Ge(a,D(I(Ie)));H(a,He);return a}function Ie(){H(this,Ie)}function Je(a){ne(a);Ne.call(a);return a}function Ke(){var a=Je(D(I(Ne)));H(a,Ke);return a}function Le(a,b){pe(a,b);Ne.call(b);return b}function Me(a){a=Le(a,D(I(Ne)));H(a,Me);return a}function Ne(){H(this,Ne)}function Oe(a){V(a);Se.call(a);return a}function Pe(){var a=Oe(D(I(Se)));H(a,Pe);return a}function Qe(a,b){Ae(a,b);Se.call(b);return b}function Re(a){a=Qe(a,D(I(Se)));H(a,Re);return a}function Se(){H(this,Se)}function Te(a){V(a);Ve.call(a);return a}function Ue(){var a=Te(D(I(Ve)));H(a,Ue);return a}function Ve(){H(this,Ve)}function We(a){V(a);Ye.call(a);return a}function Xe(){var a=We(D(I(Ye)));H(a,Xe);return a}function Ye(){H(this,Ye)}function Ze(a){V(a);af.call(a);return a}function $e(){var a=Ze(D(I(af)));H(a,$e);return a}function af(){H(this,af)}function bf(a,b){var c=a.length,d=b.length,e=0,f=b;while(e<c&&e<d){var g=e,h=e;e=h+1|0;f[g]=a[h]}return b}function cf(a,b,c){var d=a.slice(0,b);a.$type$!==void 0&&(d.$type$=a.$type$);a=a.length;if(b>a){d.length=b;while(a<b){var e=a;a=e+1|0;d[e]=c}}return d}function df(a){ff.call(a,null);return a}function ef(){var a=df(D(I(ff)));H(a,ef);return a}function ff(a){le(a,this),H(this,ff)}function gf(a,b){jf(b);return b}function hf(a){return gf(a,D(I(lf)))}function jf(a){lf.call(a,"");return a}function kf(){return jf(D(I(lf)))}function lf(a){this.m3_1=a}I(lf).p3=function(a){this.m3_1=this.m3_1+na(a);return this};I(lf).e=function(a){this.m3_1=this.m3_1+va(a);return this};I(lf).n3=function(a){this.m3_1=this.m3_1+va(a);return this};I(lf).o3=function(a){var b=this,c=this.m3_1;b.m3_1=c+(a==null?"null":a);return this};I(lf).toString=function(){return this.m3_1};function mf(a){var b=na(a).toUpperCase();return b.length>1?a:C(b,0)}function nf(a){if(!(2<=a?a<=36:!1))throw U("radix "+a+" was not in valid range 2..36");return a}function of(a){var b=Yf(a),c;b==null?Zf(a):c=b;return c}function pf(a,b){a=o(a,n(48))>=0&&o(a,n(57))<=0?la(a,n(48)):o(a,n(65))>=0&&o(a,n(90))<=0?la(a,n(65))+10|0:o(a,n(97))>=0&&o(a,n(122))<=0?la(a,n(97))+10|0:o(a,n(128))<0?-1:o(a,n(65313))>=0&&o(a,n(65338))<=0?la(a,n(65313))+10|0:o(a,n(65345))>=0&&o(a,n(65370))<=0?la(a,n(65345))+10|0:Nc(a);return a>=b?-1:a}function qf(a,b,c){c=c===N?!1:c;vf();if(c){c=a.length;var d=b.length,e=Math.min(c,d);if(e===0)return c-d|0;var f=0;if(f<e)do{var g=f;f=f+1|0;var h=C(a,g);g=C(b,g);if(!(h===g)){h=mf(h);g=mf(g);if(!(h===g)){var i=h;i=na(i).toLowerCase();h=C(i,0);i=g;i=na(i).toLowerCase();g=C(i,0);if(!(h===g))return o(h,g)}}}while(f<e);return c-d|0}else return Tb(a,b)}function rf(a){vf();return yf(a,0,a.length,!1)}function sf(a){this.x3_1=a}I(sf).y3=function(a,b){return this.x3_1(a,b)};I(sf).compare=function(a,b){return this.y3(a,b)};I(sf).d1=function(){return this.x3_1};I(sf).equals=function(a){if(a==null?!1:M(a,Sc)){(a==null?!1:M(a,Ea))?a=E(this.d1(),a.d1()):a=!1;a=a}else a=!1;return a};I(sf).hashCode=function(){return F(this.d1())};function tf(a,b){vf();return qf(a,b,!0)}var uf;function vf(){if(!uf){uf=!0;var a=tf;new sf(a)}}function wf(){Cf();return xf}var xf;function yf(a,b,c,d){Cf();if(!(b>=0&&c<=a.length&&b<=c)){var e="Failed requirement.";throw U(G(e))}e=new Int8Array(g(c-b|0,3));var f=0;b=b;while(b<c){var h=b;b=h+1|0;h=C(a,h);h=ma(h);if(h<128){var i=f;f=i+1|0;e[i]=L(h)}else if(h<2048){i=f;f=i+1|0;e[i]=L(h>>6|192);i=f;f=i+1|0;e[i]=L(h&63|128)}else if(h<55296||h>=57344){i=f;f=i+1|0;e[i]=L(h>>12|224);i=f;f=i+1|0;e[i]=L(h>>6&63|128);i=f;f=i+1|0;e[i]=L(h&63|128)}else{i=zf(a,h,b,c,d);if(i<=0){h=f;f=h+1|0;e[h]=wf()[0];h=f;f=h+1|0;e[h]=wf()[1];h=f;f=h+1|0;e[h]=wf()[2]}else{h=f;f=h+1|0;e[h]=L(i>>18|240);h=f;f=h+1|0;e[h]=L(i>>12&63|128);h=f;f=h+1|0;e[h]=L(i>>6&63|128);h=f;f=h+1|0;e[h]=L(i&63|128);b=b+1|0}}}return e.length===f?e:Kc(e,f)}function zf(a,b,c,d,e){Cf();if(!(55296<=b?b<=56319:!1)||c>=d)return Af(0,c,e);d=C(a,c);a=ma(d);return!(56320<=a?a<=57343:!1)?Af(0,c,e):65536+((b&1023)<<10)|0|a&1023}function Af(a,b,c){Cf();if(c)throw new ff("Malformed sequence starting at "+(b-1|0));return-a|0}var Bf;function Cf(){Bf||(Bf=!0,xf=new Int8Array([-17,-65,-67]))}function Df(a){return function(b){return b===a?"(this Collection)":va(b)}}function Y(){}I(Y).k=function(a){$l$block_0:{var b;M(this,q)?b=this.j():b=!1;if(b){b=!1;break $l$block_0}var c=this.f();while(c.g()){var d=c.h();if(E(d,a)){b=!0;break $l$block_0}}b=!1}return b};I(Y).m=function(a){$l$block_0:{var b;M(a,q)?b=a.j():b=!1;if(b){b=!0;break $l$block_0}a=a.f();while(a.g()){var c=a.h();if(!this.k(c)){b=!1;break $l$block_0}}b=!0}return b};I(Y).j=function(){return this.i()===0};I(Y).toString=function(){return ga(this,", ","[","]",N,N,Df(this))};I(Y).toArray=function(){return Xc(this)};function Ef(a){this.a4_1=a,this.z3_1=0}I(Ef).g=function(){return this.z3_1<this.a4_1.i()};I(Ef).h=function(){if(!this.g())throw X();var a=this.z3_1;this.z3_1=a+1|0;return this.a4_1.l(a)};function Ff(){this.g1_1=2147483639}I(Ff).v1=function(a,b){if(a<0||a>=b)throw He("index: "+a+", size: "+b)};I(Ff).w1=function(a,b){if(a<0||a>b)throw He("index: "+a+", size: "+b)};I(Ff).h1=function(a,b,c){if(a<0||b>c)throw He("fromIndex: "+a+", toIndex: "+b+", size: "+c);if(a>b)throw U("fromIndex: "+a+" > toIndex: "+b)};I(Ff).p2=function(a,b){a=a+(a>>1)|0;(a-b|0)<0&&(a=b);(a-2147483639|0)>0&&(a=b>2147483639?2147483647:2147483639);return a};I(Ff).r1=function(b){var a=1;b=b.f();while(b.g()){var c=b.h(),d=g(31,a);c=c==null?null:F(c);a=d+(c==null?0:c)|0}return a};I(Ff).q1=function(a,b){if(!(a.i()===b.i()))return!1;b=b.f();a=a.f();while(a.g()){var c=a.h(),d=b.h();if(!E(c,d))return!1}return!0};var Z;function Gf(){Y.call(this)}I(Gf).f=function(){return new Ef(this)};I(Gf).equals=function(a){if(a===this)return!0;return!(a==null?!1:M(a,p))?!1:Z.q1(this,a)};I(Gf).hashCode=function(){return Z.r1(this)};function Hf(){}I(Hf).t1=function(b){var a=0;b=b.f();while(b.g()){var c=b.h(),d=a;c=c==null?null:F(c);a=d+(c==null?0:c)|0}return a};I(Hf).s1=function(a,b){return!(a.i()===b.i())?!1:a.m(b)};var If;function Jf(a){if(a.j())return[];var b=a.i();b=Array(b);a=a.f();var c=0;while(a.g()){var d=c;c=d+1|0;b[d]=a.h()}return b}function Kf(){return Pf()}function Lf(){}I(Lf).g=function(){return!1};I(Lf).h=function(){throw X()};var Mf;function Nf(){Of=this,this.b4_1=new s(-1478467534,-1720727600)}I(Nf).equals=function(a){(a==null?!1:M(a,p))?a=a.j():a=!1;return a};I(Nf).hashCode=function(){return 1};I(Nf).toString=function(){return"[]"};I(Nf).i=function(){return 0};I(Nf).j=function(){return!0};I(Nf).f=function(){return Mf};var Of;function Pf(){Of==null&&new Nf();return Of}function Qf(a){return l(a)}function Rf(){return Tf()}function $(){Sf=this,this.c4_1=new s(1993859828,793161749)}I($).equals=function(a){(a==null?!1:M(a,ra))?a=a.j():a=!1;return a};I($).hashCode=function(){return 0};I($).toString=function(){return"[]"};I($).i=function(){return 0};I($).j=function(){return!0};I($).d4=function(a){return!1};I($).k=function(a){return!1;var b;b=rc();return this.d4(b)};I($).e4=function(a){return a.j()};I($).m=function(a){return this.e4(a)};I($).f=function(){return Mf};var Sf;function Tf(){Sf==null&&new $();return Sf}function Uf(a){return m(a,ud($c(a.length)))}function Vf(a){return new Wf(a)}function Wf(a){Gf.call(this),this.f4_1=a}I(Wf).i=function(){return this.f4_1.length};I(Wf).l=function(a){Z.v1(a,this.f4_1.length);return this.f4_1[a]};I(Wf).g4=function(a){if(a===null)return!1;var b=fa(this.f4_1,a.r_1);return b===a};I(Wf).k=function(a){return!(a instanceof r)?!1:this.g4(a instanceof r?a:rc())};function Xf(a,b,c){!(c==null)?a.e(c(b)):(b==null?!0:Fc(b))?a.e(b):b instanceof oa?a.p3(b.h4_1):a.e(G(b))}function Yf(a){return $f(a,10)}function Zf(a){throw Me("Invalid number format: '"+a+"'")}function $f(b,c){nf(c);var d=b.length;if(d===0)return null;var e,a,f,g=C(b,0);if(o(g,n(48))<0){if(d===1)return null;e=1;if(g===n(45))a=!0,f=new s(0,-2147483648);else if(g===n(43))a=!1,f=new s(1,-2147483648);else return null}else e=0,a=!1,f=new s(1,-2147483648);g=new s(1,-2147483648);g=w(g,y(36));var h=g,i=new s(0,0);e=e;if(e<d)do{var j=e;e=e+1|0;j=pf(C(b,j),c);if(j<0)return null;if(bb(i,h)<0)if(x(h,g)){var k=f;h=w(k,y(c));if(bb(i,h)<0)return null}else return null;k=i;i=v(k,y(c));k=i;var l=f;l=cb(l,y(j));if(bb(k,l)<0)return null;k=i;i=db(k,y(j))}while(e<d);return a?i:A(i)}I(cd).asJsReadonlySetView=a;I(S).r2=b;I($).asJsReadonlySetView=a;pa=new e();kd=new ua();Wc=new Vc();Td=new Sd();Z=new Ff();If=new Hf();Mf=new Lf();rd={getInstance:qa};f.KtSet=rd;f.primitiveArrayConcatwxgknw08pmlb=zc;f.VOID3gxj6tk5isa35=N;f.Exception_init_$Init$7nmtst2tre47=je;f.IllegalArgumentException_init_$Create$3ewkh27kzt8z8=U;f.RuntimeException_init_$Create$17ncyu0a6xfek=Be;f.Unit_instance1fbcbse1fwigr=Wc;f.arrayCopytctsywo3h7gj=ad;f.contentEquals1cdp6c846cfdi=Hc;f.contentHashCode25jw6rgkgywwr=Ic;f.copyOfRange3alro60z4hhf8=Jc;f.setOf45ia9pnfhe90=Qf;f.takeLast725nefakqsdr=c;f.toByteArray3caw0hip00os=d;f.toSet1glep2u1u9tcb=l;f.enumEntries20mr21zbe3az4=Vf;f.bitwiseAnd2g7wmsfd45l12=gb;f.convertToByte1epqhkuyxuz5a=ib;f.fromInt1lka3ktyu79a4=y;f.shiftRight2cr6y79ufiihy=fb;f.captureStack1fzi4aczwc4hg=H;f.defineProp3ur6h3slcvq4x=$b;f.initMetadataForClassbxx6q50dy2s7=J;f.initMetadataForCompanion1wyw17z38v6ac=yc;f.initMetadataForInterface1egvbzx539z91=K;f.objectCreate1ve4bgxiu4x98=D;f.protoOf180f3jzyo7rfj=I;f.encodeToByteArray1onwao0uakjfh=rf;f.toLongkk4waq8msp1k=of;f.Enum3alwj03lh1n41=r;f.Exceptiondt2hlxn7j7vw=T;f.Long2qws0ah9gnpki=s;f.THROW_IAE23kobfj9wdoxr=sc;f.noWhenBranchMatchedException2a6r7ubxgky5j=qc}),66);
__d("wa-kmp-syncd-engine-interfaces",["kotlin-kotlin-stdlib"],(function(a,b,c,d,e,f,g){var h;(h=d("kotlin-kotlin-stdlib")).initMetadataForCompanion1wyw17z38v6ac(l);h.initMetadataForClassbxx6q50dy2s7(q,"KmpSyncdCollectionName",h.VOID3gxj6tk5isa35,h.Enum3alwj03lh1n41);function a(a){var b;try{b=this.getForInternal(a)}catch(b){if(b instanceof d("kotlin-kotlin-stdlib").Exceptiondt2hlxn7j7vw){a=b;throw new J(a)}else throw b}return b}h.initMetadataForInterface1egvbzx539z91(ea,"KmpDerivedSyncdKeysProvider");h.initMetadataForClassbxx6q50dy2s7(w,"KmpSyncdCryptoActionData");h.initMetadataForClassbxx6q50dy2s7(x,"KmpSyncdCryptoDerivedKeys");h.initMetadataForCompanion1wyw17z38v6ac(ha);h.initMetadataForClassbxx6q50dy2s7(y,"KmpSyncdCryptoEncryptedData");h.initMetadataForClassbxx6q50dy2s7(z,"KmpSyncdCryptoMutationData");h.initMetadataForClassbxx6q50dy2s7(A,"KmpSyncdCryptoMutationKey");h.initMetadataForClassbxx6q50dy2s7(B,"KmpSyncdCryptoMutationKeyId");h.initMetadataForClassbxx6q50dy2s7(D,"KmpSyncdCryptoMutationOperation",h.VOID3gxj6tk5isa35,h.Enum3alwj03lh1n41);h.initMetadataForInterface1egvbzx539z91(pa,"KmpSyncdCryptoProvider");function b(a,b,c,d){return this.createInternal(a,b,c,d)}h.initMetadataForInterface1egvbzx539z91(qa,"KmpSyncdMutationDataFactory");h.initMetadataForInterface1egvbzx539z91(G,"KmpSyncdEncryptionProtobufProvider");h.initMetadataForInterface1egvbzx539z91(ra,"KmpSyncdProtobufProvider",h.VOID3gxj6tk5isa35,h.VOID3gxj6tk5isa35,[G]);h.initMetadataForCompanion1wyw17z38v6ac(H);h.initMetadataForClassbxx6q50dy2s7(I,"KmpSyncdCipherException",I,h.Exceptiondt2hlxn7j7vw);h.initMetadataForClassbxx6q50dy2s7(J,"KmpSyncdKeyException",h.VOID3gxj6tk5isa35,h.Exceptiondt2hlxn7j7vw);h.initMetadataForClassbxx6q50dy2s7(K,"KmpSyncdMutationException",h.VOID3gxj6tk5isa35,h.Exceptiondt2hlxn7j7vw);h.initMetadataForCompanion1wyw17z38v6ac(L);h.initMetadataForClassbxx6q50dy2s7(O,"KmpSyncdMutationExceptionReason",h.VOID3gxj6tk5isa35,h.Enum3alwj03lh1n41);h.initMetadataForCompanion1wyw17z38v6ac(Na);h.initMetadataForClassbxx6q50dy2s7(P,"KmpSyncdParseException",h.VOID3gxj6tk5isa35,h.Exceptiondt2hlxn7j7vw);h.initMetadataForClassbxx6q50dy2s7(Q,"OpMode",h.VOID3gxj6tk5isa35,h.Enum3alwj03lh1n41);h.initMetadataForClassbxx6q50dy2s7(R,"MacAlgo",h.VOID3gxj6tk5isa35,h.Enum3alwj03lh1n41);h.initMetadataForClassbxx6q50dy2s7(W,"JsKmpDerivedSyncdKeysProviderImpl",h.VOID3gxj6tk5isa35,h.VOID3gxj6tk5isa35,[ea]);h.initMetadataForClassbxx6q50dy2s7(X,"JsKmpSyncdCryptoProviderImpl",h.VOID3gxj6tk5isa35,h.VOID3gxj6tk5isa35,[pa]);h.initMetadataForClassbxx6q50dy2s7(Y,"JsKmpSyncdMutationDataFactoryImpl",h.VOID3gxj6tk5isa35,h.VOID3gxj6tk5isa35,[qa]);h.initMetadataForClassbxx6q50dy2s7(bb,"JsKmpSyncdProtobufProviderImpl",h.VOID3gxj6tk5isa35,h.VOID3gxj6tk5isa35,[ra]);h.initMetadataForClassbxx6q50dy2s7(Z,"KmpResult");h.initMetadataForCompanion1wyw17z38v6ac(eb);h.initMetadataForClassbxx6q50dy2s7(fb,"KmpSyncdCryptoMutationKeyData");h.initMetadataForClassbxx6q50dy2s7($,"KmpLong");var i,j,k,aa,ba;function l(){m=this;var a=this,b=o();a.i4_1=d("kotlin-kotlin-stdlib").toSet1glep2u1u9tcb(b);this.j4_1=d("kotlin-kotlin-stdlib").setOf45ia9pnfhe90([u(),v()])}h.protoOf180f3jzyo7rfj(l).k4=function(a){var b=o();$l$block:{var c=0,e=b.length;while(c<e){var f=b[c];c=c+1|0;if(f.value===a){f=f;break $l$block}}f=null}c=f;if(c==null)throw d("kotlin-kotlin-stdlib").IllegalArgumentException_init_$Create$3ewkh27kzt8z8("Unknown collection name: "+a);else e=c;return e};h.protoOf180f3jzyo7rfj(l).n4=function(){return this.i4_1};h.protoOf180f3jzyo7rfj(l).o4=function(){return this.j4_1};var m;function n(){p();m==null&&new l();return m}function o(){return[r(),s(),t(),u(),v()]}function c(a){switch(a){case"Regular":return r();case"RegularLow":return s();case"RegularHigh":return t();case"CriticalBlock":return u();case"CriticalUnblockLow":return v();default:p();d("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.core.model.KmpSyncdCollectionName."+a);break}}function e(a){return n().k4(a)}function f(){return n().i4_1}function ca(){return n().j4_1}var da;function p(){if(da)return d("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;da=!0;i=new q("Regular",0,"regular");j=new q("RegularLow",1,"regular_low");k=new q("RegularHigh",2,"regular_high");aa=new q("CriticalBlock",3,"critical_block");ba=new q("CriticalUnblockLow",4,"critical_unblock_low");n()}function q(a,b,c){d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,a,b),this.value=c}h.protoOf180f3jzyo7rfj(q).o=function(){return this.value};h.protoOf180f3jzyo7rfj(q).toWamSyncdCollectionType=function(){var a;switch(this.r_1){case 0:a=1;break;case 1:a=2;break;case 2:a=3;break;case 3:a=4;break;case 4:a=5;break;default:d("kotlin-kotlin-stdlib").noWhenBranchMatchedException2a6r7ubxgky5j();break}return a};h.protoOf180f3jzyo7rfj(q).toString=function(){return d("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj(d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41).toString.call(this)};function r(){p();return i}function s(){p();return j}function t(){p();return k}function u(){p();return aa}function v(){p();return ba}function ea(){}function w(a){this.syncdActionData=a}h.protoOf180f3jzyo7rfj(w).p4=function(){return this.syncdActionData};h.protoOf180f3jzyo7rfj(w).toByteArray=function(){return this.syncdActionData};function x(a,b,c,d,e){this.indexKey=a,this.valueEncryptionKey=b,this.valueMacKey=c,this.snapshotMacKey=d,this.patchMacKey=e}h.protoOf180f3jzyo7rfj(x).q4=function(){return this.indexKey};h.protoOf180f3jzyo7rfj(x).r4=function(){return this.valueEncryptionKey};h.protoOf180f3jzyo7rfj(x).s4=function(){return this.valueMacKey};h.protoOf180f3jzyo7rfj(x).t4=function(){return this.snapshotMacKey};h.protoOf180f3jzyo7rfj(x).u4=function(){return this.patchMacKey};function fa(a,b,c,e,f){var g;if(e.length>32)g=d("kotlin-kotlin-stdlib").toByteArray3caw0hip00os(d("kotlin-kotlin-stdlib").takeLast725nefakqsdr(e,32));else{var h=new Int8Array(32),i=32-e.length|0,j=e.length,k=e;d("kotlin-kotlin-stdlib").arrayCopytctsywo3h7gj(k,h,i,0,j);g=h}y.call(f,a,b,c,e,g);return f}function ga(a,b,c,e){return fa(a,b,c,e,d("kotlin-kotlin-stdlib").objectCreate1ve4bgxiu4x98(d("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj(y)))}function ha(){this.v4_1=32}var ia;function ja(){return ia}function y(a,b,c,d,e){this.keyId=a,this.indexHash=b,this.operation=c,this.indexAndValueCipherText=d,this.mutationMac=e}h.protoOf180f3jzyo7rfj(y).w4=function(){return this.keyId};h.protoOf180f3jzyo7rfj(y).x4=function(){return this.indexHash};h.protoOf180f3jzyo7rfj(y).y4=function(){return this.operation};h.protoOf180f3jzyo7rfj(y).z4=function(){return this.indexAndValueCipherText};h.protoOf180f3jzyo7rfj(y).a5=function(){return this.mutationMac};function z(a,b,c,d,e,f){this.index=a,this.version=b,this.keyId=c,this.operation=d,this.value=e,this.mutationMac=f}h.protoOf180f3jzyo7rfj(z).b5=function(){return this.index};h.protoOf180f3jzyo7rfj(z).c5=function(){return this.version};h.protoOf180f3jzyo7rfj(z).w4=function(){return this.keyId};h.protoOf180f3jzyo7rfj(z).y4=function(){return this.operation};h.protoOf180f3jzyo7rfj(z).o=function(){return this.value};h.protoOf180f3jzyo7rfj(z).a5=function(){return this.mutationMac};function A(a,b){this.keyId=a,this.keyData=b}h.protoOf180f3jzyo7rfj(A).w4=function(){return this.keyId};h.protoOf180f3jzyo7rfj(A).d5=function(){return this.keyData};function B(a){this.bytes=a}h.protoOf180f3jzyo7rfj(B).e5=function(){return this.bytes};h.protoOf180f3jzyo7rfj(B).equals=function(a){a instanceof B?a=d("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(a.bytes,this.bytes):a=!1;return a};h.protoOf180f3jzyo7rfj(B).hashCode=function(){return d("kotlin-kotlin-stdlib").contentHashCode25jw6rgkgywwr(this.bytes)};var ka,la;function ma(){return[E(),F()]}function na(a){switch(a){case"Set":return E();case"Remove":return F();default:C();d("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.cryptomanager.KmpSyncdCryptoMutationOperation."+a);break}}var oa;function C(){if(oa)return d("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;oa=!0;ka=new D("Set",0,1);la=new D("Remove",1,2)}function D(a,b,c){d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,a,b),this.h5_1=c}h.protoOf180f3jzyo7rfj(D).asBytes=function(){return new Int8Array([this.h5_1])};function E(){C();return ka}function F(){C();return la}function pa(){}function qa(){}function G(){}function ra(){}function H(){this.i5_1="Data mac corrupt",this.j5_1="Index hash corrupt"}h.protoOf180f3jzyo7rfj(H).k5=function(){return this.i5_1};h.protoOf180f3jzyo7rfj(H).l5=function(){return this.j5_1};var sa;function ta(){return sa}function I(a,b){a=a===d("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:a,b=b===d("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:b,d("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),d("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,I),this.m5_1=a,this.n5_1=b,delete this.message,delete this.cause}h.protoOf180f3jzyo7rfj(I).v3=function(){return this.m5_1};h.protoOf180f3jzyo7rfj(I).w3=function(){return this.n5_1};function J(a){d("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),d("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,J),this.o5_1=a,delete this.cause}h.protoOf180f3jzyo7rfj(J).w3=function(){return this.o5_1};function K(a,b,c){b=b===d("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?"MalformedMutationException with reason="+a.toString():b,c=c===d("kotlin-kotlin-stdlib").VOID3gxj6tk5isa35?null:c,d("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),d("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,K),this.reason=a,this.p5_1=b,this.q5_1=c,delete this.message,delete this.cause}h.protoOf180f3jzyo7rfj(K).r5=function(){return this.reason};h.protoOf180f3jzyo7rfj(K).v3=function(){return this.p5_1};h.protoOf180f3jzyo7rfj(K).w3=function(){return this.q5_1};var ua,va,wa,xa,ya,za;function L(){}h.protoOf180f3jzyo7rfj(L).s5=function(a){var b=Da();$l$block:{b=b.f();while(b.g()){var c=b.h();if(c.code===a){c=c;break $l$block}}c=null}b=c;if(b==null)throw d("kotlin-kotlin-stdlib").IllegalArgumentException_init_$Create$3ewkh27kzt8z8("Unknown mutation exception reason: "+a);else c=b;return c};var M;function Aa(){return M}function Ba(){return[Ha(),Ia(),Ja(),Ka(),La(),Ma()]}function Ca(a){switch(a){case"UNPARSABLE":return Ha();case"MISSING_INDEX":return Ia();case"MISSING_VALUE":return Ja();case"MISSING_VERSION":return Ka();case"INVALID_INDEX_FORMAT":return La();case"MISSING_ACTION_TIMESTAMP":return Ma();default:N();d("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.exception.KmpSyncdMutationExceptionReason."+a);break}}function Da(){Ga==null&&(Ga=d("kotlin-kotlin-stdlib").enumEntries20mr21zbe3az4(Ba()));return Ga}function Ea(a){return M.s5(a)}var Fa;function N(){if(Fa)return d("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;Fa=!0;ua=new O("UNPARSABLE",0,0);va=new O("MISSING_INDEX",1,1);wa=new O("MISSING_VALUE",2,2);xa=new O("MISSING_VERSION",3,3);ya=new O("INVALID_INDEX_FORMAT",4,4);za=new O("MISSING_ACTION_TIMESTAMP",5,7)}var Ga;function O(a,b,c){d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,a,b),this.code=c}h.protoOf180f3jzyo7rfj(O).v5=function(){return this.code};function Ha(){N();return ua}function Ia(){N();return va}function Ja(){N();return wa}function Ka(){N();return xa}function La(){N();return ya}function Ma(){N();return za}function Na(){this.w5_1="Cipher text too short"}h.protoOf180f3jzyo7rfj(Na).x5=function(){return this.w5_1};var Oa;function Pa(){return Oa}function P(a){d("kotlin-kotlin-stdlib").Exception_init_$Init$7nmtst2tre47(this),d("kotlin-kotlin-stdlib").captureStack1fzi4aczwc4hg(this,P),this.y5_1=a,delete this.message}h.protoOf180f3jzyo7rfj(P).v3=function(){return this.y5_1};var Qa,Ra;function Sa(){return[S(),T()]}function Ta(a){switch(a){case"ENCRYPT":return S();case"DECRYPT":return T();default:Va();d("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.utils.primitives.OpMode."+a);break}}var Ua;function Va(){if(Ua)return d("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;Ua=!0;Qa=new Q("ENCRYPT",0);Ra=new Q("DECRYPT",1)}function Q(a,b){d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,a,b)}var Wa,Xa;function Ya(){return[U(),V()]}function Za(a){switch(a){case"HMAC_SHA_256":return U();case"HMAC_SHA_512":return V();default:ab();d("kotlin-kotlin-stdlib").THROW_IAE23kobfj9wdoxr("No enum constant com.whatsapp.kmp.syncd.syncdengine.utils.primitives.MacAlgo."+a);break}}var $a;function ab(){if($a)return d("kotlin-kotlin-stdlib").Unit_instance1fbcbse1fwigr;$a=!0;Wa=new R("HMAC_SHA_256",0);Xa=new R("HMAC_SHA_512",1)}function R(a,b){d("kotlin-kotlin-stdlib").Enum3alwj03lh1n41.call(this,a,b)}function S(){Va();return Qa}function T(){Va();return Ra}function U(){ab();return Wa}function V(){ab();return Xa}function W(a){this.d6_1=a}h.protoOf180f3jzyo7rfj(W).getForInternal=function(a){return this.d6_1.getForInternal(a)};function X(a){this.e6_1=a}h.protoOf180f3jzyo7rfj(X).createCipherText=function(a,b,c,d){return this.e6_1.createCipherText(a,b,c,d)};h.protoOf180f3jzyo7rfj(X).mac=function(a,b,c){return this.e6_1.mac(a,b,c)};h.protoOf180f3jzyo7rfj(X).generateRandomBytes=function(a){return this.e6_1.generateRandomBytes(a)};h.protoOf180f3jzyo7rfj(X).bytesToHexString=function(a){return this.e6_1.bytesToHexString(a)};function Y(a){this.f6_1=a}h.protoOf180f3jzyo7rfj(Y).createInternal=function(a,b,c,d){return this.f6_1.createInternal(a,b,c,d)};function bb(a){this.g6_1=a}h.protoOf180f3jzyo7rfj(bb).encodeMutationDataToSyncdActionData=function(a,b){return this.g6_1.encodeMutationDataToSyncdActionData(a,b)};function cb(a){return function(b){return a(b).toPromise()}}function db(a){return a}function Z(a){this.h6_1=a}h.protoOf180f3jzyo7rfj(Z).i6=function(a){a=this.h6_1.then(a);return new Z(a)};h.protoOf180f3jzyo7rfj(Z).j6=function(a){a=this.h6_1.then(cb(a));var b=db;a=a.then(b);return new Z(a)};h.protoOf180f3jzyo7rfj(Z).toPromise=function(){return this.h6_1};function eb(){}function fb(a){this.keyData=a}h.protoOf180f3jzyo7rfj(fb).d5=function(){return this.keyData};function gb(a,b){$.call(b);b.k6_1=d("kotlin-kotlin-stdlib").toLongkk4waq8msp1k(a);return b}function hb(a){return gb(a,d("kotlin-kotlin-stdlib").objectCreate1ve4bgxiu4x98(d("kotlin-kotlin-stdlib").protoOf180f3jzyo7rfj($)))}h.protoOf180f3jzyo7rfj($).o=function(){return this.k6_1};h.protoOf180f3jzyo7rfj($).toDecimalString=function(){return this.k6_1.toString()};function $(){}h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(q),"name",h.protoOf180f3jzyo7rfj(q).s);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(q),"ordinal",h.protoOf180f3jzyo7rfj(q).t);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(D),"name",h.protoOf180f3jzyo7rfj(D).s);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(D),"ordinal",h.protoOf180f3jzyo7rfj(D).t);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(I),"message",function(){return this.v3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(I),"cause",function(){return this.w3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(J),"cause",function(){return this.w3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(K),"message",function(){return this.v3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(K),"cause",function(){return this.w3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(O),"name",h.protoOf180f3jzyo7rfj(O).s);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(O),"ordinal",h.protoOf180f3jzyo7rfj(O).t);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(P),"message",function(){return this.v3()});h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(Q),"name",h.protoOf180f3jzyo7rfj(Q).s);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(Q),"ordinal",h.protoOf180f3jzyo7rfj(Q).t);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(R),"name",h.protoOf180f3jzyo7rfj(R).s);h.defineProp3ur6h3slcvq4x(h.protoOf180f3jzyo7rfj(R),"ordinal",h.protoOf180f3jzyo7rfj(R).t);h.protoOf180f3jzyo7rfj(W).getFor=a;h.protoOf180f3jzyo7rfj(Y).create=b;ia=new ha();sa=new H();M=new L();Oa=new Na();G=new eb();q.values=o;q.valueOf=c;q.fromString=e;h.defineProp3ur6h3slcvq4x(q,"Regular",r,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"RegularLow",s,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"RegularHigh",t,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"CriticalBlock",u,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"CriticalUnblockLow",v,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"ALL_COLLECTIONS",f,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"ALL_CRITICAL_COLLECTIONS",ca,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(q,"Companion",n,h.VOID3gxj6tk5isa35,!0);y.createAndCalculateMutationMac=ga;h.defineProp3ur6h3slcvq4x(y,"Companion",ja,h.VOID3gxj6tk5isa35,!0);D.values=ma;D.valueOf=na;h.defineProp3ur6h3slcvq4x(D,"Set",E,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(D,"Remove",F,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(I,"Companion",ta,h.VOID3gxj6tk5isa35,!0);O.values=Ba;O.valueOf=Ca;O.fromInt=Ea;h.defineProp3ur6h3slcvq4x(O,"UNPARSABLE",Ha,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"MISSING_INDEX",Ia,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"MISSING_VALUE",Ja,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"MISSING_VERSION",Ka,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"INVALID_INDEX_FORMAT",La,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"MISSING_ACTION_TIMESTAMP",Ma,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(O,"Companion",Aa,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(P,"Companion",Pa,h.VOID3gxj6tk5isa35,!0);Q.values=Sa;Q.valueOf=Ta;h.defineProp3ur6h3slcvq4x(Q,"ENCRYPT",S,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(Q,"DECRYPT",T,h.VOID3gxj6tk5isa35,!0);R.values=Ya;R.valueOf=Za;h.defineProp3ur6h3slcvq4x(R,"HMAC_SHA_256",U,h.VOID3gxj6tk5isa35,!0);h.defineProp3ur6h3slcvq4x(R,"HMAC_SHA_512",V,h.VOID3gxj6tk5isa35,!0);$.fromDecimalString=hb;g.KmpSyncdCollectionName=q;g.KmpSyncdCryptoActionData=w;g.KmpSyncdCryptoDerivedKeys=x;g.KmpSyncdCryptoEncryptedData=y;g.KmpSyncdCryptoMutationData=z;g.KmpSyncdCryptoMutationKey=A;g.KmpSyncdCryptoMutationKeyId=B;g.KmpSyncdCryptoMutationOperation=D;g.KmpSyncdCipherException=I;g.KmpSyncdKeyException=J;g.KmpSyncdMutationException=K;g.KmpSyncdMutationExceptionReason=O;g.KmpSyncdParseException=P;g.OpMode=Q;g.MacAlgo=R;g.JsKmpDerivedSyncdKeysProviderImpl=W;g.JsKmpSyncdCryptoProviderImpl=X;g.JsKmpSyncdMutationDataFactoryImpl=Y;g.JsKmpSyncdProtobufProviderImpl=bb;g.KmpResult=Z;g.KmpSyncdCryptoMutationKeyData=fb;g.KmpLong=$;g.KmpSyncdCryptoEncryptedData2qzy9qni0hrm2=y;g.KmpSyncdCipherException1yr5ole70ur3d=I;g.KmpSyncdParseException1owflwptcaobs=P;g.MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8=U;g.MacAlgo_HMAC_SHA_512_getInstances0w60r7tu8vg=V;g.OpMode_DECRYPT_getInstance1ub7qnw77sd5o=T;g.OpMode_ENCRYPT_getInstance1dfeme89me53k=S}),98);
__d("wa-kmp-syncd-engine",["kotlin-kotlin-stdlib","wa-kmp-syncd-engine-interfaces"],(function(a,b,c,d,e,f,g){(e=d("kotlin-kotlin-stdlib")).initMetadataForCompanion1wyw17z38v6ac(a);e.initMetadataForClassbxx6q50dy2s7(c,"KmpSyncdEncryptionManager");e.initMetadataForClassbxx6q50dy2s7(w,"KmpSyncdMutationDataWithPlaintext");function h(a){var b;return new Int8Array([(b=d("kotlin-kotlin-stdlib")).convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,56),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,48),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,40),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,32),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,24),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,16),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(b.shiftRight2cr6y79ufiihy(a,8),new b.Long2qws0ah9gnpki(255,0))),b.convertToByte1epqhkuyxuz5a(b.bitwiseAnd2g7wmsfd45l12(a,new b.Long2qws0ah9gnpki(255,0)))])}function i(a,b,c,e,f){var g;b=b.bytes;c=(g=d("kotlin-kotlin-stdlib")).primitiveArrayConcatwxgknw08pmlb([c,b]);b=h(g.fromInt1lka3ktyu79a4(c.length));var i=d("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_512_getInstances0w60r7tu8vg();c=g.primitiveArrayConcatwxgknw08pmlb([c,f]);f=g.primitiveArrayConcatwxgknw08pmlb([c,b]);g=a.n6_1.mac(i,f,e);return g.i6(v)}function j(a,b,c){b=(0-b|0)-c|0;c=Math.max(0,b);return a.n6_1.generateRandomBytes(c)}function a(){this.p6_1=16,this.q6_1=0,this.r6_1=32}e.protoOf180f3jzyo7rfj(a).s6=function(){throw d("kotlin-kotlin-stdlib").RuntimeException_init_$Create$17ncyu0a6xfek("This is a test crash from KMP - WASyncDEngine")};var k;function b(){return k}function l(a,b,c){return function(e){return new(d("wa-kmp-syncd-engine-interfaces").KmpSyncdCryptoEncryptedData2qzy9qni0hrm2)(a.keyId,e,b.operation,c,d("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(c,c.length-32|0,c.length))}}function m(a,b,c,e,f,g){return function(h){var i=a;i=d("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([i,h]);h=b.n6_1.mac(d("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),c,e.indexKey);return h.i6(l(f,g,i))}}function n(a,b,c,e,f,g){return function(h){var j=a;j=d("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([j,h]);h=i(b,c.keyId,e.operation.asBytes(),f.valueMacKey,j);return h.j6(m(j,b,g,f,c,e))}}function o(a,b,c){return function(e){var f=d("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(a.index),g=a.value,h;g==null?h=new Int8Array([]):h=g;g=h;h=b.n6_1.generateRandomBytes(16);g=j(b,f.length,g.length);g=b.o6_1.encodeMutationDataToSyncdActionData(a,g).toByteArray();g=b.n6_1.createCipherText(d("wa-kmp-syncd-engine-interfaces").OpMode_ENCRYPT_getInstance1dfeme89me53k(),h,g,e.valueEncryptionKey);return g.j6(n(h,b,c,a,e,f))}}function p(a,b,c){return function(e){if(!d("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(a.indexHash,e))throw new(d("wa-kmp-syncd-engine-interfaces").KmpSyncdCipherException1yr5ole70ur3d)("Index hash corrupt");return new w(b,c)}}function q(a,b,c){return function(e){var f=a.m6_1.create(b.keyId,b.operation,e,b.mutationMac),g=a.n6_1.mac(d("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),d("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(f.index),c.indexKey);return g.i6(p(b,f,e))}}function r(a,b,c,e,f,g){return function(h){if(!d("kotlin-kotlin-stdlib").contentEquals1cdp6c846cfdi(a,h))throw new(d("wa-kmp-syncd-engine-interfaces").KmpSyncdCipherException1yr5ole70ur3d)("Data mac corrupt");h=b.n6_1.createCipherText(d("wa-kmp-syncd-engine-interfaces").OpMode_DECRYPT_getInstance1ub7qnw77sd5o(),c,e,f.valueEncryptionKey);return h.j6(q(b,g,f))}}function s(a,b,c,e,f,g){return function(h){var j=a,k=b;j=d("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([j,k]);k=c.operation.asBytes();k=i(e,f.keyId,k,h.valueMacKey,j);return k.j6(r(g,e,a,b,h,c))}}function t(a,b,c,e){return function(f){var g=d("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),i=b,j=h(c.k6_1);i=d("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([i,j]);j=d("kotlin-kotlin-stdlib").encodeToByteArray1onwao0uakjfh(e);i=d("kotlin-kotlin-stdlib").primitiveArrayConcatwxgknw08pmlb([i,j]);return a.n6_1.mac(g,i,f.snapshotMacKey)}}function u(a,b,c,e,f){return function(g){var i,j=d("wa-kmp-syncd-engine-interfaces").MacAlgo_HMAC_SHA_256_getInstance3mchsdvnjagj8(),k=b,l=c;k=(i=d("kotlin-kotlin-stdlib")).primitiveArrayConcatwxgknw08pmlb([k,l]);l=h(e.k6_1);k=i.primitiveArrayConcatwxgknw08pmlb([k,l]);l=i.encodeToByteArray1onwao0uakjfh(f);i=i.primitiveArrayConcatwxgknw08pmlb([k,l]);return a.n6_1.mac(j,i,g.patchMacKey)}}function v(a){return d("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(a,0,32)}function c(a,b,c,d){this.l6_1=a,this.m6_1=b,this.n6_1=c,this.o6_1=d}e.protoOf180f3jzyo7rfj(c).encrypt=function(a,b){var c=this.l6_1.getFor(a.keyData);return c.j6(o(b,this,a))};e.protoOf180f3jzyo7rfj(c).decrypt=function(a,b){var c=b.indexAndValueCipherText;if(c.length<48)throw new(d("wa-kmp-syncd-engine-interfaces").KmpSyncdParseException1owflwptcaobs)("Cipher text too short");c=[d("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(c,0,16),d("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(c,16,c.length-32|0),d("kotlin-kotlin-stdlib").copyOfRange3alro60z4hhf8(c,c.length-32|0,c.length)];var e=c[0],f=c[1];c=c[2];var g=this.l6_1.getFor(a.keyData);return g.j6(s(e,f,b,this,a,c))};e.protoOf180f3jzyo7rfj(c).calculateSnapshotMac=function(a,b,c,d){d=this.l6_1.getFor(d);return d.j6(t(this,c,b,a))};e.protoOf180f3jzyo7rfj(c).calculatePatchMac=function(a,b,c,d,e){c=this.l6_1.getFor(c);return c.j6(u(this,e,d,b,a))};function w(a,b){this.mutation=a,this.plaintext=b}e.protoOf180f3jzyo7rfj(w).t6=function(){return this.mutation};e.protoOf180f3jzyo7rfj(w).u6=function(){return this.plaintext};k=new a();e.defineProp3ur6h3slcvq4x(c,"Companion",b,e.VOID3gxj6tk5isa35,!0);g.KmpSyncdEncryptionManager=c;g.KmpSyncdMutationDataWithPlaintext=w}),98);
__d("wa-kmp-syncd-engine-api",["kotlin-kotlin-stdlib","wa-kmp-syncd-engine","wa-kmp-syncd-engine-interfaces"],(function(a,b,c,d,e,f){a=importNamespace("wa-kmp-syncd-engine").KmpSyncdEncryptionManager;b=importNamespace("wa-kmp-syncd-engine").KmpSyncdMutationDataWithPlaintext;d=(c=importNamespace("wa-kmp-syncd-engine-interfaces")).JsKmpDerivedSyncdKeysProviderImpl;e=c.JsKmpSyncdCryptoProviderImpl;var g=c.JsKmpSyncdMutationDataFactoryImpl,h=c.JsKmpSyncdProtobufProviderImpl,i=c.KmpLong,j=c.KmpResult,k=c.KmpSyncdCipherException,l=c.KmpSyncdCollectionName,m=c.KmpSyncdCryptoActionData,n=c.KmpSyncdCryptoDerivedKeys,o=c.KmpSyncdCryptoEncryptedData,p=c.KmpSyncdCryptoMutationData,q=c.KmpSyncdCryptoMutationKey,r=c.KmpSyncdCryptoMutationKeyData,s=c.KmpSyncdCryptoMutationKeyId,t=c.KmpSyncdCryptoMutationOperation,u=c.KmpSyncdKeyException,v=c.KmpSyncdMutationException,w=c.KmpSyncdMutationExceptionReason,x=c.KmpSyncdParseException,y=c.MacAlgo;c=c.OpMode;var z=importNamespace("kotlin-kotlin-stdlib").KtSet;f.KmpSyncdEncryptionManager=a;f.KmpSyncdMutationDataWithPlaintext=b;f.JsKmpDerivedSyncdKeysProviderImpl=d;f.JsKmpSyncdCryptoProviderImpl=e;f.JsKmpSyncdMutationDataFactoryImpl=g;f.JsKmpSyncdProtobufProviderImpl=h;f.KmpLong=i;f.KmpResult=j;f.KmpSyncdCipherException=k;f.KmpSyncdCollectionName=l;f.KmpSyncdCryptoActionData=m;f.KmpSyncdCryptoDerivedKeys=n;f.KmpSyncdCryptoEncryptedData=o;f.KmpSyncdCryptoMutationData=p;f.KmpSyncdCryptoMutationKey=q;f.KmpSyncdCryptoMutationKeyData=r;f.KmpSyncdCryptoMutationKeyId=s;f.KmpSyncdCryptoMutationOperation=t;f.KmpSyncdKeyException=u;f.KmpSyncdMutationException=v;f.KmpSyncdMutationExceptionReason=w;f.KmpSyncdParseException=x;f.MacAlgo=y;f.OpMode=c;f.KtSet=z}),66);
__d("WASyncdKmpConversion",["WAArrayBufferUtils","WAServerSync.pb","WASyncAction.pb","WASyncdKeyTypes","WAWebSyncdCryptoConst","WAWebSyncdDecode","WAWebSyncdRequestEncode","WAWebSyncdValidateSyncActionProtobuf","decodeProtobuf","encodeProtobuf","wa-kmp-syncd-engine-api"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationKeyId)(new Int8Array(d("WASyncdKeyTypes").fromSyncKeyId(a)))}function i(a){return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationKeyData)(new Int8Array(d("WASyncdKeyTypes").fromSyncKeyData(a)))}function j(a){switch(a){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:return d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationOperation.Set;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:return d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationOperation.Remove}}function a(a,b){return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationKey)(h(a),i(b))}function b(a,b){var c=b.index,e=b.binarySyncAction,f=b.operation,g=b.version;b.action;return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationData)(c,g,h(a),j(f),new Int8Array(e),null)}function e(a,b,e,f){e=d("WAWebSyncdDecode").decodeSyncActionData(null,e.buffer);e=c("WAWebSyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(null,e);var g=e.version,h=e.value;e=d("WAArrayBufferUtils").arrayBufferToString(e.index);return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoMutationData)(e,g,a,b,h?new Int8Array(d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,h).readBuffer()):null,f)}function f(a,b,c){var e=new Int8Array(c.index.blob);c=new Int8Array(c.value.blob);var f=c.slice(-d("WAWebSyncdCryptoConst").MAC_LENGTH);return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoEncryptedData)(h(a),e,j(b),c,f)}function k(a,b){var c;return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoActionData)(new Int8Array(d("WAWebSyncdRequestEncode").encodeSyncActionData({index:d("WAArrayBufferUtils").stringToArrayBuffer(a.index),value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,(c=a.value)==null?void 0:c.buffer),padding:b.buffer,version:a.version})))}g.toKmpSyncdMutationKeyData=i;g.toKmpSyncdMutationKey=a;g.toKmpSyncdMutationDataForEncryption=b;g.toKmpSyncdMutationDataForDecryption=e;g.toKmpSyncdEncryptedData=f;g.toKmpSyncdActionData=k}),98);
__d("WAWebKmpSyncdCryptoProvider",["WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","asyncToGeneratorRuntime","err","wa-kmp-syncd-engine-api"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e=(yield d("WACryptoAesCbc").aesCbcEncrypt(e,b,a));a.length!==16&&c("err")("IV must be 16 bytes");b=e.slice(a.length);return new Int8Array(b)});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield d("WACryptoAesCbc").aesCbcDecrypt(c,a,b));return new Int8Array(c)});return k.apply(this,arguments)}function a(a,b,e,f){switch(a){case d("wa-kmp-syncd-engine-api").OpMode.ENCRYPT:return new(d("wa-kmp-syncd-engine-api").KmpResult)(h(b,e,f));case d("wa-kmp-syncd-engine-api").OpMode.DECRYPT:return new(d("wa-kmp-syncd-engine-api").KmpResult)(j(b,e,f));default:throw c("err")("Invalid mode: "+a.name+")")}}function e(a,b,c){a=a===d("wa-kmp-syncd-engine-api").MacAlgo.HMAC_SHA_256?d("WACryptoHmac").hmacSha256:d("WACryptoHmac").hmacSha512;return new(d("wa-kmp-syncd-engine-api").KmpResult)(a(c,b).then(function(a){return new Int8Array(a)}))}function f(a){a=new Int8Array(a);return d("WACryptoDependencies").getCrypto().getRandomValues(a)}var l=Array.from({length:256},function(a,b){return b.toString(16).padStart(2,"0")});function m(a){var b="";for(var c=0;c<a.length;c++)b+=l[a[c]];return b}a=new(d("wa-kmp-syncd-engine-api").JsKmpSyncdCryptoProviderImpl)({createCipherText:a,mac:e,generateRandomBytes:f,bytesToHexString:m});g["default"]=a}),98);
__d("WAWebKmpSyncdProtobufEncoder",["WASyncdKmpConversion","wa-kmp-syncd-engine-api"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WASyncdKmpConversion").toKmpSyncdActionData(a,b)}b=new(d("wa-kmp-syncd-engine-api").JsKmpSyncdProtobufProviderImpl)({encodeMutationDataToSyncdActionData:a});g["default"]=b}),98);
__d("WAWebSyncdCryptoHelper",["WACryptoHkdf","WASyncdKeyTypes","WAWebSyncdCryptoConst","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=(yield i(a));return{indexKey:a.slice(0,(b=d("WAWebSyncdCryptoConst")).INDEX_KEY_END),valueEncryptionKey:a.slice(b.INDEX_KEY_END,b.VALUE_ENCRYPTION_KEY_END),valueMacKey:a.slice(b.VALUE_ENCRYPTION_KEY_END,b.VALUE_MAC_KEY_END),snapshotMacKey:a.slice(b.VALUE_MAC_KEY_END,b.SNAPSHOT_MAC_KEY_END),patchMacKey:a.slice(b.SNAPSHOT_MAC_KEY_END,b.PATCH_MAC_KEY_END)}});return h.apply(this,arguments)}function i(a){return d("WACryptoHkdf").extractAndExpand(d("WASyncdKeyTypes").fromSyncKeyData(a),d("WAWebSyncdCryptoConst").HKDF_INFO,d("WAWebSyncdCryptoConst").DERIVED_KEY_LENGTH)}g.generateEncryptionKeysUnmemoized=a}),98);
__d("WAWebSyncdCrypto",["WABase64","WACryptoHmac","WAMemoizeCache","WASyncdKeyTypes","WAWebSyncdCryptoConst","WAWebSyncdCryptoHelper"],(function(a,b,c,d,e,f,g){"use strict";c=d("WAMemoizeCache").memoizeWithArgs(d("WAWebSyncdCryptoHelper").generateEncryptionKeysUnmemoized,function(a){return d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyData(a))});function a(a,b){return d("WACryptoHmac").hmacSha256(new Uint8Array(a),new Uint8Array(b))}function b(a){var b=a.byteLength;return new Uint8Array(a).slice(b-d("WAWebSyncdCryptoConst").MAC_LENGTH).buffer}g.generateEncryptionKeys=c;g.generateIndexMac=a;g.valueMacFromIndexAndValueCipherText=b}),98);
__d("WASyncdKmpEncryptionManager",["WAArrayBufferUtils","WALogger","WASyncdKeyTypes","WASyncdKmpConversion","WAWebKmpSyncdCryptoProvider","WAWebKmpSyncdProtobufEncoder","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdMetricFatalError","asyncToGeneratorRuntime","nullthrows","wa-kmp-syncd-engine-api"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o;function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(d("WASyncdKeyTypes").toSyncKeyData(a.keyData.buffer)));return new(d("wa-kmp-syncd-engine-api").KmpSyncdCryptoDerivedKeys)(new Int8Array(a.indexKey),new Int8Array(a.valueEncryptionKey),new Int8Array(a.valueMacKey),new Int8Array(a.snapshotMacKey),new Int8Array(a.patchMacKey))});return q.apply(this,arguments)}var r=new(d("wa-kmp-syncd-engine-api").JsKmpDerivedSyncdKeysProviderImpl)({getForInternal:function(a){return new(d("wa-kmp-syncd-engine-api").KmpResult)(p(a))}}),s=new(d("wa-kmp-syncd-engine-api").JsKmpSyncdMutationDataFactoryImpl)({createInternal:function(a,b,c,e){return d("WASyncdKmpConversion").toKmpSyncdMutationDataForDecryption(a,b,c,e)}}),t=new(d("wa-kmp-syncd-engine-api").KmpSyncdEncryptionManager)(r,s,c("WAWebKmpSyncdCryptoProvider"),c("WAWebKmpSyncdProtobufEncoder"));function a(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: encrypting mutation"])));try{c=d("WASyncdKmpConversion").toKmpSyncdMutationKey(b,c);b=d("WASyncdKmpConversion").toKmpSyncdMutationDataForEncryption(b,a);c=t.encrypt(c,b);b=(yield c.toPromise());return{indexMac:b.indexHash.buffer,indexAndValueCipherText:b.indexAndValueCipherText.buffer}}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED,{collection:a.collection});if(b instanceof Error){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["kmp: encryption failed: ",""])),b.message).sendLogs("syncd: kmp: encryption failed");throw new(d("WAWebSyncdError").SyncdFatalError)(b.message)}d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["kmp: encryption failed"]))).sendLogs("syncd: kmp: encryption failed");throw b}});return u.apply(this,arguments)}function e(a,b,c,d,e){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: decrypting mutation"])));try{f=d("WASyncdKmpConversion").toKmpSyncdEncryptedData(b,f,g);g=(yield t.decrypt(d("WASyncdKmpConversion").toKmpSyncdMutationKey(b,e),f).toPromise());b=g.mutation;e=g.plaintext;g=c("nullthrows")(b.mutationMac,"SyncdMutation decryption returned a null mutationMac, this should not happen").buffer;var h=d("WAArrayBufferUtils").stringToArrayBuffer(b.index);return{version:b.version,index:h,indexMac:f.indexHash.buffer,value:(h=b.value)==null?void 0:h.buffer,valueMac:g,plaintext:e.buffer}}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:a});if(b instanceof Error){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["kmp: decryption failed: ",""])),b.message).sendLogs("syncd: kmp: decryption failed");throw new(d("WAWebSyncdError").SyncdFatalError)(b.message)}d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["kmp: decryption failed"]))).sendLogs("syncd: kmp: decryption failed");throw b}});return v.apply(this,arguments)}function f(a,b,c,d,e){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: generating patch mac"])));f=(yield t.calculatePatchMac(f,d("wa-kmp-syncd-engine-api").KmpLong.fromDecimalString(e.toString()),d("WASyncdKmpConversion").toKmpSyncdMutationKeyData(a),new Int8Array(d("WAWebSyncdCryptoUtils").combine(c)),new Int8Array(b)).toPromise());return f.buffer});return w.apply(this,arguments)}function x(a,b,c,d){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd:kmp: generating snapshot mac"])));e=(yield t.calculateSnapshotMac(e,d("wa-kmp-syncd-engine-api").KmpLong.fromDecimalString(c.toString()),new Int8Array(b),d("WASyncdKmpConversion").toKmpSyncdMutationKeyData(a)).toPromise());return e.buffer});return y.apply(this,arguments)}r={encryptMutation:a,decryptMutation:e,generatePatchMac:f,generateSnapshotMac:x};g.WASyncdKmpEncryptionManager=r}),98);
__d("WAWebABPropsInternalNumber",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_branded").split(","),c=d("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_inc").split(",");return b.includes(a)||c.includes(a)}function b(a){var b=d("WAWebABProps").getABPropConfigValue("system_msg_numbers_fb_branded").split(",");return b.includes(a)}g.getIsInternalNumber=a;g.getFbBrandedNumber=b}),98);
__d("WAWebAddonSendMsgData",["WALogger","WAWebAck","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonEncryptAddonMsgData","WAWebAddonInfraError","WAWebAddonPluginProcessor","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebAddonRetryRequestUtils","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","WAWebHandleMsgError","WAWebMsgType","WAWebReferentialMsgKey","WAWebSendMsgJob","WAWebSendMsgTypes","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebAddonEncryptAddonMsgData").createDualEncryptionHelper(a,b);b=b?yield b.decrypt():a;a=d("WAWebAddonSelectUtils").getAddonTableMode(a);yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:d("WAWebAddonConstants").AddonProcessMode.SetAck,tableMode:a},{add:[b]})});return m.apply(this,arguments)}var n=function(a){a=a.id;var b=a.remote;return a.fromMe&&d("WAWebUserPrefsMeUser").isMePrimary(b)?d("WAWebAck").ACK.READ:d("WAWebAck").ACK.SENT},o=new Set([d("WAWebAddonConstants").AddonProcessMode.Send,d("WAWebAddonConstants").AddonProcessMode.SendRetry,d("WAWebAddonConstants").AddonProcessMode.SendRevoke]),p=new Set([d("WAWebMsgType").MSG_TYPE.REACTION,d("WAWebMsgType").MSG_TYPE.REACTION_ENC]);function q(a){return p.has(a.type)?!0:new Set(["reaction","poll_update","comment","event_response"]).has(a.type)}function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebAddonConstants").AddonProcessMode.Send;a.kind===d("WAWebMsgType").MsgKind.ProtocolAddonRevoke&&(e=d("WAWebAddonConstants").AddonProcessMode.SendRevoke);a.ack===d("WAWebAck").ACK.FAILED&&(e=d("WAWebAddonConstants").AddonProcessMode.SendRetry);var f;try{if(!o.has(e))throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);var g=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a);if(q(a))f=(yield d("WAWebAddonProcessMsgs").processOutgoingMsgOptimisticUpdate(e,a));else{d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: sending "," (",") addon, id: ",", parent: ",", isParentLid: ",""])),d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a),a.type,a.id.id,g.id,(g=g.participant)==null?void 0:g.isLid());g=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([a],e));var m=g[0];g=g[1];f={encryptedMsgData:g[0],decryptedMsgData:g[0],parent:d("WAWebAddonSelectUtils").createAddonParentSelector(m).getForAddon(g[0])};if(e===d("WAWebAddonConstants").AddonProcessMode.SendRetry&&a.type===d("WAWebMsgType").MSG_TYPE.COMMENT){g=d("WAWebAddonPluginProcessor").getAddonProcessor(f.decryptedMsgData);g.convert.toDualEncryptedMsgData!=null&&(f.encryptedMsgData=(yield g.convert.toDualEncryptedMsgData(f.decryptedMsgData,f.parent)))}(e===d("WAWebAddonConstants").AddonProcessMode.Send||e===d("WAWebAddonConstants").AddonProcessMode.SendRetry)&&(yield d("WAWebAddonProcessMsgs").processOutgoingMsg(e,f.encryptedMsgData,m,b))}yield d("WAWebAddonRetryRequestUtils").storeSelfMessageTypeRow(f.decryptedMsgData);e=f.parent.broadcastId!=null&&c("WAWebWid").isWid(f.parent.broadcastId)&&Boolean((g=f.parent.broadcastId)==null?void 0:g.isBroadcastList());if(e){m=d("WAWebReferentialMsgKey").getReferentialMsgKey(f.parent);f.encryptedMsgData=d("WAWebAddonProcessMsgsUtils").updateMsgParentKeyValue(f.encryptedMsgData,m)}g=(yield d("WAWebSendMsgJob").encryptAndSendMsg({type:d("WAWebSendMsgTypes").SendMessageRecordType.Addon,data:f.encryptedMsgData},b));m=g.count;b=g.t;g=g.error;e&&(f.encryptedMsgData=d("WAWebAddonProcessMsgsUtils").updateMsgParentKeyValue(f.encryptedMsgData,f.parent.id));if(g!=null)throw new(d("WAWebHandleMsgError").MessageSentAckError)(g);yield l(babelHelpers["extends"]({},f.decryptedMsgData,{ack:n(f.encryptedMsgData)}),f.parent);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: sent "," addon, id: ",""])),f.decryptedMsgData.type,f.decryptedMsgData.id.id);return{t:parseInt(b,10),count:m}}catch(b){if(f==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendAddonMsgData: failure, parent msg "," for addon "," is not found"])),d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a),a.id.toString()).tags("messaging","addons").sendLogs("sendAddonMsgData: undefined parent");throw b}yield l(babelHelpers["extends"]({},f.decryptedMsgData,{ack:d("WAWebAck").ACK.FAILED}),f.parent);d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["sendAddonMsgData: failure, msg: ",""])),a.id.toString()).devConsole(f);throw b}});return r.apply(this,arguments)}g.isOptimisticAddonSendSupported=q;g.sendAddonProcess=a}),98);
__d("WAWebMexGetUsernameJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"XWA2UsernameGetResponse",kind:"LinkedField",name:"xwa2_username_get",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebMexGetUsernameJobQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebMexGetUsernameJobQuery",selections:a},params:{id:"9587446314672913",metadata:{},name:"WAWebMexGetUsernameJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexGetUsernameJob",["WALogger","WAWebMexClient","WAWebMexGetUsernameJobQuery.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=h!==void 0?h:h=b("WAWebMexGetUsernameJobQuery.graphql");a=(yield d("WAWebMexClient").fetchQuery(a,{}));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched latest username via mex"]))).tags("GQL","MEX").devConsole({response:a});return(a=a.xwa2_username_get)==null?void 0:a.username});return j.apply(this,arguments)}g.mexGetUsernameQueryJob=a}),98);
__d("WAWebMexSetUsernameKeyJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"pin"}],b=[{alias:null,args:[{kind:"Variable",name:"pin",variableName:"pin"}],concreteType:"XWA2UsernamePinSetMutationResponse",kind:"LinkedField",name:"xwa2_username_pin_set",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexSetUsernameKeyJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexSetUsernameKeyJobMutation",selections:b},params:{id:"9749436995157074",metadata:{},name:"WAWebMexSetUsernameKeyJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexSetUsernameKeyJob",["WALogger","WAWebMexClient","WAWebMexSetUsernameKeyJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c={pin:a},e=h!==void 0?h:h=b("WAWebMexSetUsernameKeyJobMutation.graphql");e=(yield d("WAWebMexClient").fetchQuery(e,a!=null?c:{}));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched set username KEY mutation via mex"]))).tags("GQL","MEX").devConsole({response:e});return((a=e.xwa2_username_pin_set)==null?void 0:a.result)==="SUCCESS"});return j.apply(this,arguments)}g.mexSetUsernameKeyQueryJob=a}),98);
__d("WAWebSetUsernameKeyQueryJob",["WAJobOrchestratorTypes","WAWebBackendApi","WAWebLidAwareContactsDB","WAWebMexSetUsernameKeyJob","WAWebModelStorageUtils","WAWebOrchestratorNonPersistedJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setUsernameKeyQueryJob",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebMexSetUsernameKeyJob").mexSetUsernameKeyQueryJob(a));if(b){a!=null?yield h(a):yield j();return!0}return!1}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=e.toJid(),g={id:f,usernameKey:a!=null?a:void 0};yield d("WAWebModelStorageUtils").getStorage().lock(["contact"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return c("WAWebLidAwareContactsDB").createOrMerge(f,babelHelpers["extends"]({},g))}));yield d("WAWebBackendApi").frontendSendAndReceive("updateUsernameKey",{id:f,usernameKey:a})});return i.apply(this,arguments)}function j(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield h(null)});return k.apply(this,arguments)}g.setUsernameKeyQueryJob=a;g.setUsernameKeyJob=h;g.deleteUsernameKeyJob=j}),98);
__d("WAWebGetUsernameQueryJob",["WAJobOrchestratorTypes","WALogger","WAWebMexGetUsernameJob","WAWebMexUsync","WAWebOrchestratorNonPersistedJob","WAWebSetUsernameJob","WAWebSetUsernameKeyQueryJob","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getUsernameQueryJob",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b;if(d("WAWebUsernameGatingUtils").mexUsyncUsernameQueryEnabled()){var c=(yield i());a=c==null?void 0:c.username;c=c==null?void 0:c.pin;c!=null&&(d("WAWebUsernameTypes").isUsernameKey(c)?b=c:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getUsernameJob: invalid username key received from MEX"]))).sendLogs("getUsernameJob-invalid-username-key"))}else a=(yield d("WAWebMexGetUsernameJob").mexGetUsernameQueryJob());c=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();yield d("WAWebSetUsernameJob").setUsernamesJob([a!=null?{userId:c,username:a}:{userId:c,deleteUsername:!0}]);b!=null?yield d("WAWebSetUsernameKeyQueryJob").setUsernameKeyJob(b):yield d("WAWebSetUsernameKeyQueryJob").deleteUsernameKeyJob();return a}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function i(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebMexUsync").mexUsyncQuery({users:[{jid:d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString()}],telemetry:{context:"INTERACTIVE"},fetch:{username:!0}}));a=a.response;if(a!=null)return a[0].username_info});return j.apply(this,arguments)}g.getUsernameJob=a}),98);
__d("WAWebJestE2ELogUtils",["gkx"],(function(a,b,c,d,e,f,g){function a(a){c("gkx")("26256")}g.maybeLogToJestE2eJSConsole=a}),98);
__d("WAWebWamEnumMdBootstrapHistoryPayloadType",[],(function(a,b,c,d,e,f){a=Object.freeze({INITIAL:1,RECENT_HISTORY:2,FULL_HISTORY:3,PUSHNAME:4,STATUS_V3:5,NON_BLOCKING_DATA:6,ON_DEMAND:7});f.MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE=a}),66);
__d("WAWebWamEnumMdBootstrapPayloadType",[],(function(a,b,c,d,e,f){a=Object.freeze({CRITICAL:1,NON_CRITICAL:2});f.MD_BOOTSTRAP_PAYLOAD_TYPE=a}),66);
__d("WAWebWamEnumMdBootstrapSource",[],(function(a,b,c,d,e,f){a=Object.freeze({APP_STATE:1,HISTORY:2});f.MD_BOOTSTRAP_SOURCE=a}),66);
__d("WAWebWamEnumMdBootstrapStepResult",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,FAILURE:2});f.MD_BOOTSTRAP_STEP_RESULT=a}),66);
__d("WAWebMdBootstrapDataAppliedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumCollection","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumMdBootstrapStepResult"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdBootstrapDataApplied:[2298,{appContext:[22,a.TYPES.STRING],appContextBitfield:[23,a.TYPES.INTEGER],applicationState:[21,d("WAWebWamEnumApplicationState").APPLICATION_STATE],chunkChatsApplied:[15,a.TYPES.INTEGER],chunkMsgsApplied:[16,a.TYPES.INTEGER],collection:[5,d("WAWebWamEnumCollection").COLLECTION],historySyncChunkOrder:[14,a.TYPES.INTEGER],historySyncRetryRequestId:[24,a.TYPES.STRING],historySyncStageProgress:[11,a.TYPES.INTEGER],mdBootstrapChatsCount:[17,a.TYPES.INTEGER],mdBootstrapContactsCount:[8,a.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[10,d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapMessagesCount:[18,a.TYPES.INTEGER],mdBootstrapPayloadType:[3,d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapSource:[2,d("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE],mdBootstrapStepDuration:[6,a.TYPES.INTEGER],mdBootstrapStepResult:[12,d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT],mdDroppedMsgType:[19,a.TYPES.STRING],mdRegAttemptId:[9,a.TYPES.STRING],mdSessionId:[1,a.TYPES.STRING],mdSyncFailureReason:[20,a.TYPES.STRING],mdTimestamp:[4,a.TYPES.INTEGER],sentViaMms:[13,a.TYPES.BOOLEAN],usedSnapshot:[7,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{MdBootstrapDataApplied:[]});g.MdBootstrapDataAppliedWamEvent=b}),98);
__d("WAWebMetricsAttributionActions",["WAWebAppTracker","WAWebProtobufsHistorySync.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.HistorySync);switch(a){case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP:d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.CriticalSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT:d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.RecentSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL:d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.FullSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND:d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.OnDemandSync);break;default:break}}function b(a){switch(a){case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP:d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.CriticalSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT:d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.RecentSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL:d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.FullSync);break;case d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND:d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.OnDemandSync);break;default:break}}function c(){var a;a=[(a=d("WAWebAppTracker")).AppTrackerType.HistorySync,a.AppTrackerType.CriticalSync,a.AppTrackerType.RecentSync,a.AppTrackerType.FullSync,a.AppTrackerType.OnDemandSync];a.forEach(function(a){d("WAWebAppTracker").AppTracker.stop(a)})}g.startHistorySyncAttributionTracking=a;g.stopHistorySyncAttributionTracking=b;g.stopAllHistorySyncAttributionTracking=c}),98);
__d("WAWebApiBlocklist",["WAWebModelStorageUtils","WAWebSchemaBlocklist","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebSchemaBlocklist").getBlocklistTable().all().then(function(a){a=a.map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a.id)});return a})}function b(a){var b=a.map(function(a){return{id:a.toString()}});return d("WAWebModelStorageUtils").getStorage().lock(["blocklist"],function(a){var c=a[0];return c.clear().then(function(){return c.bulkCreate(b).then(function(){return!0})})})}g.getBlocklist=a;g.updateBlocklist=b}),98);
__d("WAWebBlocklistMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").UserPrefs.BlocklistMigrated)===!0}function b(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").UserPrefs.BlocklistMigrated,!0)}g.isBlocklistMigrated=a;g.setBlocklistMigrated=b}),98);
__d("WAWebWamEnumCrashlogType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,ZERO_EVENT_EXPECTED:1,TRACKING:2});f.CRASHLOG_TYPE=a}),66);
__d("WAWebCriticalEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCrashApplicationState","WAWebWamEnumCrashlogType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CriticalEvent:[1684,{context:[2,a.TYPES.STRING],crashApplicationState:[8,d("WAWebWamEnumCrashApplicationState").CRASH_APPLICATION_STATE],crashlogType:[6,d("WAWebWamEnumCrashlogType").CRASHLOG_TYPE],debug:[3,a.TYPES.STRING],extraDebug:[7,a.TYPES.STRING],mobileBuildId:[5,a.TYPES.STRING],name:[1,a.TYPES.STRING]},[1,1,1],"regular"]},{CriticalEvent:[]});g.CriticalEventWamEvent=b}),98);
__d("WAWebGetBlocklistJob",["WALogger","WASmaxBlocklistsGetBlockListRPC","WAWebJidToWid","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a,b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["fetchBlocklist failed: code "," text ",""])),a,b).sendLogs("getBlocklist")}function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getBlocklistHash());a=babelHelpers["extends"]({},a!=null&&{itemArgs:{itemDhash:a}});a=(yield d("WASmaxBlocklistsGetBlockListRPC").sendGetBlockListRPC(a));switch(a.name){case"GetBlockListResponseInternalServerError":var b=a.value.errorServerErrors.value,c=b.code;b=b.text;j(Number(c),b);return{errorCode:Number(c),errorText:b};case"GetBlockListResponseInvalidRequest":c=a.value.errorGetBlocklistErrors.value;b=c.code;c=c.text;j(Number(b),c);return{errorCode:Number(b),errorText:c};case"GetBlockListResponseSuccessWithMatch":d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchBlocklist: GetBlockListResponseSuccessWithMatch ",""])),a.value.type);return{type:"match"};case"GetBlockListResponseSuccessWithMismatch":b=a.value.listDhash;c=a.value.listItem.map(function(a){return{wid:d("WAWebJidToWid").userJidToUserWid(a.jid),displayName:(a=a.displayNameMixin)==null?void 0:a.displayName}});return{type:"mismatch",dhash:b,list:{items:c,addressingMode:"pn"}};default:a.name;b=a.value.listDhash;c=a.value.listItem.map(function(a){var b=a.jid;b=d("WAWebJidToWid").lidUserJidToUserLid(b);return babelHelpers["extends"]({},l(a.blocklistIds),{active:a.active==="true",lid:b})});return{type:"mismatch",dhash:b,list:{items:c,addressingMode:"lid"}}}});return k.apply(this,arguments)}function c(a){return a.addressingMode==="pn"?a.items.map(function(a){return a.wid}):a.items.map(function(a){return a.lid})}function l(a){switch(a.name){case"Username":return{username:a.value.username};case"DisplayName":return{displayName:a.value.displayName};case"PnJid":return{pn:d("WAWebJidToWid").userJidToUserWid(a.value.pnJid)};case"UnknownIdentifier":return null}}g.getBlocklist=a;g.extractWids=c}),98);
__d("WAWebQueryBlockListJob",["WAArrayUtils","WALogger","WASmaxPsaChatBlockGetRPC","WAWebApiBlocklist","WAWebBackendApi","WAWebBlocklistMigration","WAWebCriticalEventWamEvent","WAWebDBCreateLidPnMappings","WAWebGetBlocklistJob","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebLogoutReasonConstants","WAWebSetUsernameJob","WAWebSocketLogoutJob","WAWebUpdateLidMetadataJob","WAWebUserPrefsMultiDevice","WAWebWid","asyncToGeneratorRuntime","partitionArray"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] fetch blocklist"])));var a=(yield d("WAWebGetBlocklistJob").getBlocklist());if(a.errorCode!=null)return a;if(a.type==="mismatch"){var b=d("WAWebBlocklistMigration").isBlocklistMigrated(),c=a.list;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] updating blocklist with "," contact(s)"])),c.items.length);yield d("WAWebUserPrefsMultiDevice").setBlocklistHash(a.dhash);var e=d("WAWebGetBlocklistJob").extractWids(c);yield d("WAWebApiBlocklist").updateBlocklist(e);d("WAWebBackendApi").frontendFireAndForget("replaceBlocklist",{wids:e});if(c.addressingMode==="pn"){b&&(yield w("LidBlocklistUnexpectedPnBlocklist"),yield d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.LidBlocklistPnWhenMigrated));e=c.items.map(function(a){var b=a.wid;a=a.displayName;if(a==null||!b.isLid())return null;var c={};a!=null&&(c.displayNameLID=a);return{lid:b,data:c}}).filter(Boolean);yield d("WAWebUpdateLidMetadataJob").updateLidMetadataJob(e)}else c.addressingMode,d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||(yield w("LidBlocklistUnmigratedChatDb"),yield d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.LidBlocklistChatDbUnmigrated)),yield p(c.items),b||(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] received a lid-based blocklist, marking the device as migrated"]))),d("WAWebBlocklistMigration").setBlocklistMigrated())}else d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] no change in blocklist, skip update"])));return a});return n.apply(this,arguments)}function e(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WASmaxPsaChatBlockGetRPC").sendChatBlockGetRPC());switch(a.name){case"ChatBlockGetResponseServerError":var b=a.value.errorChatBlockError.value,c=b.code;b=b.text;d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getBlockingStatusForPSAUser: server response with ",", ",""])),c,b);return{errorCode:Number(c),errorText:b};default:a.name;return a.value.blockingStatus==="blocked"}});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=[];for(a of a)a.pn!=null&&b.push(a),(a.username!=null||a.displayName!=null)&&c.push(a);yield r(b);yield t(c)});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAArrayUtils").groupBy(a,function(a){return a.pn.toString()});var b=[],e=[];for(a of a.values()){var f=c("partitionArray")(a,function(a){return a.active}),g=f[0];f=f[1];f=f.sort(function(a,b){return c("WAWebWid").compare(a.lid,b.lid)}).reverse();b.push.apply(b,v(f));g.length>1&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] multiple active LIDs for the same PN"]))).sendLogs("blocklist-multiple-active-lids");e.push.apply(e,v(g))}yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:b,flushImmediately:!1,identityChangeHandlingEnabled:!1,learningSource:"blocklist-inactive"});yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:e,flushImmediately:!1,identityChangeHandlingEnabled:!1,learningSource:"blocklist-active"});yield d("WAWebDBCreateLidPnMappings").flushLidPnMappingsToDb()});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],e=[],f=(yield c("WAWebLidAwareContactsDB").bulkGet(a.map(function(a){return a.lid.toString()})));for(var g=0;g<a.length;g++){var h=a[g],i=f[g];h.username!=null?(i==null||i.username==null&&i.phoneNumber==null)&&b.push({userId:h.lid,username:h.username}):(h.displayName,(i==null||i.displayNameLID==null)&&e.push({lid:h.lid,data:{displayNameLID:h.displayName}}))}yield d("WAWebSetUsernameJob").setUsernamesJob(b);yield d("WAWebUpdateLidMetadataJob").updateLidMetadataJob(e)});return u.apply(this,arguments)}function v(a){return a.map(function(a){return{lid:a.lid,pn:a.pn}})}function w(a){a=new(d("WAWebCriticalEventWamEvent").CriticalEventWamEvent)({name:a,debug:"{fetch}"});return a.commitAndWaitForFlush()}g.fetchAndUpdateBlocklist=a;g.getBlockingStatusForPSAUser=e;g.learnIdentifiers=p}),98);
__d("WAWebSyncBootstrap",["$InternalEnum","Promise","WAAsyncSleep","WAJobOrchestratorTypes","WALogger","WAPromiseDelays","WASyncdConst","WATimeUtils","WAWebABProps","WAWebAccountSyncJob","WAWebApiHistorySyncNotification","WAWebAppTracker","WAWebBootstrapNewsletter","WAWebBrokerGlobalAppState","WAWebClientFeatureFlags","WAWebCmd","WAWebDbEncryptionKey","WAWebEnvironment","WAWebGetUsernameQueryJob","WAWebHandleAccountSyncNotification","WAWebHandleHistorySyncChunk","WAWebHandleWorkerCompatibleRecentSyncChunk","WAWebHistorySyncNotificationUtils","WAWebJestE2ELogUtils","WAWebJobOrchestrator","WAWebLogoutReasonConstants","WAWebMdBootstrapDataAppliedWamEvent","WAWebMetricsAttributionActions","WAWebMiscBrowserUtils","WAWebNonAddressBookContactsJob","WAWebOrchestratorNonPersistedJob","WAWebProtobufsHistorySync.pb","WAWebQueryAndUpdateGroupMetadataJob","WAWebQueryBlockListJob","WAWebSchemaHistorySyncNotification","WAWebSocketLogoutJob","WAWebSyncContactJob","WAWebSyncDeviceAdvDeviceListJob","WAWebSyncd","WAWebSyncdDb","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebUsernameGatingUtils","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumWebcScenarioType","WAWebWamMemoryStat","WAWebWamUtils","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:17219"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,Y,ka=(a=b("cr:17219"))==null?void 0:a.getWindowsBridge(),la=40,ma=20,na=60*3,oa=2e4,Z=b("$InternalEnum").Mirrored(["NotStarted","InProcess","Completed"]),pa={initialChatHistory:!1,readReceipts:!1,syncdCritical:!1},qa={initialChatHistoryTotalMsg:-1,initialChatHistoryTotalChats:-1},ra=20,sa=5;e=function(){function a(){this.$1={},this.$2=qa,this.$6=25,this.$7=!1,this.$8=!1,this.$9=null,this.$10=!1,this.$11=null,this.$12=null,this.$13=!1,this.initState()}var e=a.prototype;e.initState=function(){this.$1=babelHelpers["extends"]({},pa),this.$2=babelHelpers["extends"]({},qa),this.$3=Z.NotStarted,this.$4=Z.NotStarted,this.$5=Z.NotStarted};e._isCriticalSyncDoneThisSession=function(){for(var a in this.$1)if(!this.$1[a])return!1;return!0};e._setSynced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] completed sync for ",""])),a),this.$1[a]=!0,this._isCriticalSyncDoneThisSession()&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] critical sync done"]))),yield d("WAWebUserPrefsAppStateSync").setAllCriticalDataSynced(),d("WAWebCmd").Cmd.criticalSyncDone(),c("WAWebBrokerGlobalAppState").initOrUpdateTracking(d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.INITIAL_PAIRING),d("WAWebWamMemoryStat").setCurrentMemoryScenario(d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),this.syncNonCriticalData())});function e(b){return a.apply(this,arguments)}return e}();e._syncContactsInChunks=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["start contact sync for "," chunks of contacts during the initial sync"])),a?b.length+1:0).tags("contact-sync");a!=null&&(yield d("WAWebSyncContactJob").syncContactListJob(Array.from(a),!1,"query"));for(a=0;a<b.length;a++){var c=Array.from(b[a]);yield d("WAPromiseDelays").delayMs(ma*1e3);yield d("WAWebSyncContactJob").syncContactListJob(c,!0,"query")}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["initial contact sync completes"]))).tags("contact-sync")});function c(b,c){return a.apply(this,arguments)}return c}();e._syncDeviceList=function(a){if(a==null){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncMostRecentDevices has no contact to sync during bootstrap"]))).tags("contact-sync");return(Y||(Y=b("Promise"))).resolve()}d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sync "," contacts for device info during the initial sync"])),a.size).tags("contact-sync");a=Array.from(a);return d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(a,null,null)["catch"](function(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Sync device failed"]))).verbose().sendLogs("Sync device failed: "+a)})};e.setReadReceiptsSynced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._setSynced("readReceipts")});function c(){return a.apply(this,arguments)}return c}();e.setInitialChatHistorySynced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._setSynced("initialChatHistory"),d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] initial chat history synced."]))),void $.continueProgressiveHistorySyncProcessingV2(d("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.InitialSyncComplete)});function c(){return a.apply(this,arguments)}return c}();e.setSyncDCriticalSynced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$3=Z.Completed;if(this.$1.syncdCritical)return;yield this._setSynced("syncdCritical")});function c(){return a.apply(this,arguments)}return c}();e.syncNonCriticalData=function(){var a=this,b=[];this.$5=Z.InProcess;d("WAWebQueryAndUpdateGroupMetadataJob").queryAndUpdateAllGroupMetadata({isHistorySyncInProgress:!0}).then(function(){b=d("WAWebNonAddressBookContactsJob").getAllContactsFromChatCollectionIntoChunks(),a._syncDeviceList(b[0]),d("WAWebNonAddressBookContactsJob").getAndUpdateNonAddressBookContacts()}).then(function(){self.setTimeout(function(){void a._syncContactsInChunks(b[0],b.slice(1,b.length))},la*1e3)})["finally"](function(){a.$5=Z.Completed});d("WAWebHandleAccountSyncNotification").getAndUpdateStatus();d("WAWebAccountSyncJob").getAndUpdateProfilePicture();void d("WAWebQueryBlockListJob").fetchAndUpdateBlocklist();d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutList");void d("WAWebBootstrapNewsletter").bootstrapNewsletterBackend();d("WAWebUsernameGatingUtils").usernameCreationEnabled()||d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()?void d("WAWebGetUsernameQueryJob").getUsernameJob():d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] username creation and 1on1 chat disabled, skipping get username query"])));this.$4=Z.InProcess;d("WAWebSyncd").markCollectionsForSync([d("WASyncdConst").CollectionName.Regular,d("WASyncdConst").CollectionName.RegularLow,d("WASyncdConst").CollectionName.RegularHigh]).then(function(){var b;a.$4=Z.Completed;void (ka==null||(b=ka.contacts)==null?void 0:b.initialize())})};e.markInitialHistorySyncCountDebugStats=function(a,b){this.$2={initialChatHistoryTotalMsg:a,initialChatHistoryTotalChats:b}};e.isSyncDCriticalDataSyncInProcess=function(){return this.$3===Z.InProcess};e.isSyncDBootstrapInProcess=function(){return this.$3===Z.InProcess||this.$4===Z.InProcess};e.isSyncDBootstrapGroupMetadataQueryInProcess=function(){return this.$5===Z.InProcess};e.$14=function(){var a=this;this.$9==null&&(d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] setting critical data syncd timeout (",")"])),na),this.$9=self.setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){(yield a.$15())||(d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap] syncd critical data timeout exceeded, logging out"]))),d("WAWebMetricsAttributionActions").stopAllHistorySyncAttributionTracking(),d("WAWebWamUtils").forceFlushAllWamAndQplBuffers(),d("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("syncd critical data timeout exceeded, logging out"),yield d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.SyncdTimeout));var b=(yield d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete());b!==!0&&(d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] history sync critical data timeout exceeded, logging out"]))),d("WAWebWamUtils").forceFlushAllWamAndQplBuffers(),d("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("history sync critical data timeout exceeded, logging out"),yield d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.HistorySyncTimeout));d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] all critical data synced within timeout period"])))}),na*1e3))};e.$15=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSyncdDb").getSyncActionsRows(["action"],[d("WASyncdConst").Actions.SettingPushName]));return a.length>0&&a.find(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Success})!=null});function c(){return a.apply(this,arguments)}return c}();e.setSyncDCriticalDataSyncCompleted=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$9!=null&&(yield new(d("WAWebMdBootstrapDataAppliedWamEvent").MdBootstrapDataAppliedWamEvent)({mdBootstrapPayloadType:d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL,mdBootstrapSource:d("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE.APP_STATE,mdSessionId:yield d("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),mdTimestamp:d("WATimeUtils").unixTimeMs()}).commitAndWaitForFlush(!0))});function c(){return a.apply(this,arguments)}return c}();e.getCriticalSyncDebugSummary=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(yield this.isCriticalDataSynced())return"-------\nAll critical data synced\n-------\n\n";var a=(yield d("WAWebUserPrefsHistorySync").getHistorySyncStatus());return"-------\n Initial history sync complete: "+(a?"true":this.$1.initialChatHistory.toString())+"\n Initial msgs: "+this.$2.initialChatHistoryTotalMsg+", initial chats: "+this.$2.initialChatHistoryTotalChats+"\n Receipt sync complete: "+this.$1.readReceipts.toString()+" \n "+("Critical collection sync complete: "+this.$1.syncdCritical.toString()+" \n-------\n")});function c(){return a.apply(this,arguments)}return c}();e.isCriticalDataSynced=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$8=this.$8||(yield d("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced());return this.$8});function c(){return a.apply(this,arguments)}return c}();e.syncCriticalData=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;c("WAWebBrokerGlobalAppState").initOrUpdateTracking(d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.INITIAL_PAIRING);d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] need to sync critical data: true"])));var e=(yield this.getCriticalSyncDebugSummary());d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap][history sync] ",""])),e);d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[bootstrap] syncing my device list"]))).tags("history-sync");e=d("WAWebSyncDeviceAdvDeviceListJob").syncMyDeviceListJob();var f=new(Y||(Y=b("Promise")))(function(b,c){d("WAWebAccountSyncJob").updatePrivacySettings().then(function(){return a.setReadReceiptsSynced()}).then(b)["catch"](c)})["catch"](function(a){d("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["failed to sync privacy settings ",""])),a.stack).verbose().devConsole(a).sendLogs("failed to update privacy settings from privacy request to server"),d("WAWebJestE2ELogUtils").maybeLogToJestE2eJSConsole("failed to sync privacy settings, logging out"),void d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.AccountSyncError)});this.$14();this.$3=Z.InProcess;e=e.then(function(){return d("WAWebSyncd").markCollectionsForSync([d("WASyncdConst").CollectionName.CriticalBlock,d("WASyncdConst").CollectionName.CriticalUnblockLow])}).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){a.$1.syncdCritical||(yield a.$15())&&(yield a.setSyncDCriticalSynced(),yield a.setSyncDCriticalDataSyncCompleted())}));var g=(yield d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete());g===!0&&(yield this.setInitialChatHistorySynced());g=d("WAWebAccountSyncJob").updateDefaultDisappearingMode()["catch"](function(a){d("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["failed to sync default disappearing mode ",""])),a.stack).verbose().devConsole(a).sendLogs("failed initial sync of default disappearing mode")});yield Y.all([f,e,g])});function e(){return a.apply(this,arguments)}return e}();e.continueProgressiveHistorySyncProcessing=function(){d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[history sync] continueProgressiveHistorySyncProcessing"])));var a=c("WAWebMiscBrowserUtils").info().name!=="Safari";this.$16(a)};e.$17=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!this.$8&&this.$1.initialChatHistory!==!0){d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Skip processLoop, until initial sync is complete"])));this.$6++;return}if(!d("WAWebCmd").Cmd.isMainStreamReadyMd){d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Skip processLoop, until main is loaded"]))).tags("history-sync");this.$6++;return}var a=(yield d("WAWebApiHistorySyncNotification").fetchNextHistorySyncChunkForProcessing());if(!a)return;d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processLoop picked up the next chunk with order ",""])),a.chunkOrder);this.$6++;a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT?yield d("WAWebHandleWorkerCompatibleRecentSyncChunk").handleWorkerCompatibleRecentSyncChunk(a):yield d("WAWebHandleHistorySyncChunk").handleHistorySyncChunk(a)});function c(){return a.apply(this,arguments)}return c}();e.$16=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);this.$10=!0;a&&this.$6++;var c=d("WAWebABProps").getABPropConfigValue("history_sync_loop_interval_ms");this.$6===0&&void d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed"],0,{shouldDecrypt:!1}).then(function(a){a=a.filter(function(a){return!d("WAWebApiHistorySyncNotification").inFlightChunk.has(a.msgKey)&&!a.reuploadPending});a.length>0&&d("WALogger").WARN(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync] No remaining iterations but still have unprocessed "," history sync notifications in table with loop interval ",""])),a.length,c)});if(!this.$7&&this.$6>0){this.$6--;this.$7=!0;try{yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey(),yield this.$17()}catch(a){d("WALogger").ERROR(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] _progressiveHistorySyncRun failed with ",", stack: ",""])),a==null?void 0:a.message,a==null?void 0:a.stack)}this.$7=!1;var e=!this.$8&&this.$1.initialChatHistory!==!0;e&&d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[history sync] initial sync is in progress, use default loop interval"])));yield new(Y||(Y=b("Promise")))(function(a){return self.setTimeout(a,e?oa:c)});this.$16()}this.$10=!1});function c(b){return a.apply(this,arguments)}return c}();e.increaseProgressiveHistorySyncRemainingIteration=function(){this.$6+=sa};e.$18=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebCmd").Cmd.isMainStreamReadyMd){d("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip processLoop, until main is loaded"]))).tags("history-sync");return}var a=(yield d("WAWebApiHistorySyncNotification").fetchNextHistorySyncChunkForProcessing());if(!a){d("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] no chunk found"]))).tags("history-sync");return}d("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] processLoop picked up chunk"])));if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&a.chunkOrder!=null){var b=a.msgKey;d("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[b]!=null?d("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[b]++:d("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[b]=1}a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT?yield d("WAWebHandleWorkerCompatibleRecentSyncChunk").handleWorkerCompatibleRecentSyncChunk(a):yield d("WAWebHandleHistorySyncChunk").handleHistorySyncChunk(a)});function c(){return a.apply(this,arguments)}return c}();e.$19=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(J||(J=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] job starts"])));try{yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey(),yield this.$18()}catch(a){d("WALogger").ERROR(K||(K=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] _progressiveHistorySyncRun failed with ",", stack: ",""])),a==null?void 0:a.message,a==null?void 0:a.stack)}d("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish main flow"])));var a=(yield d("WAWebUserPrefsHistorySync").getHistorySyncStatus());if((a==null?void 0:a.recentCompleted)===!0){a=!0;d("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync finishes, check remaining on demand sync notifications"])));var b=(yield d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND],{shouldDecrypt:!1}));b.length>0?(a=!1,void this.continueProgressiveHistorySyncProcessingV2(d("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)):d("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no on demand notifications"])));if(d("WAWebClientFeatureFlags").isFeatureEnabled("debug_1_year_history_sync")){d("WALogger").LOG(O||(O=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync finishes, check remaining full sync notifications"])));b=(yield d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL],{shouldDecrypt:!1}));b.length>0?(a=!1,void this.continueProgressiveHistorySyncProcessingV2(d("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)):d("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no on full sync notifications"])))}a&&d("WAWebMetricsAttributionActions").stopAllHistorySyncAttributionTracking();return}d("WALogger").LOG(Q||(Q=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] recent sync is incompleted, check remaining recent sync notifications"])));b=(yield d("WAWebHistorySyncNotificationUtils").getUnprocessedRecentSyncNotifications());if(b.length===0){d("WALogger").LOG(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no recent notifications"])));return}a=b[0].chunkOrder;if(a==null){d("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as first recent notification doesn't have chunk order"])));return}var e=(yield d("WAWebUserPrefsHistorySync").getLastHistoryRecentSyncedChunk());d("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] next unprocessed recent notification has chunk order: ",", last chunk order: ",""])),a,e==null?void 0:e.chunkOrder);if(e!=null&&e.chunkOrder+1!==a&&a!==1){d("WALogger").LOG(U||(U=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as no recent notifications with correct chunk order"])));return}if(c("WAWebEnvironment").isWindows===!0&&(e==null?void 0:e.chunkOrder)===this.$11&&a===this.$12){this.$13||(this.$13=!0,d("WALogger").ERROR(V||(V=babelHelpers.taggedTemplateLiteralLoose(["[history sync] loop detected, unexpected last chunk order"]))).sendLogs("history-sync-unexpected-chunk-order"));yield d("WAAsyncSleep").asyncSleep(5e3);return}this.$11=e==null?void 0:e.chunkOrder;this.$12=a;if(d("WAWebApiHistorySyncNotification").recentSyncChunkHandlingTriedCount[b[0].msgKey]>ra){d("WALogger").LOG(W||(W=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] skip scheduling the next run as recent notification with order "," fails too many times"])),a);return}d("WALogger").LOG(X||(X=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] init next run"])));void this.continueProgressiveHistorySyncProcessingV2(d("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.LastProcessedNotification)});function e(){return a.apply(this,arguments)}return e}();e.continueProgressiveHistorySyncProcessingV2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;if(!this.$8&&this.$1.initialChatHistory!==!0){d("WALogger").LOG(aa||(aa=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip job scheduling as initial chat sync is incomplete"])));return(Y||(Y=b("Promise"))).resolve()}if(a===d("WAWebHistorySyncNotificationUtils").HistorySyncScheduleSource.BackendStart){var e=(yield d("WAWebUserPrefsHistorySync").getHistorySyncStatus());if((e==null?void 0:e.recentCompleted)===!0){d("WALogger").LOG(ba||(ba=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] Skip job scheduling as recent sync is complete when starting backend"])));return(Y||(Y=b("Promise"))).resolve()}}return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("continueProgressiveHistorySyncProcessingV2",function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){d("WALogger").LOG(ca||(ca=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] job is scheduled, source: ",""])),a);return c.$19()});return function(a){return e.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC,maxTimeoutMs:1e3*120}).waitUntilCompleted()["catch"](function(a){d("WALogger").ERROR(da||(da=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] error while running job: ",""])),a)})});function c(b){return a.apply(this,arguments)}return c}();e.getIsHistorySyncRunning=function(){var a=d("WAWebJobOrchestrator").getInstance();a=a.getSnapshot(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);return a!=null&&a.continueProgressiveHistorySyncProcessingV2!=null?a.continueProgressiveHistorySyncProcessingV2>0:!1};return a}();var $=new e();d("WAWebCmd").Cmd.on("on_initial_chat_synced",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.CriticalSync),yield $.setInitialChatHistorySynced()}));d("WAWebCmd").Cmd.on("logout",function(){$.initState()});d("WAWebCmd").Cmd.on("on_recent_chat_history_synced",function(){var a=d("WAWebJobOrchestrator").getInstance();d("WALogger").DEV(ea||(ea=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish recent sync, before clearing: ",""])),JSON.stringify(a.getSnapshot(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)));d("WALogger").LOG(fa||(fa=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] clearing bucket queue for type ",""])),d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);a.clearQueueByPriority(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);d("WALogger").DEV(ga||(ga=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish recent sync, after clearing: ",""])),JSON.stringify(a.getSnapshot(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)))});d("WAWebCmd").Cmd.on("on_full_chat_history_synced",function(){var a=d("WAWebJobOrchestrator").getInstance();d("WALogger").DEV(ha||(ha=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish full sync, before clearing: ",""])),JSON.stringify(a.getSnapshot(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)));d("WALogger").LOG(ia||(ia=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] clearing bucket queue for type ",""])),d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);a.clearQueueByPriority(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC);d("WALogger").DEV(ja||(ja=babelHelpers.taggedTemplateLiteralLoose(["[history sync][continueProgressiveHistorySyncProcessingV2] finish full sync, after clearing: ",""])),JSON.stringify(a.getSnapshot(d("WAJobOrchestratorTypes").JOB_PRIORITY.HISTORY_SYNC)))});f=$;g["default"]=f}),98);
__d("WAWebBizCreateOrderJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("createOrderResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("order");var b=a.attrString("id"),c=a.attrString("token");a=a.maybeChild("price");var d={},e=a==null?void 0:a.maybeChild("subtotal");e&&(d.subtotal=e.contentString());e=a==null?void 0:a.maybeChild("total");e&&(d.total=e.contentString());e=a==null?void 0:a.maybeChild("currency");e&&(d.currency=e.contentString());e=a==null?void 0:a.maybeChild("price_status");e&&(d.price_status=e.contentString());return{id:b,token:c,price:d}});function i(a){var b,c=a.priceAmount1000!=null?d("WAWap").wap("price",null,a.priceAmount1000.toString()):void 0,e=a.currency?d("WAWap").wap("currency",null,a.currency):void 0;b=a.variantProperties?d("WAWap").wap("variant_info",null,d("WAWap").wap("properties",null,(b=a.variantProperties)==null?void 0:b.map(function(a){var b=a.name;a=a.value;return d("WAWap").wap("property",{name:d("WAWap").MAYBE_CUSTOM_STRING(b!=null?b:""),value:d("WAWap").MAYBE_CUSTOM_STRING(a!=null?a:"")})}))):void 0;return d("WAWap").wap("product",null,d("WAWap").wap("id",null,a.id),d("WAWap").wap("name",null,a.name),c,e,d("WAWap").wap("quantity",null,a.quantity.toString()),b)}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e===void 0&&(e=null);a=d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").CreateOrder),xmlns:"fb:thrift_iq",id:d("WAWap").generateId(),type:"set"},d("WAWap").wap("order",{op:d("WAWap").CUSTOM_STRING("create"),biz_jid:d("WAWebCommsWapMd").USER_JID(a)},b.map(function(a){return i(a)}).concat(e!=null?d("WAWap").wap("direct_connection_encrypted_info",null,e):[])));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,h));if(!b.success){if(b.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode)}else return b.result});return j.apply(this,arguments)}g.createOrderResponse=h;g.createOrderMD=a}),98);
__d("WAWebBizLogQplEvents",["WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CART_VIEW,a)}function b(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PROFILE_CATS_VIEW,a)}function c(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PROFILE_SAVE,a)}function e(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_VIEW,a)}function f(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,a)}function h(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_ORDER_CREATE,a)}function i(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_ORDER_VIEW,a)}g.qplPointCartView=a;g.qplPointProfileCatsView=b;g.qplPointProfileSave=c;g.qplPointProductView=e;g.qplPointPLMDetailsView=f;g.qplPointOrderCreate=h;g.qplPointOrderView=i}),98);
__d("WAWebBizQueryOrderJob",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new(c("WADeprecatedWapParser"))("queryOrderResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("order");var b=a.hasAttr("creation_ts")?a.attrTime("creation_ts"):null,c=a.maybeChild("price"),d=c==null?void 0:c.maybeChild("subtotal");d=d?parseInt(d.contentString(),10):null;var e=c==null?void 0:c.maybeChild("currency");e=e?e.contentString():null;var f=c==null?void 0:c.maybeChild("tax");f=f?parseInt(f.contentString(),10):null;c=c==null?void 0:c.maybeChild("total");c=c?parseInt(c.contentString(),10):null;var g=[];a.forEachChildWithTag("product",function(a){var b=a.child("id");b=b.contentString();var c=a.child("name");c=c.contentString();var d=a.maybeChild("price");d=d?parseInt(d.contentString(),10):null;var e=a.maybeChild("quantity");e=e?parseInt(e.contentString(),10):null;var f=a.maybeChild("variant_info");f=f?f.maybeChild("properties"):null;var h=[];f==null||f.forEachChildWithTag("property",function(a){var b=a.attrString("name");a=a.attrString("value");b!=null&&a!=null&&h.push([b,a])});f=a.maybeChild("currency");f=f?f.contentString():null;var i=null,j=null;a=a.maybeChild("image");if(a!=null){var k=a.maybeChild("url");j=k&&k.hasContent()?k.contentString():null;k=a.maybeChild("id");i=k&&k.hasContent()?k.contentString():null}g.push({id:b,price:d,thumbnailId:i,thumbnailUrl:j,currency:f,name:c,quantity:e,properties:h})});return{currency:e,createdAt:b,products:g,subtotal:d,total:c,tax:f}});function a(a,b,c,d,e){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j){j===void 0&&(j=null);if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").E451)());a=d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").QueryOrder),xmlns:"fb:thrift_iq",id:d("WAWap").generateId(),type:"get"},d("WAWap").wap("order",{op:d("WAWap").CUSTOM_STRING("get"),id:d("WAWap").CUSTOM_STRING(a)},d("WAWap").wap("image_dimensions",null,d("WAWap").wap("width",null,e.toString()),d("WAWap").wap("height",null,f.toString())),d("WAWap").wap("token",null,g),j!=null?d("WAWap").wap("direct_connection_encrypted_info",null,j):null));e=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,i));if(!e.success){if(e.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(e.errorCode)}else return e.result});return j.apply(this,arguments)}g.queryOrderResponse=i;g.queryOrder=a}),98);
__d("WAWebBizOrderBridge",["Promise","WAWebBackendErrors","WAWebBizCreateOrderJob","WAWebBizGatingUtils","WAWebBizLogQplEvents","WAWebBizQueryOrderJob","WAWebBusinessDirectConnectionBridge"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e,f,g){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").E451)());d("WAWebBizLogQplEvents").qplPointOrderView("datasource_start");a=d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(a){return d("WAWebBizQueryOrderJob").queryOrder(c,e,f,g,a)});return a.then(function(a){d("WAWebBizLogQplEvents").qplPointOrderView("datasource_end");return a})}function c(a,c){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").E451)());d("WAWebBizLogQplEvents").qplPointOrderCreate("datasource_start");var e=d("WAWebBusinessDirectConnectionBridge").attemptWithOrderDirectConnectionRetry(a,function(b){return d("WAWebBizCreateOrderJob").createOrderMD(a,c,b)});return e.then(function(a){d("WAWebBizLogQplEvents").qplPointOrderCreate("datasource_end");return a})}g.queryOrder=a;g.createOrder=c}),98);
__d("WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24249359867999500"}),null);
__d("WAWebBizCatalogManagementAddProductMutation.graphql",["WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{kind:"Variable",name:"request",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l=[h,k];i=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},d,e,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[e,f,g],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},h,i,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},j,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[h,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[k,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},f,g],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:l,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementAddProductMutation",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_add_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:i,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementAddProductMutation",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_add_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:i,storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementAddProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementAddProductMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementAddProduct",["Promise","WALogger","WAWebBizCatalogManagementAddProductMutation.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementAddProductMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForAddProductEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["addProduct: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['addProduct: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){if(a==null)return m;a=(a=a.xfb_whatsapp_catalog_add_product)==null?void 0:a.product;if(a==null)return m;a=d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a));return{type:"success",productResult:a}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["addProductWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.addProduct=a}),98);
__d("WAWebCommonParsersCustomErrors",["WADeprecatedWapParser"],(function(a,b,c,d,e,f,g){a=new(c("WADeprecatedWapParser"))("parseErrorFields",function(a){var b=[];a.forEachChildWithTag("field",function(a){var c=a.hasAttr("detail")?a.maybeAttrString("detail"):null;b.push({name:a.attrString("name"),reason:a.attrString("reason"),detail:c})});return b});g.parseErrorFields=a}),98);
__d("WAWebBizCatalogAddProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementAddProduct","WAWebBizCatalogManagementParseProductGraphql","WAWebBizCatalogParseProduct","WAWebBizGatingUtils","WAWebCommonParsersCustomErrors","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("addProductResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("product_catalog_add");a=a.child("product");return d("WAWebBizCatalogParseProduct").parseProductNode(a)});function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;a=(e=d("WAWap")).wap("iq",{id:e.generateId(),to:e.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},e.wap("product_catalog_add",{v:"1"},d("WAWebBizCatalogParseProduct").productModelToNode(a),e.wap("width",null,b.toString()),e.wap("height",null,c.toString())));b=(yield d("WADeprecatedSendIq").deprecatedSendIqErrorParser(a,h,d("WAWebCommonParsersCustomErrors").parseErrorFields));if(!b.success){if(b.errorCode===451)throw new(d("WAWebBackendErrors").E451)();if(b.customError!=null)throw new(d("WAWebBackendErrors").CatalogEditServerError)(b.errorCode,b.customError);else throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode)}else return b.result});return j.apply(this,arguments)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(f==null)throw c("err")("addProductGraphQL: meUser is null");f=(yield d("WAWebBizCatalogManagementAddProduct").addProduct({product:{biz_jid:f.toJid(),width:b,height:e,product_info:d("WAWebBizCatalogManagementParseProductGraphql").productModelToGraphQLInput(a)}}));if(f.type==="success")return f.productResult;else if(f.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(f.error);else if(f.type==="recovery-required")return i(a,b,e);else f.type;throw c("err")("addProductGraphQL: error handling flow not implemented for "+JSON.stringify(f))});return l.apply(this,arguments)}function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForAddProductEnabled()?k(a,b,c):i(a,b,c)});return m.apply(this,arguments)}g.addProductResponse=h;g.addProductMD=a}),98);
__d("WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="29276343172013990"}),null);
__d("WAWebBizCatalogManagementAppealProductMutation.graphql",["WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogAppealProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_appeal_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementAppealProductMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementAppealProductMutation",selections:c},params:{id:b("WAWebBizCatalogManagementAppealProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementAppealProductMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementAppealProduct",["Promise","WALogger","WAWebBizCatalogManagementAppealProductMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementAppealProductMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForAppealProductEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["appealProduct: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['appealProduct: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a})}).then(function(a){if(a==null)return m;a=a.xfb_whatsapp_catalog_appeal_product;return(a==null?void 0:a.success)==null?m:{type:"success",result:a.success}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["appealProductWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.appealProduct=a}),98);
__d("WAWebBizCatalogAppealProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementAppealProduct","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("appealProductResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("response");a=a.child("success");return a.contentString()==="true"});function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;b=(c=d("WAWap")).wap("iq",{id:c.generateId(),to:c.S_WHATSAPP_NET,type:"set",xmlns:"fb:thrift_iq"},c.wap("request",{type:"appeal_product"},c.wap("reason",null,b),c.wap("id",null,a)));c=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!c.success){if(c.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c.errorCode)}else return c.result});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(e==null)throw c("err")("appealProductGraphQL: meUser is null");e=(yield d("WAWebBizCatalogManagementAppealProduct").appealProduct({jid:e.toJid(),product_id:a,reason:b}));if(e.type==="success")return e.result;else if(e.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e.error);else if(e.type==="recovery-required")return i(a,b);else e.type;throw c("err")("appealProductGraphQL: error handling flow not implemented for "+JSON.stringify(e))});return l.apply(this,arguments)}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForAppealProductEnabled()?k(a,b):i(a,b)});return m.apply(this,arguments)}g.appealProductMD=a}),98);
__d("WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9376108569185474"}),null);
__d("WAWebBizCatalogManagementDeleteProductMutation.graphql",["WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogDeleteProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_delete_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"deleted_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementDeleteProductMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementDeleteProductMutation",selections:c},params:{id:b("WAWebBizCatalogManagementDeleteProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementDeleteProductMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementDeleteProduct",["Promise","WALogger","WAWebBizCatalogManagementDeleteProductMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementDeleteProductMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForDeleteProductEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["deleteProduct: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['deleteProduct: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a})}).then(function(a){if(a==null)return m;a=(a=a.xfb_whatsapp_catalog_delete_product)==null?void 0:a.deleted_count;return a==null?m:{type:"success",deleteResult:{deletedCount:a}}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["deleteProductWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.deleteProduct=a}),98);
__d("WAWebBizCatalogDeleteProductsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementDeleteProduct","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("productDeleteResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("product_catalog_delete");a=a.attrInt("deleted_count");return{deletedCount:a}});function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{id:b.generateId(),to:b.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},b.wap("product_catalog_delete",{v:"1"},a.map(function(a){return d("WAWap").wap("product",null,d("WAWap").wap("id",null,a))})));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!a.success){if(a.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode)}else return a.result});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(b==null)throw c("err")("deleteProductsGraphQL: meUser is null");b=(yield d("WAWebBizCatalogManagementDeleteProduct").deleteProduct({biz_jid:b.toJid(),product_ids:a}));if(b.type==="success")return b.deleteResult;else if(b.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(b.error);else if(b.type==="recovery-required")return i(a);else b.type;throw c("err")("deleteProductsGraphQL: error handling flow not implemented for "+JSON.stringify(b))});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForDeleteProductEnabled()?k(a):i(a)});return m.apply(this,arguments)}g.deleteProductsMD=a}),98);
__d("WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9889773371084956"}),null);
__d("WAWebBizCatalogManagementEditProductMutation.graphql",["WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{kind:"Variable",name:"request",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},l=[h,k];i=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},d,e,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[e,f,g],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},h,i,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},j,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[h,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[k,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},f,g],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:l,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementEditProductMutation",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_edit_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:i,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementEditProductMutation",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogProductMutationResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_edit_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:i,storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementEditProductMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementEditProductMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementEditProduct",["Promise","WALogger","WAWebBizCatalogManagementEditProductMutation.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementEditProductMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForEditProductEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["editProduct: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['editProduct: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){if(a==null)return m;a=(a=a.xfb_whatsapp_catalog_edit_product)==null?void 0:a.product;if(a==null)return m;a=d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a));return{type:"success",productResult:a}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["editProductWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.editProduct=a}),98);
__d("WAWebBizCatalogEditProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementEditProduct","WAWebBizCatalogManagementParseProductGraphql","WAWebBizCatalogParseProduct","WAWebBizGatingUtils","WAWebCommonParsersCustomErrors","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("editProductResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("product_catalog_edit");a=a.child("product");return d("WAWebBizCatalogParseProduct").parseProductNode(a)});function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;a=(e=d("WAWap")).wap("iq",{id:e.generateId(),to:e.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},e.wap("product_catalog_edit",{v:"1"},d("WAWebBizCatalogParseProduct").productModelToNode(a),e.wap("width",null,b.toString()),e.wap("height",null,c.toString())));b=(yield d("WADeprecatedSendIq").deprecatedSendIqErrorParser(a,h,d("WAWebCommonParsersCustomErrors").parseErrorFields));if(!b.success){if(b.errorCode===451)throw new(d("WAWebBackendErrors").E451)();if(b.customError)throw new(d("WAWebBackendErrors").CatalogEditServerError)(b.errorCode,b.customError);else throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode)}else return b.result});return j.apply(this,arguments)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(f==null)throw c("err")("editProductGraphQL: meUser is null");f=(yield d("WAWebBizCatalogManagementEditProduct").editProduct({product:{biz_jid:f.toJid(),product_id:a.id.toString(),width:b,height:e,product_info:d("WAWebBizCatalogManagementParseProductGraphql").productModelToGraphQLInput(a)}}));if(f.type==="success")return f.productResult;else if(f.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(f.error);else if(f.type==="recovery-required")return i(a,b,e);else f.type;throw c("err")("editProductGraphQL: error handling flow not implemented for "+JSON.stringify(f))});return l.apply(this,arguments)}function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForEditProductEnabled()?k(a,b,c):i(a,b,c)});return m.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9665162096898581"}),null);
__d("WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql",["WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogProductVisibilityUpdateResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product_visibility_update",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",selections:c},params:{id:b("WAWebBizCatalogManagementUpdateProductVisibilityMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementUpdateProductVisibilityMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementUpdateProductVisibility",["Promise","WALogger","WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementUpdateProductVisibilityMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForUpdateProductVisibilityEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["updateProductVisibility: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['updateProductVisibility: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a})}).then(function(a){if(a==null)return m;a=a.xfb_whatsapp_catalog_product_visibility_update;if(a==null)return m;return(a==null?void 0:a.success)==null?m:{type:"success",result:a.success}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["updateProductVisibilityWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.updateProductVisibility=a}),98);
__d("WAWebBizCatalogProductVisibilitySetJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizCatalogManagementUpdateProductVisibility","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("visibilitySetResponse",function(a){a.assertTag("iq"),a.assertFromServer()});function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;e=(e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog",smax_id:e.SMAX_ID(c("WAWapDeprecatedSmaxID").SetCatalogVisibility),id:e.generateId()},e.wap("product_visibility_update",{v:"1"},e.wap("product",{is_hidden:b?"true":"false"},d("WAWap").wap("id",null,a))));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(e,h));if(!b.success){if(b.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode)}else return b.result});return j.apply(this,arguments)}function k(a){throw c("err")("updateProductVisibilityGraphQL: error handling flow not implemented for "+JSON.stringify(a))}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(e==null)throw c("err")("updateProductVisibilityGraphQL: meUser is null");e=(yield d("WAWebBizCatalogManagementUpdateProductVisibility").updateProductVisibility({jid:e.toJid(),products:[{product_id:a,is_hidden:b}]}));if(e.type==="success"){if(e.result===!0)return;return k(e)}else if(e.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(e.error);else if(e.type==="recovery-required")return i(a,b);else{e.type;return k(e)}});return m.apply(this,arguments)}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForUpdateProductVisibilityEnabled()?l(a,b):i(a,b)});return n.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="29232780583035464"}),null);
__d("WAWebBizCatalogManagementCreateCatalogMutation.graphql",["WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogCreateResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_create",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementCreateCatalogMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementCreateCatalogMutation",selections:c},params:{id:b("WAWebBizCatalogManagementCreateCatalogMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementCreateCatalogMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementCreateCatalog",["Promise","WALogger","WAWebBizCatalogManagementCreateCatalogMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementCreateCatalogMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForCreateProductCatalogEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["createCatalog: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['createCatalog: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a})}).then(function(a){if(a==null)return m;a=(a=a.xfb_whatsapp_catalog_create)==null?void 0:a.success;return a==null?m:{type:"success",createResult:a}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["createCatalogWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.createCatalog=a}),98);
__d("WAWebBizCreateProductCatalogJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebBackendErrors","WAWebBizCatalogManagementCreateCatalog","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=new(c("WADeprecatedWapParser"))("productCatalogCreateResponse",function(a){a.assertTag("iq"),a.assertFromServer(),a.child("product_catalog_create")});function j(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=d("WAWap")).wap("iq",{id:a.generateId(),to:a.S_WHATSAPP_NET,type:"set",xmlns:"w:biz:catalog"},a.wap("product_catalog_create",{version:"1"}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,i));if(!a.success){if(a.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode)}else return a.result});return k.apply(this,arguments)}function l(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(a==null)throw c("err")("createProductCatalogGraphQL: meUser is null");a=(yield d("WAWebBizCatalogManagementCreateCatalog").createCatalog({product_catalog:{biz_jid:a.toJid()},platform:"WEB"}));if(a.type==="success")return;else a.type==="graphql-error"?d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a.error):a.type;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["createProductCatalogGraphQL: error handling flow not implemented for ",""])),JSON.stringify(a));return j()});return m.apply(this,arguments)}function a(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForCreateProductCatalogEnabled()?l():j()});return n.apply(this,arguments)}g.productCatalogCreateResponse=i;g.createProductCatalog=a}),98);
__d("WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9957894520961099"}),null);
__d("WAWebBizCatalogManagementFetchCatalogQuery.graphql",["WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{kind:"Variable",name:"request",variableName:"request"}],d={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"catalog_id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"catalog_name",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},o=[k,n];l=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},g,h,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[h,i,j],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[h,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},k,l,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},m],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[k,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[h,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},i,j],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:o,storageKey:null}],storageKey:null}];m={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchCatalogQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[d,e,f,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:l,args:null,argumentDefinitions:[]}],storageKey:null},m],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementFetchCatalogQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[d,e,f,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:l,storageKey:null},m],storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementFetchCatalogQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchCatalogQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementFetchCatalog",["Promise","WALogger","WAWebBizCatalogManagementFetchCatalogQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementFetchCatalogQuery.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForGetProductCatalogEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchCatalog: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['fetchCatalog: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").fetchQuery(n,{request:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){var b;if(a==null)return m;a=(a=a.xfb_whatsapp_catalog)==null?void 0:a.product_catalog;if(a==null)return m;var c=a.products,f=a.paging;b=(b=f==null?void 0:f.before)!=null?b:"";f=(f=f==null?void 0:f.after)!=null?f:"";c=c.map(function(a){return e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a)}).map(d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);return{type:"success",catalog:{data:c,catalog_id:a.catalog_id,catalog_name:a.catalog_name,catalog_type:a.catalog_type,paging:{cursors:{before:b,after:f}}}}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fetchCatalogWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.fetchCatalog=a}),98);
__d("WAWebQueryCatalogQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},i=[c,h];e=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product_catalog",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogGetResponseSuccessProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},c,d,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},e,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[b,f,g],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:i,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[h,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},f,g],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:i,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryCatalogQuery",selections:e},params:{id:"9916553288394782",metadata:{},name:"WAWebQueryCatalogQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebQueryCatalog",["WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchCatalog","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();try{var c,e=a.catalogWid,f=a.afterCursor,g=a.limit,j=a.width,k=a.height,l=a.checkmarkCollectionId,m=a.allowShopSource,n=a.directConnectionEncryptedInfo,o=a.variantInfoFields,p=a.variantThumbnailHeight;a=a.variantThumbnailWidth;e=(yield d("WAWebRelayClient").fetchQuery(h!==void 0?h:h=b("WAWebQueryCatalogQuery.graphql"),{request:{product_catalog:{jid:e.toString(),allow_shop_source:m?"ALLOWSHOPSOURCE_TRUE":"ALLOWSHOPSOURCE_FALSE",width:String(j),height:String(k),direct_connection_encrypted_info:n,limit:String(g),after:f,catalog_session_id:l,variant_info_fields:o,variant_thumbnail_height:p!=null?String(p):null,variant_thumbnail_width:a!=null?String(a):null}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_CATALOG)}));m=e==null||(c=e.xwa_product_catalog_get_product_catalog)==null?void 0:c.product_catalog;if(m==null)return{data:[],catalog_id:null,catalog_name:null,catalog_type:null,paging:{cursors:{after:"",before:""}}};j=m.paging;k=m.products;return{data:k.map(d("WAWebBizParseProductGraphql").parseProductGraphQL),catalog_id:null,catalog_name:null,catalog_type:null,paging:{cursors:{before:(n=j==null?void 0:j.before)!=null?n:"",after:(g=j==null?void 0:j.after)!=null?g:""}}}}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a);d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_product_catalog query."])));throw new(d("WAWebBackendErrors").CatalogUnknownError)()}});return function(b){return a.apply(this,arguments)}}(),l=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.catalogWid,c=a.afterCursor,e=a.limit,f=a.width,g=a.height,h=a.checkmarkCollectionId,i=a.allowShopSource,k=a.directConnectionEncryptedInfo;k=k===void 0?null:k;var l=a.variantInfoFields,m=a.variantThumbnailHeight;a=a.variantThumbnailWidth;if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();b=(yield d("WAWebBizCatalogManagementFetchCatalog").fetchCatalog({product_catalog:{jid:b.toJid(),after:c,limit:String(e),width:String(f),height:String(g),belongs_to:{collection_id:h},allow_shop_source:i,direct_connection_encrypted_info:k,variant_info_fields:l,variant_thumbnail_height:m!=null?String(m):null,variant_thumbnail_width:a!=null?String(a):null},platform:"WEB"}));if(b.type==="success")return b.catalog;else b.type==="graphql-error"?d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(b.error,d("WAWebMaybeThrowCatalogErrors").ErrorSourceForCatalogQuery.GET_PRODUCT_CATALOG_OWNER_GRAPHQL):b.type;if(b.type==="recovery-required"&&d("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(d("WAWebBackendErrors").AdAccountRecoveryRequiredError)(b.emailMask);if(b.type==="incorrect-nonce"&&d("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(d("WAWebBackendErrors").CatalogIncorrectNonceError)();d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["queryCatalogGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(b));throw new(d("WAWebBackendErrors").CatalogUnknownError)()});return function(b){return a.apply(this,arguments)}}();a=function(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();return b!=null&&b.equals(a.catalogWid)?l(a):k(a)};c=a;g["default"]=c}),98);
__d("WAWebQueryCatalogHasCategoriesQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetCategoriesResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_categories",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogGetCategoriesResponseSuccessCategoryWithSubCategories",kind:"LinkedField",name:"categories",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogHasCategoriesQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryCatalogHasCategoriesQuery",selections:b},params:{id:"9759957480718978",metadata:{},name:"WAWebQueryCatalogHasCategoriesQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebQueryCatalogHasCategories",["errorCode","WALogger","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogHasCategoriesQuery.graphql","WAWebRelayClient","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.catalogWid,e=a.directConnectionEncryptedInfo,f=a.imageDimensions;f=f===void 0?{width:100,height:100}:f;a=a.sessionId;try{var g;c=(yield d("WAWebRelayClient").fetchQuery(i!==void 0?i:i=b("WAWebQueryCatalogHasCategoriesQuery.graphql"),{request:{categories:{biz_jid:c.toString(),direct_connection_encrypted_info:e,image_dimensions:f,catalog_session_id:a}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_CATEGORIES)}));return Boolean(c==null||(g=c.xwa_product_catalog_get_categories)==null?void 0:g.categories.length)}catch(a){if(a instanceof d("WAWebGraphQLServerError").GraphQLServerError){e=a.source.errors||[];f=e[0];if((f==null?void 0:f.code)===2498052)return!1;d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a)}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_categories query."])));return!1}});return function(b){return a.apply(this,arguments)}}();g.queryCatalogHasCategories=a}),98);
__d("WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24529100180014015"}),null);
__d("WAWebBizCatalogManagementFetchProductQuery.graphql",["WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{kind:"Variable",name:"request",variableName:"request"}],d={alias:null,args:null,kind:"ScalarField",name:"catalog_id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},n=[j,m];k=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},f,g,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[g,h,i],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},j,k,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},k,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[j,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[g,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},h,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchProductQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetProductResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[d,e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:k,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementFetchProductQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetProductResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogGetProductResponseProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[d,e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"product",plural:!1,selections:k,storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementFetchProductQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchProductQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementFetchProduct",["Promise","WALogger","WAWebBizCatalogManagementFetchProductQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementFetchProductQuery.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForGetProductEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchProduct: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['fetchProduct: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").fetchQuery(n,{request:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){var b;if(a==null)return m;b=(b=a.xfb_whatsapp_catalog_product)==null||(b=b.product_catalog)==null?void 0:b.product;if(b==null)return m;b=d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL(e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,b));return{type:"success",productResult:{data:b,catalog_id:(b=a.xfb_whatsapp_catalog_product)==null||(b=b.product_catalog)==null?void 0:b.catalog_id,catalog_type:(b=a.xfb_whatsapp_catalog_product)==null||(b=b.product_catalog)==null?void 0:b.catalog_type}}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fetchProductWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.fetchProduct=a}),98);
__d("WAWebQueryCatalogProductQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},i=[c,h];e=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetProductResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_product",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogGetProductResponseSuccessProductCatalog",kind:"LinkedField",name:"product_catalog",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"product",plural:!1,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},c,d,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},e,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[b,f,g],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:i,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[h,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},f,g],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:i,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryCatalogProductQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryCatalogProductQuery",selections:e},params:{id:"9647868451963105",metadata:{},name:"WAWebQueryCatalogProductQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebQueryCatalogProduct",["errorCode","WALogger","WANullthrows","WAWebBackendErrors","WAWebBizCatalogManagementFetchProduct","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebQueryCatalogProductQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k,l=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();for(var a=arguments.length,e=new Array(a),f=0;f<a;f++)e[f]=arguments[f];var g=e[0],h=e[1],k=e[2],l=e[3],m=e[4],n=m===void 0?!1:m,o=e[5],p=o===void 0?null:o,q=e[6],r=e[7],s=e[8];try{var t,u=(yield d("WAWebRelayClient").fetchQuery(i!==void 0?i:i=b("WAWebQueryCatalogProductQuery.graphql"),{request:{product:{jid:g.toString(),product_id:h,width:String(k),height:String(l),fetch_compliance_info:String(n),direct_connection_encrypted_info:p,variant_info_fields:q,variant_thumbnail_height:r!=null?String(r):null,variant_thumbnail_width:s!=null?String(s):null}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_PRODUCT)})),v=c("WANullthrows")(u==null||(t=u.xwa_product_catalog_get_product)==null||(t=t.product_catalog)==null?void 0:t.product);return{data:d("WAWebBizParseProductGraphql").parseProductGraphQL(v),catalog_id:null,catalog_type:null}}catch(a){if(a instanceof d("WAWebGraphQLServerError").GraphQLServerError){var w,x=((w=a.source)==null?void 0:w.errors)||[],y=x[0];if((y==null?void 0:y.code)===2498052)return{error:"NOT_FOUND"};d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a)}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_product query."])));throw new(d("WAWebBackendErrors").CatalogUnknownError)()}});return function(){return a.apply(this,arguments)}}(),m=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=i===void 0?!1:i,l=b[5],m=l===void 0?null:l,n=b[6],o=b[7],p=b[8],q=(yield d("WAWebBizCatalogManagementFetchProduct").fetchProduct({product:{jid:e.toJid(),product_id:f,width:String(g),height:String(h),direct_connection_encrypted_info:m,fetch_compliance_info:String(j),variant_info_fields:n,variant_thumbnail_height:o!=null?String(o):null,variant_thumbnail_width:p!=null?String(p):null}}));if(q.type==="success")return q.productResult;else if(q.type==="graphql-error"){var r,s=(r=q.error.source)==null?void 0:r.errors,t=s[0];if((t==null?void 0:t.code)===2498052)return{error:"NOT_FOUND"};d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(q.error)}else if(q.type==="recovery-required"){if(d("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(d("WAWebBackendErrors").AdAccountRecoveryRequiredError)(q.emailMask)}else if(q.type==="incorrect-nonce"){if(d("WAWebBizGatingUtils").catalogTokenRecoveryEnabled())throw new(d("WAWebBackendErrors").CatalogIncorrectNonceError)()}else q.type;d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["queryCatalogProductGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(q));throw new(d("WAWebBackendErrors").CatalogUnknownError)()});return function(){return a.apply(this,arguments)}}();a=function(){var a=d("WAWebUserPrefsMeUser").getMaybeMePnUser();for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];var f=c[0];return a!=null&&a.equals(f)?m.apply(void 0,c):l.apply(void 0,c)};e=a;g["default"]=e}),98);
__d("WAWebReportProductJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XWAWhatsAppCatalogReportProductResponse",kind:"LinkedField",name:"xwa_whatsapp_catalog_report_product",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebReportProductJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebReportProductJobMutation",selections:b},params:{id:"WAWebReportProductJobMutation",metadata:{},name:"WAWebReportProductJobMutation",operationKind:"mutation",text:null}}}();a.hash="a344b224fc28492489aa97287055b47e";e.exports=a}),null);
__d("WAWebReportProductJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebBizGatingUtils","WAWebCommsWapMd","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebRelayClient","WAWebReportProductJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new(c("WADeprecatedWapParser"))("reportProductResponse",function(a){a.assertTag("iq");a.assertAttr("type","result");return});function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;e=(e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",type:"set",id:e.generateId()},e.wap("request",{type:"report_product",biz_jid:d("WAWebCommsWapMd").USER_JID(a)},c?d("WAWap").wap("reason",null,c):void 0,d("WAWap").wap("id",null,b)));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(e,i));if(!a.success){if(a.errorCode===451)throw new(d("WAWebBackendErrors").E451)();throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode)}});return k.apply(this,arguments)}var l=h!==void 0?h:h=b("WAWebReportProductJobMutation.graphql");function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a={jid:a.toJid(),product_id:b};c!==""&&(a.reason=c);return d("WAWebRelayClient").commitMutation(l,{input:a}).then(function(a){var b;a=a==null||(b=a.xwa_whatsapp_catalog_report_product)==null?void 0:b.success;if(a!==!0)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500)})["catch"](function(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a)})});return n.apply(this,arguments)}function a(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return d("WAWebBizGatingUtils").graphQLForReportProductEnabled()?m(a,b,c):j(a,b,c)});return o.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebBizProductCatalogBridge",["Promise","WALogger","WAWeb-moment","WAWebBackendErrors","WAWebBizCatalogAddProductJob","WAWebBizCatalogAppealProductJob","WAWebBizCatalogDeleteProductsJob","WAWebBizCatalogEditProductJob","WAWebBizCatalogProductVisibilitySetJob","WAWebBizCreateProductCatalogJob","WAWebBizGatingUtils","WAWebBizLogQplEvents","WAWebBusinessDirectConnectionBridge","WAWebNoop","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebProductTypes.flow","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebQueryCatalog","WAWebQueryCatalogHasCategories","WAWebQueryCatalogProduct","WAWebReportProductJob","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b,e,f,g,h,i,j,k){h===!0&&d("WAWebBizLogQplEvents").qplPointProductView("datasource_start");var l=d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(d){return c("WAWebQueryCatalogProduct")(a,b,e,f,g,d,i,j,k)});l.then(function(){return h===!0&&d("WAWebBizLogQplEvents").qplPointProductView("datasource_end")})["catch"](c("WAWebNoop"));return d("WAWebBackendErrors").attachErrorLogger(l,"Query product failed")}function e(a,e,f,g,j,k,m,n,o,p){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(l||(l=b("Promise"))).reject(new(d("WAWebBackendErrors").E451)());var q=d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(b){return c("WAWebQueryCatalog")({catalogWid:a,afterCursor:e,limit:f,width:g,height:j,checkmarkCollectionId:k,allowShopSource:m,directConnectionEncryptedInfo:b,variantInfoFields:n,variantThumbnailHeight:o,variantThumbnailWidth:p})});return q["catch"](function(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===404)throw a;if(a.errorCode===451){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Query catalog failed, error: 451"]))).verbose().sendLogs("Query catalog failed, commerce-features-disabled");throw new(d("WAWebBackendErrors").E451)()}d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Query catalog failed, error: ",""])),a).verbose().devConsole(a).sendLogs("Query catalog failed");throw a})}function f(a,c,e,f,g){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())return(l||(l=b("Promise"))).reject(new(d("WAWebBackendErrors").E451)());g&&d("WAWebBizLogQplEvents").qplPointPLMDetailsView("datasource_start");var h=d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(b){return d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.queryProductList(a,c,b,e,f))});h.then(function(){return g&&d("WAWebBizLogQplEvents").qplPointPLMDetailsView("datasource_end")})["catch"](function(a){if(a.errorCode===451)throw new(d("WAWebBackendErrors").E451)()});return h}function m(a){return d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(b){return d("WAWebQueryCatalogHasCategories").queryCatalogHasCategories({catalogWid:a,directConnectionEncryptedInfo:b})})}function n(a,b,e){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_REPORT,"datasource_start");a=c("WAWebReportProductJob")(a,b,e);a.then(function(){return d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_REPORT,"datasource_end")})["catch"](c("WAWebNoop"));return d("WAWebBackendErrors").attachErrorLogger(a,"Report product failed")}function o(a,b){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,"datasource_start");a=d("WAWebBizCatalogAppealProductJob").appealProductMD(a,b);a.then(function(){return d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_APPEAL,"datasource_end")})["catch"](c("WAWebNoop"));return d("WAWebBackendErrors").attachErrorLogger(a,"Appeal product failed")}function p(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,"datasource_start");var a=d("WAWebBizCreateProductCatalogJob").createProductCatalog();a.then(function(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_CREATE,"datasource_end")})["catch"](c("WAWebNoop"));return d("WAWebBackendErrors").attachErrorLogger(a,"Create catalog failed")}function q(a,b,e){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_start");a=d("WAWebBizCatalogAddProductJob").addProductMD(a,b,e);a.then(function(){return d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_end")})["catch"](c("WAWebNoop"));return a.then(v)["catch"](function(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===406||a instanceof d("WAWebBackendErrors").CatalogEditServerError&&a.statusCode===406)throw a;d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Add product failed, error: ",""])),a).verbose().devConsole(a).sendLogs("Add product failed");throw a})}function r(a,b,e){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_start");a=c("WAWebBizCatalogEditProductJob")(a,b,e);a.then(function(a){return d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SAVE,"datasource_end")})["catch"](c("WAWebNoop"));return a.then(v)["catch"](function(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===406||a instanceof d("WAWebBackendErrors").CatalogEditServerError&&a.statusCode===406)throw a;d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Edit product failed, error: ",""])),a).verbose().devConsole(a).sendLogs("Edit product failed");throw a})}function s(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_DELETE,"datasource_start");a=d("WAWebBizCatalogDeleteProductsJob").deleteProductsMD(a);a=a.then(function(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_DELETE,"datasource_end");return a});return d("WAWebBackendErrors").attachErrorLogger(a,"Delete product failed")}function t(a){return a==null?null:parseInt(a,10)}function u(a){return a!=null&&a!==""?c("WAWeb-moment").utc(a,c("WAWeb-moment").ISO_8601).valueOf():null}function v(a,b){var c;c=((c=a.capability_to_review_status[0])==null?void 0:c.value)||"APPROVED";c={catalogWid:b,id:a.id,isHidden:a.is_hidden||!1,isSanctioned:a.is_sanctioned||!1,url:a.url||"",name:a.name,description:a.description||"",availability:(b=d("WAWebProductTypes.flow").ProductAvailability.cast(a.availability))!=null?b:d("WAWebProductTypes.flow").ProductAvailability.UNKNOWN,maxAvailable:a.max_available,additionalImageCdnUrl:a.additional_image_cdn_urls.map(function(a){return a[1].value}),additionalImageHashes:a.image_hashes_for_whatsapp.slice(1),imageCdnUrl:a.image_cdn_urls[1].value,imageHash:a.image_hashes_for_whatsapp[0],reviewStatus:c,currency:a.currency,priceAmount1000:t(a.price),salePriceAmount1000:t(a.sale_price),salePriceStartDate:u(a.sale_start_date),salePriceEndDate:u(a.sale_end_date),retailerId:a.retailer_id||"",productMsgMediaData:null,imageCount:a.additional_image_cdn_urls.length+1,fetchedFromServer:!0,videos:(b=a.videos)==null?void 0:b.map(function(a){return{thumbnail_url:a.thumbnail_url,original_video_url:a.original_video_url,id:a.id}}),t:Date.now()/1e3,old:!1,canAppeal:a.whatsapp_product_can_appeal,checkmark:a.checkmark,importerInformationExempt:Boolean(a.importer_information_exempt),variantInfo:a.variant_info,displayPriority:0};a.compliance_info&&(c.complianceInfo=y(a.compliance_info));a.signedShimmedUrl!=null&&(c.signedShimmedUrl=a.signedShimmedUrl);return c}function w(a){var b;a.businessOwnerJid!=null&&a.businessOwnerJid!==""&&(b=d("WAWebWidFactory").createWid(a.businessOwnerJid));return{catalogWid:b,id:a.productId||"",url:a.url,name:a.title,description:a.description,imageCdnUrl:a.mediaData.renderableUrl,reviewStatus:"",currency:a.currencyCode,priceAmount1000:a.priceAmount1000,salePriceAmount1000:a.salePriceAmount1000,retailerId:a.retailerId,productMsgMediaData:a.mediaData,imageCount:a.productImageCount!=null&&a.productImageCount!==0?a.productImageCount:1,fetchedFromServer:!1,t:a.t,isHidden:!1}}function x(a,b){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,"datasource_start");a=c("WAWebBizCatalogProductVisibilitySetJob")(a,b);a.then(function(){return d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_SET_VISIBLE,"datasource_end")})["catch"](c("WAWebNoop"));return d("WAWebBackendErrors").attachErrorLogger(a,"Product visibility change failed")}function y(a){var b={countryCodeOrigin:a.country_code_origin};a.importer_name!=null&&a.importer_name!==""&&(b.importerName=a.importer_name);a.importer_address&&(b.importerAddress=z(a.importer_address));return b}function z(a){var b={street1:a.street1,city:a.city,countryCode:a.country_code};a.street2!=null&&a.street2!==""&&(b.street2=a.street2);a.postal_code!=null&&a.postal_code!==""&&(b.postalCode=a.postal_code);a.region!=null&&a.region!=="null"&&(b.region=a.region);a.country_code&&(b.countryCode=a.country_code);return b}g.queryProduct=a;g.queryCatalog=e;g.queryProductList=f;g.queryCatalogHasCategories=m;g.reportProduct=n;g.appealProduct=o;g.createCatalog=p;g.addProduct=q;g.editProduct=r;g.deleteProducts=s;g.parseDateValue=u;g.mapProductResponseToModel=v;g.mapMsgToProductModel=w;g.productVisibilitySet=x}),98);
__d("WAWebDirectConnectionCypher",["$InternalEnum","WAArrayBufferUtils","WALogger","WAWebDirectConnectionX509","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["PhoneNumberAndPostcode","Postcode"]);function a(a){return a}function c(a){return a}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebDirectConnectionX509").getEngine());e=e.subtle;return e.encrypt({name:"AES-GCM",iv:new Uint8Array(d("WAWebDirectConnectionX509").base64ToArrayBuffer(b)),tagLength:128},a,d("WAWebDirectConnectionX509").stringToArrayBuffer(c))});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebDirectConnectionX509").getEngine());e=e.subtle;a=(yield e.importKey("raw",a,{name:"AES-GCM"},!1,["decrypt"]));return e.decrypt({name:"AES-GCM",iv:new Uint8Array(d("WAWebDirectConnectionX509").base64ToArrayBuffer(c)),tagLength:128},a,d("WAWebDirectConnectionX509").base64ToArrayBuffer(b))});return m.apply(this,arguments)}function e(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return d("WAArrayBufferUtils").arrayBufferToString(yield l(a,b,c))});return n.apply(this,arguments)}function f(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebDirectConnectionX509").arrayBufferToBase64(yield d("WAWebDirectConnectionX509").getRandomValues(new Uint8Array(16)));try{var e=(yield d("WAWebDirectConnectionX509").getEngine());e=e.subtle;var f=(yield e.generateKey({name:"AES-GCM",length:256},!0,["encrypt"]));b=d("WAWebDirectConnectionX509").arrayBufferToBase64(yield j(f,c,JSON.stringify(b)));e=(yield e.exportKey("raw",f));f=(yield d("WAWebDirectConnectionX509").encryptWithPublicKey(a,e));return{cypher:"AesKey="+f+";IV="+c+";Data="+b,exportedAesKey:e,iv:c}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher creation failed with ",""])),a.toString());return null}});return o.apply(this,arguments)}g.CypherType=i;g.stringToCypherString=a;g.cypherStringToString=c;g.decryptDataWithSymmetricKey=l;g.decryptDataWithSymmetricKeyToString=e;g.genCypher=f}),98);
__d("WAWebBusinessDirectConnectionBridge",["Promise","WALogger","WAWebABProps","WAWebBusinessDirectConnectionCollection","WAWebBusinessDirectUtils","WAWebDirectConnectionCypher","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!(yield d("WAWebBusinessDirectUtils").isCypherNeeded(a)))return e();var f=function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b===void 0&&(b=!1);b=(yield c("WAWebBusinessDirectConnectionCollection").getCypher(a,{forceRenew:b})).cypher;return e(b)});return function(a){return d.apply(this,arguments)}}();try{return yield f()}catch(a){if(d("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(a)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request. Renewing certificate and retrying."])));return f(!0)}return(j||(j=b("Promise"))).reject(a)}});return l.apply(this,arguments)}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!d("WAWebABProps").getABPropConfigValue("share_phone_number_on_cart_send_to_direct_connection_biz_enabled"))return k(a,e);if(!(yield d("WAWebBusinessDirectUtils").isCypherNeeded(a)))return e();var f=function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;b=(b=(yield c("WAWebBusinessDirectConnectionCollection").genNewCypher(a,d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode,{forceRenew:!0})))==null?void 0:b.cypher;return e(b)});return function(){return f.apply(this,arguments)}}(),g=function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield c("WAWebBusinessDirectConnectionCollection").getCypher(a));return b.cypherType===d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?e(b.cypher):f()});return function(){return g.apply(this,arguments)}}();try{return yield g()}catch(a){if(d("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(a)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request. Renewing certificate and retrying."])));return f()}return(j||(j=b("Promise"))).reject(a)}});return m.apply(this,arguments)}g.attemptWithDirectConnectionRetry=k;g.attemptWithOrderDirectConnectionRetry=a}),98);
__d("WAWebSyncdGetChat",["WALogger","WASyncdConst","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.isLid()){var b,c=(yield d("WAWebSchemaChat").getChatTable().equals(["accountLid"],a.toString(),{shouldDecrypt:!1}));c.length>0&&(b=c[0]);if(b==null)return{success:!1,orphanModel:{modelId:a.toString(),modelType:d("WASyncdConst").SyncModelType.Account}};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: resolveChatForMutationIndex: found chat using accountLid query ",""])),a.toLogString());return{success:!0,chat:b}}c=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));if(c==null)return{success:!1,orphanModel:{modelId:a.toString(),modelType:d("WASyncdConst").SyncModelType.Chat}};d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: resolveChatForMutationIndex: found chat using chatId query ",""])),a.toLogString());return{success:!0,chat:c}});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isRegularUser())return a.toJid();var b=(yield o(a));if(b==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: getChatJidMutationIndexForChat: chat not found}"]))).sendLogs("syncd-missing-chat-outgoing-mutation").devConsole(a.toString());throw c("err")("syncd-missing-chat-outgoing-mutation")}return b});return m.apply(this,arguments)}function f(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isRegularUser())return a.toJid();var b=(yield o(a));if(b!=null)return b;b;b=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(a));return b!=null?b.toJid():a.toJid()});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return a.toJid();if(a.isLid())return a.toJid();var b=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));if(b==null)return;b=b.accountLid;if(b==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: getChatJidMutationIndexForChatImpl: accountLid not found in chat row}"]))).sendLogs("syncd-missing-accountLid-outgoing-mutation").devConsole(a.toString());throw c("err")("syncd-missing-accountLid-outgoing-mutation")}return b});return p.apply(this,arguments)}g.resolveChatForMutationIndex=a;g.getChatJidMutationIndexForChat=e;g.getWidMutationIndexForWid=f}),98);
__d("WAWebEditLabelAssociationBridge",["Promise","WALogger","WAServerSync.pb","WASyncdConst","WATimeUtils","WAWebBizGatingUtils","WAWebContactModel","WAWebDBLabelAssociationDatabaseApi","WAWebListsGatingUtils","WAWebMsgModel","WAWebSchemaLabelAssociation","WAWebSyncdActionUtils","WAWebSyncdCoreApi","WAWebSyncdGetChat","WAWebSyncdUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){var e=b.some(function(a){return a instanceof c("WAWebContactModel")});e&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["contact model is invalid for editLabelAssociation"]))).sendLogs("contact model is invalid for editLabelAssociation");e=l(a,b.map(function(a){return a instanceof d("WAWebMsgModel").Msg?{labelAssociationType:d("WAWebSchemaLabelAssociation").LabelAssociationType.Message,modelId:a.id.toString(),mutationIndexSegments:d("WAWebSyncdUtils").constructMsgKeySegments(a)}:{labelAssociationType:d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid,modelId:a.id.toString(),mutationIndexSegments:[a.id.toString({legacy:!0})]}}));return e}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!(d("WAWebBizGatingUtils").canEditLabelAssociation()||d("WAWebListsGatingUtils").isListsEnabled()))return(k||(k=b("Promise"))).reject(c("err")("editLabelAssociation is not supported"));var f=(yield p(a,e));return d("WAWebSyncdCoreApi").lockForSync(["label-association","chat"],f,function(){return n(a,e)})});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=[],g=[];a.forEach(function(a){var b=a.id,c=a.type;e.map(function(a){var e=a.modelId;a=a.labelAssociationType;c==="add"?f.push({labelId:b,associationId:e,type:a}):(c,g.push(d("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey({labelId:b,associationId:e,type:a})))})});yield (k||(k=b("Promise"))).all([d("WAWebDBLabelAssociationDatabaseApi").addOrEditLabelAssociations(f)["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["addOrEditLabelAssociations into label association table failed"]))).verbose().devConsole(a).sendLogs("editLocalLabelAssociationMD-add-or-edit-label-associations-failed");throw c("err")("addOrEditLabelAssociations into label association table failed")}),d("WAWebDBLabelAssociationDatabaseApi").removeLabelAssociations(g)["catch"](function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["removeLabelAssociations from label association table failed"]))).verbose().devConsole(a).sendLogs("editLocalLabelAssociationMD-remove-label-associations-failed");throw c("err")("removeLabelAssociations form label association table failed")})])});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=d("WATimeUtils").unixTimeMs(),f=[];a.forEach(function(a){var b=a.id,g=a.type;c.forEach(function(a){var c=a.labelAssociationType;a=a.mutationIndexSegments;var h={labelAssociationAction:{labeled:g==="add"}};c=c===d("WAWebSchemaLabelAssociation").LabelAssociationType.Message?d("WASyncdConst").Actions.LabelMessage:d("WASyncdConst").Actions.LabelJid;f.push({timestamp:e,collection:d("WASyncdConst").CollectionName.Regular,operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[b].concat(a),version:d("WASyncdConst").LABEL_ASSOCIATION_SYNC_VERSION,value:h,action:c})})});a=(yield (k||(k=b("Promise"))).all(f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.action===d("WASyncdConst").Actions.LabelMessage)return a;var c=a.indexArgs,e=c[0];c=c.slice(1);c=(yield (k||(k=b("Promise"))).all(c.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebWidFactory").createWid(a);return d("WAWebSyncdGetChat").getWidMutationIndexForWid(a)});return function(b){return a.apply(this,arguments)}}())));return babelHelpers["extends"]({},a,{indexArgs:[e].concat(c)})});return function(b){return a.apply(this,arguments)}}())));return a.map(d("WAWebSyncdActionUtils").buildPendingMutation)});return q.apply(this,arguments)}g.editLabelAssociation=a;g.editLocalLabelAssociationMD=n;g.createLabelAssociationMutations=p}),98);
__d("WAWebChatClearBridge",["Promise","WANullthrows","WASyncAction.pb","WATimeUtils","WAWebApiActiveMessageRanges","WAWebClearChatSync","WAWebDBQueryAndRemoveMessageHistory","WAWebDBReportingTokenUtils","WAWebMessageRangeUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebUpdateLastAddOnPreviewChatAction","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e=d("WATimeUtils").unixTimeMs();e=(yield (h||(h=b("Promise"))).all([c("WAWebClearChatSync").getClearChatMutation(e,a.id,!f,!1,!1),c("WAWebClearChatSync").getClearChatMutation(e,a.id,!f,!1,!0)]));var g=e[0],i=e[1],j;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["message","message-association"],[g],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.id.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("clearChat",{deleteStarred:!f}),i.binarySyncAction);var b=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,i.binarySyncAction);b=c("WANullthrows")((b=b.clearChatAction)==null?void 0:b.messageRange);j=(yield d("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessagesInMessageRange(a.id,b,{skipStarred:f,skipRecentSystemMessages:!1}))}));return{result:j}});return j.apply(this,arguments)}function a(a,c,e){return i(a,c,e).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(b.result!=null&&b.result.length>0){var c=b.result;d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(c);yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.id.toString(),c));void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(c,{removeWholeRow:!0})}return b});return function(a){return c.apply(this,arguments)}}())}g.sendClear=a}),98);
__d("WAWebFtsClientMessageIdResolver",["WAWebDBMessageSerialization","WAWebSchemaMessage"],(function(a,b,c,d,e,f,g){function a(a){var b=a.map(function(a){return+a.id}),c=new Map(a.map(function(a){return[+a.id,a]}));return d("WAWebSchemaMessage").getMessageTable().anyOf(["rowId"],b).then(function(a){var b=[];a.forEach(function(a){a=d("WAWebDBMessageSerialization").messageFromDbRow(a);var e=c.get(a.rowId);e!=null&&e.id===String(a.rowId)&&e.timestamp===a.t&&e.chatId===a.id.remote.toString()&&(b.push(a),c["delete"](a.rowId))});a=Array.from(c.keys(),function(a){return String(a)});b.sort(function(a,b){return b.t-a.t});return{resolved:b,unresolved:a}})}g.resolveMsgIds=a}),98);
__d("WAWebFtsGenRequestId",[],(function(a,b,c,d,e,f){var g=0;function a(){return g++}f["default"]=a}),66);
__d("WAWebBrokerMainConnect",["WAWebBrokerConnectionManager","WAWebBrokerProtocolHandshake","WAWebInvocationDispatcher","WAWebInvocationHandler"],(function(a,b,c,d,e,f,g){function a(a){var b=new MessageChannel(),e=b.port1;b=b.port2;c("WAWebInvocationHandler").respondTo(e);c("WAWebBrokerConnectionManager").init();c("WAWebInvocationDispatcher").setConnectionManager(c("WAWebBrokerConnectionManager"));c("WAWebBrokerConnectionManager").connectVia(e);a.postMessage(d("WAWebBrokerProtocolHandshake").buildHandshakePayload(b),[b])}g["default"]=a}),98);
__d("WAWebFtsWorkerAdapter",["WANullthrows","WAWebBrokerMainConnect","WAWebFtsWorkerResource","WorkerBundleResource"],(function(a,b,c,d,e,f,g){var h=null,i=function(){function a(){this.worker=null}var b=a.prototype;b.initialize=function(a,b){this.worker=d("WorkerBundleResource").createDedicatedWebWorker(c("WAWebFtsWorkerResource")),c("WANullthrows")(this.worker).onmessage=function(b){a(b.data.message)},c("WANullthrows")(this.worker).onerror=b,c("WAWebBrokerMainConnect")(this)};b.postMessage=function(a,b){a={type:"message",message:a};c("WANullthrows")(this.worker).postMessage(a,b)};b.terminate=function(){c("WANullthrows")(this.worker).terminate()};return a}();function a(a,b){h||(h=new i(),h.initialize(a,b));return h}g.getFtsWorker=a}),98);
__d("WAWebFtsClient",["Promise","WALogger","WANullthrows","WAWebEnvironment","WAWebFtsClientMessageIdResolver","WAWebFtsGenRequestId","WAWebFtsWorkerAdapter","asyncToGeneratorRuntime","cr:1274","err"],(function(a,b,c,d,e,f,g){var h,i,j;e=(a=b("cr:1274"))!=null?a:{};f=e.FtsSQLiteClient;a=function(){function a(){this.$2=new Map()}var e=a.prototype;e.initialize=function(){var a=this;if(!this.$1){var b=function(b){a.$3(b)},c=function(b){return a.$4(b)};b=d("WAWebFtsWorkerAdapter").getFtsWorker(b,c);this.$1=b}};e.$4=function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[fts][client] worker error: ",""])),a)};e.$3=function(a){var b=a.reqId,e=this.$2.get(b);e&&(a.error?(d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[fts][client] worker completed job "," with error"])),e.command.operation),e.reject(c("err")("FTS worker error"))):e.resolve(a.result),this.$5(b))};e.startIndexer=function(){return this.$6({operation:"start-indexer"})};e.indexFull=function(a){return this.$6({operation:"run"})};e.index=function(){return this.$6({operation:"consume"})};e.purge=function(a){return this.$6({operation:"purge",ids:a})};e.purgeRange=function(a){return this.$6(babelHelpers["extends"]({operation:"purge-range"},a))};e.reInit=function(){return this.$6({operation:"re-init"})};e.initExternalStorage=function(){return(j||(j=b("Promise"))).resolve()};e.destroyExternalStorage=function(){return(j||(j=b("Promise"))).resolve()};e.clearInitializationPromises=function(){return this.$6({operation:"clear-init"})};e.search=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield this.$6({operation:"find",query:a,queryOptions:b}));return this.$7(a)});function c(b,c){return a.apply(this,arguments)}return c}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(Array.isArray(a)||typeof a==="boolean")return{canceled:!1,eof:!0,status:404,messages:[]};var b=(yield d("WAWebFtsClientMessageIdResolver").resolveMsgIds(a.messages)),c=b.resolved;b=b.unresolved;var e=a.eof;a=a.status;b.length>0&&this.purge(b);return{canceled:!1,eof:e,status:a,messages:c}});function c(b){return a.apply(this,arguments)}return c}();e.$6=function(a){var d=this;this.initialize();var e=c("WAWebFtsGenRequestId")();return new(j||(j=b("Promise")))(function(b,c){var f={command:a,reqId:e};d.$2.set(e,{resolve:b,reject:c,command:a});d.$8(f)})["finally"](function(){d.$5(e)})};e.$5=function(a){this.$2["delete"](a)};e.$8=function(a){c("WANullthrows")(this.$1).postMessage(a)};return a}();e=f!=null&&c("WAWebEnvironment").isWindows?new f():new a();g.ftsClient=e}),98);
__d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils",["WALogger","WAShiftTimer","WATimeUtils","WAWebABProps","WAWebBackendApi","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage","WAWebUserPrefsHistorySync","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=new Map(),m={disableRequestSending:!1,failureCount:0};function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebDBMessageUtils").beginningOfChat(a);a=d("WAWebDBMessageUtils").endOfChat(a);b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{limit:1,reverse:!1,shouldDecrypt:!1}));return b.length===0?null:b[0]});return o.apply(this,arguments)}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a));return a!=null?d("WAWebDBMessageSerialization").messageFromDbRow(a):null});return p.apply(this,arguments)}function c(a){d("WAWebBackendApi").frontendFireAndForget("successHistorySyncOd",{chatId:a}),q()}function e(a){d("WAWebBackendApi").frontendFireAndForget("errorHistorySyncOd",{chatId:a});a=d("WATimeUtils").unixTime();var b=m.firstFailureRequestTimeStampSec;b==null&&(m.firstFailureRequestTimeStampSec=a);m.failureCount+=1;var c=d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_failure_limit"),e=d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_cooldown_sec");if(m.failureCount>=c&&b!=null&&a-b<e){m.disableRequestSending=!0;c=1e3*e;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[rdu] disable history sync on demand for ","ms."])),c);new(d("WAShiftTimer").ShiftTimer)(function(){m.disableRequestSending&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[rdu] re-enable history sync on demand."]))),q())}).onOrAfter(c)}}function q(){m.disableRequestSending=!1,m.failureCount=0,m.firstFailureRequestTimeStampSec=void 0}function f(a){var b=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary();if(b==null||Object.keys(b).length===0||(b==null?void 0:b[a.toJid()])==null){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[rdu] cannot delete chat "," from initial sync boundary."])),a.toLogString());return}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[rdu] delete chat "," from initial sync boundary"])),a.toLogString());delete b[a.toJid()];void d("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary(b)}g.inFlightHistorySyncOnDemandRequests=l;g.historySyncOnDemandRequestsFailureRecord=m;g.getOldestMsgInChatFromDB=a;g.handleHistorySyncOnDemandSuccess=c;g.handleHistorySyncOnDemandFailure=e;g.deleteChatFromInitialSyncBoundary=f}),98);
__d("WAWebChatDeleteBridge",["Promise","WALogger","WASyncdConst","WATimeUtils","WAWebABProps","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebApiOrphanTcToken","WAWebBizChatAssignmentAction","WAWebBizGatingUtils","WAWebDBLabelAssociationDatabaseApi","WAWebDBQueryAndRemoveMessageHistory","WAWebDeleteChatSync","WAWebEditLabelAssociationBridge","WAWebFtsClient","WAWebListsGatingUtils","WAWebMessageRangeUtils","WAWebModelStorageUtils","WAWebMuteChatSync","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPinChatSync","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebSchemaLabelAssociation","WAWebSyncdDb","WAWebUpdateLastAddOnPreviewChatAction","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["chat","label-association","message-association","message","chat-assignment","orphan-tc-token","sync-actions"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=(yield d("WAWebDBQueryAndRemoveMessageHistory").getBoundsForChat(a)),e=(yield d("WAWebSchemaChat").getChatTable().get(a.toString()));e=(yield (i||(i=b("Promise"))).all([d("WAWebSchemaChat").getChatTable().remove(a.toString()),d("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessageHistory(a),j(a),d("WAWebBizChatAssignmentAction").removeChatAssignmentsForChat(a),l(a,e==null?void 0:e.tcToken,e==null?void 0:e.tcTokenTimestamp),t(a,(e==null?void 0:e.accountLid)!=null?d("WAWebWidFactory").createWid(e.accountLid):null)]));e[0];var f=e[1];e[2];return{chatBoundaries:c,deletedMsgIds:f}})).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.chatBoundaries;b=b.deletedMsgIds;!c?d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendConversationDelete: chat boundaries was null"]))):(d("WAWebFtsClient").ftsClient.purgeRange(babelHelpers["extends"]({chatId:a.toString()},c)),d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(b),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.toString(),b)))});return function(a){return c.apply(this,arguments)}}())}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!(d("WAWebBizGatingUtils").canEditLabelAssociation()||d("WAWebListsGatingUtils").isListsEnabled()))return;a=(yield n(a));var b=a.labelsToUpdate;a=a.modelRecords;yield d("WAWebEditLabelAssociationBridge").editLocalLabelAssociationMD(b,a)});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){return d("WAWebABProps").getABPropConfigValue("enable_spam_report_iq_with_privacy_token")&&c!=null&&e!=null?d("WAWebApiOrphanTcToken").createOrUpdateOrphanTcToken(a,{tcToken:c,tcTokenTimestamp:e}):(i||(i=b("Promise"))).resolve()});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebDBLabelAssociationDatabaseApi").queryLocalLabelAssociations([{associationId:a.toString(),type:d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid}]));return{labelsToUpdate:b.map(function(a){a=a.labelId;return{id:a,type:"remove"}}),modelRecords:[{labelAssociationType:d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid,modelId:a.toString(),mutationIndexSegments:[a.toString({legacy:!0})]}]}});return o.apply(this,arguments)}function p(a,b,c,d,e){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){f===void 0&&(f=!1);var k=d("WATimeUtils").unixTimeMs();k=(yield (i||(i=b("Promise"))).all([c("WAWebDeleteChatSync").getDeleteChatMutation(k,a,!f),d("WAWebPinChatSync").PinChatSync.getPinMutation(k,!1,a),r(a)]));var m=k[0],n=k[1];k=k[2];k=[].concat(k,[n]);e&&k.push(m);var o;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["message","chat","label-association","message-association","group-metadata","orphan-tc-token","sync-actions"],k,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:!f}),m.binarySyncAction);o=(yield d("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessageHistory(a));var c=(yield d("WAWebApiChat").getChatRecord(a));yield (i||(i=b("Promise"))).all([d("WAWebSchemaChat").getChatTable().remove(a.toString()),d("WAWebSchemaGroupMetadata").getGroupMetadataTable().remove(a.toString()),j(a),l(a,g,h),t(a,(c==null?void 0:c.accountLid)!=null?d("WAWebWidFactory").createWid(c.accountLid):null)])}));return{status:200,result:o}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!(d("WAWebBizGatingUtils").canEditLabelAssociation()||d("WAWebListsGatingUtils").isListsEnabled()))return[];a=(yield n(a));var b=a.labelsToUpdate;a=a.modelRecords;return d("WAWebEditLabelAssociationBridge").createLabelAssociationMutations(b,a)});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=[JSON.stringify([c("WAWebMuteChatSync").getAction(),a.toJid()])];e!=null&&f.push(JSON.stringify([c("WAWebMuteChatSync").getAction(),e.toJid()]));e=(yield (i||(i=b("Promise"))).all(f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSyncdDb").getSyncAction(a));if(b==null||b.actionState===d("WASyncdConst").SyncActionState.Orphan)return;return a});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean);yield d("WAWebSyncdDb").updateSyncActionRows(e.map(function(b){return{index:b,actionState:d("WASyncdConst").SyncActionState.Orphan,modelType:d("WASyncdConst").SyncModelType.Chat,modelId:a.toString()}}))});return u.apply(this,arguments)}function e(a,c,e){return p(a,!0,!1,c,e).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(b.result!=null&&b.result.length>0){var c=b.result;d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(c);d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").deleteChatFromInitialSyncBoundary(a);yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.toString(),c));return b}return b});return function(a){return c.apply(this,arguments)}}())}g.deleteFromStorage=a;g.sendConversationDelete=e}),98);
__d("WAWebChatFindBridge",["WAWebApiHydrateWidsUtil","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaChat").getChatTable().get(a,!1));return a?d("WAWebApiHydrateWidsUtil").hydrateWids(a):null});return h.apply(this,arguments)}g.findLocal=a}),98);
__d("WAWebChatGetExistingBridge",["WAWebChatCollection","WAWebChatFindBridge","WAWebNewsletterCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebChatCollection").ChatCollection.get(a);if(b&&!b.stale)return b;b=a.isNewsletter();if(b){var e=c("WAWebNewsletterCollection").get(a);if(e!=null&&!e.stale)return c("WAWebNewsletterCollection").get(a)}e=(yield d("WAWebChatFindBridge").findLocal(a.toString()));return e?b?c("WAWebNewsletterCollection").gadd(e):d("WAWebChatCollection").ChatCollection.gadd(e):null});return h.apply(this,arguments)}g.getExisting=a}),98);
__d("WAWebChatMuteBridge",["WAWebMuteChatSync","WAWebSyncdCoreApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e=(yield c("WAWebMuteChatSync").generateMuteMutation(a,b));e=d("WAWebSyncdCoreApi").lockForSync(["chat"],[e],function(c){c=c[0];return c.merge(a.toString(),{muteExpiration:b})}).then(function(){return{status:200}});return e});return h.apply(this,arguments)}g.sendConversationMute=a}),98);
__d("WAWebChatSeenBridge",["WALogger","WATimeUtils","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebMarkChatAsReadSync","WAWebMessageRangeUtils","WAWebMiscErrors","WAWebSchemaChat","WAWebSendReadReceiptJob","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WATimeUtils").unixTimeMs();if(e===-1){var g=(yield c("WAWebMarkChatAsReadSync").getMarkChatAsReadMutation(f,!0,a.id));e=a.id.toString();d("WAWebMessageRangeUtils").lockForMessageRangeSync([],[g],function(){return d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.id.toString(),"markChatAsRead",g.binarySyncAction)});yield d("WAWebApiChat").updateChatForMarkAsReadSync(e)}else yield d("WAWebSendReadReceiptJob").markChatRead(a,b)});return j.apply(this,arguments)}function e(a,b){b=d("WATimeUtils").unixTimeMs();return c("WAWebMarkChatAsReadSync").getMarkChatAsReadMutation(b,!1,a).then(function(b){return d("WAWebMessageRangeUtils").lockForMessageRangeSync([],[b],function(){return d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),"markChatAsRead",b.binarySyncAction)})})}function f(a,b){return d("WAWebSchemaChat").getChatTable().merge(a.toString(),{unreadCount:b,unreadDividerOffset:0})["catch"](function(a){if(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw a;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["update chat table failed"]))).verbose().devConsole(a).sendLogs("update chat table failed when mark conversation seen");throw c("err")("update chat table failed")})}function k(a){return d("WAWebSchemaChat").getChatTable().merge(a.toString(),{unreadCount:-1,unreadDividerOffset:0})["catch"](function(a){if(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw a;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["update chat table failed"]))).verbose().devConsole(a).sendLogs("update chat table failed when mark conversation as unseen");throw c("err")("update chat table failed")})}g.sendConversationSeen=a;g.sendConversationUnseen=e;g.markConversationSeen=f;g.markConversationUnseen=k}),98);
__d("WAWebSyncdWamAppState",["WAPREList","WAPREMetrics","WAShiftTimer"],(function(a,b,c,d,e,f,g){"use strict";var h=k(),i=new(d("WAShiftTimer").ShiftTimer)(c),j=1e3*60*5;function a(){i.isScheduled()&&i.forceRunNow()}function k(){return{mutationCount:0,invalidActionCount:0,unsupportedActionCount:0,keyRotationRemoveCount:0,storedMutationCount:0,uploadConflictCount:0,unsetActionCount:0,missingKeyCount:0}}function l(){h=k()}function m(a){return{"int":babelHelpers["extends"]({},a)}}function b(a){var b,c,d,e,f,g,h,i;return{mutationCount:(a==null||(b=a["int"])==null?void 0:b.mutationCount)||0,invalidActionCount:(a==null||(c=a["int"])==null?void 0:c.invalidActionCount)||0,unsupportedActionCount:(a==null||(d=a["int"])==null?void 0:d.unsupportedActionCount)||0,keyRotationRemoveCount:(a==null||(e=a["int"])==null?void 0:e.keyRotationRemoveCount)||0,storedMutationCount:(a==null||(f=a["int"])==null?void 0:f.storedMutationCount)||0,uploadConflictCount:(a==null||(g=a["int"])==null?void 0:g.uploadConflictCount)||0,unsetActionCount:(a==null||(h=a["int"])==null?void 0:h.unsetActionCount)||0,missingKeyCount:(a==null||(i=a["int"])==null?void 0:i.missingKeyCount)||0}}function c(){var a=m(h);l();d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.APP_STATE_SYNC_DAILY).endSuccess(a)}function n(){i.onOrBefore(j)}function e(a){if(a===0)return;h.mutationCount+=a;n()}function f(a){h.invalidActionCount=a,n()}function o(a){h.unsupportedActionCount=a,n()}function p(a){if(a===0)return;h.keyRotationRemoveCount+=a;n()}function q(a){h.storedMutationCount=a,n()}function r(){h.uploadConflictCount++,n()}function s(a){if(a===0)return;h.unsetActionCount+=a;n()}function t(a){h.missingKeyCount=a,n()}g.forceCommitAppState=a;g.clear=l;g.convertAppStateSyncDailyFromAnnotations=b;g.addMutationCount=e;g.setInvalidActionCount=f;g.setUnsupportedActionCount=o;g.addKeyRotationRemoveCount=p;g.setStoredMutationCount=q;g.incConflict=r;g.addUnsetActionCount=s;g.setMissingKeyCount=t}),98);
__d("WAWebChatSendStarMsgsBridge",["WALogger","WAWebDBProcessMessage","WAWebStarMessageSync","WAWebSyncdCoreApi","WAWebSyncdWamAppState","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j(b,c)}function e(a,b){return j(a,!1)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b||d("WAWebSyncdWamAppState").addUnsetActionCount(a.length);var e=(yield c("WAWebStarMessageSync").getStarMessageMutations(a.map(function(a){return a.id}),b));return d("WAWebSyncdCoreApi").lockForSync(["message","message-association"],e,function(){return b?d("WAWebDBProcessMessage").starMessages(a.map(function(a){return a.id.toString()}))["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["star messages failed"]))).verbose().devConsole(a).sendLogs("star messages failed");throw c("err")("star messages failed")}):d("WAWebDBProcessMessage").unstarMessages(a.map(function(a){return a.id.toString()}))["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["unstar messages failed"]))).verbose().devConsole(a).sendLogs("unstar messages failed");throw c("err")("unstar messages failed")})})});return k.apply(this,arguments)}g.sendStarMsgs=a;g.sendUnstarAll=e}),98);
__d("WAWebDBBulkPersistProfilePic",["WABatcher","WALogger","WAWebSchemaProfilePicThumb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=d("WABatcher").batch({delayMs:3e3},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield k(a);return[]});return function(b){return a.apply(this,arguments)}}());function a(a){return j(a)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistProfilePicChanges processing "," records"])),a.length);a=Array.from(a.reduce(function(a,b){a.set(b.id,b);return a},new Map()).values());yield d("WAWebSchemaProfilePicThumb").getProfilePicThumbTable().bulkCreateOrMerge(a);d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["bulkPersistProfilePicChanges persisted "," records"])),a.length)});return l.apply(this,arguments)}g.persistProfilePicBatched=a;g.bulkPersistProfilePicChanges=k}),98);
__d("WAWebGroupGetProfilePicsJob",["WALogger","WASmaxGroupsGetGroupProfilePicturesRPC","WAWebBackendErrors","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({IMAGE:"image",PREVIEW:"preview"}),j=Object.freeze({BLOB:"blob",URL:"url"});function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=c.subgroupHintId,f=c.type;f=f===void 0?i.PREVIEW:f;c=c.query;c=c===void 0?j.URL:c;var g={profilePictureTypeMixinArgs:{pictureType:f},profilePictureQueryMixinArgs:{pictureQuery:c}};f=a.map(function(a){var b=a.groupId,c=a.photoId;a=a.isParentGroup;a=a===void 0?!1:a;a=a?{parentGroup:{anyParentGroupJid:d("WAWebWidToJid").widToGroupJid(b)}}:{subGroup:{anySubGroupJid:d("WAWebWidToJid").widToGroupJid(b)}};return babelHelpers["extends"]({parentOrSubGroupMixinGroupArgs:a,profilePictureIdMixinArgs:c!=null?{pictureId:c}:void 0},g)});c=(yield d("WASmaxGroupsGetGroupProfilePicturesRPC").sendGetGroupProfilePicturesRPC({pictureArgs:f,subGroupHintMixinArgs:e?{anyLinkedGroupsMembershipHint:d("WAWebWidToJid").widToGroupJid(e)}:void 0,baseGetGroupOrServerMixinGroupArgs:{baseGetGroup:{iqTo:d("WAWebWidToJid").widToGroupJid(b)}}}));switch(c.name){case"GetGroupProfilePicturesResponseSuccessGroupPictures":a=c.value.picturesPicture.map(function(a){var b;a.parentOrSubGroupMixinGroup.name==="SubGroup"?b=d("WAWebWidFactory").createWid(a.parentOrSubGroupMixinGroup.value.subGroupJid):b=d("WAWebWidFactory").createWid(a.parentOrSubGroupMixinGroup.value.parentGroupJid);switch(a.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.name){case"GetGroupProfilePicturesSuccessProfilePictureResponse":var c,e=a.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.value;return{id:b,tag:e.id,eurl:(c=e.profilePictureUrlOrBlobResponseMixinGroup)==null?void 0:c.value.url,directPath:(c=e.profilePictureUrlOrBlobResponseMixinGroup)==null?void 0:c.value.directPath,type:e.type,updatePicture:!0};case"GetGroupProfilePicturesPartialProfilePictureResponse":c=!1;((e=a.getGroupProfilePicturesSuccessOrGetGroupProfilePicturesPartialProfilePictureResponseMixinGroup.value.pictureDidNotChangeOrPictureNotFoundOrBadServerProfilePictureErrorOrBadLinkedGroupProfilePictureErrorMixinGroup)==null?void 0:e.name)==="PictureNotFound"&&(c=!0);return{id:b,tag:null,eurl:null,directPath:null,type:null,updatePicture:c}}});return a;case"GetGroupProfilePicturesResponseClientError":f=c.value.errorGetGroupProfilePictureClientErrors.value.code;e=c.value.errorGetGroupProfilePictureClientErrors.value.text;return l(f,e);case"GetGroupProfilePicturesResponseServerError":b=c.value.errorServerErrors.value.code;a=c.value.errorServerErrors.value.text;return l(b,a)}});return k.apply(this,arguments)}function l(a,b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getGroupProfilePics failed: ",":",""])),a,b).tags("non-sad").sendLogs("pictures-error",{sampling:.01});return Promise.reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),b))}g.ProfilePicsTypeEnum=i;g.ProfilePicsQueryEnum=j;g.getProfilePics=a}),98);
__d("WAWebFetchCommunityProfilePicAction",["Promise","WAWebGroupGetProfilePicsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f={id:a};e={groupId:a,photoId:e!=null?String(e):null,isParentGroup:a.equals(c)};a=(yield (h||(h=b("Promise"))).all([d("WAWebGroupGetProfilePicsJob").getProfilePics([e],c,{type:d("WAWebGroupGetProfilePicsJob").ProfilePicsTypeEnum.IMAGE}),d("WAWebGroupGetProfilePicsJob").getProfilePics([e],c,{type:d("WAWebGroupGetProfilePicsJob").ProfilePicsTypeEnum.PREVIEW})]));e=a[0];c=a[1];return!c[0]||!c[0].updatePicture||!e[0]||!e[0].updatePicture?f:babelHelpers["extends"]({},f,{eurl:(a=e[0].eurl)!=null?a:void 0,fullDirectPath:(f=e[0].directPath)!=null?f:void 0,previewEurl:(a=c[0].eurl)!=null?a:void 0,previewDirectPath:(f=c[0].directPath)!=null?f:void 0,tag:(a=e[0].tag)!=null?a:void 0,timestamp:Date.now(),eurlStale:!1,stale:!1})});return i.apply(this,arguments)}g.fetchCommunityProfilePic=a}),98);
__d("WAWebSendProfilePictureJob",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new(c("WADeprecatedWapParser"))("photoResponseParser",function(a){a.assertAttr("type","result");if(a.hasChild("picture")){a=a.child("picture");return{id:a.attrInt("id")}}return{id:null}});function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=(yield d("WADeprecatedSendIq").deprecatedSendIq(d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,target:c("WAWebWid").isGroup(a)?d("WAWebCommsWapMd").CHAT_JID(a):d("WAWap").DROP_ATTR,type:"set",xmlns:"w:profile:picture",id:d("WAWap").generateId()},e?d("WAWap").wap("picture",{type:"image"},e):null),i));return!a.success?(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText)):{id:a.result.id}});return j.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebContactProfilePicThumbBridge",["Promise","WABase64","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebChangeProfilePicThumb","WAWebDBBulkPersistProfilePic","WAWebFetchCommunityProfilePicAction","WAWebFetchNewsletterProfilePicAction","WAWebGetProfilePicJob","WAWebProfilePicConstants","WAWebSendProfilePictureJob","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function a(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=c("WAWebSendProfilePictureJob")(a,null).then(function(){return{status:200}});b=(yield b);d("WAWebChangeProfilePicThumb").changeProfilePicThumb(a,d("WAWebProfilePicConstants").ProfilePicCommand.Remove);return b});return o.apply(this,arguments)}function e(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e=c("WAWebURLUtils").parseDataURL(f).data;f=d("WABase64").decodeB64(e);e=c("WAWebSendProfilePictureJob")(a,f).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebGetProfilePicJob").getProfilePic(a,{preview:!1}));return{tag:b.tag,eurl:b.eurl,fullDirectPath:b.directPath,filehash:b.filehash,status:200}}));f=(yield e);d("WAWebChangeProfilePicThumb").changeProfilePicThumb(a,d("WAWebProfilePicConstants").ProfilePicCommand.Set);return f});return p.apply(this,arguments)}function q(a,b){return{id:a.toString(),eurl:(a=b==null?void 0:b.eurl)!=null?a:null,previewEurl:(a=b==null?void 0:b.previewEurl)!=null?a:null,tag:(a=b==null?void 0:b.tag)!=null?a:null,previewDirectPath:(a=b==null?void 0:b.previewDirectPath)!=null?a:null,fullDirectPath:(a=b==null?void 0:b.fullDirectPath)!=null?a:null,filehash:(a=b==null?void 0:b.filehash)!=null?a:null,timestamp:Date.now()}}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=q(a,b);yield d("WAWebDBBulkPersistProfilePic").persistProfilePicBatched(a)});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=(n||(n=b("Promise"))).all([d("WAWebGetProfilePicJob").getProfilePic(a,babelHelpers["extends"]({},c,{preview:!1})),d("WAWebGetProfilePicJob").getProfilePic(a,babelHelpers["extends"]({},c,{preview:!0}))]).then(function(a){var b=a[0];a=a[1];var c={eurl:b.eurl,tag:b.tag,previewEurl:a.eurl,previewDirectPath:a.directPath,fullDirectPath:b.directPath};a=(a=a.filehash)!=null?a:b.filehash;a!=null&&(c.filehash=a);return c});try{var e=(yield c);r(a,e)["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),a.message).devConsole(a)});x(a,e.eurl)}catch(b){x(a),v(a,b)["catch"](function(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicFind:Catch persistProfilePicToDB failed with error ",""])),a.message).devConsole(a)})}return c});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b instanceof d("WAWebBackendErrors").ServerStatusCodeError){b=b.status;b===500||b===501||b===503?d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["profilePicFind failed with serverCode: ",""])),b):b===404?yield r(a):b===401&&!a.isGroup()&&(yield r(a))}});return w.apply(this,arguments)}function x(a,b){a.equals(d("WAWebUserPrefsMeUser").getMaybeMePnUser())&&d("WAWebUserPrefsMultiDevice").setCachedProfilePicEURL(b!=null?b:"")}function f(a){return(n||(n=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=(yield t(a.id));return{id:a.id,eurl:b.eurl,tag:b.tag,previewEurl:b.previewEurl,previewDirectPath:b.previewDirectPath,fullDirectPath:b.fullDirectPath,filehash:b.filehash,stale:!1,eurlStale:!1,timestamp:Date.now()}}catch(b){if(b instanceof d("WAWebBackendErrors").ServerStatusCodeError)switch(b.status){case 401:case 404:return{tag:"",id:a.id,stale:!1,eurlStale:!1,timestamp:Date.now()};default:d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumb:resyncPictures error - ",", ",""])),b.status,b.message);return{id:a.id,stale:!1,eurlStale:!1,timestamp:Date.now()}}throw b}});return function(b){return a.apply(this,arguments)}}()))}function y(a,b,c,d){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){try{if(a.isNewsletter()){var g=(yield d("WAWebFetchNewsletterProfilePicAction").fetchNewsletterProfilePic(d("WAWebWidFactory").asNewsletterWidOrThrow(a)));r(a,g)["catch"](function(a){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),a.message).devConsole(a)});return g}if(c!=null){g=(yield d("WAWebFetchCommunityProfilePicAction").fetchCommunityProfilePic(a,c));r(a,g)["catch"](function(a){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["persistProfilePicToDB failed with error ",""])),a.message).devConsole(a)});return g}c=(yield t(a,{tcToken:e,commonGid:f}));g=babelHelpers["extends"]({},c,{id:a,timestamp:Date.now(),eurlStale:!1,stale:!1});return g}catch(c){return d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(c){var d={id:a};switch(c.status){case 401:case 404:d.tag="";d.timestamp=Date.now();d.eurlStale=!1;d.stale=!1;break;case 423:d.stale=!0;break;case 429:d.stale=!0;break;default:d.eurlStale=!1;break}return(n||(n=b("Promise"))).resolve(d)})(c)}});return z.apply(this,arguments)}g.requestDeletePicture=a;g.sendSetPicture=e;g.mapProfilePictureToProfilePicThumbRowType=q;g.persistProfilePicToDB=r;g.profilePicResync=f;g.requestProfilePicFromServer=y}),98);
__d("WAWebMexFetchAboutStatusJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"user"}],b=[{kind:"Literal",name:"updates",value:["STATUS"]},{items:[{kind:"Variable",name:"users.0",variableName:"user"}],kind:"ListValue",name:"users"}],c={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],type:"XWA2UserStatusUpdate",abstractKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchAboutStatusJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2UserUpdate",kind:"LinkedField",name:"xwa2_users_updates_since",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"updates",plural:!0,selections:[c],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchAboutStatusJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2UserUpdate",kind:"LinkedField",name:"xwa2_users_updates_since",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"updates",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c],storageKey:null}],storageKey:null}]},params:{id:"24535500086059408",metadata:{},name:"WAWebMexFetchAboutStatusJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchAboutStatusJob",["Promise","WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchAboutStatusJobQuery.graphql","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.wid;a=a.tcToken;if(!c("WAWebWid").isWid(e)||!e.isUser()){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[mex][about_status] this method should only take user wid, instead it received: ",""])),e).tags("mex","about_status").devConsole({wid:e}).sendLogs("mex-about-status-wrong-wid");return(k||(k=b("Promise"))).resolve({id:e})}var f=h!==void 0?h:h=b("WAWebMexFetchAboutStatusJobQuery.graphql"),g={user_id:e.user};a!=null&&d("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInMexFetchEnabled()&&(g.privacy_token={tctoken:d("WAWebTrustedContactsUtils").encodeTcTokenForMex(a)});a={user:g};try{var l;g=(yield d("WAWebMexClient").fetchQuery(f,a));a=(f=g.xwa2_users_updates_since)==null?void 0:f[0];a==null&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[mex][about_status] empty return list"]))).tags("mex","about_status").devConsole({response:g}).sendLogs("mex-about-status-empty-return-list");f=a==null||(l=a.updates)==null||(l=l[0])==null?void 0:l.text;return{id:e,status:f}}catch(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError){g=a.statusCode;return g===401?{id:e,status:""}:{id:e,error:{errorCode:g,errorText:a.message}}}throw a}});return l.apply(this,arguments)}g.mexGetAbout=a}),98);
__d("WAWebGetAboutQueryJob",["Promise","WALogger","WAWebMexFetchAboutStatusJob","WAWebUsync","WAWebUsyncUser","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.wid;if(!b.isLid()){b=(yield d("WAWebMexFetchAboutStatusJob").mexGetAbout(a));return b}return l(a)});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.wid;a=a.tcToken;if(!c("WAWebWid").isWid(e)||!e.isUser()){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getAbout: this method should only take user wid, instead it received: ",""])),e);return(j||(j=b("Promise"))).resolve({id:e})}var f=new(d("WAWebUsyncUser").USyncUser)().withId(e);a!=null&&f.withTcToken(a);a=new(d("WAWebUsync").USyncQuery)().withContext("interactive").withMode("query").withStatusProtocol().withUser(f);f=(yield a.execute());if(f.error.all||f.error.status){a=f.error.all||f.error.status;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getAbout: failed "," : ",""])),a.errorCode,a.errorText);return{id:e,error:a}}a=f.list;return!a.length?(j||(j=b("Promise"))).reject(c("err")("no status data returned for user")):{id:e,status:a[0].status}});return m.apply(this,arguments)}g.getAbout=a}),98);
__d("WAWebMexUsersGetAboutStatus",["$InternalEnum","WAWebMexUsync","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["EMPTY","NOT_ALLOWED","NO_CHANGE"]);function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.wid;a=a.tcToken;b={jid:b.toJid()};a!=null&&d("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInUsyncEnabled()&&(b.privacy_token={tctoken:d("WAWebTrustedContactsUtils").encodeTcTokenForMex(a)});a=(yield d("WAWebMexUsync").mexUsyncQuery({users:[b],telemetry:{context:"INTERACTIVE"},fetch:{about_status:!0}}));b=a.response;if(b!=null){a=(a=b[0].about_status_info)==null?void 0:a.text;b=h.cast((b=b[0].about_status_info)==null?void 0:b.status);if(b==null)return{status:a,state:null};else if(b===h.NOT_ALLOWED)return{status:"",state:null};else if(b===h.EMPTY)return{status:null,state:null};return{state:b}}return{state:h.EMPTY}});return i.apply(this,arguments)}g.getMexUsersAboutStatus=a}),98);
__d("WAWebContactStatusBridge",["WALogger","WAWebABProps","WAWebAck","WAWebApiStatus","WAWebGetAboutQueryJob","WAWebMexUsersGetAboutStatus","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebSendReadReceiptJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.wid;if(d("WAWebABProps").getABPropConfigValue("mex_usync_about_status")){var c=(yield d("WAWebMexUsersGetAboutStatus").getMexUsersAboutStatus(a)),e=c.status;c=c.state;return c==null?{id:b,status:e}:{id:b,stale:!0,status:null}}return d("WAWebGetAboutQueryJob").getAbout(a).then(function(a){if(a.error){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getStatus: failed "," : ",""])),a.error.errorCode,a.error.errorText);return{id:a.id,stale:!0,status:""}}return{id:a.id,status:a.status}})});return i.apply(this,arguments)}function c(a){return d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.setAbout(a))}function e(){return d("WAWebApiStatus").getAllStatuses()}function f(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{yield d("WAWebSendReadReceiptJob").markStatusRead(a,b,c);a.ack=d("WAWebAck").ACK.READ;return!0}catch(a){return!1}});return j.apply(this,arguments)}g.getStatus=a;g.setMyStatus=c;g.queryStatusAll=e;g.sendReadStatus=f}),98);
__d("WAWebRequestMediaReuploadBridge",["WAWebProtobufsMmsRetry.pb","WAWebRequestMediaReuploadManager"],(function(a,b,c,d,e,f,g){function h(a){if(a!=null)switch(a){case d("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.SUCCESS:return 200;case d("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.NOT_FOUND:case d("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.DECRYPTION_ERROR:return 404;case d("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType.GENERAL_ERROR:return 500}return 500}function a(a){return d("WAWebRequestMediaReuploadManager").RequestMediaReuploadManager.requestMediaReupload(a).then(function(a){var b=a.result;a=a.directPath;return{status:h(b),directPath:a,isMD:!0}})}g["default"]=a}),98);
__d("WAWebDBUpdateMessageTable",["WALogger","WAWebSchemaMessage"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return d("WAWebSchemaMessage").getMessageTable().merge(a.toString(),b)["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateMessageTable: failed to update in storage"]))).verbose().devConsole(a).sendLogs("updateMessageTable failed");throw a})}g.updateMessageTable=a}),98);
__d("WAWebMsgReactionsBridge",["Promise","WALogger","WAWebAck","WAWebDBGetReactions","WAWebDBUpdateMessageTable","WAWebLidMigrationUtils","WAWebMsgCollection","WAWebMsgKey","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=d("WAWebMsgCollection").MsgCollection.get(a);if(a&&a.hasReaction!==c){c={hasReaction:c};yield d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,c);a.set(c)}return(i||(i=b("Promise"))).resolve()});return k.apply(this,arguments)}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;try{b=(yield d("WAWebDBGetReactions").getReactions(a.id.toString()));if(b.reactions.length===0&&a.id.remote.isStatus()){var e=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id);e&&(b=(yield d("WAWebDBGetReactions").getReactions(e.toString())))}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getReactions: failed with error: "," message: ",""])),a.name,a.message).verbose().devConsole(a).sendLogs("getReactions failed");throw a}e=b.reactions.map(function(a){var b=a.senders.map(function(a){return babelHelpers["extends"]({},a,{id:c("WAWebMsgKey").fromString(a.msgKey),isSendFailure:d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid)&&a.ack===d("WAWebAck").ACK.CLOCK})});return babelHelpers["extends"]({},a,{hasReactionByMe:a.hasReactionByMe,id:a.aggregateEmoji,senders:b})});var f=e.length>0;yield j(a.id.toString(),f);return babelHelpers["extends"]({},b,{id:a.id,reactions:e})});return l.apply(this,arguments)}g.updateHasReactionInParent=j;g.sendQueryReactions=a}),98);
__d("WAWebWamEnumForwardOrigin",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:1,CHAT:2,STATUS:3,CHANNELS:4,META_AI:5});f.FORWARD_ORIGIN=a}),66);
__d("WAWebWamEnumForwardPickerOrigin",[],(function(a,b,c,d,e,f){a=Object.freeze({STATUS_VIEWER:1});f.FORWARD_PICKER_ORIGIN=a}),66);
__d("WAWebWamEnumMessageBizType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_BIZ_MSG:0,API_MARKETING:1,API_UTILITY:2,OTHER_API_BIZ_MSG:3,SMB_BIZ_MSG:4});f.MESSAGE_BIZ_TYPE=a}),66);
__d("WAWebForwardSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumForwardOrigin","WAWebWamEnumForwardPickerOrigin","WAWebWamEnumMediaType","WAWebWamEnumMessageBizType","WAWebWamEnumMessageType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ForwardSend:[1728,{disappearingChatInitiator:[21,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],e2eCiphertextType:[12,d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eCiphertextVersion:[11,a.TYPES.INTEGER],ephemeralityDuration:[18,a.TYPES.INTEGER],ephemeralityInitiator:[24,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[25,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],fastForwardEnabled:[5,a.TYPES.BOOLEAN],forwardOrigin:[28,d("WAWebWamEnumForwardOrigin").FORWARD_ORIGIN],forwardPickerOrigin:[27,d("WAWebWamEnumForwardPickerOrigin").FORWARD_PICKER_ORIGIN],isForwardedForward:[22,a.TYPES.BOOLEAN],isFrequentlyForwarded:[14,a.TYPES.BOOLEAN],mediaCaptionPresent:[10,a.TYPES.BOOLEAN],messageBizType:[26,d("WAWebWamEnumMessageBizType").MESSAGE_BIZ_TYPE],messageForwardAgeT:[4,a.TYPES.TIMER],messageIsFanout:[6,a.TYPES.BOOLEAN],messageIsFastForward:[3,a.TYPES.BOOLEAN],messageIsInternational:[9,a.TYPES.BOOLEAN],messageMediaType:[2,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageSendT:[13,a.TYPES.TIMER],messageType:[1,d("WAWebWamEnumMessageType").MESSAGE_TYPE],receiverDefaultDisappearingDuration:[20,a.TYPES.INTEGER],resendCount:[8,a.TYPES.INTEGER],retryCount:[7,a.TYPES.INTEGER],senderDefaultDisappearingDuration:[19,a.TYPES.INTEGER],typeOfGroup:[23,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],wouldBeFrequentlyForwardedAt3:[16,a.TYPES.BOOLEAN],wouldBeFrequentlyForwardedAt4:[17,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{ForwardSend:[]});g.ForwardSendWamEvent=b}),98);
__d("WAWebMsgUtilsBridge",["WALogger","WATimeUtils","WAWebABProps","WAWebBackendApi","WAWebChatThreadLogging","WAWebChatThreadLoggingUtils","WAWebContactCollection","WAWebDBMsgUtils","WAWebDBProcessReplyMsgs","WAWebEphemeralityResolver","WAWebForwardSendWamEvent","WAWebMsgGetters","WAWebMsgType","WAWebWamGroupMetadataMetricUtils","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=Boolean(a.caption);a.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT&&(b=a.isCaptionByUser);b={messageType:a.getWamMessageType(),messageMediaType:a.getWamMediaType(),mediaCaptionPresent:b,fastForwardEnabled:!0,messageIsFanout:!0,isFrequentlyForwarded:Boolean(d("WAWebMsgGetters").getIsFrequentlyForwarded(a)),isForwardedForward:Boolean(d("WAWebMsgGetters").getNumTimesForwarded(a)>1)};a.ephemeralDuration!=null&&(b.ephemeralityDuration=a.ephemeralDuration);if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){var c=d("WAWebMsgGetters").getWamDisappearingModeTrigger(a);c!=null&&(b.ephemeralityTriggerAction=c);c=d("WAWebMsgGetters").getWamDisappearingModeInitiatedByMe(a);c!=null&&(b.ephemeralityInitiator=c)}d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["createMessageForwardMetric"])));if(!d("WAWebMsgGetters").getIsGroupMsg(a)){c=d("WAWebEphemeralityResolver").getEphemeralDurationForUser(d("WAWebContactCollection").ContactCollection.getMeContact());c!=null&&(b.senderDefaultDisappearingDuration=c);c=d("WAWebEphemeralityResolver").getEphemeralDurationForUser(d("WAWebContactCollection").ContactCollection.get(a.to));c!=null&&(b.receiverDefaultDisappearingDuration=c)}c=a.getWamDisappearingModeInitiator();c!=null&&(b.disappearingChatInitiator=c);c=(yield d("WAWebWamGroupMetadataMetricUtils").getGroupTypeFromChatWid(a.to));c!=null&&(b.typeOfGroup=c);return new(d("WAWebForwardSendWamEvent").ForwardSendWamEvent)(b)});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;return((b=a.quotedMsg)==null?void 0:b.type)!==d("WAWebMsgType").MSG_TYPE.PRODUCT||!d("WAWebMsgGetters").getIsSentByMe(a)?!1:d("WAWebBackendApi").frontendSendAndReceive("isMessageSentToBusiness",{msgKey:a.id})});return k.apply(this,arguments)}function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebChatThreadLoggingUtils").shouldIncrementMsgSendAndReceive(a))return;if(c("justknobx")._("2641")&&d("WAWebABProps").getABPropConfigValue("group_status_receiver_enabled")){var b=d("WAWebDBProcessReplyMsgs").createQuotedMsgKey(a);if(b!=="missing-stanza-id"){b=(yield d("WAWebDBMsgUtils").getMsgByMsgKey(b));if(b!=null&&d("WAWebMsgGetters").getIsGroupStatus(b)){b=d("WAWebMsgGetters").getIsSentByMe(b);var e=d("WAWebMsgGetters").getIsReply(a);return d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"groupStatusMsgSend",chatId:a.id.remote,ts:d("WATimeUtils").unixTime(),isGroupStatusReplyOwnToOwn:e&&b,isGroupStatusReplyOwnToOthers:e&&!b}])}}}d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"msgSend",chatId:a.id.remote,ts:d("WATimeUtils").unixTime(),isViewOnce:Boolean(a.isViewOnce),isReaction:d("WAWebMsgGetters").getIsReaction(a),isForwarded:d("WAWebMsgGetters").getIsForwarded(a),isCommerceMessage:d("WAWebChatThreadLoggingUtils").isCommerceMessage(a),isPdpInquiry:yield j(a),isReply:d("WAWebMsgGetters").getIsReply(a),isEdit:d("WAWebMsgGetters").getIsEditProtocolMsg(a),isBot:d("WAWebMsgGetters").getIsBotQuery(a),isEventCreation:a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,isEventResponse:a.type===d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE}])});return l.apply(this,arguments)}function f(a){a.markMessageSendT(),a.commit()}g.createMessageForwardMetric=a;g.logMessageSendForChatThreadLogging=e;g.logMessageMetric=f}),98);
__d("WAWebErrorType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NoError","EditWindowExpired","UserReachedMaxMonthlyLimitForNewMessages"]);f.SendFailureErrorCode=a}),66);
__d("WAWebWamEnumMessageCappingActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CLICK:0,VIEW:1,API:2,ENTER:3,DEBUG:4});f.MESSAGE_CAPPING_ACTION_TYPE=a}),66);
__d("WAWebMessageCappingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMessageCappingActionType","WAWebWamEnumSurfaceType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MessageCapping:[6854,{extraAttributes:[2,a.TYPES.STRING],messageCappingActionType:[6,d("WAWebWamEnumMessageCappingActionType").MESSAGE_CAPPING_ACTION_TYPE],messageCappingEntryPoint:[9,d("WAWebWamEnumSurfaceType").SURFACE_TYPE],messageCappingSequence:[7,a.TYPES.INTEGER],messageCappingSession:[8,a.TYPES.STRING],surface:[4,d("WAWebWamEnumSurfaceType").SURFACE_TYPE],userActionTarget:[5,a.TYPES.STRING]},[1,1,1],"regular"]},{MessageCapping:[]});g.MessageCappingWamEvent=b}),98);
__d("WAWebSendMsgRecordBridge",["WALogger","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebBackendApi","WAWebCreateNackFromStanza","WAWebDBUpdateMessageTable","WAWebErrorType","WAWebHandleMsgError","WAWebIndividualNewChatMessageCappingLimitGatingUtils","WAWebIndividualNewChatMessageCappingLimitUtils","WAWebMessageCappingWamEvent","WAWebMsgUtilsBridge","WAWebSendMsgJob","WAWebSendMsgTypes","WAWebUserPrefsTypes","WAWebWamEnumMessageCappingActionType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;a.isForwarded&&(c=d("WAWebMsgUtilsBridge").createMessageForwardMetric(a));try{b=(yield d("WAWebSendMsgJob").encryptAndSendMsg({type:d("WAWebSendMsgTypes").SendMessageRecordType.Message,data:a},b));c&&c.then(d("WAWebMsgUtilsBridge").logMessageMetric);if(b.error!=null)throw new(d("WAWebHandleMsgError").MessageSentAckError)(b.error);return{t:parseInt(b.t,10),count:b.count}}catch(c){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendMsgRecord: send failure, msg: ",""])),a.id.toString()).tags("messaging").devConsole(a.type);b={isSendFailure:!0};c instanceof d("WAWebHandleMsgError").MessageSentAckError&&(b=babelHelpers["extends"]({},b,{ack:d("WAWebAck").ACK.FAILED}),c.ackErrorCode===d("WAWebCreateNackFromStanza").NackReason.NewChatMessagesCapped&&(b=babelHelpers["extends"]({},b,{errorCode:d("WAWebErrorType").SendFailureErrorCode.UserReachedMaxMonthlyLimitForNewMessages}),d("WAWebIndividualNewChatMessageCappingLimitGatingUtils").isIndividualNewChatMessageCappingEnabled()&&(yield d("WAWebIndividualNewChatMessageCappingLimitUtils").resetCappingStatus(d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.CAPPED),void d("WAWebBackendApi").frontendFireAndForget("individualNewChatMessageCappingStateChange",{}),new(d("WAWebMessageCappingWamEvent").MessageCappingWamEvent)({messageCappingActionType:d("WAWebWamEnumMessageCappingActionType").MESSAGE_CAPPING_ACTION_TYPE.API,userActionTarget:"nack_received",extraAttributes:JSON.stringify(d("WAWebIndividualNewChatMessageCappingLimitUtils").getCappingData()||{})}).commit())));d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,b);a.set(b);d("WAWebAddOnsUpdateSendStatesAction").updateAddOnSendStatesForMsgAction(a,b);throw c}});return i.apply(this,arguments)}g.sendMsgRecord=a}),98);
__d("WAWebDBGetEventMessagesForChat",["Promise","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e){return(h||(h=b("Promise"))).resolve().then(function(){if(e!=null)return d("WAWebSchemaMessage").getMessageTable().get(e.toString())}).then(function(b){b=b==null?[d("WAWebDBMessageUtils").endOfChat(a),Infinity]:[b.internalId,b.isEventMsg];var e=[d("WAWebDBMessageUtils").beginningOfChat(a),0];return d("WAWebSchemaMessage").getMessageTable().between(["internalId","isEventMsg"],e,b,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:c}).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})})}g.getEventMessagesForChat=a}),98);
__d("WAWebDBMessageFindLocal",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebCallLogMsgData.flow","WAWebDBGetEventMessagesForChat","WAWebDBGetStarredMessagesForChat","WAWebDBMessageSerialization","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebFtsClient","WAWebMediaHubGating","WAWebModelStorageUtils","WAWebModelStorageVersions","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","err","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=20,o=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="NoAnchorMessageError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));function a(a,e){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["msgFindQuery: id:"," chat:"," type:",""])),e.id,e.chat,a).devConsole(e);var f=function(){return e.msgKey instanceof c("WAWebMsgKey")?e.msgKey:e.id==null?void 0:new(c("WAWebMsgKey"))(e)};if(e.label!=null)return(m||(m=b("Promise"))).resolve([]);if(a==="before")return K(e,e.count)["catch"](d("WAFilteredCatch").filteredCatch(o,function(){return{status:404}}));else if(a==="after")return M(e,e.count)["catch"](d("WAFilteredCatch").filteredCatch(o,function(){return{status:404}}));else if(a==="star"){var g=e.id==null?void 0:new(c("WAWebMsgKey"))(e);return e.chat!=null?d("WAWebDBGetStarredMessagesForChat").getStarredMessagesForChat(e.chat,e.count,g):r(e.count,g)}else if(a==="call_log"){g=e.id==null?void 0:new(c("WAWebMsgKey"))(e);return v(e.count,g)}else if(a==="event"){g=e.id==null?void 0:new(c("WAWebMsgKey"))(e);var j=d("WAWebModelStorageUtils").getStorage();return e.chat!=null&&j.doesLocalSchemaIncludeVersion(j.versions.version(152))?d("WAWebDBGetEventMessagesForChat").getEventMessagesForChat(e.chat,e.count,g):I(e.count,g)}else if(a==="search"){j={};e.remote&&(j.remote=e.remote.toString());e.count&&e.page>=0&&(j.limit=e.count,j.page=e.page);return d("WAWebFtsClient").ftsClient.search(e.searchTerm,j)}else if(a==="media"){var k=e.remote,l=f();g=e.media;switch(g){case"allDocs":return G(e.count,l,e.direction);case"allLinks":return E(e.count,l,e.direction);case"allMedia":return C(e.count,l,e.direction);case"url":return q(k,e.count,e.direction,"hasLink",l).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});case"document":return q(k,e.count,e.direction,"isDocMsg",l).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});default:return(m||(m=b("Promise"))).all(["isMediaMsg","isDocMsg","hasLink","isCarouselMsg"].map(function(a){return q(k,e.count,e.direction,a,l).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})})).then(function(a){var b=a[0],c=a[1],d=a[2];a=a[3];a=[b,d,c,a].flat();return{docCount:c.length,linkCount:d.length,mediaCount:b.length,messages:a}})}}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Message query type "," not implemented."])),a);return(m||(m=b("Promise"))).reject(c("err")("Message query type "+a+" not implemented."))}function e(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebSchemaMessage").getMessageTable().equals(["vcardWAids"],a.toString()).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})});return p.apply(this,arguments)}function q(a,c,e,f,g){var h=g==null?(m||(m=b("Promise"))).resolve(void 0):d("WAWebSchemaMessage").getMessageTable().equals(["id"],g.toString());return h.then(function(b){if(g&&b!=null&&b.length===0){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),g&&g.toString());throw new o()}b=b==null?void 0:b[0];var h,i,k=!1;e==="before"?(h=d("WAWebDBMessageUtils").beginningOfChat(a),i=b==null?d("WAWebDBMessageUtils").endOfChat(a):d("WAWebDBMessageUtils").craftInternalId(a.toString(),d("WAWebDBMessageUtils").getInChatMsgId(b.internalId||"")),k=!0):(h=b==null?d("WAWebDBMessageUtils").beginningOfChat(a):d("WAWebDBMessageUtils").craftInternalId(a.toString(),d("WAWebDBMessageUtils").getInChatMsgId(b.internalId||"")),i=d("WAWebDBMessageUtils").endOfChat(a));return d("WAWebSchemaMessage").getMessageTable().between(["internalId",f],[h,0],[i,Infinity],{lowerInclusive:!1,upperInclusive:!1,limit:c,reverse:k})})}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield t(b,function(a){return a==null?void 0:a.isStarred}));b[0];b=b[1];var c=0;return d("WAWebSchemaMessage").getMessageTable().between(["isStarred"],c,b,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:a}).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})});return s.apply(this,arguments)}function t(a,b,c,d){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){c===void 0&&(c="before");e===void 0&&(e=-Infinity);var f=null;a!=null&&(f=(yield d("WAWebSchemaMessage").getMessageTable().get(a.toString())));a=f==null?void 0:b(f);return c==="before"?[e,a!=null?a:Infinity]:[a!=null?a:e,Infinity]});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield t(b,function(a){return a==null?void 0:a.isCallLogMsg}));var c=b[0];b=b[1];c=(yield d("WAWebSchemaMessage").getMessageTable().between(["isCallLogMsg"],c,b,{lowerInclusive:!1,upperInclusive:!0,reverse:!0,limit:a}));return c.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return w.apply(this,arguments)}function f(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaMessage").getMessageTable().equals(["callOutcome"],d("WAWebCallLogMsgData.flow").CallOutcome.Ongoing));return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return x.apply(this,arguments)}function y(){var a;a=(a=d("WAWebUserPrefsMultiDevice").getPairingTimestamp())!=null?a:d("WATimeUtils").unixTime();return a-d("WATimeUtils").DAY_SECONDS*14}function z(){var a=c("justknobx")._("2155"),b=d("WAWebModelStorageUtils").getStorage();b=b.doesLocalSchemaIncludeVersion(d("WAWebModelStorageVersions").messageAddMediaRelatedIndex());var e=d("WAWebMediaHubGating").isFilesMediaHubComponentEnabled();return a&&b&&e}function A(a,b,c,d,e,f){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){c===void 0&&(c="before");var h=z(),i=c==="before";b=(yield t(b,function(a){return h?a==null?void 0:a.t:a==null?void 0:a[f]},c,e));var j=b[0],k=b[1];if(h){var l=function(a){return[[a,j],[a,k]]};c=(yield d("WAWebSchemaMessage").getMessageTable().inAnyRange(["typeFlag","t"],g.map(function(a){return l(a)}),{reverse:i,limit:a}))}else c=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId",f],["0",j],["_g",k],{lowerInclusive:!1,upperInclusive:!0,reverse:!0,limit:a})),c=c.filter(function(a){return a.t>(e!=null?e:0)});return c});return B.apply(this,arguments)}function C(a,b,c,d){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=y());var f=z();a=(yield A(a,b,c,f?e:y(),"isMediaMsg",[d("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG,d("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG|d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]));return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return D.apply(this,arguments)}function E(a,b,c,d){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=z();a=(yield A(a,b,c,f?e:void 0,"hasLink",[d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK,d("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG|d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK,d("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG|d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]));return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return F.apply(this,arguments)}function G(a,b,c,d){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=z();a=(yield A(a,b,c,f?e:void 0,"isDocMsg",[d("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG,d("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG|d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK]));return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return H.apply(this,arguments)}function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield t(b,function(a){return a==null?void 0:a.isEventMsg}));b[0];b=b[1];var c=0;return d("WAWebSchemaMessage").getMessageTable().between(["isEventMsg"],c,b,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:a}).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})});return J.apply(this,arguments)}function K(a,b){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e===void 0&&(e=n);if(!a.remote)return(m||(m=b("Promise"))).resolve([]);var f=a.remote.toString(),g=void 0;if(a instanceof c("WAWebMsgKey")){var h=(yield d("WAWebSchemaMessage").getMessageTable().equals(["id"],a.toString()));if(h.length===0){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),a.toString());throw new o()}g=h[0]}h=d("WAWebDBMessageUtils").beginningOfChat(a.remote);var i=d("WAWebDBMessageUtils").endOfChat(a.remote);if(g){g=d("WAWebDBMessageUtils").getInChatMsgId(g.internalId||"");var j=Math.max(0,g-e);i=d("WAWebDBMessageUtils").craftInternalId(f,g);h=d("WAWebDBMessageUtils").craftInternalId(f,j)}g={lowerInclusive:!0,upperInclusive:!1};h=d("WAWebDBMessageUtils").beginningOfChat(a.remote);f=(yield d("WAWebDBMessageStoreUtils").queryChatVisibleMessageHelper(h,i,babelHelpers["extends"]({},g,{reverse:!0}),e));return f.reverse().map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})});return L.apply(this,arguments)}function M(a,e){e===void 0&&(e=n);if(a instanceof c("WAWebMsgKey")){var f=a.remote.toString();return d("WAWebSchemaMessage").getMessageTable().equals(["id"],a.toString()).then(function(b){if(b.length===0){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Anchor message "," does not exist in message table"])),a.toString());throw new o()}b=b[0];b=d("WAWebDBMessageUtils").getInChatMsgId(b.internalId||"");var c=b+e;b=d("WAWebDBMessageUtils").craftInternalId(f,b);c=d("WAWebDBMessageUtils").craftInternalId(f,c);var g={lowerInclusive:!1,upperInclusive:!0};c=d("WAWebDBMessageUtils").endOfChat(a.remote);return d("WAWebDBMessageStoreUtils").queryChatVisibleMessageHelper(b,c,g,e).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})})}return(m||(m=b("Promise"))).resolve([])}g.msgFindQuery=a;g.queryVcard=e;g.queryMessageType=q;g.getVoipOngoingCallLogMessages=f;g.getMediaAvailableMsgBoundary=y;g.libraryIsChunkEnabled=z;g.getAllMediaMessages=C}),98);
__d("WAWebDBMessageRange",["Promise","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebE2EProtoUtils","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=1e3;function a(a){return d("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],d("WAWebDBMessageStoreUtils").beginningOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage),d("WAWebDBMessageStoreUtils").endOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage),{lowerInclusive:!0,reverse:!0,limit:1,shouldDecrypt:!1}).then(function(a){return d("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((a=a[0])==null?void 0:a.messageRangeIndex)})}function e(a){return d("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],d("WAWebDBMessageStoreUtils").beginningOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),d("WAWebDBMessageStoreUtils").endOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!0,limit:1,shouldDecrypt:!1}).then(function(a){return d("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((a=a[0])==null?void 0:a.messageRangeIndex)})}function f(a){return d("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],d("WAWebDBMessageStoreUtils").beginningOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),d("WAWebDBMessageStoreUtils").endOfMessageRange(a,d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage),{lowerInclusive:!0,reverse:!1,limit:1,shouldDecrypt:!1}).then(function(a){return d("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex((a=a[0])==null?void 0:a.messageRangeIndex)})}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f,g,h=d("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],(f=d("WAWebDBMessageStoreUtils")).beginningOfMessageRange(a,(g=d("WAWebDBMessageUtils")).MessagePropertyType.Outgoing,e),f.endOfMessageRange(a,g.MessagePropertyType.Outgoing),{reverse:!0,shouldDecrypt:!1});e=d("WAWebSchemaMessage").getMessageTable().anyOf(["messageRangeIndex"],[f.beginningOfMessageRange(a,g.MessagePropertyType.IncomingChatMessage,e),f.beginningOfMessageRange(a,g.MessagePropertyType.Outgoing,e),f.beginningOfMessageRange(a,g.MessagePropertyType.Outgoing)],{reverse:!0,shouldDecrypt:!1});f=(yield (k||(k=b("Promise"))).all([h,e]).then(function(a){var b=a[0];a=a[1];var e=function(a){if(a.ack===-1&&a.isSendFailure===!0)return!1;return a.type===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE?!1:!0};b=b.concat(a).filter(e);a=function(a){var b=c("WAWebMsgKey").fromString(a.id);a=(a=d("WAWebDBMessageStoreUtils").extractC2STimestampFromMessageRangeIndex(a.messageRangeIndex))!=null?a:void 0;b={key:d("WAWebE2EProtoUtils").msgKeyToProtobuf(b),timestamp:a};return b};return b.map(a)}));a=o(f,l);g=a.messages;h=a.newLastMessageTimestamp;return{messages:g,newLastMessageTimestamp:h}});return n.apply(this,arguments)}function o(a,b){var e=[],f=[];a.forEach(function(a){a.timestamp!=null?e.push(a):f.push(a)});if(e.length<b)return{messages:a};a=e.sort(p).slice(0,b);b=a[a.length-1];w(b.timestamp,"smallestTimestampMessage");return{messages:a.concat(f),newLastMessageTimestamp:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(b.timestamp))}}function p(a,b){a=[a,b].map(function(a){return d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(a.timestamp))});b=a[0];a=a[1];return a-b}function q(a,b,c,d){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebSchemaMessage").getMessageTable().between(["messageRangeIndex"],d("WAWebDBMessageStoreUtils").beginningOfMessageRange(a,c),d("WAWebDBMessageStoreUtils").beginningOfMessageRange(a,c,d("WALongInt").numberOrThrowIfTooLarge(b)),{lowerInclusive:!0,upperInclusive:!0,shouldDecrypt:!1}));c===d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage&&(a=a.filter(function(a){return!d("WAWebDBMessageStoreUtils").isInitialEncryptionMessage(a)}));if((e==null?void 0:e.forceDeleteAllMessagesExceptInitialEncryption)===!0)return a.map(function(a){return a.id});c===d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage&&(e==null?void 0:e.skipRecentSystemMessages)!==!1&&(a=a.filter(function(a){return!(d("WAWebDBMessageStoreUtils").isSecuritySensitiveMessage(a)&&a.t>d("WATimeUtils").unixTime()-d("WATimeUtils").DAY_SECONDS)}));(e==null?void 0:e.skipStarred)!==!1&&(a=a.filter(function(a){return a.isStarred===void 0}));if(c===d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage){var f;for(b=a.length-1;b>=0;b--)if(d("WAWebDBMessageStoreUtils").isBizBotDisclosureMessage(a[b])){f=a[b].id;break}f!=null&&(a=a.filter(function(a){return a.id!==f}))}return a.map(function(a){return a.id})});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=b.map(function(a){return d("WAWebE2EProtoUtils").protobufToMsgKey(c("WANullthrows")(a.key)).toString()});var f=[];a.isGroup()&&b.forEach(function(a){a=c("WAWebMsgKey").fromString(a);if(a.fromMe){a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a);a&&f.push(a.toString())}});a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(b.concat(f)));var g=[];a.forEach(function(a){a!=null&&((e==null?void 0:e.skipStarred)!==!1&&a.isStarred!=null||g.push(a.id))});return g});return t.apply(this,arguments)}function u(a,c,e){var f=c.lastMessageTimestamp,g=c.lastSystemMessageTimestamp,h=c.messages;return d("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){c=c[0];var i=[],j=[];f!=null&&(j.push(q(a,f,d("WAWebDBMessageUtils").MessagePropertyType.IncomingChatMessage,e)),j.push(q(a,f,d("WAWebDBMessageUtils").MessagePropertyType.Outgoing,e)));var l=g!=null?g:f;l!=null&&j.push(q(a,l,d("WAWebDBMessageUtils").MessagePropertyType.SystemMessage,e));j.push(s(a,h,e));l=(yield (k||(k=b("Promise"))).all(j));i=(j=i).concat.apply(j,l);var m=e==null?void 0:e.skipMessages;m&&(i=i.filter(function(a){return!m.has(a)}));j=[c.bulkRemove(i)];d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&j.push(d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeys(i));yield k.all(j);return i});return function(a){return c.apply(this,arguments)}}())}function v(a){var b=a.messages,c={messages:b,lastMessageTimestamp:a.lastMessageTimestamp};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: additionalMessages length: ",""])),b.length);if(b.length>l){b=o(b,l);var e=b.messages;b=b.newLastMessageTimestamp;b!=null&&(c.lastMessageTimestamp=b,w(c.lastMessageTimestamp,"resultantRange"));c.messages=e}d("WALongInt").numberOrThrowIfTooLarge((b=a.lastSystemMessageTimestamp)!=null?b:0)>d("WALongInt").numberOrThrowIfTooLarge((e=c.lastMessageTimestamp)!=null?e:0)&&(c.lastSystemMessageTimestamp=a.lastSystemMessageTimestamp);return c}function w(a,b){try{d("WALongInt").numberOrThrowIfTooLarge(a!=null?a:0)/d("WATimeUtils").unixTime()>10&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: large timestamp: "," returned a large timestamp: ",""])),b,a).sendLogs("syncd: "+b+" returned a large timestamp")}catch(b){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: error reporting logMaybeMillisecondTimestamp for ",": ",""])),a,b)}}var x={limitAdditionalMessages:o};g.getLastMessageTimestamp=a;g.getLastSystemMessageTimestamp=e;g.getFirstSystemMessageTimestamp=f;g.getAdditionalMessages=m;g.timestampComparison=p;g.deleteMessagesInMessageRange=u;g.fixMessageRange=v;g.logMaybeMillisecondTimestamp=w;g._test=x}),98);
__d("WAWebReparseRichResponseMsgs",["Promise","WAWebBackendApi","WAWebBotGating","WAWebCmd","WAWebDBMessageSerialization","WAWebMessageProcessDBPipeline","WAWebRichResponse.flow","WAWebRichResponseParseUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBotGating").isRichStructuredResponseReceiverEnabled())return;a=a.map(function(a){a=d("WAWebDBMessageSerialization").messageFromDbRow(a);var b=a.richResponse;if(b==null||b.parseState===d("WAWebRichResponse.flow").RichResponseParseState.Parsed)return null;b=d("WAWebRichResponseParseUtils").parseRichResponse(b);return b.parseState===d("WAWebRichResponse.flow").RichResponseParseState.Unparsed?null:babelHelpers["extends"]({},a,{richResponse:b})}).filter(Boolean);if(a.length===0)return;yield d("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(a,!0);d("WAWebCmd").Cmd.isMainStreamReadyMd&&(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:a.id.remote,msg:a})});return function(b){return a.apply(this,arguments)}}())))});return i.apply(this,arguments)}g.reparseRichResponseMsgs=a}),98);
__d("WAWebDBMessageStoreUtils",["WALogger","WAWebABProps","WAWebAck","WAWebAddonGatingUtils","WAWebApiMessageInfoStore","WAWebBotGating","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebFutureproofReparseMsgsAction","WAWebGroupMetadataCollection","WAWebGroupUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPerformanceUtils","WAWebReparseRichResponseMsgs","WAWebRichResponse.flow","WAWebSchemaMessage","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["limit"],i,j,k,l,m,n,o,p,q=10,r=1e9;function s(a){a=a.toString(16);return(a.length-1).toString(16)+a}function a(a){if(a==null||a.length<3)return null;a=a.split("_")[2];return a?d("WAWebDBMessageUtils").undoOrderPreservingHex(a):null}function e(a,b,c){c=c!=null?s(c):"";return a.toString()+"_"+b+"_"+c}function f(a,b){return a.toString()+"_"+b+"_g"}function t(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],a,b,c));b=a.filter(function(a){return C(a)});yield D(b);return b});return u.apply(this,arguments)}function v(){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["internalId"],[d("WAWebDBMessageUtils").InternalIdPrefix.GroupStatus]));return a});return w.apply(this,arguments)}function x(a){if(!d("WAWebGroupUtils").INVALID_CAG_NON_ADMIN_SYSTEM_MSG_SUBTYPES.has(a.subtype))return!1;if(!c("WAWebWid").isGroup(a.from))return!1;a=c("WAWebGroupMetadataCollection").get(a.from);if(a==null||!a.isCag)return!1;a=a.participants.iAmAdmin();return!a}function y(a,b,c,d,e){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){f===void 0&&(f=[]);c.limit;c=babelHelpers.objectWithoutPropertiesLoose(c,h);var g=d("WAWebABProps").getABPropConfigValue("web_init_chat_max_unread_message_count"),i=[],j=[],k=0,p=0,q=function(a){p++;if(e!=null&&k===e)return!0;if(!C(a,f))return!1;d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a.viewMode)&&k++;k>g&&d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: visibleMsgsCount exceeds the threshold"])));return!1},r=self.performance.now();a=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],a,b,c,q));d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: took ",", visit ",", visiable ",""])),d("WAWebPerformanceUtils").getElapsedTimeMs(r),p,k);b=a.filter(function(a){if(A(a)){var b=d("WAWebDBMessageSerialization").messageFromDbRow(a),c=d("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(b);a.futureproofReparsed!==!0&&(!c||c!=null&&c.canRenderInUi(b)&&!f.includes(a.id.toString()))&&i.push(a)}else B(a)&&d("WAWebBotGating").isRichStructuredResponseReceiverEnabled()&&j.push(a);if(!C(a,f))return!1;return x(a)?!1:!0});yield D(b);i.length&&(d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: starting process "," futureproofedMessages"])),i.length),void d("WAWebFutureproofReparseMsgsAction").processFutureproof(i));j.length&&(d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["queryChatVisibleMessageHelper: starting process "," unparsedRichResponseMessages"])),j.length),void d("WAWebReparseRichResponseMsgs").reparseRichResponseMsgs(j));return b});return z.apply(this,arguments)}function A(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN}function B(a){return a.type===d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE&&((a=a.richResponse)==null?void 0:a.parseState)!==d("WAWebRichResponse.flow").RichResponseParseState.Parsed}function C(a,b){b===void 0&&(b=[]);var c=d("WAWebDBMessageSerialization").messageFromDbRow(a),e=H(a),f=d("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(c);if(e)return!1;if(A(a)&&a.futureproofReparsed===!0)return!1;if(f&&f.canRenderInUi(c)&&!b.includes(a.id.toString()))return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.DEBUG)return!1;return!d("WAWebBotGating").isBizBot1pEnabled()&&a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_bot_1p_disclosure"?!1:!0}function D(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=F(a);if(a.length===0)return;var b=(yield d("WAWebApiMessageInfoStore").getHighestMsgAcks(a.map(function(a){return c("WAWebMsgKey").from(a.id)}))),e=[];a.forEach(function(a){var c=a.ack,f=a.id,g=b.get(f);if(g==null)return;g>c&&(e.push({id:f,ack:g}),a.ack=g);e.length>0&&(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateMsgAck: storing ack updates ",""])),JSON.stringify(e)).tags("message-store"),void d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(e))})});return E.apply(this,arguments)}function F(a){return a.filter(function(a){if(!d("WAWebMsgGetters").getIsUnreadType(a))return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN||a.ack<=d("WAWebAck").ACK.CLOCK)return!1;var b=c("WAWebMsgKey").fromString(a.id);if(!b.fromMe)return!1;if(b.remote.isGroup()&&(a.rowId!=null&&a.rowId<r||a.count==null)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getMsgMayNeedAckUpdate: skip update for history group message ",""])),a.id).tags("message-store");return!1}if(d("WAWebMsgGetters").getIsAckPlayable(a)){if(a.ack===d("WAWebAck").ACK.PLAYED)return!1}else if(a.ack===d("WAWebAck").ACK.READ)return!1;return!0})}function G(a,b){var c,e=self.performance.now(),f=d("WAWebABProps").getABPropConfigValue("web_init_chat_max_unread_message_count"),g,h=a.unreadCount,i=(c=a.unreadDividerOffset)!=null?c:0,l=void 0,m=void 0,n=void 0,o=0,p=[],r=0;c=function(c){if(x(c))return!1;o++;if(c.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL)return!1;var e=d("WAWebDBMessageSerialization").messageFromDbRow(c),k=H(c);if(k)return!1;if(A(c)){var s=d("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(e);if(c.futureproofReparsed===!0)return!1;if(!b)p.push(c);else if(s!=null&&s.canRenderInUi(e)){if(f!==0&&r>=f){n==null&&(n=c.id);m||(d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage] getKeyMsgsFromChatHistory: Exceeded limit "," to find a non futureproof reaction message"])),f),m=c);return!0}r++;return!1}}n==null&&(n=c.id);m||(m=c);!l&&!k&&c.botPluginReferenceIndex==null&&d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST,c.viewMode)&&![d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION,d("WAWebMsgType").MSG_TYPE.PROTOCOL,d("WAWebMsgType").MSG_TYPE.DEBUG].includes(c.type)&&(l=c);if(!b&&(l!=null||o>q))return!0;if(h===0&&i>0)if(c.type===d("WAWebMsgType").MSG_TYPE.REVOKED){i-=1;if(i===0){g=c.id.toString();return!0}}else return!0;if((h===0&&i===0||f!==0&&a.unreadCount>=f)&&l)return!0;if(h>0&&d("WAWebMsgGetters").getIsUnreadType(c)){h-=1;if(h===0){g=c.id.toString();if(i===0)return!0}}return!1};return d("WAWebSchemaMessage").getMessageTable().between(["internalId"],a.id+"_/",a.id+"_g",{reverse:!0},c).then(function(){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage] getKeyMsgsFromChatHistory: ",", chatId: ",", isActiveChat: ",", count: ",", chatUnread: ",", unreadMsgCounter: ",""])),d("WAWebPerformanceUtils").getElapsedTimeMs(e),a.id,b,o,a.unreadCount,h);p.length&&d("WAWebFutureproofReparseMsgsAction").processFutureproof(p);return{anchor:g,previewMsg:l||m,lastReceivedKey:n}})}function H(a){if(a.type===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)return!0;var b=a.futureproofType;return b!=null?d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(b):d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(a.type)}function I(a){var b=new Map([[d("WAWebMsgType").MSG_TYPE.GP2,["remove","add","ephemeral","invite","leave"]],[d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION,["encrypt","encrypt_now","e2e_identity_unavailable","identity","device","chat_psa"]],[d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,["change_number","masked_thread_created","cag_masked_thread_created","verified_initial_unknown","verified_initial_low","verified_initial_high","verified_transition_any_to_none","verified_transition_any_to_high","verified_transition_high_to_low","verified_transition_high_to_unknown","verified_transition_unknown_to_low","verified_transition_low_to_unknown","verified_transition_none_to_low","verified_transition_none_to_unknown","payment_transaction_status_update_failed","payment_transaction_status_update_refunded","payment_transaction_status_update_refund_failed","payment_transaction_status_receiver_pending_setup","payment_transaction_status_receiver_success_after_hiccup","payment_transaction_request_cancelled","payment_action_account_setup_reminder","payment_action_send_payment_reminder","payment_action_send_payment_invitation","payment_action_request_declined","payment_action_request_expired","biz_bot_1p_disclosure","biz_bot_3p_disclosure","bot_init"]]]);return((b=b.get(a.type))==null?void 0:b.includes(a.subtype))||!1}function J(a,b){return d("WAWebSchemaMessage").getMessageTable().between(["internalId"],a+"_/",a+"_g",{reverse:!0},b)}function K(a){return a.type===d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&a.subtype==="encrypt"||a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_privacy_mode_init_fb"||a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_me_account_type_is_hosted"||a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_me_account_type_is_hosted_transition"||a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_account_type_is_hosted"||a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="biz_account_type_changed_to_hosted"}function L(a){return a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&(a.subtype==="biz_bot_1p_disclosure"||a.subtype==="biz_bot_3p_disclosure")}g.extractC2STimestampFromMessageRangeIndex=a;g.beginningOfMessageRange=e;g.endOfMessageRange=f;g.queryChatMessageHelper=t;g.queryGroupStatusMsgsHelper=v;g.queryChatVisibleMessageHelper=y;g.shouldRenderInUI=C;g.getKeyMsgsFromChatHistory=G;g.isSecuritySensitiveMessage=I;g.getMessagesBefore=J;g.isInitialEncryptionMessage=K;g.isBizBotDisclosureMessage=L}),98);
__d("WAWebGroupUnreadMessageType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NEW_MESSAGE","PERSISTANCE_LOAD","HISTORYC_SYNC_CHUNK"]);f.UnreadMessageType=a}),66);
__d("WAWebUnreadMentionModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="unreadMention";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebDBProcessInitialHistorySyncMessage",["Promise","WALogger","WAPromiseReduce","WATimeUtils","WAWeb-dexie","WAWebApiChat","WAWebApiGroupInviteV4Store","WAWebChatCollection","WAWebDBEncryptMultipleMsgs","WAWebDBReportingTokenUtils","WAWebDBStoreMessage","WAWebDbEncryptionKey","WAWebFtsClient","WAWebGroupUnreadMessageType","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebNoop","WAWebSchemaFtsIndexingQueue","WAWebSchemaMessage","WAWebSchemaMessageAssociation","WAWebUnreadMentionModel","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=1e9;function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();var e=0;c("lodash").forOwn(a,function(a){a=a.msgs;return e+=a.length});var f=new Map(),g=new Map();d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start storing initial sync messages."])));var q=(yield d("WAPromiseReduce").promiseReduce(Object.keys(a),function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){var e=b.nextRowId,g=p-a[c].msgs.length,h=(yield r(a[c].chatInfo.unreadCount||0,a[c].msgs)),k=h.pendingUnreadIds;h=h.unreadMentions;h.length&&f.set(c,h);h=[];for(var l=0;l<a[c].msgs.length;l++){var m=a[c].msgs[l];try{var n=(yield d("WAWebDBEncryptMultipleMsgs").processAndEncryptSingleMsgRow(m));e++;g++;m.isMdHistoryMsg=!0;n=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:n[0],chatId:d("WAWebWidFactory").createWid(c).toString(),hasLink:d("WAWebLinkify").hasHttpLink(m),rowId:e,inChatMsgId:g,pendingReadReceipt:k.has(String(m.id))});h.push(n)}catch(a){if(a instanceof d("WAWebDBEncryptMultipleMsgs").DroppingMsgRowDueToLogout)throw a;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["storeInitialSyncMessages failed for msg: "," from ",""])),(n=m.id)==null?void 0:n.id,(n=m.id)==null?void 0:n.remote).tags("message-store-optimized");d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["storeInitialSyncMessages failed with error: ",", message: ",", stack: ",""])),a.name,a.message,a.stack).tags("message-store-optimized").devConsole(a)}}return{nextRowId:e,messages:b.messages.concat(h)}});return function(a,b){return c.apply(this,arguments)}}(),{nextRowId:p-e,messages:[]})),s=[];q.messages.forEach(function(a){a.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(a.id.toString(),{id:a.id.toString(),from:a.from.toString(),to:a.to.toString(),groupId:a.inviteGrp,expiration:parseInt(a.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(a.inviteCodeExp,10)}),a.associationType!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&s.push({msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),associationType:a.associationType,msgKeyInternalId:a.internalId})});var t=[d("WAWebSchemaMessage").getMessageTable().bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(q.messages)];s.length&&t.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreate(s));void d("WAWebDBReportingTokenUtils").handleHistorySyncedReportingInfo(q.messages);f.size&&(f.forEach(function(a,b){var e,f,h=d("WAWebChatCollection").ChatCollection.get(d("WAWebWidFactory").createWid(b));a=a.map(function(a){var b=a.id;a=a.timestamp;return new(c("WAWebUnreadMentionModel"))({id:b,timestamp:a})});h=h==null||(e=h.groupMetadata)==null?void 0:e.unreadMentionMetadata;f=(f=h==null?void 0:h.pendingUnreadMentionCount)!=null?f:0;h!=null&&h.pendingUnreadMentionCount&&(h.pendingUnreadMentionCount=Math.max(f-a.length,0),g.set(b,h.pendingUnreadMentionCount));h==null||h.addUnreadMentions(a,d("WAWebGroupUnreadMessageType").UnreadMessageType.HISTORYC_SYNC_CHUNK)}),void d("WAWebApiChat").addUnreadMentionChat(f,g));return(o||(o=b("Promise"))).all(t)["catch"](function(a){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error storing initial sync messages with error "," with optimization"])),a);if(a instanceof c("WAWeb-dexie").BulkError||a instanceof c("WAWeb-dexie").ConstraintError){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Retrying initial sync bulk add on error"]))).tags("history-sync-initial-sync-optimized");return d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(q.messages)}throw a}).then(function(){c("WAWeb-dexie").ignoreTransaction(function(){d("WAWebSchemaFtsIndexingQueue").getFtsIndexingQueueTable().bulkCreateOrReplace(q.messages.map(function(a){return{id:String(a.rowId)}})).then(function(){d("WAWebFtsClient").ftsClient.index()["catch"](c("WAWebNoop"))})})})["catch"](function(a){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error storing initial sync messages with error "," after retry"])),a).devConsole(a);var b=q.messages.map(function(a){return a.id.toString()});d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] additional information: messages length: ",", ids: ",""])),b.length,b).devConsole(a)})});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a;var c=new Set(),e=[];for(var f=b.length-1;f>=0;f--){if(a<=0)break;var g=b[f],h=d("WAWebDBStoreMessage").isPendingUnreadReceipt(g.id,g);if(h){a--;c.add(String(g.id));if(d("WAWebMsgGetters").getIsImportantMessage(g)){h={id:String(g.id),timestamp:g.t};e.push(h)}}}return{pendingUnreadIds:c,unreadMentions:e}});return s.apply(this,arguments)}g.storeInitialSyncMessages=a}),98);
__d("WAWebDBQueryAndRemoveMessageHistory",["Promise","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageRange","WAWebDBMessageUtils","WAWebFtsClient","WAWebMessageAssociationGatingUtils","WAWebNoop","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebDBMessageUtils").beginningOfChat(a);a=d("WAWebDBMessageUtils").endOfChat(a);var c=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{lowerInclusive:!1,upperInclusive:!1,limit:1}));if(c.length===0)return null;c=c[0].rowId;b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{lowerInclusive:!1,upperInclusive:!1,limit:1,reverse:!0}));if(b.length===0)return null;a=b[0].rowId;b=b[0].t;return c==null||a==null?null:{startRowId:c,endRowId:a,tsOfLastMessage:b}});return i.apply(this,arguments)}function e(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield d("WAWebDBMessageRange").deleteMessagesInMessageRange(a,b,e));d("WAWebFtsClient").ftsClient.purge(a)["catch"](c("WAWebNoop"));return a});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebDBMessageUtils").beginningOfChat(a);a=d("WAWebDBMessageUtils").endOfChat(a);c=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],c,a,{lowerInclusive:!1,upperInclusive:!1,returnKeyType:"primary_key"}));a=[d("WAWebSchemaMessage").getMessageTable().bulkRemove(c)];d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&a.push(d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeys(c));yield (h||(h=b("Promise"))).all(a);return c});return k.apply(this,arguments)}g.getBoundsForChat=a;g.queryAndRemoveMessagesInMessageRange=e;g.queryAndRemoveMessageHistory=f}),98);
__d("WAWebGroupsPrivacyTokenUtils",["WAWebSchemaChat","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.tcToken;a=a.tcTokenTimestamp;return b==null||a==null||d("WAWebTrustedContactsUtils").isTokenExpired(a,d("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:{anyElementValue:new Uint8Array(b)}}function i(a,b){var c=new Map();b.map(function(b){var d=a.find(function(a){return(a==null?void 0:a.id)===b.toString()});d!=null&&c.set(b,h(d))});return c}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a.map(function(a){return a.toString()}),!0));return i(b,a)});return j.apply(this,arguments)}g.getPermissionTokenMap=i;g.getPermissionTokenMapForChatIds=a}),98);
__d("WAWebMexFetchTextStatusListJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2TextStatus",kind:"LinkedField",name:"xwa2_text_status_list",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"jid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_update_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ephemeral_duration_sec",storageKey:null},{alias:null,args:null,concreteType:"XWA2TextStatusEmoji",kind:"LinkedField",name:"emoji",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchTextStatusListJobQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchTextStatusListJobQuery",selections:b},params:{id:"24072923595647473",metadata:{},name:"WAWebMexFetchTextStatusListJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchTextStatusListJob",["WALogger","WAWebGroupsPrivacyTokenUtils","WAWebMexClient","WAWebMexFetchTextStatusListJobQuery.graphql","WAWebPrivacyGatingUtils","WAWebTrustedContactsUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!c("WAWebWid").isWid(a)||!a.isUser()){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][TEXT-STATUS] this method should only take user wid, instead it received: ",""])),a.toLogString()).sendLogs("mex-text-status-list-invalid-wid");throw c("err")("[MEX][TEXT-STATUS] this method should only take user wid, instead it received: "+a.toLogString())}e={jid:a.toJid(),last_update_time:e==null?void 0:e.toString()};if(d("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInMexFetchEnabled()){var f=(yield d("WAWebGroupsPrivacyTokenUtils").getPermissionTokenMapForChatIds([a]));a=(f=f.get(a))==null?void 0:f.anyElementValue;a!=null&&(e.privacy_token={tctoken:d("WAWebTrustedContactsUtils").encodeTcTokenForMex(a.buffer)})}f=h!==void 0?h:h=b("WAWebMexFetchTextStatusListJobQuery.graphql");a={input:[e]};e=(yield d("WAWebMexClient").fetchQuery(f,a));f=e.xwa2_text_status_list;a=f[0];f=a==null?void 0:a.text;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[MEX][TEXT-STATUS] fetched text status for ",""])),a.jid).tags("GQL","MEX").devConsole(f,e);f=l(a);return{id:f.id,text:f.textStatusString,emoji:f.textStatusEmoji,lastUpdateTime:f.textStatusLastUpdateTime,ephemeralDurationSeconds:f.textStatusEphemeralDuration}});return k.apply(this,arguments)}function l(a){var b;return{id:d("WAWebWidFactory").createWid(a.jid),textStatusString:a.text,textStatusEmoji:(b=a.emoji)==null?void 0:b.content,textStatusEphemeralDuration:a.ephemeral_duration_sec,textStatusLastUpdateTime:Number(a.last_update_time)}}g.mexGetTextStatusList=a;g.parseTextStatusServerResponse=l}),98);
__d("WAWebContactTextStatusBridge",["WALogger","WAWebMexFetchTextStatusListJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{b=(yield d("WAWebMexFetchTextStatusListJob").mexGetTextStatusList(a,b));return{id:b.id,text:b.text,emoji:b.emoji,lastUpdateTime:b.lastUpdateTime,ephemeralDurationSeconds:b.ephemeralDurationSeconds}}catch(b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getTextStatus: failed "," : ",""])),b.statusCode,b.message);return{id:a,error:b,text:""}}});return i.apply(this,arguments)}function c(a,b,c,e){return d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.setTextStatus(a,b,c,e))}g.getTextStatus=a;g.setTextStatus=c}),98);
__d("WAWebGetDisappearingModeJob",["Promise","WALogger","WAWebUsync","WAWebUsyncUser","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!c("WAWebWid").isWid(a)||!a.isUser()){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMode: this method should only take user wid, instead it received: ",""])),a);return(j||(j=b("Promise"))).resolve({id:a})}var e=new(d("WAWebUsync").USyncQuery)().withContext("interactive").withMode("query").withDisappearingModeProtocol().withUser(new(d("WAWebUsyncUser").USyncUser)().withId(a));e=(yield e.execute());if(e.error.all||e.error.status){var f=e.error.all||e.error.status;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMode: failed "," : ",""])),f.errorCode,f.errorText);return{id:a,error:f}}f=e.list;if(f.length===0||f[0].disappearing_mode==null)return(j||(j=b("Promise"))).reject(c("err")("no disappearing_mode data returned for user"));e=f[0].disappearing_mode;f=e.duration;e=e.t;return{id:a,disappearingModeDuration:f,disappearingModeSettingTimestamp:e}});return k.apply(this,arguments)}g.getDisappearingMode=a}),98);
__d("WAWebTextStatusGatingUtils",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("evolve_about_m1_receiver_enabled")}function a(){return h()&&d("WAWebABProps").getABPropConfigValue("evolve_about_m1_receiver_for_new_surfaces_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("web_evolve_about_send_enabled")&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("text_status_creation_support")}g.receiveTextStatusEnabled=h;g.receiveTextStatusForNewSurfacesEnabled=a;g.sendTextStatusEnabled=b}),98);
__d("WAWebDBUpdateContactTable",["WAJids","WAWebLidAwareContactsDB"],(function(a,b,c,d,e,f,g){function a(a,b){a=a.isLid()?d("WAJids").toLidUserJid(a.user):d("WAJids").toPhoneUserJid(a.user);return c("WAWebLidAwareContactsDB").merge(a,b)}g.updateContactTable=a}),98);
__d("WAWebUpdateDisappearingModeForContact",["WALogger","WAWebApiContact","WAWebBackendApi","WAWebDBUpdateContactTable","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WAWebWidFactory").createUserWidOrThrow(a.user,a.server);var e=(yield d("WAWebApiContact").getContactRecord(a));if(e){e=e.disappearingModeSettingTimestamp;if(e==null&&c!==0||e!=null&&e<c){e={disappearingModeDuration:b,disappearingModeSettingTimestamp:c};yield d("WAWebDBUpdateContactTable").updateContactTable(a,e);d("WAWebBackendApi").frontendFireAndForget("updateDisappearingMode",babelHelpers["extends"]({},e,{contactId:a}));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateDisappearingMode: Contact="," updated, new duration="," t=","."])),a.toLogString(),b,c).tags("DM","DDM")}}});return i.apply(this,arguments)}g.updateDisappearingModeForContact=a}),98);
__d("WAWebTextStatusUtils",["WATimeUtils","WAWebTextStatusGatingUtils","fbs"],(function(a,b,c,d,e,f,g){var h=-1;f=5;var i=0,j=null,k=null,l=null,m=-1;function n(a,b,c,e,f){f=f===m||e!=null&&d("WATimeUtils").unixTime()<e;e=Boolean(a)||Boolean(b);a=c!==i;return a&&f&&e}function a(a,b,c,e,f){if(!d("WAWebTextStatusGatingUtils").receiveTextStatusEnabled())return!1;if(c===h)return!1;return!n(a,b,c,e,f)?!1:!0}var o="",p=" ";function b(a){return a.status===void 0}function e(a){var b=c("fbs")._(/*BTDS*/"Hey there! I am using WhatsApp.").toString();return a.status!==o&&a.status!==void 0&&a.status!==p&&a.status!==b}g.TEXT_STATUS_NOT_FETCHED=h;g.SUGGESTIONS_MAX_COUNT=f;g.CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL=i;g.CLEAR_TEXT_STATUS_STRING_VAL=j;g.CLEAR_TEXT_STATUS_EMOJI_VAL=k;g.CLEAR_TEXT_STATUS_EPHEMERAL_DURATION_VAL=l;g.TEXT_STATUS_DURATION_INFINITE=m;g.hasTextStatusSet=n;g.shouldDisplayTextStatus=a;g.EMPTY_ABOUT=o;g.EMPTY_MIGRATED_ABOUT=p;g.isLegacyAboutNotFetched=b;g.hasCustomAboutSet=e}),226);
__d("WAWebUpdateTextStatusForContact",["WAWebApiContact","WAWebBackendApi","WAWebDBUpdateContactTable","WAWebTextStatusUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c,d,e){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){a=d("WAWebWidFactory").createUserWidOrThrow(a.user,a.server);var g=(yield d("WAWebApiContact").getContactRecord(a));if(g){g=g.textStatusLastUpdateTime;if(f==null||g!=null&&f!==d("WAWebTextStatusUtils").CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL&&f<g)return;var h;e!=null&&e>0&&f!==d("WAWebTextStatusUtils").CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL&&(h=Number(f)+Number(e));g={textStatusString:b,textStatusEmoji:c,textStatusEphemeralDuration:e,textStatusLastUpdateTime:f,textStatusExpiryTs:h};yield d("WAWebDBUpdateContactTable").updateContactTable(a,babelHelpers["extends"]({},g));d("WAWebBackendApi").frontendFireAndForget("updateTextStatus",babelHelpers["extends"]({},g,{contactId:a}))}});return h.apply(this,arguments)}g.updateTextStatusForContact=a}),98);
__d("WAWebHandleAccountSyncNotification",["Promise","WADeprecatedWapParser","WAJids","WALogger","WATimeUtils","WAWap","WAWebABProps","WAWebAccountSyncJob","WAWebAdvHandlerApi","WAWebApiPendingDeviceSync","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebCmd","WAWebCommsWapMd","WAWebContactTextStatusBridge","WAWebGetAboutQueryJob","WAWebGetDisappearingModeJob","WAWebJidToWid","WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebMexFetchTextStatusListJob","WAWebMexUsersGetAboutStatus","WAWebOfflineDeviceCache","WAWebOfflineHandler","WAWebPDFNTypes","WAWebQueryBlockListJob","WAWebSetUsernameJob","WAWebSignalCommonUtils","WAWebSignalStoreApi","WAWebTextStatusGatingUtils","WAWebUpdateDisappearingModeForContact","WAWebUpdateTextStatusForContact","WAWebUserDisclosureCollection","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUsernameGatingUtils","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=function(a){var b=a.maybeChild("key-index-list");b=b==null?null:{ts:b.attrTime("ts"),signedKeyIndexBytes:b.hasContent()?b.contentBytes():null,expectedTs:b.hasAttr("expected_ts")?b.attrTime("expected_ts"):void 0};var c=a.mapChildrenWithTag("device",function(b){var c=b.attrDeviceJid("jid");if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(c!=null&&c.endsWith("@hosted")||c!=null&&c.endsWith("@hosted.lid"))){c=(c=d("WAWebWidFactory").createHostedDeviceWidOrThrow(c))==null?void 0:c.device;if(c==null)throw a.createParseError("invalid hosted device jid");if(c!==d("WAWebBizCoexUtils").HOSTED_DEVICE_ID)throw a.createParseError("invalid hosted device jid");return{id:c,keyIndex:b.hasAttr("key-index")?b.attrInt("key-index"):null,isHosted:!0}}return{id:(c=d("WAWebWidFactory").createWid(b.attrDeviceJid("jid")).device)!=null?c:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:b.hasAttr("key-index")?b.attrInt("key-index"):null}});d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||(c=c.filter(function(a){return a.id===d("WAWebBizCoexUtils").HOSTED_DEVICE_ID?!1:!0}));return c.length===0?null:{deviceList:c,keyIndex:b}},o=new(c("WADeprecatedWapParser"))("incomingAccountSyncNotification",function(a){a.assertTag("notification");var b={stanzaId:a.attrString("id"),ts:a.attrTime("t"),from:d("WAWebJidToWid").deviceJidToDeviceWid(a.attrDeviceJid("from"))};if(a.hasChild("status")){var c=a.child("status");c=c.hasAttr("action")?c.attrString("action"):void 0;return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.STATUS,action:c},b)}else if(a.hasChild("text_status")){c=a.child("text_status");var e=c.hasAttr("action")?c.attrString("action"):void 0,f=c.hasAttr("text")?c.attrString("text"):void 0,g=c.hasChild("emoji")?c.child("emoji"):void 0;g=g!=null&&g.hasAttr("content")?g==null?void 0:g.attrString("content"):void 0;var h=c.hasAttr("ephemeral_duration_sec")?c.attrInt("ephemeral_duration_sec"):void 0;c=c.hasAttr("last_update_time")?c.attrString("last_update_time"):void 0;return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.TEXT_STATUS,action:e,text:f,emoji:g,ephemeralDurationSeconds:h,lastUpdateTime:c},b)}else if(a.hasChild("privacy"))return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.PRIVACY},b);else if(a.hasChild("devices"))return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.DEVICES,devices:n(a.child("devices"))},b);else if(a.hasChild("blocklist")){e=a.child("blocklist");var i=[];d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&e.forEachChildWithTag("item",function(a){var b=a.maybeAttrString("username");a=d("WAWebJidToWid").userJidToUserWid(a.attrUserJid("jid"));b!=null&&i.push({userId:a,username:b})});return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.BLOCKLIST,usernames:i},b)}else if(a.hasChild("picture"))return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.PICTURE},b);else if(a.hasChild("tos")){f=a.child("tos");var j=[];f.forEachChildWithTag("notice",function(a){var b=a.maybeAttrString("state")!=="false";a=a.attrString("id");j.push({id:a,state:b})});return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.TOS,notices:j},b)}else if(a.hasChild("disappearing_mode")){g=a.child("disappearing_mode");var k,l,m;g.hasAttr("action")?k=g.attrString("action"):(l=g.attrInt("duration"),m=g.attrInt("t"));return babelHelpers["extends"]({},b,{type:d("WAWebAccountSyncJob").AccountSyncType.DISAPPEARING_MODE,action:k,disappearingModeDuration:l,disappearingModeSettingTimestamp:m})}else if(a.hasChild("notice")){h=a.child("notice");return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.NOTICE,noticeId:h.attrString("id"),noticeStage:h.maybeAttrString("stage"),noticeVersion:h.maybeAttrString("version"),noticeTimestamp:h.attrInt("t")},b)}else if(a.hasChild("user")){c=a.child("user");e=c.maybeAttrString("state")==="AI available";return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.USER,isAiAvailable:e},b)}else if(a.hasChild("biz_opt_out_list")){f=a.child("biz_opt_out_list");g=f.mapChildren(function(a){return{action:a.attrString("action"),biz_jid:a.attrUserJid("biz_jid")}});h=f.maybeAttrString("dhash");c=f.maybeAttrString("prev_dhash");return babelHelpers["extends"]({type:d("WAWebAccountSyncJob").AccountSyncType.OPTOUTLIST,list:g,dhash:h,prevDhash:c},b)}throw a.createParseError("notification type not supported")});function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),c;if(d("WAWebABProps").getABPropConfigValue("mex_usync_about_status")){var e=(yield d("WAWebMexUsersGetAboutStatus").getMexUsersAboutStatus({wid:a,tcToken:null})),f=e.status;e=e.state;e==null&&(c=f)}else{e=(yield d("WAWebGetAboutQueryJob").getAbout({wid:a,tcToken:null}));if(e.error){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getStatus failed for ",": failed "," : ",""])),a,e.error.errorCode,e.error.errorText);return(m||(m=b("Promise"))).reject(e.error.errorText)}c=e.status}c!==""&&(yield d("WAWebBackendApi").frontendSendAndReceive("setMyStatus",{status:c}))});return q.apply(this,arguments)}function r(){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();a=(yield d("WAWebContactTextStatusBridge").getTextStatus(a));if(a.error)return(m||(m=b("Promise"))).reject(a.error.message);var c=a.id,e=a.text,f=a.emoji,g=a.ephemeralDurationSeconds;a=a.lastUpdateTime;e=d("WAWebMexFetchTextStatusListJob").parseTextStatusServerResponse({text:e,emoji:f!=null?{content:f}:null,ephemeral_duration_sec:g,last_update_time:a.toString(),jid:c.toJid()});return d("WAWebUpdateTextStatusForContact").updateTextStatusForContact(e.id,e.textStatusString,e.textStatusEmoji,e.textStatusEphemeralDuration,e.textStatusLastUpdateTime)});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.wid;a=a.devices;var c=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow(),e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f={wid:b,devices:a};if(!b.isSameAccountAndAddressingMode(e)){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wid-is-not-self"]))).sendLogs("wid-is-not-self");return[f]}b=(yield d("WAWebSignalStoreApi").waSignalStore.bulkGetIdentity([d("WAWebSignalCommonUtils").createSignalAddress(e),d("WAWebSignalCommonUtils").createSignalAddress(c)]));e=b[0];b=b[1];b==null&&e!=null&&(yield d("WAWebSignalStoreApi").waSignalStore.putIdentity(d("WAWebSignalCommonUtils").createSignalAddress(c).toString(),e));return[f,{wid:c,devices:a}]});return u.apply(this,arguments)}function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=o.parse(a);if(c.error){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),a.toString());d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),c.error.toString());return(m||(m=b("Promise"))).reject(c.error)}a=c.success;c=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a.stanzaId),to:d("WAWebCommsWapMd").JID(a.from),"class":"notification",type:"account_sync"});switch(a.type){case d("WAWebAccountSyncJob").AccountSyncType.STATUS:yield p();break;case d("WAWebAccountSyncJob").AccountSyncType.TEXT_STATUS:if(!d("WAWebTextStatusGatingUtils").receiveTextStatusEnabled())break;if(a.action==="modify")yield r();else{var e=a.text,f=a.emoji,g=a.ephemeralDurationSeconds,h=a.lastUpdateTime,i=d("WAWebWidFactory").asUserWidOrThrow(a.from);yield d("WAWebUpdateTextStatusForContact").updateTextStatusForContact(i,e,f,g,h!=null?Number(h):void 0)}break;case d("WAWebAccountSyncJob").AccountSyncType.DEVICES:if(!d("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()){d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(a.from.toString(),c);return"NO_ACK"}else if(d("WAWebOfflineHandler").OfflineMessageHandler.isResumeOnSocketDisconnectInProgress()){yield d("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync([a.from.toString()]);return c}i=a.devices;if(i){e=(yield t({wid:d("WAWebWidFactory").asUserWidOrThrow(a.from),devices:i}));yield d("WAWebAdvHandlerApi").handleADVDeviceSyncResult(e)}else yield d("WAWebAccountSyncJob").getDevices("notification");break;case d("WAWebAccountSyncJob").AccountSyncType.PICTURE:yield d("WAWebAccountSyncJob").getAndUpdateProfilePicture();break;case d("WAWebAccountSyncJob").AccountSyncType.PRIVACY:d("WAWebCmd").Cmd.onAccountSyncForPrivacy(yield d("WAWebAccountSyncJob").updatePrivacySettings());break;case d("WAWebAccountSyncJob").AccountSyncType.BLOCKLIST:d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&a.usernames!=null&&(yield d("WAWebSetUsernameJob").setUsernamesJob(a.usernames));void d("WAWebQueryBlockListJob").fetchAndUpdateBlocklist();break;case d("WAWebAccountSyncJob").AccountSyncType.OPTOUTLIST:f=d("WAWebUserPrefsMultiDevice").getOptOutListHash();g=a.dhash;h=a.prevDhash;i=a.list;if(d("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutListServerSyncEnabled()&&f!==h){d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutList");break}else g!=null&&(i==null||i.forEach(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.action;a=a.biz_jid;b=b==="block";a=d("WAWebJidToWid").userJidToUserWid(a);yield d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("updateOptOutListModelInCollection",{targetWid:a,isBlocked:b})});return function(b){return a.apply(this,arguments)}}()),yield d("WAWebUserPrefsMultiDevice").setOptOutlistHash(g));break;case d("WAWebAccountSyncJob").AccountSyncType.TOS:a.notices&&d("WAWebAccountSyncJob").updateTosStateFromAccountSync(a.notices);break;case d("WAWebAccountSyncJob").AccountSyncType.DISAPPEARING_MODE:e=a.action;f=a.from;h=a.disappearingModeDuration;i=a.disappearingModeSettingTimestamp;if(e==="modify"){g=(yield d("WAWebGetDisappearingModeJob").getDisappearingMode(f));g.error==null&&g.disappearingModeDuration!=null&&g.disappearingModeSettingTimestamp!=null&&(h=g.disappearingModeDuration,i=g.disappearingModeSettingTimestamp)}h!=null&&i!=null&&(yield d("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(f,h,i));break;case d("WAWebAccountSyncJob").AccountSyncType.NOTICE:e=a.noticeId;g=a.noticeStage;f=a.noticeVersion;h=a.noticeTimestamp;if(e!=null&&e!==""&&g!=null&&f!=null&&h!=null){i=g===d("WAWebPDFNTypes").NOTICE_STAGES.PDFN_ACCEPTED;yield d("WAWebUserDisclosureCollection").UserDisclosureCollection.updateNoticeStage({id:e,accepted:i,policyVersion:f});d("WAWebAccountSyncJob").updateTosStateFromAccountSync([{id:e,state:i,timestamp:d("WATimeUtils").castToUnixTime(h)}])}break;case d("WAWebAccountSyncJob").AccountSyncType.USER:a.isAiAvailable===!0&&d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Receieved account sync notification for Ai Available"])));break}return c});return v.apply(this,arguments)}g.getAndUpdateStatus=p;g.getDeviceSyncInputs=t;g.handleAccountSyncNotification=a}),98);
__d("WAWebHandleBusinessNameChangeLidHelpers",["Promise","WAWebBizGatingUtils","WAWebHandleBusinessRemoval","WAWebLidMigrationUtils","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return a.map(function(a){var b=d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?d("WAWebLidMigrationUtils").getPnAndLidToUpdate(a.id):[a.id];return b.map(function(b){return babelHelpers["extends"]({},a,{id:b})})}).reduce(function(a,b){return a.concat(b)},[])}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebModelStorageUtils").getStorage().lock(["contact","verified-business-name"],function(c){c[0];var e=c[1];c=d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?d("WAWebLidMigrationUtils").getPnAndLidToUpdate(a):[a];return(h||(h=b("Promise"))).all([].concat(c.map(d("WAWebHandleBusinessRemoval").removeBusinessPropsFromContact),c.map(function(a){return d("WAWebHandleBusinessRemoval").removeVerifiedName(e,a)})))})});return i.apply(this,arguments)}g.getVerifiedNamesToUpdateLidAware=a;g.removeVerifiedNameFromTableLidAware=c}),98);
__d("WAWebHandleBusinessRemoval",["WAWebApiContact","WAWebBackendApi","WAWebContactCollection","WAWebHandleBusinessNameChangeLidHelpers","WAWebLidAwareContactsDB","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.toString();var b=(yield c("WAWebLidAwareContactsDB").get(a));if(b==null)return;b.isBusiness=!1;b.verifiedLevel=0;b.verifiedName="";return c("WAWebLidAwareContactsDB").merge(a,b)});return h.apply(this,arguments)}function e(a,b){return a.remove(b.isLid()?b.toString():b.user)}var i={isBusiness:!1};function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=d("WAWebContactCollection").ContactCollection.get(a);c=b?{isBusiness:b.isBusiness,privacyMode:b.privacyMode}:i;yield d("WAWebHandleBusinessNameChangeLidHelpers").removeVerifiedNameFromTableLidAware(a);b=d("WAWebContactCollection").ContactCollection.get(a);b!=null&&b.set({isBusiness:!1,verifiedLevel:null,verifiedName:null});d("WAWebBackendApi").frontendFireAndForget("generateAndUpdatePrivacySystemMessages",{wid:a,previousState:c,currentState:i})});return k.apply(this,arguments)}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.type!=="remove_hash")throw c("err")("Invalid notification type");var b=(yield d("WAWebApiContact").getContactRecordByHash(a.hash));if(b==null)return!1;b=d("WAWebWidFactory").createUserWidOrThrow(b.id);yield j(b,a.stanzaId,a.ts);return!0});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.type!=="remove_jid")throw c("err")("Invalid notification type");yield j(a.jid,a.stanzaId,a.ts)});return n.apply(this,arguments)}g.removeBusinessPropsFromContact=a;g.removeVerifiedName=e;g.handleBusinessRemoval=j;g.handleBusinessRemovalNotificationHash=f;g.handleBusinessRemovalNotificationContact=m}),98);
__d("WAWebHistorySyncDynamicThrottlingManager",["WAWebDynamicThrottlingManager"],(function(a,b,c,d,e,f,g){a=new(d("WAWebDynamicThrottlingManager").DynamicThrottlingManager)({targetTimeMs:150,maxDelayTimeMs:3e3,minBatchSize:1,maxBatchSize:500,defaultBatchSize:50});g.historySyncDynamicThrottlingManager=a}),98);
__d("WAWebHistorySyncProgress",["Promise","WALogger","WAWebBackendApi","WAWebCmd","WAWebProtobufsHistorySync.pb","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=2*60,r=3,s=null;function t(){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] clearing history sync paused timeout"]))),s!=null&&self.clearTimeout(s)}function u(){t(),d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] setting history sync paused timeout to ","s"])),q),s=self.setTimeout(function(){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] ","s have passed without chunk uploads from phone, setting paused state..."])),q),z(!0)},q*1e3)}var v=0;function a(a){v=a?0:v+1,v===0&&u(),z(v>=3)}function c(){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield (p||(p=b("Promise"))).all([x(),d("WAWebUserPrefsHistorySync").getHistorySyncStatus()])),c=a[0];a=a[1];a=(a==null?void 0:a.recentCompleted)!==!0;d("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{incomplete:a});c!=null&&d("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{progress:c})}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["updateProgressModel: error computing progress"])))}});return w.apply(this,arguments)}function x(){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsHistorySync").getChunkCountForEndOfRecentHistorySync());if(a===0){a=(yield d("WAWebUserPrefsHistorySync").getEstimatedChunkCountForEndOfRecentHistorySync());if(a===0)return}var b=(yield d("WAWebUserPrefsHistorySync").getLastHistorySyncedChunk());if(b!=null){b=b.split("_").map(function(a){return parseInt(a,10)});var c=b[0];b=b[1];if(c===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT){c=Math.floor(b/a*100);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] computeProgress: compute progress when the last processed history sync chunk is completed"])));return Math.min(100,c)}}return A(a)});return y.apply(this,arguments)}function z(a){d("WAWebBackendApi").frontendFireAndForget("setHistorySyncPaused",{paused:a})}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield d("WAWebUserPrefsHistorySync").getRecentSyncSingleChunkStatus()))==null?void 0:b[1];if(b==null||[d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.RECEIVED,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.NOTIFICATION_STORED,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING].includes(b))return null;d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync] computeProgress: compute progress when the first history sync chunk is downloaded"])));b=Math.floor(1/a/r*100);return Math.min(100,b)});return B.apply(this,arguments)}d("WAWebCmd").Cmd.on("on_critical_sync_done",function(){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] initial sync complete, starting paused timer"]))),u()});d("WAWebCmd").Cmd.on("on_recent_chat_history_synced",function(){d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync] sync complete, clearing paused timer "]))),t(),z(!1),d("WAWebBackendApi").frontendFireAndForget("setHistorySyncProgress",{progress:100,incomplete:!1})});g.handleChunkProgress=a;g.updateHistorySyncProgressModel=c}),98);
__d("WAWebHistorySyncWorkerCompatibleNotificationUtils",["WALogger","WAWebBackendApi","WAWebChatConstants","WAWebProtobufsHistorySync.pb","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!1);b=j(b);var e={id:a,endOfHistoryTransferType:b};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] update chat "," end of history transfer type to ",""])),a.toLogString(),b);c&&(e.t=0);yield d("WAWebSchemaChat").getChatTable().merge(a.toString(),{endOfHistoryTransferType:b});yield d("WAWebBackendApi").frontendSendAndReceive("chatCollectionAdd",{things:[e],options:{merge:!0,add:!1}})});return i.apply(this,arguments)}function j(a){switch(a){case d("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:return d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY;case d("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:return d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;case d("WAWebProtobufsHistorySync.pb").Conversation$EndOfHistoryTransferType.COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY:return d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY}}g.updateEndOfHistorySync=a}),98);
__d("WAWebMediaHost",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){var h=new Set(d("WAWebMmsMediaTypes").MEDIA_TYPE_VALUES),i=Object.freeze({PRIMARY:"primary",FALLBACK:"fallback"});a=function(){function a(b){this.hostname=b.hostname;this.ips=b.ips||[];this.type=b.type;this["class"]=b["class"];var c=j(b.rules),d=c.downloadBuckets,e=c.supportedDownloadTypes;c=c.supportedUploadTypes;this.downloadBuckets=d;this.$1=e;this.$2=c;this.fallback=b.fallback!=null?new a(babelHelpers["extends"]({},b,b.fallback,{type:"fallback",fallback:void 0})):null}var b=a.prototype;b.equals=function(a){return this.hostname===(a==null?void 0:a.hostname)};b.isFallback=function(){return this.type===i.FALLBACK};b.supportsDownloadMediaType=function(a){return this.$1.has(k(a))};b.supportsUploadMediaType=function(a){return this.$2.has(l(a))};b.setSelectedBucket=function(a){this.selectedBucket=a};return a}();function j(a){a=a||[];var b,c,d;for(a of a){if(a.download){b=b!=null?b:new Set();for(var e of a.download)b.add(e)}if(a.upload){c=c!=null?c:new Set();for(e of a.upload)c.add(e)}a.downloadBuckets&&(d=a.downloadBuckets.map(function(a){return parseInt(a,10)}))}return{supportedDownloadTypes:b!=null?b:h,supportedUploadTypes:c!=null?c:h,downloadBuckets:d}}function k(a){return a==="ptv"||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV?d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:a}function l(a){switch(a){case"ptv":return d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO;case"product-catalog-image":return d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT;default:return a}}g.HOST_TYPE=i;g.MediaHost=a}),98);
__d("WAWebMediaHostsErrors",["WACustomError"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("NoMediaHostsError"));g.NoMediaHostsError=a}),98);
__d("WAWebMediaHostsRouteSelection",["WABase64Modulo","WAWebABProps"],(function(a,b,c,d,e,f,g){var h={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};function a(a){var b=a.encFilehash,e=a.hosts,f=a.operation,g=a.type;a=a.maxBuckets;if(!e.length)return{selectedHost:null,fallbackHost:null};var j;if(f===h.DOWNLOAD){var k=d("WAWebABProps").getABPropConfigValue("mms_vcache_aggregation_enabled"),l;b==null?l=0:k&&a!=null&&(l=c("WABase64Modulo")(b,a)+100);k=i(e);b=l==null?null:k.get(l);a=k.get(0);b!=null&&b.supportsDownloadMediaType(g)?j=b:a!=null&&a.supportsDownloadMediaType(g)&&(j=a);(k=j)==null||k.setSelectedBucket(l)}b=e.find(function(a){return a.isFallback()});j=j!=null?j:e.find(function(a){return f===h.UPLOAD?a.supportsUploadMediaType(g):a.supportsDownloadMediaType(g)});return{selectedHost:j!=null?j:null,fallbackHost:b!=null?b:null}}function i(a){var b=new Map();a.forEach(function(a){var c;(c=a.downloadBuckets)==null||c.forEach(function(c){b.set(c,a)})});return b}g.OPERATIONS=h;g.routeSelection=a}),98);
__d("WAWebQueryMediaConnsJob",["WADeprecatedSendIq","WALogger","WAMediaConnParser","WAPromiseRaceAbort","WATimeUtils","WAWap","WAWebBackendErrors","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function o(a){switch(a){case"kyc-id":case"novi-image":case"novi-video":case"thumbnail-gif":case"xma-image":return null;default:return a}}function p(a){return{hostname:a.domain,"class":a["class"],ips:[{ip4:a.ip4,ip6:a.ip6}]}}function q(a){var b=function(a){var b=[],c=a.downloadable.map(o).filter(Boolean);c.length>0&&b.push({download:c});c=a.uploadable.map(o).filter(Boolean);c.length>0&&b.push({upload:c});c=a.downloadBuckets.map(function(a){return a.toString()});c!=null&&c.length>0&&b.push({downloadBuckets:c});return b};return{hosts:a.hosts.map(function(a){return babelHelpers["extends"]({},p(a),{fallback:a.fallback!=null?p(a.fallback):void 0,type:a.isFallback?"fallback":"primary",rules:b(a)})}),auth:a.authToken,authTTL:a.authTokenExpiryTs,ttl:a.routesExpiryTs,maxBuckets:a.maxBuckets}}function a(a){var b,e=new Date(),f=d("WATimeUtils").unixTime();b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:m",type:"set",id:b.generateId()},b.wap("media_conn",null));b=d("WADeprecatedSendIq").deprecatedSendIq(b,d("WAMediaConnParser").mediaConnParser).then(function(a){if(!a.success){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["response: "," ",""])),a.errorCode,a.errorText).sendLogs("backend:queryMediaConn: fail");if(a.errorCode===507)throw new(d("WAWebBackendErrors").E507)(a.errorText,a.errorBackoff);throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText)}else{d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConn: got "," hosts"])),a.result.hosts.length);a=q(a.result);var b=a.auth,g=a.authTTL,o=a.ttl,p=a.hosts;a=a.maxBuckets;if(!b||o==null||!p||p.length===0){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: auth exists ",""])),String(!!b));d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: ttl exists ",""])),String(!!o));d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: hosts exists ",""])),String(!!p));p&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["backend:queryMediaConnections: hosts.length ",""])),p.length);d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("backend:queryMediaConnections unexpected mediaConn");throw c("err")("Invalid mediaConn")}return{queryStartTime:e,auth:b,hosts:p,ttl:o-f,maxBuckets:a,authTTL:g-f}}});return c("WAPromiseRaceAbort")(b,a)}g.mapParsedMediaConn=q;g.queryMediaConn=a}),98);
__d("WAWebQueryMediaConnsBridge",["WABackoffDelay","WAPromiseBackoffs","WAWebBackendErrors","WAWebQueryMediaConnsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=1e3;c=15*60*1e3;var i=d("WAPromiseBackoffs").createTimer({algo:{type:"fibonacci",first:0,second:1},max:c,jitter:.25});function a(a){return d("WABackoffDelay").backoff({delay:function(a){a=a.taskDuration;var b=h*i();return Math.max(b-a,0)},signal:a},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=d("WAWebQueryMediaConnsJob").queryMediaConn(a);try{c=(yield c);var e=c.ttl,f=c.authTTL;f*=1e3;e*=1e3;return babelHelpers["extends"]({},c,{authTTL:f,ttl:e})}catch(a){if(a instanceof d("WAWebBackendErrors").E507)throw a;if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.status>=500)return b(a);throw a}});return function(a){return c.apply(this,arguments)}}())}g.sendQueryMediaConn=a}),98);
__d("WAWebMediaHosts",["Promise","WAAbortError","WALogger","WAMemoizeConcurrent","WAWebBackendErrors","WAWebMediaHost","WAWebMediaHostsErrors","WAWebMediaHostsRouteSelection","WAWebNormalizeStack","WAWebQueryMediaConnsBridge","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["forceRefresh"],i=["name","message","stack"],j,k,l,m,n,o;a=function(){function a(){var a=this;this._locked=!1;this._fetch=c("WAMemoizeConcurrent")(function(){return"all"},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var e=c.signal;try{c=(yield d("WAWebQueryMediaConnsBridge").sendQueryMediaConn(e));a._data=a._createMediaConnData(c);d("WAWebUserPrefsMultiDevice").setMms4Conn(c);a._err=null}catch(g){c=g;if(c instanceof d("WAWebBackendErrors").E507){var f;a._data=a._previousData;a._previousData=null;a._locked=!0;self.setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield a._refreshIfStale({signal:e}),a._locked=!1}),(f=c.backoff)!=null?f:void 0);return}a._data=null;a._err=c;if(c.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["mediaHosts.sendQueryMediaConn aborted"])));return}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["mediaHosts.sendQueryMediaConn error: ",""])),p(c)).verbose();d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).devConsole(c).sendLogs("Error fetching mms hosts")}});return function(a){return c.apply(this,arguments)}}());this._reset()}var e=a.prototype;e.forceRefresh=function(a){if(this._locked)return(o||(o=b("Promise"))).resolve(!1);a={signal:a,forceRefresh:!0};return this._refreshIfStale(a)};e.getCachedHostsInfo=function(a){var c=this;if(!this._locked){var d={signal:a.signal||new AbortController().signal,forceRefresh:!1};self.setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c._refreshIfStale(d),c._locked=!1}),0)}return this._getPreferredHostsInfo(a)};e.maybeLoadMediaConnFromStorage=function(){var a=d("WAWebUserPrefsMultiDevice").getMms4Conn();if(a==null)return;try{this._data=this._createMediaConnData(a)}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to init media conn from storage: ",""])),a).sendLogs("media-conn-failed-to-load")}};e.getHostsInfo=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,c=a.encFilehash,d=a.operation,e=a.type,f=a.signal;a=a.forceRefresh;a=a===void 0?!1:a;if(!this._locked){f={signal:f||new AbortController().signal,forceRefresh:a};yield this._refreshIfStale(f)}return this._getPreferredHostsInfo({directPath:b,encFilehash:c,operation:d,type:e})});function c(b){return a.apply(this,arguments)}return c}();e.getHostsInfoByBucket=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.preferredBuckets,c=a.signal;a=a.forceRefresh;a=a===void 0?!1:a;if(!this._locked){c={signal:c||new AbortController().signal,forceRefresh:a};yield this._refreshIfStale(c)}if(!this._data)throw new(d("WAWebMediaHostsErrors").NoMediaHostsError)("no fetched data");a=this._data;c=a.auth;a=a.hosts;if(!a.length)throw new(d("WAWebMediaHostsErrors").NoMediaHostsError)("no selected host");var e=new Map(b.map(function(a){return[a,null]}));a.forEach(function(a){var b;b=(b=a.downloadBuckets)==null?void 0:b.find(function(a){return e.has(a)});b!=null&&e.set(b,a)});var f,g;for(b of e.values()){if(b==null)continue;if(!f)f=b;else if(!g){g=b;break}}!f&&!g?(f=a[0],g=a[1]):g||(g=a[0]);if(!f)throw new(d("WAWebMediaHostsErrors").NoMediaHostsError)("no selected host");return{auth:c,selectedHost:f,fallbackHost:g}});function c(b){return a.apply(this,arguments)}return c}();e._createMediaConnData=function(a){var b=new Date(a.queryStartTime);return{auth:a.auth,authExpirationTime:new Date(b.getTime()+a.authTTL),authTTL:a.authTTL,hosts:a.hosts.map(function(a){return new(d("WAWebMediaHost").MediaHost)(a)}),hostsRefreshTime:new Date(b.getTime()+a.ttl),queryStartTime:b,maxBuckets:a.maxBuckets}};e._isExpiredOrMissing=function(){if(!this._data)return!0;var a=this._data;return new Date()>=a.authExpirationTime};e._getPreferredHostsInfo=function(a){if(!this._data)throw new(d("WAWebMediaHostsErrors").NoMediaHostsError)("no fetched data");var b=a.encFilehash,c=a.operation;a=a.type;var e=this._data,f=e.auth,g=e.hosts;e=e.maxBuckets;b=d("WAWebMediaHostsRouteSelection").routeSelection({encFilehash:b,hosts:g,operation:c,type:a,maxBuckets:e});g=b.selectedHost;c=b.fallbackHost;if(!g)throw new(d("WAWebMediaHostsErrors").NoMediaHostsError)("no selected host");return{auth:f,selectedHost:g,fallbackHost:c}};e._needsRefresh=function(){if(!this._data)return!0;var a=this._data;if(new Date()>=a.hostsRefreshTime)return!0;var b=a.authTTL;a=a.queryStartTime;b=Math.floor(b*.8);a=new Date(a.getTime()+b);return new Date()>=a};e._refreshIfStale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.forceRefresh;a=babelHelpers.objectWithoutPropertiesLoose(a,h);if(this._isExpiredOrMissing()||Boolean(b)){this._reset();yield this._fetch(a);return!0}if(this._needsRefresh()){this._fetch(a)["catch"](function(){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[media-hosts] failed to refresh and fetch"]))).sendLogs("media-hosts-failed-to-refresh-and-fetch",{sampling:.01})});return!1}return!1});function c(b){return a.apply(this,arguments)}return c}();e._reset=function(){this._previousData=this._data,this._data=null,this._err=null};return a}();e=new a();function p(a){a.name;a.message;a.stack;var b=babelHelpers.objectWithoutPropertiesLoose(a,i),c=d("WAWebNormalizeStack").normalizeStack(a);c=c.slice(c.indexOf("\n")+1);b=Object.keys(b).length===0?"":" "+JSON.stringify(b,function(a,b){return a&&typeof b==="object"?String(b):b});return(a.name||"Error")+": "+a.message+b+"\n"+c}g.mediaHosts=e}),98);
__d("WAWebMmsClientErrors",["WAWebHttpErrors"],(function(a,b,c,d,e,f,g){b=function(a){function b(b,c){c=a.call(this,404,b)||this;c.name="MediaNotFoundError";return c}babelHelpers.inheritsLoose(b,a);return b}((a=d("WAWebHttpErrors")).HttpStatusCodeError);c=function(a){function b(b,c){c=a.call(this,413,b)||this;c.name="MediaTooLargeError";return c}babelHelpers.inheritsLoose(b,a);return b}(a.HttpStatusCodeError);e=function(a){function b(b,c){c=a.call(this,415,b)||this;c.name="MediaInvalidError";return c}babelHelpers.inheritsLoose(b,a);return b}(a.HttpStatusCodeError);f=function(a){function b(b,c){c=a.call(this,401,b)||this;c.name="MMSUnauthorizedError";return c}babelHelpers.inheritsLoose(b,a);return b}(a.HttpStatusCodeError);d=function(a){function b(b,c){c=a.call(this,403,b)||this;c.name="MMSForbiddenError";return c}babelHelpers.inheritsLoose(b,a);return b}(a.HttpStatusCodeError);a=function(a){function b(b,c){c=a.call(this,507,b)||this;c.name="MMSThrottleError";return c}babelHelpers.inheritsLoose(b,a);return b}(a.HttpStatusCodeError);g.MediaNotFoundError=b;g.MediaTooLargeError=c;g.MediaInvalidError=e;g.MMSUnauthorizedError=f;g.MMSForbiddenError=d;g.MMSThrottleError=a}),98);
__d("WAWebMmsClientIsErrorRetryable",["WAWebHttpErrors","WAWebMediaHostsErrors","WAWebMmsClientErrors"],(function(a,b,c,d,e,f,g){function a(a){if(a===408)return!0;if(a===507)return!1;return a>=500?!0:!1}function b(a){return a instanceof d("WAWebMmsClientErrors").MMSThrottleError?!1:a instanceof d("WAWebMediaHostsErrors").NoMediaHostsError||a instanceof d("WAWebHttpErrors").HttpNetworkError||a instanceof d("WAWebMmsClientErrors").MMSUnauthorizedError||a instanceof d("WAWebHttpErrors").HttpStatusCodeError&&a.status>=500}g.isRetriableStatusCode=a;g.isErrorRetryable=b}),98);
__d("WAWebMmsClientMmsBackoffOptions",[],(function(a,b,c,d,e,f){a={minTimeout:1e3,retries:3};b=a;f["default"]=b}),66);
__d("WAWebMmsClientFormatHashUrl",["WABase64UrlSafe","WANullthrows","WAWebMmsMediaTypes","WAWebPonyfillsUrlSearchParams"],(function(a,b,c,d,e,f,g){var h=(b={audio:"/mms/audio",document:"/mms/document",gif:"/mms/gif",image:"/mms/image",ppic:"/pps/photo",product:"/mms/image",ptt:"/mms/ptt",sticker:"/mms/sticker","thumbnail-document":"/mms/thumbnail-document","thumbnail-link":"/mms/thumbnail-link",video:"/mms/video","md-app-state":"/mms/md-app-state","md-msg-hist":"/mms/md-msg-hist","product-catalog-image":"/product/image","biz-cover-photo":"/pps/biz-cover-photo","thumbnail-image":"/mms/thumbnail-image","thumbnail-video":"/mms/thumbnail-video"},b[(e=d("WAWebMmsMediaTypes")).MEDIA_TYPES.NEWSLETTER_AUDIO]="/newsletter/newsletter-audio",b[e.MEDIA_TYPES.NEWSLETTER_IMAGE]="/newsletter/newsletter-image",b[e.MEDIA_TYPES.NEWSLETTER_DOCUMENT]="/newsletter/newsletter-document",b[e.MEDIA_TYPES.NEWSLETTER_IMAGE]="/newsletter/newsletter-image",b[e.MEDIA_TYPES.NEWSLETTER_GIF]="/newsletter/newsletter-gif",b[e.MEDIA_TYPES.NEWSLETTER_PTT]="/newsletter/newsletter-ptt",b[e.MEDIA_TYPES.NEWSLETTER_PTV]="/newsletter/newsletter-ptv",b[e.MEDIA_TYPES.NEWSLETTER_STICKER]="/newsletter/newsletter-sticker",b[e.MEDIA_TYPES.NEWSLETTER_STICKER_PACK]="/newsletter/newsletter-sticker-pack",b[e.MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK]="/newsletter/newsletter-thumbnail-link",b[e.MEDIA_TYPES.NEWSLETTER_VIDEO]="/newsletter/newsletter-video",b[e.MEDIA_TYPES.NATIVE_AD_IMAGE]="/mms/ads-image",b[e.MEDIA_TYPES.NATIVE_AD_VIDEO]="/mms/ads-video",b[e.MEDIA_TYPES.STICKER_PACK]="/mms/sticker-pack",b[e.MEDIA_TYPES.THUMBNAIL_STICKER_PACK]="/mms/thumbnail-sticker-pack",b[e.MEDIA_TYPES.MUSIC_ARTWORK]="/mms/music-artwork",b);function a(a){var b=a.hostname,d=a.type,e=a.encFilehash,f=a.query;a=c("WANullthrows")(h[d]);d=new URL("https://"+b+a+"/"+c("WABase64UrlSafe")(e));var g={};f&&Object.keys(f).forEach(function(a){f[a]!=null&&(g[a]=f[a])});b=new(c("WAWebPonyfillsUrlSearchParams"))(g).toString();b&&(b="?"+b);return"https://"+d.host+d.pathname+b}g["default"]=a}),98);
__d("WAWebMmsClientFormatUploadUrl",["WABase64UrlSafe","WAWebABProps","WAWebMmsClientFormatHashUrl"],(function(a,b,c,d,e,f,g){function a(a){var b,e,f=a.auth,g=a.encFilehash,h=a.hostname,i=a.query,j=a.type,k=a.byteRange,l=a.mediaId;a=a.token;var m=i==null?void 0:i.final_hash;return c("WAWebMmsClientFormatHashUrl")({encFilehash:g,hostname:h,type:j,query:{auth:f,token:c("WABase64UrlSafe")(a),resume:i==null||(b=i.resume)==null?void 0:b.toString(10),stream:i==null||(e=i.stream)==null?void 0:e.toString(10),final_hash:m!=null?c("WABase64UrlSafe")(m):void 0,bytestart:k==null?void 0:k.start.toString(10),byteend:k==null?void 0:k.end.toString(10),media_id:l.toString(10),server_thumb_gen:(i==null?void 0:i.server_thumb_gen)!=null?"1":void 0,server_transcode:j==="newsletter-video"&&d("WAWebABProps").getABPropConfigValue("web_channel_video_server_transcode_upload")?"1":void 0}})}g["default"]=a}),98);
__d("WAWebMmsClientMmsLogError",["WAAbortError","WALogger","WAWebMmsClientErrors"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,e){e===void 0&&(e=!0),b instanceof d("WAWebMmsClientErrors").MediaNotFoundError&&e?d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",": expected error"])),a).devConsole(c,b):typeof b==="object"&&(b==null?void 0:b.name)===d("WAAbortError").ABORT_ERROR?d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["",": canceled"])),a).devConsole(c,b):d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),a,b).devConsole(c,b)}g.mmsLogError=a}),98);
__d("WAWebMmsClientMmsGetUploadProgress",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.auth,e=a.encFilehash,f=a.hostname,g=a.signal,j=a.type,k=a.onProgress,l=a.mediaId,m=a.token;a=a.generateThumbnailOnServer;b=c("WAWebMmsClientFormatUploadUrl")({auth:b,encFilehash:e,hostname:f,query:{resume:1,server_thumb_gen:a===!0?1:void 0},type:j,mediaId:l,token:m});f={encFilehash:e,type:j,url:b};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsGetUploadProgress: start"]))).devConsole(f);try{a=(yield d("WAWebHttpExtendedFetch").extendedFetch(b,{method:"post",signal:g,onProgress:k}));if(!a.ok)switch(a.status){case 401:throw new(d("WAWebMmsClientErrors").MMSUnauthorizedError)("mmsGetUploadProgress",{url:b});case 404:throw new(d("WAWebMmsClientErrors").MediaNotFoundError)("mmsGetUploadProgress",{url:b});default:throw new(d("WAWebHttpErrors").HttpStatusCodeError)(a.status,"mmsGetUploadProgress",{url:b})}l=(yield a.json());if(!l.resume)throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsGetUploadProgress: missing resume",{url:b});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mmsGetUploadProgress: success"]))).devConsole(f);return{directPath:l.direct_path,resume:l.resume,url:l.url,handle:l.handle}}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",a,f);throw a}});return j.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebMmsClientMmsCheckIfUploadExists",["WALogger","WAWebHttpErrors","WAWebMmsClientErrors","WAWebMmsClientMmsGetUploadProgress","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k="complete";function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={encFilehash:a.encFilehash,type:a.type};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: start"]))).devConsole(b);try{a=(yield c("WAWebMmsClientMmsGetUploadProgress")(a));var e=a.directPath,f=a.url,g=a.handle;a=a.resume;if(a===k){if(e==null||e==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsCheckIfUploadExists: missing directPath");if(f==null||f==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsCheckIfUploadExists: missing url");d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: success"]))).devConsole(b);return{directPath:e,url:f,handle:g,complete:!0}}e=parseInt(a,10);if(e===0)throw new(d("WAWebMmsClientErrors").MediaNotFoundError)("mmsCheckIfUploadExists");if(Number.isNaN(e)){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["mmsCheckIfUploadExists: resume is NaN, resume=",""])),e).sendLogs("upload-offset-is-NaN");throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsCheckIfUploadExists: invalid resume")}return{complete:!1,resume:e}}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsCheckIfUploadExists",a,b);throw a}});return l.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebPonyfillsFetch",["WAWebHttpExtendedFetch"],(function(a,b,c,d,e,f,g){var h=function(){};b="fetch"in self?self.fetch:a;function a(a,b){b===void 0&&(b={});return d("WAWebHttpExtendedFetch").sharedFetch(a,babelHelpers["extends"]({},b,{onProgress:h}))}g["default"]=b}),98);
__d("WAWebMmsClientMmsDeleteMdHistorySyncBlob",["WABase64","WABase64UrlSafe","WAWebHttpErrors","WAWebMmsClientFormatHashUrl","WAWebMmsMediaTypes","WAWebPonyfillsFetch","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,e=a.encFilehash,f=a.hostname,g=a.auth,h=a.encHandle;a=a.companionUserSecret;b=b.split("?")[0];b=new TextEncoder().encode(b);b=d("WABase64").encodeB64UrlSafe(b);var i=d("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC;f=c("WAWebMmsClientFormatHashUrl")({encFilehash:e,hostname:f,type:i,query:{token:c("WABase64UrlSafe")(e),d_md:b,auth:g,e_handle:h}});i={};h!=null&&a!=null&&(i.Companion_User_Secret=a);e=(yield c("WAWebPonyfillsFetch")(f,{method:"DELETE",headers:i}));if(!e.ok)throw new(d("WAWebHttpErrors").HttpStatusCodeError)(e.status,"MMS Delete error")});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebMmsCdnUrlValidationUtils",["WATimeUtils"],(function(a,b,c,d,e,f,g){var h={OE:"oe"};function a(a){a=a instanceof URL?a.searchParams:new URL(a).searchParams;a=a.get(h.OE);a=a==null?void 0:d("WATimeUtils").convertHexToDate(a);return{expirationDate:a}}g.parseCdnUrlParams=a}),98);
__d("WAWebMmsClientFormatDownloadUrl",["WABase64UrlSafe","WALogger","WAWebABProps","WAWebMmsClientFormatHashUrl","WAWebPonyfillsUrlSearchParams","WAWebSharedConstants","err","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var b=a.directPath,e=a.encFilehash,f=a.hostname,g=a.type,i=a.mode,k=a.byteRange;a=a.downloadBucket;if(!c("isStringNullOrEmpty")(b)){return j({encFilehash:e,hostname:f,directPath:b,query:(b={mode:i,bytestart:k==null?void 0:k.start.toString(),byteend:k==null?void 0:k.end.toString()},b[d("WAWebSharedConstants").MMS_URL_MEDIA_TYPE_SEARCH_PARAM]=g,b[d("WAWebSharedConstants").IS_MMS_URL_SEARCH_PARAM]="",b),downloadBucket:a,type:g})}if(d("WAWebABProps").getABPropConfigValue("web_deprecate_mms4_hash_based_download")){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[mms] missing direct path, media type: ",""])),g).sendLogs("media-fault: missing direct path");throw c("err")("No direct path is available for download, abort")}return c("WAWebMmsClientFormatHashUrl")({hostname:f,type:g,encFilehash:e,query:(k={mode:i},k[d("WAWebSharedConstants").IS_MMS_URL_SEARCH_PARAM]="",k)})}function j(a){var b=a.directPath,e=a.encFilehash,f=a.hostname,g=a.query,h=a.downloadBucket;a=a.type;var j=new URL(b,"https://"+f);if(j.hostname!==f){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["url.hostname: ",", hostname: ",", directPath: ",""])),j.hostname,f,b).sendLogs("malicious directPath");throw c("err")("malicious directPath")}var k=j.searchParams||new(c("WAWebPonyfillsUrlSearchParams"))(j.search);k.set("hash",c("WABase64UrlSafe")(e));h!=null&&k.set("_nc_cat",h.toString());f=d("WAWebABProps").getABPropConfigValue("low_cache_hit_rate_media_types");if(f!=null){b=f.split(",");b.includes(a)&&k.set("_nc_map","whatsapp-nofna")}Object.keys(g).forEach(function(a){var b=g[a];b!=null&&k.set(a,b)});return"https://"+j.host+j.pathname+"?"+k.toString()}g["default"]=a}),98);
__d("WAWebMmsClientMmsDownload",["WALogger","WAMediaCalculateFilehash","WATimeUtils","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMiscErrors","WAWebMmsCdnUrlValidationUtils","WAWebMmsClientErrors","WAWebMmsClientFormatDownloadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.url,c=a.signal,e=a.onHeadersReceived,f=a.onProgress,g=a.onData,k=a.debug,l=a.debugString;a=a.ciphertextValidator;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsDownload: [","] start"])),l).devConsole(k);try{c=(yield d("WAWebHttpExtendedFetch").extendedFetch(b,{signal:c,onProgress:f,onData:g,onHeadersReceived:e}));yield o({response:c,functionName:"mmsDownload",url:b});f=(yield c.arrayBuffer());if(a&&!(yield a(f))){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["download hash mismatch error. downloaded size: ",""])),f.byteLength);throw new(d("WAWebHttpErrors").MmsDownloadFilehashMismatchError)({url:b})}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["mmsDownload: [","] success"])),l).devConsole(k);return f}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsDownload",a,k);if(a instanceof TypeError)throw new(d("WAWebHttpErrors").HttpNetworkError)(a.message);throw a}});return l.apply(this,arguments)}function a(a){var e=a.directPath,f=a.encFilehash,g=a.staticUrl,h=a.hostname,i=a.type,j=a.signal,l=a.onProgress,m=a.onData,n=a.onHeadersReceived,o=a.mode,p=a.byteRange,q=a.debugString;a=a.downloadBucket;g=g?g:c("WAWebMmsClientFormatDownloadUrl")({directPath:e,encFilehash:f,hostname:h,type:i,mode:o,byteRange:p,downloadBucket:a});e=p?null:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("WAMediaCalculateFilehash").calculateFilehash(a))===f});return function(b){return a.apply(this,arguments)}}();return k({url:g,signal:j,onHeadersReceived:n,onProgress:l,onData:m,ciphertextValidator:e,debugString:q,debug:{encFilehash:f,type:i,url:g}})}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,c=a.encFilehash,d=a.hostname,e=a.type;a=a.signal;yield q({directPath:b,encFilehash:c,hostname:d,type:e,signal:a,functionName:"mmsCheckExistence"})});return m.apply(this,arguments)}function f(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,c=a.encFilehash,e=a.hostname,f=a.type;a=a.signal;b=(yield q({directPath:b,encFilehash:c,hostname:e,type:f,signal:a,functionName:"mmsGetEncryptedMediaSize"}));c=b.headers.get("content-length");if(!c)throw new(d("WAWebMiscErrors").UnableToGetContentLengthError)();return parseInt(c,10)});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.response,c=a.url;a=a.functionName;if(!b.ok)switch(b.status){case 401:throw new(d("WAWebMmsClientErrors").MMSUnauthorizedError)(a,{url:c});case 403:var e=(yield b.text());if(e.includes("URL signature expired"))throw new(d("WAWebMmsClientErrors").MediaNotFoundError)(a,{url:c,status:b.status});e=d("WAWebMmsCdnUrlValidationUtils").parseCdnUrlParams(c);e=e.expirationDate;if(e!=null&&d("WATimeUtils").toDate(d("WATimeUtils").unixTime())>=e)throw new(d("WAWebMmsClientErrors").MediaNotFoundError)(a,{url:c,status:b.status});throw new(d("WAWebMmsClientErrors").MMSForbiddenError)(a,{url:c});case 404:case 410:throw new(d("WAWebMmsClientErrors").MediaNotFoundError)(a,{url:c,status:b.status});case 507:throw new(d("WAWebMmsClientErrors").MMSThrottleError)(a,{url:c});default:throw new(d("WAWebHttpErrors").HttpStatusCodeError)(b.status,a,{url:c})}});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,e=a.encFilehash,f=a.hostname,g=a.type,h=a.signal;a=a.functionName;b=c("WAWebMmsClientFormatDownloadUrl")({directPath:b,encFilehash:e,hostname:f,type:g,mode:"auto"});e=(yield d("WAWebHttpExtendedFetch").extendedFetch(b,{method:"HEAD",signal:h}));yield o({response:e,functionName:a,url:b});return e});return r.apply(this,arguments)}g.mms4Download=a;g.mmsCheckExistence=e;g.mmsGetEncryptedMediaSize=f;g.validateMmsResponse=o}),98);
__d("WAWebMmsClientMmsUpload",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){var b;if(a.direct_path==null||a.direct_path==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing direct_path");if(a.url==null||a.url==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing url");return{directPath:a.direct_path,url:a.url,handle:a.handle,thumbnailDirectPath:(b=a.thumbnail_info)==null?void 0:b.thumbnail_direct_path,thumbnailSha256:(b=a.thumbnail_info)==null?void 0:b.thumbnail_sha256,metadataUrl:a.metadata_url}}function k(a){if(a.ts==null)throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing ts (timestamp)");if(a.meta_hmac==null)throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing meta_hmac");if(a.fbid==null)throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing fbid");return{directPath:"",url:"",ts:a.ts,metaHmac:a.meta_hmac,fbid:a.fbid}}function l(a){if(a.direct_path==null||a.direct_path==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing direct_path");if(a.url==null||a.url==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing url");if(a.fbid==null)throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUpload: missing fbid");return{directPath:a.direct_path,url:a.url,fbid:a.fbid}}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.auth,e=a.ciphertextHmac,f=a.encFilehash,g=a.hostname,m=a.type,n=a.signal,o=a.onProgress,p=a.byteRange,q=a.mediaId,r=a.generateThumbnailOnServer,s=c("WAWebMmsClientFormatUploadUrl")({auth:b,encFilehash:f,hostname:g,type:m,byteRange:p,mediaId:q,token:a.token,query:{server_thumb_gen:r===!0?1:void 0}});b={encFilehash:f,type:m,url:s};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsUpload: start"]))).devConsole(b);try{var t;switch(m){case d("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_IMAGE:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_VIDEO:t=l;break;case d("WAWebMmsMediaTypes").MEDIA_TYPES.BIZ_COVER_PHOTO:t=k;break;default:t=j;break}g=(yield d("WAWebHttpExtendedFetch").extendedFetch(s,{method:"post",body:e,signal:n,onProgress:o}).then(function(a){if(!a.ok)switch(a.status){case 401:throw new(d("WAWebMmsClientErrors").MMSUnauthorizedError)("mmsUpload",{url:s});case 413:throw new(d("WAWebMmsClientErrors").MediaTooLargeError)("mmsUpload",{url:s});case 415:throw new(d("WAWebMmsClientErrors").MediaInvalidError)("mmsUpload: hash mismatch",{url:s});case 507:throw new(d("WAWebMmsClientErrors").MMSThrottleError)("mmsUpload",{url:s});default:throw new(d("WAWebHttpErrors").HttpStatusCodeError)(a.status,"mmsUpload",{url:s})}return a.json()}).then(t));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mmsUpload: success"]))).devConsole(b);return g}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",a,b,!1);throw a}});return m.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebMediaHostsMaybeSwitchHost",["WAWebMediaHost"],(function(a,b,c,d,e,f,g){var h=50*1024*1024;function i(a,b,c){return a.equals(b)&&c!=null&&b!=null&&!b.equals(c)}function a(a,b,c,e){var f=b.selectedHost;b=b.fallbackHost;var g=c.selectedHost;c=c.fallbackHost;if(e<h)return{changed:!1,host:a};switch(a.type){case d("WAWebMediaHost").HOST_TYPE.PRIMARY:if(!a.equals(g))return{changed:!0,host:g};break;case d("WAWebMediaHost").HOST_TYPE.FALLBACK:if(!f.equals(g))return{changed:!0,host:g};else if(i(a,b,c)||i(a,f.fallback,g.fallback))return{changed:!0,host:f};break}return{changed:!1,host:a}}g.THRESHOLD=h;g.maybeSwitchHost=a}),98);
__d("WAWebMmsClientPollMediaHosts",["Promise","WAPromiseDelays","WARetryPromise","WAWebMediaHostsMaybeSwitchHost","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=5*60*1e3;function a(a,b){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&b>d("WAWebMediaHostsMaybeSwitchHost").THRESHOLD}function e(a,b){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&(b!=null?b:0)>d("WAWebMediaHostsMaybeSwitchHost").THRESHOLD}function f(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.connectionBlock;yield d("WAPromiseDelays").delayMs(i,a.signal);return c("WARetryPromise")(function(c){var f=c.retry;return new(h||(h=b("Promise")))(function(b){return a.getMediaHosts().then(function(c){var g=c.selectedHost;c=c.fallbackHost;g={selectedHost:g,fallbackHost:c};c=a.getRemainingBytes();if(c==null)return f(i);c=d("WAWebMediaHostsMaybeSwitchHost").maybeSwitchHost(a.getHost(),e,g,c);var h=c.changed;c=c.host;e=g;return h?b(c):f(i)})})},a.signal)});return j.apply(this,arguments)}g.SERVER_POLLING_INTERVAL=i;g.shouldPollUploadHosts=a;g.shouldPollDownloadHosts=e;g.pollMediaHosts=f}),98);
__d("WAWebMmsClientSelectHost",[],(function(a,b,c,d,e,f){var g=4;function a(a){var b=a.selectedHost,c=a.fallbackHost,d=a.attemptCount,e=a.lastHostUsed;a=a.lastFetchMadeProgress;if(a&&e)return e;if(d<=1)return b;if(d===g-1&&c)return c;return e!=null&&e.equals(b)&&b.fallback!=null?b.fallback:c!=null?c:b}f["default"]=a}),66);
__d("WAWebMmsClientMmsUploadStream",["WALogger","WAWebHttpErrors","WAWebHttpExtendedFetch","WAWebMmsClientErrors","WAWebMmsClientFormatUploadUrl","WAWebMmsClientMmsLogError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a,b,c){switch(a){case 401:throw new(d("WAWebMmsClientErrors").MMSUnauthorizedError)(b,{url:c});case 413:throw new(d("WAWebMmsClientErrors").MediaTooLargeError)(b,{url:c});case 415:throw new(d("WAWebMmsClientErrors").MediaInvalidError)(b+": hash mismatch",{url:c});case 507:throw new(d("WAWebMmsClientErrors").MMSThrottleError)("mmsUploadStreamFinalize",{url:c});default:throw new(d("WAWebHttpErrors").HttpStatusCodeError)(a,b,{url:c})}}function a(a){var b=a.auth,e=a.encFilehash,f=a.type,g=a.hostname,h=a.byteStart,i=a.byteEnd,k=a.chunk,l=a.signal,m=a.onProgress,n=a.mediaId,o=a.token;a=a.generateThumbnailOnServer;var p=c("WAWebMmsClientFormatUploadUrl")({auth:b,encFilehash:e,type:f,hostname:g,query:{stream:1,server_thumb_gen:a===!0?1:void 0},byteRange:{start:h,end:i},mediaId:n,token:o});return d("WAWebHttpExtendedFetch").extendedFetch(p,{method:"post",body:k,signal:l,onProgress:m}).then(function(a){a.ok||j(a.status,"mmsUploadStream",p)})}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.auth,e=a.encFilehash,f=a.type,g=a.hostname,k=a.finalHash,l=a.signal,m=a.mediaId;a=a.generateThumbnailOnServer;var n=c("WAWebMmsClientFormatUploadUrl")({auth:b,encFilehash:e,type:f,hostname:g,query:{stream:1,final_hash:k,server_thumb_gen:a===!0?1:void 0},mediaId:m,token:e});b={encFilehash:e,type:f,url:n};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mmsUploadStreamFinalize: start"]))).devConsole(b);try{g=(yield d("WAWebHttpExtendedFetch").extendedFetch(n,{method:"post",signal:l}).then(function(a){a.ok||j(a.status,"mmsUploadStreamFinalize",n);return a.json()}).then(function(a){if(a.direct_path==null||a.direct_path==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUploadStreamFinalize: missing direct_path");if(a.url==null||a.url==="")throw new(d("WAWebHttpErrors").HttpInvalidResponseError)("mmsUploadStreamFinalize: missing url");return{directPath:a.direct_path,url:a.url,handle:a.handle}}));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mmsUploadStreamFinalize: success"]))).devConsole(b);return g}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsUpload",a,b,!1);throw a}});return k.apply(this,arguments)}g.mmsUploadStream=a;g.mmsUploadStreamFinalize=e}),98);
__d("WAWebWamEnumOverallLastUploadRetryPhaseType",[],(function(a,b,c,d,e,f){a=Object.freeze({RESUME_CHECK:1,UPLOAD:2,FINALIZE:3});f.OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE=a}),66);
__d("WAWebMmsClientUploadStreamer",["Promise","WAExponentialBackoff","WALogger","WARaceSignal","WARetryPromise","WAWebHttpErrors","WAWebMediaHosts","WAWebMediaHostsRouteSelection","WAWebMmsClientIsErrorRetryable","WAWebMmsClientMmsBackoffOptions","WAWebMmsClientMmsUploadStream","WAWebMmsClientPollMediaHosts","WAWebMmsClientSelectHost","WAWebMmsMediaTypes","WAWebNetworkStatus","WAWebWamEnumOverallLastUploadRetryPhaseType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["auth"],i,j,k,l;function a(a,b){var c=o(b);return b===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&c>0&&a>c}e=function(){function a(a){var c;this.$2=Date.now();this.$3=0;this.$4=0;this.$9=(l||(l=b("Promise"))).resolve();this.$6=a.encFilehash;this.$5=a.type;this.$7=a.signal;this.$3=(c=a.byteOffset)!=null?c:0;this.$1=a.encFilehash.slice(0,10);this.$11=a.token;this.$12=(c=a.generateThumbnailOnServer)!=null?c:!1;this.$13=a.onUploadHostFound;this.$14=a.onUploadAttemptSuccess;this.$15=a.onUploadAttemptError;this.$16=a.onProgress;this.$17=a.onFinalize;this.$18=a.onStreamUploadStart;this.$10=a.mediaId}var e=a.prototype;e.uploadCompleteFile=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.ciphertextHmac;a=new Uint8Array(a);this.$8=a.byteLength;var e=o(this.$5);e=e===0?a.byteLength:e;(b=this.$18)==null||b.call(this);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] start upload"])),this.$1);yield c("WAWebNetworkStatus").waitIfOffline();b=Math.ceil((a.byteLength-this.$3)/e);for(var f=0;f<b;f++){this.$19(f,b);var g=this.$3+f*e,h=g+e;h=a.subarray(g,h);yield this.$20(h,g);this.$4+=h.byteLength}g=(yield this.$21(this.$6));(h=this.$14)==null||h.call(this,Date.now()-this.$2);return g});function e(b){return a.apply(this,arguments)}return e}();e.startUploadFromClient=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;yield c("WAWebNetworkStatus").waitIfOffline();(a=this.$18)==null||a.call(this)});function d(){return a.apply(this,arguments)}return d}();e.uploadChunkFromClient=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;this.$9=this.$9.then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c.$20(a,c.$3),c.$4+=a.byteLength,c.$3+=a.byteLength}));yield this.$9});function c(b){return a.apply(this,arguments)}return c}();e.finalizeUploadFromClient=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c,d=(yield this.$9.then(function(){return b.$21(a)}));(c=this.$14)==null||c.call(this,Date.now()-this.$2);return d});function c(b){return a.apply(this,arguments)}return c}();e.$22=function(){this.$2=Date.now()};e.$23=function(){return Date.now()-this.$2};e.$24=function(){if(this.$8==null)return;return this.$8-this.$4};e.$19=function(a,b){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] uploading chunk ","/",""])),this.$1,a+1,b)};e.$20=function(a,e){var f=this;return d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:this.$7}),function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){try{yield f.$25(a,e,c)}catch(a){if(m(a,c)){f.$15==null||f.$15(a,f.$23(),c,d("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.UPLOAD);f.$22();return b(a)}throw a}});return function(a,b){return c.apply(this,arguments)}}())};e.$21=function(a){var e=this;return d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:this.$7}),function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){try{e.$17==null||e.$17();return yield e.$26(a,c)}catch(a){if(n(a,c)){e.$15==null||e.$15(a,e.$23(),c,d("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.FINALIZE);e.$22();return b(a)}throw a}});return function(a,b){return c.apply(this,arguments)}}())};e.$25=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=this,i=null,j=!1;yield c("WAWebNetworkStatus").waitIfOffline();var k=(yield this.$27(f)),m=k.auth,n=babelHelpers.objectWithoutPropertiesLoose(k,h),o=i=c("WAWebMmsClientSelectHost")({selectedHost:n.selectedHost,fallbackHost:n.fallbackHost,lastHostUsed:i,lastFetchMadeProgress:j,attemptCount:f}),p=function(a){j=!0,g.$16==null||g.$16(a,e)};return c("WARetryPromise")(function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(h){h=h.retry;var j=new AbortController(),k=j.signal;k=(yield c("WARaceSignal")([k,g.$7],function(c){var h=g.$8!=null&&d("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(g.$5,g.$8)?d("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:n,signal:c,getHost:function(){return o},getMediaHosts:function(){return g.$27(f,!0)},getRemainingBytes:function(){return g.$24()}}).then(function(a){return{host:a,kind:"host-changed"}}):null;c=d("WAWebMmsClientMmsUploadStream").mmsUploadStream({auth:m,encFilehash:g.$6,type:g.$5,hostname:o.hostname,byteStart:e,byteEnd:e+a.byteLength,chunk:a,signal:c,onProgress:p,mediaId:g.$10,token:g.$11,generateThumbnailOnServer:g.$12}).then(function(){return{kind:"upload-completed"}});return(l||(l=b("Promise"))).race([c,h].filter(Boolean))["finally"](function(){return j.abort()})}));if(k.kind==="host-changed"){i=o;o=k.host;return h()}});return function(a){return h.apply(this,arguments)}}())});function e(b,c,d){return a.apply(this,arguments)}return e}();e.$26=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield c("WAWebNetworkStatus").waitIfOffline();b=(yield this.$27(b));var e=b.auth;b=b.selectedHost;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["uploadStreamer: [","] finalizing"])),this.$1);return d("WAWebMmsClientMmsUploadStream").mmsUploadStreamFinalize({auth:e,hostname:b.hostname,encFilehash:this.$6,finalHash:a,type:this.$5,signal:this.$7,mediaId:this.$10,generateThumbnailOnServer:this.$12})});function e(b,c){return a.apply(this,arguments)}return e}();e.$27=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;b===void 0&&(b=!1);b=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:d("WAWebMediaHostsRouteSelection").OPERATIONS.UPLOAD,encFilehash:this.$6,type:this.$5,signal:this.$7,forceRefresh:b}));(c=this.$13)==null||c.call(this,{failCount:a,hostName:b.selectedHost.hostname,hostClass:b.selectedHost["class"]});return b});function c(b,c){return a.apply(this,arguments)}return c}();return a}();function m(a,b){return d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(a)&&b<c("WAWebMmsClientMmsBackoffOptions").retries}function n(a,b){return a instanceof d("WAWebHttpErrors").HttpStatusCodeError&&a.status>=500?!1:m(a,b)}function o(a){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT?50*1024*1024:0}g.shouldUseStreamingUpload=a;g.UploadStreamer=e}),98);
__d("WAWebMmsOperationsConst",[],(function(a,b,c,d,e,f){a={DOWNLOAD:"DOWNLOAD",UPLOAD:"UPLOAD"};b=a;f["default"]=b}),66);
__d("WAWebMmsClient",["Promise","WAExponentialBackoff","WALogger","WANullthrows","WARaceSignal","WARetryPromise","WAWebMediaHosts","WAWebMmsClientIsErrorRetryable","WAWebMmsClientMmsBackoffOptions","WAWebMmsClientMmsCheckIfUploadExists","WAWebMmsClientMmsDeleteMdHistorySyncBlob","WAWebMmsClientMmsDownload","WAWebMmsClientMmsLogError","WAWebMmsClientMmsUpload","WAWebMmsClientPollMediaHosts","WAWebMmsClientSelectHost","WAWebMmsClientUploadStreamer","WAWebMmsMediaTypes","WAWebMmsOperationsConst","WAWebNetworkStatus","WAWebWamEnumOverallLastUploadRetryPhaseType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["ciphertextHmac"],i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;function a(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.encFilehash,f=a.signal,g=a.type,h=a.mediaId,i=a.generateThumbnailOnServer,j=!1,k={encFilehash:a.encFilehash,type:a.type};d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: start"]))).devConsole(k);try{var l=null,p=(yield d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:f}),function(){var m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,m){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: attempt #",""])),m+1).devConsole(k);yield c("WAWebNetworkStatus").waitIfOffline();try{var o=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c("WAWebMmsOperationsConst").UPLOAD,encFilehash:e,type:g,signal:f})),p=o.auth,q=o.selectedHost;o=o.fallbackHost;q=c("WAWebMmsClientSelectHost")({selectedHost:q,fallbackHost:o,lastHostUsed:l,attemptCount:m,lastFetchMadeProgress:j});l=q;return yield c("WAWebMmsClientMmsCheckIfUploadExists")({auth:p,encFilehash:e,hostname:q.hostname,type:g,signal:f,onProgress:function(){j=!0},mediaId:h,token:a.token,generateThumbnailOnServer:i})}catch(a){if(d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(a))return b(a);throw a}});return function(a,b){return m.apply(this,arguments)}}()));d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.checkIfUploadExists: success"]))).devConsole(k);return p}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.checkIfUploadExists",a,k);throw a}});return A.apply(this,arguments)}function e(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.encFilehash,e=a.type,f=a.onUploadAttemptSuccess;b={encFilehash:b,type:e};d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: start"]))).devConsole(b);try{if(d("WAWebMmsClientUploadStreamer").shouldUseStreamingUpload(a.ciphertextHmac.byteLength,a.type)){e=a.ciphertextHmac;var g=babelHelpers.objectWithoutPropertiesLoose(a,h);g=new(d("WAWebMmsClientUploadStreamer").UploadStreamer)(g);return yield g.uploadCompleteFile({ciphertextHmac:e})}g=(yield M(a));e=g.response;a=g.retryStartTime;f(Date.now()-a);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: success"]))).devConsole(b);return c("WANullthrows")(e)}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.upload",a,b,!1);throw a}});return B.apply(this,arguments)}function f(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,c=a.filehash,e=a.type,f=a.debugString,g=a.staticUrl,h=a.onDownloadAttemptSuccess;b={directPath:b,filehash:c,type:e,staticUrl:g};d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] start"])),f).devConsole(b);try{c=(yield I(a));e=c.response;g=c.retryStartTime;h(Date.now()-g);d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] success"])),f).devConsole(b);return e}catch(a){d("WAWebMmsClientMmsLogError").mmsLogError("mmsClient.download",a,b);throw a}});return C.apply(this,arguments)}function D(a){return F(function(b){return d("WAWebMmsClientMmsDownload").mmsCheckExistence(babelHelpers["extends"]({},a,{hostname:b}))},a)}function E(a){return F(function(b){return d("WAWebMmsClientMmsDownload").mmsGetEncryptedMediaSize(babelHelpers["extends"]({},a,{hostname:b}))},a)}function F(a,e){var f=e.directPath,g=e.encFilehash,h=e.type,k=e.signal,l={directPath:f,type:h};d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["runTaskWithBackoff: start"]))).devConsole(l);return d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:k}),function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["runMmsTaskWithBackoff: attempt #",""])),e+1).devConsole(l);try{e=(yield G({operation:c("WAWebMmsOperationsConst").DOWNLOAD,directPath:f,encFilehash:g,type:h,signal:k,failCount:e}));e=(yield a(e));return e}catch(a){if(d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(a))return b(a);throw a}});return function(a,b){return e.apply(this,arguments)}}())}function G(a){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.failCount,c=a.operation,e=a.directPath,f=a.encFilehash,g=a.type;a=a.signal;c=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c,directPath:e,encFilehash:f,type:g,signal:a}));e=c.selectedHost;f=c.fallbackHost;g=b>=2&&f?f:e;return g.hostname});return H.apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.debugString,f=a.signal,g=a.directPath,h=a.filehash,i=a.staticUrl,j=a.type,k=a.onDownloadHostFound,l=a.mode,m=a.byteRange,n=a.onDownloadAttemptError,o=a.onData,p=a.onProgress;a=Date.now();var q=!1,r={directPath:g,filehash:h,type:j,staticUrl:i},s=null,w=(yield d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:f}),function(){var w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(w,x){a=Date.now();d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] attempt #",""])),e,x+1).devConsole(r);var y=function(a){return d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c("WAWebMmsOperationsConst").DOWNLOAD,directPath:g,encFilehash:h,type:j,signal:f,forceRefresh:a})};try{var A=(yield y()),B=A.selectedHost;A=A.fallbackHost;var C=c("WAWebMmsClientSelectHost")({selectedHost:B,fallbackHost:A,attemptCount:x,lastHostUsed:s,lastFetchMadeProgress:q});s=C;k({hostName:C.hostname,hostClass:C["class"],failCount:x});var D=0,E=null,F={selectedHost:B,fallbackHost:A},G=function(a){if(a!=null&&E==null){a=a.get("Content-Length");a=parseInt(a,10);E=Number.isNaN(a)?null:a;d("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] Content-Length "," bytes"])),e,E)}};return yield c("WARetryPromise")(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var k=a.retry;a.failCount;var n=function(a){p==null||p(a),q=!0,a.lengthComputable&&(D=a.loaded)};D=0;var r=new AbortController();a=r.signal;a=(yield c("WARaceSignal")([f,a],function(a){var c=d("WAWebMmsClientMmsDownload").mms4Download({directPath:g,encFilehash:h,staticUrl:i,hostname:C.hostname,type:j,signal:a,mode:l,byteRange:m,debugString:e,onHeadersReceived:G,onProgress:n,onData:o,downloadBucket:C.selectedBucket}).then(function(a){return{kind:"download-completed",arrayBuffer:a}});a=d("WAWebMmsClientPollMediaHosts").shouldPollDownloadHosts(j,E)?d("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:F,getHost:function(){return C},getMediaHosts:function(){return y(!0)},getRemainingBytes:function(){return E!=null?E-D:null},signal:a}).then(function(a){return{kind:"host-changed",host:a}}):null;return(z||(z=b("Promise"))).race([c,a].filter(Boolean))["finally"](function(){return r.abort()})}));if(a.kind==="host-changed"){C=a.host;s=C;d("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.download: [","] switch to new host"])),e).devConsole(C);return k()}return a.arrayBuffer});return function(b){return a.apply(this,arguments)}}())}catch(b){q=!1;B=d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(b);A=!B||x===c("WAWebMmsClientMmsBackoffOptions").retries;A||n({error:b,overallT:Date.now()-a,failCount:x});if(B)return w(b);throw b}});return function(a,b){return w.apply(this,arguments)}}()));return{response:c("WANullthrows")(w),retryStartTime:a}});return J.apply(this,arguments)}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.auth,e=a.encFilehash,f=a.hostname,g=a.type,h=a.signal,i=a.byteLength,j=a.byteOffset,k=a.failCount,l=a.mediaId,m=a.token;a=a.generateThumbnailOnServer;if(j!=null&&k===0)return j;if(!d("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(g,i))return 0;try{k=(yield c("WAWebMmsClientMmsCheckIfUploadExists")({auth:b,encFilehash:e,hostname:f,type:g,signal:h,mediaId:l,token:m,generateThumbnailOnServer:a}));if(k.complete)return 0;j=k.resume;return j>=i?0:j}catch(a){d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["Failed to compute upload offset"]))).verbose().devConsole(a).sendLogs("upload-offset-failed");return 0}});return L.apply(this,arguments)}function M(a){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.ciphertextHmac,f=a.encFilehash,g=a.type,h=a.signal,i=a.onUploadHostFound,j=a.onUploadAttemptError,k=a.onProgress,l=a.byteOffset,m=a.mediaId,n=a.generateThumbnailOnServer,o=!1,p=Date.now(),q={encFilehash:f,type:g},r=null,s=(yield d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:h}),function(){var s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(s,t){var u=function(a){return d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c("WAWebMmsOperationsConst").UPLOAD,encFilehash:f,type:g,signal:h,forceRefresh:a})};p=Date.now();d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: attempt #",""])),t+1).devConsole(q);try{yield c("WAWebNetworkStatus").waitIfOffline();var v=(yield u()),w=v.auth,A=v.selectedHost;v=v.fallbackHost;var B={selectedHost:A,fallbackHost:v},C=c("WAWebMmsClientSelectHost")({selectedHost:A,fallbackHost:v,attemptCount:t,lastHostUsed:r,lastFetchMadeProgress:o});r=C;i({hostName:C.hostname,hostClass:C["class"],failCount:t});return yield c("WARetryPromise")(function(){var i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(i){i=i.retry;var j=(yield K({auth:w,encFilehash:f,byteLength:e.byteLength,hostname:C.hostname,type:g,signal:h,byteOffset:l,failCount:t,mediaId:m,token:a.token,generateThumbnailOnServer:n})),p=new AbortController(),q=p.signal;q=(yield c("WARaceSignal")([h,q],function(i){i=d("WAWebMmsClientPollMediaHosts").shouldPollUploadHosts(g,e.byteLength)?d("WAWebMmsClientPollMediaHosts").pollMediaHosts({connectionBlock:B,getHost:function(){return C},getMediaHosts:function(){return u(!0)},getRemainingBytes:function(){return e.byteLength},signal:i}).then(function(a){return{kind:"host-changed",host:a}}):null;var l=c("WAWebMmsClientMmsUpload")({auth:w,ciphertextHmac:j>0?new Uint8Array(e).subarray(j):e,hostname:C.hostname,encFilehash:f,type:g,signal:h,onProgress:function(a){o=!0,k(a,j)},byteRange:j>0?{start:j,end:e.byteLength}:void 0,mediaId:m,token:a.token,generateThumbnailOnServer:n}).then(function(a){return{kind:"upload-completed",value:a}});return(z||(z=b("Promise"))).race([l,i].filter(Boolean))["finally"](function(){return p.abort()})}));if(q.kind==="host-changed"){C=q.host;r=C;d("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["mmsClient.upload: switch to new host"]))).devConsole(C);return i()}return q.value});return function(a){return i.apply(this,arguments)}}())}catch(a){o=!1;A=d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(a);v=!A||t===c("WAWebMmsClientMmsBackoffOptions").retries;v||j(a,Date.now()-p,t,d("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.UPLOAD);if(A)return s(a);throw a}});return function(a,b){return s.apply(this,arguments)}}()));return{response:s,retryStartTime:p}});return N.apply(this,arguments)}function O(a){var b=a.directPath,e=a.encFilehash,f=a.encHandle,g=a.companionUserSecret;return P(function(a,d){return c("WAWebMmsClientMmsDeleteMdHistorySyncBlob")({directPath:b,hostname:a,encFilehash:e,auth:d,encHandle:f,companionUserSecret:g})},babelHelpers["extends"]({},a,{type:d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,operation:c("WAWebMmsOperationsConst").UPLOAD}))}function P(a,e){var f=e.directPath,g=e.encFilehash,h=e.type,i=e.signal,j=e.operation,m={directPath:f,type:h};d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["runTaskWithBackoff: start"]))).devConsole(m);return d("WAExponentialBackoff").exponentialBackoff(babelHelpers["extends"]({},c("WAWebMmsClientMmsBackoffOptions"),{signal:i}),function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["runMmsTaskWithBackoff: attempt #",""])),c+1).devConsole(m);try{c=(yield Q({operation:j,directPath:f,encFilehash:g,type:h,signal:i,failCount:c}));var e=c.hostname;c=c.auth;e=(yield a(e,c));return e}catch(a){if(d("WAWebMmsClientIsErrorRetryable").isErrorRetryable(a))return b(a);throw a}});return function(a,b){return c.apply(this,arguments)}}())}function Q(a){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.failCount,c=a.operation,e=a.directPath,f=a.encFilehash,g=a.type;a=a.signal;c=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c,directPath:e,encFilehash:f,type:g,signal:a}));e=c.selectedHost;f=c.fallbackHost;g=c.auth;a=b>=2&&f?f:e;return{hostname:a.hostname,auth:g}});return R.apply(this,arguments)}f={download:f,upload:e,checkExistence:D,getEncryptedMediaSize:E,checkIfUploadExists:a,deleteMdHistorySyncBlob:O};e=f;g["default"]=e}),98);
__d("WAWebWamEnumPeerDataRequestType",[],(function(a,b,c,d,e,f){a=Object.freeze({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERAL_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4,WAFFLE_LINKING_NONCE_FETCH:5,SYNCD_SNAPSHOT_RECOVERY:6,HISTORY_SYNC_CHUNK_RETRY:7});f.PEER_DATA_REQUEST_TYPE=a}),66);
__d("WAWebWamEnumPeerDataResponseResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,OTHER_ERROR:2,REQUEST_TARGET_NOT_FOUND:3,REQUEST_INVALID:4,FAIL_TO_UPLOAD:5,FAIL_TO_SEND_RESPONSE:6,REQUEST_TOO_OLD:7});f.PEER_DATA_RESPONSE_RESULT_TYPE=a}),66);
__d("WAWebNonMessagePeerDataMediaUploadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestType","WAWebWamEnumPeerDataResponseResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({NonMessagePeerDataMediaUpload:[3902,{peerDataErrorCount:[1,a.TYPES.INTEGER],peerDataExistingDataNoUploadCount:[2,a.TYPES.INTEGER],peerDataNotFoundCount:[3,a.TYPES.INTEGER],peerDataRequestCount:[4,a.TYPES.INTEGER],peerDataRequestSessionId:[5,a.TYPES.STRING],peerDataRequestType:[6,d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE],peerDataResponseResult:[8,d("WAWebWamEnumPeerDataResponseResultType").PEER_DATA_RESPONSE_RESULT_TYPE],peerDataSuccessInlineNoUploadCount:[9,a.TYPES.INTEGER],peerDataSuccessUploadCount:[7,a.TYPES.INTEGER]},[1,1,1],"regular"]},{NonMessagePeerDataMediaUpload:[]});g.NonMessagePeerDataMediaUploadWamEvent=b}),98);
__d("WAWebWamEnumPeerDataRequestErrorCode",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_SUPPORTED:0,GENERATION_ERROR:1,CHUNK_CONSUMED:2,TIMEOUT:3,SESSION_EXHAUSTED:4,CHUNK_EXHAUSTED:5,DUPLICATE_REQUEST:6});f.PEER_DATA_REQUEST_ERROR_CODE=a}),66);
__d("WAWebWamEnumPeerDataResponseApplyResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,OTHER_ERROR:2,INVALID_RESPONSE:3,FAIL_TO_DOWNLOAD:4,REQUEST_TIMEOUT:5});f.PEER_DATA_RESPONSE_APPLY_RESULT_TYPE=a}),66);
__d("WAWebNonMessagePeerDataOperationResponseWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestErrorCode","WAWebWamEnumPeerDataRequestType","WAWebWamEnumPeerDataResponseApplyResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({NonMessagePeerDataOperationResponse:[3904,{peerDataErrorCount:[1,a.TYPES.INTEGER],peerDataNotFoundCount:[2,a.TYPES.INTEGER],peerDataRequestErrorCode:[9,d("WAWebWamEnumPeerDataRequestErrorCode").PEER_DATA_REQUEST_ERROR_CODE],peerDataRequestSessionId:[3,a.TYPES.STRING],peerDataRequestType:[4,d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE],peerDataResponseApplyResult:[8,d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE],peerDataResponseCount:[5,a.TYPES.INTEGER],peerDataSuccessProcessCount:[6,a.TYPES.INTEGER],peerDataSuccessResponseCount:[7,a.TYPES.INTEGER]},[1,1,1],"regular"]},{NonMessagePeerDataOperationResponse:[]});g.NonMessagePeerDataOperationResponseWamEvent=b}),98);
__d("WAWebNonMessagePeerDataRequestWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPeerDataRequestErrorCode","WAWebWamEnumPeerDataRequestType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({NonMessagePeerDataRequest:[3906,{peerDataRequestCount:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER],peerDataRequestErrorCode:[4,d("WAWebWamEnumPeerDataRequestErrorCode").PEER_DATA_REQUEST_ERROR_CODE],peerDataRequestSessionId:[2,d("WAWebWamCodegenUtils").TYPES.STRING],peerDataRequestType:[3,d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE]},[1,1,1],"regular"]},{NonMessagePeerDataRequest:[]});g.NonMessagePeerDataRequestWamEvent=a}),98);
__d("WAWebWebcLinkPreviewResponseHandleWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcLinkPreviewResponseHandle:[3860,{didRespondHqPreview:[5,a.TYPES.BOOLEAN],isPreviewSuccess:[2,a.TYPES.BOOLEAN],previewDurationMs:[4,a.TYPES.INTEGER],previewSessionId:[3,a.TYPES.STRING]},[1,1,1],"regular"]},{WebcLinkPreviewResponseHandle:[]});g.WebcLinkPreviewResponseHandleWamEvent=b}),98);
__d("WAWebNonMessageDataRequestLoggingUtils",["WALogger","WATimeUtils","WAWebNonMessagePeerDataMediaUploadWamEvent","WAWebNonMessagePeerDataOperationResponseWamEvent","WAWebNonMessagePeerDataRequestWamEvent","WAWebProtobufsE2E.pb","WAWebWamEnumPeerDataRequestType","WAWebWebcLinkPreviewResponseHandleWamEvent","err"],(function(a,b,c,d,e,f,g){var h,i=new Map();function a(a,b,c){var e=void 0,f=d("WATimeUtils").unixTimeMs();if(a!=null){var g=i.get(a);g!=null&&(e=f-g)}d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["link preview: session id: ",", is success: ",", durationMs: ",""])),a,b,e);new(d("WAWebWebcLinkPreviewResponseHandleWamEvent").WebcLinkPreviewResponseHandleWamEvent)({previewSessionId:a,isPreviewSuccess:b,previewDurationMs:e!=null?e:void 0,didRespondHqPreview:c}).commit();a!=null&&i["delete"](a)}function b(a,b){var c=k(a);new(d("WAWebNonMessagePeerDataRequestWamEvent").NonMessagePeerDataRequestWamEvent)({peerDataRequestCount:j(a,b),peerDataRequestType:c,peerDataRequestSessionId:b.id.id}).commit()}function j(a,b){switch(a){case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:a=(a=b.peerDataOperationRequestMessage)==null?void 0:a.requestStickerReupload;return(a=a==null?void 0:a.length)!=null?a:0;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:a=(a=b.peerDataOperationRequestMessage)==null?void 0:a.requestStickerReupload;return(a=a==null?void 0:a.length)!=null?a:0;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:b=(a=b.peerDataOperationRequestMessage)==null?void 0:a.placeholderMessageResendRequest;return(a=b==null?void 0:b.length)!=null?a:0;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:return 1;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:return 1}}function k(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.UPLOAD_STICKER;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.SEND_RECENT_STICKER_BOOTSTRAP;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.GENERAL_LINK_PREVIEW;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.HISTORY_SYNC_ON_DEMAND;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.PLACEHOLDER_MESSAGE_RESEND;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.WAFFLE_LINKING_NONCE_FETCH;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:throw c("err")("full history sync on demand is not supported in web");case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:throw c("err")("companion meta nonce fetch is not supported in web");case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:throw c("err")("companion canonical user nonce fetch is not supported in web");case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.SYNCD_SNAPSHOT_RECOVERY;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:throw c("err")("history sync chunk retry is not supported in web");case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:return d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.UPLOAD_STICKER}}function e(a,b,c,e,f,g,h){a=k(a);new(d("WAWebNonMessagePeerDataOperationResponseWamEvent").NonMessagePeerDataOperationResponseWamEvent)({peerDataResponseCount:c,peerDataSuccessResponseCount:e,peerDataSuccessProcessCount:f,peerDataErrorCount:g,peerDataNotFoundCount:h,peerDataRequestType:a,peerDataRequestSessionId:b}).commit()}function f(a,b,c,e,f,g,h){if(a!==d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER)return;a=k(a);new(d("WAWebNonMessagePeerDataMediaUploadWamEvent").NonMessagePeerDataMediaUploadWamEvent)({peerDataRequestCount:c,peerDataSuccessUploadCount:e,peerDataExistingDataNoUploadCount:f,peerDataErrorCount:g,peerDataNotFoundCount:h,peerDataRequestType:a,peerDataRequestSessionId:b}).commit()}function l(a,b){new(d("WAWebNonMessagePeerDataOperationResponseWamEvent").NonMessagePeerDataOperationResponseWamEvent)({peerDataRequestType:d("WAWebWamEnumPeerDataRequestType").PEER_DATA_REQUEST_TYPE.HISTORY_SYNC_ON_DEMAND,peerDataResponseApplyResult:a,peerDataRequestSessionId:b}).commit()}function m(a,b,c,e,f,g){a=k(a);new(d("WAWebNonMessagePeerDataOperationResponseWamEvent").NonMessagePeerDataOperationResponseWamEvent)({peerDataResponseCount:e,peerDataSuccessResponseCount:f,peerDataErrorCount:g,peerDataResponseApplyResult:c,peerDataRequestType:a,peerDataRequestSessionId:b}).commit()}g.sendTimes=i;g.logLinkPreviewResponse=a;g.logNonMessagePeerDataRequest=b;g.logNonMessagePeerDataResponse=e;g.logMediaUpload=f;g.logHistorySyncOnDemandResponse=l;g.logPlaceholderMessageResendResponse=m}),98);
__d("WAWebCryptoMediaRetry",["WABinary","WACryptoAesGcm","WACryptoHkdf","WALogger","WAWebProtobufsMmsRetry.pb","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function i(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encodeServerErrorReceipt"]))).devConsole(a);var b=new(d("WABinary").Binary)();d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMmsRetry.pb").ServerErrorReceiptSpec,a,b);return b.readByteArrayView()}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield n(a));c=(c==null?void 0:c.slice())||o();var e=i({stanzaId:b});a=(yield d("WACryptoAesGcm").gcmEncrypt(a,c,e,b));return{ciphertext:a,iv:c}});return j.apply(this,arguments)}function c(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield n(a));a=(yield d("WACryptoAesGcm").gcmDecrypt(a,c,e,b));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMmsRetry.pb").MediaRetryNotificationSpec,a)});return k.apply(this,arguments)}var l=12,m="WhatsApp Media Retry Notification";function n(a){return d("WACryptoHkdf").extractAndExpand(a,m,32)}function o(){var a=new Uint8Array(l);self.crypto.getRandomValues(a);return a}g.encryptServerErrorReceipt=a;g.decryptMediaRetryNotification=c;g.ENC_IV_SIZE=l}),98);
__d("WAWebSendHistSyncServerErrorReceiptJob",["WABase64","WADeprecatedSendIq","WAWap","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCryptoMediaRetry","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;c=d("WABase64").decodeB64(c);c=(yield d("WAWebCryptoMediaRetry").encryptServerErrorReceipt(c,b));var f=c.ciphertext;c=c.iv;f=(e=d("WAWap")).wap("receipt",{type:"server-error",to:d("WAWebCommsWapMd").USER_JID(a),id:e.CUSTOM_STRING(b),category:"peer"},e.wap("encrypt",null,e.wap("enc_p",null,f),e.wap("enc_iv",null,c)));return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(f,d("WAWebCommsAckParser").toCoreAckTemplate({id:b,"class":"receipt",type:"server-error",from:a,participant:null}))});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WaWebDecodeProtobufThrottled",["Promise","WABaseProto","WABinary","WAProtoCompile","WAProtoConst","WAProtoValidate","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=new(d("WABinary").Binary)(b);b=(yield j(a,b,void 0,!1,!1,self.performance.now()));yield m();d("WAProtoValidate").checkRequirements(a,b);return b});return i.apply(this,arguments)}function j(a,b,c,d,e,f){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){var h=g;self.performance.now()-h>l&&(yield m(),h=self.performance.now());g=d("WAProtoCompile").compileSpec(a);var i=g.names,k=g.fields,n=g.types,o=g.meta,p=g.oneofToFields,q=g.fieldToOneof,r=g.reservedTags,s=g.reservedFields;g=a.internalDefaults;var t=c||babelHelpers["extends"]({},g)||{};t.$$unknownFieldCount=(a=c==null?void 0:c.$$unknownFieldCount)!=null?a:0;for(g=0;g<i.length;g++)n[g]&d("WAProtoConst").FLAGS.REPEATED?t[i[g]]=[]:n[g]===(d("WAProtoConst").TYPES.MAP&d("WAProtoConst").TYPE_MASK)&&(t[i[g]]=new Map());var u=0,v=k.length>0,w=k[0];c=function*(){var a=d("decodeProtobuf").readBoundVarInt(b,0,4294967296,"field and enc type",d("WABinary").parseInt64OrThrow),c=a&7;a=a>>>3;if(v&&a!==w){var g=u;do++u===k.length&&(u=0),w=k[u];while(a!==w&&u!==g)}if(v&&a===w){var l=i[u];g=n[u];d("decodeProtobuf").assertEncType(c,g,l);var m=g&d("WAProtoConst").TYPE_MASK,x=o[u];if(g&d("WAProtoConst").FLAGS.PACKED){var y=b.readVarInt(d("WABinary").parseUint64OrThrow);y=b.readBinary(y);while(y.size()){var z=d("decodeProtobuf").readValue(l,m,y);(m!==d("WAProtoConst").TYPES.ENUM||x[z]||(x.cast==null?void 0:x.cast(z))!==void 0)&&t[l].push(z)}}else if(m===d("WAProtoConst").TYPES.MESSAGE){z=b.readVarInt(d("WABinary").parseUint64OrThrow);y=b.readBinary(z);if(g&d("WAProtoConst").FLAGS.REPEATED)t[l].push(yield j(x,y,void 0,e,f,h));else{z=t[l];t[l]=(yield j(x,y,z,e,f,h))}}else if(m===d("WAProtoConst").TYPES.MAP){y=b.readVarInt(d("WABinary").parseUint64OrThrow);z=b.readBinary(y);var A,B;for(y=0;y<o[u].length;y++){var C=d("decodeProtobuf").readBoundVarInt(z,0,4294967296,"map field and enc type",d("WABinary").parseInt64OrThrow),D=C&7;C=C>>>3;var E=void 0;switch(D){case d("WAProtoConst").ENC.VARINT:E=z.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:E=z.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:D=x[y];if(D===d("WAProtoConst").TYPES.BYTES||D===d("WAProtoConst").TYPES.STRING)E=d("decodeProtobuf").readValue(l,D,z);else{var F=z.readVarInt(d("WABinary").parseUint64OrThrow);F=z.readBinary(F);E=(yield j(D,F,void 0,e,f,h))}break;case d("WAProtoConst").ENC.BIT32:E=z.readBinary(4);break}C===1?A=E:B=E}t[l].set(A,B)}else{D=d("decodeProtobuf").readValue(l,m,b);(m!==d("WAProtoConst").TYPES.ENUM||x[D]||(x.cast==null?void 0:x.cast(D))!==void 0)&&(g&d("WAProtoConst").FLAGS.REPEATED?t[l].push(D):t[l]=D)}F=q[l];F&&typeof t[l]!=="undefined"&&F.forEach(function(a){var b=p[a].filter(function(a){return a!==l});b.forEach(function(a){delete t[a]});if(f){t[a]=(b={type:l,value:t[l]},b[d("WABaseProto").TAGGED_UNION_TAG]=!0,b);delete t[l]}});(r[a]||s[l])&&delete t[l]}else{t.$$unknownFieldCount++;if(e){t.$$unsafeUnknownFields||(t.$$unsafeUnknownFields={});var G;switch(c){case d("WAProtoConst").ENC.VARINT:G=b.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:G=b.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:G=b.readBinary(b.readVarInt(d("WABinary").parseUint64OrThrow));break;case d("WAProtoConst").ENC.BIT32:G=b.readBinary(4);break}t.$$unsafeUnknownFields[a]=G}else c===d("WAProtoConst").ENC.VARINT?b.readVarInt(d("WABinary").parseInt64OrThrow):c===d("WAProtoConst").ENC.BIT64?b.advance(8):c===d("WAProtoConst").ENC.BINARY?b.advance(b.readVarInt(d("WABinary").parseUint64OrThrow)):c===d("WAProtoConst").ENC.BIT32&&b.advance(4)}};while(b.size())yield* c();return t});return k.apply(this,arguments)}var l=500;function m(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield new(h||(h=b("Promise")))(function(a){return self.setTimeout(a,0)})});return n.apply(this,arguments)}g.decodeProtobufThrottled=a}),98);
__d("WAWebHandleHistorySyncChunk",["Promise","WAAsyncSleep","WABinary","WAGzip","WALogger","WALongInt","WATimeUtils","WAWebABProps","WAWebAddonProcessMsgsUtils","WAWebApiChat","WAWebApiHistorySyncNotification","WAWebAppTracker","WAWebChatConstants","WAWebCmd","WAWebCurrentUser","WAWebDBCreateLidPnMappings","WAWebDBMessageUtils","WAWebDownloadManager","WAWebHandleHistorySyncMsg","WAWebHistoryMsgHandlerAction","WAWebHistorySyncDynamicThrottlingManager","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebHistorySyncWorkerCompatibleNotificationUtils","WAWebHttpErrors","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMetricsAttributionActions","WAWebMmsClient","WAWebMsgKey","WAWebNetworkStatus","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebNonMessageDataRequestLoggingUtils","WAWebProtobufsE2E.pb","WAWebProtobufsHistorySync.pb","WAWebSchemaMessage","WAWebSendHistSyncServerErrorReceiptJob","WAWebSendReceiptJobCommon","WAWebSetUsernameJob","WAWebSyncGatingUtils","WAWebUpdateLidMetadataApi","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","WAWebUsernameGatingUtils","WAWebWamEnumMdBootstrapStepResult","WAWebWamEnumPeerDataResponseApplyResultType","WAWebWidFactory","WaWebDecodeProtobufThrottled","asyncToGeneratorRuntime","decodeProtobuf","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,B,C,D,E,F,ka,la=10,ma=100;function na(a,b){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e===void 0&&(e=la);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleHistorySyncChunk started for ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync");if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP){var f=(yield d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete());if(f===!0){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Skip duplicate initial sync chunk ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync");return}}d("WAWebMetricsAttributionActions").startHistorySyncAttributionTracking(a.syncType);if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3)try{f=c("WAWebMsgKey").fromString(a.msgKey);void d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:f.remote,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:new Map().set(f.remote,[f.id])})}catch(a){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history_sync_notification_handler: sending Status receipt failed"]))).tags("history-sync").devConsole(a)}f=(yield d("WAWebHistorySyncNotificationUtils").getHistorySyncProgress(a));var g=d("WAWebHistorySyncNotificationUtils").maybeGetInlinePayload(a),h=(yield d("WAWebHistorySyncNotificationUtils").getHistorySyncMetrics(a,g==null)),B=h.historySyncStartDownloadingMetric,C=h.historySyncDownloadedMetric,D=h.historySyncDataAppliedMetric;void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING,a.chunkOrder);d("WAWebHistorySyncNotificationUtils").commitHistoryStartDownloadingMetric(B,a.historySyncStepStartedTs,d("WATimeUtils").unixTimeMs());h=null;if(g!=null)d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync] get inline payload in chunk, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync"),h=g;else try{d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start downloading chunk, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync"),h=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers["extends"]({signal:new AbortController().signal},a.downloadOptions)))}catch(b){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history sync download failed"]))).devConsole(b);d("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(a.syncType);if(b instanceof d("WAWebHttpErrors").HttpNetworkError){if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP&&e>0){yield c("WAWebNetworkStatus").waitIfOffline();d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Initial sync download failed due to network error retry download"]))).tags("history-sync");B=e-1;return na(a,B)}d("WAWebApiHistorySyncNotification").removeLocalFailureFromInFlightChunk(a.msgKey);return}g=c("WAWebMsgKey").fromString(a.msgKey);d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(C,a.historySyncStepStartedTs,!1,d("WATimeUtils").unixTimeMs());if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] history sync on demand chunk fails to download."])));d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure((e=a.peerDataRequestChatId)!=null?e:"");d("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.FAIL_TO_DOWNLOAD,(B=a.peerDataRequestSessionId)!=null?B:"")}c("WAWebSendHistSyncServerErrorReceiptJob")(g.remote,g.id,a.downloadOptions.mediaKey);yield d("WAWebApiHistorySyncNotification").markChunkForReuploadPending(a.msgKey);return}void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADED,a.chunkOrder);a.downloadOptions.mediaKey="";C.mdBootstrapStepResult=d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS;e=new(d("WABinary").Binary)(h);B=(yield d("WAGzip").inflate(e.readByteArrayView()));d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.HSProtobufParsing);d("WAWebABProps").getABPropConfigValue("web_anr_throttle_protobuf_decoding")?g=(yield d("WaWebDecodeProtobufThrottled").decodeProtobufThrottled(d("WAWebProtobufsHistorySync.pb").HistorySyncSpec,B)):g=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsHistorySync.pb").HistorySyncSpec,B);d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.HSProtobufParsing);var E=[];g.phoneNumberToLidMappings.forEach(function(a){var b=a.lidJid;a=a.pnJid;b!=null&&a!=null&&E.push({lid:d("WAWebWidFactory").createUserLidOrThrow(b),pn:d("WAWebWidFactory").createUserWidOrThrow(a)})});h={mappings:E,flushImmediately:!0,learningSource:"other"};a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP?yield d("WAWebDBCreateLidPnMappings").createLidPnMappings(h):yield d("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches(h);e=d("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(E);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["completed learning lid mappings for history sync. count: ",". ","..."])),e==null?void 0:e.size,d("WAWebHistorySyncNotificationUtils").getLidsForLogging(e)).verbose();B=new Map();void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DECODED,a.chunkOrder);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[history sync] chunk downloaded, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a,void 0,g.conversations.length));h=d("WATimeUtils").unixTimeMs();a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&a.chunkOrder!=null&&d("WAWebHistorySyncProgress").updateHistorySyncProgressModel();var F=function(b){void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:D,startTs:a.historySyncStepStartedTs,isSuccess:!1,forceFlushWamBuffer:!0,failureReason:b})};a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&g.statusV3Messages&&g.statusV3Messages.length>0?yield d("WAWebHistoryMsgHandlerAction").handleStatusMessages(g,a,C,D,h)["catch"](function(a){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing status messages failed: ",""])),a);F(""+a);throw a}):a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.NON_BLOCKING_DATA?yield d("WAWebHistoryMsgHandlerAction").handleNonBlockingData(g,a,C,D,h)["catch"](function(a){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing non blocking data failed: ",""])),a);F(""+a);throw a}):a.syncType!==d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME&&(g.conversations=g.conversations.reduce(function(a,b){var c=null;try{c=d("WAWebWidFactory").createWid(b.id)}catch(a){d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(['[history sync] handleHistorySyncChunk: failed to create wid from "','": ',""])),b.id,a).tags("history-sync")}return c?a.concat(b):a},[]));var G=[],H=[],ra=[];if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)yield d("WAWebHistoryMsgHandlerAction").handleInitialSyncMsgs(g,a,G,C,D,h,ra,E)["catch"](function(a){d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial sync messages failed: ",""])),a);F(""+a);throw a});else if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME)yield d("WAWebHistoryMsgHandlerAction").handlePushName(g,a,C,D,h)["catch"](function(a){d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial pushname failed: ",""])),a);F(""+a);throw a});else if(![d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.NON_BLOCKING_DATA].includes(a.syncType)){d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing non initial status messages"])));yield new(ka||(ka=b("Promise")))(function(a){return self.setTimeout(a,0)});if(!oa(a,g)){var I=[],J=new Set(),sa=[],K=[],L=new Set(),ta=[],M=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),N=0,ua=0,va=!1,wa=d("WAWebSyncGatingUtils").getRecentSyncMessageProcessingBreakIteration(),xa=(yield d("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced());(M==null||Object.keys(M).length===0)&&d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[history sync] boundary data is null or empty"])));for(var O=0;O<g.conversations.length;O++){var P=!1,Q=g.conversations[O],R=M==null?void 0:M[Q.id];if(R==null){d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat ","$ due to null entry in initial sync boundary"])),c("gkx")("26258")?"-":Q.id).tags("history-sync");var S=d("WAWebWidFactory").createWid(Q.id).toJid();(M==null?void 0:M[S])!=null&&d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[history sync] dropping chat "," due to null entry in initial sync boundary, but it exists as chatJid ",""])),c("gkx")("26258")?"-":Q.id,c("gkx")("26258")?"-":S).sendLogs("history-sync-unexpected-conversation-drop");P=!0}S=d("WAWebWidFactory").createWid(Q.id);S.isNewsletter()&&(d("WALogger").LOG(aa||(aa=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat ","$ due to chat is not enabled for sync"])),c("gkx")("26258")?"-":Q.id),P=!0);var T=(yield d("WAWebApiChat").getChatRecord(S)),U=(T==null?void 0:T.endOfHistoryTransferType)===d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;(!T&&R!=null||T&&T.endOfHistoryTransferType==null||U)&&(d("WALogger").LOG(ba||(ba=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping chat "," due to the chat in sync payload "," is already marked as complete locally"])),c("gkx")("26258")?"-":Q.id,d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync"),P=!0);if(!P){U=0;P=self.performance.now();for(var V=0;V<Q.messages.length;V++){var W,X;N++;var Y=d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.getThrottleRate();if(++U>=Y.batchSize&&d("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")){var Z=self.performance.now();Z=Z-P;d("WALogger").LOG(ca||(ca=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Observed process time ","ms, target process time ","ms, batch size ",""])),Z.toFixed(),d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.targetTimeMs.toFixed(),U).tags("history-sync");d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(Z,U);Y.delayMs>0&&(d("WALogger").LOG(da||(da=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Applying message throttling delay: ","ms"])),Y.delayMs.toFixed()).tags("history-sync"),yield d("WAAsyncSleep").asyncSleep(Y.delayMs));U=0;P=self.performance.now()}Z=Q.messages[V];Y=d("WALongInt").maybeNumberOrThrowIfTooLarge(Z.msgOrderId);if(R!=null&&R!==-1&&Y!=null&&Y>=R)continue;Y=(Z==null||(W=Z.message)==null||(W=W.message)==null||(W=W.protocolMessage)==null?void 0:W.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(Y===!0){d("WALogger").LOG(ea||(ea=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping request welcome message"])));continue}Y=(Z==null||(X=Z.message)==null||(X=X.message)==null||(X=X.protocolMessage)==null?void 0:X.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(Y){d("WALogger").LOG(fa||(fa=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));continue}L.add(Q.id);Y=d("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(S,Z.message,a,e,B);Y&&Y.id.remote.toString()!==Q.id&&L.add(Y.id.remote.toString());if(V===0&&Y&&T){var $=(yield d("WAWebSchemaMessage").getMessageTable().betweenCount(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(S),d("WAWebDBMessageUtils").endOfChat(S)));$===0&&ta.push(Y)}K=K.concat(d("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:Z.message,parsedWebMsgInfo:Y,isFromCag:($=Q.isDefaultSubgroup)!=null?$:!1}));Y!=null&&(($=Z.message)==null||($=$.commentMetadata)==null?void 0:$.commentParentKey)==null&&(J.has(Y.id.toString())&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&J["delete"](Y==null?void 0:Y.id.toString()),I.push(Y));if(Y!=null&&d("WAWebMessageAssociation.flow").isAssociatedMsg(Y)&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){Z=Y.parentMsgKey.toString();J.add(Z);sa.push(Y)}d("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")||(yield d("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(ua++,xa?wa:ma))}if(U>0){$=self.performance.now();Z=$-P;d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(Z,U)}}else a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&(va=!0)}C.mdBootstrapMessagesCount=N;C.mdBootstrapChatsCount=g.conversations.length;d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(C,a.historySyncStepStartedTs,!0,h);void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.MESSAGE_PREPROCESSED,a.chunkOrder);try{I.length!==0?yield d("WAWebHandleHistorySyncMsg").handleProgressiveHistorySyncMsgs(I,Array.from(L),K,ta,a.syncType,a.chunkOrder,sa,J):d("WALogger").LOG(ga||(ga=babelHelpers.taggedTemplateLiteralLoose(["[history sync] no messages from history sync need to handle"])));yield d("WAWebUserPrefsHistorySync").setLastHistorySyncedChunk(a.syncType,a.chunkOrder,f);d("WAWebHistorySyncProgress").updateHistorySyncProgressModel();yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(a.msgKey,a.syncType,a.chunkOrder);var ya=new Set();g.conversations.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.id);ya.add(b.toString());var c=(M==null?void 0:M[a.id])!=null,e=null;c&&(e=a.endOfHistoryTransferType);if(e!=null)return d("WAWebHistorySyncWorkerCompatibleNotificationUtils").updateEndOfHistorySync(b,e)});pa(a,g,va);d("WAWebCmd").Cmd.onHistorySyncChunkProcessed(ya);void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:D,startTs:a.historySyncStepStartedTs,isSuccess:!0});void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.APPLIED,a.chunkOrder);d("WALogger").LOG(ha||(ha=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing recent/full/on-demand chunk complete, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a,N,L.size))}catch(a){d("WALogger").LOG(ia||(ia=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing recent/full/on-demand chunk failed: ",""])),a);F(String(a));throw a}}}Y=c("WAWebMsgKey").fromString(a.msgKey);S=new Map();S.set(Y.remote,[Y.id]);a.syncType!==d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&void d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:Y.remote,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:S});yield d("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:H,flushImmediately:!0,learningSource:"other"});yield d("WAWebUpdateLidMetadataApi").updateLidMetadata({updates:G});d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(yield d("WAWebSetUsernameJob").setUsernamesJob(ra));yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(a.msgKey,a.syncType,a.chunkOrder);a.downloadOptions.encFilehash!=null&&c("WAWebMmsClient").deleteMdHistorySyncBlob({directPath:a.downloadOptions.directPath,encFilehash:a.downloadOptions.encFilehash,signal:new AbortController().signal,encHandle:a.encHandle,companionUserSecret:d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAWebCompanionMetaNonce")})["catch"](function(a){d("WALogger").WARN(ja||(ja=babelHelpers.taggedTemplateLiteralLoose(["MMS client delete error"]))).devConsole(a)});T=g.conversations.length===1?g.conversations[0].id:null;yield qa(a.syncType,g.progress,T);d("WAWebHistorySyncNotificationUtils").reportMissingMapping(B)});return G.apply(this,arguments)}function oa(a,b){if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&b.conversations.length!==1){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] dropping history sync on demand response as its conversation length "," is not 1."])),c("gkx")("26258")?"":b.conversations.length);d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure((b=a.peerDataRequestChatId)!=null?b:"");d("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.INVALID_RESPONSE,(b=a.peerDataRequestSessionId)!=null?b:"");return!0}return!1}function pa(a,b,c){if(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&b.conversations.length===1){d("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(a.syncType);b=b.conversations[0].id;!c?d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandSuccess(b):d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure(b);d("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(c?d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.OTHER_ERROR:d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.SUCCESS,(b=a.peerDataRequestSessionId)!=null?b:"")}}function qa(a,b,c){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled();(b===100||a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)&&d("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(a);if(a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP)d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Initial bootstrap history sync complete"]))).tags("history-sync"),yield d("WAWebUserPrefsHistorySync").setInitialHistorySyncComplete(),yield d("WAWebUserPrefsHistorySync").setHistorySyncStatus({initialCompleted:!0}),d("WAWebCmd").Cmd.onInitialChatHistorySynced();else if(a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&b===100)d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Recent history sync complete"]))).tags("history-sync"),yield d("WAWebUserPrefsHistorySync").setHistorySyncStatus({recentCompleted:!0}),d("WAWebCmd").Cmd.onRecentChatHistorySynced();else if(a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL&&b===100)d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Full history sync complete"]))).tags("history-sync"),f||(d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set history initial sync boundary to empty"]))),void d("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary({})),yield d("WAWebUserPrefsHistorySync").setHistorySyncStatus({fullCompleted:!0}),d("WAWebCmd").Cmd.onFullChatHistorySynced();else if(f&&a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&b===100){d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[history sync] On demand history sync complete for chat ",""])),c("gkx")("26258")?"-":e).tags("history-sync");f="onDemandCompleted_"+(e!=null?e:"");yield d("WAWebUserPrefsHistorySync").setHistorySyncStatus((a={},a[f]=!0,a))}});return H.apply(this,arguments)}g.handleHistorySyncChunk=na}),98);
__d("WAWebDBProcessRecentAndFullHistorySyncMessage",["WALogger","WATimeUtils","WAWebABProps","WAWebApiChat","WAWebApiFilterAndReplaceMessages","WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebMessageAssociationGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebProcessMessageAssociationMessages","WAWebRunInBatches","WAWebRuntimeEnvironmentUtils","WAWebSchemaChat","WAWebSyncGatingUtils","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=1e3,r=1e3;function a(a,b,c,d,e,f){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){var k=a,l;if(f.length&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){f=d("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache(f,g);if((g=f)!=null&&g.validAssociatedMsgs){l=d("WAWebApiFilterAndReplaceMessages").validateMsgFn((g=f)==null?void 0:g.validAssociatedMsgs)}}try{f=(yield d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages(a,l));g=f.newMsgs;k=g}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["filterAndReplaceMessages failed with error ",""])),a).tags("history-sync")}var m=new Map();k.forEach(function(a){a.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(a.id.toString(),{id:a.id.toString(),from:a.from.toString(),to:a.to.toString(),groupId:a.inviteGrp,expiration:parseInt(a.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(a.inviteCodeExp,10)});var b=a.id.remote.toString();if(d("WAWebMsgGetters").getIsImportantMessage(a))if(m.has(b)){var c;(c=m.get(b))==null||c.push(a)}else m.set(b,[a])});a=d("WAWebSyncGatingUtils").isRecentSyncWorkerComaptibleHandlingEnabled()||d("WAWebSyncGatingUtils").isRecentSyncChunkDataHandlingInWorkerEnabled();f=a&&d("WAWebRuntimeEnvironmentUtils").isWorker()?yield v(m):yield d("WAWebBackendApi").frontendSendAndReceive("processAndGetUnreadMentionsInfo",{filteredMsgs:k});g=f.unreadMentionsToAdd;f=f.pendingUnreadMentionsMap;d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] recent or full or on demand sync starts encrypting "," messages"])),k.length);k=(yield d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(k,!0));void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(c,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.ENCRYPTED,e);d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] recent or full sync or on demand starts storing "," encrypted messages"])),k.length);yield t(k,b,g,f,a)});return s.apply(this,arguments)}function t(a,b,c,d,e){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){try{d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedRecentAndFullSyncMsgs: storing "," messages: start"])),a.length);if(d("WAWebABProps").getABPropConfigValue("web_anr_throttle_history_sync_db_writes"))try{yield d("WAWebRunInBatches").runInBatches(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: start"])),a.length),yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(a,c,!0),d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: done"])),a.length)});return function(b){return a.apply(this,arguments)}}(),{batchSize:q,delayMs:r})}catch(b){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to store "," in batches: ",""])),a.length,b).sendLogs("failed-to-store-encrypted-db-messages-in-batches");throw b}else yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(a,c,!0);d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedRecentAndFullSyncMsgs: storing "," messages: done"])),a.length);if(e.size>0){g=g&&d("WAWebRuntimeEnvironmentUtils").isWorker()?yield x(e,f):yield d("WAWebBackendApi").frontendSendAndReceive("getChatIdsNeedToBeDeletedFromUnreadMentionInfo",{unreadMentionsToAdd:e,pendingUnreadMentionsMap:f});g.forEach(function(a){e["delete"](a)});e.size>0&&void d("WAWebApiChat").addUnreadMentionChat(e,f)}}catch(b){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] error storing "," recent or full sync messages: ",""])),a.length,b)}});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map(),c=new Map(),e=Array.from(a.keys()),f=(yield d("WAWebSchemaChat").getChatTable().bulkGet(e)).reduce(function(a,b){b&&b.id&&a.set(b.id,b);return a},new Map());a.forEach(function(a,d){var e=f.get(d);a.forEach(function(a){var f=0;if(!c.has(d)){var g;f=(g=e==null?void 0:e.unreadMentionCount)!=null?g:0;c.set(d,f)}else{f=(g=c.get(d))!=null?g:0}if(f>0){c.set(d,f-1);g={id:a.id.toString(),timestamp:a.t};if(b.has(d)){(f=b.get(d))==null||f.push(g)}else b.set(d,[g])}})});return{unreadMentionsToAdd:b,pendingUnreadMentionsMap:c}});return w.apply(this,arguments)}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=Array.from(a.keys()),e=(yield d("WAWebSchemaChat").getChatTable().bulkGet(c)).reduce(function(a,b){b&&b.id&&a.set(b.id,b);return a},new Map()),f=[];a.forEach(function(a,c){var g,h=e.get(c);g=(g=b.get(c))!=null?g:0;if((h==null?void 0:h.unreadMentionCount)===0){f.push(c);return}(h==null?void 0:h.unreadMentionCount)!=null&&(h==null?void 0:h.unreadMentionCount)>0&&d("WAWebBackendApi").frontendFireAndForget("updateUnreadMentionMetadataByAdding",{chatId:c,newUnreadMentions:a,pendingUnreadMentionCount:g})});return f});return y.apply(this,arguments)}g.storeRecentAndFullHistSyncMessages=a}),98);
__d("WAWebHandleHistorySyncMsg",["Promise","WAFilteredCatch","WALogger","WAWebAddonProcessMsgs","WAWebBackendErrors","WAWebCheckUpdateOrphanReactions","WAWebDBProcessRecentAndFullHistorySyncMessage","WAWebNoop","WAWebSyncdOrphan","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,d,e,f,g,h){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k,l,m,n){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] starts handling recent/full/on-demand sync progressive history messages"])));yield (j||(j=b("Promise"))).resolve();return d("WAWebDBProcessRecentAndFullHistorySyncMessage").storeRecentAndFullHistSyncMessages(a,e,k,l,m,n).then(function(){var b=e.map(function(a){return a}),c=a.map(function(a){return a.id.toString()});d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(c);return d("WAWebSyncdOrphan").checkOrphanMutations(c,b)}).then(function(){return(j||(j=b("Promise"))).all(f).then(function(a){var b;return d("WAWebAddonProcessMsgs").processHistoryMsgs((b=[]).concat.apply(b,a))})}).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){for(var a of g){if(!a||!a.id||!a.id.remote)return;var b=a.id.remote;if(b.isNewsletter())return;yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("processLastMsgs",{chatId:b,msgObjs:[a],meta:{add:"last",isHistory:!0},processMessagesOrigin:"historyMsgHandlerAction",chatMsgsCollection:null})}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").LogoutDrop,c("WAWebNoop")))["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error: ",", message: ",", stack: ",""])),a.name,a.message,a.stack).devConsole(a).sendLogs("handleProgressiveHistorySyncMsgs: error storing/processing multiple messages")})});return k.apply(this,arguments)}g.handleProgressiveHistorySyncMsgs=a}),98);
__d("WAWebHandleWorkerCompatibleRecentSyncChunk",["Promise","WABinary","WAGzip","WALogger","WATimeUtils","WAWebApiHistorySyncNotification","WAWebCmd","WAWebDBCreateLidPnMappings","WAWebDownloadManager","WAWebHandleHistorySyncMsg","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebHistorySyncWorkerCompatibleNotificationUtils","WAWebHttpErrors","WAWebMetricsAttributionActions","WAWebMmsClient","WAWebMsgKey","WAWebPreprocessHistorySyncProto","WAWebProtobufsHistorySync.pb","WAWebSendHistSyncServerErrorReceiptJob","WAWebSendReceiptJobCommon","WAWebSetUsernameJob","WAWebSyncGatingUtils","WAWebUpdateLidMetadataApi","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;function a(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] handleHistorySyncChunk started for ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync");d("WAWebMetricsAttributionActions").startHistorySyncAttributionTracking(a.syncType);var e=(yield d("WAWebHistorySyncNotificationUtils").getHistorySyncProgress(a)),f=d("WAWebSyncGatingUtils").isRecentSyncDownloadOptimizationEnabled(),g=f?a.downloadedHistorySyncPayload:null,w=(yield d("WAWebHistorySyncNotificationUtils").getHistorySyncMetrics(a,!0)),x=w.historySyncStartDownloadingMetric,y=w.historySyncDownloadedMetric;w=w.historySyncDataAppliedMetric;var z=null;if(g!=null)d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] get downloaded payload in chunk, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync"),z=g;else{void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADING,a.chunkOrder);d("WAWebHistorySyncNotificationUtils").commitHistoryStartDownloadingMetric(x,a.historySyncStepStartedTs,d("WATimeUtils").unixTimeMs());try{d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] start downloading chunk, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a)).tags("history-sync"),z=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers["extends"]({signal:new AbortController().signal},a.downloadOptions)))}catch(b){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] history sync download failed"]))).devConsole(b);d("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(a.syncType);if(b instanceof d("WAWebHttpErrors").HttpNetworkError){d("WAWebApiHistorySyncNotification").removeLocalFailureFromInFlightChunk(a.msgKey);return}g=c("WAWebMsgKey").fromString(a.msgKey);d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(y,a.historySyncStepStartedTs,!1,d("WATimeUtils").unixTimeMs());void c("WAWebSendHistSyncServerErrorReceiptJob")(g.remote,g.id,a.downloadOptions.mediaKey);yield d("WAWebApiHistorySyncNotification").markChunkForReuploadPending(a.msgKey);return}void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DOWNLOADED,a.chunkOrder);a.downloadOptions.mediaKey="";d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] chunk downloaded, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a))}x=new(d("WABinary").Binary)(z);g=(yield d("WAGzip").inflate(x.readByteArrayView()));z=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsHistorySync.pb").HistorySyncSpec,g);var A=[];z.phoneNumberToLidMappings.forEach(function(a){var b=a.lidJid;a=a.pnJid;b!=null&&a!=null&&A.push({lid:d("WAWebWidFactory").createUserLidOrThrow(b),pn:d("WAWebWidFactory").createUserWidOrThrow(a)})});yield d("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:A,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"});d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] learned "," mappings"])),A.length);void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.DECODED,a.chunkOrder);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] chunk decoded, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a,void 0,z.conversations.length));x=d("WATimeUtils").unixTimeMs();a.chunkOrder!=null&&void d("WAWebHistorySyncProgress").updateHistorySyncProgressModel();z.conversations=z.conversations.reduce(function(a,b){var c=null;try{c=d("WAWebWidFactory").createWid(b.id)}catch(a){d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(['[history sync][recent sync] handleWorkerCompatibleRecentSyncChunk: failed to create wid from "','": ',""])),b.id,a).tags("history-sync")}return c?a.concat(b):a},[]);g=[];var B=[],C=[];try{d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] start processing recent sync messages"])));yield new(v||(v=b("Promise")))(function(a){return self.setTimeout(a,0)});var D=(yield d("WAWebPreprocessHistorySyncProto").preprocessHistorySyncProto(z,A)),E=D.recentOrFullSyncMsgs,F=D.chatsWithRecentOrFullSyncMsgs,G=D.unifiedAddons,H=D.lastMsgs,I=D.totalChunkMsgCount,J=D.associatedMsgs;D=D.missingParentsCache;f||(y.mdBootstrapMessagesCount=I,y.mdBootstrapChatsCount=z.conversations.length,d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(y,a.historySyncStepStartedTs,!0,x));void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.MESSAGE_PREPROCESSED,a.chunkOrder);E.length!==0?yield d("WAWebHandleHistorySyncMsg").handleProgressiveHistorySyncMsgs(E,Array.from(F),G,H,a.syncType,a.chunkOrder,J,D):d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] no messages from history sync need to handle"])));void d("WAWebUserPrefsHistorySync").setHistorySyncTotalProcessedMessageCount(I);yield d("WAWebUserPrefsHistorySync").setLastHistorySyncedChunk(a.syncType,a.chunkOrder,e);void d("WAWebHistorySyncProgress").updateHistorySyncProgressModel();yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(a.msgKey,a.syncType,a.chunkOrder);var K=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),L=new Set();z.conversations.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.id);L.add(b.toString());var c=(K==null?void 0:K[a.id])!=null;if(c){c=a.endOfHistoryTransferType;if(c!=null)return d("WAWebHistorySyncWorkerCompatibleNotificationUtils").updateEndOfHistorySync(b,c)}});d("WAWebCmd").Cmd.onHistorySyncChunkProcessed(L);void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:w,startTs:a.historySyncStepStartedTs,isSuccess:!0});void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.APPLIED,a.chunkOrder);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] storing recent chunk complete, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(a,I,F.length))}catch(b){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] handleWorkerCompatibleRecentSyncChunk failed with error ",""])),b);void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:w,startTs:a.historySyncStepStartedTs,isSuccess:!1,forceFlushWamBuffer:!0,failureReason:String(b)});throw b}f=c("WAWebMsgKey").fromString(a.msgKey);y=new Map();y.set(f.remote,[f.id]);a.syncType!==d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3&&void d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:f.remote,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.HISTORY_SYNC_COMPLETION,groupedReceipt:y});yield d("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:B,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"});yield d("WAWebUpdateLidMetadataApi").updateLidMetadata({updates:g});d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(yield d("WAWebSetUsernameJob").setUsernamesJob(C));yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(a.msgKey,a.syncType,a.chunkOrder);a.downloadOptions.encFilehash!=null&&c("WAWebMmsClient").deleteMdHistorySyncBlob({directPath:a.downloadOptions.directPath,encFilehash:a.downloadOptions.encFilehash,signal:new AbortController().signal,encHandle:a.encHandle,companionUserSecret:d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAWebCompanionMetaNonce")})["catch"](function(a){d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["MMS client delete error"]))).devConsole(a)});e===100&&(d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Recent history sync complete"]))).tags("history-sync"),d("WAWebMetricsAttributionActions").stopHistorySyncAttributionTracking(a.syncType),yield d("WAWebUserPrefsHistorySync").setHistorySyncStatus({recentCompleted:!0}),d("WAWebCmd").Cmd.onRecentChatHistorySynced())});return w.apply(this,arguments)}g.handleWorkerCompatibleRecentSyncChunk=a}),98);
__d("WAWebPreprocessHistorySyncProto",["WAAsyncSleep","WALogger","WALongInt","WAWebABProps","WAWebAddonProcessMsgsUtils","WAWebApiChat","WAWebChatConstants","WAWebCurrentUser","WAWebDBMessageUtils","WAWebHistorySyncDynamicThrottlingManager","WAWebHistorySyncNotificationUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebProtobufsE2E.pb","WAWebSchemaMessage","WAWebSyncGatingUtils","WAWebUserPrefsAppStateSync","WAWebUserPrefsHistorySync","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=100;function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(b);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["first lid mappings for recent sync preprocess: ","..."])),d("WAWebHistorySyncNotificationUtils").getLidsForLogging(b)).verbose();var e=new Map(),f=[],g=[],r=new Set(),s=[],t=new Set(),u=[],v=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary(),w=0,x=0,y=d("WAWebSyncGatingUtils").getRecentSyncMessageProcessingBreakIteration(),z=(yield d("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced()),A=self.performance.now(),B=0;(v==null||Object.keys(v).length===0)&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] boundary data is null or empty"])));for(var C=0;C<a.conversations.length;C++){var D=!1,E=a.conversations[C],F=v==null?void 0:v[E.id];if(F==null){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping chat ","$ due to null entry in initial sync boundary"])),c("gkx")("26258")?"-":E.id).tags("history-sync");var G=d("WAWebWidFactory").createWid(E.id).toJid();(v==null?void 0:v[G])!=null&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] dropping chat "," due to null entry in initial sync boundary, but it exists as chatJid ",""])),c("gkx")("26258")?"-":E.id,c("gkx")("26258")?"-":G).sendLogs("history-sync-unexpected-conversation-drop");D=!0}G=d("WAWebWidFactory").createWid(E.id);G.isNewsletter()&&(d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping chat ","$ due to chat is not enabled for sync"])),c("gkx")("26258")?"-":E.id),D=!0);var H=(yield d("WAWebApiChat").getChatRecord(G)),I=(H==null?void 0:H.endOfHistoryTransferType)===d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;(!H&&F!=null||H&&H.endOfHistoryTransferType==null||I)&&(D=!0);if(!D)for(I=0;I<E.messages.length;I++){var J,K;w++;D=E.messages[I];var L=d("WALongInt").maybeNumberOrThrowIfTooLarge(D.msgOrderId);if(F!=null&&F!==-1&&L!=null&&L>=F)continue;L=(D==null||(J=D.message)==null||(J=J.message)==null||(J=J.protocolMessage)==null?void 0:J.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(L===!0){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync][recent sync] Dropping request welcome message"])));continue}L=(D==null||(K=D.message)==null||(K=K.message)==null||(K=K.protocolMessage)==null?void 0:K.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(L){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));continue}t.add(E.id);L=d("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(G,D.message,void 0,b,e);L&&L.id.remote.toString()!==E.id&&t.add(L.id.remote.toString());if(I===0&&L&&H){var M=(yield d("WAWebSchemaMessage").getMessageTable().betweenCount(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(G),d("WAWebDBMessageUtils").endOfChat(G)));M===0&&u.push(L)}s=s.concat(d("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:D.message,parsedWebMsgInfo:L,isFromCag:(M=E.isDefaultSubgroup)!=null?M:!1}));L!=null&&((M=D.message)==null||(M=M.commentMetadata)==null?void 0:M.commentParentKey)==null&&(r.has(L.id.toString())&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&r["delete"](L==null?void 0:L.id.toString()),f.push(L));if(L!=null&&d("WAWebMessageAssociation.flow").isAssociatedMsg(L)&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){D=L.parentMsgKey.toString();r.add(D);g.push(L)}if(d("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")){B++;M=d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.getThrottleRate();if(B>=M.batchSize){D=self.performance.now()-A;d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Observed process time ","ms, target process time ","ms, batch size ",""])),D.toFixed(),d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.targetTimeMs.toFixed(),B).tags("history-sync");d("WAWebHistorySyncDynamicThrottlingManager").historySyncDynamicThrottlingManager.setLastProcessTime(D,B);M.delayMs>0&&(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Applying message throttling delay: ","ms"])),M.delayMs.toFixed()).tags("history-sync"),yield d("WAAsyncSleep").asyncSleep(M.delayMs));B=0;A=self.performance.now()}}else yield d("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(x++,z?y:q)}}d("WAWebHistorySyncNotificationUtils").reportMissingMapping(e);return{recentOrFullSyncMsgs:f,chatsWithRecentOrFullSyncMsgs:Array.from(t),unifiedAddons:s,lastMsgs:u,totalChunkMsgCount:w,associatedMsgs:g,missingParentsCache:r}});return r.apply(this,arguments)}g.preprocessHistorySyncProto=a}),98);
__d("WAWebGetMetricHistorySyncPayloadType",["WAWebWamEnumMdBootstrapHistoryPayloadType"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case 0:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.INITIAL;case 1:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.STATUS_V3;case 2:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.FULL_HISTORY;case 3:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.RECENT_HISTORY;case 4:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.PUSHNAME;case 5:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.NON_BLOCKING_DATA;case 6:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.ON_DEMAND;default:return d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE.PUSHNAME}}g.getMetricHistorySyncPayloadType=a}),98);
__d("WAWebMdBootstrapHistoryDataDownloadedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapStepResult"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdBootstrapHistoryDataDownloaded:[2296,{appContext:[18,a.TYPES.STRING],appContextBitfield:[19,a.TYPES.INTEGER],applicationState:[17,d("WAWebWamEnumApplicationState").APPLICATION_STATE],historySyncChunkOrder:[15,a.TYPES.INTEGER],historySyncRetryRequestId:[20,a.TYPES.STRING],historySyncStageProgress:[14,a.TYPES.INTEGER],mdBootstrapChatsCount:[6,a.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[13,d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapMessagesCount:[5,a.TYPES.INTEGER],mdBootstrapPayloadSize:[4,a.TYPES.INTEGER],mdBootstrapPayloadThumbnailsSize:[21,a.TYPES.INTEGER],mdBootstrapPayloadType:[2,d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapStepDuration:[7,a.TYPES.INTEGER],mdBootstrapStepResult:[8,d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT],mdHsOldestMessageTimestamp:[11,a.TYPES.INTEGER],mdRegAttemptId:[12,a.TYPES.STRING],mdSessionId:[1,a.TYPES.STRING],mdStorageQuotaBytes:[9,a.TYPES.INTEGER],mdStorageQuotaUsedBytes:[10,a.TYPES.INTEGER],mdSyncFailureReason:[16,a.TYPES.STRING],mdTimestamp:[3,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapHistoryDataDownloaded:[]});g.MdBootstrapHistoryDataDownloadedWamEvent=b}),98);
__d("WAWebMdBootstrapHistoryDataStartDownloadingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMdBootstrapHistoryPayloadType","WAWebWamEnumMdBootstrapPayloadType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdBootstrapHistoryDataStartDownloading:[4650,{historySyncChunkOrder:[1,a.TYPES.INTEGER],historySyncRetryRequestId:[9,a.TYPES.STRING],historySyncStageProgress:[2,a.TYPES.INTEGER],mdBootstrapHistoryPayloadType:[3,d("WAWebWamEnumMdBootstrapHistoryPayloadType").MD_BOOTSTRAP_HISTORY_PAYLOAD_TYPE],mdBootstrapPayloadSize:[4,a.TYPES.INTEGER],mdBootstrapPayloadType:[5,d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdBootstrapStepDuration:[6,a.TYPES.INTEGER],mdSessionId:[7,a.TYPES.STRING],mdTimestamp:[8,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapHistoryDataStartDownloading:[]});g.MdBootstrapHistoryDataStartDownloadingWamEvent=b}),98);
__d("WAWebHistorySyncNotificationUtils",["$InternalEnum","Promise","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebApiHistorySyncNotification","WAWebChatCollection","WAWebChatThreadLogging","WAWebCurrentUser","WAWebDBGroupParticipant","WAWebDBGroupsGroupMetadata","WAWebEphemeralityUtils","WAWebGetMetricHistorySyncPayloadType","WAWebGroupMetadataCollection","WAWebGroupParticipantModel","WAWebGroupParticipantsJob","WAWebLeaveReasonType","WAWebMdBootstrapDataAppliedWamEvent","WAWebMdBootstrapHistoryDataDownloadedWamEvent","WAWebMdBootstrapHistoryDataStartDownloadingWamEvent","WAWebParseWebMessageInfoApi","WAWebProtobufsHistorySync.pb","WAWebSchemaHistorySyncNotification","WAWebSignalProtocolStore","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsHistorySync","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebWamEnumMdBootstrapPayloadType","WAWebWamEnumMdBootstrapSource","WAWebWamEnumMdBootstrapStepResult","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=b("$InternalEnum").Mirrored(["NewRecentSyncNotification","NewOnDemandSyncNotification","LastProcessedNotification","InitialSyncComplete","BackendStart","HistorySyncStatusCheck","ManualRestart"]);function a(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.pastParticipants.map(function(a){return{groupId:c("WANullthrows")(a.groupJid),pastParticipants:a.pastParticipants.map(function(a){return{id:d("WAWebWidFactory").createWid(c("WANullthrows")(a.userJid)),leaveReason:a.leaveReason===d("WAWebProtobufsHistorySync.pb").PastParticipant$LeaveReason.LEFT?d("WAWebLeaveReasonType").LeaveReason.Left:d("WAWebLeaveReasonType").LeaveReason.Removed,leaveTs:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(a.leaveTs))}})}});yield d("WAWebDBGroupParticipant").addPastParticipants(a);a.forEach(function(a){var b=d("WAWebChatCollection").ChatCollection.gadd(d("WAWebWidFactory").createWid(a.groupId));b=b.groupMetadata;b==null||b.pastParticipants.add(a.pastParticipants,{merge:!0})});d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Past Participants completed, ",""])),E(b))});return D.apply(this,arguments)}function E(a,b,c){var d;if(a==null)return"";var e=(a.msgKey||"").split("_")[2],f=F(a.syncType,a.chunkOrder,a.isReupload);a=(d=(d=a.downloadOptions.filehash)==null?void 0:d.slice(0,10))!=null?d:(d=a.filehash)==null?void 0:d.slice(0,10);return" "+f+", id: "+e+" ## msgCount: "+(b!=null?b:"-")+", ## chatCount: "+(c!=null?c:"-")+", ## downloadStr: "+(a!=null?a:"")+" "}function F(a,b,c){return"type_"+(a!=null?a:"none")+"_order_"+(b!=null?b:"none")+"_isReupload_"+(c||0)}function e(a,b,e,f,g){var j=null;try{b!=null&&(j=d("WAWebParseWebMessageInfoApi").parseWebMessageInfo(b)),Y(b,f,g,j)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMessageInfo failed with error "," "," and stack ",""])),a==null?void 0:a.name,a==null?void 0:a.code,a==null?void 0:a.stack),c("gkx")("26258")||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMessageInfo failed on msg key ",", msg type: "," in chunk ",""])),b==null?void 0:b.key.id,b==null?void 0:b.messageStubType,E(e)).sendLogs("parseWebMessageInfo failed during history sync")}if(G(a,j))return;return j}function G(a,b){if(b==null)return!1;var c=a.isUser()&&!a.isLid();if(!c)return!1;c=(c=b.id)==null?void 0:c.remote;c=c!=null&&c.isLid();if(c){if(d("WAWebCurrentUser").isEmployee()){var e;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] msg invalid because chat id is PN and msgKey.remote is lid. chatId: ",", msg key: ",""])),a,(e=b.id)==null?void 0:e.toString())}d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] msg invalid because chat id is PN and msgKey.remote is lid"]))).sendLogs("history-sync-invalid-msg").devConsole(a,b.id.remote)}return c}function f(a,b){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().loadIdentityKey(a));a!=null&&a!==b&&d("WALogger").ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[history sync] get changed self identity key from history sync,\n     existing length: ",", new length: ",""])),a.length,b.length).tags("history-sync").sendLogs("self-identity-change-from-history-sync")});return H.apply(this,arguments)}function I(a,b){var e;if(!b.isGroup())return;e=(e=a.disappearingMode)==null?void 0:e.trigger;var f;if(e!=null){e=d("WAWebEphemeralityUtils").getDisappearingModeTriggerFromProtobuf(e);e!=null&&(f=e)}if(a.suspended!=null||a.terminated!=null||a.createdBy!=null||a.createdAt!=null||a.description!=null||a.support!=null||a.isParentGroup!=null||a.isDefaultSubgroup!=null||a.parentGroupId!=null||a.disappearingMode!=null){var g;e={id:b,subject:a.name,suspended:a.suspended,terminated:a.terminated,owner:a.createdBy!=null?d("WAWebWidFactory").createWid(a.createdBy):void 0,creation:a.createdAt,desc:a.description,support:a.support,isParentGroup:a.isParentGroup,defaultSubgroup:a.isDefaultSubgroup,parentGroup:a.parentGroupId!=null?d("WAWebWidFactory").createWid(a.parentGroupId):void 0,disappearingModeInitiatedByMe:(e=a.disappearingMode)==null?void 0:e.initiatedByMe,disappearingModeTrigger:f};d("WAWebDBGroupsGroupMetadata").persistGroupMetadata(b,babelHelpers["extends"]({},e,{id:e.id.toString(),owner:e.owner!==void 0?e.owner.toString():void 0,creation:e.creation!==void 0?Number(e.creation):void 0,parentGroup:e.parentGroup!==void 0?String(e.parentGroup):void 0}));e=c("WAWebGroupMetadataCollection").add(babelHelpers["extends"]({},e),{merge:!0})[0];g=(g=a.participant)==null?void 0:g.map(function(a){var b=a.rank===d("WAWebProtobufsHistorySync.pb").GroupParticipant$Rank.SUPERADMIN,e=a.rank===d("WAWebProtobufsHistorySync.pb").GroupParticipant$Rank.ADMIN;return new(c("WAWebGroupParticipantModel"))({id:d("WAWebWidFactory").createWid(a.userJid),isAdmin:e||b,isSuperAdmin:b})});e==null||e.participants.add(g,{merge:!0});(a.readOnly===!0||g.length>0)&&d("WAWebGroupParticipantsJob").updateParticipantsJob({group:b,participants:g.map(function(a){return{id:a.id,isAdmin:a.isAdmin,isSuperAdmin:a.isSuperAdmin}}),skipDeviceSync:a.readOnly})["catch"](function(a){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsJob: failed: ",""])),a)})}}function J(a){var c=(B||(B=b("Promise"))).resolve(),e=B.resolve();a.threadIdUserSecret!=null?c=d("WAWebChatThreadLogging").setThreadIdUserSecret(a.threadIdUserSecret):d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleChatThreadLoggingMetadata: missing threadIdUserSecret"]))).sendLogs("ctl-missing-secret-history-sync");a.threadDsTimeframeOffset!=null?e=d("WAWebChatThreadLogging").setThreadDsTimeframeOffset(a.threadDsTimeframeOffset):d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleChatThreadLoggingMetadata: missing threadDsTimeframeOffset"]))).sendLogs("ctl-missing-offset-history-sync");return B.all([c,e])}function K(a,b){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP?d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.CRITICAL:d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE.NON_CRITICAL,e=d("WAWebGetMetricHistorySyncPayloadType").getMetricHistorySyncPayloadType(a.syncType),f=(yield d("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId()),g=(yield Q(a)),h=new(d("WAWebMdBootstrapHistoryDataStartDownloadingWamEvent").MdBootstrapHistoryDataStartDownloadingWamEvent)({mdBootstrapPayloadType:c,mdBootstrapPayloadSize:a.historySyncPayloadSize,mdBootstrapHistoryPayloadType:e,mdSessionId:f,historySyncStageProgress:g}),i=new(d("WAWebMdBootstrapHistoryDataDownloadedWamEvent").MdBootstrapHistoryDataDownloadedWamEvent)({mdBootstrapPayloadType:c,mdBootstrapPayloadSize:a.historySyncPayloadSize,mdBootstrapHistoryPayloadType:e,mdSessionId:f,historySyncStageProgress:g});c=new(d("WAWebMdBootstrapDataAppliedWamEvent").MdBootstrapDataAppliedWamEvent)({mdBootstrapPayloadType:c,mdBootstrapSource:d("WAWebWamEnumMdBootstrapSource").MD_BOOTSTRAP_SOURCE.HISTORY,mdBootstrapHistoryPayloadType:e,mdSessionId:f,sentViaMms:b,historySyncStageProgress:g});a.chunkOrder!=null&&(h.historySyncChunkOrder=a.chunkOrder,i.historySyncChunkOrder=a.chunkOrder,c.historySyncChunkOrder=a.chunkOrder);e=(yield d("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getStorageEstimation());e.mdStorageQuotaBytes!==d("WAWebSyncdMdSyncFieldstatMeta").STORAGE_QUOTA_UNAVAILABLE&&(i.mdStorageQuotaUsedBytes=e.mdStorageQuotaUsedBytes,i.mdStorageQuotaBytes=e.mdStorageQuotaBytes);return{historySyncStartDownloadingMetric:h,historySyncDownloadedMetric:i,historySyncDataAppliedMetric:c}});return L.apply(this,arguments)}function M(a,b,c){a.mdTimestamp=c,a.mdBootstrapStepDuration=c-b,a.commit()}function N(a,b,c,e){a.mdTimestamp=e,a.mdBootstrapStepDuration=e-b,a.mdBootstrapStepResult=c?d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS:d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.FAILURE,a.commit()}function O(a){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.historySyncDataAppliedMetric,c=a.startTs,e=a.isSuccess,f=a.forceFlushWamBuffer;a=a.failureReason;var g=d("WATimeUtils").unixTimeMs();b.mdTimestamp=g;b.mdBootstrapStepDuration=g-c;b.mdBootstrapStepResult=e?d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.SUCCESS:d("WAWebWamEnumMdBootstrapStepResult").MD_BOOTSTRAP_STEP_RESULT.FAILURE;a!=null&&(b.mdSyncFailureReason=a);return b.commitAndWaitForFlush(f)});return P.apply(this,arguments)}function Q(a){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.progress,c=(yield d("WAWebUserPrefsHistorySync").getChunkCountForEndOfRecentHistorySync());(a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL||a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&a.chunkOrder===c)&&(b=100);return b!=null?b:0});return R.apply(this,arguments)}function S(a){return[d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_BOOTSTRAP,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.INITIAL_STATUS_V3,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME].includes(a.syncType)&&a.initialHistBootstrapInlinePayload!=null&&(a==null?void 0:a.initialHistBootstrapInlinePayload.byteLength)>0?a.initialHistBootstrapInlinePayload:null}function T(){return U.apply(this,arguments)}function U(){U=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed","syncType"],[0,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT],{shouldDecrypt:!1}).then(function(a){return a.filter(function(a){return!d("WAWebApiHistorySyncNotification").inFlightChunk.has(a.msgKey)&&!a.reuploadPending}).sort(function(a,b){return((a=a.chunkOrder)!=null?a:0)-((a=b.chunkOrder)!=null?a:0)})})});return U.apply(this,arguments)}function V(a){var b=null;if(d("WAWebCurrentUser").isEmployee())try{b=new Set(a.map(function(a){a=a.lid;return a.toString()}))}catch(a){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history] could not create allLidMapping ",""])),a)}return b}function W(a){if(a==null)return"N/A";var b=0,c=[];for(a of a){c.push(a);if(b++===50)break}return c.join(",")}function X(a){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history] start to report missing mapping. is sw enabled: ",""])),d("WAWebUserPrefsNotifications").getGlobalOfflineNotifications().toString());try{var b=!1;a.forEach(function(a,c){a>0&&(b=!0,d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["total missing mapping for type ",": ",""])),c,a))});b&&d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["missing Lid mapping in history Sync"]))).sendLogs("missing Lid mapping in history Sync")}catch(a){d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history] could not calculate missing mapping: ",""])),a)}d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[history] end to report missing mapping"])))}function Y(a,b,c,d){}g.HistorySyncScheduleSource=C;g.processPastParticipants=a;g.getHistorySyncLogDetailsString=E;g.getHistorySyncBasicChunkInfoString=F;g.parseWebMsgInfoAndReturnNullOnFailure=e;g.isInvalidMsg=G;g.checkSelfHistorySyncIdentity=f;g.saveGroupMetadataForLeftGroup=I;g.handleChatThreadLoggingMetadata=J;g.getHistorySyncMetrics=K;g.commitHistoryStartDownloadingMetric=M;g.commitHistoryDownloadedMetric=N;g.commitHistoryDataAppliedMetric=O;g.getHistorySyncProgress=Q;g.maybeGetInlinePayload=S;g.getUnprocessedRecentSyncNotifications=T;g.getLidMappingAsStringSet=V;g.getLidsForLogging=W;g.reportMissingMapping=X}),98);
__d("WAWebNewsletterReportUtils",["Promise","WAJids","WALogger","WASmaxSpamNewsletterReportRPC","WAWebDBMsgUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationUIUtils","WAWebMsgType","WAWebPollCreationUtils","WAWebReportSpamJob","WAWebReportUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){switch(a.name){case"NewsletterReportResponseError":var b=parseInt(a.value.errorSpamIqErrors.value,10),c=a.value.errorSpamIqErrors.name;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseNewsletterReportResponse: server response with ",", ",""])),b,c);return{errorCode:b,errorText:c};default:a.name;return a.value}}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return a.parentMsgKey!=null?d("WAWebDBMsgUtils").getMsgByMsgKey(a.parentMsgKey):null});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a==null)return d("WAWebReportSpamJob").loadMsgsForSpamReport(b,d("WAWebReportSpamJob").SPAM_REPORT_MESSAGE_COUNT,null);b=[a];if(a.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&a.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE)b.push.apply(b,d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(a.id));else if(a.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL){a=(yield k(a));a!=null&&b.push.apply(b,d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(a.id))}return b});return n.apply(this,arguments)}function a(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){c=(yield m(c,a));var f;c=(yield (i||(i=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("WAWebReportUtils").getMessageMixinArgs(b));b!=null&&(f=babelHelpers["extends"]({messageFrom:d("WAJids").toNewsletterJid(a.id.toJid())},b));return f});return function(a){return c.apply(this,arguments)}}())));e={spamListJid:d("WAJids").toNewsletterJid(a.id.toJid()),spamListSpamFlow:e,spamListSubject:a.name,messageArgs:c.filter(Boolean)};c=(yield d("WASmaxSpamNewsletterReportRPC").sendNewsletterReportRPC(e));return j(c)});return o.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebReportSpamJob",["Promise","WAJids","WALogger","WASmaxGroupsAcknowledgeGroupRPC","WASmaxSpamGroupReportRPC","WASmaxSpamIndividualReportRPC","WASmaxSpamStatusReportRPC","WAWebChatGetters","WAWebMessageAssociationUIUtils","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterReportUtils","WAWebNoop","WAWebParseReportResponse","WAWebPollCreationUtils","WAWebReportUtils","WAWebSchemaChat","WAWebSpamUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=5;function m(a,b,c){var e=[],f=a.msgs.toArray().reverse(),g=b;for(var h=0;h<f.length;h++){if(e.length>=b)break;var i=f[h];if(!d("WAWebSpamUtils").isSpamSupportedForMessageType(i.type)&&i.type!==d("WAWebMsgType").MSG_TYPE.ALBUM||d("WAWebMsgGetters").getIsBotResponse(i)||i.from.equals(d("WAWebUserPrefsMeUser").getMaybeMePnUser())||!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT_SPAM_REPORT,i.viewMode))continue;if(c){if(d("WAWebChatGetters").getIsGroup(a)&&!c.equals(i.author))continue;if(d("WAWebChatGetters").getIsUser(a)&&!c.equals(i.from))continue}if(i.type===d("WAWebMsgType").MSG_TYPE.ALBUM)e.push.apply(e,d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(i.id).slice(0,4));else if(i.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&i.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE){e.push(i);var j=d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(i.id);e.push.apply(e,j);g+=j.length}else e.push(i)}return e.slice(0,g)}function a(a){var b;((b=a.buttonsMessage)==null?void 0:b.buttons)!=null&&(a.buttonsMessage=babelHelpers["extends"]({},a.buttonsMessage,{buttons:a.buttonsMessage.buttons.map(function(a){if(a.nativeFlowInfo){var b;b=JSON.parse((b=a.nativeFlowInfo.paramsJson)!=null?b:"{}");delete b.reference_id;delete b.total_amount;return babelHelpers["extends"]({},a,{nativeFlowInfo:babelHelpers["extends"]({},a.nativeFlowInfo,{paramsJson:JSON.stringify(b)})})}return a})}));((b=a.messageContextInfo)==null?void 0:b.messageSecret)!=null&&(a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{messageSecret:null}));return a}function e(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebReportUtils").getMessageMixinArgs(b));if(e==null)throw c("err")("report status failed due to unsupported msg type");var f=d("WAWebMsgGetters").getSender(b);if(f==null)throw c("err")("report status failed due to missing sender");e=babelHelpers["extends"]({},e,{messageParticipantMixinArgs:{messageParticipant:d("WAWebWidToJid").widToUserJid(f)}});f={spamListSpamFlow:a,spamListJid:d("WAJids").STATUS_JID,messageFrom:d("WAJids").STATUS_JID,messageRecipientMixinArgs:{messageTo:d("WAWebWidToJid").widToUserJid(b.to)},messageMixinArgs:e};a=(yield d("WASmaxSpamStatusReportRPC").sendStatusReportRPC(f));switch(a.name){case"StatusReportResponseError":b=parseInt(a.value.errorSpamIqErrors.value.code,10);e=a.value.errorSpamIqErrors.value.text;d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["reportStatus: server response with ",", ",""])),b,e);return{errorCode:b,errorText:e};default:a.name;return a.value}});return n.apply(this,arguments)}function f(a){d("WAWebChatGetters").getIsGroup(a)&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[callp] acknowledging group ",""])),a.id.toLogString()),d("WASmaxGroupsAcknowledgeGroupRPC").sendAcknowledgeGroupRPC({iqTo:d("WAWebWidToJid").widToGroupJid(a.id)})["catch"](c("WAWebNoop")));return d("WAWebSchemaChat").getChatTable().merge(a.id.toString(),{notSpam:!0})["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["get chat table merge failed"]))).verbose().devConsole(a).sendLogs("get chat table merge failed when sending spam report");throw c("err")("get chat table merge failed")})}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f=(yield d("WAWebReportUtils").getMessageMixinArgs(a));f!=null&&(e=babelHelpers["extends"]({messageSenderOrRecipientMixinGroupArgs:{messageSender:{messageFrom:d("WAWebWidToJid").widToUserJid(a.from)}}},f));f=d("WAWebMsgGetters").getSender(a);if(f==null)throw c("err")("report status failed due to missing sender");a={spamListSpamFlow:b,spamListJid:d("WAWebWidToJid").widToUserJid(f),messageArgs:e!=null?[e]:[]};b=(yield d("WASmaxSpamIndividualReportRPC").sendIndividualReportRPC(a));return d("WAWebParseReportResponse").parseIndividualReportResponse(b)});return p.apply(this,arguments)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b={spamListJid:d("WAWebWidToJid").widToGroupJid(a.id),spamListSpamFlow:b,spamListSubject:a.formattedTitle};a=(yield d("WASmaxSpamGroupReportRPC").sendGroupReportRPC(b));return d("WAWebParseReportResponse").parseGroupReportResponse(a)});return r.apply(this,arguments)}function s(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=[];c!=null?f=[c]:f=m(a,l,null);var g,h;c=(yield (k||(k=b("Promise"))).all(f.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield d("WAWebReportUtils").getMessageMixinArgs(b));b.author?h=d("WAWebWidToJid").widToUserJid(b.author):b.from.isUser()&&(h=d("WAWebWidToJid").widToUserJid(b.from));c!=null&&(g=babelHelpers["extends"]({messageFrom:d("WAWebWidToJid").widToGroupJid(a.id)},c,h!=null&&{messageParticipantMixinArgs:{messageParticipant:h}}));return g});return function(a){return c.apply(this,arguments)}}())));f={spamListJid:d("WAWebWidToJid").widToGroupJid(a.id),spamListSpamFlow:e,spamListSubject:a.formattedTitle,messageArgs:c.filter(Boolean)};e=(yield d("WASmaxSpamGroupReportRPC").sendGroupReportRPC(f));return d("WAWebParseReportResponse").parseGroupReportResponse(e)});return t.apply(this,arguments)}function u(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=[];c!=null?f=[c]:f=m(a,l,a.id);var g;c=(yield (k||(k=b("Promise"))).all(f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebReportUtils").getMessageMixinArgs(a));b!=null&&(g=babelHelpers["extends"]({messageSenderOrRecipientMixinGroupArgs:{messageSender:{messageFrom:d("WAWebWidToJid").widToUserJid(a.from)}}},b));return g});return function(b){return a.apply(this,arguments)}}())));a={spamListSpamFlow:e,messageArgs:c.filter(Boolean)};f=(yield d("WASmaxSpamIndividualReportRPC").sendIndividualReportRPC(a));return d("WAWebParseReportResponse").parseIndividualReportResponse(f)});return v.apply(this,arguments)}function w(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f;d("WAWebChatGetters").getIsNewsletter(a)?f=(yield c("WAWebNewsletterReportUtils")==null?void 0:c("WAWebNewsletterReportUtils")(a,e,b)):e!=null&&!d("WAWebChatGetters").getIsGroup(a)?f=(yield o(e,b)):a.isParentGroup===!0?f=(yield q(a,b)):d("WAWebChatGetters").getIsGroup(a)?f=(yield s(a,e,b)):f=(yield u(a,e,b));return f});return x.apply(this,arguments)}g.SPAM_REPORT_MESSAGE_COUNT=l;g.loadMsgsForSpamReport=m;g.getSpamMessageProtobuf=a;g.reportStatus=e;g.sendNotSpamJob=f;g.reportSpam=w}),98);
__d("WAWebLruCacheMap",["WALruCache"],(function(a,b,c,d,e,f,g){a=function(){function a(a){var b=a.sizeLimit;a=a.getSize;this.$1=new(d("WALruCache").LruCache)({sizeLimit:b,getSize:a!=null?a:function(){return 1}})}var b=a.prototype;b.clear=function(){this.$1.clear()};b["delete"]=function(a){var b=this.has(a);if(!b)return!1;this.$1["delete"](a);return!0};b.get=function(a){return this.$1.get(a)};b.has=function(a){return this.$1.has(a)};b.set=function(a,b){this.$1.put(a,b);return this};b.iterateOnEach=function(a){this.$1.forEach(a)};return babelHelpers.createClass(a,[{key:"size",get:function(){return this.$1.getCurrentSize()}}])}();g.LruCacheMap=a}),98);
__d("WAWebGalaxyFlowsSessionsCache",["WATimeUtils","WAWebABProps","WAWebLruCacheMap"],(function(a,b,c,d,e,f,g){"use strict";e=1e3;var h=new(d("WAWebLruCacheMap").LruCacheMap)({sizeLimit:e});function i(){return new(d("WAWebLruCacheMap").LruCacheMap)({sizeLimit:d("WAWebABProps").getABPropConfigValue("extensions_user_report_store_max_data_max_sessions_per_message")})}function j(){return new(d("WAWebLruCacheMap").LruCacheMap)({sizeLimit:d("WAWebABProps").getABPropConfigValue("extensions_user_report_store_max_data_exchanges_per_session")})}function a(a,b){a=a+"_"+b;b=d("WATimeUtils").unixTime();var c="session_"+a+"_"+b.toString(),e=h.get(a);e==null&&(e={timestamp:b,sessions:i(),latestSessionId:null},h.set(a,e));a={timestamp:b,sessionData:j()};e.sessions.set(c,a);e.timestamp=b;e.latestSessionId=c}function k(a,b){a=a+"_"+b;b=h.get(a);if(b==null)return null;a=b.latestSessionId;return a==null?null:b.sessions.get(a)}function b(a,b,c,e){a=k(a,b);if(a==null)return;b=d("WATimeUtils").unixTime();c={timestamp:b,screenName:c,data:e};a.sessionData.set("navigation_"+b.toString(),c)}function c(a,b){a=a+"_"+b;b=h.get(a);if(b==null)return[];var c=[];b.sessions.iterateOnEach(function(a){a.sessionData.iterateOnEach(function(a){c.push({screenName:a.screenName,timestamp:a.timestamp,data:a.data})})});return c}g.GalaxyFlowSessionsCache=h;g.createFlowSession=a;g.addDataToLatestSession=b;g.getFlowDataForMessage=c}),98);
__d("WAWebReportUtils",["Promise","WALogger","WAStanzaUtils","WAWebBackendJobsCommon","WAWebDBReportingTokenUtils","WAWebE2EProtoUtils","WAWebGalaxyFlowsSessionsCache","WAWebInteractiveMessagesNativeFlowName","WAWebMessagingGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebOTPHelper","WAWebOutgoingMessage","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebReportSpamJob","WAWebReportingTokenUtils","WAWebSpamUtils","WAWebViewOnceState","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i;function j(a,b){var c=a.conversation;if(!b.isFromTemplate||c==null)return a;b=b.buttons;b==null||b.forEach(function(a){a=d("WAWebOTPHelper").getOTPCodeFromButton(a);if(a!=null){var b;c=(b=c)==null?void 0:b.replace(a,"<code>")}});a.conversation=c;return a}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN)return{deletedReason:null,messagePayloadTypesArgs:{messageWithType:{contentTypeTextOrMediaMixinGroupArgs:{isContentTypeText:!0}}},hsmTemplateMixin:null,rawArgs:null,questionsResponseMixin:null};var b,c=a.isViewOnce&&!d("WAWebViewOnceState").isUnviewed(a.safe());c&&(b=d("WAWebViewOnceState").isViewed(a.safe())?"view_once_opened":"view_once_expired");var e=d("WAWebReportSpamJob").getSpamMessageProtobuf(d("WAWebOutgoingMessage").createOutgoingMsgModelProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Report,a));e=j(e,a);var f=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(e);c=c?null:d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,e).readByteArrayView();e=d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(e);var g;switch(e){case"poll":g={messageWithPoll:{metaContenttype:a.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE?"image":"text"}};break;case"text":g={messageWithType:{contentTypeTextOrMediaMixinGroupArgs:{isContentTypeText:!0}}};break;default:g={messageWithType:{contentTypeTextOrMediaMixinGroupArgs:{isContentTypeMedia:!0}}};break}e=c!=null?babelHelpers["extends"]({rawElementValue:c,rawMixinsArgs:d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION===2?{isRawV2:!0}:{rawV3:{rawProtocolV:d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION}}},f&&{rawMediatype:f},{rawLocalMessageType:d("WAWebSpamUtils").msgTypeToReportLocalMessageType(a.type)}):null;c=a.isFromTemplate&&a.templateId!=null?{hsmTid:a.templateId}:null;f=a.type===d("WAWebMsgType").MSG_TYPE.NEWSLETTER_QUESTION_RESPONSE&&a.parentServerId!=null&&a.questionResponseInfo!=null&&a.questionResponseInfo.responseServerId!=null?{messageServerId:a.parentServerId,messageResponseServerId:a.questionResponseInfo.responseServerId}:null;return{deletedReason:b,messagePayloadTypesArgs:g,hsmTemplateMixin:c,rawArgs:e,questionsResponseMixin:f}});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return null;a=(yield d("WAWebDBReportingTokenUtils").getReportingInfosFromMsgKeys([a.toString()]));if(a.length===0)return null;var e=d("WAWebMsgGetters").getIsStatus(c)?c.author:d("WAWebMsgGetters").getSender(c),f=c.messageSecret,g=d("WAWebReportingTokenUtils").getRemoteJidOnReceiverSide(c);c=a.map(function(a){return d("WAWebDBReportingTokenUtils").createReportingValidationArgs(a,g,f,e)});return{reportingValidationArgs:yield (i||(i=b("Promise"))).all(c)}});return n.apply(this,arguments)}function o(a,b){var c=JSON.parse((b=b[0].buttonParamsJson)!=null?b:"{}");b=d("WAWebGalaxyFlowsSessionsCache").getFlowDataForMessage(a.id.id.toString(),(b=a.galaxyFlowQPLMessageId)!=null?b:"");return b.length===0?null:b.map(function(b){var d;return{extensionScreenExtensionId:(d=c.flow_id)!=null?d:"",extensionScreenSessionId:(d=a.galaxyFlowQPLMessageId)!=null?d:"",extensionScreenT:b.timestamp,extensionScreenName:b.screenName,extensionScreenEntryPoint:"message_cta",dataElementValue:(b=JSON.stringify((d=b.data)!=null?d:{}))!=null?b:""}})}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebSpamUtils").isSpamSupportedForMessageType(a.type))return null;var b=a.id;if(a.type==="revoked"){var e;b=(e=a.protocolMessageKey)!=null?e:a.id}try{e=(yield k(a));var f=e.deletedReason,g=e.messagePayloadTypesArgs,i=e.hsmTemplateMixin,j=e.rawArgs;e=e.questionsResponseMixin;g={messagePayloadTypesArgs:g,messageT:a.t,messageId:d("WAStanzaUtils").toStanzaId(b.id),rawArgs:j,messageDeletedReason:f,messageWithHsmTemplateMixinArgs:i};d("WAWebMsgGetters").getIsEdited(a)&&(g=babelHelpers["extends"]({},g,{hasMessageEdit:!0}));a.type==="revoked"&&(g=babelHelpers["extends"]({},g,a.subtype==="sender"?{hasRevoke:!0}:{hasAdminRevoke:!0}));d("WAWebMsgGetters").getIsMarketingMessage(a)&&(g=babelHelpers["extends"]({},g,{sMBBroadcastSourceMixinArgs:{metaBizSource:"smb_promo"}}));j=(yield m(b,a));j!=null&&(g=babelHelpers["extends"]({waMessageReportingMixinArgs:{hasRaw:!1,clientReportingContentValidationMixinArgs:j}},g));e!=null&&(g=babelHelpers["extends"]({},g,{messageWithNewsletterQuestionResponseMixinArgs:e}));if((a==null?void 0:a.nativeFlowName)===c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW){i=(f=a.interactivePayload)==null?void 0:f.buttons;if(i!=null){b=o(a,i);b!=null&&(g=babelHelpers["extends"]({},g,{extensionScreenDataMixinArgs:{extensionScreenArgs:b}}))}}return g}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[WA-ICE][Reporting] getMessageMixinArgs failed for type: ",", subtype: ",""])),a.type,a.subtype).tags("wa-ice","reporting").devConsole(b).sendLogs("reporting-get-message-failed");throw b}});return p.apply(this,arguments)}g.getMessageMixinArgs=a}),98);
__d("WAWebSendServerErrorReceiptJob",["Promise","WABase64","WADeprecatedSendIq","WALogger","WAWap","WAWebChatGetters","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCryptoMediaRetry","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.id.id;if(d("WAWebMsgGetters").getIsNewsletterMsg(a)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Called RMR on newsletter media, which has null mediaKey"]))).tags("newsletter").sendLogs("newsletter-called-rmr");return(j||(j=b("Promise"))).resolve()}if(a.mediaKey==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[media][rmr] Called RMR with null mediaKey"]))).tags("media","non-sad").sendLogs("rmr-called-with-null-media-key",{sampling:.01});return(j||(j=b("Promise"))).resolve()}var e=d("WABase64").decodeB64(a.mediaKey);e=(yield d("WAWebCryptoMediaRetry").encryptServerErrorReceipt(e,c));var f=e.ciphertext;e=e.iv;var g=d("WAWebFrontendMsgGetters").getChat(a),k=d("WAWap").CUSTOM_STRING(g.id.toString({legacy:!0}));g=d("WAWebChatGetters").getIsGroup(g)||d("WAWebChatGetters").getIsBroadcast(g)?d("WAWap").CUSTOM_STRING(d("WAWebMsgGetters").getSender(a).toString({legacy:!0})):d("WAWap").DROP_ATTR;var l=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();f=d("WAWap").wap("receipt",{type:"server-error",to:d("WAWebCommsWapMd").USER_JID(l),id:d("WAWap").CUSTOM_STRING(c)},d("WAWap").wap("encrypt",null,d("WAWap").wap("enc_p",null,f),d("WAWap").wap("enc_iv",null,e)),d("WAWap").wap("rmr",{jid:k,from_me:d("WAWap").CUSTOM_STRING(String(d("WAWebMsgGetters").getIsSentByMe(a))),participant:g}));return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(f,d("WAWebCommsAckParser").toCoreAckTemplate({id:c,"class":"receipt",type:"server-error",from:l,participant:null}))});return k.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebResendUserMsg",["WALogger","WATimeUtils","WAWebDBDeviceListFanout","WAWebMsgFanoutTypes","WAWebMsgUtilsBridge","WAWebSendMsgCommonApi","WAWebSendMsgToDeviceList","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebWamEnumMessageSendResultType","asyncToGeneratorRuntime","cr:10198","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(a,b,c,d,e){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var n=a.data.to,o=a.data.id.id;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: "," to ",""])),o,n.toString()).tags("messaging");var p=d("WAWebSendMsgCommonApi").getResendTimeoutInSeconds();if(d("WATimeUtils").unixTime()-f>p){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending due to "," min timeout"])),o,p/60).tags("messaging");(f=g.sendReporter)==null||f.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_EXPIRED,isTerminal:!1});g.sendReporter=null;return}try{f=n.isLid()?(p=d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?p:d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow():d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();p=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:[n,f]}));p=c("lodash").differenceBy(p,e,String);if(p.length===0){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending to the empty list"])),o).tags("messaging");(e=g.sendReporter)==null||e.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_BACKFILL_USYNC_FAILED,isTerminal:!1});g.sendReporter=null;return}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": resending to devices: ",""])),o,p.join(",")).tags("messaging");if(a.data.isOverwrittenByRevoke===!0){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip resending because this message has been overwritten by a revoke"])),o).tags("messaging");return}e=(yield d("WAWebSendMsgToDeviceList").sendMsgToDeviceList(a,b,p,{fanoutType:d("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT,isResendingMsg:!0},g));b=e.phash;b!=null&&(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": got phash during the resend"])),o).tags("messaging"),void d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([n,f],"message",b))}catch(a){(p=g.sendReporter)==null||p.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1});g.sendReporter=null;throw a}yield d("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(a.data)});return n.apply(this,arguments)}g.resendUserMsg=a}),98);
__d("WAWebSendAppStateSyncMsgJob",["WADeprecatedSendIq","WALogger","WAWebCommsAckParser","WAWebE2EProtoGenerator","WAWebEventsWaitForOfflineDeliveryEnd","WAWebSendMsgCreateDeviceStanza","WAWebSendMsgTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg,c=a.pushPriority;a=a.privacySensitive;yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd();d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendKeyMsg: sending ",""])),b.id.toString()).tags("messaging");var e=b.to,f=d("WAWebE2EProtoGenerator").createPeerMsgProtobuf(b);f=(yield d("WAWebSendMsgCreateDeviceStanza").createUserDeviceMsgStanza({type:d("WAWebSendMsgTypes").SendMessageRecordType.Message,data:b},f,{to:e,recipient:null,option:{type:d("WAWebSendMsgCreateDeviceStanza").MsgType.AppStateSync,pushPriority:c,privacySensitive:a}}));return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(f,d("WAWebCommsAckParser").toCoreAckTemplate({id:b.id.id,"class":"message",from:e,participant:null}))});return i.apply(this,arguments)}g.encryptAndSendKeyMsg=a}),98);
__d("WAWebGroupMsgSendUtils",["WALogger","WAWebAddonGatingUtils","WAWebGroupType","WAWebGroupUtils","WAWebMsgGetters","WAWebSchemaGroupMetadata","WAWebSchemaParticipant","WAWebWamGroupMetricUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(a));e==null&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_getGroupData: no group metadata record found for: ",""])),a);a={groupId:a,amIAdmin:null,isCag:null,isLid:null,isLidAddressingMode:null,wamTypeOfGroup:null,participantCount:null,deviceCount:null,deviceSizeBucket:null,isCapiGroup:null};var f=(e==null?void 0:e.isLidAddressingMode)===!0;if(e!=null){var g=d("WAWebGroupType").getGroupTypeFromGroupMetadata(e),i=g===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;a.wamTypeOfGroup=d("WAWebGroupType").groupTypeToWamEnum(g);a.isLid=i&&(c==null?void 0:c.type)==="addon";a.isCag=i;a.isLidAddressingMode=f;a.isCapiGroup=e.hasCapi===!0}if(b!=null){g=d("WAWebGroupUtils").amIGroupAdmin(b.admins);a.amIAdmin=g;Object.assign(a,d("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(b))}return a});return j.apply(this,arguments)}function c(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaParticipant").getParticipantTable().get(a));b==null&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["_getParticipantRecord: no participants record found for: ",""])),a);return b});return k.apply(this,arguments)}function e(a,b){return b.isCag===!0?d("WAWebMsgGetters").getIsReaction(a)||d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(a.type):!1}function f(a){var b=a.filter(function(a){return a.isLid()});a=a.length-b.length;return b.length+" lid participants & "+a+" pn participants"}function l(a){var b=a.isLidAddressingMode===!0?"lid":"pn";a=a.isCag===!0?"cag":"nonCag";return"group type: "+b+", "+a}g.getGroupData=a;g.getParticipantRecord=c;g.isCagAddon=e;g.formatWidTypeCountsForLog=f;g.formatGroupTypeForLog=l}),98);
__d("WAWebEncryptMsgProtobuf",["Promise","WALogger","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebE2eMessageSendWamEvent","WAWebGroupMsgSendUtils","WAWebMsgGetters","WAWebPostE2eMessageSendMetric","WAWebSendMsgCommonApi","WAWebSignal","WAWebSignalSessionApi","WAWebUserPrefsMeUser","WAWebWamAddressingModeUtils","WAWebWamEnumE2eDestination","WAWebWamEnumEditType","WAWebWamMsgUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i){i===void 0&&(i=d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED);try{f=(yield d("WAWebSignal").Cipher.encryptSignalProto(a,d("WAWebSendMsgCommonApi").encodeAndPad(f)));var k=f.type;f=f.ciphertext;d("WAWebPostE2eMessageSendMetric").postSuccessDirectE2eMessageSendMetric({to:a,retryCount:e,type:k,msg:g,editType:i});return{type:k,ciphertext:f}}catch(f){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptMsgProtobuf: encryption fail for ",", ",""])),a.toString(),f).tags("messaging");d("WAWebSignalSessionApi").maybeDeleteUnconvertedSession(a);d("WAWebPostE2eMessageSendMetric").postFailureDirectE2eMessageSendMetric({to:a,retryCount:e,msg:g,editType:i});return(j||(j=b("Promise"))).reject(c("err")("[messaging] encryptMsgProtobuf: encryption fail for "+a.toString()+", "+f))}});return k.apply(this,arguments)}function e(a,b,c,d){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h;h=new(d("WAWebE2eMessageSendWamEvent").E2eMessageSendWamEvent)({e2eSuccessful:!0,e2eCiphertextType:d("WAWebBackendJobsCommon").getMetricE2eCiphertextType(d("WAWebBackendJobs.flow").CiphertextType.Skmsg),e2eCiphertextVersion:d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION,e2eDestination:d("WAWebWamEnumE2eDestination").E2E_DESTINATION.GROUP,messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(a),retryCount:0,isLid:Boolean(g.isLid)||((h=a.author)==null?void 0:h.isLid()),typeOfGroup:(h=g.wamTypeOfGroup)!=null?h:void 0,editType:d("WAWebMsgGetters").getWamEditType(a),localAddressingMode:d("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(g)});var k=d("WAWebWamMsgUtils").getWamAgentEngagementType(a);k!=null&&(h.agentEngagementType=k);k=d("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow();var l=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();a=d("WAWebGroupMsgSendUtils").isCagAddon(a,g)||g.isLidAddressingMode===!0?k:l;try{return babelHelpers["extends"]({},yield d("WAWebSignal").Cipher.encryptSenderKeyMsgSignalProto(e,a,f))}catch(a){h.e2eSuccessful=!1;h.weight=1;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptMsgSenderKey: encryption fail for ",", ",""])),e.toString(),a).tags("messaging");return(j||(j=b("Promise"))).reject(c("err")("[messaging] encryptMsgSenderKey: encryption fail for "+e.toString()+", "+a))}finally{h.commit()}});return l.apply(this,arguments)}g.encryptMsgProtobuf=a;g.encryptMsgSenderKey=e}),98);
__d("WAWebSendMsgMetaNode",["WAWap","WAWebABProps","WAWebCommonMsgSubtypeTypes","WAWebCommsWapMd","WAWebE2EProtoUtils","WAWebHandleMsgCommon","WAWebMsgType","WAWebPollsGatingUtils","WAWebProtobufsE2E.pb","WAWebUsernameTypes","WAWebVerifyProtobufMsgObjectKeys"],(function(a,b,c,d,e,f,g){function h(a,b){b=b==null?void 0:b.origin;return a.isLid()&&b!=null&&b===d("WAWebUsernameTypes").LidOriginType.PNH_CTWA?b:null}function a(a,b,c,e,f){e=(e=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(c))!=null?e:c;c=i(e);e=j(e);var g;b.type==="addon"&&(g=d("WAWebE2EProtoUtils").extractCommentTargetIdAndSenderLid(b.data));a=h(a,f);var l=k(b,f),m=!1;if(d("WAWebABProps").getABPropConfigValue("view_once_meta_tag_sending_enabled")){m=((b=b.data.mediaData)==null?void 0:b.isViewOnce)===!0}b=c!=null||e!=null||g!=null||a!=null||(f==null?void 0:f.appendHostedSenderIntent)===!0||l!=null||m;if(b){return d("WAWap").wap("meta",{origin:a!=null?d("WAWap").CUSTOM_STRING(a):d("WAWap").DROP_ATTR,sender_intent:(f==null?void 0:f.appendHostedSenderIntent)===!0?d("WAWap").CUSTOM_STRING("hosted"):d("WAWap").DROP_ATTR,polltype:c!=null?c:d("WAWap").DROP_ATTR,event_type:e!=null?e:d("WAWap").DROP_ATTR,thread_msg_id:((b=g)==null?void 0:b.threadMsgId)!=null?d("WAWap").CUSTOM_STRING(g.threadMsgId):d("WAWap").DROP_ATTR,thread_msg_sender_jid:(a=g)!=null&&a.threadMsgSenderLid?d("WAWebCommsWapMd").USER_JID(g.threadMsgSenderLid):d("WAWap").DROP_ATTR,appdata:l!=null?d("WAWap").CUSTOM_STRING(l):d("WAWap").DROP_ATTR,view_once:m?d("WAWap").CUSTOM_STRING("true"):d("WAWap").DROP_ATTR})}}function i(a){var b;if(a.pollCreationMessage!=null||a.pollCreationMessageV2!=null||a.pollCreationMessageV3!=null)return d("WAWebHandleMsgCommon").POLL_TYPES.creation;if(((b=a.pollUpdateMessage)==null?void 0:b.vote)!=null)return d("WAWebHandleMsgCommon").POLL_TYPES.vote;return a.pollResultSnapshotMessage!=null&&d("WAWebPollsGatingUtils").isPollResultSnapshotPollTypeEnvelopeEnabled()?d("WAWebHandleMsgCommon").POLL_TYPES.result_snapshot:null}function j(a){if(a.eventMessage!=null)return d("WAWebHandleMsgCommon").EVENT_TYPES.creation;if(a.encEventResponseMessage!=null)return d("WAWebHandleMsgCommon").EVENT_TYPES.response;return((a=a.secretEncryptedMessage)==null?void 0:a.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT?d("WAWebHandleMsgCommon").EVENT_TYPES.edit:null}function k(a,b){a=a.data.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.data.subtype===d("WAWebCommonMsgSubtypeTypes").MsgSubtype.EphemeralSyncResponse;b=(b==null?void 0:b.isCategoryPeerMessage)===!0;return a||b?"default":null}g.getOriginAttribute=h;g.genMetaNode=a}),98);
__d("WAWebSendMsgCreateDeviceStanza",["invariant","$InternalEnum","Promise","WAWap","WAWebAdvSignatureApi","WAWebApiContact","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBizCoexGatingUtils","WAWebCommsWapMd","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebGroupMsgSendUtils","WAWebHandleMsgCommon","WAWebICDCMetaApi","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebManageE2ESessionsJob","WAWebMsgType","WAWebReportingTokenUtils","WAWebSendMsgCommonApi","WAWebSendMsgMetaNode","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){var i,j=b("$InternalEnum").Mirrored(["Retry","AppStateSync"]);f=b("$InternalEnum")({OnDemand:1});function a(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=c.to,g=c.recipient,i=c.option,k=b;yield d("WAWebManageE2ESessionsJob").ensureE2ESessions([f]);d("WAWebUserPrefsMeUser").isMeAccount(f)&&i.type!==j.AppStateSync?(g!=null||h(0,56363),k=d("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(b,g),yield d("WAWebICDCMetaApi").populateICDCMeta(d("WAWebWidFactory").asUserWidOrThrow(g),k)):yield d("WAWebICDCMetaApi").populateICDCMeta(d("WAWebWidFactory").asUserWidOrThrow(f),k);return m(a,k,babelHelpers["extends"]({type:"user"},c),e)});return k.apply(this,arguments)}function e(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=f.to,h=f.participant,k=f.option;yield d("WAWebManageE2ESessionsJob").ensureE2ESessions([h]);if(k.type===j.AppStateSync)return(i||(i=b("Promise"))).reject(c("err")("[messaging] createGroupDeviceMsgStanza: not expect for App State Sync message"));k=a.data.id.remote;if(!k.isGroup())return(i||(i=b("Promise"))).reject(c("err")("[messaging] createGroupDeviceMsgStanza: function called for non group WID"));var l=(yield d("WAWebGroupMsgSendUtils").getParticipantRecord(k.toString()));k=(yield d("WAWebGroupMsgSendUtils").getGroupData(k.toString(),l,a));l=d("WAWebUserPrefsMeUser").isMeAccount(h)?d("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(e,g):e;yield d("WAWebICDCMetaApi").populateICDCMeta(d("WAWebWidFactory").asUserWidOrThrow(h),l);return m(a,l,babelHelpers["extends"]({type:"group",groupData:k},f))});return l.apply(this,arguments)}function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f,g,i=a.data,k=c.to,l=c.option,m=c.botMessageSecret,n=c.isLidBot,o,p;c.type==="user"?o=c.recipient:p=c.participant;var q=p||k;f=(f=l.retryCount)!=null?f:0;var r=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(b),s=i.id,t=d("WAWebBackendJobsCommon").getMetricEditTypeFromMsg(b,i),u=!1;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&f>0){var v;((v=a.data)==null?void 0:v.senderOrRecipientAccountTypeHosted)===!0&&(u=!0)}v=k.isBot()&&o!=null&&!o.isBot();g=Boolean(((g=p)==null?void 0:g.isBot())||v);m=(yield d("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(q,f,g&&m?d("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(b,m):b,i,t));t=m.type;m=m.ciphertext;var w=null;if(t===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg){var x=(yield d("WAWebAdvSignatureApi").getADVEncodedIdentity());w=d("WAWap").wap("device-identity",null,x)}l.type!==j.Retry&&(yield d("WAWebSendMsgCommonApi").updateIdentityRange(a,[q]));yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();l.pushPriority!=null?x=d("WAWap").CUSTOM_STRING(l.pushPriority):x=l.type===j.AppStateSync?d("WAWap").CUSTOM_STRING("high"):d("WAWap").DROP_ATTR;q=null;c.type==="group"&&(q=c.groupData.isLidAddressingMode===!0?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn);u=d("WAWebSendMsgMetaNode").genMetaNode(k,a,b,c.type==="group"?c.groupData:void 0,{appendHostedSenderIntent:u,isCategoryPeerMessage:l.type===j.AppStateSync,origin:e});e=o&&v?o:k;v=d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(t),count:f===0?d("WAWap").DROP_ATTR:d("WAWap").INT(f),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(r),"decrypt-fail":d("WAWebBackendJobsCommon").encodeMaybeDecryptFail(d("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(b))},m);if(g){t=k.isBot()?k:p;t!=null&&t.isBot()||h(0,75934);v=d("WAWap").wap("bot",{is_lid:n===!0?d("WAWap").CUSTOM_STRING("true"):d("WAWap").DROP_ATTR},d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(t)},v))}f=!d("WAWebUserPrefsMeUser").isMeAccount(k)&&a.data.kind!==d("WAWebMsgType").MsgKind.PeerMessage?yield d("WAWebReportingTokenUtils").genReportingTokenBody(a.data,b):null;r=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();var y,z,A;if(r&&d("WAWebUserPrefsMeUser").isMeAccount(e)&&o!=null&&o.isRegularUser())if(o.isLid()){y=d("WAWebApiContact").getPhoneNumber(o);if(d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){m=(yield d("WAWebApiContact").getContactRecord(o));(m==null?void 0:m.username)!=null&&(A=m.username)}}else{z=(n=c.peerRecipientLid)!=null?n:d("WAWebLidMigrationUtils").toLid(o)}return d("WAWap").wap("message",{id:d("WAWap").CUSTOM_STRING(s.id),to:d("WAWebCommsWapMd").JID(e),participant:p&&!g?d("WAWebCommsWapMd").DEVICE_JID(p):d("WAWap").DROP_ATTR,recipient:o&&!g?d("WAWebCommsWapMd").USER_JID(o):d("WAWap").DROP_ATTR,type:d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(b),peer_recipient_pn:y?d("WAWebCommsWapMd").USER_JID(y):d("WAWap").DROP_ATTR,peer_recipient_lid:z?d("WAWebCommsWapMd").USER_JID(z):d("WAWap").DROP_ATTR,peer_recipient_username:A!==void 0?d("WAWap").CUSTOM_STRING(A):d("WAWap").DROP_ATTR,edit:d("WAWebSendMsgCommonApi").editAttribute(b,i.subtype),category:l.type===j.AppStateSync?d("WAWap").CUSTOM_STRING("peer"):d("WAWap").DROP_ATTR,push_priority:x,privacy_sensitive:l.privacySensitive!=null?d("WAWap").CUSTOM_STRING(l.privacySensitive.valueOf().toString()):d("WAWap").DROP_ATTR,addressing_mode:q!=null?d("WAWap").CUSTOM_STRING(q):d("WAWap").DROP_ATTR},v,w,u,f)});return n.apply(this,arguments)}g.MsgType=j;g.PrivacySensitiveType=f;g.createUserDeviceMsgStanza=a;g.createGroupDeviceMsgStanza=e}),98);
__d("WAWebWamEnumPrekeysFetchContext",[],(function(a,b,c,d,e,f){a=Object.freeze({SEND_MESSAGE:1,GET_VNAME_CERTIFICATE:2,SEND_LIVE_LOCATION_RETRY:3,SEND_LIVE_LOCATION_KEY:4,SEND_PEER_MESSAGE:5,MULTI_DEVICE_CALL:6,CALL_PEER_E2E_FAIL:7,IDENTITY_CHANGE_NOTIFICATION:8,BACK_OFF:9,USER_INTENT_PREFETCH:10,RESEND_MESSAGE:11,RETRY_MESSAGE:12,USER_INTENT_STATUS_PREFETCH:13});f.PREKEYS_FETCH_CONTEXT=a}),66);
__d("WAWebPrekeysDepletionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamEnumSizeBucket"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({PrekeysDepletion:[3014,{deviceSizeBucket:[3,d("WAWebWamEnumSizeBucket").SIZE_BUCKET],messageType:[2,d("WAWebWamEnumMessageType").MESSAGE_TYPE],prekeysFetchReason:[1,d("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT]},[1,20,20],"regular"]},{PrekeysDepletion:[]});g.PrekeysDepletionWamEvent=a}),98);
__d("WAWebPostPrekeysDepletionMetric",["WALogger","WAWebPrekeysDepletionWamEvent"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.count,c=a.prekeysFetchReason,e=a.messageType;a=a.deviceSizeBucket;if(b==null||b===0)return;var f={};c!=null&&(f.prekeysFetchReason=c);e!=null&&(f.messageType=e);a!=null&&(f.deviceSizeBucket=a);d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["maybePostPrekeysDepletionMetric: depletion prekey count: ",""])),b);self.setTimeout(function(){for(var a=0;a<b;a++)new(d("WAWebPrekeysDepletionWamEvent").PrekeysDepletionWamEvent)(f).commit()},0)}g.maybePostPrekeysDepletionMetric=a}),98);
__d("WAWebExternalEntryPointPrefs",["WALogger","WATimeUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h,i;function j(a){var b=Date.now();return b-a.addedTime>d("WATimeUtils").WEEK_MILLISECONDS}function k(a){try{Object.keys(a).forEach(function(b){j(a[b])&&delete a[b]}),c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.EXTERNAL_ENTRY_POINT,a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[external_ctx] failed to persist entry points"]))).devConsole(a)}}function l(){try{var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.EXTERNAL_ENTRY_POINT);return a==null?{}:a}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[external_ctx] failed to load entry points"]))).devConsole(a);return{}}}function a(a,b,c,d){var e=l(),f=Date.now();e[a.toString()]={addedTime:f,deepLinkType:b,authSuccess:c,partnerName:d!=null?d:null};k(e)}function b(a){var b=l(),c=b[a.toString()];c!=null&&(delete b[a.toString()],k(b))}function e(a){var b=l();b=b[a.toString()];return b==null||j(b)?null:b}g.saveExternalEntryPoint=a;g.deleteExternalEntryPoint=b;g.getExternalEntryPoint=e}),98);
__d("WAWebSendMsgCtwaAttributionNode",["WASmaxOutMessagePublishCtwaAttributionMixin","WAWebExternalCtxConfig","WAWebExternalEntryPointPrefs","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a){a=a.getAllCMCs();var b=0;for(var c=0;c<a.length;c++){var e=a[c].getModelsArray();for(var f=0;f<e.length;f++){var g=e[f];if(!d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(g.type)&&g.isSendFailure!==!0){++b;if(b>1)return!0}}}return!1}function i(a,b){var c=d("WAWebExternalCtxConfig").getFirstMessageLoggingOption();switch(c){case"NEW_CHATS_OR_EXISTING_CHATS_WITH_PARTNER_LINKS":return b!=null||!h(a);case"ALL_CHATS":return!0;default:c;return!h(a)}}function a(a){if(a==null||!d("WAWebExternalCtxConfig").isCtxLoggingEnabled())return null;var b=d("WAWebExternalEntryPointPrefs").getExternalEntryPoint(a.id);if(b==null)return null;if(!i(a,b.partnerName))return null;a={lt:"WEB_"+b.deepLinkType};b.authSuccess||(a.s=0);b.partnerName!=null&&(a.p=b.partnerName);b=new TextEncoder().encode(JSON.stringify(a));return d("WASmaxOutMessagePublishCtwaAttributionMixin").makeCtwaAttributionCtwaAttribution({ctwaAttributionElementValue:b})}g.getCtwaAttributionNode=a}),98);
__d("WAWebSendMsgCreateFanoutStanza",["Promise","WALogger","WAWap","WAWebABProps","WAWebAdvSignatureApi","WAWebApiContact","WAWebApiMessageInfoStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBotGating","WAWebBotTypes","WAWebBotUtils","WAWebChatCollection","WAWebCommsAckParser","WAWebCommsWapMd","WAWebContactCollection","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebHandleMsgCommon","WAWebICDCMetaApi","WAWebLid1X1MigrationGating","WAWebManageE2ESessionsJob","WAWebMsgFanoutTypes","WAWebMsgGetters","WAWebMsgRcatUtils","WAWebPostPrekeysDepletionMetric","WAWebReportingTokenUtils","WAWebSendMsgCommonApi","WAWebSendMsgCtwaAttributionNode","WAWebSendMsgMetaNode","WAWebSignalProtocolStore","WAWebSimpleSignalPNToFBIDMigration","WAWebTrustedContactsUtils","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameTypes","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamNumberToSizeBucket","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function o(a,b,c,d,e,f,g){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j,k,l){var m,o,p=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(g),q=d("WAWebBackendJobsCommon").nativeFlowNameTypeFromProtobuf(g),r=d("WAWebBotGating").isBotEnabled()&&((m=a.invokedBotWid)==null?void 0:m.isBot())===!0;m=d("WAWebBotGating").isBotEnabled()&&d("WAWebMsgGetters").getIsBotFeedbackMessage(a);o=m&&Boolean(a.bizBotType&&((o=a.protocolMessageKey)==null?void 0:o.remote.equals(e)));var s=m&&e.isBot()||o,t=m&&!e.isBot()&&!o,u=d("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(a);o=d("WAWebSimpleSignalPNToFBIDMigration").getFbidBotPersonaType(e);if(j.fanoutType===d("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT&&f.length===1&&d("WAWebSendMsgCommonApi").isPrimaryDevice(f[0])&&!t&&!d("WAWebBotUtils").isMetaAiBot(e)){var v=f[0],w=d("WAWebUserPrefsMeUser").isMeAccount(v)?d("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(g,e):g,x=w;v.isBot()&&s&&(x=d("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(w));w=(yield d("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(v,0,x,a,l));v=w.type;x=w.ciphertext;w=null;(s||o!=null)&&(w=d("WAWap").wap("bot",{type:s?"feedback":d("WAWap").DROP_ATTR,persona_type:o?d("WAWap").CUSTOM_STRING(o):d("WAWap").DROP_ATTR}));return{shouldHaveIdentity:v===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg,body:d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(v),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(p),"decrypt-fail":d("WAWebBackendJobsCommon").encodeMaybeDecryptFail(d("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(g)),native_flow_name:d("WAWebBackendJobsCommon").encodeMaybeNativeFlowName(q)},x),botBody:w}}o=!1;v=f.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=d("WAWebUserPrefsMeUser").isMeAccount(b)?d("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(g,e):g,f=j.fanoutType===d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?d("WAWebWidFactory").asUserWidOrThrow(b):d("WAWebWidFactory").asUserWidOrThrow(e);yield d("WAWebICDCMetaApi").populateICDCMeta(f,c);f=k==null?void 0:k.get(d("WAWebWidToJid").widToUserJid(f));f=f!=null?d("WAWap").wap("content_binding",null,f):null;try{var m=c,n=b.isBot()&&(r||t||u);n&&(m=d("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(c,a.botMessageSecret));b.isFbidBot()&&(m=d("WAWebE2EProtoGenerator").updateFbidBotProtobuf(m));b.isBot()&&(m=d("WAWebE2EProtoGenerator").updateBotProtobuf(m));c=(yield d("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(b,0,m,a,l));m=c.type;c=c.ciphertext;m===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(o=!0);return{shouldFanoutToBot:n,node:d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(b)},d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(m),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(p),"decrypt-fail":d("WAWebBackendJobsCommon").encodeMaybeDecryptFail(d("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(g)),native_flow_name:d("WAWebBackendJobsCommon").encodeMaybeNativeFlowName(q)},c),f)}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: encryption fail for ",": ",""])),String(b),a);d("WAWebSendMsgCommonApi").isPrimaryDevice(b)&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: encryption fail for primary device: ",""])),a).tags("messaging").sendLogs("encryption-fail-for-primary-device");return null}});return function(a){return c.apply(this,arguments)}}());x=(yield (n||(n=b("Promise"))).all(v));var y=[],z=[];x.forEach(function(a){if((a==null?void 0:a.node)==null)return;a!=null&&a.shouldFanoutToBot?z.push(a.node):y.push(a.node)});return y.length>0||z.length>0?{body:y.length>0?d("WAWap").wap("participants",null,y):null,botBody:z.length>0||s?d("WAWap").wap("bot",{type:m?"feedback":d("WAWap").DROP_ATTR},z):null,shouldHaveIdentity:o}:n.reject(c("err")("[messaging] encryptAndSendUserMsg: encryption fail for all devices"))});return p.apply(this,arguments)}function a(a,b,c,d,e,f){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h){var i=a.data,n=i.to,p=i.id,q=i.from,t=i.subtype;try{var u;(u=g.sendPerfReporter)==null||u.startPrekeysFetchStage();u=(yield d("WAWebManageE2ESessionsJob").ensureE2ESessions(e));var v=u==null?void 0:u.missedPrekeyCount;if(v!=null){var w;(w=g.sendPerfReporter)==null||w.setFetchedPrekeyCount(v)}(w=g.sendPerfReporter)==null||w.postPrekeysFetchStage();d("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:u==null?void 0:u.depletedPrekeyCount,prekeysFetchReason:d("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:f.fanoutType===d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP:d("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL,deviceSizeBucket:f.fanoutType===d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT?c("WAWebWamNumberToSizeBucket")(e.length):null})}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions with error"]))).tags("messaging").devConsole(a)}w=d("WAWebMsgGetters").getIsBotFeedbackMessage(i)&&Boolean(i.bizBotType&&((v=i.protocolMessageKey)==null?void 0:v.remote.equals(n)));u=d("WAWebBotGating").isBotEnabled()&&d("WAWebMsgGetters").getIsBotFeedbackMessage(i)&&n.isBot()||w;v=e;f.isResendingMsg&&(v=(yield d("WAWebSendMsgCommonApi").filterDeviceWithChangedIdentity(a,e)));e=v.map(function(a){return{msgKey:p,receiverId:a}});yield d("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(e);(e=g.sendPerfReporter)==null||e.startClientEncryptStage();e=(yield d("WAWebMsgRcatUtils").genContentBindingForMsg(i,r(q,v)));var x=d("WAWebMsgGetters").getWamEditType(i);x=(yield o(i,n,v,b,f,e,x));(g=g.sendPerfReporter)==null||g.postClientEncryptStage();g=null;if(f.fanoutType===d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT){var y=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(b);g=d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(y)})}y=null;if(x.shouldHaveIdentity){var z=(yield d("WAWebAdvSignatureApi").getADVEncodedIdentity());y=d("WAWap").wap("device-identity",null,z)}z=d("WAWebE2EProtoUtils").getBizNativeFlowName(b);var A=i.nativeFlowInteractiveMsg,B,C=d("WAWebContactCollection").ContactCollection.get(n),D=d("WAWebChatCollection").ChatCollection.get(n),E=C==null?void 0:C.privacyMode;if(E!=null){var F;B=(F=d("WAWap")).wap("biz",{host_storage:F.INT(E.hostStorage),actual_actors:F.INT(E.actualActors),privacy_mode_ts:F.INT(E.privacyModeTs),native_flow_name:F.MAYBE_CUSTOM_STRING(z)})}var G,H,I,J;E=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["createFanoutMsgStanza: create fanout for ",""])),p.id);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["createFanoutMsgStanza: create fanout for a message. found chat: ",". found contact: ",".\n      is lid: ",". lid origin: ",". isLidMigrated: ","\n      contact has phone number: ",""])),D!=null,C!=null,n.isLid(),D==null?void 0:D.lidOriginType,E,(C==null?void 0:C.phoneNumber)!=null).devConsole(p.id);n.isLid()?(((D==null?void 0:D.lidOriginType)==null||(D==null?void 0:D.lidOriginType)===d("WAWebUsernameTypes").LidOriginType.PNH_CTWA)&&(C==null?void 0:C.shareOwnPn)!==!0&&(C==null?void 0:C.phoneNumber)!=null&&(G=C==null?void 0:C.phoneNumber),d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&((C==null?void 0:C.username)!=null&&(J=C.username)),E&&(D==null?void 0:D.lidOriginType)!==d("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&(I=d("WAWebApiContact").getPhoneNumber(n))):n.isUser()&&(D!=null&&D.accountLid&&(H=D==null?void 0:D.accountLid));if(B==null&&z!=null&&A===!0){var F;B=(F=d("WAWap")).wap("biz",null,F.wap("interactive",{v:"1",type:F.CUSTOM_STRING("native_flow")},F.wap("native_flow",{name:F.CUSTOM_STRING(z)})))}else B==null&&z!=null&&(B=d("WAWap").wap("biz",{native_flow_name:d("WAWap").CUSTOM_STRING(z)}));f.isResendingMsg||(yield d("WAWebSendMsgCommonApi").updateIdentityRange(a,v));yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();C=d("WAWebSendMsgMetaNode").genMetaNode(n,a,b,h,{origin:D==null?void 0:D.lidOriginType});E=e==null?void 0:e.get(d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").asUserWidOrThrow(q)));A=E!=null?d("WAWap").wap("sender_content_binding",null,E):null;var K;if(i.subtype==="bot_request_welcome")K="request_welcome";else if(i.botMsgBodyType!=null)switch(i.botMsgBodyType){case d("WAWebBotTypes").BotMsgBodyType.PROMPT:K="prompt";break;case d("WAWebBotTypes").BotMsgBodyType.COMMAND:K="command";break;case d("WAWebBotTypes").BotMsgBodyType.VOICE:d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[bot] outgoing voice message is not supported"])));break}var L;if(i.bizBotType&&!w)switch(i.bizBotType){case d("WAWebBotTypes").BizBotType.BIZ_1P:L="1p_partial";break;case d("WAWebBotTypes").BizBotType.BIZ_3P:L="3p_full";break}var M;(K!=null||L!=null)&&(M=d("WAWap").wap("bot",{type:K!=null?d("WAWap").CUSTOM_STRING(K):d("WAWap").DROP_ATTR,local_automated_type:L!=null?d("WAWap").CUSTOM_STRING(L):d("WAWap").DROP_ATTR}));F=(yield d("WAWebReportingTokenUtils").genReportingTokenBody(i,b));z=(yield s(D));var N;h!=null&&(N=(h==null?void 0:h.isLidAddressingMode)===!0?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn);v=d("WAWebSendMsgCtwaAttributionNode").getCtwaAttributionNode(D);a=d("WAWap").wap("message",{id:d("WAWap").CUSTOM_STRING(p.id),to:d("WAWebCommsWapMd").CHAT_JID(n),type:d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(b),peer_recipient_lid:H?d("WAWebCommsWapMd").USER_JID(H):d("WAWap").DROP_ATTR,peer_recipient_pn:I?d("WAWebCommsWapMd").USER_JID(I):d("WAWap").DROP_ATTR,peer_recipient_username:J!==void 0?d("WAWap").CUSTOM_STRING(J):d("WAWap").DROP_ATTR,edit:d("WAWebSendMsgCommonApi").editAttribute(b,t),device_fanout:f.isResendingMsg===!0||u?d("WAWap").CUSTOM_STRING("false"):d("WAWap").DROP_ATTR,recipient_pn:G?d("WAWebCommsWapMd").USER_JID(G):d("WAWap").DROP_ATTR,addressing_mode:N!=null?d("WAWap").CUSTOM_STRING(N):d("WAWap").DROP_ATTR},x.body,x.botBody,g,y,B,C,A,M,F,z,v);e=d("WAWebCommsAckParser").toCoreAckTemplate({id:p.id,"class":"message",from:i.to,participant:null});return{stanza:a,ackTemplate:e}});return q.apply(this,arguments)}function r(a,b){var c=new Map();c.set(a.user,d("WAWebWidFactory").asUserWidOrThrow(a));for(a of b)c.has(a.user)||c.set(a.user,d("WAWebWidFactory").asUserWidOrThrow(a));return Array.from(c.values())}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebABProps").getABPropConfigValue("privacy_token_sending_on_all_1_on_1_messages"))return null;if(a==null)return null;var b=a.tcToken;a=a.tcTokenTimestamp;return b==null||a==null||d("WAWebTrustedContactsUtils").isTokenExpired(a,d("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:d("WAWap").wap("tctoken",null,b)});return t.apply(this,arguments)}g.createFanoutMsgStanza=a}),98);
__d("WAWebSendMsgJob",["Promise","WALogger","WAWebABPropsSaga","WAWebE2EProtoGenerator","WAWebEventsWaitForOfflineDeliveryEnd","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebOutgoingMessage","WAWebSendGroupKeyDistributionMsgJob","WAWebSendGroupMsgJob","WAWebSendTcTokenChatAction","WAWebSendUserMsgJob","WAWebSimpleSignalPNToFBIDMigration","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=a.data,g=f.id;f=f.to;d("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForBotSend(a);d("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForInvoke(a,"invokedBotWid");d("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceWidWithFbIdForInvoke(a,"botRespOrInvocationRevokeBotWid");d("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()||(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[messaging] waiting for offline delivery end before sending "," message"])),g),yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd());if(!g||!g.id)return(i||(i=b("Promise"))).reject(c("err")("[messaging] sending message without an id"));if(!f)return(i||(i=b("Promise"))).reject(c("err")("[messaging] sending message without an remote id"));g=d("WAWebOutgoingMessage").createOutgoingMessageProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Chat,a);if(f.isUser()){c("WAWebWid").isCAPISupportAccount(f)&&d("WAWebABPropsSaga").getIsSagaV1Enabled()&&d("WAWebABPropsSaga").getIsSagaV1ReengagementEnabled()&&(yield d("WAWebE2EProtoGenerator").addDebugInfoSupportPayload(g));var j=d("WAWebSendUserMsgJob").encryptAndSendUserMsg(a,g,e);a.data.type!=="protocol"&&d("WAWebSendTcTokenChatAction").sendTcToken(f);return j}else if(f.isGroup())return d("WAWebSendGroupMsgJob").encryptAndSendGroupMsg(a,g,e);return(i||(i=b("Promise"))).reject(c("err")("[messaging] unsupported remote jid type"))});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd();if(!a.id)return(i||(i=b("Promise"))).reject(c("err")("[messaging] sending message without an id"));else if(!a.remote)return(i||(i=b("Promise"))).reject(c("err")("[messaging] sending message without an remote id"));if(a.remote.isGroup()){var e=d("WAWebMessageSendReporter").createMessageSendMetricReporter({messageIsInvisible:!0}),f=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:a.remote,mediaType:d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE,messageType:d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP});f.setMessageIsInvisible(!0);return d("WAWebSendGroupKeyDistributionMsgJob").encryptAndSendGroupKeyDistributionMsg(a,e).then(function(){f.postWrittenWireStage(),e.post()})}return(i||(i=b("Promise"))).reject(c("err")("[messaging] unsupported remote jid type"))});return k.apply(this,arguments)}g.encryptAndSendMsg=a;g.encryptAndSendKeyDistributionMsg=e}),98);
__d("WAWebSendMsgToDeviceList",["WADeprecatedSendIq","WAWebCommsAckParser","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a,b,c,d,e){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var h;(h=g.sendPerfReporter)==null||h.startReadyToSendStage();h=a.data;var i=h.id;h=h.to;a=(yield d("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(a,b,e,f,g));b=a.stanza;(e=g.sendPerfReporter)==null||e.postReadyToSendStage();(f=g.sendPerfReporter)==null||f.startWrittenWireStage();a=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(b,d("WAWebCommsAckParser").toCoreAckTemplate({id:i.id,"class":"message",from:h,participant:null})));e=d("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(a);if(e.error)throw c("err")("[messaging] sendMsgToDeviceList: Invalid ack from server");(f=g.sendPerfReporter)==null||f.postWrittenWireStage();g.sendPerfReporter=null;(b=g.sendReporter)==null||b.postSuccess();g.sendReporter=null;return e.success});return h.apply(this,arguments)}g.sendMsgToDeviceList=a}),98);
__d("WAWebFetchResendMissingKeyJob",["Promise","WALogger","WAParsableXmlNode","WAPromiseQueue","WASmaxPreKeysFetchMissingPreKeysRPC","WAWap","WAWebApiDeviceList","WAWebBackendErrors","WAWebDeviceListPk","WAWebEventsWaitForOfflineDeliveryEnd","WAWebProcessKeyBundle","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=new(d("WAPromiseQueue").PromiseQueueMap)();function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd();a=Array.from(new Set(a.map(function(a){return d("WAWebWidFactory").asUserWidOrThrow(a).toString()}))).map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)});var b=a.map(function(a){return a.toString()}).join();d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys ",""])),b);var c=u.waitIfPending(b);if(c){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys deduped ",""])),b);return c}return u.enqueueHandlers(b,w(a))});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start fetching key for "," wids"])),a.length);var c=(yield y(a)),e=(yield A(c)),f=new Map();c.forEach(function(a,b){b=e[b];var c=d("WAWebWidFactory").asUserWidOrThrow(a).toString(),g=f.get(c)||[];if(b!=null){g.push({id:(a=a.device)!=null?a:0,regId:b})}f.set(c,g)});var g=[];f.forEach(function(a,b){b=d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").createUserWidOrThrow(b));b={userJid:b,hasUserReasonIdentity:!1,deviceArgs:a.map(function(a){return{deviceId:a.id,registrationElementValue:d("WAWap").BIG_ENDIAN_CONTENT(a.regId)}})};g.push(b)});d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start sending fetching iq for "," wids"])),a.length);c=(yield d("WASmaxPreKeysFetchMissingPreKeysRPC").sendFetchMissingPreKeysRPC({userArgs:g}));switch(c.name){case"FetchMissingPreKeysResponseSuccess":d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: start processing keys for "," wids"])),a.length);return B(c.value);case"FetchMissingPreKeysResponseServerError":a=c.value.errorServerErrors.value;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed: ",":",""])),a.code,a.text);return(t||(t=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a.code),a.text));case"FetchMissingPreKeysResponseRequestError":a=c.value.errorRequestErrorsFetch.value;d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed: ",":",""])),a.code,a.text);return(t||(t=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a.code),a.text))}});return x.apply(this,arguments)}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: find "," users"])),a.length);var b=(yield d("WAWebApiDeviceList").getDeviceIds(a)),c=new Map();b.forEach(function(b,e){if(b){var f=b.devices;f.forEach(function(a){if(a.id!==0){a=d("WAWebWidFactory").createDeviceWidFromDeviceListPk(b.id,a.id,a.isHosted);c.set(a.toString(),a)}})}f=d("WAWebWidFactory").asUserWidOrThrow(a[e]);c.set(f.toString(),f)});return Array.from(c.values())});return z.apply(this,arguments)}function A(a){a=a.map(function(a){return d("WAWebUserPrefsMeUser").isMeDevice(a)?d("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId():d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSession(String(d("WAWebSignalCommonUtils").createSignalAddress(a))).then(function(a){var b,c=a==null?void 0:a.sessions;if(c)for(var d in c)if(c[d].indexInfo.closed===-1)return c[d].registrationId;return a==null||(b=a.remote)==null?void 0:b.regId})});return(t||(t=b("Promise"))).all(a)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[];a.listUser.forEach(function(a){var c=a.userFetchMissingPreKeysSuccessOrFetchMissingPreKeysErrorOrFetchMissingPreKeysErrorFallbackMixinGroup;switch(c.name){case"FetchMissingPreKeysUserSuccess":var e=c.value,f=e.jid;e=e.device;var g=d("WAWebWidFactory").createWid(f);e.forEach(function(a){var c,e=a.preKeyMixin;b.push({identity:a.elementValue,deviceIdentity:(c=(c=a.deviceIdentityMixin)==null?void 0:c.deviceIdentityElementValue)!=null?c:null,skey:{id:d("WAParsableXmlNode").convertBytesToUint(a.skeyIdKeyIDMixin.elementValue,3),pubkey:a.skeyValueKeyDataMixin.elementValue,signature:a.skeySignatureElementValue},key:e&&{id:d("WAParsableXmlNode").convertBytesToUint(e.keyIdKeyIDMixin.elementValue,3),pubkey:e.keyValueKeyDataMixin.elementValue},regId:d("WAParsableXmlNode").convertBytesToUint(a.registrationElementValue,4),wid:d("WAWebWidFactory").createDeviceWidFromDeviceListPk(d("WAWebDeviceListPk").createDeviceListPK(g),a.id,!1)})});return;case"FetchMissingPreKeysUserErrorFallback":case"FetchMissingPreKeysUserError":f=c.value;d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys failed for user ",": ",":",""])),a.jid,f.errorCode,f.errorText).sendLogs("fetchResendMissingKeys-user-error");return}});d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: parsed "," keys"])),b.length);if(b.length>0)try{a=(yield d("WAWebProcessKeyBundle").processKeyBundles(b));a=a.processedPrekeyCount;d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: successfully established "," E2E sessions out of "," requested"])),a,b.length)}catch(a){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed to build session with error ",""])),a).sendLogs("fetchResendMissingKeys-session-error")}});return C.apply(this,arguments)}g.fetchResendMissingKeys=a}),98);
__d("WAWebMdDeviceSyncAckWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMessageChatType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdDeviceSyncAck:[2180,{chatType:[1,d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE],invisibleMessageCategory:[7,d("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isLid:[3,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],localAddressingMode:[5,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],revoke:[2,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],serverAddressingMode:[6,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],typeOfGroup:[4,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{MdDeviceSyncAck:[]});g.MdDeviceSyncAckWamEvent=a}),98);
__d("WAWebPostMdDeviceSyncAckMetric",["WAWebGetMessageChatTypeFromWid","WAWebMdDeviceSyncAckWamEvent","WAWebSendMsgCommonApi","WAWebWamAddressingModeUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c,e,f){c=new(d("WAWebMdDeviceSyncAckWamEvent").MdDeviceSyncAckWamEvent)({revoke:d("WAWebSendMsgCommonApi").isRevokeMsg(c)});c.chatType=d("WAWebGetMessageChatTypeFromWid").getMessageChatTypeFromWid(a);a.isGroup()?c.isLid=b.data.from.isLid():c.isLid=a.isLid();if(e!=null){b=d("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(e);b!=null&&(c.localAddressingMode=b)}a.isGroup()&&f!=null&&(c.serverAddressingMode=d("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(f));c.commit()}g.postMdDeviceSyncAckMetric=a}),98);
__d("WAWebSendUserMsgJob",["Promise","WALogger","WATimeUtils","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebBotGating","WAWebDBDeviceListFanout","WAWebDBUpdateMessageTable","WAWebFetchResendMissingKeyJob","WAWebLidMigrationUtils","WAWebMsgFanoutTypes","WAWebMsgGetters","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPostMdDeviceSyncAckMetric","WAWebResendUserMsg","WAWebSendMsgToDeviceList","WAWebSimpleSignalPNToFBIDMigration","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:10198"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=a.data,g=f.id,n=f.to,q=f.invokedBotWid,r=f.protocolMessageKey,s=f.subtype;f=f.botRespOrInvocationRevokeBotWid;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: sending ",""])),g).tags("messaging");var t=n.isLid()?(g=d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?g:d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow():d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();g={wids:[n,t]};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&n!=null&&n.isUser()&&(g.chatWidSetToIncludeHostedInFanoutOneToOneChatOnly=n);var u=(yield d("WAWebDBDeviceListFanout").getFanOutList(g));if(d("WAWebBotGating").isBotEnabled())if(d("WAWebMsgGetters").getIsBotFeedbackMessage(a.data)&&r!=null){!n.isBot()&&r.participant!=null?g=r.participant:a.data.bizBotType!=null?g=n:g=r.remote;u=[d("WAWebSimpleSignalPNToFBIDMigration").maybeReplaceDeprecatedBotPnWithFbid(g)]}else if(q&&q!=null&&q.isBot()){r=q;u=[].concat(u,[r])}else f&&f!=null&&f.isBot()&&((s==="sender_revoke"||s==="admin_revoke")&&(u=[].concat(u,[f])));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&d("WAWebBizCoexUtils").fanoutListContainsHostedDevice(u)&&void d("WAWebDBUpdateMessageTable").updateMessageTable(a.data.id,{senderOrRecipientAccountTypeHosted:!0});g=(yield d("WAWebSendMsgToDeviceList").sendMsgToDeviceList(a,c,u,{fanoutType:d("WAWebMsgFanoutTypes").FANOUT_TYPE.CHAT},e));o(n,g);var v=g.phash;if(v!=null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendUserMsg: phash mismatch, got server phash ",""])),v).tags("messaging");var w=d("WATimeUtils").unixTime();d("WAWebPostMdDeviceSyncAckMetric").postMdDeviceSyncAckMetric(n,a,c);e.sendReporter=e.createSendReporter({isResend:!0,originalMessage:a.type==="message"?a.data:void 0});void (m||(m=b("Promise"))).resolve().then(function(){if(!n.isLid())return d("WAWebFetchResendMissingKeyJob").fetchResendMissingKeys([n,t])["catch"](function(){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed"]))).sendLogs("fetchResendMissingKeys-sync-error")})}).then(function(){return d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([n,t],"message",v)}).then(function(){return p(a,c,u,w,e)})["catch"](function(b){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: failed to resend message: ",", type: ",""])),a.data.id.toString(),a.data.type).tags("messaging"),d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: failed to resend message: ",""])),b).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})})}return g});return n.apply(this,arguments)}function o(a,b){b=b.refreshLid;if(b){b=d("WAWebLidMigrationUtils").toPn(a);b&&d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:[b],shouldSyncDevice:!1,mode:"query"})}}function p(a,b,c,d,e){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=(yield d("WAWebPersistedJobManager").getJobManager().accessors.maybeCreateJob(d("WAWebPersistedJobDefinitions").jobSerializers.resendUserMsg(a,c,e)));yield d("WAWebResendUserMsg").resendUserMsg(a,b,c,e,f);yield d("WAWebPersistedJobManager").getJobManager().accessors.deletePersistedJob(g.id)});return q.apply(this,arguments)}g.encryptAndSendUserMsg=a;g.maybeRefreshLid=o}),98);
__d("WAWebAdvMetadataCreationFailureWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({AdvMetadataCreationFailure:[3048,{advMetadataIsMe:[1,d("WAWebWamCodegenUtils").TYPES.BOOLEAN]},[1,1,1],"regular"]},{AdvMetadataCreationFailure:[]});g.AdvMetadataCreationFailureWamEvent=a}),98);
__d("WAWebIdentityIcdcApi",["WACryptoSha256","WAJids","WANullthrows","WASignalOther","WATimeUtils","WAWebABProps","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebIdentityApiUtils","WAWebProtobufsAdv.pb","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=8,i=30*24*60*60;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebApiDeviceList").getDeviceRecord(a));return!b||b.deleted?null:k(a,b)});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!b||b.deleted)return null;var e={keyHash:void 0,timestamp:void 0},f=b.timestamp,g=b.devices,h=b.id;b=b.advAccountType;var i=g.some(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID});if(i){var j=g.map(function(a){return[a.keyIndex,d("WAWebWidFactory").createDeviceWidFromDeviceListPk(h,a.id,a.isHosted)]}),k=[],l=null;j.forEach(function(a){var b=a[0];a=a[1];!d("WAWebUserPrefsMeUser").isMeDevice(a)?k.push([b,a]):l=b});j=(yield d("WAWebIdentityApiUtils").getAllIdentityKeysBytes(k.map(function(a){a=a[1];return a})));var n=[],q=[];j.forEach(function(a,b){a!=null&&(n.push(a),q.push(k[b][0]))});if(d("WAWebUserPrefsMeUser").isMeAccount(a)){j=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair());if(!j)return null;n.push(new Uint8Array(j.pubKey));q.push(c("WANullthrows")(l))}j=o();e.keyHash=(yield m(n.map(function(a){return new Uint8Array(d("WAWebCryptoCurve25519").toCurveKeyPubKey(a.buffer))}),j));q.length!==g.length&&(e.keyIndexes=q)}(i||p(f))&&(e.timestamp=f);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(d("WAWebUserPrefsMeUser").isMeAccount(a)&&(yield d("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0&&(e.senderAccountType=d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED),!d("WAWebUserPrefsMeUser").isMeAccount(a)&&b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(e.receiverAccountType=d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED));return e});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WAWebIdentityApiUtils").identityKeysToBinary(a);a=(yield d("WACryptoSha256").sha256(a));a=new Uint8Array(a);return d("WASignalOther").sliceBytes(a,0,b)});return n.apply(this,arguments)}function o(){var a=d("WAWebABProps").getABPropConfigValue("md_icdc_hash_length");return Math.max(a,h)}function p(a){return d("WATimeUtils").unixTime()-a<i}g.getICDCMeta=a;g.getICDCMetaFromDeviceRecord=k;g.computeIdentityHash=m}),98);
__d("WAWebGetGroupKeyDistributionMsg",["Promise","WALogger","WAWebAdvMetadataCreationFailureWamEvent","WAWebApiDeviceList","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoGenerator","WAWebEncryptMsgProtobuf","WAWebIdentityIcdcApi","WAWebSendMsgCommonApi","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k){var m={senderKeyDistributionMessage:{groupId:e.toString({legacy:!0}),axolotlSenderKeyDistributionMessage:g}};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getKeyDistributionMsg: precalculate ICDC for ",""])),a==null?void 0:a.id.toString()).tags("messaging");var n=(yield l(m,f,k,e));g=f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var e;e=(e=n.get(d("WAWebWidFactory").asUserWidOrThrow(a).toString()))!=null?e:babelHelpers["extends"]({},m);e=(yield d("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(a,0,e));return{type:e.type,ciphertext:e.ciphertext,participant:a}}catch(e){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getKeyDistributionMsg: encryption fail for ",", ",""])),a.toString(),e).tags("messaging");if(d("WAWebSendMsgCommonApi").isPrimaryDevice(a))return(j||(j=b("Promise"))).reject(c("err")("getKeyDistributionMsg: encryption fail for primary device"))}});return function(b){return a.apply(this,arguments)}}());a=(yield (j||(j=b("Promise"))).all(g));return a.filter(Boolean)});return k.apply(this,arguments)}function l(a,b,c,d){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),h=[].concat(Array.from(new Set(c.map(d("WAWebWidFactory").asUserWidOrThrow))));c=(yield d("WAWebApiDeviceList").bulkGetDeviceRecord([g].concat(h)));var i=c[0];c=c.slice(1);var k=null;try{k=(yield d("WAWebIdentityIcdcApi").getICDCMetaFromDeviceRecord(g,i))}catch(a){new(d("WAWebAdvMetadataCreationFailureWamEvent").AdvMetadataCreationFailureWamEvent)({advMetadataIsMe:!0}).commit();throw a}var l=new Map();yield (j||(j=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){c=h[c];var g=babelHelpers["extends"]({},a),i=null;if(d("WAWebUserPrefsMeUser").isMeAccount(c))e&&(g=d("WAWebDeviceSentMessageProtoUtils").wrapDeviceSentMessage(g,f));else try{i=(yield d("WAWebIdentityIcdcApi").getICDCMetaFromDeviceRecord(c,b))}catch(a){new(d("WAWebAdvMetadataCreationFailureWamEvent").AdvMetadataCreationFailureWamEvent)({advMetadataIsMe:!1}).commit();throw a}d("WAWebE2EProtoGenerator").populateMessageContextInfo(g,k,i);l.set(c.toString(),g)});return function(a,b){return c.apply(this,arguments)}}()));return l});return m.apply(this,arguments)}g.getKeyDistributionMsg=a;g.generateMsgProtobufs=l}),98);
__d("WAWebMdGroupParticipantMissAckWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdGroupParticipantMissAck:[4146,{groupSizeBucket:[1,d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],isLid:[2,a.TYPES.BOOLEAN],messageIsRevoke:[3,a.TYPES.BOOLEAN],participantAddCount:[4,a.TYPES.INTEGER],participantRemoveCount:[5,a.TYPES.INTEGER],typeOfGroup:[6,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{MdGroupParticipantMissAck:[]});g.MdGroupParticipantMissAckWamEvent=b}),98);
__d("WAWebWamNumberToClientGroupSizeBucket",["WAWebWamEnumClientGroupSizeBucket"],(function(a,b,c,d,e,f,g){function a(a){if(a<=32+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.SMALL;if(a<=64+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.MEDIUM;if(a<=128+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LARGE;if(a<=256+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.EXTRA_LARGE;if(a<=512+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.XX_LARGE;if(a<=1024+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT1024;if(a<=1500+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT1500;if(a<=2e3+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT2000;if(a<=2500+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT2500;if(a<=3e3+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT3000;if(a<=3500+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT3500;if(a<=4e3+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT4000;if(a<=4500+1)return d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT4500;return a<=5e3+1?d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LT5000:d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET.LARGEST_BUCKET}g["default"]=a}),98);
__d("WAWebMaybePostMdGroupSyncMetrics",["WALogger","WAWebMdGroupParticipantMissAckWamEvent","WAWebSendMsgCommonApi","WAWebWamEnumTypeOfGroupEnum","WAWebWamNumberToClientGroupSizeBucket"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,e,f){b=k(a,b);var g=b.added;b=b.removed;if(g!==0||b!==0){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: added: ",", removed: ",""])),g,b);var l=new(d("WAWebMdGroupParticipantMissAckWamEvent").MdGroupParticipantMissAckWamEvent)();l.messageIsRevoke=d("WAWebSendMsgCommonApi").isRevokeMsg(e);l.groupSizeBucket=c("WAWebWamNumberToClientGroupSizeBucket")((f==null?void 0:f.participantCount)||0);l.typeOfGroup=(f==null?void 0:f.wamTypeOfGroup)||d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.GROUP;l.isLid=l.isLid=a.some(function(a){return a.isLid()});l.participantAddCount=g;l.participantRemoveCount=b;l.commitAndWaitForFlush()["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["maybePostGroupSyncMetrics: event commit failed with ",""])),a)})}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: skip due to no participant change"])))}function k(a,b){var c=new Set(a.map(String)),d=new Set(b.map(String));return{added:b.filter(function(a){return!c.has(String(a))}).length,removed:a.filter(function(a){return!d.has(String(a))}).length}}g.maybePostGroupSyncMetrics=a;g.computeParticipantChange=k}),98);
__d("WAWebResendGroupMsg",["WALogger","WATimeUtils","WAWebCurrentUser","WAWebDBDeviceListFanout","WAWebFetchResendMissingKeyJob","WAWebGroupMsgSendUtils","WAWebGroupQueryBridge","WAWebMaybePostMdGroupSyncMetrics","WAWebMsgFanoutTypes","WAWebMsgUtilsBridge","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPostMdDeviceSyncAckMetric","WAWebSendDirectMsgToDeviceList","WAWebSendMsgCommonApi","WAWebSyncDeviceAdvDeviceListJob","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.isDirect,e=a.msgRecord,f=a.msgProtobuf,g=a.oldList,u=a.ackTime,v=a.groupData,w=a.phash,x=a.metricReporter;a=a.serverAddressingMode;var A=e.data.id.id,B=e.data.to;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: "," to ",""])),A,B.toString()).tags("messaging");d("WAWebPostMdDeviceSyncAckMetric").postMdDeviceSyncAckMetric(B,e,f,v,a);x.sendReporter=x.createSendReporter({isResend:!0,originalMessage:e.type==="message"?e.data:void 0,groupData:v});a=Array.from(new Set(g.map(function(a){return d("WAWebWidFactory").asUserWidOrThrow(a).toString()}))).map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)});if(!d("WAWebGroupMsgSendUtils").isCagAddon(e.data,v))try{yield d("WAWebFetchResendMissingKeyJob").fetchResendMissingKeys(g)}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchResendMissingKeys: failed"]))).sendLogs("fetchResendMissingKeys-sync-error")}if(b)yield d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(g,"message",w);else try{yield d("WAWebGroupQueryBridge").sendQueryGroup(B),z(v,B,f,a.map(d("WAWebWidFactory").createWidFromWidLike))["catch"](function(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: ",": failed for postGroupParticipantSyncMetric ",""])),A,a).tags("messaging")})}catch(a){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": sendQueryGroup failed for message resend: ",""])),A,a).tags("messaging");y(x);throw a}b=d("WAWebSendMsgCommonApi").getResendTimeoutInSeconds();if(d("WATimeUtils").unixTime()-u>b){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["resendUserMsg: ",": skip group resending due to "," min timeout"])),A,b/60).tags("messaging");(w=x.sendReporter)==null||w.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_EXPIRED,isTerminal:!1});x.sendReporter=null;return}try{u=(yield d("WAWebGroupMsgSendUtils").getParticipantRecord(B.toString()));b=u==null?void 0:u.participants;if(b!=null&&b.length!==a.length){w=b.length-a.length;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": group participant list has "," by "," since initial send"])),A,w>0?"increased":"decreased",Math.abs(w));if(d("WAWebCurrentUser").isEmployee()){B=b.map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)});var C=new Set(a);u=B.filter(function(a){return!C.has(a)});d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": message was not sent intentionally to following participants: ",""])),A,u.join()).sendLogs("resendGroupMsg-missed-participants",{sampling:.01})}}w=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:a}));b=c("lodash").differenceBy(w,g,String);if(b.length===0){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": skip resending to the empty list"])),A).tags("messaging");return}d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": resending to devices: ",""])),A,b.join(",")).tags("messaging");if(e.data.isOverwrittenByRevoke===!0){d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": skip resending because this message has been overwritten by a revoke"])),A).tags("messaging");return}yield d("WAWebSendDirectMsgToDeviceList").sendDirectMsgToDeviceList(e,f,b,{fanoutType:d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT,isResendingMsg:!0},v,x);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: ",": done"])),A).tags("messaging")}catch(a){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend "," message: ",""])),A,a).tags("messaging");d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend message: ",""])),a).tags("messaging");(B=x.sendReporter)==null||B.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1});x.sendReporter=null;throw a}yield d("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(e.data)});return x.apply(this,arguments)}function y(a){var b;(b=a.sendReporter)==null||b.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_BACKFILL_USYNC_FAILED,isTerminal:!1});a.sendReporter=null}function z(a,b,c,d){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: start"])));var f=(yield d("WAWebGroupMsgSendUtils").getParticipantRecord(String(b)));if(!f){d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["postGroupParticipantSyncMetric: failed to find participant record for group ",""])),String(b));return}b=f.participants.map(d("WAWebWidFactory").createWid);d("WAWebMaybePostMdGroupSyncMetrics").maybePostGroupSyncMetrics(e,b,c,a)});return A.apply(this,arguments)}function a(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgRecord,c=a.groupData,e=a.isDirect,f=a.oldList,g=a.phash,h=a.ackTime,i=a.serverAddressingMode;b=(yield d("WAWebPersistedJobManager").getJobManager().accessors.maybeCreateJob(d("WAWebPersistedJobDefinitions").jobSerializers.resendGroupMsg(b,c,e,f,g,h,i)));yield w(a);yield d("WAWebPersistedJobManager").getJobManager().accessors.deletePersistedJob(b.id)});return B.apply(this,arguments)}g.resendGroupMsg=w;g.resendPersistedGroupMsgWrapper=a}),98);
__d("WAWebSendDirectMsgToDeviceList",["Promise","WADeprecatedSendIq","WAWebCommsAckParser","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","WAWebSignalProtocolStore","WAWebWamEnumMessageDistributionEnumType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c,d,e,f){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i,j){var k=a.data,l=k.id;k=k.to;a=(yield d("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(a,e,f,g,j,i));e=a.stanza;yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();(f=j.sendPerfReporter)==null||f.postReadyToSendStage();(g=j.sendPerfReporter)==null||g.startWrittenWireStage();i=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(e,d("WAWebCommsAckParser").toCoreAckTemplate({id:l.id,"class":"message",from:k,participant:null})));a=d("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(i);if(a.error)return(h||(h=b("Promise"))).reject(c("err")("[messaging] encryptAndSendGroupDirectMsg: Invalid ack from server"));(f=j.sendReporter)==null||f.setMessageDistributionType(d("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.DIRECT_MESSAGE);(g=j.sendPerfReporter)==null||g.postWrittenWireStage();j.sendPerfReporter=null;(e=j.sendReporter)==null||e.postSuccess();j.sendReporter=null;return a.success});return i.apply(this,arguments)}g.sendDirectMsgToDeviceList=a}),98);
__d("WAWebSendGroupDirectJob",["WALogger","WATimeUtils","WAWebMsgFanoutTypes","WAWebResendGroupMsg","WAWebSendDirectMsgToDeviceList","asyncToGeneratorRuntime","cr:10198"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b,c,d,e){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=a.data.to;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupDirectMsg: sending "," with group ",""])),a.data.id,g.toLogString()).tags("messaging");g=(yield d("WAWebSendDirectMsgToDeviceList").sendDirectMsgToDeviceList(a,b,c,{fanoutType:d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT},e,f));var l=g.phash,m=g.addressingMode;l&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupDirectMsg: phash mismatch, got server phash ",""])),l).tags("messaging"),void d("WAWebResendGroupMsg").resendPersistedGroupMsgWrapper({isDirect:!0,msgRecord:a,msgProtobuf:b,oldList:c,ackTime:d("WATimeUtils").unixTime(),groupData:e,phash:l,metricReporter:f,serverAddressingMode:m})["catch"](function(b){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["resendGroupDirectMsg: failed to resend group msg: ",", type: ",""])),a.data.id.toString(),a.data.type).tags("messaging"),d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["resendGroupDirectMsg: failed to resend group msg: ",""])),b).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})}));return g});return l.apply(this,arguments)}g.encryptAndSendGroupDirectMsg=a}),98);
__d("WAWebSendMsgQueueMap",["WAPromiseQueue"],(function(a,b,c,d,e,f,g){a=new(d("WAPromiseQueue").PromiseQueueMap)();g.sendMsgQueueMap=a}),98);
__d("WAWebSendGroupKeyDistributionMsgJob",["Promise","WADeprecatedSendIq","WALogger","WAWap","WAWebAdvSignatureApi","WAWebApiMessageInfoStore","WAWebApiParticipantStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebCommsAckParser","WAWebCommsWapMd","WAWebGetGroupKeyDistributionMsg","WAWebGroupMsgSendUtils","WAWebManageE2ESessionsJob","WAWebPhashUtils","WAWebSchemaParticipant","WAWebSendMsgCommonApi","WAWebSendMsgQueueMap","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","cr:10198","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupKeyDistributionMsg: sending ",""])),a).tags("messaging");var c=a.remote;return d("WAWebSendMsgQueueMap").sendMsgQueueMap.enqueue(c.toString(),function(){return l(a,b)})}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=a.id,g=a.remote,h=(yield d("WAWebSchemaParticipant").getParticipantTable().get(g.toString())),l=(yield d("WAWebGroupMsgSendUtils").getGroupData(g.toString(),h));e.setGroupData(l);e=(yield d("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(g,h));l=e.skDistribList;h=e.skList;e=e.rotateKey;h=h.concat(l);if(l.length===0){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupKeyDistributionMsg: skip sending ",": sender key distribution list is empty"])),a).tags("messaging");return}yield d("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(h.map(function(b){return{msgKey:a,receiverId:b}}));yield d("WAWebManageE2ESessionsJob").ensureE2ESessions(l);h=(yield d("WAWebPhashUtils").phashV2([].concat(h,[d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()])));e=(yield n(g,l,e));var m=e[0];e=e[1];h=d("WAWap").wap("message",{id:d("WAWap").CUSTOM_STRING(f),to:d("WAWebCommsWapMd").CHAT_JID(g),phash:d("WAWap").CUSTOM_STRING(h),type:"text",device_fanout:d("WAWap").CUSTOM_STRING("false")},d("WAWap").wap("meta",{appdata:"default"}),d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobs.flow").CiphertextType.Skmsg),"decrypt-fail":d("WAWap").CUSTOM_STRING("hide")}),m,e);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();m=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(h,d("WAWebCommsAckParser").toCoreAckTemplate({id:f,"class":"message",from:g,participant:null})));e=d("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(m);if(e.error){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: Invalid ack from server"]))).tags("messaging");return(k||(k=b("Promise"))).reject(c("err")("[messaging] encryptAndSendSenderKeyMsg: Invalid ack from server"))}yield d("WAWebApiParticipantStore").markHasSenderKey(g,l);return e.success});return m.apply(this,arguments)}function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.every(function(a){return a.isLid()});e=e?d("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow():d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();c&&(yield d("WAWebSignal").Session.deleteGroupSenderKeyInfo(a,e));c=(yield d("WAWebSignal").Session.getGroupSenderKeyInfo(a,e));e=(yield d("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(null,a,b,c,!0));a=null;b=!1;e&&e.length>0&&(a=d("WAWap").wap("participants",null,e.map(function(a){var c=a.type,e=a.ciphertext;a=a.participant;c===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(b=!0);return d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)},d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),"decrypt-fail":d("WAWap").CUSTOM_STRING("hide"),type:d("WAWap").CUSTOM_STRING(c)},e))})));c=null;if(b){e=(yield d("WAWebAdvSignatureApi").getADVEncodedIdentity());c=d("WAWap").wap("device-identity",null,e)}return[a,c]});return o.apply(this,arguments)}g.encryptAndSendGroupKeyDistributionMsg=a}),98);
__d("WAWebSendGroupMsgJob",["WALogger","WAWebABProps","WAWebApiContact","WAWebApiParticipantStore","WAWebDBDeviceListFanout","WAWebE2EProtoGenerator","WAWebGroupMsgSendUtils","WAWebLidMigrationUtils","WAWebMaybe","WAWebMsgGetters","WAWebMsgKey","WAWebMsgRcatUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebSchemaMessageInfo","WAWebSendGroupDirectJob","WAWebSendGroupSkmsgJob","WAWebSendMsgQueueMap","WAWebWidFactory","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=Object.freeze({SKMSG:"skmsg",DIRECT:"direct"});function p(a){return a.isLid()}function q(a){return!a.isLid()}function r(a,b,c,d,e,f,g,h){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h,i){b=(yield d("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(b,h));h=b.skDistribList;b=b.skList;i=i||t(a,g);i=i?p:q;b={type:o.SKMSG,senderKeyList:{skList:b.filter(i),skDistribList:h.filter(i),rotateKey:!1}};if(d("WAWebMsgGetters").getSubtype(a.data)==="sender_revoke"){h=!g&&d("WAWebABProps").getABPropConfigValue("send_cag_member_revokes_as_GDM");i=c==null?null:yield w(c,b.senderKeyList,{forceDirectMessage:h,normalizeAddressingModeFn:function(a){return a}});return i!=null?i:b}if(d("WAWebMsgGetters").getType(a.data)==="keep_in_chat"){c=!g&&d("WAWebABProps").getABPropConfigValue("supports_keep_in_chat_in_cag");h=e==null?null:yield y(e,b.senderKeyList,c);return h!=null?h:b}return f?A(f,b.senderKeyList,{normalizeAddressingModeFn:function(a){return a}}):b});return s.apply(this,arguments)}function t(a,b){var e=a.data,f=e.type,g=e.subtype;e=e.keepType;if(e===d("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL)return!1;switch(f){case"reaction_enc":case"comment":case"event_response":return!0;case"poll_update":if(g==="poll_vote")return!0;break;case"protocol":if(a.type==="addon"&&a.data.kind===d("WAWebMsgType").MsgKind.ProtocolAddonRevoke)return!0;if(g==="sender_revoke")return!1;break;case"notification":case"status_notification":case"notification_template":case"gp2":case"broadcast_notification":case"e2e_notification":case"call_log":case"chat":case"location":case"payment":case"vcard":case"ciphertext":case"debug_placeholder":case"multi_vcard":case"revoked":case"oversized":case"groups_v4_invite":case"hsm":case"template_button_reply":case"debug":case"image":case"video":case"ptv":case"audio":case"ptt":case"sticker":case"status":case"document":case"product":case"order":case"list":case"interactive":case"interactive_response":case"list_response":case"buttons_response":case"reaction":case"poll_creation":case"poll_result_snapshot":case"request_phone_number":case"native_flow":case"biz-cover-photo":case"keep_in_chat":case"pin_message":case"pinned_message":case"unknown":case"newsletter_notification":case"history_bundle":case"newsletter_admin_invite":case"event_creation":case"event_edit_encrypted":case"biz_content_placeholder":case"album":case"sticker-pack":case"rich_response":case"automated_greeting_message":case"newsletter_question_response":case"guest_upsell_system_msg":case"newsletter_follower_invite":case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:case"message_history_notice":case"quarantined":break;default:f;throw c("err")("CAG - Invalid type: "+f)}if(b)return!1;throw c("err")("CAG - non-admin trying to send a regular message")}function u(a,b,c,d,e){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){a=(yield d("WAWebApiParticipantStore").getGroupSenderKeyListFromParticipantRecord(a,b));b={senderKeyList:a,type:o.SKMSG};var g=function(a){return a.map(d("WAWebLidMigrationUtils").toAddressingModeFactory(f))};if(c){c=(yield w(c,a,{forceDirectMessage:!1,normalizeAddressingModeFn:g}));return c!=null?c:b}return e?A(e,a,{normalizeAddressingModeFn:g}):b});return v.apply(this,arguments)}function w(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(a)));a=a.map(function(a){return d("WAWebWidFactory").createWid(a.receiverUserJid)});if(a.length===0)return null;var e=b.skDistribList;b=b.skList;var f=new Set([].concat(e,b).map(d("WAWebWidFactory").asUserWidOrThrow).map(String));a=a.filter(function(a){var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a));return!f.has(String(a))&&!(b!=null&&f.has(String(b)))});a=c.normalizeAddressingModeFn(a).filter(Boolean);if(c.forceDirectMessage===!1&&a.length===0)return null;c=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:a}));return{type:o.DIRECT,deviceList:[].concat(c,b,e)}});return x.apply(this,arguments)}function y(a,b,c){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(a)));if(a.length===0)return null;var e=b.skDistribList;b=b.skList;var f=new Set(e.concat(b).map(function(a){return String(d("WAWebWidFactory").asUserWidOrThrow(a))}));a=a.filter(function(a){return!f.has(a.receiverUserJid)}).map(function(a){return d("WAWebWidFactory").createWid(a.receiverUserJid)});if(a.length===0&&c!==!0)return null;c=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:a}));a=[].concat(c,b,e);return{type:o.DIRECT,deviceList:a}});return z.apply(this,arguments)}function A(a,b,c){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(a)));var e=b.skDistribList;b=b.skList;var f=new Set(e.concat(b).map(function(a){return String(d("WAWebWidFactory").asUserWidOrThrow(a))})),g=function(a){return d("WAWebMaybe").ifSome(d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a)),function(a){return f.has(String(a))})};e=a.map(function(a){return d("WAWebWidFactory").createWid(a.receiverUserJid)}).filter(function(a){return f.has(String(a))||g(a)});b=c.normalizeAddressingModeFn(e).filter(Boolean);a=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:b}));return{type:o.DIRECT,deviceList:[].concat(a)}});return B.apply(this,arguments)}function a(a,c,e){var f,g=a.data,l=g.id,m=g.to;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: queued ",""])),l).tags("messaging");(f=e.sendPerfReporter)==null||f.startWaitingToEncryptStage();return d("WAWebSendMsgQueueMap").sendMsgQueueMap.enqueue(m.toString(),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b,f;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: sending ",""])),l).tags("messaging");(b=e.sendPerfReporter)==null||b.postWaitingToEncryptStage();(b=e.sendPerfReporter)==null||b.startReadyToSendStage();b=D(c);var h=F(c),n=E(c),p=(yield d("WAWebGroupMsgSendUtils").getParticipantRecord(m.toString())),q=(yield d("WAWebGroupMsgSendUtils").getGroupData(m.toString(),p,a));(f=e.sendReporter)==null||f.setGroupData(q);(f=e.sendPerfReporter)==null||f.setGroupData(q);f=(f=p==null?void 0:p.participants.map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)}))!=null?f:[];f=(yield d("WAWebMsgRcatUtils").genContentBindingForMsg(g,f));var s=Boolean(q.isLidAddressingMode);if(q.isCag===!0){var t=Boolean(q.amIAdmin);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: Incognito CAG "," "])),t?"admin":"non-admin").tags("messaging");n=(yield r(a,m,b,n,h,t,p,s))}else{d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendGroupMsg: "," group size: ",""])),d("WAWebGroupMsgSendUtils").formatGroupTypeForLog(q),p==null?void 0:p.participants.length).tags("messaging");t=(yield u(m,p,b,h,s));n=C(t,q)}p=(q==null?void 0:q.isCapiGroup)===!0?d("WAWebE2EProtoGenerator").updateGroupMsgProtoWithCapiFlag(c):c;if(n.type===o.DIRECT){b=n;h=b.deviceList;(s=e.sendReporter)==null||s.setDeviceCount(h.length);(t=e.sendPerfReporter)==null||t.setIsDirectedMessage(!0);return d("WAWebSendGroupDirectJob").encryptAndSendGroupDirectMsg(a,p,h,q,e)}b=n;s=b.senderKeyList;(t=e.sendReporter)==null||t.setDeviceCount(s.skList.length+s.skDistribList.length);return d("WAWebSendGroupSkmsgJob").encryptAndSendSenderKeyMsg(a,p,s,q,e,f)}))}function C(a,b){var e=b.isLidAddressingMode===!0?p:q;switch(a.type){case o.DIRECT:var f=a.deviceList.filter(e);if(f.length<a.deviceList.length){var g=d("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(a.deviceList),h=d("WAWebGroupMsgSendUtils").formatGroupTypeForLog(b);d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.deviceList"])),g,h).sendLogs("GroupLidInfra/outgoing_message")}return babelHelpers["extends"]({},a,{deviceList:f});case o.SKMSG:g=a.senderKeyList;h=g.skDistribList;f=g.skList;g=h.filter(e);if(g.length<h.length){h=d("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(h);var i=d("WAWebGroupMsgSendUtils").formatGroupTypeForLog(b);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.senderKeyList.skDistribList"])),h,i).sendLogs("GroupLidInfra/outgoing_message")}h=f.filter(e);if(h.length<f.length){i=d("WAWebGroupMsgSendUtils").formatWidTypeCountsForLog(f);e=d("WAWebGroupMsgSendUtils").formatGroupTypeForLog(b);d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose([""," found in "," group groupSendingList.senderKeyList.skList"])),i,e).sendLogs("GroupLidInfra/outgoing_message")}return babelHelpers["extends"]({},a,{senderKeyList:babelHelpers["extends"]({},a.senderKeyList,{skDistribList:g,skList:h})});default:a.type;throw c("err")("filterIncorrectlyAddressedDevices - Invalid type: "+a.type)}}function D(a){a=a.protocolMessage;var b=null;if((a==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE&&a!=null&&a.key){a=a.key;var e=a.remoteJid,f=a.id;a=a.participant;!c("isStringNullOrEmpty")(e)&&!c("isStringNullOrEmpty")(f)&&!c("isStringNullOrEmpty")(a)&&(b=new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").createWid(e),fromMe:!0,id:f,participant:d("WAWebWidFactory").createWid(a)}))}return b}function E(a){a=a.keepInChatMessage;if(a!=null&&a.key){a=a.key;var b=a.remoteJid,e=a.id;a=a.participant;if(!c("isStringNullOrEmpty")(b)&&!c("isStringNullOrEmpty")(e)&&!c("isStringNullOrEmpty")(a)){b=new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").createWid(b),fromMe:!0,id:e,participant:d("WAWebWidFactory").createWid(a)});return b}}return null}function F(a){a=a.protocolMessage;var b=null;if((a==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT&&a!=null&&a.key){a=a.key;var e=a.remoteJid,f=a.id;a=a.participant;!c("isStringNullOrEmpty")(e)&&!c("isStringNullOrEmpty")(f)&&!c("isStringNullOrEmpty")(a)&&(b=new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").createWid(e),fromMe:!0,id:f,participant:d("WAWebWidFactory").createWid(a)}))}return b}g.GROUP_MSG_TYPE=o;g.getCagMessageSendList=r;g.getGroupSendListForRevoke=w;g.encryptAndSendGroupMsg=a;g.filterIncorrectlyAddressedDevices=C}),98);
__d("WAWebSendGroupSkmsgJob",["Promise","WADeprecatedSendIq","WALogger","WATimeUtils","WAWap","WAWebAck","WAWebAdvSignatureApi","WAWebApiMessageInfoStore","WAWebApiParticipantStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebBotGating","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCreateNackFromStanza","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebEncryptMsgProtobuf","WAWebGetGroupKeyDistributionMsg","WAWebGroupHandleAddressingModeMismatch","WAWebGroupMsgSendUtils","WAWebGroupQueryBridge","WAWebHandleMsgCommon","WAWebManageE2ESessionsJob","WAWebMsgGetters","WAWebPhashUtils","WAWebPostPrekeysDepletionMetric","WAWebReportingTokenUtils","WAWebResendGroupMsg","WAWebSchemaMessage","WAWebSendMsgCommonApi","WAWebSendMsgMetaNode","WAWebSendMsgTypes","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageType","WAWebWamEnumMismatchOriginType","WAWebWamEnumPrekeysFetchContext","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","cr:10198","cr:10199","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;(e=a.sendPerfReporter)==null||e.startPrekeysFetchStage();(e=a.sendPerfReporter)==null||e.setFetchedPrekeyCount(0);if(b.length>0)try{var f;e=(yield d("WAWebManageE2ESessionsJob").ensureE2ESessions(b));(f=a.sendPerfReporter)==null||f.setFetchedPrekeyCount(e==null?void 0:e.missedPrekeyCount);d("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:e==null?void 0:e.depletedPrekeyCount,prekeysFetchReason:d("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP,deviceSizeBucket:c.deviceSizeBucket})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: failed for "," devices: ",""])),b.length,a).tags("messaging").devConsole(a)}(f=a.sendPerfReporter)==null||f.postPrekeysFetchStage()});return r.apply(this,arguments)}function s(a,b,c,d,e,f,g,h){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h,i){var j,k;(j=h.sendPerfReporter)==null||j.startClientEncryptStage();j=d("WAWebSendMsgCommonApi").encodeAndPad(f);var l=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(f);k=d("WAWebBotGating").isBotEnabled()&&((k=a.invokedBotWid)==null?void 0:k.isBot())===!0;var m=d("WAWebBotGating").isBotEnabled()&&d("WAWebMsgGetters").getIsBotFeedbackMessage(a),n=d("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(a);j=(yield d("WAWebEncryptMsgProtobuf").encryptMsgSenderKey(a,b,j,g));g=j.ciphertext;j=j.senderKeyBytes;var o;c.length>0&&(o=(yield d("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(a,b,c,j,!1)));(b=h.sendPerfReporter)==null||b.postClientEncryptStage();c=null;j=!1;o&&o.length>0&&!m?c=d("WAWap").wap("participants",null,o.map(function(a){var b=a.type,c=a.ciphertext;a=a.participant;b===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(j=!0);var e=i==null?void 0:i.get(d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").asUserWidOrThrow(a)));e=e!=null?d("WAWap").wap("content_binding",null,e):null;return d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)},d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(b),"decrypt-fail":d("WAWebBackendJobsCommon").encodeMaybeDecryptFail(d("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(f))},c),e)})):i!=null&&(c=d("WAWap").wap("participants",null,e.map(function(a){var b=i==null?void 0:i.get(d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").asUserWidOrThrow(a)));return b!=null?d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)},d("WAWap").wap("content_binding",null,b)):null})));h=m?null:d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(l),"decrypt-fail":d("WAWebBackendJobsCommon").encodeMaybeDecryptFail(d("WAWebE2EProtoUtils").decryptFailAttributeFromProtobuf(f))},g);b=null;e=k||m||n?yield w(a,f):[null,!1];l=e[0];g=e[1];if(j||g){k=(yield d("WAWebAdvSignatureApi").getADVEncodedIdentity());b=d("WAWap").wap("device-identity",null,k)}return{keyDistributionMsg:c,skeyEncryptedGroupMsg:h,identityNode:b,botMsgNode:l}});return t.apply(this,arguments)}function a(a,b,c,d,e,f){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,r){var t,u=a.data,w=u.id,x=u.to;u=a.data;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: sending ",""])),w).tags("messaging");var y=w.id,z=f.skDistribList,A=f.skList;f=f.rotateKey;v(x,h);(t=h.sendPerfReporter)==null||t.setSenderKeyDistributionCount(z.length);t=A.concat(z);var B=d("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow(),C=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();B=d("WAWebGroupMsgSendUtils").isCagAddon(u,g)||(g==null?void 0:g.isLidAddressingMode)===!0?B:C;C=(yield d("WAWebPhashUtils").phashV2([].concat(t,[B])));var D=d("WAWebMsgGetters").getIsBotFeedbackMessage(u);yield d("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(t.map(function(a){return{msgKey:w,receiverId:a}}));f&&(yield d("WAWebSignal").Session.deleteGroupSenderKeyInfo(x,B));yield q(h,z,g);f=(yield s(u,x,z,A,e,g,h,r));A=f.keyDistributionMsg;var E=f.skeyEncryptedGroupMsg,F=f.identityNode;f=f.botMsgNode;r=r==null?void 0:r.get(d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").asUserWidOrThrow(B)));B=r!=null?d("WAWap").wap("sender_content_binding",null,r):null;r=g.isLidAddressingMode===!0?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn;var G=(yield d("WAWebReportingTokenUtils").genReportingTokenBody(u,e));D=d("WAWap").wap("message",{id:d("WAWap").CUSTOM_STRING(y),to:d("WAWebCommsWapMd").CHAT_JID(x),phash:D?d("WAWap").DROP_ATTR:d("WAWap").CUSTOM_STRING(C),type:d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(e),edit:d("WAWebSendMsgCommonApi").editAttribute(e,u.subtype),addressing_mode:d("WAWap").CUSTOM_STRING(r)},A,E,F,d("WAWebSendMsgMetaNode").genMetaNode(x,a,e,g,{}),f,B,G);yield d("WAWebSendMsgCommonApi").updateIdentityRange(a,t);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();(E=h.sendPerfReporter)==null||E.postReadyToSendStage();(F=h.sendPerfReporter)==null||F.startWrittenWireStage();b("cr:10199")==null||b("cr:10199").printEncNode(e);f=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(D,d("WAWebCommsAckParser").toCoreAckTemplate({id:y,"class":"message",from:x,participant:null})));if(A){(B=h.sendReporter)==null||B.setMessageDistributionType(d("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.SENDER_KEY_DISTRIBUTION_MESSAGE)}(G=h.sendPerfReporter)==null||G.postWrittenWireStage();h.sendPerfReporter=null;(E=h.sendReporter)==null||E.postSuccess();h.sendReporter=null;F=d("WAWebSendMsgCommonApi").sendMsgAckSyncParser.parse(f);if(F.error){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: invalid ack from server for ",""])),u.id).tags("messaging");return(p||(p=b("Promise"))).reject(c("err")("[messaging] encryptAndSendSenderKeyMsg: Invalid ack from server"))}D=F.success.error;if(D===d("WAWebCreateNackFromStanza").NackReason.StaleGroupAddressingMode){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: ack with error code 421"]))).tags("messaging");(p||(p=b("Promise"))).resolve().then(function(){return d("WAWebGroupQueryBridge").sendQueryGroup(x)})["catch"](function(a){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: sendQueryGroup failed after ack. error: ",""])),a).tags("messaging")});a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message&&void a.data.updateAck(d("WAWebAck").ACK.FAILED,!1);return p.reject(c("err")("[messaging] encryptAndSendSenderKeyMsg: ack with error code 421"))}yield d("WAWebApiParticipantStore").markHasSenderKey(x,z);y=F.success;A=y.phash;B=y.count;G=y.addressingMode;A!=null&&A!==C?(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendSenderKeyMsg: phash mismatch for ",", got server phash ",""])),u.id,A).tags("messaging"),void d("WAWebResendGroupMsg").resendPersistedGroupMsgWrapper({isDirect:!1,msgRecord:a,msgProtobuf:e,oldList:t,ackTime:d("WATimeUtils").unixTime(),groupData:g,metricReporter:h,serverAddressingMode:G})["catch"](function(b){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend group msg: ",", type: ",""])),a.data.id.toString(),a.data.type).tags("messaging"),d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["resendGroupMsg: failed to resend group msg: ",""])),b).tags("messaging").sendLogs("message-resend-failed",{sampling:.01})})):G!=null&&G!==r&&void d("WAWebGroupHandleAddressingModeMismatch").handleAddressingModeMismatch(x,{localAddressingMode:r,serverAddressingMode:G,mismatchOrigin:d("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE.ACK_OUTGOING_MESSAGE});B!=null&&void d("WAWebSchemaMessage").getMessageTable().merge(String(w),{count:B});return F.success});return u.apply(this,arguments)}function v(a,b){a=d("WAWebUserPrefsGeneral").markUserSentMessageToChat(a);if(a){(a=b.sendPerfReporter)==null||a.setMessageIsFirstUserMessage(!0);(a=b.sendReporter)==null||a.setMessageIsFirstUserMessage(!0)}}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebMsgGetters").getIsBotFeedbackMessage(a),e=null,f=d("WAWebMsgGetters").getIsRevokeForMsgFromOrDeliveredToBot(a);if(c){var g;e=(g=a.protocolMessageKey)==null?void 0:g.participant}else f?e=a.botRespOrInvocationRevokeBotWid:e=a.invokedBotWid;if(!e||!e.isBot())return[null,!1];yield d("WAWebApiMessageInfoStore").createOrMergeReceiptRecords([{msgKey:a.id,receiverId:e}]);g=!1;yield d("WAWebManageE2ESessionsJob").ensureE2ESessions([e]);b=d("WAWebE2EProtoGenerator").updateBotInvokeMsgProtoCopyForCapi(b,a.botMessageSecret);f&&e.isFbidBot()&&(b=d("WAWebE2EProtoGenerator").updateFbidBotInvokeProtobuf(b));f=(yield d("WAWebEncryptMsgProtobuf").encryptMsgProtobuf(e,0,b,a,0));b=f.type;a=f.ciphertext;b===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(g=!0);f=d("WAWap").wap("bot",{type:c?"feedback":d("WAWap").DROP_ATTR},d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(e)},d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(b)},a)));return[f,g]});return x.apply(this,arguments)}g.encryptAndSendSenderKeyMsg=a}),98);
__d("WAWebGalaxyFlowCloseEvent",["WAWebEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return"galaxy_flow_"+a+"_"+b}b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.handleClose=function(a){this.trigger(a)};return b}(c("WAWebEventEmitter"));d=new b();g.getGalaxyFlowCloseEventKey=a;g.GalaxyFlowCloseEvent=d}),98);
__d("WAWebNonMessageDataRequestHandlerGalaxyFlow",["WALogger","WAWebGalaxyFlowCloseEvent","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){a=a.galaxyFlowAction;if(a==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: galaxyFlowAction is null in peer data operation request"])));return}var b=a.flowId;a=a.stanzaId;if(b==null||a==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: missing required field - flowId="," stanzaId=",""])),b!=null?b:"null",a!=null?a:"null");return}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["galaxy flow: received NOTIFY_LAUNCH request with flowId="," stanzaId=",""])),b,a);d("WAWebGalaxyFlowCloseEvent").GalaxyFlowCloseEvent.trigger(d("WAWebGalaxyFlowCloseEvent").getGalaxyFlowCloseEventKey(b,a))}function b(a){var b=a.flowId;a=a.stanzaId;return b==null||a==null?null:{type:d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestMessage$GalaxyFlowAction$GalaxyFlowActionType.NOTIFY_LAUNCH,flowId:b,stanzaId:a}}g.handleGalaxyFlowLaunchRequest=a;g.buildGalaxyFlowDataOperationRequest=b}),98);
__d("WAWebSyncdSnapshotRecoveryGatingUtils",["WASyncdConst","WAWebABProps","WAWebSyncdError","WAWebUserPrefsIndexedDBStorage","WAWebWamEnumRecoveryStatusEnum","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAPrimaryDeviceSupportsSyncdRecovery")===!0}function i(){return!h()?!1:d("WAWebABProps").getABPropConfigValue("enable_peer_snapshot_recovery")}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAPrimaryDeviceSupportsSyncdRecovery",a)});return j.apply(this,arguments)}function c(a,b,c){if(!(c instanceof d("WAWebSyncdError").SyncdFatalError))return{shouldPerformRecovery:!1,reason:d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.NOT_FATAL};if(!i())return{shouldPerformRecovery:!1,reason:h()?d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.ABPROP_OFF:d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.PRIMARY_UNSUPPORTED};if(a===d("WASyncdConst").CollectionName.CriticalBlock)return{shouldPerformRecovery:!1,reason:d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.COLLECTION_UNSUPPORTED};c=d("WAWebABProps").getABPropConfigValue("max_mutations_for_sync_recovery");return b>c?{shouldPerformRecovery:!1,reason:d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.MUTATION_COUNT_TOO_HIGH}:{shouldPerformRecovery:!0}}g.syncdSnapshotRecoveryEnabled=i;g.updatePrimaryDeviceSupportsSyncdRecovery=a;g.shouldPreformSnapshotRecovery=c}),98);
__d("WAWebSendNonMessageDataRequest",["Promise","WALogger","WANullthrows","WAShiftTimer","WATimeUtils","WAWebABProps","WAWebApiPeerMessageStore","WAWebCommsWapMd","WAWebCurrentUser","WAWebDBDeviceListFanout","WAWebE2EProtoUtils","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMsgKey","WAWebMsgType","WAWebNonMessageDataRequestHandlerGalaxyFlow","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebNonMessageDataRequestLoggingUtils","WAWebNonMessageDataRequestMediaHandlingUtils","WAWebNonMessageDataRequestPlaceholderMessageResendUtils","WAWebProtobufsE2E.pb","WAWebSendAppStateSyncMsgJob","WAWebSendMsgCreateDeviceStanza","WAWebSyncGatingUtils","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumPeerDataResponseApplyResultType","WAWebWidFactory","asyncToGeneratorRuntime","gkx","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=3e3;function a(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=e!=null?e:{},g=f.skipStoringMessage;f=(yield y(a,c));if(f==null){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[rdu] the constructed peer data operation request object is null"])));return}c=(yield A(f,e));if(c==null||c.length===0){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[rdu] the constructed peer data operation request message is null or empty"])));return}var h=K(a),i=L(a);yield (v||(v=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[rdu] build rdu message successfully, ## type: ",", ## msg: ",""])),a,b.id.id).devConsole(b),I(a,b),d("WAWebNonMessageDataRequestLoggingUtils").logNonMessagePeerDataRequest(a,b),g!==!0&&(yield d("WAWebApiPeerMessageStore").storePeerMessages([b])),d("WAWebNonMessageDataRequestLoggingUtils").sendTimes.set(b.id.id,d("WATimeUtils").unixTimeMs()),yield d("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:b,pushPriority:h!=null?h:void 0,privacySensitive:i!=null?i:void 0})});return function(a){return c.apply(this,arguments)}}()))});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[rdu] start building rdu request object, ## type: ",""])),a);var c={peerDataOperationRequestType:a,requestUrlPreview:[],requestStickerReupload:[],placeholderMessageResendRequest:[]};switch(a){case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP:break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.WAFFLE_LINKING_NONCE_FETCH:break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:a=C(b);if(a==null)return null;c.requestStickerReupload=a;break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:a=D(b);if(a==null)return null;c.requestUrlPreview=a;break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:a=(yield F(b));if(a==null)return null;c.historySyncOnDemandRequest=a;break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:a=H(b);if(a==null)return null;c.placeholderMessageResendRequest=a;break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.FULL_HISTORY_SYNC_ON_DEMAND:d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["full history sync on demand not supported in web"])));break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_META_NONCE_FETCH:d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["companion meta nonce fetch is not supported in web"])));break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_CANONICAL_USER_NONCE_FETCH:d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["companion canonical user nonce fetch is not supported in web"])));break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:if(d("WAWebSyncdSnapshotRecoveryGatingUtils").syncdSnapshotRecoveryEnabled()===!1){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Syncd Snapshot recovery is not enabled"])));return null}a=E(b);if(a==null)return null;c.syncdCollectionFatalRecoveryRequest=a;break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_CHUNK_RETRY:d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["history sync chunk retry is not supported in web"])));break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GALAXY_FLOW_ACTION:a=d("WAWebNonMessageDataRequestHandlerGalaxyFlow").buildGalaxyFlowDataOperationRequest(b);if(a==null)return null;c.galaxyFlowAction=a;break}return c});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e!=null?e:{};var f=e.fanout;e=e.msgId;if(f){f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();f=f.isLid()?(f=d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid())!=null?f:d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow():d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();f={wids:[f]};f=(yield d("WAWebDBDeviceListFanout").getFanOutList(f));var g=(yield (v||(v=b("Promise"))).all(f.map(function(a){return c("WAWebMsgKey").newId()})));return f.map(function(b,e){return{id:new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:g[e]}),to:b,type:"protocol",subtype:"peer_data_operation_request_message",kind:d("WAWebMsgType").MsgKind.PeerMessage,peerDataOperationRequestMessage:a}})}f=new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:e!=null?e:yield c("WAWebMsgKey").newId()});return[{id:f,to:d("WAWebWidFactory").createDeviceWidFromUserAndDevice(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user,d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().server,0),type:"protocol",subtype:"peer_data_operation_request_message",kind:d("WAWebMsgType").MsgKind.PeerMessage,peerDataOperationRequestMessage:a}]});return B.apply(this,arguments)}function C(a){var b;a=a.fileSha256Arr;a=a==null||(b=a.filter(function(a){return!d("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests.has(a)}))==null?void 0:b.map(function(a){J(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,d("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests,a);return{fileSha256:a}});return(a==null?void 0:a.length)===0?null:a}function D(a){var b=a.urls;return b==null?void 0:b.map(function(b){return{url:b,includeHqThumbnail:a.includeHqThumbnail}})}function E(a){return{collectionName:c("WANullthrows")(a.collectionName),timestamp:a.timestamp}}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled())return null;if(d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_request_send_killswitch")&&d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").historySyncOnDemandRequestsFailureRecord.disableRequestSending){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[rdu] stop sending history sync on demand request as it fails too many times"])));return null}a=a.chatId;if(a==null)return null;var b=d("WAWebCommsWapMd").CHAT_JID(a).toString();if(new Set(d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests.values()).has(b)){d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[rdu] drop history sync on demand request as it's in flight"])));return null}a=(yield d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").getOldestMsgInChatFromDB(a));var c=(yield d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_message_count"));return{chatJid:b,oldestMsgId:a==null?void 0:a.id.id,oldestMsgFromMe:a==null?void 0:a.id.fromMe,onDemandMsgCount:c,oldestMsgTimestampMs:a==null?void 0:a.t}});return G.apply(this,arguments)}function H(a){if(!d("WAWebSyncGatingUtils").isPlaceholderMessageResendEnabled())return null;a=a.msgKeys;if(a==null||a.length===0)return null;d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[rdu] send placeholder message backfill request for ",""])),a.map(function(a){return a.toString()}));return a.filter(function(a){return!d("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests.has(a.id)}).map(function(a){J(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND,d("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests,a.id);var b=a.remote.isRegularUser()?d("WAWebLidMigrationUtils").toUserLid(a.remote):null;b=a.remote.isRegularUser()&&d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?new(c("WAWebMsgKey"))({id:a.id,fromMe:a.fromMe,remote:b!=null?b:a.remote}):a;return{messageKey:d("WAWebE2EProtoUtils").msgKeyToProtobuf(b)}})}function I(a,b){switch(a){case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER:a=(a=b.peerDataOperationRequestMessage)==null?void 0:a.requestStickerReupload;a!=null&&a.forEach(function(a){a=a.fileSha256;if(a!=null){d("WAWebNonMessageDataRequestMediaHandlingUtils").inFlightStickerRequests.add(a);d("WAWebNonMessageDataRequestMediaHandlingUtils").mediaReuploadRequestCountMap.set(a,((a=d("WAWebNonMessageDataRequestMediaHandlingUtils").mediaReuploadRequestCountMap.get(a))!=null?a:0)+1)}});break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:a=(a=b.peerDataOperationRequestMessage)==null?void 0:a.historySyncOnDemandRequest;if(a!=null){var e=(a=a.chatJid)!=null?a:"";d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests.set(b.id.id,e);a=d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_timeout_ms");var f=function(){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync][rdu] dropping history sync on demand response as it's timeout with key ","."])),c("gkx")("26258")?"":b.id.id),d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").handleHistorySyncOnDemandFailure(e),d("WAWebNonMessageDataRequestLoggingUtils").logHistorySyncOnDemandResponse(d("WAWebWamEnumPeerDataResponseApplyResultType").PEER_DATA_RESPONSE_APPLY_RESULT_TYPE.REQUEST_TIMEOUT,b.id.id)};J(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND,d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").inFlightHistorySyncOnDemandRequests,b.id.id,a,f)}break;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:f=(a=b.peerDataOperationRequestMessage)==null?void 0:a.placeholderMessageResendRequest;f!=null&&f.forEach(function(a){a=(a=a.messageKey)==null?void 0:a.id;a!=null&&d("WAWebNonMessageDataRequestPlaceholderMessageResendUtils").inFlightPlaceholderResendRequests.add(a)});break;default:break}}function J(a,b,e,f,g){f===void 0&&(f=w),new(d("WAShiftTimer").ShiftTimer)(function(){b.has(e)&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[rdu] clean rdu message request (regardless of success status). key ",", ## type: ",""])),c("gkx")("26258")?"":e,a),b["delete"](e),g==null||g())}).onOrAfter(f)}function K(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.GENERATE_LINK_PREVIEW:return d("WAWebSyncGatingUtils").isWebLinkPreviewNseSupportEnabled()?"high_force":null;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND:return d("WAWebSyncGatingUtils").isMessagePlaceholderResendNseSupportEnabled()?"high_force":null;case d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND:return d("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()?"high_force":null;default:return null}}function L(a){if(d("WAWebCurrentUser").isEmployee()&&!c("justknobx")._("4199")&&a===d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.HISTORY_SYNC_ON_DEMAND)return d("WAWebSendMsgCreateDeviceStanza").PrivacySensitiveType.OnDemand}g.sendPeerDataOperationRequest=a}),98);
__d("WAWebEncryptAndSendStatusMsg",["WADeprecatedSendIq","WAJids","WALogger","WANullthrows","WAWap","WAWebAdvSignatureApi","WAWebApiContact","WAWebApiMessageInfoStore","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebCommsAckParser","WAWebCommsWapMd","WAWebDBDeviceListFanout","WAWebE2EProtoUtils","WAWebGetGroupKeyDistributionMsg","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebManageE2ESessionsJob","WAWebMsgFanoutTypes","WAWebMsgKey","WAWebPostPrekeysDepletionMetric","WAWebProtobufsE2E.pb","WAWebReportingTokenUtils","WAWebSchemaMessageInfo","WAWebSendMsgCommonApi","WAWebSendMsgCreateFanoutStanza","WAWebSignal","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsStatus","WAWebUserPrefsStatusType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageType","WAWebWamEnumPrekeysFetchContext","WAWebWamNumberToSizeBucket","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(a)));b.length===0&&(b=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().equals(["msgKey"],String(d("WAWebLidMigrationUtils").getAlternateMsgKey(a)))));return b.map(function(a){return d("WAWebLidStatusMigrationUtils").matWidConvert(d("WAWebWidFactory").createWid(a.receiverUserJid))})});return s.apply(this,arguments)}function a(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=a.data.id,g=d("WAWebLidStatusMigrationGating").getLidStatusSendEnabled(),p=d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID),q=g?c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid()):d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),s=x(b),t,v=(yield c("WAWebUserPrefsStatus").getStatusList());g&&(v.list=v.list.map(function(a){return d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(a))}).filter(Boolean).map(function(a){return a}));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start to send ",", revoke: ",""])),f.id,s).devConsole(b);if(s){(g=e.sendPerfReporter)==null||g.setIsRevokeMessage(!0);g=(yield r(s));if(y(g,v.list)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start to send direct revoke message"])));s=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:[].concat(g,[q])}));return z(a,b,s,e)}s=g}else{if(v.list.length===0)return;s=v.list;t=d("WAWap").wap("meta",{status_setting:w(v.setting)})}g=(yield d("WAWebDBDeviceListFanout").getFanOutList({wids:[].concat(s,[q])}));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: all device list size ",""])),g.length);v=(yield c("WAWebUserPrefsStatus").getStatusSkDistribList(g));s=v.skDistribList;v=v.participantList;if(s.length>0){var A;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: distribute "," sender key"])),s.length);(A=e.sendReporter)==null||A.setMessageDistributionType(d("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.SENDER_KEY_DISTRIBUTION_MESSAGE);(A=e.sendReporter)==null||A.setDeviceCount(s.length);(A=e.sendPerfReporter)==null||A.setSenderKeyDistributionCount(s.length)}yield d("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(g.map(function(a){return{msgKey:f,receiverId:a}}));d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: create receipts records"])));if(s.length>0)try{var B;(A=e.sendPerfReporter)==null||A.startPrekeysFetchStage();A=(yield d("WAWebManageE2ESessionsJob").ensureE2ESessions(s));(B=e.sendPerfReporter)==null||B.setFetchedPrekeyCount(A==null?void 0:A.missedPrekeyCount);d("WAWebPostPrekeysDepletionMetric").maybePostPrekeysDepletionMetric({count:A==null?void 0:A.depletedPrekeyCount,prekeysFetchReason:d("WAWebWamEnumPrekeysFetchContext").PREKEYS_FETCH_CONTEXT.SEND_MESSAGE,messageType:d("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS,deviceSizeBucket:c("WAWebWamNumberToSizeBucket")(g.length)})}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: ensureE2ESessions: failed for "," devices: ",""])),s.length,a).tags("messaging").devConsole(a)}(B=e.sendPerfReporter)==null||B.postPrekeysFetchStage();(A=e.sendPerfReporter)==null||A.startClientEncryptStage();g=(yield u(p,q,s,v,b));B=g[0];A=g[1];q=g[2];d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: encrypt message body done"])));v=(yield d("WAWebReportingTokenUtils").genReportingTokenBody(a.data,b));g=d("WAWap").wap("message",{id:d("WAWap").CUSTOM_STRING(f.id),to:d("WAWebCommsWapMd").CHAT_JID(p),type:d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(b),edit:d("WAWebSendMsgCommonApi").editAttribute(b,a.data.subtype)},B,A,q,t,v);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();(b=e.sendPerfReporter)==null||b.postClientEncryptStage();(a=e.sendPerfReporter)==null||a.startWrittenWireStage();d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusMsg: start sending ",""])),f.id);yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(g,d("WAWebCommsAckParser").toCoreAckTemplate({id:f.id,"class":"message",from:p,participant:null}));(B=e.sendPerfReporter)==null||B.postWrittenWireStage();yield c("WAWebUserPrefsStatus").markStatusHasSenderKey(s)});return t.apply(this,arguments)}function u(a,b,c,d,e){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g=d("WAWebSendMsgCommonApi").encodeAndPad(f);f=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(f);b=(yield d("WAWebSignal").Cipher.encryptSenderKeyMsgSignalProto(a,b,g));g=b.ciphertext;b=b.senderKeyBytes;var h;c.length>0&&(h=(yield d("WAWebGetGroupKeyDistributionMsg").getKeyDistributionMsg(null,a,c,b,!1)));a=[];c=[];b=!1;var i=null;h&&h.length>0&&(a=h.map(function(a){var c=a.type,e=a.ciphertext;a=a.participant;c===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg&&(b=!0);return d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)},d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(c)},e))}));c=e.map(function(a){return d("WAWap").wap("to",{jid:d("WAWebCommsWapMd").USER_JID(a)})});(c.length>0||a.length>0)&&(i=d("WAWap").wap("participants",null,a.concat(c)));e=d("WAWap").wap("enc",{v:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobsCommon").CIPHERTEXT_VERSION.toString()),type:d("WAWap").CUSTOM_STRING(d("WAWebBackendJobs.flow").CiphertextType.Skmsg),mediatype:d("WAWebBackendJobsCommon").encodeMaybeMediaType(f)},g);a=null;if(b){c=(yield d("WAWebAdvSignatureApi").getADVEncodedIdentity());a=d("WAWap").wap("device-identity",null,c)}return[i,e,a]});return v.apply(this,arguments)}function w(a){switch(a){case d("WAWebUserPrefsStatusType").StatusPrivacySettingType.AllowList:return"allowlist";case d("WAWebUserPrefsStatusType").StatusPrivacySettingType.DenyList:return"denylist";case d("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact:return"contacts"}}function x(a){a=a.protocolMessage;var b=null;if((a==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE&&a!=null&&a.key){a=a.key;var e=a.remoteJid,f=a.id;a=a.participant;e!=null&&f!=null&&a!=null&&(b=new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").createWid(e),fromMe:!0,id:f,participant:d("WAWebWidFactory").createWid(a)}))}return b}function y(a,b){var c=new Set(b.map(function(a){return d("WAWebWidFactory").asUserWidOrThrow(a).toString()}));return a.some(function(a){return!d("WAWebUserPrefsMeUser").isMeAccount(a)&&!c.has(d("WAWebWidFactory").asUserWidOrThrow(a).toString())})}function z(a,b,c,d){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=a.data.id,g=d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID);d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusDirectMsg: send "," to "," device"])),f.id,c.length);a=(yield d("WAWebSendMsgCreateFanoutStanza").createFanoutMsgStanza(a,b,c,{fanoutType:d("WAWebMsgFanoutTypes").FANOUT_TYPE.GROUP_DIRECT},e));b=a.stanza;yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();(c=e.sendPerfReporter)==null||c.startWrittenWireStage();d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["encryptAndSendStatusDirectMsg: start sending ",""])),f.id);yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(b,d("WAWebCommsAckParser").toCoreAckTemplate({id:f.id,"class":"message",from:g,participant:null}));(a=e.sendPerfReporter)==null||a.postWrittenWireStage()});return A.apply(this,arguments)}g.calculateRevokeSenderList=r;g.encryptAndSendStatusMsg=a}),98);
__d("WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],b=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"}],c={alias:null,args:null,kind:"ScalarField",name:"capabilities",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"9801384413216421",metadata:{},name:"WAWebMexFetchNewsletterAdminCapabilitiesJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchNewsletterAdminCapabilitiesJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql","WAWebNewsletterModelUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=h!==void 0?h:h=b("WAWebMexFetchNewsletterAdminCapabilitiesJobQuery.graphql");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={newsletter_id:a};b=(yield d("WAWebMexClient").fetchQuery(j,b));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched admin capabilities"]))).tags("GQL","MEX").devConsole({newsletterJid:a,response:b});b=(a=b.xwa2_newsletter_admin)==null?void 0:a.capabilities;a=b==null?[]:b.map(d("WAWebNewsletterModelUtils").getNewsletterCapabilityFromValue);return new Set(a)});return k.apply(this,arguments)}g.mexFetchNewsletterAdminCapabilities=a}),98);
__d("WAWebQueryDisappearingModeJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("dmParser",function(a){a=a.child("disappearing_mode");return{duration:a.attrInt("duration"),t:a.attrInt("t")}});function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWap").wap("iq",{xmlns:"disappearing_mode",to:d("WAWap").S_WHATSAPP_NET,type:"get",id:d("WAWap").generateId()});a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,h));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);return a.result});return i.apply(this,arguments)}g.queryDisappearingMode=a}),98);
__d("WAWebQueryPrivacySettingsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebPrivacySettings","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;function i(a,b){b=b.maybeChild("error");var c=b&&b.maybeAttrString("code");b=b&&b.maybeAttrString("text");d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getPrivacy error: "," - code "," text ",""])),a,c,b).sendLogs("getPrivacy",{sampling:.01})}var j=new(c("WADeprecatedWapParser"))("privacyParser",function(a){a.assertAttr("type","result");var b={};a.child("privacy").forEachChildWithTag("category",function(a){var c=a.attrString("name");switch(c){case"readreceipts":var e=a.attrEnum("value",d("WAWebPrivacySettings").ALL_NONE_WITH_ERROR);e!=="error"?b.readReceipts=e:i("readreceipts",a);break;case"last":e=a.attrEnum("value",d("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);e!=="error"?b.lastSeen=e:i("last",a);break;case"online":e=a.attrEnum("value",d("WAWebPrivacySettings").ONLINE_VISIBILITY_WITH_ERROR);e!=="error"?b.online=e:i("online",a);break;case"profile":e=a.attrEnum("value",d("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);e!=="error"?b.profilePicture=e:i("profile",a);break;case"status":e=a.attrEnum("value",d("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);e!=="error"?b.about=e:i("status",a);break;case"groupadd":e=a.attrEnum("value",d("WAWebPrivacySettings").VISIBILITY_WITH_ERROR);e!=="error"?b.groupAdd=e:i("groupadd",a);break;case"calladd":e=a.attrEnum("value",d("WAWebPrivacySettings").CALL_ADD_WITH_ERROR);e!=="error"?b.callAdd=e:i("calladd",a);break;case"messages":e=a.attrEnum("value",d("WAWebPrivacySettings").ALL_CONTACTS);b.messages=e;break;case"pix":case"linked_profiles":case"stickers":break;default:i(c+" is unknown type",a);break}});return b});function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=d("WAWap")).wap("iq",{xmlns:"privacy",to:a.S_WHATSAPP_NET,type:"get",id:a.generateId()},a.wap("privacy",null));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,j));if(!a.success)throw c("err")("invalid response");else return a.result});return k.apply(this,arguments)}g.getPrivacy=a}),98);
__d("WAWebQueryPrivacyDisallowedListLidJob",["WALogger","WASmaxPrivacyGetContactBlacklistRPC","WAWebDBCreateLidPnMappings","WAWebJidToWid","WAWebSchemaPrivacyDisallowedList","WAWebSetUsernameJob","WAWebUsernameGatingUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(a===d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About)b="status";else if(a===d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd)b="groupadd";else if(a===d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen)b="last";else if(a===d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture)b="profile";else{d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["invalid privacyType: ",""])),a);throw c("err")("GetContactBlacklist lid request invalid privacyType")}a={getContactBlacklistGetContactBlacklistLIDOrGetContactBlacklistPNMixinGroupArgs:{getContactBlacklistGetContactBlacklistLID:{categoryNamesForContactBlacklistMixinArgs:{anyName:b}}}};b=(yield d("WASmaxPrivacyGetContactBlacklistRPC").sendGetContactBlacklistRPC(a));if(b.name==="GetContactBlacklistResponseError"){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["retrieved response error for GetContactBlacklist lid request"])));throw c("err")("GetContactBlacklist lid request invalid response")}if(b.name==="GetContactBlacklistResponseSuccess"){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["retrieved pn response for GetContactBlacklist lid request"])));throw c("err")("GetContactBlacklist lid request invalid response")}a=b.value;b=a.privacyAddressingMode;a=a.privacyList;if(b!=="lid"){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["response privacyAddressingMode should be lid but it is pn"])));throw c("err")("GetContactBlacklist lid request invalid response")}if(a==null)return{status:"match"};b=a.user;var e=[],f=[];b=b.map(function(a){var b=a.contactListIds;if(b.name==="Username")e.push({userId:d("WAWebJidToWid").lidUserJidToUserLid(a.jid),username:b.value.username});else if(b.name==="PnJid")f.push({lid:d("WAWebJidToWid").lidUserJidToUserLid(a.jid),pn:d("WAWebJidToWid").userJidToUserWid(b.value.pnJid)});else{d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["response contactListIds name is unexpected ",""])),a.contactListIds.name);throw c("err")("GetContactBlacklist lid request invalid response")}return d("WAWebJidToWid").lidUserJidToUserLid(a.jid)});yield d("WAWebDBCreateLidPnMappings").createLidPnMappingsInBatches({mappings:f,flushImmediately:!0,learningSource:"other"});d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&e.length>0&&(yield d("WAWebSetUsernameJob").setUsernamesJob(e));a=a.dhash;return{status:"mismatch",users:b,dhash:a}});return m.apply(this,arguments)}g.queryPrivacyDisallowedListLid=a}),98);
__d("WAWebQueryPrivacyDisallowedListPnJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebJidToWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("getPrivacyDisallowedListParser",function(a){a=a.child("privacy");a=a.maybeChild("list");if(a==null)return{status:"match"};var b=a.mapChildren(function(a){return d("WAWebJidToWid").deviceJidToUserWid(a.attrDeviceJid("jid"))});return{status:"mismatch",users:b,dhash:a.attrString("dhash")}});function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"get",id:b.generateId(),xmlns:"privacy"},b.wap("privacy",null,b.wap("list",{name:b.CUSTOM_STRING(a),value:b.CUSTOM_STRING("contact_blacklist")})));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,h));if(!b.success)throw c("err")("invalid response");else return b.result});return i.apply(this,arguments)}g.queryPrivacyDisallowedListPn=a}),98);
__d("WAWebQueryPrivacyDisallowedListUtil",["WAWebPrivacyGatingUtils","WAWebQueryPrivacyDisallowedListLidJob","WAWebQueryPrivacyDisallowedListPnJob","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return i(a)?d("WAWebQueryPrivacyDisallowedListLidJob").queryPrivacyDisallowedListLid(a):d("WAWebQueryPrivacyDisallowedListPnJob").queryPrivacyDisallowedListPn(a)});return h.apply(this,arguments)}function i(a){switch(a){case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About:return d("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForStatusEnabled();case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd:return d("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForGroupAddEnabled();case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen:return d("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForLastSeenEnabled();case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture:return d("WAWebPrivacyGatingUtils").isPrivacyListLidMigrationForProfilePictureEnabled()}}g.queryPrivacyDisallowedList=a;g.isTypeLidMigrated=i}),98);
__d("WAWebSyncPrivacyDisallowedLists",["Promise","WAWebQueryPrivacyDisallowedListUtil","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebQueryPrivacyDisallowedListUtil").queryPrivacyDisallowedList(a));return{type:a,response:b}});return function(b){return a.apply(this,arguments)}}())));var c=[];a.forEach(function(a){var b=a.response,d=b.status,e=b.users;b=b.dhash;if(d!=="mismatch"||e==null||b==null)return;c.push({id:a.type,disallowedList:e.map(function(a){return a.toString()}),dhash:b})});yield d("WAWebSchemaPrivacyDisallowedList").getPrivacyDisallowedListTable().bulkCreateOrReplace(c);return c});return j.apply(this,arguments)}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield i([a])});return k.apply(this,arguments)}g.syncPrivacyDisallowedLists=i;g.syncSinglePrivacyDisallowedList=a}),98);
__d("WAWebAccountSyncJob",["$InternalEnum","WATimeUtils","WAWebProfilePicThumbCollection","WAWebQueryDisappearingModeJob","WAWebQueryPrivacySettingsJob","WAWebSchemaPrivacyDisallowedList","WAWebSyncDeviceAdvDeviceListJob","WAWebSyncPrivacyDisallowedLists","WAWebTos","WAWebUpdateDisappearingModeForContact","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({BLOCKLIST:"blocklist",OPTOUTLIST:"biz_opt_out_list",DEVICES:"devices",DISAPPEARING_MODE:"disappearing_mode",PICTURE:"picture",PRIVACY:"privacy",STATUS:"status",TOS:"tos",NOTICE:"notice",USER:"user",TEXT_STATUS:"text_status"});function a(a){return d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(d("WAWebUserPrefsMeUser").getMePNandLIDWids(),a,null)}function c(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),b=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(a);return b!=null?d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.resyncPictures([b]):d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.resyncPicturesByWid([a])}function e(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b=(yield d("WAWebQueryPrivacySettingsJob").getPrivacy());d("WAWebUserPrefsGeneral").setUserPrivacySettings(b);a=[(a=d("WAWebSchemaPrivacyDisallowedList")).PrivacyDisallowedListType.About,a.PrivacyDisallowedListType.GroupAdd,a.PrivacyDisallowedListType.LastSeen,a.PrivacyDisallowedListType.ProfilePicture];a=(yield d("WAWebSyncPrivacyDisallowedLists").syncPrivacyDisallowedLists(a));return{privacySettings:b,privacyDisallowedRows:a}});return i.apply(this,arguments)}function f(a){var b=d("WATimeUtils").unixTime();a.forEach(function(a){d("WAWebTos").TosManager.setState(a.id,a.state?"ACCEPTED":"NOT_ACCEPTED",(a=a.timestamp)!=null?a:b)})}function j(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebQueryDisappearingModeJob").queryDisappearingMode());yield d("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),a.duration,a.t)});return k.apply(this,arguments)}g.AccountSyncType=h;g.getDevices=a;g.getAndUpdateProfilePicture=c;g.updatePrivacySettings=e;g.updateTosStateFromAccountSync=f;g.updateDefaultDisappearingMode=j}),98);
__d("WAWebNonAddressBookContactsJob",["WAJids","WALogger","WAWebApiContact","WAWebChatCollection","WAWebChatGetters","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebSchemaChat","WAWebSchemaParticipant","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(a){a===void 0&&(a=500);var b=[],c=[],e=new Set(),f=new Set();for(var g of d("WAWebChatCollection").ChatCollection.toArray())f.size===a&&(b.push(f),f=new Set()),d("WAWebChatGetters").getIsEligibleForContactSync(g)&&(d("WAWebChatGetters").getIsGroup(g)?c.push(g.id):e.has(g.id)||(f.add(g.id),e.add(g.id)));for(g of c){c=d("WAWebChatCollection").ChatCollection.get(g)||{};c=(c=(c=c.groupMetadata)==null?void 0:c.participants.toArray())!=null?c:[];for(c of c)f.size===a&&(b.push(f),f=new Set()),e.has(c.id)||(f.add(c.id),e.add(c.id))}f.size!==0&&b.push(f);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["get "," chunks of contacts from chat collection, chunk size: ",""])),b.length,a).tags("contact-sync");return b}function n(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=new Set();yield d("WAWebSchemaParticipant").getParticipantTable().forEach(function(b){b.participants.forEach(function(b){c("WAWebWid").isStringLid(b)?a.add(d("WAJids").toLidUserJid(d("WAWebWidFactory").createWid(b).user)):a.add(d("WAJids").toPhoneUserJid(d("WAWebWidFactory").createWid(b).user))})});yield d("WAWebSchemaChat").getChatTable().forEach(function(b){c("WAWebWid").isEligibleForUSync(b.id)&&(c("WAWebWid").isStringLid(b.id)?a.add(d("WAJids").toLidUserJid(d("WAWebWidFactory").createWid(b.id).user)):a.add(d("WAJids").toPhoneUserJid(d("WAWebWidFactory").createWid(b.id).user)))});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["found "," contacts from chat and group participant tables"])),a.size).tags("contact-sync");return Array.from(a)});return o.apply(this,arguments)}function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("WAWebLidAwareContactsDB").anyOf(["isAddressBookContact"],[1,0]));a=new Map(a.map(function(a){return[a.id,a.contactHash]}));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["found "," contacts with set isAddressBookContact value from contact table"])),a.size).tags("contact-sync");return a});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.size===0)return;var e=function(a,c){a={id:a,contactHash:d("WAWebApiContact").getContactHash(a)};if(c.isLid()){c=d("WAWebApiContact").getPhoneNumber(c);if(c!=null){var e;c=c.toJid();a.pnContactHash=(e=b.get(c))!=null?e:d("WAWebApiContact").getContactHash(c)}}return a};a=Array.from(a).reduce(function(a,c){var f;try{f=d("WAWebWidFactory").createUserWidOrThrow(c)}catch(b){return a}c=e(c,f);a.push(c);if(f.isLid()){c=d("WAWebApiContact").getPhoneNumber(f);if(c!=null){var g=c.toJid();if(b.get(g)==null){g=e(g,c);a.push(g)}}}else{c=d("WAWebApiContact").getCurrentLid(f);if(c!=null){g=c.toJid();if(b.get(g)==null){g=e(g,c);a.push(g)}}}return a},[]);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["add missing contactHashes to "," contacts"])),a.length).tags("contact-sync");return c("WAWebLidAwareContactsDB").bulkCreateOrMerge(a,"NonAddressBookContactsJob.addMissingContactHashesToContacts")});return s.apply(this,arguments)}function e(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield n());return d("WAWebModelStorageUtils").getStorage().lock(["contact"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield p()),e=new Set(),f=Array.from(a).map(function(a){var c={id:a,isContactSyncCompleted:0};b.has(a)||(c.isAddressBookContact=0);b.get(a)==null&&e.add(a);return c});d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["mark "," contacts dirty during the regular sync"])),f.length).tags("contact-sync");yield c("WAWebLidAwareContactsDB").bulkCreateOrMerge(f,"NonAddressBookContactsJob.getNonAddressBookContactsAndMarkAllContactsDirty");b.forEach(function(a,b){a==null&&e.add(b)});yield r(e,b)}))});return t.apply(this,arguments)}function f(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield n());return d("WAWebModelStorageUtils").getStorage().lock(["contact"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield p()),e=a.filter(function(a){return!b.has(a)});e=e.map(function(a){return{id:a,isAddressBookContact:0,isContactSyncCompleted:0}});d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["get "," non-address book contacts, mark dirty, and update the contact table during the initial sync"])),e.length).tags("contact-sync");yield c("WAWebLidAwareContactsDB").bulkCreateOrMerge(e,"NonAddressBookContactsJob.getAndUpdateNonAddressBookContacts");var f=new Set(a.filter(function(a){return b.get(a)==null}));b.forEach(function(a,b){a==null&&f.add(b)});yield r(f,b)}))});return u.apply(this,arguments)}g.getAllContactsFromChatCollectionIntoChunks=a;g.getNonAddressBookContactsAndMarkAllContactsDirty=e;g.getAndUpdateNonAddressBookContacts=f}),98);
__d("WAWebSyncContactJob",["WAJobOrchestratorTypes","WAWebContactSyncApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){b===void 0&&(b=!0);a={contactIds:a,shouldDelayBetweenChunks:b,mode:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncContactListInChunks",function(a){return d("WAWebContactSyncApi").syncContactListInChunks(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}function b(a,b,c){b===void 0&&(b=!0);a={contactIds:a,shouldSyncDevice:b,mode:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncContactList",function(a){return d("WAWebContactSyncApi").syncContactList(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted(a)}g.syncContactListInChunksJob=a;g.syncContactListJob=b}),98);
__d("WAWebNonMessageDataRequestMediaHandlingUtils",["Promise","WAJobOrchestratorTypes","WATimeUtils","WAWebMediaMmsV4Upload","WAWebOrchestratorNonPersistedJob","WAWebProtobufsE2E.pb","WAWebSchemaNonMessageDataRequest","WAWebSendNonMessageDataRequest","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=15,j=15,k=new Set(),l=new Map(),m=new Map();function a(a){l.clear(),a.forEach(function(a){a.operationType===d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD&&l.set(a.id,a)})}function c(){m.clear();return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("requestAllSyncdMissingKeys",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WATimeUtils").unixTime(),b=d("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable();b=(yield b.all());b.filter(function(b){if(b.operationType!==d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD)return!1;if(b.requestType!==d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER)return!1;if(b.lastRequestTimeStampSec!=null&&a-b.lastRequestTimeStampSec>48*d("WATimeUtils").HOUR_SECONDS)return!1;return b.requestRetryCount!=null&&b.requestRetryCount>=3?!1:!0});d("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,{fileSha256Arr:b.map(function(a){return a.fileKey})})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted()}function e(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=d("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable(),f=Array.from(a.keys()),g=d("WATimeUtils").unixTime(),i=[];yield (h||(h=b("Promise"))).all(f.map(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=q(b,c,d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.SEND_REQUEST),h=(yield e.get(f));i.push({id:f,fileKey:b,requestType:c,operationType:d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.SEND_REQUEST,lastRequestTimeStampSec:g,requestRetryCount:((f=h==null?void 0:h.requestRetryCount)!=null?f:0)+1,responseError:a.get(b)})});return function(a){return f.apply(this,arguments)}}())).then(function(){e.bulkCreateOrReplace(i)})});return n.apply(this,arguments)}function f(a,b,c){a=q(a,b,d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD);b=l.get(a);return b!=null&&b.lastMediaUploadSuccess===!0&&b.lastMediaUploadTimeStampSec!=null&&c-b.lastMediaUploadTimeStampSec<=d("WATimeUtils").DAY_SECONDS}function o(a,b,c){a=q(a,b,d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD);b=l.get(a);a=r(c,b==null?void 0:b.lastRequestTimeStampSec);return b!=null&&b.lastMediaUploadSuccess===!1&&a&&b.mediaUploadFailureCount!=null&&b.mediaUploadFailureCount>=i}function p(a,b){var c=[];a.forEach(function(a,e){var f=q(e,d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD),g=l.get(f),h=!r(b,g==null?void 0:g.lastMediaUploadTimeStampSec);a=a===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.SUCCESS;g=(h?0:(h=g==null?void 0:g.mediaUploadFailureCount)!=null?h:0)+(a?0:1);h={id:f,fileKey:e,requestType:d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.UPLOAD_STICKER,operationType:d("WAWebSchemaNonMessageDataRequest").DataRequestUploadOperationType.MEDIA_UPLOAD,lastMediaUploadTimeStampSec:b,lastMediaUploadSuccess:a,mediaUploadFailureCount:g};l.set(f,h);c.push(h)});a=d("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable();a.bulkCreateOrReplace(c)}function q(a,b,c){return a+"_"+String(b)+"_"+String(c)}function r(a,b){a=new Date(a*1e3).toDateString();b=b!=null?new Date(b*1e3).toDateString():a;return a===b}g.MEDIA_REUPLOAD_REQUEST_LIMIT=j;g.inFlightStickerRequests=k;g.mediaReuploadRequestCountMap=m;g.initializeMediaUploadResultFromStorage=a;g.retryNonMessageDataRequestJob=c;g.insertResponseError=e;g.shouldSkipMediaUploadWithSuccess=f;g.shouldSkipMediaUploadWithCancellation=o;g.insertMediaUploadResult=p}),98);
__d("WAWebNonMessageDataRequestPlaceholderMessageResendUtils",["WATimeUtils","WAWebABProps","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebSendNonMessageDataRequest","WAWebSyncGatingUtils"],(function(a,b,c,d,e,f,g){var h=new Set();b=new Set();var i=32;function a(a,b){if(!d("WAWebSyncGatingUtils").isPlaceholderMessageResendEnabled()||!b)return;var c=[],e=d("WATimeUtils").unixTime(),f=d("WAWebABProps").getABPropConfigValue("placeholder_message_resend_maximum_days_limit")*d("WATimeUtils").DAY_SECONDS;a.forEach(function(a){a.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&!h.has(a.id)&&e-a.t<=f&&!a.unsafe().isMdHistoryMsg&&a.subtype!=="bot_unavailable_fanout"&&a.subtype!=="hosted_unavailable_fanout"&&a.subtype!=="view_once_unavailable_fanout"&&(h.add(a.id),c.push(a.id))});if(c.length>0)for(b=0;b<c.length;b+=i){a=c.slice(b,b+i);d("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.PLACEHOLDER_MESSAGE_RESEND,{msgKeys:a})}}g.inFlightPlaceholderResendRequests=b;g.handlePlaceholderMsgsSeen=a}),98);
__d("WAWebContactSyncApiConst",[],(function(a,b,c,d,e,f){a=500;b=20;f.CONTACT_SYNC_CHUNK_SIZE=a;f.SYNC_CONTACT_CHUNK_INTERVAL_SECONDS=b}),66);
__d("WAWebContactSyncApi",["Promise","WAJids","WALogger","WANullthrows","WAPromiseDelays","WATimeUtils","WAWebAdvHandlerApi","WAWebApiContact","WAWebApiDeviceList","WAWebBizVerifiedNameAction","WAWebContactSyncApiConst","WAWebDBCreateLidPnMappings","WAWebGetIdentityKeysJob","WAWebHandleUsernameSync","WAWebLidAwareContactsDB","WAWebLocalStorage","WAWebPhashUtils","WAWebTextStatusCollection","WAWebTextStatusGatingUtils","WAWebUpdateDisappearingModeForContact","WAWebUpdateTextStatusForContact","WAWebUserPrefsKeys","WAWebUsernameGatingUtils","WAWebUsync","WAWebUsyncUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;function a(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.contactIds,c=a.shouldDelayBetweenChunks;a=a.mode;var e=d("WAWebContactSyncApiConst").CONTACT_SYNC_CHUNK_SIZE;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["start contact sync for "," contacts in "," chunks, each chunk size: ",""])),b.length,Math.ceil(b.length/e),e).tags("contact-sync");for(var f=0;f<b.length;f+=e){var g=b.slice(f,f+e);c&&(yield d("WAPromiseDelays").delayMs(d("WAWebContactSyncApiConst").SYNC_CONTACT_CHUNK_INTERVAL_SECONDS*1e3));yield x({contactIds:g,shouldSyncDevice:!0,mode:a})}});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.contactIds,f=a.shouldSyncDevice;a=a.mode;if(e.length===0)return;var g=(yield L(e)),h=new(d("WAWebUsync").USyncQuery)().withContext("background").withMode(a).withBusinessProtocol().withStatusProtocol();d("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()&&h.withTextStatusProtocol();f&&h.withDeviceProtocol();h.withDisappearingModeProtocol();h.withLidProtocol();d("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&h.withUsernameProtocol();a=g.filter(function(a){return!a.id.isLid()}).map(function(a){return d("WAWebWidFactory").asUserWidOrThrow(a.id)});var i=new Map(a.map(function(a){var b=d("WAWebApiContact").getCurrentLid(a);return b==null?null:[a.toString(),b]}).filter(Boolean));g.forEach(function(a){var b=new(d("WAWebUsyncUser").USyncUser)().withId(a.id).withDeviceHash(String(a.hash));if(!a.id.isLid()){a=i.get(a.id.toString());a!=null&&b.withLid(a)}h.withUser(b)});a=null;g=3;var j=10*Math.random();while(g-->0)try{a=(yield h.execute());var k=a.error.all;if(k){var l;j=(l=k.errorBackoff)!=null?l:10*Math.random();throw c("err")("syncContactList: error "+k.errorCode+": "+k.errorText)}else g=0}catch(a){g===0&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["failed to execute usync query"]))).verbose().devConsole(a).sendLogs("failed to execute usync query: "+a),yield d("WAPromiseDelays").delayMs(j*1e3)}if(a==null||a.error.all)return;l=a.refresh;k=[];for(g of Object.keys(l))k.push(l[g]);if(k.length>0){j=Math.min.apply(Math,k);N(j)}yield E(a);yield (v||(v=b("Promise"))).all([f?J(a):(v||(v=b("Promise"))).resolve(),C(a),d("WAWebUsernameGatingUtils").usernameUsyncEnabled()?d("WAWebHandleUsernameSync").handleUsernameSync(a):(v||(v=b("Promise"))).resolve(),z(a),A(a),G(a)]);yield I(e)});return y.apply(this,arguments)}function z(a){var b=a.error.status;if(b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleSyncStatus: failed "," : ",""])),b.errorCode,b.errorText);return}a.list.map(function(a){var b=d("WAWebTextStatusCollection").TextStatusCollection.get(a.id);b&&a.status&&b.set({status:a.status})})}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebTextStatusGatingUtils").receiveTextStatusEnabled())return(v||(v=b("Promise"))).resolve();var c=a.error.text_status;if(c){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["handleSyncTextStatus: failed "," : ",""])),c.errorCode,c.errorText);return}yield (v||(v=b("Promise"))).all(a.list.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.text_status){var b=a.text_status,c=b.text,e=b.emoji,f=b.ephemeralDurationSeconds;b=b.lastUpdateTime;yield d("WAWebUpdateTextStatusForContact").updateTextStatusForContact(a.id,c,e,f,b)}});return function(b){return a.apply(this,arguments)}}()))});return B.apply(this,arguments)}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.error.status;if(c){d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["handleDisappearingMode: failed "," : ",""])),c.errorCode,c.errorText);return}yield (v||(v=b("Promise"))).all(a.list.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.disappearing_mode&&(yield d("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(a.id,a.disappearing_mode.duration,a.disappearing_mode.t))});return function(b){return a.apply(this,arguments)}}()))});return D.apply(this,arguments)}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.error.lid;b&&d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: error ",": ",""])),b.errorCode,b.errorText);var c=[],e=[];a.list.forEach(function(a){var b=a.id,f=a.lid;a=a.pn;if(f!=null){if(b.isLid()){d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: lidResults entry has lid as id, skipping: ",""])),b.toLogString());return}c.push({lid:d("WAWebWidFactory").createUserWidOrThrow(f,"lid"),pn:b})}else if(a!=null){if(!b.isLid()){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: pnResults entry has phone number as id, skipping: ",""])),b.toLogString());return}e.push({lid:b,pn:a})}});c.length>0&&e.length>0&&d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleLidSync: mixed mapping types detected - lidResults: ",", pnResults: ",""])),c.length,e.length);b=[].concat(c,e);b.length>0&&(yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:b,flushImmediately:!0,learningSource:"usync"}))});return F.apply(this,arguments)}function G(a){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.list.filter(function(a){a=a.business;return Boolean(a)});yield d("WAWebBizVerifiedNameAction").handleVerifiedNameSync(a.map(function(a){var b=a.id;a=a.business.verifiedName;return{id:b,verifiedName:a}}))});return H.apply(this,arguments)}function I(a){a=a.map(function(a){a=a.isLid()?d("WAJids").toLidUserJid(a.user):d("WAJids").toPhoneUserJid(a.user);return{id:a,isContactSyncCompleted:1}});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mark "," contacts completed for contact sync"])),a.length).tags("contact-sync");return c("WAWebLidAwareContactsDB").bulkCreateOrMerge(a,"ContactSyncApi.markContactsSyncCompleted")}function J(a){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.error.devices;b&&d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["handleSyncDevice: error ",": ",""])),b.errorCode,b.errorText);b=a.list.filter(function(a){return a.devices&&a.devices.deviceList!=null&&a.devices.keyIndex!=null&&!("errorCode"in a.devices)}).map(function(a){return{wid:a.id,devices:a.devices}});d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleSyncDevice: skipping "," out of "," records"])),a.list.length-b.length,a.list.length);yield d("WAWebGetIdentityKeysJob").getAndStoreIdentityKeys(b.map(function(a){return a.wid}));return d("WAWebAdvHandlerApi").handleADVDeviceSyncResult(b)});return K.apply(this,arguments)}function L(a){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield d("WAWebApiDeviceList").getDeviceIds(a));c=c.map(function(a){return a==null?[]:a.devices.map(function(b){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(a.id,b.id,b.isHosted)})});var e=(yield (v||(v=b("Promise"))).all(c.map(function(a){return a.length===0?"":d("WAWebPhashUtils").phashV2(a)})));c=a.map(function(a,b){return{id:a,hash:e[b]}});return c});return M.apply(this,arguments)}function N(a){if(Number.isNaN(a)||a<=d("WATimeUtils").HOUR_SECONDS){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["invalid contact sync refresh period: ",""])),a).tags("contact-sync");return}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["set contact sync refresh period: ",""])),a).tags("contact-sync");c("WANullthrows")(c("WAWebLocalStorage")).setItem(d("WAWebUserPrefsKeys").KEYS.CONTACT_SYNC_REFRESH,String(a))}g.syncContactListInChunks=a;g.syncContactList=x;g.handleLidSync=E;g.markContactsSyncCompleted=I}),98);
__d("WAWebOutgoingMessage",["$InternalEnum","WALogger","WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebFrontendMsgGetters","WAWebHandleMsgError","WAWebMessagePluginParseProtobuf","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebSendMsgTypes","WAWebVerifyProtobufMsgObjectKeys","cr:10197"],(function(a,b,c,d,e,f,g){var h,i,j=new Set([(a=d("WAWebMsgType")).MSG_TYPE.CIPHERTEXT,a.MSG_TYPE.UNKNOWN,a.MSG_TYPE.GP2,a.MSG_TYPE.E2E_NOTIFICATION,a.MSG_TYPE.NOTIFICATION_TEMPLATE]);c=b("$InternalEnum")({Chat:"chat",ChatResend:"chat-resend",Retry:"retry",Newsletter:"newsletter",Report:"report",Status:"status",Debug:"debug"});var k=function(a,b,c){if(j.has(b.data.type))return;try{c=d("WAWebE2EProtoUtils").getMutableMessageProtobuf(c);d("WAWebVerifyProtobufMsgObjectKeys").verifyProtobufMessageObjectKeys(c);d("WAWebMessagePluginParseProtobuf").parseProtobuf({msgContext:"outgoing",messageProtobuf:c,baseMessage:b.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message?d("WAWebProcessBaseMsgInfo").msgToBaseMsgInfo(b.data):d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(b.data)})}catch(c){c instanceof d("WAWebHandleMsgError").MessageValidationError?d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["generate proto: type:"," error:",""])),b.data.type,c.name).tags("messaging").sendLogs("outgoingMsg: "+c.name):d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["generate proto uncategorized error: msgId:"," type:"," error:",""])),b.data.id,b.data.type,c).sendLogs("outgoing "+String(a)+" "+b.data.type,{sampling:.01});throw c}},l="https://web.whatsapp.net",m=function(a){a.type===d("WAWebMsgType").MSG_TYPE.STICKER&&a.deprecatedMms3Url==null&&(a.deprecatedMms3Url=l);var b;if(d("WAWebFrontendMsgGetters").getAsMms(a)){var c=a.isUnsentPhoneMsg();b=c?{type:a.type}:a.avParams();a.type===d("WAWebMsgType").MSG_TYPE.STICKER&&!c&&b.url==null&&(b.url=l)}return d("WAWebE2EProtoGenerator").createMsgProtobuf(a,b||{})},n=function(a,b){var c=b.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message?m(b.data):d("WAWebE2EProtoGenerator").createAddonProtobuf(b.data);k(a,b,c);return c};e=function(a,b){return n(a,{type:d("WAWebSendMsgTypes").SendMessageRecordType.Message,data:b})};g.OutgoingMessageOriginType=c;g.createOutgoingMessageProtobuf=n;g.createOutgoingMsgModelProtobuf=e}),98);
__d("WAWebICDCMetaApi",["WAWebAdvMetadataCreationFailureWamEvent","WAWebE2EProtoGenerator","WAWebIdentityIcdcApi","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),e,f;try{e=(yield d("WAWebIdentityIcdcApi").getICDCMeta(c))}catch(a){new(d("WAWebAdvMetadataCreationFailureWamEvent").AdvMetadataCreationFailureWamEvent)({advMetadataIsMe:!0}).commit();throw a}try{f=d("WAWebUserPrefsMeUser").isMeAccount(a)?null:yield d("WAWebIdentityIcdcApi").getICDCMeta(a)}catch(a){new(d("WAWebAdvMetadataCreationFailureWamEvent").AdvMetadataCreationFailureWamEvent)({advMetadataIsMe:!1}).commit();throw a}d("WAWebE2EProtoGenerator").populateMessageContextInfo(b,e,f)});return h.apply(this,arguments)}g.populateICDCMeta=a}),98);
__d("WAWebSetWorkerLocalStorage",["WANullthrows","WAWebApiLocalStorage","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=c("WANullthrows")(d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid()),b=d("WAWebUserPrefsMeUser").getMeDisplayNameOrThrow();a=[{key:"deviceJid",value:d("WAWebWidToJid").widToDeviceJid(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow())},{key:"lidDeviceJid",value:a.toString()},{key:d("WAWebUserPrefsKeys").KEYS.ME_DISPLAY_NAME,value:b}];yield d("WAWebApiLocalStorage").updateLocalStorage(a)});return h.apply(this,arguments)}function e(){return d("WAWebApiLocalStorage").clearLocalStorage()}g.setWorkerLocalStorage=a;g.clearWorkerLocalStorage=e}),98);
__d("WAWebBackgroundSyncAction",["WALogger","WATimeUtils","WAWebABProps","WAWebPushNotificationsGatingUtils","WAWebPwaDocumentMetadataUtils","WAWebSetWorkerLocalStorage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q="background-sync";function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);try{var b,c;if(!d("WAWebPushNotificationsGatingUtils").canSupportPeriodicBackgroundSync()||!d("WAWebPwaDocumentMetadataUtils").isCurrentWebSessionInsidePwa())return;b=(yield (b=window.navigator.serviceWorker)==null?void 0:b.ready);if(!("periodicSync"in(b!=null?b:[])))return;b=b==null?void 0:b.periodicSync;if(!b)return;var e=(yield b.getTags==null?void 0:b.getTags());if(!e)return;c=(yield (c=window.navigator.permissions)==null||c.query==null?void 0:c.query({name:"background-sync"}));if((c==null?void 0:c.state)!=="granted")return;c=d("WAWebABProps").getABPropConfigValue("web_pwa_background_sync");if(!a&&c){yield d("WAWebSetWorkerLocalStorage").setWorkerLocalStorage();if(!e.includes(q)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Start pwa background sync registration"])));yield b.register==null?void 0:b.register(q,{minInterval:d("WAWebABProps").getABPropConfigValue("web_pwa_background_sync_min_interval_hours")*d("WATimeUtils").HOUR_MILLISECONDS});a=(yield b.getTags==null?void 0:b.getTags());a!=null&&a.includes!=null&&a.includes(q)?d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync registered successfully"]))):d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync failed to register"])))}else d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync is already registered"])))}else if(e.includes(q)){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Start pwa background sync unregistration"])));yield b.unregister==null?void 0:b.unregister(q);c=(yield b.getTags==null?void 0:b.getTags());c!=null&&c.includes!=null&&c.includes(q)?d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync failed to unregister"]))):d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync unregistered successfully"])))}else d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["pwa background sync is already unregistered"])))}catch(a){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["pwa-background-sync-registration-update-failure: ",""])),a.stack).devConsole(a).sendLogs("pwa-background-sync-registration-update-failure")}});return r.apply(this,arguments)}g.updatePeriodicBackgroundSyncRegistration=a}),98);
__d("WAWebFeatureDetectionDetermineIncognito",["Promise","WACustomError","WAFilteredCatch","WALogger","WAPromiseTimeout","WAWebIndexedDB","WAWebLocalStorage","WAWebUA"],(function(a,b,c,d,e,f,g){var h,i;function a(){var a=new(i||(i=b("Promise")))(function(a){function b(){a(!1)}if(self.requestFileSystem)self.requestFileSystem(window.TEMPORARY,1,b,function(b){a(b.name==="SecurityError")});else if(c("WAWebIndexedDB")){var e=c("WAWebIndexedDB").open("pb_detect");e?(e.onsuccess=b,e.onerror=function(b){b.preventDefault(),window.InvalidStateError?a(b instanceof window.InvalidStateError):a(!0)}):b()}else d("WAWebUA").UA.isTrident?a(!0):b()}).then(function(a){if(a)return a;if(!c("WAWebLocalStorage"))return!1;try{c("WAWebLocalStorage").setItem("INCOG","0");c("WAWebLocalStorage").removeItem("INCOG");return!1}catch(a){if(a.name==="QuotaExceededError")return!0;throw a}});return d("WAPromiseTimeout").promiseTimeout(a,100,"detectIncognitoTimeout")["catch"](d("WAFilteredCatch").filteredCatch(d("WACustomError").TimeoutError,function(){return!1}))["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["promiseUtil:determineIncognito failed check: ",""])),String(a)).devConsole(a).sendLogs("incog-throw");return!1})}g["default"]=a}),98);
__d("WAWebMediaArrayBufferCacheStore",["WAWebKeyValueCacheStore"],(function(a,b,c,d,e,f,g){var h={ignoreSearch:!0,ignoreMethod:!0,ignoreVary:!0};a=function(a){function b(b){return a.call(this,b,i,j,{encodeKey:k,matchOptions:h})||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebKeyValueCacheStore"));function i(a){return new Response(a)}function j(a){return a.arrayBuffer()}function k(a,b){a=encodeURIComponent(a);b=encodeURIComponent(b);return"https://_media_cache_v2_.whatsapp.com/"+b+"_"+a}g["default"]=a}),98);
__d("WAWebLruMediaStorage",["WAWebLruMediaStorageUtils","once"],(function(a,b,c,d,e,f,g){a=2;b=c("once")(function(){return d("WAWebLruMediaStorageUtils").getStorage().initialize()});g.versionToRollout=a;g.initialize=b}),98);
__d("WAWebMediaLruIdbStoreUtils",["Promise","WAWebAbstractStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(a){function c(b,c){var d;d=a.call(this)||this;d.$IdbStore$p_1=b;d.$IdbStore$p_2=c;return d}babelHelpers.inheritsLoose(c,a);var d=c.prototype;d.doGet=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.get(a)});function c(b){return a.apply(this,arguments)}return c}();d.doQueryByIndex=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.all({limit:b.limit,index:[a]})});function c(b,c){return a.apply(this,arguments)}return c}();d.doGetAll=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.all()});function c(){return a.apply(this,arguments)}return c}();d.doPut=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=this;yield this.$IdbStore$p_1().then(function(){return c.$IdbStore$p_2.createOrReplace(b)});return b});function c(b,c){return a.apply(this,arguments)}return c}();d.doDel=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.remove(a)});function c(b){return a.apply(this,arguments)}return c}();d.doCount=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.count()});function c(){return a.apply(this,arguments)}return c}();d.doClear=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this.$IdbStore$p_1();return this.$IdbStore$p_2.clear(!0)});function c(){return a.apply(this,arguments)}return c}();d.doOpen=function(){return this.$IdbStore$p_1()};d.doClose=function(){return(h||(h=b("Promise"))).resolve()};return c}(c("WAWebAbstractStore"));g["default"]=a}),98);
__d("WAWebSchemaLruMediaArrayBuffer",["WAWebLruMediaStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){var h="id",i="data";a="lru-media-array-buffer";b=d("WAWebStorageMutationBuilder").columnBuilder();c=b.addColumn;e=b.addUserDefinedPrimaryKey;d("WAWebLruMediaStorageUtils").getStorage().add(a).version(d("WAWebLruMediaStorageUtils").getStorage().versions.version(0),[e(h),c(i)]).view(function(a){a={id:a[h],data:a[i]};return a});f=d("WAWebLruMediaStorageUtils").getStorage().table(a);g.IdbArrayBufferTable=f}),98);
__d("WAWebMediaArrayBufferIdbStore",["Promise","WAWebAbstractStore","WAWebLruMediaStorage","WAWebMediaLruIdbStoreUtils","WAWebSchemaLruMediaArrayBuffer","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;a=function(a){function e(b){b=a.call(this)||this;b.$ArrayBufferIdbStore$p_1=new(c("WAWebMediaLruIdbStoreUtils"))(d("WAWebLruMediaStorage").initialize,d("WAWebSchemaLruMediaArrayBuffer").IdbArrayBufferTable);return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.doGet=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield this.$ArrayBufferIdbStore$p_1.get(a));return!a?null:a.data});function c(b){return a.apply(this,arguments)}return c}();f.doQueryByIndex=function(a,b){throw c("err")("Not implemented. Actual Arraybuffer store does not need it.")};f.doGetAll=function(){throw c("err")("Not implemented. Actual Arraybuffer store does not need it.")};f.doPut=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield this.$ArrayBufferIdbStore$p_1.put(a,{id:a,data:b}));return a.data});function c(b,c){return a.apply(this,arguments)}return c}();f.doDel=function(a){return this.$ArrayBufferIdbStore$p_1.del(a)};f.doCount=function(){return this.$ArrayBufferIdbStore$p_1.count()};f.clear=function(){return this.$ArrayBufferIdbStore$p_1.clear()};f.doOpen=function(){return(h||(h=b("Promise"))).resolve()};f.doClose=function(){return(h||(h=b("Promise"))).resolve()};return e}(c("WAWebAbstractStore"));g["default"]=a}),98);
__d("WAWebMediaStoreDummyImpl",["Promise","WAWebAbstractStore"],(function(a,b,c,d,e,f,g){var h;a=function(a){function c(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(c,a);var d=c.prototype;d.get=function(a){return(h||(h=b("Promise"))).resolve()};d.queryByIndex=function(a,c){return(h||(h=b("Promise"))).resolve([])};d.getAll=function(){return(h||(h=b("Promise"))).resolve([])};d.put=function(a,c){return(h||(h=b("Promise"))).resolve(c)};d.del=function(a){return(h||(h=b("Promise"))).resolve()};d.count=function(){return(h||(h=b("Promise"))).resolve(0)};d.clear=function(){return(h||(h=b("Promise"))).resolve()};d.setMaxSize=function(a){return(h||(h=b("Promise"))).resolve()};return c}(c("WAWebAbstractStore"));g["default"]=a}),98);
__d("WAWebSchemaLruMediaMetaInfo",["WAWebLruMediaStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){a="id";b="timestamp";c="size";e="lru-media-meta-info";f=d("WAWebStorageMutationBuilder").columnBuilder();var h=f.addColumn,i=f.addUserDefinedPrimaryKey;f=f.addIndex;(d=d("WAWebLruMediaStorageUtils")).getStorage().add(e).version(d.getStorage().versions.version(1),[i(a),h(b),f(b)]).version(d.getStorage().versions.version(2),[h(c)]).view(function(a){a={id:a.id,timestamp:a.timestamp,size:a.size||0};return a});i=d.getStorage().table(e);g.metaInfoPrimaryIndex=a;g.metaInfoDateIndex=b;g.metaInfoSizeIndex=c;g.IdbMetaInfoTable=i}),98);
__d("WAWebSizeLruObjectStore",["Promise","WALogger","WANullthrows","WAPromiseLoop","WAPromiseQueue","WAShiftTimer","WAWebAbstractStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;a=function(a){function e(e,f){var g;g=a.call(this)||this;g._queueMap=new(d("WAPromiseQueue").PromiseQueueMap)();g._purge=function(){if(g._pendingPurgePromise)return g._pendingPurgePromise;var a=g.open().then(function(){return d("WAPromiseLoop").promiseLoop(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=function(){g._pendingPurgePromise=null,a()},f=g.getCurrentSize();if(f==null||f<=g._maxSize){e();return}f=(yield g.queryOneByIndex(g._dateIndex));var i=g.getCurrentSize(),j=g._maxSize;if(i==null||i<=j){e();return}if(f==null){b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield g.count());d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["SizeLruObjectStore: _purge error: No row returned but currentSize (",") > maxSize (","). Row count is "," (may be out of date)."])),i,j,a).sendLogs("size-lru-store-invalid-empty")})();return(m||(m=b("Promise"))).reject(c("err")("Query returned no result but currentSize > maxSize"))}e=f[g._primaryIndex];return g.del(e)});return function(b){return a.apply(this,arguments)}}())});return g._pendingPurgePromise=a};g._schedulePurge=function(){g._purgeTimer.debounce(2*1e3)};g.doPut=function(a,d){return g._queueMap.enqueue(a,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d[g._primaryIndex]!==a)throw c("err")("The key you provide does not match.");var b=(yield g._store.get(a));b=b==null?0:g._getSize(b);var e=g._getSize(d);e=e-b;b=(yield g._store.put(a,d));g._currentSize=c("WANullthrows")(g.getCurrentSize())+e;g._schedulePurge();return b}))};g.doDel=function(a){return g._queueMap.enqueue(a,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield g._store.get(a));if(b==null)return;try{yield g._dispose(a,b)}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["SizeLRUObjectStore: _dispose error: ",""])),a.message).sendLogs("size-lru-store-dispose-error");throw a}yield g._store.del(a);g._currentSize=c("WANullthrows")(g.getCurrentSize())-g._getSize(b)}))};g._store=e;g._primaryIndex=f.primaryIndex;g._dateIndex=f.dateIndex;g._sizeIndex=f.sizeIndex;if(f.maxSize<0)throw c("err")("Cannot set max size to a negative number");g._maxSize=Math.floor(f.maxSize);g._dispose=f.dispose;g._purgeTimer=new(d("WAShiftTimer").ShiftTimer)(function(){g._purge()["catch"](function(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Error while purging: ",""])),a.message)})});return g}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getCurrentSize=function(){return this._currentSize};f.getMaxSize=function(){return this._maxSize};f.setMaxSize=function(a){if(a<0)return(m||(m=b("Promise"))).reject(c("err")("Cannot set size to a negative number"));this._maxSize=Math.floor(a);this._purgeTimer.cancel();return this._purge()["catch"](function(a){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error while purging during setMaxSize: ",""])),a.message)})};f.putObject=function(a){var b=a[this._primaryIndex];return this.put(b,a)};f._getSize=function(a){a=a[this._sizeIndex];if(typeof a!=="number"||a<0){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Invalid size in index ",": ",""])),this._sizeIndex,a);return 0}return a};f.doGet=function(a){return this._store.get(a)};f.queryOneByIndex=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield this._store.queryByIndex(a,{limit:1}));return a.length===0?null:a[0]});function c(b){return a.apply(this,arguments)}return c}();f.doQueryByIndex=function(a,b){return this._store.queryByIndex(a,b)};f.doGetAll=function(){return this._store.getAll()};f.doClear=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this._purgeTimer.cancel(),yield this._store.clear(),this._currentSize=0});function c(){return a.apply(this,arguments)}return c}();f.doCount=function(){return this._store.count()};f.doOpen=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;yield this._store.open();if(this._currentSize!=null)return;var b=(yield this._store.doGetAll());this._currentSize=b.reduce(function(b,c){return b+a._getSize(c)},0)});function c(){return a.apply(this,arguments)}return c}();f.doClose=function(){this._currentSize=null;return this._store.close()};return e}(c("WAWebAbstractStore"));g["default"]=a}),98);
__d("WAWebMediaStoreMetaInfo",["WAWebLruMediaStorage","WAWebMediaLruIdbStoreUtils","WAWebSchemaLruMediaMetaInfo","WAWebSizeLruObjectStore"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,e){var f;b={primaryIndex:(f=d("WAWebSchemaLruMediaMetaInfo")).metaInfoPrimaryIndex,dateIndex:f.metaInfoDateIndex,sizeIndex:f.metaInfoSizeIndex,maxSize:b,dispose:e};e=new(c("WAWebMediaLruIdbStoreUtils"))(d("WAWebLruMediaStorage").initialize,f.IdbMetaInfoTable);return a.call(this,e,b)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebSizeLruObjectStore"));g["default"]=a}),98);
__d("WAWebMediaStoreLruImpl",["Promise","WALogger","WANullthrows","WAPromiseQueue","WAWeb-dexie","WAWebAbstractStore","WAWebMediaStoreMetaInfo","WAWebStorageErrorHandlingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=3e7;a=function(a){function e(e){var f;f=a.call(this)||this;f._queueMap=new(d("WAPromiseQueue").PromiseQueueMap)();f.updateMaxSizeInterval=null;f._dispose=function(a,b){return f._bufferStore.del(a)};f.doPut=function(a,e){return f._queueMap.enqueue(a,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(e.byteLength>f.getMaxSize())return e;if(e.byteLength>j)return e;var b={id:a,timestamp:new Date().getTime(),size:e.byteLength};try{yield f._metaInfoStore.putObject(b);return f._bufferStore.put(a,e)}catch(a){if(a instanceof c("WAWeb-dexie").AbortError&&a.message.includes("QuotaExceededError")){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["LruMediaStore: encounter QuotaExceededError, thus shrink the size of LruMediaStore"])));void f.setMaxSize(c("WANullthrows")(f.getCurrentSize())/2);void d("WAWebStorageErrorHandlingUtils").reportQuotaExceededError(a,{op:"put",db:"lru-media-store",writeSize:e.byteLength});return}throw a}}))};f.doDel=function(a){return f._queueMap.enqueue(a,function(){return f._metaInfoStore.del(a)})};var g=e.maxSize;e=e.arrayBufferStore;f._bufferStore=e;f._metaInfoStore=new(c("WAWebMediaStoreMetaInfo"))(g,f._dispose);return f}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.doGet=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._bufferStore.get(a));b!=null&&void this.put(a,b);return b});function c(b){return a.apply(this,arguments)}return c}();f.doClear=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._bufferStore.clear();return this._metaInfoStore.clear()});function c(){return a.apply(this,arguments)}return c}();f.doCount=function(){return this._metaInfoStore.count()};f.doOpen=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (i||(i=b("Promise"))).all([this._metaInfoStore.open(),this._bufferStore.open()])});function c(){return a.apply(this,arguments)}return c}();f.doClose=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (i||(i=b("Promise"))).all([this._metaInfoStore.close(),this._bufferStore.close()])});function c(){return a.apply(this,arguments)}return c}();f.getCurrentSize=function(){return this._metaInfoStore.getCurrentSize()};f.getMaxSize=function(){return this._metaInfoStore.getMaxSize()};f.setMaxSize=function(a){return this._metaInfoStore.setMaxSize(a)};f._calculateTargetedBufferSize=function(a){a=Math.floor(a*.01);if(a<1e8)return 1e8;return a>5e8?5e8:a};f._clearStoreForThisSession=function(){void this.setMaxSize(0),this.updateMaxSizeInterval&&(self.clearInterval(this.updateMaxSizeInterval),this.updateMaxSizeInterval=null)};return e}(c("WAWebAbstractStore"));g["default"]=a}),98);
__d("WAWebSerializeError",["WAWebNormalizeStack"],(function(a,b,c,d,e,f,g){var h=["name","message","stack"];function a(a){var b=d("WAWebNormalizeStack").normalizeError(a),c=b.name,e=b.message;b.stack;b=babelHelpers.objectWithoutPropertiesLoose(b,h);a=d("WAWebNormalizeStack").normalizeStack(a,!0);b=Object.keys(b).length===0?"":" "+JSON.stringify(b,function(a,b){return a&&typeof b==="object"?String(b):b});return c+" - "+(e||"")+b+"\n"+a}g["default"]=a}),98);
__d("WAWebStoreQuotaManager",["WAStorageEstimator","WAWebABProps","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=1024*1024*1024;a=new Map([["lru-media-store",{getQuota:function(a){return a<=d("WAWebABProps").getABPropConfigValue("web_browser_quota_threshold")*h?Math.min(a*.2,d("WAWebABProps").getABPropConfigValue("web_browser_min_storage_quota")*h):.2*a}}]]);c=function(){function a(a){this.$1=a}var c=a.prototype;c.getQuotaForStore=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAStorageEstimator").estimateStorage());if(!b.success)return 0;b=b.value.quota;return Math.floor((a=(a=this.$1.get(a))==null?void 0:a.getQuota(b))!=null?a:0)});function c(b){return a.apply(this,arguments)}return c}();return a}();e=new c(a);g.storeQuotaManager=e}),98);
__d("WAWebMediaStore",["WALogger","WAMemoizeConcurrent","WAWebIndexedDB","WAWebMediaArrayBufferCacheStore","WAWebMediaArrayBufferIdbStore","WAWebMediaStoreDummyImpl","WAWebMediaStoreLruImpl","WAWebMiscErrors","WAWebPromiseQueue","WAWebSerializeError","WAWebStoreQuotaManager","asyncToGeneratorRuntime","once"],(function(a,b,c,d,e,f,g){var h,i,j=new AbortController();a=function(){function a(){var a=this;this._getBackingStore=c("once")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield k());if(a!=null){yield a.open();return a}}catch(a){if(a.name==="SecurityError")d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["\n            There was a security error attempting to open the media storage.             This likely indicates a permissions error. Falling back to fake             (no-op) storage.\n          "],["\n            There was a security error attempting to open the media storage. \\\n            This likely indicates a permissions error. Falling back to fake \\\n            (no-op) storage.\n          "])));else if(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw a;else d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["\n            Failed to initialize media store! Falling back to fake (no-op) storage. Error:\n            ","\n          "])),c("WAWebSerializeError")(a)).verbose().devConsole(a).sendLogs("Failed to initialize media store")}return new(c("WAWebMediaStoreDummyImpl"))()}));this._promiseQueueHas=new(d("WAWebPromiseQueue").PromiseQueue)();this._memoizedConcurrentHas=c("WAMemoizeConcurrent")(function(a){return a.key},function(b){var c=b.key;return a._promiseQueueHas.enqueue(function(){return a.get(c).then(function(a){return a!=null})})})}var e=a.prototype;e.setMaxSize=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._getBackingStore());return b.setMaxSize(a)});function c(b){return a.apply(this,arguments)}return c}();e.get=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._getBackingStore());return b.get(a)});function c(b){return a.apply(this,arguments)}return c}();e.has=function(a){return this._memoizedConcurrentHas({key:a,signal:j.signal})};e.queryByIndex=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this._getBackingStore());return c.queryByIndex(a,b)});function c(b,c){return a.apply(this,arguments)}return c}();e.getAll=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._getBackingStore());return a.getAll()});function c(){return a.apply(this,arguments)}return c}();e.put=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this._getBackingStore());return c.put(a,b)});function c(b,c){return a.apply(this,arguments)}return c}();e.del=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this._getBackingStore());yield b.del(a)});function c(b){return a.apply(this,arguments)}return c}();e.count=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._getBackingStore());return a.count()});function c(){return a.apply(this,arguments)}return c}();e.clear=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._getBackingStore());yield a.clear()});function c(){return a.apply(this,arguments)}return c}();e.open=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._getBackingStore());yield a.open()});function c(){return a.apply(this,arguments)}return c}();e.close=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield this._getBackingStore());yield a.close()});function c(){return a.apply(this,arguments)}return c}();return a}();function k(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=m();if(a==null)return null;var b=(yield d("WAWebStoreQuotaManager").storeQuotaManager.getQuotaForStore("lru-media-store"));return new(c("WAWebMediaStoreLruImpl"))({maxSize:b,arrayBufferStore:a})});return l.apply(this,arguments)}function m(){if(c("WAWebIndexedDB")!=null){var a=new(c("WAWebMediaArrayBufferIdbStore"))("media_lru_buffer");return"caches"in self?new(c("WAWebMediaArrayBufferCacheStore"))("lru-media-array-buffer-cache"):a}return null}e=new a();g.MediaStore=a;g.LruMediaStore=e}),98);
__d("WAWebUnpairDeviceJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebCommsWapMd","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("unpairResponse",function(a){a.assertTag("iq");a.assertFromServer();var b=a.attrString("type"),c=200;b==="error"&&(c=a.child("error").attrInt("code"));return{status:c}});function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"set",id:b.generateId(),xmlns:"md"},b.wap("remove-companion-device",{jid:d("WAWebCommsWapMd").DEVICE_JID(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()),reason:b.CUSTOM_STRING(a)}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));return a.success?{status:a.result.status}:{status:a.errorCode}});return i.apply(this,arguments)}g.unpairDevice=a}),98);
__d("WAWebSocketModel",["Promise","WAComms","WALogger","WANullthrows","WAPromiseDelays","WAPromiseTimeout","WAWebABPropsCache","WAWebAddMeContactAction","WAWebBackgroundSyncAction","WAWebBaseModel","WAWebCmd","WAWebConnModel","WAWebCrashlog","WAWebCryptoEncKeyHelper","WAWebCryptoEncryptionSaltHelper","WAWebDeleteAllCacheStorage","WAWebEnvironment","WAWebFeatureDetectionDetermineIncognito","WAWebFtsClient","WAWebFtsStorage","WAWebInvocationInterface","WAWebJobsStorage","WAWebLocalStorage","WAWebLogoutReason","WAWebLogoutReasonConstants","WAWebLruMediaStorageUtils","WAWebMediaStore","WAWebMiscBrowserUtils","WAWebMiscErrors","WAWebModelStorage","WAWebNetworkStatus","WAWebOffdStorage","WAWebPonyfillsUrlSearchParams","WAWebQplStorage","WAWebSentinel","WAWebSignalStorage","WAWebSocketConstants","WAWebSubscribePushManagerAction","WAWebSyncBootstrap","WAWebSyncdGatingUtils","WAWebUnpairDeviceJob","WAWebUpdater","WAWebUserPrefsAppStateSync","WAWebUserPrefsClearLocalState","WAWebUserPrefsGeneral","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebUserPrefsStore","WAWebWorkerStorage","asyncToGeneratorRuntime","cr:10201","cr:17219","err","gkx","requireDeferred"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=c("requireDeferred")("WAWebClearAppStates").__setRef("WAWebSocketModel");a=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.socket=d("WAWebBaseModel").session(),b.launchGeneration=d("WAWebBaseModel").session(0),b.backoffGeneration=d("WAWebBaseModel").session(0),b.hasSynced=d("WAWebBaseModel").session(),b.state=d("WAWebBaseModel").session(d("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED),b.stream=d("WAWebBaseModel").session(d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED),b.isIncognito=d("WAWebBaseModel").session(),b.retryTimestamp=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){var a=this,e;this.clearAppStatesDeferred=U.load();this.listenTo(this,"change:state",function(){return a.$SocketImpl$p_1()});this.listenTo(this,"change:stream",function(){return a.$SocketImpl$p_2()});d("WAPromiseDelays").delayMs(0).then(c("WAWebFeatureDetectionDetermineIncognito")).then(function(b){a.isIncognito=b});this.listenTo((e=d("WAWebCmd")).Cmd,"log_socket_summary",function(){return a.summary()});this.listenTo(e.Cmd,"set_socket_state",function(b){a.state=b});this.listenTo(e.Cmd,"open_socket_stream",function(){c("WAWebNetworkStatus").online=!0,void c("WAWebNetworkStatus").checkOnline(),a.openStream()["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[open socket stream] failed to open stream: ",""])),a).sendLogs("socket-model-failed-to-open-stream")}),a.hasSynced&&a.set({stream:d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})});this.listenTo(e.Cmd,"socket_stream_disconnected",function(){a.set({stream:d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED}),void c("WAWebNetworkStatus").checkOnline()});this.listenTo(e.Cmd,"on_critical_sync_done",function(){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[ws2] observed on_critical_sync_done"]))),a.$SocketImpl$p_3()});this.listenTo(e.Cmd,"main_stream_mode_ready",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[ws2] observed main_stream_mode_ready"])));if(!(yield d("WAWebUserPrefsAppStateSync").getAllCriticalDataSynced())){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[ws2] did not meet conditions to move to main screen"])));return}d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[ws2] moving to main screen from main_stream_mode_ready"])));a.set({hasSynced:!0,stream:d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})}));this.listenTo(e.Cmd,"socket_stream_disconnected",function(){a.stream=d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED})};f.reconnect=function(){d("WAWebCmd").Cmd.reconnectSocket()};f.takeover=function(){throw"Takeover called without conflict!"};f.$SocketImpl$p_4=function(){c("WAWebLocalStorage")==null||c("WAWebLocalStorage").setItem(d("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT,"1")};f.$SocketImpl$p_5=function(){c("WAWebLocalStorage")==null||c("WAWebLocalStorage").removeItem(d("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT)};f.$SocketImpl$p_6=function(){return(c("WAWebLocalStorage")==null?void 0:c("WAWebLocalStorage").getItem(d("WAWebUserPrefsKeys").KEYS.LOGOUT_DIRTY_BIT))==="1"};f.clearCredentialsAndStoredData=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(c("WAWebEnvironment").isWindows){var f,g=b("cr:17219")==null||(f=b("cr:17219").getWindowsBridge())==null?void 0:f.getClientKeyBridge();if(g!=null)try{yield d("WAPromiseTimeout").promiseTimeout(g.clearClientKey(),5e3)}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["clearCredentials: native logout failed - ",""])),a).tags("logout").sendLogs("native-clear-credentials-failed")}}g=!1;a!=null&&[d("WAWebLogoutReasonConstants").LogoutReason.WebFailAddChat,d("WAWebLogoutReasonConstants").LogoutReason.WebFailEncSalt,d("WAWebLogoutReasonConstants").LogoutReason.WebFailOfflineResume,d("WAWebLogoutReasonConstants").LogoutReason.WebFailStorageInitialization].includes(a)&&(g=!0);this.$SocketImpl$p_4();g=(yield this.clearCredentials());if(this.$SocketImpl$p_6()){g=!0;var h=d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["clearCredentials: dirty bit is still set"]))).tags("logout");c("gkx")("26258")||h.sendLogs("Logout clearCredentials failed")}void d("WAWebSubscribePushManagerAction").unsubscribePushManager();void d("WAWebBackgroundSyncAction").updatePeriodicBackgroundSyncRegistration(!0);this.$SocketImpl$p_4();try{yield this.destroyStorage()}catch(a){g=!0,c("gkx")("26258")?d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["destroyStorage: failed with error ",""])),a).tags("logout"):d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["destroyStorage: failed with error ",""])),a).tags("logout").sendLogs("Logout destroyStorage failed")}d("WAWebABPropsCache").clearABPropConfigs();g||this.$SocketImpl$p_5();h=new(c("WAWebPonyfillsUrlSearchParams"))();g&&c("WAWebMiscBrowserUtils").info().name!=="Firefox"&&h.set("post_logout","1");if(a){g=d("WAWebLogoutReason").getErrorCodeFromLogoutReason(a);g&&h.set("logout_reason",g);if(a===d("WAWebLogoutReasonConstants").LogoutReason.AccountLocked&&e!=null){g=e.logoutMessageHeader;a=e.logoutMessageSubtext;g!=null&&h.set("logout_message_header",g);a!=null&&h.set("logout_message_subtext",a)}}e=h.toString();e==null||e===""?window.location.reload():window.location.href=window.location.pathname+"?"+h.toString()});function e(b,c){return a.apply(this,arguments)}return e}();f.destroyStorage=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[d("WAWebModelStorage").destroy(),d("WAWebLruMediaStorageUtils").destroyStorage()];a.push(d("WAWebFtsStorage").destroy());a.push(d("WAWebOffdStorage").destroy());a.push(d("WAWebJobsStorage").destroy());a.push(d("WAWebQplStorage").destroy());a.push(d("WAWebFtsClient").ftsClient.clearInitializationPromises());a.push(d("WAWebFtsClient").ftsClient.destroyExternalStorage());a.push(d("WAWebWorkerStorage").destroy());yield (T||(T=b("Promise"))).all(a)});function c(){return a.apply(this,arguments)}return c}();f.logout=function(a){var e=this;a===void 0&&(a=d("WAWebLogoutReasonConstants").LogoutReason.UserInitiated);c("WAWebLocalStorage")==null||c("WAWebLocalStorage").removeItem("WebEncKeySalt");c("WAWebLocalStorage")==null||c("WAWebLocalStorage").removeItem("WANoiseInfo");d("WAWebInvocationInterface").get().setLogoutState(!0)["catch"](function(a){d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to set logout state: ",""])),a).sendLogs("socket-model-set-logout-state-failed")});d("WAWebCmd").Cmd.onStartingLogout();if(!c("gkx")("26258"))try{throw c("err")("Non Error - WS2 logout, thrown only for getting logout stack trace")}catch(a){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["WS2 logout debug: \n ",""],["WS2 logout debug: \\n ",""])),a.stack).verbose()}d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ws2:user logged out"])));var f=(T||(T=b("Promise"))).resolve(),g=0,h=20;h=Math.min(h,Math.max(g,d("WAWebSyncdGatingUtils").getSyncdSentinelTimeoutSeconds()));f=d("WAPromiseTimeout").promiseTimeout(c("WAWebSentinel")(),h*1e3)["catch"](function(){return d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["ws2: multi-device logout did not manage to send sentinel patch"])))});g=3;d("WAPromiseTimeout").promiseTimeout(f.then(function(){return e.sendCurrentLogout(a)})["catch"](function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ws2: [logout error] sendCurrentLogoutPromise errored with ",""])),b),yield e.clearCredentialsAndStoredData(a),d("WAWebCmd").Cmd.logout()});return function(a){return c.apply(this,arguments)}}()),g*1e3,"network request took more than "+g+" seconds").then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield e.clearCredentialsAndStoredData(a),e.state===d("WAWebSocketConstants").SOCKET_STATE.OPENING&&e.trigger("change:state"),d("WAWebCmd").Cmd.logout()}))["catch"](function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){d("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["ws2: [logout error] sentinelPromise or sendCurrentLogoutPromise timed out with ",""])),b),yield e.clearCredentialsAndStoredData(a),d("WAWebCmd").Cmd.logout()});return function(a){return c.apply(this,arguments)}}())["finally"](function(){d("WAWebInvocationInterface").get().setLogoutState(!1)["catch"](function(a){d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to set logout state: ",""])),a).sendLogs("socket-model-set-logout-state-failed")})})};f.summary=function(){d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["ws:summary --------------------------------"]))),d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["ws state           ",""])),this.state),d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["wd online:         ",""])),String(navigator.onLine)),d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["ws socket id:      ",""])),this.socket?this.socket.id:"n/a"),c("gkx")("26258")||void c("WAWebSyncBootstrap").getCriticalSyncDebugSummary().then(function(a){d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["",""])),a)})};f.$SocketImpl$p_1=function(){d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["ws2:state change: ",""])),this.state)};f.$SocketImpl$p_2=function(){d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["ws2:stream change: ",""])),this.stream),this.stream===d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED&&this.unset("resumePromise")};f.$SocketImpl$p_3=function(){d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[ws2] moving to main screen from onCriticalSyncDone"]))),this.set({hasSynced:!0,stream:d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED})};f.openStream=function(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(a){var c;(c=d("WAWebConnModel")).Conn.blockStoreAdds=!1;c.Conn.id="1";c.Conn.trigger("me_ready");c.Conn.meReadyTriggered=!0;return d("WAWebAddMeContactAction").addMeToContacts(a)}return(T||(T=b("Promise"))).resolve()};f.clearCredentials=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){c("WAWebUserPrefsStore").updatePreservedUserKeys();var a=!1;try{a=(yield this.clearState())}catch(b){a=!0}try{d("WAWebUserPrefsGeneral").setBrowserId()}catch(b){a=!0,d("WALogger").ERROR(F||(F=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),b).tags("logout")}try{d("WAWebUserPrefsMeUser").setUnknownId()}catch(a){d("WALogger").ERROR(G||(G=babelHelpers.taggedTemplateLiteralLoose(["ws2:setUnknownId error ",""])),a).tags("logout")}try{d("WAWebUserPrefsMeUser").setMe()}catch(b){a=!0,d("WALogger").ERROR(H||(H=babelHelpers.taggedTemplateLiteralLoose(["ws2:setMe error ",""])),b).tags("logout")}try{yield d("WAWebUserPrefsMultiDevice").clearRegistrationInfo()}catch(b){a=!0,d("WALogger").ERROR(I||(I=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearRegistrationInfo error ",""])),b).tags("logout")}try{yield d("WAWebSignalStorage").destroy()}catch(b){a=!0,d("WALogger").ERROR(J||(J=babelHelpers.taggedTemplateLiteralLoose(["ws2:destroySignal error ",""])),b).tags("logout")}try{yield d("WAWebCryptoEncKeyHelper").deleteEncKeysAndCache(),yield d("WAWebCryptoEncryptionSaltHelper").deleteSalt()}catch(b){a=!0}try{yield d("WAWebUserPrefsClearLocalState").clearAllLocalState()}catch(b){a=!0,d("WALogger").ERROR(K||(K=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearAllLocalState error ",""])),b).tags("logout")}return a});function e(){return a.apply(this,arguments)}return e}();f.clearState=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState"])));var a=!1;this.unset("hasSynced");try{c("WANullthrows")(yield this.clearAppStatesDeferred)()}catch(b){a=!0,b instanceof d("WAWebMiscErrors").DbOnLogoutAbort?d("WALogger").WARN(M||(M=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState failed due to DB operations aborted: ",""])),b.stack):d("WALogger").ERROR(N||(N=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),b.stack).sendLogs("clear_session_app_state")}try{yield V()}catch(b){a=!0,b instanceof d("WAWebMiscErrors").DbOnLogoutAbort?d("WALogger").WARN(O||(O=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState failed due to DB operations aborted: ",""])),b.stack):d("WALogger").ERROR(P||(P=babelHelpers.taggedTemplateLiteralLoose(["ws2:clearState error ",""])),b.stack).sendLogs("clear_persistent_app_state")}return a});function e(){return a.apply(this,arguments)}return e}();f.sendCurrentLogout=function(a){return d("WAWebUnpairDeviceJob").unpairDevice(a).then(function(a){a.status!==200&&d("WALogger").WARN(Q||(Q=babelHelpers.taggedTemplateLiteralLoose(["ws2:multi-device logout failed with error code ",""])),a.status),d("WAComms").stopComms()})["catch"](function(a){d("WALogger").ERROR(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[CRITICAL] unpairDevice failed with error, preoceed with local logout \n",""],["[CRITICAL] unpairDevice failed with error, preoceed with local logout \\n",""])),a.stack).verbose().devConsole(a)})};f.updateImmediately=function(a){d("WAWebCrashlog").upload({reason:a,immediate:!0})["finally"](function(){d("WAWebUpdater").Updater.restart(!0)["catch"](function(a){d("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[socket model] failed to restart updater: ",""])),a).sendLogs("socket-model-failed-to-restart-updater")})})};return e}(d("WAWebBaseModel").BaseModel);e=d("WAWebBaseModel").defineModel(a);f=new e();function V(){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (T||(T=b("Promise"))).allSettled([c("WAWebDeleteAllCacheStorage")(),d("WAWebMediaStore").LruMediaStore.clear()]));a.forEach(function(a){if(a.status==="rejected")throw a.reason})});return W.apply(this,arguments)}g.Socket=f}),98);
__d("WAWebChatStateBridge",["WASendChatStateProtocol","WAWebWidToJid"],(function(a,b,c,d,e,f,g){function a(a){return d("WASendChatStateProtocol").sendChatStateProtocol(d("WAWebWidToJid").widToChatJid(a),"idle")}function b(a){return d("WASendChatStateProtocol").sendChatStateProtocol(d("WAWebWidToJid").widToChatJid(a),"recording_audio")}function c(a){return d("WASendChatStateProtocol").sendChatStateProtocol(d("WAWebWidToJid").widToChatJid(a),"typing")}g.sendChatStatePaused=a;g.sendChatStateRecording=b;g.sendChatStateComposing=c}),98);
__d("WAWebSendPresenceSubscriptionJob",["WASmaxPresenceSubscribeRPC","WAWebWidToJid"],(function(a,b,c,d,e,f,g){function a(a,b){var c;a.isUser()&&b!=null&&(c={privacyTokenContentsMixinArgs:{anyElementValue:new Uint8Array(b)}});void d("WASmaxPresenceSubscribeRPC").sendSubscribeRPC({presenceTo:d("WAWebWidToJid").widToChatJid(a),tCTokenMixinArgs:c})}g["default"]=a}),98);
__d("WAWebContactPresenceBridge",["Promise","WASendPresenceStatusProtocol","WAWebConnModel","WAWebSendPresenceSubscriptionJob","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(){void d("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"available",name:d("WAWebConnModel").Conn.pushname})}function e(){void d("WASendPresenceStatusProtocol").sendPresenceStatusProtocol({status:"unavailable",name:d("WAWebConnModel").Conn.pushname})}function f(a,e){var f;a instanceof c("WAWebWid")?f=a:f=d("WAWebWidFactory").createWid(a);return(h||(h=b("Promise"))).resolve(c("WAWebSendPresenceSubscriptionJob")(f,e))}g.setPresenceAvailable=a;g.setPresenceUnavailable=e;g.subscribePresence=f}),98);
__d("WAWebPresenceChatAction",["WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebChatGetters","WAWebChatStateBridge","WAWebContactPresenceBridge","WAWebLidMigrationUtils","WAWebStateUtils","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=2500,o=1e4;function a(a){if(d("WAWebChatGetters").getIsNewsletter(a)||a.id.isBot())return;return r(d("WAWebStateUtils").unproxy(a))}function b(a){if(d("WAWebChatGetters").getIsNewsletter(a)||a.id.isBot())return;return s(d("WAWebStateUtils").unproxy(a))}function e(a){if(d("WAWebChatGetters").getIsNewsletter(a)||a.id.isBot())return;return t(d("WAWebStateUtils").unproxy(a))}function f(){d("WAWebContactPresenceBridge").setPresenceAvailable()}function p(){d("WAWebContactPresenceBridge").setPresenceUnavailable()}function q(a){var b=d("WAWebLidMigrationUtils").shouldHaveAccountLid(a.id);if(b&&a.accountLid==null){var e="[presence] getChatIdentifier: lid-migrated client does not have an accountLid!";d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",""])),e).sendLogs("lid-migrated-client-with-null-account-lid");throw c("err")(e)}return b&&a.accountLid?a.accountLid:a.id}function r(a){if(!a.typing){var b=q(a);d("WAWebChatStateBridge").sendChatStateComposing(b)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status>=400&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence composing error ",""])),b.toLogString())}));a.presenceResendTimerId=self.setTimeout(function(){return u(a)},o)}a.typing=!0;a.pausedTimerId&&self.clearTimeout(a.pausedTimerId);a.pausedTimerId=self.setTimeout(function(){return s(a)},n)}function s(a){if(a.typing||a.recording){var b=q(a);d("WAWebChatStateBridge").sendChatStatePaused(b)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status>=400&&d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence paused error ",""])),b.toLogString())}))}a.presenceResendTimerId&&(self.clearTimeout(a.presenceResendTimerId),a.unset("presenceResendTimerId"));a.pausedTimerId&&(self.clearTimeout(a.pausedTimerId),a.unset("pausedTimerId"));a.typing=a.recording=!1}function t(a){if(!a.recording){var b=q(a);d("WAWebChatStateBridge").sendChatStateRecording(b)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status>=400&&d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence recording error ",""])),b.toLogString())}));a.presenceResendTimerId=self.setTimeout(function(){return u(a)},o)}a.pausedTimerId&&(self.clearTimeout(a.pausedTimerId),a.unset("pausedTimerId"));a.recording=!0;a.typing=!1}function u(a){var b=a.id;if(a.recording)d("WAWebChatStateBridge").sendChatStateRecording(b)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status>=400&&d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence resend recording error ",""])),b.toLogString())}));else if(a.typing)d("WAWebChatStateBridge").sendChatStateComposing(b)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status>=400&&d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:chat send presence resend composing error ",""])),b.toLogString())}));else{a.unset("presenceResendTimerId");return}a.presenceResendTimerId=self.setTimeout(function(){return u(a)},o)}function v(a){a.presence.isOnline?u(a):a.presenceResendTimerId&&(self.clearTimeout(a.presenceResendTimerId),a.unset("presenceResendTimerId"))}function w(a){a.presenceResendTimerId&&(self.clearTimeout(a.presenceResendTimerId),a.unset("presenceResendTimerId")),a.pausedTimerId&&(self.clearTimeout(a.pausedTimerId),a.unset("pausedTimerId")),a.typing=!1}g.markComposing=a;g.markPaused=b;g.markRecording=e;g.sendPresenceAvailable=f;g.sendPresenceUnavailable=p;g.getChatIdentifier=q;g.presenceOnlineChanged=v;g.clearPresence=w}),98);
__d("WAWebWamEnumWebcStreamModeCode",[],(function(a,b,c,d,e,f){a=Object.freeze({QR:0,MAIN:1,SYNCING:2,OFFLINE:3,CONFLICT:4,PROXYBLOCK:5,TOS_BLOCK:6,SMB_TOS_BLOCK:7,DEPRECATED_VERSION:8,LOCK:9});f.WEBC_STREAM_MODE_CODE=a}),66);
__d("WAWebWebcPageResumeWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcPageResume:[884,{webcResumeCount:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{WebcPageResume:[]});g.WebcPageResumeWamEvent=a}),98);
__d("WAWebWebcStreamModeChangeWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcStreamModeCode"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcStreamModeChange:[770,{webcStreamMode:[1,d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE]},[1,1,1],"regular"]},{WebcStreamModeChange:[]});g.WebcStreamModeChangeWamEvent=a}),98);
__d("WAWebStreamModel",["$InternalEnum","WALogger","WAShiftTimer","WAWebABProps","WAWebBaseModel","WAWebCallCollection","WAWebCmd","WAWebEnvironment","WAWebLockScreenResolver","WAWebNetworkStatus","WAWebPresenceChatAction","WAWebPresenceCollection","WAWebSocketConstants","WAWebSocketModel","WAWebUpdater","WAWebUserPrefsMultiDevice","WAWebUserPrefsScreenLock","WAWebWamEnumWebcStreamModeCode","WAWebWamPageLoadReporter","WAWebWebcPageResumeWamEvent","WAWebWebcStreamModeChangeWamEvent","asyncToGeneratorRuntime","cr:17219","gkx"],(function(a,b,c,d,e,f,g){var h,i,j;e=(a=b("cr:17219"))!=null?a:{};var k=e.getWindowsBridge,l=b("$InternalEnum").Mirrored(["OFFLINE","OPENING","PAIRING","SYNCING","RESUMING","CONNECTING","NORMAL"]),m=b("$InternalEnum").Mirrored(["QR","MAIN","SYNCING","OFFLINE","CONFLICT","PROXYBLOCK","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION"]),n=b("$InternalEnum").Mirrored(["SHOW","OBSCURE","HIDE"]),o=18e3,p=3e3;f=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.info=d("WAWebBaseModel").session(l.NORMAL),b.mode=d("WAWebBaseModel").session(m.SYNCING),b.obscurity=d("WAWebBaseModel").session(n.HIDE),b.needsUpdate=d("WAWebBaseModel").session(),b.clientExpired=d("WAWebBaseModel").session(!1),b.hardExpired=d("WAWebBaseModel").session(!1),b.lastSyncStart=d("WAWebBaseModel").session(u()),b.needsManualDownload=d("WAWebBaseModel").session(),b.couldForce=d("WAWebBaseModel").session(),b.uiActive=d("WAWebBaseModel").session(),b.isInConnectedCall=d("WAWebBaseModel").session(!1),b.available=d("WAWebBaseModel").session(!0),b.unavailableShiftTimer=d("WAWebBaseModel").session(),b.unavailableAutoLockTimer=d("WAWebBaseModel").session(),b.unavailableLogoutTimer=d("WAWebBaseModel").session(),b.unobscureShiftTimer=d("WAWebBaseModel").session(),b.resumeCount=d("WAWebBaseModel").session(0),b.phoneAuthed=d("WAWebBaseModel").session(!1),b.displayInfo=d("WAWebBaseModel").derived(function(){return t(this.info,this.obscurity)},["info","obscurity"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){var b=this;a.prototype.initialize.call(this);d("WAWebUserPrefsMultiDevice").isRegistered()||(this.mode=m.QR);var e=d("WAWebABProps").getABPropConfigValue("web_dau_overreporting_fix");window.document&&e&&(this.available=document.hasFocus());this.unavailableShiftTimer=new(d("WAShiftTimer").ShiftTimer)(function(){return b.markUnavailable()});this.unobscureShiftTimer=new(d("WAShiftTimer").ShiftTimer)(function(){return b.unobscure()});this.unavailableAutoLockTimer=new(d("WAShiftTimer").ShiftTimer)(function(){d("WAWebUserPrefsScreenLock").getScreenLockDurationInSeconds()!==0&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Stream:autoLockShiftTimer auto lock due to inactivity"]))),void d("WAWebLockScreenResolver").lockScreenAndTriggerUnlockFlow())});this.listenTo(d("WAWebSocketModel").Socket,"change:state change:stream change:hasSynced",this.$StreamImpl$p_1);this.listenTo(c("WAWebNetworkStatus"),"change:online",this.$StreamImpl$p_1);this.listenTo(this,"change:available",this.$StreamImpl$p_2);this.listenTo(this,"change:phoneAuthed",this.$StreamImpl$p_3);this.listenTo(this,"change:info",this.logPageResume);this.listenTo(this,"change:info",this.updateWamLog);this.listenTo(this,"change:mode",this.logModeChange);this.listenTo(this,"change:available change:uiActive",this.updateCouldForce);this.listenTo(d("WAWebCmd").Cmd,"midnight",this.updateHardExpire);this.listenTo(d("WAWebCmd").Cmd,"serverUpdatedClientExpiration",this.updateHardExpire);this.listenTo(d("WAWebCmd").Cmd,"socket_stream_disconnected",function(){d("WAWebPresenceCollection").PresenceCollection.clearAllPresence()});this.listenTo(c("WAWebCallCollection"),"change:isInConnectedCall",this.$StreamImpl$p_4);window.document&&document.addEventListener("visibilitychange",this.updateCouldForce);this.updateCouldForce();this.updateHardExpire()};f["delete"]=function(){};f.markAvailable=function(){this.unavailableShiftTimer.cancel(),this.available=!0};f.markUnavailable=function(a){a!=null&&a!==0?this.unavailableShiftTimer.onOrBefore(a):(this.unavailableShiftTimer.cancel(),this.available=!1)};f.$StreamImpl$p_1=function(){var a=r(),b={info:a,mode:s(),phoneAuthed:d("WAWebSocketModel").Socket.stream!==d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED};if(a===l.NORMAL)this.unobscureShiftTimer.cancel(),b.obscurity=n.HIDE;else if(a===l.OFFLINE)this.unobscureShiftTimer.cancel(),b.obscurity=n.OBSCURE;else switch(this.obscurity){case n.HIDE:this.unobscureShiftTimer.onOrBefore(o);break;case n.OBSCURE:this.unobscureShiftTimer.onOrBefore(p);break;case n.SHOW:break}this.set(b)};f.unobscure=function(){this.obscurity=n.SHOW};f.$StreamImpl$p_3=function(){this.phoneAuthed&&(c("WAWebEnvironment").isWindows?this.$StreamImpl$p_5():this.$StreamImpl$p_6())};f.$StreamImpl$p_6=function(){this.sendAvailability(!0)};f.$StreamImpl$p_5=function(){var a,b=k==null||(a=k())==null||(a=a.nativeAppStateBridge)==null?void 0:a.isMinimizedToTray();b!=null?b&&!this.isInConnectedCall?d("WAWebPresenceChatAction").sendPresenceUnavailable():this.sendAvailability(!1):this.sendAvailability(!0)};f.$StreamImpl$p_2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.available;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Stream:onAvailableUpdate user ",""])),a?"available":"unavailable");var b=d("WAWebUserPrefsScreenLock").getScreenLockDurationInSeconds();!a&&b!==0?this.unavailableAutoLockTimer.onOrBefore(b*1e3):this.unavailableAutoLockTimer.cancel();this.sendAvailability(!1);a||d("WAWebPresenceCollection").PresenceCollection.clearAllPresence()});function c(){return a.apply(this,arguments)}return c}();f.$StreamImpl$p_4=function(){this.isInConnectedCall=c("WAWebEnvironment").isWindows&&c("WAWebCallCollection").isInConnectedCall,this.sendAvailability(!0)};f.sendAvailability=function(a){(a||this.uiActive||this.isInConnectedCall)&&(this.available||this.isInConnectedCall?d("WAWebPresenceChatAction").sendPresenceAvailable():d("WAWebPresenceChatAction").sendPresenceUnavailable())};f.updateCouldForce=function(){this.couldForce=!this.uiActive||!this.available&&document.hidden};f.updateHardExpire=function(){d("WAWebUpdater").Updater.isExpired()&&(this.hardExpired=!0,d("WAWebUpdater").Updater.restart(!0))};f.logPageResume=function(){this.info===l.RESUMING&&(this.resumeCount++,new(d("WAWebWebcPageResumeWamEvent").WebcPageResumeWamEvent)({webcResumeCount:this.resumeCount}).commit())};f.updateWamLog=function(){var a=this.info===l.NORMAL;d("WAWebWamPageLoadReporter").streamInfoChange(this.info,1,a);a&&this.stopListening(this,"change:info",this.updateWamLog)};f.logModeChange=function(){this.mode===m.SYNCING&&(this.lastSyncStart=u()),new(d("WAWebWebcStreamModeChangeWamEvent").WebcStreamModeChangeWamEvent)({webcStreamMode:q(this.mode)}).commit()};return e}(d("WAWebBaseModel").BaseModel);f.Proxy="stream";function q(a){switch(a){case m.QR:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.QR;case m.MAIN:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.MAIN;case m.SYNCING:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.SYNCING;case m.OFFLINE:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.OFFLINE;case m.CONFLICT:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.CONFLICT;case m.PROXYBLOCK:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.PROXYBLOCK;case m.DEPRECATED_VERSION:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.DEPRECATED_VERSION;case m.TOS_BLOCK:case m.SMB_TOS_BLOCK:return d("WAWebWamEnumWebcStreamModeCode").WEBC_STREAM_MODE_CODE.TOS_BLOCK}}a=d("WAWebBaseModel").defineModel(f);e=new a();function r(){var a=!1;if((a||c("gkx")("26256"))&&!c("WAWebNetworkStatus").online&&c("WAWebNetworkStatus").simulatedOfflineConditions)return l.OFFLINE;switch(d("WAWebSocketModel").Socket.state){case d("WAWebSocketConstants").SOCKET_STATE.OPENING:return c("WAWebNetworkStatus").online?l.OPENING:l.OFFLINE;case d("WAWebSocketConstants").SOCKET_STATE.PAIRING:return d("WAWebSocketModel").Socket.hasSynced?l.RESUMING:l.PAIRING;case d("WAWebSocketConstants").SOCKET_STATE.CONNECTED:return d("WAWebSocketModel").Socket.stream!==d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED?d("WAWebSocketModel").Socket.hasSynced?l.NORMAL:l.SYNCING:l.NORMAL;case d("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED:case d("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK:default:return l.NORMAL}}function s(){var a;a=d("WAWebUserPrefsMultiDevice").isRegistered();if(!a&&d("WAWebSocketModel").Socket.state!==d("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK)return m.QR;a=d("WAWebSocketModel").Socket.hasSynced;switch(d("WAWebSocketModel").Socket.state){case d("WAWebSocketConstants").SOCKET_STATE.PROXYBLOCK:return m.PROXYBLOCK;case d("WAWebSocketConstants").SOCKET_STATE.CONFLICT:return m.CONFLICT;case d("WAWebSocketConstants").SOCKET_STATE.TOS_BLOCK:return m.TOS_BLOCK;case d("WAWebSocketConstants").SOCKET_STATE.SMB_TOS_BLOCK:return m.SMB_TOS_BLOCK;case d("WAWebSocketConstants").SOCKET_STATE.DEPRECATED_VERSION:return m.DEPRECATED_VERSION;case d("WAWebSocketConstants").SOCKET_STATE.UNLAUNCHED:return m.SYNCING;case d("WAWebSocketConstants").SOCKET_STATE.UNPAIRED_IDLE:case d("WAWebSocketConstants").SOCKET_STATE.UNPAIRED:return m.QR;case d("WAWebSocketConstants").SOCKET_STATE.OPENING:if(!c("WAWebNetworkStatus").online&&!d("WAWebSocketModel").Socket.hasSynced)return m.OFFLINE;default:return a||d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED?m.MAIN:m.SYNCING}}function t(a,b){switch(b){case n.SHOW:return a;case n.HIDE:return d("WAWebSocketModel").Socket.hasSynced?l.NORMAL:l.CONNECTING;case n.OBSCURE:switch(a){case l.OPENING:case l.PAIRING:case l.SYNCING:case l.RESUMING:return l.CONNECTING;default:return a}}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Stream:unknown obscure level:"]))).devConsole(b);return a}function u(){return Math.floor(window.performance.now())}g.StreamInfo=l;g.StreamMode=m;g.Stream=e}),98);
__d("WAWebMessagePluginGenerateProtobuf",["WAWebMessagePluginGenerateProtobufRegistry","WAWebPluginCreateRegistryLookup"],(function(a,b,c,d,e,f,g){var h=d("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(c("WAWebMessagePluginGenerateProtobufRegistry"));function a(a){var b=a.json;return(b=h(b.type,b.subtype))==null||b.generateProtobuf==null?void 0:b.generateProtobuf(a)}g.generateProtobuf=a}),98);
__d("WAWebEventsGenerateEventCreationMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.contextInfo;a=a.json;a={description:a.eventDescription,isCanceled:a.isEventCanceled,location:a.eventLocation,name:a.eventName,startTime:a.eventStartTime,endTime:a.eventEndTime,joinLink:a.eventJoinLink,contextInfo:b!=null?b:void 0,isScheduleCall:(b=a.eventIsScheduledCall)!=null?b:void 0};return{eventMessage:a}}f["default"]=a}),66);
__d("WAWebEventsGenerateEventEditMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;a={targetMessageKey:d("WAWebE2EProtoUtils").encodeKey(a.targetMessageKey),encIv:a.encIv,encPayload:a.encPayload,secretEncType:d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT};return{secretEncryptedMessage:a}}g["default"]=a}),98);
__d("WAWebEventsGenerateEventResponseMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;a={eventCreationMessageKey:d("WAWebE2EProtoUtils").encodeKey(a.targetMessageKey),encPayload:a.encPayload,encIv:a.encIv};return{encEventResponseMessage:a}}g["default"]=a}),98);
__d("WAWebGenerateBizContentPlaceholderProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("Not supported")}g["default"]=a}),98);
__d("WAWebGenerateBotFeedbackProtocolMessageProto",["WAWebBotTypes","WAWebE2EProtoUtils","WAWebProtobufsAICommon.pb","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;var b;switch(a.botFeedbackKind){case d("WAWebBotTypes").BotFeedbackKind.POSITIVE:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_POSITIVE;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_GENERIC;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_HELPFUL:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_HELPFUL;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_INTERESTING:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_INTERESTING;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_ACCURATE:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_ACCURATE;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_SAFE:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_SAFE;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_OTHER:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_OTHER;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_REFUSED:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_REFUSED;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_VISUALLY_APPEALING:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING;break;case d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_RELEVANT_TO_TEXT:b=d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT;break}a={messageKey:d("WAWebE2EProtoUtils").encodeKey(a.protocolMessageKey),kind:b,text:a.botFeedbackText};a={type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_FEEDBACK_MESSAGE,botFeedbackMessage:a};return{protocolMessage:a}}g["default"]=a}),98);
__d("WAWebGenerateBotRequestWelcomeMessageProto",["WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE}}}g["default"]=a}),98);
__d("WAWebGenerateButtonsResponseMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{buttonsResponseMessage:babelHelpers["extends"]({},b.buttonsResponse,{contextInfo:a})}}f["default"]=a}),66);
__d("WAWebGenerateCancelPaymentMessageProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("Not supported")}g["default"]=a}),98);
__d("WAWebGenerateExtendedTextMessageProtoUtils",["WATypeUtils","WAWebE2EProtoUtils","WAWebGroupType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function h(a){switch(a){case d("WAWebGroupType").GroupType.COMMUNITY:return d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.PARENT;case d("WAWebGroupType").GroupType.LINKED_SUBGROUP:return d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.SUB;case d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:return d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT_SUB;default:return d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT}}function a(a){var b=a.json;a=a.contextInfo;var c=b.faviconMMSMetadata!=null;return{extendedTextMessage:{text:b.body,matchedText:b.matchedText,description:b.description,title:b.title,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b.thumbnail),previewType:b.richPreviewType,contextInfo:a,mediaKey:d("WAWebE2EProtoUtils").encodeBytes(b.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(b.mediaKeyTimestamp)?b.mediaKeyTimestamp:void 0,thumbnailDirectPath:b.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(b.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoUtils").encodeBytes(b.thumbnailEncSha256),thumbnailHeight:b.thumbnailHeight,thumbnailWidth:b.thumbnailWidth,inviteLinkGroupTypeV2:h(b.inviteGrpType),backgroundArgb:b.backgroundColor,paymentLinkMetadata:b.paymentLinkMetadata,faviconMMSMetadata:c?{mediaKey:d("WAWebE2EProtoUtils").encodeBytes(b.faviconMMSMetadata.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(b.faviconMMSMetadata.mediaKeyTimestamp)?b.faviconMMSMetadata.mediaKeyTimestamp:void 0,thumbnailDirectPath:b.faviconMMSMetadata.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(b.faviconMMSMetadata.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoUtils").encodeBytes(b.faviconMMSMetadata.thumbnailEncSha256)}:void 0}}}g["default"]=a}),98);
__d("WAWebGenerateExtendedTextUrlChatMessageProto",["WAWebGenerateExtendedTextMessageProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;return c("WAWebGenerateExtendedTextMessageProtoUtils")({json:b,contextInfo:a})}g["default"]=a}),98);
__d("WAWebGenerateChatMessageProto",["WAWebGenerateExtendedTextUrlChatMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;return b.quotedMsg||b.quotedRemoteJid||Array.isArray(b.mentionedJidList)&&b.mentionedJidList.length>0||Array.isArray(b.groupMentions)&&b.groupMentions.length>0||b.conversionTuple||b.isForwarded||b.forwardingScore||b._isPaymentNoteMsg||b.ephemeralDuration||b.ephemeralSettingTimestamp||b.ctwaContext||b.backgroundColor||a!=null&&a.utm||(a==null?void 0:a.isQuestion)===!0||a!=null&&a.questionReplyQuotedMessage||b.paymentLinkMetadata?c("WAWebGenerateExtendedTextUrlChatMessageProto")({json:b,contextInfo:a}):{conversation:b.body}}g["default"]=a}),98);
__d("WAWebGenerateDeclinePaymentMessageProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("Not supported")}g["default"]=a}),98);
__d("WAWebGenerateDocumentMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){var b=a.contextInfo,e=a.json;a=a.mediaMetadata;a=a===void 0?{}:a;var f=e.mimetype||a.mimetype,g=void 0,h=void 0;e.type!==d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&(h=e.caption,g=a.filename);f={url:a.url,mimetype:f,title:g,caption:h,directPath:a.directPath,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(a.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(a.encFilehash),fileName:a.filename,fileLength:d("WATypeUtils").isNumber(e.size)?e.size:void 0,mediaKey:d("WAWebE2EProtoUtils").encodeBytes(a.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(a.mediaKeyTimestamp)?a.mediaKeyTimestamp:void 0,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(e.body),contextInfo:b,contactVcard:e.isVcardOverMmsDocument,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(a.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoUtils").encodeBytes(a.thumbnailEncSha256),thumbnailHeight:a.thumbnailHeight,thumbnailWidth:a.thumbnailWidth};Number.isFinite(e.pageCount)&&!Number.isNaN(e.pageCount)&&(f.pageCount=e.pageCount);d("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(e.type,f,c("WAWebWid").isNewsletter(e.to));return{documentMessage:f}}g["default"]=a}),98);
__d("WAWebGenerateEncCommentMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{encCommentMessage:{targetMessageKey:d("WAWebE2EProtoUtils").encodeKey(a.targetMessageKey),encIv:a.encIv,encPayload:a.encPayload}}}g["default"]=a}),98);
__d("WAWebGenerateEphemeralSyncResponseMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;a={type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE,ephemeralExpiration:a.ephemeralDuration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,disappearingMode:d("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(a.disappearingModeInitiator,a.disappearingModeTrigger,a.disappearingModeInitiatedByMe)};return{protocolMessage:a}}g["default"]=a}),98);
__d("WAWebGenerateGroupInviteMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;return{groupInviteMessage:{inviteCode:b.inviteCode,inviteExpiration:parseInt(b.inviteCodeExp,10),groupJid:b.inviteGrp,groupName:b.inviteGrpName,caption:b.comment,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b.inviteGrpJpegThum),contextInfo:a}}}g["default"]=a}),98);
__d("WAWebGenerateHsmMessageProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("Not supported")}g["default"]=a}),98);
__d("WAWebGenerateImageMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMediaGatingUtils","WAWebWid","err"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json,e=a.mediaMetadata;a=a.contextInfo;if(e==null)throw c("err")("generateImageMessageProto: generating image protobuf without mediaMetadata");var f=b.mimetype||e.mimetype,g={};c("WAWebWid").isStatus(b.to)&&(g={thumbnailDirectPath:e.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(e.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoUtils").encodeBytes(e.thumbnailEncSha256)});d("WAWebMediaGatingUtils").isThumbnailGenerationForMsgOnServerEnabled(b)&&(g={thumbnailDirectPath:e.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(e.thumbnailSha256)});f=babelHelpers["extends"]({url:e.url,mimetype:f,caption:b.caption,directPath:e.directPath,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(e.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(e.encFilehash),height:e.height,width:e.width,fileLength:d("WATypeUtils").isNumber(b.size)?b.size:void 0,mediaKey:d("WAWebE2EProtoUtils").encodeBytes(e.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(e.mediaKeyTimestamp)?e.mediaKeyTimestamp:void 0,jpegThumbnail:b.isViewOnce?void 0:d("WAWebE2EProtoUtils").encodeBytes(b.body),contextInfo:a,viewOnce:b.isViewOnce},g);d("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(b.type,f,c("WAWebWid").isNewsletter(b.to));return{imageMessage:f}}g["default"]=a}),98);
__d("WAWebGenerateVideoMessageProto",["WATypeUtils","WAWebE2EProtoUtils","WAWebMediaGatingUtils","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json,e=a.mediaMetadata;a=a.contextInfo;var f=e==null?void 0:e.duration;f=f!=null&&d("WATypeUtils").isString(f)?parseInt(f,10):f;var g=b.caption,h=b.mimetype||(e==null?void 0:e.mimetype),i={};d("WAWebMediaGatingUtils").isThumbnailGenerationForMsgOnServerEnabled(b)&&(i={thumbnailDirectPath:e==null?void 0:e.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(e==null?void 0:e.thumbnailSha256)});h=babelHelpers["extends"]({url:e==null?void 0:e.url,mimetype:h,directPath:e==null?void 0:e.directPath,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(e==null?void 0:e.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(e==null?void 0:e.encFilehash),height:e==null?void 0:e.height,width:e==null?void 0:e.width,seconds:f,caption:g,fileLength:d("WATypeUtils").isNumber(b.size)?b.size:void 0,mediaKey:d("WAWebE2EProtoUtils").encodeBytes(e==null?void 0:e.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(e==null?void 0:e.mediaKeyTimestamp)?e.mediaKeyTimestamp:void 0,jpegThumbnail:b.isViewOnce?void 0:d("WAWebE2EProtoUtils").encodeBytes(b.body),gifPlayback:b.isGif,gifAttribution:b.gifAttribution,accessibilityLabel:b.accessibilityLabel,contextInfo:a,streamingSidecar:b.streamingSidecar,viewOnce:b.isViewOnce,metadataUrl:(e==null?void 0:e.metadataUrl)!=null&&d("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()?e.metadataUrl:void 0},i);d("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(b.type,h,c("WAWebWid").isNewsletter(b.to));return b.type===d("WAWebMsgType").MSG_TYPE.PTV?{ptvMessage:h}:{videoMessage:h}}g["default"]=a}),98);
__d("WAWebGenerateInteractiveMessageProto",["WAWebE2EProtoUtils","WAWebGenerateDocumentMessageProto","WAWebGenerateImageMessageProto","WAWebGenerateVideoMessageProto","WAWebInteractiveMessageHeaderMediaType","WAWebInteractiveMessagesNativeFlowName"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json,e=a.mediaMetadata;a=a.contextInfo;var f;if(b.interactiveHeader){f={title:b.interactiveHeader.title,subtitle:b.interactiveHeader.subtitle,hasMediaAttachment:b.interactiveHeader.hasMediaAttachment};if(b.interactiveHeader.thumbnail)f=babelHelpers["extends"]({},f,{jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b.interactiveHeader.thumbnail)});else if(b.interactiveHeader.mediaType)switch(b.interactiveHeader.mediaType){case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:var g=c("WAWebGenerateVideoMessageProto")({json:b,mediaMetadata:e,contextInfo:a}).videoMessage;f=babelHelpers["extends"]({},f,{videoMessage:babelHelpers["extends"]({},g,{caption:void 0})});break;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:f=babelHelpers["extends"]({},f,{documentMessage:c("WAWebGenerateDocumentMessageProto")({json:b,mediaMetadata:e,contextInfo:a}).documentMessage});break;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:f=babelHelpers["extends"]({},f,{imageMessage:c("WAWebGenerateImageMessageProto")({json:b,mediaMetadata:e,contextInfo:a}).imageMessage});break}}g=babelHelpers["extends"]({body:b.caption||b.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS?{text:b.caption}:void 0,footer:b.footer?{text:b.footer}:void 0,header:f},a&&{contextInfo:a});e=d("WAWebE2EProtoUtils").getInteractiveMessageFieldNameForType(b.interactiveType);e&&(g[e]=b.interactivePayload);return{interactiveMessage:g}}g["default"]=a}),98);
__d("WAWebGenerateInteractiveResponseMessageProto",["WAWebABProps","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){var h=["type"],i=["type","buttonParamsJson"];function a(a){var b=a.json;a=a.contextInfo;var e=b.interactivePayload,f=e.type;e=babelHelpers.objectWithoutPropertiesLoose(e,h);f=d("WAWebE2EProtoUtils").getInteractiveResponseMessageFieldNameForType(f);var g=e.name===String(c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW)&&d("WAWebABProps").getABPropConfigValue("flows_wa_web");if(g)return j({json:b,contextInfo:a});b=(g={body:{text:b.body}},g[f]=e,g.contextInfo=a,g);return{interactiveResponseMessage:b}}function j(a){var b=a.json;a=a.contextInfo;var c=b.interactivePayload,e=c.type,f=c.buttonParamsJson;c=babelHelpers.objectWithoutPropertiesLoose(c,i);e=d("WAWebE2EProtoUtils").getInteractiveResponseMessageFieldNameForType(e);f=JSON.parse(f);var g=f.flow_token,h=f.wa_flow_response_params;e=(b={body:{text:b.body,format:d("WAWebProtobufsE2E.pb").Message$InteractiveResponseMessage$Body$Format.EXTENSIONS_1}},b[e]=babelHelpers["extends"]({},c,{paramsJson:JSON.stringify({flow_token:g,wa_flow_response_params:h}),version:f.wa_flow_response_params!=null?3:2}),b.contextInfo=a,b);return{interactiveResponseMessage:e}}g["default"]=a}),98);
__d("WAWebGenerateKeepInChatMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{keepInChatMessage:{key:d("WAWebE2EProtoUtils").encodeKey(a.keptMessageKey),keepType:a.keepType,timestampMs:a.senderTimestampMs}}}g["default"]=a}),98);
__d("WAWebGenerateListMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{listMessage:babelHelpers["extends"]({},b.list,{contextInfo:a})}}f["default"]=a}),66);
__d("WAWebGenerateListResponseMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{listResponseMessage:babelHelpers["extends"]({},b.listResponse,{contextInfo:a})}}f["default"]=a}),66);
__d("WAWebGenerateLocationMessageProto",["WATypeUtils","WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;var c={};if(b.loc&&d("WATypeUtils").isString(b.loc)){var e=b.loc.split("\n");c={name:e[0],address:e[1],url:b.clientUrl}}return{locationMessage:babelHelpers["extends"]({},c,{degreesLatitude:parseFloat(b.lat)||void 0,degreesLongitude:parseFloat(b.lng)||void 0,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b.body),contextInfo:a})}}g["default"]=a}),98);
__d("WAWebGenerateMultiVcardMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{contactsArrayMessage:{contacts:b.vcardList.map(function(a){return a}),contextInfo:a}}}f["default"]=a}),66);
__d("WAWebGenerateNativeFlowButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebGenerateImageMessageProto","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.message,e=a.json,f=a.mediaMetadata;a=a.contextInfo;b=babelHelpers["extends"]({},b);if(e.headerType===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE){f=c("WAWebGenerateImageMessageProto")({json:e,mediaMetadata:f,contextInfo:void 0});f=f.imageMessage;b=babelHelpers["extends"]({},b,{imageMessage:f})}b=d("WAWebButtonsMessageProtoUtils").createDynamicReplyButtonsMessage(b,e,a);b.buttonsMessage=babelHelpers["extends"]({},b.buttonsMessage,{buttons:e.nativeFlowButtons});return b}g["default"]=a}),98);
__d("WAWebGenerateNewsletterAdminInviteMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;b=b.newsletterAdminInviteInfo;var c=b.newsletterId,e=b.newsletterName,f=b.inviteExpiration,g=b.inviteMessage;b=b.pictureThumbnail;return{newsletterAdminInviteMessage:{newsletterJid:d("WAWebE2EProtoUtils").encodeJid(c),newsletterName:e,caption:g,inviteExpiration:f,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b),contextInfo:a}}}g["default"]=a}),98);
__d("WAWebGenerateNewsletterFollowerInviteMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.contextInfo;b=b.newsletterFollowerInviteInfo;var c=b.newsletterId,e=b.newsletterName,f=b.inviteMessage;b=b.pictureThumbnail;return{newsletterFollowerInviteMessageV2:{newsletterJid:d("WAWebE2EProtoUtils").encodeJid(c),newsletterName:e,caption:f,jpegThumbnail:d("WAWebE2EProtoUtils").encodeBytes(b),contextInfo:a}}}g["default"]=a}),98);
__d("WAWebGenerateOrderMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return a.itemCount||a.message||a.orderId||a.orderTitle||a.sellerJid||a.status||a.surface||a.thumbnail||a.token||a.totalAmount1000||a.totalCurrencyCode||a.catalogType?{orderMessage:{itemCount:a.itemCount,message:a.message,orderId:a.orderId,orderTitle:a.orderTitle,sellerJid:a.sellerJid,status:a.status,surface:a.surface,thumbnail:d("WAWebE2EProtoUtils").encodeBytes(a.thumbnail),token:a.token,totalAmount1000:a.totalAmount1000,totalCurrencyCode:a.totalCurrencyCode,catalogType:a.catalogType}}:{conversation:a.body}}g["default"]=a}),98);
__d("WAWebGeneratePaymentInviteMessageProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("Not supported")}g["default"]=a}),98);
__d("WAWebGeneratePinMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{pinInChatMessage:{key:d("WAWebE2EProtoUtils").encodeKey(a.pinParentKey),type:a.pinMessageType,senderTimestampMs:a.pinSenderTimestampMs},messageContextInfo:{messageAddOnDurationInSecs:a.pinExpiryDuration}}}g["default"]=a}),98);
__d("WAWebGeneratePollResultSnapshotMessageProto",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.msgContext,c=a.contextInfo;a=a.json;var d=a.pollName;if(b==="quoted")return{pollResultSnapshotMessage:{name:d,pollVotes:[],contextInfo:c}};b=a.pollVotesSnapshot;a=b.pollVotes.map(function(a){var b=a.option;a=a.optionVoteCount;return{optionName:b.name,optionVoteCount:a}});return{pollResultSnapshotMessage:{name:d,pollVotes:a,contextInfo:c}}}f["default"]=a}),66);
__d("WAWebGenerateProductMessageProto",["WAWebGenerateImageMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json,d=a.mediaMetadata;a=a.contextInfo;var e;d!=null&&(e=c("WAWebGenerateImageMessageProto")({json:b,mediaMetadata:d,contextInfo:a}).imageMessage);d={product:{productImage:e,productId:b.productId,title:b.title,description:b.description,currencyCode:b.currencyCode,priceAmount1000:b.priceAmount1000||void 0,salePriceAmount1000:b.salePriceAmount1000||void 0,retailerId:b.retailerId,url:b.url,productImageCount:b.productImageCount},businessOwnerJid:b.businessOwnerJid,contextInfo:a,body:b.caption,footer:b.footer};return{productMessage:d}}g["default"]=a}),98);
__d("WAWebGenerateProtocolEphemeralSettingMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING,ephemeralExpiration:a.ephemeralDuration,disappearingMode:d("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(a.disappearingModeInitiator,a.disappearingModeTrigger,a.disappearingModeInitiatedByMe)}}}g["default"]=a}),98);
__d("WAWebGenerateProtocolHistorySyncNotificationMessageProto",["err"],(function(a,b,c,d,e,f,g){function a(a){throw c("err")("generateProtocolHistorySyncNotificationMessageProto: Not supported")}g["default"]=a}),98);
__d("WAWebGenerateProtocolLimitSharingMessageProto",["WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;a=a.limitSharing?{trigger:a.limitSharing.trigger,sharingLimited:a.limitSharing.sharingLimited,limitSharingSettingTimestamp:a.limitSharing.limitSharingSettingTimestamp,initiatedByMe:!0}:void 0;return{limitSharingMessage:{message:{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.LIMIT_SHARING,limitSharing:a}}}}}g["default"]=a}),98);
__d("WAWebGenerateProtocolRevokeMessageProto",["WAWebE2EProtoUtils","WAWebProtobufsE2E.pb","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return babelHelpers["extends"]({protocolMessage:{key:d("WAWebE2EProtoUtils").encodeKey(a.protocolMessageKey),type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE}},a.botTargetSenderJid instanceof c("WAWebWid")?{messageContextInfo:{botMetadata:{invokerJid:a.botTargetSenderJid.toJid()}}}:{})}g["default"]=a}),98);
__d("WAWebGenerateProtocolSharePhoneNumberMessageProto",["WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.SHARE_PHONE_NUMBER}}}g["default"]=a}),98);
__d("WAWebGenerateReactionEncMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{encReactionMessage:{targetMessageKey:d("WAWebE2EProtoUtils").encodeKey(a.targetMessageKey),encIv:a.encIv,encPayload:a.encPayload}}}g["default"]=a}),98);
__d("WAWebGenerateRequestPhoneNumberMessageProto",[],(function(a,b,c,d,e,f){function a(a){a=a.contextInfo;return{requestPhoneNumberMessage:{contextInfo:a}}}f["default"]=a}),66);
__d("WAWebGenerateStickerPackMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.json;a=a.mediaMetadata;a=a===void 0?{}:a;return{stickerPackMessage:{stickerPackId:b.stickerPackId,name:b.filename,publisher:b.stickerPackPublisher,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(a.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(a.encFilehash),mediaKey:d("WAWebE2EProtoUtils").encodeBytes(a.mediaKey),directPath:b.directPath,caption:b.caption,packDescription:b.description,thumbnailSha256:d("WAWebE2EProtoUtils").encodeBytes(a.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoUtils").encodeBytes(a.thumbnailEncSha256),thumbnailDirectPath:b.thumbnailDirectPath,stickers:b.stickers,fileLength:b.size,trayIconFileName:b.trayIconFileName,stickerPackSize:b.stickerPackSize}}}g["default"]=a}),98);
__d("WAWebGenerateTemplateButtonReplyMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{templateButtonReplyMessage:{selectedId:b.selectedId,selectedIndex:b.selectedIndex,selectedCarouselCardIndex:b.selectedCarouselCardIndex,selectedDisplayText:b.body,contextInfo:a}}}f["default"]=a}),66);
__d("WAWebGenerateVcardMessageProto",[],(function(a,b,c,d,e,f){function a(a){var b=a.json;a=a.contextInfo;return{contactMessage:{displayName:b.vcardFormattedName,vcard:b.body,contextInfo:a}}}f["default"]=a}),66);
__d("WAWebPollsProtoUtils",["WALogger","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var b=a.pollContentType;if(b!==d("WAWebProtobufsE2E.pb").Message$PollContentType.IMAGE)return;b=a.options;if(b==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Missing options in pollCreationMessage"]))).sendLogs("missing-options-in-pollCreationMessage");return}a=b.some(function(a){a=a.optionHash;return a==null||a===""});a&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Outgoing photo poll with missing option hashes"]))).devConsole(b).sendLogs("outgoing-photo-poll-missing-option-hashes")}g.validatePhotoPollCreationMessage=a}),98);
__d("WAWebPollsGeneratePollCreationMessageProto",["WAWebPollCreationUtils","WAWebPollsProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.msgContext,c=a.contextInfo;a=a.json;var e=a.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE;b=b==="quoted"?{name:a.pollName,options:[]}:{name:a.pollName,options:a.pollOptions.map(function(a){var b=a.name;a=a.hash;return e?{optionName:b,optionHash:a}:{optionName:b}}),selectableOptionsCount:a.pollSelectableOptionsCount,pollContentType:d("WAWebPollCreationUtils").getPollContentTypeAsE2EValue(a.pollContentType),pollType:d("WAWebPollCreationUtils").getPollTypeAsE2EValue(a.pollType)};c!=null&&(b.contextInfo=c);d("WAWebPollsProtoUtils").validatePhotoPollCreationMessage(b);if(a.isSentCagPollCreation)return{pollCreationMessageV2:b};return a.pollSelectableOptionsCount===1||a.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE?{pollCreationMessageV3:b}:{pollCreationMessage:b}}g["default"]=a}),98);
__d("WAWebPollsGeneratePollVoteMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;a={pollCreationMessageKey:d("WAWebE2EProtoUtils").encodeKey(a.pollUpdateParentKey),vote:a.encPollVote,senderTimestampMs:a.senderTimestampMs};return{pollUpdateMessage:a}}g["default"]=a}),98);
__d("WAWebPttGenerateAudioOrPttMessageProto",["invariant","WALogger","WATypeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoUtils","WAWebWid"],(function(a,b,c,d,e,f,g,h){var i;function a(a){var b=a.json,e=a.mediaMetadata;a=a.contextInfo;e||h(0,66891);var f=b.mimetype||e.mimetype,g=e.duration,j=b.waveform||e.waveform;g=g!=null&&d("WATypeUtils").isString(g)?parseInt(g,10):g;f={url:e.url,mimetype:f,directPath:e.directPath,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(e.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(e.encFilehash),seconds:g,ptt:b.type==="ptt",fileLength:d("WATypeUtils").isNumber(b.size)?b.size:void 0,mediaKey:d("WAWebE2EProtoUtils").encodeBytes(e.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(e.mediaKeyTimestamp)?e.mediaKeyTimestamp:void 0,contextInfo:a,streamingSidecar:b.streamingSidecar,viewOnce:b.isViewOnce};j&&(d("WAWebAudioMessageProtoUtils").validateWaveform(j)?f.waveform=j.buffer:d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Outgoing waveform with invalid size: ",""])),j.byteLength).sendLogs("outgoing-waveform-invalid-size"));d("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(b.type?"ptt":"audio",f,c("WAWebWid").isNewsletter(b.to));return{audioMessage:f}}g["default"]=a}),98);
__d("WAWebQuestionsGenerateQuestionResponseMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{questionResponseMessage:{key:d("WAWebE2EProtoUtils").encodeKey(a.id),text:a.body}}}g["default"]=a}),98);
__d("WAWebReactionsGenerateReactionMessageProto",["WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;return{reactionMessage:{key:d("WAWebE2EProtoUtils").encodeKey(a.reactionParentKey),text:a.reactionText,senderTimestampMs:a.reactionTimestamp}}}g["default"]=a}),98);
__d("WAWebStickersGenerateStickerMessageProto",["invariant","WALogger","WATypeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebStickerMimeUtils","WAWebWid","err"],(function(a,b,c,d,e,f,g,h){var i;function a(a){var b=a.contextInfo,e=a.json;a=a.mediaMetadata;a!=null||h(0,66810);if(a.mimetype!=null&&!d("WAWebStickerMimeUtils").getValidStickerMimeTypes().has(a.mimetype)){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["invalid sticker mimetype: ",""])),a.mimetype);throw c("err")("invalid sticker mimetype")}a={url:a.url,mimetype:a.mimetype,directPath:a.directPath,fileSha256:d("WAWebE2EProtoUtils").encodeBytes(a.filehash),fileEncSha256:d("WAWebE2EProtoUtils").encodeBytes(a.encFilehash),mediaKey:d("WAWebE2EProtoUtils").encodeBytes(a.mediaKey),mediaKeyTimestamp:d("WATypeUtils").isNumber(a.mediaKeyTimestamp)?a.mediaKeyTimestamp:void 0,fileLength:d("WATypeUtils").isNumber(e.size)?e.size:void 0,height:e.height,width:e.width,firstFrameLength:a.firstFrameLength,firstFrameSidecar:e.firstFrameSidecar||void 0,isAnimated:a.isAnimated,isLottie:a.isLottie,stickerSentTs:e.stickerSentTs,contextInfo:b};d("WAWebE2EProtoUtils").validateOutgoingRequiredMediaProperties(d("WAWebMsgType").MSG_TYPE.STICKER,a,c("WAWebWid").isNewsletter(e.to));return{stickerMessage:a}}g["default"]=a}),98);
__d("WAWebMessagePluginGenerateProtobufRegistry",["WAWebEventsGenerateEventCreationMessageProto","WAWebEventsGenerateEventEditMessageProto","WAWebEventsGenerateEventResponseMessageProto","WAWebGenerateBizContentPlaceholderProto","WAWebGenerateBotFeedbackProtocolMessageProto","WAWebGenerateBotRequestWelcomeMessageProto","WAWebGenerateButtonsResponseMessageProto","WAWebGenerateCancelPaymentMessageProto","WAWebGenerateChatMessageProto","WAWebGenerateDeclinePaymentMessageProto","WAWebGenerateDocumentMessageProto","WAWebGenerateEncCommentMessageProto","WAWebGenerateEphemeralSyncResponseMessageProto","WAWebGenerateExtendedTextUrlChatMessageProto","WAWebGenerateGroupInviteMessageProto","WAWebGenerateHsmMessageProto","WAWebGenerateImageMessageProto","WAWebGenerateInteractiveMessageProto","WAWebGenerateInteractiveResponseMessageProto","WAWebGenerateKeepInChatMessageProto","WAWebGenerateListMessageProto","WAWebGenerateListResponseMessageProto","WAWebGenerateLocationMessageProto","WAWebGenerateMultiVcardMessageProto","WAWebGenerateNativeFlowButtonsMessageProto","WAWebGenerateNewsletterAdminInviteMessageProto","WAWebGenerateNewsletterFollowerInviteMessageProto","WAWebGenerateOrderMessageProto","WAWebGeneratePaymentInviteMessageProto","WAWebGeneratePinMessageProto","WAWebGeneratePollResultSnapshotMessageProto","WAWebGenerateProductMessageProto","WAWebGenerateProtocolEphemeralSettingMessageProto","WAWebGenerateProtocolHistorySyncNotificationMessageProto","WAWebGenerateProtocolLimitSharingMessageProto","WAWebGenerateProtocolMessageEditProto","WAWebGenerateProtocolRevokeMessageProto","WAWebGenerateProtocolSharePhoneNumberMessageProto","WAWebGenerateReactionEncMessageProto","WAWebGenerateRequestPaymentMessageProto","WAWebGenerateRequestPhoneNumberMessageProto","WAWebGenerateSendPaymentMessageProto","WAWebGenerateStickerPackMessageProto","WAWebGenerateTemplateButtonReplyMessageProto","WAWebGenerateVcardMessageProto","WAWebGenerateVideoMessageProto","WAWebPollsGeneratePollCreationMessageProto","WAWebPollsGeneratePollVoteMessageProto","WAWebPttGenerateAudioOrPttMessageProto","WAWebQuestionsGenerateQuestionResponseMessageProto","WAWebReactionsGenerateReactionMessageProto","WAWebStickersGenerateStickerMessageProto"],(function(a,b,c,d,e,f,g){b=[{type:"album",subtype:void 0,generateProtobuf:null},{type:"audio",subtype:void 0,generateProtobuf:c("WAWebPttGenerateAudioOrPttMessageProto")},{type:"biz_content_placeholder",subtype:void 0,generateProtobuf:c("WAWebGenerateBizContentPlaceholderProto")},{type:"buttons_response",subtype:void 0,generateProtobuf:c("WAWebGenerateButtonsResponseMessageProto")},{type:"chat",subtype:"url",generateProtobuf:c("WAWebGenerateExtendedTextUrlChatMessageProto")},{type:"chat",subtype:void 0,generateProtobuf:c("WAWebGenerateChatMessageProto")},{type:"ciphertext",subtype:"bot_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:"fanout",generateProtobuf:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:"view_once_unavailable_fanout",generateProtobuf:null},{type:"ciphertext",subtype:void 0,generateProtobuf:null},{type:"comment",subtype:void 0,generateProtobuf:c("WAWebGenerateEncCommentMessageProto")},{type:"debug_placeholder",subtype:void 0,generateProtobuf:null},{type:"document",subtype:void 0,generateProtobuf:c("WAWebGenerateDocumentMessageProto")},{type:"event_creation",subtype:void 0,generateProtobuf:c("WAWebEventsGenerateEventCreationMessageProto")},{type:"event_edit_encrypted",subtype:void 0,generateProtobuf:c("WAWebEventsGenerateEventEditMessageProto")},{type:"event_response",subtype:void 0,generateProtobuf:c("WAWebEventsGenerateEventResponseMessageProto")},{type:"groups_v4_invite",subtype:void 0,generateProtobuf:c("WAWebGenerateGroupInviteMessageProto")},{type:"hsm",subtype:void 0,generateProtobuf:c("WAWebGenerateHsmMessageProto")},{type:"image",subtype:void 0,generateProtobuf:c("WAWebGenerateImageMessageProto")},{type:"interactive",subtype:void 0,generateProtobuf:c("WAWebGenerateInteractiveMessageProto")},{type:"interactive_response",subtype:void 0,generateProtobuf:c("WAWebGenerateInteractiveResponseMessageProto")},{type:"keep_in_chat",subtype:void 0,generateProtobuf:c("WAWebGenerateKeepInChatMessageProto")},{type:"list",subtype:void 0,generateProtobuf:c("WAWebGenerateListMessageProto")},{type:"list_response",subtype:void 0,generateProtobuf:c("WAWebGenerateListResponseMessageProto")},{type:"location",subtype:void 0,generateProtobuf:c("WAWebGenerateLocationMessageProto")},{type:"multi_vcard",subtype:void 0,generateProtobuf:c("WAWebGenerateMultiVcardMessageProto")},{type:"native_flow",subtype:void 0,generateProtobuf:c("WAWebGenerateNativeFlowButtonsMessageProto")},{type:"newsletter_admin_invite",subtype:void 0,generateProtobuf:c("WAWebGenerateNewsletterAdminInviteMessageProto")},{type:"newsletter_follower_invite",subtype:void 0,generateProtobuf:c("WAWebGenerateNewsletterFollowerInviteMessageProto")},{type:"newsletter_question_response",subtype:void 0,generateProtobuf:c("WAWebQuestionsGenerateQuestionResponseMessageProto")},{type:"notification_template",subtype:"contact_info_card",generateProtobuf:null},{type:"order",subtype:void 0,generateProtobuf:c("WAWebGenerateOrderMessageProto")},{type:"payment",subtype:"ciphertext",generateProtobuf:null},{type:"payment",subtype:"futureproof",generateProtobuf:null},{type:"payment",subtype:"invite",generateProtobuf:c("WAWebGeneratePaymentInviteMessageProto")},{type:"payment",subtype:"request",generateProtobuf:c("WAWebGenerateRequestPaymentMessageProto")},{type:"payment",subtype:"send",generateProtobuf:c("WAWebGenerateSendPaymentMessageProto")},{type:"pin_message",subtype:void 0,generateProtobuf:c("WAWebGeneratePinMessageProto")},{type:"pinned_message",subtype:void 0,generateProtobuf:null},{type:"poll_creation",subtype:void 0,generateProtobuf:c("WAWebPollsGeneratePollCreationMessageProto")},{type:"poll_result_snapshot",subtype:void 0,generateProtobuf:c("WAWebGeneratePollResultSnapshotMessageProto")},{type:"poll_update",subtype:"poll_vote",generateProtobuf:c("WAWebPollsGeneratePollVoteMessageProto")},{type:"product",subtype:void 0,generateProtobuf:c("WAWebGenerateProductMessageProto")},{type:"protocol",subtype:"admin_revoke",generateProtobuf:a=c("WAWebGenerateProtocolRevokeMessageProto")},{type:"protocol",subtype:"bot_feedback",generateProtobuf:c("WAWebGenerateBotFeedbackProtocolMessageProto")},{type:"protocol",subtype:"bot_memu_onboarding",generateProtobuf:null},{type:"protocol",subtype:"bot_request_welcome",generateProtobuf:c("WAWebGenerateBotRequestWelcomeMessageProto")},{type:"protocol",subtype:"ephemeral_setting",generateProtobuf:c("WAWebGenerateProtocolEphemeralSettingMessageProto")},{type:"protocol",subtype:"ephemeral_sync_response",generateProtobuf:c("WAWebGenerateEphemeralSyncResponseMessageProto")},{type:"protocol",subtype:"event_edit_decrypted",generateProtobuf:null},{type:"protocol",subtype:"history_sync_notification",generateProtobuf:c("WAWebGenerateProtocolHistorySyncNotificationMessageProto")},{type:"protocol",subtype:"limit_sharing_system_message",generateProtobuf:c("WAWebGenerateProtocolLimitSharingMessageProto")},{type:"protocol",subtype:"member_label",generateProtobuf:null},{type:"protocol",subtype:"message_edit",generateProtobuf:c("WAWebGenerateProtocolMessageEditProto")},{type:"protocol",subtype:"message_history_bundle",generateProtobuf:null},{type:"protocol",subtype:"message_history_notice",generateProtobuf:null},{type:"protocol",subtype:"sender_revoke",generateProtobuf:a},{type:"protocol",subtype:"share_phone_number",generateProtobuf:c("WAWebGenerateProtocolSharePhoneNumberMessageProto")},{type:"protocol",subtype:"status_group_mention_message",generateProtobuf:null},{type:"protocol",subtype:"status_mention_message",generateProtobuf:null},{type:"ptt",subtype:void 0,generateProtobuf:c("WAWebPttGenerateAudioOrPttMessageProto")},{type:"ptv",subtype:void 0,generateProtobuf:c("WAWebGenerateVideoMessageProto")},{type:"reaction",subtype:void 0,generateProtobuf:c("WAWebReactionsGenerateReactionMessageProto")},{type:"reaction_enc",subtype:void 0,generateProtobuf:c("WAWebGenerateReactionEncMessageProto")},{type:"request_phone_number",subtype:void 0,generateProtobuf:c("WAWebGenerateRequestPhoneNumberMessageProto")},{type:"revoked",subtype:"admin",generateProtobuf:a},{type:"revoked",subtype:"sender",generateProtobuf:a},{type:"rich_response",subtype:void 0,generateProtobuf:null},{type:"status_notification",subtype:"status_notification_message",generateProtobuf:null},{type:"sticker",subtype:void 0,generateProtobuf:c("WAWebStickersGenerateStickerMessageProto")},{type:"sticker-pack",subtype:void 0,generateProtobuf:c("WAWebGenerateStickerPackMessageProto")},{type:"template_button_reply",subtype:void 0,generateProtobuf:c("WAWebGenerateTemplateButtonReplyMessageProto")},{type:"unknown",subtype:"payment_action_request_declined",generateProtobuf:c("WAWebGenerateDeclinePaymentMessageProto")},{type:"unknown",subtype:"payment_transaction_request_cancelled",generateProtobuf:c("WAWebGenerateCancelPaymentMessageProto")},{type:"unknown",subtype:"phone",generateProtobuf:null},{type:"unknown",subtype:"phone_only_feature",generateProtobuf:null},{type:"unknown",subtype:void 0,generateProtobuf:null},{type:"vcard",subtype:void 0,generateProtobuf:c("WAWebGenerateVcardMessageProto")},{type:"video",subtype:void 0,generateProtobuf:c("WAWebGenerateVideoMessageProto")}];g["default"]=b}),98);
__d("WAWebGenerateBotMetadata",["WAWebBotGating","WAWebLidMigrationUtils","WAWebProtobufsAICommon.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.botPersonaId!=null?a.botPersonaId:void 0;a=h(a);return b==null&&a==null?void 0:{personaId:b,invokerJid:a,capabilityMetadata:i()}}function h(a){if(a.subtype==="bot_feedback"){var b;return(b=a.botTargetSenderJid)==null?void 0:b.toJid()}if(a.botTargetSenderJid!=null){return(b=d("WAWebLidMigrationUtils").toLid(a.botTargetSenderJid))==null?void 0:b.toJid()}return void 0}function i(){var a=[];d("WAWebBotGating").isRichStructuredResponseEnabled()&&(a.push(d("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_STRUCTURED_RESPONSE),d("WAWebBotGating").isRichResponseHeadingEnabled()&&a.push(d("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_HEADING),d("WAWebBotGating").isRichResponseSubHeadingEnabled()&&a.push(d("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_SUB_HEADING),d("WAWebBotGating").isRichResponseTableEnabled()&&a.push(d("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_TABLE),d("WAWebBotGating").isRichResponseInlineReelsEnabled()&&a.push(d("WAWebProtobufsAICommon.pb").BotCapabilityMetadata$BotCapabilityType.RICH_RESPONSE_INLINE_REELS));return a.length>0?{capabilities:a}:void 0}g.generateBotMetadata=a;g.generateBotCapabilityMetadata=i}),98);
__d("WAWebE2EProtoGenerator",["WALogger","WATypeUtils","WAWebABPropsSaga","WAWebAssociationProtoUtils","WAWebBizCoexGatingUtils","WAWebBotGating","WAWebButtonsMessageProtoUtils","WAWebConversionTupleCollection","WAWebE2EProtoUtils","WAWebGenerateBotMetadata","WAWebLidMigrationUtils","WAWebLoggerDebugInfo","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMessagePluginGenerateProtobuf","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessagingGatingUtils","WAWebMsgType","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebURLUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h=["messageContextInfo"],i;function a(a,b,c){if(!b&&!c)return;a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{deviceListMetadata:{senderKeyHash:b==null?void 0:b.keyHash,senderTimestamp:b==null?void 0:b.timestamp,senderKeyIndexes:b==null?void 0:b.keyIndexes,recipientKeyHash:c==null?void 0:c.keyHash,recipientTimestamp:c==null?void 0:c.timestamp,recipientKeyIndexes:c==null?void 0:c.keyIndexes,senderAccountType:d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?b==null?void 0:b.senderAccountType:void 0,receiverAccountType:d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?c==null?void 0:c.receiverAccountType:void 0},deviceListMetadataVersion:2})}function e(a){if(a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL)return{};switch(a.subtype){case"app_state_sync_key_share":return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_SHARE,appStateSyncKeyShare:a.appStateSyncKeyShare}};case"app_state_sync_key_request":return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_SYNC_KEY_REQUEST,appStateSyncKeyRequest:a.appStateSyncKeyRequest}};case"app_state_fatal_exception_notification":return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.APP_STATE_FATAL_EXCEPTION_NOTIFICATION,appStateFatalExceptionNotification:a.appStateFatalExceptionNotification}};case"peer_data_operation_request_message":return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.PEER_DATA_OPERATION_REQUEST_MESSAGE,peerDataOperationRequestMessage:a.peerDataOperationRequestMessage}};case"peer_data_operation_request_response_message":return{protocolMessage:{type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE,peerDataOperationRequestResponseMessage:a.peerDataOperationRequestResponseMessage}}}return{}}function f(a,b){var c=l(a);return k(c,b,(c=a.utm)!=null?c:void 0)}function j(a){return k(a)}function k(a,b,c){var e={};if(a.quotedMsg){var f=a.quotedMsg.mentionedJidList,g=a.quotedMsg.groupMentions,h=[],i=[];Array.isArray(f)&&f.length>0&&h.push.apply(h,f.map(d("WAWebE2EProtoUtils").encodeJid));Array.isArray(g)&&g.length>0&&i.push.apply(i,g.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebE2EProtoUtils").encodeJid(a.groupJid)}}));f=h.length>0||i.length>0?{mentionedJid:h,groupMentions:i,statusAttributions:[]}:void 0;e.stanzaId=a.quotedStanzaID;e.remoteJid=d("WAWebE2EProtoUtils").encodeJid(a.quotedRemoteJid);e.participant=d("WAWebE2EProtoUtils").encodeJid(a.quotedParticipant);g={duration:a.quotedMsg.duration,directPath:a.quotedMsg.directPath,encFilehash:a.quotedMsg.encFilehash,filehash:a.quotedMsg.filehash,height:a.quotedMsg.height,mediaKey:a.quotedMsg.mediaKey,mediaKeyTimestamp:d("WATypeUtils").isNumber(a.quotedMsg.mediaKeyTimestamp)?a.quotedMsg.mediaKeyTimestamp:void 0,mimetype:a.quotedMsg.mimetype,url:a.quotedMsg.clientUrl||a.quotedMsg.deprecatedMms3Url,width:a.quotedMsg.width};e.quotedMessage=m(a.quotedMsg,g,f,void 0,"quoted")}else a.quotedRemoteJid&&a.quotedGroupSubject&&a.quotedParentGroupJid?(e.remoteJid=d("WAWebE2EProtoUtils").encodeJid(a.quotedRemoteJid),e.groupSubject=a.quotedGroupSubject,e.parentGroupJid=d("WAWebE2EProtoUtils").encodeJid(a.quotedParentGroupJid)):a.quotedRemoteJid&&(e.remoteJid=d("WAWebE2EProtoUtils").encodeJid(a.quotedRemoteJid));if(a.mentionedJidList&&a.mentionedJidList.length>0){h=a.mentionedJidList;e.mentionedJid=h.map(d("WAWebE2EProtoUtils").encodeJid)}a.groupMentions&&a.groupMentions.length>0&&(e.groupMentions=a.groupMentions.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebE2EProtoUtils").encodeJid(a.groupJid)}}));a.conversionTuple&&Object.assign(e,a.conversionTuple);a.isForwarded&&(e.isForwarded=a.isForwarded);a.isQuestion&&(e.isQuestion=a.isQuestion);a.questionReplyQuotedMessage&&(e.questionReplyQuotedMessage={serverQuestionId:a.questionReplyQuotedMessage.questionServerId,quotedQuestion:m(a.questionReplyQuotedMessage.quotedQuestion,void 0,{isQuestion:!0,groupMentions:[],mentionedJid:[],statusAttributions:[]},void 0,"quoted"),quotedResponse:m(a.questionReplyQuotedMessage.quotedResponse,void 0,void 0,void 0,"quoted")});a.forwardingScore&&(e.forwardingScore=a.forwardingScore);a.groupId&&(e.groupId=a.groupId);a.groupIndex&&(e.groupIndex=a.groupIndex);a.groupSize&&(e.groupSize=a.groupSize);if(a.forwardedNewsletterMessageInfo){i=a.forwardedNewsletterMessageInfo;g=i.newsletterId;f=i.newsletterName;h=i.serverMessageId;e.forwardedNewsletterMessageInfo={newsletterJid:d("WAWebE2EProtoUtils").encodeJid(g),newsletterName:f,serverMessageId:h}}a.ephemeralDuration&&(e.expiration=a.ephemeralDuration);a.ephemeralSettingTimestamp&&(e.ephemeralSettingTimestamp=a.ephemeralSettingTimestamp);(a.disappearingModeInitiator||a.disappearingModeTrigger!=null&&a.to.isGroup())&&(e.disappearingMode=d("WAWebE2EProtoUtils").disappearingModeInitiatorToProto(a.disappearingModeInitiator,a.disappearingModeTrigger,a.disappearingModeInitiatedByMe));a.ctwaContext&&(e.externalAdReply={sourceUrl:a.ctwaContext.sourceUrl,sourceId:a.ctwaContext.sourceId,sourceType:a.ctwaContext.sourceType,body:a.ctwaContext.description,title:a.ctwaContext.title,thumbnailUrl:a.ctwaContext.thumbnailUrl,thumbnail:a.ctwaContext.thumbnail?d("WAWebE2EProtoUtils").encodeBytes(a.ctwaContext.thumbnail):void 0,mediaType:a.ctwaContext.mediaType,mediaUrl:a.ctwaContext.mediaUrl});c&&(e.utm={utmCampaign:c.campaign!=null?c.campaign:void 0,utmSource:c.source!=null?c.source:void 0});a.cannotBeRanked&&(e.featureEligibilities={cannotBeRanked:a.cannotBeRanked});a.limitSharing&&(e.limitSharingV2=a.limitSharing);return m(a,b,Object.keys(e).length>0?e:void 0)}function l(a){var b=a.id,d=a.toJSON();delete d.status;delete d.mimetype;delete d.height;delete d.width;delete d.recipients;delete d.chat;delete d.broadcast;delete d.ack;delete d.invis;delete d.filehash;delete d.recvFresh;delete d.mediaData;c("WAWebURLUtils").isHttp(a.clientUrl)||delete d.clientUrl;c("WAWebURLUtils").isHttp(a.deprecatedMms3Url)||delete d.deprecatedMms3Url;for(a in d)d[a]==null&&delete d[a];a=c("WAWebConversionTupleCollection").get(b.remote);a&&(d.conversionTuple=a.serialize());return d}function m(a,b,c,e,f){var g;b===void 0&&(b={});c===void 0&&(c=void 0);b=n(a,b,c,e,f);try{e=d("WAWebAssociationProtoUtils").getValidatedOutgoingMessageAssociationContextInfo(a.associationType,a.parentMsgKey);e&&(b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,e))}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["failed to generate associated message context info for "," of association "," due to error: ",""])),a.type,a.associationType,b).sendLogs("getProtobufMessage: failed to generate associated message context info")}!(d("WAWebBotGating").isBotEnabled()&&(g=a.invokedBotWid)!=null&&g.isBot())&&a.messageSecret&&(b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,{messageSecret:a.messageSecret}));if(d("WAWebBotGating").isBotEnabled()){f=d("WAWebGenerateBotMetadata").generateBotMetadata(a);b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,{botMetadata:f})}b=y(b,a,c);if(d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(a.type,a.subtype)){b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,{messageSecret:(f=(e=b.messageContextInfo)==null?void 0:e.messageSecret)!=null?f:a.messageSecret})}a.type===d("WAWebMsgType").MSG_TYPE.COMMENT&&((c=b.messageContextInfo)==null?void 0:c.messageSecret)!=null&&(b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,{messageSecret:null}));a.limitSharing&&(b.messageContextInfo=babelHelpers["extends"]({},b.messageContextInfo,{limitSharingV2:a.limitSharing}));return b}function n(a,b,c,e,f){b===void 0&&(b={});c===void 0&&(c=void 0);e===void 0&&(e={});f=d("WAWebMessagePluginGenerateProtobuf").generateProtobuf({message:e,msgContext:f,contextInfo:c,json:a,mediaMetadata:b});if(f!=null)return f;switch(a.type){case d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE:return{conversation:a.body};case"template":a.subtype==="text"?(a.type="chat",a.title&&(a.body="*"+a.title+"*\n"+a.body)):a.type=a.subtype;return m(a,b,c,e)}return e}function o(a,b){return b.type==="ptt"?{viewOnceMessageV2Extension:{message:a}}:{viewOnceMessage:{message:a}}}function p(a){return{documentWithCaptionMessage:{message:a}}}function q(a){return{lottieStickerMessage:{message:a}}}function r(a){return{groupMentionedMessage:{message:a}}}function s(a){return{botInvokeMessage:{message:a}}}function t(a){return{pollCreationMessageV4:{message:a}}}function u(a){return{questionMessage:{message:a}}}function v(a){return{questionReplyMessage:{message:a}}}function w(a){return{associatedChildMessage:{message:babelHelpers["extends"]({},a,{messageContextInfo:void 0})},messageContextInfo:a.messageContextInfo}}function x(a){var b=a.messageContextInfo;a=babelHelpers.objectWithoutPropertiesLoose(a,h);return{pollCreationOptionImageMessage:{message:a},messageContextInfo:b}}function y(a,b,e){var f,g,h=a;b.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE&&(h=t(h));(e==null?void 0:e.isQuestion)===!0&&(h=u(h));e!=null&&e.questionReplyQuotedMessage&&(h=v(h));b.associationType!=null&&(b.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL?h=x(h):d("WAWebMessageAssociationGatingUtils").isFutureproofAssociatedChildEnabled()&&(h=w(h)));b.isViewOnce&&(h=o(h,b));b.isDynamicReplyButtonsMsg===!0&&(h=d("WAWebButtonsMessageProtoUtils").createDynamicReplyButtonsMessage(h,b,e));b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT&&Boolean((f=h.documentMessage)==null?void 0:f.caption)&&(h=p(h));b.type===d("WAWebMsgType").MSG_TYPE.STICKER&&Boolean((f=h.stickerMessage)==null?void 0:f.isLottie)&&(h=q(h));e!=null&&(g=e.groupMentions)!=null&&g.length&&(h=r(h));if(!((f=b.invokedBotWid)!=null&&f.isFbidBot())&&((e=b.invokedBotWid)!=null&&e.isPnBot()||b.subtype==="bot_request_welcome")){h=s(h);if(d("WAWebBotGating").isBotEnabled()){h.messageContextInfo=babelHelpers["extends"]({},h.messageContextInfo,{messageSecret:b.messageSecret,botMetadata:babelHelpers["extends"]({},((f=a.messageContextInfo)==null?void 0:f.botMetadata)||{},b.botTargetSenderJid instanceof c("WAWebWid")?{invokerJid:b.botTargetSenderJid.toJid()}:{})})}}return h}function z(a,b){var e,f,g,h,i;a=c("lodash").cloneDeep(a);a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{messageSecret:null});b&&(a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{botMessageSecret:b}));b=(a==null||(e=a.botInvokeMessage)==null||(e=e.message)==null||(e=e.extendedTextMessage)==null?void 0:e.contextInfo)||(a==null||(f=a.extendedTextMessage)==null?void 0:f.contextInfo);if((b==null?void 0:b.quotedMessage)!=null){var j;b.participant!=null&&((j=d("WAWebWidFactory").createWid(b.participant))==null?void 0:j.isBot())!==!0&&(delete b.quotedMessage,delete b.stanzaId,delete b.remoteJid,delete b.participant)}j=a==null||(g=a.protocolMessage)==null||(g=g.botFeedbackMessage)==null?void 0:g.messageKey;j!=null&&j.remoteJid!=null&&delete j.remoteJid;b=(a==null||(h=a.protocolMessage)==null?void 0:h.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE?a==null||(i=a.protocolMessage)==null?void 0:i.key:null;b!=null&&b.remoteJid!=null&&delete b.remoteJid;return a}function A(a){var b,e,f,g=a;b=(b=a==null||(e=a.botInvokeMessage)==null||(e=e.message)==null||(e=e.extendedTextMessage)==null||(e=e.contextInfo)==null?void 0:e.participant)!=null?b:a==null||(f=a.extendedTextMessage)==null||(f=f.contextInfo)==null?void 0:f.participant;if(b!=null){b=d("WAWebWidFactory").createWid(b);if(!b.isBot()){g=c("lodash").cloneDeep(a);a=(a=(a=g)==null||(a=a.botInvokeMessage)==null||(a=a.message)==null||(a=a.extendedTextMessage)==null?void 0:a.contextInfo)!=null?a:(a=g)==null||(a=a.extendedTextMessage)==null?void 0:a.contextInfo;if(a!=null){b=d("WAWebLidMigrationUtils").toLid(b);a.participant=d("WAWebE2EProtoUtils").encodeJid(b)}}}return g}function B(a){var b,e=a,f=a==null||(b=a.protocolMessage)==null||(b=b.key)==null?void 0:b.participant;if(f!=null){f=d("WAWebWidFactory").createWid(f);if(!f.isBot()&&!f.isLid()){e=c("lodash").cloneDeep(a);a=(a=e)==null||(a=a.protocolMessage)==null?void 0:a.key;if(a!=null){f=d("WAWebLidMigrationUtils").toLid(f);a.participant=d("WAWebE2EProtoUtils").encodeJid(f)}}}return e}function C(a){var b=a,d=(a==null?void 0:a.protocolMessage)!=null;if(d){b=c("lodash").cloneDeep(a);(d=b.protocolMessage)==null||(d=d.key)==null||delete d.remoteJid;(a=b.protocolMessage)==null||(a=a.key)==null||delete a.participant}return b}function D(a){a=c("lodash").cloneDeep(a);a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{capiCreatedGroup:!0});return a}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLoggerDebugInfo").getDebugInfo({addLanguageFields:!0,convertFields:!0,addUserAgentDetails:!0}));b.sagaKey="saga_v1_enabled";b=babelHelpers["extends"]({version:1,debug_information:b},d("WAWebABPropsSaga").getIsSagaV1CarouselEnabled()?{citations_carousel:!0}:{});a.messageContextInfo=babelHelpers["extends"]({},a.messageContextInfo,{supportPayload:JSON.stringify(b)})});return F.apply(this,arguments)}g.populateMessageContextInfo=a;g.createPeerMsgProtobuf=e;g.createMsgProtobuf=f;g.createAddonProtobuf=j;g.getProtobufMessage=m;g.updateBotInvokeMsgProtoCopyForCapi=z;g.updateFbidBotProtobuf=A;g.updateFbidBotInvokeProtobuf=B;g.updateBotProtobuf=C;g.updateGroupMsgProtoWithCapiFlag=D;g.addDebugInfoSupportPayload=E}),98);
__d("WAWebApiHistorySyncNotification",["WALogger","WAWebHistorySyncNotificationUtils","WAWebHistorySyncProgress","WAWebProtobufsHistorySync.pb","WAWebSchemaHistorySyncNotification","WAWebSyncGatingUtils","WAWebUserPrefsHistorySync","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=new Set(),u={};function v(a,b,c){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.PUSH_NAME)return!0;if([d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.FULL,d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT].includes(a)&&b===1||d("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()&&a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.ON_DEMAND&&b===0){if(a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT){var e=(yield d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete());return e===!0}e=(yield d("WAWebUserPrefsHistorySync").getHistorySyncStatus());return!!(e!=null&&e.recentCompleted)}e=(yield d("WAWebUserPrefsHistorySync").getLastHistorySyncedChunk());if(e==null)return!1;var f=e.split("_"),g=f[0];f=f[1];if(g===""+a&&f===""+(b-1))return!0;else if(g===""+a&&f===""+b){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed: next chunk already processed ","_",", last processed: "," "])),a,b,e).tags("history-sync");yield A(c,a,b);return!1}d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed returned false for ","_",", last processed: "," "])),a,b,e).tags("history-sync");return!1});return w.apply(this,arguments)}function x(a,b,c){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] check if previous recent sync is processed with optimized logic"])));if(b===1){var e=(yield d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete());return e===!0}e=(yield d("WAWebUserPrefsHistorySync").getLastHistoryRecentSyncedChunk());if(e==null)return!1;var f=e.chunkOrder;if(f===b-1)return!0;else if(f===b){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed: next chunk already processed ","_",", last processed: chunkOrder:"," progress:",""])),a,b,e.chunkOrder,e.progress).tags("history-sync");yield A(c,a,b);return!1}d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] isPreviousChunkProcessed returned false for ","_",", last processed: "," "])),a,b,f).tags("history-sync");return!1});return y.apply(this,arguments)}function z(a){return d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().equals(["processed"],0,{shouldDecrypt:!1}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.filter(function(a){return!t.has(a.msgKey)&&!a.reuploadPending}).sort(function(a,b){if(a.syncType!==b.syncType)return b.syncType-a.syncType;return a.chunkOrder!=null&&b.chunkOrder!=null?a.chunkOrder-b.chunkOrder:0});a=a.length>0?a[0]:void 0;b=(b=a)==null?void 0:b.chunkOrder;if(b==null){var c;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] getNextUnProcessedNotification chunkOrder is null, ",""])),(c=a)==null?void 0:c.msgKey).tags("history-sync");return void 0}if(a){a.syncType===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&d("WAWebSyncGatingUtils").isRecentSyncNextChunkFetchOptimizationEnabled()?c=(yield x(a.syncType,b,a.msgKey)):c=(yield v(a.syncType,b,a.msgKey));d("WAWebHistorySyncProgress").handleChunkProgress(c);if(!c)return void 0;a=(yield d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().postflightDecryptSingleRecord(a))}return a});return function(b){return a.apply(this,arguments)}}())}function A(a,b,c){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] remove history sync notification from db with ","_",""])),b,c);t["delete"](a);return d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().remove(a)["catch"](function(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] updateCurrentlyProcessed failed with error ",""])),a).tags("history-sync")})}function a(a){t["delete"](a);return d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().merge(a,{reuploadPending:!0})}function c(a){t["delete"](a)}function B(a){var b=d("WAWebHistorySyncNotificationUtils").getHistorySyncBasicChunkInfoString(a.syncType,a.chunkOrder,a.isReupload);d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] add history sync notification, ",""])),b);b=a.downloadOptions.mediaKey;var c=a.downloadOptions.directPath,e=a.downloadOptions.filehash,f=a.downloadOptions.encFilehash;a.downloadOptions.mediaKey="";a.downloadOptions.directPath="";a.downloadOptions.filehash="";a.downloadOptions.encFilehash="";b=babelHelpers["extends"]({},a,{chunkEncryptionKey:b,directPath:c,filehash:e,encFilehash:f});a.processed=0;return d("WAWebSchemaHistorySyncNotification").getHistorySyncNotificationTable().createOrMerge(a.msgKey,b)}function e(a,b){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1),yield B(a).then(function(){void d("WAWebUserPrefsHistorySync").setRecentSyncSingleChunkStatus(a.syncType,d("WAWebUserPrefsTypes").HistorySyncSingleChunkStatusType.NOTIFICATION_STORED,a.chunkOrder)}),b&&t.add(a.msgKey)});return C.apply(this,arguments)}function f(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(t.size>0){d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[history sync] return null for next history sync chunk due to inFlightChunk.size=",""])),t.size);return null}var a=(yield z());if(a){var b=d("WAWebHistorySyncNotificationUtils").getHistorySyncBasicChunkInfoString(a==null?void 0:a.syncType,a==null?void 0:a.chunkOrder,a==null?void 0:a.isReupload);d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[history sync] fetched next history sync chunk for processing, ",""])),b);a.downloadOptions.mediaKey=a.chunkEncryptionKey;delete a.chunkEncryptionKey;a.downloadOptions.directPath=a.directPath||a.downloadOptions.directPath;delete a.directPath;a.downloadOptions.filehash=a.downloadOptions.filehash===""?a.filehash:a.downloadOptions.filehash;delete a.filehash;a.downloadOptions.encFilehash=a.encFilehash;delete a.encFilehash;t.add(a.msgKey)}else d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] return null for next history sync chunk due to next=null"])));return a});return D.apply(this,arguments)}g.inFlightChunk=t;g.recentSyncChunkHandlingTriedCount=u;g.updateCurrentlyProcessed=A;g.markChunkForReuploadPending=a;g.removeLocalFailureFromInFlightChunk=c;g.enqueueNotification=e;g.fetchNextHistorySyncChunkForProcessing=f}),98);
__d("WAWebSettingsGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createSettingsCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;d=b("archive");a=c(function(a){a=a[0];return!a.enabled?!1:!a.classic},[d]);g.clearSettingsGetterCacheFor=f;g.getArchive=d;g.getShowArchiveV2=a}),98);
__d("WAWebSettingsModel",["WAWebBaseModel","WAWebSettingsGetters"],(function(a,b,c,d,e,f,g){var h={classic:!1,enabled:!1};a={duration:0,settingTimestamp:0};b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.archive=d("WAWebBaseModel").prop(),b.disappearingMode=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){this.set({archive:h,disappearingMode:h}),a.prototype["delete"].call(this),d("WAWebSettingsGetters").clearSettingsGetterCacheFor(this)};return b}(d("WAWebBaseModel").BaseModel);b.Proxy="settings";c=d("WAWebBaseModel").defineModel(b);e=new c({id:"default_settings_id",archive:h,disappearingMode:a});g["default"]=e}),98);
__d("WAWebInitFromStorage",["Promise","WALogger","WAWebAgentCollection","WAWebApiHydrateWidsUtil","WAWebBizGatingUtils","WAWebBlocklistCollection","WAWebCartCollection","WAWebChatAssignmentCollection","WAWebCommunityActivityCollection","WAWebConnModel","WAWebDBLabelAssociationDatabaseApi","WAWebFavoriteStickerCollection","WAWebGroupMetadataCollection","WAWebLabelCollection","WAWebListsGatingUtils","WAWebLogoutReasonConstants","WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebMobilePlatforms","WAWebModelStorageUtils","WAWebNonMessageDataRequestMediaHandlingUtils","WAWebOptOutListCollection","WAWebQuickReplyCollection","WAWebRecentStickerCollectionMd","WAWebSchemaAgent","WAWebSchemaBlocklist","WAWebSchemaCart","WAWebSchemaChatAssignment","WAWebSchemaFavoriteStickers","WAWebSchemaLabel","WAWebSchemaNonMessageDataRequest","WAWebSchemaOptOutList","WAWebSchemaQuickReply","WAWebSchemaRecentStickers","WAWebSchemaStickerDownload","WAWebSchemaSubscription","WAWebSchemaUnjoinedSubgroupMetadata","WAWebSettingsGetters","WAWebSettingsModel","WAWebSocketModel","WAWebStickerDownloadCollection","WAWebSubscriptionCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[InitFromStorage] will attempt to initialize metadata from storage"])));d("WAWebConnModel").Conn.trigger("me_ready");d("WAWebConnModel").Conn.meReadyTriggered=!0;var a=d("WAWebUserPrefsGeneral").getPushname(),b=(yield d("WAWebUserPrefsGeneral").getLastMobilePlatform());if(b==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["platform not found in UserPrefs."])));return d("WAWebSocketModel").Socket.logout(d("WAWebLogoutReasonConstants").LogoutReason.UnknownCompanion)}yield d("WAWebMobilePlatforms").setMobilePlatform(b,!1);d("WAWebConnModel").Conn.pushname=a;d("WAWebConnModel").Conn.platform=b;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[InitFromStorage] important metadata loaded"])))});return n.apply(this,arguments)}function e(){return d("WAWebSchemaBlocklist").getBlocklistTable().all().then(function(a){d("WAWebBlocklistCollection").BlocklistCollection.initializeFromCache(a.map(d("WAWebApiHydrateWidsUtil").hydrateWids))})}function f(){return!d("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMOptOutEnabled()?(m||(m=b("Promise"))).resolve():d("WAWebSchemaOptOutList").getOptOutListTable().all().then(function(a){d("WAWebOptOutListCollection").OptOutListCollection.initializeFromCache(a.map(d("WAWebApiHydrateWidsUtil").hydrateWids))})}function o(){return d("WAWebBizGatingUtils").canDisplayLabel()||d("WAWebListsGatingUtils").isListsEnabled()?d("WAWebSchemaLabel").getLabelTable().all().then(function(a){d("WAWebLabelCollection").LabelCollection.initializeFromCache(a)}):(m||(m=b("Promise"))).resolve()}function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").canDisplayLabel()||d("WAWebListsGatingUtils").isListsEnabled()){var a=[];yield d("WAWebModelStorageUtils").getStorage().lock(["label","label-association","chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];b=(yield b.all());b=b.map(function(a){return a.id});b=(yield d("WAWebDBLabelAssociationDatabaseApi").queryLabelAssociationsForLabelIds(b));a.push.apply(a,b)});return function(a){return c.apply(this,arguments)}}());a.length>0&&d("WAWebLabelCollection").LabelCollection.initializeAssociationsFromCache(a)}return(m||(m=b("Promise"))).resolve()});return q.apply(this,arguments)}function r(){return d("WAWebBizGatingUtils").canSendQuickReply()?d("WAWebSchemaQuickReply").getQuickReplyTable().all().then(function(a){d("WAWebQuickReplyCollection").QuickReplyCollection.initializeFromCache(a)}):(m||(m=b("Promise"))).resolve()}function s(){return d("WAWebSchemaRecentStickers").getRecentStickersTable().all().then(function(a){return d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.initializeFromCache(a)})}function t(){return d("WAWebSchemaFavoriteStickers").getFavoriteStickersTable().all().then(function(a){return d("WAWebFavoriteStickerCollection").FavoriteStickerCollection.initializeFromCache(a)})}function u(){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getArchiveV2EnabledSetting()),b=(yield d("WAWebUserPrefsMultiDevice").getUnarchiveChatsSetting());a!=null&&(c("WAWebSettingsModel").archive=babelHelpers["extends"]({},d("WAWebSettingsGetters").getArchive(c("WAWebSettingsModel")),{enabled:a}));b!=null&&(c("WAWebSettingsModel").archive=babelHelpers["extends"]({},d("WAWebSettingsGetters").getArchive(c("WAWebSettingsModel")),{classic:b}))});return v.apply(this,arguments)}function w(){return d("WAWebSchemaCart").getCartTable().all().then(function(a){d("WAWebCartCollection").CartCollection.initializeFromCache(a.map(d("WAWebApiHydrateWidsUtil").hydrateWids))})}function x(){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").isMultiDeviceMessageAttributionEnabled()){var a=(yield d("WAWebSchemaAgent").getAgentTable().all());d("WAWebAgentCollection").AgentCollection.initializeFromCache(a)}});return y.apply(this,arguments)}function z(){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaSubscription").getSubscriptionTable().all());d("WAWebSubscriptionCollection").SubscriptionCollection.initializeFromCache(a)});return A.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebBizGatingUtils").chatAssignmentEnabled()){var a=(yield d("WAWebSchemaChatAssignment").getChatAssignmentTable().all());d("WAWebChatAssignmentCollection").ChatAssignmentCollection.initializeFromCache(a)}});return C.apply(this,arguments)}function D(){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreUnjoinedSubgroups: start restoring unjoined subgroups"])));try{var a=(yield d("WAWebSchemaUnjoinedSubgroupMetadata").getUnjoinedSubgroupMetadataTable().all());a.forEach(function(a){c("WAWebUnjoinedSubgroupMetadataCollection").add({id:d("WAWebWidFactory").createWid(a.id),subject:a.subject,subjectTime:a.subjectTime,defaultSubgroup:a.defaultSubgroup,parentGroupId:d("WAWebWidFactory").createWid(a.parentGroup),size:a.size,generalSubgroup:a.generalSubgroup,membershipApprovalMode:a.membershipApprovalMode,membershipApprovalRequest:a.membershipApprovalRequest,hiddenSubgroup:a.hiddenSubgroup},{merge:!0})})}finally{d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: restoreUnjoinedSubgroups: complete restoring unjoined subgroups"])))}});return E.apply(this,arguments)}function F(){var a=c("WAWebGroupMetadataCollection").filter(function(a){return a.isParentGroup});a=a.map(function(a){return c("WAWebCommunityActivityCollection").syncActivityFor(a.id)});return(m||(m=b("Promise"))).all(a)}function G(){return d("WAWebSchemaNonMessageDataRequest").getNonMessageDataRequestTable().all().then(function(a){d("WAWebNonMessageDataRequestMediaHandlingUtils").initializeMediaUploadResultFromStorage(a)})}function H(){return d("WAWebSchemaStickerDownload").getStickerDownloadTable().all().then(function(a){return d("WAWebStickerDownloadCollection").StickerDownloadCollection.initializeFromCache(a)})}g.restoreImportantMetaData=a;g.restoreBlocklist=e;g.restoreOptOutList=f;g.restoreLabels=o;g.restoreLabelAssociations=p;g.restoreQuickReplies=r;g.restoreRecentStickers=s;g.restoreFavoriteStickers=t;g.restoreArchiveV2Settings=u;g.restoreCarts=w;g.restoreAgents=x;g.restoreSubscriptions=z;g.restoreChatAssignments=B;g.restoreUnjoinedSubgroups=D;g.restoreCommunityActivity=F;g.restoreMediaUploadResult=G;g.restoreStickerDownload=H}),98);
__d("WAWebGetPendingMutation",["WAWebRunInTransaction"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.getByCollection(a)})}function b(){return d("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(a){a=a.PendingMutationStore;return a.getAll()})}function c(a){return d("WAWebRunInTransaction").runInTransaction({PendingMutationStore:!0},function(b){b=b.PendingMutationStore;return b.bulkCreate(a)})}g.getSyncPendingMutationsByCollectionInTransaction=a;g.getAllSyncPendingMutationsInTransaction=b;g.bulkCreateSyncPendingMutationsInTransaction=c}),98);
__d("WAWebSentinel",["WASyncdConst","WAWebGetPendingMutation","WAWebSentinelMutationSync","WAWebSyncd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("WAWebSentinelMutationSync").getSentinelMutations());yield d("WAWebGetPendingMutation").bulkCreateSyncPendingMutationsInTransaction(a);return d("WAWebSyncd").markCollectionsForSync(Array.from(d("WASyncdConst").CollectionName.members()))});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebGetCollectionVersion",["WACryptoLtHash","WAWebRunInTransaction"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a)})}function h(a,b){a=a.CollectionVersionStore;return a.get(b).then(function(a){return(a=a==null?void 0:a.ltHash)!=null?a:new ArrayBuffer(d("WACryptoLtHash").KEY_LENGTH_BYTES)})}function b(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return h({CollectionVersionStore:b},a)})}function c(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkGet(a)})}function e(){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(a){a=a.CollectionVersionStore;return a.getAll()})}function f(a,b,c){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(d){d=d.CollectionVersionStore;return d.update(a,{version:b,ltHash:c})})}function i(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.bulkUpdate(a)})}function j(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.get(a).then(function(a){return a==null?void 0:a.isCollectionInMacMismatchFatal})})}function k(a){return d("WAWebRunInTransaction").runInTransaction({CollectionVersionStore:!0},function(b){b=b.CollectionVersionStore;return b.update(a,{isCollectionInMacMismatchFatal:!0})})}g.getCollectionVersionInTransaction=a;g.getCollectionVersionLtHashInTransaction=b;g.bulkGetCollectionVersionsInTransaction=c;g.getAllCollectionVersionsInTransaction=e;g.updateCollectionVersionAndLtHashInTransaction=f;g.bulkUpdateCollectionVersionInTransaction=i;g.getIsCollectionInMacMismatchFatalInTransaction=j;g.updateIsCollectionInMacMismatchFatalInTransaction=k}),98);
__d("WAWebGetSyncAction",["WASyncdConst","WAWebRunInTransaction"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.count()})}function b(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.get(a)})}function c(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByCollections(a)})}function e(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByIndexMacs(a)})}function f(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByActionStates(a)})}function h(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByModelInfos(a)})}function i(){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(a){a=a.SyncActionStore;return a.getAll()})}function j(a){return d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0},function(b){b=b.SyncActionStore;return b.getByActionStates([d("WASyncdConst").SyncActionState.Orphan]).then(function(b){return b.filter(function(b){return b.modelType!=null&&d("WASyncdConst").SyncModelType.cast(b.modelType)===a})})})}g.countSyncActionsInTransaction=a;g.getSyncActionInTransaction=b;g.getSyncActionsByCollectionsInTransaction=c;g.getSyncActionsByIndexMacsInTransaction=e;g.getSyncActionsByActionStatesInTransaction=f;g.getSyncActionsByModelInfosInTransaction=h;g.getAllSyncActions=i;g.getOrphanSyncActionsByModelTypeInTransaction=j}),98);
__d("WAWebSyncdCollectionsStateMachine",["WALogger","WASyncdConst","WATimeUtils","WAWebGetCollectionVersion","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;a=function(){function a(){}a.loadStatesFromDb=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,b=(yield d("WAWebGetCollectionVersion").getAllCollectionVersionsInTransaction());b.forEach(function(b){return a.collectionStates.set(b.collection,{collection:b.collection,state:b.state,finiteFailureStartTime:b.finiteFailureStartTime})})});function c(){return a.apply(this,arguments)}return c}();a.persistToDb=function(){var a=[];this.collectionStates.forEach(function(b){return a.push(babelHelpers["extends"]({},b))});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine persistToDb. states:"])));a.forEach(function(a){var b=a.finiteFailureStartTime==null?"":"(failure start: "+a.finiteFailureStartTime+")";d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": "," ",""])),a.collection,a.state,b)});return d("WAWebGetCollectionVersion").bulkUpdateCollectionVersionInTransaction(a)};a.clean=function(){this.collectionStates=new Map()};a.getCollectionState=function(a){var b=this.collectionStates.get(a);if(b)return b.state;this.moveCollectionsToUpToDate([a]);return d("WASyncdConst").CollectionSyncState.UpToDate};a.getCollectionsInStateDirty=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Dirty&&a.push(b.collection)});return a};a.getCollectionsInStateRetry=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry&&a.push(b.collection)});return a};a.getCollectionsInStateFatal=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Fatal&&a.push(b.collection)});return a};a.getCollectionsInStateBlocked=function(){var a=[];this.collectionStates.forEach(function(b){b.state===d("WASyncdConst").CollectionSyncState.Blocked&&a.push(b.collection)});return a};a.moveCollectionsToUpToDate=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.UpToDate,finiteFailureStartTime:void 0})})};a.moveCollectionsToDirty=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Dirty,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.moveCollectionsToFiniteRetry=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.FailingFiniteRetry,finiteFailureStartTime:(a=(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime)!=null?a:d("WATimeUtils").unixTimeMs()})})};a.moveCollectionsToFatal=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Fatal})})};a.moveCollectionsToBlocked=function(a){var b=this;a.forEach(function(a){return b.collectionStates.set(a,{collection:a,state:d("WASyncdConst").CollectionSyncState.Blocked,finiteFailureStartTime:(a=b.collectionStates.get(a))==null?void 0:a.finiteFailureStartTime})})};a.getExpiredCollections=function(){var a=[];this.collectionStates.forEach(function(b){if(b.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry){var c;b.finiteFailureStartTime==null?(c=Infinity,d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Collection "," is in finite retry state with no failure start time"])),b.collection)):c=b.finiteFailureStartTime;c=c+d("WASyncdConst").FINITE_FAILURE_EXPIRY_DURATION;c<d("WATimeUtils").unixTimeMs()&&a.push(b.collection)}});return a};a.getCollectionMinFailureTime=function(){var a=Array.from(this.collectionStates.values()).filter(function(a){return a.state===d("WASyncdConst").CollectionSyncState.FailingFiniteRetry}).map(function(a){return a.finiteFailureStartTime}).filter(Boolean);return a.length===0?null:Math.min.apply(Math,a)};return a}();a.collectionStates=new Map();g["default"]=a}),98);
__d("WAWebSyncdDisabled",["WAWebRuntimeEnvironmentUtils"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebRuntimeEnvironmentUtils").isWorker()?!0:!1}g.isSyncdDisabled=a}),98);
__d("WAWebSyncdMetricCriticalBootstrapStage",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncAction.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=b("$InternalEnum").Mirrored(["ABOUT_TO_APPLY_MUTATIONS","APPLIED_MUTATIONS","MUTATIONS_DECRYPTED","REQUEST_BUILT","RESPONSE_RECEIVED","RESPONSE_PARSED_VALID","ENTERED_RETRY_MODE","MISSING_KEYS_RECEIVED"]),p=b("$InternalEnum").Mirrored(["PATCH_MUTATIONS","SNAPSHOT_MUTATIONS"]);function q(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_BOOTSTRAP_STAGE).endSuccess(r({type:a}))}function a(a,b){q(o.MUTATIONS_DECRYPTED),d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_DECRYPT_MUTATIONS).endSuccess(s({type:a,mutations:b}))}function r(a){return{string:{criticalBootstrapStage:a.type}}}function s(a){var b=a.type;a=a.mutations;var c,e=0,f=[];a.forEach(function(a){a=a.binarySyncData;a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a);a=a.value;if(a==null)return;a.archiveChatAction?c=a.archiveChatAction.messageRange:a.markChatAsReadAction?c=a.markChatAsReadAction.messageRange:a.clearChatAction?c=a.clearChatAction.messageRange:a.deleteChatAction&&(c=a.deleteChatAction.messageRange);c!=null&&(e+=c.messages.length,f.push(c.messages.length))});return{string:{mutationType:b},"int":{count:a.length,totalAdditionalMessagesCount:e},int_array:{messageRangeLengths:f}}}function c(a){var b;a=a==null||(b=a.string)==null?void 0:b.criticalBootstrapStage;if(a==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing bootstrap stage for critical bootstrap stage"])));return null}var c=o.cast(a);if(c==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown bootstrap stage: "," for critical bootstrap stage"])),a);return null}return{type:c}}function e(a){var b,c,e,f,g=a==null||(b=a.string)==null?void 0:b.mutationType,h=a==null||(c=a["int"])==null?void 0:c.count,i=a==null||(e=a["int"])==null?void 0:e.totalAdditionalMessagesCount;a=a==null||(f=a.int_array)==null?void 0:f.messageRangeLengths;if(g==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing type for DecryptMutations"])));return null}if(h==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing count for DecryptMutations"])));return null}if(i==null){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing totalAdditionalMessagesCount for DecryptMutations"])));return null}if(a==null){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing decryptedMutationMessageRangeCountArray for DecryptMutations"])));return null}g=p.cast(g);if(g==null){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown SyncdDecryptMutationsType for DecryptMutations"])));return null}return{type:g,count:h,totalAdditionalMessagesCount:i,decryptedMutationMessageRangeCountArray:a}}g.SyncdCriticalBootstrapStageType=o;g.SyncdDecryptMutationsType=p;g.reportSyncdCriticalBootstrapStage=q;g.reportSyncdDecryptedMutations=a;g.convertSyncdCriticalBootstrapStageFromAnnotations=c;g.convertSyncdDecryptMutationsMetricsFromAnnotations=e}),98);
__d("WAWebSyncd",["Promise","WALogger","WASyncdConst","WAWebGetCollectionVersion","WAWebGetMissingKey","WAWebGetPendingMutation","WAWebGetSyncAction","WAWebGetSyncKey","WAWebSyncdAntiTampering","WAWebSyncdCollectionsStateMachine","WAWebSyncdCryptoUtils","WAWebSyncdDbCallbacksApi","WAWebSyncdDisabled","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdOrphan","WAWebSyncdServerSync","WAWebSyncdWamAppState","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,aa,ba,ca,w,x,y,z,A,B,C,D,E,F,G,H=1e3,da=1e3*60*60,ea=2,I=new Set(),J=new Set(),K,L=!1,M=0,N=0;function O(a,b){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b!=null?yield fa(a,b):a;d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: marking for sync: ",""])),b);b.forEach(function(a){var b=c("WAWebSyncdCollectionsStateMachine").getCollectionState(a);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," state before sync: ",""])),a,b);b===d("WASyncdConst").CollectionSyncState.UpToDate?c("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty([a]):b===d("WASyncdConst").CollectionSyncState.Dirty&&(J=new Set([].concat(Array.from(J),[a])))});yield c("WAWebSyncdCollectionsStateMachine").persistToDb();return U()});return P.apply(this,arguments)}function fa(a,b){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["syncd: start filter collections: ",""])),a);var c=(yield d("WAWebGetCollectionVersion").bulkGetCollectionVersionsInTransaction(a)),e=new Map(a.map(function(a,b){return[a,(a=c[b])==null?void 0:a.version]}));return a.filter(function(a){var c=e.get(a);if(c==null){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version for "," missing; will mark for sync."])),a);return!0}var f=b.get(a);if(f==null){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["syncd: server version for "," missing; will mark for sync."])),a);return!0}if(c<f){d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",") for "," less than server version (","); will mark for sync."])),c,a,f);return!0}d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["syncd: local version (",")for "," >= server version (","); will not mark for sync."])),c,a,f);return!1})});return Q.apply(this,arguments)}function a(){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b=(yield d("WAWebGetSyncAction").countSyncActionsInTransaction());(a=d("WAWebSyncdWamAppState")).setStoredMutationCount(b);b=(yield d("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Malformed]));a.setInvalidActionCount(b.length);b=(yield d("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Unsupported]));a.setUnsupportedActionCount(b.length);b=(yield d("WAWebGetMissingKey").getMissingKeyCountTransaction());a.setMissingKeyCount(b)});return R.apply(this,arguments)}function e(){return S.apply(this,arguments)}function S(){S=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});return S.apply(this,arguments)}function f(){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});return T.apply(this,arguments)}function e(){var a=c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateBlocked();d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync blocked collections: ",""])),a);c("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty(a);J=new Set([].concat(Array.from(J),Array.from(I)));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncBlockedCollections:\n    \tmoving blocked collections to dirty: [","]\n    \tadding inflight collections to pending: [","]"],["syncd: syncBlockedCollections:\n    \\tmoving blocked collections to dirty: [","]\n    \\tadding inflight collections to pending: [","]"])),a,Array.from(I));return U()}function U(){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebSyncdDisabled").isSyncdDisabled())return(G||(G=b("Promise"))).resolve();var a=c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateDirty();d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["syncd: dirty collections: ",""])),a);var e=new Set(a.filter(function(a){return!I.has(a)}));if(e.size===0){d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["syncd: no collections to sync"])));return(G||(G=b("Promise"))).resolve()}a=[];try{I=new Set([].concat(Array.from(I),Array.from(e)));d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync"])));a=(yield d("WAWebSyncdServerSync").serverSync(Array.from(e)));d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync successful"])));var f=a.filter(function(a){return a.state===d("WASyncdConst").CollectionState.ErrorRetry});f.length>0&&(N=f[0].serverBackoff||0,M=0);Y(a)}catch(a){d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during sync(): ",""])),a),c("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(e))}finally{d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after sync()"]))),c("WAWebSyncdCollectionsStateMachine").persistToDb(),I=new Set(Array.from(I).filter(function(a){return!e.has(a)})),X(),yield d("WAWebSyncdDbCallbacksApi").handleSyncCompleted(a)}});return V.apply(this,arguments)}function ga(){if(d("WAWebSyncdDisabled").isSyncdDisabled())return;var a=new Set(c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateRetry());if(a.size===0)return;K=setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{L=!0;M+=1;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: initiate server sync retry"])));var b=(yield d("WAWebSyncdServerSync").serverSync(Array.from(a)));d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: server sync retry successful"])));Y(b)}catch(b){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: exception during handleRetry(): ",""])),b),c("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry(Array.from(a))}finally{d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: cleanup after handleRetry()"]))),yield ia(),c("WAWebSyncdCollectionsStateMachine").persistToDb(),L=!1,X()}}),ha(M,N))}function ha(a,b){a=Math.pow(ea,a)*H;return Math.min(Math.max(a,b),da)}function ia(){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=c("WAWebSyncdCollectionsStateMachine").getExpiredCollections();a.length>0&&(c("WAWebSyncdCollectionsStateMachine").moveCollectionsToFatal(a),yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(),d("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: expired collections"]))).sendLogs("syncd: fatal error: expired collections"),d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D,{collection:a[0],lidMigrationStage:d("WAWebSyncdAntiTampering").getLidMigrationStage()}))});return W.apply(this,arguments)}function X(){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: state machine tick"])));c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateDirty().length>0&&(J=new Set(Array.from(J).filter(function(a){return I.has(a)})),U());var a=c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateRetry();if(a.length>0){if(L){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: retry is in flight"])));return}K!=null&&clearTimeout(K);J=new Set(Array.from(J).filter(function(b){return!a.includes(b)}));ga()}c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateFatal().length>0&&d("WAWebSyncdDbCallbacksApi").handleSyncdFatal({collections:c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateFatal()})}function Y(a){return a.forEach(function(a){if(a.state===d("WASyncdConst").CollectionState.Success&&!J.has(a.name))return c("WAWebSyncdCollectionsStateMachine").moveCollectionsToUpToDate([a.name]);if(a.state===d("WASyncdConst").CollectionState.ErrorRetry){d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ENTERED_RETRY_MODE);return c("WAWebSyncdCollectionsStateMachine").moveCollectionsToFiniteRetry([a.name])}if(a.state===d("WASyncdConst").CollectionState.ErrorFatal)return c("WAWebSyncdCollectionsStateMachine").moveCollectionsToFatal([a.name]);if(a.state===d("WASyncdConst").CollectionState.Blocked&&!J.has(a.name))return c("WAWebSyncdCollectionsStateMachine").moveCollectionsToBlocked([a.name])})}function ja(){return Z.apply(this,arguments)}function Z(){Z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections"])));var a=(yield d("WAWebGetPendingMutation").getAllSyncPendingMutationsInTransaction()),b=c("WAWebSyncdCollectionsStateMachine").getCollectionsInStateBlocked();c("WAWebSyncdCollectionsStateMachine").moveCollectionsToDirty(b);a=a.map(function(a){return a.collection}).concat(b);a.length>0&&(d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncPendingMutationsAndBlockedCollections: [","]"])),a),O(a))});return Z.apply(this,arguments)}function ka(){return c("WAWebSyncdCollectionsStateMachine").loadStatesFromDb().then(function(){return X()})}function la(){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebSyncdOrphan").applyAllOrphansAndUnsupported(),d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["syncd: syncing pending mutations and blocked collections due to app resume"]))),yield ja()});return $.apply(this,arguments)}function ma(){return I}function na(){return J}g.markCollectionsForSync=O;g.reportWam=a;g.logKeysInfoInIntern=f;g.syncBlockedCollections=e;g.initializeStateMachine=ka;g.processOnAppResume=la;g.getInFlightCollections=ma;g.getPendingCollections=na}),98);
__d("WAWebSyncdMutationsCryptoUtils",["WACryptoAesCbc","WACryptoDependencies","WACryptoHmac","WAServerSync.pb","WASyncdKeyTypes","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=d("WASyncdKeyTypes").fromSyncKeyId(b);var e;switch(a){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:e=d("WAWebSyncdCryptoConst").OPERATION_SET_HEX;break;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:e=d("WAWebSyncdCryptoConst").OPERATION_REMOVE_HEX;break}if(e!=null){a=new Uint8Array([parseInt(e,16)]).buffer;var f=new Uint8Array(a.byteLength+b.byteLength);f.set(new Uint8Array(a));f.set(new Uint8Array(b),a.byteLength);return f.buffer}throw c("err")("invalid mutation operation value")}function b(a,b){a=Math.max(0,d("WAWebSyncdCryptoConst").MAX_OF_MIN_DATA_LENGTH-a-b);b=new Uint8Array(a);d("WACryptoDependencies").getCrypto().getRandomValues(b);return b.buffer}function e(a,b,c){return d("WACryptoAesCbc").aesCbcEncrypt(b,c,a)}function f(a,b,c){var e=new Uint8Array(d("WAWebSyncdCryptoConst").OCTET_LENGTH);e.set([a.byteLength],e.byteLength-1);a=d("WAWebSyncdCryptoUtils").combine([a,b,e.buffer]);return d("WACryptoHmac").hmacSha512(c,a,d("WAWebSyncdCryptoConst").MAC_LENGTH)}function h(a,b,c){return d("WACryptoAesCbc").aesCbcDecrypt(b,a,c)}g.generateAssociatedData=a;g.generatePadding=b;g.generateCipherText=e;g.generateMac=f;g.decryptCipherText=h}),98);
__d("WAWebSyncdDecryptMutations",["WACryptoUtils","WASyncAction.pb","WAWebSyncdCrypto","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","WAWebSyncdDecode","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdMutationsCryptoUtils","WAWebSyncdValidateSyncActionProtobuf","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d,e){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var h=g.index.blob;g=g.value.blob;var i=d("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(g);g=d("WAWebSyncdCryptoUtils").split(g,d("WAWebSyncdCryptoConst").IV_LENGTH,g.byteLength-d("WAWebSyncdCryptoConst").MAC_LENGTH-d("WAWebSyncdCryptoConst").IV_LENGTH);var j=g[0],k=g[1];g=g[2];e=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(e));var l=e.indexKey,m=e.valueEncryptionKey;e=e.valueMacKey;var n=d("WAWebSyncdCryptoUtils").combine([j,k]);f=d("WAWebSyncdMutationsCryptoUtils").generateAssociatedData(f,b);b=(yield d("WAWebSyncdMutationsCryptoUtils").generateMac(f,n,e));if(!d("WACryptoUtils").arrayBuffersEqual(g,b)){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("decryption failure: valueMAC mismatch")}f=(yield d("WAWebSyncdMutationsCryptoUtils").decryptCipherText(new Uint8Array(j),m,k));n=d("WAWebSyncdDecode").decodeSyncActionData(a,f);e=c("WAWebSyncdValidateSyncActionProtobuf").validateSyncActionDataProtobuf(a,n);g=(yield d("WAWebSyncdCrypto").generateIndexMac(l,e.index));if(!d("WACryptoUtils").arrayBuffersEqual(h,g)){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DECRYPTION_FAILED,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("decryption failure: indexMAC mismatch")}b=e.index;j=e.value;m=e.version;return{version:m,index:b,value:j?d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,j).readBuffer():null,indexMac:h,valueMac:i,plaintext:f}});return h.apply(this,arguments)}g.syncdDecryptMutation=a}),98);
__d("WAWebSyncdEncryptMutations",["WAArrayBufferUtils","WACryptoDependencies","WASyncAction.pb","WAWebSyncdCrypto","WAWebSyncdCryptoConst","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdMutationsCryptoUtils","WAWebSyncdRequestEncode","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{var e,f=a.index,g=a.binarySyncAction,h=a.operation;a=a.version;f=d("WAArrayBufferUtils").stringToArrayBuffer(f);c=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(c));var j=c.indexKey,k=c.valueEncryptionKey;c=c.valueMacKey;var l=(yield d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(d("WAWebSyncdCryptoConst").IV_LENGTH))),m=(e=d("WAWebSyncdMutationsCryptoUtils")).generatePadding(f.byteLength,g.byteLength);g=i(f,g,m,a);m=(yield e.generateCipherText(l,k,g));a=e.generateAssociatedData(h,b);l=(yield e.generateMac(a,m,c));k=d("WAWebSyncdCryptoUtils").combine([m,l]);g=(yield d("WAWebSyncdCrypto").generateIndexMac(j,f));return{indexMac:g,indexAndValueCipherText:k}}catch(a){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.ENCRYPTION_FAILED);throw new(d("WAWebSyncdError").SyncdFatalError)("encryption failure")}});return h.apply(this,arguments)}function i(a,b,c,e){return d("WAWebSyncdRequestEncode").encodeSyncActionData({index:a,value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,b),padding:c,version:e})}g.syncdEncryptMutation=a}),98);
__d("WAWebSyncdEncryptionManager",["WACryptoHmac","WAEncodeString","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdDecryptMutations","WAWebSyncdEncryptMutations","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(a));a=a.snapshotMacKey;e=d("WAEncodeString").toUtf8(e).buffer;c=d("WAWebSyncdCryptoUtils").to64BitNetworkOrder(c);return d("WACryptoHmac").hmacSha256(a,d("WAWebSyncdCryptoUtils").combine([b,c,e]))});return h.apply(this,arguments)}function c(a,b,c,d,e){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){a=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(a));a=a.patchMacKey;f=d("WAEncodeString").toUtf8(f).buffer;e=d("WAWebSyncdCryptoUtils").to64BitNetworkOrder(e);return d("WACryptoHmac").hmacSha256(a,d("WAWebSyncdCryptoUtils").combine([b].concat(c,[e,f])))});return i.apply(this,arguments)}e={encryptMutation:d("WAWebSyncdEncryptMutations").syncdEncryptMutation,decryptMutation:d("WAWebSyncdDecryptMutations").syncdDecryptMutation,generatePatchMac:c,generateSnapshotMac:a};g.WASyncdEncryptionManager=e}),98);
__d("WAWebEncryptionManagerSelector",["WASyncdKmpEncryptionManager","WAWebABProps","WAWebSyncdEncryptionManager"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("kmp_syncd_engine_crypto_enabled")?d("WASyncdKmpEncryptionManager").WASyncdKmpEncryptionManager:d("WAWebSyncdEncryptionManager").WASyncdEncryptionManager}g.syncdEncryptionManager=a}),98);
__d("WAWebKeyManagementUtils",["WALogger","WAWebApiDeviceList","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[],b=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();try{var c=(yield d("WAWebApiDeviceList").getMyDeviceList());c.devices.forEach(function(c){c.id!==b.getDeviceId()&&a.push(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,c.id))})}catch(a){c=String(a);d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPeerDevices: error ",". Future key requests will only be sent to primary device."])),c).sendLogs(c);return[d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,0)]}return a});return i.apply(this,arguments)}g.getPeerDevices=a}),98);
__d("WAWebSyncdKeyCache",["WABase64","WASyncdKeyTypes","WAWebGetSyncKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WABase64").encodeB64(d("WASyncdKeyTypes").fromSyncKeyId(a)),c=h.get(b);if(c)return c.keyData;c=(yield d("WAWebGetSyncKey").getSyncKeyInTransaction_DO_NOT_USE(a));c&&h.set(b,c);return(a=c)==null?void 0:a.keyData});return i.apply(this,arguments)}function c(){h=new Map()}g.getKeyData=a;g.clearSyncKeysCache=c}),98);
__d("WAWebSyncdMetrics",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t=b("$InternalEnum").Mirrored(["MISSING_MUTATION_TO_REMOVE"]),u=b("$InternalEnum").Mirrored(["SNAPSHOT_USED","SNAPSHOT_NOT_USED"]),v=b("$InternalEnum").Mirrored(["APP_STATE_SYNC_KEY_EXPIRY","DEVICE_DEREGISTERATION","NO_KEYS"]);function a(a){var b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_APP_STATE_DOWNLOAD);a.isSuccess!=="success"?b.endFail("syncd error: Error downloading snapshot or patches",w(a)):b.endSuccess(w(a))}function c(a,b,c){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_BOOTSTRAP_DATA_APPLIED).endSuccess(x({collection:a,snapshotUsed:b,durationMs:c}))}function e(a,b){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_CRITICAL_EVENT).endFail("syncd critical event: "+a,y({type:a,collection:b}))}function f(a){d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_KEY_ROTATION).endSuccess(z({type:a}))}function w(a){var b=a.collection,c=a.downloadSize,d=a.downloadStartTs;a=a.isSuccess;return{string:{collection:b},"int":{downloadSize:c,downloadStartTs:d},bool:{isSuccess:a==="success"}}}function x(a){return{string:{collection:a.collection},bool:{snapshot:a.snapshotUsed===u.SNAPSHOT_USED},"int":{durationMs:a.durationMs}}}function y(a){return{string:{criticalEventCode:a.type,collection:a.collection==null?null:a.collection}}}function z(a){return{string:{keyRotationEventCode:a.type}}}function A(a){var b,c,e,f,g=a==null||(b=a.string)==null?void 0:b.collection,l=a==null||(c=a["int"])==null?void 0:c.downloadSize,m=a==null||(e=a["int"])==null?void 0:e.downloadStartTs;a=a==null||(f=a.bool)==null?void 0:f.isSuccess;if(g==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap app state download metric"])));return null}if(m==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing downloadStartTs for bootstrap app state download metric"])));return null}if(a==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing isSuccess for bootstrap app state download metric"])));return null}var n=d("WASyncdConst").CollectionName.cast(g);if(n==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap app state download metric"])),g);return null}g=a?"success":"failure";return{collection:n,downloadStartTs:m,downloadSize:l,isSuccess:g}}function B(a){var b,c,e,f=a==null||(b=a.string)==null?void 0:b.collection,g=a==null||(c=a.bool)==null?void 0:c.snapshot;a=a==null||(e=a["int"])==null?void 0:e.durationMs;if(f==null){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing collection for bootstrap data applied event"])));return null}if(g==null){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing snapshotUsed for bootstrap data applied event"])));return null}if(a==null){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing durationMs for bootstrap data applied event"])));return null}var h=d("WASyncdConst").CollectionName.cast(f);if(h==null){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown collection "," for bootstrap data applied event"])),f);return null}f=g?u.SNAPSHOT_USED:u.SNAPSHOT_NOT_USED;return{collection:h,snapshotUsed:f,durationMs:a}}function C(a){var b,c,e=a==null||(b=a.string)==null?void 0:b.criticalEventCode;if(e==null){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for critical event"])));return null}var f=t.cast(e);if(f==null){d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for critical event"])),e);return null}return{type:f,collection:d("WASyncdConst").CollectionName.cast(a==null||(c=a.string)==null?void 0:c.collection)}}function D(a){var b;a=a==null||(b=a.string)==null?void 0:b.keyRotationEventCode;if(a==null){d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for key rotation event"])));return null}var c=v.cast(a);if(c==null){d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for key rotation event"])),a);return null}return{type:c}}function E(a){var b={};Object.keys(a).forEach(function(c){typeof a[c]==="number"?(b["int"]==null&&(b["int"]={}),b["int"][c]=a[c]):typeof a[c]==="string"&&(b.string==null&&(b.string={}),b.string[c]=a[c])});return Object.keys(b).length>0?b:void 0}b=function(){function a(){this.event=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD)}var b=a.prototype;b.end=function(a){a===void 0&&(a=!1),a?this.event.endFail("syncd failed"):this.event.endSuccess()};b.mark=function(a,b){this.event.addPoint(a,E(b))};return a}();g.SyncdCriticalEventType=t;g.SyncdBootstrapDataAppliedSnapshotUsed=u;g.SyncdKeyRotationEventType=v;g.reportSyncdBootstrapAppStateDownloadMetric=a;g.reportSyncdBootstrapDataApplied=c;g.reportSyncdCriticalEvent=e;g.reportSyncdKeyRotationEvent=f;g.convertSyncdBootstrapAppStateDownloadFromAnnotations=A;g.convertSyncdBootstrapDataAppliedFromAnnotations=B;g.convertSyncdCriticalEventFromAnnotations=C;g.convertSyncdKeyRotationEventFromAnnotations=D;g.constructAnnotationsFromContext=E;g.SyncdEventFlow=b}),98);
__d("WAWebSyncdAntiTampering",["$InternalEnum","Promise","WACryptoLtHash","WACryptoUtils","WAEncodeString","WAJids","WALogger","WAPromiseEach","WAServerSync.pb","WASyncdConst","WASyncdKeyTypes","WATextEncoding","WAWebABProps","WAWebConnModel","WAWebCurrentUser","WAWebEncryptionManagerSelector","WAWebGetCollectionVersion","WAWebGetSyncAction","WAWebKeyManagementUtils","WAWebLid1X1MigrationGating","WAWebRunInTransaction","WAWebSyncdCrypto","WAWebSyncdCryptoUtils","WAWebSyncdDb","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdKeyCache","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebUserPrefsTypes","WAWebWamEnumIsPureSyncdSessionEnum","WAWebWamEnumLidMigrationStageEnum","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,aa,ba,ca,v,w,x,y,z,A,B,C,D,E,F,G,H,I,da,J,K,L=b("$InternalEnum").Mirrored(["Incoming","Outgoing"]),ea=[(K=d("WASyncdConst")).Actions.LocaleSetting,K.Actions.SettingPushName,"generated_wui",K.Actions.Sentinel,K.Actions.PrimaryVersion,K.Actions.TimeFormat,K.Actions.Nux,K.Actions.BotWelcomeRequest,K.Actions.DeviceCapabilities,K.Actions.Archive,K.Actions.LockChat,K.Actions.FavoriteSticker,K.Actions.ChatLockSettings,K.Actions.MarkChatAsRead,K.Actions.NoteEdit,K.Actions.Pin,K.Actions.PinDEPRECATED,K.Actions.RemoveRecentSticker,K.Actions.UnarchiveChatsSetting,K.Actions.AndroidUnsupportedActions];function M(a,b,c){c===void 0&&(c=!0);a=typeof a==="string"?a:d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a);b=typeof b==="string"?b:d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(b);c=c?-16:0;return a.slice(c)+":"+b.slice(c)}var fa=d("WATextEncoding").newTextDecoder();function a(a,b,c){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.mac,f=b.version,g=b.keyId,j=b.records;g=(yield d("WAWebSyncdKeyCache").getKeyData(g.id));if(!g)throw new(d("WAWebSyncdError").SyncdMissingKeyError)();var k=new Map(j.map(function(a){return[d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a.index.blob),d("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(a.value.blob)]}));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n  "," snapshot macsToAdd:\n      ",""])),c,a,Array.from(k.entries()).map(function(a){var b=a[0];a=a[1];return M(b,a)}).join("\n\t"));k=(yield d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(k.values())));var l=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(g));l=l.snapshotMacKey;var m=d("WAWebSyncdCryptoUtils").to64BitNetworkOrder(f.version),n=d("WAEncodeString").toUtf8(a).buffer;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot mac for "," snapshot v",":\n  ltHash: ","\n  encoded version: ","\n  encoded collection: ","\n  expected snapshotMAC: ","\n  "])),c,a,f.version,d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(k),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(m),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(n),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(l));yield ha(a,e,g,k,m,n,!0,j.length,b.version.version,null,null,null,null,c);return k});return N.apply(this,arguments)}function c(a,b,c,d){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: computeLtHashAndValidatePatch for ",""])),e,a);var g=c.version,h=c.mutations,i=c.snapshotMac,m=c.patchMac,n=c.keyId;n=n.id;var o=(yield d("WAWebSyncdKeyCache").getKeyData(n));if(!o)throw new(d("WAWebSyncdError").SyncdMissingKeyError)();var p=h.map(function(a){return{operation:a.operation,indexMac:a.record.index.blob,valueMac:d("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(a.record.value.blob)}}),q=(yield d("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));f=(yield ja(a,p,e,f,c.version.version,L.Incoming,q));var r=d("WAWebSyncdCryptoUtils").to64BitNetworkOrder(g.version),s=d("WAEncodeString").toUtf8(a).buffer;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: validating snapshot and patch mac for "," v",":\n  expected snapshotMAC: ","\n  expected patchMAC: ","\n  encoded version: ","\n  encoded collection: ","\n  key ID: ","\n  "])),e,a,g.version,d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(i),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(m),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(r),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(s),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(d("WASyncdKeyTypes").fromSyncKeyId(n)));try{yield ia(a,m,o,i,p.map(function(a){return a.valueMac}),h.length,g.version,e),yield ha(a,i,o,f.ltHash,r,s,!1,h.length,g.version,c.clientDebugData,q,f,c.deviceIndex,e)}catch(a){yield t();throw a}return f.ltHash;function t(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield X(a,e,"logErrorDiagnostics",!1)),c=new Map(b.map(function(a){var b=a.indexMac;a=a.valueMac;return[d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(b),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a)]}));d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: error on incoming records:\n    \t",""],["[","] syncd: error on incoming records:\n    \\t",""])),e,p.map(function(a){var b=a.operation,e=a.indexMac;a=a.valueMac;return(b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"set":"remove")+" | "+M(e,a,!1)+" | "+(c.has(d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e))?"found":"did not find")+" indexMAC in the above logged macs"}).join("\n\t"))});return u.apply(this,arguments)}});return O.apply(this,arguments)}function ga(a,b,c){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:0}));if(e!==b-1){var f=e>b-1?"greater-than-expected":"less-than-expected";d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," received patch v"," !== latest local version (v",") + 1"])),c,a,b,e).sendLogs("syncd-version-check-error-local-version-"+f);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+c+"] received patch v"+b+" !== latest local version (v"+e+") + 1");throw new(d("WAWebSyncdError").SyncdRetryableError)("syncd-version-check-error-local-version-"+f)}e=(yield d("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(a));if(d("WACryptoUtils").arrayBuffersEqual(e,d("WACryptoLtHash").EMPTY_LT_HASH)&&b!==1){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: empty local lthash found when processing "," patch v",""])),c,a,b).sendLogs("syncd-empty-lthash-on-mac-mismatch");throw new(d("WAWebSyncdError").SyncdRetryableError)("empty lthash")}});return P.apply(this,arguments)}function ha(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h,i,j,k,l,m,n,v){var w,x=!h;w=(w=(yield d("WAWebGetCollectionVersion").getIsCollectionInMacMismatchFatalInTransaction(a)))!=null?w:!1;if(x&&w){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection "," is already in snapshot mac mismatch so not checking again"])),v,a);return}w=d("WAWebEncryptionManagerSelector").syncdEncryptionManager().generateSnapshotMac;w=(yield w(c,e,j,a));c=d("WACryptoUtils").arrayBuffersEqual(w,b);var y=d("WAWebSyncdSnapshotRecoveryGatingUtils").shouldPreformSnapshotRecovery(a,i,new(d("WAWebSyncdError").SyncdFatalError)("probe")),z=!c&&h&&y.shouldPerformRecovery;if(!c){z&&d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: snapshot mac mismatch, will perform recovery for "," v"," with "," mutations"])),v,a,j,i);d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd:\n      expected snapshotMAC: ","\n      computed snapshotMAC: ",""])),v,d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(b),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(w));h||(yield ga(a,j,v));yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+v+"] failed validate snapshot mac");c=(yield U(v,a));b=c.isLtHashConsistent;w=c.scratchLtHash;c=h?d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SNAPSHOT_MAC_MISMATCH_IN_PATCH;h=(k==null?void 0:k.collectionName)&&!d("WACryptoUtils").arrayBuffersEqual(g,k==null?void 0:k.collectionName);g=(k==null?void 0:k.newLthash)&&!d("WACryptoUtils").arrayBuffersEqual(e,k==null?void 0:k.newLthash);e=(k==null?void 0:k.patchVersion)&&!d("WACryptoUtils").arrayBuffersEqual(f,k==null?void 0:k.patchVersion);f=(k==null?void 0:k.currentLthash)&&l&&!d("WACryptoUtils").arrayBuffersEqual(l,k==null?void 0:k.currentLthash);var A=(k==null?void 0:k.newLthashSubtract)&&(m==null?void 0:m.subtractResult)&&!d("WACryptoUtils").arrayBuffersEqual(m==null?void 0:m.subtractResult,k==null?void 0:k.newLthashSubtract),B=m==null?void 0:m.hasOverride,C=m==null?void 0:m.numAdd,D=m==null?void 0:m.numRemove,E=(k==null?void 0:k.currentLthash)&&w&&!d("WACryptoUtils").arrayBuffersEqual(w,k==null?void 0:k.currentLthash);n=n===0;var F=(k==null?void 0:k.numberAdd)!=null&&(m==null?void 0:m.numAdd)!=null&&(m==null?void 0:m.numAdd)!==(k==null?void 0:k.numberAdd),G=(k==null?void 0:k.numberRemove)!=null&&(m==null?void 0:m.numRemove)!=null&&(m==null?void 0:m.numRemove)!==(k==null?void 0:k.numberRemove),H=m==null?void 0:m.didUseFallback;m=m==null?void 0:m.hasMissingRemove;var I=(yield d("WAWebKeyManagementUtils").getPeerDevices()).length>1;d("WAWebSyncdMetricFatalError").reportSyncdFatalError(c,{collection:a,patchSnapshotMutationCount:i,patchVersion:j,isFatal:!x,isLtHashConsistent:b,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:f,macFatalNewLthashMismatch:g,macFatalPatchVersionMismatch:e,macFatalNewLthashSubtractMismatch:A,macFatalNumberHasOverrideMutation:B,macFatalNumberNumAddMutation:C,macFatalNumberNumRemoveMutation:D,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:E,isPatchSenderPrimary:n,macFatalDidUseMacFetchFallback:H,macFatalHasMissingRemove:m,macFatalNumberAddMismatch:F,macFatalNumberRemoveMismatch:G,isThereAnotherSyncdCompanion:I,isPureSyncdSession:yield oa(),lidMigrationStage:na(),recoveryStatus:y.reason},z);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: fatal extra details:\n      mdFatalErrorCode: ",",\n      collection: ",",\n      mutationCount: ",",\n      patchVersion: ",",\n      isLtHashConsistent: ",",\n      macFatalCollectionNameMismatch: ",",\n      macFatalCurrentLthashMismatch: ",",\n      macFatalNewLthashMismatch: ",",\n      macFatalPatchVersionMismatch: ",",\n      macFatalNewLthashSubtractMismatch: ",",\n      macFatalNumberHasOverrideMutation: ",",\n      macFatalNumberNumAddMutation: ",",\n      macFatalNumberNumRemoveMutation: ",",\n      macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch: ",",\n      isPatchSenderPrimary: ",",\n      macFatalDidUseMacFetchFallback: ",",\n      macFatalHasMissingRemove: ",",\n      macFatalNumberAddMismatch: ",",\n      macFatalNumberRemoveMismatch: ",",\n      isThereAnotherSyncdCompanion: ","\n    "])),v,c,a,i,j,b,h,f,g,e,A,B,C,D,E,n,H,m,F,G,I);if(x){yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a);y="syncd: unable to validate snapshot mac. collection: "+a;if(d("WAWebCurrentUser").isEmployee())d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[","] ",""])),v,y).sendLogs(y,{sampling:1});else if(k!=null){z=y+" (additional info)";d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[","] ",""])),v,z).sendLogs(z,{sampling:1})}else d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[","]  ",""])),v,y).sendLogs(y,{sampling:.01});yield d("WAWebGetCollectionVersion").updateIsCollectionInMacMismatchFatalInTransaction(a);d("WALogger").LOG(aa||(aa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: skip fatal after snapshot mac mismatch for collection ",""])),v,a);if(E===!1&&f===!0){d("WALogger").LOG(ba||(ba=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: clientDebugData?.currentLthash: ",",\n        scratchLtHash: ",",\n        currentLtHash: ",""])),v,d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((c=k==null?void 0:k.currentLthash)!=null?c:new ArrayBuffer(0)).slice(-16),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(w!=null?w:new ArrayBuffer(0)).slice(-16),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(l!=null?l:new ArrayBuffer(0)).slice(-16));d("WALogger").ERROR(ca||(ca=babelHelpers.taggedTemplateLiteralLoose(["syncd: snapshot_mac_mismatch_in_patch due to cache mismatch"]))).sendLogs("syncd: snapshot_mac_mismatch_in_patch due to cache mismatch")}return}throw new(d("WAWebSyncdError").SyncdFatalError)("unable to validate snapshot mac")}});return Q.apply(this,arguments)}function ia(a,b,c,d,e,f,g,h){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h,i){var j=d("WAWebEncryptionManagerSelector").syncdEncryptionManager().generatePatchMac;j=(yield j(c,e,f,h,a));c=d("WACryptoUtils").arrayBuffersEqual(j,b);if(!c){yield ga(a,h,i);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"failed validate patch mac");d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MAC_MISMATCH_PATCH,{collection:a,patchSnapshotMutationCount:g,patchVersion:h});d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: unable to validate patch mac."])),i).sendLogs("syncd: unable to validate patch mac.");d("WALogger").DEV(w||(w=babelHelpers.taggedTemplateLiteralLoose(["syncd:\n      expected patchMAC: ","$\n      computed patchMAC: ",""])),b,j);throw new(d("WAWebSyncdError").SyncdFatalError)("unable to validate patch mac")}});return R.apply(this,arguments)}function e(a,b,c,d){return S.apply(this,arguments)}function S(){S=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield d("WAWebGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return(a=a==null?void 0:a.version)!=null?a:d("WASyncdConst").DEFAULT_COLLECTION_VERSION}))+1,g=d("WAWebSyncdCryptoUtils").to64BitNetworkOrder(f),h=d("WAEncodeString").toUtf8(a).buffer,i=d("WAWebEncryptionManagerSelector").syncdEncryptionManager();b=(yield i.generateSnapshotMac(e,b,f,a));i=(yield i.generatePatchMac(e,b,c.map(function(a){return a.valueMac}),f,a));c=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(e));e=c.patchMacKey;c=c.snapshotMacKey;d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["syncd: computing snapshot and patch macs for outgoing patch "," v",":\n  encoded version: ","\n  encoded collection: ","\n  snapshotMAC: ","\n  patchMAC: ",""])),a,f,d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(g),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(h),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(b),d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(i)).devConsole("\n  --- DEV ONLY ---\n  snapshotMacKey: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(c)+"\n  patchMacKey: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e));return{snapshotMac:b,patchMac:i}});return S.apply(this,arguments)}function ja(a,b,c,d,e,f,g){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,h,i){var j=d("WAWebABProps").getABPropConfigValue("enable_syncd_debug_data_in_patch")||a===d("WASyncdConst").CollectionName.CriticalBlock||h===L.Outgoing;i=i!=null?i:yield d("WAWebGetCollectionVersion").getCollectionVersionLtHashInTransaction(a);var k=(yield la(c.map(function(a){return a.indexMac}))),l=new Map(),m=new Map(),n=new Map(),o=!1,p=!1;yield d("WAPromiseEach").promiseEach(c,function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f){f=b.indexMac;var i=b.valueMac;b=b.operation;var j=fa.decode(f);j=k.get(j);if(j)b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE?m.set(d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f),j.valueMac):n.set(d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f),j.valueMac);else if(b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE){j=(yield s(f));if(j!=null){m.set(d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f),j);p=!0;d("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: had to use fallbackQueryForValueMac in collection "," for platform ",": ","\n        }"])),e,a,(j=d("WAWebConnModel").Conn.platform)!=null?j:"[empty]",d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f).slice(-16)).tags("non-sad").sendLogs("syncd: fallback query");yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+e+"] used fallback for "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f))}else{o=!0;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+e+"] incoming REMOVE mutation missing in local snapshot for collection "+a+" version "+((j=g==null?void 0:g.toString())!=null?j:"n/a")+": "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f));yield X(a,e,"REMOVE missing",!1);j="\n          syncUseMultipleMacQueries: true\n          input mutations mac:\n          "+c.map(function(a){return(a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+M(a.indexMac,a.valueMac)}).join("\n\t")+"\n          currentMacs: "+Array.from(k.values()).map(function(a){return M(a.indexMac,a.valueMac)}).join(", ")+"\n        ";d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["",""])),j);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"missing remove additional info: "+j);d("WAWebSyncdMetrics").reportSyncdCriticalEvent(d("WAWebSyncdMetrics").SyncdCriticalEventType.MISSING_MUTATION_TO_REMOVE,a);j="["+e+"] syncd: missing indexMAC in sync-actions table for REMOVE mutation in collection "+a+" version "+((j=g==null?void 0:g.toString())!=null?j:"n/a")+" direction "+(h?h:"n/a")+" for platform "+((j=d("WAWebConnModel").Conn.platform)!=null?j:"[empty]")+": "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f).slice(-16);a===d("WASyncdConst").CollectionName.CriticalBlock?(yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a),d("WALogger").ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["",""])),j).sendLogs("syncd: missing indexMAC from REMOVE in collection "+a)):d("WALogger").ERROR(B||(B=babelHelpers.taggedTemplateLiteralLoose(["",""])),j).sendLogs("syncd: missing indexMAC from REMOVE in collection "+a,{sampling:.01})}}b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&l.set(d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(f),i)});return function(a,b){return f.apply(this,arguments)}}());var q=(yield d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.subtractThenAdd(i,Array.from(l.values()),Array.from(m.values()).concat(Array.from(n.values())))),r=q.ltHash;q=q.subtractResult;i="["+e+"] syncd: computing ltHash for "+a+":\n  mutations length: "+c.length+"\n  currentLtHash: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(i).slice(-16)+"\n  subtractResult: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(q).slice(-16)+"\n  currentMacs length: "+k.size+"\n  macsToAdd:\n      "+Array.from(l.entries()).map(function(a){var b=a[0];a=a[1];return M(b,a)}).join("\n\t")+"\n  macsToRemove:\n      "+Array.from(m.entries()).map(function(a){var b=a[0];a=a[1];return M(b,a)}).join("\n\t")+"\n  macsToOverwrite (also remove):\n      "+Array.from(n.entries()).map(function(a){var b=a[0];a=a[1];return M(b,a)}).join("\n\t")+"\n  newLtHash: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(r).slice(-16)+"\n  hasMissingRemove: "+o.toString()+"\n  didUseFallback: "+p.toString();d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["",""])),i);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"generate lthash details 1: "+i);if(j){i="\n      input mutations mac:\n      "+c.map(function(a){return(a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET ":"REMOVE ")+M(a.indexMac,a.valueMac)}).join("\n\t")+"\n      currentMacs: "+Array.from(k.values()).map(function(a){return M(a.indexMac,a.valueMac)}).join(", ")+"\n    ";d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["",""])),i);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"generate lthash details 2: "+i)}return{ltHash:r,numAdd:l.size,numRemove:m.size,hasOverride:n.size>0,subtractResult:q,hasMissingRemove:o,didUseFallback:p};function s(a){return f==null?(J||(J=b("Promise"))).resolve(null):f(a)}});return T.apply(this,arguments)}function U(a,b,c){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e=d("WAWebCurrentUser").isEmployee()?900:e;var f=(yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var d=a.SyncActionStore;a=a.CollectionVersionStore;a=c==null?yield a.getAll():[yield a.get(c)];return(J||(J=b("Promise"))).all(a.filter(Boolean).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.collection;a=a.ltHash;var c=(yield d.getByCollections([b]));return{collection:b,ltHash:a,mutations:c}});return function(b){return a.apply(this,arguments)}}()))});return function(b){return a.apply(this,arguments)}}())),g=0;f.map(function(a){a.collection;a.ltHash;a=a.mutations;g+=a.length});if(e!==void 0&&g>e)return{isLtHashConsistent:void 0,scratchLtHash:void 0,cachedLtHash:void 0};var h=null,i=null;e=!0;yield (J||(J=b("Promise"))).all(f.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.collection,f=b.ltHash;b=b.mutations;b=(yield ka(b));h==null&&(h=b);i==null&&(i=f);d("WACryptoUtils").arrayBuffersEqual(f,b)||g>0&&(e=!1,d("WALogger").ERROR(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: failed LtHash check for ",""])),a,c).verbose())});return function(a){return c.apply(this,arguments)}}()));return{isLtHashConsistent:e,scratchLtHash:h,cachedLtHash:i}});return V.apply(this,arguments)}function ka(a){a=new Map(a.map(function(a){return[d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac),a.valueMac]}));return d("WACryptoLtHash").LT_HASH_ANTI_TAMPERING.add(d("WACryptoLtHash").EMPTY_LT_HASH,Array.from(a.values()))}function la(a){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebGetSyncAction").getSyncActionsByIndexMacsInTransaction(a));return new Map(a.map(function(a){return[fa.decode(a.indexMac),{indexMac:a.indexMac,valueMac:a.valueMac}]}))});return W.apply(this,arguments)}function ma(a,b){var c=b.action;if(!c)return;if(d("WAWebCurrentUser").isEmployee()||a===d("WASyncdConst").CollectionName.RegularLow||a===d("WASyncdConst").CollectionName.CriticalBlock||ea.includes(c)){if(c===d("WASyncdConst").Actions.DeviceCapabilities){if(d("WAWebCurrentUser").isEmployee())return b.index;a=b.index.indexOf(":");return"device_capabilities:"+b.index.slice(a-4)}return c}}function X(a,b,c,d){return Y.apply(this,arguments)}function Y(){Y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){f===void 0&&(f=!0);var g=f?20:1;d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["syncd: logMacs: ",": prepare"])),a);var h=(yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,CollectionVersionStore:!0},function(c){var d=c.SyncActionStore;c=c.CollectionVersionStore;return(J||(J=b("Promise"))).all([c.get(a).then(function(a){return a==null?void 0:a.version}),d.getByCollections([a])])})),i=h[0];h=h[1];d("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: current snapshot "," v"," with "," mutations. context "," mutations:"])),c,a,i,h.length,e);c=d("WAWebCurrentUser").isEmployee()?200:120;if(f&&h.length>c)return h;c=h.reduce(function(b,c,d){d%g===0&&b.push("");b[b.length-1]+=M(c.indexMac,c.valueMac,f)+(" "+((d=ma(a,c))!=null?d:"n/a")+" | ");return b},[]);c.forEach(function(a){return d("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["|",""])),a)});(a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow||d("WAWebCurrentUser").isEmployee())&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"current local snapshot for "+a+" v"+(i!=null?i:"n/a")+" mutation length "+h.length+" context "+e+": "+c.join("\n")));return h});return Y.apply(this,arguments)}function f(a,b,c,d){return Z.apply(this,arguments)}function Z(){Z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=400);e=(yield U(c,a,e));var f=e.isLtHashConsistent,g=e.scratchLtHash;e=e.cachedLtHash;g=g==null?"":d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(g).slice(-16);e=e==null?"":d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(e).slice(-16);if(f===!1){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+c+"] lthash first time inconsistent. scratchLtHash: "+g+", cachedLtHash: "+e+", context: "+b);yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a);c="syncd: lthash inconsistent";a===d("WASyncdConst").CollectionName.CriticalBlock||d("WAWebCurrentUser").isEmployee()?d("WALogger").ERROR(I||(I=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""])),c,a).verbose().sendLogs(c):d("WALogger").ERROR(da||(da=babelHelpers.taggedTemplateLiteralLoose([""," first time for ",""])),c,a).verbose().sendLogs(c,{sampling:.01});return!0}else if(f===!0){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"lthash consistent. scratchLtHash: "+g+", cachedLtHash: "+e+", context: "+b);return!1}yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"lthash unknown if consistent. scratchLtHash: "+g+", cachedLtHash: "+e+", context: "+b);return void 0});return Z.apply(this,arguments)}function na(){return!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?d("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.NOT_MIGRATED:d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.lidMigrationSource()===d("WAWebUserPrefsTypes").LidMigrationSource.PEER?d("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.PEER_MIGRATED:d("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM.HISTORY_MIGRATED}function oa(){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isPureLidSyncDSession();if(a!=null)return a?d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.YES:d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.NO;a=(yield d("WAWebSyncdDb").getSyncActionsRows(["action"],[d("WASyncdConst").Actions.Archive,d("WASyncdConst").Actions.ClearChat,d("WASyncdConst").Actions.DeleteChat,d("WASyncdConst").Actions.DeleteMessageForMe,d("WASyncdConst").Actions.MarkChatAsRead,d("WASyncdConst").Actions.Mute,d("WASyncdConst").Actions.Pin,d("WASyncdConst").Actions.Star]));var b=a.find(function(a){return a.index.includes(d("WAJids").WA_USER_DOMAIN)});if(b)return d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.PROBABLY_NO;b=a.find(function(a){return a.index.includes(d("WAJids").LID_DOMAIN)});return b?d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.PROBABLY_YES:d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM.UNKNOWN});return $.apply(this,arguments)}g.SyncdPatchDirection=L;g.indexAndValueMacToString=M;g.computeLtHashAndValidateSnapshot=a;g.computeLtHashAndValidatePatch=c;g.computeOutgoingSnapshotAndPatchMacs=e;g.computeLtHash=ja;g.checkLtHash=U;g.logMacsInSnapshot=X;g.reportCollectionInconsistency=f;g.getLidMigrationStage=na}),98);
__d("WAWebSyncdGetActionHandler",["err"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=null,j=null;function a(a){j=a}function b(a){if(j==null)throw c("err")("Action handlers not initialized");h==null&&(h=new Map(j.map(function(a){return[a.getAction(),a]})));return h.get(a)}function d(){if(j==null)throw c("err")("Action handlers not initialized");i==null&&(i=Math.max.apply(Math,j.map(function(a){return a.getVersion()})));return i}g.setActionHandlers=a;g.getActionHandler=b;g.maxSupportedVersion=d}),98);
__d("WAWebSyncdRequestBuilderTypesConverter",["WANullthrows","WASyncAction.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.map(function(a){var e=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;e=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,c("WANullthrows")(e)).readBuffer();return{collection:a.collection,index:a.index,binarySyncAction:e,operation:b,version:a.version,timestamp:a.timestamp,action:a.action}})}g.syncActionsToPendingMutations=a}),98);
__d("WAWebSyncdCoreApi",["Promise","WALogger","WAServerSync.pb","WASyncdConst","WATypeUtils","WAWebCmd","WAWebDebounce","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid1X1MigrationGating","WAWebModelStorageUtils","WAWebSchemaChat","WAWebSchemaSyncActions","WAWebSyncd","WAWebSyncdDb","WAWebSyncdDisabled","WAWebSyncdGetActionHandler","WAWebSyncdRequestBuilderTypesConverter","WAWebSyncdUtils","WAWebUserPrefsAppStateSync","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","tryParseJSONMixed"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m=["pending-mutations"];function a(){if(d("WAWebSyncdDisabled").isSyncdDisabled())return(l||(l=b("Promise"))).resolve();n();d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){d("WAWebSyncd").processOnAppResume()});o();return d("WAWebSyncd").initializeStateMachine()}function n(){var a=1e3*60;a=c("WAWebDebounce")(d("WAWebSyncd").reportWam,a,{maxWait:a*3});d("WAWebCmd").Cmd.on(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,a)}function o(){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsAppStateSync").getMdSyncActionsActionSanitized());if(!a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: sanitizing null 'action' property in sync-actions table"])));a=(yield d("WAWebSchemaSyncActions").getSyncActionsTable().all());a=a.filter(function(a){return a.action==null});a=a.map(function(a){var b=d("WAWebSyncdUtils").getMutationNameFromIndex(a.index),c=d("WASyncdConst").Actions.cast(b);if(!c){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),b);return babelHelpers["extends"]({},a)}return babelHelpers["extends"]({},a,{action:c})});yield d("WAWebSyncdDb").updateSyncActionRows(a);yield d("WAWebUserPrefsAppStateSync").setMdSyncActionsActionSanitized(!0)}});return p.apply(this,arguments)}function e(a,c,e){a=[].concat(a,m);d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.push("chat","sync-actions");a=d("WAWebModelStorageUtils").getStorage().lock(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var f=(yield q(c));return(l||(l=b("Promise"))).all([d("WAWebSyncdDb").appendPendingMutationsRows(c.concat(f)),e(a)])});return function(b){return a.apply(this,arguments)}}()).then(function(){var a=c.map(function(a){return a.collection});void d("WAWebSyncd").markCollectionsForSync(a)});return(l||(l=b("Promise"))).resolve(a)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isSyncdSessionMigrated())return[];a=(yield (l||(l=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.action==null)return;var b=d("WAWebSyncdGetActionHandler").getActionHandler(a.action);if((b==null?void 0:b.chatJidIndex)==null)return;b=b.chatJidIndex;a=c("tryParseJSONMixed")(a.index);if(!Array.isArray(a)){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: indexParts is not an array"]))).sendLogs("syncd-lid-cleanup-invalid-index-non-array");return}var e=a[b];if(!d("WATypeUtils").isString(e)){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: getPnMutationsForLidCleanup: chat JID not a string"]))).sendLogs("syncd-lid-cleanup-invalid-index-non-string-jid");return}if(!c("WAWebWid").isStringLid(e))return;e=(yield d("WAWebSchemaChat").getChatTable().equals(["accountLid"],e,{shouldDecrypt:!1}))[0];if(e==null||e.accountLid===e.id)return;e=d("WAWebWidFactory").createWid(e.id).toJid();a=[].concat(a);a[b]=e;b=JSON.stringify(a);return d("WAWebSchemaSyncActions").getSyncActionsTable().get(b)});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean).map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow);return d("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)});return r.apply(this,arguments)}g.initialize=a;g.sanitizeActionInSyncActionsRow=o;g.lockForSync=e}),98);
__d("WAWebWamEnumBootstrapAppStateDataStageCode",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUEST_BUILT:1,RESPONSE_RECEIVED:2,RESPONSE_PARSED_VALID:3,MISSING_KEYS_REQUESTED:4,MISSING_KEYS_RECEIVED:5,MUTATIONS_DECRYPTED:6,ABOUT_TO_APPLY_MUTATIONS:7,APPLIED_MUTATIONS:8,PUSHNAME_APPLIED:9,PUSHNAME_INVALID:10,ENTERED_RETRY_MODE:11});f.BOOTSTRAP_APP_STATE_DATA_STAGE_CODE=a}),66);
__d("WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBootstrapAppStateDataStageCode","WAWebWamEnumMdBootstrapPayloadType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdBootstrapAppStateCriticalDataProcessing:[3164,{bootstrapAppStateDataStage:[1,d("WAWebWamEnumBootstrapAppStateDataStageCode").BOOTSTRAP_APP_STATE_DATA_STAGE_CODE],mdBootstrapPayloadType:[2,d("WAWebWamEnumMdBootstrapPayloadType").MD_BOOTSTRAP_PAYLOAD_TYPE],mdRegAttemptId:[3,a.TYPES.STRING],mdSessionId:[4,a.TYPES.STRING],mdTimestamp:[5,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MdBootstrapAppStateCriticalDataProcessing:[]});g.MdBootstrapAppStateCriticalDataProcessingWamEvent=b}),98);
__d("WAWebSyncdCriticalBootstrapProcessingApi",["WATimeUtils","WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent","WAWebSyncBootstrap","WAWebSyncdMdSyncFieldstatMeta","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("WAWebSyncBootstrap").isSyncDCriticalDataSyncInProcess()&&new(d("WAWebMdBootstrapAppStateCriticalDataProcessingWamEvent").MdBootstrapAppStateCriticalDataProcessingWamEvent)({bootstrapAppStateDataStage:a,mdSessionId:yield d("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId(),mdTimestamp:d("WATimeUtils").unixTimeMs()}).commit()});return h.apply(this,arguments)}g.logCriticalBootstrapStageIfNecessary=a}),98);
__d("WAWebAndroidUnsupportedActionsSync",["Promise","WALogger","WASyncdAction","WASyncdConst","WAWebUserPrefsAppStateSync"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=null,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getVersion=function(){return 4};e.getAction=function(){return d("WASyncdConst").Actions.AndroidUnsupportedActions};e.applyMutations=function(a){var c=this;return(m||(m=b("Promise"))).all(a.map(function(a){try{if(a.operation==="set"){a=a.value;a=a.androidUnsupportedActions;if(!a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["android unsupported actions: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}a=a.allowed;a===!0?(c.updatePrimaryAllowsAllMutationsFlag("allow_unsupported_mutation"),d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully set primary allows all mutations flag"])))):d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: androidUnsupportedMutation has invalid 'allowed' value"])));return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["locale setting sync: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}}))};e.updatePrimaryAllowsAllMutationsFlag=function(a){d("WAWebUserPrefsAppStateSync").getPrimaryAllowsAllMutations()||(d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[syncd] primary allows all mutations flag set: ",""])),a),d("WAWebUserPrefsAppStateSync").setPrimaryAllowsAllMutations())};return c}(d("WASyncdAction").SyncActionBase);c=new a();g["default"]=c}),98);
__d("WAWebSyncdLogs",["WALogger","WASyncdConst","WAWebPriorLogs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebPriorLogs").WAWebLogCategory.cast(a);if(c!=null)return d("WAWebPriorLogs").writePriorLog(c,b);d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: cannot log unknown cagtegory ",""])),a)});return function(b,c){return a.apply(this,arguments)}}();c=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=[].concat(Array.from(a?[a]:d("WASyncdConst").CollectionName.members()),[""]).map(function(a){return d("WAWebPriorLogs").WAWebLogCategory.cast(a)}).filter(Boolean);return d("WAWebPriorLogs").printPriorLogs(a)});return function(b){return a.apply(this,arguments)}}();g.writeSyncdLogImpl=a;g.printSyncdLogs=c}),98);
__d("WAWebSyncdDbCallbacksApi",["Promise","WAWebAndroidUnsupportedActionsSync","WAWebCmd","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid1X1MigrationGating","WAWebMsgKey","WAWebSchemaChat","WAWebSyncdFatal","WAWebSyncdLogs","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;f=function(a){a.deviceIndex===0&&c("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("device index");return(h||(h=b("Promise"))).resolve()};var i=function(a){d("WAWebCmd").Cmd.trigger(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,a);return(h||(h=b("Promise"))).resolve()},j=function(){return d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){}))},k=function(a){return d("WAWebSyncdFatal").handleFatalError(a==null?void 0:a.collections)};function a(a){return d("WAWebSchemaChat").getChatTable().bulkGet(a).then(function(a){return a.map(function(a){return a==null?void 0:a.accountLid})})}function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return[];a=a.map(function(a){return c("WAWebMsgKey").fromString(a)}).filter(function(a){return a.remote.isUser()&&!a.remote.isLid()});var b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a.map(function(a){return a.remote.toString()}))).map(function(a){return a==null?void 0:a.accountLid}),e=[];for(var f=0;f<a.length;f++){var g=b[f];if(g!=null){var h=a[f];e.push(new(c("WAWebMsgKey"))({fromMe:h.fromMe,remote:d("WAWebWidFactory").createWid(g),id:h.id}).toString())}}return e});return l.apply(this,arguments)}g.handleSyncBeforeApplyPatch=f;g.handleSyncCompleted=i;g.handleSyncDelayApplyingPatchUntilUIUnblocks=j;g.handleSyncdFatal=k;g.writeSyncdLog=d("WAWebSyncdLogs").writeSyncdLogImpl;g.printSyncdLog=d("WAWebSyncdLogs").printSyncdLogs;g.bulkGetAccountLid=a;g.getAdditionalLidMsgKeys=e}),98);
__d("WAWebSyncdFatal",["Promise","WAAsyncSleep","WALogger","WATimeUtils","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebSyncdDbCallbacksApi","WAWebSyncdFatalExceptionNotificationApi","WAWebSyncdLogs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=5e3;function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: starting fatal flow for ",""])),a);a?yield r(a,"handleFatalError for collection"):yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog("","handleFatalError without collection");var b=[];a!=null&&(b=a.map(function(a){return String(a)}));var c=d("WATimeUtils").castMilliSecondsToUnixTime(d("WATimeUtils").unixTimeMs());d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal flow: before sleep"])));yield d("WAAsyncSleep").asyncSleep(p);yield r(a,"handleFatalError before notify primary");var e=d("WATimeUtils").castMilliSecondsToUnixTime(d("WATimeUtils").unixTimeMs());d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: start notifying primary on fatal error"])));try{yield d("WAWebSyncdFatalExceptionNotificationApi").sendAppStateFatalExceptionNotification(b)}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: error when sending fatal message to primary: ",""])),a).sendLogs("syncd: could not send fatal to primary")}d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: end notifying primary on fatal error"])));yield r(a,"handleFatalError after notify primary");b=d("WATimeUtils").castMilliSecondsToUnixTime(d("WATimeUtils").unixTimeMs());d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: end notifying primary on fatal error. tsBeforeSleep: ",", tsBeforeSendToPrimary: ",", currTs: ",""])),d("WATimeUtils").toHttpHeaderDate(c),d("WATimeUtils").toHttpHeaderDate(e),d("WATimeUtils").toHttpHeaderDate(b));yield d("WAWebSyncdLogs").printSyncdLogs();d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: Received fatal error and logged out"]))).verbose().tags("syncd","logout").sendLogs("syncd: fatal error and logged out");yield d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.SyncdFailure)});return q.apply(this,arguments)}function r(a,c){return(o||(o=b("Promise"))).all((a!=null?a:[""]).map(function(a){return d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,c)}))}g.handleFatalError=a}),98);
__d("WAWebSyncdFatalExceptionNotificationApi",["WATimeUtils","WAWebApiPeerMessageStore","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a={collectionNames:a,timestamp:d("WATimeUtils").unixTimeMs()};var b=new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:yield c("WAWebMsgKey").newId()});b={id:b,to:d("WAWebWidFactory").createDeviceWidFromUserAndDevice(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().user,d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().server,0),type:"protocol",subtype:"app_state_fatal_exception_notification",kind:d("WAWebMsgType").MsgKind.PeerMessage,appStateFatalExceptionNotification:a};yield d("WAWebApiPeerMessageStore").storePeerMessages([b]);return d("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:b})});return h.apply(this,arguments)}g.sendAppStateFatalExceptionNotification=a}),98);
__d("WAWebSyncdKeyCallbacksApi",["WALogger","WAWebApiDeviceList","WAWebKeyManagementSendKeyRequestApi","WAWebKeyManagementSendKeyShareApi","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebApiDeviceList").getMyDeviceList()),b=a.currentIndex,e=a.devices;a=a.rawId;if(b==null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing current index for own device: devices length: ",""])),e==null?void 0:e.length);throw c("err")("syncd: missing current index for own device")}return{currentIndex:b,deviceIndexes:e.map(function(a){return a.keyIndex}),rawId:a}});return function(){return a.apply(this,arguments)}}();e=function(a){return d("WAWebKeyManagementSendKeyShareApi").sendAppStateSyncKeyShare({type:"key_rotation",keys:a})};g.getDeviceFingerprint=a;g.sendSyncdKeyRequest=d("WAWebKeyManagementSendKeyRequestApi").sendAppStateSyncKeyRequest;g.sendSyncdKeyRotation=e}),98);
__d("WAWebWamEnumUploadSourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:1,CAMERA:2,GALLERY:3,SHARE:4});f.UPLOAD_SOURCE_TYPE=a}),66);
__d("WAWebMapFileOriginToUploadOrigin",["WAWebWamEnumMediaPickerOriginType","WAWebWamEnumUploadSourceType"],(function(a,b,c,d,e,f,g){function a(a,b){if(b)return d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.OTHER;switch(a){case d("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY:return d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.GALLERY;case d("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE:return d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.CAMERA;case d("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.PASTE:return d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.SHARE;default:return d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE.OTHER}}g["default"]=a}),98);
__d("WAWebWamEnumConnectionType",[],(function(a,b,c,d,e,f){a=Object.freeze({HOSTNAME:0,IP4:1,IP6:2});f.CONNECTION_TYPE=a}),66);
__d("WAWebWamEnumHttpProtocolVersionType",[],(function(a,b,c,d,e,f){a=Object.freeze({HTTP1:0,HTTP2:1,HTTP3:2});f.HTTP_PROTOCOL_VERSION_TYPE=a}),66);
__d("WAWebWamEnumMediaQuality",[],(function(a,b,c,d,e,f){a=Object.freeze({AUTO:0,DATA_SAVER:1,HIGH_QUALITY:2,HIGHEST_QUALITY:3});f.MEDIA_QUALITY=a}),66);
__d("WAWebWamEnumMediaUploadModeType",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:1,FAST_FORWARD_EXIST_CHECK:2,VIDEO_EXIST_CHECK:3,PRODUCT:4,MEDIA_RETRY:5,WEB_REUPLOAD:6,THUMBNAIL:7,EXPRESS_PATH_UPLOAD:8});f.MEDIA_UPLOAD_MODE_TYPE=a}),66);
__d("WAWebWamEnumNetworkStackType",[],(function(a,b,c,d,e,f){a=Object.freeze({NATIVE:0,OK_HTTP:1,LIGER:2,APACHE:3,WATLS:4,CRONET:5,TIGON_HUC:6,TIGON_MNS:7});f.NETWORK_STACK_TYPE=a}),66);
__d("WAWebWamEnumOptimisticFlagType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,OPTIMISTIC:1,OPT_USED:2,OPT_TAKEOVER:3,OPT_DISABLED:4});f.OPTIMISTIC_FLAG_TYPE=a}),66);
__d("WAWebWamEnumOverallMediaKeyReuseType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE_NEW_CONTENT:1,NONE_EXPIRED:2,REUSED:3,NONE_WAS_STATUS:4});f.OVERALL_MEDIA_KEY_REUSE_TYPE=a}),66);
__d("WAWebWamEnumUploadOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:1,CHAT_PERSONAL:2,CHAT_GROUP:3,STATUS_USER:4,PRODUCT_CATALOG:5,STICKER_WEB:6,PAYMENTS_KYC:7,MESSAGE_HISTORY_SYNC:8,COMMUNITY:9,CHANNEL:10,BROADCAST:11,MULTI_CHAT:12,INTEROP:13});f.UPLOAD_ORIGIN_TYPE=a}),66);
__d("WAWebMediaUpload2WamEvent",["WAWebWamCodegenUtils","WAWebWamEnumConnectionType","WAWebWamEnumHttpProtocolVersionType","WAWebWamEnumMediaQuality","WAWebWamEnumMediaType","WAWebWamEnumMediaUploadModeType","WAWebWamEnumMediaUploadResultType","WAWebWamEnumNetworkStackType","WAWebWamEnumOptimisticFlagType","WAWebWamEnumOverallLastUploadRetryPhaseType","WAWebWamEnumOverallMediaKeyReuseType","WAWebWamEnumPairedMediaType","WAWebWamEnumUploadOriginType","WAWebWamEnumUploadSourceType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MediaUpload2:[1588,{appContext:[63,a.TYPES.STRING],appContextBitfield:[64,a.TYPES.INTEGER],batchSize:[57,a.TYPES.INTEGER],connectionType:[43,d("WAWebWamEnumConnectionType").CONNECTION_TYPE],debugMediaException:[34,a.TYPES.STRING],debugMediaIp:[32,a.TYPES.STRING],debugUrl:[33,a.TYPES.STRING],estimatedBandwidth:[45,a.TYPES.NUMBER],estimatedBandwidthV2:[61,a.TYPES.NUMBER],fileHeight:[55,a.TYPES.INTEGER],fileWidth:[56,a.TYPES.INTEGER],finalizeConnectT:[28,a.TYPES.TIMER],finalizeHttpCode:[31,a.TYPES.INTEGER],finalizeIsReuse:[30,a.TYPES.BOOLEAN],finalizeNetworkT:[29,a.TYPES.TIMER],httpProtocolVersionType:[51,d("WAWebWamEnumHttpProtocolVersionType").HTTP_PROTOCOL_VERSION_TYPE],isViewOnce:[49,a.TYPES.BOOLEAN],mediaCollectionId:[60,a.TYPES.INTEGER],mediaId:[46,a.TYPES.INTEGER],messageKeyHash:[58,a.TYPES.STRING],networkStack:[42,d("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE],originalSize:[53,a.TYPES.INTEGER],overallAttemptCount:[4,a.TYPES.INTEGER],overallConnBlockFetchT:[10,a.TYPES.TIMER],overallConnectionClass:[41,a.TYPES.STRING],overallCumT:[37,a.TYPES.TIMER],overallCumUserVisibleT:[38,a.TYPES.TIMER],overallDomain:[5,a.TYPES.STRING],overallEncryptT:[50,a.TYPES.TIMER],overallIsFinal:[36,a.TYPES.BOOLEAN],overallIsForward:[16,a.TYPES.BOOLEAN],overallIsManual:[13,a.TYPES.BOOLEAN],overallLastUploadRetryPhase:[11,d("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE],overallMediaKeyReuse:[40,d("WAWebWamEnumOverallMediaKeyReuseType").OVERALL_MEDIA_KEY_REUSE_TYPE],overallMediaSize:[7,a.TYPES.NUMBER],overallMediaType:[1,d("WAWebWamEnumMediaType").MEDIA_TYPE],overallMmsVersion:[6,a.TYPES.INTEGER],overallOptimisticFlag:[12,d("WAWebWamEnumOptimisticFlagType").OPTIMISTIC_FLAG_TYPE],overallQueueT:[9,a.TYPES.TIMER],overallRetryCount:[3,a.TYPES.INTEGER],overallT:[8,a.TYPES.TIMER],overallTranscodeT:[15,a.TYPES.TIMER],overallUploadMode:[39,d("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE],overallUploadOrigin:[44,d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE],overallUploadResult:[35,d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE],overallUserVisibleT:[14,a.TYPES.TIMER],pairedMediaType:[62,d("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],photoQualitySetting:[52,d("WAWebWamEnumMediaQuality").MEDIA_QUALITY],resumeConnectT:[17,a.TYPES.TIMER],resumeHttpCode:[20,a.TYPES.INTEGER],resumeIsReuse:[19,a.TYPES.BOOLEAN],resumeNetworkT:[18,a.TYPES.TIMER],uploadBytesTransferred:[27,a.TYPES.NUMBER],uploadConnectT:[22,a.TYPES.TIMER],uploadHttpCode:[25,a.TYPES.INTEGER],uploadIsReuse:[24,a.TYPES.BOOLEAN],uploadIsStreaming:[26,a.TYPES.BOOLEAN],uploadNetworkT:[23,a.TYPES.TIMER],uploadResumePoint:[21,a.TYPES.INTEGER],uploadSource:[48,d("WAWebWamEnumUploadSourceType").UPLOAD_SOURCE_TYPE],usedFallbackHint:[47,a.TYPES.STRING],videoQualitySetting:[54,d("WAWebWamEnumMediaQuality").MEDIA_QUALITY]},[1,1,1],"regular"]},{MediaUpload2:[]});g.MediaUpload2WamEvent=b}),98);
__d("WAWebWamEnumBackendStoreType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,NON_DIRECT_PATH:1,EVERSTORE:2,OIL:3,EXPRESS_PATH:4,STATIC:5,MANIFOLD:6});f.BACKEND_STORE_TYPE=a}),66);
__d("WAWebWamEnumMediaDownloadModeType",[],(function(a,b,c,d,e,f){a=Object.freeze({MANUAL:1,FULL:2,PREFETCH:3,HEADER:4,THUMBNAIL:5,EXPRESS_PATH_DOWNLOAD:6,PREFETCH_FOR_THUMB_PREVIEW:7,FULL_FOR_THUMB_PREVIEW:8});f.MEDIA_DOWNLOAD_MODE_TYPE=a}),66);
__d("WAWebWamEnumMediaDownloadResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({OK:1,ERROR_UNKNOWN:2,ERROR_TIMEOUT:3,ERROR_DNS:4,ERROR_INSUFFICIENT_SPACE:5,ERROR_TOO_OLD:6,ERROR_CANNOT_RESUME:7,ERROR_HASH_MISMATCH:8,ERROR_INVALID_URL:9,ERROR_OUTPUT_STREAM:10,ERROR_CANCEL:11,DEDUPED:12,ERROR_ENC_HASH_MISMATCH:14,PREFETCH_END:15,ERROR_CANCEL_PROGRAMMATIC:16,ERROR_MEDIA_CONN:17,ERROR_THROTTLE:18,ERROR_SSL:19,ERROR_NETWORK:20,ERROR_CONNECT:21,ERROR_EP_NOTIFY_DECRYPTION_FAILURE:22,SKIPPED_EP_DIFFERENT_POP:23,SKIPPED_EP_AUTODOWNLOAD_DISABLED:24,ERROR_SERVER:25,ERROR_WATLS:26,ERROR_INVALID_CODE:27,ERROR_WAMSYS:28,ERROR_GENERIC:29,ERROR_CRONET:30,ERROR_NO_CLIENT_NETWORK:31,ERROR_HOST_SWITCH_REQUIRED:32,ERROR_SUSPICIOUS_CONTENT:33,ERROR_NO_ENCRYPTION_ALGORITHM:34,ERROR_NO_ENCRYPTED_HASH:35,ERROR_NO_MEDIA_HASH:36,ERROR_NO_MEDIA_KEY:37,ERROR_NO_SIDECAR:38,ERROR_HASH_VERIFICATION_FAILURE:39,INTEGRITY_CHECK_FAILURE:40});f.MEDIA_DOWNLOAD_RESULT_TYPE=a}),66);
__d("WAWebWamEnumWebcMediaOperationCode",[],(function(a,b,c,d,e,f){a=Object.freeze({DOWNLOAD:1,UPLOAD:2});f.WEBC_MEDIA_OPERATION_CODE=a}),66);
__d("WAWebWebcMediaErrorUnknownDetailsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcMediaOperationCode"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMediaErrorUnknownDetails:[2352,{mediaId:[1,a.TYPES.INTEGER],webcMediaErrorMessage:[4,a.TYPES.STRING],webcMediaErrorName:[3,a.TYPES.STRING],webcMediaOperation:[2,d("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE]},[1,1,1],"regular"]},{WebcMediaErrorUnknownDetails:[]});g.WebcMediaErrorUnknownDetailsWamEvent=b}),98);
__d("WAWebWamMediaMetricUtils",["WAAbortError","WALogger","WAWebHttpErrors","WAWebMediaHostsErrors","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsMediaTypes","WAWebWamEnumBackendStoreType","WAWebWamEnumMediaDownloadModeType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumMediaType","WAWebWamEnumMediaUploadModeType","WAWebWamEnumMediaUploadResultType","WAWebWamEnumWebcMediaOperationCode","WAWebWebcMediaErrorUnknownDetailsWamEvent","err","gkx"],(function(a,b,c,d,e,f,g){var h,i;function j(a){switch(a){case"thumbnail-document":case"thumbnail-image":case"thumbnail-video":case"thumbnail-link":case"newsletter-thumbnail-link":return!0}return!1}function a(a,b,c){if(j(a))return d("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.THUMBNAIL;if(b==="manual")return d("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.MANUAL;return c?d("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.PREFETCH:d("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE.FULL}function b(a){return j(a)?d("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE.THUMBNAIL:d("WAWebWamEnumMediaUploadModeType").MEDIA_UPLOAD_MODE_TYPE.REGULAR}function e(a){switch(a){case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO:case"audio":return d("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case"document":return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"thumbnail-document":return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF:case"gif":return d("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case"image":case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"thumbnail-image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"ppic":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PROFILE_PIC;case"product":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT:case"ptt":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER:case"sticker":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK:case"sticker-pack":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"thumbnail-sticker-pack":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"video":case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:return d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"ptv":case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"thumbnail-video":return d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"template":return d("WAWebWamEnumMediaType").MEDIA_TYPE.TEMPLATE;case"md-msg-hist":return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_HISTORY_SYNC;case"md-app-state":return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_APP_STATE;case"product-catalog-image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:case"thumbnail-link":return d("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case"payment-bg-image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"biz-cover-photo":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"ads-image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"ads-video":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"music-artwork":return d("WAWebWamEnumMediaType").MEDIA_TYPE.MUSIC_ARTWORK;case"group-history":return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;default:a;throw c("err")("webMediaType is invalid: "+a)}}function f(a){if(a instanceof d("WAWebMmsClientErrors").MMSUnauthorizedError)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_NO_PERMISSIONS;if(a instanceof d("WAWebMmsClientErrors").MediaTooLargeError)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_BAD_MEDIA;if(a instanceof d("WAWebMmsClientErrors").MMSThrottleError)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_THROTTLE;if(a instanceof d("WAWebHttpErrors").HttpStatusCodeError&&a.status>=500)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_SERVER;if(a instanceof d("WAWebMediaHostsErrors").NoMediaHostsError)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(a.name===d("WAAbortError").ABORT_ERROR)return d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_CANCEL;return a instanceof d("WAWebHttpErrors").HttpNetworkError?d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UPLOAD:d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN}function k(a){if(a instanceof d("WAWebMmsClientErrors").MMSThrottleError)return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;if(a instanceof d("WAWebMediaHostsErrors").NoMediaHostsError)return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_MEDIA_CONN;if(a instanceof d("WAWebHttpErrors").HttpNetworkError)return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_NETWORK;if(a instanceof d("WAWebHttpErrors").HttpStatusCodeError)switch(a.status){case 404:case 410:return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_TOO_OLD;case 416:return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANNOT_RESUME;case 401:return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_INVALID_URL;case 429:case 507:return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_THROTTLE;default:return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}if(a.name===d("WAAbortError").ABORT_ERROR)return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_CANCEL;if(a instanceof d("WAWebHttpErrors").MmsDownloadFilehashMismatchError)return d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_ENC_HASH_MISMATCH;return a instanceof d("WAWebMiscErrors").MediaDecryptionError&&a.message.includes(d("WAWebMiscErrors").PLAINTEXT_HASH_MISMATCH_ERROR)?d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_HASH_MISMATCH:d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN}function l(a){if(a instanceof d("WAWebHttpErrors").HttpStatusCodeError)return a.status}function m(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}function n(a,b){if(b==null)return;var c;a.overallDownloadResult===d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.ERROR_UNKNOWN?c=d("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE.DOWNLOAD:a.overallUploadResult===d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.ERROR_UNKNOWN&&(c=d("WAWebWamEnumWebcMediaOperationCode").WEBC_MEDIA_OPERATION_CODE.UPLOAD);if(c==null)return;new(d("WAWebWebcMediaErrorUnknownDetailsWamEvent").WebcMediaErrorUnknownDetailsWamEvent)({mediaId:a.mediaId,webcMediaOperation:c,webcMediaErrorName:b.name,webcMediaErrorMessage:b.message}).commit()}function o(a){if(!a)return d("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.NON_DIRECT_PATH;switch(a.slice(0,2).toLowerCase()){case"/v":return d("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.EVERSTORE;case"/o":return d("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.OIL;case"/m":return d("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE.MANIFOLD}c("gkx")("26258")?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unrecognized direct path type"]))).sendLogs("unrecognized-direct-path-type"):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unrecognized direct path type: ",""])),a).sendLogs("unrecognized-direct-path-type");return null}g.getMetricOverallDownloadModeType=a;g.getMetricOverallUploadModeType=b;g.getMetricMediaType=e;g.getMetricUploadErrorResultType=f;g.getMetricDownloadErrorResultType=k;g.getStatusCode=l;g.generateMediaEventId=m;g.logErrorUnknownDetails=n;g.getMetricBackendStore=o}),98);
__d("WAWebCreateMediaUploadMetrics",["WAWebABProps","WAWebAppTracker","WAWebHttpErrors","WAWebMapFileOriginToUploadOrigin","WAWebMediaUpload2WamEvent","WAWebMmsMediaTypes","WAWebWamEnumConnectionType","WAWebWamEnumMediaQuality","WAWebWamEnumMediaUploadResultType","WAWebWamEnumNetworkStackType","WAWebWamEnumOverallLastUploadRetryPhaseType","WAWebWamMediaMetricUtils"],(function(a,b,c,d,e,f,g){function a(a,b,e,f,g,h){h===void 0&&(h=!1);var i=d("WAWebWamMediaMetricUtils").generateMediaEventId(),j=new(d("WAWebMediaUpload2WamEvent").MediaUpload2WamEvent)({mediaId:i,connectionType:d("WAWebWamEnumConnectionType").CONNECTION_TYPE.HOSTNAME,overallMediaType:d("WAWebWamMediaMetricUtils").getMetricMediaType(a),overallMmsVersion:4,overallAttemptCount:e,networkStack:d("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE.NATIVE,overallUploadMode:d("WAWebWamMediaMetricUtils").getMetricOverallUploadModeType(a),overallIsForward:f,overallUploadOrigin:b,uploadSource:c("WAWebMapFileOriginToUploadOrigin")(b,f),isViewOnce:g,overallUserVisibleT:0});d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.MediaUL);if(a===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&d("WAWebABProps").getABPropConfigValue("hqp_log_enabled")){e=h?d("WAWebWamEnumMediaQuality").MEDIA_QUALITY.HIGHEST_QUALITY:d("WAWebWamEnumMediaQuality").MEDIA_QUALITY.DATA_SAVER;j.set({photoQualitySetting:e})}function k(a){j.set({overallMediaSize:a})}function l(a){a instanceof d("WAWebHttpErrors").HttpStatusCodeError&&j.set({resumeHttpCode:a.status})}function m(){j.set({overallUploadResult:d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.DUPLICATE,overallIsFinal:!0,resumeHttpCode:200}),j.markOverallCumT(),d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL),d("WAWebAppTracker").attachWAMAppContext(j,j.overallCumT),j.commit()}function n(a){var b=a.hostName,c=a.hostClass;a=a.failCount;j.set({overallDomain:b,overallConnectionClass:c,overallRetryCount:a})}function o(){j.set({resumeHttpCode:404,overallUploadResult:d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.OK,overallIsFinal:!0,uploadHttpCode:200,finalizeHttpCode:200}),j.markOverallCumT(),d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL),d("WAWebAppTracker").attachWAMAppContext(j,j.overallCumT),j.commit()}function p(a){j.set({overallUploadResult:d("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(a),overallIsFinal:!0});var b=d("WAWebWamMediaMetricUtils").getStatusCode(a);b!=null&&(j.uploadHttpCode=b,j.finalizeHttpCode=b);j.markOverallCumT();d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL);d("WAWebAppTracker").attachWAMAppContext(j,j.overallCumT);j.commit();d("WAWebWamMediaMetricUtils").logErrorUnknownDetails(j,a)}function q(a){j.set({overallT:a})}function r(a,b,c,e){var f=new(d("WAWebMediaUpload2WamEvent").MediaUpload2WamEvent)(j.all),g=d("WAWebWamMediaMetricUtils").getStatusCode(a),h=e===d("WAWebWamEnumOverallLastUploadRetryPhaseType").OVERALL_LAST_UPLOAD_RETRY_PHASE_TYPE.FINALIZE?g:f.finalizeHttpCode;f.set({mediaId:d("WAWebWamMediaMetricUtils").generateMediaEventId(),overallUploadResult:d("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(a),overallIsFinal:!1,overallT:b,overallRetryCount:c,overallLastUploadRetryPhase:e,finalizeHttpCode:h});g!=null&&(j.uploadHttpCode=g);j.markOverallCumT();d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL);d("WAWebAppTracker").attachWAMAppContext(j,j.overallCumT);f.commit();d("WAWebWamMediaMetricUtils").logErrorUnknownDetails(j,a)}function s(){j.startOverallEncryptT()}function t(){j.markOverallEncryptT()}function u(){j.set({uploadIsStreaming:!0})}function v(a){j.set({uploadBytesTransferred:a})}function w(a){a!=null&&j.set({isViewOnce:a}),j.markOverallUserVisibleT()}return{handleStreamUploadStart:u,handleArrayBufferCreated:k,handleCheckExistingError:l,handleCheckExistingSuccess:m,handleUploadHostFound:n,handleUploadSuccess:o,handleUploadError:p,handleUploadAttemptSuccess:q,handleUploadAttemptError:r,mediaId:i,handleEncryptionStart:s,handleEncryptionSuccess:t,handleUploadProgress:v,handleSendMessageStart:w}}g["default"]=a}),98);
__d("WAWebCryptoCalculateStreamingSidecar",["Promise","WAArrayBuffersConcat","WACryptoHmac","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=64*1024,j=16,k=10;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=a instanceof ArrayBuffer?a.byteLength:a.buffer.byteLength;e=e-j;e=Math.ceil(e/i);e=Array.from({length:e},function(b,e){b=e*i;e=b+j+i;b=a.slice(b,e);return d("WACryptoHmac").hmacSha256(c,b,k)});e=(yield (h||(h=b("Promise"))).all(e));return d("WAArrayBuffersConcat").concatArrayBuffers.apply(void 0,e)});return l.apply(this,arguments)}g.IV_LENGTH=j;g.HMAC_LENGTH=k;g.calculateStreamingSidecar=a}),98);
__d("WAWebCryptoCalculateFirstFrameSidecar",["WACryptoHmac","WAWebCryptoCalculateStreamingSidecar"],(function(a,b,c,d,e,f,g){var h=16;function a(a,b,c){a=Math.ceil(a/h)*h;b=b.slice(0,d("WAWebCryptoCalculateStreamingSidecar").IV_LENGTH+a);return d("WACryptoHmac").hmacSha256(c,b,d("WAWebCryptoCalculateStreamingSidecar").HMAC_LENGTH)}g["default"]=a}),98);
__d("WAWebCryptoCreateMediaKeys",["WABase64","WACryptoHkdf","WALogger","WAWebMiscErrors","WAWebMmsMediaTypes","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=j(a),f;try{f=d("WABase64").decodeB64(b)}catch(a){c("gkx")("26258")||d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["decodeB64: invalid base64 string ",""])),b)}if(!b||!e||!f)throw new(d("WAWebMiscErrors").MediaEncryptionError)("createKeys fail: !!mediakey: "+!!b+" info: "+e+" type: "+a);b=(yield d("WACryptoHkdf").extractAndExpand(f,e,112));if(!b||b.byteLength<112)throw new(d("WAWebMiscErrors").MediaEncryptionError)("computeMediaKeys: hkdf error");return{iv:b.slice(0,0+16),encKey:b.slice(16,16+32),macKey:b.slice(48,48+32),refKey:b.slice(80,80+32)}});return i.apply(this,arguments)}function j(a){switch(a){case d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO:return"WhatsApp Audio Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT:return"WhatsApp Document Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.GIF:return"WhatsApp Video Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE:return"WhatsApp Image Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC:throw c("err")("Cannot create media keys for profile pics");case d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT:return"WhatsApp Image Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.PTT:return"WhatsApp Audio Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER:return"WhatsApp Image Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:case d("WAWebMmsMediaTypes").MEDIA_TYPES.PTV:return"WhatsApp Video Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT:return"WhatsApp Document Thumbnail Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER_PACK:return"WhatsApp Sticker Pack Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK:return"WhatsApp Sticker Pack Thumbnail Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE:return"WhatsApp Image Thumbnail Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO:return"WhatsApp Video Thumbnail Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK:return"WhatsApp Link Thumbnail Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.TEMPLATE:throw c("err")("Cannot create media keys for template");case d("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC:return"WhatsApp History Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.MD_APP_STATE:return"WhatsApp App State Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT_CATALOG_IMAGE:throw c("err")("Cannot create media keys for product catalog image");case d("WAWebMmsMediaTypes").MEDIA_TYPES.PAYMENT_BG_IMAGE:return"WhatsApp Payment Background Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_IMAGE:return"ads-image";case d("WAWebMmsMediaTypes").MEDIA_TYPES.NATIVE_AD_VIDEO:return"ads-video";case d("WAWebMmsMediaTypes").MEDIA_TYPES.MUSIC_ARTWORK:return"WhatsApp Music Artwork Keys";case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_DOCUMENT:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK:throw c("err")("createKeys: newsletter media is not encrypted: "+a);case d("WAWebMmsMediaTypes").MEDIA_TYPES.GROUP_HISTORY:return"Group History";default:a;return}}g["default"]=a}),98);
__d("WAWebMmsPerformanceExperimentSwitch",["WAWebServerPropConstants"],(function(a,b,c,d,e,f,g){function a(a){return a>d("WAWebServerPropConstants").DEFAULT_MAX_FILE_SIZE_BYTES}function b(){return!0}g.shouldEncryptInChunks=a;g.isPerformanceExperimentEnabled=b}),98);
__d("WAWebWebp",["$InternalEnum","WABinary","WALogger","WATypedArraysEqual"],(function(a,b,c,d,e,f,g){var h,i,j=b("$InternalEnum")({VP8X:"VP8X",ANMF:"ANMF",EXIF:"EXIF",XMP:"XMP "}),k=12,l=8,m=4,n=20,o=2,p="}".charCodeAt(0),q=0;function r(a,b){b=u(b);var d=0;d+=k;while(d<a.byteLength){var e=a.slice(d,d+l),f=e.slice(0,m);e=t(e.slice(m,2*m));e%2!==0&&(e+=1);if(c("WATypedArraysEqual")(f,b))return{position:d,size:e+m+m};d+=l+e}return null}function a(a){if(!s(a)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sticker file not extended format."])));return null}var b=r(a,j.EXIF);if(!b)return null;a=a.slice(b.position,b.position+b.size);var c,e;for(var f=a.byteLength;f>0;--f)if(e==null&&a[f]===p)e=f;else if(e!=null&&a[f]===q){c=f+1;break}if(c==null||e==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["JSON not found in sticker file"])));return null}return{position:b.position+c,size:e-c+1}}function s(a){a=a.slice(k,k+m);return c("WATypedArraysEqual")(a,u(j.VP8X))}function e(a){a=new Uint8Array(a);return s(a)&&(o&a[n])!==0}function t(a){return a.reduce(function(a,b,c){return a+(b<<c*8)},0)}function f(a){var b=new(d("WABinary").Binary)();b.writeUint32(a,!0);return b.readByteArrayView()}function u(a){var b=new(d("WABinary").Binary)();b.writeString(a);return b.readByteArrayView()}g.Chunk=j;g.CHUNK_HEADER_SIZE=l;g.FOUR=m;g.findWebpChunk=r;g.findWebpMetadata=a;g.isExtendedFile=s;g.isAnimatedWebp=e;g.littleEndianToNumber=t;g.numberToLittleEndian=f;g.stringToUint8=u}),98);
__d("WAWebWebpMetadata",["$InternalEnum","WAWebStickerMetadataParsing","WAWebWamEnumStickerMakerSourceType"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({CutoutImage:1,WebStickerMaker:2,IosStickerMaker:3,AndroidStickerMaker:4,TransparentImage:5,GIF:6});function a(a){return d("WAWebStickerMetadataParsing").toStickerMetadata(a)}function c(a){var b={};a.isFirstParty!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isFirstParty]=a.isFirstParty?1:0);a.isFromStickerMaker!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isFromStickerMaker]=a.isFromStickerMaker?1:0);a.emojis!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.emojis]=a.emojis);a.stickerPackId!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackId]=a.stickerPackId);a.stickerPackName!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackName]=a.stickerPackName);a.stickerPackPublisher!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackPublisher]=a.stickerPackPublisher);a.stickerPackPlayStoreLink!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackPlayStoreLink]=a.stickerPackPlayStoreLink);a.stickerPackAppleStoreLink!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerPackAppleStoreLink]=a.stickerPackAppleStoreLink);a.isAvatar!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isAvatar]=a.isAvatar?1:0);a.isAiSticker!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.isAiSticker]=a.isAiSticker?1:0);a.stickerMakerSourceType!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.stickerMakerSourceType]=a.stickerMakerSourceType);a.accessibilityLabel!=null&&(b[d("WAWebStickerMetadataParsing").STICKER_METADATA_FIELDS.accessibilityLabel]=a.accessibilityLabel);return b}function e(a){if(a==null)return null;switch(a){case h.CutoutImage:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.CUTOUT_IMAGE;case h.WebStickerMaker:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.WEB_STICKER_MAKER;case h.IosStickerMaker:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.IOS_STICKER_MAKER;case h.AndroidStickerMaker:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.ANDROID_STICKER_MAKER;case h.TransparentImage:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.TRANSPARENT_IMAGE;case h.GIF:return d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE.GIF}}g.StickerMakerSourceType=h;g.toWebpMetadata=a;g.toRawWebpMetadata=c;g.getStickerMakerSourceType=e}),98);
__d("WAWebStickerMetadataParsing",["WAWebWebpMetadata"],(function(a,b,c,d,e,f,g){"use strict";var h={isFirstParty:!1,isFromStickerMaker:!1,emojis:[],stickerPackId:null,stickerPackName:null,stickerPackPublisher:null,stickerPackPlayStoreLink:null,stickerPackAppleStoreLink:null,isAvatar:!1,isAiSticker:!1,stickerMakerSourceType:null,accessibilityLabel:null},i={isFirstParty:"is-first-party-sticker",isFromStickerMaker:"is-from-sticker-maker",emojis:"emojis",stickerPackId:"sticker-pack-id",stickerPackName:"sticker-pack-name",stickerPackPublisher:"sticker-pack-publisher",stickerPackPlayStoreLink:"android-app-store-link",stickerPackAppleStoreLink:"ios-app-store-link",isAvatar:"is-avatar-sticker",isAiSticker:"is-ai-sticker",stickerMakerSourceType:"sticker-maker-source-type",accessibilityLabel:"accessibility-text"};function a(a){var b=a[i.isFirstParty],c=a[i.isFromStickerMaker],e=a[i.emojis],f=a[i.stickerPackId],g=a[i.stickerPackName],j=a[i.stickerPackPublisher],k=a[i.stickerPackPlayStoreLink],l=a[i.stickerPackAppleStoreLink],m=a[i.isAvatar],n=a[i.isAiSticker],o=d("WAWebWebpMetadata").StickerMakerSourceType.cast(a[i.stickerMakerSourceType]);a=a[i.accessibilityLabel];var p=babelHelpers["extends"]({},h);if(b!=null){b=b===1;p.isFirstParty=b}if(c!=null){b=c===1;p.isFromStickerMaker=b}e!=null&&Array.isArray(e)&&(p.emojis=e);f!=null&&(p.stickerPackId=f);g!=null&&(p.stickerPackName=g);j!=null&&(p.stickerPackPublisher=j);k!=null&&(p.stickerPackPlayStoreLink=k);l!=null&&(p.stickerPackAppleStoreLink=l);if(m!=null){c=m===1;p.isAvatar=c}if(n!=null){b=n===1;p.isAiSticker=b}o!=null&&(p.stickerMakerSourceType=o);a!=null&&(p.accessibilityLabel=a);return p}g.DEFAULT_STICKER_METADATA=h;g.STICKER_METADATA_FIELDS=i;g.toStickerMetadata=a}),98);
__d("WAWebGetWebpMetadata",["WALogger","WAWebWebp","WAWebWebpMetadata"],(function(a,b,c,d,e,f,g){var h;function i(a){a=new Uint8Array(a);var b=d("WAWebWebp").findWebpMetadata(a);if(!b)return{};var c=b.position;b=b.size;var e=new TextDecoder();a=a.slice(c,c+b);c=e.decode(a);try{b=JSON.parse(c);return b}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to parse emojis out of sticker, returning empty object."]))).devConsole(a);return{}}}function a(a){a=i(a);a=d("WAWebWebpMetadata").toWebpMetadata(a);return a}g.getWebpMetadata=a}),98);
__d("WAWebWebpParseWebp",["WALogger","WATypedArraysEqual","WAWebGetWebpMetadata","WAWebWebp"],(function(a,b,c,d,e,f,g){var h,i=3,j=5e3;function k(a){if(a===0)return 0;var b=Math.min(Math.floor(j/a),i);return Math.max(b,1)*a}var l=44,m=20,n=3,o=4,p={animationDuration:0,singleLoopDuration:0,emojis:[],isFirstParty:!1,isFromStickerMaker:!1,stickerPackId:null,stickerPackName:null,stickerPackPublisher:null,isAvatar:!1,isAiSticker:!1,stickerMakerSourceType:null,accessibilityLabel:null};function a(a){var b=new Uint8Array(a);if(!d("WAWebWebp").isExtendedFile(b)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sticker file not extended format."])));return p}a=d("WAWebGetWebpMetadata").getWebpMetadata(a);var e=a.emojis,f=a.isFirstParty,g=a.isFromStickerMaker,i=a.stickerPackId,j=a.stickerPackName,q=a.stickerPackPublisher,r=a.isAvatar,s=a.isAiSticker,t=a.stickerMakerSourceType;a=a.accessibilityLabel;e=babelHelpers["extends"]({},p,{emojis:e,isFirstParty:f,isFromStickerMaker:g,stickerPackId:i,stickerPackName:j,stickerPackPublisher:q,isAvatar:r,isAiSticker:s,stickerMakerSourceType:t,accessibilityLabel:a});if(!d("WAWebWebp").isAnimatedWebp(b))return e;f=0;g=l;var u;while(c("WATypedArraysEqual")(b.slice(g,g+o),d("WAWebWebp").stringToUint8(d("WAWebWebp").Chunk.ANMF))){i=g+m;j=b.slice(i,i+n);if(j.length!==n)return e;f+=d("WAWebWebp").littleEndianToNumber(j);q=g+o;r=b.slice(q,q+o);if(r.length!==o)return e;g+=o*2+d("WAWebWebp").littleEndianToNumber(r);u==null&&(u=g)}s=k(f);return babelHelpers["extends"]({},e,{animationDuration:s,firstFrameLength:u,singleLoopDuration:f})}g.MAX_LOOPS=i;g.getTotalAnimationDuration=k;g.parseWebp=a}),98);
__d("WAWebCryptoEncryptMedia",["Promise","WAArrayBuffersConcat","WACryptoAesCbc","WACryptoHmac","WALogger","WAMediaCalculateFilehash","WAPromiseProps","WATypedArraysConcat","WAWebCryptoCalculateFirstFrameSidecar","WAWebCryptoCalculateStreamingSidecar","WAWebCryptoCreateMediaKeys","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebMmsPerformanceExperimentSwitch","WAWebWebpParseWebp","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=10;function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=f.iv,h=f.encKey;f=f.macKey;h=(yield d("WACryptoAesCbc").aesCbcEncrypt(h,a,g));g=h.slice(g.byteLength);var i=(yield d("WACryptoHmac").hmacSha256(f,h,l)),j=(k||(k=b("Promise"))).resolve();if(e===d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO||e===d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO){var m=d("WAArrayBuffersConcat").concatArrayBuffers(h,i);j=d("WAWebCryptoCalculateStreamingSidecar").calculateStreamingSidecar(m,f)}m=k.resolve();if(e===d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER){e=d("WAWebWebpParseWebp").parseWebp(a);a=e.firstFrameLength;if(a!=null){e=d("WAArrayBuffersConcat").concatArrayBuffers(h,i);m=c("WAWebCryptoCalculateFirstFrameSidecar")(a,e,f)}}h=d("WAArrayBuffersConcat").concatArrayBuffers(g,i);return d("WAPromiseProps").promiseProps({ciphertextHmac:h,hash:d("WAMediaCalculateFilehash").calculateFilehash(h),sidecar:j,firstFrameSidecar:m})});return n.apply(this,arguments)}function a(a){var c=a.ivCiphertext,e=a.signature;a=a.macKey;c=d("WAArrayBuffersConcat").concatArrayBuffers(c,e);return{sidecar:d("WAWebCryptoCalculateStreamingSidecar").calculateStreamingSidecar(c,a),firstFrameSidecar:(k||(k=b("Promise"))).resolve()}}function e(a){var e=a.plaintext,f=a.ivCiphertext,g=a.signature;a=a.macKey;e=d("WAWebWebpParseWebp").parseWebp(e);e=e.firstFrameLength;return{sidecar:(k||(k=b("Promise"))).resolve(),firstFrameSidecar:e!=null?c("WAWebCryptoCalculateFirstFrameSidecar")(e,d("WAArrayBuffersConcat").concatArrayBuffers(f,g),a):(k||(k=b("Promise"))).resolve()}}var o=new Map([[d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,a],[d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO,a],[d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER,e]]);function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=e.iv,g=e.encKey;e=e.macKey;g=d("WAWebMmsPerformanceExperimentSwitch").shouldEncryptInChunks(a.byteLength)?yield d("WACryptoAesCbc").aesCbcEncryptWithChunking(g,a,f):yield d("WACryptoAesCbc").aesCbcEncrypt(g,a,f);f=new Uint8Array(g).subarray(f.byteLength);var h=(yield d("WACryptoHmac").hmacSha256(e,g,l));a=(c=(c=o.get(c))==null?void 0:c({plaintext:a,ivCiphertext:g,signature:h,macKey:e}))!=null?c:{};g=a.sidecar;e=g===void 0?(k||(k=b("Promise"))).resolve():g;c=a.firstFrameSidecar;g=c===void 0?(k||(k=b("Promise"))).resolve():c;a=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[f,new Uint8Array(h)]).buffer;return d("WAPromiseProps").promiseProps({ciphertextHmac:a,hash:d("WAMediaCalculateFilehash").calculateFilehash(a),sidecar:e,firstFrameSidecar:g})});return q.apply(this,arguments)}function f(a){var e=a.mediaKey,f=a.plaintext,g=a.type;return new(k||(k=b("Promise")))(function(a,b){var k={mediaKey:e.slice(0,10),type:g};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: start"]))).devConsole(k);if(!g)throw new(d("WAWebMiscErrors").MediaEncryptionError)('encryptMedia: missing "type"');if(!e)throw new(d("WAWebMiscErrors").MediaEncryptionError)('encryptMedia: missing "mediaKey"');c("WAWebCryptoCreateMediaKeys")(g,e).then(function(a){return d("WAWebMmsPerformanceExperimentSwitch").isPerformanceExperimentEnabled()?p(f,g,a):m(f,g,a)}).then(function(b){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: success"]))).devConsole(k),a(b)})["catch"](function(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptMedia: error"]))).devConsole(k,a);if(a instanceof d("WAWebMiscErrors").MediaEncryptionError)throw a;throw new(d("WAWebMiscErrors").MediaEncryptionError)("encryption error: "+String(a)+"; stack: "+a.stack)})["catch"](b)})}g["default"]=f}),98);
__d("WAWebCryptoRandomMediaKey",["WABase64","WATimeUtils"],(function(a,b,c,d,e,f,g){function a(){var a=new Uint8Array(32);self.crypto.getRandomValues(a);return{key:d("WABase64").encodeB64(a),timestamp:d("WATimeUtils").unixTime()}}g["default"]=a}),98);
__d("WAWebMediaDebugString",[],(function(a,b,c,d,e,f){function a(a){return(a=a==null?void 0:a.slice(0,10))!=null?a:""}f.getDebugString=a}),66);
__d("WAWebMmsDownloadUploadCrashLogger",["$InternalEnum","WALogger","WAWebLocalStorage","justknobx"],(function(a,b,c,d,e,f,g){var h;a=b("$InternalEnum").Mirrored(["DOWNLOAD_STARTED","DOWNLOAD_FINISHED","DOWNLOAD_DECRYPTION_STARTED","DOWNLOAD_DECRYPTION_FINISHED","DOWNLOAD_ERROR","UPLOAD_STARTED","UPLOAD_FINISHED","UPLOAD_BLOB_TO_ARRAY_BUFFER_STARTED","UPLOAD_BLOB_TO_ARRAY_BUFFER_FINISHED","UPLOAD_ENCRYPTION_STARTED","UPLOAD_ENCRYPTION_FINISHED","UPLOAD_ERROR"]);var i="DownloadUploadCrashLoggerLikelyCrashed",j=new Set([a.DOWNLOAD_DECRYPTION_FINISHED,a.DOWNLOAD_ERROR,a.UPLOAD_FINISHED,a.UPLOAD_ERROR]);function k(a){return a.toLowerCase().replace(/(?:^|_)(\w)/g,function(a,b){return b.toLocaleUpperCase()})}function l(a){return Object.entries(a).map(function(a){var b=a[0];a=a[1];return b+": "+String(a)}).join(", ")}e=function(){function a(){this.hasPerformedInit=!1,this.$3=function(){c("WAWebLocalStorage")==null||c("WAWebLocalStorage").removeItem(i)}}var b=a.prototype;b.$1=function(){var a=c("WAWebLocalStorage")==null?void 0:c("WAWebLocalStorage").getItem(i);return a?JSON.parse(a):{}};b.$2=function(){c("WAWebLocalStorage")==null||c("WAWebLocalStorage").setItem(i,JSON.stringify(this.storage))};b.$4=function(){return c("justknobx")._("3944")};b.init=function(){if(this.hasPerformedInit||!this.$4())return;window.addEventListener("beforeunload",this.$3);this.storage=this.$1();Object.entries(this.storage).forEach(function(a){var b=a[0];a=a[1];var c=a.progressType;a=a.metadata;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["downloadUploadCrashLogger.likelyCrashedDuring","WithID","",""])),k(c),b,a?"AndData => "+l(a):"").sendLogs("download-upload-manager-likely-crashed")});this.$3();this.hasPerformedInit=!0};b.reset=function(){if(!this.$4())return;window.removeEventListener("beforeunload",this.$3);this.$3();this.hasPerformedInit=!1};b.mark=function(a,b,c){if(!this.$4())return;j.has(b)?delete this.storage[String(a)]:this.storage[String(a)]={progressType:b,metadata:c};this.$2()};return a}();f=new e();g.ProgressType=a;g.downloadUploadCrashLogger=f}),98);
__d("WAWebUploadManager",["Promise","WAAbortError","WAFilteredCatch","WALogger","WAMemoizeConcurrent","WATimeUtils","WAWebCreateMediaUploadMetrics","WAWebCryptoEncryptMedia","WAWebCryptoRandomMediaKey","WAWebFileUtils","WAWebMediaDebugString","WAWebMmsClient","WAWebMmsClientErrors","WAWebMmsDownloadUploadCrashLogger","WAWebMmsPerformanceExperimentSwitch","WAWebPonyfillsUrlSearchParams","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;function u(a){var b=a.mediaKey;a=a.mediaKeyTimestamp;if(b!=null&&a!=null)return{mediaKey:b,mediaKeyTimestamp:a};b=c("WAWebCryptoRandomMediaKey")();a=b.key;b=b.timestamp;return{mediaKey:a,mediaKeyTimestamp:b}}a=function(){function a(){var a=this;this._checkIfAlreadyUploaded=c("WAMemoizeConcurrent")(function(a){return a.token},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.encFilehash,e=a.type;e={encFilehash:b,type:e};b=d("WAWebMediaDebugString").getDebugString(b);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] start"])),b).devConsole(e);try{a=(yield c("WAWebMmsClient").checkIfUploadExists(a)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMmsClientErrors").MediaNotFoundError,function(){return null})));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] success"])),b).devConsole(e);return a}catch(a){a.name===d("WAAbortError").ABORT_ERROR?d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] canceled"])),b).devConsole(e,a):d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.checkIfAlreadyUploaded: [","] error"])),b).devConsole(e,a);throw a}});return function(b){return a.apply(this,arguments)}}());this._memoizedUpload=c("WAMemoizeConcurrent")(function(a){return a.token},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.ciphertextHmac,d=a.encFilehash,e=a.type,f=a.signal,g=a.onUploadHostFound,h=a.onUploadAttemptSuccess,i=a.onUploadAttemptError,j=a.onUploadSuccess,k=a.onProgress,l=a.onFinalize,m=a.onStreamUploadStart,n=a.mediaId,o=a.generateThumbnailOnServer;d=(yield c("WAWebMmsClient").upload({ciphertextHmac:b,encFilehash:d,type:e,signal:f,onUploadHostFound:g,onUploadAttemptSuccess:h,onUploadAttemptError:i,onProgress:k,byteOffset:(b=a.byteOffset)!=null?b:0,onFinalize:l,onStreamUploadStart:m,mediaId:n,token:a.token,generateThumbnailOnServer:o}));j();return d});return function(b){return a.apply(this,arguments)}}());this._getExistingOrUpload=c("WAMemoizeConcurrent")(function(a){return a.token},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.ciphertextHmac,e=b.encFilehash,f=b.signal,g=b.type,h=b.onCheckExistingSuccess,i=b.onCheckExistingError,j=b.onUploadHostFound,k=b.onUploadAttemptSuccess,p=b.onUploadAttemptError,q=b.onUploadSuccess,r=b.onProgress,s=b.onFinalize,t=b.onStreamUploadStart,u=b.mediaId,v=b.generateThumbnailOnServer,w={encFilehash:e,type:g},x=d("WAWebMediaDebugString").getDebugString(e);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] start"])),x).devConsole(w);try{var y=(yield a._checkIfAlreadyUploaded({encFilehash:e,type:g,signal:f,mediaId:u,token:b.token,generateThumbnailOnServer:v})["catch"](function(a){i(a);throw a}).then(function(d){if((d==null?void 0:d.complete)===!0){h();return{directPath:d.directPath,handle:d.handle,url:d.url}}return a._memoizedUpload({ciphertextHmac:c,encFilehash:e,type:g,signal:f,onUploadHostFound:j,onUploadAttemptSuccess:k,onUploadAttemptError:p,onUploadSuccess:q,onCheckExistingSuccess:h,onCheckExistingError:i,onProgress:r,onFinalize:s,onStreamUploadStart:t,byteOffset:d==null?void 0:d.resume,mediaId:u,token:b.token,generateThumbnailOnServer:v})}));d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] success"])),x).devConsole(w,y);return y}catch(a){a.name===d("WAAbortError").ABORT_ERROR?d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] canceled"])),x).devConsole(w,a):d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["uploadManager._getExistingOrUpload: [","] error"])),x).devConsole(w,a);throw a}});return function(a){return c.apply(this,arguments)}}());d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.init()}var e=a.prototype;e.encryptAndUpload=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this,f=a.blob,g=a.signal,h=a.type,i=a.userUploadAttemptCount,j=a.forwardedFromWeb,k=a.uploadOrigin,l=a.onProgress,m=a.onFinalize,n=a.isViewOnce,o=a.isHdPhoto,w={type:h};d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: start"]))).devConsole(w);k=c("WAWebCreateMediaUploadMetrics")(h,k,i,j,n,o);var x=k.handleCheckExistingSuccess,y=k.handleCheckExistingError,z=k.handleUploadHostFound,A=k.handleUploadAttemptSuccess,B=k.handleUploadAttemptError,C=k.handleUploadSuccess,D=k.handleArrayBufferCreated;i=k.handleUploadError;var E=k.mediaId,F=k.handleEncryptionStart,G=k.handleEncryptionSuccess,H=k.handleStreamUploadStart,I=k.handleUploadProgress,J=function(a,b){l==null||l(a,b);b=b+a.loaded;I(b)};d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ENCRYPTION_STARTED);try{if(d("WAWebMmsPerformanceExperimentSwitch").isPerformanceExperimentEnabled()){var K=u(a);n=(t||(t=b("Promise"))).resolve(f).then(function(a){d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_STARTED,{size:f instanceof Blob?f.size:f.byteLength});a=a instanceof Blob?d("WAWebFileUtils").blobToArrayBuffer(a):a;d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_FINISHED);return a}).then(function(a){D(a.byteLength);F();return c("WAWebCryptoEncryptMedia")({type:h,plaintext:a,mediaKey:K.mediaKey})}).then(function(b){var c=b.hash,f=b.ciphertextHmac,i=b.sidecar,k=b.firstFrameSidecar;G();d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ENCRYPTION_FINISHED);b=a.mediaKey?e._getExistingOrUpload:e._memoizedUpload;return b({ciphertextHmac:f,encFilehash:c,type:h,signal:g,onCheckExistingSuccess:x,onCheckExistingError:y,onUploadHostFound:z,onUploadAttemptSuccess:A,onUploadAttemptError:B,onUploadSuccess:C,onProgress:J,onFinalize:m,onStreamUploadStart:H,mediaId:E,token:(b=a.token)!=null?b:c}).then(function(a){return{directPath:j?v(a.directPath):a.directPath,encFilehash:c,mediaKey:K.mediaKey,mediaKeyTimestamp:K.mediaKeyTimestamp,sidecar:i,firstFrameSidecar:k,url:a.url,handle:a.handle}})})}else{d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_STARTED,{size:f instanceof Blob?f.size:f.byteLength});o=f instanceof Blob?d("WAWebFileUtils").blobToArrayBuffer(f):(t||(t=b("Promise"))).resolve(f);d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_BLOB_TO_ARRAY_BUFFER_FINISHED);n=o.then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){D(b.byteLength);var f=u(a),i=f.mediaKey;f=f.mediaKeyTimestamp;F();b=(yield c("WAWebCryptoEncryptMedia")({type:h,plaintext:b,mediaKey:i}));var k=b.ciphertextHmac,l=b.hash,n=b.sidecar;b=b.firstFrameSidecar;G();d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ENCRYPTION_FINISHED);var o=a.mediaKey?e._getExistingOrUpload:e._memoizedUpload;k=(yield o({ciphertextHmac:k,encFilehash:l,type:h,signal:g,onCheckExistingSuccess:x,onCheckExistingError:y,onUploadHostFound:z,onUploadAttemptSuccess:A,onUploadAttemptError:B,onUploadSuccess:C,onFinalize:m,onStreamUploadStart:H,onProgress:J,mediaId:E,token:(o=a.token)!=null?o:l}));return{directPath:j?v(k.directPath):k.directPath,encFilehash:l,mediaKey:i,mediaKeyTimestamp:f,sidecar:n,firstFrameSidecar:b,url:k.url,handle:k.handle}});return function(a){return f.apply(this,arguments)}}())}k=(yield n);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: success"]))).devConsole(w);d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_FINISHED);return k}catch(a){a.name===d("WAAbortError").ABORT_ERROR?d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: canceled"]))).devConsole(w,a):d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["uploadManager.encryptAndUpload: error"]))).devConsole(w,a);d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(E,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.UPLOAD_ERROR);i(a);throw a}});function e(b){return a.apply(this,arguments)}return e}();e.unencryptedUpload=function(a){var b=a.file,d=a.hash,e=a.type,f=a.signal,g=a.uploadOrigin,h=a.isViewOnce,i=a.generateThumbnailOnServer;g=c("WAWebCreateMediaUploadMetrics")(e,g,0,!1,h);h=g.handleCheckExistingSuccess;var j=g.handleCheckExistingError,k=g.handleUploadHostFound,l=g.handleUploadAttemptSuccess,m=g.handleUploadAttemptError,n=g.handleUploadSuccess,o=g.handleStreamUploadStart,p=g.handleUploadProgress;g=g.mediaId;var q=function(a,b){p(a.loaded+b)};a=(a=a.token)!=null?a:d;return this._getExistingOrUpload({ciphertextHmac:b,encFilehash:d,type:e,signal:f,onCheckExistingSuccess:h,onCheckExistingError:j,onUploadHostFound:k,onUploadAttemptSuccess:l,onUploadAttemptError:m,onUploadSuccess:n,onStreamUploadStart:o,onProgress:q,mediaId:g,token:a,generateThumbnailOnServer:i})};e.uploadCoverPhoto=function(a){var b=a.file,d=a.hash,e=a.type,f=a.signal,g=a.uploadOrigin,h=a.isViewOnce;g=c("WAWebCreateMediaUploadMetrics")(e,g,0,!1,h);h=g.handleCheckExistingSuccess;var i=g.handleCheckExistingError,j=g.handleUploadHostFound,k=g.handleUploadAttemptSuccess,l=g.handleUploadAttemptError,m=g.handleUploadSuccess,n=g.handleStreamUploadStart,o=g.handleUploadProgress;g=g.mediaId;var p=function(a,b){o(a.loaded+b)};d={ciphertextHmac:b,encFilehash:d,type:e,signal:f,onCheckExistingSuccess:h,onCheckExistingError:i,onUploadHostFound:j,onUploadAttemptSuccess:k,onUploadAttemptError:l,onUploadSuccess:m,onStreamUploadStart:n,onProgress:p,mediaId:g,token:(b=a.token)!=null?b:a.hash};return this._memoizedUpload(d)};return a}();e=new a();function v(a){a=a.split("?");var b=a[0];a=a[1];a=new(c("WAWebPonyfillsUrlSearchParams"))(a);var e=d("WATimeUtils").unixTime();a.set("_nc_hot",String(e));return b+"?"+a.toString()}g["default"]=e}),98);
__d("WAWebWamEnumMdSyncdFatalErrorCode",[],(function(a,b,c,d,e,f){a=Object.freeze({TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D:1,SERVER_DATA_MISMATCH:2,PROTOBUF_DESERIALIZATION_FAILED:3,EXTERNAL_PATCH_EXPIRED:4,MISSING_OR_EMPTY_INDEX:5,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH:6,DECRYPTION_FAILED:7,MISSING_PATCH_VERSION:8,DUPLICATE_PATCH_VERSION_IN_COLLECTION:9,ENCRYPTION_FAILED:10,MISSING_MUTATION_VERSION:11,MISSING_MUTATION_VALUE:12,INVALID_MUTATION_INDEX:13,PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS:14,MISSING_MUTATION_OPERATION:15,MISSING_MUTATION_RECORD:16,MISSING_MUTATION_KEY_ID:17,PATCH_PROTOBUF_DESERIALIZATION_FAILED:18,ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED:19,MISSING_MUTATION_INDEX:20,MISSING_ACTION_INDEX:21,INVALID_ACTION_INDEX:22,MISSING_ACTION_VALUE:23,MISSING_ACTION_VERSION:24,MISSING_ACTION_TIMESTAMP:25,MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED:26,MUTATIONS_PROTOBUF_SERIALIZATION_FAILED:27,PATCH_PROTOBUF_SERIALIZATION_FAILED:28,ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED:29,MISSING_KEY_ON_ALL_CLIENTS:30,TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY:31,MAC_MISMATCH_SNAPSHOT:33,MAC_MISMATCH_PATCH:34,DB_STORE_NOT_READY:35,TERMINAL_PATCH_MISSING_DATA:36,TERMINAL_PATCH_DESERIALIZATION_ERROR:37,TERMINAL_PATCH_UNKNOWN:38,CYCLIC_MUTATION_DEPENDENCY_IN_PATCH:39,MISSING_SNAPSHOT_VERSION:45,MISSING_SNAPSHOT_MAC:46,MISSING_PATCH_SNAPSHOT_MAC:47,MISSING_PATCH_MAC:48,MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY:49,MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH:50,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256:51,MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256:52,INVALID_KEY_SHARE_KEY_ID:53,MISSING_PATCH_KEY_ID:56,INVALID_KEY_SHARE_KEY_DATA:57,SNAPSHOT_EXPIRED:58,MISSING_SNAPSHOT_KEY_ID:59,SNAPSHOT_MAC_MISMATCH_IN_PATCH:60,SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT:61,XMPP_BAD_REQUEST_FOR_COLLECTION:62,XMPP_NOT_FOUND_FOR_COLLECTION:63,XMPP_BAD_REQUEST_GLOBAL_ERROR:64,XMPP_NOT_FOUND_GLOBAL_ERROR:65,XMPP_BAD_METHOD_GLOBAL_ERROR:66,XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR:67,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT:68,EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED:69,SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED:70,REQUESTING_MISSING_KEY_WITH_NO_CLIENTS:71,DB_STORE_NOT_READY_LOW_DISK_SPACE:72,SERVER_DID_NOT_SEND_ALL_PATCHES:73,SERVER_SENT_EARLIER_PATCH:74,MISSING_KEY_FOR_MUTATION_IN_LOCAL_SNAPSHOT:75,MISSING_ACTIVE_KEY_AFTER_ROTATION:76,MISSING_ACTIVE_KEY_FOR_ENCRYPTION:77,MISSING_CURRENT_EPOCH_FOR_ACTIVE_KEY_VALIDATION:78,SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_OUTGOING_PATCH:79,INVALID_SNAPSHOT_RECORDS:80,MISSING_EXTERNAL_BLOB_REFERENCE_HANDLE:81,INVALID_EXTERNAL_BLOB_REFERENCE_UPLOADED:82,INVALID_PATCH_KEY_ID_SIZE:83,INVALID_PATCH_MAC_SIZE:84,INVALID_PATCH_SNAPSHOT_MAC_SIZE:85,INVALID_COLLECTION_SNAPSHOT_HASH_SIZE:86,MISSING_COLLECTION_SNAPSHOT_HASH:87,INVALID_PATCH_KEY_ID_DEVICE_ID:88,INVALID_PATCH_KEY_ID_EPOCH:89,DECRYPTION_FAILED_KEY_ID_MISMATCH:90,DECRYPTION_FAILED_VALUE_MAC_MISMATCH:91,DECRYPTION_FAILED_INDEX_MAC_MISMATCH:92,EXTERNAL_PATCH_MISSING_BLOB:93,COLLECTION_PULL_REQUEST_RECEIVED_PUSH_RESPONSE_WITH_UPDATED_VERSION:94,COLLECTION_PUSH_REQUEST_RECEIVED_RESPONSE_WITH_VERSION_MISMATCH:95,MMS_ERROR_INVALID_FILEHASH:96,UNKNOWN:97,MALFORMED_MUTATION_CLEAR_CHAT:98,MALFORMED_MUTATION_DELETE_CHAT:99,FAILED_MUTATION_CLEAR_CHAT:100,FAILED_MUTATION_DELETE_CHAT:101,CHAT_DB_CORRUPTION:102,LID_BLOCKLIST_PN_WHEN_MIGRATED:103});f.MD_SYNCD_FATAL_ERROR_CODE=a}),66);
__d("WAWebSyncdNetCallbacksApi",["WABase64","WALogger","WAWebDownloadManager","WAWebMmsClientErrors","WAWebSyncdError","WAWebSyncdUploadFatalErrorMetric","WAWebUploadManager","WAWebWamEnumMdSyncdFatalErrorCode","WAWebWamEnumUploadOriginType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h;a=function(a){return c("WAWebUploadManager").encryptAndUpload({blob:a,signal:new AbortController().signal,type:"md-app-state",uploadOrigin:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,userUploadAttemptCount:0,forwardedFromWeb:!1,isViewOnce:!1}).then(function(a){var b=a.mediaKey,e=a.directPath,f=a.encFilehash;a=a.handle;if(a==null)throw c("err")("Missing handle after uploading external patch to mms4");return{mediaKey:d("WABase64").decodeB64(b),directPath:e,encFilehash:d("WABase64").decodeB64(f),handle:a}})};e=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=a.mediaKey,f=a.directPath,g=a.fileSha256,i=a.fileEncSha256;f={directPath:f,encFilehash:d("WABase64").encodeB64(i),filehash:d("WABase64").encodeB64(g),mediaKey:d("WABase64").encodeB64(e),type:"md-app-state",userDownloadAttemptCount:0};try{return yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt(babelHelpers["extends"]({signal:new AbortController().signal},f))}catch(e){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: error downloading "," of expected size "," with expected hash b64 length of "," for collection ",""])),b,a.fileSizeBytes,d("WABase64").encodeB64(a.fileEncSha256).length,c);if(e instanceof d("WAWebMmsClientErrors").MediaNotFoundError){d("WAWebSyncdUploadFatalErrorMetric").uploadFatalErrorMetric(b==="patch"?d("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE.EXTERNAL_PATCH_EXPIRED:d("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE.SNAPSHOT_EXPIRED,c);throw new(d("WAWebSyncdError").SyncdFatalError)("external patch expired")}throw e}});return function(b,c,d){return a.apply(this,arguments)}}();g.uploadSyncExternalPatch=a;g.downloadSyncBlob=e}),98);
__d("WAWebSyncdOrphan",["Promise","WALogger","WASyncdConst","WAWebGetSyncAction","WAWebMiscGatingUtils","WAWebSyncdCollectionHandler","WAWebSyncdDbCallbacksApi","WAWebSyncdDisabled","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s;function a(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(d("WAWebSyncdDisabled").isSyncdDisabled())return(s||(s=b("Promise"))).resolve();yield (s||(s=b("Promise"))).all([u(a),w(c),d("WAWebSyncdDbCallbacksApi").bulkGetAccountLid(c).then(function(a){return y(a.filter(Boolean))})])});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSyncdDbCallbacksApi").getAdditionalLidMsgKeys(a));yield A(a.concat(b),d("WASyncdConst").SyncModelType.Msg)});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield A(a,d("WASyncdConst").SyncModelType.Chat)});return x.apply(this,arguments)}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield A(a,d("WASyncdConst").SyncModelType.Account)});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying orphans of type "," with ids=",""])),c,a);if(d("WAWebSyncdDisabled").isSyncdDisabled())return(s||(s=b("Promise"))).resolve();var e=(yield d("WAWebGetSyncAction").getSyncActionsByModelInfosInTransaction(a.map(function(a){return[a,c,d("WASyncdConst").SyncActionState.Orphan]})));yield d("WAWebSyncdCollectionHandler").applyIndividualMutations(e);d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying orphans of type "," with ids=",""])),c,a)});return B.apply(this,arguments)}function c(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebSyncdDisabled").isSyncdDisabled())return(s||(s=b("Promise"))).resolve();d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyAllOrphansAndUnsupported"])));var a=(yield d("WAWebGetSyncAction").getSyncActionsByActionStatesInTransaction([d("WASyncdConst").SyncActionState.Orphan,d("WASyncdConst").SyncActionState.Unsupported]));yield d("WAWebSyncdCollectionHandler").applyIndividualMutations(a);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: end applyAllOrphansAndUnsupported"])))});return C.apply(this,arguments)}function e(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield A(a,d("WASyncdConst").SyncModelType.Agent)});return D.apply(this,arguments)}function f(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield A(a,d("WASyncdConst").SyncModelType.ChatAssignment)});return E.apply(this,arguments)}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield A(a,d("WASyncdConst").SyncModelType.UserStatusMute)});return G.apply(this,arguments)}function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying all orphans for type ",""])),a);if(d("WAWebSyncdDisabled").isSyncdDisabled())return(s||(s=b("Promise"))).resolve();var e=(yield d("WAWebGetSyncAction").getOrphanSyncActionsByModelTypeInTransaction(a));if(e.length===0){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: no orphans for type "," to apply"])),a);return}if(c!=null&&!c())return;yield d("WAWebSyncdCollectionHandler").applyIndividualMutations(e);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: finished applying all orphans for type ",", count=",""])),a,e.length)});return I.apply(this,arguments)}function J(){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers"])));if(!d("WAWebMiscGatingUtils").isFavoriteStickersEnabled()){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: favorite stickers not enabled in primary device"])));return}yield H(d("WASyncdConst").SyncModelType.FavoriteSticker,function(){var a=d("WAWebMiscGatingUtils").isFavoriteStickerSyncAfterPairingEnabled();d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: favorite sticker sync after pairing enabled: ",""])),a);return a});d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["syncd: checkOrphanFavoriteStickers: finished"])))});return K.apply(this,arguments)}g.checkOrphanMutations=a;g.checkOrphanMessages=u;g.checkOrphanChats=w;g.applyAllOrphansAndUnsupported=c;g.checkOrphanAgents=e;g.checkOrphanChatAssignments=f;g.checkOrphanUserStatusMutes=F;g.checkOrphanFavoriteStickers=J}),98);
__d("WAWebSyncdResponseParser",["WADeprecatedWapParser","WALogger","WASyncdConst","WAWebSyncdDecode","WAWebSyncdError","WAWebSyncdMetricFatalError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p;a=new(c("WADeprecatedWapParser"))("syncResponseParser",function(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: start parsing syncd collections"])));var b=[];a=a.child("sync");a.mapChildrenWithTag("collection",function(a){var c=d("WASyncdConst").CollectionName.cast(a.attrString("name"));if(!c)throw new(d("WAWebSyncdError").SyncdFatalError)("invalid collection name");var e={name:c};e.state=q(a,e.name);a.hasAttr("version")&&(e.version=parseInt(a.attrString("version"),10));a.hasChild("patches")&&(e.patches=a.child("patches").mapChildrenWithTag("patch",function(a){return d("WAWebSyncdDecode").decodeSyncdPatch(c,a.contentBytes())}));a.hasChild("snapshot")&&(e.snapshot=d("WAWebSyncdDecode").decodeExternalBlobReference(c,a.child("snapshot").contentBytes()));b.push(e);e.version==null&&e.patches==null&&e.snapshot==null&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," has no version, patches or snapshot"])),c);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully parsed collection ",""])),c)});return b});function q(a,b){if(a.hasAttr("type")&&a.attrString("type")==="error"){var c=a.child("error"),e=c.attrString("code");c=c.attrString("text");d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server error: ",""])),b,e);switch(e){case"409":return a.hasAttr("has_more_patches")?d("WASyncdConst").CollectionState.ConflictHasMore:d("WASyncdConst").CollectionState.Conflict;case"400":d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_FOR_COLLECTION);d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: collection "," throws ",""])),String(b),c).sendLogs("syncd: fatal error 400: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;case"404":d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_FOR_COLLECTION);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error 404: collection "," throws ",""])),String(b),c).sendLogs("syncd: fatal error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorFatal;default:d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: collection "," throws ",""])),String(b),c).sendLogs("syncd: retryable error: collection "+String(b));return d("WASyncdConst").CollectionState.ErrorRetry}}else if(a.hasAttr("has_more_patches")){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," got server code has_more_patches"])),b);return d("WASyncdConst").CollectionState.SuccessHasMore}else{d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection "," did not get server error"])),b);return d("WASyncdConst").CollectionState.Success}}g.syncResponseParser=a}),98);
__d("WAWebSyncdServerSync",["Promise","WADeprecatedSendIq","WALogger","WASyncdConst","WAWebGetPendingMutation","WAWebRuntimeEnvironmentUtils","WAWebSyncd","WAWebSyncdCollectionHandler","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdRequestBuilder","WAWebSyncdResponseParser","WAWebSyncdWamAppState","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t=5,u=500;function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=Math.random().toString(36).substr(2,5);yield B(a,c+" start serverSync");var e=[];a=[].concat(a);var f=0;while(f<t||a.length>0&&f<u){if(a.length===0)break;var g=(yield w(a,c)),i=g.doneCollections;g=g.refetchCollections;yield (s||(s=b("Promise"))).all(i.map(function(a){return B([a.name],c+" done collection "+a.name+",\n            state: "+a.state)}));a=g;e=e.concat(i);f++;c=Math.random().toString(36).substr(2,5)}a.length>0&&(yield B(a,"error: max iterations"),d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: reached max iterations for collections: ",""])),a).tags("syncd").sendLogs("syncd: max iteration"),e=e.concat(a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a}})));return e});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(a.length===0)return{doneCollections:[],refetchCollections:[]};try{var e=(yield y(a,c)),f=e.collectionDetails,g=e.localCollectionVersions,h=e.collectionsToUpload;h.length>0&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: deferred local mutation upload for ",""])),h);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: local collection versions:"])),c);g.forEach(function(a,b){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["\n\t"," v",""],["\\n\\t"," v",""])),b,a!=null?a:"(undefined)}")});var p=[],q=[];f.forEach(function(a){switch(a.state){case d("WASyncdConst").CollectionState.ErrorRetry:case d("WASyncdConst").CollectionState.ErrorFatal:case d("WASyncdConst").CollectionState.Blocked:q.push(a);return;default:p.push(a)}(a.state===d("WASyncdConst").CollectionState.Conflict||a.state===d("WASyncdConst").CollectionState.ConflictHasMore)&&d("WAWebSyncdWamAppState").incConflict()});d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start apply collections:\n      ",""])),c,p.map(function(a){return a.name}));var r=new(d("WAWebSyncdMetrics").SyncdEventFlow)();e=(yield (s||(s=b("Promise"))).all(p.map(function(a){return d("WAWebSyncdCollectionHandler").applyAppStateSyncResponse(a,c,g.get(a.name),r)})));r.end();d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: end apply collections: ",""])),p.map(function(a){return a.name}));var t=[];yield s.all(e.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.state===d("WASyncdConst").CollectionState.Conflict){var b=(yield d("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a.name)).length>0;b?t.push(a.name):(a.state=d("WASyncdConst").CollectionState.Success,q.push(a))}else a.state===d("WASyncdConst").CollectionState.ConflictHasMore||a.state===d("WASyncdConst").CollectionState.SuccessHasMore||a.state===d("WASyncdConst").CollectionState.Success&&h.some(function(b){return b===a.name})?t.push(a.name):q.push(a)});return function(b){return a.apply(this,arguments)}}()));return{doneCollections:q,refetchCollections:t}}catch(b){if(b instanceof d("WAWebSyncdError").SyncdFatalError){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: syncd global throws ",""])),b.message).sendLogs("syncd: fatal error: syncd global throws "+b.message);yield B(a,c+" moving to fatal state: "+b.name+" "+b.message+" "+b.stack);f=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorFatal,name:a}});return{doneCollections:f,refetchCollections:[]}}d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: retryable error: syncd global throws ",""])),c,b.message).sendLogs("syncd: retryable error: syncd global throws "+b.message);yield B(a,"["+c+"] retryable error: "+b);e=a.map(function(a){return{state:d("WASyncdConst").CollectionState.ErrorRetry,name:a,serverBackoff:b.errorBackoff}});return{doneCollections:e,refetchCollections:[]}}});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield c("WAWebSyncdRequestBuilder")(a,b)),f=e.syncIqNode,g=e.collectionWithPendingMutationsIds,h=e.collectionWithEncryptedMutations,i=e.localCollectionVersions;e=e.collectionsToSkip;d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.REQUEST_BUILT);var j="["+b+"] syncd: before sendIq for collections:\n    "+a.map(function(a){var b;return"\n\t\n          "+a+" v"+((b=i.get(a))!=null?b:"(undefined)")+" "+(((b=(b=g.get(a))==null?void 0:b.length)!=null?b:0)>0&&i.get(a)!=null?" with local changes":"")}).join(",")+"\n\n  in flight: "+Array.from(d("WAWebSyncd").getInFlightCollections()).join(",")+"\n  pending: "+Array.from(d("WAWebSyncd").getPendingCollections()).join(",")+"\n  is worker? "+d("WAWebRuntimeEnvironmentUtils").isWorker().toString()+"\n  ";d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""])),b,j);yield B(a,j);j=(yield d("WADeprecatedSendIq").deprecatedSendIq(f,d("WAWebSyncdResponseParser").syncResponseParser));d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed network operation for collections:\n    ",""])),b,a);d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_RECEIVED);if(j.success){d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.RESPONSE_PARSED_VALID);yield B(a,"["+b+"] after sendIq success");f=j.result;d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: received sync response for collections:\n      ",""])),b,f.map(function(a){var b="\n"+a.name;a.version!=null&&(b+="\n\tupdated to version "+a.version);a.snapshot!=null&&(b+="\n\tcontains snapshot");a.patches!=null&&(b+="\n\tcontains "+a.patches.length+" patches");return b}));f.forEach(function(a){var b=g.get(a.name);b&&(a.syncedPendingMutationsId=b);b=h.get(a.name);b&&(a.syncedEncryptedMutations=b)});return{collectionDetails:f,localCollectionVersions:i,collectionsToUpload:e}}a=j.errorCode;b=j.errorText;f=j.errorBackoff;throw A(a,b,f)});return z.apply(this,arguments)}function A(a,b,c){switch(a){case 400:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_REQUEST_GLOBAL_ERROR);return new(d("WAWebSyncdError").SyncdFatalError)(b);case 404:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_FOUND_GLOBAL_ERROR);return new(d("WAWebSyncdError").SyncdFatalError)(b);case 405:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_BAD_METHOD_GLOBAL_ERROR);return new(d("WAWebSyncdError").SyncdFatalError)(b);case 406:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR);return new(d("WAWebSyncdError").SyncdFatalError)(b);default:return new(d("WAWebSyncdError").SyncdRetryableError)(b,c)}}function B(a,c){return(s||(s=b("Promise"))).all(a.map(function(a){return d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,c)}))}g.serverSync=a}),98);
__d("WAWebArchiveChatSync",["Promise","WALogger","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAction","WASyncdConst","WAWebApiActiveMessageRanges","WAWebChatDbUpdatesApi","WAWebMessageRangeUtils","WAWebPinChatSync","WAWebSchemaChat","WAWebSettingsGetters","WAWebSettingsModel","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;function u(a,b){switch(b){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return{actionState:d("WASyncdConst").SyncActionState.Success};case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelType:d("WASyncdConst").SyncModelType.Chat,modelId:a.toString()}}}}a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 3};f.getAction=function(){return d("WASyncdConst").Actions.Archive};f.validateSyncActionValue=function(a){a=a.archiveChatAction;var b=a==null?void 0:a.archived;a=a==null?void 0:a.messageRange;return!d("WAWebMessageRangeUtils").validateMessageRange(a)||b==null||a==null?null:{archived:b,messageRange:a}};f.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this,f=[];a=(yield (t||(t=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b=a.indexParts;a=a.value;b=b[1];b||d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(!c("WAWebWid").isWid(b)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}b=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(b)));if(!b.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:b.orphanModel};b=b.chat.id;var g=e.validateSyncActionValue(a);if(g==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}var j=g.archived;g=g.messageRange;b=d("WAWebWidFactory").createWid(b);yield e.$ArchiveChatSync$p_1(b,"before apply");j=(yield e.$ArchiveChatSync$p_2(b,j,g,a));j.updates&&(f.push(j.updates),yield e.$ArchiveChatSync$p_1(b,"after push"));return j.syncApplyActionResult}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: REMOVE operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}())));f.length>0&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before archive use case will update chat table"]))),yield d("WAWebChatDbUpdatesApi").setArchive(f),d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after archive use case updated chat table"]))));return a});function e(b){return a.apply(this,arguments)}return e}();f.$ArchiveChatSync$p_1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{if(!a.isRegularUser())return;var c=(yield d("WAWebSchemaChat").getChatTable().get(a.toString()));c==null&&d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: chat expected to exist ",". context: ",""])),a.toLogString(),b);(c==null?void 0:c.accountLid)==null&&d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: chat expected to have accountLid ",". ",""])),a.toLogString(),b)}catch(a){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: error validating chat exists ",""])),a)}});function c(b,c){return a.apply(this,arguments)}return c}();f.$ArchiveChatSync$p_2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("archive"));if(!b){d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: archive-",", chatId-",""])),b,a.toString());return{updates:{id:a.toString(),archive:b},syncApplyActionResult:{actionState:d("WASyncdConst").SyncActionState.Success}}}var g=(yield d("WAWebMessageRangeUtils").constructMessageRange(a,{forOutgoingMutation:!1}));g=d("WAWebMessageRangeUtils").compareMessageRanges(g,e);var h=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,f).readBuffer();e=function(){return d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("archive"),h)};f=d("WAWebSettingsGetters").getShowArchiveV2(c("WAWebSettingsModel"));d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: shouldKeepChatsArchived-",""])),f);d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[syncd][archive-chat]: archive-",", rangeEnclosedType-",", chatId-",""])),b,g,a.toLogString());switch(g){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:yield e();return{updates:{id:a.toString(),archive:b},syncApplyActionResult:u(a,g)};case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:if(f)return{updates:{id:a.toString(),archive:b},syncApplyActionResult:u(a,g)};yield e();return{updates:void 0,syncApplyActionResult:u(a,g)}}});function e(b,c,d,e){return a.apply(this,arguments)}return e}();f.getArchiveChatMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(c));b={archiveChatAction:{archived:b,messageRange:yield d("WAWebMessageRangeUtils").constructMessageRange(c,{forOutgoingMutation:!0,mutationIndexJid:e})}};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularLow,indexArgs:[e],value:b,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:a,action:this.getAction()})});function c(b,c,d){return a.apply(this,arguments)}return c}();f.getMutationsForArchive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=[this.getArchiveChatMutation(a,c,e)];c&&f.push(d("WAWebPinChatSync").PinChatSync.getPinMutation(a,!1,e));return(t||(t=b("Promise"))).all(f)});function c(b,c,d){return a.apply(this,arguments)}return c}();f.resolveConflicts=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction),g=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,h=a.timestamp;e=e.timestamp;f=c("WANullthrows")(f.archiveChatAction);var i=c("WANullthrows")(g==null?void 0:g.archiveChatAction),j=d("WAWebMessageRangeUtils").compareMessageRanges(c("WANullthrows")(i.messageRange),c("WANullthrows")(f.messageRange));switch(j){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return h<=e?d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:var k=h<=e?(j=i.archived)!=null?j:!1:(h=f.archived)!=null?h:!1;e=d("WAWebMessageRangeUtils").mergeMessageRanges(c("WANullthrows")(i.messageRange),c("WANullthrows")(f.messageRange));j={archived:k,messageRange:e};var l=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},g,{archiveChatAction:j})).readBuffer();h=babelHelpers["extends"]({},a,{binarySyncAction:l});delete h.id;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["chat"],[h],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=JSON.parse(a.index);b=d("WAWebWidFactory").createWid(b[1]);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"])));yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(b.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("archive"),l);b=(yield d("WAWebChatDbUpdatesApi").setArchive([{id:b.toString(),archive:k}]));d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"])));return b}));return d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}});function e(b,c){return a.apply(this,arguments)}return e}();return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebBotWelcomeRequestSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebChatCollection","WAWebDBUpdateChatTable","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getVersion=function(){return 2};e.getAction=function(){return d("WASyncdConst").Actions.BotWelcomeRequest};e.applyMutations=function(a){return(l||(l=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{switch(a.operation){case"set":var b=a.indexParts;a=a.value;b=b[1];b||d("WAWebSyncdIndexUtils").throwInvalidActionIndex();a=(a=a.botWelcomeRequestAction)==null?void 0:a.isSent;if(a==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync]: malformed mutation. isSent is not of boolean type"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}b=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(b)));if(!b.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:b.orphanModel};b=d("WAWebWidFactory").createWid(b.chat.id);yield d("WAWebDBUpdateChatTable").updateChatTable(b,{hasRequestedWelcomeMsg:a});var c=d("WAWebChatCollection").ChatCollection.get(b);c!=null&&(c.hasRequestedWelcomeMsg=a);d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync]: set bot welcome request to "," for ",""])),a,b);return{actionState:d("WASyncdConst").SyncActionState.Success};default:d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync] operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};e.getBotWelcomeRequestSetMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={botWelcomeRequestAction:{isSent:b}};c=d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularLow,indexArgs:[yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(a)],value:c,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:d("WATimeUtils").unixTime(),action:this.getAction()});d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[BotWelcomeRequestSync] mutation generated, set bot welcome request to "," for ",""])),b,a).devConsole(c);return c});function c(b,c){return a.apply(this,arguments)}return c}();return c}(d("WASyncdAction").SyncActionBase);c=new a();g["default"]=c}),98);
__d("WAWebChatAssignmentOpenedStatusSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebBizChatAssignmentOpenedAction","WAWebChatAssignmentCollection","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getVersion=function(){return d("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION};e.getAction=function(){return d("WASyncdConst").Actions.ChatAssignmentOpenedStatus};e.createChatOpenedMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WATimeUtils").unixTimeMs();a=(yield (k||(k=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId,e=a.agentId;a=a.chatOpenedByAgent;a={chatAssignmentOpenedStatus:{chatOpened:a}};return d("WAWebSyncdActionUtils").buildPendingMutation({timestamp:c,collection:d("WASyncdConst").CollectionName.Regular,operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(d("WAWebWidFactory").createWid(b)),e],value:a,action:d("WASyncdConst").Actions.ChatAssignmentOpenedStatus,version:d("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION})});return function(b){return a.apply(this,arguments)}}())));return a});function c(b){return a.apply(this,arguments)}return c}();e.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a=(yield (k||(k=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=a.indexParts,e=b[1];b=b[2];(e==null||b==null)&&d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(a.operation==="set"){e=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(e)));if(!e.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:e.orphanModel};e=d("WAWebWidFactory").createWid(e.chat.id);a=a.value.chatAssignmentOpenedStatus;if(!a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}a=a.chatOpened;if(a==null){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}var f=e.toJid()+"_"+b,g=d("WAWebChatAssignmentCollection").ChatAssignmentCollection.get(f);if(g==null)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:f,modelType:d("WASyncdConst").SyncModelType.ChatAssignment}};c.push({id:f,chatId:e.toJid(),agentId:b,chatOpenedByAgent:a});return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_opened_status:syncd: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}())));yield d("WAWebBizChatAssignmentOpenedAction").updateLocalOpenedState(c);return a});function c(b){return a.apply(this,arguments)}return c}();return c}(d("WASyncdAction").SyncActionBase);c=new a();g["default"]=c}),98);
__d("WAWebChatAssignmentSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebAgentCollection","WAWebBizChatAssignmentAction","WAWebChatAssignmentCollection","WAWebSchemaChatAssignment","WAWebSyncBootstrap","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdOrphan","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return d("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION};f.getAction=function(){return d("WASyncdConst").Actions.ChatAssignment};f.createChatAssignmentMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WATimeUtils").unixTimeMs();a=(yield (j||(j=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId;a=a.agentId;a={chatAssignment:{deviceAgentID:a}};return d("WAWebSyncdActionUtils").buildPendingMutation({timestamp:c,collection:d("WASyncdConst").CollectionName.Regular,operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,indexArgs:[yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(d("WAWebWidFactory").createWid(b))],value:a,action:d("WASyncdConst").Actions.ChatAssignment,version:d("WASyncdConst").CHAT_ASSIGNMENT_SYNC_VERSION})});return function(b){return a.apply(this,arguments)}}())));return a});function c(b){return a.apply(this,arguments)}return c}();f.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[],g=[],k=(yield (j||(j=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=a.indexParts;b=b[1];b||d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(a.operation==="set"){var j=a.value.chatAssignment;if(!j){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment:syncd: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}var k=(j=j.deviceAgentID)!=null?j:"";j=d("WAWebAgentCollection").AgentCollection.get(k);if(k!==""&&j==null)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:k,modelType:d("WASyncdConst").SyncModelType.Agent}};b=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(b)));if(!b.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:b.orphanModel};var l=d("WAWebWidFactory").createWid(b.chat.id);d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(l).filter(function(a){return a.id!==k}).forEach(function(a){return f.push(l.toJid()+"_"+a.id)});k!==""&&e.push({id:l.toJid()+"_"+k,chatId:l.toJid(),agentId:k,chatOpenedByAgent:!1});c("WAWebSyncBootstrap").isSyncDBootstrapInProcess()||g.push({chatId:l,agent:j,timestamp:Math.floor(a.timestamp/1e3)});return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment:syncd: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}())));yield d("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkCreateOrMerge(e);d("WAWebChatAssignmentCollection").ChatAssignmentCollection.processChatAssignments(e);yield d("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkRemove(f);d("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(f);d("WAWebBizChatAssignmentAction").createChatAssignmentSystemMsgs(g);d("WAWebBizChatAssignmentAction").triggerChatAssignmentNotification(e,a.map(function(a){return a.timestamp}).join("-"));a=e.map(function(a){return a.id.toString()});d("WAWebSyncdOrphan").checkOrphanChatAssignments(a);return k});function e(b){return a.apply(this,arguments)}return e}();return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebWamEnumMdFeatureCode",[],(function(a,b,c,d,e,f){a=Object.freeze({PIN_MUTATION:1,UNPIN_4TH_CHAT_MUTATION:2,DELETE_MUTATION:3,CLEAR_CHAT_REMOVE_STARRED_MUTATION:4,CLEAR_CHAT_KEEP_STARRED_MUTATION:5});f.MD_FEATURE_CODE=a}),66);
__d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMdFeatureCode"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdSyncdDogfoodingFeatureUsage:[3016,{mdSyncdDogfoodingFeature:[1,d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE]},[1,1,1],"regular"]},{MdSyncdDogfoodingFeatureUsage:[]});g.MdSyncdDogfoodingFeatureUsageWamEvent=a}),98);
__d("WAWebClearChatSync",["Promise","WALogger","WALongInt","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAction","WASyncdConst","WAWebAndroidUnsupportedActionsSync","WAWebApiActiveMessageRanges","WAWebBackendApi","WAWebChatCollection","WAWebDBMessageRange","WAWebDBQueryAndRemoveMessageHistory","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebMessageRangeUtils","WAWebMsgKey","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebStatusCollection","WAWebSyncdActionUtils","WAWebSyncdDb","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebWamEnumMdFeatureCode","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 6};f.getAction=function(){return d("WASyncdConst").Actions.ClearChat};f.$ClearChatSync$p_1=function(a,b,e,f){var g=new Set();a.forEach(function(a){if(a.actionName===d("WASyncdConst").Actions.Star&&a.timestamp>b){a=d("WAWebSyncdIndexUtils").getMsgKeyFromStarActionIndex(a.index);g.add(a.toString());f!=null&&a.remote.equals(f)&&g.add(new(c("WAWebMsgKey"))({fromMe:a.fromMe,id:a.id,remote:e}).toString())}});return g};f.validateSyncActionValue=function(a){a=a.clearChatAction;return d("WAWebMessageRangeUtils").validateMessageRange(a==null?void 0:a.messageRange)};f.applyMutations=function(a,e){var f=this;c("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("other mutation");var g=e.allSupportedSetMutations;return(o||(o=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b,e=a.indexParts,j=a.value,k=e[1],l=e[2];e=e[3];(!k||!l||!e)&&d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(!c("WAWebWid").isWid(k)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}if(!f.validateSyncActionValue(j)){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd][clear-chat]: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}k=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(k)));if(!k.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:k.orphanModel};var m=d("WAWebWidFactory").createWid(k.chat.id);b=d("WAWebMessageRangeUtils").replaceMessageRangeRemoteJid(m,c("WANullthrows")((b=j.clearChatAction)==null?void 0:b.messageRange));a=f.$ClearChatSync$p_1(g,a.timestamp,m,k.chat.accountLid==null?null:d("WAWebWidFactory").createWid(k.chat.accountLid));return f.$ClearChatSync$p_2(d("WAWebWidFactory").createWid(k.chat.id),b,l==="1",e==="0",a,j)}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[syncd][clear-chat]: REMOVE operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};f.clearChat=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){c=(yield d("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessagesInMessageRange(a,b,{skipStarred:!c,skipMessages:e}));c.length>0&&(d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:c}),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.toString(),c)));e=d("WAWebChatCollection").ChatCollection.get(a);e&&e.deleteMessages(c);this.maybeClearGroupStatus(a,b)});function c(b,c,d,e){return a.apply(this,arguments)}return c}();f.$ClearChatSync$p_2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){g=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,g).readBuffer();d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[syncd][clear-chat]: chatId-",""])),a.toString());yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("clearChat",{deleteMedia:e,deleteStarred:c}),g);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before use case will update chat table"])));yield this.clearChat(a,b,c,f);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after use case updated chat table"])));return{actionState:d("WASyncdConst").SyncActionState.Success}});function c(b,c,d,e,f,g){return a.apply(this,arguments)}return c}();f.getClearChatMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){g===void 0&&(g=!1);c("gkx")("26258")||new(d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent").MdSyncdDogfoodingFeatureUsageWamEvent)({mdSyncdDogfoodingFeature:e?d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.CLEAR_CHAT_REMOVE_STARRED_MUTATION:d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.CLEAR_CHAT_KEEP_STARRED_MUTATION}).commit();g=g?b.toString():yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(b);b=(yield d("WAWebMessageRangeUtils").constructForwardMovingMessageRange(b,g));g=this.$ClearChatSync$p_3(d("WAWebWidFactory").createWid(g),e,f||!1);e=(yield d("WAWebSyncdDb").getPendingMutationsRowsByIndex(["index"],d("WAWebSyncdActionUtils").buildIndex(this.getAction(),g)));if(e.length){f=e.reduce(function(a,b){return a.timestamp>b.timestamp?a:b});e=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,f.binarySyncAction);e=(f=e.clearChatAction)==null?void 0:f.messageRange;e&&(b=d("WAWebMessageRangeUtils").mergeMessageRanges(b,e),d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(b.lastMessageTimestamp,"pendingMutationRange"))}f={clearChatAction:{messageRange:b}};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularHigh,indexArgs:g,value:f,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:a,action:this.getAction()})});function e(b,c,d,e,f){return a.apply(this,arguments)}return e}();f.$ClearChatSync$p_3=function(a,b,c){return[a.toJid(),b?"1":"0",c?"1":"0"]};f.resolveConflicts=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this,g=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction),h=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,i=a.timestamp;e=e.timestamp;g=c("WANullthrows")(g.clearChatAction);var j=c("WANullthrows")(h==null?void 0:h.clearChatAction),k=d("WAWebMessageRangeUtils").compareMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));switch(k){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return i<=e?d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:var l=d("WAWebMessageRangeUtils").mergeMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));k={messageRange:l};var o=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},h,{clearChatAction:k})).readBuffer();i=babelHelpers["extends"]({},a,{binarySyncAction:o});delete i.id;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["message-association","chat"],[i],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=JSON.parse(a.index),c=d("WAWebWidFactory").createWid(b[1]),e=b[2]==="1";b=b[3]==="1";d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"])));yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(c.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("clearChat",{deleteStarred:e,deleteMedia:b}),o);b=f.clearChat(c,l,e);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"])));return b}));return d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}});function e(b,c){return a.apply(this,arguments)}return e}();f.maybeClearGroupStatus=function(a,b){if(a.isGroup()){var c;c=(c=d("WAWebStatusCollection").StatusCollection.get(a))==null?void 0:c.getAllMsgs();var e=c==null?void 0:c.filter(function(a){return b.lastMessageTimestamp==null||a.t<d("WALongInt").numberOrThrowIfTooLarge(b.lastMessageTimestamp)});e&&(e==null?void 0:e.length)>0&&(e==null||e.forEach(function(a){return a["delete"]()}),e.length===(c==null?void 0:c.length)&&d("WAWebStatusCollection").StatusCollection.remove(a))}};return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebDeleteChatSync",["Promise","WALogger","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAction","WASyncdConst","WAWebAndroidUnsupportedActionsSync","WAWebApiActiveMessageRanges","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebChatCollection","WAWebChatDeleteBridge","WAWebDBMessageRange","WAWebDBQueryAndRemoveMessageHistory","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebMessageRangeUtils","WAWebNonMessageDataRequestHistorySyncOnDemandUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebSyncdActionUtils","WAWebSyncdDb","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebWamEnumMdFeatureCode","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 6};f.getAction=function(){return d("WASyncdConst").Actions.DeleteChat};f.validateSyncActionValue=function(a){a=a.deleteChatAction;return d("WAWebMessageRangeUtils").validateMessageRange(a==null?void 0:a.messageRange)};f.applyMutations=function(a){var e=this;c("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("other mutation");return(o||(o=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b,f=a.indexParts;a=a.value;var g=f[1];f=f[2];(!g||!f)&&d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(!c("WAWebWid").isWid(g)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}if(!e.validateSyncActionValue(a)){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}g=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(g)));if(!g.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:g.orphanModel};g=d("WAWebWidFactory").createWid(g.chat.id);b=d("WAWebMessageRangeUtils").replaceMessageRangeRemoteJid(g,c("WANullthrows")((b=a.deleteChatAction)==null?void 0:b.messageRange));return e.$DeleteChatSync$p_1(g,b,f==="0",a)}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: REMOVE operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};f.deleteChat=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(d("WAWebBizCoexUtils").deleteChatFromFallbackHostedAdvSystemMsgOnPlaceholderCache(a),d("WAWebBizCoexUtils").clearDedupInitialHostedSystemMsgCache());var c=d("WAWebChatCollection").ChatCollection.get(a);if(b){b=(yield d("WAWebDBQueryAndRemoveMessageHistory").queryAndRemoveMessagesInMessageRange(a,b,{forceDeleteAllMessagesExceptInitialEncryption:!0}));b.length>0&&(d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:b}),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.toString(),b)));c&&c.deleteMessages(b)}else d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before use case will update chat table ",""])),a.toLogString()),yield d("WAWebChatDeleteBridge").deleteFromStorage(a),d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after use case updated chat table ",""])),a.toLogString()),c&&c["delete"]();d("WAWebNonMessageDataRequestHistorySyncOnDemandUtils").deleteChatFromInitialSyncBoundary(a)});function c(b,c){return a.apply(this,arguments)}return c}();f.$DeleteChatSync$p_1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,e).readBuffer();yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:c}),e);c=(yield d("WAWebMessageRangeUtils").constructMessageRange(a,{forOutgoingMutation:!1}));e=d("WAWebMessageRangeUtils").compareMessageRanges(c,b);d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[syncd][delete-chat]: rangeEnclosedType-"," chatId-",""])),e,a.toString());switch(e){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:yield this.deleteChat(a,b);break;default:yield this.deleteChat(a);break}return{actionState:d("WASyncdConst").SyncActionState.Success}});function c(b,c,d,e){return a.apply(this,arguments)}return c}();f.getDeleteChatMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){c("gkx")("26258")||new(d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent").MdSyncdDogfoodingFeatureUsageWamEvent)({mdSyncdDogfoodingFeature:d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.DELETE_MUTATION}).commit();var f=(yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(b)),g=d("WAWebWidFactory").createWid(f);b=(yield d("WAWebMessageRangeUtils").constructForwardMovingMessageRange(b,f));f=d("WAWebSyncdActionUtils").buildIndex(this.getAction(),this.buildDeleteChatIndexArgs(d("WAWebWidFactory").createWid(f),e||!1));f=(yield d("WAWebSyncdDb").getPendingMutationsRowsByIndex(["index"],f));if(f.length){f=f.reduce(function(a,b){return a.timestamp>b.timestamp?a:b});f=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,f.binarySyncAction);f=(f=f.deleteChatAction)==null?void 0:f.messageRange;f&&(b=d("WAWebMessageRangeUtils").mergeMessageRanges(b,f),d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(b.lastMessageTimestamp,"pendingMutationRange"))}return this.buildDeleteChatMutation({timestamp:a,indexWid:g,mergedRange:b,deleteMediaFiles:e||!1})});function e(b,c,d){return a.apply(this,arguments)}return e}();f.resolveConflicts=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this,g=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction),h=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,i=a.timestamp;e=e.timestamp;g=c("WANullthrows")(g.deleteChatAction);var j=c("WANullthrows")(h==null?void 0:h.deleteChatAction),k=d("WAWebMessageRangeUtils").compareMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));switch(k){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return i<=e?d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:var l=d("WAWebMessageRangeUtils").mergeMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));k={messageRange:l};var o=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},h,{deleteChatAction:k})).readBuffer();i=babelHelpers["extends"]({},a,{binarySyncAction:o});delete i.id;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["message-association","chat"],[i],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=JSON.parse(a.index),c=d("WAWebWidFactory").createWid(b[1]);d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"])));yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(c.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("deleteChat",{deleteMedia:b[2]==="1"}),o);b=(yield f.deleteChat(c,l));d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"])));return b}));return d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}});function e(b,c){return a.apply(this,arguments)}return e}();f.buildDeleteChatMutation=function(a){var b=a.timestamp,c=a.indexWid,e=a.mergedRange;a=a.deleteMediaFiles;e={deleteChatAction:{messageRange:e}};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularHigh,indexArgs:this.buildDeleteChatIndexArgs(c,a),value:e,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:b,action:this.getAction()})};f.buildDeleteChatIndexArgs=function(a,b){return[a.toJid(),b?"1":"0"]};return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebUserPrefsFavoritesLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").UserPrefs.FavoritesLidTableMigrationComplete,!0)}function b(){return c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").UserPrefs.FavoritesLidTableMigrationComplete)===!0}g.setFavoritesMigrationAsComplete=a;g.isFavoritesMigrationComplete=b}),98);
__d("WAWebDBFavoriteDatabaseApi",["WAWebLidMigrationDbUtils","WAWebSchemaFavorite","WAWebUserPrefsFavoritesLidMigration","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?yield p(a):a;yield d("WAWebSchemaFavorite").getFavoriteTable().bulkCreateOrReplace(a)});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?yield p(a):a;yield d("WAWebSchemaFavorite").getFavoriteTable().clear();yield d("WAWebSchemaFavorite").getFavoriteTable().bulkCreateOrReplace(a)});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?[].concat(yield n(a),a):a;yield d("WAWebSchemaFavorite").getFavoriteTable().bulkRemove(a)});return j.apply(this,arguments)}function f(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaFavorite").getFavoriteTable().all());if(a.length===0)return 0;a=Math.max.apply(Math,a.map(function(a){a=a.orderIndex;return a}));return a+1});return k.apply(this,arguments)}function l(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaFavorite").getFavoriteTable().all());return d("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()?r(a):a});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLidMigrationDbUtils").findAccountLidsForPnChatIds(a));return a.map(function(a){var c;return(c=b.get(a))!=null?c:a})});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLidMigrationDbUtils").findAccountLidsForPnChatIds(a.map(function(a){return a.id})));return a.map(function(a){var c;return babelHelpers["extends"]({},a,{id:(c=b.get(a.id))!=null?c:a.id})})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLidMigrationDbUtils").findChatIdsForAccountLids(a.map(function(a){return a.id})));return a.map(function(a){var c;return babelHelpers["extends"]({},a,{id:(c=b.get(a.id))!=null?c:a.id})})});return s.apply(this,arguments)}g.addOrEditFavorites=a;g.setFavorites=c;g.removeFavorites=e;g.getNextFavoriteOrderIndex=f;g.getAllFavorites=l}),98);
__d("WAWebFavoritesSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdConst","WAWebApiContact","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebLid1X1MigrationGating","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=null,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getVersion=function(){return 1};e.getAction=function(){return d("WASyncdConst").Actions.Favorites};e.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c,e;a=a.map(function(a){var b;if(a.operation!=="set"){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["favorites sync: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}if(((b=a.value.favoritesAction)==null?void 0:b.favorites)==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["favorites sync: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}(e==null||a.timestamp>e.timestamp)&&(e=a);return{actionState:d("WASyncdConst").SyncActionState.Success}});c=(c=e)==null||(c=c.value.favoritesAction)==null?void 0:c.favorites;if(c!=null){var f=0;c=c.reduce(function(a,b){b=b.id;b!=null&&a.push({id:b,orderIndex:f++});return a},[]);var g=0;c=(yield (k||(k=b("Promise"))).all(c.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(a.id)));if(b.success===!0){g++;return{orderIndex:a.orderIndex,id:b.chat.id}}b.success;b=d("WAWebWidFactory").createWid(a.id);if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&b.isLid()){b=d("WAWebApiContact").getPhoneNumber(b);if(b!=null)return{orderIndex:a.orderIndex,id:b.toString()}}return{orderIndex:a.orderIndex,id:a.id}});return function(b){return a.apply(this,arguments)}}())));yield d("WAWebDBFavoriteDatabaseApi").setFavorites(c);d("WAWebFavoriteCollection").FavoriteCollection.set(c.map(function(a){return{id:a.id,orderIndex:a.orderIndex}}));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Favorites sync: successfully set favorites. Resolved chats: "," of total ",""])),g,c.length).devConsole(c)}return a});function c(b){return a.apply(this,arguments)}return c}();e.getFavoritesMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=a.map(function(a){return{orderIndex:a.orderIndex,wid:d("WAWebWidFactory").createWid(a.id)}});a=(yield (k||(k=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return babelHelpers["extends"]({},a,{mutationIndex:yield d("WAWebSyncdGetChat").getWidMutationIndexForWid(a.wid)})});return function(b){return a.apply(this,arguments)}}())));return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularHigh,indexArgs:[],operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:this.getVersion(),timestamp:c,action:this.getAction(),value:{favoritesAction:{favorites:a.sort(function(a,b){return a.orderIndex-b.orderIndex}).map(function(a){a=a.mutationIndex;return{id:a}})}}})});function c(b,c){return a.apply(this,arguments)}return c}();return c}(d("WASyncdAction").SyncActionBase);c=new a();g["default"]=c}),98);
__d("WAWebMarkChatAsReadSync",["Promise","WALogger","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAction","WASyncdConst","WAWebApiActiveMessageRanges","WAWebChatGetExistingBridge","WAWebConstantsDeprecated","WAWebMessageRangeUtils","WAWebSchemaChat","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebUpdateUnreadChatAction","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;function q(a,b){switch(b){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return{actionState:d("WASyncdConst").SyncActionState.Success};case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelType:d("WASyncdConst").SyncModelType.Chat,modelId:a.toString()}}}}a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 3};f.getAction=function(){return d("WASyncdConst").Actions.MarkChatAsRead};f.$MarkChatAsReadSync$p_1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebChatGetExistingBridge").getExisting(a));a&&(b?d("WAWebUpdateUnreadChatAction").markSeen(a):d("WAWebUpdateUnreadChatAction").markUnseen(a))});function c(b,c){return a.apply(this,arguments)}return c}();f.$MarkChatAsReadSync$p_2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));return(a==null?void 0:a.unreadCount)===c("WAWebConstantsDeprecated").MARKED_AS_UNREAD});function e(b){return a.apply(this,arguments)}return e}();f.validateSyncActionValue=function(a){a=a.markChatAsReadAction;var b=a==null?void 0:a.read;return b!=null&&d("WAWebMessageRangeUtils").validateMessageRange(a==null?void 0:a.messageRange)};f.applyMutations=function(a){var e=this;return(p||(p=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b,f,g=a.indexParts;a=a.value;g=g[1];g||d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(!e.validateSyncActionValue(a)){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}if(!c("WAWebWid").isWid(g)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}b=c("WANullthrows")((b=a.markChatAsReadAction)==null?void 0:b.read);f=c("WANullthrows")((f=a.markChatAsReadAction)==null?void 0:f.messageRange);g=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(g)));return!g.success?{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:g.orphanModel}:e.$MarkChatAsReadSync$p_3(d("WAWebWidFactory").createWid(g.chat.id),b,f,a)}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};f.$MarkChatAsReadSync$p_3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"));var g=(yield d("WAWebMessageRangeUtils").constructMessageRange(a,{forOutgoingMutation:!1}));g=d("WAWebMessageRangeUtils").compareMessageRanges(g,e);var h=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,f).readBuffer();e=function(){return d("WAWebApiActiveMessageRanges").addActiveMessageRange(a.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"),h)};d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before use case will update chat table"])));d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: read-",", rangeEnclosedType-",", chatId-",""])),c,g,a.toString());switch(g){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:yield e();yield this.$MarkChatAsReadSync$p_1(a,c);return(p||(p=b("Promise"))).resolve(q(a,g));case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:c&&(yield this.$MarkChatAsReadSync$p_2(a))&&(d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[syncd][mark-chat-as-read]: isChatMarkedUnreadByUser-true"]))),yield this.$MarkChatAsReadSync$p_1(a,c));return(p||(p=b("Promise"))).resolve(q(a,g))}d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after use case updated chat table"])))});function c(b,c,d,e){return a.apply(this,arguments)}return c}();f.getMarkChatAsReadMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(c));b={markChatAsReadAction:{read:b,messageRange:yield d("WAWebMessageRangeUtils").constructMessageRange(c,{forOutgoingMutation:!0,mutationIndexJid:e})}};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularLow,indexArgs:[e],value:b,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:a,action:this.getAction()})});function c(b,c,d){return a.apply(this,arguments)}return c}();f.resolveConflicts=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this,g=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction),h=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,e.binarySyncData).value,i=a.timestamp;e=e.timestamp;g=c("WANullthrows")(g.markChatAsReadAction);var j=c("WANullthrows")(h==null?void 0:h.markChatAsReadAction),k=d("WAWebMessageRangeUtils").compareMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));switch(k){case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeAEnclosesRangeB:return d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangeBEnclosesRangeA:return d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesAreEqual:return i<=e?d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:d("WASyncdConst").ConflictResolutionState.SkipRemote;case d("WAWebMessageRangeUtils").MessageRangeEncloseType.RangesNotEnclosing:var l=i<=e?(k=j.read)!=null?k:!1:(i=g.read)!=null?i:!1;e=d("WAWebMessageRangeUtils").mergeMessageRanges(c("WANullthrows")(j.messageRange),c("WANullthrows")(g.messageRange));k={read:l,messageRange:e};var m=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},h,{markChatAsReadAction:k})).readBuffer();i=babelHelpers["extends"]({},a,{binarySyncAction:m});delete i.id;yield d("WAWebMessageRangeUtils").lockForMessageRangeSync(["chat"],[i],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=JSON.parse(a.index);b=d("WAWebWidFactory").createWid(b[1]);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[syncd] before update chat table due to conflict"])));yield d("WAWebApiActiveMessageRanges").addActiveMessageRange(b.toString(),d("WAWebApiActiveMessageRanges").getActiveRangeAction("markChatAsRead"),m);b=(yield f.$MarkChatAsReadSync$p_1(b,l));d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[syncd] after update chat table due to conflict"])));return b}));return d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal}});function e(b,c){return a.apply(this,arguments)}return e}();return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebMessageRangeUtils",["$InternalEnum","WALogger","WALongInt","WASyncAction.pb","WASyncdConst","WAWebApiActiveMessageRanges","WAWebDBMessageRange","WAWebSchemaActiveMessageRanges","WAWebSyncdCoreApi","WAWebSyncdDb","WAWebSyncdUtils","WAWebTimestampConversionUtils","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=b("$InternalEnum").Mirrored(["RangeAEnclosesRangeB","RangeBEnclosesRangeA","RangesAreEqual","RangesNotEnclosing"]);function p(a,b){var c=new Set(a.messages.map(function(a){return(a=a.key)==null?void 0:a.id}));for(var e=0;e<b.messages.length;e++)if(b.messages[e].timestamp==null){var f;if(!c.has((f=b.messages[e].key)==null?void 0:f.id))return!1}for(f=0;f<b.messages.length;f++){if(!c.has((e=b.messages[f].key)==null?void 0:e.id)&&d("WALongInt").numberOrThrowIfTooLarge((e=a.lastMessageTimestamp)!=null?e:0)<=d("WALongInt").numberOrThrowIfTooLarge((e=b.messages[f].timestamp)!=null?e:0))return!1}return!0}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c,e=(yield (c=d("WAWebDBMessageRange")).getLastMessageTimestamp(a));c.logMaybeMillisecondTimestamp(e,"getLastMessageTimestamp");var f=(yield c.getLastSystemMessageTimestamp(a));c.logMaybeMillisecondTimestamp(f,"lastSystemMessageTimestamp");c=(yield c.getAdditionalMessages(a,e));var g=c.messages;c=c.newLastMessageTimestamp;c!=null&&(e=c,d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(c,"newLastMessageTimestamp"));if(e==null){c=g.sort(d("WAWebDBMessageRange").timestampComparison);c=(c=c[g.length-1])==null?void 0:c.timestamp;e=c!=null?d("WALongInt").numberOrThrowIfTooLarge(c):null;d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(e,"sorting")}c={messages:g};e!=null&&(c.lastMessageTimestamp=e);f!=null&&((e==null||f>d("WALongInt").numberOrThrowIfTooLarge(e))&&(c.lastSystemMessageTimestamp=f,d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(c.lastSystemMessageTimestamp,"lastSystemMessageTimestamp")));if(b.forOutgoingMutation&&c.lastMessageTimestamp==null){g=(yield d("WAWebDBMessageRange").getFirstSystemMessageTimestamp(a));g!=null&&(c.lastMessageTimestamp=g,d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(c.lastMessageTimestamp,"firstSystemMessageTimestamp"),g===f&&(c.lastSystemMessageTimestamp=void 0))}d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: constructing current message range for ","\n      ",""])),a.toString({legacy:!0}),JSON.stringify(c,null,2));if(b.forOutgoingMutation&&b.mutationIndexJid!=null)for(e of c.messages){((g=e.key)==null?void 0:g.remoteJid)!=null&&(e.key.remoteJid=b.mutationIndexJid)}return c});return r.apply(this,arguments)}function a(a,b){var c=p(a,b);b=p(b,a);if(c&&b)return o.RangesAreEqual;else if(c)return o.RangeAEnclosesRangeB;else if(b)return o.RangeBEnclosesRangeA;return o.RangesNotEnclosing}function s(a,b,c){var e=new Map();a=a.concat(b);a.forEach(function(a){var b,f;b=(b=(b=a.key)==null?void 0:b.id)!=null?b:"";if(d("WALongInt").numberOrThrowIfTooLarge((f=a.timestamp)!=null?f:0)>=c){f=e.get(b);if(f){var g;e.set(b,d("WALongInt").numberOrThrowIfTooLarge((g=f.timestamp)!=null?g:0)<d("WALongInt").numberOrThrowIfTooLarge((g=a.timestamp)!=null?g:0)?a:f)}else e.set(b,a)}});return Array.from(e.values())}function t(a,b){var c,e;c=d("WALongInt").numberOrThrowIfTooLarge((c=a.lastMessageTimestamp)!=null?c:0);e=d("WALongInt").numberOrThrowIfTooLarge((e=b.lastMessageTimestamp)!=null?e:0);c=Math.max(c,e);e=s(a.messages,b.messages,c);e={messages:e};c!==0&&(e.lastMessageTimestamp=c);if(a.lastSystemMessageTimestamp!=null||b.lastSystemMessageTimestamp!=null){b=Math.max(d("WALongInt").numberOrThrowIfTooLarge((a=a.lastSystemMessageTimestamp)!=null?a:0),d("WALongInt").numberOrThrowIfTooLarge((a=b.lastSystemMessageTimestamp)!=null?a:0));(c==null||b>c)&&(e.lastSystemMessageTimestamp=b)}return e}var u=[[(n=d("WAWebWamEnumMdSyncdCriticalEventCode")).MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET,function(a){var b=a.lastSystemMessageTimestamp;a=a.lastMessageTimestamp;return b!=null&&a!=null&&d("WALongInt").numberOrThrowIfTooLarge(b)<d("WALongInt").numberOrThrowIfTooLarge(a)}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGES_CROSS_LIMIT,function(a){return a.messages.filter(function(a){return a.timestamp!=null}).length>1e3}]],v=[[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_UNSET,function(a){return a.key==null}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET,function(a){return((a=a.key)==null?void 0:a.remoteJid)==null}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET,function(a){return((a=a.key)==null?void 0:a.fromMe)==null}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET,function(a){return((a=a.key)==null?void 0:a.id)==null}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_INVALID,function(a){return!d("WAWebWidFactory").isWidlike((a=a.key)==null?void 0:a.remoteJid)}],[n.MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_MESSAGE_KEY_PARTICIPANT_UNSET,function(a){var b;return c("WAWebWid").isGroup((b=a.key)==null?void 0:b.remoteJid)&&((b=a.key)==null?void 0:b.fromMe)!==!0&&((b=a.key)==null?void 0:b.participant)==null}]];function e(a){if(a==null){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.MESSAGE_RANGE_UNSET);return!1}for(var b of u){var c=b[0],e=b[1];if(a&&e(a)){d("WAWebSyncdUtils").uploadCriticalEventMetric(c);return!1}}if((a==null?void 0:a.messages)==null)return!0;for(e of a.messages)for(c of v){b=c[0];a=c[1];if(a(e)){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["message_range_utils: malformed message key for id ",""])),(a=e.key)==null?void 0:a.id);d("WAWebSyncdUtils").uploadCriticalEventMetric(b);return!1}}return!0}function f(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield q(a,{forOutgoingMutation:!0,mutationIndexJid:b}));b=(yield d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a.toString()));b.forEach(function(a){var b=a.actionValue.messageRange;b&&(d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(b.lastMessageTimestamp,"activeRanges"),d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(b.lastSystemMessageTimestamp,"activeRangesSystem"));switch(a.action){case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:b=a.actionValue.messageRange;b&&(c=t(c,b));break;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:break}});d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(c.lastMessageTimestamp,"intermediaForwardMovingRange");b=(yield x(a));c.messages=s(c.messages,b,d("WALongInt").numberOrThrowIfTooLarge((b=c.lastMessageTimestamp)!=null?b:0));c=d("WAWebDBMessageRange").fixMessageRange(c);d("WAWebDBMessageRange").logMaybeMillisecondTimestamp(c.lastMessageTimestamp,"forwardMovingRange");d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: constructing forward moving message range for ","\n      ",""])),a.toString({legacy:!0}),JSON.stringify(c,null,2));return c});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=(yield d("WAWebSyncdDb").getSyncActionsRows(["action"],[d("WASyncdConst").Actions.DeleteMessageForMe]));d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: deleteForMeSyncActions length: ",""])),c.length);c.forEach(function(c){var e=a.toString({legacy:!0}),f=JSON.parse(c.index);if(f.length!==5)d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["constructForwardMovingMessageRange: delete for me mutation index malformed ",""])),c.index);else if(e===f[1]&&c.actionState===d("WASyncdConst").SyncActionState.Success){var g;e=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,c.binarySyncData).value;c=e==null||(g=e.deleteMessageForMeAction)==null?void 0:g.messageTimestamp;if(c==null)d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["constructForwardMovingMessageRange: deleteMessageForMeAction malformed"])));else{e={remoteJid:f[1],id:f[2],fromMe:f[3]==="1",participant:f[4]!=="0"?f[4]:void 0};b.push({key:e,timestamp:d("WAWebTimestampConversionUtils").maybeMillisecondsToSeconds(c)})}}});return b});return y.apply(this,arguments)}function z(a,b){return babelHelpers["extends"]({},b,{messages:b.messages.map(function(b){return babelHelpers["extends"]({},b,{key:babelHelpers["extends"]({},b.key,{remoteJid:a.toString()})})})})}n=function(a,b,c){return d("WAWebSyncdCoreApi").lockForSync([].concat(a,["message","active-message-ranges"]),b,c)};g.MessageRangeEncloseType=o;g.constructMessageRange=q;g.compareMessageRanges=a;g.mergeMessageRanges=t;g.validateMessageRange=e;g.constructForwardMovingMessageRange=f;g.replaceMessageRangeRemoteJid=z;g.lockForMessageRangeSync=n}),98);
__d("WAWebMuteChatSync",["Promise","WALogger","WALongInt","WAServerSync.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebMuteCollection","WAWebSchemaChat","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=-1;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 2};f.getAction=function(){return d("WASyncdConst").Actions.Mute};f.applyMutations=function(a){return(k||(k=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b=a.indexParts;a=a.value;b=b[1];b||d("WAWebSyncdIndexUtils").throwInvalidActionIndex();if(!c("WAWebWid").isWid(b)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}var e=a.muteAction;a=(a=a.muteAction)==null?void 0:a.muted;e=d("WALongInt").maybeNumberOrThrowIfTooLarge(e==null?void 0:e.muteEndTimestamp);if(a==null||a&&e==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mute chat sync: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}a=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(b)));if(!a.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:a.orphanModel};b=a.chat.id;a=e!=null?e:0;e=a>0&&a<d("WATimeUtils").unixTimeMs()?0:Math.floor(a/1e3);yield d("WAWebSchemaChat").getChatTable().merge(b,{muteExpiration:e});a={id:d("WAWebWidFactory").createWid(b),expiration:e};d("WAWebMuteCollection").MuteCollection.add(a,{merge:!0});d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully set mute for "," with expiration=",""])),b,e);return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["mute chat sync: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};f.generateMuteMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b!==void 0&&b!==0,e=d("WATimeUtils").unixTimeMs();b=b;b!==l&&(b*=1e3);c={muted:c,muteEndTimestamp:b};b={muteAction:c};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularHigh,indexArgs:[yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(a)],operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:this.getVersion(),value:b,timestamp:e,action:this.getAction()})});function c(b,c){return a.apply(this,arguments)}return c}();return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebPinChatSync",["$InternalEnum","Promise","WALogger","WALongInt","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebAndroidUnsupportedActionsSync","WAWebArchiveChatSync","WAWebChatGetExistingBridge","WAWebMdSyncdDogfoodingFeatureUsageWamEvent","WAWebSchemaChat","WAWebSyncdActionUtils","WAWebSyncdCoreApi","WAWebSyncdDb","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdUtils","WAWebWamEnumMdFeatureCode","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=3,p=2;function q(a){switch(a){case r.Chat:return function(a){return!c("WAWebWid").isNewsletter(a)};case r.Newsletter:return function(a){return c("WAWebWid").isNewsletter(a)}}}var r=b("$InternalEnum").Mirrored(["Chat","Newsletter"]);a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 5};f.getAction=function(){return d("WASyncdConst").Actions.Pin};f.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("WAWebAndroidUnsupportedActionsSync").updatePrimaryAllowsAllMutationsFlag("other mutation");var b=[];for(var d=0;d<a.length;d++)b.push(yield this.applyMutation(a[d]));return b});function d(b){return a.apply(this,arguments)}return d}();f.applyMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.operation==="remove"){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: REMOVE not supported"])));return(n||(n=b("Promise"))).resolve({actionState:d("WASyncdConst").SyncActionState.Unsupported})}var e=a.indexParts,f=a.value;a=a.timestamp;e=e[1];try{e||(d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing chatJid in index"]))),d("WAWebSyncdIndexUtils").throwInvalidActionIndex());if(!c("WAWebWid").isWid(e)){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}f=f.pinAction;if(f==null){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing pinAction"])));return(n||(n=b("Promise"))).resolve({actionState:d("WASyncdConst").SyncActionState.Malformed})}f=f.pinned;if(f==null){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: missing pinned field"])));return(n||(n=b("Promise"))).resolve({actionState:d("WASyncdConst").SyncActionState.Malformed})}e=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(e)));if(!e.success)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:e.orphanModel};var g=e.chat.id;e=e.chat.id;var q=d("WAWebWidFactory").createWid(e);if(!f){d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: unpin ",""])),e);yield this.applyUpdates([{wid:q,pinned:!1,timestamp:a}]);return{actionState:d("WASyncdConst").SyncActionState.Success}}e=q.isNewsletter()?yield this.getLocalNewsletterPins():yield this.getLocalChatPins();if(e.some(function(a){return a.chatId.toString()===q.toString()})){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: pin_chat_sync: "," already pinned, updating timestamp"])),g);yield this.applyUpdates([{wid:q,pinned:f,timestamp:a}]);return{actionState:d("WASyncdConst").SyncActionState.Success}}g=q.isNewsletter()?p:o;if(e.length<g){yield this.applyUpdates([{wid:q,pinned:f,timestamp:a}]);return{actionState:d("WASyncdConst").SyncActionState.Success}}c("gkx")("26258")||new(d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent").MdSyncdDogfoodingFeatureUsageWamEvent)({mdSyncdDogfoodingFeature:d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.UNPIN_4TH_CHAT_MUTATION}).commit();g=e.reduce(function(a,b){return b.timestamp<a.timestamp?b:a});f=[];e=g.timestamp<a?g.chatId:q;e===g.chatId&&f.push({wid:g.chatId,pinned:!1,timestamp:a},{wid:q,pinned:!0,timestamp:a});yield (n||(n=b("Promise"))).all([this.applyUpdates(f),this.createPendingUnpin(e,a)]);return n.resolve({actionState:d("WASyncdConst").SyncActionState.Success})}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});function e(b){return a.apply(this,arguments)}return e}();f.applyUpdates=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var c=a.map(function(a){var b=a.wid,c=a.pinned;a=a.timestamp;b={id:b.toString(),pin:c?a:0};c&&(b.archive=!1);return b});yield (n||(n=b("Promise"))).all(c.map(function(a){return d("WAWebSchemaChat").getChatTable().merge(a.id,a)}));yield n.all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebChatGetExistingBridge").getExisting(a.wid));if(b==null)return;b.pin=a.pinned?a.timestamp:0;a.pinned&&(b.archive=!1)});return function(b){return a.apply(this,arguments)}}()))});function c(b){return a.apply(this,arguments)}return c}();f.createPendingUnpin=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebSyncdDb").appendPendingMutationsRows([yield this.getPinMutation(b,!1,a)])});function c(b,c){return a.apply(this,arguments)}return c}();f.getLocalChatPins=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_1(r.Chat)});function c(){return a.apply(this,arguments)}return c}();f.getLocalNewsletterPins=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_1(r.Newsletter)});function c(){return a.apply(this,arguments)}return c}();f.$PinChatSyncImpl$p_1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebSchemaChat").getChatTable().all().then(function(a){return a.filter(function(a){return a.pin!=null&&a.pin>0}).map(function(a){return[a.id,c("WANullthrows")(a.pin)]})}),f=d("WAWebSyncdDb").getSyncActionsRows(["action"],[d("WASyncdConst").Actions.Pin]).then(function(a){return a.filter(function(a){return a.actionState===d("WASyncdConst").SyncActionState.Orphan}).map(function(a){var b=JSON.parse(a.index);if(b.length<2)return null;b=b[1];a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;return(a==null?void 0:a.pinAction)==null||(a==null?void 0:a.pinAction.pinned)!==!0?null:[b,d("WALongInt").numberOrThrowIfTooLarge((b=a.timestamp)!=null?b:0)]}).filter(Boolean)});e=(yield (n||(n=b("Promise"))).all([e,f]));f=e[0];e=e[1];var g=q(a);return[].concat(f,e).filter(function(a){a=a[0];return g(a)}).map(function(a){var b=a[0];a=a[1];return{chatId:d("WAWebWidFactory").createWid(b),timestamp:a}})});function e(b){return a.apply(this,arguments)}return e}();f.unpinAllChats=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_2(yield this.getLocalChatPins())});function c(){return a.apply(this,arguments)}return c}();f.unpinAllNewsletters=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$PinChatSyncImpl$p_2(yield this.getLocalNewsletterPins())});function c(){return a.apply(this,arguments)}return c}();f.$PinChatSyncImpl$p_2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this,e=d("WATimeUtils").unixTimeMs(),f=(yield (n||(n=b("Promise"))).all(a.map(function(a){a=a.chatId;return c.getPinMutation(e,!1,a)})));return d("WAWebSyncdCoreApi").lockForSync(["chat"],f,function(){return(n||(n=b("Promise"))).resolve()}).then(function(){return c.applyUpdates(a.map(function(a){a=a.chatId;return{wid:a,pinned:!1,timestamp:e}}))})});function c(b){return a.apply(this,arguments)}return c}();f.getMutationsForPin=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){c("gkx")("26258")||new(d("WAWebMdSyncdDogfoodingFeatureUsageWamEvent").MdSyncdDogfoodingFeatureUsageWamEvent)({mdSyncdDogfoodingFeature:d("WAWebWamEnumMdFeatureCode").MD_FEATURE_CODE.PIN_MUTATION}).commit();var f=[yield this.getPinMutation(a,b,e)];b&&f.push(yield c("WAWebArchiveChatSync").getArchiveChatMutation(a,!1,e));return f});function e(b,c,d){return a.apply(this,arguments)}return e}();f.getPinMutation=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b={pinAction:{pinned:b}};return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularLow,indexArgs:[yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(c)],value:b,version:this.getVersion(),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,timestamp:a,action:this.getAction()})});function c(b,c,d){return a.apply(this,arguments)}return c}();return e}(d("WASyncdAction").SyncActionBase);e=new a();g.MAX_PINNED_CHATS=o;g.MAX_PINNED_NEWSLETTERS=p;g.PinChatSync=e}),98);
__d("WAWebSentinelMutationSync",["Promise","WALogger","WAServerSync.pb","WASyncdAction","WASyncdConst","WATagsLogger","WATimeUtils","WAWebGetSyncKey","WAWebSyncdActionUtils","WAWebSyncdKeyManagement","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n=d("WATagsLogger").TAGS(["syncd","SentinelMutationSync"]);a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=null,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getVersion=function(){return 3};e.getAction=function(){return d("WASyncdConst").Actions.Sentinel};e.applyMutations=function(a){n.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["applying mutations..."])));return(m||(m=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){a=(a=a.value.keyExpiration)==null?void 0:a.expiredKeyEpoch;if(a==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}yield d("WAWebGetSyncKey").expireSyncKeyInTransaction(a);return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}()))};e.getSentinelMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;n.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["preparing mutations..."])));var b=d("WATimeUtils").unixTimeMs(),c=Array.from(d("WASyncdConst").CollectionName.members()),e=(yield d("WAWebSyncdKeyManagement").getNewestKeyPair());if(e==null){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sentinel mutation sync: no key pairs"])));return[]}e=e.keyEpoch;var f={keyExpiration:{expiredKeyEpoch:e}};return c.map(function(c){return d("WAWebSyncdActionUtils").buildPendingMutation({collection:c,indexArgs:[c],operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:a.getVersion(),value:f,timestamp:b,action:a.getAction()})})});function c(){return a.apply(this,arguments)}return c}();return c}(d("WASyncdAction").SyncActionBase);c=new a();Object.freeze(c);e=c;g["default"]=e}),98);
__d("WAWebStarMessageSync",["Promise","WALogger","WANullthrows","WAServerSync.pb","WASyncdAction","WASyncdConst","WATimeUtils","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebCurrentUser","WAWebDBProcessMessage","WAWebLid1X1MigrationGating","WAWebMessageAssociationGatingUtils","WAWebMsgCollection","WAWebMsgKey","WAWebSchemaChat","WAWebStarredMsgCollection","WAWebSyncdActionUtils","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebSyncdResolveMessages","WAWebSyncdUtils","WAWebWamEnumMdSyncdCriticalEventCode","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.chatJidIndex=1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.getVersion=function(){return 2};f.getAction=function(){return d("WASyncdConst").Actions.Star};f.applyMutations=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[];d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: start apply star message"])));var g=(yield d("WAWebSyncdResolveMessages").resolveMessagesForMutations(a)),r=g.incomingRemoteToLocalChatId,s=g.messagesInDB;d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: after gather cache for star message"])));g=(yield (q||(q=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.operation==="set"){var b=a.indexParts;a=a.value;var g=b[1],h=b[2],i=b[3];b=b[4];(!g||!h||!i||!b)&&d("WAWebSyncdIndexUtils").throwInvalidActionIndex();a=(a=a.starAction)==null?void 0:a.starred;var o=r.get(g);if(a==null){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["star message sync: malformed mutation"])));return{actionState:d("WASyncdConst").SyncActionState.Malformed}}g=d("WAWebSyncdIndexUtils").syncKeyToMsgKey(g,h,i,b);if(g==null){d("WAWebSyncdUtils").uploadCriticalEventMetric(d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE.ACTION_INVALID_INDEX_DATA);return{actionState:d("WASyncdConst").SyncActionState.Malformed}}if(o==null){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var p=(yield d("WAWebSchemaChat").getChatTable().get(g.remote.toString()));p!=null&&d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["star message sync: found chat via fallback"]))).sendLogs("star-message-sync-found-chat-via-fallback",{sampling:.01})}return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:g.toString(),modelType:d("WASyncdConst").SyncModelType.Msg}}}var q=c("WANullthrows")(d("WAWebSyncdIndexUtils").syncKeyToMsgKey(o,h,i,b,!1));p=s.find(function(a){return a.startsWith(q.toString())});if(p==null)return{actionState:d("WASyncdConst").SyncActionState.Orphan,orphanModel:{modelId:g.toString(),modelType:d("WASyncdConst").SyncModelType.Msg}};a?e.push(p.toString()):f.push(p.toString());o=d("WAWebMsgCollection").MsgCollection.get(p);if(o){h=o.associationType;if(h!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){i=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(h);(i==null?void 0:i.processorType)===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&o.detachAssociatedMsg()}o.star=a;o.star?d("WAWebStarredMsgCollection").addStarredMsgs([o]):d("WAWebStarredMsgCollection").removeStarredMsgs([o])}else d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["star_message_sync: msg "," found in storage but not in collection"])),q);d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: successfully "," msg ",""])),a?"starred":"unstarred",q);return{actionState:d("WASyncdConst").SyncActionState.Success}}d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["star message sync: operation not supported"])));return{actionState:d("WASyncdConst").SyncActionState.Unsupported}}catch(a){return{actionState:d("WASyncdConst").SyncActionState.Failed}}});return function(b){return a.apply(this,arguments)}}())));d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: before persist stars"])));yield q.all([d("WAWebDBProcessMessage").starMessages(e),d("WAWebDBProcessMessage").unstarMessages(f)]);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: after persist stars"])));return g});function e(b){return a.apply(this,arguments)}return e}();f.getStarMessageMutations=function(a,e){var f=this,g=d("WATimeUtils").unixTimeMs();return(q||(q=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={starAction:{starred:e}};a=new(c("WAWebMsgKey"))({fromMe:a.fromMe,participant:a.participant,remote:d("WAWebWidFactory").createWid(yield d("WAWebSyncdGetChat").getChatJidMutationIndexForChat(a.remote)),id:a.id});return d("WAWebSyncdActionUtils").buildPendingMutation({collection:d("WASyncdConst").CollectionName.RegularHigh,indexArgs:d("WAWebSyncdUtils").constructMsgKeySegmentsFromMsgKey(a),operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:f.getVersion(),value:b,timestamp:g,action:f.getAction()})});return function(b){return a.apply(this,arguments)}}()))};return e}(d("WASyncdAction").SyncActionBase);e=new a();g["default"]=e}),98);
__d("WAWebSyncdIndexUtils",["WALogger","WAWebMsgKey","WAWebSyncdError","WAWebSyncdUploadFatalErrorMetric","WAWebUserPrefsMeUser","WAWebWamEnumMdSyncdFatalErrorCode","WAWebWid","WAWebWidFactory","err"],(function(a,b,c,d,e,f,g){var h,i,j,k=/\d(?=)/gm;function l(a,b,e,f,g){g===void 0&&(g=!0);var j=void 0;if(!c("WAWebWid").isWid(a)){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncKeyToMsgKey: invalid remote value: ",""])),a.replace(k,"#"));return null}if(!d("WAWebWidFactory").createWid(a).isUser()){if(e==="0"&&!c("WAWebWid").isWid(f)){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncKeyToMsgKey: invalid participant value: ",""])),f.replace(k,"#"));return null}e==="1"?j=g?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():void 0:j=d("WAWebWidFactory").createWid(f)}return new(c("WAWebMsgKey"))({fromMe:e==="1",remote:d("WAWebWidFactory").createWid(a),id:b,participant:j})}function a(a){a=JSON.parse(a);if(a.length<5)throw c("err")("[sync-action] star action index malformed, cannot create MsgKey");a=l(a[1],a[2],a[3],a[4]);if(!a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[sync-action] star action index data is malformed, , cannot create MsgKey"])));throw c("err")("[sync-action] star action index data is malformed, , cannot create MsgKey")}return a}function b(){d("WAWebSyncdUploadFatalErrorMetric").uploadFatalErrorMetric(d("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE.INVALID_ACTION_INDEX,null);throw new(d("WAWebSyncdError").SyncdFatalError)("invalid action index")}g.syncKeyToMsgKey=l;g.getMsgKeyFromStarActionIndex=a;g.throwInvalidActionIndex=b}),98);
__d("WAWebSyncdCollectionUtils",["WASyncdConst"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a==null}function b(a){switch(a){case d("WASyncdConst").CollectionName.CriticalBlock:return!0;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return!0;case d("WASyncdConst").CollectionName.Regular:return!1;case d("WASyncdConst").CollectionName.RegularHigh:return!1;case d("WASyncdConst").CollectionName.RegularLow:return!1}}g.isBootstrap=a;g.isCriticalCollection=b}),98);
__d("WAWebSyncdResolveConflict",["Promise","WASyncdConst","WAWebGetPendingMutation","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=c.get(a.index);if(b){var d=a.actionHandler;return{remoteMutationIndex:a.index,conflictResolutionState:yield d.resolveConflicts(b,a)}}});return function(b){return a.apply(this,arguments)}}())));var d=new Map();a.forEach(function(a){a&&d.set(a.remoteMutationIndex,a.conflictResolutionState)});return d});return j.apply(this,arguments)}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=[],e=[],f=(yield d("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a));a=new Map(f.map(function(a){return[a.index,a]}));var g=(yield i(b,a));b.forEach(function(a){var b=g.get(a.index);if(b)switch(b){case d("WASyncdConst").ConflictResolutionState.SkipRemote:break;case d("WASyncdConst").ConflictResolutionState.ApplyRemoteAndDropLocal:c.push(a);e=e.concat(f.filter(function(b){return b.index===a.index}));break;case d("WASyncdConst").ConflictResolutionState.SkipRemoteAndDropLocal:e=e.concat(f.filter(function(b){return b.index===a.index}));break}else c.push(a)});b=[];for(var h=0;h<c.length;h++){var j=c[h].actionHandler;j=(yield j.dropMutationDueToCrossIndexConflict(c[h],a));j||b.push(c[h])}j=e.map(function(a){return a.id}).filter(Boolean);return{remoteMutationsToApply:b,pendingSetMutationsToDrop:j}});return k.apply(this,arguments)}g.resolveConflict=a}),98);
__d("WAWebSyncdValidateMutations",["WACryptoUtils","WALogger","WALongInt","WAServerSync.pb","WASyncAction.pb","WASyncdConst","WAWebSyncdError","WAWebSyncdMetricFatalError","WAWebSyncdUtils","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m;function a(a,b){var c=new Set();b.forEach(function(b){b=b.version.version;if(c.has(b)){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.DUPLICATE_PATCH_VERSION_IN_COLLECTION,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("duplicate patch version in collection")}c.add(b)})}function n(a){return a==null?!0:[d("WASyncdConst").Actions.Agent,d("WASyncdConst").Actions.AndroidUnsupportedActions,d("WASyncdConst").Actions.Archive,d("WASyncdConst").Actions.BotWelcomeRequest,d("WASyncdConst").Actions.ChatAssignment,d("WASyncdConst").Actions.ChatAssignmentOpenedStatus,d("WASyncdConst").Actions.ChatLockSettings,d("WASyncdConst").Actions.ClearChat,d("WASyncdConst").Actions.Contact,d("WASyncdConst").Actions.CustomPaymentMethods,d("WASyncdConst").Actions.DeleteChat,d("WASyncdConst").Actions.DeleteMessageForMe,d("WASyncdConst").Actions.DeviceCapabilities,d("WASyncdConst").Actions.DisableLinkPreviews,d("WASyncdConst").Actions.ExternalWebBeta,d("WASyncdConst").Actions.FavoriteSticker,d("WASyncdConst").Actions.LabelEdit,d("WASyncdConst").Actions.LabelJid,d("WASyncdConst").Actions.LabelMessage,d("WASyncdConst").Actions.LabelReordering,d("WASyncdConst").Actions.LocaleSetting,d("WASyncdConst").Actions.LockChat,d("WASyncdConst").Actions.MarkChatAsRead,d("WASyncdConst").Actions.MarketingMessage,d("WASyncdConst").Actions.MarketingMessageBroadcast,d("WASyncdConst").Actions.Mute,d("WASyncdConst").Actions.Nux,d("WASyncdConst").Actions.PaymentInfo,d("WASyncdConst").Actions.Pin,d("WASyncdConst").Actions.PinDEPRECATED,d("WASyncdConst").Actions.PnForLidChat,d("WASyncdConst").Actions.PrimaryFeature,d("WASyncdConst").Actions.PrimaryVersion,d("WASyncdConst").Actions.QuickReply,d("WASyncdConst").Actions.RemoveRecentSticker,d("WASyncdConst").Actions.Sentinel,d("WASyncdConst").Actions.SettingPushName,d("WASyncdConst").Actions.ShareOwnPn,d("WASyncdConst").Actions.Star,d("WASyncdConst").Actions.StatusPrivacy,d("WASyncdConst").Actions.Subscription,d("WASyncdConst").Actions.TimeFormat,d("WASyncdConst").Actions.UnarchiveChatsSetting,d("WASyncdConst").Actions.UserStatusMute,d("WASyncdConst").Actions.Favorites,d("WASyncdConst").Actions.NoteEdit].includes(a)}function o(a){var b=d("WASyncdConst").Actions.cast(d("WAWebSyncdUtils").getMutationNameFromIndex(a.index)),c=a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE";n(b)?d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""])),c,b):d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: [not specified]"])),c);d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: duplicate "," mutation: ",""])),c,a.index)}function b(a,b,c){var e=new Set(),f=new Set();b.forEach(function(g){var h=!1;g.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET&&(e.has(g.index)?(o(g),h=!0):e.add(g.index));g.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&(f.has(g.index)?(o(g),h=!0):f.add(g.index));if(h)switch(c){case d("WASyncdConst").SyncDataType.Patch:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("same index for multiple mutations in patch");case d("WASyncdConst").SyncDataType.Snapshot:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT,{collection:a,isFatal:!1});p(b);break;case d("WASyncdConst").SyncDataType.Local:d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["validation not required for local mutations"])))}})}function p(a){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: all duplicated actions:"])));var b=new Map();a.forEach(function(a){if(b.has(a.index)){o(a);var c=b.get(a.index);if(c==null)return;var e=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value,f=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,c.binarySyncData).value;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: is using same timestamp? ","\n          is same key? ",""])),(e==null?void 0:e.timestamp)===(f==null?void 0:f.timestamp),d("WACryptoUtils").arrayBuffersEqual(a.keyId,c==null?void 0:c.keyId))}b.set(a.index,a)})}function c(a,b){return b.map(function(b){var c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,b.binarySyncData);c=c.value;if(!c){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_VALUE,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing action value")}c=d("WALongInt").maybeNumberOrThrowIfTooLarge(c.timestamp);if(c==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_ACTION_TIMESTAMP,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing action timestamp")}return{index:b.index,version:b.version,keyId:b.keyId,indexMac:b.indexMac,valueMac:b.valueMac,collection:b.collection,binarySyncData:b.binarySyncData,timestamp:c}})}g.validateNoDuplicatePatchVersionInCollection=a;g.validateNoSameIndexForMultipleMutations=b;g.validateAndTypeSetMutations=c}),98);
__d("WAWebSyncdValidateServerSyncProtobuf",["WALongInt","WASyncAction.pb","WASyncdKeyTypes","WAWebSyncdError","WAWebSyncdMetricFatalError","decodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.validateSnapshotProtobuf=function(b,c){var e=c.version,f=c.records,g=c.mac;c=c.keyId;var h=e==null?void 0:e.version;if(!e||h==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_VERSION,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing snapshot version")}e=f.map(function(c){return a.validateRecordProtobuf(b,c)});if(!g){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_MAC,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing snapshot mac")}f=a.validateKeyIdProtobuf(b,c,d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_SNAPSHOT_KEY_ID);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(h)},records:e,mac:g,keyId:f}};a.validatePatchProtobuf=function(b,c){var e=c.version,f=c.mutations,g=c.externalMutations,h=c.snapshotMac,i=c.patchMac,j=c.keyId,k=c.exitCode,l=c.deviceIndex;c=c.clientDebugData;var m=e==null?void 0:e.version;if(!e||m==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_VERSION,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing patch version")}if(f&&f.length>0&&g){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("patch with both inline and external mutations")}if(!h){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_SNAPSHOT_MAC,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing patch snapshot mac")}if(!i){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_MAC,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing patch mac")}e=a.validateKeyIdProtobuf(b,j,d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_PATCH_KEY_ID);j=void 0;c!=null&&(j=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").PatchDebugDataSpec,c));if(g){c=a.validateExternalBlobReference(b,g);return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:void 0,externalMutations:c,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}}g=f.map(function(c){return a.validateMutationProtobuf(b,c)});return{version:{version:d("WALongInt").numberOrThrowIfTooLarge(m)},mutations:g,externalMutations:void 0,exitCode:k,snapshotMac:h,patchMac:i,keyId:e,deviceIndex:l,clientDebugData:j}};a.validateExternalBlobReference=function(a,b){var c=b.mediaKey,e=b.directPath,f=b.handle,g=b.fileSizeBytes,h=b.fileSha256;b=b.fileEncSha256;if(!c){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing external blob reference media key")}if(e==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing external blob reference direct path")}if(!h){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing external blob reference file SHA256")}if(!b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing external blob reference file enc SHA256")}return{mediaKey:c,directPath:e,handle:f,fileSizeBytes:g,fileSha256:h,fileEncSha256:b}};a.validateMutationProtobuf=function(b,c){var e=c.operation;c=c.record;if(e==null){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_OPERATION,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing mutation operation")}if(!c){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_RECORD,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing mutation record")}b=a.validateRecordProtobuf(b,c);return{operation:e,record:b}};a.validateRecordProtobuf=function(b,c){var e=c.index,f=c.value;c=c.keyId;var g=e==null?void 0:e.blob,h=f==null?void 0:f.blob;if(!e||!g){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_INDEX,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing mutation index")}if(!f||!h){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_VALUE,{collection:b});throw new(d("WAWebSyncdError").SyncdFatalError)("missing mutation value")}e=a.validateKeyIdProtobuf(b,c,d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_MUTATION_KEY_ID);return{index:{blob:g},value:{blob:h},keyId:e}};a.validateKeyIdProtobuf=function(a,b,c){var e=b==null?void 0:b.id;if(!b||!e){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(c,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("missing mutation key id")}return{id:d("WASyncdKeyTypes").toSyncKeyId(e)}};return a}();g["default"]=a}),98);
__d("WAWebWamEnumMutationBundleType",[],(function(a,b,c,d,e,f){a=Object.freeze({SNAPSHOT:0,PATCH:1});f.MUTATION_BUNDLE_TYPE=a}),66);
__d("WAWebWamEnumMutationDirectionType",[],(function(a,b,c,d,e,f){a=Object.freeze({INCOMING:0,OUTGOING:1});f.MUTATION_DIRECTION_TYPE=a}),66);
__d("WAWebWamEnumMutationOperationType",[],(function(a,b,c,d,e,f){a=Object.freeze({SET:0,REMOVE:1});f.MUTATION_OPERATION_TYPE=a}),66);
__d("WAWebWamEnumSyncdCollectionType",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:1,REGULAR_LOW:2,REGULAR_HIGH:3,CRITICAL_BLOCK:4,CRITICAL_UNBLOCK_LOW:5});f.SYNCD_COLLECTION_TYPE=a}),66);
__d("WAWebMdSyncdMutationWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMutationBundleType","WAWebWamEnumMutationDirectionType","WAWebWamEnumMutationOperationType","WAWebWamEnumSyncdCollectionType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdSyncdMutation:[5970,{appSessionId:[1,a.TYPES.STRING],companionSessionIds:[2,a.TYPES.STRING],contentLength:[3,a.TYPES.INTEGER],isInBootstrap:[4,a.TYPES.BOOLEAN],isUsingLid:[5,a.TYPES.BOOLEAN],mutationBundle:[6,d("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE],mutationDirection:[7,d("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE],mutationMac:[8,a.TYPES.STRING],mutationName:[9,a.TYPES.STRING],mutationOperation:[10,d("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE],patchMac:[15,a.TYPES.STRING],seqNumber:[11,a.TYPES.INTEGER],syncdCollection:[12,d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE],syncdKeyhash:[13,a.TYPES.STRING],syncdKeyid:[14,a.TYPES.STRING]},[1,1,1],"regular"]},{MdSyncdMutation:[]});g.MdSyncdMutationWamEvent=b}),98);
__d("WAWebSyncdWamReportingUtils",["WALogger","WASyncdConst","WAWebABProps","WAWebMdSyncdMutationWamEvent","WAWebWamEnumMutationBundleType","WAWebWamEnumMutationDirectionType","WAWebWamEnumMutationOperationType","WAWebWamEnumSyncdCollectionType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){switch(a){case d("WASyncdConst").CollectionName.RegularHigh:return d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR_HIGH;case d("WASyncdConst").CollectionName.RegularLow:return d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR_LOW;case d("WASyncdConst").CollectionName.Regular:return d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.REGULAR;case d("WASyncdConst").CollectionName.CriticalBlock:return d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.CRITICAL_BLOCK;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return d("WAWebWamEnumSyncdCollectionType").SYNCD_COLLECTION_TYPE.CRITICAL_UNBLOCK_LOW}}function a(a,b,c,d,e,f,g,h,i){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,j,k,l){try{var m=d("WAWebABProps").getABPropConfigValue("syncd_mutation_and_bundle_logging");if(!m)return;m=JSON.parse(m);if(!m||!m.allowlist||!m.allowlist.includes(a))return;new(d("WAWebMdSyncdMutationWamEvent").MdSyncdMutationWamEvent)({appSessionId:"",companionSessionIds:k,contentLength:0,isInBootstrap:!1,isUsingLid:!1,mutationBundle:j?d("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE.PATCH:d("WAWebWamEnumMutationBundleType").MUTATION_BUNDLE_TYPE.SNAPSHOT,mutationDirection:c?d("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE.INCOMING:d("WAWebWamEnumMutationDirectionType").MUTATION_DIRECTION_TYPE.OUTGOING,mutationMac:e,mutationName:f,mutationOperation:g?d("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE.REMOVE:d("WAWebWamEnumMutationOperationType").MUTATION_OPERATION_TYPE.SET,seqNumber:b,syncdCollection:i(a),syncdKeyhash:"",syncdKeyid:"",patchMac:l!=null?l:""}).commit()}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncReportMutationToWam: ",""])),a).sendLogs("syncReportMutationToWam failed")}});return j.apply(this,arguments)}g.syncReportMutationToWam=a}),98);
__d("WAWebSyncdCollectionHandler",["Promise","WABase64","WACryptoDependencies","WACryptoUtils","WALogger","WALongInt","WANullthrows","WAServerSync.pb","WASyncAction.pb","WASyncdConst","WASyncdKeyTypes","WATimeUtils","WAWebABProps","WAWebCurrentUser","WAWebGetCollectionVersion","WAWebGetMissingKey","WAWebGetPendingMutation","WAWebGetSyncAction","WAWebRequestSyncdSnapshotRecovery","WAWebRunInTransaction","WAWebSyncdAntiTampering","WAWebSyncdCollectionHandlerTypesConverter","WAWebSyncdCollectionUtils","WAWebSyncdCryptoUtils","WAWebSyncdDbCallbacksApi","WAWebSyncdDecryptMutationsWrapper","WAWebSyncdError","WAWebSyncdGetActionHandler","WAWebSyncdHandleMissingKeys","WAWebSyncdMMSDownload","WAWebSyncdMdSyncFieldstatMeta","WAWebSyncdMetricCriticalBootstrapStage","WAWebSyncdMetricFatalError","WAWebSyncdMetrics","WAWebSyncdResolveConflict","WAWebSyncdSnapshotRecoveryGatingUtils","WAWebSyncdUtils","WAWebSyncdValidateMutations","WAWebSyncdValidateServerSyncProtobuf","WAWebSyncdWamAppState","WAWebSyncdWamReportingUtils","asyncToGeneratorRuntime","decodeProtobuf","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,F,Ua=0,Va=new ArrayBuffer(128),G=null;function H(){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{if(G!=null)return G;var a=(yield d("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getMdSessionId());a=d("WABase64").decodeB64(a);a=(yield d("WACryptoDependencies").getCrypto().subtle.digest({name:"SHA-1"},a));a=d("WABase64").encodeB64UrlSafe(a);G=a.slice(-6);return G}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getShortMdSessionId: ",""])),a).sendLogs("getShortMdSessionId failed");return""}});return I.apply(this,arguments)}function a(a){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return(F||(F=b("Promise"))).resolve();var c=Math.random().toString(36).substr(2,5),e=a.sort(function(a,b){return a.timestamp-b.timestamp});d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: start applyIndividualMutations"])));e=d("WAWebSyncdCollectionHandlerTypesConverter").syncActionsToDecryptedMutation(e);var f=e.reduce(function(a,b){var c;c=(c=a.get(b.collection))!=null?c:[];c.push(b);a.set(b.collection,c);return a},new Map());e=Array.from(f.keys()).map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose([""," syncd: apply individual mutations for collection ",""])),c,e);var g=f.get(e);if(g===void 0)return;g=(yield V(e,g,d("WASyncdConst").SyncDataType.Local,c,null,null));var h=g.setMutationsToPersist,i=g.pendingSetMutationsToDrop;g=h.map(function(a){return{actionState:a.actionState,index:a.index,modelId:a.modelId,modelType:a.modelType}});var j=g;j=g.filter(function(b){var c=a.find(function(a){return a.index===b.index});if(c==null){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not find original individual mutation"]))).sendLogs("syncd: could not find original individual mutation");return!0}return b.actionState!==c.actionState||b.modelId!==c.modelId||b.modelType!==c.modelType});d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end apply individual mutations for collection ",""])),c,e);yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.SyncActionStore;a=a.PendingMutationStore;j.length>0&&(yield b.bulkUpdate(j));i.length>0&&(yield a.bulkRemove(i))});return function(b){return a.apply(this,arguments)}}());d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end update db after apply individual mutations for collection ",""])),c,e)});return function(a){return e.apply(this,arguments)}}());yield (F||(F=b("Promise"))).all(e);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose([""," syncd: end applyIndividualMutations"])),c)});return J.apply(this,arguments)}function e(a,b,c,d){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=a.name,g=a.version,h=a.patches,i=a.snapshot,j=a.syncedPendingMutationsId,k=a.syncedEncryptedMutations;d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start applying collection ",""])),b,f);try{var l;e==null||e.mark("external_mutations_download_start",{patchCount:(l=a.patches)==null?void 0:l.length,snapshotSizeBytes:(l=a.snapshot)==null?void 0:l.fileSizeBytes});l=(yield Za(f,h,i,c));h=l[0];i=l[1];e==null||e.mark("external_mutations_download_end",{patchesWithMutationsCount:i==null?void 0:i.length,snapshotRecordsCount:h==null?void 0:h.records.length});l=performance.now();if(h!=null)yield bb(f,h,i,e,b),d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," snapshot and patches applied successfully"])),b,f);else if(i!=null){var m=Math.min.apply(Math,i.map(function(a){return a.version.version})),n=c!=null&&m>c+1&&i.length>0;if(n){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(f,b+" has missing patches");n=(yield d("WAWebGetMissingKey").getAllMissingKeysInTransaction());d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose([""," syncd: missing keys: [","]"])),b,n.map(function(a){return a.keyHex+":"+a.timestamp}));d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",", localVersion: ",",\n           minPatch: ",""])),b,f,c,m);yield Wa(f,i[0]);yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(f);d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose([""," syncd: has missing patches. collection: ",""])),b,f).sendLogs("syncd: has missing patches");d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.SERVER_DID_NOT_SEND_ALL_PATCHES,{collection:f,patchVersion:c!=null?c:0});throw new(d("WAWebSyncdError").SyncdFatalError)("syncd: has missing patches")}yield db(f,i,e,b);d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," patches applied successfully"])),b,f)}else if(g!=null){n=k.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).length;m=k.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).length;e=Array.from(new Set(k.map(function(a){return a.index}))).length;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(f,b+" start upload patch. version: "+g+". mutation count: "+k.length+",\n        numSet: "+n+", numRemove: "+m+", numUniqueIndex: "+e);yield Xa(f,g,j,k,b);var o=(yield H());k.forEach(function(a){var b=d("WAWebSyncdUtils").getMutationNameFromIndex(a.index);void d("WAWebSyncdWamReportingUtils").syncReportMutationToWam(f,g,!1,d("WABase64").encodeB64UrlSafe(a.indexMac),b,a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,o,a.patchMac?d("WABase64").encodeB64UrlSafe(a.patchMac):void 0)});yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(f,b+" end upload patches");d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," v"," uploaded successfully"])),b,f,g)}else d("WAWebSyncdCollectionUtils").isBootstrap(c)&&(yield d("WAWebGetCollectionVersion").updateCollectionVersionAndLtHashInTransaction(f,Ua,Va)),d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["syncd: sync "," but there are no updates"])),f);n=Math.floor(performance.now()-l);d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["syncd: applyAppStateSyncResponse: finished applying "," in ","ms"])),f,n);if((i||h)&&(d("WAWebSyncdCollectionUtils").isBootstrap(c)&&!d("WAWebSyncdCollectionUtils").isCriticalCollection(f))){m=h!=null;d("WAWebSyncdMetrics").reportSyncdBootstrapDataApplied(f,m?d("WAWebSyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_USED:d("WAWebSyncdMetrics").SyncdBootstrapDataAppliedSnapshotUsed.SNAPSHOT_NOT_USED,n)}return a}catch(a){e=a.message;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(f,"error (maybe retryable): "+a);if(a instanceof d("WAWebSyncdError").SyncdMissingKeyError){d("WALogger").WARN(B||(B=babelHelpers.taggedTemplateLiteralLoose(["syncd: key error: "," missing keys"])),f);return{name:f,state:d("WASyncdConst").CollectionState.Blocked}}if(a instanceof d("WAWebSyncdError").SyncdFatalError){d("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: "," throws ",""])),f,e).sendLogs("syncd: fatal error: "+String(f)+" throws "+e);return{name:f,state:d("WASyncdConst").CollectionState.ErrorFatal}}d("WALogger").WARN(D||(D=babelHelpers.taggedTemplateLiteralLoose(["syncd: retryable error: "," throws ",""])),f,e).sendLogs("syncd: retryable error: "+String(f)+" throws "+e);return{name:f,state:d("WASyncdConst").CollectionState.ErrorRetry}}});return K.apply(this,arguments)}function Wa(a,b){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{b=(yield d("WAWebSyncdDecryptMutationsWrapper").tryDecryptPatch(a,b));b=b.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});b=d("WAWebSyncdValidateMutations").validateAndTypeSetMutations(a,b);b=b.length>0?b[0].timestamp:null;b=b==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),b);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"max timestamp in first patch: "+(b!=null?b:"n/a")+" days ago")}catch(a){d("WALogger").WARN(E||(E=babelHelpers.taggedTemplateLiteralLoose(["syncd: could not log max timestamp: ",""])),a)}});return L.apply(this,arguments)}function Xa(a,b,c,d,e){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var h=f.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});yield Ya(g,a,f,h);h=(yield d("WAWebSyncdAntiTampering").computeLtHash(a,h,g,null,c,d("WAWebSyncdAntiTampering").SyncdPatchDirection.Outgoing));var i=h.ltHash,j=d("WAWebSyncdCollectionHandlerTypesConverter").encryptedUploadMutationsToSyncActions(f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),d("WASyncdConst").SyncActionState.Success);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+g+"] set mutation during upload: "+j.map(function(a){return d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t"));var k=new Set(j.map(function(a){return a.index})),l=f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&!k.has(a.index)}).map(function(a){return a.index});yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+g+"] count removed during upload: "+l.length);h=(h=(yield d("WAWebGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version})))!=null?h:0;c!==h+1&&d("WALogger").ERROR(aa||(aa=babelHelpers.taggedTemplateLiteralLoose(["syncd: _uploadSuccessful: unexpected server version (",") after patch upload, expected ",""])),c,h+1).sendLogs("syncd: unexpected server version after patch upload");d("WALogger").LOG(ba||(ba=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: _uploadSuccessful: write to db for ",""])),g,a);yield d("WAWebSyncdAntiTampering").logMacsInSnapshot(a,g,"pre-processing outgoing patch v"+c);yield d("WAWebSyncdAntiTampering").reportCollectionInconsistency(a,"pre-processing outgoing patch "+c+".",g);yield S(a,c,f,g);h=null;yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=b.SyncActionStore,k=b.PendingMutationStore;b=b.CollectionVersionStore;h=(yield Z(a,c,"outgoing patch",b,g));h==null?(yield f.bulkRemove(l),yield f.bulkSet(j),yield k.bulkRemove(e),yield b.update(a,{version:c,ltHash:i})):d("WALogger").LOG(ca||(ca=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),g,c)});return function(a){return f.apply(this,arguments)}}());if(h!=null){f=h;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,f);yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a);d("WALogger").ERROR(da||(da=babelHelpers.taggedTemplateLiteralLoose(["",""])),f).sendLogs("syncd: processing old version for "+a)}d("WALogger").LOG(ea||(ea=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: end _uploadSuccessful for ",""])),g,a)});return M.apply(this,arguments)}function Ya(a,b,c,d){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){try{e=(yield (F||(F=b("Promise"))).all([(yield F.all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(a){return d("WAWebGetSyncAction").getSyncActionInTransaction(a.index)}))).filter(Boolean),(yield F.all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WAWebGetSyncAction").getSyncActionInTransaction(a.index)}))).filter(Boolean),(yield F.all(e.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WAWebGetSyncAction").getSyncActionsByIndexMacsInTransaction([a.indexMac])}))).filter(Boolean)]));var g=e[0],h=e[1];e=e[2];var i=null;h.length===1&&e.length===1&&e[0].length===1&&(i=h[0].index===e[0][0].index);a="["+a+"] patch uploaded with mutations mac for "+c+":\n\n      SET: "+f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t")+"\n      REMOVE: "+f.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE}).map(function(a){return d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)}).join("\n\t")+"\n\n      REMOVE fetch by index: "+g.map(function(a){return a.collection+":"+d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+d("WAWebSyncdUtils").getMutationNameFromIndex(a.index)}).join("\n\t")+"\n      SET fetch by index: "+h.map(function(a){return a.collection+":"+d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+d("WAWebSyncdUtils").getMutationNameFromIndex(a.index)}).join("\n\t")+"\n      SET fetch by mac: "+e.map(function(a){return a.map(function(a){return a.collection+":"+d("WAWebSyncdAntiTampering").indexAndValueMacToString(a.indexMac,a.valueMac)+":"+d("WAWebSyncdUtils").getMutationNameFromIndex(a.index)})}).join("\n\t")+"\n      isSameIndex: "+(i==null?"n/a":i.toString())+"\n      ";d("WALogger").LOG(fa||(fa=babelHelpers.taggedTemplateLiteralLoose(["syncd: "," "])),a);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(c,a)}catch(a){d("WALogger").LOG(ga||(ga=babelHelpers.taggedTemplateLiteralLoose(["syncd: failed to debug upload: ",""])),a)}});return N.apply(this,arguments)}function Za(a,b,c,d){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h=(F||(F=b("Promise"))).resolve(),i=0,j=d("WATimeUtils").unixTimeMs();if(f!=null){var k;f=c("WAWebSyncdValidateServerSyncProtobuf").validateExternalBlobReference(a,f);i+=d("WALongInt").numberOrThrowIfTooLarge((k=f.fileSizeBytes)!=null?k:0);d("WALogger").LOG(ha||(ha=babelHelpers.taggedTemplateLiteralLoose(["syncd: download snapshot for ",""])),a);h=d("WAWebSyncdMMSDownload").downloadSnapshot(a,f)}k=F.resolve();if(e!=null&&e.length>0){f=e.map(function(b){return c("WAWebSyncdValidateServerSyncProtobuf").validatePatchProtobuf(a,b)});k=(F||(F=b("Promise"))).all(f.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.mutations||[],e=b.externalMutations;if(e){d("WALogger").LOG(ia||(ia=babelHelpers.taggedTemplateLiteralLoose(["syncd: download patch for ",""])),a);c=(yield d("WAWebSyncdMMSDownload").downloadExternalPatch(a,e));d("WALogger").LOG(ja||(ja=babelHelpers.taggedTemplateLiteralLoose(["syncd: ","'s external patch downloaded"])),a);i+=d("WALongInt").numberOrThrowIfTooLarge((e=e.fileSizeBytes)!=null?e:0)}return{mutations:c,version:b.version,snapshotMac:b.snapshotMac,patchMac:b.patchMac,keyId:b.keyId,exitCode:b.exitCode,deviceIndex:b.deviceIndex,clientDebugData:b.clientDebugData}});return function(a){return c.apply(this,arguments)}}()))}var l,m;try{e=(yield (F||(F=b("Promise"))).all([h,k]));l=e[0];m=e[1];d("WAWebSyncdCollectionUtils").isBootstrap(g)&&d("WAWebSyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:j,downloadSize:i,isSuccess:"success"})}catch(b){d("WAWebSyncdCollectionUtils").isBootstrap(g)&&d("WAWebSyncdMetrics").reportSyncdBootstrapAppStateDownloadMetric({collection:a,downloadStartTs:j,downloadSize:i,isSuccess:"failure"});throw b}return[l,m]});return O.apply(this,arguments)}function $a(a,c){var e=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){a==null||a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Snapshot});b=(yield d("WAWebSyncdAntiTampering").computeLtHashAndValidateSnapshot(b,e,c));a==null||a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return b});return function(a,b){return e.apply(this,arguments)}}(),f=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){a==null||a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Snapshot});b=(yield d("WAWebSyncdDecryptMutationsWrapper").tryDecryptSnapshot(b,c));a==null||a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Snapshot});return b});return function(a,b){return c.apply(this,arguments)}}();return{measuredComputeLtHashAndValidateSnapshot:e,measuredTryDecryptSnapshot:f}}function ab(a){var c=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c,e,f){a==null||a.mark("anti_tampering_start",{source:d("WASyncdConst").SyncDataType.Patch});b=(yield d("WAWebSyncdAntiTampering").computeLtHashAndValidatePatch(b,c,e,f));a==null||a.mark("anti_tampering_end",{source:d("WASyncdConst").SyncDataType.Patch});return b});return function(a,b,d,e){return c.apply(this,arguments)}}(),e=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){a==null||a.mark("decryption_start",{source:d("WASyncdConst").SyncDataType.Patch});b=(yield d("WAWebSyncdDecryptMutationsWrapper").tryDecryptPatch(b,c));a==null||a.mark("decryption_end",{source:d("WASyncdConst").SyncDataType.Patch});return b});return function(a,b){return c.apply(this,arguments)}}();return{measuredComputeLtHashAndValidatePatch:c,measuredTryDecryptPatch:e}}function bb(a,b,c,d,e){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+h+"] start _applySnapshotAndPatches. mutation count: "+e.records.length+", version: "+e.version.version);var i=!1;try{var j=$a(g,h),k=j.measuredComputeLtHashAndValidateSnapshot;j=j.measuredTryDecryptSnapshot;g==null||g.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Snapshot,snapshotRecordsCount:e.records.length});d("WALogger").LOG(ka||(ka=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: start validate ","'s snapshot"])),h,a);var l=new ArrayBuffer(0),m=null;try{l=(yield k(a,e))}catch(b){k=d("WAWebSyncdSnapshotRecoveryGatingUtils").shouldPreformSnapshotRecovery(a,e.records.length,b);if(k.shouldPerformRecovery)i=!0,yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+h+"] attempt to recovery failed validate snapshot mac"),d("WALogger").LOG(la||(la=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: "," failed validate snapshot mac, attempt to recovery"])),h,a);else throw b}d("WALogger").LOG(ma||(ma=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot validated"])),h,a);k=[];if(!i)k=(yield j(a,e)),d("WALogger").LOG(na||(na=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot decrypted"])),h,a);else{d("WALogger").LOG(oa||(oa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," requesting recovery from primary"])),h,a);c("gkx")("26258")||d("WALogger").ERROR(pa||(pa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," requesting recovery from primary"])),h,a).sendLogs("syncd-recover-fatal");j=d("WATimeUtils").unixTimeMs();var n=(yield d("WAWebRequestSyncdSnapshotRecovery").SyncdSnapshotRecoveryModule.requestRecoveryWithTimeout(a));d("WALogger").LOG(qa||(qa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd recovery: "," recovery request resolved"])),h,a);j=d("WATimeUtils").unixTimeMs()-j;if(n==null){d("WAWebSyncdMetricFatalError").flushDeferredFatalError(j);throw new(d("WAWebSyncdError").SyncdFatalError)("unable to validate snapshot mac")}else d("WAWebSyncdMetricFatalError").flushDeferredFatalError(j,!1);k=n.decryptedMutations;l=n.collectionLthash;m=n.version}var o=(yield H());i||(k.forEach(function(b){var c=d("WAWebSyncdUtils").getMutationNameFromIndex(b.index);void d("WAWebSyncdWamReportingUtils").syncReportMutationToWam(a,e.version.version,!0,d("WABase64").encodeB64UrlSafe(b.indexMac),c,b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!1,o,d("WABase64").encodeB64UrlSafe(e.mac))}),yield S(a,e.version.version,k,h),d("WAWebSyncdWamAppState").addMutationCount(e.records.length),d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.SNAPSHOT_MUTATIONS,k),d("WAWebSyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,k,d("WASyncdConst").SyncDataType.Snapshot));var p=i&&m!=null?m:e.version.version;j=(yield V(a,k,d("WASyncdConst").SyncDataType.Snapshot,h,g,p));var q=j.setMutationsToPersist,r=j.pendingSetMutationsToDrop;d("WALogger").LOG(ra||(ra=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in snapshot of collection "," v",""])),h,k.length,a,p);d("WALogger").LOG(sa||(sa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: collection ","'s snapshot v"," applied"])),h,a,p);n=null;g==null||g.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Snapshot,setMutationsToPersistCount:q.length,pendingMutationsToDropCount:r.length});yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.SyncActionStore,e=b.PendingMutationStore;b=b.CollectionVersionStore;n=(yield Z(a,p,"snapshot",b,h));n==null?(yield c.bulkSet(q),yield e.bulkRemove(r),yield b.update(a,{version:p,ltHash:l})):d("WALogger").LOG(ta||(ta=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),h,p)});return function(a){return c.apply(this,arguments)}}());g==null||g.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Snapshot});if(n!=null){m=n;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,m);yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a);d("WALogger").ERROR(ua||(ua=babelHelpers.taggedTemplateLiteralLoose(["",""])),m).sendLogs("syncd: processing old version for "+a)}d("WALogger").LOG(va||(va=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed applying snapshot for ",""])),h,a);g==null||g.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Snapshot,decryptedMutationsCount:k.length})}catch(b){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"exception "+b.message);b instanceof d("WAWebSyncdError").SyncdMissingKeyError&&(yield d("WAWebSyncdHandleMissingKeys").handleMissingKeysInSnapshot(a,e));throw b}yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+h+"] done applying snapshot");f&&!i&&(g==null||g.mark("apply_start",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:f.length}),yield db(a,f,g,h),g==null||g.mark("apply_end",{source:d("WASyncdConst").SyncDataType.Patch,patchCount:f.length}))});return P.apply(this,arguments)}function cb(a){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebABProps").getABPropConfigValue("web_syncd_max_mutations_to_process_during_resume");if(a>b){b=Date.now();d("WALogger").LOG(wa||(wa=babelHelpers.taggedTemplateLiteralLoose(["syncd: patches have "," mutations, wait for UI unblock"])),a);yield d("WAWebSyncdDbCallbacksApi").handleSyncDelayApplyingPatchUntilUIUnblocks();d("WALogger").LOG(xa||(xa=babelHelpers.taggedTemplateLiteralLoose(["syncd: UI is unblocked, waited for ","ms"])),Date.now()-b)}});return Q.apply(this,arguments)}function db(a,b,c,d){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=c.length===0?"n/a":c[c.length-1].version.version;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+f+"] start apply patches. count: "+c.length+", last patch version: "+g);if(c.length===0){d("WALogger").LOG(ya||(ya=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: no patches for collection ",""])),f,a);return(F||(F=b("Promise"))).resolve()}d("WAWebSyncdValidateMutations").validateNoDuplicatePatchVersionInCollection(a,c);c.sort(function(a,b){return a.version.version>b.version.version?1:-1});try{var h=c.reduce(function(a,b){return a+b.mutations.length},0);yield cb(h);for(var i=0;i<c.length;i++){if(i<=4||i%10===0){var j;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+f+"] start applying "+a+" patch "+c[i].version.version+" with "+c[i].mutations.length+" mutations from device "+((j=c[i].deviceIndex)!=null?j:"n/a"))}yield eb(a,c[i],e,i<=1,f);(i<=4||i%10===0)&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+f+"] finished applying patch "+c[i].version.version+" with "+c[i].mutations.length+" mutations"))}yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+f+"] after apply patches for "+a+" (last patch: v"+g+" total mutations: "+h+")")}catch(b){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"exception"+b.message);b instanceof d("WAWebSyncdError").SyncdMissingKeyError&&(yield d("WAWebSyncdHandleMissingKeys").handleMissingKeysInPatches(a,c));throw b}});return R.apply(this,arguments)}function S(a,b,c,d){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){if(a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow){c=c.map(function(a){var b=a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET?"SET":"REMOVE",c=d("WAWebSyncdUtils").getMutationNameFromIndex(a.index);return b+" "+c+" index mac: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(a.indexMac).slice(-16)+", key id: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(d("WASyncdKeyTypes").fromSyncKeyId(a.keyId))}).join("  || ");b="mutations in patch for collection "+a+" version "+b+": "+c;d("WALogger").LOG(za||(za=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: ",""])),e,b);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,b)}});return T.apply(this,arguments)}function eb(a,b,c,d,e){return U.apply(this,arguments)}function U(){U=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){f===void 0&&(f=!1);var h=d("WAWebABProps").getABPropConfigValue("enable_syncd_debug_data_in_patch")||a===d("WASyncdConst").CollectionName.CriticalBlock||a===d("WASyncdConst").CollectionName.RegularLow||d("WAWebCurrentUser").isEmployee();if(h){var i,j,k;yield d("WAWebSyncdAntiTampering").logMacsInSnapshot(a,g,"pre-processing incoming patch "+c.version.version+".");yield d("WAWebSyncdAntiTampering").reportCollectionInconsistency(a,"["+g+"] pre-processing incoming patch "+c.version.version+".\n      incoming current lthash: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((i=c==null||(j=c.clientDebugData)==null?void 0:j.currentLthash)!=null?i:new ArrayBuffer(0)).slice(-16)+",\n      incoming new lthash: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded((i=c==null||(k=c.clientDebugData)==null?void 0:k.newLthash)!=null?i:new ArrayBuffer(0)).slice(-16),g,250)}if(c.exitCode){i=c.exitCode.code;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"patch exit code "+(i!=null?i:""));switch(i){case 100:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_MISSING_DATA,{collection:a});break;case 101:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_DESERIALIZATION_ERROR,{collection:a});break;default:d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TERMINAL_PATCH_UNKNOWN,{collection:a})}throw new(d("WAWebSyncdError").SyncdFatalError)("received terminal patch with exit code:  "+String(i)+" text: "+String((i=c.exitCode)==null?void 0:i.text)+"  ")}yield d("WAWebSyncdDbCallbacksApi").handleSyncBeforeApplyPatch(c);i=c.mutations.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).length;var l=c.mutations.length-i;d("WALogger").LOG(Aa||(Aa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: applying patch "," v"," from device ","\n    SET count: ","\n    REMOVE count: ",""])),g,a,c.version.version,c.deviceIndex,i,l);i===0&&l===0&&d("WALogger").WARN(Ba||(Ba=babelHelpers.taggedTemplateLiteralLoose(["syncd: ",": empty patch found"])),a).sendLogs("syncd: "+a+": empty patch found");i=ab(e);l=i.measuredComputeLtHashAndValidatePatch;i=i.measuredTryDecryptPatch;i=(yield i(a,c));d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdDecryptedMutations(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdDecryptMutationsType.PATCH_MUTATIONS,i);var m=(yield H());i.forEach(function(b){var e=d("WAWebSyncdUtils").getMutationNameFromIndex(b.index);void d("WAWebSyncdWamReportingUtils").syncReportMutationToWam(a,c.version.version,!0,d("WABase64").encodeB64UrlSafe(b.indexMac),e,b.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE,!0,m,c.patchMac?d("WABase64").encodeB64UrlSafe(c.patchMac):void 0)});yield S(a,c.version.version,i,g);f&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+g+"] after decrypt patch "+c.version.version));var n=(yield l(a,c,g,s));d("WALogger").LOG(Ca||(Ca=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed computeLtHashAndValidatePatch for "," v",""])),g,a,c.version.version);d("WAWebSyncdWamAppState").addMutationCount(i.length);d("WAWebSyncdValidateMutations").validateNoSameIndexForMultipleMutations(a,i,d("WASyncdConst").SyncDataType.Patch);l=hb(i);var o=l.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});s=(yield fb(a,o,g));s=s.pendingRemoveMutationsToDrop;d("WALogger").LOG(Da||(Da=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed _applyRemoveMutations for "," v",""])),g,a,c.version.version);l=l.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET});l=(yield V(a,l,d("WASyncdConst").SyncDataType.Patch,g,e,c.version.version,f));var p=l.setMutationsToPersist;l=l.pendingSetMutationsToDrop;d("WALogger").LOG(Ea||(Ea=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: processed "," mutations in patch version "," of collection ",""])),g,i.length,c.version.version,a);var q=s.concat(l);e==null||e.mark("update_DB_start",{source:d("WASyncdConst").SyncDataType.Patch,setMutationsToPersistCount:p.length,pendingMutationsToDropCount:q.length});var r=c.version.version;i=null;yield d("WAWebRunInTransaction").runInTransaction({SyncActionStore:!0,PendingMutationStore:!0,CollectionVersionStore:!0},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.SyncActionStore,e=b.PendingMutationStore;b=b.CollectionVersionStore;i=(yield Z(a,r,"incoming patch",b,g));i==null?(yield c.bulkRemove(o.map(function(a){return a.index})),yield c.bulkSet(p),yield e.bulkRemove(q),yield b.update(a,{version:r,ltHash:n})):d("WALogger").LOG(Fa||(Fa=babelHelpers.taggedTemplateLiteralLoose(["syncd: [","] skip applying syncd old version ",""])),g,r)});return function(a){return c.apply(this,arguments)}}());if(i!=null){s=i;yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,s);yield d("WAWebSyncdDbCallbacksApi").printSyncdLog(a);d("WALogger").ERROR(Ga||(Ga=babelHelpers.taggedTemplateLiteralLoose(["",""])),s).sendLogs("syncd: processing old version for "+a)}(h||a===d("WASyncdConst").CollectionName.RegularLow||d("WAWebCurrentUser").isEmployee())&&(yield d("WAWebSyncdAntiTampering").logMacsInSnapshot(a,g,"post-processing incoming patch "+c.version.version+"."));e==null||e.mark("update_DB_end",{source:d("WASyncdConst").SyncDataType.Patch});d("WALogger").LOG(Ha||(Ha=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: completed final transaction in _applyPatch for "," v",""])),g,a,c.version.version);f&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+g+"] after final transaction for patch "+c.version.version+". new lthash: "+d("WAWebSyncdCryptoUtils").arrayBufferToHexPadded(n).slice(-16)));function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c;return(c=(yield d("WAWebGetSyncAction").getSyncActionsByCollectionsInTransaction([a])).filter(function(a){return d("WACryptoUtils").arrayBuffersEqual(b,a.indexMac)}).pop())==null?void 0:c.valueMac});return t.apply(this,arguments)}});return U.apply(this,arguments)}function V(a,b,c,d,e,f,g){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h,i){i===void 0&&(i=!1);d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.ABOUT_TO_APPLY_MUTATIONS);var j=e===d("WASyncdConst").SyncDataType.Local?" (individual mutations)":"",k=[];b=d("WAWebSyncdValidateMutations").validateAndTypeSetMutations(a,b);b=ib(a,b);var l=b.supportedMutations;b=b.unsupportedMutations;b.forEach(function(a){return k.push(d("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Unsupported))});g==null||g.mark("conflict_resolution_start",{source:e,collectionName:a,count:l.length});d("WALogger").LOG(Ia||(Ia=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: before resolveConflict for "," v",""])),f,a,h);b=(yield d("WAWebSyncdResolveConflict").resolveConflict(a,l));var m=b.remoteMutationsToApply;b=b.pendingSetMutationsToDrop;d("WALogger").LOG(Ja||(Ja=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after resolveConflict for "," v",""])),f,a,h);l=l.filter(function(a){return!m.includes(a)});g==null||g.mark("conflict_resolution_end",{source:e,collectionName:a,apply:m.length,drop:l.length});l.forEach(function(a){return k.push(d("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(a,d("WASyncdConst").SyncActionState.Skipped,a.actionName))});g==null||g.mark("apply_set_mutations_start",{source:e,collectionName:a,count:m.length});l=jb(m);var n=null;for(var o=0;o<l.length;o++){var p=i&&o<=1,q=l[o][0].actionHandler,r=l[o].map(function(a){var b;a.binarySyncData?b=c("WANullthrows")(d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value):b=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction);(n==null||n<a.timestamp)&&(n=a.timestamp);return{operation:"set",indexParts:a.indexArr,value:b,timestamp:a.timestamp}});p&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,f+" after deserialize. mutationsToApply length: "+r.length));var s=[],t=!1;try{d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(Ka||(Ka=babelHelpers.taggedTemplateLiteralLoose(["syncd: applying mutations "," for handler "," ",""])),JSON.stringify(r.slice(0,3),null,2),q.getAction(),j);d("WALogger").LOG(La||(La=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: before apply mutation batch for "," v",", mutations count: "," ",""])),f,a,h,r.length,j);s=(yield q.applyMutations(r,{setMutationsPendingToPersist:k,allSupportedSetMutations:m},p));q=d("WAWebCurrentUser").isEmployee()?q.getAction():"-";d("WALogger").LOG(Ma||(Ma=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after apply mutation batch for "," v",", mutations count: ",", handler: "," ",""])),f,a,h,r.length,q,j);p&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"["+f+"] after apply group "+o+"/"+l.length+" for "+a+" "+(h!=null?h:"")+". result length: "+s.length))}catch(b){if(b instanceof d("WAWebSyncdError").SyncdFatalError||a===d("WASyncdConst").CollectionName.CriticalBlock)throw b;t=!0;d("WALogger").WARN(Na||(Na=babelHelpers.taggedTemplateLiteralLoose(["syncd: catching error during _applySetMutations: ",""])),b)}d("WALogger").DEV(Oa||(Oa=babelHelpers.taggedTemplateLiteralLoose(["syncd: actionStates after apply ",": ",""])),j,s.slice(0,100).map(function(a){return a.actionState}));d("WALogger").LOG(Pa||(Pa=babelHelpers.taggedTemplateLiteralLoose(["[","] syncd: after apply mutation batch for "," ",""])),f,a,j);for(r=0;r<l[o].length;r++){q=t?d("WASyncdConst").SyncActionState.Failed:s[r].actionState;k.push(d("WAWebSyncdCollectionHandlerTypesConverter").setMutationToSyncAction(l[o][r],q,l[o][r].actionName,t?void 0:(p=s[r].orphanModel)==null?void 0:p.modelId,t?void 0:(q=s[r].orphanModel)==null?void 0:q.modelType))}}p=n;q=p==null?null:d("WATimeUtils").daysDiff(d("WATimeUtils").unixTimeMs(),p);d("WALogger").LOG(Qa||(Qa=babelHelpers.taggedTemplateLiteralLoose(["syncd: max timestamp from recent patch: "," days agp"])),q!=null?q:"n/a");i&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,f+" max timestamp from recent patch: "+(q!=null?q:"n/a")+" days ago"));t=k.reduce(function(a,b){b=b.actionState;a[b]==null&&(a[b]=0);a[b]++;return a},{});g==null||g.mark("apply_set_mutations_end",babelHelpers["extends"]({source:e,collectionName:a,count:m.length},t));d("WAWebSyncdMetricCriticalBootstrapStage").reportSyncdCriticalBootstrapStage(d("WAWebSyncdMetricCriticalBootstrapStage").SyncdCriticalBootstrapStageType.APPLIED_MUTATIONS);a===d("WASyncdConst").CollectionName.CriticalBlock&&(yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,f+" apply states for "+a+" v"+(h!=null?h:"n/a")+": "+k.map(function(a){return a.actionState}).join(", ")));d("WALogger").LOG(Ra||(Ra=babelHelpers.taggedTemplateLiteralLoose([""," syncd: completed apply set mutations for "," ",""])),f,a,j);return{setMutationsToPersist:k,pendingSetMutationsToDrop:b}});return W.apply(this,arguments)}function fb(a,b,c){return X.apply(this,arguments)}function X(){X=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=gb(b);e=e.supportedMutations;e=jb(e);var f=new Set(b.map(function(a){return a.index})),g=(yield d("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a)).filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE&&f.has(a.index)}).map(function(a){return a.id}).filter(Boolean);d("WALogger").LOG(Sa||(Sa=babelHelpers.taggedTemplateLiteralLoose([""," syncd: before apply remove mutations for ",""])),c,a);for(var h=0;h<e.length;h++){var i=e[h][0].actionHandler;yield i.applyMutations(e[h].map(function(b){return{operation:"remove",indexParts:Y(a,b.index)}}),{setMutationsPendingToPersist:[],allSupportedSetMutations:[]})}d("WALogger").LOG(Ta||(Ta=babelHelpers.taggedTemplateLiteralLoose([""," syncd: after apply remove mutations for ",""])),c,a);yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,c+" after apply remove mutations for "+a+". mutation count: "+b.length);return{pendingRemoveMutationsToDrop:g}});return X.apply(this,arguments)}function gb(a){a=a.map(function(a){if(a.version>d("WAWebSyncdGetActionHandler").maxSupportedVersion())return{unsupported:a};var b=Y(a.collection,a.index),c=d("WASyncdConst").Actions.cast(b[0]);if(!c){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),b[0]);return{unsupported:a}}var e=d("WAWebSyncdGetActionHandler").getActionHandler(c);if(!e){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""])),c);return{unsupported:a}}a={collection:a.collection,index:a.index,indexMac:a.indexMac,keyId:a.keyId,binarySyncData:a.binarySyncData,valueMac:a.valueMac,version:a.version,indexArr:b,actionName:c,actionHandler:e};return{supported:a}});var b=[],c=[];a.map(function(a){var d=a.supported;a=a.unsupported;d!=null?b.push(d):a!=null&&c.push(a)});return{supportedMutations:b,unsupportedMutations:c}}function hb(a){var b=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}),c=new Set(b.map(function(a){return a.index}));a=a.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE});a.forEach(function(a){c.has(a.index)||b.push(a)});return b}function ib(a,b){b=b.map(function(b){if(b.version>d("WAWebSyncdGetActionHandler").maxSupportedVersion())return{unsupported:b};var c=Y(a,b.index),e=d("WASyncdConst").Actions.cast(c[0]);if(!e){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: invalid action ",""])),c[0]);return{unsupported:b}}var f=d("WAWebSyncdGetActionHandler").getActionHandler(e);if(!f){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: no handler for action ",""])),e);return{unsupported:b}}return{supported:{collection:b.collection,index:b.index,indexMac:b.indexMac,keyId:b.keyId,timestamp:b.timestamp,binarySyncData:b.binarySyncData,valueMac:b.valueMac,version:b.version,indexArr:c,actionName:e,actionHandler:f}}});var c=[],e=[];b.map(function(a){var b=a.supported;a=a.unsupported;b!=null?c.push(b):a!=null&&e.push(a)});return{supportedMutations:c,unsupportedMutations:e}}function jb(a){return a.reduce(function(a,b){a.length!==0&&b.actionName===a[a.length-1][0].actionName?a[a.length-1].push(b):a.push([b]);return a},[])}function Y(a,b){try{b=JSON.parse(b);if(b.length<1)throw c("err")("");return b}catch(b){d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.INVALID_ACTION_INDEX,{collection:a});throw new(d("WAWebSyncdError").SyncdFatalError)("invalid action index")}}function Z(a,b,c,d,e){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e){d=(yield d.get(a));if(d!=null&&d.version>=b)return"["+e+"] syncd: processing old version for "+a+". processing: "+b+" already persisted: "+d.version+". context: "+c});return $.apply(this,arguments)}g.applyIndividualMutations=a;g.applyAppStateSyncResponse=e}),98);
__d("WAWebSyncdDecryptMutationsWrapper",["Promise","WAServerSync.pb","WATextEncoding","WAWebEncryptionManagerSelector","WAWebSyncdDbCallbacksApi","WAWebSyncdError","WAWebSyncdKeyCache","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("WATextEncoding").newTextDecoder();function a(a,c){return(h||(h=b("Promise"))).all(c.records.map(function(b){return j(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,b)}))}function c(a,c){return(h||(h=b("Promise"))).all(c.mutations.map(function(b){return j(a,b.operation,b.record)}))}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=d("WAWebEncryptionManagerSelector").syncdEncryptionManager().decryptMutation,f=c.keyId.id,g=(yield d("WAWebSyncdKeyCache").getKeyData(f));if(!g){if(b===d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE){yield d("WAWebSyncdDbCallbacksApi").writeSyncdLog(a,"exception: no key data for remove mutations");throw new(d("WAWebSyncdError").SyncdFatalError)("no key data for remove mutations")}throw new(d("WAWebSyncdError").SyncdMissingKeyError)()}e=(yield e(a,f,g,b,c));g=e.index;c=e.version;var h=e.indexMac,j=e.valueMac;e=e.plaintext;return{index:i.decode(g),action:null,version:c,keyId:f,operation:b,indexMac:h,valueMac:j,collection:a,binarySyncData:e}});return k.apply(this,arguments)}g.tryDecryptSnapshot=a;g.tryDecryptPatch=c}),98);
__d("WAWebSyncdMMSDownload",["WAWebSyncdDecode","WAWebSyncdNetCallbacksApi","WAWebSyncdValidateServerSyncProtobuf","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebSyncdNetCallbacksApi").downloadSyncBlob(b,"snapshot",a));b=d("WAWebSyncdDecode").decodeSyncdSnapshot(a,b);return c("WAWebSyncdValidateServerSyncProtobuf").validateSnapshotProtobuf(a,b)});return h.apply(this,arguments)}function e(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebSyncdNetCallbacksApi").downloadSyncBlob(b,"patch",a));b=d("WAWebSyncdDecode").decodeSyncdMutations(a,b).mutations;return b.map(function(b){return c("WAWebSyncdValidateServerSyncProtobuf").validateMutationProtobuf(a,b)})});return i.apply(this,arguments)}g.downloadSnapshot=a;g.downloadExternalPatch=e}),98);
__d("WAWebKeyManagementSendKeyRequestApi",["Promise","WALogger","WASyncdKeyTypes","WAWebApiPeerMessageStore","WAWebKeyManagementUtils","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebSyncdCriticalBootstrapProcessingApi","WAWebSyncdCryptoUtils","WAWebUserPrefsMeUser","WAWebWamEnumBootstrapAppStateDataStageCode","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield d("WAWebKeyManagementUtils").getPeerDevices()),f=a.map(function(a){return{keyId:d("WASyncdKeyTypes").fromSyncKeyId(a)}}),g={keyIds:f};f=e.map(function(a){var b=new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,to:a,type:"protocol",subtype:"app_state_sync_key_request",kind:d("WAWebMsgType").MsgKind.PeerMessage,appStateSyncKeyRequest:g}});e=e.map(function(a){return a.getDeviceId()});a=a.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a)});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: send key request key id "," to peer deviceIds ",""])),a,e);yield d("WAWebApiPeerMessageStore").storePeerMessages(f);yield (i||(i=b("Promise"))).all(f.map(function(a){return d("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:a})}));d("WAWebSyncdCriticalBootstrapProcessingApi").logCriticalBootstrapStageIfNecessary(d("WAWebWamEnumBootstrapAppStateDataStageCode").BOOTSTRAP_APP_STATE_DATA_STAGE_CODE.MISSING_KEYS_REQUESTED);return e});return j.apply(this,arguments)}g.sendAppStateSyncKeyRequest=a}),98);
__d("WAWebKeyManagementSendKeyShareApi",["Promise","WALogger","WASyncdKeyTypes","WAWebApiPeerMessageStore","WAWebKeyManagementUtils","WAWebMsgKey","WAWebMsgType","WAWebSendAppStateSyncMsgJob","WAWebSyncdCryptoUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e,f;a.type==="key_rotation"?(e=k(a.keys),f=(yield d("WAWebKeyManagementUtils").getPeerDevices())):a.type==="missing_key"&&(e=k(a.keys,a.orphanKeys),f=[a.peerDeviceId]);if(f==null)return(i||(i=b("Promise"))).resolve();var g=f,j=g.map(function(a){var b=new(c("WAWebMsgKey"))({fromMe:!0,remote:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,to:a,type:"protocol",subtype:"app_state_sync_key_share",kind:d("WAWebMsgType").MsgKind.PeerMessage,appStateSyncKeyShare:e}});g=g.map(function(a){return a.getDeviceId()});var l=a.keys.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: send key share key id "," to peer deviceIds "," due to ",""])),l,g,a.type);yield d("WAWebApiPeerMessageStore").storePeerMessages(j);yield (i||(i=b("Promise"))).all(j.map(function(a){return d("WAWebSendAppStateSyncMsgJob").encryptAndSendKeyMsg({msg:a})}))});return j.apply(this,arguments)}function k(a,b){a=a.map(function(a){return{keyId:{keyId:d("WASyncdKeyTypes").fromSyncKeyId(a.keyId)},keyData:{keyData:d("WASyncdKeyTypes").fromSyncKeyData(a.keyData),fingerprint:{rawId:a.fingerprint.rawId,currentIndex:a.fingerprint.currentIndex,deviceIndexes:a.fingerprint.deviceIndexes},timestamp:a.timestamp}}});if(b){b=b.map(function(a){return{keyId:{keyId:d("WASyncdKeyTypes").fromSyncKeyId(a)},keyData:void 0}});a=a.concat(b)}return{keys:a}}g.sendAppStateSyncKeyShare=a}),98);
__d("WAWebSyncdHandleMissingKeys",["Promise","WALogger","WASyncdKeyTypes","WAWebGetMissingKey","WAWebGetSyncKey","WAWebOfflineHandler","WAWebSyncdCryptoUtils","WAWebSyncdError","WAWebSyncdKeyCallbacksApi","WAWebSyncdStoreMissingKeys","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p=d("WASyncdKeyTypes").toSyncKeyId(new ArrayBuffer(0));function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new Set(),e=(yield d("WAWebGetSyncKey").getAllSyncKeysInTransaction()).map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)});b.records.forEach(function(a){a=a.keyId.id;if(d("WAWebSyncdCryptoUtils").syncKeyIdsEqual(a,p))throw new(d("WAWebSyncdError").SyncdFatalError)("snapshot has empty key");a=d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a);e.includes(a)||c.add(a)});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s snapshot has missing keys ",""])),a,Array.from(c));yield s(c)});return q.apply(this,arguments)}function c(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new Set(),e=(yield d("WAWebGetSyncKey").getAllSyncKeysInTransaction()).map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)});b.forEach(function(a){var b=a.keyId.id;if(d("WAWebSyncdCryptoUtils").syncKeyIdsEqual(b,p))throw new(d("WAWebSyncdError").SyncdFatalError)("syncd: patch has empty key. patch device id: ${p.deviceIndex}");b=d("WAWebSyncdCryptoUtils").syncKeyIdToHex(b);e.includes(b)||(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: handleMissingKeysInPatches: missing key: keyId: ",", patch version: ",", patch device id: ",""])),b,a.version.version,a.deviceIndex),c.add(b))});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: collection ","'s patches has missing keys ",""])),a,Array.from(c));yield s(c)});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()?"idle":"processing";if(c!=="idle"){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: skipping due to resume from restart in progress"])));return}c=Array.from(a);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys [","]"])),c);var e=new Set((yield d("WAWebGetMissingKey").bulkGetMissingKeysInTransaction(c)).filter(Boolean).map(function(a){return a.keyHex}));a=c.filter(function(a){return!e.has(a)});d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: _handleMissingKeys: missing keys after filter: [","]"])),a);if(a.length===0)return(o||(o=b("Promise"))).resolve();c=a.map(function(a){return d("WASyncdKeyTypes").toSyncKeyId(d("WAWebSyncdCryptoUtils").hexToUint8Array(a).buffer)});a=(yield d("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRequest(c));yield d("WAWebSyncdStoreMissingKeys").addMissingKeys(c,a)});return t.apply(this,arguments)}function e(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebGetMissingKey").getAllMissingKeysInTransaction());d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: requestAllMissingKeys: missing keys: [","]"])),a.map(function(a){return a.keyHex}));if(a.length===0)return;yield d("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRequest(a.map(function(a){return a.keyId}))});return u.apply(this,arguments)}g.handleMissingKeysInSnapshot=a;g.handleMissingKeysInPatches=c;g.requestAllMissingKeys=e}),98);
__d("WAWebSyncdRotateKey",["WAArrayBuffersConcat","WABaseGlobals","WAByteArray","WACryptoDependencies","WAJids","WASyncdKeyManagementUtils","WASyncdKeyTypes","WATimeUtils","WAWebSyncdGatingUtils","equalsSet"],(function(a,b,c,d,e,f,g){"use strict";var h=1,i=90;function a(a){a=a.timestamp;var b=Math.min(i,Math.max(h,d("WAWebSyncdGatingUtils").getSyncdKeyMaxUseDays()));b=b*d("WATimeUtils").DAY_MILLISECONDS;a=d("WATimeUtils").unixTimeMs()-a;return a>b}function b(a,b){a=a.fingerprint;var d=b.rawId,e=b.currentIndex;b=b.deviceIndexes;var f=new Set(a.deviceIndexes);for(var g=a.currentIndex+1;g<=e;g++)f.add(g);return a.rawId!==d||!c("equalsSet")(f,new Set(b))}function e(a,b){b=j(b);var c=b.keyId;b=b.keyEpoch;var e=k(),f=d("WATimeUtils").unixTimeMs();return{keyId:c,keyEpoch:b,keyData:e,fingerprint:a,timestamp:f}}function j(a){if(a==null){var b=new Uint8Array(16);d("WACryptoDependencies").getCrypto().getRandomValues(b);b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(d("WASyncdKeyTypes").toSyncKeyId(b.buffer))}else b=d("WASyncdKeyManagementUtils").generateNewKeyEpoch(a.keyId);a=d("WAJids").interpretAsNumber(d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()));return{keyId:d("WASyncdKeyTypes").toSyncKeyId(new Uint8Array(d("WAArrayBuffersConcat").concatArrayBuffers(d("WAByteArray").intToBytes(2,a).buffer,d("WAByteArray").intToBytes(4,b).buffer)).buffer),keyEpoch:b}}function k(){return d("WASyncdKeyTypes").toSyncKeyData(d("WACryptoDependencies").getCrypto().getRandomValues(new Uint8Array(32)).buffer)}g.hasKeyExpired=a;g.hasADeviceBeenRemoved=b;g.rotateKey=e}),98);
__d("WAWebSyncdKeyManagement",["WALogger","WAPromiseQueue","WASyncdKeyManagementUtils","WAWebGetSyncKey","WAWebSyncdCryptoUtils","WAWebSyncdKeyCallbacksApi","WAWebSyncdMetrics","WAWebSyncdRotateKey","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=new(d("WAPromiseQueue").PromiseQueue)();function a(a){a===void 0&&(a=!0);return l.enqueue(function(){return m(a)})}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!0);var b=(yield o()),e=(yield d("WAWebSyncdKeyCallbacksApi").getDeviceFingerprint()),f=!1,g=!1;if(b!=null){f=d("WAWebSyncdRotateKey").hasKeyExpired(b);g=d("WAWebSyncdRotateKey").hasADeviceBeenRemoved(b,e);if(!a||!f&&!g)return{keyId:b.keyId,keyData:b.keyData}}else throw c("err")("syncd: No sync key available");e=d("WAWebSyncdRotateKey").rotateKey(e,b);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: stored key rotation key id ",""])),d("WAWebSyncdCryptoUtils").syncKeyIdToHex(e.keyId));yield d("WAWebGetSyncKey").setSyncKeyInTransaction(e);yield d("WAWebSyncdKeyCallbacksApi").sendSyncdKeyRotation([e]);f&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to key expiry"]))),d("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(d("WAWebSyncdMetrics").SyncdKeyRotationEventType.APP_STATE_SYNC_KEY_EXPIRY));g&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to device removal"]))),d("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(d("WAWebSyncdMetrics").SyncdKeyRotationEventType.DEVICE_DEREGISTERATION));b==null&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: key rotation due to no key present"]))),d("WAWebSyncdMetrics").reportSyncdKeyRotationEvent(d("WAWebSyncdMetrics").SyncdKeyRotationEventType.NO_KEYS));return m(a)});return n.apply(this,arguments)}function o(){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebGetSyncKey").getAllSyncKeysInTransaction());if(a.length===0)return null;var b=a.map(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)}),c=Math.max.apply(Math,b);b=a.filter(function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)===c});a=b.map(function(a){return d("WASyncdKeyManagementUtils").getKeyDeviceId(a.keyId)});var e=Math.min.apply(Math,a);a=a.indexOf(e);return b[a]});return p.apply(this,arguments)}g.getActiveKey=a;g.getNewestKeyPair=o}),98);
__d("WAWebSyncdRequestBuilderUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return g(a.reverse(),function(a){return a.index}).reverse()}function g(a,b){var c=new Set();return a.filter(function(a){a=b(a);if(c.has(a))return!1;c.add(a);return!0})}f.compactPatch=a}),66);
__d("WAWebSyncdRequestBuilder",["Promise","WAWebGetPendingMutation","WAWebSyncdRequestBuilderBuild","WAWebSyncdRequestBuilderUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=new Map(),f=new Map();yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebGetPendingMutation").getSyncPendingMutationsByCollectionInTransaction(a)),c=b.map(function(a){return a.id}).filter(Boolean);f.set(a,c);c=d("WAWebSyncdRequestBuilderUtils").compactPatch(b);e.set(a,c)});return function(b){return a.apply(this,arguments)}}()));a=(yield d("WAWebSyncdRequestBuilderBuild").buildSyncIqNode(e,c));return{syncIqNode:a.syncIqNode,collectionWithPendingMutationsIds:f,collectionWithEncryptedMutations:a.collectionWithEncryptedMutations,localCollectionVersions:a.localCollectionVersions,collectionsToSkip:a.collectionsToSkip}});return i.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebSyncdEncryptMutationsWrapper",["WAServerSync.pb","WAWebEncryptionManagerSelector","WAWebGetSyncAction","WAWebSyncdCrypto","WAWebSyncdError","WAWebSyncdKeyCache","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebEncryptionManagerSelector").syncdEncryptionManager().encryptMutation,e=a.index,f=a.operation,g=b.keyId;b=b.keyData;switch(f){case d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET:break;case d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE:f=(yield d("WAWebGetSyncAction").getSyncActionInTransaction(e));if(!f)throw new(d("WAWebSyncdError").SyncdFatalError)("no corresponding set mutation");e=f.keyId;f=(yield d("WAWebSyncdKeyCache").getKeyData(e));if(f==null)throw new(d("WAWebSyncdError").SyncdFatalError)("no key data for corresponding mutation");g=e;b=f}e=(yield c(a,g,b));f=e.indexMac;c=e.indexAndValueCipherText;e=d("WAWebSyncdCrypto").valueMacFromIndexAndValueCipherText(c);return babelHelpers["extends"]({},a,{keyId:g,keyData:b,indexMac:f,indexAndValueCipherText:c,valueMac:e})});return h.apply(this,arguments)}g.encryptMutation=a}),98);
__d("WAWebSyncdMMSUpload",["WAWebSyncdGatingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=100,i=2e3,j=10,k=100;function a(a){var b=Math.min(i,Math.max(d("WAWebSyncdGatingUtils").getSyncdInlineMutationsMaxCount(),h));return a.length>b}function b(a){var b=Math.min(k,Math.max(d("WAWebSyncdGatingUtils").getSyncdPatchProtobufMaxSize(),j))*1e3;return a.byteLength>b}g.exceedInlineMutationCount=a;g.exceedPatchProtobufSize=b}),98);
__d("WAWebSyncdRequestBuilderBuild",["Promise","WABase64","WABaseGlobals","WAJids","WALogger","WAMediaCalculateFilehash","WAServerSync.pb","WASyncAction.pb","WASyncdConst","WASyncdKeyManagementUtils","WASyncdKeyTypes","WAWap","WAWebABProps","WAWebBrokerGlobalAppState","WAWebGetCollectionVersion","WAWebGetSyncAction","WAWebSyncdAntiTampering","WAWebSyncdCryptoUtils","WAWebSyncdEncryptMutationsWrapper","WAWebSyncdKeyManagement","WAWebSyncdMMSUpload","WAWebSyncdNetCallbacksApi","WAWebSyncdRequestBuilderTypesConverter","WAWebSyncdRequestEncode","WAWebSyncdUtils","WAWebSyncdWamAppState","asyncToGeneratorRuntime","encodeProtobuf","sortBy"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=5;function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield o(a,b));b=a.collectionNodes;var c=a.collectionWithEncryptedMutations,e=a.localCollectionVersions;a=a.collectionsToSkip;b=n(d("WAWap").wap("sync",null,b));return{syncIqNode:b,collectionWithEncryptedMutations:c,localCollectionVersions:e,collectionsToSkip:a}});return m.apply(this,arguments)}function n(a){return d("WAWap").wap("iq",{id:d("WAWap").generateId(),to:d("WAWap").S_WHATSAPP_NET,type:"set",xmlns:"w:sync:app:state"},a)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: start _buildCollectionNodes"])));var e=[],f=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var f=(yield d("WAWebGetCollectionVersion").getCollectionVersionInTransaction(a).then(function(a){return a==null?void 0:a.version})),g,h;if(b!=null&&b.length>0)if(f==null)d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: skipping "," in sync iq patch because initial full sync\n        is incomplete"])),a),e.push(a);else{b=(yield q(a,b,c));var j=b.patchNode;b=b.encryptedMutations;g=j;h=b}return{collection:a,version:f,patchNode:g,encryptedMutations:h}});return function(b,c){return a.apply(this,arguments)}}(),g=new Map(),l=new Map(),m=[];a.forEach(function(a,b){return m.push(f(b,a))});a=(yield (k||(k=b("Promise"))).all(m));a=a.map(function(a){var b=a.collection,c=a.version,e=a.patchNode;a=a.encryptedMutations;a&&l.set(b,a);g.set(b,c);return d("WAWap").wap("collection",{name:d("WAWap").CUSTOM_STRING(b),return_snapshot:c===void 0?"true":"false",version:d("WAWap").INT(c!=null?c:d("WASyncdConst").DEFAULT_COLLECTION_VERSION)},e)});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: end _buildCollectionNodes"])));return{collectionNodes:a,collectionWithEncryptedMutations:l,localCollectionVersions:g,collectionsToSkip:e}});return p.apply(this,arguments)}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=(yield d("WAWebSyncdKeyManagement").getActiveKey(!s(c)));c=(yield z(a,c,f));c=c.map(function(a){return d("WAWebSyncdEncryptMutationsWrapper").encryptMutation(a,f)});c=(yield (k||(k=b("Promise"))).all(c));var g=c.map(function(a){return{indexMac:a.indexMac,valueMac:a.valueMac,operation:a.operation}});g=(yield d("WAWebSyncdAntiTampering").computeLtHash(a,g,e));e=g.ltHash;g=(yield d("WAWebSyncdAntiTampering").computeOutgoingSnapshotAndPatchMacs(a,e,c,f.keyData));var h=g.snapshotMac,i=g.patchMac;c.map(function(a){a.patchMac=i});a=c.map(function(a){return y(a.keyId,a.operation,a.indexMac,a.indexAndValueCipherText)});var j=x(a);e=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSyncdNetCallbacksApi").uploadSyncExternalPatch(j));a=(yield t(a,j));return v(a,f.keyId,h,i)});return function(){return a.apply(this,arguments)}}();d("WAWebSyncdMMSUpload").exceedInlineMutationCount(a)?g=(yield e()):(g=w(a,f.keyId,h,i),d("WAWebSyncdMMSUpload").exceedPatchProtobufSize(g)&&(g=(yield e())));a=d("WAWap").wap("patch",null,g);return{patchNode:a,encryptedMutations:c}});return r.apply(this,arguments)}function s(a){return c("WAWebBrokerGlobalAppState").isLogoutInProgress&&a.some(function(a){return d("WAWebSyncdUtils").getMutationNameFromIndex(a.index)===d("WASyncdConst").Actions.Sentinel})}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.mediaKey,e=a.directPath,f=a.encFilehash;a=a.handle;var g=(yield d("WAMediaCalculateFilehash").calculateFilehash(b));return{mediaKey:c,directPath:e,handle:a,fileSizeBytes:b.byteLength,fileSha256:d("WABase64").decodeB64(g),fileEncSha256:f}});return u.apply(this,arguments)}function v(a,b,c,e){var f=d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid());return d("WAWebSyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},externalMutations:a,snapshotMac:c,patchMac:e,deviceIndex:f})}function w(a,b,c,e){var f=d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid()),g=d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").PatchDebugDataSpec,{isSenderPrimary:!1,senderPlatform:d("WASyncAction.pb").PatchDebugData$Platform.WEB}).readBuffer();return d("WAWebSyncdRequestEncode").encodeSyncdPatch({keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(b)},mutations:a,snapshotMac:c,patchMac:e,deviceIndex:f,clientDebugData:g})}function x(a){return d("WAWebSyncdRequestEncode").encodeSyncdMutations({mutations:a})}function y(a,b,c,e){return{operation:b,record:{keyId:{id:d("WASyncdKeyTypes").fromSyncKeyId(a)},index:{blob:c},value:{blob:e}}}}function z(a,b,c){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("WAWebGetSyncAction").getSyncActionsByCollectionsInTransaction([a]));var e=b;b=B(a,b,c.keyId);e=e.concat(b);b=C(a,e,c.keyId);d("WAWebSyncdWamAppState").addKeyRotationRemoveCount(b.length);e=e.concat(b);return e});return A.apply(this,arguments)}function B(a,b,e){a=a.filter(function(a){return!b.map(function(a){return a.index}).includes(a.index)&&!d("WAWebSyncdCryptoUtils").syncKeyIdsEqual(a.keyId,e)});a=c("sortBy")(a,function(a){return d("WASyncdKeyManagementUtils").getKeyEpoch(a.keyId)});var f=Math.min(l,d("WAWebABProps").getABPropConfigValue("syncd_additional_mutations_count"));a=a.slice(0,f);return d("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET)}function C(a,b,c){var e=b.filter(function(a){return a.operation===d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET}).map(function(a){return a.index});b=a.filter(function(a){return e.includes(a.index)});a=b.filter(function(a){return!d("WAWebSyncdCryptoUtils").syncKeyIdsEqual(a.keyId,c)});return d("WAWebSyncdRequestBuilderTypesConverter").syncActionsToPendingMutations(a,d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE)}g.buildSyncIqNode=a;g._generateMutationsToUpload=z}),98);
__d("WAWebSyncdResolveMessages",["Promise","WAWebSchemaMessage","WAWebSyncdGetChat","WAWebSyncdIndexUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=new Map();a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.indexParts;var b=a[1],e=a[2],g=a[3];a=a[4];if(!b||!e||!g||!a)return null;if(!c("WAWebWid").isWid(b))return null;var h=(yield d("WAWebSyncdGetChat").resolveChatForMutationIndex(d("WAWebWidFactory").createWid(b)));if(!h.success)return;h=h.chat.id;f.set(b,h);return(b=d("WAWebSyncdIndexUtils").syncKeyToMsgKey(h,e,g,a,!1))==null?void 0:b.toString()});return function(b){return a.apply(this,arguments)}}()))).filter(Boolean);yield d("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["id"],a).then(function(a){return a.forEach(function(a){a&&e.push(a.id)})});return{messagesInDB:e,incomingRemoteToLocalChatId:f}});return i.apply(this,arguments)}g.resolveMessagesForMutations=a}),98);
__d("WAWebWamEnumMdCompanionDeviceAccountType",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE_DEVICE:1,HOSTED_DEVICE:2});f.MD_COMPANION_DEVICE_ACCOUNT_TYPE=a}),66);
__d("WAWebWamEnumMdSyncdFatalErrorSource",[],(function(a,b,c,d,e,f){a=Object.freeze({SNAPSHOT:1,EXTERNAL_PATCH:2,INLINE_PATCH:3});f.MD_SYNCD_FATAL_ERROR_SOURCE=a}),66);
__d("WAWebMdFatalErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCollection","WAWebWamEnumIsPureSyncdSessionEnum","WAWebWamEnumLidMigrationStageEnum","WAWebWamEnumMdCompanionDeviceAccountType","WAWebWamEnumMdSyncdFatalErrorCode","WAWebWamEnumMdSyncdFatalErrorSource","WAWebWamEnumRecoveryStatusEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdFatalError:[2304,{appContext:[46,a.TYPES.STRING],appContextBitfield:[47,a.TYPES.INTEGER],appSessionId:[41,a.TYPES.STRING],collection:[2,d("WAWebWamEnumCollection").COLLECTION],companionSessionIds:[42,a.TYPES.STRING],currentPrimaryAppVersion:[14,a.TYPES.STRING],daysSinceLastPeriodicSync:[11,a.TYPES.INTEGER],didBootstrapFromSnapshot:[38,a.TYPES.BOOLEAN],hoursSinceFirstFiniteFailure:[12,a.TYPES.INTEGER],isBootstrap:[3,a.TYPES.BOOLEAN],isFatal:[16,a.TYPES.BOOLEAN],isPatchSenderPrimary:[23,a.TYPES.BOOLEAN],isPreviousPatchAnIncomingPatch:[24,a.TYPES.BOOLEAN],isPreviousPatchSenderPrimary:[25,a.TYPES.BOOLEAN],isPureSyncdSession:[48,d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM],isSenderIndexSameAsPreviousSenderIndex:[39,a.TYPES.BOOLEAN],isThereAnotherSyncdCompanion:[40,a.TYPES.BOOLEAN],isWebLthashConsistent:[17,a.TYPES.BOOLEAN],lidMigrationStage:[49,d("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM],macFatalCollectionNameMismatch:[18,a.TYPES.BOOLEAN],macFatalCurrentLthashMismatch:[19,a.TYPES.BOOLEAN],macFatalDidPreviousPatchFailPostSaveValidation:[26,a.TYPES.BOOLEAN],macFatalDidUseMacFetchFallback:[36,a.TYPES.BOOLEAN],macFatalFirstTwoBytesFromAHashOfSnapshotMacKeyMismatch:[20,a.TYPES.BOOLEAN],macFatalHasMissingRemove:[37,a.TYPES.BOOLEAN],macFatalNewLthashMismatch:[21,a.TYPES.BOOLEAN],macFatalNewLthashSubtractMismatch:[27,a.TYPES.BOOLEAN],macFatalNumberAddMismatch:[28,a.TYPES.BOOLEAN],macFatalNumberHasOverrideMutation:[29,a.TYPES.BOOLEAN],macFatalNumberNumAddMutation:[30,a.TYPES.INTEGER],macFatalNumberNumRemoveMutation:[31,a.TYPES.INTEGER],macFatalNumberOverrideMismatch:[32,a.TYPES.BOOLEAN],macFatalNumberRemoveMismatch:[33,a.TYPES.BOOLEAN],macFatalPatchVersionMismatch:[22,a.TYPES.BOOLEAN],macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:[34,a.TYPES.BOOLEAN],macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:[35,a.TYPES.BOOLEAN],mailboxAgeDays:[13,a.TYPES.INTEGER],mdCompanionDeviceAccountType:[43,d("WAWebWamEnumMdCompanionDeviceAccountType").MD_COMPANION_DEVICE_ACCOUNT_TYPE],mdFatalErrorCode:[1,d("WAWebWamEnumMdSyncdFatalErrorCode").MD_SYNCD_FATAL_ERROR_CODE],mdRegAttemptId:[44,a.TYPES.STRING],patchSnapshotMutationCount:[9,a.TYPES.INTEGER],patchVersion:[5,a.TYPES.INTEGER],recoveryRequestDurationMs:[50,a.TYPES.INTEGER],recoveryStatus:[51,d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM],seqNumber:[45,a.TYPES.INTEGER],sessionStartPrimaryAppVersion:[15,a.TYPES.STRING],sourceType:[10,d("WAWebWamEnumMdSyncdFatalErrorSource").MD_SYNCD_FATAL_ERROR_SOURCE],timeSincePairingMs:[6,a.TYPES.INTEGER],timeSinceRefreshMs:[7,a.TYPES.INTEGER],timeSinceTabTakeoverMs:[8,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MdFatalError:[]});g.MdFatalErrorWamEvent=b}),98);
__d("WAWebSyncdUploadFatalErrorMetric",["WASyncAction.pb","WATimeUtils","WAWebABProps","WAWebAppTracker","WAWebMdFatalErrorWamEvent","WAWebSchemaSyncActions","WAWebSyncBootstrap","WAWebSyncdCollectionsStateMachine","WAWebSyncdUtils","WAWebUserPrefsAppStateSync","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h=d("WATimeUtils").unixTime();function a(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H){a={mdFatalErrorCode:a,collection:b?d("WAWebSyncdUtils").collectionNameToMetric(b):void 0,isBootstrap:c("WAWebSyncBootstrap").isSyncDCriticalDataSyncInProcess()};b=d("WAWebUserPrefsMultiDevice").getPairingTimestamp();b=b!=null?(d("WATimeUtils").unixTime()-b)*1e3:void 0;a=babelHelpers["extends"]({},a,{timeSinceRefreshMs:(d("WATimeUtils").unixTime()-h)*1e3,timeSincePairingMs:b,patchSnapshotMutationCount:e,patchVersion:f,isFatal:g,isWebLthashConsistent:i,macFatalCollectionNameMismatch:j,macFatalCurrentLthashMismatch:k,macFatalNewLthashMismatch:l,macFatalPatchVersionMismatch:m,macFatalNewLthashSubtractMismatch:n,macFatalNumberHasOverrideMutation:o,macFatalNumberNumAddMutation:p,macFatalNumberNumRemoveMutation:q,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:r,isPatchSenderPrimary:s,macFatalDidUseMacFetchFallback:t,macFatalHasMissingRemove:u,macFatalNumberAddMismatch:v,macFatalNumberRemoveMismatch:w,macFatalDidPreviousPatchFailPostSaveValidation:x,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:y,isPreviousPatchAnIncomingPatch:z,isPreviousPatchSenderPrimary:A,isSenderIndexSameAsPreviousSenderIndex:B,didBootstrapFromSnapshot:C,isThereAnotherSyncdCompanion:D,isPureSyncdSession:E,lidMigrationStage:F,recoveryRequestDurationMs:G,recoveryStatus:H});a=babelHelpers["extends"]({},a,{appContext:d("WAWebAppTracker").AppTracker.getAppContext()});if(d("WAWebABProps").getABPropConfigValue("web_syncd_fatal_fields_from_L1104589PRV2")){b=(yield d("WAWebUserPrefsMultiDevice").getRecentMailboxAgeDays());e=(yield d("WAWebUserPrefsAppStateSync").getLastPeriodicAppStateSyncTs());f=c("WAWebSyncdCollectionsStateMachine").getCollectionMinFailureTime();a=babelHelpers["extends"]({},a,{mailboxAgeDays:b==null?void 0:b,daysSinceLastPeriodicSync:e==null?void 0:Math.trunc((d("WATimeUtils").unixTime()-e)/60/60/24),hoursSinceFirstFiniteFailure:f==null?void 0:Math.trunc((d("WATimeUtils").unixTimeMs()-f)/1e3/60/60)});g=(yield d("WAWebSchemaSyncActions").getSyncActionsTable().get('["primary_version","current"]'));i=(yield d("WAWebSchemaSyncActions").getSyncActionsTable().get('["primary_version","session_start"]'));if(g||i){var I,J;j=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,g==null?void 0:g.binarySyncData).value;k=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,i==null?void 0:i.binarySyncData).value;a=babelHelpers["extends"]({},a,{currentPrimaryAppVersion:(l=j==null||(I=j.primaryVersionAction)==null?void 0:I.version)!=null?l:void 0,sessionStartPrimaryAppVersion:(m=k==null||(J=k.primaryVersionAction)==null?void 0:J.version)!=null?m:void 0})}}yield new(d("WAWebMdFatalErrorWamEvent").MdFatalErrorWamEvent)(a).commitAndWaitForFlush(!0)});return i.apply(this,arguments)}g.uploadFatalErrorMetric=a}),98);
__d("WAWebRequestSyncdSnapshotRecovery",["Promise","WALogger","WANullthrows","WAPromiseTimeout","WAResolvable","WAServerSync.pb","WASyncdConst","WASyncdKeyTypes","WATextEncoding","WATimeUtils","WAWebProtobufSyncAction.pb","WAWebProtobufsE2E.pb","WAWebSendNonMessageDataRequest","WAWebSyncdCrypto","WAWebSyncdKeyCache","asyncToGeneratorRuntime","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=d("WATextEncoding").newTextDecoder(),n=6e4;a=function(){function a(){this.recoveryPromise=new Map(),this.recoveryInflight=null}var e=a.prototype;e.requestRecoveryWithTimeout=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAPromiseTimeout").promiseTimeout(this.requestRecoveryFromPrimary(a),n));return a}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during recovery request ",""])),a);return null}});function c(b){return a.apply(this,arguments)}return c}();e.requestRecoveryFromPrimary=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=null;try{this.recoveryInflight!=null&&(yield this.recoveryInflight.promise);this.recoveryInflight=new(d("WAResolvable").Resolvable)();this.recoveryPromise.has(a)||this.recoveryPromise.set(a,new(d("WAResolvable").Resolvable)());yield d("WAWebSendNonMessageDataRequest").sendPeerDataOperationRequest(d("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY,{collectionName:a,timestamp:d("WATimeUtils").unixTime()});var e=(yield c("WANullthrows")(this.recoveryPromise.get(a)).promise);if(e==null||String(e==null?void 0:e.collectionName)!==String(a)){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] Null response or collection name missmatch. Collection name: ",", expected: ",""])),e==null?void 0:e.collectionName,a);throw c("err")("syncd recovery: null or collection name missmatch")}b=(yield this.convertSyncdSnapshotRecoveryResponseToSnapshot(e))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during response processing ",""])),a)}this.recoveryInflight!=null&&this.recoveryInflight.resolve();this.recoveryPromise.set(a,new(d("WAResolvable").Resolvable)());return b});function e(b){return a.apply(this,arguments)}return e}();e.convertSyncdSnapshotRecoveryResponseToSnapshot=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.mutationRecords,f=a.collectionName,g=a.collectionLthash;a=a.version;if(a==null)throw c("err")("syncd recovery: syncdVersion is null");e=(yield (l||(l=b("Promise"))).all(e.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.keyId,e=a.value;a=a.mac;if(e==null||b==null)throw c("err")("syncd recovery: unexpected null value in mutation record");var g=e.index,h=e.version;if(g==null||h==null||a==null)throw c("err")("syncd recovery: unexpected null value in mutation value");var i=null;try{i=(yield d("WAWebSyncdKeyCache").getKeyData(d("WASyncdKeyTypes").toSyncKeyId(b)))}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[syncd recovery] error occured during key data retrieval. error: ",""])),a instanceof Error&&a.name).sendLogs("syncd-recovery-key-data-error")}i=(yield d("WAWebSyncdCrypto").generateEncryptionKeys(c("WANullthrows")(i)));i=i.indexKey;i=(yield d("WAWebSyncdCrypto").generateIndexMac(c("WANullthrows")(i),c("WANullthrows")(g)));e=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufSyncAction.pb").SyncActionDataSpec,e).readBuffer();var j=d("WASyncdConst").CollectionName.cast(f);if(j==null)throw c("err")("syncd recovery: invalid collection name");g={index:m.decode(g),action:null,binarySyncData:e,operation:d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET,version:h,keyId:d("WASyncdKeyTypes").toSyncKeyId(b),indexMac:i,valueMac:a,collection:j};return g});return function(b){return a.apply(this,arguments)}}())));return{collectionLthash:c("WANullthrows")(g),version:Number(a.version),decryptedMutations:e}});function e(b){return a.apply(this,arguments)}return e}();e.resolveRecoveryPromise=function(a,b){a=this.recoveryPromise.get(a);a!=null&&a.resolve(b)};return a}();e=new a();g.SyncdSnapshotRecoveryModule=e}),98);
__d("WAWebApiPrivacyDisallowedList",["WALogger","WAWebSchemaPrivacyDisallowedList","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("WAWebSchemaPrivacyDisallowedList").getPrivacyDisallowedListTable().all());return j(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["privacy_settings_drawer: get all privacy disallowed lists failed"]))).verbose().devConsole(a).sendLogs("privacy_settings_drawer: get all privacy disallowed lists failed");return{about:null,groupadd:null,last:null,profile:null}}});return i.apply(this,arguments)}function j(a){var b={about:null,groupadd:null,last:null,profile:null};a.forEach(function(a){switch(a.id){case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.About:b.about=a;return;case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.GroupAdd:b.groupadd=a;return;case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.LastSeen:b.last=a;return;case d("WAWebSchemaPrivacyDisallowedList").PrivacyDisallowedListType.ProfilePicture:b.profile=a;return}});return b}g.queryDisallowedLists=a;g.disallowedRowsToLists=j}),98);
__d("WAWebApiPrivacyEphemerality",["WALogger","WAWebABProps","WAWebSchemaChat","WAWebSchemaGroupMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("WAWebSchemaChat").getChatTable().greaterThan(["ephemeralDuration"],0,{shouldDecrypt:!1})),b=a.length;a=a.filter(function(a){return a.disappearingModeInitiatedByMe===!0}).length;var c=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().greaterThan(["ephemeralDuration"],0));c=d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")?c.filter(function(a){return a.disappearingModeInitiatedByMe===!0}).length:0;a=a+c;return{isEphemeralMessagingUser:a>0,countEphemeralThreadsEnabledByMe:a,countEphemeralThreads:b}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ephemerality_daily_logs: retrieving current ephemerality information failed"]))).verbose().devConsole(a).sendLogs("ephemerality_daily_logs: retrieving current ephemerality information failed");return{isEphemeralMessagingUser:null,countEphemeralThreadsEnabledByMe:null,countEphemeralThreads:null}}});return i.apply(this,arguments)}g.queryEphemeralityDailyLogInfo=a}),98);
__d("WAWebCommunityHomeActionWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CommunityHomeAction:[3494,{communityHomeGroupDiscoveries:[1,a.TYPES.INTEGER],communityHomeGroupJoins:[2,a.TYPES.INTEGER],communityHomeGroupNavigations:[3,a.TYPES.INTEGER],communityHomeId:[4,a.TYPES.STRING],communityHomeViews:[5,a.TYPES.INTEGER]},[1,1,1],"regular"]},{CommunityHomeAction:[]});g.CommunityHomeActionWamEvent=b}),98);
__d("WAWebCommunityTabActionWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CommunityTabAction:[3496,{communityNoActionTabViews:[4,a.TYPES.INTEGER],communityTabGroupNavigations:[1,a.TYPES.INTEGER],communityTabToHomeViews:[2,a.TYPES.INTEGER],communityTabViews:[3,a.TYPES.INTEGER],communityTabViewsViaContextMenu:[5,a.TYPES.INTEGER]},[1,1,1],"regular"]},{CommunityTabAction:[]});g.CommunityTabActionWamEvent=b}),98);
__d("WAWebWamEnumBackupEncryptionMethod",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_E2EE:1,E2EE_PASSWORD:2,E2EE_64DIGIT:3,E2EE_PASSKEY:4});f.BACKUP_ENCRYPTION_METHOD=a}),66);
__d("WAWebWamEnumBackupNetworkSetting",[],(function(a,b,c,d,e,f){a=Object.freeze({WIFI_ONLY:0,WIFI_OR_CELLULAR:1});f.BACKUP_NETWORK_SETTING=a}),66);
__d("WAWebWamEnumBackupSchedule",[],(function(a,b,c,d,e,f){a=Object.freeze({OFF:0,DAILY:1,WEEKLY:2,MONTHLY:3,MANUAL:4});f.BACKUP_SCHEDULE=a}),66);
__d("WAWebWamEnumContactsPermissionAuthorizationStatusType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_DETERMINED:1,RESTRICTED:2,DENIED:3,AUTHORIZED:4,LIMITED:5});f.CONTACTS_PERMISSION_AUTHORIZATION_STATUS_TYPE=a}),66);
__d("WAWebWamEnumEmailState",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_ADDED:1,UNVERIFIED:2,VERIFIED:3,UNCONFIRMED:4});f.EMAIL_STATE=a}),66);
__d("WAWebWamEnumGalleryPermissionState",[],(function(a,b,c,d,e,f){a=Object.freeze({FULL:1,PARTIAL:2,NONE:3});f.GALLERY_PERMISSION_STATE=a}),66);
__d("WAWebWamEnumMetaAiModelTierType",[],(function(a,b,c,d,e,f){a=Object.freeze({BASE:0,PREMIUM:1});f.META_AI_MODEL_TIER_TYPE=a}),66);
__d("WAWebWamEnumNotificationSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({ALLOWED:1,BLOCKED:2,UNKNOWN:3});f.NOTIFICATION_SETTING_TYPE=a}),66);
__d("WAWebWamEnumPrivacySettingsContactsBuckets",[],(function(a,b,c,d,e,f){a=Object.freeze({B0:1,B1:2,B5:3,B10:4,B15:5,B20:6,B30:7,B40:8,B50:9,B60:10,B70:11,B80:12,B90:13,B100:14});f.PRIVACY_SETTINGS_CONTACTS_BUCKETS=a}),66);
__d("WAWebWamEnumPrivacySettingsValueType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOBODY:1,ONLY_SHARE_WITH:2,MY_CONTACTS:3,MY_CONTACTS_EXCEPT:4,EVERYONE:5,KNOWN:6,CLOSE_FRIENDS:7});f.PRIVACY_SETTINGS_VALUE_TYPE=a}),66);
__d("WAWebDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAndroidKeystoreStateType","WAWebWamEnumBackupEncryptionMethod","WAWebWamEnumBackupNetworkSetting","WAWebWamEnumBackupSchedule","WAWebWamEnumContactsPermissionAuthorizationStatusType","WAWebWamEnumEmailState","WAWebWamEnumGalleryPermissionState","WAWebWamEnumMediaQuality","WAWebWamEnumMetaAiModelTierType","WAWebWamEnumNotificationSettingType","WAWebWamEnumPrivacySettingsContactsBuckets","WAWebWamEnumPrivacySettingsValueType"],(function(a,b,c,d,e,f,g){e=(a=d("WAWebWamCodegenUtils")).defineEvents({Daily:[1158,{accessibilityVoiceover:[108,a.TYPES.BOOLEAN],addressbookSize:[11,a.TYPES.INTEGER],addressbookWhatsappSize:[12,a.TYPES.INTEGER],aiMemorySavedCnt:[223,a.TYPES.INTEGER],aiWidgetInstalled:[210,a.TYPES.BOOLEAN],androidAdvertisingId:[135,a.TYPES.STRING],androidKeystoreState:[139,d("WAWebWamEnumAndroidKeystoreStateType").ANDROID_KEYSTORE_STATE_TYPE],appCodeHash:[103,a.TYPES.STRING],appLastOpenTimestamp:[212,a.TYPES.INTEGER],appStandbyBucket:[121,a.TYPES.INTEGER],autoDlAudioCellular:[90,a.TYPES.BOOLEAN],autoDlAudioRoaming:[91,a.TYPES.BOOLEAN],autoDlAudioWifi:[89,a.TYPES.BOOLEAN],autoDlDocCellular:[96,a.TYPES.BOOLEAN],autoDlDocRoaming:[97,a.TYPES.BOOLEAN],autoDlDocWifi:[95,a.TYPES.BOOLEAN],autoDlImageCellular:[87,a.TYPES.BOOLEAN],autoDlImageRoaming:[88,a.TYPES.BOOLEAN],autoDlImageWifi:[86,a.TYPES.BOOLEAN],autoDlVideoCellular:[93,a.TYPES.BOOLEAN],autoDlVideoRoaming:[94,a.TYPES.BOOLEAN],autoDlVideoWifi:[92,a.TYPES.BOOLEAN],backupEncryptionMethod:[231,d("WAWebWamEnumBackupEncryptionMethod").BACKUP_ENCRYPTION_METHOD],backupNetworkSetting:[10,d("WAWebWamEnumBackupNetworkSetting").BACKUP_NETWORK_SETTING],backupRestoreEncryptionVersion:[138,a.TYPES.INTEGER],backupSchedule:[9,d("WAWebWamEnumBackupSchedule").BACKUP_SCHEDULE],channelsMediaFolderSize:[186,a.TYPES.INTEGER],chatDatabaseSize:[19,a.TYPES.INTEGER],chatLockFolderCount:[168,a.TYPES.INTEGER],contactsCreatedOnWhatsappSize:[200,a.TYPES.INTEGER],contactsPermissionAuthorizationStatus:[201,d("WAWebWamEnumContactsPermissionAuthorizationStatusType").CONTACTS_PERMISSION_AUTHORIZATION_STATUS_TYPE],count1on1Threads:[216,a.TYPES.INTEGER],countEphemeralThreads:[181,a.TYPES.INTEGER],countEphemeralThreadsEnabledByMe:[182,a.TYPES.INTEGER],countGroupThreads:[217,a.TYPES.INTEGER],countLimitSharing1on1Threads:[218,a.TYPES.INTEGER],countLimitSharingGroupThreads:[219,a.TYPES.INTEGER],dbAddressbookTableSize:[206,a.TYPES.INTEGER],defaultDisappearingDuration:[140,a.TYPES.INTEGER],defenseMode:[214,a.TYPES.INTEGER],deprecatedContactsSize:[228,a.TYPES.INTEGER],deviceLanguage:[153,a.TYPES.STRING],emailState:[174,d("WAWebWamEnumEmailState").EMAIL_STATE],entSecurityNotificationsEnabled:[134,a.TYPES.BOOLEAN],experimentTmoPreloadGroupDaily:[166,a.TYPES.INTEGER],favoritedAnimatedStickerCount:[113,a.TYPES.INTEGER],favoritedFirstPartyStickerCount:[112,a.TYPES.INTEGER],favoritedTotalStickerCount:[111,a.TYPES.INTEGER],galleryPermission:[164,d("WAWebWamEnumGalleryPermissionState").GALLERY_PERMISSION_STATE],hasTextstatusEmojiModified24h:[175,a.TYPES.BOOLEAN],hasTextstatusModified24h:[176,a.TYPES.BOOLEAN],hasTextstatusTextModified24h:[177,a.TYPES.BOOLEAN],hasUsername:[187,a.TYPES.BOOLEAN],hasUsernamePin:[222,a.TYPES.BOOLEAN],inNetworkContactsSize:[190,a.TYPES.INTEGER],installedAnimatedStickerPackCount:[116,a.TYPES.INTEGER],installedAnimatedThirdPartyStickerPackCount:[137,a.TYPES.INTEGER],installedFirstPartyStickerPackCount:[115,a.TYPES.INTEGER],installedTotalStickerPackCount:[114,a.TYPES.INTEGER],isCanonicalEntPresent:[234,a.TYPES.BOOLEAN],isContactSyncToOsDefaultOn:[202,a.TYPES.BOOLEAN],isDefaultDisappearingMessagingUser:[183,a.TYPES.BOOLEAN],isEphemeralMessagingUser:[184,a.TYPES.BOOLEAN],isProfilePhotoSet:[195,a.TYPES.BOOLEAN],keyboardLanguage:[154,a.TYPES.STRING],languageCode:[5,a.TYPES.STRING],lastBackupTimestamp:[63,a.TYPES.INTEGER],lastCloudBackupSize:[185,a.TYPES.INTEGER],locationCode:[6,a.TYPES.STRING],lockFolderHidden:[171,a.TYPES.BOOLEAN],lowestAppStandbyBucket:[160,a.TYPES.INTEGER],mdPairTime:[124,a.TYPES.INTEGER],mediaFolderFileCount:[21,a.TYPES.INTEGER],mediaFolderSize:[20,a.TYPES.INTEGER],mediaQualitySetting:[188,d("WAWebWamEnumMediaQuality").MEDIA_QUALITY],metaAiModelActual:[198,d("WAWebWamEnumMetaAiModelTierType").META_AI_MODEL_TIER_TYPE],metaAiModelSelected:[199,d("WAWebWamEnumMetaAiModelTierType").META_AI_MODEL_TIER_TYPE],metaAiVoiceDefaultOn:[220,a.TYPES.BOOLEAN],metaAiVoiceSelection:[221,a.TYPES.STRING],modifiedInternalProps:[155,a.TYPES.BOOLEAN],nativeContactsGlobalSettingEnabled:[205,a.TYPES.BOOLEAN],networkIsRoaming:[7,a.TYPES.BOOLEAN],networkOperatorName:[159,a.TYPES.STRING],numAccounts:[163,a.TYPES.INTEGER],numContactsWithTextstatus24h:[178,a.TYPES.INTEGER],numContactsWithTextstatusEmoji24h:[179,a.TYPES.INTEGER],numContactsWithTextstatusText24h:[180,a.TYPES.INTEGER],osBuildNumber:[4,a.TYPES.STRING],osNotificationSetting:[118,d("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE],outOfNetworkContactsSize:[191,a.TYPES.INTEGER],packageName:[102,a.TYPES.STRING],passkeyExists:[165,a.TYPES.BOOLEAN],paymentsIsEnabled:[100,a.TYPES.BOOLEAN],peripheralConnected:[209,a.TYPES.STRING],peripheralLinkedProductLine:[229,a.TYPES.STRING],permissionAccessCoarseLocation:[57,a.TYPES.INTEGER],permissionAccessFineLocation:[58,a.TYPES.INTEGER],permissionCamera:[56,a.TYPES.INTEGER],permissionContacts:[104,a.TYPES.BOOLEAN],permissionReadExternalStorage:[53,a.TYPES.INTEGER],permissionRecordAudio:[55,a.TYPES.INTEGER],phoneCores:[156,a.TYPES.INTEGER],phoneyid:[162,a.TYPES.STRING],preloadsAppManagerId:[224,a.TYPES.STRING],preloadsAttributionJson:[227,a.TYPES.STRING],privacySettingsAbout:[141,(b=d("WAWebWamEnumPrivacySettingsValueType")).PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsAboutExceptNum:[142,(c=d("WAWebWamEnumPrivacySettingsContactsBuckets")).PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsCoverPhoto:[235,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsGroups:[143,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsGroupsExceptNum:[144,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsLastSeen:[145,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsLastSeenExceptNum:[146,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsProfileLinks:[225,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsProfileLinksExceptNum:[226,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsProfilePhoto:[147,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsProfilePhotoExceptNum:[148,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsStatus:[150,b.PRIVACY_SETTINGS_VALUE_TYPE],privacySettingsStatusExceptNum:[151,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],privacySettingsStatusShareNum:[152,c.PRIVACY_SETTINGS_CONTACTS_BUCKETS],profileLinksCount:[211,a.TYPES.INTEGER],receiptsEnabled:[8,a.TYPES.BOOLEAN],secretCodeActive:[172,a.TYPES.BOOLEAN],showMetaAiButtonSetting:[173,a.TYPES.BOOLEAN],simMcc:[2,a.TYPES.INTEGER],simMnc:[3,a.TYPES.INTEGER],storageAvailSize:[31,a.TYPES.INTEGER],storageTotalSize:[32,a.TYPES.INTEGER],supportedDecoders:[169,a.TYPES.STRING],supportedEncoders:[170,a.TYPES.STRING],syncedInNetworkContactsSize:[192,a.TYPES.INTEGER],totalCountInNetworkUniquePhoneNumber:[193,a.TYPES.INTEGER],totalCountSyncedInNetworkUniquePhoneNumber:[194,a.TYPES.INTEGER],totalMissedCalls:[232,a.TYPES.INTEGER],totalUnreadMessages:[233,a.TYPES.INTEGER],trafficAnonymization:[215,a.TYPES.INTEGER],uniquePhoneNumberContactsSizeWithUsername:[236,a.TYPES.INTEGER],unreadBadgeFrequency:[213,a.TYPES.INTEGER],usernameOnlyContactsSize:[237,a.TYPES.INTEGER],videoFolderFileCount:[23,a.TYPES.INTEGER],videoFolderSize:[22,a.TYPES.INTEGER],webcContactsTableSize:[207,a.TYPES.INTEGER],webcFilteredContactsSize:[208,a.TYPES.INTEGER]},[1,1,1],"regular"]},{Daily:[]});g.DailyWamEvent=e}),98);
__d("WAWebEstimateFtsStorageApi",["Promise","WALogger","WANullthrows","WAWebDbUsageApiUtils","WAWebIndexedDB","WAWebScanDbRowApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k="fts-storage",l=15e3;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a===void 0?{sampleRows:l}:a;a=a.sampleRows;var e=Date.now(),f=a;a=c("WANullthrows")(c("WAWebIndexedDB"));a=(yield d("WAWebDbUsageApiUtils").getDatabase(a,k));var g=a.transaction(a.objectStoreNames,"readonly"),m=0,n=0;a=function*(a){var b=g.objectStore(a),c=(yield d("WAWebDbUsageApiUtils").promisifyRequest(b.count()));if(c===0)return 1;var e=Math.min(f,c);n=e;var h=0;yield d("WAWebDbUsageApiUtils").objectStoreIterator(b,function(b){h+=d("WAWebScanDbRowApi").estimateSize(b,a);n--;return n>0});b=Math.round(h*(c/(e-n)));m+=b;d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Estimated FTS "," size: "," KB, fetched rows: ",""])),a,b/1e3,e-n)};for(var o of g.objectStoreNames)if(yield* a(o))continue;a=Date.now()-e;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Estimated FTS size: "," KB, fetched rows: "," took: "," ms"])),m/1e3,n,a);return(j||(j=b("Promise"))).resolve(m)});return m.apply(this,arguments)}g.getEstimatedFTSDbSize=a}),98);
__d("WAWebKeepInChatNotifWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({KeepInChatNotif:[3484,{kicGroupNotificationTaps:[3,a.TYPES.INTEGER],kicGroupNotifications:[4,a.TYPES.INTEGER],kicNotificationTaps:[5,a.TYPES.INTEGER],kicNotifications:[6,a.TYPES.INTEGER]},[1,1,1],"regular"]},{KeepInChatNotif:[]});g.KeepInChatNotifWamEvent=b}),98);
__d("WAWebWamEnumLidMigrationSourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({PEER:1,HISTORY:2});f.LID_MIGRATION_SOURCE_TYPE=a}),66);
__d("WAWebLidMigrationDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumLidMigrationSourceType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({LidMigrationDaily:[5842,{completedMigrations:[1,a.TYPES.STRING],lidMigrationSource:[7,d("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE],numberOfPnChatsWithoutMapping:[5,a.TYPES.INTEGER],numberOfPnhCtwaThreadsKnownMapping:[2,a.TYPES.INTEGER],numberOfPnhCtwaThreadsMissingMapping:[3,a.TYPES.INTEGER],numberOfSplitThreads:[4,a.TYPES.INTEGER],numberOfUserChatsWithoutAccountLid:[6,a.TYPES.INTEGER]},[1,1,1],"regular"]},{LidMigrationDaily:[]});g.LidMigrationDailyWamEvent=b}),98);
__d("WAWebWamEnumGroupTypeClient",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR_GROUP:1,SUB_GROUP:2,DEFAULT_SUB_GROUP:3,PARENT_GROUP:4});f.GROUP_TYPE_CLIENT=a}),66);
__d("WAWebNotificationEngagementWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket","WAWebWamEnumGroupTypeClient"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({NotificationEngagement:[3796,{avgNotifEngagementT:[1,a.TYPES.TIMER],groupSizeBucket:[2,d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],groupTypeClient:[3,d("WAWebWamEnumGroupTypeClient").GROUP_TYPE_CLIENT],isAGroup:[4,a.TYPES.BOOLEAN],isWebBackgroundSyncNotif:[18,a.TYPES.BOOLEAN],threadId:[5,a.TYPES.STRING],totalLinkReshareMessageNotifShown:[19,a.TYPES.INTEGER],totalLinkReshareMessageNotifShownFb:[21,a.TYPES.INTEGER],totalLinkReshareMessageNotifShownIg:[22,a.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpen:[20,a.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpenFb:[23,a.TYPES.INTEGER],totalLinkReshareMessageNotifTapToOpenIg:[24,a.TYPES.INTEGER],totalMessageReminderNotifShown:[16,a.TYPES.INTEGER],totalMessageReminderNotifTapToOpen:[17,a.TYPES.INTEGER],totalNotifMarkAsRead:[6,a.TYPES.INTEGER],totalNotifMissedCallVoipCallback:[7,a.TYPES.INTEGER],totalNotifMissedCallVoipMessage:[8,a.TYPES.INTEGER],totalNotifOthers:[9,a.TYPES.INTEGER],totalNotifReply:[10,a.TYPES.INTEGER],totalNotifRtcVoipAccept:[11,a.TYPES.INTEGER],totalNotifRtcVoipDecline:[12,a.TYPES.INTEGER],totalNotifShowPreview:[13,a.TYPES.INTEGER],totalNotifShown:[14,a.TYPES.INTEGER],totalNotifTapToOpen:[15,a.TYPES.INTEGER]},[1,1,1],"regular"]},{NotificationEngagement:[]});g.NotificationEngagementWamEvent=b}),98);
__d("WAWebWamEnumInAppNotificationAlertStyle",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:1,BANNERS:2,ALERTS:3});f.IN_APP_NOTIFICATION_ALERT_STYLE=a}),66);
__d("WAWebWamEnumNotificationSoundTone",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:1,CUSTOM:2});f.NOTIFICATION_SOUND_TONE=a}),66);
__d("WAWebWamEnumUnreadBadgeSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({CURRENT_UNREAD_COUNT:0,CLEAR_ON_APP_OPEN:1});f.UNREAD_BADGE_SETTING_TYPE=a}),66);
__d("WAWebNotificationSettingWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumInAppNotificationAlertStyle","WAWebWamEnumNotificationSoundTone","WAWebWamEnumUnreadBadgeSettingType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({NotificationSetting:[3684,{groupReactionNotification:[1,a.TYPES.BOOLEAN],groupShowNotification:[2,a.TYPES.BOOLEAN],groupSoundTone:[3,d("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],inAppNotificationAlertStyle:[4,d("WAWebWamEnumInAppNotificationAlertStyle").IN_APP_NOTIFICATION_ALERT_STYLE],inAppNotificationSound:[5,a.TYPES.BOOLEAN],inAppNotificationVibrate:[6,a.TYPES.BOOLEAN],messageReactionNotification:[7,a.TYPES.BOOLEAN],messageShowNotification:[8,a.TYPES.BOOLEAN],messageSoundTone:[9,d("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],offlineNotification:[11,a.TYPES.BOOLEAN],recommendedChannelsNotificationSetting:[19,a.TYPES.BOOLEAN],showPreview:[10,a.TYPES.BOOLEAN],statusNotificationPriority:[14,a.TYPES.BOOLEAN],statusNotificationVibration:[15,a.TYPES.BOOLEAN],statusReactionNotification:[16,a.TYPES.BOOLEAN],statusReminderNotification:[12,a.TYPES.BOOLEAN],statusShowNotification:[18,a.TYPES.BOOLEAN],statusSoundTone:[17,d("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE],unreadBadgeSetting:[13,d("WAWebWamEnumUnreadBadgeSettingType").UNREAD_BADGE_SETTING_TYPE]},[1,1,1],"regular"]},{NotificationSetting:[]});g.NotificationSettingWamEvent=b}),98);
__d("WAWebPnhDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PnhDaily:[3806,{communityId:[1,a.TYPES.STRING],mappingMissing:[7,a.TYPES.INTEGER],pnhIndicatorClicksChat:[2,a.TYPES.INTEGER],pnhIndicatorClicksInfoScreen:[3,a.TYPES.INTEGER],reactionDeleteCount:[4,a.TYPES.INTEGER],reactionOpenTrayCount:[5,a.TYPES.INTEGER],totalContacts:[8,a.TYPES.INTEGER],typeOfGroup:[6,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{PnhDaily:[]});g.PnhDailyWamEvent=b}),98);
__d("WAWebWamEnumPrivacyHighlightCategoryEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE:0});f.PRIVACY_HIGHLIGHT_CATEGORY_ENUM=a}),66);
__d("WAWebWamEnumPrivacyHighlightSurfaceEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({GOLDEN_BOX_CONTACT:0,GOLDEN_BOX_GROUP:1,GOLDEN_BOX_BROADCAST:2,INFO_SCREEN_CONTACT:3,INFO_SCREEN_GROUP:4,INFO_SCREEN_BROADCAST:5,CALLS_LIST:6,CHATS_LIST:7,STATUS_LIST:8,LINKED_DEVICES_SCREEN:9,CALLING_SCREEN_AUDIO:10,CALLING_SCREEN_VIDEO:11,SPLIT_VIEW_HOME_PLACEHOLDER:12});f.PRIVACY_HIGHLIGHT_SURFACE_ENUM=a}),66);
__d("WAWebPrivacyHighlightDailyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPrivacyHighlightCategoryEnum","WAWebWamEnumPrivacyHighlightSurfaceEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PrivacyHighlightDaily:[3522,{dialogAppearCount:[1,a.TYPES.INTEGER],dialogSelectCount:[2,a.TYPES.INTEGER],narrativeAppearCount:[3,a.TYPES.INTEGER],privacyHighlightCategory:[4,d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM],privacyHighlightSurface:[5,d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM]},[1,1,1],"regular"]},{PrivacyHighlightDaily:[]});g.PrivacyHighlightDailyWamEvent=b}),98);
__d("WAWebPttDailyWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PttDaily:[2938,{pttCancelBroadcast:[9,a.TYPES.INTEGER],pttCancelGroup:[8,a.TYPES.INTEGER],pttCancelIndividual:[7,a.TYPES.INTEGER],pttCancelInterop:[42,a.TYPES.INTEGER],pttCancelNewsletter:[32,a.TYPES.INTEGER],pttDraftReviewBroadcast:[15,a.TYPES.INTEGER],pttDraftReviewGroup:[14,a.TYPES.INTEGER],pttDraftReviewIndividual:[13,a.TYPES.INTEGER],pttDraftReviewInterop:[43,a.TYPES.INTEGER],pttDraftReviewNewsletter:[33,a.TYPES.INTEGER],pttFastplaybackBroadcast:[21,a.TYPES.INTEGER],pttFastplaybackGroup:[20,a.TYPES.INTEGER],pttFastplaybackIndividual:[19,a.TYPES.INTEGER],pttFastplaybackInterop:[44,a.TYPES.INTEGER],pttFastplaybackNewsletter:[34,a.TYPES.INTEGER],pttLockBroadcast:[12,a.TYPES.INTEGER],pttLockGroup:[11,a.TYPES.INTEGER],pttLockIndividual:[10,a.TYPES.INTEGER],pttLockInterop:[45,a.TYPES.INTEGER],pttLockNewsletter:[35,a.TYPES.INTEGER],pttOutOfChatBroadcast:[29,a.TYPES.INTEGER],pttOutOfChatGroup:[30,a.TYPES.INTEGER],pttOutOfChatIndividual:[31,a.TYPES.INTEGER],pttOutOfChatInterop:[46,a.TYPES.INTEGER],pttOutOfChatNewsletter:[36,a.TYPES.INTEGER],pttPausedRecordBroadcast:[22,a.TYPES.INTEGER],pttPausedRecordGroup:[23,a.TYPES.INTEGER],pttPausedRecordIndividual:[24,a.TYPES.INTEGER],pttPausedRecordInterop:[47,a.TYPES.INTEGER],pttPausedRecordNewsletter:[37,a.TYPES.INTEGER],pttPlaybackBroadcast:[18,a.TYPES.INTEGER],pttPlaybackGroup:[17,a.TYPES.INTEGER],pttPlaybackIndividual:[16,a.TYPES.INTEGER],pttPlaybackInterop:[48,a.TYPES.INTEGER],pttPlaybackNewsletter:[38,a.TYPES.INTEGER],pttRecordBroadcast:[3,a.TYPES.INTEGER],pttRecordGroup:[2,a.TYPES.INTEGER],pttRecordIndividual:[1,a.TYPES.INTEGER],pttRecordInterop:[49,a.TYPES.INTEGER],pttRecordNewsletter:[39,a.TYPES.INTEGER],pttSendBroadcast:[6,a.TYPES.INTEGER],pttSendGroup:[5,a.TYPES.INTEGER],pttSendIndividual:[4,a.TYPES.INTEGER],pttSendInterop:[50,a.TYPES.INTEGER],pttSendNewsletter:[40,a.TYPES.INTEGER],pttStopTapBroadcast:[25,a.TYPES.INTEGER],pttStopTapGroup:[26,a.TYPES.INTEGER],pttStopTapIndividual:[27,a.TYPES.INTEGER],pttStopTapInterop:[51,a.TYPES.INTEGER],pttStopTapNewsletter:[41,a.TYPES.INTEGER]},[1,1,1],"regular"]},{PttDaily:[]});g.PttDailyWamEvent=b}),98);
__d("WAWebScreenLockSettingsDataWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({ScreenLockSettingsData:[4802,{screenAutoLockDuration:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{ScreenLockSettingsData:[]});g.ScreenLockSettingsDataWamEvent=a}),98);
__d("WAWebChatLockDailyWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ChatLockDaily:[4214,{folderChatsCount:[1,a.TYPES.INTEGER],folderOpenCount:[2,a.TYPES.INTEGER],lockFolderHidden:[5,a.TYPES.BOOLEAN],newAddChatCount:[3,a.TYPES.INTEGER],newRemoveChatCount:[4,a.TYPES.INTEGER],secretCodeActive:[6,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{ChatLockDaily:[]});g.ChatLockDailyWamEvent=b}),98);
__d("WAWebSubmitChatLockDailyStats",["WAWebChatLockDailyWamEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.chatLockFolderChatsCount,c=a.chatLockFolderOpenCount,e=a.chatLockNewAddChatCount,f=a.chatLockNewRemoveChatCount,g=a.chatLockLockFolderHidden;a=a.chatLockSecretCodeActive;if(b===0||c===0||e===0||f===0)return;b=new(d("WAWebChatLockDailyWamEvent").ChatLockDailyWamEvent)({folderChatsCount:b,folderOpenCount:c,newAddChatCount:e,newRemoveChatCount:f});g!=null&&b.set({lockFolderHidden:g});a!=null&&b.set({secretCodeActive:a});b.commit()}g.submitChatLockDailyStats=a}),98);
__d("WAWebUserPrefsCartLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").UserPrefs.CartDbLidMigrationComplete,a)}function b(){return c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").UserPrefs.CartDbLidMigrationComplete)===!0}g.setCartLidMigrationValue=a;g.isCartLidMigrationComplete=b}),98);
__d("WAWebUserPrefsContactManagement",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h=1;function i(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").UserPrefs.SyncContactToAddressbookCounts);a=typeof a==="object"?a:null;var b=typeof (a==null?void 0:a.enabledCount)==="number"?a.enabledCount:0;a=typeof (a==null?void 0:a.disabledCount)==="number"?a.disabledCount:0;return{enabledCount:b,disabledCount:a}}function j(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").UserPrefs.SyncContactToAddressbookCounts,a)}function a(a){var b=i(),c=k();c!==a?a?(b.enabledCount++,b.enabledCount>=h&&(b.disabledCount=0)):(b.disabledCount++,b.disabledCount>=h&&(b.enabledCount=0)):!a&&b.enabledCount<h?b.enabledCount=0:a&&b.disabledCount<h&&(b.disabledCount=0);j(b)}function k(){var a=i();return a.enabledCount>=h?!0:!1}g.setSyncToAddressbookLastSetting=a;g.getSyncToAddressbookDefaultSetting=k}),98);
__d("WAWebWaFsSingleEmojiMessageDailyWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WaFsSingleEmojiMessageDaily:[5602,{animatedEmojiEnabled:[1,a.TYPES.BOOLEAN],animatedEmojiReceiveCnt:[2,a.TYPES.INTEGER],animatedEmojiSendCnt:[3,a.TYPES.INTEGER],emojiClickCnt:[4,a.TYPES.INTEGER],emojiReplyCount:[5,a.TYPES.INTEGER],pauseAnimationCnt:[6,a.TYPES.INTEGER],replayAnimationCnt:[7,a.TYPES.INTEGER],singleEmojiReceiveCnt:[8,a.TYPES.INTEGER],singleEmojiSendCnt:[9,a.TYPES.INTEGER]},[1,1,1],"regular"]},{WaFsSingleEmojiMessageDaily:[]});g.WaFsSingleEmojiMessageDailyWamEvent=b}),98);
__d("WAWebWamEnumPsTestEnumField",[],(function(a,b,c,d,e,f){a=Object.freeze({TEST_VALUE1:1,TEST_VALUE2:2});f.PS_TEST_ENUM_FIELD=a}),66);
__d("WAWebTestAnonymousDailyIdWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsTestEnumField"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({TestAnonymousDailyId:[2958,{psTestEnumField:[1,d("WAWebWamEnumPsTestEnumField").PS_TEST_ENUM_FIELD],psTestFloatField:[2,d("WAWebWamCodegenUtils").TYPES.NUMBER]},[1,1,1],"private",248614979]},{TestAnonymousDailyId:[]});g.TestAnonymousDailyIdWamEvent=a}),98);
__d("WAWebTestAnonymousDailyWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({TestAnonymousDaily:[2328,{},[1,1,1],"private",113760892]},{TestAnonymousDaily:[]});g.TestAnonymousDailyWamEvent=a}),98);
__d("WAWebTestAnonymousIdLessWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({TestAnonymousIdLess:[3004,{psTimeSinceLastEventInMin:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"private",0]},{TestAnonymousIdLess:[]});g.TestAnonymousIdLessWamEvent=a}),98);
__d("WAWebTestAnonymousMonthlyIdWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({TestAnonymousMonthlyId:[2960,{},[1,20,1e3],"private",191000728]},{TestAnonymousMonthlyId:[]});g.TestAnonymousMonthlyIdWamEvent=a}),98);
__d("WAWebTestAnonymousWeeklyIdWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({TestAnonymousWeeklyId:[2956,{psTestBooleanField:[2,a.TYPES.BOOLEAN],psTestStringField:[3,a.TYPES.STRING],psTimeSinceLastEventInMin:[1,a.TYPES.INTEGER]},[1,1,1],"private",42196056]},{TestAnonymousWeeklyId:[]});g.TestAnonymousWeeklyIdWamEvent=b}),98);
__d("WAWebWamPrivateStatsUtils",["WAWebTestAnonymousDailyIdWamEvent","WAWebTestAnonymousDailyWamEvent","WAWebTestAnonymousIdLessWamEvent","WAWebTestAnonymousMonthlyIdWamEvent","WAWebTestAnonymousWeeklyIdWamEvent"],(function(a,b,c,d,e,f,g){function a(){new(d("WAWebTestAnonymousDailyWamEvent").TestAnonymousDailyWamEvent)().commit(),new(d("WAWebTestAnonymousWeeklyIdWamEvent").TestAnonymousWeeklyIdWamEvent)().commit(),new(d("WAWebTestAnonymousIdLessWamEvent").TestAnonymousIdLessWamEvent)().commit()}function b(){new(d("WAWebTestAnonymousDailyIdWamEvent").TestAnonymousDailyIdWamEvent)().commit(),new(d("WAWebTestAnonymousMonthlyIdWamEvent").TestAnonymousMonthlyIdWamEvent)().commit()}g.logDailyPrivateStatsTestEvents=a;g.logUiActionShadowPrivateStatsTestEvents=b}),98);
__d("WAWebWebDynamicSamplingTestEventWithSamplingWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebDynamicSamplingTestEventWithSampling:[5320,{},[100,100,1e4],"regular"]},{WebDynamicSamplingTestEventWithSampling:[]});g.WebDynamicSamplingTestEventWithSamplingWamEvent=a}),98);
__d("WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebDynamicSamplingTestEventWithoutSampling:[5322,{},[1,1,1],"regular"]},{WebDynamicSamplingTestEventWithoutSampling:[]});g.WebDynamicSamplingTestEventWithoutSamplingWamEvent=a}),98);
__d("WAWebWebcFtsStorageWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcFtsStorage:[3642,{ftsTotalSize:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{WebcFtsStorage:[]});g.WebcFtsStorageWamEvent=a}),98);
__d("WAWebTasksDailyStatsTask",["Promise","WALogger","WAStorageEstimator","WATimeUtils","WAWebABProps","WAWebABPropsGlobals","WAWebApiPrivacyDisallowedList","WAWebApiPrivacyEphemerality","WAWebBlocklistMigration","WAWebCommunityHomeActionWamEvent","WAWebCommunityTabActionWamEvent","WAWebContactCollection","WAWebContactManagementGating","WAWebCurrentUser","WAWebDailyAggregatedStatsCollection","WAWebDailyWamEvent","WAWebEphemeralityResolver","WAWebEstimateFtsStorageApi","WAWebKeepInChatNotifWamEvent","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebLidMigrationDailyWamEvent","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebMediaStore","WAWebMuteCollection","WAWebNotificationConstants","WAWebNotificationEngagementWamEvent","WAWebNotificationSettingWamEvent","WAWebPnhDailyWamEvent","WAWebPrivacyHighlightDailyWamEvent","WAWebPttDailyWamEvent","WAWebSchemaChat","WAWebScreenLockSettingsDataWamEvent","WAWebSubmitChatLockDailyStats","WAWebUserPrefsCartLidMigration","WAWebUserPrefsContactManagement","WAWebUserPrefsFavoritesLidMigration","WAWebUserPrefsGeneral","WAWebUserPrefsInfoStore","WAWebUserPrefsLabelAssociationsLidMigration","WAWebUserPrefsMultiDevice","WAWebUserPrefsNotifications","WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration","WAWebUserPrefsScreenLock","WAWebUserPrefsTypes","WAWebWaFsSingleEmojiMessageDailyWamEvent","WAWebWamEnumLidMigrationSourceType","WAWebWamEnumNotificationSettingType","WAWebWamEnumNotificationSoundTone","WAWebWamEnumPrivacyHighlightCategoryEnum","WAWebWamEnumPrivacyHighlightSurfaceEnum","WAWebWamEnumPrivacySettingsContactsBuckets","WAWebWamEnumPrivacySettingsValueType","WAWebWamEnumTypeOfGroupEnum","WAWebWamPrivateStatsUtils","WAWebWebDynamicSamplingTestEventWithSamplingWamEvent","WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent","WAWebWebcFtsStorageWamEvent","WAWebWebcStorageStatWamEvent","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function n(a){if(a.goldenBoxContactNarrativeAppearCount>0||a.goldenBoxContactDialogAppearCount>0||a.goldenBoxContactDialogSelectCount>0){var b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.GOLDEN_BOX_CONTACT,narrativeAppearCount:a.goldenBoxContactNarrativeAppearCount,dialogAppearCount:a.goldenBoxContactDialogAppearCount,dialogSelectCount:a.goldenBoxContactDialogSelectCount});b.commit()}if(a.goldenBoxGroupNarrativeAppearCount>0||a.goldenBoxGroupDialogAppearCount>0||a.goldenBoxGroupDialogSelectCount>0){b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.GOLDEN_BOX_GROUP,narrativeAppearCount:a.goldenBoxGroupNarrativeAppearCount,dialogAppearCount:a.goldenBoxGroupDialogAppearCount,dialogSelectCount:a.goldenBoxGroupDialogSelectCount});b.commit()}if(a.infoScreenGroupNarrativeAppearCount>0||a.infoScreenGroupDialogAppearCount>0||a.infoScreenGroupDialogSelectCount>0){b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.INFO_SCREEN_GROUP,narrativeAppearCount:a.infoScreenGroupNarrativeAppearCount,dialogAppearCount:a.infoScreenGroupDialogAppearCount,dialogSelectCount:a.infoScreenGroupDialogSelectCount});b.commit()}if(a.chatsListNarrativeAppearCount>0||a.chatsListDialogAppearCount>0||a.chatsListDialogSelectCount>0){b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.CHATS_LIST,narrativeAppearCount:a.chatsListNarrativeAppearCount,dialogAppearCount:a.chatsListDialogAppearCount,dialogSelectCount:a.chatsListDialogSelectCount});b.commit()}if(a.statusListNarrativeAppearCount>0||a.statusListDialogAppearCount>0||a.statusListDialogSelectCount>0){b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.STATUS_LIST,narrativeAppearCount:a.statusListNarrativeAppearCount,dialogAppearCount:a.statusListDialogAppearCount,dialogSelectCount:a.statusListDialogSelectCount});b.commit()}if(a.callingScreenAudioNarrativeAppearCount>0||a.callingScreenAudioDialogAppearCount>0||a.callingScreenAudioDialogSelectCount>0){b=new(d("WAWebPrivacyHighlightDailyWamEvent").PrivacyHighlightDailyWamEvent)({privacyHighlightCategory:d("WAWebWamEnumPrivacyHighlightCategoryEnum").PRIVACY_HIGHLIGHT_CATEGORY_ENUM.E2EE,privacyHighlightSurface:d("WAWebWamEnumPrivacyHighlightSurfaceEnum").PRIVACY_HIGHLIGHT_SURFACE_ENUM.CALLING_SCREEN_AUDIO,narrativeAppearCount:a.callingScreenAudioNarrativeAppearCount,dialogAppearCount:a.callingScreenAudioDialogAppearCount,dialogSelectCount:a.callingScreenAudioDialogSelectCount});b.commit()}}function o(){var a=!d("WAWebMuteCollection").MuteCollection.globalReactionsMute(),b=!!d("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg(),c=new(d("WAWebNotificationSettingWamEvent").NotificationSettingWamEvent)();c.set({groupReactionNotification:b&&a,groupShowNotification:b,groupSoundTone:d("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT,inAppNotificationSound:d("WAWebUserPrefsNotifications").getGlobalSounds(),messageReactionNotification:a,messageShowNotification:d("WAWebUserPrefsNotifications").getGlobalNotifications(),messageSoundTone:d("WAWebWamEnumNotificationSoundTone").NOTIFICATION_SOUND_TONE.DEFAULT,showPreview:d("WAWebUserPrefsNotifications").getGlobalPreviews(),offlineNotification:d("WAWebUserPrefsNotifications").getGlobalOfflineNotifications()});c.commit()}function a(){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebABPropsGlobals").logClientExposurePulseEventFromDailyStatsTask();var a=(yield q()),b=(yield u()),e=(yield y()),f=(yield A()),g=B(),i=(yield C());a=babelHelpers["extends"]({},a,b,e,g,i);d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WamDailyStats: "]))).devConsole(a);b=new(d("WAWebDailyWamEvent").DailyWamEvent)();b.set(a);b.commit();o();g=(yield s());void new(d("WAWebLidMigrationDailyWamEvent").LidMigrationDailyWamEvent)(g).commit();i=new(d("WAWebWebcFtsStorageWamEvent").WebcFtsStorageWamEvent)();i.set({ftsTotalSize:f});i.commit();a=new(d("WAWebScreenLockSettingsDataWamEvent").ScreenLockSettingsDataWamEvent)();a.set(E());a.commit();b=d("WAWebUserPrefsMultiDevice").getPairingTimestamp();g=new(d("WAWebWebcStorageStatWamEvent").WebcStorageStatWamEvent)();g.set({webcStorageQuota:e.storageTotalSize,webcStorageUsage:e.storageUsed,webcAgeOfStorage:b!=null?d("WATimeUtils").unixTimeWithoutClockSkewCorrection()-b:-1,webcPackingEnabled:!1});void g.commit();f=(yield d("WAWebUserPrefsGeneral").getOfflineNotificationEngagement());if(f){new(d("WAWebNotificationEngagementWamEvent").NotificationEngagementWamEvent)({isWebBackgroundSyncNotif:!0,totalNotifShown:(i=f.totalNotifShown)!=null?i:0,totalNotifTapToOpen:(a=f.totalNotifTapToOpen)!=null?a:0}).commit();void d("WAWebUserPrefsGeneral").clearOfflineNotificationContentEngagement()}e=(yield d("WAWebUserPrefsGeneral").getNotificationEngagement());if(e){new(d("WAWebNotificationEngagementWamEvent").NotificationEngagementWamEvent)({totalNotifShown:(b=e.totalNotifShown)!=null?b:0,totalNotifTapToOpen:(g=e.totalNotifTapToOpen)!=null?g:0}).commit();void d("WAWebUserPrefsGeneral").clearNotificationContentEngagement()}d("WAWebWamPrivateStatsUtils").logDailyPrivateStatsTestEvents();i=d("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.toArray().filter(function(a){return a.shouldBeSubmitted()});d("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.remove(i);i.forEach(function(a){var b=new(d("WAWebPttDailyWamEvent").PttDailyWamEvent)({pttCancelBroadcast:a.pttCancelBroadcast,pttCancelGroup:a.pttCancelGroup,pttCancelIndividual:a.pttCancelIndividual,pttCancelNewsletter:a.pttCancelNewsletter,pttDraftReviewBroadcast:a.pttDraftReviewBroadcast,pttDraftReviewGroup:a.pttDraftReviewGroup,pttDraftReviewIndividual:a.pttDraftReviewIndividual,pttDraftReviewNewsletter:a.pttDraftReviewNewsletter,pttFastplaybackBroadcast:a.pttFastplaybackBroadcast,pttFastplaybackGroup:a.pttFastplaybackGroup,pttFastplaybackIndividual:a.pttFastplaybackIndividual,pttFastplaybackNewsletter:a.pttFastplaybackNewsletter,pttLockBroadcast:a.pttLockBroadcast,pttLockGroup:a.pttLockGroup,pttLockIndividual:a.pttLockIndividual,pttLockNewsletter:a.pttLockNewsletter,pttOutOfChatBroadcast:a.pttOutOfChatBroadcast,pttOutOfChatGroup:a.pttOutOfChatGroup,pttOutOfChatIndividual:a.pttOutOfChatIndividual,pttOutOfChatNewsletter:a.pttOutOfChatNewsletter,pttPlaybackBroadcast:a.pttPlaybackBroadcast,pttPlaybackGroup:a.pttPlaybackGroup,pttPlaybackIndividual:a.pttPlaybackIndividual,pttPlaybackNewsletter:a.pttPlaybackNewsletter,pttRecordBroadcast:a.pttRecordBroadcast,pttRecordGroup:a.pttRecordGroup,pttRecordIndividual:a.pttRecordIndividual,pttRecordNewsletter:a.pttRecordNewsletter,pttSendBroadcast:a.pttSendBroadcast,pttSendGroup:a.pttSendGroup,pttSendIndividual:a.pttSendIndividual,pttSendNewsletter:a.pttSendNewsletter,pttPausedRecordBroadcast:a.pttPausedRecordBroadcast,pttPausedRecordGroup:a.pttPausedRecordGroup,pttPausedRecordIndividual:a.pttPausedRecordIndividual,pttPausedRecordNewsletter:a.pttPausedRecordNewsletter});b.commit();n(a);new(d("WAWebCommunityTabActionWamEvent").CommunityTabActionWamEvent)({communityTabGroupNavigations:a.communityTabGroupNavigations,communityTabToHomeViews:a.communityTabToHomeViews,communityTabViews:a.communityTabViews,communityTabViewsViaContextMenu:a.communityTabViewsViaContextMenu}).commit();a.communityHome!=null&&Object.keys(a.communityHome).forEach(function(b){var e=c("WAWebWid").user(b);if(e==null)return;b=a.communityHome[b];var f=b.communityHomeGroupDiscoveries,g=b.communityHomeGroupJoins,h=b.communityHomeGroupNavigations;b=b.communityHomeViews;new(d("WAWebCommunityHomeActionWamEvent").CommunityHomeActionWamEvent)({communityHomeId:e,communityHomeGroupDiscoveries:f,communityHomeGroupJoins:g,communityHomeGroupNavigations:h,communityHomeViews:b}).commit()});a.pnhCagActions!=null&&Object.keys(a.pnhCagActions).forEach(function(b){var c=a.pnhCagActions[b],e=c.pnhIndicatorClicksChat,f=c.pnhIndicatorClicksInfoScreen,g=c.reactionDeleteCount;c=c.reactionOpenTrayCount;new(d("WAWebPnhDailyWamEvent").PnhDailyWamEvent)({communityId:b,pnhIndicatorClicksChat:e,pnhIndicatorClicksInfoScreen:f,reactionDeleteCount:g,reactionOpenTrayCount:c,typeOfGroup:d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.DEFAULT_SUBGROUP}).commit()});b=new(d("WAWebKeepInChatNotifWamEvent").KeepInChatNotifWamEvent)({kicGroupNotificationTaps:a.kicGroupNotificationTaps,kicGroupNotifications:a.kicGroupNotifications,kicNotificationTaps:a.kicNotificationTaps,kicNotifications:a.kicNotifications});b.commit();d("WAWebABProps").getABPropConfigValue("single_emoji_logging_enabled")&&new(d("WAWebWaFsSingleEmojiMessageDailyWamEvent").WaFsSingleEmojiMessageDailyWamEvent)({animatedEmojiSendCnt:a.animatedEmojiSend,emojiReplyCount:a.emojiReply,singleEmojiSendCnt:a.singleEmojiSend}).commit();d("WAWebSubmitChatLockDailyStats").submitChatLockDailyStats(a)});void new(d("WAWebWebDynamicSamplingTestEventWithoutSamplingWamEvent").WebDynamicSamplingTestEventWithoutSamplingWamEvent)().commit();void new(d("WAWebWebDynamicSamplingTestEventWithSamplingWamEvent").WebDynamicSamplingTestEventWithSamplingWamEvent)().commit()});return p.apply(this,arguments)}function q(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsInfoStore").deviceInfo.get());return{languageCode:a.lg,locationCode:a.lc,osBuildNumber:a.osBuild,simMcc:parseInt(a.mcc,10),simMnc:parseInt(a.mnc,10)}});return r.apply(this,arguments)}function s(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[];a.push("con");a.push("id");a.push("ss");a.push("sk");d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.push("ch_jid");d("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()&&a.push("st_lid");d("WAWebUserPrefsFavoritesLidMigration").isFavoritesMigrationComplete()&&a.push("fav");d("WAWebUserPrefsCartLidMigration").isCartLidMigrationComplete()&&a.push("cart");d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()&&a.push("lab");d("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").isPhoneNumberHidingThreadPromotionMigrationComplete()&&a.push("pnh_lid");d("WAWebBlocklistMigration").isBlocklistMigrated()&&a.push("bl_lid");var b=(yield d("WAWebSchemaChat").getChatTable().all()),c,e;try{c=b.filter(function(a){a=d("WAWebWidFactory").createWid(a.id);return a.isRegularUser()&&d("WAWebLidMigrationUtils").toLid(a)==null});e=b.filter(function(a){var b=d("WAWebWidFactory").createWid(a.id);return b.isRegularUser()&&a.accountLid==null});if(d("WAWebCurrentUser").isEmployee()){b=function(a){var b=d("WAWebWidFactory").createWid(a.id);return"chat id: "+b.toLogString()+", account lid: "+(a.accountLid==null?"null":d("WAWebWidFactory").createWid(a.accountLid).toLogString())+", mapping: "+((b=(a=d("WAWebLidMigrationUtils").toLid(b))==null?void 0:a.toLogString())!=null?b:"null")};d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: PN chat without mapping: ",""])),c.slice(0,5).map(b).join(","));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: chats without account_lid: ",""])),e.slice(0,5).map(b).join(","))}}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["getLidMigrationStatus: ",""])),a)}b=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.lidMigrationSource()===d("WAWebUserPrefsTypes").LidMigrationSource.HISTORY?d("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE.HISTORY:d("WAWebWamEnumLidMigrationSourceType").LID_MIGRATION_SOURCE_TYPE.PEER;return{completedMigrations:a.join(","),numberOfPnChatsWithoutMapping:(a=(a=c)==null?void 0:a.length)!=null?a:-1,numberOfUserChatsWithoutAccountLid:d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?(a=(a=e)==null?void 0:a.length)!=null?a:-1:void 0,lidMigrationSource:b}});return t.apply(this,arguments)}function u(){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getPrivacySettings"])));var b=d("WAWebUserPrefsGeneral").getUserPrivacySettings(),c={receiptsEnabled:b.readReceipts!=="none"},e=(yield d("WAWebApiPrivacyDisallowedList").queryDisallowedLists());c.privacySettingsAbout=w(b.about);c.privacySettingsAboutExceptNum=b.about==="contact_blacklist"?x((a=e.about)==null?void 0:a.disallowedList.length):null;c.privacySettingsGroups=w(b.groupAdd);c.privacySettingsGroupsExceptNum=b.groupAdd==="contact_blacklist"?x((a=e.groupadd)==null?void 0:a.disallowedList.length):null;c.privacySettingsLastSeen=w(b.lastSeen);c.privacySettingsLastSeenExceptNum=b.lastSeen==="contact_blacklist"?x((a=e.last)==null?void 0:a.disallowedList.length):null;c.privacySettingsProfilePhoto=w(b.profilePicture);c.privacySettingsProfilePhotoExceptNum=b.profilePicture==="contact_blacklist"?x((a=e.profile)==null?void 0:a.disallowedList.length):null;b=d("WAWebEphemeralityResolver").getEphemeralDurationForUser(d("WAWebContactCollection").ContactCollection.getMeContact());c.defaultDisappearingDuration=b!=null?b:0;if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_daily_logs")){c.isDefaultDisappearingMessagingUser=c.defaultDisappearingDuration!==0;e=(yield d("WAWebApiPrivacyEphemerality").queryEphemeralityDailyLogInfo());a=e.isEphemeralMessagingUser;b=e.countEphemeralThreadsEnabledByMe;e=e.countEphemeralThreads;c.isEphemeralMessagingUser=a;c.countEphemeralThreads=e;c.countEphemeralThreadsEnabledByMe=b}return c});return v.apply(this,arguments)}function w(a){if(a==null)return null;switch(a){case"all":return d("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.EVERYONE;case"contacts":return d("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.MY_CONTACTS;case"contact_blacklist":return d("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.MY_CONTACTS_EXCEPT;case"none":return d("WAWebWamEnumPrivacySettingsValueType").PRIVACY_SETTINGS_VALUE_TYPE.NOBODY}}function x(a){if(a==null)return null;if(a===0)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B0;if(a<5)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B1;if(a<10)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B5;if(a<15)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B10;if(a<20)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B15;if(a<30)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B20;if(a<40)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B30;if(a<50)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B40;if(a<60)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B50;if(a<70)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B60;if(a<80)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B70;if(a<90)return d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B80;return a<100?d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B90:d("WAWebWamEnumPrivacySettingsContactsBuckets").PRIVACY_SETTINGS_CONTACTS_BUCKETS.B100}function y(){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=c("WAWebLidAwareContactsDB").equals(["isAddressBookContact"],1).then(function(a){return a.filter(function(a){return!c("WAWebWid").isStringLid(a.id)}).length}),e=d("WAStorageEstimator").estimateStorage(),f=d("WAWebMediaStore").LruMediaStore.count(),g=c("WAWebLidAwareContactsDB").count(),h=d("WAWebContactCollection").ContactCollection.getFilteredContacts({}).length;e=(yield (m||(m=b("Promise"))).all([e,a,f,g]));a=e[0];f=e[1];g=e[2];e=e[3];var i=0,j=0,k=0;if(a.success){a=a.value;var l=a.quota;a=a.usage;i=l-a;j=l;k=a}return{addressbookWhatsappSize:F(f,10),storageAvailSize:F(i,100),storageTotalSize:F(j,100),storageUsed:F(k,100),mediaFolderFileCount:g,webcContactsTableSize:F(e,10),webcFilteredContactsSize:h}});return z.apply(this,arguments)}function A(){return d("WAWebEstimateFtsStorageApi").getEstimatedFTSDbSize()}function B(){var a=d("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.UNKNOWN;if(window.Notification!=null)switch(window.Notification.permission){case d("WAWebNotificationConstants").PERMISSION_ALLOWED:a=d("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.ALLOWED;break;case d("WAWebNotificationConstants").PERMISSION_DENIED:a=d("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.BLOCKED;break;default:a=d("WAWebWamEnumNotificationSettingType").NOTIFICATION_SETTING_TYPE.UNKNOWN}var b;d("WAWebContactManagementGating").contactManagementEnabled()&&(b=d("WAWebUserPrefsContactManagement").getSyncToAddressbookDefaultSetting());return{osNotificationSetting:a,isContactSyncToOsDefaultOn:b}}function C(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[],b=[],c=window.navigator.mediaCapabilities;if(c!=null){var d={width:800,height:600,bitrate:1e4,framerate:30},e={type:"record"},f={type:"file"},g={contentType:'video/mp4; codecs="avc1.42000a"'},h={contentType:'video/mp4; codecs="hev1.1.6.L93.B0"'},i={contentType:'video/mp4; codecs="av01.0.00M.08"'},j={contentType:'video/mp4; codecs="vp09.00.51.08.01.01.01.01.00"'},k=babelHelpers["extends"]({},e,{video:babelHelpers["extends"]({},g,d)}),l=babelHelpers["extends"]({},e,{video:babelHelpers["extends"]({},h,d)}),m=babelHelpers["extends"]({},e,{video:babelHelpers["extends"]({},i,d)});e=babelHelpers["extends"]({},e,{video:babelHelpers["extends"]({},j,d)});g=babelHelpers["extends"]({},f,{video:babelHelpers["extends"]({},g,d)});h=babelHelpers["extends"]({},f,{video:babelHelpers["extends"]({},h,d)});i=babelHelpers["extends"]({},f,{video:babelHelpers["extends"]({},i,d)});f=babelHelpers["extends"]({},f,{video:babelHelpers["extends"]({},j,d)});if(c.encodingInfo!=null){try{(yield c.encodingInfo(k)).supported&&a.push("avc")}catch(a){}try{(yield c.encodingInfo(l)).supported&&a.push("hevc")}catch(a){}try{(yield c.encodingInfo(m)).supported&&a.push("av1")}catch(a){}try{(yield c.encodingInfo(e)).supported&&a.push("vp9")}catch(a){}}if(c.decodingInfo!=null){try{(yield c.decodingInfo(g)).supported&&b.push("avc")}catch(a){}try{(yield c.decodingInfo(h)).supported&&b.push("hevc")}catch(a){}try{(yield c.decodingInfo(i)).supported&&b.push("av1")}catch(a){}try{(yield c.decodingInfo(f)).supported&&b.push("vp9")}catch(a){}}}return{supportedEncoders:a.join(","),supportedDecoders:b.join(",")}});return D.apply(this,arguments)}function E(){return{screenAutoLockDuration:d("WAWebUserPrefsScreenLock").getScreenLockDurationForLogging()}}function F(a,b){return c("gkx")("26258")?Math.round(a/b)*b:a}g.logDailyStats=a;g.getLidMigrationStatus=s}),98);
__d("WAWebTosGating",["WAWebABPropsInternalNumber","WAWebBizGatingUtils","WAWebBotGating","WAWebBotTos","WAWebBotTosIds","WAWebHandleMsgTypes.flow","WAWebTos","WaWebPDFNCommonUtils"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebBizGatingUtils").tos3GatingEnabled()){var b;if(d("WAWebTos").TosManager.getState(d("WAWebTos").TOS_3_ID)==="NOT_ACCEPTED"&&((b=a.privacyMode)==null?void 0:b.hostStorage)===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&!d("WAWebABPropsInternalNumber").getFbBrandedNumber(a.id.user))return!0}return!1}function b(a){if(d("WAWebBotTos").hasAcceptedNonBlockingBotTos())return!1;if(d("WaWebPDFNCommonUtils").hasAcceptedTos(String(d("WAWebBotGating").getMasterBotNoticeId())))return!1;if(a.id.isPnBot()&&!d("WAWebBotTos").hasSeenAgentTos()&&!d("WAWebBotTos").hasSeenShortcutTos())return!0;return a.id.isFbidBot()&&!d("WAWebBotTos").hasSeenUgcTos()?!0:!1}function c(){return d("WAWebBotTos").hasSeenInvokeTos()?!1:!d("WAWebBotTos").canShowBotTos(d("WAWebBotTosIds").getBotInvokeTosId())}g.shouldBlockByTos=a;g.shouldBlockByBotTos=b;g.shouldBlockBotInvokeAsTosNotAvailable=c}),98);
__d("WAWebElevatedPushNamesFlag",["WAWebABProps","WAWebChatGetters","WAWebContactGetters","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebStateUtils"],(function(a,b,c,d,e,f,g){function a(a){if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&(d("WAWebFrontendChatGetters").getIsCAG(a)||a.getParticipantCount()>2)}function b(a){if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&(d("WAWebFrontendChatGetters").getIsCAG(a)||a.getParticipantCount()>2)&&d("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")}function c(a){if(a==null)return!1;a=d("WAWebStateUtils").unproxy(a);var b=d("WAWebContactGetters").getNotifyName(a);return d("WAWebFrontendContactGetters").getFormattedName(a)===d("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(a)&&b!=null&&b!==""}g.elevatedPushNamesEnabled=a;g.elevatedPushNamesM2Enabled=b;g.pushNameCanBeUsed=c}),98);
__d("WAWebMediaTypes",["$InternalEnum","WAWebMsgType"],(function(a,b,c,d,e,f,g){a=Object.freeze({preview:"body",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",fullHeight:"height",fullWidth:"width",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",sidecar:"streamingSidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isLottie:"isLottie",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce",waveform:"waveform",staticUrl:"staticUrl",accessibilityLabel:"accessibilityLabel"});c=Object.freeze({body:"preview",directPath:"directPath",mediaKey:"mediaKey",mediaKeyTimestamp:"mediaKeyTimestamp",size:"size",filehash:"filehash",mimetype:"mimetype",duration:"duration",pageCount:"pageCount",height:"fullHeight",width:"fullWidth",type:"type",filename:"filename",caption:"caption",isGif:"isGif",gifAttribution:"gifAttribution",streamingSidecar:"sidecar",subtype:"subtype",firstFrameLength:"firstFrameLength",firstFrameSidecar:"firstFrameSidecar",isAnimated:"isAnimated",isLottie:"isLottie",isVcardOverMmsDocument:"isVcardOverMmsDocument",isViewOnce:"isViewOnce",waveform:"waveform",staticUrl:"staticUrl",stickerPackId:"stickerPackId",stickerPackName:"stickerPackName",stickerPackPublisher:"stickerPackPublisher",accessibilityLabel:"accessibilityLabel"});e=Object.keys(c);f=["filehash","height","mimetype","size","type","width","stickerPackId","stickerPackName","stickerPackPublisher","accessibilityLabel"];var h=[].concat(e,["deprecatedMms3Url","encFilehash","streamable"]),i=Object.freeze({VIDEO:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData","staticUrl"]),PTV:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","duration","durationFloat","isViewOnce","fullPreviewData","staticUrl"]),AUDIO:Object.freeze(["duration","waveform"]),IMAGE:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview","isViewOnce","fullPreviewData","staticUrl"]),PRODUCT:Object.freeze(["aspectRatio","fullWidth","fullHeight","preview"]),STICKER:Object.freeze(["animationDuration","singleLoopDuration","emojis","firstFrameLength","firstFrameSidecar","isAnimated","isAvatar","isAiSticker","isLottie","isFirstParty","isFromStickerMaker","stickerPackId","stickerPackName","stickerPackPublisher","stickerMakerSourceType","fullWidth","fullHeight","preview","rgbaBuffer","rgbaWidth","rgbaHeight","aspectRatio","extractedLottieSticker","accessibilityLabel"]),STICKER_PACK:Object.freeze([]),DOCUMENT:Object.freeze(["aspectRatio","pageCount","preview","isVcardOverMmsDocument","parsedVcards","fullPreviewData","fullPreviewSize"]),RAW:Object.freeze(["mediaBlob","size","loadedSize","filehash","progressiveStage"]),BIZ_COVER_PHOTO:Object.freeze([])}),j=["type","filename","caption","isGif","gifAttribution","mimetype","pageCount","sidecar","subtype","isViewOnce","accessibilityLabel"],k=b("$InternalEnum").Mirrored(["INIT","EXISTS","PREPARING","REUPLOADING","FETCHING","PROCESSING","NEED_POKE","ERROR_MISSING","ERROR_UNSUPPORTED","PROGRESSIVE_READY","RESOLVED"]),l=b("$InternalEnum").Mirrored(["INIT","PREPARING","UPLOADING","FINALIZING","NEED_UPLOAD","ERROR_FILE_NOT_READABLE","ERROR_MISSING","ERROR_TOO_LARGE","UPLOADED"]);b=b("$InternalEnum").Mirrored(["INIT","EXISTS","PREPARING","UPLOADING","FINALIZING","SENDING","REUPLOADING","FETCHING","DECRYPTING","RESOLVED","NEED_POKE","NEED_UPLOAD","ERROR_FILE_NOT_READABLE","ERROR_MISSING","ERROR_TOO_LARGE","ERROR_UNSUPPORTED","PROGRESSIVE_READY","REMOTE_UPLOADING","REMOTE_NEED_UPLOAD"]);d={IMAGE:"image",VIDEO:"video",PTV:"ptv",AUDIO:"audio",PTT:"ptt",STICKER:"sticker",DOCUMENT:"document",PRODUCT:"product",BIZ_COVER_PHOTO:"biz-cover-photo",UNKNOWN:"unknown",STICKER_PACK:"sticker-pack",MESSAGE_HISTORY_BUNDLE:d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE};var m=Object.freeze({VIDEO:"VIDEO",PTV:"PTV",IMAGE:"IMAGE",AUDIO:"AUDIO",STICKER:"STICKER",DOCUMENT:"DOCUMENT",PRODUCT:"PRODUCT",BIZ_COVER_PHOTO:"BIZ_COVER_PHOTO"});g.MEDIA_TO_MSG=a;g.MSG_TO_MEDIA=c;g.MAPPED_MSG_PROPS=e;g.MAPPED_STICKER_PROPS=f;g.MEDIA_MSG_PROPS=h;g.FIELDS=i;g.MSG_SPECIFIC_FIELDS=j;g.DownloadStage=k;g.UploadStage=l;g.MediaDataStage=b;g.OUTWARD_TYPES=d;g.TYPE=m}),98);
__d("WAWebOrderItemGetters",["WAWebGetters","WAWebGettersCaches","WAWebMediaData","WAWebMediaTypes"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createOrderItemCache});b=a.field;e=a.computed;f=a.clearCacheFor;a=f;f=b("thumbnailUrl");b=e(function(a){a=a[0];return new(c("WAWebMediaData"))({mediaStage:a!=null?d("WAWebMediaTypes").MediaDataStage.RESOLVED:d("WAWebMediaTypes").MediaDataStage.PREPARING,renderableUrl:a!=null?""+a:null})},[f]);g.clearOrderItemGetterCacheFor=a;g.getMediaData=b}),98);
__d("WAWebMediaMetadata",["WALogger","WAWebMediaCryptoEligibilityUtils","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var b=a.mediaObject;if(!b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: mediaMetadata msg without mediaObject");throw c("err")("msg.mediaMetadata with no mediaObject")}b=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(a)?b.entries.getEntryByEncFilehash({encFilehash:a.encFilehash,deprecatedMms3Url:a.deprecatedMms3Url}):b.entries.getUnencryptedEntry(a.filehash,a.directPath);if(!b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: mediaMetadata no entry");throw c("err")("msg.mediaMetadata with entry mismatch")}var e=a.mediaData;return{url:d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(a)?b.deprecatedMms3Url:null,directPath:b.directPath,encFilehash:b.getEncfilehash(),mediaKey:b.getMediaKey(),mediaKeyTimestamp:b.getMediaKeyTimestamp(),filehash:a.filehash,type:e.type,mimetype:e.mimetype,filename:e.filename,duration:e.duration,width:e.fullWidth,height:e.fullHeight,firstFrameLength:e.firstFrameLength,isAnimated:e.isAnimated,isLottie:e.isLottie,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:a.thumbnailSha256,thumbnailEncSha256:a.thumbnailEncSha256,thumbnailHeight:a.thumbnailHeight,thumbnailWidth:a.thumbnailWidth,metadataUrl:a.metadataUrl,waveform:a.waveform,staticUrl:a.staticUrl}}g.mediaMetadata=a}),98);
__d("WAWebWamEnumEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({SETTINGS_CONTACTS:1,CONTACTS_LIST:2,CONTACTS_MENU:3,CONTACTPICKER_LIST:4,CONTACTPICKER_MENU:5,EMPTY_CONVERSATIONS:6,EMPTY_CONTACTS:7,INVITE_NON_WA_CONTACT:8,EMPTY_CALLS:9,CHATS_LIST:10,CHANNEL_THREAD:11,CHANNEL_INFO:12,CHAT_THREAD:13,CHAT_HOME:14,CHAT_INFO_PAGE:15,SEARCH_FILTER:16,BUSINESS_HOME:17,OVERFLOW_MENU:18,BUSINESS_TOOLS:19,SETTINGS:20,APP_STORE:21,ACCOUNT_SETTINGS:22,CHAT_LONG_PRESS_OPTIONS:23,CHAT_SELECT_OPTIONS:24,CHAT_SWIPE:25,CHAT_MORE_OPTIONS:26,DEEP_LINK:27,ALERT:28,KEYBOARD_SHORTCUTS:29,ADD_EDIT_PRODUCT:30,AI_HUB_CHAT:31,TOPICS_CHECKLIST:32,LEARNING_SUMMARY:33,CATALOG_PRODUCT_DETAILS:34,AI_HOME:35,MESSAGE:36,KNOWLEDGE_REPO:37,COACHING_INDICATOR:38,SPAM_FOLDER:39,SAMPLE_RESPONSE_BOTTOMSHEET:40,CHAT_BANNER:41,CHAT_ATTACHMENT_MENU:42,ORDERS:43,PROFILE_EDIT:44,ONBOARDING:45,COACHING_ENTRYPOINT_BUTTON:46,COACHING_INLINE_FEEDBACK_BUTTONS:47,MESSAGE_HEADER:48,MESSAGE_CTA:49,NOTIFICATION:50,BB_HOME:51,BB_THREAD:52,BB_THREAD_BANNER:53,BB_HOME_USED_ALL_BB_CREDIT_MV_BANNER:54,BB_HOME_USED_MOST_BB_CREDIT_MV_BANNER:55,BB_THREAD_USED_ALL_BB_CREDIT_MV_BANNER:56,BB_THREAD_USED_MOST_BB_CREDIT_MV_BANNER:57,BB_THREAD_NEED_MORE_CREDIT_MV_BANNER:58,BB_REVIEW_USED_ALL_BB_CREDIT_MV_BANNER:59,BB_REVIEW_USED_MOST_BB_CREDIT_MV_BANNER:60,BB_REVIEW_NEED_MORE_CREDIT_MV_BANNER:61,MESSAGE_CAPPING_NUX:62,ADVANCED_TOOLS_BOTTOM_SHEET:63,DEEP_LINK_CHAT_PSA:64,NAV_BAR:65});f.ENTRY_POINT=a}),66);
__d("WAWebWamEnumOppositePlatformEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({CONSUMER:0,BUSINESS:1});f.OPPOSITE_PLATFORM_ENUM=a}),66);
__d("WAWebWamEnumSmbFeatureNameEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({NOTES:0,GEN_AI_AGENT:1,BROADCAST_LIST:2,BIZ_APP_ONBOARDING:3,BUSINESS_TOOLS_HOME:4,CATALOG:5,BUSINESS_PROFILE:6,LEARNING_HUB:7,BUSINESS_BROADCAST:8});f.SMB_FEATURE_NAME_ENUM=a}),66);
__d("WAWebWamEnumSmbUserActionTypeEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({VIEW:0,CLICK:1,ENTER:2,SCROLL:3,SCAN:4,API:5,EDIT:6,DELETE:7,SEARCH:8,DISMISS:9});f.SMB_USER_ACTION_TYPE_ENUM=a}),66);
__d("WAWebSmbUserJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumEntryPoint","WAWebWamEnumOppositePlatformEnum","WAWebWamEnumSmbFeatureNameEnum","WAWebWamEnumSmbUserActionTypeEnum","WAWebWamEnumSurfaceType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({SmbUserJourney:[5462,{actionType:[1,d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES],contactIsSaved:[2,a.TYPES.BOOLEAN],entryPoint:[3,d("WAWebWamEnumEntryPoint").ENTRY_POINT],extraAttributes:[4,a.TYPES.STRING],oppositePlatform:[5,d("WAWebWamEnumOppositePlatformEnum").OPPOSITE_PLATFORM_ENUM],prevSurface:[14,d("WAWebWamEnumSurfaceType").SURFACE_TYPE],recipientSize:[12,a.TYPES.INTEGER],seqId:[7,a.TYPES.INTEGER],smbFeatureName:[8,d("WAWebWamEnumSmbFeatureNameEnum").SMB_FEATURE_NAME_ENUM],smbUserActionType:[13,d("WAWebWamEnumSmbUserActionTypeEnum").SMB_USER_ACTION_TYPE_ENUM],smbUserSessionId:[9,a.TYPES.STRING],surface:[10,d("WAWebWamEnumSurfaceType").SURFACE_TYPE],userActionTarget:[11,a.TYPES.STRING]},[1,1,1],"regular"]},{SmbUserJourney:[]});g.SmbUserJourneyWamEvent=b}),98);
__d("WAWebMediaProduct",["$InternalEnum","WAWebFileUtils","WAWebMmsMediaTypes","WAWebSmbUserJourneyWamEvent","WAWebUploadManager","WAWebWamEnumMediaUploadResultType","WAWebWamEnumSmbFeatureNameEnum","WAWebWamEnumSmbUserActionTypeEnum","WAWebWamEnumSurfaceType","WAWebWamEnumUploadOriginType","WAWebWamMediaMetricUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({ImageUpload:"image_upload"});function i(a,b){b=JSON.stringify(b);new(d("WAWebSmbUserJourneyWamEvent").SmbUserJourneyWamEvent)({smbUserActionType:d("WAWebWamEnumSmbUserActionTypeEnum").SMB_USER_ACTION_TYPE_ENUM.API,surface:a?d("WAWebWamEnumSurfaceType").SURFACE_TYPE.ADD_ITEM:d("WAWebWamEnumSurfaceType").SURFACE_TYPE.EDIT_ITEM,smbFeatureName:d("WAWebWamEnumSmbFeatureNameEnum").SMB_FEATURE_NAME_ENUM.CATALOG,userActionTarget:h.ImageUpload,extraAttributes:b}).commit()}function a(a,b,c,d){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){a=(yield d("WAWebFileUtils").blobToArrayBuffer(a.forceToBlob()).then(function(a){return c("WAWebUploadManager").unencryptedUpload({file:a,hash:b,signal:new AbortController().signal,type:d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT_CATALOG_IMAGE,uploadOrigin:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.PRODUCT_CATALOG,isViewOnce:!1,generateThumbnailOnServer:!1}).then(function(a){i(f,{media_upload_result:d("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE.OK,media_upload_index:e});return a})["catch"](function(a){i(f,{media_upload_result:d("WAWebWamMediaMetricUtils").getMetricUploadErrorResultType(a),media_upload_index:e});throw a})}));return new URL(a.directPath,"https://mmg.whatsapp.net").toString()});return j.apply(this,arguments)}g.uploadProductImage=a}),98);
__d("WAWebMediaVideoStreaming",[],(function(a,b,c,d,e,f){function a(a){var b=a.mediaObject;return b?b.videoStreamingInfo(a.id.toString()):null}f.videoStreamingInfo=a}),66);
__d("WAWebMedia",["WAWebCheckMediaExistence","WAWebClearMediaForChat","WAWebDownloadProgressiveJpegThumbnail","WAWebDownloadStatusThumbnail","WAWebDownloadVideoThumbnail","WAWebManuallySetMedia","WAWebMediaCancelDownloadMsg","WAWebMediaCancelUploadMsg","WAWebMediaDownloadMsg","WAWebMediaForwardMediaMsg","WAWebMediaMetadata","WAWebMediaMsgRegistration","WAWebMediaPrep","WAWebMediaProduct","WAWebMediaResumeUploadMsg","WAWebMediaStickers","WAWebMediaVideoStreaming","WAWebPrepRawMedia"],(function(a,b,c,d,e,f){a=importNamespace("WAWebDownloadVideoThumbnail").downloadVideoThumbnail;b=importNamespace("WAWebMediaPrep").MediaPrep;c=importNamespace("WAWebCheckMediaExistence").checkMediaExistence;d=importNamespace("WAWebClearMediaForChat").clearMediaForChat;e=importNamespace("WAWebMediaDownloadMsg").downloadMsg;var g=importNamespace("WAWebDownloadProgressiveJpegThumbnail").downloadProgressiveJpegThumbnail,h=importNamespace("WAWebDownloadStatusThumbnail").downloadStatusThumbnail,i=importNamespace("WAWebMediaForwardMediaMsg").forwardMediaMsg,j=importNamespace("WAWebManuallySetMedia").manuallySetMedia,k=importNamespace("WAWebPrepRawMedia").prepRawMedia,l=importNamespace("WAWebMediaResumeUploadMsg").resumeUploadMsg;Object.keys(importNamespace("WAWebMediaCancelDownloadMsg")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaCancelDownloadMsg")[a]});Object.keys(importNamespace("WAWebMediaCancelUploadMsg")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaCancelUploadMsg")[a]});Object.keys(importNamespace("WAWebMediaMetadata")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaMetadata")[a]});Object.keys(importNamespace("WAWebMediaMsgRegistration")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaMsgRegistration")[a]});Object.keys(importNamespace("WAWebMediaProduct")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaProduct")[a]});Object.keys(importNamespace("WAWebMediaStickers")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaStickers")[a]});Object.keys(importNamespace("WAWebMediaVideoStreaming")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("WAWebMediaVideoStreaming")[a]});f.downloadVideoThumbnail=a;f.MediaPrep=b;f.checkMediaExistence=c;f.clearMediaForChat=d;f.downloadMsg=e;f.downloadProgressiveJpegThumbnail=g;f.downloadStatusThumbnail=h;f.forwardMediaMsg=i;f.manuallySetMedia=j;f.prepRawMedia=k;f.resumeUploadMsg=l}),66);
__d("WAWebWamEnumWebcRmrReasonCode",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,MSG_CLICK:1,STICKER_PANEL_ICON:2,MEDIA_VIEWER:3,VIDEO_STREAMING:4,STATUS_V3:5,MULTI_SELECT_DOWNLOAD:6,DOCUMENT_DOWNLOAD:7,PIP:8,STICKER_PANEL_STICKER:9,SEND_TO_CHAT:10,UPLOAD:11,MSG_INIT:12,MSG_UPDATE:13,MSG_DELETE:14,MSG_RENDER:15});f.WEBC_RMR_REASON_CODE=a}),66);
__d("WAWebMediaAutoDownloadQueue",["$InternalEnum","WAConcurrentPriorityPromiseQueue","WALogger","WAWebMedia","WAWebMediaDownloadMmsThumbnail","WAWebMiscGatingUtils","WAWebMsgGetters","WAWebMsgModelPropUtils","WAWebMsgModelUtils","WAWebMsgType","WAWebStickerMimeUtils","WAWebStickerModel","WAWebUserPrefsGeneral","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=b("$InternalEnum")({MEDIA:"media",MMS_THUMBNAIL:"mms_thumbnail"}),m=32*1024*1024,n=512*1024,o=5,p=512,q=500*1024;function r(a){var b=a.type===d("WAWebMsgType").MSG_TYPE.STICKER&&a.mimetype===d("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType&&a.isLottie===!0&&a.isAnimated===!0;return b||d("WAWebMsgModelPropUtils").isTrusted(a.unsafe())}function s(a){switch(a.type){case d("WAWebMsgType").MSG_TYPE.AUDIO:case d("WAWebMsgType").MSG_TYPE.PTT:return d("WAWebUserPrefsGeneral").getAutoDownloadAudio();case d("WAWebMsgType").MSG_TYPE.STICKER:case d("WAWebMsgType").MSG_TYPE.IMAGE:return d("WAWebUserPrefsGeneral").getAutoDownloadPhotos();case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.PTV:return a.isGif&&a.size<q?d("WAWebUserPrefsGeneral").getAutoDownloadPhotos():d("WAWebUserPrefsGeneral").getAutoDownloadVideos();case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return d("WAWebUserPrefsGeneral").getAutoDownloadDocuments()}return!1}function t(a){switch(a.type){case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.PTV:case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return a.size<=m;case d("WAWebMsgType").MSG_TYPE.AUDIO:case d("WAWebMsgType").MSG_TYPE.PTT:return a.size<n;case d("WAWebMsgType").MSG_TYPE.STICKER:return!0}return!1}a=function(){function a(){this.$1=new(c("WAConcurrentPriorityPromiseQueue"))(o,{photos:2,videos:1,audio:1,documents:1,mms_thumbnail:4})}var e=a.prototype;e.getEnqueuedTasksCount=function(){return this.$1.getEnqueuedTasksCount()};e.clearQueue=function(){this.$1.clearQueue()};e.$2=function(){return d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&d("WAWebUserPrefsGeneral").getAutoDownloadPhotos()&&this.getEnqueuedTasksCount()<p};e.enqueue=function(a,b,c){if(a instanceof d("WAWebStickerModel").StickerModel){if(this.$2()){void this.$3({sticker:a});return!0}return!1}a=a;var e=d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&b===l.MEDIA&&!d("WAWebMsgGetters").getIsNewsletterMsg(a)&&r(a)&&a.isNewMsg&&s(a)&&t(a)&&this.getEnqueuedTasksCount()<p;if(e)switch(a.type){case d("WAWebMsgType").MSG_TYPE.AUDIO:case d("WAWebMsgType").MSG_TYPE.PTT:this.$4({message:a,group:"audio",chat:c});return!0;case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.STICKER:this.$4({message:a,group:"photos",chat:c});return!0;case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.PTV:if(a.isGif&&a.size<q){this.$4({message:a,group:"photos",chat:c});return!0}this.$4({message:a,group:"videos",chat:c});return!0;case d("WAWebMsgType").MSG_TYPE.DOCUMENT:this.$4({message:a,group:"documents",chat:c});return!0}if(b===l.MMS_THUMBNAIL){if(a.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT||d("WAWebMsgModelUtils").typeIsUrl(a)){this.$5({message:a,group:"mms_thumbnail",chat:c});return!0}if(a.type===d("WAWebMsgType").MSG_TYPE.IMAGE||a.type===d("WAWebMsgType").MSG_TYPE.VIDEO||a.type===d("WAWebMsgType").MSG_TYPE.PTV){this.$6({message:a,group:"mms_thumbnail"});return!0}}return!1};e.$3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.sticker;if(!e.mediaObject){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sticker mediaObject does not exist for media at enqueue time ",""])),c("gkx")("26258")?"":e.id).sendLogs("Sticker mediaObject does not exist for media at enqueue time");return}yield this.$1.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!e.mediaObject){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Sticker mediaObject does not exist for media at download time ",""])),c("gkx")("26258")?"":e.id).sendLogs("Sticker mediaObject does not exist for media at download time");return}yield e.downloadMedia()}),{group:"photos",priority:1})});function e(b){return a.apply(this,arguments)}return e}();e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.message;a=a.group;if(!e.mediaObject){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["mediaObject does not exist for media at enqueue time ",""])),c("gkx")("26258")?"":e.id).sendLogs("mediaObject does not exist for media at enqueue time");return}yield this.$1.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!e.mediaObject){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["mediaObject does not exist for media at download time ",""])),c("gkx")("26258")?"":e.id).sendLogs("mediaObject does not exist for media at download time",{sampling:0});return}if(!s(e))return;yield e.downloadMedia({downloadEvenIfExpensive:!1,rmrReason:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.OTHER,isUserInitiated:!1,isAutoDownload:!0})}),{group:a,priority:-e.t})});function e(b){return a.apply(this,arguments)}return e}();e.$5=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var d=a.message,e=a.chat;a=a.group;yield this.$1.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c("WAWebMediaDownloadMmsThumbnail")({msg:d,chat:e})}),{group:a,priority:-d.t})});function d(b){return a.apply(this,arguments)}return d}();e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.message;a=a.group;yield this.$1.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebMedia").downloadStatusThumbnail({msg:c})}),{group:a,priority:-c.t})});function c(b){return a.apply(this,arguments)}return c}();return a}();e=new a();g.AutoDownloadTypes=l;g.MAX_AUTO_DOWNLOAD_SIZE=m;g.AUDIO_AUTO_DOWNLOAD_SIZE_LIMIT=n;g.shouldTrustMedia=r;g.shouldAutoDownloadMedia=s;g.validateMediaSize=t;g.AutoDownloadQueue=e}),98);
__d("WAWebMediaData",["WALogger","WAWebBaseModel","WAWebFeatureDetectionSwSupport","WAWebMediaCleanFileName","WAWebMediaInMemoryBlobCache","WAWebMediaTypes"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.type=d("WAWebBaseModel").prop(d("WAWebMediaTypes").OUTWARD_TYPES.UNKNOWN),b.directPath=d("WAWebBaseModel").prop(),b.mediaKey=d("WAWebBaseModel").prop(),b.mediaKeyTimestamp=d("WAWebBaseModel").prop(),b.encFilehash=d("WAWebBaseModel").prop(),b.mediaStage=d("WAWebBaseModel").prop(d("WAWebMediaTypes").MediaDataStage.INIT),b.size=d("WAWebBaseModel").prop(),b.loadedSize=d("WAWebBaseModel").prop(),b.filehash=d("WAWebBaseModel").prop(),b.mimetype=d("WAWebBaseModel").prop(),b.mediaBlob=d("WAWebBaseModel").prop(),b.renderableUrl=d("WAWebBaseModel").prop(),b.fullHeight=d("WAWebBaseModel").prop(),b.fullWidth=d("WAWebBaseModel").prop(),b.aspectRatio=d("WAWebBaseModel").prop(),b.rgbaBuffer=d("WAWebBaseModel").prop(),b.rgbaHeight=d("WAWebBaseModel").prop(),b.rgbaWidth=d("WAWebBaseModel").prop(),b.animationDuration=d("WAWebBaseModel").prop(0),b.animatedAsNewMsg=d("WAWebBaseModel").prop(!1),b.isAnimated=d("WAWebBaseModel").prop(),b.isFirstParty=d("WAWebBaseModel").prop(),b.isFromStickerMaker=d("WAWebBaseModel").prop(),b.isAvatar=d("WAWebBaseModel").prop(),b.isAiSticker=d("WAWebBaseModel").prop(),b.isLottie=d("WAWebBaseModel").prop(),b.stickerPackId=d("WAWebBaseModel").prop(),b.stickerPackName=d("WAWebBaseModel").prop(),b.stickerPackPublisher=d("WAWebBaseModel").prop(),b.stickerMakerSourceType=d("WAWebBaseModel").prop(),b.singleLoopDuration=d("WAWebBaseModel").prop(),b.firstFrameLength=d("WAWebBaseModel").prop(),b.firstFrameSidecar=d("WAWebBaseModel").prop(),b.emojis=d("WAWebBaseModel").prop(),b.accessibilityLabel=d("WAWebBaseModel").prop(),b.progressiveStage=d("WAWebBaseModel").prop(),b.isViewOnce=d("WAWebBaseModel").prop(!1),b.staticUrl=d("WAWebBaseModel").prop(),b.preview=d("WAWebBaseModel").prop(),b.sidecar=d("WAWebBaseModel").prop(),b.duration=d("WAWebBaseModel").prop(),b.durationFloat=d("WAWebBaseModel").prop(),b.isGif=d("WAWebBaseModel").prop(),b.gifAttribution=d("WAWebBaseModel").prop(),b.streamable=d("WAWebBaseModel").derived(function(){return this.isStreamable()},["isGif","isViewOnce","mediaStage","sidecar","type","swStreamingSupported"]),b.swStreamingSupported=d("WAWebBaseModel").prop(!1),b.$MediaData$p_1=d("WAWebBaseModel").prop(!1),b.filename=d("WAWebBaseModel").prop(),b.pageCount=d("WAWebBaseModel").prop(),b.documentPreview=d("WAWebBaseModel").prop(),b.isVcardOverMmsDocument=d("WAWebBaseModel").prop(!1),b.parsedVcards=d("WAWebBaseModel").prop(),b.extractedLottieSticker=d("WAWebBaseModel").prop(),b.fullPreviewSize=d("WAWebBaseModel").prop(),b.fullPreviewData=d("WAWebBaseModel").prop(),b.subtype=d("WAWebBaseModel").prop(),b.waveform=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){a.prototype.initialize.call(this)};e.set=function(b,c,d){d=d;if(typeof b==="string"){var e;e=(e={},e[b]=c,e)}else e=b,d=c;e=m(e);return a.prototype.set.call(this,e,d)};e.isStreamable=function(){return this.isStreamableType()&&this.listenToServiceWorkerSupport()&&!this.isViewOnce};e.$MediaData$p_2=function(a){this.swStreamingSupported=a};e.listenToServiceWorkerSupport=function(){if(this.$MediaData$p_1)return this.swStreamingSupported;this.listenTo(c("WAWebFeatureDetectionSwSupport"),"change:streamingSupported",this.$MediaData$p_2);this.swStreamingSupported=Boolean(c("WAWebFeatureDetectionSwSupport").streamingSupported);this.$MediaData$p_1=!0;return this.swStreamingSupported};e.isStreamableType=function(){return this.type===d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO&&!this.isGif&&(this.mediaStage===d("WAWebMediaTypes").MediaDataStage.INIT||this.mediaStage===d("WAWebMediaTypes").MediaDataStage.FETCHING||this.mediaStage===d("WAWebMediaTypes").MediaDataStage.DECRYPTING||this.mediaStage===d("WAWebMediaTypes").MediaDataStage.RESOLVED)&&this.fullWidth!=null&&this.fullHeight!=null&&Boolean(this.sidecar&&this.sidecar.byteLength>0)};e.isDownloadable=function(){if(this.isViewOnce)return!1;var a=this.renderableUrl!=null;if(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasRenderableUrl = ",""])),a);return!0}a=d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.has(this.filehash);if(a){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasCachedBlob = ",""])),a);return!0}a=this.mediaStage===d("WAWebMediaTypes").MediaDataStage.EXISTS||this.mediaStage===d("WAWebMediaTypes").MediaDataStage.PROGRESSIVE_READY;if(a){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: hasValidMediaStage = "," (stage: ",")"])),a,this.mediaStage);return!0}d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["MediaData.isDownloadable: no conditions met, returning false"])));return!1};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="mediaData";var l=d("WAWebBaseModel").defineModel(a);l.TYPE=d("WAWebMediaTypes").OUTWARD_TYPES;b=l;function m(a){if(a.filename&&a.type===l.TYPE.DOCUMENT){var b=d("WAWebMediaCleanFileName").cleanFilename(a.filename);return babelHelpers["extends"]({},a,{filename:b,caption:b})}return a}g["default"]=b}),98);
__d("WAWebMediaOpaqueData",["Promise","WABase64","WALogger","WANullthrows","WAShiftTimer","WAWebFileUtils","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=[],p=new(d("WAShiftTimer").ShiftTimer)(a),q=function(){function a(){this._retainCount=1,this._inAutoreleasePool=!1,this.released=!1,this._b64=void 0,this.blob=void 0,this._url=void 0,this._mimetype=void 0,this._released=void 0}var e=a.prototype;e.retain=function(){if(this.released){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:retain called on released OpaqueData"])));throw c("err")("OpaqueData:retain called on released OpaqueData")}else this._retainCount++};e.autorelease=function(){this.released?d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:autorelease called on released object"]))):this._retainCount===0?d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:autorelease too many release calls"]))):this._retainCount===1?(this._retainCount=0,this._inAutoreleasePool||(this._inAutoreleasePool=!0,o.push(this),p.onOrBefore(1e3))):this._retainCount--};e.autoreleaseWhenPromiseCompletes=function(a){var b=this,c=function(){b.autorelease()};a.then(c,c)};e.throwIfReleased=function(a){if(this.released){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," called on released OpaqueData"])),a);throw c("err")(a+" called on released OpaqueData")}else this._retainCount===0&&d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose([""," called on unretained OpaqueData"])),a)};e.url=function(){this.throwIfReleased("OpaqueData:url");if(this._url!=null&&this._url!=="")return this._url;if(this._b64!=null&&this._b64!==""){this._url="data:image/jpeg;base64,"+this._b64;return this._url}this._url=window.URL.createObjectURL(c("WANullthrows")(this.blob,"unexpected empty blob"));return this._url};e.getBlob=function(){return this.blob};e.getBase64=function(){return this._b64};e.validate=function(){if(this._released===!0)return(n||(n=b("Promise"))).resolve(!1);else if(this.blob)return d("WAWebFileUtils").validateBlob(this.blob);return(n||(n=b("Promise"))).resolve(!0)};e.size=function(){this.throwIfReleased("OpaqueData:size");if(this.blob)return this.blob.size;else if(this._b64!=null)return d("WABase64").sizeWhenB64Decoded(this._b64);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["OpaqueData:size returned 0"]))).sendLogs("opaque-data-size-0");return 0};e.formData=function(a){this.throwIfReleased("OpaqueData:formData");return this.forceToBlob()};e.type=function(){this.throwIfReleased("OpaqueData:type");return this._mimetype!=null&&this._mimetype!==""?this._mimetype:"undefined"};e.forceToBlob=function(){this.throwIfReleased("OpaqueData:forceToBlob");var a=this.blob;if(a)return a;a=this._b64;if(a!=null&&a!==""){this._b64=void 0;this._url=void 0;var b=this._mimetype;return this.blob=new Blob([d("WABase64").decodeB64(a)],b!=null&&b!==""?{type:b}:void 0)}throw c("err")("OpaqueData:forceToBlob no b64 or blob")};e._releaseImpl=function(){this._mimetype=void 0;var a=this.blob;a?(this.blob=void 0,this._url!=null&&this._url!==""&&(window.URL.revokeObjectURL(this._url),this._url=void 0)):(this._b64=void 0,this._url=void 0)};e.isBlobEqual=function(a){return!a?!this.blob:this.blob===a.blob};return a}();q.createFromBase64Jpeg=function(a){return new(n||(n=b("Promise")))(function(b){var c=new q();c._b64=a;c._mimetype="image/jpeg";return b(c)})};q.createFromData=function(a,c){return new(n||(n=b("Promise")))(function(b){var d=new q();d.blob=a instanceof Blob&&a.type===c?a:new Blob([a],{type:c});d._mimetype=c;return b(d)})};function a(){var a=o;o=[];for(var b=0;b<a.length;b++){var c=a[b];c._inAutoreleasePool=!1;c._retainCount===0&&!c.released&&(c.released=!0,c._releaseImpl())}}g["default"]=q}),98);
__d("WAWebGetThumbnailTypeForMediaChatMsg",["WAWebMmsMediaTypes","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){function a(a){a=a.msg;a=d("WAWebMsgGetters").getIsNewsletterMsg(a);return a?d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK:d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK}g["default"]=a}),98);
__d("WAWebGetThumbnailTypeForMediaDocumentMsg",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT}g["default"]=a}),98);
__d("WAWebGetThumbnailTypeForMediaImageMsg",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE}g["default"]=a}),98);
__d("WAWebGetThumbnailTypeForMediaInteractiveMsg",["WAWebInteractiveMessageHeaderMediaType","WAWebMmsMediaTypes","err"],(function(a,b,c,d,e,f,g){function a(a){a=a.msg;a=a.interactiveHeader;if((a==null?void 0:a.mediaType)!=null)switch(a.mediaType){case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;default:break}throw c("err")("getThumbnailTypeForMediaMsg: unsupported msg type")}g["default"]=a}),98);
__d("WAWebGetThumbnailTypeForMediaStickerPackMsg",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK}g["default"]=a}),98);
__d("WAWebGetThumbnailTypeForMediaVideoMsg",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO}g["default"]=a}),98);
__d("WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry",["WAWebGetThumbnailTypeForMediaChatMsg","WAWebGetThumbnailTypeForMediaDocumentMsg","WAWebGetThumbnailTypeForMediaImageMsg","WAWebGetThumbnailTypeForMediaInteractiveMsg","WAWebGetThumbnailTypeForMediaStickerPackMsg","WAWebGetThumbnailTypeForMediaVideoMsg"],(function(a,b,c,d,e,f,g){a=[{type:"album",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"audio",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"biz_content_placeholder",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"buttons_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"chat",subtype:"url",getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaChatMsg")},{type:"chat",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaChatMsg")},{type:"ciphertext",subtype:"bot_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:"view_once_unavailable_fanout",getThumbnailTypeForMediaMsg:null},{type:"ciphertext",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"comment",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"debug_placeholder",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"document",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaDocumentMsg")},{type:"event_creation",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"event_edit_encrypted",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"event_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"groups_v4_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"hsm",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"image",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaImageMsg")},{type:"interactive",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaInteractiveMsg")},{type:"interactive_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"keep_in_chat",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"list",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"list_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"location",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"multi_vcard",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"native_flow",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_admin_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_follower_invite",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"newsletter_question_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"notification_template",subtype:"contact_info_card",getThumbnailTypeForMediaMsg:null},{type:"order",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"ciphertext",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"futureproof",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"invite",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"request",getThumbnailTypeForMediaMsg:null},{type:"payment",subtype:"send",getThumbnailTypeForMediaMsg:null},{type:"pin_message",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"pinned_message",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_creation",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_result_snapshot",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"poll_update",subtype:"poll_vote",getThumbnailTypeForMediaMsg:null},{type:"product",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"admin_revoke",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_feedback",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_memu_onboarding",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"bot_request_welcome",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"ephemeral_setting",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"ephemeral_sync_response",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"event_edit_decrypted",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"history_sync_notification",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"limit_sharing_system_message",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"member_label",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_edit",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_history_bundle",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"message_history_notice",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"sender_revoke",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"share_phone_number",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"status_group_mention_message",getThumbnailTypeForMediaMsg:null},{type:"protocol",subtype:"status_mention_message",getThumbnailTypeForMediaMsg:null},{type:"ptt",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"ptv",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"reaction",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"reaction_enc",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"request_phone_number",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"revoked",subtype:"admin",getThumbnailTypeForMediaMsg:null},{type:"revoked",subtype:"sender",getThumbnailTypeForMediaMsg:null},{type:"rich_response",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"status_notification",subtype:"status_notification_message",getThumbnailTypeForMediaMsg:null},{type:"sticker",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"sticker-pack",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaStickerPackMsg")},{type:"template_button_reply",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"payment_action_request_declined",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"payment_transaction_request_cancelled",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"phone",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:"phone_only_feature",getThumbnailTypeForMediaMsg:null},{type:"unknown",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"vcard",subtype:void 0,getThumbnailTypeForMediaMsg:null},{type:"video",subtype:void 0,getThumbnailTypeForMediaMsg:c("WAWebGetThumbnailTypeForMediaVideoMsg")}];g["default"]=a}),98);
__d("WAWebMessagePluginGetThumbnailTypeForMediaMsg",["WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry","WAWebPluginCreateRegistryLookup"],(function(a,b,c,d,e,f,g){var h=d("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(c("WAWebMessagePluginGetThumbnailTypeForMediaMsgRegistry"));function a(a){var b=a.msg;b=h(b.type,b.subtype);return b==null||b.getThumbnailTypeForMediaMsg==null?void 0:b.getThumbnailTypeForMediaMsg(a)}g.getThumbnailTypeForMediaMsg=a}),98);
__d("WAWebMediaDownloadMmsThumbnail",["Promise","WAAbortError","WABase64","WALogger","WANullthrows","WAWebDownloadManager","WAWebFrontendMsgGetters","WAWebMediaCryptoEligibilityUtils","WAWebMediaOpaqueData","WAWebMessagePluginGetThumbnailTypeForMediaMsg","WAWebMmsMediaTypes","WAWebMsgType","WAWebSerializeError","asyncToGeneratorRuntime","isStringNullOrEmpty","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg,e=a.chat,f=a.isPreload;a=a.signal;if(!c("justknobx")._("1023"))return;var g=d("WAWebFrontendMsgGetters").getAsUrl(b.unsafe()),m=g==null?void 0:g.faviconMMSMetadata,n=m==null?void 0:m.thumbnailSha256;if(g==null||m==null||c("isStringNullOrEmpty")(m.thumbnailDirectPath)||n==null)return;var o=m.thumbnail==null;if(!o){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: skipping"])));return}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: start"])));try{o=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:m.thumbnailDirectPath,encFilehash:m.thumbnailEncSha256,filehash:n,mediaKey:m.mediaKey,mediaKeyTimestamp:m.mediaKeyTimestamp,type:c("WANullthrows")(d("WAWebMessagePluginGetThumbnailTypeForMediaMsg").getThumbnailTypeForMediaMsg({msg:b})),signal:a||new AbortController().signal,userDownloadAttemptCount:0,isPreload:f,chatWid:e==null?void 0:e.id}));if(o){n=d("WABase64").encodeB64(o);g.faviconMMSMetadata=babelHelpers["extends"]({},g.faviconMMSMetadata,{thumbnail:n});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: success"])))}}catch(a){if(a.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon aborted"])));return}d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMMSFavicon: error\n",""],["media.downloadMMSFavicon: error\\n",""])),c("WAWebSerializeError")(a)).verbose()}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg,e=a.chat,f=a.isPreload;a=a.signal;var g=b.thumbnailSha256,h=b.thumbnailEncSha256,i=b.thumbnailDirectPath,j=b.mediaKey,k=b.mediaKeyTimestamp;if(c("isStringNullOrEmpty")(i)||c("isStringNullOrEmpty")(g))return;if(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(b)&&(h==null||j==null||k==null))return;if((b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT||b.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE)&&d("WAWebMmsMediaTypes").getMsgMediaType(b)===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT&&(b.thumbnailHeight==null||b.thumbnailWidth==null))return;var l=d("WAWebFrontendMsgGetters").getAsUrl(b.unsafe());if(l&&(l.thumbnailHeight==null||l.thumbnailWidth==null))return;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: start"])));try{i=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:i,encFilehash:h,filehash:g,mediaKey:j,mediaKeyTimestamp:k,type:c("WANullthrows")(d("WAWebMessagePluginGetThumbnailTypeForMediaMsg").getThumbnailTypeForMediaMsg({msg:b})),signal:a||new AbortController().signal,userDownloadAttemptCount:0,isPreload:f,chatWid:e==null?void 0:e.id}));if(l)l.thumbnailHQ=d("WABase64").encodeB64(i);else{h=c("WANullthrows")(b.mediaObject,"mediaObject cannot be null for thumbnail download");g={fullPreviewData:yield c("WAWebMediaOpaqueData").createFromData(i,"image/jpeg")};b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT&&(g.fullPreviewSize={height:c("WANullthrows")(b.thumbnailHeight),width:c("WANullthrows")(b.thumbnailWidth)});h.consolidate(g)}d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: success"])))}catch(a){if(a.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail aborted"])));return}d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["media.downloadMmsThumbnail: error\n",""],["media.downloadMmsThumbnail: error\\n",""])),c("WAWebSerializeError")(a)).verbose()}});return u.apply(this,arguments)}function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield (q||(q=b("Promise"))).all([r(a),t(a)])});return v.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebMediaGetUploadOriginForChat",["WAWebChatGetters","WAWebFrontendChatGetters","WAWebStateUtils","WAWebWamEnumUploadOriginType"],(function(a,b,c,d,e,f,g){function a(a){if(!a)return d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN;a=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsNewsletter(a))return d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHANNEL;return d("WAWebChatGetters").getIsGroup(a)?d("WAWebFrontendChatGetters").getIsCAG(a)?d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.COMMUNITY:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_GROUP:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL}g["default"]=a}),98);
__d("WAWebDownloadManagerErrors",["WAWebBackendErrors"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this,404)||this;b.name="MediaNotOnPhone";return b}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBackendErrors").ServerStatusCodeError);g.MediaNotOnPhone=a}),98);
__d("WAWebMediaEntry",["Promise","WABase64Equal","WAIsMediaKeyReusable","WALogger","WATimeUtils","WAWebMediaHosts","WAWebMmsClientFormatDownloadUrl","WAWebMmsOperationsConst","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j=["filehash","handle","metadataUrl","fbid","thumbnailDirectPath","thumbnailSha256"],k=["mediaKey","mediaKeyTimestamp","encFilehash"],l,m={PROBABLY_ON_SERVER:"PROBABLY_ON_SERVER",PROBABLY_OFF_SERVER:"PROBABLY_OFF_SERVER",UNKNOWN:"UNKNOWN"};a=function(){function a(b){this.useBackupUrl=!1;if(this.constructor===a)throw c("err")("AbstractMediaEntry is an abstract class");this.deprecatedMms3Url=b.deprecatedMms3Url;this.serverStatus=m.UNKNOWN;this.sidecar=b.sidecar;this.directPath=b.directPath;this.firstFrameSidecar=b.firstFrameSidecar;this.type=b.type;this.scansSidecar=b.scansSidecar;this.scanLengths=b.scanLengths;this.staticUrl=b.staticUrl}var b=a.prototype;b.markWhetherOnServer=function(a){this.serverStatus=a?m.PROBABLY_ON_SERVER:m.PROBABLY_OFF_SERVER};b.getMediaKey=function(){return null};b.getMediaKeyTimestamp=function(){return null};b.getEncfilehash=function(){return null};b.getFilehash=function(){return null};b.getThumbnailDirectPath=function(){return null};b.getThumbnailSha256=function(){return null};b.validateForDownloads=function(){return this.serverStatus!==m.PROBABLY_OFF_SERVER};return a}();var n=function(a){function b(b){var c=b.filehash,d=b.handle,e=b.metadataUrl,f=b.fbid,g=b.thumbnailDirectPath,h=b.thumbnailSha256;b=babelHelpers.objectWithoutPropertiesLoose(b,j);b=a.call(this,b)||this;b.filehash=c;b.handle=d;b.metadataUrl=e;b.fbid=f;b.thumbnailDirectPath=g;b.thumbnailSha256=h;return b}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getFilehash=function(){return this.filehash};c.getThumbnailDirectPath=function(){return this.thumbnailDirectPath};c.getThumbnailSha256=function(){return this.thumbnailSha256};return b}(a),o=function(a){function e(b){var c=b.mediaKey,d=b.mediaKeyTimestamp,e=b.encFilehash;b=babelHelpers.objectWithoutPropertiesLoose(b,k);b=a.call(this,b)||this;b.mediaKey=c;b.mediaKeyTimestamp=d;b.encFilehash=e;return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.canReuseMediaKey=function(){if(this.directPath==null)return!1;var a=d("WATimeUtils").castToUnixTime(this.mediaKeyTimestamp);return d("WAIsMediaKeyReusable").isMediaKeyReusable(a)};f.getMediaKey=function(){return this.mediaKey};f.getMediaKeyTimestamp=function(){return this.mediaKeyTimestamp};f.getEncfilehash=function(){return this.encFilehash};f.url=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a||{};var e=a.useFallback;a=a.forceHashUrl;var f=this.encFilehash;if(f==null||f==="")return(l||(l=b("Promise"))).reject(c("err")("media_entry: encFilehash does not exist"));var g=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfo({operation:c("WAWebMmsOperationsConst").DOWNLOAD,encFilehash:f,type:this.type})),h=g.selectedHost;g=g.fallbackHost;e=Boolean(e)&&g?g:h;return c("WAWebMmsClientFormatDownloadUrl")({directPath:a?null:this.directPath,encFilehash:f,hostname:e.hostname,type:this.type})});function e(b){return a.apply(this,arguments)}return e}();return e}(a);e=function(){function a(){this.entries=[]}var b=a.prototype;b.$1=function(a){var b=a.foundEntry,c=a.mediaKey,e=a.mediaKeyTimestamp,f=a.encFilehash,g=a.sidecar,i=a.directPath,j=a.firstFrameSidecar,k=a.scansSidecar,l=a.scanLengths,m=a.deprecatedMms3Url;a=a.staticUrl;if(b instanceof o&&c!=null&&c!==""&&!d("WABase64Equal").b64Equal(b.mediaKey,c)){var n=b.mediaKey.replace("=","").split("\n")[0];c=c.replace("=","").split("\n")[0];d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\n",""],["media-fault: mediaKey changed for the same MMS3 url. type:",". equal?:",". Debug:\\n",""])),b.type,n===c,JSON.stringify({before:{hasDirectPath:Boolean(b.directPath),hasEncFilehash:Boolean(b.encFilehash),hasMediaKey:Boolean(b.mediaKey),hasDeprecatedMms3Url:Boolean(b.deprecatedMms3Url)},after:{hasDirectPath:Boolean(i),hasEncFilehash:Boolean(f),hasDeprecatedMms3Url:Boolean(m)}},null,2)).sendLogs("media-key-mismatch-same-mms3-url");return null}b instanceof o&&e!=null&&(b.mediaKeyTimestamp=e);g&&(b.sidecar=g);j&&(b.firstFrameSidecar=j);k&&(b.scansSidecar=k);l!=null&&l.length&&(b.scanLengths=l);a&&(b.staticUrl=a);b.directPath=i;return b};b.updateEntry=function(a){var b=a.deprecatedMms3Url,c=a.mediaKey,d=a.mediaKeyTimestamp,e=a.encFilehash;a.type;var f=a.sidecar,g=a.directPath,h=a.firstFrameSidecar,i=a.scansSidecar,j=a.scanLengths;a=a.staticUrl;var k=this.getEntryByEncFilehash({encFilehash:e,deprecatedMms3Url:b});if(!k)return;return this.$1({foundEntry:k,mediaKey:c,mediaKeyTimestamp:d,encFilehash:e,sidecar:f,directPath:g,firstFrameSidecar:h,scansSidecar:i,scanLengths:j,deprecatedMms3Url:b,staticUrl:a})};b.addUnencryptedEntry=function(a){var b=this.updateUnencryptedEntry({filehash:a.filehash,directPath:a.directPath});if(b){b.handle=a.handle;b.metadataUrl=a.metadataUrl;b.fbid=a.fbid;return b}b=new n({deprecatedMms3Url:a.directPath,filehash:a.filehash,type:a.type,directPath:a.directPath,handle:a.handle,metadataUrl:a.metadataUrl,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:a.thumbnailSha256,fbid:a.fbid});this.entries.push(b);return b};b.updateUnencryptedEntry=function(a){var b=a.directPath!=null?this.getUnencryptedEntry(a.filehash,a.directPath):null;if(!b||!(b instanceof n))return null;a.directPath!=null&&(b.directPath=a.directPath);return b};b.addEntry=function(a){var b=a.deprecatedMms3Url,c=a.mediaKey,e=a.mediaKeyTimestamp,f=a.encFilehash,g=a.type,h=a.sidecar,j=a.directPath,k=a.firstFrameSidecar,l=a.scansSidecar,m=a.scanLengths,n=a.staticUrl,p=a.debugHint;f==null&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Media type "," from "," is missing encFilehash"])),g,p).devConsole(a).sendLogs("media-entry-missing-upload-hash-"+g+"-"+p);a=this.entries;p=this.getEntryByEncFilehash({encFilehash:f,deprecatedMms3Url:b});p=p?this.$1({foundEntry:p,mediaKey:c,mediaKeyTimestamp:e,encFilehash:f,sidecar:h,directPath:j,firstFrameSidecar:k,scansSidecar:l,scanLengths:m,deprecatedMms3Url:b,staticUrl:n}):null;if(p instanceof o)return p;if(!c)return null;p=new o({deprecatedMms3Url:b,mediaKey:c,mediaKeyTimestamp:e,encFilehash:f,type:g,sidecar:h,directPath:j,firstFrameSidecar:k,scansSidecar:l,scanLengths:m,staticUrl:n});a.push(p);return p};b.$2=function(a){var b=a.encFilehash;a=a.deprecatedMms3Url;return b==null?"mms3:"+a:b};b.has=function(a){return this.getEntryByEncFilehash(a)instanceof o};b.hasUnencryptedEntry=function(a){return a.filehash==null||a.directPath==null?!1:this.getUnencryptedEntry(a.filehash,a.directPath)instanceof n};b.getEntryByEncFilehash=function(a){var b=this,c=this.$2(a);return this.entries.find(function(a){return a instanceof o&&b.$2({encFilehash:a.encFilehash,deprecatedMms3Url:a.deprecatedMms3Url})===c})};b.getUnencryptedEntry=function(a,b){return this.entries.find(function(c){return c instanceof n&&c.filehash===a&&c.directPath===b})};b.$3=function(a){return this.entries.filter(function(b){return a?b instanceof o:b instanceof n})};b.getUploadEntry=function(a){p(this);return this.$3(a)[0]};b.getDownloadEntry=function(a){p(this);return this.$3(a).find(function(a){return a.validateForDownloads()})};b.clearEntries=function(){this.entries=[]};return a}();function p(a){a.entries.sort(function(a,b){var c=q(b)-q(a);if(c!==0)return c;a=a.getMediaKeyTimestamp();b=b.getMediaKeyTimestamp();return a==null||b==null?c:b-a})}function q(a){var b=0;switch(a.serverStatus){case m.PROBABLY_ON_SERVER:b+=200;break;case m.PROBABLY_OFF_SERVER:break;case m.UNKNOWN:b+=100;break}a.getEncfilehash()!=null&&(b+=20);return b}g.AbstractMediaEntry=a;g.UnencryptedMediaEntry=n;g.EncryptedMediaEntry=o;g.MediaEntryList=e}),98);
__d("WAWebMmsConst",[],(function(a,b,c,d,e,f){a=100;f.FILE_PROGRESS_THROTTLE_WAIT_MS=a}),66);
__d("WAWebWamEnumStickerErrorType",[],(function(a,b,c,d,e,f){a=Object.freeze({DECOMPRESSION:2,SENDER_VALIDATION:3,RECEIVER_VALIDATION:4});f.STICKER_ERROR_TYPE=a}),66);
__d("WAWebStickerErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerErrorType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({StickerError:[5024,{stickerErrorType:[1,d("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE]},[1,1,1],"regular"]},{StickerError:[]});g.StickerErrorWamEvent=a}),98);
__d("WAWebWamEnumStickerLatencyAction",[],(function(a,b,c,d,e,f){a=Object.freeze({DECOMPRESSION:2});f.STICKER_LATENCY_ACTION=a}),66);
__d("WAWebStickerLatencyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerLatencyAction"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({StickerLatency:[5026,{size:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER],stickerLatencyAction:[2,d("WAWebWamEnumStickerLatencyAction").STICKER_LATENCY_ACTION],stickerLatencyTtAction:[3,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{StickerLatency:[]});g.StickerLatencyWamEvent=a}),98);
__d("WAWebWebcProgressiveImageWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcProgressiveImage:[2226,{webcFirstRenderScans:[1,a.TYPES.INTEGER],webcFirstRenderT:[2,a.TYPES.TIMER],webcFullQualityT:[4,a.TYPES.TIMER],webcMidQualityT:[3,a.TYPES.TIMER]},[1,1,10],"regular"]},{WebcProgressiveImage:[]});g.WebcProgressiveImageWamEvent=b}),98);
__d("WAWebMediaMmsV4Download",["WAAbortError","WABlobToArrayBuffer","WACustomError","WAFilteredCatch","WALogger","WANullthrows","WARaceSignal","WAWebABProps","WAWebCryptoImageStreamer","WAWebDownloadManager","WAWebDownloadManagerErrors","WAWebEnvironment","WAWebFileUtils","WAWebInMemoryLottieStickerCache","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaInMemoryBlobCache","WAWebMediaLoad","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMimeTypes","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsConst","WAWebMmsMediaTypes","WAWebStickerErrorWamEvent","WAWebStickerLatencyWamEvent","WAWebStickerMimeUtils","WAWebVcardParsingUtils","WAWebWamEnumStickerErrorType","WAWebWamEnumStickerLatencyAction","WAWebWebcProgressiveImageWamEvent","asyncToGeneratorRuntime","err","fflate","isStringNullOrEmpty","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("NoEntryAfterRMR")),y=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("MissingEncFilehash")),z={THUMBNAIL:1,LOW:2,MID:3,FULL:4},A=new WeakMap();function a(a){a.getDownloadPromises().forEach(function(a){var b;if(a==null)return;b=(b=A.get(a))==null?void 0:b.abort;if(b==null)return;A["delete"](a);b()})}function e(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mimetype,c=a.mediaObject,e=a.mediaBlob,f=a.mediaType,g=a.rmrReason,h=a.downloadOrigin;a=a.chatWid;if(c.mediaBlob)return;yield d("WAWebMediaDataUtils").gatherAndSetMetadata(c,e);yield E({mimetype:b,mediaObject:c,downloadEvenIfExpensive:!1,mediaType:f,rmrReason:g,downloadOrigin:h,chatWid:a})});return B.apply(this,arguments)}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mimetype,e=c("lodash").throttle(function(b){a.mediaObject.consolidate({loadedSize:b.loaded})},d("WAWebMmsConst").FILE_PROGRESS_THROTTLE_WAIT_MS);e=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({shouldSequenceDownload:a.shouldSequenceDownload,directPath:a.directPath,encFilehash:a.encFilehash,filehash:a.objFilehash,isFinalRmrRetry:a.isFinalRmrRetry,mediaKey:a.mediaKey,mediaKeyTimestamp:a.mediaKeyTimestamp,signal:a.signal,staticUrl:a.staticUrl,type:a.mediaType,onDecryptStart:function(){a.mediaObject.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.PROCESSING})},onProgress:e,userDownloadAttemptCount:a.mediaObject.userDownloadAttemptCount,downloadOrigin:a.downloadOrigin,mode:a.mode,progressiveJpegOpts:L({scanLengths:a.scanLengths,scansSidecar:a.scansSidecar,mimetype:b,mediaObject:a.mediaObject,signal:a.signal}),isViewOnce:a.isViewOnce,imageDimensions:a.mediaType===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE?{fileHeight:(e=a.mediaObject.contentInfo.fullHeight)!=null?e:0,fileWidth:(e=a.mediaObject.contentInfo.fullWidth)!=null?e:0}:void 0,chatWid:a.chatWid}));b=b!=null&&b!==""?b:d("WAWebMimeTypes").getMediaMimeType(a.mediaType,new Uint8Array(e));return new Blob([e],{type:b})});return D.apply(this,arguments)}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.mimetype,f=a.mediaObject,g=a.downloadEvenIfExpensive,u=a.mediaType,v=a.signal,w=a.rmrReason,z=a.rmrData,B=a.downloadOrigin,D=a.shouldThrow,F=a.isVcardOverMmsDocument,G=a.mode,H=a.isAutoDownload,I=a.isFinalRmrRetry,J=a.isViewOnce,K=a.chatWid;a=a.shouldSequenceDownload;var L=a===void 0?!1:a,M=D===!0,N=H!==!0||c("WAWebEnvironment").isWindows;if(!f)return;var Q=f.filehash;if(c("isStringNullOrEmpty")(Q))return;a=O(f,u);a&&N&&(a.shouldStoreInMemory=!0);D=f.getDownloadPromise(u);if(D)return D;if(f.downloadStage===d("WAWebMediaTypes").DownloadStage.ERROR_MISSING)return;if(f.downloadStage===d("WAWebMediaTypes").DownloadStage.PREPARING)return;if(f.mediaBlob){a=(yield f.mediaBlob.validate());if(a){f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.RESOLVED});return}f.clearBlob();f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});f.notifyMsgsAsync();return}var R=d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(Q),S,T=new AbortController();return c("WARaceSignal")([T.signal,v].filter(Boolean),function(a){var v,U=function(){var j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(R)D=R;else{S=f.entries.getDownloadEntry(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(u));if(!S)if(g&&d("WAWebMediaCryptoEligibilityUtils").isRmrSupportedForMediaType(u)){yield d("WAWebDownloadManager").downloadManager.rmr({mediaObject:f,signal:a,rmrReason:w,rmrData:z});S=f.entries.getDownloadEntry(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(u));if(!S){if(u!==d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)throw new x();return}}else{if(!d("WAWebMediaCryptoEligibilityUtils").isRmrSupportedForMediaType(u))throw new(d("WAWebDownloadManagerErrors").MediaNotOnPhone)();f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});return}f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.FETCHING});S=c("WANullthrows")(S);var b=S,j=b.scansSidecar,k=b.scanLengths,l=b.directPath;b=b.staticUrl;if(S instanceof d("WAWebMediaEntry").EncryptedMediaEntry&&S.getEncfilehash()==null){var m;(m=S)==null||m.markWhetherOnServer(!1);throw new y()}l=(yield C({directPath:l,encFilehash:(m=S)==null?void 0:m.getEncfilehash(),objFilehash:Q,isFinalRmrRetry:I,mediaKey:(l=S)==null?void 0:l.getMediaKey(),mediaKeyTimestamp:(m=S)==null?void 0:m.getMediaKeyTimestamp(),signal:a,staticUrl:b,mediaType:u,mediaObject:f,downloadOrigin:B,mode:G,scanLengths:k,mimetype:e,scansSidecar:j,isViewOnce:J,chatWid:K,shouldSequenceDownload:L}));P(u)?D=(yield d("WAWebMediaLoad").transcode(l)):D=l}D.type===d("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType&&(d("WAWebInMemoryLottieStickerCache").InMemoryLottieStickerCache.has(Q)||(yield d("WAWebInMemoryLottieStickerCache").extractAndSetLottieJSONInMemoryCache(Q,D)),f.consolidate({isLottie:!0}));if(D.type==="text/vcard"&&F===!0)try{m=(yield d("WAWebFileUtils").blobToText(D));if(m){b=d("WAWebVcardParsingUtils").parseMultiVcard(m);b.length>0?f.consolidate({parsedVcards:b}):d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).tags("non-sad").sendLogs("vcard_over_mms:Failed to parse vcard over mms contents")}}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to retrieve blob text contents ",""])),String(a)).tags("non-sad").sendLogs("vcard_over_mms:blobToText failed with error: "+String(a))}if(!d("WAWebMediaDataUtils").shouldUseMediaCache(u)){k=(yield c("WAWebMediaOpaqueData").createFromData(D,D.type));yield d("WAWebMediaDataUtils").gatherAndSetMetadata(f,k)}else{j=O(f,u);(j!=null&&j.shouldStoreInMemory||N)&&(d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(Q,D),yield d("WAWebMediaDataUtils").gatherAndSetMetadataNoOpaque(f,D))}f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.RESOLVED});f.clearDownloadPromise(u);return f.resolveWhenConsolidated()});return function(){return j.apply(this,arguments)}}();U=U()["catch"]((U=d("WAFilteredCatch")).filteredCatch(d("WAWebMmsClientErrors").MediaNotFoundError,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!S)throw a;S.markWhetherOnServer(!1);if(!g)throw a;yield d("WAWebDownloadManager").downloadManager.rmr({mediaObject:f,signal:new AbortController().signal,rmrReason:w,rmrData:z});f.clearDownloadPromise(u);return E({mimetype:e,mediaObject:f,downloadEvenIfExpensive:!1,mediaType:u,rmrReason:w,rmrData:z,downloadOrigin:B,isFinalRmrRetry:!0,isVcardOverMmsDocument:F,mode:G,isAutoDownload:H,chatWid:K})});return function(b){return a.apply(this,arguments)}}()))["catch"](U.filteredCatch(d("WAWebMiscErrors").MediaUnsupportedError,function(a){f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.ERROR_UNSUPPORTED});d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: media unsupported error: ",", ",", ",""])),a.name,a.message,e||"");d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),a.message).tags("non-sad").sendLogs("downloadMedia: media unsupported error:");if(M)throw a}))["catch"](U.filteredCatch(d("WAWebDownloadManagerErrors").MediaNotOnPhone,function(a){f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.ERROR_MISSING});if(M)throw a}))["catch"](U.filteredCatch([x,y],function(a){f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.ERROR_MISSING});if(a===x&&u===d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)return;d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unexpected download error: ",""])),a.name).devConsole(a.message,a.stack);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).tags("non-sad").sendLogs("unexpected download error: "+a.name);if(M)throw a}))["catch"](U.filteredCatch([d("WAWebMiscErrors").MediaDecryptionError,d("WAWebMiscErrors").MediaHashMismatch],function(a){var b=f.progressiveStage;T.abort();f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE,progressiveStage:null});f.notifyMsgsAsync();f["delete"]();d("WAWebCryptoImageStreamer").deleteFromInMemoryMediaBlobCache(Q,b);if(M)throw a}))["catch"](function(a){f.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});if(a instanceof d("WAWebMiscErrors").MediaLoadError){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: media unsupported error: ",", ",", ",""])),a.name,a.message,e||"");d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),a.message).tags("non-sad").sendLogs("downloadMedia: media load error:",{sampling:0});if(M)throw a;return}if(a instanceof d("WAWebMiscErrors").TranscodeBlobTooLargeError){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error: ",", ",""])),a.message,e||"");d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),a.message).tags("non-sad").sendLogs("downloadMedia: transcode blob too large",{sampling:0});if(M)throw a;return}if(a instanceof d("WAWebMiscErrors").UnableToPlayVideoError){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error: ",", ",""])),a.message,e||"");d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),a.message).tags("non-sad").sendLogs("downloadMedia: unable to play video",{sampling:0});if(M)throw a;return}if(a.name===d("WAAbortError").ABORT_ERROR){if(M)throw a;return}d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: error"]))).devConsole(a.name,a.message,a.stack);if(M)throw a})["finally"](function(){f.clearDownloadPromise(u)});A.set(U,{abort:function(){T.abort()},shouldStoreInMemory:((v=O(f,u))==null?void 0:v.shouldStoreInMemory)||N});f.setDownloadPromise(U,u);return U})});return F.apply(this,arguments)}var G=function(a){var b=/animation\/animation.json$/,c=Object.keys(a).find(function(a){return b.test(a)});return c!=null?a[c]:void 0};function f(a,b){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var e=new(d("WAWebStickerLatencyWamEvent").StickerLatencyWamEvent)({size:a.size,stickerLatencyAction:d("WAWebWamEnumStickerLatencyAction").STICKER_LATENCY_ACTION.DECOMPRESSION}),f=self.performance.now();a=(yield d("WABlobToArrayBuffer").blobToArrayBuffer(a));a=new Uint8Array(a);a=d("fflate").unzipSync(a);a=G(a);if(!a)throw c("err")("animationContents missing");if(a){a=new TextDecoder("utf-8").decode(a);e.stickerLatencyTtAction=Math.ceil(self.performance.now()-f);d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&e.commit();return a}}catch(a){d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&new(d("WAWebStickerErrorWamEvent").StickerErrorWamEvent)({stickerErrorType:d("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE.DECOMPRESSION}).commit(),d("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to extract Lottie Sticker for trimmed-filehash: "," "])),b.slice(0,10)),d("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Failed to extract Lottie Sticker zip file ",""])),String(a)).tags("non-sad").sendLogs("lottie_sticker:Failed to extract Lottie Sticker zip file")}});return H.apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.mimetype;var b=a.mediaObject;a=a.mediaType;var e=b.filehash;if(c("isStringNullOrEmpty")(e))return;if(b.downloadStage!==d("WAWebMediaTypes").DownloadStage.INIT)return;if(yield M(b))return;e=d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(e);var f=new AbortController();if(e){b.downloadStage===d("WAWebMediaTypes").DownloadStage.INIT&&b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.EXISTS});return}e=b.entries.getDownloadEntry(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a));if(!e){b.downloadStage===d("WAWebMediaTypes").DownloadStage.INIT&&b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});return}if(e instanceof d("WAWebMediaEntry").UnencryptedMediaEntry)return;var g=e.getEncfilehash();if(c("isStringNullOrEmpty")(g)){e.markWhetherOnServer(!1);b.downloadStage===d("WAWebMediaTypes").DownloadStage.INIT&&b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});return}try{c("isStringNullOrEmpty")(e.staticUrl)&&(yield d("WAWebDownloadManager").downloadManager.checkExistence({directPath:e.directPath,encFilehash:g,signal:f.signal,type:a})),b.downloadStage===d("WAWebMediaTypes").DownloadStage.INIT&&b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.EXISTS})}catch(a){b.downloadStage===d("WAWebMediaTypes").DownloadStage.INIT&&b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE}),d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["checkExistence: error"]))).devConsole(a.name,a.message,a.stack)}});return J.apply(this,arguments)}function K(a,b){return!!(a&&b&&a.length>=2&&a.length*10===b.byteLength)}function L(a){var b=a.scanLengths,e=a.scansSidecar,f=a.mimetype,g=a.mediaObject,h=a.signal;if(!K(b,e))return null;var i=new(d("WAWebWebcProgressiveImageWamEvent").WebcProgressiveImageWamEvent)({webcFirstRenderScans:0});return{mimetype:f,scansSidecar:c("WANullthrows")(e),scanLengths:c("WANullthrows")(b),onProgressiveUpdate:function(a){if(h.aborted)return;if(g.downloadStage===d("WAWebMediaTypes").DownloadStage.RESOLVED)return;g.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.PROGRESSIVE_READY,progressiveStage:a});i.webcFirstRenderScans||(i.webcFirstRenderScans=a,i.markWebcFirstRenderT());a>=z.MID&&!i.webcMidQualityT&&i.markWebcMidQualityT();a===z.FULL&&!i.webcFullQualityT&&(i.markWebcFullQualityT(),i.commit())}}}function M(a){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.mediaBlob)return!1;var b=(yield a.mediaBlob.validate());if(b){a.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.RESOLVED});return!0}a.clearBlob();a.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.NEED_POKE});a.notifyMsgsAsync();return!1});return N.apply(this,arguments)}function O(a,b){a=a.getDownloadPromise(b);return a?A.get(a):null}function P(a){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO}g.NoEntryAfterRMR=x;g.MissingEncFilehash=y;g.cancelDownloadMedia=a;g.manuallySetMedia=e;g.downloadMedia=E;g.getContentsOfLottieJSONFile=G;g.extractLottieJSON=f;g.checkExistence=I}),98);
__d("WAWebHDMediaUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(a,b){a=Math.max(a,b);return a>=d("WAWebABProps").getABPropConfigValue("original_quality_image_min_edge")}function b(a,b){if(!d("WAWebABProps").getABPropConfigValue("hd_video_label_enabled"))return!1;a=[Math.max(a,b),Math.min(a,b)];b=a[0];a=a[1];return a>=d("WAWebABProps").getABPropConfigValue("hd_video_definition_min_edge")?!0:b>d("WAWebABProps").getABPropConfigValue("hd_video_definition_max_edge")&&a>=d("WAWebABProps").getABPropConfigValue("hd_video_definition_min_edge_with_max_edge")}g.isHdPhoto=a;g.isHdVideo=b}),98);
__d("WAWebWamEnumDownloadOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT_PERSONAL:1,CHAT_GROUP:2,STATUS_USER:3,STATUS_ADS:4,PRODUCT_CATALOG:5,GDPR:6,STICKER_PICKER:7,PROFILE_PICTURE:8,BLOKS:9,P2B:10,MESSAGE_HISTORY_SYNC:11,COMMUNITY:12,CHANNEL:13,BROADCAST:14,INTEROP:15,WAMO_STATUS:16,WAMO_BIZ_PROFILE:17,WAMO_PREFERENCES:18,RICH_ORDER_STATUS:19});f.DOWNLOAD_ORIGIN_TYPE=a}),66);
__d("WAWebMediaGetDownloadOriginFromUploadOrigin",["WAWebWamEnumDownloadOriginType","WAWebWamEnumUploadOriginType"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHAT_PERSONAL:return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL;case d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.CHANNEL:return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL;case d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.COMMUNITY:return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY;default:return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP}}g.getDownloadOriginFromUploadOrigin=a}),98);
__d("WAWebMediaMmsV4Upload",["Promise","WAAbortError","WAFilteredCatch","WALogger","WAMediaCalculateFilehash","WAWebCreateMediaUploadMetrics","WAWebDownloadManagerErrors","WAWebEnvironment","WAWebFileUtils","WAWebHDMediaUtils","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaGatingUtils","WAWebMediaGetDownloadOriginFromUploadOrigin","WAWebMediaInMemoryBlobCache","WAWebMediaLoad","WAWebMediaMmsV4Download","WAWebMediaStore","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsClientErrors","WAWebMmsConst","WAWebMmsMediaTypes","WAWebUploadManager","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=new WeakMap();function a(a){a.getUploadPromises().forEach(function(a){if(a==null)return;var b=n.get(a);if(b==null)return;n["delete"](a);b()})}var o={SUCCESS:"success",CANCELLATION:"cancellation",ERROR:"error",TIMEOUT:"timeout"};function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.blob,e=a.canEnableFastForward;e=e===void 0?!0:e;var f=a.forwardedFromWeb,g=a.mediaKeyInfo,h=a.mediaObject,i=a.mediaType,j=a.signal,k=a.uploadEntry,l=a.uploadOrigin,m=a.isViewOnce;a=a.earlyUpload;if(k instanceof d("WAWebMediaEntry").EncryptedMediaEntry&&k!=null&&k.canReuseMediaKey()&&e){c("WAWebCreateMediaUploadMetrics")(i,l,0,f,m).handleCheckExistingSuccess();return k}e=(yield a);if(e!=null)return h.entries.addEntry({deprecatedMms3Url:e.url,mediaKey:e.mediaKey,mediaKeyTimestamp:e.mediaKeyTimestamp,encFilehash:e.encFilehash,type:i,sidecar:e.sidecar,directPath:e.directPath,firstFrameSidecar:e.firstFrameSidecar,debugHint:"upload"});a=function(){h.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.FINALIZING})};e=c("lodash").throttle(function(a,b){a=a.loaded+b;Number.isFinite(a)&&h.consolidate({loadedSize:a})},d("WAWebMmsConst").FILE_PROGRESS_THROTTLE_WAIT_MS);var n=g?g.key:k==null?void 0:k.getMediaKey();g=g?g.timestamp:k==null?void 0:k.getMediaKeyTimestamp();n=(yield c("WAWebUploadManager").encryptAndUpload({blob:b,mediaKey:n,mediaKeyTimestamp:g,type:i,signal:j,userUploadAttemptCount:h.userUploadAttemptCount,forwardedFromWeb:f,uploadOrigin:l,onProgress:e,onFinalize:a,isViewOnce:m,isHdPhoto:i===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&d("WAWebHDMediaUtils").isHdPhoto((k=h.contentInfo.fullHeight)!=null?k:0,(b=h.contentInfo.fullWidth)!=null?b:0)}));g=n.directPath;j=n.encFilehash;f=n.mediaKey;l=n.mediaKeyTimestamp;e=n.url;a=n.sidecar;m=n.firstFrameSidecar;return h.entries.addEntry({deprecatedMms3Url:e,mediaKey:f,mediaKeyTimestamp:l,encFilehash:j,type:i,sidecar:a,directPath:g,firstFrameSidecar:m,debugHint:"upload"})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.blob,e=a.mediaObject,f=a.mediaType,g=a.signal,h=a.uploadOrigin,i=a.isViewOnce;a=a.calculateToken;b=(yield d("WAWebFileUtils").blobToArrayBuffer(b));var j=(yield d("WAMediaCalculateFilehash").calculateFilehash(b));b=(yield c("WAWebUploadManager").unencryptedUpload({file:b,isViewOnce:i,signal:g,type:f,uploadOrigin:h,hash:j,token:yield a==null?void 0:a(j),generateThumbnailOnServer:d("WAWebMediaGatingUtils").isThumbnailGenerationOnServerEnabledForMediaType(f)}));return e.entries.addUnencryptedEntry({directPath:b.directPath,debugHint:"upload",filehash:j,type:f,handle:b.handle,metadataUrl:b.metadataUrl,thumbnailDirectPath:b.thumbnailDirectPath,thumbnailSha256:b.thumbnailSha256,fbid:b.fbid})});return s.apply(this,arguments)}function e(a){return t(a,p)}function f(a){return t(a,r)}function t(a,e){var f=a.mimetype,g=a.canEnableFastForward,p=g===void 0?!0:g,q=a.mediaObject,r=a.mediaType,s=a.forwardedFromWeb,t=a.uploadOrigin;g=a.mediaKeyInfo;var v=a.isViewOnce,w=a.earlyUpload,x=a.calculateToken,y=g;a=q.getUploadPromise(r);if(a)return a;var z=new AbortController(),A=z.signal;g=(m||(m=b("Promise"))).resolve().then(function(){q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.UPLOADING})}).then(function(){return u({mediaObject:q,mimetype:f,mediaType:r,abortSignal:A,uploadOrigin:t})}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;p&&(b=q.entries.getUploadEntry(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(r)));if(b instanceof d("WAWebMediaEntry").EncryptedMediaEntry&&y&&b.mediaKey!==y.key){var f=y;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same, mediaType: ",""])),r).sendLogs("media-keys-not-the-same-"+r);var g=!q.entries.entries.some(function(a){return a.getMediaKey()===f.key});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[_uploadMediaAndManageErrors]: isNewEntry: "," uploadEntry.mediaKey length "," - mediaKeyInfo.mediaKey length ",""])),g,(g=b.mediaKey)==null?void 0:g.length,(g=f.key)==null?void 0:g.length);if(r===d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER)y=null;else throw c("err")("uploadEntry.mediaKey and mediaKeyInfo.mediaKey should be the same")}g=(yield e({blob:a,canEnableFastForward:p,forwardedFromWeb:s,mediaKeyInfo:y,mediaObject:q,mediaType:r,signal:A,uploadEntry:b,uploadOrigin:t,isViewOnce:v,earlyUpload:w,calculateToken:x}));if(!g)throw c("err")("could not create media entry");if((r===d("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||r===d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO)&&!d("WAWebMediaDataUtils").canPlayOgg())if(d("WAWebMediaDataUtils").shouldUseMediaCache(r)){var j=q.filehash;if(j&&q.mediaBlob){var k=(yield d("WAWebMediaLoad").transcode(q.mediaBlob.formData()));d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(j,k)}}else q.mediaBlob&&(yield d("WAWebMediaDataUtils").gatherAndSetMetadata(q,q.mediaBlob));j=q.filehash;if(c("WAWebEnvironment").isWindows&&j!=null){k=(yield d("WAWebFileUtils").blobToArrayBuffer(a));yield d("WAWebMediaStore").LruMediaStore.put(j,k)}return g});return function(b){return a.apply(this,arguments)}}()).then(function(a){var b;if(A.aborted)throw new(d("WAAbortError").AbortError)();q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.UPLOADED});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: success"]))).devConsole((b=a.getEncfilehash())!=null?b:a.getFilehash());return{kind:o.SUCCESS,mediaEntry:a}})["catch"](function(a){a.name===d("WAAbortError").ABORT_ERROR?d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: canceled"]))).devConsole(a):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["MediaAlgo.uploadMedia: ",""])),a).devConsole(a);throw a})["finally"](function(){q.clearUploadPromise(r)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").FileNotReadableError,function(){q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.ERROR_FILE_NOT_READABLE});return{kind:o.ERROR}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebDownloadManagerErrors").MediaNotOnPhone,function(){q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.ERROR_MISSING});return{kind:o.ERROR}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMmsClientErrors").MediaTooLargeError,function(){q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE});return{kind:o.ERROR}}))["catch"](function(a){q.consolidate({uploadStage:d("WAWebMediaTypes").UploadStage.NEED_UPLOAD});return a.name===d("WAAbortError").ABORT_ERROR?{kind:o.CANCELLATION}:{kind:o.ERROR}});n.set(g,function(){z.abort()});q.setUploadPromise(g,r);return g}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mediaObject,e=a.mimetype,f=a.mediaType,g=a.abortSignal,h=a.uploadOrigin;a=a.chatWid;var i=w(b);if(i)return i;yield d("WAWebMediaMmsV4Download").downloadMedia({mimetype:e,mediaObject:b,downloadEvenIfExpensive:!0,mediaType:f,signal:g,rmrReason:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.UPLOAD,downloadOrigin:d("WAWebMediaGetDownloadOriginFromUploadOrigin").getDownloadOriginFromUploadOrigin(h),mode:"manual",chatWid:a});if(b.downloadStage===d("WAWebMediaTypes").DownloadStage.ERROR_MISSING)throw new(d("WAWebDownloadManagerErrors").MediaNotOnPhone)();i=w(b);if(i)return i;throw c("err")("cant upload media w/out mediaBlob after download")});return v.apply(this,arguments)}function w(a){var b=a.mediaBlob;if(b)return b.formData();if(!a.filehash)return;return d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.get(a.filehash)}g.cancelUploadMedia=a;g.UploadMediaResultKind=o;g.uploadMedia=e;g.uploadUnencryptedMedia=f;g.getOrDownloadBlob=u;g.getBlobFromMediaObject=w}),98);
__d("WAWebMediaObject",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebAck","WAWebCryptoCreateMediaKeys","WAWebInteractiveMessageHeaderMediaType","WAWebMedia","WAWebMediaCryptoEligibilityUtils","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMmsMediaTypes","WAWebMsgType","WAWebRequestMediaReuploadBridge","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;e=function(){function a(){var a=this;this.msgs=[];this.$1=new(d("WAShiftTimer").ShiftTimer)(function(){u(a),D(a)});this.callOnConsolidate=null;this.$2=null;this.$3=0;this.saveMedia=null;this.stickers=[];this.stickerPacks=[];this.entries=new(d("WAWebMediaEntry").MediaEntryList)();this.downloadStage=d("WAWebMediaTypes").DownloadStage.INIT;this.uploadStage=d("WAWebMediaTypes").UploadStage.INIT;this.userUploadAttemptCount=0;this.userDownloadAttemptCount=0;this.$4=null;this.$5=null;this.$6=null;this.$7=null;this.mediaBlob=null;this.size=void 0;this.loadedSize=void 0;this.filehash=void 0;this.contentInfo={};this.progressiveStage=void 0;this.parsedVcards=null;this.extractedLottieSticker=null}var e=a.prototype;e.encryptedDownloadPromise_TESTONLY=function(){return this.$4};e.unencryptedDownloadPromise_TESTONLY=function(){return this.$5};e.consolidate=function(a){if(a.downloadStage){var b;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[","] mediaObject.downloadStage: ",""])),(b=this.filehash)==null?void 0:b.slice(0,10),String(a.downloadStage))}if(r(this,a)){this.notifyMsgsAsync();return!0}return!1};e.clearBlob=function(a){var b=this.mediaBlob;b&&(this.mediaBlob=null,b.autorelease());(a==null?void 0:a.reset)===!0&&this.$8()};e.$8=function(){this.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.INIT})};e.contentFields=function(){var a=this.type||d("WAWebMediaTypes").TYPE.DOCUMENT;return d("WAWebMediaTypes").FIELDS[a]};e.resolveWhenConsolidated=function(){var a=this;return this.$1.ts?new(q||(q=b("Promise")))(function(b){a.callOnConsolidate?a.callOnConsolidate.push(b):a.callOnConsolidate=[b]}):(q||(q=b("Promise"))).resolve()};e.notifyMsgsAsync=function(){this.$1.debounce(0)};e.addMsg=function(a){var b=this.msgs;for(var c=0;c<b.length;c++){var e=b[c],f=e[0];e=e[1];f===a&&!e&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-media-msg")}b.push([a,!1]);this.notifyMsgsAsync()};e.removeMsg=function(a){var b=this.msgs,c=!1;for(var d=0;!c&&d<b.length;d++){var e=b[d],f=e[0];e=e[1];f===a&&!e&&(b[d][1]=!0,c=!0)}};e.hasAssociatedMsgsOrStickers=function(){var a=this.msgs;for(var b=0;b<a.length;b++)if(!a[b][1])return!0;return this.hasAssociatedStickers()||this.hasAssociatedStickerPacks()};e.associatedMsgs=function(){var a=this.msgs,b=[];for(var c=0;c<a.length;c++){var d=a[c],e=d[0];d=d[1];d||b.push(e)}return b};e.rmr=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this.associatedStickers();if(e.length>0){e=this.associatedMsgs().filter(function(a){return a!=null});if(e.length===0){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["The sticker associated message has been deleted."])));return(q||(q=b("Promise"))).resolve(200)}}e=this.msgs.find(function(a){var b=a[0];a=a[1];return!a&&!b.isUnsentPhoneMsg()})||[null];e=e[0];if(!e){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: rmr called on MediaObject with no msg");return(q||(q=b("Promise"))).reject(c("err")("rmr called on MediaObject with no msg"))}a.onMsgSelect(e);a=(yield c("WAWebRequestMediaReuploadBridge")(e));if(a.status===200){var f=e.mediaData.type;if(f==="unknown")return(q||(q=b("Promise"))).reject(c("err")("rmr called on MediaData with unknown type"));e=a.isMD?this.entries.updateEntry({deprecatedMms3Url:e.deprecatedMms3Url,encFilehash:e.encFilehash,directPath:a.directPath}):this.entries.addEntry({deprecatedMms3Url:a.url,mediaKey:a.mediaKey||c("WANullthrows")(e.mediaKey),mediaKeyTimestamp:a.mediaKeyTimestamp,encFilehash:a.encFilehash,type:f,directPath:a.directPath,debugHint:"rmr"});e||d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: rmr entry can not be found");e==null||e.markWhetherOnServer(!0)}return a.status});function e(b){return a.apply(this,arguments)}return e}();e.msgProps=function(a){var b={};v(b,this,d("WAWebMediaTypes").FIELDS.RAW);v(b,this.contentInfo,this.contentFields());v(b,a,d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS);b.preview=this.contentInfo._preview;a={};for(var c in b){var e=d("WAWebMediaTypes").MEDIA_TO_MSG[c];e&&(a[e]=b[c])}return a};e["delete"]=function(){this.saveMedia=null,d("WAWebMedia").cancelDownloadMedia(this),d("WAWebMedia").cancelUploadMedia(this),this.clearBlob()};e.runProcessIfNotRunBefore=function(a,c,d){var e=this,f=this.$2;f||(f=this.$2={});if(Object.prototype.hasOwnProperty.call(f,a))return;this.$3++;f[a]=(q||(q=b("Promise"))).resolve(d).then(c).then(function(a){return void e.consolidate(a)})["finally"](function(){e.$3--,e.$3===0&&e.notifyMsgsAsync()})};e.getPendingProcess=function(a){return this.$3===0||!this.$2||!Object.prototype.hasOwnProperty.call(this.$2,a)?(q||(q=b("Promise"))).resolve():this.$2[a]};e.videoStreamingInfo=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(this.type!==d("WAWebMediaTypes").TYPE.VIDEO){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["type: ",""])),String(this.type)).sendLogs("media-fault: media streaming info request for non-video type");return}var e=this.entries.getDownloadEntry(!0);if(!e||!e.sidecar||!(e instanceof d("WAWebMediaEntry").EncryptedMediaEntry))return null;var f=(yield (q||(q=b("Promise"))).all([c("WAWebCryptoCreateMediaKeys")(d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,e.mediaKey),e.url()])),g=f[0];f=f[1];return{cryptoKeys:babelHelpers["extends"]({},g,{cipherKey:g.encKey,sidecar:e.sidecar}),streamData:{clientUrl:f,size:this.size,msgKey:a}}});function e(b){return a.apply(this,arguments)}return e}();e.addStickerPack=function(a){var b=this.stickerPacks;for(var c=0;c<b.length;c++){var e=b[c],f=e[0];e=e[1];f===a&&!e&&d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-sticker-pack-add")}b.push([a,!1]);this.notifyMsgsAsync()};e.addSticker=function(a){var b=this.stickers;for(var c=0;c<b.length;c++){var e=b[c],f=e[0];e=e[1];f===a&&!e&&d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("redundant-sticker-add")}b.push([a,!1]);this.notifyMsgsAsync()};e.removeSticker=function(a){var b=this.stickers,c=!1;for(var d=0;!c&&d<b.length;d++){var e=b[d],f=e[0];e=e[1];f===a&&!e&&(b[d][1]=!0,c=!0)}};e.removeStickerPack=function(a){var b=this.stickerPacks,c=!1;for(var d=0;!c&&d<b.length;d++){var e=b[d],f=e[0];e=e[1];f===a&&!e&&(b[d][1]=!0,c=!0)}};e.hasAssociatedStickers=function(){return this.stickers.some(function(a){a[0];a=a[1];return!a})};e.hasAssociatedStickerPacks=function(){return this.stickerPacks.some(function(a){a[0];a=a[1];return!a})};e.associatedStickers=function(){return this.stickers.reduce(function(a,b){var c=b[0];b=b[1];return b?a:a.concat(c)},[])};e.getUploadPromise=function(a){return d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a)?this.$6:this.$7};e.setUploadPromise=function(a,b){d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(b)?this.$6=a:this.$7=a};e.clearUploadPromise=function(a){d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a)?this.$6=null:this.$7=null};e.getUploadPromises=function(){return[this.$6,this.$7]};e.getDownloadPromise=function(a){return d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a)?this.$4:this.$5};e.setDownloadPromise=function(a,b){d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(b)?this.$4=a:this.$5=a};e.clearDownloadPromise=function(a){d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(a)?this.$4=null:this.$5=null};e.getDownloadPromises=function(){return[this.$4,this.$5]};e.toJSON=function(){return{mediaBlob:this.mediaBlob,size:this.size,filehash:this.filehash,type:this.type,contentInfo:this.contentInfo,downloadStage:this.downloadStage,uploadStage:this.uploadStage}};return a}();function r(a,b){var c=a.contentInfo,d=!1,e=s(b.type);e&&!a.type&&(a.type=e,d=!0);e=b.downloadStage;var f=b.uploadStage;e&&e!==a.downloadStage&&(a.downloadStage=e,d=!0);f&&f!==a.uploadStage&&(a.uploadStage=f,d=!0);b.resolvedPreview&&!c.preview&&(b.resolvedPreview.retain(),c.preview=b.resolvedPreview,d=!0);b.progressiveStage!==void 0&&b.progressiveStage!==a.progressiveStage&&(a.progressiveStage=b.progressiveStage,d=!0);e=b.mediaBlob;e&&!e.isBlobEqual(a.mediaBlob)&&(a.mediaBlob&&a.clearBlob(),e.retain(),a.mediaBlob=e,a.size=e.size(),d=!0);b.size!=null&&b.size!==0&&(a.size==null||b.size<a.size)&&(a.size=b.size,d=!0);f=b.loadedSize;f!=null&&f!==a.loadedSize&&(a.loadedSize=f,d=!0);b.filehash&&!a.filehash&&(a.filehash=b.filehash,d=!0);b.parsedVcards&&b.parsedVcards!==a.parsedVcards&&(a.parsedVcards=b.parsedVcards,d=!0);b.extractedLottieSticker!=null&&b.extractedLottieSticker!==a.extractedLottieSticker&&(a.extractedLottieSticker=b.extractedLottieSticker,d=!0);e=a.contentFields();for(f=0;f<e.length;f++){var g=e[f];switch(g){case"preview":b.preview&&!c._preview&&(a.runProcessIfNotRunBefore("preview",z,b.preview),c._preview=b.preview,d=!0);break;case"fullWidth":case"fullHeight":case"aspectRatio":var h=b[g];h!=null&&h!==0&&c[g]!==h&&(c[g]=h,d=!0);break;case"animationDuration":case"singleLoopDuration":h=b[g];h!=null&&h!==c[g]&&(c[g]=h,d=!0);break;default:h=b[g];h!==void 0&&c[g]===void 0&&(c[g]=h,d=!0)}}(c.aspectRatio==null||c.aspectRatio===0)&&(c.fullWidth!=null&&c.fullWidth!==0&&c.fullHeight!=null&&c.fullHeight!==0?(c.aspectRatio=c.fullWidth/c.fullHeight,d=!0):c.preview&&a.runProcessIfNotRunBefore("aspectRatio",B,c.preview));return d}function s(a){switch(a){case d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE:case d("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT:return d("WAWebMediaTypes").TYPE.IMAGE;case d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO:return d("WAWebMediaTypes").TYPE.VIDEO;case d("WAWebMediaTypes").OUTWARD_TYPES.PTV:return d("WAWebMediaTypes").TYPE.PTV;case d("WAWebMediaTypes").OUTWARD_TYPES.STICKER:return d("WAWebMediaTypes").TYPE.STICKER;case d("WAWebMediaTypes").OUTWARD_TYPES.AUDIO:case d("WAWebMediaTypes").OUTWARD_TYPES.PTT:return d("WAWebMediaTypes").TYPE.AUDIO;case d("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT:default:return void 0}}function a(a){switch(a){case"VIDEO":case"PTV":return 3;case"IMAGE":return 2;case"AUDIO":return 4;case"STICKER":return 16;case"DOCUMENT":return 8;case"PRODUCT":return 18;case"BIZ_COVER_PHOTO":throw c("err")("web media type is invalid: "+a);default:a;throw c("err")("web media type is invalid: "+a)}}function t(a){var b;if(((b=a.interactiveHeader)==null?void 0:b.mediaType)!=null)switch(a.interactiveHeader.mediaType){case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return d("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:return d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.PRODUCT:return d("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT}return void 0}function u(a){var b={};v(b,a,d("WAWebMediaTypes").FIELDS.RAW);v(b,a.contentInfo,a.contentFields());a.mediaBlob&&(b.renderableUrl=a.mediaBlob.url());var c=a.msgs,e=c.length;for(var f=0;f<e;f++){var g=c[f],h=g[0];g=g[1];if(h!=null&&!g){if(h.type!==d("WAWebMsgType").MSG_TYPE.CIPHERTEXT){b.mediaStage=w(h,a);for(g=0;g<d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;g++){var i=d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[g];i==="accessibilityLabel"&&b.accessibilityLabel!=null&&h.type===d("WAWebMsgType").MSG_TYPE.STICKER&&h.set("accessibilityLabel",b.accessibilityLabel);b[i]=h.get(d("WAWebMediaTypes").MEDIA_TO_MSG[i])}b.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&(b.type=t(h))}else{delete b.mediaStage;for(i=0;i<d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;i++)delete b[d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[i]]}h.mediaData.set(b)}}for(g=c.length-1;g>=0;g--)c[g][1]&&c.splice(g,1);i=a.callOnConsolidate;i&&(a.callOnConsolidate=null,i.forEach(function(a){return void a()}));a.saveMedia&&a.saveMedia(a)}function v(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];a[e]=b[e]}}function w(a,b){if(!b.filehash)return d("WAWebMediaTypes").MediaDataStage.PREPARING;else if(a.id.fromMe&&a.ack<d("WAWebAck").ACK.SENT){a.local||d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: unsent media system message not local");return y(b)}return x(b)}function x(a){switch(a.downloadStage){case d("WAWebMediaTypes").DownloadStage.INIT:return d("WAWebMediaTypes").MediaDataStage.INIT;case d("WAWebMediaTypes").DownloadStage.EXISTS:return d("WAWebMediaTypes").MediaDataStage.EXISTS;case d("WAWebMediaTypes").DownloadStage.PREPARING:return d("WAWebMediaTypes").MediaDataStage.PREPARING;case d("WAWebMediaTypes").DownloadStage.REUPLOADING:return d("WAWebMediaTypes").MediaDataStage.REUPLOADING;case d("WAWebMediaTypes").DownloadStage.FETCHING:return d("WAWebMediaTypes").MediaDataStage.FETCHING;case d("WAWebMediaTypes").DownloadStage.PROCESSING:return d("WAWebMediaTypes").MediaDataStage.DECRYPTING;case d("WAWebMediaTypes").DownloadStage.NEED_POKE:return d("WAWebMediaTypes").MediaDataStage.NEED_POKE;case d("WAWebMediaTypes").DownloadStage.ERROR_MISSING:return d("WAWebMediaTypes").MediaDataStage.ERROR_MISSING;case d("WAWebMediaTypes").DownloadStage.ERROR_UNSUPPORTED:return d("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED;case d("WAWebMediaTypes").DownloadStage.RESOLVED:return d("WAWebMediaTypes").MediaDataStage.RESOLVED;case d("WAWebMediaTypes").DownloadStage.PROGRESSIVE_READY:return d("WAWebMediaTypes").MediaDataStage.PROGRESSIVE_READY}}function y(a){switch(a.uploadStage){case d("WAWebMediaTypes").UploadStage.INIT:return d("WAWebMediaTypes").MediaDataStage.PREPARING;case d("WAWebMediaTypes").UploadStage.PREPARING:return d("WAWebMediaTypes").MediaDataStage.PREPARING;case d("WAWebMediaTypes").UploadStage.UPLOADING:return d("WAWebMediaTypes").MediaDataStage.UPLOADING;case d("WAWebMediaTypes").UploadStage.NEED_UPLOAD:return d("WAWebMediaTypes").MediaDataStage.NEED_UPLOAD;case d("WAWebMediaTypes").UploadStage.ERROR_MISSING:return d("WAWebMediaTypes").MediaDataStage.ERROR_MISSING;case d("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE:return d("WAWebMediaTypes").MediaDataStage.ERROR_TOO_LARGE;case d("WAWebMediaTypes").UploadStage.UPLOADED:return d("WAWebMediaTypes").MediaDataStage.SENDING;case d("WAWebMediaTypes").UploadStage.ERROR_FILE_NOT_READABLE:return d("WAWebMediaTypes").MediaDataStage.ERROR_FILE_NOT_READABLE;case d("WAWebMediaTypes").UploadStage.FINALIZING:return d("WAWebMediaTypes").MediaDataStage.FINALIZING}}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield c("WAWebMediaOpaqueData").createFromBase64Jpeg(a));a.autorelease();return{resolvedPreview:a}});return A.apply(this,arguments)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMediaDataUtils").getImageWidthHeight(a));var b=a.width;a=a.height;return{aspectRatio:b/a}});return C.apply(this,arguments)}function D(a){var b={};v(b,a,d("WAWebMediaTypes").FIELDS.RAW);v(b,a.contentInfo,a.contentFields());a.mediaBlob&&(b.renderableUrl=a.mediaBlob.url());var c=x(a);a.stickers=a.stickers.filter(function(a){a[0];a=a[1];return!a});a.stickers.forEach(function(a){var d=a[0];a[1];d.mediaData.set(babelHelpers["extends"]({},b,{mediaStage:c}))});a.stickerPacks=a.stickerPacks.filter(function(a){a[0];a=a[1];return!a});a.stickerPacks.forEach(function(a){var d=a[0];a[1];d.mediaData.set(babelHelpers["extends"]({},b,{mediaStage:c}))});a.callOnConsolidate&&(a.callOnConsolidate.forEach(function(a){return void a()}),a.callOnConsolidate=null);a.saveMedia&&a.saveMedia(a)}g.MediaObject=e;g.consolidate=r;g.webMediaTypeToWamMediaType=a;g.getInteractiveMsgMediaType=t}),98);
__d("WAWebAttachMenuGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("web_expression_panel_2")}function a(){return d("WAWebABProps").getABPropConfigValue("web_expression_panel_open")}function b(){return d("WAWebABProps").getABPropConfigValue("web_expression_panels_outside_input")}function c(){return h()&&d("WAWebABProps").getABPropConfigValue("wa_web_expression_panel_ui_v2")}g.areExpressionPanelsEnabledV2=h;g.areExpressionPanelsOpenEnabled=a;g.shouldShowExpressionPanelsOutOfInput=b;g.areExpressionPanelsUiV2Enabled=c}),98);
__d("WAWebEncodeRgbaToWebp",["Promise","WAWebMiscErrors","WAWebRgbaToWebpWorkerResource","WorkerBundleResource"],(function(a,b,c,d,e,f,g){var h;function a(a,e,f,g){g=g!=null?g:{};var i=g.quality,j=i===void 0?90:i;i=g.ensureExtendedFormat;var k=i===void 0?!1:i;return new(h||(h=b("Promise")))(function(b,g){var h=d("WorkerBundleResource").createDedicatedWebWorker(c("WAWebRgbaToWebpWorkerResource"));h.onerror=function(a){h.terminate(),g(new(d("WAWebMiscErrors").EncodeWebpError)("worker error",a))};h.onmessageerror=function(a){h.terminate(),g(new(d("WAWebMiscErrors").EncodeWebpError)("worker message error",a))};h.onmessage=function(a){h.terminate(),b(a.data.blob)};h.postMessage({type:"message",message:{rgbaData:a,width:e,height:f,quality:j,ensureExtendedFormat:k}})})}g["default"]=a}),98);
__d("WAWebImageGeometry",[],(function(a,b,c,d,e,f){function a(a,b){if(typeof a!=="number"||a<0||a!==a)return{width:b,height:b};else if(a>1)return{width:b,height:Math.max(b/a,1)};return{width:Math.max(b*a,1),height:b}}function b(a,b,c){b=b!=null?b:c;a=a!=null?a:c;b>a?b>c&&(a*=c/b,b=c):a>c&&(b*=c/a,a=c);return{width:Math.max(b,1),height:Math.max(a,1)}}f.aspectRatioScaled=a;f.boundHeightWidth=b}),66);
__d("WAWebCanvasUtils",["Promise","WAWebABProps","WAWebDataUrlToBlob","WAWebEncodeRgbaToWebp","WAWebImageGeometry","WAWebMediaOpaqueData","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.getContext("2d");b=b.getImageData(0,0,a.width,a.height);return c("WAWebEncodeRgbaToWebp")(b.data,a.width,a.height,{ensureExtendedFormat:!0})}function i(a,c){c===void 0&&(c="image/jpeg");if(Object.prototype.hasOwnProperty.call(HTMLCanvasElement.prototype,"toBlob")){var e=c==="image/jpeg"?d("WAWebABProps").getABPropConfigValue("web_jpeg_quality")/100:void 0;return new(h||(h=b("Promise")))(function(b){a.toBlob(b,c,e)})}return(h||(h=b("Promise"))).resolve(d("WAWebDataUrlToBlob").dataURLtoBlob(a.toDataURL(c)))}function e(a,b,c){b===void 0&&(b="image/jpeg");var e=a.toDataURL(b);e=d("WAWebDataUrlToBlob").dataURLtoBlob(e);if(e.size<=c)return a.toDataURL(b);for(e=.9;e>=.1;e-=.1){var f=a.toDataURL(b,e),g=d("WAWebDataUrlToBlob").dataURLtoBlob(f);if(g.size<=c)return f}return null}function f(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){var e;d=d||{};e=(e=d.mimetype)!=null?e:"image/jpeg";d=(d=d.maxAttempts)!=null?d:10;var f=.5,g=a,h=(yield i(g,e));for(var j=0;j<d;j++){if(h.size<=b)break;var k=Math.floor(a.width*f),l=Math.floor(a.height*f);g=q(k,l);var m=g.getContext("2d");m.drawImage(a,0,0,k,l);h=(yield i(g,e));f*=.5}return{opaqueData:yield c("WAWebMediaOpaqueData").createFromData(h,e),width:g.width,height:g.height,dataUrl:g.toDataURL("image/jpeg")}});return j.apply(this,arguments)}function k(a,b){var c=b.x||0,d=b.y||0;b.degrees&&(b.radians=b.degrees*(Math.PI/180));a.translate(c,d);b.radians!=null&&a.rotate(b.radians);a.translate(-c,-d)}function l(a,b,c){var d=a.getContext("2d"),e=d.getImageData(0,0,b,c);a.width=b;a.height=c;d.putImageData(e,0,0)}function m(a){var b=a.getContext("2d"),c=a.width,d=a.height,e=b.getImageData(0,0,c,d),f=Math.max(c,d);a.width=f;a.height=f;a=(f-c)/2;f=(f-d)/2;b.clearRect(0,0,c,d);b.putImageData(e,a,f,0,0,c,d)}function n(a,b){var c=a.getContext("2d"),e=r(a);b=d("WAWebImageGeometry").aspectRatioScaled(a.width/a.height,b);var f=b.width;b=b.height;a.width=f;a.height=b;c.drawImage(e,0,0,f,b)}function o(a){var b=a.getContext("2d");b.fillStyle="rgb(247,247,247)";b.fillRect(0,0,a.width,a.height)}function p(a,b){b=d("WAWebImageGeometry").boundHeightWidth(a.height,a.width,b);var c=b.width;b=b.height;if(c>a.width&&b>a.height)return a;var e=document.createElement("canvas"),f=e.getContext("2d");e.width=c;e.height=b;f.drawImage(a,0,0,c,b);return e}function q(a,b){var c=document.createElement("canvas");c.width=a;c.height=b;return c}function r(a){var b=q(a.width,a.height),c=b.getContext("2d");c.drawImage(a,0,0);return b}function s(a){var b=a.getContext("2d");b=b.getImageData(0,0,a.width,a.height);a=b.data.length/4;var c;for(c=0;c<a;c++){var d=b.data[4*c+3];if(d!==0)return!1}return!0}function t(a){var b=a.getContext("2d");b=b.getImageData(0,0,a.width,a.height);var c=b.data.length/4,d=Infinity,e=Infinity,f=0,g=0,h;for(h=0;h<c;h++){var i=b.data[4*h+3];if(i===0)continue;i=h%a.width;var j=Math.floor(h/a.width);i<d&&(d=i);i>f&&(f=i);j<e&&(e=j);j>g&&(g=j)}return{left:d,top:e,right:f,bottom:g}}function u(a){if(s(a))return;var b=t(a),c=b.left,d=b.top,e=b.right;b=b.bottom;b=b-d;e=e-c;a=a.getContext("2d");a=a.getImageData(c,d,e,b);c=q(e,b);d=c.getContext("2d");d.putImageData(a,0,0);return c}function v(a,b,c){c===void 0&&(c="white");var d=document.createElement("canvas"),e=d.getContext("2d"),f=document.createElement("canvas"),g=f.getContext("2d");b=b*2;d.width=f.width=a.width+b*2;d.height=f.height=a.height+b*2;e.drawImage(a,b,b);g.shadowColor=c;g.shadowBlur=1;for(c=0;c<b;c++)g.drawImage(d,0,0),e.drawImage(f,0,0);g.shadowColor="rgba(0,0,0,0)";g.drawImage(a,b,b);return f}g.canvasToWebp=a;g.canvasToBlob=i;g.getResizedDataUrl=e;g.generateMicroThumb=f;g.rotate=k;g.resize=l;g.square=m;g.scale=n;g.fillBackgroundWithGray=o;g.contain=p;g.createCanvas=q;g.trim=u;g.addBorder=v}),98);
__d("WAWebChatEphemerality",["WALogger","WAWebChatGetters","WAWebEphemeralityTypes","WAWebStateUtils","WAWebUserPrefsMultiDevice"],(function(a,b,c,d,e,f,g){var h;function i(a){var b;a=d("WAWebStateUtils").unproxy(a);b=d("WAWebChatGetters").getIsGroup(a)?(b=a.groupMetadata)==null?void 0:b.ephemeralDuration:a.ephemeralDuration;if(b==null||b===0)return null;if(b<0){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[ephemeral] invalid duration of "," for chat ",""])),b,a.id.toLogString());return null}return b}function a(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsGroup(a))return null;return a.ephemeralSettingTimestamp===0?null:a.ephemeralSettingTimestamp}function j(a){a=d("WAWebStateUtils").unproxy(a);a=i(a);return a!=null&&a!==0}function b(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()&&!d("WAWebChatGetters").getIsGroup(a))return!1;if(d("WAWebChatGetters").getIsPSA(a))return!1;if(a.id.isBot())return!1;if(d("WAWebChatGetters").getIsGroup(a)){var b;b=(b=a.groupMetadata)==null?void 0:b.participants.getSuperAdmin();if(b!=null&&b.contact.isEnterprise)return!1;if(!((b=a.groupMetadata)!=null&&b.canSetEphemeralSetting())&&!j(a))return!1}if(d("WAWebChatGetters").getIsBroadcast(a))return!1;return a.contact.isEnterprise?!1:!0}function c(a){a=d("WAWebStateUtils").unproxy(a);if(a.disappearingModeInitiator!=null)return a.disappearingModeInitiator;return j(a)?d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:null}function e(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsGroup(a))return k(a);if(a.disappearingModeTrigger!=null)return a.disappearingModeTrigger;return j(a)?d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:null}function f(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsGroup(a))return l(a);return a.disappearingModeInitiatedByMe!=null?a.disappearingModeInitiatedByMe:null}function k(a){a=d("WAWebStateUtils").unproxy(a);a=(a=a.groupMetadata)==null?void 0:a.disappearingModeTrigger;return a==null?null:a}function l(a){a=d("WAWebStateUtils").unproxy(a);a=(a=a.groupMetadata)==null?void 0:a.disappearingModeInitiatedByMe;return a==null?null:a}function m(a){var b;a=d("WAWebStateUtils").unproxy(a);return a.ephemeralDuration==null&&a.ephemeralSettingTimestamp==null&&a.disappearingModeInitiator==null?null:{duration:(b=a.ephemeralDuration)!=null?b:0,settingTimestamp:a.ephemeralSettingTimestamp,initiator:a.disappearingModeInitiator,disappearingModeTrigger:a.disappearingModeTrigger,initiatedByMe:a.disappearingModeInitiatedByMe}}g.getEphemeralSetting=i;g.getEphemeralSettingTimestamp=a;g.isEphemeralSettingOn=j;g.shouldShowEphemeralSetting=b;g.getDisappearingModeInitiator=c;g.getDisappearingModeTrigger=e;g.getDisappearingModeInitiatedByMe=f;g.getDisappearingModeTriggerGroups=k;g.getDisappearingModeInitiatedByMeGroups=l;g.getChatEphemeralityFields=m}),98);
__d("WAWebAddWebpMetadata",["WATypedArraysConcat","WAWebWebp","WAWebWebpMetadata","err"],(function(a,b,c,d,e,f,g){function a(a,b){a=new Uint8Array(a);if(!d("WAWebWebp").isExtendedFile(a))throw c("err")("Not extended");b=d("WAWebWebpMetadata").toRawWebpMetadata(b);b=i(b);a=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[a,b]);a.set(d("WAWebWebp").numberToLittleEndian(a.byteLength-8),4);b=a.buffer;return b}function h(a,b){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[d("WAWebWebp").stringToUint8(a),d("WAWebWebp").numberToLittleEndian(b)])}function i(a){var b=new TextEncoder();a=JSON.stringify(a);b=b.encode(a);a=j(b);a=[h(d("WAWebWebp").Chunk.EXIF,a.byteLength),a];b.byteLength%2!==0&&a.push(new Uint8Array([0]));b=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,a);return b}function j(a){var b;b=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[(b=d("WAWebWebp")).stringToUint8("II"),new Uint8Array([42,0]),b.numberToLittleEndian(8),new Uint8Array([1,0]),b.stringToUint8("AW"),new Uint8Array([7,0]),b.numberToLittleEndian(a.byteLength),b.numberToLittleEndian(22),a]);return b}g.addWebpMetadata=a}),98);
__d("WAWebMediaJpeg",["WABinary","WAProgressiveJpegMarkers","err"],(function(a,b,c,d,e,f,g){function h(a){var b=new(d("WABinary").Binary)();b.writeBytes(255,216,255,224,0,16,74,70,73,70,0);b.writeUint16(a.version);b.writeUint8(a.densityUnits);b.writeUint16(a.xDensity);b.writeUint16(a.yDensity);b.writeBytes(0,0);return b.readByteArrayView()}function a(a){var b=new(d("WABinary").Binary)(a);a=new(d("WABinary").Binary)(a);var e=new(d("WABinary").Binary)(),f=2,g=2,i=!1,j=!1,k=!1,l=!1,m={version:257,densityUnits:0,xDensity:1,yDensity:1};if(!(b.readUint8()===d("WAProgressiveJpegMarkers").MARKER_PREFIX&&b.readUint8()===d("WAProgressiveJpegMarkers").MARKERS.SOI))throw c("err")("SOI marker not at the start of the file.");a.advance(f);var n=void 0;while(n!=null||b.size()){if(n===void 0){var o=b.readUint8();if(o!==d("WAProgressiveJpegMarkers").MARKER_PREFIX)throw c("err")("0x"+o.toString(16)+" is not a marker prefix.");n=b.readUint8()}switch(n){case d("WAProgressiveJpegMarkers").MARKERS.APP0:if(j)o=b.readUint16(),a.advance(o+f),b.advance(b.size()-a.size());else{o=b.readUint16();if(b.readString(5)!=="JFIF\0")throw c("err")("APP0 marker missing 'JFIF' magic bytes.");l=!0;m.version=b.readUint16();m.densityUnits=b.readUint8();m.xDensity=b.readUint16();m.yDensity=b.readUint16();a.advance(o+f);b.advance(b.size()-a.size());j=!0}break;case d("WAProgressiveJpegMarkers").MARKERS.SOS:if(!k&&!l)throw c("err")("Missing magic bytes marker.");b.advance(b.readUint16()-g);var p,q=void 0,r=b.readUint8();while(b.size()){q=b.readUint8();p=r===d("WAProgressiveJpegMarkers").MARKER_PREFIX&&!d("WAProgressiveJpegMarkers").SOS_STREAM.includes(q);if(p){n=q;break}r=q}e.writeByteArray(a.readByteArrayView(a.size()-b.size()-f));continue;case d("WAProgressiveJpegMarkers").MARKERS.APP1:o=b.readUint16();if(!k&&b.readString(6)!=="Exif\0\0")throw c("err")("APP1 marker missing 'EXIF' magic bytes.");k=!0;a.advance(o+f);b.advance(b.size()-a.size());break;case d("WAProgressiveJpegMarkers").MARKERS.APP13:case d("WAProgressiveJpegMarkers").MARKERS.COM:if(!k&&!l)throw c("err")("Missing magic bytes marker.");o=b.readUint16();a.advance(o+f);b.advance(b.size()-a.size());break;case d("WAProgressiveJpegMarkers").MARKERS.EOI:if(!k&&!l)throw c("err")("Missing magic bytes marker.");i=!0;e.writeByteArray(a.readByteArrayView(f));break;case d("WAProgressiveJpegMarkers").MARKERS.SOF0:case d("WAProgressiveJpegMarkers").MARKERS.SOF1:case d("WAProgressiveJpegMarkers").MARKERS.SOF2:case d("WAProgressiveJpegMarkers").MARKERS.SOF3:case d("WAProgressiveJpegMarkers").MARKERS.SOF5:case d("WAProgressiveJpegMarkers").MARKERS.SOF6:case d("WAProgressiveJpegMarkers").MARKERS.SOF7:case d("WAProgressiveJpegMarkers").MARKERS.SOF9:case d("WAProgressiveJpegMarkers").MARKERS.SOF10:case d("WAProgressiveJpegMarkers").MARKERS.SOF11:case d("WAProgressiveJpegMarkers").MARKERS.SOF13:case d("WAProgressiveJpegMarkers").MARKERS.SOF14:case d("WAProgressiveJpegMarkers").MARKERS.SOF15:case d("WAProgressiveJpegMarkers").MARKERS.DQT:case d("WAProgressiveJpegMarkers").MARKERS.DHT:case d("WAProgressiveJpegMarkers").MARKERS.DRI:if(!k&&!l)throw c("err")("Missing magic bytes marker.");o=b.readUint16();e.writeByteArray(a.readByteArrayView(f+o));b.advance(b.size()-a.size());break;case d("WAProgressiveJpegMarkers").MARKERS.APP2:case d("WAProgressiveJpegMarkers").MARKERS.APP3:case d("WAProgressiveJpegMarkers").MARKERS.APP4:case d("WAProgressiveJpegMarkers").MARKERS.APP5:case d("WAProgressiveJpegMarkers").MARKERS.APP6:case d("WAProgressiveJpegMarkers").MARKERS.APP7:case d("WAProgressiveJpegMarkers").MARKERS.APP8:case d("WAProgressiveJpegMarkers").MARKERS.APP9:case d("WAProgressiveJpegMarkers").MARKERS.APP10:case d("WAProgressiveJpegMarkers").MARKERS.APP11:case d("WAProgressiveJpegMarkers").MARKERS.APP12:case d("WAProgressiveJpegMarkers").MARKERS.APP14:case d("WAProgressiveJpegMarkers").MARKERS.APP15:throw c("err")("Received unexpected APP marker 0x"+n.toString(16));default:throw c("err")("Did not understand marker: 0x"+n.toString(16))}n=void 0;if(i)break}if(!i)throw c("err")("No EOI tag found.");p=h(m);return new Blob([p,e.readByteArrayView()],{type:"image/jpeg"})}g.cleanJPEG=a}),98);
__d("WAWebStickerConstants",[],(function(a,b,c,d,e,f){a=512;b=8;c=36;d=156;e=20;var g=24*60*60;f.STICKER_DIMENSION=a;f.STICKER_BORDER_WIDTH=b;f.STICKER_PADDING=c;f.STICKER_LIST_ITEM_HEIGHT=d;f.STICKER_MAKER_IMAGE_PADDING=e;f.STICKER_PACK_FETCH_TIMEOUT=g}),66);
__d("WAWebImageUtils",["Promise","WACustomError","WAExponentialBackoff","WALogger","WAPromiseProps","WAWebAddWebpMetadata","WAWebCanvasUtils","WAWebFileUtils","WAWebImageGeometry","WAWebMediaJpeg","WAWebMediaLoad","WAWebMiscErrors","WAWebModernizr","WAWebNoop","WAWebStickerConstants","WAWebUA","WAWebWebpMetadata","asyncToGeneratorRuntime","err","exif-component"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p={DATA_URL:1<<0,BLOB:1<<1,CANVAS:1<<2},q=p.DATA_URL,r=p.BLOB,s=p.CANVAS,t=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("BlackVideoThumbnailError"));t.message="Generated video thumbnail is black";var u=function(a){var b=a.video,c=a.fullWidth,e=a.fullHeight;a=a.maxDimension;var f=document.createElement("canvas");a=d("WAWebImageGeometry").boundHeightWidth(e,c,a);var g=a.width;a=a.height;f.width=g;f.height=a;var h=f.getContext("2d");h.drawImage(b,0,0,g,a);b=h.getImageData(0,0,g,a);h=f.toDataURL("image/jpeg");f={url:h,width:g,height:a,fullWidth:c,fullHeight:e};return{thumb:f,imageData:b}};function a(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.file,f=a.maxDimensions,g=a.debugHint;a=a.throwOnBlack;var h=a===void 0?!1:a;a=(yield d("WAWebMediaLoad").loadVideo(e));var i=a.video,m=a.fullWidth,n=a.fullHeight;if(d("WAWebUA").UA.isBuggyVideoLoad){e=50;var p=5e3/e;return d("WAExponentialBackoff").exponentialBackoff({minTimeout:e,maxTimeout:e,retries:p,signal:new AbortController().signal,factor:1},function(a,e){var l=[],q;for(q of f){var r=u({video:i,fullHeight:n,fullWidth:m,maxDimension:q}),s=r.thumb;r=r.imageData;if(H(r)){if(e<p){e===0&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Setting video.currentTime to 0 to attempt to unblock the video"])));i.currentTime=0;return a(c("err")("retry"))}d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Failed to generate video thumbnail from ",""])),g).sendLogs("thumbnail-generation-failed-"+g,{sampling:.001});if(h)throw new t()}l.push(s)}r={duration:~~i.seekable.end(0),thumbs:l};d("WAWebMediaLoad").disposeVideo(i);return(o||(o=b("Promise"))).resolve(r)})}try{a=f.map(function(a){a=u({video:i,fullHeight:n,fullWidth:m,maxDimension:a});var b=a.thumb;a=a.imageData;if(H(a)){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["generateVideoThumbsAndDuration: Failed to generate video thumbnail from ",""])),g).sendLogs("thumbnail-generation-failed-"+g,{sampling:.001});if(h)throw new t()}return b});return{duration:~~i.seekable.end(0),thumbs:a}}finally{d("WAWebMediaLoad").disposeVideo(i)}});return v.apply(this,arguments)}function e(a,b,c,d,e,f,g,h){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h,i){i===void 0&&(i=q);a=a instanceof HTMLCanvasElement?a:yield d("WAWebMediaLoad").loadImage(a);var j=document.createElement("canvas"),k=j.getContext("2d");g==null||h==null?(j.height=f,j.width=e,k.drawImage(a,b,c,e,f)):(j.height=h,j.width=g,k.drawImage(a,b,c,e,f,0,0,g,h));k={};E(k,j,i);a=(yield d("WAPromiseProps").promiseProps(k));return{images:a,width:e,height:f}});return w.apply(this,arguments)}function f(a,e,f,g){g=g!=null?g:{};var j=g.transparency,k=j===void 0?!1:j;j=g.fitToSquare;var l=j===void 0?!1:j;j=g.minDimension;var m=j===void 0?0:j,n=new ArrayBuffer(0),p;a instanceof HTMLCanvasElement?(g=(o||(o=b("Promise"))).resolve(a),j=o.resolve(n)):(p=window.URL.createObjectURL(a),g=d("WAWebMediaLoad").loadImage(p),j=d("WAWebFileUtils").blobToArrayBuffer(a)["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ImageUtils::rotateAndResize error: ",""])),a).devConsole(a);return n}));return d("WAPromiseProps").promiseProps({buffer:j,image:g}).then(function(a){var b,g=a.buffer;a=a.image;var h={};try{h=c("exif-component")(g)}catch(a){}var j=0;if(!((b=d("WAWebModernizr").getModernizr())!=null&&b.exiforientation))switch(h.orientation||"UNKNOWN"){case"right-top":j=1;break;case"left-bottom":j=-1;break;case"bottom-right":j=2;break}var n=document.createElement("canvas");b=a.naturalWidth||a.width;h=a.naturalHeight||a.height;var o=Math.max(b,h),p=n.getContext("2d"),q={};if(j)switch(j){case 1:case-1:var s=Math.max(b,h),t=s/2;n.width=n.height=s;k||d("WAWebCanvasUtils").fillBackgroundWithGray(n);d("WAWebCanvasUtils").rotate(p,{x:t,y:t,degrees:j*90});j===1?p.drawImage(a,0,s-h):p.drawImage(a,s-b,0);d("WAWebCanvasUtils").rotate(p,{x:t,y:t,degrees:j*-90});d("WAWebCanvasUtils").resize(n,h,b);l&&d("WAWebCanvasUtils").square(n);o<m&&d("WAWebCanvasUtils").scale(n,m);var u=d("WAWebCanvasUtils").contain(n,e);E(q,u,f,k);return d("WAPromiseProps").promiseProps(q).then(function(a){return{width:u.width,height:u.height,images:a}});case 2:s=d("WAWebImageGeometry").boundHeightWidth(h,b,e);t=n.width=s.width;s=n.height=s.height;k||d("WAWebCanvasUtils").fillBackgroundWithGray(n);d("WAWebCanvasUtils").rotate(p,{x:t/2,y:s/2,degrees:j*90});p.drawImage(a,0,0,t,s);d("WAWebCanvasUtils").rotate(p,{x:t/2,y:s/2,degrees:j*-90});l&&d("WAWebCanvasUtils").square(n);o<m&&d("WAWebCanvasUtils").scale(n,m);E(q,n,f,k);return d("WAPromiseProps").promiseProps(q).then(function(a){return{width:n.width,height:n.height,images:a}})}else{t=d("WAWebImageGeometry").boundHeightWidth(h,b,e);var v,w;s=f&r;if(g&&s&&b===t.width&&h===t.height)try{j=d("WAWebMediaJpeg").cleanJPEG(g);q.blob=j;s=!1;v=b;w=h}catch(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Could not parse JPEG: ",""])),a.message)}(s||f&~r)&&(n.width=t.width,n.height=t.height,k||d("WAWebCanvasUtils").fillBackgroundWithGray(n),p.drawImage(a,0,0,n.width,n.height),l&&(d("WAWebCanvasUtils").square(n),q.blob=void 0),o<m&&(d("WAWebCanvasUtils").scale(n,m),q.blob=void 0),v=n.width,w=n.height,E(q,n,f,k));return d("WAPromiseProps").promiseProps(q).then(function(a){return{width:v,height:w,images:a}})}})["finally"](c("WAWebNoop"))}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=(yield a.arrayBuffer());c=d("WAWebAddWebpMetadata").addWebpMetadata(c,b);b=new Uint8Array(c);c=new Blob([b],{type:"image/webp"});return c}catch(b){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["addMetadataToSticker: Unable to add metadata to Sticker"]))).sendLogs("unable-to-add-sticker-metadata");return a}});return y.apply(this,arguments)}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=window.URL.createObjectURL(a);var b=(yield d("WAWebMediaLoad").loadImage(a));window.URL.revokeObjectURL(a);a=d("WAWebStickerConstants").STICKER_DIMENSION;var c=d("WAWebCanvasUtils").createCanvas(a,a),e=c.getContext("2d"),f=d("WAWebImageGeometry").aspectRatioScaled(b.width/b.height,a),g=f.width;f=f.height;var h=(a-g)/2;a=(a-f)/2;e.drawImage(b,h,a,g,f);e=(yield d("WAWebCanvasUtils").canvasToWebp(c));b=(yield x(e,{isFirstParty:!1,isFromStickerMaker:!0,emojis:[],stickerPackPublisher:"WhatsApp Sticker Maker",stickerMakerSourceType:d("WAWebWebpMetadata").StickerMakerSourceType.WebStickerMaker}));return b}catch(a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Webp sticker file generation failed: "]))).devConsole(a);throw a}});return A.apply(this,arguments)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=(yield d("WAWebMediaLoad").loadImage(a)),c=document.createElement("canvas");c.width=b.naturalWidth;c.height=b.naturalHeight;var e=c.getContext("2d");d("WAWebCanvasUtils").fillBackgroundWithGray(c);e.drawImage(b,0,0);return d("WAWebCanvasUtils").canvasToBlob(c)}catch(b){throw new(d("WAWebMiscErrors").MediaDragDropError)("unable to render image",a)}});return C.apply(this,arguments)}function D(a){if(!a)return!1;var b=new Image();b.src=a;return!!b.complete}function E(a,c,e,f){f===void 0&&(f=!1);f=f?"image/png":"image/jpeg";!a.blob&&e&r&&(a.blob=d("WAWebCanvasUtils").canvasToBlob(c,f));!a.dataUrl&&e&q&&(a.dataUrl=(o||(o=b("Promise"))).resolve(c.toDataURL(f)));!a.canvas&&e&s&&(a.canvas=(o||(o=b("Promise"))).resolve(c))}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMediaLoad").loadImage(a));var b=d("WAWebCanvasUtils").createCanvas(a.width,a.height),c=b.getContext("2d");c.drawImage(a,0,0);return b});return G.apply(this,arguments)}function H(a){var b=a.data,c=a.width,d=a.height;for(var e=0;e<d;e++){var f=Math.round(e*(c/d));f=e*c+f;f=f*4;var g=b[f];if(g!==0)return!1;g=b[f+1];if(g!==0)return!1;g=a.data[f+2];if(g!==0)return!1;g=a.data[f+3];if(g!==0&&g!==255)return!1}return!0}g.DATA_URL=q;g.BLOB=r;g.CANVAS=s;g.BlackVideoThumbnailError=t;g.generateVideoThumbsAndDuration=a;g.crop=e;g.rotateAndResize=f;g.toWebpSticker=z;g.urlToFile=B;g.isCached=D;g.base64ImageToCanvas=F}),98);
__d("WAWebMediaConstants",[],(function(a,b,c,d,e,f){"use strict";a=100;b=480;c=480;d=500;e=.4;var g=3e3,h=1300;f.IMG_THUMB_MAX_EDGE=a;f.DOC_THUMB_MAX_EDGE=b;f.VIDEO_THUMB_MAX_EDGE=c;f.MAX_PORTRAIT_MEDIA_CAPTION_LENGTH=d;f.MEDIA_EDITOR_OUTLINE_TENSION=e;f.MMS_THUMBNAIL_UPLOAD_TIMEOUT=g;f.MICRO_THUMBNAIL_MAX_FILE_SIZE_BYTES=h}),66);
__d("WAWebMediaGatingShouldClearUploadedBlobs",["WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT}g["default"]=a}),98);
__d("WAWebMediaInMemoryKeyCache",["WALruCache"],(function(a,b,c,d,e,f,g){b=10;c={sizeLimit:b,getSize:function(a){return 1}};function a(){return!0}e=new(d("WALruCache").LruCache)(c);g.shouldUseMediaKeyCache=a;g.MediaKeyCache=e}),98);
__d("WAWebMediaUpdateMsg",["WAWebDBUpdateMessageTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,b),a.set(b)});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebSendMsgResultAction",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["OK","ERROR_NETWORK","ERROR_EXPIRED","ERROR_CANCELLED","ERROR_UPLOAD","ERROR_UNKNOWN","ERROR_RATE_LIMIT"]);f.SendMsgResult=a}),66);
__d("WAWebMediaPrep",["invariant","Promise","WALogger","WAMediaCalculateFilehash","WANullthrows","WAPromiseCallSync","WATimeUtils","WAWebABProps","WAWebAck","WAWebAttachMenuGatingUtils","WAWebCanvasUtils","WAWebChatEphemerality","WAWebChatGetters","WAWebCryptoCalculateFilehash","WAWebCryptoRandomMediaKey","WAWebFrontendChatGetters","WAWebImageUtils","WAWebMediaConstants","WAWebMediaCryptoEligibilityUtils","WAWebMediaData","WAWebMediaDataUtils","WAWebMediaEntry","WAWebMediaGatingShouldClearUploadedBlobs","WAWebMediaGatingUtils","WAWebMediaGetUploadOriginForChat","WAWebMediaInMemoryBlobCache","WAWebMediaInMemoryKeyCache","WAWebMediaMmsV4Download","WAWebMediaMmsV4Upload","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebMediaUpdateMsg","WAWebMediaUploadMmsThumbnail","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessagingGatingUtils","WAWebMmsMediaTypes","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterSendMsgAction","WAWebRecentStickerCollectionMd","WAWebSchemaChat","WAWebSendMsgChatAction","WAWebSendMsgResultAction","WAWebSendStatusMsgAction","WAWebStateUtils","WAWebURLUtils","WAWebWamEnumDownloadOriginType","WAWebWamEnumMessageSendResultType","WAWebWamEnumUploadOriginType","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err","justknobx"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;a=function(){function a(a,b){var e=this;this.baseType=a;this.mediaData=new(c("WAWebMediaData"))({mediaStage:d("WAWebMediaTypes").MediaDataStage.PREPARING});this.$1=b.then(function(a){e.mediaData.set(a);if(!a.filehash){a.mediaBlob||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: no hash or blob");return d("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(a.mediaBlob).then(function(a){e.mediaData.filehash=a})}},function(a){e.mediaData.mediaStage=d("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED;throw a})}var e=a.prototype;e.sendToChat=function(a,b,c){return d("WAPromiseCallSync").promiseCallSync(S,null,this,a,b,c)};e.waitForPrep=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this.$1;return this.mediaData});function c(){return a.apply(this,arguments)}return c}();return a}();function F(a,b){if(b.type==="product")return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG;b=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsGroup(b))return d("WAWebFrontendChatGetters").getIsCAG(b)?d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP;return d("WAWebChatGetters").getIsNewsletter(b)?d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}function G(a){a=d("WAWebMmsMediaTypes").getMsgMediaType(a);return d("WAWebABProps").getABPropConfigValue("upload_document_thumb_mms_enabled")&&a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT}var H=[d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE];function I(a){a=d("WAWebMmsMediaTypes").getMsgMediaType(a);return H.includes(a)}function J(a){if(a.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT)return G(a);if(a.type===d("WAWebMsgType").MSG_TYPE.STICKER_PACK)return!0;return d("WAWebMsgGetters").getIsStatus(a)?I(a):!1}function K(a){switch(a.type){case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT;case d("WAWebMsgType").MSG_TYPE.IMAGE:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE;case d("WAWebMsgType").MSG_TYPE.VIDEO:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;case d("WAWebMsgType").MSG_TYPE.STICKER_PACK:return d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_STICKER_PACK;default:throw c("err")("_getMediaTypeForThumbnails: attempt to create thumbnail for unsupported media type")}}function L(a){var b=a.uploadThumbnailResult,e=a.mediaResultEntry,f=a.uploadEncryptedThumbnail,g=a.fullPreviewSize,h=a.mediaType;a=a.mediaObject;var i=b==null?void 0:b.mediaEntry;if(f===!0){if(i&&b&&g)return{thumbnailDirectPath:i.directPath,thumbnailSha256:b.filehash,thumbnailEncSha256:i.encFilehash,thumbnailHeight:g.height,thumbnailWidth:g.width};f={thumbnailResultEntry:i,uploadThumbnailResult:b,fullPreviewSize:g};d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["upload failed: thumbnail data incomplete\nDebug info:",""],["upload failed: thumbnail data incomplete\\nDebug info:",""])),JSON.stringify(f)).devConsole(f).sendLogs("mms-thumbnail-data-incomplete");throw c("err")("upload failed: thumbnail data incomplete")}i=a.contentInfo;b=i.fullHeight;g=i.fullWidth;if(e.getThumbnailDirectPath()!=null&&e.getThumbnailSha256()!=null&&g!=null&&b!=null&&d("WAWebMediaGatingUtils").isThumbnailGenerationOnServerEnabledForMediaType(h))return{thumbnailDirectPath:e.getThumbnailDirectPath(),thumbnailSha256:e.getThumbnailSha256(),thumbnailHeight:b,thumbnailWidth:g}}function M(a){(a=a.wamMessageSendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD,isTerminal:!0});return d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}var N=function(a,b,c,e){c.chatWid=b.id;c.downloadOrigin=F(b,e);c.isNewsletterMsg=d("WAWebChatGetters").getIsNewsletter(b);return O(a,c)};function O(a,b){return a.waitForPrep().then(function(a){var b=a.mediaBlob;return b&&!(b instanceof c("WAWebMediaOpaqueData"))?c("WAWebMediaOpaqueData").createFromData(b,b.type).then(function(b){a.mediaBlob=b;return a}):a}).then(function(a){var e=a.filehash;e||d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: sendToChat filehash undefined");var f=d("WAWebMediaStorage").getOrCreateMediaObject(e),g=f.mediaBlob;g&&(g.retain(),a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&a.mediaBlob.autorelease(),a.mediaBlob=g);a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&(a.renderableUrl=a.mediaBlob.url());f.consolidate(a.toJSON());a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&a.mediaBlob.autorelease();g=d("WAWebMediaDataUtils").shouldUseMediaCache(d("WAWebMmsMediaTypes").castToV4(f.type));if(g&&a.mediaBlob instanceof c("WAWebMediaOpaqueData")){g=a.mediaBlob.formData();d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(e,g)}d("WAWebMediaMmsV4Download").downloadMedia({mimetype:a.mimetype,mediaObject:f,downloadEvenIfExpensive:!0,mediaType:d("WAWebMmsMediaTypes").msgToMediaType({type:a.type,isGif:a.isGif,isNewsletter:b.isNewsletterMsg===!0}),rmrReason:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.SEND_TO_CHAT,downloadOrigin:(e=b.downloadOrigin)!=null?e:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL,mode:"manual",chatWid:b.chatWid});g=babelHelpers["extends"]({},f.msgProps(a));g.caption=b.caption;b.isViewOnce===!0&&(g.isViewOnce=!0);return g})}function P(a,b,e,f){return a.waitForPrep().then(function(a){var b=a.mediaBlob;return b&&!(b instanceof c("WAWebMediaOpaqueData"))?c("WAWebMediaOpaqueData").createFromData(b,b.type).then(function(b){a.mediaBlob=b;return a}):a}).then(function(a){var g=a.filehash;g||d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: sendToChat filehash undefined");var h=d("WAWebMediaStorage").getOrCreateMediaObject(g),i=h.mediaBlob;i&&(i.retain(),a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&a.mediaBlob.autorelease(),a.mediaBlob=i);a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&(a.renderableUrl=a.mediaBlob.url());h.consolidate(a.toJSON());a.mediaBlob instanceof c("WAWebMediaOpaqueData")&&a.mediaBlob.autorelease();i=d("WAWebMediaDataUtils").shouldUseMediaCache(d("WAWebMmsMediaTypes").castToV4(h.type));if(i&&a.mediaBlob instanceof c("WAWebMediaOpaqueData")){i=a.mediaBlob.formData();d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(g,i)}d("WAWebMediaMmsV4Download").downloadMedia({mimetype:a.mimetype,mediaObject:h,downloadEvenIfExpensive:!0,mediaType:d("WAWebMmsMediaTypes").msgToMediaType({type:a.type,isGif:a.isGif,isNewsletter:d("WAWebChatGetters").getIsNewsletter(b)}),rmrReason:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.SEND_TO_CHAT,downloadOrigin:F(b,f),mode:"manual",chatWid:b.id});g=babelHelpers["extends"]({},h.msgProps(a));g.caption=e.caption;e.isViewOnce===!0&&(g.isViewOnce=!0);return g})}function Q(a,b){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f,g=a.mediaObject;g||d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: incorrect media object for created msg");g||h(0,56330);var i=d("WAWebMmsMediaTypes").getMsgMediaType(a),j;f=(f=e.canEnableFastForward)!=null?f:!0;f===!0&&(j=g.entries.getUploadEntry(e.isMediaCryptoExpectedForChat===!0));f=j instanceof d("WAWebMediaEntry").EncryptedMediaEntry?{key:j.mediaKey,timestamp:j.mediaKeyTimestamp}:c("WAWebCryptoRandomMediaKey")();var k=g.contentInfo,l=k.fullPreviewData;k=k.fullPreviewSize;var n=a.safe(),o=J(n),p=!l&&o,q=!k&&o,r=o,s=a.body;if((p||q||r)&&g.contentInfo.preview){q=(yield d("WAWebImageUtils").base64ImageToCanvas(g.contentInfo.preview.url()));r=p?d("WAWebABProps").getABPropConfigValue("web_pdf_thumbnail_size_in_bytes"):d("WAWebMediaConstants").MICRO_THUMBNAIL_MAX_FILE_SIZE_BYTES;p=(yield d("WAWebCanvasUtils").generateMicroThumb(q,r,{mimetype:"image/jpeg",maxAttempts:10}));l=g.contentInfo.preview;k={width:p.width,height:p.height};s=c("WAWebURLUtils").parseDataURL(p.dataUrl).data}q=l&&k&&o;p=l&&q===!0?c("WAWebMediaUploadMmsThumbnail")({thumbnail:l,mediaKeyInfo:f,mediaType:c("WANullthrows")(K(n)),uploadOrigin:(r=e.uploadOriginForChat)!=null?r:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,forwardedFromWeb:Boolean(a.forwardedFromWeb),isViewOnce:Boolean(a.isViewOnce)}):(E||(E=b("Promise"))).resolve(null);l={mimetype:a.mimetype,canEnableFastForward:e.canEnableFastForward,mediaObject:g,mediaType:i,forwardedFromWeb:Boolean(a.forwardedFromWeb),uploadOrigin:(o=e.uploadOriginForChat)!=null?o:d("WAWebWamEnumUploadOriginType").UPLOAD_ORIGIN_TYPE.UNKNOWN,isViewOnce:Boolean(a.isViewOnce),earlyUpload:e.earlyUpload};n=e.isMediaCryptoExpectedForChat===!0?d("WAWebMediaMmsV4Upload").uploadMedia(babelHelpers["extends"]({},l,{mediaKeyInfo:f})):d("WAWebMediaMmsV4Upload").uploadUnencryptedMedia(babelHelpers["extends"]({},l,{calculateToken:d("WAMediaCalculateFilehash").getRandomFilehash}));r=g.filehash;d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&r!=null&&d("WAWebMediaInMemoryKeyCache").MediaKeyCache.put(r,f);o=(yield (E||(E=b("Promise"))).all([n,p]));a=o[0];e=o[1];c("WAWebMediaGatingShouldClearUploadedBlobs")(i)&&g.clearBlob({reset:!0});l=a.mediaEntry;if(!l)return{mediaResult:a,mmsThumbnailData:null,body:s,fbid:null};d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&r!=null&&d("WAWebMediaInMemoryKeyCache").MediaKeyCache["delete"](r);n=(f=L({uploadThumbnailResult:e,mediaResultEntry:l,uploadEncryptedThumbnail:q,mediaObject:g,fullPreviewSize:k,mediaType:i}))!=null?f:{};o=l instanceof d("WAWebMediaEntry").UnencryptedMediaEntry?(p=l.fbid)!=null?p:null:null;return{mediaResult:a,mmsThumbnailData:n,body:s,fbid:o}});return R.apply(this,arguments)}function S(a,b,c,d){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d,e){return c("justknobx")._("2620")?W(a,b,d,e):U(a,b,d,e)});return T.apply(this,arguments)}function U(a,b,c,d){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var i,j;d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat chat ",""])),e.id.toLogString());try{if(!e.id.isStatus()){var k=(yield d("WAWebSchemaChat").getChatTable().get(e.id.toString()));if(k==null){var l;d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," not found in DB. model account lid: ",""])),e.id.toLogString(),(l=e.accountLid)==null?void 0:l.toLogString()).sendLogs("send-media-chat-not-found").tags("missing-lid")}else d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," found in DB. has account lid: ",""])),e.id.toLogString(),k.accountLid!=null)}}catch(a){d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: failed to check if chat exists"])))}l=f.caption;k=f.footer;var m=f.quotedMsg?f.quotedMsg.msgContextInfo(e.id):{};i=(i=f.productMsgOptions)!=null?i:{};var w=d("WAWebChatEphemerality").isEphemeralSettingOn(e)?d("WAWebChatEphemerality").getEphemeralSetting(e):void 0,x=d("WAWebChatEphemerality").getEphemeralSettingTimestamp(e),y=d("WAWebChatEphemerality").getDisappearingModeInitiator(e),z,A=!1;e.isCAGAdmin()&&(A=!0);j=(j=f.type)!=null?j:a.baseType;d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(j)&&(A=!0);A&&(z=self.crypto.getRandomValues(new Uint8Array(32)));var B=babelHelpers["extends"]({},yield d("WAWebMsgDataUtils").genOutgoingMsgData(e,j),{type:j,caption:l,footer:k,quotedMsg:m.quotedMsg,quotedParticipant:m.quotedParticipant,quotedStanzaID:m.quotedStanzaID,quotedRemoteJid:m.quotedRemoteJid,mentionedJidList:f.mentionedJidList,groupMentions:f.groupMentions,isForwarded:f.isForwarded,forwardingScore:f.forwardingScore,forwardedNewsletterMessageInfo:f.forwardedNewsletterMessageInfo,multicast:f.multicast,forwardedFromWeb:f.forwardedFromWeb,ctwaContext:f.ctwaContext,ephemeralDuration:w,ephemeralSettingTimestamp:x,disappearingModeInitiator:y,messageSecret:z,isAvatar:f.isAvatar,viewMode:f.viewMode,parentMsgKey:f.parentMsgKey,associationType:f.associationType,isQuestion:f.isQuestion,questionReplyQuotedMessage:f.questionReplyQuotedMessage,botPersonaId:f.botPersonaId},i);if(f.type===d("WAWebMsgType").MSG_TYPE.STICKER_PACK){B.description=f.description;B.isCaptionByUser=Boolean(f.caption);B.thumbnailSha256=f.thumbnailSha256;B.stickers=f.stickers;B.stickerPackPublisher=f.publisher;B.size=(A=f.fileLength)!=null?A:0;B.stickerPackId=f.stickerPackId;B.thumbnailDirectPath=f.thumbnailDirectPath;B.thumbnailEncSha256=f.thumbnailEncSha256;B.trayIconFileName=f.trayIconFileName;B.stickerPackSize=f.stickerPackSize}f.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT&&Boolean(f.caption)&&(B.isCaptionByUser=!0);f.isWamoSub===!0&&(B.isWamoSub=!0);var C,D;function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var i;C=a;var j=a.mediaObject;j||d("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: incorrect media object for created msg");j||h(0,56330);var k=d("WAWebMmsMediaTypes").getMsgMediaType(a),l;i=(i=f.canEnableFastForward)!=null?i:!0;i===!0&&(l=j.entries.getUploadEntry(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForChat(e)));i=l instanceof d("WAWebMediaEntry").EncryptedMediaEntry?{key:l.mediaKey,timestamp:l.mediaKeyTimestamp}:c("WAWebCryptoRandomMediaKey")();var m=j.contentInfo,n=m.fullPreviewData;m=m.fullPreviewSize;var o=a.safe(),p=J(o),q=!n&&p,r=!m&&p,s=p,t=a.body;if((q||r||s)&&j.contentInfo.preview){r=(yield d("WAWebImageUtils").base64ImageToCanvas(j.contentInfo.preview.url()));s=q?d("WAWebABProps").getABPropConfigValue("web_pdf_thumbnail_size_in_bytes"):d("WAWebMediaConstants").MICRO_THUMBNAIL_MAX_FILE_SIZE_BYTES;q=(yield d("WAWebCanvasUtils").generateMicroThumb(r,s,{mimetype:"image/jpeg",maxAttempts:10}));n=j.contentInfo.preview;m={width:q.width,height:q.height};t=c("WAWebURLUtils").parseDataURL(q.dataUrl).data}r=n&&m&&p;s=n&&r===!0?c("WAWebMediaUploadMmsThumbnail")({thumbnail:n,mediaKeyInfo:i,mediaType:c("WANullthrows")(K(o)),uploadOrigin:c("WAWebMediaGetUploadOriginForChat")(e),forwardedFromWeb:Boolean(a.forwardedFromWeb),isViewOnce:Boolean(a.isViewOnce)}):(E||(E=b("Promise"))).resolve(null);q={mimetype:a.mimetype,canEnableFastForward:f.canEnableFastForward,mediaObject:j,mediaType:k,forwardedFromWeb:Boolean(a.forwardedFromWeb),uploadOrigin:c("WAWebMediaGetUploadOriginForChat")(e),isViewOnce:Boolean(a.isViewOnce),earlyUpload:g};p=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForChat(e)?d("WAWebMediaMmsV4Upload").uploadMedia(babelHelpers["extends"]({},q,{mediaKeyInfo:i})):d("WAWebMediaMmsV4Upload").uploadUnencryptedMedia(babelHelpers["extends"]({},q,{calculateToken:d("WAMediaCalculateFilehash").getRandomFilehash}));n=j.filehash;d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&n!=null&&d("WAWebMediaInMemoryKeyCache").MediaKeyCache.put(n,i);o=(yield (E||(E=b("Promise"))).all([p,s]));a=o[0];q=a.kind;i=a.mediaEntry;p=o[1];c("WAWebMediaGatingShouldClearUploadedBlobs")(k)&&j.clearBlob({reset:!0});D=q;if(!i)throw c("err")("upload failed: media entry was not created");d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&n!=null&&d("WAWebMediaInMemoryKeyCache").MediaKeyCache["delete"](n);a=(s=L({uploadThumbnailResult:p,mediaResultEntry:i,uploadEncryptedThumbnail:r,mediaObject:j,fullPreviewSize:m,mediaType:k}))!=null?s:{};yield c("WAWebMediaUpdateMsg")(C,babelHelpers["extends"]({deprecatedMms3Url:i.deprecatedMms3Url,directPath:i.directPath,mediaKey:i.getMediaKey(),mediaKeyTimestamp:i.getMediaKeyTimestamp(),filehash:j.filehash,encFilehash:i.getEncfilehash(),size:j.size,streamingSidecar:i.sidecar,firstFrameSidecar:i.firstFrameSidecar,body:t,stickerSentTs:d("WATimeUtils").unixTimeMs(),mediaHandle:i instanceof d("WAWebMediaEntry").UnencryptedMediaEntry?i.handle:null,metadataUrl:i instanceof d("WAWebMediaEntry").UnencryptedMediaEntry&&i.metadataUrl!=null&&d("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()?i.metadataUrl:null},a));return C});return G.apply(this,arguments)}if(f.addEvenWhilePreparing===!0){j=f.placeholderProps||{};l=babelHelpers["extends"]({},j,B);k=function(b){C=b;return P(a,e,f,B).then(function(a){return c("WAWebMediaUpdateMsg")(C,a)}).then(function(){return F(C)})};d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&d("WAWebChatGetters").getIsNewsletter(e)?m=d("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(e,l,k):e.id.isStatus()?(d("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(l,k),m=(E||(E=b("Promise"))).reject(c("err")("unsupported"))):m=d("WAWebSendMsgChatAction").addAndSendMsgToChat(e,l,k)[1]}else{w=P(a,e,f,B).then(function(a){var b=f.useBasePropsType===!0?B.type:a.type;return babelHelpers["extends"]({},B,a,{type:b})});d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&d("WAWebChatGetters").getIsNewsletter(e)?m=d("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(e,yield w,F):e.id.isStatus()?(d("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(yield w,F),m=(E||(E=b("Promise"))).reject(c("err")("unsupported"))):m=d("WAWebSendMsgChatAction").addAndSendMsgToChat(e,w,F)[1]}return m.then(function(a){return{result:a,error:null}})["catch"](function(a){return{result:null,error:a}}).then(function(a){var b,c=a.result;a=a.error;if((c==null?void 0:c.messageSendResult)===d("WAWebSendMsgResultAction").SendMsgResult.OK){C.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&C.isAvatar!==!0&&d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.addStickerWithMediaData(C);return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK}}C&&(C.ack=d("WAWebAck").ACK.FAILED);b=(b=C)==null||(b=b.mediaObject)==null?void 0:b.uploadStage;if(C&&d("WAWebMmsMediaTypes").getMsgMediaType(C)===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&d("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()){var e=b?b:"undefined";D===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR&&d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with expressions panel enabled"]))).tags("non-sad").sendLogs("sticker-send-fail-with-expressions-panel-enabled-uploadStage-"+e,{sampling:.01})}if(D===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.CANCELLATION){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat canceled"]))).devConsole({result:c,uploadStage:b,error:a});(e=C.wamMessageSendReporter)==null||e.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_CANCELLED,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_CANCELLED}}d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat error\nresult: ","\nuploadStage: ","\nuploadResultKind: ","\nerror: ",""],["Media:sendToChat error\\nresult: ","\\nuploadStage: ","\\nuploadResultKind: ","\\nerror: ",""])),c,b,D,String(a)).devConsole(a);if(b!=null)switch(b){case d("WAWebMediaTypes").UploadStage.NEED_UPLOAD:case d("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE:return{messageSendResult:M(C)};case d("WAWebMediaTypes").UploadStage.ERROR_MISSING:return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_EXPIRED};default:}if(D===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR)return{messageSendResult:M(C)};if(c!=null)return c;C&&d("WAWebMmsMediaTypes").getMsgMediaType(C)===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with unknown error"]))).sendLogs("sticker-send-fail-unknown-"+(d("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()?"expression-panels":"old-panels"));return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})});return V.apply(this,arguments)}function W(a,b,c,d){return X.apply(this,arguments)}function X(){X=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h,i;d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat chat ",""])),e.id.toLogString());try{if(!e.id.isStatus()){var j=(yield d("WAWebSchemaChat").getChatTable().get(e.id.toString()));if(j==null){var k;d("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," not found in DB. model account lid: ",""])),e.id.toLogString(),(k=e.accountLid)==null?void 0:k.toLogString()).sendLogs("send-media-chat-not-found").tags("missing-lid")}else d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: chat "," found in DB. has account lid: ",""])),e.id.toLogString(),j.accountLid!=null)}}catch(a){d("WALogger").ERROR(z||(z=babelHelpers.taggedTemplateLiteralLoose(["sendMediaMsgToChat: failed to check if chat exists"])))}k=f.caption;j=f.footer;var l=f.quotedMsg?f.quotedMsg.msgContextInfo(e.id):{};h=(h=f.productMsgOptions)!=null?h:{};var m=d("WAWebChatEphemerality").isEphemeralSettingOn(e)?d("WAWebChatEphemerality").getEphemeralSetting(e):void 0,n=d("WAWebChatEphemerality").getEphemeralSettingTimestamp(e),o=d("WAWebChatEphemerality").getDisappearingModeInitiator(e),p,q=!1;e.isCAGAdmin()&&(q=!0);i=(i=f.type)!=null?i:a.baseType;d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(i)&&(q=!0);q&&(p=self.crypto.getRandomValues(new Uint8Array(32)));var r=babelHelpers["extends"]({},yield d("WAWebMsgDataUtils").genOutgoingMsgData(e,i),{type:i,caption:k,footer:j,quotedMsg:l.quotedMsg,quotedParticipant:l.quotedParticipant,quotedStanzaID:l.quotedStanzaID,quotedRemoteJid:l.quotedRemoteJid,mentionedJidList:f.mentionedJidList,groupMentions:f.groupMentions,isForwarded:f.isForwarded,forwardingScore:f.forwardingScore,forwardedNewsletterMessageInfo:f.forwardedNewsletterMessageInfo,multicast:f.multicast,forwardedFromWeb:f.forwardedFromWeb,ctwaContext:f.ctwaContext,ephemeralDuration:m,ephemeralSettingTimestamp:n,disappearingModeInitiator:o,messageSecret:p,isAvatar:f.isAvatar,viewMode:f.viewMode,parentMsgKey:f.parentMsgKey,associationType:f.associationType,isQuestion:f.isQuestion,questionReplyQuotedMessage:f.questionReplyQuotedMessage},h);if(f.type===d("WAWebMsgType").MSG_TYPE.STICKER_PACK){r.description=f.description;r.isCaptionByUser=Boolean(f.caption);r.thumbnailSha256=f.thumbnailSha256;r.stickers=f.stickers;r.stickerPackPublisher=f.publisher;r.size=(q=f.fileLength)!=null?q:0;r.stickerPackId=f.stickerPackId;r.thumbnailDirectPath=f.thumbnailDirectPath;r.thumbnailEncSha256=f.thumbnailEncSha256;r.trayIconFileName=f.trayIconFileName;r.stickerPackSize=f.stickerPackSize}f.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT&&Boolean(f.caption)&&(r.isCaptionByUser=!0);f.isWamoSub===!0&&(r.isWamoSub=!0);var s,t;function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){s=a;var b=a.mediaObject;f.earlyUpload=g;f.isMediaCryptoExpectedForChat=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForChat(e);f.uploadOriginForChat=c("WAWebMediaGetUploadOriginForChat")(e);a=(yield Q(a,f));var h=a.mediaResult,i=h.kind;h=h.mediaEntry;var j=a.body;a=a.mmsThumbnailData;t=i;if(!h)throw c("err")("upload failed: media entry was not created");yield c("WAWebMediaUpdateMsg")(s,babelHelpers["extends"]({deprecatedMms3Url:h.deprecatedMms3Url,directPath:h.directPath,mediaKey:h.getMediaKey(),mediaKeyTimestamp:h.getMediaKeyTimestamp(),filehash:c("WANullthrows")(b).filehash,encFilehash:h.getEncfilehash(),size:c("WANullthrows")(b).size,streamingSidecar:h.sidecar,firstFrameSidecar:h.firstFrameSidecar,body:j,stickerSentTs:d("WATimeUtils").unixTimeMs(),mediaHandle:h instanceof d("WAWebMediaEntry").UnencryptedMediaEntry?h.handle:null,metadataUrl:h instanceof d("WAWebMediaEntry").UnencryptedMediaEntry&&h.metadataUrl!=null&&d("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()?h.metadataUrl:null},a));return s});return v.apply(this,arguments)}if(f.addEvenWhilePreparing===!0){i=f.placeholderProps||{};k=babelHelpers["extends"]({},i,r);j=function(b){s=b;return N(a,e,f,r).then(function(a){return c("WAWebMediaUpdateMsg")(s,a)}).then(function(){return u(s)})};d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&d("WAWebChatGetters").getIsNewsletter(e)?l=d("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(e,k,j):e.id.isStatus()?(d("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(k,j),l=(E||(E=b("Promise"))).reject(c("err")("unsupported"))):l=d("WAWebSendMsgChatAction").addAndSendMsgToChat(e,k,j)[1]}else{m=N(a,e,f,r).then(function(a){var b=f.useBasePropsType===!0?r.type:a.type;return babelHelpers["extends"]({},r,a,{type:b})});d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&d("WAWebChatGetters").getIsNewsletter(e)?l=d("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(e,yield m,u):e.id.isStatus()?(d("WAWebSendStatusMsgAction").sendStatusMediaMsgAction(yield m,u),l=(E||(E=b("Promise"))).reject(c("err")("unsupported"))):l=d("WAWebSendMsgChatAction").addAndSendMsgToChat(e,m,u)[1]}return l.then(function(a){return{result:a,error:null}})["catch"](function(a){return{result:null,error:a}}).then(function(a){var b,c=a.result;a=a.error;if((c==null?void 0:c.messageSendResult)===d("WAWebSendMsgResultAction").SendMsgResult.OK){s.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&s.isAvatar!==!0&&d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.addStickerWithMediaData(s);return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK}}s&&(s.ack=d("WAWebAck").ACK.FAILED);b=(b=s)==null||(b=b.mediaObject)==null?void 0:b.uploadStage;if(s&&d("WAWebMmsMediaTypes").getMsgMediaType(s)===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&d("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()){var e=b?b:"undefined";t===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR&&d("WALogger").ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with expressions panel enabled"]))).tags("non-sad").sendLogs("sticker-send-fail-with-expressions-panel-enabled-uploadStage-"+e,{sampling:.01})}if(t===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.CANCELLATION){d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat canceled"]))).devConsole({result:c,uploadStage:b,error:a});(e=s.wamMessageSendReporter)==null||e.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_CANCELLED,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_CANCELLED}}d("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Media:sendToChat error\nresult: ","\nuploadStage: ","\nuploadResultKind: ","\nerror: ",""],["Media:sendToChat error\\nresult: ","\\nuploadStage: ","\\nuploadResultKind: ","\\nerror: ",""])),c,b,t,String(a)).devConsole(a);if(b!=null)switch(b){case d("WAWebMediaTypes").UploadStage.NEED_UPLOAD:case d("WAWebMediaTypes").UploadStage.ERROR_TOO_LARGE:return{messageSendResult:M(s)};case d("WAWebMediaTypes").UploadStage.ERROR_MISSING:return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_EXPIRED};default:}if(t===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.ERROR)return{messageSendResult:M(s)};if(c!=null)return c;s&&d("WAWebMmsMediaTypes").getMsgMediaType(s)===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&d("WALogger").ERROR(D||(D=babelHelpers.taggedTemplateLiteralLoose(["Sticker:sendToChat failed with unknown error"]))).sendLogs("sticker-send-fail-unknown-"+(d("WAWebAttachMenuGatingUtils").areExpressionPanelsEnabledV2()?"expression-panels":"old-panels"));return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})});return X.apply(this,arguments)}g.MediaPrep=a;g.getMediaPropsNew=O;g.uploadMediaWithPrep=Q;g.sendMediaMsgToChat=S}),98);
__d("WAWebMediaStorage",["WALogger","WAWebMediaDataUtils","WAWebMediaObject","WAWebMediaStore","WAWebMmsMediaTypes","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i={};function a(a,b){a.addMsg(b)}function b(a,b){b.mediaObject=null;a.removeMsg(b);if(a.hasAssociatedMsgsOrStickers())return;o(a.filehash,d("WAWebMediaDataUtils").shouldUseLruMediaStore(d("WAWebMmsMediaTypes").getMsgMediaType(b)));a["delete"]()}function e(){var a=i;i={};for(var b in a)a[b]["delete"]()}function f(a){return Object.prototype.hasOwnProperty.call(i,a)?i[a]:i[a]=new(d("WAWebMediaObject").MediaObject)()}function j(a){}function k(a,b){a.addStickerPack(b)}function l(a,b){b.mediaObject=null;a.removeStickerPack(b);if(a.hasAssociatedMsgsOrStickers())return;o(a.filehash);a["delete"]()}function m(a,b){a.addSticker(b)}function n(a,b){b.mediaObject=null;a.removeSticker(b);if(a.hasAssociatedMsgsOrStickers())return;o(a.filehash);a["delete"]()}var o=function(a,b){b===void 0&&(b=!0);if(c("isStringNullOrEmpty")(a))return;delete i[a];b&&d("WAWebMediaStore").LruMediaStore.del(a)["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Media Storage] removing data (ArrayBuffer) from persistent storage "]))).devConsole(a)})};g.associateMediaWithMsg=a;g.disassociateMediaFromMsg=b;g.delistAndDeleteAllMedia=e;g.getOrCreateMediaObject=f;g.clearMediaForChat=j;g.associateMediaWithStickerPack=k;g.disassociateMediaFromStickerPack=l;g.associateMediaWithSticker=m;g.disassociateMediaFromSticker=n}),98);
__d("WAWebMediaUploadMmsThumbnail",["WAAbortError","WACustomError","WAPromiseRaceAbort","WAPromiseTimeout","WAWebCryptoCalculateFilehash","WAWebMediaCryptoEligibilityUtils","WAWebMediaMmsV4Upload","WAWebMediaObject","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.thumbnail,f=a.mediaType,g=a.mediaKeyInfo,h=a.uploadOrigin,i=a.forwardedFromWeb,j=a.timeout,k=a.signal,l=a.isViewOnce,m=new(d("WAWebMediaObject").MediaObject)();try{return j==null?yield n():yield d("WAPromiseTimeout").promiseTimeout(n(),j)}catch(b){a=b;if(a instanceof d("WACustomError").TimeoutError){d("WAWebMediaMmsV4Upload").cancelUploadMedia(m);return{kind:d("WAWebMediaMmsV4Upload").UploadMediaResultKind.TIMEOUT}}throw a}function n(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield c("WAPromiseRaceAbort")(d("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(e),k));m.filehash=a;m.mediaBlob=e;var b=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(f)?d("WAWebMediaMmsV4Upload").uploadMedia:d("WAWebMediaMmsV4Upload").uploadUnencryptedMedia;b=(yield c("WAPromiseRaceAbort")(b({mimetype:"image/jpeg",mediaObject:m,mediaType:f,forwardedFromWeb:i,uploadOrigin:h,mediaKeyInfo:g,isViewOnce:l}),k));return b.kind===d("WAWebMediaMmsV4Upload").UploadMediaResultKind.SUCCESS?babelHelpers["extends"]({},b,{filehash:a}):{kind:b.kind}}catch(b){a=b;if(typeof a==="object"&&(b==null?void 0:b.name)===d("WAAbortError").ABORT_ERROR){d("WAWebMediaMmsV4Upload").cancelUploadMedia(m);return{kind:d("WAWebMediaMmsV4Upload").UploadMediaResultKind.CANCELLATION}}}});return o.apply(this,arguments)}});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebMediaFileTooLargeError",["WACustomError","WAWebMiscErrors"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,c,d){var e;e=a.call(this,"File ("+b+") size = "+d+" exceeds limit of "+c)||this;e.mediaType=b;e.uploadLimit=c;e.actualSize=d;return e}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("MediaFileTooLarge",!0,d("WAWebMiscErrors").MediaFileError));g["default"]=a}),98);
__d("WAWebWamEnumDocumentType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:1,IMAGE:2,VIDEO:3,AUDIO:4,DOCUMENT:5,COMPRESSED_FILE:6,EXECUTABLE:7,VCARD:8});f.DOCUMENT_TYPE=a}),66);
__d("WAWebSendDocumentWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDocumentType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({SendDocument:[2172,{documentExt:[3,a.TYPES.STRING],documentPageSize:[4,a.TYPES.INTEGER],documentSize:[1,a.TYPES.NUMBER],documentType:[2,d("WAWebWamEnumDocumentType").DOCUMENT_TYPE]},[1,1,1],"regular"]},{SendDocument:[]});g.SendDocumentWamEvent=b}),98);
__d("WAWebProcessRawMediaLogging",["WAWebSendDocumentWamEvent","WAWebWamEnumDocumentType"],(function(a,b,c,d,e,f,g){var h=new Map([["ai",(b=d("WAWebWamEnumDocumentType")).DOCUMENT_TYPE.IMAGE],["ico",b.DOCUMENT_TYPE.IMAGE],["jpeg",b.DOCUMENT_TYPE.IMAGE],["jpg",b.DOCUMENT_TYPE.IMAGE],["png",b.DOCUMENT_TYPE.IMAGE],["ps",b.DOCUMENT_TYPE.IMAGE],["psd",b.DOCUMENT_TYPE.IMAGE],["svg",b.DOCUMENT_TYPE.IMAGE],["tif",b.DOCUMENT_TYPE.IMAGE],["tiff",b.DOCUMENT_TYPE.IMAGE],["3g2",b.DOCUMENT_TYPE.VIDEO],["3gp",b.DOCUMENT_TYPE.VIDEO],["avi",b.DOCUMENT_TYPE.VIDEO],["flv",b.DOCUMENT_TYPE.VIDEO],["h264",b.DOCUMENT_TYPE.VIDEO],["m4v",b.DOCUMENT_TYPE.VIDEO],["mkv",b.DOCUMENT_TYPE.VIDEO],["mov",b.DOCUMENT_TYPE.VIDEO],["mp4",b.DOCUMENT_TYPE.VIDEO],["mpg",b.DOCUMENT_TYPE.VIDEO],["mpeg",b.DOCUMENT_TYPE.VIDEO],["rm",b.DOCUMENT_TYPE.VIDEO],["vob",b.DOCUMENT_TYPE.VIDEO],["wmv",b.DOCUMENT_TYPE.AUDIO],["aif",b.DOCUMENT_TYPE.AUDIO],["cda",b.DOCUMENT_TYPE.AUDIO],["mpa",b.DOCUMENT_TYPE.AUDIO],["opus",b.DOCUMENT_TYPE.AUDIO],["ogg",b.DOCUMENT_TYPE.AUDIO],["wlp",b.DOCUMENT_TYPE.AUDIO],["amr",b.DOCUMENT_TYPE.AUDIO],["mp3",b.DOCUMENT_TYPE.AUDIO],["m4a",b.DOCUMENT_TYPE.AUDIO],["aac",b.DOCUMENT_TYPE.AUDIO],["wav",b.DOCUMENT_TYPE.AUDIO],["wma",b.DOCUMENT_TYPE.AUDIO],["pdf",b.DOCUMENT_TYPE.DOCUMENT],["doc",b.DOCUMENT_TYPE.DOCUMENT],["docx",b.DOCUMENT_TYPE.DOCUMENT],["ppt",b.DOCUMENT_TYPE.DOCUMENT],["pptx",b.DOCUMENT_TYPE.DOCUMENT],["xls",b.DOCUMENT_TYPE.DOCUMENT],["xlsx",b.DOCUMENT_TYPE.DOCUMENT],["txt",b.DOCUMENT_TYPE.DOCUMENT],["rtf",b.DOCUMENT_TYPE.DOCUMENT],["tex",b.DOCUMENT_TYPE.DOCUMENT],["csv",b.DOCUMENT_TYPE.DOCUMENT],["wpd",b.DOCUMENT_TYPE.DOCUMENT],["7z",b.DOCUMENT_TYPE.COMPRESSED_FILE],["arj",b.DOCUMENT_TYPE.COMPRESSED_FILE],["deb",b.DOCUMENT_TYPE.COMPRESSED_FILE],["pkg",b.DOCUMENT_TYPE.COMPRESSED_FILE],["rar",b.DOCUMENT_TYPE.COMPRESSED_FILE],["rpm",b.DOCUMENT_TYPE.COMPRESSED_FILE],["gz",b.DOCUMENT_TYPE.COMPRESSED_FILE],["z",b.DOCUMENT_TYPE.COMPRESSED_FILE],["zip",b.DOCUMENT_TYPE.COMPRESSED_FILE],["apk",b.DOCUMENT_TYPE.EXECUTABLE],["bat",b.DOCUMENT_TYPE.EXECUTABLE],["bin",b.DOCUMENT_TYPE.EXECUTABLE],["cgi",b.DOCUMENT_TYPE.EXECUTABLE],["pl",b.DOCUMENT_TYPE.EXECUTABLE],["com",b.DOCUMENT_TYPE.EXECUTABLE],["exe",b.DOCUMENT_TYPE.EXECUTABLE],["gadget",b.DOCUMENT_TYPE.EXECUTABLE],["jar",b.DOCUMENT_TYPE.EXECUTABLE],["msi",b.DOCUMENT_TYPE.EXECUTABLE],["py",b.DOCUMENT_TYPE.EXECUTABLE],["wsf",b.DOCUMENT_TYPE.EXECUTABLE]]);function a(a,b){var c;a=(a=a==null?void 0:a.split(".").pop())!=null?a:"";a=h.has(a)?a:"";c=(c=h.get(a))!=null?c:d("WAWebWamEnumDocumentType").DOCUMENT_TYPE.OTHER;b=new(d("WAWebSendDocumentWamEvent").SendDocumentWamEvent)({documentSize:b,documentType:c,documentExt:a});b.commit()}g.logSendDocumentEvent=a}),98);
__d("WAWebProcessRawMedia",["WAWebABProps","WAWebFileUtils","WAWebMediaDataUtils","WAWebMediaFileTooLargeError","WAWebMediaGatingUtils","WAWebMiscErrors","WAWebProcessRawMediaLogging","asyncToGeneratorRuntime","cr:10296","err"],(function(a,b,c,d,e,f,g){var h=2*1024*1024*1024;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a.retain();try{var f,g,i=a.size();f=(f=b("cr:10296")==null?void 0:b("cr:10296").isWindowsHybridTranscoderEnabled())!=null?f:!1;var j;e.asDocument===!0?j=d("WAWebFileUtils").FILETYPE.DOCUMENT:e.asSticker===!0?j=d("WAWebFileUtils").FILETYPE.STICKER:e.asStickerPack===!0?j=d("WAWebFileUtils").FILETYPE.STICKER_PACK:j=d("WAWebFileUtils").typeFromMimetype(a.type());g=(g=e.isVcardOverMmsDocument)!=null?g:!1;j==="document"&&d("WAWebProcessRawMediaLogging").logSendDocumentEvent(e.filename,i);var k=d("WAWebMediaGatingUtils").getUploadLimit(j,e.fileOrigin,g);if(j==="video"&&f&&i>=h)throw new(c("WAWebMediaFileTooLargeError"))(j,h,i);else if(!f&&i>k)throw new(c("WAWebMediaFileTooLargeError"))(j,k,i);if(i<=0)throw new(d("WAWebMiscErrors").MediaFileEmpty)();var l;e.gifAttribution!=null?l=e.gifAttribution:e.asGif===!0&&(l=0);var m;switch(j){case"image":m=(yield d("WAWebMediaDataUtils").processRawImage(a,{maxDimension:(i=e.maxDimension)!=null?i:d("WAWebABProps").getABPropConfigValue("web_image_max_edge"),minDimension:e.minDimension,transparency:e.transparency}));break;case"sticker":m=(yield d("WAWebMediaDataUtils").processRawSticker(a));break;case"video":case"audio":m=(yield d("WAWebMediaDataUtils").processRawAudioVideo(a,!!e.isPtt,e.precomputedFields,e.asGif,l,a.type(),e.accessibilityLabel,e.setProgressPercentage,e.setMediaPreview,e.resetMediaPreview,e.setMimeType));if(f&&j==="video"&&m.size!=null&&m.size>k)throw new(c("WAWebMediaFileTooLargeError"))(j,k,m.size);break;case"document":case"sticker-pack":m=(yield d("WAWebMediaDataUtils").processRawDocument(a,e.filename,g,e.documentPageCount,j));break;default:j;throw c("err")("Received unsupported mediaType: "+j)}return m}finally{a.autorelease()}});return i.apply(this,arguments)}g.processRawMedia=a}),98);
__d("WAWebRequestMediaReuploadManager",["Promise","WALogger","WANullthrows","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebSendServerErrorReceiptJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;a=function(){function a(){var a=this;this.$1=new Map();this.requestMediaReupload=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e.id.id;if(d("WAWebMsgGetters").getIsNewsletterMsg(e))throw new(d("WAWebMiscErrors").RMRNotSupportedOnNewsletterMessagesError)(d("WAWebMmsMediaTypes").getMsgMediaType(e));var g=a.$1.get(f);if(g)return c("WANullthrows")(g.request);g=new(i||(i=b("Promise")))(function(b,c){a.$1.set(f,{resolve:b,reject:c,msg:e})});c("WANullthrows")(a.$1.get(f)).request=g;yield c("WAWebSendServerErrorReceiptJob")(e);return g});return function(a){return e.apply(this,arguments)}}();this.resolveMediaReupload=function(b){var c=b.msgId,e=b.result;b=b.directPath;var f=a.$1.get(c);f!=null?(f.resolve({result:e,directPath:b}),a.$1["delete"](c)):d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["resolveMediaReupload: msgId (",") is not found in _rmrRequests"])),c)};this.getMediaKey=function(b){return(b=a.$1.get(b))==null?void 0:b.msg.mediaKey}}var e=a.prototype;e.rmrRequests_TESTONLY=function(){return this.$1};return a}();e=new a();g.RequestMediaReuploadManagerImpl=a;g.RequestMediaReuploadManager=e}),98);
__d("WAWebDecodeWebpToRgba",["Promise","WAWebMiscErrors","WAWebWebpToRgbaWorkerResource","WorkerBundleResource"],(function(a,b,c,d,e,f,g){var h;function a(a){return new(h||(h=b("Promise")))(function(b,e){var f=d("WorkerBundleResource").createDedicatedWebWorker(c("WAWebWebpToRgbaWorkerResource"));f.onerror=function(a){f.terminate(),e(new(d("WAWebMiscErrors").DecodeWebpResultsError)("worker error",a))};f.onmessageerror=function(a){f.terminate(),e(new(d("WAWebMiscErrors").DecodeWebpResultsError)("worker message error",a))};f.onmessage=function(a){f.terminate();a=a.data;b(a)};f.postMessage({type:"message",message:{webpBuffer:a}},[a])})}g["default"]=a}),98);
__d("WAXMultiSitePdfWorkerResourceControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/static_resources/webworker/pdf-worker/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("WAWebPDFWorkerSrc",["WAXMultiSitePdfWorkerResourceControllerRouteBuilder"],(function(a,b,c,d,e,f,g){function a(){return c("WAXMultiSitePdfWorkerResourceControllerRouteBuilder").buildUri({}).toString()}g.getWorkerSrc=a}),98);
__d("WAWebPDFUtils",["JSResourceForInteraction","Promise","WABackoffUtils","WAPromiseDelays","WAPromiseLoop","WAPromiseProps","WAWebABProps","WAWebCanvasUtils","WAWebImageUtils","WAWebMediaConstants","WAWebMediaOpaqueData","WAWebMiscErrors","WAWebPDFWorkerSrc","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){return d("WAPromiseLoop").promiseLoop(function(a,b,e){var f=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(e,12e4,0,0));return c("JSResourceForInteraction")("pdfjs-dist").__setRef("WAWebPDFUtils").load().then(function(b){b.GlobalWorkerOptions.workerSrc=d("WAWebPDFWorkerSrc").getWorkerSrc(),a({GlobalWorkerOptions:b.GlobalWorkerOptions,getDocument:b.getDocument})})["catch"](function(){return f})})}function a(a){var b=URL.createObjectURL(a);return i().then(function(a){return a.getDocument({url:b,isEvalSupported:!1}).promise})}function e(a){return a.destroy()}function f(a,e){var f=document.createElement("canvas");return a.getPage(e).then(function(a){var b=a.getViewport({scale:1}),c=f.getContext("2d");f.height=b.height;f.width=b.width;c={canvasContext:c,viewport:b};return a.render(c).promise}).then(function(){var a;return d("WAPromiseProps").promiseProps({blob:d("WAWebCanvasUtils").canvasToBlob(f),thumbnail:(a=d("WAWebImageUtils")).rotateAndResize(f,d("WAWebMediaConstants").DOC_THUMB_MAX_EDGE,a.DATA_URL|a.CANVAS|a.BLOB),microThumbnail:d("WAWebABProps").getABPropConfigValue("upload_document_thumb_mms_enabled")?d("WAWebCanvasUtils").generateMicroThumb(f,d("WAWebABProps").getABPropConfigValue("web_pdf_thumbnail_size_in_bytes"),{mimetype:"image/jpeg",maxAttempts:10}):(h||(h=b("Promise"))).resolve(null)})}).then(function(a){return a}).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e.blob,g=e.thumbnail;e=e.microThumbnail;g=g.images;var b=g.canvas,h=g.blob;g=g.dataUrl;if(b==null||h==null||g==null)throw new(d("WAWebMiscErrors").MediaFileFailedLoad)();return{url:URL.createObjectURL(f),thumbUrl:g,width:b.width,height:b.height,fullPreviewData:yield c("WAWebMediaOpaqueData").createFromData(h,"image/jpeg"),fullPreviewSize:{width:b.width,height:b.height},pdfPages:a.numPages,microThumbnail:e}});return function(a){return e.apply(this,arguments)}}())}g.fileToPdf=a;g.releasePdf=e;g.pdfToImg=f}),98);
__d("WAWebDocumentUploadEnrichment",["Promise","WALogger","WAPromiseTimeout","WAWebMimeTypes","WAWebPDFUtils"],(function(a,b,c,d,e,f,g){var h,i;function a(a,c){var e;switch(d("WAWebMimeTypes").previewType(c)){case"pdf":e=j(a);break;default:e=(i||(i=b("Promise"))).resolve()}return d("WAPromiseTimeout").promiseTimeout(e,3e3,"Document enrichment timeout")["catch"](function(){return null})}function j(a){var b;return d("WAWebPDFUtils").fileToPdf(a).then(function(a){b=a;return d("WAWebPDFUtils").pdfToImg(a,1)})["catch"](function(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["pdf preview generation failed"]))).devConsole(a);return null})["finally"](function(){b&&d("WAWebPDFUtils").releasePdf(b)})}g.enrich=a}),98);
__d("WAWebSendMessageToMediaWorker",["Promise","WALogger","WAWebMediaWorkerResource","WebWorker"],(function(a,b,c,d,e,f,g){var h,i,j,k=l();function a(a){var c;return new(j||(j=b("Promise")))(function(b,e){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:sendMessageToMediaWorker"]))),c=k&&m(k)?l():k,c.setMessageHandler(function(a){try{a.type==="log"?d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["(via Milan) ",""])),a.msg):b(a)}catch(a){e(a)}}).setErrorHandler(function(a){e(new Error("Milan.onerror = "+(a!=null&&a.message?a.message:a)))}).execute(),c.postMessage(a)})["finally"](function(){c&&(c.terminate(),(!k||!k.isCurrentState("constructed"))&&(k=l()))})}function l(){return new(c("WebWorker"))(c("WAWebMediaWorkerResource")).setAllowCrossPageTransition(!0)}function m(a){return a.isCurrentState("preparing")||a.isCurrentState("executing")}g.sendMessageToMediaWorker=a}),98);
__d("WAWebWebcMediaAnalyzedWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMediaAnalyzed:[912,{webcMediaAnalyzeT:[3,a.TYPES.TIMER],webcMediaExtensions:[2,a.TYPES.STRING],webcMediaSupported:[1,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{WebcMediaAnalyzed:[]});g.WebcMediaAnalyzedWamEvent=b}),98);
__d("WAWebMediaAnalyzer",["WALogger","WAMediaWasmWorkerClient","WAWebMediaGatingUtils","WAWebSendMessageToMediaWorker","WAWebWebcMediaAnalyzedWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new(d("WAWebWebcMediaAnalyzedWamEvent").WebcMediaAnalyzedWamEvent)(),e=!1;try{var f=d("WAWebMediaGatingUtils").shouldUseWasmMediaWorkerForFile(a),g;if(f)g=(yield s(a,b));else{b={type:"prep",file:a,asGif:b};b=(yield d("WAWebSendMessageToMediaWorker").sendMessageToMediaWorker(b));var m=b.type,n=b.result,o=b.error,p=b.filename;b=b.file;switch(m){case"result":d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair approved file"])));e=!!n;g=n;break;case"parsingError":d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""])),b,p,String(o));b&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""])),String(o)).sendLogs("media-parsing-error");d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"])),String(o));break}}return[g,f]}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""])),String(a)).sendLogs("media-detection-error");return[void 0,!1]}finally{if(c){m=void 0;if(a.name){n=a.name.split(".");n.length>1&&(m=n[n.length-1])}c.set({webcMediaSupported:e,webcMediaExtensions:m});c.markWebcMediaAnalyzeT();c.commit()}}});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm] start process video through wasm"])));a=(yield a.arrayBuffer());a=(yield d("WAMediaWasmWorkerClient").mp4RepairMuxInWorker({input:new Uint8Array(a),eventFlow:null}));if(a.success){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][success]"]))).devConsole(a);return{type:"video/mp4",file:new Blob([a.value],{type:"video/mp4"}),isGif:b}}switch(a.error){case"undefined-operation":case"worker-connection-runtime-error":case"invalid-media":case"runtime-error":case"internal-error":d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] failed to repair video file"]))).devConsole(a);break;case"worker-connection-timeout":d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] error ",""])),a.error).sendLogs("worker-connection-timeout-error");break;default:a.error;d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[processVideoThroughWasm][error] unrecognised error ",""])),a.error).sendLogs("media-analyzer-unrecognised-error");break}});return t.apply(this,arguments)}g.checkAndRepair=a}),98);
__d("WAWebWamEnumVideoTranscoderAlgorithmType",[],(function(a,b,c,d,e,f){a=Object.freeze({WA_IPHONE:0,FB_IPHONE:1,WASM_MP4_CHECK_AND_REPAIR:2,WEB_MEDIA_WORKER:3,HYBRID_BRIDGE:4});f.VIDEO_TRANSCODER_ALGORITHM_TYPE=a}),66);
__d("WAWebWamEnumVideoTranscoderResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,SUCCEEDED:1,FAILED:2,CANCELLED:3});f.VIDEO_TRANSCODER_RESULT_TYPE=a}),66);
__d("WAWebWamEnumVideoTranscoderSourceFormatType",[],(function(a,b,c,d,e,f){a=Object.freeze({SLOMO:0,VIDEO:1,GIF:2});f.VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE=a}),66);
__d("WAWebWamEnumVideoTranscoderTargetFormatType",[],(function(a,b,c,d,e,f){a=Object.freeze({IMAGE:0,VIDEO:1,GIF:2});f.VIDEO_TRANSCODER_TARGET_FORMAT_TYPE=a}),66);
__d("WAWebVideoTranscoderWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumVideoTranscoderAlgorithmType","WAWebWamEnumVideoTranscoderResultType","WAWebWamEnumVideoTranscoderSourceFormatType","WAWebWamEnumVideoTranscoderTargetFormatType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({VideoTranscoder:[1802,{sourceAudioBitRate:[12,a.TYPES.NUMBER],sourceAudioCodec:[23,a.TYPES.STRING],sourceContainerFormat:[24,a.TYPES.STRING],sourceDuration:[8,a.TYPES.TIMER],sourceFileExtension:[25,a.TYPES.STRING],sourceFileSize:[7,a.TYPES.NUMBER],sourceFormat:[14,d("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE],sourceFrameRate:[13,a.TYPES.NUMBER],sourceHeight:[10,a.TYPES.NUMBER],sourceMimeType:[26,a.TYPES.STRING],sourceVideoBitRate:[11,a.TYPES.NUMBER],sourceVideoCodec:[27,a.TYPES.STRING],sourceWidth:[9,a.TYPES.NUMBER],targetAudioBitRate:[20,a.TYPES.NUMBER],targetDuration:[16,a.TYPES.TIMER],targetFileSize:[15,a.TYPES.NUMBER],targetFormat:[22,d("WAWebWamEnumVideoTranscoderTargetFormatType").VIDEO_TRANSCODER_TARGET_FORMAT_TYPE],targetFrameRate:[21,a.TYPES.NUMBER],targetHeight:[18,a.TYPES.NUMBER],targetVideoBitRate:[19,a.TYPES.NUMBER],targetWidth:[17,a.TYPES.NUMBER],transcoderAlgorithm:[1,d("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE],transcoderContainsVideocomposition:[5,a.TYPES.BOOLEAN],transcoderHasEdits:[6,a.TYPES.BOOLEAN],transcoderIsPassthrough:[4,a.TYPES.BOOLEAN],transcoderResult:[2,d("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE],transcoderT:[3,a.TYPES.TIMER]},[1,1,1],"regular"]},{VideoTranscoder:[]});g.VideoTranscoderWamEvent=b}),98);
__d("WAWebWaveformUtils",["WAPttComposerScaleWaveform","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=64;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebNewsletterGatingUtils").isAudioFileWaveformSenderEnabled())return null;a=(yield a.arrayBuffer());var b=new AudioContext({sampleRate:8e3});b=(yield b.decodeAudioData(a));a=j(b,h);return new Uint8Array(a)});return i.apply(this,arguments)}function j(a,b){a=a.getChannelData(0);return l(k(a,b))}function k(a,b){return c("WAPttComposerScaleWaveform")(Array.from(a,Math.abs),b)}function l(a){var b=Math.pow(Math.max.apply(Math,a),-1);a=a.map(function(a){return a*b});return a.map(function(a){return a*100})}g.computeWaveform=a}),98);
__d("WAWebMediaDataUtils",["Promise","WABase64","WAFilteredCatch","WALogger","WANullthrows","WAPromiseCallSync","WAWebABProps","WAWebCanvasUtils","WAWebDecodeWebpToRgba","WAWebDocumentUploadEnrichment","WAWebFileUtils","WAWebImageUtils","WAWebMediaAnalyzer","WAWebMediaCleanFileName","WAWebMediaConstants","WAWebMediaLoad","WAWebMediaOpaqueData","WAWebMediaTypes","WAWebMimeTypes","WAWebMiscErrors","WAWebMiscGatingUtils","WAWebMmsMediaTypes","WAWebNetworkGetResponseIfOnline","WAWebStickerUtils","WAWebURLUtils","WAWebVcardParsingUtils","WAWebVideoTranscoderWamEvent","WAWebWamEnumVideoTranscoderAlgorithmType","WAWebWamEnumVideoTranscoderResultType","WAWebWamEnumVideoTranscoderSourceFormatType","WAWebWamEnumVideoTranscoderTargetFormatType","WAWebWaveformUtils","WAWebWebpParseWebp","WAWebXHR","asyncToGeneratorRuntime","cr:10296","err","file-type","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=2e4;function a(a){return J(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d){d(a);var e=new Image();yield new(o||(o=b("Promise")))(function(b,d){e.onload=b,e.onabort=function(){d(c("err")("getImageWidthHeight onabort"))},e.onerror=function(){d(c("err")("getImageWidthHeight onerror"))},e.src=a.url()});return{width:e.naturalWidth,height:e.naturalHeight}});return function(a){return d.apply(this,arguments)}}())}function q(a){return new(o||(o=b("Promise")))(function(b,d){var e=new Image(),f=window.URL.createObjectURL(a);e.onload=function(){var a={width:e.naturalWidth,height:e.naturalHeight};window.URL.revokeObjectURL(f);b(a)};e.onabort=function(){window.URL.revokeObjectURL(f),d(c("err")("getImageWidthHeight onabort"))};e.onerror=function(){window.URL.revokeObjectURL(f),d(c("err")("getImageWidthHeight onerror"))};e.src=f})}function r(a){return d("WAWebFileUtils").blobToArrayBuffer(a)["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaUtils error: ",""])),a).devConsole(a);throw a})}function e(a){return J(function(b){b(a);b=a.getBlob();if(b)return r(b);b=c("WANullthrows")(a.getBase64(),"b64 should be defined");return d("WABase64").decodeB64(b)})}function f(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield r(a));return c("WAWebDecodeWebpToRgba")(a)});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield r(a));return d("WAWebWebpParseWebp").parseWebp(a)});return u.apply(this,arguments)}function v(a){return d("WAWebMediaLoad").videoWidthHeightDuration(a)}function w(a,e){return J(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b(a);var f=(yield d("WAWebMediaLoad").transcode(a.forceToBlob(),e).then(function(a){return c("WAWebMediaOpaqueData").createFromData(a,a.type)}));b(f);f.autorelease();return f});return function(a){return f.apply(this,arguments)}}())}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.transparency,e=b.minDimension;b=b.maxDimension;a=(yield d("WAWebImageUtils").rotateAndResize(a,b,d("WAWebImageUtils").BLOB,{transparency:c,minDimension:e}));b=a.width;c=a.height;e=a.images;if(e==null||e.blob==null)throw new(d("WAWebMiscErrors").MediaFileFailedLoad)();return{width:b,height:c,size:e.blob.size}});return y.apply(this,arguments)}function z(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.transparency,f=b.minDimension;b=b.maxDimension;a=a.forceToBlob();a=(yield d("WAWebImageUtils").rotateAndResize(a,b,d("WAWebImageUtils").BLOB|d("WAWebImageUtils").CANVAS,{transparency:e,minDimension:f}));b=a.width;e=a.height;f=a.images;if(f==null||f.canvas==null)throw new(d("WAWebMiscErrors").MediaFileFailedLoad)();a=(yield d("WAWebImageUtils").rotateAndResize(f.canvas,d("WAWebMediaConstants").IMG_THUMB_MAX_EDGE,d("WAWebImageUtils").DATA_URL|d("WAWebImageUtils").CANVAS));a=a.images;if(a==null||a.canvas==null)throw new(d("WAWebMiscErrors").MediaFileFailedLoad)();a=d("WAWebCanvasUtils").getResizedDataUrl(a.canvas,"image/jpeg",p);a=a!=null&&a!==""?c("WAWebURLUtils").parseDataURL(a).data:null;(a==null||a==="")&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["processRawImage: Failed to reach max thumbnail size, preview will be null"])));return{type:d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE,mediaBlob:f.blob,mimetype:(f=f.blob)==null?void 0:f.type,fullWidth:b,fullHeight:e,preview:a}});return A.apply(this,arguments)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.forceToBlob();a=(yield d("WAWebImageUtils").rotateAndResize(a,d("WAWebABProps").getABPropConfigValue("web_image_max_edge"),d("WAWebImageUtils").BLOB,{transparency:!0}));var b=a.width,e=a.height;a=a.images;if(a==null||a.blob==null)throw new(d("WAWebMiscErrors").MediaFileFailedLoad)();a=(yield d("WAWebImageUtils").toWebpSticker(a.blob));var f=(yield c("WAWebMediaOpaqueData").createFromData(a,a.type));return{type:d("WAWebMediaTypes").OUTWARD_TYPES.STICKER,mediaBlob:f,mimetype:a.type,fullWidth:b,fullHeight:e}});return C.apply(this,arguments)}function D(a,b,c,d,e,f,g,h,i,j,k){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,i,n,o,p,q,r){i=!1;try{var s=a.forceToBlob(),t=s instanceof File?s.name:"";a=new(d("WAWebVideoTranscoderWamEvent").VideoTranscoderWamEvent)({sourceHeight:f==null?void 0:f.fullHeight,sourceWidth:f==null?void 0:f.fullWidth,sourceDuration:f==null?void 0:f.duration,sourceFileSize:a.size(),sourceFormat:g===!0?d("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE.GIF:d("WAWebWamEnumVideoTranscoderSourceFormatType").VIDEO_TRANSCODER_SOURCE_FORMAT_TYPE.VIDEO,sourceMimeType:s.type,sourceFileExtension:t.split(".").pop()});t=(t=b("cr:10296")==null?void 0:b("cr:10296").isWindowsHybridTranscoderEnabled())!=null?t:!1;var u=s.type.startsWith("video/"),v=s.type==="video/mp4";v=v?(v=b("cr:10296")==null?void 0:b("cr:10296").isWindowsHybridTranscoderEnabledForMp4())!=null?v:!1:!0;u=t&&u&&v;a.startTranscoderT();v=null;if(!u){var w=(yield d("WAWebMediaAnalyzer").checkAndRepair(s,!!g));v=w[0];w=w[1];v&&(a.transcoderAlgorithm=w?d("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.WASM_MP4_CHECK_AND_REPAIR:d("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.WEB_MEDIA_WORKER)}if(u||!v&&t){a.transcoderAlgorithm=d("WAWebWamEnumVideoTranscoderAlgorithmType").VIDEO_TRANSCODER_ALGORITHM_TYPE.HYBRID_BRIDGE;w=(yield b("cr:10296")==null?void 0:b("cr:10296").transcodeVideo(s,o,p,q,r));if(w!=null){u=w[0];t=w[1];s=u;i=t;v={type:s.type,file:s,isGif:!1}}}a.markTranscoderT();if(!v){a.set({transcoderResult:d("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED});a.commit();d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["processRawAudioVideo bad video file ",""])),s.type).devConsole(s);throw new(d("WAWebMiscErrors").InvalidMediaCheckRepairFailedType)()}o=v.type;p=v.file;a.set({targetFileSize:p.size});r=g===!0||v.isGif===!0;switch(d("WAWebFileUtils").typeFromMimetype(o)){case d("WAWebFileUtils").FILETYPE.VIDEO:if(e){a.set({transcoderResult:d("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED});a.commit();d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: ptt became video");throw new(d("WAWebMiscErrors").InvalidMediaFileType)()}a.set({targetFormat:d("WAWebWamEnumVideoTranscoderTargetFormatType").VIDEO_TRANSCODER_TARGET_FORMAT_TYPE.VIDEO,transcoderResult:d("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.SUCCEEDED});w={type:d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO,mediaBlob:p,mimetype:o,isGif:r,gifAttribution:r?h||0:void 0,accessibilityLabel:n,size:p.size};if(f&&f.duration!=null&&f.fullHeight!=null&&f.fullHeight!==0&&f.fullWidth!=null&&f.fullWidth!==0&&!c("isStringNullOrEmpty")(f.preview)){u=f.duration;a.set({sourceHeight:f.fullHeight,sourceWidth:f.fullWidth,sourceDuration:u});a.commit();return babelHelpers["extends"]({},w,{fullWidth:f.fullWidth,fullHeight:f.fullHeight,preview:f.preview,duration:u==null?void 0:u.toString()})}t=(yield d("WAWebImageUtils").generateVideoThumbsAndDuration({file:p,maxDimensions:[d("WAWebMediaConstants").IMG_THUMB_MAX_EDGE,d("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"processRawAudioVideo"}));s=t.duration;g=t.thumbs;v=g[0];r=g[1];h=(yield c("WAWebMediaOpaqueData").createFromBase64Jpeg(c("WAWebURLUtils").parseDataURL(r.url).data));a.set({sourceHeight:v.fullHeight,sourceWidth:v.fullWidth,sourceDuration:s});a.commit();return babelHelpers["extends"]({},w,{fullWidth:v.fullWidth,fullHeight:v.fullHeight,preview:c("WAWebURLUtils").parseDataURL(v.url).data,fullPreviewData:h,duration:s.toString()});case d("WAWebFileUtils").FILETYPE.AUDIO:u=(n=f==null?void 0:f.duration)!=null?n:yield d("WAWebFileUtils").getAudioDuration(p);g=(t=f==null?void 0:f.waveform)!=null?t:yield d("WAWebWaveformUtils").computeWaveform(p);return{type:e?d("WAWebMediaTypes").OUTWARD_TYPES.PTT:d("WAWebMediaTypes").OUTWARD_TYPES.AUDIO,mediaBlob:p,mimetype:o,duration:u.toString(),waveform:g};default:a.set({transcoderResult:d("WAWebWamEnumVideoTranscoderResultType").VIDEO_TRANSCODER_RESULT_TYPE.FAILED});a.commit();d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("media-fault: audio/video became other");throw c("err")("audio/video became "+o)}}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["processRawAudioVideo error: ",""])),a).devConsole(a);i&&q!=null&&q();throw a}});return E.apply(this,arguments)}function F(a,b){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.type;if(e){if(d("WAWebMimeTypes").DOC_MIMES==="*"||d("WAWebMimeTypes").DOC_MIMES.includes(e))return e;throw new(d("WAWebMiscErrors").InvalidMediaFileType)("disallowed mimetype "+e)}else{e=Math.min(d("WAWebMimeTypes").MIMETYPE_DETERMINING_LENGTH,a.size);e=(yield r(a.slice(0,e)));e=new Uint8Array(e);if(d("WAWebMimeTypes").isMsCompoundFileBinaryFormat(e.subarray(0,8))){var f;return b!=null?(f=d("WAWebFileUtils").getMimeTypeForFilepath(b))!=null?f:d("WAWebMimeTypes").MSCFB_MIME:d("WAWebMimeTypes").MSCFB_MIME}f=c("file-type")(e);if(f!=null&&f.mime){e=d("WAWebMimeTypes").isAllowedDocumentMimetype(f.mime,b,!0);if(!c("isStringNullOrEmpty")(e))return e}else if(!c("isStringNullOrEmpty")(b)){f=d("WAWebFileUtils").getMimeTypeForFilepath(b);if(!c("isStringNullOrEmpty")(f))return f}throw new(d("WAWebMiscErrors").InvalidMediaFileType)("type: "+String(a.type)+" name: "+String(b))}});return G.apply(this,arguments)}function H(a,b,c,d,e){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){var i,j;a=a.forceToBlob();e=d("WAWebMediaCleanFileName").cleanFilename(a.name||(e!=null?e:""));var k=(yield F(a,e)),l=f?d("WAWebFileUtils").blobToText(a):null;l=(yield (o||(o=b("Promise"))).all([d("WAWebDocumentUploadEnrichment").enrich(a,k),l]));var m=l[0];l=l[1];i=(i=m==null||(j=m.microThumbnail)==null?void 0:j.dataUrl)!=null?i:m==null?void 0:m.thumbUrl;i=c("isStringNullOrEmpty")(i)?null:c("WAWebURLUtils").parseDataURL(i).data;return{type:h,mediaBlob:yield c("WAWebMediaOpaqueData").createFromData(a,k),mimetype:k,filename:e||void 0,documentPreview:m,preview:i,fullPreviewData:m==null?void 0:m.fullPreviewData,fullPreviewSize:m?{width:m.width,height:m.height}:null,pageCount:g!=null?g:m==null?void 0:m.pdfPages,isVcardOverMmsDocument:f,parsedVcards:l?d("WAWebVcardParsingUtils").parseMultiVcard(l):null}});return I.apply(this,arguments)}function J(a){var b=[];function c(a){a.retain(),b.push(a)}return d("WAPromiseCallSync").promiseCallSync(a,null,c)["finally"](function(){for(var a=0;a<b.length;a++)b[a].autorelease()})}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield c("WAWebNetworkGetResponseIfOnline")(a,"GET",null,c("WAWebXHR").RESP_TYPE.ARRAY_BUFFER));return!a?(o||(o=b("Promise"))).resolve(null):(o||(o=b("Promise"))).resolve({result:a.response,status:a.status})});return L.apply(this,arguments)}function M(){return!!d("WAWebMediaLoad").canPlayOgg}function N(a,b){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b.retain();var e,f;try{switch(a.type){case d("WAWebMediaTypes").TYPE.VIDEO:case d("WAWebMediaTypes").TYPE.PTV:var g=b.forceToBlob();g=(yield d("WAWebImageUtils").generateVideoThumbsAndDuration({file:g,maxDimensions:[d("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"gatherAndSetMetadata"}));var h=g.thumbs;h=h[0];g=g.duration;var i;d("WAWebMiscGatingUtils").isHighQualityVideoThumbnailsEnabled()&&(i=(yield c("WAWebMediaOpaqueData").createFromBase64Jpeg(c("WAWebURLUtils").parseDataURL(h.url).data)));e={mediaBlob:b,renderableUrl:b.url(),fullWidth:h.fullWidth,fullHeight:h.fullHeight,duration:g!==void 0?""+Math.ceil(g):void 0,durationFloat:g,fullPreviewData:i};break;case d("WAWebMediaTypes").TYPE.AUDIO:var j=(yield w(b));j.retain();e={mediaBlob:j,renderableUrl:j.url()};f=function(){return j.autorelease()};break;default:(a.type===d("WAWebMediaTypes").TYPE.IMAGE||a.type===d("WAWebMediaTypes").TYPE.STICKER)&&d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["object type: ",""])),a.type||"").sendLogs("Entering gatherAndSetMetadata (with OpaqueData) unexpectedly"),e={mediaBlob:b,renderableUrl:b.url()}}a.consolidate(e)}catch(c){if(c instanceof d("WAWebMiscErrors").MediaUnsupportedError)a.consolidate({mediaBlob:b,renderableUrl:b.url()});else throw c}finally{b.autorelease(),f!=null&&f()}});return O.apply(this,arguments)}function P(a,b){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield (o||(o=b("Promise"))).resolve().then(function(){switch(a.type){case d("WAWebMediaTypes").TYPE.VIDEO:case d("WAWebMediaTypes").TYPE.PTV:return v(c).then(function(a){return{fullWidth:a.width,fullHeight:a.height,duration:a.duration!==void 0?""+Math.ceil(a.duration):void 0,durationFloat:a.duration}});case d("WAWebMediaTypes").TYPE.IMAGE:return a.contentInfo.fullHeight!=null&&a.contentInfo.fullWidth!=null&&a.size===c.size?null:q(c).then(function(a){return{fullWidth:a.width,fullHeight:a.height,size:c.size}});case d("WAWebMediaTypes").TYPE.STICKER:return d("WAWebStickerUtils").parseStickerMetadata(c,a);case d("WAWebMediaTypes").TYPE.AUDIO:return{};default:return{}}})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").MediaUnsupportedError,function(b){a.consolidate({});throw b})));if(e==null)return;a.consolidate(e)});return Q.apply(this,arguments)}function R(a){return a===d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO}function S(a){var b=a===d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER;a=a===d("WAWebMmsMediaTypes").MEDIA_TYPES.AUDIO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_AUDIO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.DOCUMENT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.GIF||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_GIF||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PRODUCT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.PTV||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_PTV||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.TEMPLATE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_IMAGE||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_LINK||a===d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_VIDEO;return b||a}function T(a,c){return new(o||(o=b("Promise")))(function(b){var d=new Image();d.setAttribute("crossorigin","anonymous");d.onload=function(){var a=c.map(function(a){var b=a.width,c=a.height,e=a.minWidth,f=a.minHeight,g=a.imageFormat,h=a.imageFormatOptions;a=a.keepAspectRatio;if(e!=null&&d.width<e||f!=null&&d.height<f)return null;e=document.createElement("canvas");f=e.getContext("2d");var i=0,j=0,k;if(d.height>d.width){var l=d.height/d.width;k=b;l=l*b;j=-(l-c)/2}else{var m=d.width/d.height;l=c;k=m*c;i=-(k-b)/2}a===!0?(e.width=k,e.height=l):(e.width=b,e.height=c);f.drawImage(d,i,j,k,l);return{dataUrl:e.toDataURL(g,h).replace("data:image/jpeg;base64,",""),width:e.width,height:e.height}});b(a)};d.src=a})}function U(a){if(!a)return null;if(a.fullPreviewData)return a.fullPreviewData.url();return a.preview instanceof c("WAWebMediaOpaqueData")?a.preview.url():null}g.getImageWidthHeight=a;g.getImageWidthHeightNoOpaque=q;g.opaqueDataToArrayBuffer=e;g.decodeWebpToRGBANoOpaque=f;g.parseWebpNoOpaque=t;g.getImageMetadata=x;g.processRawImage=z;g.processRawSticker=B;g.processRawAudioVideo=D;g.getRawDocumentMimetype=F;g.processRawDocument=H;g.fetchMedia=K;g.canPlayOgg=M;g.gatherAndSetMetadata=N;g.gatherAndSetMetadataNoOpaque=P;g.shouldUseMediaCache=R;g.shouldUseLruMediaStore=S;g.getResizedThumbData=T;g.getHighestQualityThumbnailUrl=U}),98);
__d("WAWebInMemoryLottieStickerCache",["WAWebABProps","WAWebLruCacheMap","WAWebMediaMmsV4Download","WAWebStickerErrorWamEvent","WAWebWamEnumStickerErrorType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){c=5e3;var h=new(d("WAWebLruCacheMap").LruCacheMap)({sizeLimit:c});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebMediaMmsV4Download").extractLottieJSON(b,a));if(b==null)return null;try{b=JSON.parse(b);if(!j(b))return null;h.set(a,b);return b}catch(a){d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")&&new(d("WAWebStickerErrorWamEvent").StickerErrorWamEvent)({stickerErrorType:d("WAWebWamEnumStickerErrorType").STICKER_ERROR_TYPE.RECEIVER_VALIDATION}).commit();return null}});return i.apply(this,arguments)}function j(a){var b=["v","ip","op","layers","fr","w","h"];return b.every(function(b){return Object.prototype.hasOwnProperty.call(a,b)})}g.InMemoryLottieStickerCache=h;g.extractAndSetLottieJSONInMemoryCache=a}),98);
__d("WAWebMediaInMemoryBlobCache",["WALogger","WALruCache","WAWebMediaStorage","WAWebMediaTypes","err","lodash"],(function(a,b,c,d,e,f,g){var h,i=25e7;a=function(){function a(a){var b=this;a===void 0&&(a=i);this.$4=new Set();this.$5=new Set();this.getOrCreateURL=function(a){if(b.$3[a]){b.touch(a);return b.$3[a]}var d=b.get(a);if(!d)throw c("err")("There is no blob matching filehash: "+a+".");d=window.URL.createObjectURL(d);b.$3[a]=d;return d};this.revokeURL=function(a,d){if(!d)return;if(b.$3[a]!==d)throw c("err")("The url provided does not match the filehash.");delete b.$3[a];window.URL.revokeObjectURL(d)};this.$8=c("lodash").throttle(function(){b.$4.forEach(function(a){window.URL.revokeObjectURL(b.$3[a]),delete b.$3[a]}),b.$4.clear()},0,{leading:!1});if(a!=null&&a<0)throw c("err")("Size limit cannot be a negative number.");this.$2={};this.$3={};this.$1=new(d("WALruCache").LruCache)({sizeLimit:a,getSize:function(a){return a.size},onEvict:function(a,c){b.$3[a]&&b.$6(a)===0&&(b.revokeURL(a,b.$3[a]),d("WAWebMediaStorage").getOrCreateMediaObject(a).consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.INIT,progressiveStage:null}))},shouldEvict:function(a,c){return b.$6(a)===0}})}var b=a.prototype;b.get=function(a){return this.$1.get(a)};b.has=function(a){return this.$1.has(a)};b.touch=function(a){this.get(a)};b.put=function(a,b){this.$1.put(a,b),this.$7()};b["delete"]=function(a){this.$1["delete"](a),this.$7()};b.clear=function(){var a=this;this.$8.flush();this.$2={};Object.keys(this.$3).forEach(function(b){a.$3[b]&&a.revokeURL(b,a.$3[b])});this.$3={};this.$1.clear()};b.increaseUsageCount=function(a){this.$2[a]=this.$6(a)+1,this.$4["delete"](a)};b.decreaseUsageCount=function(a){var b=this.$6(a);if(b<=0){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["InMemoryMediaBlobCache: Cannot decrease the usageCount to a negative number."]))).tags("media-in-memory-blob-cache").sendLogs("media-blob-cache-usage-count-negative-number");return}this.$2[a]=b-1;this.$2[a]===0&&(delete this.$2[a],this.$4.add(a),this.$8())};b.$6=function(a){return this.$2[a]||0};b.$7=function(){this.$5.forEach(function(a){return a()})};b.subscribe=function(a){var b=this;this.$5.add(a);return function(){b.$5["delete"](a)}};b.getBlobCacheSnapshot=function(a){return this.has(a)};return a}();b=new a();g.InMemoryMediaBlobCacheImpl=a;g.InMemoryMediaBlobCache=b}),98);
__d("WAWebCheckMediaExistence",["WALogger","WAWebMediaMmsV4Download","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.waitForPhoneUpload();if(!a.mediaObject){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["checkExistence msg without mediaObject, id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: checkExistence msg without mediaObject");return}yield d("WAWebMediaMmsV4Download").checkExistence({mimetype:a.mimetype,mediaObject:a.mediaObject,mediaType:d("WAWebMmsMediaTypes").getMsgMediaType(a)})});return i.apply(this,arguments)}g.checkMediaExistence=a}),98);
__d("WAWebClearMediaForChat",["WAWebMediaStorage"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebMediaStorage").clearMediaForChat(a)}g.clearMediaForChat=a}),98);
__d("WAWebConsolidateMediaUpdate",["WALogger","WAWebMediaCryptoEligibilityUtils","WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMediaObject","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebMsgType"],(function(a,b,c,d,e,f,g){var h,i;function j(a){var b={};d("WAWebMediaTypes").MAPPED_MSG_PROPS.forEach(function(c){var e=a[c];c=d("WAWebMediaTypes").MSG_TO_MEDIA[c];b[c]=e});if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE){var c=d("WAWebMediaObject").getInteractiveMsgMediaType(a);c&&(b.type=c)}return b}function a(a,b){if(a.isUnsentPhoneMsg()){a.mediaObject&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: consolidateMediaUpdate unsent message");var e=j(a);if(Object.prototype.hasOwnProperty.call(e,"preview")){var f=e.preview;delete e.preview;f&&c("WAWebMediaOpaqueData").createFromBase64Jpeg(f).then(function(b){a!=null&&a.mediaData&&a.isUnsentPhoneMsg()&&(a.mediaData.preview=b)})}a.mediaData.set(babelHelpers["extends"]({},e,{mediaStage:d("WAWebMediaTypes").MediaDataStage.REMOTE_NEED_UPLOAD}))}else k(a,a,b)}function k(a,b,e,f){var g=j(b),h=a.mediaObject,k=b.filehash,l=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(a);if(!h){k?h=d("WAWebMediaStorage").getOrCreateMediaObject(k):h=new(d("WAWebMediaObject").MediaObject)();var m=a.mediaData;m.aspectRatio!==void 0&&(g.aspectRatio=m.aspectRatio);a.mediaObject=h;d("WAWebMediaStorage").associateMediaWithMsg(h,a)}else k&&k!==h.filehash&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["media:msg "," "," filehash"])),a.id.toString(),h.filehash?"changed":"added"),d("WAWebMediaStorage").disassociateMediaFromMsg(h,a),h=d("WAWebMediaStorage").getOrCreateMediaObject(k),a.mediaObject=h,d("WAWebMediaStorage").associateMediaWithMsg(h,a));m=!1;var n=b.deprecatedMms3Url,o=b.mediaKey,p=b.mediaKeyTimestamp,q=b.encFilehash,r=b.type,s=b.streamingSidecar,t=b.firstFrameSidecar,u=b.directPath,v=b.scansSidecar,w=b.scanLengths,x=b.staticUrl;if(n||q||!l){var y;try{y=d("WAWebMmsMediaTypes").msgToMediaType({type:b.type,isGif:b.isGif,interactiveHeader:b.interactiveHeader,isNewsletter:d("WAWebMsgGetters").getIsNewsletterMsg(b)})}catch(a){y=~d("WAWebMmsMediaTypes").MEDIA_TYPE_VALUES.indexOf(r)?r:null}m=l?!h.entries.has({encFilehash:q,deprecatedMms3Url:n}):!h.entries.hasUnencryptedEntry({filehash:k,directPath:u});var z;!m?l&&o!=null&&o!==""?z=h.entries.updateEntry({deprecatedMms3Url:n,mediaKey:o,mediaKeyTimestamp:p,encFilehash:q,type:y,sidecar:s,directPath:u,firstFrameSidecar:t,scansSidecar:v,scanLengths:w,staticUrl:x}):!l&&k!=null&&(z=h.entries.updateUnencryptedEntry({filehash:k,directPath:u})):y!=null&&(q!=null||!l)?l&&o!=null?z=h.entries.addEntry({deprecatedMms3Url:n,mediaKey:o,mediaKeyTimestamp:p,encFilehash:q,type:y,sidecar:s,directPath:u,firstFrameSidecar:t,scansSidecar:v,scanLengths:w,debugHint:"consolidate",staticUrl:x}):!l&&u!=null&&k!=null&&(z=h.entries.addUnencryptedEntry({debugHint:"consolidate",directPath:u,filehash:k,type:y})):m=!1;z||(m=!1);m&&h.downloadStage===d("WAWebMediaTypes").DownloadStage.ERROR_MISSING&&(g.downloadStage=d("WAWebMediaTypes").DownloadStage.INIT)}h.consolidate(g)||h.notifyMsgsAsync();if(m&&h.downloadStage===d("WAWebMediaTypes").DownloadStage.NEED_POKE){var A;try{A=d("WAWebMmsMediaTypes").getMsgMediaType(a)}catch(c){if(!b.type)throw c;A=d("WAWebMmsMediaTypes").msgToMediaType({type:b.type,isGif:a.isGif,isNewsletter:d("WAWebMsgGetters").getIsNewsletterMsg(a)})}d("WAWebMediaMmsV4Download").downloadMedia({mimetype:b.mimetype,mediaObject:h,downloadEvenIfExpensive:!1,mediaType:A,rmrReason:e,downloadOrigin:c("WAWebMediaGetDownloadOriginForMsg")(a),chatWid:f})}}g.consolidateMediaUpdate=a;g.consolidateMediaUpdateWithValues=k}),98);
__d("WAWebDownloadProgressiveJpegThumbnail",["WAAbortError","WALogger","WANullthrows","WAWebDownloadManager","WAWebMediaOpaqueData","WAWebMmsMediaTypes","WAWebSerializeError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg,e=a.chat,f=a.isPreload;a=a.signal;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: start"])));try{var g,l=(g=c("WANullthrows"))(b.scanLengths),m=g(b.scansSidecar),n=g(b.mediaObject);g=g(n.filehash);var o=b.encFilehash,p=b.directPath;p=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:p,encFilehash:o,filehash:g,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp,type:d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,signal:a||new AbortController().signal,userDownloadAttemptCount:0,progressiveJpegOpts:{mimetype:"image/jpeg",scansSidecar:m,scanLengths:l,scanCount:1},isPreload:f,chatWid:e==null?void 0:e.id}));n.consolidate({fullPreviewData:yield c("WAWebMediaOpaqueData").createFromData(p,"image/jpeg")});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: success"])))}catch(a){if(a.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail aborted"])));return}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media.downloadProgressiveJpegThumbnail: error\n",""],["media.downloadProgressiveJpegThumbnail: error\\n",""])),c("WAWebSerializeError")(a)).sendLogs("download-pjpeg-thumbnail-failed")}});return l.apply(this,arguments)}g.downloadProgressiveJpegThumbnail=a}),98);
__d("WAWebDownloadStatusThumbnail",["WAWebDownloadProgressiveJpegThumbnail","WAWebMediaDownloadMmsThumbnail","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg,e=a.isPreload;a=a.signal;var f=b.encFilehash,g=b.thumbnailSha256,h=b.thumbnailEncSha256,i=b.thumbnailDirectPath;if(b.type===d("WAWebMsgType").MSG_TYPE.IMAGE&&b.scanLengths&&b.scansSidecar&&f){yield d("WAWebDownloadProgressiveJpegThumbnail").downloadProgressiveJpegThumbnail({msg:b,signal:a,isPreload:e});return}if(g&&h&&i){yield c("WAWebMediaDownloadMmsThumbnail")({msg:b,signal:a,isPreload:e,chat:null});return}});return h.apply(this,arguments)}g.downloadStatusThumbnail=a}),98);
__d("WAWebDownloadVideoThumbnail",["WALogger","WANullthrows","WAWebDownloadManager","WAWebImageUtils","WAWebMediaConstants","WAWebMediaCryptoEligibilityUtils","WAWebMediaOpaqueData","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebMsgModelPropUtils","WAWebSerializeError","WAWebURLUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg;a=a.chat;if(!d("WAWebMsgModelPropUtils").isTrusted(b.unsafe()))return;if(a.isSuspendedOrTerminated())return;var e=b.encFilehash,f=b.filehash,g=b.directPath;if(!f||!g)return;if(d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(b)&&!e)return;var l=b.mediaData,m=l.fullPreviewData,n=l.fullWidth;l=l.fullHeight;if(m&&n!=null&&l!=null)return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: start"])));try{m=Math.max(parseInt(b.mediaData.duration,10),1);n={video:{size:b.mediaData.size,duration:m},secondsToDownload:1};l=(yield d("WAWebDownloadManager").downloadManager.downloadAndMaybeDecrypt({directPath:g,encFilehash:e,filehash:f,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp,type:d("WAWebMsgGetters").getIsNewsletterMsg(b)?d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO,signal:new AbortController().signal,userDownloadAttemptCount:0,partialVideoOpts:n,isPreload:!0,chatWid:a.id}));m=new Blob([l],{type:"video/mp4"});g=(yield d("WAWebImageUtils").generateVideoThumbsAndDuration({file:m,maxDimensions:[d("WAWebMediaConstants").VIDEO_THUMB_MAX_EDGE],debugHint:"downloadVideoThumbnail",throwOnBlack:!0}));e=g.thumbs;f=e[0];n=(yield c("WAWebMediaOpaqueData").createFromBase64Jpeg(c("WAWebURLUtils").parseDataURL(f.url).data));a=c("WANullthrows")(b.mediaObject,"mediaObject cannot be null for thumbnail download");l={fullPreviewData:n,fullWidth:f.fullWidth,fullHeight:f.fullHeight};a.consolidate(l);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: success"])))}catch(a){if(a instanceof d("WAWebImageUtils").BlackVideoThumbnailError){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: black thumbnail was generated, fallback to blurred thumbnail"])));return}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media.downloadVideoThumbnail: error\n",""],["media.downloadVideoThumbnail: error\\n",""])),c("WAWebSerializeError")(a)).verbose()}});return l.apply(this,arguments)}g.downloadVideoThumbnail=a}),98);
__d("WAWebManuallySetMedia",["WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMediaOpaqueData","WAWebMmsMediaTypes"],(function(a,b,c,d,e,f,g){function a(a){var b=a.msg,e=a.media,f=a.rmrReason,g=a.chatWid,h=b.mediaObject;if(!h)return;c("WAWebMediaOpaqueData").createFromData(e,b.mimetype).then(function(a){d("WAWebMediaMmsV4Download").manuallySetMedia({mimetype:b.mimetype,mediaObject:h,mediaBlob:a,mediaType:d("WAWebMmsMediaTypes").getMsgMediaType(b),rmrReason:f,downloadOrigin:c("WAWebMediaGetDownloadOriginForMsg")(b),chatWid:g})})}g.manuallySetMedia=a}),98);
__d("WAWebMediaCancelDownloadMsg",["WALogger","WAWebMediaMmsV4Download"],(function(a,b,c,d,e,f,g){var h;function i(a){d("WAWebMediaMmsV4Download").cancelDownloadMedia(a)}function a(a){a.mediaObject?i(a.mediaObject):a.mediaObject||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: cancelDownloadMsg msg without mediaObject")}g.cancelDownloadMedia=i;g.cancelDownloadMsg=a}),98);
__d("WAWebMediaCancelUploadMsg",["WALogger","WAWebMediaMmsV4Upload"],(function(a,b,c,d,e,f,g){var h;function i(a){d("WAWebMediaMmsV4Upload").cancelUploadMedia(a)}function a(a){a.mediaObject?i(a.mediaObject):d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: cancelUploadMsg msg without mediaObject")}g.cancelUploadMedia=i;g.cancelUploadMsg=a}),98);
__d("WAWebMediaDownloadMsg",["Promise","WALogger","WAWebMediaGetDownloadOriginForMsg","WAWebMediaMmsV4Download","WAWebMmsMediaTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var e=a.msg,f=a.isUserClick,g=a.mode,j=a.downloadEvenIfExpensive,k=a.rmrReason,l=a.rmrData,m=a.isAutoDownload,n=a.chatWid,o=a.shouldSequenceDownload,p=e.mediaObject;if(p){a=p.getPendingProcess("fromDisk");return a.then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){f&&p.userDownloadAttemptCount++,yield d("WAWebMediaMmsV4Download").downloadMedia({mimetype:e.mimetype,mediaObject:p,downloadEvenIfExpensive:j,mediaType:d("WAWebMmsMediaTypes").getMsgMediaType(e),rmrReason:k,rmrData:l,downloadOrigin:c("WAWebMediaGetDownloadOriginForMsg")(e),isVcardOverMmsDocument:e.isVcardOverMmsDocument,mode:g,isAutoDownload:m,isViewOnce:Boolean(e.isViewOnce),chatWid:n,shouldSequenceDownload:o}),p.userDownloadAttemptCount=0}))}d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),e.id.toString(),e.type).devConsole(e).sendLogs("media-fault: downloadMsg msg without mediaObject");return(i||(i=b("Promise"))).resolve()}g.downloadMsg=a}),98);
__d("WAWebMediaFastForwardUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.id;return!b.isPSA()&&!b.isCAPISupportAccount()&&!b.isBot()&&!b.isHosted()&&!b.isNewsletter()&&!a.isEnterprise}f.canEnableFastForward=a}),66);
__d("WAWebWamEnumStickerSendMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:1,PAYMENTS:2});f.STICKER_SEND_MESSAGE_TYPE=a}),66);
__d("WAWebWamEnumStickerSendOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({STICKER_SEARCH:1,FORWARD:2,STICKER_PICKER_TAB_RECENTS:3,STICKER_PICKER_TAB_FAVORITES:4,STICKER_PICKER_TAB_EMOTION:5,STICKER_PICKER_TAB_PACK:6,STICKER_PICKER_TAB_CONTEXTUAL_SUGGESTIONS:7,STICKER_MAKER:8,STICKER_STORE:9,AI_STICKER_CREATE:10,AI_STICKER_CREATE_TRAY:11,AI_STICKER_CREATE_CHAT:12,STATUS_QUICK_REPLY:13,DISCOVERY_PACK:14,STICKER_FROM_DEVICE_KEYBOARD:15,STICKER_PACK_INFO:16,CONVERSATION_STARTER:17,STICKER_SEARCH_TRENDING:18});f.STICKER_SEND_ORIGIN_TYPE=a}),66);
__d("WAWebStickerSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumStickerMakerSourceType","WAWebWamEnumStickerSendMessageType","WAWebWamEnumStickerSendOriginType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({StickerSend:[1840,{stickerIsAi:[7,a.TYPES.BOOLEAN],stickerIsAnimated:[3,a.TYPES.BOOLEAN],stickerIsAvatar:[6,a.TYPES.BOOLEAN],stickerIsFirstParty:[2,a.TYPES.BOOLEAN],stickerIsFromStickerMaker:[5,a.TYPES.BOOLEAN],stickerIsFromUserCreatedPack:[12,a.TYPES.BOOLEAN],stickerIsGiphy:[10,a.TYPES.BOOLEAN],stickerIsKlipy:[13,a.TYPES.BOOLEAN],stickerIsLottie:[9,a.TYPES.BOOLEAN],stickerIsTenor:[11,a.TYPES.BOOLEAN],stickerIsText:[14,a.TYPES.BOOLEAN],stickerMakerSourceType:[8,d("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE],stickerSendMessageType:[4,d("WAWebWamEnumStickerSendMessageType").STICKER_SEND_MESSAGE_TYPE],stickerSendOrigin:[1,d("WAWebWamEnumStickerSendOriginType").STICKER_SEND_ORIGIN_TYPE]},[1,1,1],"regular"]},{StickerSend:[]});g.StickerSendWamEvent=b}),98);
__d("WAWebMediaForwardMediaMsg",["Promise","WALogger","WAWebABProps","WAWebFrontendMsgGetters","WAWebGetNewsletterContextForForwardedMsg","WAWebMediaFastForwardUtils","WAWebMediaOpaqueData","WAWebMediaPrep","WAWebMediaTypes","WAWebMsgGetters","WAWebStickerSendWamEvent","WAWebWamEnumStickerSendOriginType","WAWebWebpMetadata","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){f===void 0&&(f=!1);g===void 0&&(g=!1);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Prepping media msg"]))).devConsole(a);var k=a.mediaObject;if(!k){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: forwardMediaMsg msg without mediaObject");return(j||(j=b("Promise"))).reject(c("err")("non initialized media"))}var l=a.mediaData.toJSON();l.preview!=null&&(l.preview=k.contentInfo._preview);l.mediaBlob instanceof c("WAWebMediaOpaqueData")&&l.mediaBlob.retain();k={mimetype:l.mimetype};k=l.isGif?babelHelpers["extends"]({},k,{isGif:!0}):k;l.type===d("WAWebMediaTypes").OUTWARD_TYPES.PTT&&!d("WAWebMsgGetters").getHasOriginatedFromNewsletter(a)&&(l.type=d("WAWebMediaTypes").OUTWARD_TYPES.AUDIO);var m={businessOwnerJid:a.businessOwnerJid,productId:a.productId,currencyCode:a.currencyCode,priceAmount1000:a.priceAmount1000,salePriceAmount1000:a.salePriceAmount1000,retailerId:a.retailerId,url:a.url,productImageCount:a.productImageCount,title:a.title,description:a.description},n=l.type===d("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT&&(a.isFromTemplate||a.isDynamicReplyButtonsMsg);n=n||l.type===d("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT?a.caption:void 0;g&&(l.type===d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE||l.type===d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO||l.type===d("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT||l.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK)&&(n=a.caption);g=d("WAWebMediaFastForwardUtils").canEnableFastForward(e.contact);var o=d("WAWebMediaFastForwardUtils").canEnableFastForward(d("WAWebFrontendMsgGetters").getChat(a).contact);f={forwardedFromWeb:!0,canEnableFastForward:g&&o,caption:n,type:a.type,mentionedJidList:a.mentionedJidList,groupMentions:a.groupMentions,footer:l.type===d("WAWebMediaTypes").OUTWARD_TYPES.PRODUCT?a.footer:void 0,addEvenWhilePreparing:!0,placeholderProps:k,isForwarded:d("WAWebMsgGetters").getShouldDisplayAsForwarded(a),forwardingScore:a.getForwardingScoreWhenForwarded(),multicast:f,productMsgOptions:m,isAvatar:(g=a.isAvatar)!=null?g:!1,forwardedNewsletterMessageInfo:d("WAWebGetNewsletterContextForForwardedMsg").getNewsletterContextForForwardedMsg(a),stickers:(o=a.stickers)!=null?o:void 0,publisher:(n=a.stickerPackPublisher)!=null?n:void 0,fileLength:(k=a.size)!=null?k:void 0,description:l.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK&&a.description!=null?a.description:"",stickerPackId:(f=a.stickerPackId)!=null?f:void 0,thumbnailDirectPath:(m=a.thumbnailDirectPath)!=null?m:void 0,thumbnailSha256:(g=a.thumbnailSha256)!=null?g:void 0,thumbnailEncSha256:(o=a.thumbnailEncSha256)!=null?o:void 0,trayIconFileName:(n=a.trayIconFileName)!=null?n:void 0,stickerPackSize:(k=a.stickerPackSize)!=null?k:void 0};m=(yield new(d("WAWebMediaPrep").MediaPrep)(l.type,(j||(j=b("Promise"))).resolve(l)).sendToChat(e,d("WAWebGetNewsletterContextForForwardedMsg").maybeStripNewsletterForwardMetadata({forwardable:f,destination:e.id,source:a.id.remote,isOriginalMsgForwarded:a.isForwarded,isQuestionOrQuestionReply:a.isQuestion||a.questionReplyQuotedMessage!=null})));if(l.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER){k={stickerSendOrigin:d("WAWebWamEnumStickerSendOriginType").STICKER_SEND_ORIGIN_TYPE.FORWARD,stickerIsAnimated:Boolean((g=a.mediaData)==null?void 0:g.isAnimated),stickerIsFirstParty:Boolean((o=a.mediaData)==null?void 0:o.isFirstParty),stickerIsFromStickerMaker:Boolean((n=a.mediaData)==null?void 0:n.isFromStickerMaker)};if(d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_logging_enabled")){k=babelHelpers["extends"]({},k,{stickerIsLottie:Boolean((f=a.mediaData)==null?void 0:f.isLottie)})}e=new(d("WAWebStickerSendWamEvent").StickerSendWamEvent)(k);g=d("WAWebWebpMetadata").getStickerMakerSourceType((l=a.mediaData)==null?void 0:l.stickerMakerSourceType);g!=null&&(e.stickerMakerSourceType=g);e.commit()}return m});return k.apply(this,arguments)}g.forwardMediaMsg=a}),98);
__d("WAWebMediaGetDownloadOriginForMsg",["WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebWamEnumDownloadOriginType"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebFrontendMsgGetters").getAsProduct(a))return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.PRODUCT_CATALOG;if(d("WAWebMsgGetters").getIsStatus(a))return d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.STATUS_USER;if(d("WAWebMsgGetters").getIsGroupMsg(a)){var b=d("WAWebFrontendMsgGetters").getChat(a);return b!=null&&d("WAWebFrontendChatGetters").getIsCAG(b)?d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.COMMUNITY:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_GROUP}return d("WAWebMsgGetters").getIsNewsletterMsg(a)?d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHANNEL:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.CHAT_PERSONAL}g["default"]=a}),98);
__d("WAWebMediaMsgRegistration",["Promise","WALogger","WAWebConsolidateMediaUpdate","WAWebMediaDataUtils","WAWebMediaOpaqueData","WAWebMediaStorage","WAWebMediaTypes","WAWebWamEnumWebcRmrReasonCode"],(function(a,b,c,d,e,f,g){var h,i,j="change:ack "+d("WAWebMediaTypes").MEDIA_MSG_PROPS.map(function(a){return"change:"+a}).join(" ");function k(a){d("WAWebConsolidateMediaUpdate").consolidateMediaUpdate(a,d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_UPDATE)}function a(a){a.off(null,k);var b=a.mediaObject;b&&d("WAWebMediaStorage").disassociateMediaFromMsg(b,a)}function e(a){!a.mimetype&&a.type===d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE&&(a.mimetype="image/jpeg"),!a.mimetype&&a.type===d("WAWebMediaTypes").OUTWARD_TYPES.STICKER&&(a.mimetype="image/webp"),a.on(j,k),d("WAWebConsolidateMediaUpdate").consolidateMediaUpdate(a,d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_INIT)}function f(a,b){a.isUnsentPhoneMsg()&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: registerMsgEarly msg without mediaObject");var c={};for(var e=0;e<d("WAWebMediaTypes").MEDIA_MSG_PROPS.length;e++){var f=d("WAWebMediaTypes").MEDIA_MSG_PROPS[e],g=b[f];c[f]=g!==void 0?g:a[f]}!c.mimetype&&c.type===d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE&&(b.mimetype=c.mimetype="image/jpeg");a.on(j,k);d("WAWebConsolidateMediaUpdate").consolidateMediaUpdateWithValues(a,c,d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_UPDATE);g={};for(f=0;f<d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS.length;f++){e=d("WAWebMediaTypes").MSG_SPECIFIC_FIELDS[f];g[e]=c[d("WAWebMediaTypes").MEDIA_TO_MSG[e]]}a.mediaData.set(g)}function l(a){var e=a.mediaObject;if(e)return e.resolveWhenConsolidated();e=a.mediaData;var f=e.preview;return f instanceof c("WAWebMediaOpaqueData")&&e.aspectRatio===void 0&&(e.fullWidth===void 0||e.fullHeight===void 0)?d("WAWebMediaDataUtils").getImageWidthHeight(f).then(function(b){var c=b.width;b=b.height;if(a.mediaObject)return;a.mediaData.set({aspectRatio:c/b})}):(i||(i=b("Promise"))).resolve()}g.deregisterMsg=a;g.registerMsg=e;g.registerMsgEarly=f;g.prepareMsg=l}),98);
__d("WAWebMediaResumeUploadMsg",["Promise","WALogger","WAWebAck","WAWebFrontendMsgGetters","WAWebMediaEntry","WAWebMediaGetUploadOriginForChat","WAWebMediaInMemoryKeyCache","WAWebMediaMmsV4Upload","WAWebMediaUpdateMsg","WAWebMmsMediaTypes","WAWebMsgGetters","WAWebNewsletterSendMsgAction","WAWebSendMsgChatAction","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var e,f=a.mediaObject;if(!f){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),a.id.toString(),a.type).devConsole(a).sendLogs("media-fault: resumeUploadMsg msg without mediaObject");return(i||(i=b("Promise"))).resolve()}f.userUploadAttemptCount++;var g=f.filehash;e=d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&g!=null?(e=d("WAWebMediaInMemoryKeyCache").MediaKeyCache.get(g))!=null?e:void 0:void 0;a.ack=d("WAWebAck").ACK.CLOCK;var j=d("WAWebMsgGetters").getIsNewsletterMsg(a)?d("WAWebMediaMmsV4Upload").uploadUnencryptedMedia:d("WAWebMediaMmsV4Upload").uploadMedia,k=j({mimetype:a.mimetype,mediaObject:f,mediaKeyInfo:e,mediaType:d("WAWebMmsMediaTypes").getMsgMediaType(a),forwardedFromWeb:Boolean(a.forwardedFromWeb),uploadOrigin:c("WAWebMediaGetUploadOriginForChat")(d("WAWebFrontendMsgGetters").getChat(a)),isViewOnce:Boolean(a.isViewOnce)}).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b.mediaEntry;d("WAWebMediaInMemoryKeyCache").shouldUseMediaKeyCache()&&g!=null&&d("WAWebMediaInMemoryKeyCache").MediaKeyCache["delete"](g);if(!b)throw c("err")("upload failed: media entry was not created");f.userUploadAttemptCount=0;var e={deprecatedMms3Url:b.deprecatedMms3Url,directPath:b.directPath,filehash:f.filehash,size:f.size,streamingSidecar:b.sidecar,firstFrameSidecar:b.firstFrameSidecar};b instanceof d("WAWebMediaEntry").EncryptedMediaEntry?(e.mediaKey=b.mediaKey,e.mediaKeyTimestamp=b.mediaKeyTimestamp,e.encFilehash=b.encFilehash):b instanceof d("WAWebMediaEntry").UnencryptedMediaEntry&&(e.mediaHandle=b.handle);yield c("WAWebMediaUpdateMsg")(a,e);return a});return function(a){return e.apply(this,arguments)}}());j=d("WAWebMsgGetters").getIsNewsletterMsg(a)?d("WAWebNewsletterSendMsgAction").sendNewsletterMediaMsg(d("WAWebFrontendMsgGetters").getChat(a),a,function(){return k}):d("WAWebSendMsgChatAction").resendMsgToChat(d("WAWebFrontendMsgGetters").getChat(a),k);return j["catch"](function(){a.ack=d("WAWebAck").ACK.FAILED})}g.resumeUploadMsg=a}),98);
__d("WAWebMediaStickers",["Promise","WAFilteredCatch","WALogger","WAWebDownloadManager","WAWebMediaEntry","WAWebMediaMmsV4Download","WAWebMediaPrep","WAWebMediaStorage","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsMediaTypes","WAWebRecentStickerCollectionMd","WAWebWamEnumDownloadOriginType","WAWebWamEnumWebcRmrReasonCode","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=125;function p(a){var b={};d("WAWebMediaTypes").MAPPED_STICKER_PROPS.forEach(function(c){var e=a[c];c=d("WAWebMediaTypes").MSG_TO_MEDIA[c];b[c]=e});return b}function q(a){if(!a.filehash){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unexpected sticker with no filehash"]))).devConsole(a).sendLogs("sticker-filehash-error");return}var b=d("WAWebMediaStorage").getOrCreateMediaObject(a.filehash);d("WAWebMediaStorage").associateMediaWithSticker(b,a);return b}function r(a){if(!a.filehash){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unexpected sticker pack with no filehash"]))).devConsole(a).sendLogs("sticker-pack-filehash-error");return}var b=d("WAWebMediaStorage").getOrCreateMediaObject(a.filehash);d("WAWebMediaStorage").associateMediaWithStickerPack(b,a);return b}function s(a,b,e,f){var g=p(a);a.mediaData.set(g);if(!b)return;a.mediaObject=b;var h=a.deprecatedMms3Url,i=a.encFilehash;!c("gkx")("26258")&&!i&&h&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encFileHash missing from sticker "," but deprecatedMms3Url exists"])),f?"pack tray icon":"").devConsole(a).sendLogs("sticker-"+(f?"icon-":"")+"missing-upload-hash-but-url-exists");if((i||h)&&!b.entries.has({encFilehash:i,deprecatedMms3Url:h})){f=b.entries.addEntry({deprecatedMms3Url:h,mediaKey:a.mediaKey,mediaKeyTimestamp:a.mediaKeyTimestamp,encFilehash:i,type:e,directPath:a.directPath,debugHint:"setMediaObjectValues"});f&&b.downloadStage===d("WAWebMediaTypes").DownloadStage.ERROR_MISSING&&(g.downloadStage=d("WAWebMediaTypes").DownloadStage.INIT)}b.consolidate(g)}function a(a){s(a,a.mediaObject||q(a),d("WAWebMmsMediaTypes").MEDIA_TYPES.STICKER,!1)}function e(a){var b=a.mediaObject;b&&d("WAWebMediaStorage").disassociateMediaFromSticker(b,a)}function f(a){s(a,a.mediaObject||r(a),d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE,!0)}function t(a){var b=a.mediaObject;b&&d("WAWebMediaStorage").disassociateMediaFromStickerPack(b,a)}function u(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){f===void 0&&(f=!0);if(a.isPlaceholder||a.isCreateButton){a.mediaData.mediaStage=d("WAWebMediaTypes").MediaDataStage.PREPARING;return(n||(n=b("Promise"))).resolve()}var g=a.mediaObject;if(!g)return(n||(n=b("Promise"))).reject(c("err")("media-fault: downloadStickerOrStickerPackIcon sticker/stickerPack without mediaObject"));var h=e==="STICKER"?d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.STICKER_PANEL_STICKER:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.STICKER_PANEL_ICON;e=!1;yield g.getPendingProcess("fromDisk").then(function(){if(!a.filehash||!a.mediaKey||!a.encFilehash){e=!0;return d("WAWebDownloadManager").downloadManager.rmr({mediaObject:g,signal:new AbortController().signal,rmrReason:h})}}).then(function(){return d("WAWebMediaMmsV4Download").downloadMedia({mimetype:a.mimetype,mediaObject:a.mediaObject,downloadEvenIfExpensive:!0,mediaType:d("WAWebMmsMediaTypes").msgToMediaType({type:a.type,isGif:!1,isNewsletter:!1}),rmrReason:h,downloadOrigin:d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE.STICKER_PICKER,shouldThrow:f})})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").RMRNotSupportedOnNewsletterMessagesError,function(b){if(b.mediaType!==d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unexpected RMR error for media type ",""])),b.mediaType).devConsole(a,b).sendLogs("failed-to-download-sticker-rmr");throw b}}));var i=g.entries.getDownloadEntry(!0);e&&i instanceof d("WAWebMediaEntry").EncryptedMediaEntry&&d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.updateStickerMediaData(a.filehash,i)});return v.apply(this,arguments)}function w(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Prepping sticker"]))).devConsole(a);var e=a.mediaObject,f=a.mediaData.toJSON();f.fullWidth=o;f.fullHeight=o;if(!e){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["id: ",""])),a.id).sendLogs("media-fault: prepSticker sticker without mediaObject");return new(d("WAWebMediaPrep").MediaPrep)(f.type,(n||(n=b("Promise"))).reject(c("err")("non initialized media")))}return new(d("WAWebMediaPrep").MediaPrep)(f.type,(n||(n=b("Promise"))).resolve(f))}g.registerSticker=a;g.deregisterSticker=e;g.registerStickerPackIcon=f;g.deregisterStickerPackIcon=t;g.downloadStickerOrStickerPackIcon=u;g.prepSticker=w}),98);
__d("WAWebPrepRawMedia",["Promise","WALogger","WAWebMediaPrep","WAWebMediaTypes","WAWebProcessRawMedia"],(function(a,b,c,d,e,f,g){var h,i;function a(a,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Prepping raw media"])));var e;c.isPtt===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.PTT:c.asDocument===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.DOCUMENT:c.asGif===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.VIDEO:c.isAudio===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.AUDIO:c.asSticker===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.STICKER:c.asStickerPack===!0?e=d("WAWebMediaTypes").OUTWARD_TYPES.STICKER_PACK:e=d("WAWebMediaTypes").OUTWARD_TYPES.UNKNOWN;var f=(i||(i=b("Promise"))).resolve(a).then(function(a){a.autoreleaseWhenPromiseCompletes(f);return d("WAWebProcessRawMedia").processRawMedia(a,c)});return new(d("WAWebMediaPrep").MediaPrep)(e,f)}g.prepRawMedia=a}),98);
__d("WAWebCryptoCalculateFilehash",["WALogger","WAMediaCalculateFilehash","WAWebFileUtils","WAWebMediaDataUtils","WAWebMediaOpaqueData"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a instanceof c("WAWebMediaOpaqueData")?d("WAWebMediaDataUtils").opaqueDataToArrayBuffer(a):d("WAWebFileUtils").blobToArrayBuffer(a);return b.then(function(a){return d("WAMediaCalculateFilehash").calculateFilehash(a)})["catch"](function(b){b={error:""+b,blobSize:a.size,isOpaqueData:a instanceof c("WAWebMediaOpaqueData")};d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["calculateFilehashFromBlob error. Debug:\n",""],["calculateFilehashFromBlob error. Debug:\\n",""])),JSON.stringify(b,null,2)).sendLogs("calculate-filehash-from-blob-error");return void 0})}g.calculateFilehashFromBlob=a}),98);
__d("WAWebCryptoImageStreamer",["Promise","WAAlignChunkLengthsToMultipleOfAesBlockSize","WAArrayBufferUtils","WAArrayBuffersConcat","WACrypto","WACryptoAesCbc","WACryptoHmac","WACryptoUtils","WACustomError","WALogger","WANullthrows","WATypedArraysConcat","WAWebMediaInMemoryBlobCache","WAWebPromiseQueue","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=function(a){function b(b){return a.call(this,"Chunk "+b+" does not match sidecar")||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("ChunkValidationError")),q=10,r=16,s=new Uint8Array([2,2]),t=new Uint8Array([255,217]);e=function(){function a(a){this._alignedScanLengths=[];this._increasingScanLengths=[];this._lastDecryptedChunk=0;this._promiseQueue=new(d("WAWebPromiseQueue").PromiseQueue)();this._downloadedBytes=new ArrayBuffer(0);var b=a.cryptoKeys,c=a.scanLengths,e=a.scansSidecar,f=a.filehash,g=a.mimetype,h=a.debugString;a=a.onProgressiveUpdate;this._cryptoKeys=b;this._scanLengths=c;this._scansSideCar=e;this._filehash=f;this._mimetype=g;this._nextChunkIV=(b=this._cryptoKeys)==null?void 0:b.iv;this._decryptedChunks=new Array(c.length);this._onProgressiveUpdate=a;this._debugString=h}var e=a.prototype;e.setCryptoKeys=function(a){this._cryptoKeys=a,this._nextChunkIV=a.iv};e._validateSidecar=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b===0&&(this._nextChunkIV=e.iv);e=e.macKey;var f=this._scansSideCar.slice(b*q,b*q+q),g=c("WANullthrows")(this._nextChunkIV);this._nextChunkIV=a.slice(0-r);g=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(g),new Uint8Array(a)]);a=(yield d("WACryptoHmac").hmacSha256(e,g,q));if(!d("WACryptoUtils").arrayBuffersEqual(a,f))throw new p(b)});function e(b,c,d){return a.apply(this,arguments)}return e}();e._cleanupCipherTextAndIV=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=a;var e=b===0,f=a.byteLength%r===0,g=!f;if(e)e=c.iv;else{b=this._increasingScanLengths[b-1];e=this._downloadedBytes.slice(b-r,b)}g&&(a=a.slice(0,a.byteLength-q));if(f){b=(yield u(a,c));return{cipherText:d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(a),new Uint8Array(b)]),iv:e}}return{cipherText:a,iv:e}});function c(b,c,d){return a.apply(this,arguments)}return c}();e._getLastFullyLoadedChunkIndex=function(a){var b=0;for(var c=0;c<this._alignedScanLengths.length;c++){b+=this._alignedScanLengths[c];if(a<b)return c}return this._alignedScanLengths.length};e._handleChunk=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){yield this._validateSidecar(a,b,c);a=(yield this._cleanupCipherTextAndIV(a,b,c));var e=a.cipherText;a=a.iv;c=(yield d("WACryptoAesCbc").aesCbcDecrypt(c.encKey,a,e));a=(yield d("WACrypto").removeEncryptedPadding(c,s.buffer));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer: [","] Successfully decrypted chunk "," of "," total"])),this._debugString,b+1,this._scanLengths.length).devConsole({filehash:this._filehash});return a});function c(b,c,d){return a.apply(this,arguments)}return c}();e._generateBlobFromFullyLoadedChunks=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield (o||(o=b("Promise"))).all(this._decryptedChunks.slice(0,a))),e=this._scanLengths.slice(0,a).reduce(function(a,b){return a+b},0);c=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,c.map(function(a){return new Uint8Array(a)})).slice(0,e);e=d("WACryptoUtils").arrayBuffersEqual(t.buffer,c.slice(-t.length).buffer)?c:d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[c,t]);c=[e];c=this._mimetype!=null?new Blob(c,{type:this._mimetype}):new Blob(c);var f=w(this._filehash,a);d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache.put(f,c);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer: [","] Generated progressive image using "," chunks of "," total"])),this._debugString,a,this._scanLengths.length).devConsole({filehash:this._filehash});(f=this._onProgressiveUpdate)==null||f.call(this,a);this._lastDecryptedChunk=a;return e.buffer});function c(b){return a.apply(this,arguments)}return c}();e._decryptFullyLoadedChunks=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){for(var e=0;e<c;e++)if(!this._decryptedChunks[e]){var f=e===0?0:this._increasingScanLengths[e-1];f=a.slice(f,f+this._alignedScanLengths[e]);yield (o||(o=b("Promise"))).all(this._decryptedChunks);this._decryptedChunks[e]||(this._decryptedChunks[e]=this._handleChunk(f,e,d))}});function c(b,c,d){return a.apply(this,arguments)}return c}();e.handleProgress=function(a,c){var e=this;return this._promiseQueue.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!e._alignedScanLengths.length){e._alignedScanLengths=d("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(e._scanLengths,a);for(var b=0;b<e._alignedScanLengths.length;b++){var f=e._alignedScanLengths[b];f=b===0?f:e._increasingScanLengths[b-1]+f;e._increasingScanLengths.push(f)}}f=typeof c==="string"?c.length:c.byteLength+e._downloadedBytes.byteLength;b=e._getLastFullyLoadedChunkIndex(f);f=e._cryptoKeys;if(b<=e._lastDecryptedChunk||f==null){e._downloadedBytes=d("WAArrayBuffersConcat").concatArrayBuffers(e._downloadedBytes,typeof c==="string"?yield d("WAArrayBufferUtils").largeStringToArrayBuffer(c.slice(e._downloadedBytes.byteLength)):c);return null}try{var g=typeof c==="string"?yield d("WAArrayBufferUtils").largeStringToArrayBuffer(c.slice(e._downloadedBytes.byteLength)):c;e._downloadedBytes=d("WAArrayBuffersConcat").concatArrayBuffers(e._downloadedBytes,g);yield e._decryptFullyLoadedChunks(e._downloadedBytes,b,f);return yield e._generateBlobFromFullyLoadedChunks(b)}catch(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error: ",""])),a.message).devConsole({error:a,filehash:e._filehash,scanLengths:e._scanLengths,scansSidecar:e._scansSideCar,mimetype:e._mimetype});g=a.message+", ["+e._debugString+"]"+("scanLengths length: "+e._scanLengths.length+", scansSidecar byteLength: "+e._scansSideCar.byteLength+".");a instanceof p?(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:chunk validation error: ",""])),g),d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:chunk validation error"]))).devConsole(a).tags("non-sad").sendLogs("ImageStreamer:chunk validation error",{sampling:.01})):(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error: ",""])),g),d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["ImageStreamer:handleProgress error"]))).devConsole(a).sendLogs("ImageStreamer:handleProgress error"))}}))};return a}();function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.encKey;b=(yield d("WACryptoAesCbc").aesCbcEncrypt(b,s,new Uint8Array(a.slice(0-r))));return b.slice(0-r)});return v.apply(this,arguments)}function w(a,b){return a+"-progressive-"+b}function a(a,b){if(b!=null&&Number.isInteger(b)){b=b;while(b>0)d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache["delete"](w(a,b)),b--}d("WAWebMediaInMemoryBlobCache").InMemoryMediaBlobCache["delete"](a)}g.EOI_TAG=t;g.ImageStreamer=e;g.getProgressiveMediaCacheKey=w;g.deleteFromInMemoryMediaBlobCache=a}),98);
__d("WAWebDownloadAndDecryptCache",["WALogger","WAWebMediaDataUtils","WAWebMediaStore","WAWebSerializeError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){var b,c;b=(b=a.progressiveJpegOpts)==null?void 0:b.scanCount;c=(c=a.progressiveJpegOpts)==null?void 0:c.scanLengths;if(b!=null&&!!c)return a.filehash+"-"+b+"/"+c.length+"-scans";else if(a.partialVideoOpts){b=a.partialVideoOpts.secondsToDownload;return a.filehash+"-"+b+"-seconds"}return a.filehash}a=function(){function a(){}var e=a.prototype;e.get=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebMediaDataUtils").shouldUseLruMediaStore(b.type))return null;try{return yield d("WAWebMediaStore").LruMediaStore.get(j(b))}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.asyncCache.get error:\n",""],["downloadManager.asyncCache.get error:\\n",""])),c("WAWebSerializeError")(a)).verbose();return null}});function e(b,c){return a.apply(this,arguments)}return e}();e.set=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!d("WAWebMediaDataUtils").shouldUseLruMediaStore(e.type))return;try{yield d("WAWebMediaStore").LruMediaStore.put(j(e),b)}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.asyncCache.set error:\n",""],["downloadManager.asyncCache.set error:\\n",""])),c("WAWebSerializeError")(a)).verbose()}});function e(b,c,d){return a.apply(this,arguments)}return e}();return a}();g.getLRUStoreKey=j;g.DownloadAndDecryptCache=a}),98);
__d("WAWebWamEnumAiFetchMediaType",[],(function(a,b,c,d,e,f){a=Object.freeze({IMAGE_SINGLE:1,GRID_HIGH_RES:2,GRID_LOW_RES:3,INLINE_HIGH_RES:4,INLINE_LOW_RES:5});f.AI_FETCH_MEDIA_TYPE=a}),66);
__d("WAWebWamEnumDownloadQualityType",[],(function(a,b,c,d,e,f){a=Object.freeze({NORMAL_QUALITY:1,MID_QUALITY:2,INELIGIBLE_IMAGE_TOO_SMALL:3,INELIGIBLE_PARTIAL_HASHES_NOT_FOUND:4,ERROR_DETERMINING_ELIGIBILITY:5,NOT_DOWNLOADED_ENOUGH_BYTES_TO_DETERMINE_ELIGIBILITY:6});f.DOWNLOAD_QUALITY_TYPE=a}),66);
__d("WAWebWamEnumExpressPathDownloadState",[],(function(a,b,c,d,e,f){a=Object.freeze({PARTIAL_OR_NONE:1,FULL:2,MEDIANOTIFY_RECEIVED_EP_DISABLED:3,SKIPPED_DIFF_POP:4,SKIPPED_AUTODOWNLOAD:5});f.EXPRESS_PATH_DOWNLOAD_STATE=a}),66);
__d("WAWebMediaDownload2WamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAiFetchMediaType","WAWebWamEnumBackendStoreType","WAWebWamEnumConnectionType","WAWebWamEnumDownloadOriginType","WAWebWamEnumDownloadQualityType","WAWebWamEnumExpressPathDownloadState","WAWebWamEnumHttpProtocolVersionType","WAWebWamEnumMediaDownloadModeType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumMediaType","WAWebWamEnumNetworkStackType","WAWebWamEnumPairedMediaType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MediaDownload2:[1590,{activeThreadCount:[55,a.TYPES.INTEGER],aiFetchMediaType:[62,d("WAWebWamEnumAiFetchMediaType").AI_FETCH_MEDIA_TYPE],appContext:[64,a.TYPES.STRING],appContextBitfield:[65,a.TYPES.INTEGER],clientMessageId:[50,a.TYPES.STRING],connectionType:[31,d("WAWebWamEnumConnectionType").CONNECTION_TYPE],daysSinceReceive:[46,a.TYPES.INTEGER],debugMediaException:[24,a.TYPES.STRING],debugMediaIp:[22,a.TYPES.STRING],debugUrl:[23,a.TYPES.STRING],deviceCount:[49,a.TYPES.INTEGER],downloadBytesTransferred:[20,a.TYPES.NUMBER],downloadConnectT:[15,a.TYPES.TIMER],downloadHttpCode:[18,a.TYPES.INTEGER],downloadIsReuse:[17,a.TYPES.BOOLEAN],downloadIsStreaming:[19,a.TYPES.BOOLEAN],downloadNetworkT:[16,a.TYPES.TIMER],downloadQuality:[37,d("WAWebWamEnumDownloadQualityType").DOWNLOAD_QUALITY_TYPE],downloadResumePoint:[14,a.TYPES.INTEGER],downloadTimeToFirstByteT:[21,a.TYPES.TIMER],estimatedBandwidth:[36,a.TYPES.NUMBER],estimatedBandwidthV2:[59,a.TYPES.NUMBER],expressPathBytesSaved:[42,a.TYPES.NUMBER],expressPathDownloadState:[56,d("WAWebWamEnumExpressPathDownloadState").EXPRESS_PATH_DOWNLOAD_STATE],expressPathTimeSavedMs:[43,a.TYPES.TIMER],fileHeight:[47,a.TYPES.INTEGER],fileWidth:[48,a.TYPES.INTEGER],hasLeveragedExpressPath:[44,a.TYPES.BOOLEAN],httpProtocolVersionType:[45,d("WAWebWamEnumHttpProtocolVersionType").HTTP_PROTOCOL_VERSION_TYPE],isProcessedVideo:[58,a.TYPES.BOOLEAN],isSenderPlatformCapi:[52,a.TYPES.BOOLEAN],isViewOnce:[41,a.TYPES.BOOLEAN],maxThreadCount:[57,a.TYPES.INTEGER],mediaId:[38,a.TYPES.INTEGER],networkStack:[30,d("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE],overallAttemptCount:[4,a.TYPES.INTEGER],overallBackendStore:[39,d("WAWebWamEnumBackendStoreType").BACKEND_STORE_TYPE],overallConnBlockFetchT:[10,a.TYPES.TIMER],overallConnectionClass:[29,a.TYPES.STRING],overallCumT:[27,a.TYPES.TIMER],overallCumUserVisibleT:[60,a.TYPES.TIMER],overallCumV2T:[53,a.TYPES.TIMER],overallDecryptT:[12,a.TYPES.TIMER],overallDomain:[5,a.TYPES.STRING],overallDownloadMode:[11,d("WAWebWamEnumMediaDownloadModeType").MEDIA_DOWNLOAD_MODE_TYPE],overallDownloadOrigin:[35,d("WAWebWamEnumDownloadOriginType").DOWNLOAD_ORIGIN_TYPE],overallDownloadResult:[25,d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE],overallFileValidationT:[13,a.TYPES.TIMER],overallIsEncrypted:[28,a.TYPES.BOOLEAN],overallIsFinal:[26,a.TYPES.BOOLEAN],overallMediaSize:[7,a.TYPES.NUMBER],overallMediaType:[1,d("WAWebWamEnumMediaType").MEDIA_TYPE],overallMmsVersion:[6,a.TYPES.INTEGER],overallQueueT:[9,a.TYPES.TIMER],overallRetryCount:[3,a.TYPES.INTEGER],overallT:[8,a.TYPES.TIMER],overallUserVisibleT:[61,a.TYPES.TIMER],pairedMediaType:[63,d("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],prefetchOrder:[66,a.TYPES.INTEGER],sleepModeAffected:[51,a.TYPES.BOOLEAN],statusId:[67,a.TYPES.STRING],timeDelayed:[54,a.TYPES.TIMER],usedFallbackHint:[40,a.TYPES.STRING]},[1,1,50],"regular"]},{MediaDownload2:[]});g.MediaDownload2WamEvent=b}),98);
__d("WAWebCreateMediaDownloadMetrics",["WATimeUtils","WAWebABProps","WAWebAppTracker","WAWebMediaDownload2WamEvent","WAWebMmsDownloadUploadCrashLogger","WAWebMmsMediaTypes","WAWebWamEnumConnectionType","WAWebWamEnumMediaDownloadResultType","WAWebWamEnumNetworkStackType","WAWebWamGroupMetricCache","WAWebWamMediaMetricUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=d("WAWebWamMediaMetricUtils").generateMediaEventId(),e=new(d("WAWebMediaDownload2WamEvent").MediaDownload2WamEvent)({mediaId:c,connectionType:d("WAWebWamEnumConnectionType").CONNECTION_TYPE.HOSTNAME,overallMediaType:d("WAWebWamMediaMetricUtils").getMetricMediaType(a.type),overallMmsVersion:4,networkStack:d("WAWebWamEnumNetworkStackType").NETWORK_STACK_TYPE.NATIVE,overallDownloadMode:d("WAWebWamMediaMetricUtils").getMetricOverallDownloadModeType(a.type,a.downloadMode,a.isPrefetch),overallAttemptCount:a.userDownloadAttemptCount,overallDownloadOrigin:a.downloadOrigin,overallBackendStore:(b=d("WAWebWamMediaMetricUtils").getMetricBackendStore(a.directPath))!=null?b:void 0,isViewOnce:a.isViewOnce});d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.MediaUL);a.type===d("WAWebMmsMediaTypes").MEDIA_TYPES.IMAGE&&d("WAWebABProps").getABPropConfigValue("hqp_log_enabled")&&e.set(babelHelpers["extends"]({},a.imageDimensions));if(d("WAWebABProps").getABPropConfigValue("enable_days_since_receive_logging")&&a.mediaKeyTimestamp!=null){b=a.mediaKeyTimestamp;b=Math.floor((d("WATimeUtils").unixTime()-b)/(24*60*60));e.set({daysSinceReceive:b})}b=a.chatWid;if(b){a=(yield d("WAWebWamGroupMetricCache").getGroupMetrics(b));(a==null?void 0:a.deviceCount)!=null&&e.set({deviceCount:a.deviceCount})}d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(c,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_STARTED);b=function(a){var b=a.hostName,c=a.hostClass;a=a.failCount;e.set({overallDomain:b,overallConnectionClass:c,overallRetryCount:a})};a=function(a){e.set({overallMediaSize:a,overallDownloadResult:d("WAWebWamEnumMediaDownloadResultType").MEDIA_DOWNLOAD_RESULT_TYPE.OK,overallIsFinal:!0,downloadHttpCode:200}),d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(c,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_FINISHED,{overallMediaSize:a})};var f=function(a,b){e.set({overallDownloadResult:d("WAWebWamMediaMetricUtils").getMetricDownloadErrorResultType(a),overallIsFinal:b});b=d("WAWebWamMediaMetricUtils").getStatusCode(a);b!=null&&(e.downloadHttpCode=b);e.markOverallCumT();d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL);d("WAWebAppTracker").attachWAMAppContext(e,e.overallCumT);e.commit();d("WAWebWamMediaMetricUtils").logErrorUnknownDetails(e,a)},g=function(a){e.set({overallT:a})},h=function(a){var b=a.error,c=a.overallT;a=a.failCount;var f=new(d("WAWebMediaDownload2WamEvent").MediaDownload2WamEvent)(e.all);f.set({mediaId:d("WAWebWamMediaMetricUtils").generateMediaEventId(),overallDownloadResult:d("WAWebWamMediaMetricUtils").getMetricDownloadErrorResultType(b),overallIsFinal:!1,overallT:c,overallRetryCount:a});c=d("WAWebWamMediaMetricUtils").getStatusCode(b);c!=null&&(e.downloadHttpCode=c);e.markOverallCumT();d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL);d("WAWebAppTracker").attachWAMAppContext(e,e.overallCumT);f.commit();d("WAWebWamMediaMetricUtils").logErrorUnknownDetails(f,b)},i=function(){e.startOverallDecryptT()},j=function(){e.markOverallDecryptT()},k=function(){e.markOverallCumT(),d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.MediaUL),d("WAWebAppTracker").attachWAMAppContext(e,e.overallCumT),e.commit()},l=function(){e.startDownloadNetworkT()},m=function(){e.markDownloadNetworkT()};return{mediaId:c,handleDownloadSuccess:a,handleDownloadHostFound:b,handleDownloadError:f,handleDownloadAttemptSuccess:g,handleDownloadAttemptError:h,handleDownloadAndDecryptSuccess:k,markDecryptionEnd:j,markDecryptionStart:i,startNetworkT:l,markNetworkT:m}});return h.apply(this,arguments)}g.createMediaDownloadMetrics=a}),98);
__d("WAWebCryptoDecryptMedia",["Promise","WACryptoAesCbc","WACryptoHmac","WACryptoUtils","WALogger","WAMediaCalculateFilehash","WATypedArraysCast","WATypedArraysConcat","WAWebMiscErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=10;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.mediaKeys,e=a.ciphertextHmac,f=a.expectedPlaintextHash,g=a.debugString;yield (k||(k=b("Promise"))).resolve();var m={mediaKeys:c};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] start"])),g).devConsole(m);if(e.byteLength<l)throw new(d("WAWebMiscErrors").MediaDecryptionError)("ciphertext too short: "+e.byteLength);var n=c.iv,o=c.encKey;a=c.macKey;var p=d("WATypedArraysCast").castTypedArrays(Uint8Array,e);try{return yield d("WACryptoHmac").hmacSha256(a,d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(n),p.subarray(0,0-l)]),l).then(function(a){var b=p.buffer.slice(0-l);if(!d("WACryptoUtils").arrayBuffersEqual(a,b))throw new(d("WAWebMiscErrors").MediaDecryptionError)("decryptMedia: hmac mismatch");return d("WACryptoAesCbc").aesCbcDecrypt(o,n,p.subarray(0,0-l))}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(f==null)return a;var b=(yield d("WAMediaCalculateFilehash").calculateFilehash(a));if(b!==f)throw new(d("WAWebMiscErrors").MediaDecryptionError)("decryptMedia: "+d("WAWebMiscErrors").PLAINTEXT_HASH_MISMATCH_ERROR);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] success"])),g).devConsole(m);return a});return function(b){return a.apply(this,arguments)}}())}catch(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["decryptMedia: [","] error"])),g).devConsole(m,a);if(a instanceof d("WAWebMiscErrors").MediaDecryptionError)throw a;throw new(d("WAWebMiscErrors").MediaDecryptionError)("decryption error: "+String(a)+"; stack: "+a.stack)}});return m.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebGetMediaDownloadByterange",["WAAlignChunkLengthsToMultipleOfAesBlockSize","WAWebCryptoDecryptPartialMedia"],(function(a,b,c,d,e,f,g){function a(a){var b=a.partialVideoOpts,c=a.progressiveJpegOpts;a=a.scanCount;if(c&&a!=null)return{start:0,end:d("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(c.scanLengths).slice(0,a).reduce(function(a,b){return a+b},0)};if(b){c=b.video;a=c.size;c=c.duration;b=b.secondsToDownload;a=a*b/c;b=128*1024;c=Math.max(a,b);a=Math.ceil(c/d("WAWebCryptoDecryptPartialMedia").BLOCK_SIZE);return{start:0,end:a*d("WAWebCryptoDecryptPartialMedia").BLOCK_SIZE-1}}return null}g["default"]=a}),98);
__d("WAWebNetworkType",[],(function(a,b,c,d,e,f){function a(){return navigator.connection&&typeof navigator.connection.effectiveType==="string"?navigator.connection.effectiveType:null}f.getEffectiveNetworkType=a}),66);
__d("WAWebValidateMediaFilehash",["WAMediaCalculateFilehash","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAMediaCalculateFilehash").calculateFilehash(a));return b===a});return h.apply(this,arguments)}g.validateFileash=a}),98);
__d("WAWebWamEnumWebcChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:0,GROUP:1,BROADCAST_LIST:2,COMMUNITY:3,NEWSLETTER:4});f.WEBC_CHAT_TYPE=a}),66);
__d("WAWebWebcMediaRmrWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumWebcChatType","WAWebWamEnumWebcRmrReasonCode"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMediaRmr:[1906,{messageMediaType:[10,d("WAWebWamEnumMediaType").MEDIA_TYPE],webcBrowserNetworkType:[2,a.TYPES.STRING],webcBrowserStorageQuotaBytes:[11,a.TYPES.INTEGER],webcBrowserStorageQuotaUsedBytes:[12,a.TYPES.INTEGER],webcChatPosition:[1,a.TYPES.INTEGER],webcChatType:[9,d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE],webcMediaRmrError:[8,a.TYPES.BOOLEAN],webcMediaRmrT:[6,a.TYPES.TIMER],webcMediaSize:[7,a.TYPES.INTEGER],webcMessageIndex:[3,a.TYPES.INTEGER],webcMessageT:[5,a.TYPES.TIMER],webcRmrReason:[14,d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE],webcRmrStatusCode:[13,a.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcMediaRmr:[]});g.WebcMediaRmrWamEvent=b}),98);
__d("WAWebDownloadManager",["Promise","WAAsyncCache","WAConcurrentPriorityPromiseQueue","WALogger","WAMediaWasmWorkerClient","WAMemoizeConcurrent","WANullthrows","WAResultOrError","WAWebABProps","WAWebBackendErrors","WAWebCreateMediaDownloadMetrics","WAWebCryptoCreateMediaKeys","WAWebCryptoDecryptMedia","WAWebCryptoDecryptPartialMedia","WAWebCryptoImageStreamer","WAWebDownloadAndDecryptCache","WAWebDownloadManagerErrors","WAWebFrontendMsgGetters","WAWebGetMediaDownloadByterange","WAWebMediaCryptoEligibilityUtils","WAWebMediaDebugString","WAWebMediaObject","WAWebMediaTypes","WAWebMiscErrors","WAWebMmsClient","WAWebMmsClientErrors","WAWebMmsDownloadUploadCrashLogger","WAWebMmsMediaTypes","WAWebNetworkType","WAWebNoop","WAWebSerializeError","WAWebValidateMediaFilehash","WAWebWebcMediaRmrWamEvent","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w={PRELOAD_MMS_MEDIA:1,PRELOAD_MMS_THUMBNAIL:2},x=function(a){switch(a){case d("WAWebMmsMediaTypes").MEDIA_TYPES.THUMBNAIL_DOCUMENT:return w.PRELOAD_MMS_THUMBNAIL;case d("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC:case d("WAWebMmsMediaTypes").MEDIA_TYPES.VIDEO:default:return w.PRELOAD_MMS_MEDIA}};a=function(){var a=this;this.preloader=new(c("WAConcurrentPriorityPromiseQueue"))(10,{thumbnail:4,histSyncChunk:3});this.loadSequence=new(c("WAConcurrentPriorityPromiseQueue"))(c("justknobx")._("4675"),{thumbnail:5},c("justknobx")._("4676"));this.downloadAndMaybeDecrypt=c("WAAsyncCache")(function(a){return d("WAWebDownloadAndDecryptCache").getLRUStoreKey(a)},new(d("WAWebDownloadAndDecryptCache").DownloadAndDecryptCache)(),function(e){var f=function(){return y(e).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebABProps").getABPropConfigValue("web_use_kaleidoscope_media_check_enabled")){var b=(yield d("WAMediaWasmWorkerClient").kaleidoscopeClassifyInWorker({rawMimeType:"image/jpeg",input:a,eventFlow:{addPoint:c("WAWebNoop"),addAnnotations:c("WAWebNoop")}})["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifyInWorker: Unexpected runtime error: ",""])),a).devConsole(a).tags("kaleidoscope").sendLogs("kaleidoscope-error");return d("WAResultOrError").makeError("runtime-error")}));b.success?d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifiyInWorker success"]))):d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscopeClassifyInWorker failed: ",""])),b.error).tags("kaleidoscope").sendLogs("kaleidoscope-fail")}return a});return function(b){return a.apply(this,arguments)}}())},g={priority:-x(e.type),group:e.type===d("WAWebMmsMediaTypes").MEDIA_TYPES.HISTORY_SYNC?"histSyncChunk":"thumbnail",signal:e.signal};if(e.isPreload===!0)return a.preloader.enqueue(f,g);return e.shouldSequenceDownload===!0?a.loadSequence.enqueue(f,babelHelpers["extends"]({},g,{group:"thumbnail"})):f()});this.rmr=c("WAMemoizeConcurrent")(function(a){return a.mediaObject.filehash||""},A);this.checkExistence=c("WAMemoizeConcurrent")(function(a){return a.encFilehash},C);d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.init()};function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.directPath,f=a.encFilehash,g=a.filehash,h=a.mediaKey,i=a.mediaKeyTimestamp,j=a.onDecryptStart,q=a.downloadOrigin,r=a.staticUrl,s=a.type,t=a.mode,u=a.progressiveJpegOpts,w=a.partialVideoOpts,x=a.onProgress,y=a.userDownloadAttemptCount,z=a.isViewOnce,A=a.imageDimensions,B=a.chatWid,C=d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMediaType(s);if(h==null&&C){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[DownloadManager] expected media key for media type ",""])),s).tags("media").sendLogs("missing-media-key-for-media-type-"+s);throw new(d("WAWebMiscErrors").MediaDecryptionError)("decryptMedia: missing key for type "+s)}if(f==null&&C){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[DownloadManager] expected encFilehash for media type ",""])),s).tags("media").sendLogs("missing-encfilehash-for-media-type-"+s);throw new(d("WAWebMiscErrors").MediaDecryptionError)("decryptMedia: missing encFilehash for type "+s)}var D=u==null?void 0:u.scanCount,F=u!=null&&(u.scanCount==null||u.scanCount===u.scanLengths.length);D=F?null:D;q=(yield d("WAWebCreateMediaDownloadMetrics").createMediaDownloadMetrics({directPath:e,downloadOrigin:q,type:s,userDownloadAttemptCount:y,isViewOnce:z,downloadMode:t,isPrefetch:u!=null&&!F,imageDimensions:A,chatWid:B,mediaKeyTimestamp:i}));y=q.handleDownloadSuccess;var G=q.handleDownloadHostFound;z=q.handleDownloadError;var H=q.handleDownloadAttemptSuccess,I=q.handleDownloadAttemptError;F=q.handleDownloadAndDecryptSuccess;A=q.markDecryptionStart;B=q.markDecryptionEnd;var J=q.startNetworkT,K=q.markNetworkT;i=q.mediaId;var L=a.signal||new AbortController().signal,M=d("WAWebMediaDebugString").getDebugString(g);q={directPath:e,encFilehash:f,staticUrl:r,type:s};d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] start"])),M).devConsole(q);try{var N=E({progressiveJpegOpts:u,filehash:g,debugString:M}),O=function(a){I(a),N!=null&&(N=E({progressiveJpegOpts:u,filehash:g,debugString:M}))},P=c("WAWebGetMediaDownloadByterange")({partialVideoOpts:w,progressiveJpegOpts:u,scanCount:D}),Q=D==null&&u?function(a,b){var c;void ((c=N)==null?void 0:c.handleProgress(a.total,b))}:null;h=C&&h!=null?c("WAWebCryptoCreateMediaKeys")(s,h).then(function(a){var b;(b=N)==null||b.setCryptoKeys(a);return a}):(v||(v=b("Promise"))).resolve(null);h=(yield (v||(v=b("Promise"))).all([h,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){J();try{return yield c("WAWebMmsClient").download({directPath:e,filehash:C?c("WANullthrows")(f):g,staticUrl:r,type:s,signal:L,mode:t,byteRange:P,onData:Q,onDownloadHostFound:G,onDownloadAttemptSuccess:H,onDownloadAttemptError:O,debugString:M,onProgress:x})}finally{K()}})()]));var R=h[0];h=h[1];y(h.byteLength);y=h;if(R!=null){d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(i,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_DECRYPTION_STARTED);j==null||j();A();if(D!=null&&P!=null){j=P.end-P.start;return c("WANullthrows")(yield (A=N)==null?void 0:A.handleProgress(j,h))}else w?y=(yield d("WAWebCryptoDecryptPartialMedia").decryptPartialMedia({mediaKeys:R,ciphertext:h})):y=(yield c("WAWebCryptoDecryptMedia")({mediaKeys:R,ciphertextHmac:h,expectedPlaintextHash:g,debugString:M}));B();d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(i,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_DECRYPTION_FINISHED)}else{D=w==null;if(D){A=(yield d("WAWebValidateMediaFilehash").validateFileash(y,g));if(!A)throw new(d("WAWebMiscErrors").MediaHashMismatch)()}}d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] success"])),M).devConsole(q,y);F();return y}catch(b){b instanceof d("WAWebMmsClientErrors").MediaNotFoundError?(z(b,Boolean(a.isFinalRmrRetry)),d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] expected error\n",""],["downloadManager.download: [","] expected error\\n",""])),M,c("WAWebSerializeError")(b)).verbose().devConsole(q)):(z(b,!0),d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.download: [","] error\n",""],["downloadManager.download: [","] error\\n",""])),M,c("WAWebSerializeError")(b)).verbose().devConsole(q));d("WAWebMmsDownloadUploadCrashLogger").downloadUploadCrashLogger.mark(i,d("WAWebMmsDownloadUploadCrashLogger").ProgressType.DOWNLOAD_ERROR);throw b}});return z.apply(this,arguments)}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mediaObject,e=d("WAWebMediaDebugString").getDebugString(b.filehash),f={filehash:b.filehash,type:b.type};d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] start"])),e).devConsole(f);b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.REUPLOADING});var g=self.performance.now(),h=new(d("WAWebWebcMediaRmrWamEvent").WebcMediaRmrWamEvent)(babelHelpers["extends"]({},a.rmrData,{webcRmrReason:a.rmrReason}));a=d("WAWebNetworkType").getEffectiveNetworkType();a!=null&&(h.webcBrowserNetworkType=a);b.type&&(h.messageMediaType=d("WAWebMediaObject").webMediaTypeToWamMediaType(b.type));b.size!=null&&(h.webcMediaSize=b.size);function i(a){var b=d("WAWebFrontendMsgGetters").getMaybeChat(a);h.webcChatType==null&&b&&(h.webcChatType=b.getWebcChatType());h.webcMessageT==null&&(h.webcMessageT=a.t);h.messageMediaType=a.getWamMediaType()}try{a=(yield b.rmr({onMsgSelect:i}));h.webcRmrStatusCode=a;d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] status ",""])),e,a).devConsole(f);if(a===404)throw new(d("WAWebDownloadManagerErrors").MediaNotOnPhone)();if(a!==200)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a)}catch(a){h.webcMediaRmrError=!0;if(a instanceof d("WAWebMiscErrors").RMRNotSupportedOnNewsletterMessagesError){a.mediaType===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER||a.mediaType===d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_STICKER_PACK?b.consolidate({downloadStage:d("WAWebMediaTypes").DownloadStage.RESOLVED}):d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error RMRNotSupportedOnNewsletterMessagesError","\n",""],["downloadManager.rmr: [","] error RMRNotSupportedOnNewsletterMessagesError","\\n",""])),e,a.message,a.stack).verbose().devConsole(f);throw a}else if(a instanceof d("WAWebDownloadManagerErrors").MediaNotOnPhone){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error MediaNotOnPhone\n",""],["downloadManager.rmr: [","] error MediaNotOnPhone\\n",""])),e,c("WAWebSerializeError")(a)).verbose().devConsole(f);throw a}else{d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["downloadManager.rmr: [","] error ","\n",""],["downloadManager.rmr: [","] error ","\\n",""])),e,a.status||a.message,a.stack).verbose().devConsole(f);throw new(d("WAWebMiscErrors").MediaNeedsReupload)()}}finally{h.webcMediaRmrT=Math.ceil(self.performance.now()-g),h.commit()}});return B.apply(this,arguments)}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.directPath,d=a.encFilehash,e=a.signal;a=a.type;yield c("WAWebMmsClient").checkExistence({directPath:b,encFilehash:d,type:a,signal:e||new AbortController().signal})});return D.apply(this,arguments)}function E(a){var b=a.progressiveJpegOpts,c=a.filehash;a=a.debugString;return b==null?null:new(d("WAWebCryptoImageStreamer").ImageStreamer)({scanLengths:b.scanLengths,scansSidecar:b.scansSidecar,mimetype:b.mimetype,filehash:c,debugString:a,onProgressiveUpdate:b.onProgressiveUpdate})}e=new a();g.downloadManager=e}),98);
__d("WAWebBaseCachePolicy",["WAWebEventEmitter"],(function(a,b,c,d,e,f,g){a={LOAD:"LOAD",NONE:"NONE"};b=function(a){function b(b,c){var d;d=a.call(this)||this;d.collection=b;d.id=c;return d}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.enableCaching=function(){};c.disableCaching=function(){};return b}(c("WAWebEventEmitter"));b.policy=a.NONE;g.CACHE_POLICY=a;g.BaseCachePolicy=b}),98);
__d("WAWebLoadCachePolicy",["WAWebBaseCachePolicy","WAWebDebounce"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,d){var e;e=a.call(this,b,d.id)||this;e.saveToCache=function(){e.collection.saveToCache()};e.$LoadCachePolicy$p_2=d.trigger||"all";e.$LoadCachePolicy$p_1=d.delay;e.$LoadCachePolicy$p_3=c("WAWebDebounce")(e.saveToCache,e.$LoadCachePolicy$p_1);return e}babelHelpers.inheritsLoose(b,a);var d=b.prototype;d.enableCaching=function(){this.listenTo(this.collection,this.$LoadCachePolicy$p_2,this.$LoadCachePolicy$p_3)};d.disableCaching=function(){this.stopListening(this.collection,this.$LoadCachePolicy$p_2,this.$LoadCachePolicy$p_3)};return b}(d("WAWebBaseCachePolicy").BaseCachePolicy);a.policy=d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD;g["default"]=a}),98);
__d("WAWebNoCachePolicy",["WAWebBaseCachePolicy"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,c){return a.call(this,b,c.id)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCachePolicy").BaseCachePolicy);a.policy=d("WAWebBaseCachePolicy").CACHE_POLICY.NONE;g["default"]=a}),98);
__d("WAWebCachePolicies",["WAWebLoadCachePolicy","WAWebNoCachePolicy"],(function(a,b,c,d,e,f,g){function a(a,b){switch(b.policy){case"LOAD":return new(c("WAWebLoadCachePolicy"))(a,b);case"NONE":return new(c("WAWebNoCachePolicy"))(a,b)}return new(c("WAWebNoCachePolicy"))(a,{id:"none",policy:"NONE"})}g.createCachePolicy=a}),98);
__d("WAWebBaseCollection",["Promise","WAFilteredCatch","WALogger","WATypeUtils","WAWebBackendErrors","WAWebBaseCachePolicy","WAWebCachePolicies","WAWebCollection","WAWebConnModel","WAWebMiscErrors","WAWebSocketConstants","WAWebSocketModel","WAWebUserPrefsStore","asyncToGeneratorRuntime","cr:5292","err","gkx","uniqueID"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p={QUERY:"QUERY",FIND:"FIND",UPDATE:"UPDATE"},q={}.toString(),r={id:"none",policy:d("WAWebBaseCachePolicy").CACHE_POLICY.NONE},s=function(a){function b(b){var c;c=a.call(this,b)||this;c.name="CollectionSilentQueryError";c.message=b;return c}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));a=function(a){function e(){var b;b=a.call(this)||this;b._inflight={};b._cachePolicy=d("WAWebCachePolicies").createCachePolicy(b,b.constructor.cachePolicy||r);b._staleCollection=b.constructor.staleCollection||!1;b._staleCollection===!0&&b.listenTo(d("WAWebSocketModel").Socket,"change:stream",b._handleStreamChange);b._cachePolicy.enableCaching();b._cachePolicy.constructor.policy===d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD&&(b.listenTo(d("WAWebConnModel").Conn,"me_ready",b._updateFromCache),d("WAWebConnModel").Conn.meReadyTriggered&&b._updateFromCache());return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initializeFromCache=function(a){this.add(a)};f.saveToCache=function(){if(!d("WAWebConnModel").Conn.shouldSaveToCache())return;var a=this._cachePolicy.id;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:saveToCache save: ",""])),String(a));c("WAWebUserPrefsStore").setCollection(a,this.toJSON())};f.add=function(e,f){var g=this;c("gkx")("26258")||(b("cr:5292")==null?void 0:b("cr:5292").currentTransaction)!=null&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Detected UI change inside a transaction in collection ",".\n      This can result in a consistency issue. See https://fburl.com/aleoj4tt item #1 for details."])),this.constructor.name);if(e){if(d("WAWebConnModel").Conn.blockStoreAdds)throw new(d("WAWebBackendErrors").LogoutDrop)("adding to store when blocking store adds");var h=Array.isArray(e)?e:[e];if(h.every(function(a){return a==null?void 0:a.isState})){var j=h.filter(function(a){return!g.get(a.id)});j.length&&a.prototype.add.call(this,j,f);return h}}return a.prototype.add.call(this,e,f)};f.findQuery=function(a,b){return this._query(p.QUERY,a,b)};f.find=function(a,e){if(a)return this._query(p.FIND,a,e);d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Called find without an id"]))).sendLogs("find-without-id");return(o||(o=b("Promise"))).reject(c("err")("called find without an id"))};f.update=function(a,e){if(a)return this._query(p.UPDATE,a,e);d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Called update without an id"]))).sendLogs("update-without-id");return(o||(o=b("Promise"))).reject(c("err")("called update without an id"))};f.gadd=function(a,b){if(this.modelClass.prototype.isIdType(a)){var d=this.get(a);return d?d:this.add({id:a},b)[0]}if(a.id){d=b?b:{};d.merge=!0;return this.add(a,d)[0]}throw c("err")("gadd called without an id attr (id)")};f.gaddUp=function(a){var b=this._staleCollection;this.get(a.id)&&(b=!1);b=babelHelpers["extends"]({stale:b},a);a=this.add(b,{merge:!0})[0];if(a){b=a;a.stale&&this.find(a.id);return b}throw c("err")(".gaddUp called without an id attr (id)")};f["delete"]=function(){this._inflight={},this.reset()};f._handleResume=function(){switch(d("WAWebSocketModel").Socket.stream){case d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach(function(a){a&&(a.stale=!0)});break;case d("WAWebSocketConstants").SOCKET_STREAM.RESUMING:case d("WAWebSocketConstants").SOCKET_STREAM.SYNCING:case d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED:break}};f._query=function(a,e,f){var g=this,h=d("WATypeUtils").isString(e)?e:e.toString();h===q&&(h=c("uniqueID")("collection_query_"));var i=a===p.QUERY?void 0:this.get(e),j="force-"+h;(this._inflight[j]&&a===p.FIND||a===p.UPDATE)&&(h=j);if(this._inflight[h])return a===p.FIND&&i&&!i.stale?(o||(o=b("Promise"))).resolve(i):this._inflight[h];return!i||i.stale||a===p.UPDATE?this._inflight[h]=this._serverQuery(a,e,f)["finally"](function(){delete g._inflight[h]})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").LogoutDrop,function(a){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["LogoutDrop error: ",""])),a.toString()).devConsole(a)}))["catch"](function(a){if(a instanceof s)d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:query query promise rejected: ",""])),String(a));else throw a}):(o||(o=b("Promise"))).resolve(i)};f._serverQuery=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;a===p.UPDATE?e=this._update(b,c):a===p.FIND?e=this.findImpl(b,c):e=this.findQueryImpl(b);a=(yield e);if(this._staleCollection){b=Array.isArray(a)?a:[a];b.filter(Boolean).forEach(function(a){typeof a.stale==="undefined"&&(a.stale=!1)})}c!=null&&c.set?e=this.set(a):e=this.add(a,{merge:!0});if(Array.isArray(a))return e;if(e[0])return e[0];throw new(d("WAWebMiscErrors").ModelCreateError)("Unknown",a)});function c(b,c,d){return a.apply(this,arguments)}return c}();f._update=function(a,b){return this.findImpl(a,b)};f._handleStreamChange=function(){this._handleResume(),this._cachePolicy.constructor.policy===d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD&&this._updateFromCache()};f._updateFromCache=function(){var a=this._cachePolicy.id;this._cachePolicy.disableCaching();if(!d("WAWebConnModel").Conn.shouldSaveToCache())return;d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["baseCollection:initFromCache load: ",""])),String(a));this.initializeFromCache(c("WAWebUserPrefsStore").getCollection(a));this._cachePolicy.enableCaching()};return e}(c("WAWebCollection"));g.CollectionSilentQueryError=s;g.BaseCollection=a}),98);
__d("WAWebCollection",["WAArrayMove","WALogger","WAWebCollectionInternalUtils","WAWebEventEmitter","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;a=function(a){function b(b,d){d===void 0&&(d={});b=a.call(this)||this;d.parent&&(b.parent=d.parent);d=b.constructor;var e=d.model;d=d.comparator;if(!e)throw c("err")("Collection initialized without model. It is likely that you have a circular dependency. Set a breakpoint to find it and use inline `require` instead of `import` to avoid it.");b.modelClass=e;d&&(b._comparator=d);b._reset();var f=b;Object.defineProperty(b,"length",{get:function(){return f._models.length}});return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.add=function(a,b){var c;Array.isArray(a)?c=a.slice():c=a?[a]:[];return this.set(c,babelHelpers["extends"]({merge:!1,add:!0,remove:!1},b))};e.set=function(a,b){var c=this;if(!a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["collection:set called with no models"])));return[]}var e=babelHelpers["extends"]({add:!0,remove:!0,merge:!0},b),f,g,j,k;b=this._comparator&&e.sort!==!1;var l=[],m=[],n={},o=e.add,p=e.merge,q=e.remove,r=e.at!=null?e.at:void 0,s=!b&&o===!0&&q===!0?[]:null,t=function(){k=a[v];c.isModel(k)&&(g=k);f=k.id;if(!f){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["collection:set model has no id"])));return 0}j=c.get(f);if(j){var b=j;q===!0&&(n[j.id.toString()]=!0);p===!0&&(k=g&&k===g?g.attributes:k,b.set(k,e),c._iterateAggregators(function(a){a.add([b])}));a[v]=b}else if(o===!0){g=a[v]=c._prepareModel(k,e);if(g){var h=g;l.push(h);c._addReference(h)}else return 0}g=j||g;if(!g)return 0;h=g;s&&(!g.id||!n[g.id.toString()])&&s.push(h);n[h.id.toString()]=!0},u;for(var v=0,w=a.length;v<w;v++){u=t();if(u===0)continue}if(q===!0){for(u=0,t=this.length;u<t;u++){g=this._models[u];w=g;n[g.id.toString()]||m.push(w)}m.length&&this.remove(m,babelHelpers["extends"]({},e))}var x;if(l.length||Boolean(s==null?void 0:s.length)){b&&(x=!0);if(typeof r==="number"){(w=this._models).splice.apply(w,[r,0].concat(l))}else{u=s||l;for(t=0,m=u.length;t<m;t++)this._models.push(u[t])}this._iterateAggregators(function(a){a.add(l)})}x&&this.sort({silent:!0});if(e.silent!==!0){for(b=0,w=l.length;b<w;b++)g=l[b],g.trigger?g.trigger("add",g,this,e):this.trigger("add",g,this,e);(x||Boolean(s==null?void 0:s.length))&&this.trigger("sort",this,e)}return a};e.remove=function(a,b){b===void 0&&(b={});var c,d;a=Array.isArray(a)?a.slice():[a];var e=[];for(var f=0,g=a.length;f<g;f++){d=a[f];if(!d)continue;d=d instanceof this.modelClass?d.id:d;d=e[f]=this.get(d);if(d){var h=d;this._deIndex(d);c=this._models.indexOf(d);this._models.splice(c,1);b.silent!==!0&&(b.index=c,h.trigger?h.trigger("remove",d,this,b):this.trigger("remove",d,this,b));this._removeReference(h)}}this._iterateAggregators(function(a){a.remove(e)});return e};e.reset=function(){for(var a=0,b=this._models.length;a<b;a++)this._removeReference(this._models[a]);this._reset();this.trigger("reset",this)};e.sort=function(a){var b;a===void 0&&(a={});this._models.sort((b=a.comparator)!=null?b:this._comparator.bind(this));a.silent!==!0&&this.trigger("sort",this,a);return this};e.replaceId=function(a,b){var c=this.get(a);if(!c)return;this._removeFromIndex(a);c.set({id:b});this._addIndex(c)};e.reorderMutate=function(a,b){d("WAArrayMove").arrayMoveMutate(this._models,a,b)};e.get=function(a){return this._index[a]};e.assertGet=function(a){var b=this._index[a];if(!b)if(c("gkx")("26258"))d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Collection:assertGet no result");else{var e=this.constructor.name+":assertGet";d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["no model with id ",""])),String(a)).sendLogs(e)}return b};e.at=function(a){return this._models[a]};e.serialize=function(){return this.map(function(a){return a.toJSON()})};e.toJSON=function(){return this.serialize()};e.isModel=function(a){return a instanceof this.modelClass};e.includes=function(a,b){b===void 0&&(b=0);return b===0?!(a instanceof this.modelClass)?!1:this.get(a.id)!=null:this._models.includes(a,b)};e.indexOf=function(a,b){return this._models.indexOf(a,b)};e.lastIndexOf=function(a,b){return this._models.lastIndexOf(a,b)};e.every=function(a){return this._models.every(a)};e.some=function(a){return this._models.some(a)};e.forEach=function(a){this._models.forEach(a)};e.map=function(a){return this._models.map(a)};e.filter=function(a){return this._models.filter(a)};e.findFirst=function(a){return this._models.find(a)};e.reduce=function(a,b){return this._models.reduce(a,b)};e.slice=function(a,b){return this._models.slice(a,b)};e.where=function(a){return this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})};e.head=function(){return this._models[0]};e.last=function(){return this._models[this._models.length-1]};e.toArray=function(){return this._models.slice()};e.getModelsArray=function(){return this._models};e.reorder=function(a,b){return d("WAArrayMove").arrayMove(this._models,a,b)};e._reset=function(){this._models=[],this._index={},this._iterateAggregators(function(a){a.reset()},!1)};e._prepareModel=function(a,b){if(this.isModel(a)){a.collection==null&&(a.collection=this);return a}b=babelHelpers["extends"]({},b,{collection:this});try{return new this.modelClass(a,b)}catch(b){var c;d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["collection:_prepareModel for model "," exception: ",""])),(a=this==null||(c=this.modelClass)==null?void 0:c.name)!=null?a:"",b.stack).sendLogs("collection-model-creation-error");return void 0}};e._addReference=function(a){this._addIndex(a),a.collection||(a.collection=this),a.on&&a.on("all",this._handleModelEvent,this)};e._removeReference=function(a){this===a.collection&&delete a.collection,this._deIndex(a),a.off&&a.off("all",this._handleModelEvent,this)};e._addIndex=function(a){this._index[a.id]=a};e._deIndex=function(a){delete this._index[a.id]};e._removeFromIndex=function(a){if(!this.get(a))return;delete this._index[a]};e._handleModelEvent=function(a,b,c,d){var e=a.indexOf(":"),f=e===-1?a:a.slice(0,e);if((f==="add"||f==="remove")&&c!==this)return;f==="destroy"&&this.remove(b,d);this.trigger.apply(this,arguments)};e._iterateAggregators=function(a,b){b===void 0&&(b=!0);if(this._aggregators==null){if(!b)return;this._aggregators=d("WAWebCollectionInternalUtils").groupMethodsByKind(this).aggregate}(b=this._aggregators)==null||b.forEach(a)};return b}(c("WAWebEventEmitter"));g["default"]=a}),98);
__d("WAWebCollectionInternalUtils",["WAWebCollectionUtils"],(function(a,b,c,d,e,f,g){var h=function(a){return a!=null&&typeof a==="function"&&"kind"in a&&d("WAWebCollectionUtils").CollectionMethodKind.isValid(a.kind)?a:null};function a(a){var b=null;for(var c of Object.keys(a)){var e=h(a[c]);if(e)switch(e.kind){case d("WAWebCollectionUtils").CollectionMethodKind.Aggregate:b||(b=[]);b.push(e);break}}return{aggregate:b}}g.groupMethodsByKind=a}),98);
__d("WAWebCollectionUtils",["$InternalEnum","WALogger","WAWebSimpleCollection"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["Aggregate"]);function j(a){return Array.isArray(a)?JSON.stringify(a.map(j)):String(a)}var k=function(a){function b(b,c){var d;d=a.call(this)||this;d._isWaitingForCollection=!1;d._rootCollection=b;d._key=c;var e=d;Object.defineProperty(d,"_models",{get:function(){var a;return(a=(a=e._getAggregatedCollection())==null?void 0:a._models)!=null?a:[]}});Object.defineProperty(d,"_index",{get:function(){var a;return(a=(a=e._getAggregatedCollection())==null?void 0:a._index)!=null?a:{}}});return d}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c._getAggregatedCollection=function(){var a;return(a=this._rootCollection.get(this._key))==null?void 0:a.collection};c.on=function(b,c,d){a.prototype.on.call(this,b,c,d);this._maybeConnect();return this};c.off=function(b,c,d){a.prototype.off.call(this,b,c,d);this._maybeDisconnect();return this};c._hasListeners=function(){var a=this._events;if(a==null)return!1;for(var b in a)if(a[b]!=null&&a[b].length>0)return!0;return!1};c._maybeConnect=function(){var a=this,b=this._getAggregatedCollection();if(b==null){if(this._isWaitingForCollection)return;this._isWaitingForCollection=!0;this._rootCollection.on("add",this._maybeConnect,this);this._disconnect=function(){a._rootCollection.off("add",a._maybeConnect,a)};return}if(this._isWaitingForCollection){var c;(c=this._disconnect)==null||c.call(this);this._isWaitingForCollection=!1}b.on("all",this._relayEvent,this);this._rootCollection.on("remove",this._handleCollectionRemove,this);this._disconnect=function(){b.off("all",a._relayEvent,a),a._rootCollection.off("remove",a._handleCollectionRemove,a)}};c._maybeDisconnect=function(){var a;if(this._hasListeners())return;(a=this._disconnect)==null||a.call(this);this._disconnect=null};c._handleCollectionRemove=function(a){if(this._key===a.id){(a=this._disconnect)==null||a.call(this);this._disconnect=null;this._maybeConnect()}};c._relayEvent=function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this.trigger.apply(this,[a].concat(c))};return b}(d("WAWebSimpleCollection").SimpleCollection);function a(a,b){b===void 0&&(b={});b=b;var c=b.subscribeToKey,e=b.subscribeToKeys,f=new(d("WAWebSimpleCollection").SimpleCollection)(),g=new Map(),h=function(a){if(c!=null){var b=function(){var d=function(){a.off("change:"+c,b)};n(a,d)};a.on("change:"+c,b)}if(e!=null){var d=function(){var b=function(){e.forEach(function(b){a.off("change:"+b,d)})};n(a,b)};e.forEach(function(b){a.on("change:"+b,d)})}},l=function(a,b){var c;c=(c=f.get(a))==null?void 0:c.collection;c&&(c.remove(b),c.length===0&&f.remove(a));g["delete"](b.id)},m=function(b){var c=a(b);if(c==null)return;var e=g.get(b.id);c=j(c);e!=null&&c!==e&&l(e,b);e=(e=f.get(c))==null?void 0:e.collection;e==null&&(e=new(d("WAWebSimpleCollection").SimpleCollection)(),f.add({id:c,collection:e}));e.add(b);g.set(b.id,c);h(b)},n=function(b,c){var d=g.get(b.id),e=a(b);if(e==null){d!=null&&(c(),l(d,b));return}if(d!==j(e)){c();return m(b)}};return Object.assign(function(a){return new k(f,j(a))},{kind:i.Aggregate,add:function(a){a.forEach(function(a){m(a)})},remove:function(b){b.filter(Boolean).forEach(function(b){var c=j(a(b));l(c,b)})},reset:function(){f.forEach(function(a){a=a.collection;a.reset()}),f.reset(),g.clear()}})}g.CollectionMethodKind=i;g.AggregatedProxyView=k;g.aggregated=a}),98);
__d("WAWebSimpleCollection",["WAWebBaseCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=Object;g.SimpleCollection=a}),98);
__d("WAWebMsgModelFromData",["WAWebMsgModel"],(function(a,b,c,d,e,f,g){function h(a){return new(d("WAWebMsgModel").Msg)(babelHelpers["extends"]({},a,{paymentNoteMsg:a.paymentNoteMsg?h(a.paymentNoteMsg):void 0}))}g.msgModelFromMsgData=h}),98);
__d("WAWebDirectConnectionGatingUtils",["WALogger","WAWebABProps","WAWebBusinessProfileCollection","WAWebBusinessProfileVersioningBridge","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(){return(d("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersion()&d("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0}function j(){return!d("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function k(a,b){return a===d("WAWebMsgType").MSG_TYPE.LIST&&b===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST}function l(){return d("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function a(){return d("WAWebABProps").getABPropConfigValue("web_abprop_direct_connection_md")}function c(){var a=d("WAWebABProps").getABPropConfigValue("direct_connection_business_numbers");return typeof a==="string"&&a.length>0?a.split(","):[]}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(j()||!k(a,b)||!c)return!1;if(!i()){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] This web client cannot detect if the product list message recevied is coming from a direct connection business"])));return"unknown"}a=d("WAWebWidFactory").createWid(c);b=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(a);(!b||!b.profileOptions)&&(b=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a)));return b.isBusinessDirectConnection()||!1});return n.apply(this,arguments)}function e(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield m(a,b,c));return a===!0&&!l()?{requiresDirectConnection:a,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,subtype:"phone_only_feature"}:{requiresDirectConnection:a}});return o.apply(this,arguments)}g.supportsDirectConnection=l;g.enablePostcodeInCatalog=a;g.directConnectionBusinessNumbersFromAbprop=c;g.genDirectConnectionMessageModifiers=e}),98);
__d("WAWebEmojiDownloadSuggestions",["JSResource","Promise","WAWebL10nGetRenderedLocale","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=new Set(["en_GB",d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale()]);a=(yield (h||(h=b("Promise"))).all(Array.from(a).map(j)));return a.filter(Boolean)}catch(a){return[]}});return i.apply(this,arguments)}function j(a){switch(a){case"en_GB":case"en_IN":case"en_OP":case"en_PI":case"en_UD":case"en_US":case"en_XA":return c("JSResource")("WAWebLocalesEmojiSuggestionEn").__setRef("WAWebEmojiDownloadSuggestions").load();case"pt_BR":case"pt_PT":return c("JSResource")("WAWebLocalesEmojiSuggestionPt").__setRef("WAWebEmojiDownloadSuggestions").load();case"de_DE":return c("JSResource")("WAWebLocalesEmojiSuggestionDe").__setRef("WAWebEmojiDownloadSuggestions").load();case"es_CL":case"es_CO":case"es_ES":case"es_LA":case"es_MX":case"es_VE":return c("JSResource")("WAWebLocalesEmojiSuggestionEs").__setRef("WAWebEmojiDownloadSuggestions").load();case"it_IT":return c("JSResource")("WAWebLocalesEmojiSuggestionIt").__setRef("WAWebEmojiDownloadSuggestions").load();case"ru_RU":return c("JSResource")("WAWebLocalesEmojiSuggestionRu").__setRef("WAWebEmojiDownloadSuggestions").load();case"ar_AR":return c("JSResource")("WAWebLocalesEmojiSuggestionAr").__setRef("WAWebEmojiDownloadSuggestions").load();case"tr_TR":return c("JSResource")("WAWebLocalesEmojiSuggestionTr").__setRef("WAWebEmojiDownloadSuggestions").load();case"uk_UA":return c("JSResource")("WAWebLocalesEmojiSuggestionUk").__setRef("WAWebEmojiDownloadSuggestions").load();case"bn_IN":return c("JSResource")("WAWebLocalesEmojiSuggestionBn").__setRef("WAWebEmojiDownloadSuggestions").load();case"hi_IN":case"hi_FB":return c("JSResource")("WAWebLocalesEmojiSuggestionHi").__setRef("WAWebEmojiDownloadSuggestions").load();case"hu_HU":return c("JSResource")("WAWebLocalesEmojiSuggestionHu").__setRef("WAWebEmojiDownloadSuggestions").load();case"ms_MY":return c("JSResource")("WAWebLocalesEmojiSuggestionMs").__setRef("WAWebEmojiDownloadSuggestions").load();case"pl_PL":return c("JSResource")("WAWebLocalesEmojiSuggestionPl").__setRef("WAWebEmojiDownloadSuggestions").load();case"ro_RO":return c("JSResource")("WAWebLocalesEmojiSuggestionRo").__setRef("WAWebEmojiDownloadSuggestions").load();case"th_TH":return c("JSResource")("WAWebLocalesEmojiSuggestionTh").__setRef("WAWebEmojiDownloadSuggestions").load();case"ur_PK":return c("JSResource")("WAWebLocalesEmojiSuggestionUr").__setRef("WAWebEmojiDownloadSuggestions").load();case"id_ID":return c("JSResource")("WAWebLocalesEmojiSuggestionId").__setRef("WAWebEmojiDownloadSuggestions").load();case"fa_IR":return c("JSResource")("WAWebLocalesEmojiSuggestionFa").__setRef("WAWebEmojiDownloadSuggestions").load();case"mr_IN":return c("JSResource")("WAWebLocalesEmojiSuggestionMr").__setRef("WAWebEmojiDownloadSuggestions").load();case"gu_IN":return c("JSResource")("WAWebLocalesEmojiSuggestionGu").__setRef("WAWebEmojiDownloadSuggestions").load();case"fr_FR":case"fr_CA":return c("JSResource")("WAWebLocalesEmojiSuggestionFr").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_TW":return c("JSResource")("WAWebLocalesEmojiSuggestionZhTw").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_CN":return c("JSResource")("WAWebLocalesEmojiSuggestionZhCn").__setRef("WAWebEmojiDownloadSuggestions").load();case"zh_HK":return c("JSResource")("WAWebLocalesEmojiSuggestionZhHk").__setRef("WAWebEmojiDownloadSuggestions").load();case"nl_NL":case"nl_BE":return c("JSResource")("WAWebLocalesEmojiSuggestionNl").__setRef("WAWebEmojiDownloadSuggestions").load();case"cs_CZ":return c("JSResource")("WAWebLocalesEmojiSuggestionCs").__setRef("WAWebEmojiDownloadSuggestions").load();case"sk_SK":return c("JSResource")("WAWebLocalesEmojiSuggestionSk").__setRef("WAWebEmojiDownloadSuggestions").load();default:return(h||(h=b("Promise"))).resolve(null)}}g.downloadEmojiSuggestions=a}),98);
__d("WAWebEmojiKeywordToUnicode",["WAArraysShallowEqual","WALogger","WAWebEmojiDownloadSuggestions","WAWebEmojiSearch","WAWebEventsWaitForBbEvent","WAWebL10N","WAWebNoop","WAWebStreamModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=null;function a(a){if(j!=null)return d("WAWebEmojiSearch").emojiSearch(a,j);d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Emoji Trie is not loaded."]))).sendLogs("Emoji Trie is not loaded");return[]}var k=null,l=[];function m(){o();var a=["en"],e=c("WAWebL10N").getNormalizedLocale();e!=="en"&&a.push(e);if(c("WAArraysShallowEqual")(l,a))return;l=a;var f=d("WAWebEmojiDownloadSuggestions").downloadEmojiSuggestions().then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(k!==f)return;j=(yield d("WAWebEmojiSearch").emojiLocaleDictsToTrie(a))});return function(b){return a.apply(this,arguments)}}())["catch"](c("WAWebNoop"))["finally"](function(){if(k!==f)return;k=null});k=f}var n=!1;function o(){if(n)return;try{c("WAWebL10N").on("locale_change",function(){m()})}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[emoji-trie] subscription to locale_change failed: ",", stack: ",""])),a,a.stack).sendLogs("[emoji-trie] subscription to locale_change failed: "+a.message)}void c("WAWebEventsWaitForBbEvent")(d("WAWebStreamModel").Stream,"change:mode",function(){return d("WAWebStreamModel").Stream.mode===d("WAWebStreamModel").StreamMode.MAIN}).then(function(){m()});n=!0}g.emojiKeywordToUnicodeSearch=a;g.updateEmojiTrie=m}),98);
__d("WAWebEmojiSearch",["WALogger","WATrie","WAWebEmoji","WAWebRecentEmojiCollection","asyncToGeneratorRuntime","justknobx","once","requireDeferred"],(function(a,b,c,d,e,f,g){var h,i=c("requireDeferred")("WAFtsMultiLangTokenizer").__setRef("WAWebEmojiSearch"),j=["\ud83d\ude02","\ud83e\udd23","\u2764","\ud83e\udd7a","\ud83e\udd70","\ud83d\ude18","\ud83d\ude2d","\ud83d\ude0d","\ud83d\ude01","\ud83d\ude4f","\ud83d\ude05","\ud83d\ude06","\ud83d\ude0a","\ud83d\ude42","\ud83d\ude14","\ud83e\udd73","\ud83d\ude12","\u263a","\ud83c\udf82","\ud83d\udc4d","\ud83d\udc96","\ud83d\ude22","\ud83d\ude44","\ud83d\ude0f","\ud83d\ude0e","\ud83d\udc8b","\ud83d\ude1e","\ud83d\ude09","\ud83d\udc4f","\ud83d\ude43","\ud83d\ude21","\ud83d\ude00","\ud83d\ude04","\ud83d\ude07","\ud83e\udd29","\ud83d\ude0c","\ud83e\udd14","\ud83c\udf39","\ud83d\ude0b","\ud83d\udc97","\ud83e\udd17","\ud83d\udc95","\ud83d\udc94","\ud83d\ude1a","\u2639","\ud83d\ude03","\ud83c\udf89","\ud83d\udd25","\ud83e\udd74","\ud83d\ude33"],k=["SMILEYS_PEOPLE","ANIMALS_NATURE","FOOD_DRINK","ACTIVITY","TRAVEL_PLACES","OBJECTS","SYMBOLS","FLAGS","VARIATION"];function a(a,b){var c=[];if(a){a=n(a.toLowerCase(),b);c=Array.from(new Set(a))}return c}function l(a,b){if(!b)return[];if(a.length<=5)return b.getMatches(a);var c=a.substring(0,5).trim();b=b.getMatches(c);b=b.filter(function(b){return b.keyword.startsWith(a)});return b}function m(a){return a.map(d("WAWebEmoji").EmojiUtil.normalizeEmoji).filter(Boolean)}function n(a,b){var e,f=i.getModuleIfRequireable();!f?d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WAFtsMultiLangTokenizer not loaded"]))).sendLogs("WAFtsMultiLangTokenizer not loaded"):e=new f();var g;if(e&&c("justknobx")._("2148")){f=Array.from(e.tokenize(a));f=f.map(function(a){return l(a,b)});f.length===0?g=[]:f.length===1?g=f[0]:g=f.reduce(function(a,b){return a.filter(function(a){return b.map(function(a){return a.value}).includes(a.value)})},f[0])}else g=l(a,b);f=m(g.flatMap(function(a){return a.value}));g=m(g.filter(function(b){return b.keyword===a}).flatMap(function(a){return a.value}));var k=s(m(d("WAWebRecentEmojiCollection").RecentEmojiCollection.map(function(a){return a.id})),f),n=s(m(j),f),o=s(t(k,n),g);return t(o,p(g),k,n,p(f))}var o=c("once")(function(){var a=new Map(),b=0;for(var c of k){var e=d("WAWebEmoji").EmojiUtil.getEmojisInCategory(c);for(e of e)a.set(e,b),b++}return a});function p(a){var b=o();return a.toSorted(function(a,c){a=(a=b.get(a))!=null?a:Number.MAX_SAFE_INTEGER;c=(c=b.get(c))!=null?c:Number.MAX_SAFE_INTEGER;return a-c})}function e(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a.length>1&&(b=babelHelpers["extends"]({},b,a[1]));a=(yield i.load());var d=new a();c("justknobx")._("2148")?a=Object.entries(b).flatMap(function(a){var b=a[0],c=a[1];a=b.toLowerCase();b=Array.from(d.tokenize(a));return b.map(function(a){return{value:c,keyword:a,shortKeyword:a.substring(0,5)}})}):a=Object.entries(b).flatMap(function(a){var b=a[0];a=a[1];b=b.toLowerCase();var c=b.substring(0,5);return{value:a,keyword:b,shortKeyword:c}});return r(a,"shortKeyword")});return q.apply(this,arguments)}function r(a,b){var d=c("WATrie").fromForwardsStrings(a.map(function(a){return a[b]}),a);return{getMatches:function(a){return d.search(a)}}}function s(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];if(b.length===0)return[];return b.length===1?b[0]:b.reduce(function(a,b){return a.filter(function(a){return b.includes(a)})},b[0])}function t(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return Array.from(new Set(b.flat(1)))}g.emojiSearch=a;g.emojiLocaleDictsToTrie=e}),98);
__d("WAWebLoggerDebugInfo",["WAWebABPropsSaga","WAWebConnModel","WAWebCrashlogConstants","WAWebEnvironment","WAWebL10N","WAWebLid1X1MigrationGating","WAWebTasksDailyStatsTask","WAWebUA","WAWebUIRefreshGatingUtils","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWam","WAWebWamGlobals","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h=new Map([["appIsBetaRelease","is-beta"],["appVersion","version"],["browserVersion","browser-version"],["deviceName","os"],["mcc","phone-mcc"],["mnc","phone-mnc"],["webc_bucket","exp-bucket"],["webcPhoneAppVersion","phone-app-version"],["webcPhoneCharging","is-phone-charging"],["webcPhoneDeviceManufacturer","phone-manufacturer"],["webcPhoneDeviceModel","phone-model"],["webcPhoneOsVersion","phone-os-version"],["webcPhonePlatform","phone-os"],["webcWebPlatform","platform"],["webcProtoVersion","protocol-version"],["deviceID","device-id"],["webcWebArch","device-arch"],["webcWebDeviceManufacturer","device-manufacturer"],["webcWebDeviceModel","device-model"],["webcWebOsReleaseNumber","device-release"],["deviceVersion","os-version"],["userAgent","user-agent"],["mdEnabled","md-enabled"],["hasMdCompanion","has-md-companion"],["entityId","entity id"],["isLidMigrated","is_lid_migrated"],["lidCompletedMigrations","lid_completed_migrations"],["isUiRefreshEnabled","ui-refresh-enabled"]]);function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){void d("WAWebWam").Wam.initialize();var b=babelHelpers["extends"]({},d("WAWebWamGlobals").Global.all,{webcWebPlatform:d("WAWebCrashlogConstants").CLB_PLATFORM,webcPhonePlatform:d("WAWebConnModel").Conn.platform,webcProtoVersion:String(d("WAWebConnModel").Conn.protoVersion)});c("WAWebEnvironment").isWindows&&(b.subplatform=d("WAWebCrashlogConstants").CLB_SUBPLATFORM);c("gkx")("26259")?b.releaseChannel="intern":c("gkx")("26258")&&(b.releaseChannel="production");var e=d("WAWebUserPrefsMeUser").getMaybeMeDevicePn();e&&(b.deviceID=e.toString());if(c("gkx")("11584")){b.saga_copy=d("WAWebABPropsSaga").getIsSagaV1Enabled().toString();e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b.pn=e.user.toString()}e={};for(var f in b){var g=b[f];g!=null&&(e[f]=g)}e.debugIsExternalBeta=(yield d("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb());e.isLidMigrated=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();e.isUiRefreshEnabled=d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled();g=(yield d("WAWebTasksDailyStatsTask").getLidMigrationStatus());g.completedMigrations!=null&&(e.lidCompletedMigrations=g.completedMigrations);if(a){f=a.supportTag;b=a.addUserAgentDetails;g=a.convertFields;var h=a.entityId,i=a.addLanguageFields;a=a.user_review_score;f!=null&&(e.context=f);h!=null&&(e.entityId=h);a!=null&&(e.user_review_score=a);b===!0&&(e.userAgent=d("WAWebUA").UA.parser.getUA());i===!0&&(e.lc=c("WAWebL10N").getRegion(),e.lg=c("WAWebL10N").getLanguage());if(g===!0){f=j(e);return f}}return e});return i.apply(this,arguments)}function j(a){var b={};for(a of Object.entries(a)){var c,d=a[0],e=a[1];b[(c=h.get(d))!=null?c:d]=e}return b}g.getDebugInfo=a}),98);
__d("WAWebPrivacyMode_WORKER_INCOMPATIBLE",["WAWebContactCollection","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){if(!c("WAWebWid").isUser(a))return;a=d("WAWebContactCollection").ContactCollection.get(a);return a==null?void 0:a.privacyMode}g.getPrivacyModeFromModel=a}),98);
__d("WAWebWamEnumBlockEventActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({BLOCK:0,UNBLOCK:1});f.BLOCK_EVENT_ACTION_TYPE=a}),66);
__d("WAWebBlockEventsFsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBlockEntryPoint","WAWebWamEnumBlockEventActionType","WAWebWamEnumCallResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({BlockEventsFs:[4288,{blockEntryPoint:[1,d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT],blockEventActionType:[2,d("WAWebWamEnumBlockEventActionType").BLOCK_EVENT_ACTION_TYPE],blockEventIsSuspicious:[3,a.TYPES.BOOLEAN],blockEventIsUnsub:[4,a.TYPES.BOOLEAN],pastCall:[5,a.TYPES.BOOLEAN],pastCallResult:[6,d("WAWebWamEnumCallResultType").CALL_RESULT_TYPE]},[1,1,1],"regular"]},{BlockEventsFs:[]});g.BlockEventsFsWamEvent=b}),98);
__d("WAWebWamBlockEventReporter",["WAWebABProps","WAWebBlockEventsFsWamEvent","WAWebChatCollection","WAWebContactGetters","WAWebWamEnumBlockEventActionType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.contact,c=a.blockEntryPoint;a=a.isBlock;if(d("WAWebABProps").getABPropConfigValue("block_entry_point_logging_enabled")){var e;e=d("WAWebContactGetters").getIsMyContact(b)||((e=d("WAWebChatCollection").ChatCollection.get(b.id))==null?void 0:e.isTrusted());new(d("WAWebBlockEventsFsWamEvent").BlockEventsFsWamEvent)({blockEntryPoint:c,blockEventIsSuspicious:!e,blockEventIsUnsub:!d("WAWebContactGetters").getIsMyContact(b),blockEventActionType:a?d("WAWebWamEnumBlockEventActionType").BLOCK_EVENT_ACTION_TYPE.BLOCK:d("WAWebWamEnumBlockEventActionType").BLOCK_EVENT_ACTION_TYPE.UNBLOCK}).commit()}}g.logBlockEvent=a}),98);
__d("WAWebWebcResourceLoadWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcResourceLoad:[688,{webcResourceCached:[3,a.TYPES.BOOLEAN],webcResourceDuration:[2,a.TYPES.TIMER],webcResourceName:[1,a.TYPES.STRING]},[1,1e3,2e3],"regular"]},{WebcResourceLoad:[]});g.WebcResourceLoadWamEvent=b}),98);
__d("WAWebWamResourceLoadReporter",["WALogger","WAWebWebcResourceLoadWamEvent"],(function(a,b,c,d,e,f,g){var h;function a(){var a;a=(a=window.performance)==null?void 0:a.timing;if(!(a&&window.performance.getEntriesByType)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logResourceLoads metrics not provided by browser!"]))).devConsole("red");return}var b=window.performance.timing.fetchStart===window.performance.timing.domainLookupEnd;a=window.performance.getEntriesByType("resource");var c=document.createElement("a");a.forEach(function(a){a.initiatorType!=="xmlhttprequest"&&(c.href=a.name,new(d("WAWebWebcResourceLoadWamEvent").WebcResourceLoadWamEvent)({webcResourceName:c.pathname+c.search+c.hash,webcResourceDuration:Math.round(a.duration),webcResourceCached:b}).commit())})}g["default"]=a}),98);
__d("WAWebWamEnumWebcAppcacheStatusCode",[],(function(a,b,c,d,e,f){a=Object.freeze({UNCACHED:0,IDLE:1,CHECKING:2,DOWNLOADING:3,UPDATEREADY:4,OBSOLETE:5});f.WEBC_APPCACHE_STATUS_CODE=a}),66);
__d("WAWebWamEnumWebcNavigationType",[],(function(a,b,c,d,e,f){a=Object.freeze({NAVIGATE_NEXT:0,RELOAD:1,BACK_FORWARD:2,UNDEFINED:255});f.WEBC_NAVIGATION_TYPE=a}),66);
__d("WAWebWebcPageLoadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcAppcacheStatusCode","WAWebWamEnumWebcNavigationType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcPageLoad:[642,{webcAppcacheStatus:[29,d("WAWebWamEnumWebcAppcacheStatusCode").WEBC_APPCACHE_STATUS_CODE],webcCached:[30,a.TYPES.BOOLEAN],webcConnectEnd:[10,a.TYPES.TIMER],webcConnectStart:[9,a.TYPES.TIMER],webcDomComplete:[19,a.TYPES.TIMER],webcDomContentLoadedEventEnd:[18,a.TYPES.TIMER],webcDomContentLoadedEventStart:[17,a.TYPES.TIMER],webcDomInteractive:[16,a.TYPES.TIMER],webcDomLoading:[15,a.TYPES.TIMER],webcDomainLookupEnd:[8,a.TYPES.TIMER],webcDomainLookupStart:[7,a.TYPES.TIMER],webcExeDone:[23,a.TYPES.TIMER],webcExeStart:[22,a.TYPES.TIMER],webcFetchStart:[6,a.TYPES.TIMER],webcInitialMountT:[38,a.TYPES.TIMER],webcInitialNavMountT:[39,a.TYPES.TIMER],webcInitialPanel:[42,a.TYPES.STRING],webcInitialPanelMountStartT:[43,a.TYPES.TIMER],webcInitialPanelMountT:[40,a.TYPES.TIMER],webcInitialPanelRenderT:[46,a.TYPES.TIMER],webcJsLoadT:[37,a.TYPES.TIMER],webcLoadEventEnd:[21,a.TYPES.TIMER],webcLoadEventStart:[20,a.TYPES.TIMER],webcLoadInForeground:[53,a.TYPES.BOOLEAN],webcMainScriptEnd:[45,a.TYPES.TIMER],webcMainScriptStart:[44,a.TYPES.TIMER],webcNativeLoadT:[36,a.TYPES.TIMER],webcNavigation:[32,d("WAWebWamEnumWebcNavigationType").WEBC_NAVIGATION_TYPE],webcPageLoadId:[54,a.TYPES.STRING],webcPageLoadT:[34,a.TYPES.TIMER],webcParallellyFetched:[41,a.TYPES.BOOLEAN],webcQrCode:[31,a.TYPES.BOOLEAN],webcRedirectCount:[33,a.TYPES.NUMBER],webcRedirectEnd:[5,a.TYPES.TIMER],webcRedirectStart:[4,a.TYPES.TIMER],webcRequestStart:[12,a.TYPES.TIMER],webcResponseEnd:[14,a.TYPES.TIMER],webcResponseStart:[13,a.TYPES.TIMER],webcSecureConnectionStart:[11,a.TYPES.TIMER],webcUnloadEventEnd:[3,a.TYPES.TIMER],webcUnloadEventStart:[2,a.TYPES.TIMER],webcWsAttempts:[28,a.TYPES.NUMBER],webcWsNormal:[27,a.TYPES.TIMER],webcWsOpening:[24,a.TYPES.TIMER],webcWsPairing:[25,a.TYPES.TIMER],webcWsSyncing:[26,a.TYPES.TIMER]},[1,1,1],"regular"]},{WebcPageLoad:[]});g.WebcPageLoadWamEvent=b}),98);
__d("WAWebWamPageLoadReporter",["Promise","WALogger","WAWebAppScreen","WAWebPageLoadLogging","WAWebStreamModel","WAWebWam","WAWebWamResourceLoadReporter","WAWebWebcPageLoadWamEvent","once"],(function(a,b,c,d,e,f,g){var h,i,j,k=new(d("WAWebWebcPageLoadWamEvent").WebcPageLoadWamEvent)(),l,m={},n,o,p=!1,q=!1;function a(){return{uiTimingComplete:p,wsTimingComplete:q}}b=new(j||(j=b("Promise")))(function(a){return n=function(){p=!0,a()}});var r=new j(function(a){return o=function(){q=!0,a()}}),s=!1,t;function e(a,b,c){u(a);var d=Math.floor(self.performance.now());m[a]=d;c&&(m.socketSequence=b,o())}function u(a){switch(a){case d("WAWebStreamModel").StreamInfo.OPENING:d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_opening");break;case d("WAWebStreamModel").StreamInfo.PAIRING:d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_pairing");break;case d("WAWebStreamModel").StreamInfo.NORMAL:d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_ws_normal");break;default:return}}function v(a){d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_mount_t"),l=a}function w(a){if(k==null)return;k.set({webcInitialPanel:a})}function x(){n()}window.document&&(t=!document.hidden,document.addEventListener("visibilitychange",z));void j.all([b,r]).then(function(){A(),c("WAWebWamResourceLoadReporter")(),s||(s=!0,d("WAWebWam").Wam.resumeJobs())});function y(a){return!self.performance||!self.performance.timing||!self.performance.timing.navigationStart?null:a-self.performance.timing.navigationStart}function z(){if(!k)return;document.hidden&&(t=!1)}function A(){var a;if(!((a=self.performance)!=null&&a.timing&&self.performance.navigation)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logPageLoad metrics not provided by browser!"]))).devConsole("red");return}if(!k)return;a=k;var b=self.performance.timing,c=self.performance.navigation,e=b.navigationStart,f=b.loadEventEnd-e;if(f<=0){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MetricReporter:logPageLoad delayed"]))).devConsole("blue");self.setTimeout(A,1e4);return}function g(a){a=b[a];return a&&y(a)}a.set({webcPageLoadT:f,webcUnloadEventStart:g("unloadEventStart"),webcUnloadEventEnd:g("unloadEventEnd"),webcRedirectStart:g("redirectStart"),webcRedirectEnd:g("redirectEnd"),webcFetchStart:g("fetchStart"),webcDomainLookupStart:g("domainLookupStart"),webcDomainLookupEnd:g("domainLookupEnd"),webcConnectStart:g("connectStart"),webcConnectEnd:g("connectEnd"),webcSecureConnectionStart:g("secureConnectionStart"),webcRequestStart:g("requestStart"),webcResponseStart:g("responseStart"),webcResponseEnd:g("responseEnd"),webcDomLoading:g("domLoading"),webcDomInteractive:g("domInteractive"),webcDomContentLoadedEventStart:g("domContentLoadedEventStart"),webcDomContentLoadedEventEnd:g("domContentLoadedEventEnd"),webcDomComplete:g("domComplete"),webcLoadEventStart:g("loadEventStart"),webcLoadEventEnd:g("loadEventEnd"),webcCached:b.fetchStart===b.domainLookupEnd,webcNavigation:c.type,webcRedirectCount:c.redirectCount,webcWsOpening:m.OPENING,webcWsPairing:m.PAIRING,webcWsSyncing:m.SYNCING,webcWsNormal:m.NORMAL,webcWsAttempts:m.socketSequence,webcQrCode:!m.SYNCING,webcInitialPanelMountT:l-e,webcLoadInForeground:t,webcPageLoadId:d("WAWebPageLoadLogging").getPageLoadId()});B(a);a.commit();window.document&&document.removeEventListener("visibilitychange",z);k=null}function B(a){var b;(b=d("WAWebPageLoadLogging")).addPageLoadValidationData("webc_ws_opening",{wam:a.webcWsOpening});b.addPageLoadValidationData("webc_ws_pairing",{wam:a.webcWsPairing});b.addPageLoadValidationData("webc_ws_normal",{wam:a.webcWsNormal});b.addPageLoadValidationData("webc_initial_panel_mount_t",{wam:a.webcInitialPanelMountT});b.addPageLoadValidationData("webc_initial_panel_mount_start_t",{wam:a.webcInitialPanelMountStartT});b.addPageLoadValidationData("webc_initial_panel_render_t",{wam:a.webcInitialPanelRenderT});b.setWamCompleteForValidation()}b=function(){function a(a){this.$4=!1,this.$3=a.label,this.$1=a.startProperty,this.$2=a.endProperty}var b=a.prototype;b.start=function(){var a;this.$4=!0;if(k==null)return;k.set((a={},a[this.$1]=y(Date.now()),a))};b.end=function(){var a;if(k==null)return;k.set((a={},a[this.$2]=y(Date.now()),a))};b.hasStarted=function(){return this.$4};return a}();function f(a){if(I.hasStarted())return;if(!C(a))return;w(a);I.start();d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_mount_start_t");window.requestAnimationFrame(function(){I.end(),d("WAWebPageLoadLogging").addPageLoadQplPoint("webc_initial_panel_render_t"),F("initialPanelRenderTRecorded")})}function C(a){return a!==d("WAWebAppScreen").AppScreen.SYNCING}var D=!1,E=!1;function F(a){a==="initialPanelMountTRecorded"&&(D=!0),a==="initialPanelRenderTRecorded"&&(E=!0),D&&E&&x()}r=c("once")(function(){v(Date.now()),F("initialPanelMountTRecorded")});var G=new b({label:"PageLoad.webcExe",startProperty:"webcExeStart",endProperty:"webcExeDone"}),H=new b({label:"PageLoad.webcMainScript",startProperty:"webcMainScriptStart",endProperty:"webcMainScriptEnd"}),I=new b({label:"PageLoad.webcInitialPanelRender",startProperty:"webcInitialPanelMountStartT",endProperty:"webcInitialPanelRenderT"});g.getWamPageLoadTimingCompletion=a;g.streamInfoChange=e;g.logWamPageLoad=A;g.maybeLogInitialScreenRenderStart=f;g.logFirstRenderMountTimeOnce=r;g.exeTimer=G;g.mainScriptTimer=H}),98);
__d("WAWebAlbumsFormatAlbumMessageText",["fbt","WAWebAlbumMessageUtils","WAWebFbtIntlList","WAWebMessageAssociationUIUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.associatedMessages;a=a.msg;b=d("WAWebAlbumMessageUtils").getAlbumPhotoAndVideoCountText(b!=null?b:d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(a.id));return b.length===0?h._(/*BTDS*/"Album"):c("WAWebFbtIntlList")(b,c("WAWebFbtIntlList").CONJUNCTIONS.NONE,c("WAWebFbtIntlList").DELIMITERS.COMMA).toString()}g["default"]=a}),226);
__d("WAWebAlbumMessageUtils",["fbt","WAWebFrontendMsgGetters"],(function(a,b,c,d,e,f,g,h){function a(a){a=a.reduce(function(a,b){d("WAWebFrontendMsgGetters").getAsImage(b)?a.photoCount+=1:d("WAWebFrontendMsgGetters").getAsVideo(b)&&(a.videoCount+=1);return a},{photoCount:0,videoCount:0});var b=a.photoCount;a=a.videoCount;b=b>0?h._(/*BTDS*/"_j{\"*\":\"{photo-count} photos\",\"_1\":\"1 photo\"}",[h._plural(b,"photo-count")]):null;a=a>0?h._(/*BTDS*/"_j{\"*\":\"{video-count} videos\",\"_1\":\"1 video\"}",[h._plural(a,"video-count")]):null;return[b,a].filter(Boolean)}g.getAlbumPhotoAndVideoCountText=a}),226);
__d("WAWebBizAiAgentGating",["WAWebABProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("biz_ai_smb_agents_automatic_reply_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("biz_ai_web_ai_hub_tap_cta_show_alert")}function c(){return d("WAWebABProps").getABPropConfigValue("biz_ai_auto_save_enabled")}function e(){return d("WAWebABProps").getABPropConfigValue("biz_ai_in_thread_unmute_v2")}function f(){return d("WAWebABProps").getABPropConfigValue("biz_ai_coaching_enabled")}function h(){return d("WAWebABProps").getABPropConfigValue("biz_ai_agent_thread_status_history_sync_enabled")}g.isAiAgentAutoReplyEnabled=a;g.isAiHubTapCtaShowAlertEnabled=b;g.isAiAgentAutoSaveEnabled=c;g.isAiMuteUnmuteV2Enabled=e;g.isAiCoachingEnabled=f;g.isAiAgentThreadStatusHistorySyncEnabled=h}),98);
__d("WAWebBizAiAgentStatusUtils",["WAWebBizAiAgentGating","WAWebBusinessProfileCollection","WAWebContactGetters","WAWebMobilePlatforms","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function h(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();a=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(a);return(a==null?void 0:a.isBizBot1p)===!0}function a(a){var b=d("WAWebContactGetters").getIsMe(a.contact),c=d("WAWebContactGetters").getIsAiHub(a.contact);return d("WAWebMobilePlatforms").isSMB()&&d("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&!b&&a.id.isUserNotPSA()&&h()&&!c}function i(a){return a.capiThreadControl===d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN}function b(a){return i(a)&&!a.forceDismissAiAgentBlockBar}function c(a){return i(a)}function e(a){return a.attempToEnableAi===!0}g.hasOnboardedAiAgent=h;g.isChatEligibleForAiAgent=a;g.isChatAiEnabled=i;g.shouldShowAiAgentBlockBar=b;g.shouldMuteNotification=c;g.tryToEnableAiAgent=e}),98);
__d("WAWebMuteGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createMuteCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;d=b("callExpiration");a=b("expiration");e=c(function(a){a=a[0];return!!a},[a]);b=c(function(a){a=a[0];return!!a},[d]);g.clearMuteGetterCacheFor=f;g.getCallExpiration=d;g.getExpiration=a;g.getIsMuted=e;g.getIsCallMuted=b}),98);
__d("WAWebNotificationMuteReason",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["ParentMsgMissing","GlobalMute","AppState","MutedChat","ArchivedChat","OfflineResumeInProgress","IgnoreGroupMsg","GroupFlood","ReactionFlood","NonHydratedReaction","MutedStatus","AlreadyNotifiedKic","KicOnNonEphemeralChat","KicOnNonOriginalMsg","KicByMe","UserLeftGroupKic","IgnoreAddedToCommunityHome","IgnoreFutureProof","IgnoreBizContentPlaceholder","IgnoreCallMsgs","IgnoreBotMsgs","IgnoreInternalSilentTag","IgnoreHiddenViewModeMsgs","AIRepliesOn","MutedStatusReaction","IgnoreViewedMsgs","GroupSafetyCheck"]);c=a;f["default"]=c}),66);
__d("WAWebAiHandoffNotification",["fbt","WAWebBaseNotification","WAWebFrontendContactGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var c;b=b.chat;c=a.call(this)||this;c.chat=b;return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(a){if(d("WAWebNotificationHelpers").shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState;if(d("WAWebMuteGetters").getIsMuted(this.chat.mute))return c("WAWebNotificationMuteReason").MutedChat;if(this.chat.archive)return c("WAWebNotificationMuteReason").ArchivedChat;return d("WAWebNotificationHelpers").isOfflineResumeInProgress()?c("WAWebNotificationMuteReason").OfflineResumeInProgress:null};f.buildKey=function(){return"handoff:"+this.chat.id.toString()};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){return{wid:this.chat.id,title:i(),body:d("WAWebGetNotificationStrings").getNotificationBody(babelHelpers["extends"]({},j(this.chat)))}};return e}(d("WAWebBaseNotification").WABaseNotification);function i(){return h._(/*BTDS*/"Whatsapp Business AI").toString()}function j(a){a=d("WAWebFrontendContactGetters").getFormattedName(a.contact);a=h._(/*BTDS*/"{name}'s conversation needs your attention",[h._param("name",a)]);return{body:a.toString()}}g.AiHandoffNotification=a;g.getNotificationTitle=i;g.getNotificationParts=j}),226);
__d("WAWebOrderRequestMsg.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["SMB_META_CATALOG","NATIVE","UNKNOWN"]);f.CatalogType=a}),66);
__d("WAWebLinkedCatalogHelper",["WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebCatalogCollection","WAWebMobilePlatforms","WAWebOrderRequestMsg.flow","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();return h(a)}function h(a){var b,c=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(d("WAWebMobilePlatforms").isSMB()&&c.equals(a)){c=d("WAWebCatalogCollection").CatalogCollection.get(a);return(c==null?void 0:c.catalogType)===d("WAWebOrderRequestMsg.flow").CatalogType.SMB_META_CATALOG}c=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(a);return(c==null||(b=c.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG}g.shouldHideComponentForSMBLinkedCatalog=a;g.isLinkedCatalog=h}),98);
__d("WAWebWamEnumCatalogEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({CATALOG_ENTRY_POINT_PROFILE:1,CATALOG_ENTRY_POINT_SETTINGS:2,CATALOG_ENTRY_POINT_MESSAGE:3,CATALOG_ENTRY_POINT_ATTACHMENT_PANEL:4,CATALOG_ENTRY_POINT_NUX:5,CATALOG_ENTRY_POINT_DEEPLINK:6,CATALOG_ENTRY_POINT_CHAT:7,CATALOG_ENTRY_POINT_ORDER_MESSAGE:8,CATALOG_ENTRY_POINT_INVOICE_ATTACHMENT_PANEL:9,CATALOG_ENTRY_POINT_PRODUCT_LIST_MESSAGE:10,CATALOG_ENTRY_POINT_TOP_BAR:11,CATALOG_ENTRY_POINT_PROFILE_ITEM_CLICK:12,CATALOG_ENTRY_POINT_PROFILE_SEE_ALL:13,CATALOG_ENTRY_POINT_QUOTED_PRODUCT:14,CATALOG_ENTRY_POINT_CATALOG_MESSAGE:15,CATALOG_ENTRY_QBM:16,CATALOG_ENTRY_POINT_ADS_DEEPLINK:17,CATALOG_ENTRY_POINT_WA_PAGES:18,CATALOG_ENTRY_POINT_DIRECTORY_BARE_TIPS:19,CATALOG_ENTRY_POINT_BIZ_ACTION_BAR:20,CATALOG_ENTRY_POINT_BIZ_ONBOARDING:21,CATALOG_ENTRY_POINT_TRUST_CARD:22,CATALOG_ENTRY_POINT_FLOWS:23,CATALOG_ENTRY_POINT_BIZ_AI_HOME:24,CATALOG_ENTRY_POINT_BUSINESS_HOME:25,CATALOG_ENTRY_POINT_LEARNING_HUB:26});f.CATALOG_ENTRY_POINT=a}),66);
__d("WAWebWamEnumCatalogViewAction",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTION_CARD_ITEM_CLICK:2,ACTION_CARD_MORE_CLICK:3,ACTION_LIST_IMPRESSION:4,ACTION_DETAIL_IMAGE_CLICK:6,ACTION_DETAIL_LINK_CLICK:7,ACTION_FULL_IMAGE_SWIPE:11,ACTION_DETAIL_IMPRESSION:12,ACTION_REPORT_PRODUCT:13,ACTION_SEND_PRODUCT_MESSAGE:14,ACTION_REPORT_PRODUCT_SUCCESS:15,ACTION_REPORT_PRODUCT_FAILURE:16,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:17,ACTION_PRODUCT_IN_CONVERSATION_CLICK:18,ACTION_SHARE_CATALOG_LINK_CLICK:19,ACTION_SHARE_PRODUCT_LINK_CLICK:20,ACTION_CATALOG_IN_CONVERSATION_CLICK:21,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:22,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:23,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:24,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:25,ACTION_CHAT_CATALOG_ICON_CLICK:26,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:27,ACTION_CART_ADD_PRODUCT:28,ACTION_CART_EDIT_PRODUCT:29,ACTION_CART_DELETE_PRODUCT:30,ACTION_CART_ABANDON:31,ACTION_CART_ICON_CLICK:32,ACTION_CART_SNACKBAR_CLICK:33,ACTION_SEND_ORDER_MESSAGE:34,ACTION_ORDER_LIST_IMPRESSION:35,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:36,ACTION_CART_LIST_IMPRESSION:37,ACTION_ORDER_MESSAGE_CLICK:38,ACTION_ORDER_LIST_ITEM_CLICK:39,ACTION_PLM_CART_CTA_CLICK:40,ACTION_CART_CHAT_ICON_CLICK:42,ACTION_CREATE_CART:43,ACTION_PLP_PRODUCT_VARIANT_BOTTOM_SHEET_OPEN:44,ACTION_PLP_PRODUCT_VARIANT_CHANGE:45,ACTION_PDP_PRODUCT_VARIANT_CHANGE:46,ACTION_PLP_BOTTOM_SHEET_SEE_MORE_DETAILS:47,ACTION_UPDATE_VARIANT_SELECTION:48,ACTION_VIEW_PRODUCT_VARIANTS_BOTTOM_SHEET:49,ACTION_WATCH_PRODUCT_VIDEO:50,ACTION_DETAIL_VIDEO_CLICK:51,ACTION_FULL_VIDEO_SWIPE:52,ACTION_LIST_LOAD:53,ACTION_DETAIL_LOAD:54});f.CATALOG_VIEW_ACTION=a}),66);
__d("WAWebWamEnumDeepLinkOpenFrom",[],(function(a,b,c,d,e,f){a=Object.freeze({DEEP_LINK_EXTERNAL:1,DEEP_LINK_WA_LINK_CLICK:2,QR_CODE_SHEET:3,DEEP_LINK_BANNER:4,DEEP_LINK_SMB_NOTIFICATION:5,DEEP_LINK_MESSENGER_APP:6});f.DEEP_LINK_OPEN_FROM=a}),66);
__d("WAWebBizCatalogViewWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBizPlatform","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumCatalogViewAction","WAWebWamEnumDeepLinkOpenFrom","WAWebWamEnumEntryPointConversationInitiated"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({BizCatalogView:[3006,{adId:[26,a.TYPES.STRING],bizPlatform:[14,d("WAWebWamEnumBizPlatform").BIZ_PLATFORM],cartToggle:[13,a.TYPES.BOOLEAN],catalogCategoryId:[19,a.TYPES.STRING],catalogEntryPoint:[2,d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT],catalogEventSampled:[11,a.TYPES.BOOLEAN],catalogOwnerJid:[10,a.TYPES.STRING],catalogReportReasonCode:[8,a.TYPES.STRING],catalogSessionId:[3,a.TYPES.STRING],catalogViewAction:[1,d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION],collectionId:[15,a.TYPES.STRING],collectionIndex:[16,a.TYPES.STRING],deepLinkOpenFrom:[12,d("WAWebWamEnumDeepLinkOpenFrom").DEEP_LINK_OPEN_FROM],entryPointConversationInitiated:[22,d("WAWebWamEnumEntryPointConversationInitiated").ENTRY_POINT_CONVERSATION_INITIATED],entryPointConversionApp:[20,a.TYPES.STRING],entryPointConversionSource:[21,a.TYPES.STRING],hasVariants:[23,a.TYPES.BOOLEAN],isNewProductAddedToCart:[7,a.TYPES.BOOLEAN],isOrderMsgAttached:[5,a.TYPES.BOOLEAN],orderId:[4,a.TYPES.STRING],productId:[9,a.TYPES.STRING],productIndex:[17,a.TYPES.STRING],quantity:[6,a.TYPES.INTEGER],sequenceNumber:[18,a.TYPES.INTEGER],variantTypes:[24,a.TYPES.STRING],variantsExtraAttributes:[25,a.TYPES.STRING]},[1,1,1],"private",0]},{BizCatalogView:[]});g.BizCatalogViewWamEvent=b}),98);
__d("WAWebWamEnumCatalogBizAction",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTION_PRODUCT_ADD_CLICKED:1,ACTION_PRODUCT_ADD_SUCCESS:2,ACTION_PRODUCT_ADD_FAILED:3,ACTION_PRODUCT_EDIT_CLICKED:4,ACTION_PRODUCT_EDIT_SUCCESS:5,ACTION_PRODUCT_EDIT_FAILED:6,ACTION_PRODUCT_DELETE_CLICKED:7,ACTION_PRODUCT_DELETE_SUCCESS:8,ACTION_PRODUCT_DELETE_FAILED:9,ACTION_APPEAL_PRODUCT_CLICKED:10,ACTION_APPEAL_PRODUCT_SUCCESS:11,ACTION_APPEAL_PRODUCT_FAILED:12,ACTION_CREATE_PRODUCT_CATALOG:13,ACTION_CREATE_PRODUCT_CATALOG_SUCCESS:14,ACTION_CREATE_PRODUCT_CATALOG_FAILED:15,ACTION_CATALOG_MENU_ITEM_CLICKED:16,ACTION_PRODUCT_RESUBMIT_CLICKED:17,ACTION_START_IMPORT_FLOW:18,ACTION_IMPORT_POST:19,ACTION_CARD_ITEM_CLICK:21,ACTION_CARD_MORE_CLICK:22,ACTION_LIST_IMPRESSION:23,ACTION_DETAIL_IMAGE_CLICK:25,ACTION_DETAIL_LINK_CLICK:26,ACTION_FULL_IMAGE_SWIPE:30,ACTION_DETAIL_IMPRESSION:31,ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK:32,ACTION_PRODUCT_IN_CONVERSATION_CLICK:33,ACTION_SEND_PRODUCT_MESSAGE:34,ACTION_ONBOARD_IMPRESSION:35,ACTION_SHARE_CATALOG_LINK_CLICK:36,ACTION_SHARE_PRODUCT_LINK_CLICK:37,ACTION_CATALOG_IN_CONVERSATION_CLICK:38,ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK:39,ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK:40,ACTION_SHARE_CATALOG_COPY_LINK_CLICK:41,ACTION_SHARE_PRODUCT_COPY_LINK_CLICK:42,ACTION_SEND_CATALOG_CLICK:43,ACTION_ORDER_MESSAGE_CLICK:44,ACTION_ORDER_LIST_IMPRESSION:45,ACTION_ORDER_LIST_ITEM_CLICK:46,ACTION_MESSAGE_BUSINESS_BUTTON_CLICK:47,ACTION_QUOTED_PRODUCT_MESSAGE_SEND:48,ACTION_CART_ADD_PRODUCT:49,ACTION_CART_ICON_CLICK:50,ACTION_CART_SNACKBAR_CLICK:51,ACTION_CART_LIST_IMPRESSION:52,ACTION_CART_EDIT_PRODUCT:53,ACTION_CART_DELETE_PRODUCT:54,ACTION_CART_ABANDON:55,ACTION_SEND_ORDER_MESSAGE:56,ACTION_MENU_CLICK:57,ACTION_PRODUCT_HIDE_CLICKED:58,ACTION_PRODUCT_HIDE_SUCCESS:59,ACTION_PRODUCT_HIDE_CANCELLED:60,ACTION_PRODUCT_HIDE_FAILED:61,ACTION_PRODUCT_UNHIDE_CLICKED:62,ACTION_PRODUCT_UNHIDE_SUCCESS:63,ACTION_PRODUCT_UNHIDE_CANCELLED:64,ACTION_PRODUCT_UNHIDE_FAILED:65,ACTION_CATALOG_LIST_MENU_CLICKED:66,ACTION_CATALOG_LIST_MENU_CLICKED_WITH_ADVERTISE_SHOWN:67,ACTION_COLLECTION_CREATE_CLICKED:68,ACTION_COLLECTION_CREATED:69,ACTION_MENU_COLLECTIONS_CLICK:70,ACTION_COLLECTION_RENAME_CLICKED:71,ACTION_COLLECTION_RENAME_CANCELLED:72,ACTION_COLLECTION_RENAMED:73,ACTION_COLLECTION_DELETE_CLICKED:74,ACTION_COLLECTION_DELETE_CANCELLED:75,ACTION_COLLECTION_DELETED:76,ACTION_COLLECTION_ASSIGN_ITEMS:77,ACTION_COLLECTION_UNASSIGN_ITEMS:78,ACTION_COLLECTION_CHANGE_ORDER:80,ACTION_COLLECTION_ITEM_CHANGE_ORDER:81,ACTION_ERROR_SAVING_ITEM:82,ACTION_MEDIA_DELETE_SUCCESS:83,ACTION_SAVING_PRODUCT_PROGRESS_BAR:84,ACTION_CONTINUE_SAVING_PRODUCT:85,ACTION_ABORT_SAVING_PRODUCT:86,ACTION_CLICK_SAVE_PRODUCT:87,ACTION_CHOOSE_PRODUCT_INTENT:88,ACTION_DETAIL_VIDEO_CLICK:89,ACTION_WATCH_PRODUCT_VIDEO:90,ACTION_FULL_VIDEO_SWIPE:91,ACTION_PROCEED_TO_REPLACE_MEDIA:92,ACTION_PRODUCT_LINK_SHARE_TO_STATUS_BTN_IMPRESSION:93,ACTION_PRODUCT_LINK_SHARE_TO_STATUS_BTN_CLICKED:94,ACTION_CATALOG_LINK_SHARE_TO_STATUS_BTN_IMPRESSION:95,ACTION_CATALOG_LINK_SHARE_TO_STATUS_BTN_CLICKED:96});f.CATALOG_BIZ_ACTION=a}),66);
__d("WAWebCatalogBizWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCatalogBizAction","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumDeepLinkOpenFrom","WAWebWamEnumLastMessageDirection"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CatalogBiz:[1722,{adId:[19,a.TYPES.STRING],cartToggle:[13,a.TYPES.BOOLEAN],catalogAppealReason:[4,a.TYPES.STRING],catalogBizAction:[1,d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION],catalogEntryPoint:[7,d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT],catalogSessionId:[3,a.TYPES.STRING],collectionCount:[18,a.TYPES.INTEGER],collectionId:[14,a.TYPES.STRING],collectionIndex:[15,a.TYPES.STRING],deepLinkOpenFrom:[8,d("WAWebWamEnumDeepLinkOpenFrom").DEEP_LINK_OPEN_FROM],entryPointConversionSource:[20,a.TYPES.STRING],errorCode:[5,a.TYPES.INTEGER],extraAttributes:[24,a.TYPES.STRING],isOrderMsgAttached:[10,a.TYPES.BOOLEAN],lastMessageDirection:[21,d("WAWebWamEnumLastMessageDirection").LAST_MESSAGE_DIRECTION],messageDepth:[22,a.TYPES.INTEGER],orderId:[9,a.TYPES.STRING],productCount:[6,a.TYPES.INTEGER],productId:[2,a.TYPES.STRING],productIds:[12,a.TYPES.STRING],productIndex:[16,a.TYPES.STRING],quantity:[11,a.TYPES.INTEGER],threadIdHmac:[23,a.TYPES.STRING]},[1,1,1],"regular"]},{CatalogBiz:[]});g.CatalogBizWamEvent=b}),98);
__d("WAWebProductCatalogSession",["WALogger"],(function(a,b,c,d,e,f,g){var h,i="accidental_session";a=function(){function a(a){this.accidental=a||!1,this.initSessionId()}var b=a.prototype;b.isAccidental=function(){return this.accidental};b.initSessionId=function(){this.sessionId=this.newSessionId()};b.newSessionId=function(){this.sessionId=Math.floor(2147483648*Math.random());return this.sessionId};b.toString=function(){var a=""+this.sessionId;this.accidental&&(d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Session ID requested without being set, returning a randon accidental session. Please investigate."]))),a=i+"_"+a);return a};return a}();g.ProductCatalogSession=a}),98);
__d("WAWebProductCatalogContext",["WAWebProductCatalogSession","WAWebWamEnumBizPlatform"],(function(a,b,c,d,e,f,g){function h(a,b,c){a===void 0&&(a=new(d("WAWebProductCatalogSession").ProductCatalogSession)());b===void 0&&(b=d("WAWebWamEnumBizPlatform").BIZ_PLATFORM.UNKNOWN);return{type:"product_catalog",session:a,entryPoint:c,bizPlatform:b}}function i(){return h(new(d("WAWebProductCatalogSession").ProductCatalogSession)(!0))}function a(a){return j(a).session.toString()}function j(a){return a.type==="product_catalog"?a:i()}function b(a){return{catalogSessionId:a.session.toString(),bizPlatform:a.bizPlatform,catalogEntryPoint:a.entryPoint}}g.buildProductCatalogContext=h;g.getProductCatalogSessionId=a;g.getProductCatalogContext=j;g.toDataForCatalogViewEvents=b}),98);
__d("WAWebProductCatalogEventUtils",["WAWebBizCatalogViewWamEvent","WAWebBizGatingUtils","WAWebCatalogBizWamEvent","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h=["isOwner","catalogBizAction","catalogViewAction","bizActionConfig","bizPlatform","catalogOwnerJid"];a=function(a){var b;!c("isStringNullOrEmpty")(a.catalogOwnerJid)?b=d("WAWebWidFactory").createWid(a.catalogOwnerJid):a.catalogOwnerWid?b=a.catalogOwnerWid:a.product&&(b=a.product.catalogWid);return b instanceof c("WAWebWid")&&d("WAWebUserPrefsMeUser").isMeAccount(b)};b=function(a){var b=a.isOwner,c=a.catalogBizAction,e=a.catalogViewAction,f=a.bizActionConfig,g=a.bizPlatform,i=a.catalogOwnerJid;a=babelHelpers.objectWithoutPropertiesLoose(a,h);if(c&&b){new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)(babelHelpers["extends"]({catalogBizAction:c},a,f)).commit();return}if(e&&d("WAWebBizGatingUtils").isPSForCatalogViewEnabled()){new(d("WAWebBizCatalogViewWamEvent").BizCatalogViewWamEvent)(babelHelpers["extends"]({catalogViewAction:e,bizPlatform:g,catalogOwnerJid:i},a)).commit();return}};g.isCatalogOwner=a;g.logCatalogViewOrBizEvent=b}),98);
__d("WAWebProductCatalogLogEvents",["WAWebBizCatalogUtils","WAWebBizCatalogViewWamEvent","WAWebCatalogBizWamEvent","WAWebProductCatalogContext","WAWebProductCatalogEventUtils","WAWebProductCatalogSession","WAWebUserPrefsMeUser","WAWebWamEnumCatalogBizAction","WAWebWamEnumCatalogEntryPoint","WAWebWamEnumCatalogViewAction","WAWebWidFactory","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){function a(a){var b=a.catalogOwnerWid;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a),{isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b}),catalogOwnerJid:b.toJid()}))}function b(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CARD_ITEM_CLICK},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a),{catalogOwnerJid:b.catalogWid.toJid()}))}function e(a){var b=a.catalogOwnerWid;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CARD_MORE_CLICK,catalogOwnerJid:b.toJid()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function f(a){var b=a.catalogOwnerWid,c=a.catalogContext;a=a.cartToggle;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b}),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_LIST_IMPRESSION,catalogOwnerJid:b.toJid(),cartToggle:a},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(c)))}function h(a){var b=a.catalogOwnerWid;a=a.catalogContext;var c=d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b});d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:c,catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_LINK_CLICK,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_LINK_CLICK,catalogOwnerJid:b.toJid()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function i(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b})},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function j(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_IMAGE_CLICK,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_IMAGE_CLICK,catalogOwnerJid:b.catalogWid.toJid(),productId:b.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function k(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_LINK_CLICK,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_LINK_CLICK,productId:b.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function l(a){var b=a.product;a=a.catalogSessionId;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogSessionId:a})}function m(a){var b=a.product;a=a.catalogSessionId;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogSessionId:a})}function n(a){var b=a.product;a=a.catalogSessionId;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogSessionId:a})}function o(a){var b=a.product;a=a.catalogSessionId;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_FULL_IMAGE_SWIPE,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_FULL_IMAGE_SWIPE,catalogSessionId:a,productId:b.id.toString()})}function p(a){var b=a.product,c=a.catalogContext,e=a.cartToggle;a=a.collectionId;a=d("WAWebBizCatalogUtils").getProductStatsInFetched(b.catalogWid.toString(),a,b);d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({catalogOwnerJid:b.catalogWid.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_DETAIL_IMPRESSION,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_DETAIL_IMPRESSION,cartToggle:e},a,d("WAWebProductCatalogContext").toDataForCatalogViewEvents(c)))}function q(a){var b=a.product,c=a.catalogSessionId;a=a.reason;new(d("WAWebBizCatalogViewWamEvent").BizCatalogViewWamEvent)({catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_REPORT_PRODUCT_SUCCESS,catalogSessionId:c,catalogOwnerJid:b.catalogWid.toJid(),catalogReportReasonCode:a,productId:b.id.toString()}).commit()}function r(a){var b=a.product,c=a.catalogSessionId;a=a.reason;new(d("WAWebBizCatalogViewWamEvent").BizCatalogViewWamEvent)({catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_REPORT_PRODUCT_FAILURE,catalogOwnerJid:b.catalogWid.toJid(),catalogSessionId:c,catalogReportReasonCode:a,productId:b.id.toString()}).commit()}function s(a){var b=a.product;a=a.catalogContext;var c=d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b});d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:c,catalogOwnerJid:b.catalogWid.toJid(),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_QUOTED_PRODUCT_IN_CONVERSATION_CLICK},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function t(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogOwnerJid:b.catalogWid.toJid(),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_IN_CONVERSATION_CLICK},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function u(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_LINK_CLICK,catalogOwnerJid:b.catalogWid.toJid(),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_LINK_CLICK,productId:b.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function v(a,b){d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:a}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_MESSAGE_BUSINESS_BUTTON_CLICK,catalogOwnerJid:a.catalogWid.toJid(),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_MESSAGE_BUSINESS_BUTTON_CLICK,productId:a.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(b)))}function w(a,b){var e,f=!1,g="";a.businessOwnerJid!=null&&(g=a.businessOwnerJid,f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow().equals(d("WAWebWidFactory").createWid(g)));d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({isOwner:f,catalogOwnerJid:g,catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_QUOTED_PRODUCT_MESSAGE_SEND,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_QUOTED_PRODUCT_MESSAGE_SEND,productId:a==null||(e=a.productId)==null?void 0:e.toString(),catalogSessionId:c("isStringNullOrEmpty")(b)?new(d("WAWebProductCatalogSession").ProductCatalogSession)().toString():b})}function x(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_COPY_LINK_CLICK,catalogOwnerJid:b.catalogWid.toJid(),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_COPY_LINK_CLICK,productId:b.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function y(a){var b=a.product;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogOwnerJid:b.catalogWid.toJid(),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_PRODUCT_VIA_WA_LINK_CLICK,productId:b.id.toString()},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function z(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CATALOG_IN_CONVERSATION_CLICK,catalogEntryPoint:d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_ATTACHMENT_PANEL,catalogSessionId:a});a.commit()}function A(a){var b=a.product;a=a.catalogSessionId;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({product:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SEND_PRODUCT_MESSAGE,catalogOwnerJid:b.catalogWid.toJid(),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SEND_PRODUCT_MESSAGE,catalogSessionId:a,productId:b.id.toString()})}function B(a){a.catalogOwnerWid;a=a.catalogSessionId;a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SEND_CATALOG_CLICK,catalogSessionId:a});a.commit()}function C(a){var b=a.catalogOwnerWid;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_COPY_LINK_CLICK,catalogOwnerJid:b.toJid(),catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_COPY_LINK_CLICK},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function D(a){var b=a.catalogOwnerWid;a=a.catalogContext;d("WAWebProductCatalogEventUtils").logCatalogViewOrBizEvent(babelHelpers["extends"]({catalogOwnerJid:b.toJid(),isOwner:d("WAWebProductCatalogEventUtils").isCatalogOwner({catalogOwnerWid:b}),catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK,catalogViewAction:d("WAWebWamEnumCatalogViewAction").CATALOG_VIEW_ACTION.ACTION_SHARE_CATALOG_VIA_WA_LINK_CLICK},d("WAWebProductCatalogContext").toDataForCatalogViewEvents(a)))}function E(a,b){b={has_catalog:b};a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_CLICKED,catalogSessionId:a.session.toString(),catalogEntryPoint:a.entryPoint,extraAttributes:JSON.stringify(b)});a.commit()}function F(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_SUCCESS,catalogEntryPoint:a.entryPoint,catalogSessionId:a.session.toString()});a.commit()}function G(a,b){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_ADD_FAILED,catalogEntryPoint:a.entryPoint,catalogSessionId:a.session.toString(),errorCode:b});a.commit()}function H(a,b){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_CLICKED,productId:a.id.toString(),catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString()});a.commit()}function I(a,b){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_SUCCESS,catalogEntryPoint:b.entryPoint,productId:a.id.toString(),catalogSessionId:b.session.toString()});a.commit()}function J(a,b,c){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_EDIT_FAILED,catalogEntryPoint:b.entryPoint,productId:a.id.toString(),errorCode:c,catalogSessionId:b.session.toString()});a.commit()}function K(a,b,c){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_CLICKED,catalogEntryPoint:c.entryPoint,productId:a.id.toString(),productCount:b,catalogSessionId:c.session.toString()});a.commit()}function L(a,b,c){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_SUCCESS,catalogEntryPoint:c.entryPoint,productId:a.id.toString(),productCount:b,catalogSessionId:c.session.toString()});a.commit()}function M(a,b,c,e){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_DELETE_FAILED,catalogEntryPoint:c.entryPoint,productId:a.id.toString(),productCount:b,errorCode:e,catalogSessionId:c.session.toString()});a.commit()}function N(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_ONBOARD_IMPRESSION,catalogEntryPoint:a.entryPoint,catalogSessionId:a.session.toString()});a.commit()}function O(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG,catalogEntryPoint:a.entryPoint,catalogSessionId:a.session.toString()});a.commit()}function P(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG_SUCCESS,catalogEntryPoint:a.entryPoint,catalogSessionId:a.session.toString()});a.commit()}function Q(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_CREATE_PRODUCT_CATALOG_FAILED,catalogEntryPoint:a.entryPoint,errorCode:b,catalogSessionId:a.session.toString()});b.commit()}function R(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_CLICKED,catalogEntryPoint:d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,catalogSessionId:a});a.commit()}function S(a){a=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_SUCCESS,catalogEntryPoint:d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,catalogSessionId:a});a.commit()}function T(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_APPEAL_PRODUCT_FAILED,catalogEntryPoint:d("WAWebWamEnumCatalogEntryPoint").CATALOG_ENTRY_POINT.CATALOG_ENTRY_POINT_SETTINGS,errorCode:b,catalogSessionId:a});b.commit()}function U(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_MENU_CLICK,catalogEntryPoint:b==null?void 0:b.entryPoint,catalogSessionId:b==null?void 0:b.session.toString(),productId:a});b.commit()}function V(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_CLICKED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function W(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_SUCCESS,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function X(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_CANCELLED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function Y(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_HIDE_FAILED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function Z(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_CLICKED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function $(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_SUCCESS,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function aa(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_CANCELLED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}function ba(a,b){b=new(d("WAWebCatalogBizWamEvent").CatalogBizWamEvent)({catalogBizAction:d("WAWebWamEnumCatalogBizAction").CATALOG_BIZ_ACTION.ACTION_PRODUCT_UNHIDE_FAILED,catalogEntryPoint:b.entryPoint,catalogSessionId:b.session.toString(),productId:a});b.commit()}g.logBusinessProfileCatalogView=a;g.logProfileProductClick=b;g.logCarouselViewMoreClick=e;g.logCatalogListView=f;g.logCatalogShareLinkClick=h;g.logCatalogListDetailClick=i;g.logDetailImageClick=j;g.logDetailLinkClick=k;g.logImageCarouselModalView=l;g.logImageListClick=m;g.logFullImageView=n;g.logImageNavigate=o;g.logProductDetailView=p;g.logReportProductSuccess=q;g.logReportProductFailure=r;g.logProductInquiryClick=s;g.logProductMsgClick=t;g.logProductShareLinkClick=u;g.logProductMessageBusinessClick=v;g.logProductMessageBusinessSend=w;g.logShareProductCopyLinkClick=x;g.logShareProductViaWALinkClick=y;g.logCatalogAttachmentButtonClick=z;g.logProductMessageSent=A;g.logSendCatalogClick=B;g.logShareCatalogCopyLinkClick=C;g.logShareCatalogViaWALinkClick=D;g.logAddProductClick=E;g.logAddProductSuccess=F;g.logAddProductFailed=G;g.logEditProductClick=H;g.logEditProductSuccess=I;g.logEditProductFailed=J;g.logDeleteProductClick=K;g.logDeleteProductSuccess=L;g.logDeleteProductFailed=M;g.logCatalogOnboardImpression=N;g.logCreateProductCatalogClick=O;g.logCreateProductCatalogSuccess=P;g.logCreateProductCatalogFailed=Q;g.logAppealProductCatalogClick=R;g.logAppealProductCatalogSuccess=S;g.logAppealProductCatalogFailed=T;g.logCatalogContextMenuClick=U;g.logCatalogProductHideClick=V;g.logCatalogProductHideSuccess=W;g.logCatalogProductHideCancelled=X;g.logCatalogProductHideFailed=Y;g.logCatalogProductShowClick=Z;g.logCatalogProductShowSuccess=$;g.logCatalogProductShowCancelled=aa;g.logCatalogProductShowFailed=ba}),98);
__d("WAWebProductCatalogMetaLinkingGatingUtils",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";function a(){return h._(/*BTDS*/"Connected catalog. View with WhatsApp mobile app.")}function c(){if(!m())return!1;var a=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(d("WAWebUserPrefsMeUser").getMePnUserOrThrow());return n(a)}function e(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return!m()?!1:j(a)});return i.apply(this,arguments)}function f(){if(d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled())return!1;if(m())return!1;var a=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(d("WAWebUserPrefsMeUser").getMePnUserOrThrow());return n(a)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.fetchBizProfile(a));return n(a)});return k.apply(this,arguments)}function l(a){return n(a)}function m(){return d("WAWebABProps").getABPropConfigValue("meta_catalog_linking_m2_enabled")}function n(a){var b;if(o())return!0;return d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()?!1:(a==null||(b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG}function o(){var a=window.location.search;a=new URLSearchParams(a);return a.get("force_disable_catalog")==="1"}g.getDisabledMetaLinkedCatalogTooltipText=a;g.shouldShowMetaLinkedDisabledCatalogTooltipForSelf=c;g.shouldShowMetaLinkedDisabledCatalogTooltip=e;g.shouldDisableCatalogDueToMetaLinkingForSelf=f;g.shouldDisableCatalogDueToMetaLinking=j;g.shouldDisableCatalogDueToMetaLinkingForProfile=l;g.linkedCatalogDisabledTooltipEnabled=m}),226);
__d("WAWebPersistBotProfiles",["WAWebBotProfileCollection","WAWebSchemaBotProfile","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["id","prompts","commands"];function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaBotProfile").getBotProfileTable().bulkCreateOrMerge(a.map(function(a){var b=a.id,c=a.prompts,d=a.commands;a=babelHelpers.objectWithoutPropertiesLoose(a,h);return babelHelpers["extends"]({id:b.toString(),prompts:JSON.stringify(c),commands:JSON.stringify(d)},a)})),a.forEach(function(a){return d("WAWebBotProfileCollection").BotProfileCollection.gadd(babelHelpers["extends"]({id:a.id},a))})});return i.apply(this,arguments)}g.persistBotProfiles=a}),98);
__d("WAWebCreateBizBotSysMsgAction",["WAWebBotSystemMsg","WAWebBotTypes","WAWebDBProcessMessage","WAWebMsgModelFromData","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.bizBotSystemMsgType===d("WAWebBotTypes").BizBotType.BIZ_1P)return;var b=d("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(a.id);a.msgs.add(d("WAWebMsgModelFromData").msgModelFromMsgData(b));yield d("WAWebDBProcessMessage").storeMessages([b],a.id);yield a.updateBizBotSysMsgCreated(d("WAWebBotTypes").BizBotType.BIZ_1P)});return h.apply(this,arguments)}g.maybeCreateBizBot1pDisclosureSysMsg=a}),98);
__d("WAWebHandleBizBotAutomatedTypeAction",["WALogger","WAWebApiBusinessProfile","WAWebBotGating","WAWebBotSystemMsg","WAWebBotTos","WAWebBotTypes","WAWebBotUtils","WAWebChatCollection","WAWebContactSystemMsg","WAWebDBProcessMessage","WAWebMsgModelFromData","WAWebPrivacyModeSystemMsg","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=d("WAWebChatCollection").ChatCollection.get(a);if(!e)return;if(d("WAWebBotUtils").isMetaAiBot(a))return;b=b;if(!b){a=(yield d("WAWebApiBusinessProfile").getBusinessProfileRow(a.toString()));b=(a=d("WAWebBotTypes").BizBotAutomatedType.cast(a==null?void 0:a.automatedType))!=null?a:d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN}a=c!=null?c:d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN;if(b===a)return;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] handle automatedType transition for ",". prev: ",", next: ",""])),e.id.toString(),b,a);b===d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&a===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P?yield m(e):b===d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&a===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P?yield o(e):b===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P&&a===d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN&&(yield q(e))});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBotTos").hasAcceptedBizBotTos()||a.bizBotSystemMsgType===d("WAWebBotTypes").BizBotType.BIZ_1P)return;var b=d("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(a.id);yield d("WAWebDBProcessMessage").storeMessages([b],b.id.remote);if(d("WAWebBotGating").isBizBot1pEnabled()){b=d("WAWebMsgModelFromData").msgModelFromMsgData(b);a.msgs.add(b)}yield a.updateBizBotSysMsgCreated(d("WAWebBotTypes").BizBotType.BIZ_1P);d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created 1p system message for ",""])),a.id.toString())});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBotTos").hasAcceptedBizBotTos()||a.bizBotSystemMsgType===d("WAWebBotTypes").BizBotType.BIZ_3P)return;var b=d("WAWebBotSystemMsg").genBizBot3pDisclosureMessage(a.id);yield d("WAWebDBProcessMessage").storeMessages([b],b.id.remote);b=d("WAWebMsgModelFromData").msgModelFromMsgData(b);a.msgs.add(b);yield a.updateBizBotSysMsgCreated(d("WAWebBotTypes").BizBotType.BIZ_3P);d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created 3p system message for ",""])),a.id.toString())});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.bizBotSystemMsgType==null)return;var b=a.id,e,f=d("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(a.contact.privacyMode);switch(f){case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE:e=d("WAWebContactSystemMsg").genEncryptNotificationMsg(b,"encrypt_now");break;case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP:e=d("WAWebContactSystemMsg").genNonE2ENotificationMsg(b,"biz_privacy_mode_to_bsp");break;case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB:e=d("WAWebContactSystemMsg").genNonE2ENotificationMsg(b,"biz_privacy_mode_to_fb");break;case d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.HOSTED_GROUP:e=d("WAWebContactSystemMsg").genNonE2ENotificationMsg(b,"is_capi_hosted_group");break}if(!e)throw c("err")("Unhandled privacy mode");yield d("WAWebDBProcessMessage").storeMessages([e],e.id.remote);f=d("WAWebMsgModelFromData").msgModelFromMsgData(e);a.msgs.add(f);yield a.updateBizBotSysMsgCreated(null);d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] created generic privacy system message for ",""])),a.id.toString())});return r.apply(this,arguments)}g.handleBizBotAutomatedTypeTransition=a}),98);
__d("WAWebHandleBizBotWelcomeMsgProtocolModeAction",["WALogger","WAWebApiBusinessProfile","WAWebBotGating","WAWebBotTypes","WAWebBotWelcomeRequestSync","WAWebChatCollection","WAWebSyncdCoreApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(!d("WAWebBotGating").isBizBot3pAvailable())return;var e=d("WAWebChatCollection").ChatCollection.get(a);if(!e)return;b=b;if(!b){a=(yield d("WAWebApiBusinessProfile").getBusinessProfileRowLidAware(a.toString()));b=(a=d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.cast(a==null?void 0:a.welcomeMsgProtocolMode))!=null?a:d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE}a=c!=null?c:d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE;if(b===a)return;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] handle welcomeMsgProtocolMode transition for ",". prev: ",", next: ",""])),e.id.toString(),b,a);a===d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE&&(d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[biz-bot] reset welcome msg request flag to false"]))),yield k(e))});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.hasRequestedWelcomeMsg)return;a.hasRequestedWelcomeMsg=!1;var e=(yield c("WAWebBotWelcomeRequestSync").getBotWelcomeRequestSetMutation(a.id,!1));yield d("WAWebSyncdCoreApi").lockForSync(["chat"],[e],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];return b.merge(a.id.toString(),{hasRequestedWelcomeMsg:!1})});return function(a){return c.apply(this,arguments)}}())});return l.apply(this,arguments)}g.handleBizBotWelcomeMsgProtocolModeTransition=a}),98);
__d("WAWebBotProfileCategory",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({SYNTHETIC:"synthetic",LIVING:"living",FICTIONAL:"fictional",HISTORICAL:"historical"});f.BotProfileCategory=a}),66);
__d("WAWebRequestBotProfiles",["Promise","WALogger","WAWebBackendErrors","WAWebBotProfileCategory","WAWebUsync","WAWebUsyncUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return(i||(i=b("Promise"))).resolve([]);var e=new(d("WAWebUsync").USyncQuery)().withContext("interactive").withMode("query").withBotProfileProtocol();a.forEach(function(a){var b=a.id;a=a.personaId;e.withUser(new(d("WAWebUsyncUser").USyncUser)().withId(b).withPersonaId(a))});var f=(yield e.execute()),g=f.error.all||f.error.status;if(g)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(g.errorCode,g.errorText);g=f.list;if(!g.length){f=a.map(function(a){return a.id.toString()});d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Bot ids ",""])),f.join(", ")).sendLogs("noStatusDataForBots");return(i||(i=b("Promise"))).reject(c("err")("no status data returned for user"))}return g.map(function(a){var b=a.bot;a=a.id;return{id:a,name:b.name,attrs:b.attributes,description:b.description,category:(a=d("WAWebBotProfileCategory").BotProfileCategory.cast(b.category))!=null?a:d("WAWebBotProfileCategory").BotProfileCategory.SYNTHETIC,isDefault:b.isDefault,prompts:b.prompts,personaId:b.personaId,commands:b.commands,commandsDescription:b.commandsDescription,isMetaCreated:b.isMetaCreated,creatorName:b.creatorName,creatorProfileUrl:b.creatorProfileUrl,posingAsProfessional:b.posingAsProfessional,lastUpdateTs:Date.now()}})});return j.apply(this,arguments)}g.requestBotProfiles=a}),98);
__d("WAWebBotProfileAction",["WAWebRequestBotProfiles","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebRequestBotProfiles").requestBotProfiles([{id:a,isDefault:!1}]))[0];return a});return h.apply(this,arguments)}g.queryBotProfile=a}),98);
__d("WAWebBotProfileCollection",["WALogger","WAWebBaseCollection","WAWebBotGating","WAWebBotProfileAction","WAWebBotProfileModel","WAWebPersistBotProfiles","WAWebWidFactory","asyncToGeneratorRuntime","cr:10195"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;a=function(a){function c(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getDefaultBot=function(){return this.findFirst(function(a){return a.isDefault===!0})};e.findImpl=function(a){return this.$BotProfileCollectionImpl$p_1(a)};e.update=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!a.isFbidBot()){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["update only supports FBID bots"]))).devConsole(a);return}b=(b=(b=this.get(a))==null?void 0:b.lastUpdateTs)!=null?b:0;if(b+d("WAWebBotGating").ugcBotProfileSyncInterval()>Date.now()){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] skip updating bot profile"]))).devConsole({wid:a,lastUpdateTs:b});return}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] updating bot profile"]))).devConsole({wid:a,lastUpdateTs:b});yield this.$BotProfileCollectionImpl$p_1(a)});function c(b,c){return a.apply(this,arguments)}return c}();e.$BotProfileCollectionImpl$p_1=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebWidFactory").createWidFromWidLike(a);if(!b.isFbidBot()){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["_findAndParse only supports FBID bots"]))).devConsole(b);return null}var c=(yield d("WAWebBotProfileAction").queryBotProfile(b));d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[BotProfileCollection] query bot profile"]))).devConsole({wid:b,botProfile:c});if(!c){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unable to find bot profile with id"]))).devConsole(a);return null}yield d("WAWebPersistBotProfiles").persistBotProfiles([c]);return babelHelpers["extends"]({},c)});function c(b){return a.apply(this,arguments)}return c}();return c}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebBotProfileModel");e=new a();g.BotProfileCollection=e}),98);
__d("WAWebBotProfileModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.attrs=d("WAWebBaseModel").prop(""),b.description=d("WAWebBaseModel").prop(),b.category=d("WAWebBaseModel").prop(),b.isDefault=d("WAWebBaseModel").prop(),b.prompts=d("WAWebBaseModel").prop(function(){return[]}),b.personaId=d("WAWebBaseModel").prop(),b.commands=d("WAWebBaseModel").prop(function(){return[]}),b.commandsDescription=d("WAWebBaseModel").prop(),b.isMetaCreated=d("WAWebBaseModel").prop(),b.creatorName=d("WAWebBaseModel").prop(),b.creatorProfileUrl=d("WAWebBaseModel").prop(),b.posingAsProfessional=d("WAWebBaseModel").prop(),b.lastUpdateTs=d("WAWebBaseModel").prop(),b.contact=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd({id:this.id,name:this.name,verifiedName:this.name,shortName:this.name,pushName:this.name,isBusiness:!0,type:"out"}))};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="botProfile";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebBizBotHeroIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="biz-bot-hero";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=120;o=240;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 240 120",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsxs("g",{clipPath:"url(#a)",children:[k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m29.7 55.473 3.41.695-.655 3.178c-.423 1.963.859 3.872 2.836 4.281a3.66 3.66 0 0 0 4.336-2.795l.655-3.178 3.204.655a3.66 3.66 0 0 0 4.336-2.796c.423-1.963-.858-3.872-2.836-4.281l-3.204-.655.709-3.368c.423-1.964-.86-3.873-2.837-4.282a3.68 3.68 0 0 0-4.336 2.81l-.709 3.367-3.409-.695a3.68 3.68 0 0 0-4.336 2.81c-.423 1.963.859 3.872 2.836 4.281v-.027Z",fill:"#FCF5EB",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m186 33.355-.914-9.969c-.081-1.022-.736-1.922-1.691-2.372a2.978 2.978 0 0 0-2.918.259l-8.291 5.768a2.867 2.867 0 0 0-1.227 2.618c.082 1.023.736 1.923 1.691 2.373l9.205 4.2a2.924 2.924 0 0 0 2.918-.26A2.867 2.867 0 0 0 186 33.356Z",fill:"#73F793",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{d:"M159.3 22.555c-.655-4.5-4.173-7.814-8.359-7.814H65.754c-4.145 0-7.704 3.3-8.359 7.814L53.837 47.29h.041c0 6.654 2.946 12.368 7.405 16.254V91.95c0 6.86 5.468 12.464 12.273 12.695v.028h69.177c7.009 0 12.723-5.714 12.723-12.723V63.545c4.472-3.886 7.404-9.613 7.404-16.295l-3.56-24.695Z",fill:"white"}),k.jsx("path",{d:"M159.3 22.555c-.655-4.5-4.173-7.814-8.359-7.814H65.754c-4.145 0-7.704 3.3-8.359 7.814L53.837 47.29h.041c0 6.654 2.946 12.368 7.405 16.254V91.95c0 6.86 5.468 12.464 12.273 12.695v.028h69.177c7.009 0 12.723-5.714 12.723-12.723V63.545c4.472-3.886 7.404-9.613 7.404-16.295l-3.56-24.695Z",fill:"#06CF9C",fillOpacity:.2}),k.jsx("path",{d:"M155.455 63.56v28.404c0 7.009-5.714 12.722-12.723 12.722H74.004c-7.009 0-12.722-5.713-12.722-12.722V63.79",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{d:"M95.332 67.486a9.398 9.398 0 0 1 1.636 5.319v31.868m-23.4.013V72.818c0-1.09.546-2.945.886-3.927m68.428-.001v14.046c0 5.196-4.214 9.41-9.409 9.41h-17.741c-5.196 0-9.409-4.214-9.409-9.41V70.964m44.659-56.224H65.768c-4.145 0-7.704 3.3-8.359 7.815L53.85 47.29h109.009L159.3 22.555c-.655-4.5-4.173-7.814-8.359-7.814h.041Z",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{d:"M162.859 47.264c0 15.804-16.418 26.318-30.75 19.663-3.436-1.595-5.577-3.136-5.577-3.136-1.459 1.364-7.882 7.036-17.823 7.173-10.377.136-17.114-5.878-18.505-7.173-.313.218-.831.573-1.5.968a43.912 43.912 0 0 1-4.077 2.168c-14.332 6.655-30.75-3.859-30.75-19.663h109.009M90.218 63.79l2.25-49.035m34.077 49.035-2.14-49.035",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{d:"M55.923 103.8c4.759 0 8.618-3.805 8.618-8.51 0-4.704-3.86-8.508-8.618-8.508-4.76 0-8.618 3.804-8.618 8.509 0 4.704 3.859 8.509 8.618 8.509Z",fill:"#fff",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{d:"m224.605 58.268-18.028-20.74c-2.195-2.196-5.972-.642-5.972 2.468v2.85h-22.132a7.525 7.525 0 0 0-7.528 7.527v20.454c0 4.132 3.341 7.5 7.473 7.528l22.173.272v2.85c0 3.11 3.764 4.678 5.973 2.468l18.027-20.74a3.505 3.505 0 0 0 0-4.95l.014.013Z",fill:"#FCF5EB",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M180.559 88.132h-.027l-10.868-4.596c-.6-.259-1.05-.709-1.282-1.268l-4.664-10.677c-1.077-2.495-3.491-2.714-4.173-2.714-.681 0-3.109.232-4.172 2.741l-4.623 10.623c-.286.614-.736 1.064-1.309 1.295l-10.95 4.623c-2.496 1.036-2.755 3.327-2.755 4.091 0 .71.232 3.055 2.728 4.105l10.5 4.54c.545.246.995.682 1.268 1.241l5.073 11.019c1.104 2.386 3.368 2.618 4.131 2.618.696 0 3.082-.205 4.173-2.687l4.732-10.895c.286-.614.736-1.064 1.295-1.296l10.896-4.595h.027c2.427-1.09 2.7-3.327 2.7-4.105 0-.736-.245-3.027-2.7-4.104h-.014l.014.04Z",fill:"#fff",stroke:"#316474",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})]}),k.jsx("defs",{children:k.jsx("clipPath",{id:"a",children:k.jsx("path",{fill:"#fff",d:"M0 0h240v120H0z"})})})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.BizBotHeroIcon=a}),98);
__d("WAWebWamEnumBotBizActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({BOT_BIZ_CARD_CLICK:1,BOT_BIZ_CARD_MESSAGE_CLICK:2,BOT_BIZ_CARD_VIEW_AI_CLICK:3,BOT_BIZ_DEEPLINK_CLICK:4,BOT_BIZ_NUX_APPEAR:5,BOT_BIZ_NUX_DISMISS:6,BOT_BIZ_NUX_SELECT:7,BOT_BIZ_INFO_CHAT_CLICK:8,BOT_BIZ_NUX_CONTINUE_CLICKED:9,BOT_BIZ_NUX_DISMISS_AUTO_ACCEPT:10,BOT_BIZ_NUX_APPEAR_MERGED:11,BOT_BIZ_NUX_APPEAR_NEW:12});f.BOT_BIZ_ACTION_TYPE=a}),66);
__d("WAWebWamEnumBotBizEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({SHARED_BOT_BIZ_CARD:1,SHARED_BOT_BIZ_DEEPLINK:2,BOT_BIZ_CHAT:3});f.BOT_BIZ_ENTRY_POINT=a}),66);
__d("WAWebWamEnumBotBizType",[],(function(a,b,c,d,e,f){a=Object.freeze({BOT_BIZ_3P:1,BOT_BIZ_1P:2});f.BOT_BIZ_TYPE=a}),66);
__d("WAWebBotBizJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBotBizActionType","WAWebWamEnumBotBizEntryPoint","WAWebWamEnumBotBizType","WAWebWamEnumBotType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({BotBizJourney:[4868,{appSessionId:[1,d("WAWebWamCodegenUtils").TYPES.STRING],botBizActionType:[5,d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE],botBizEntryPoint:[6,d("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT],botBizType:[7,d("WAWebWamEnumBotBizType").BOT_BIZ_TYPE],botType:[4,d("WAWebWamEnumBotType").BOT_TYPE]},[1,1,1],"regular"]},{BotBizJourney:[]});g.BotBizJourneyWamEvent=a}),98);
__d("WAWebBizBotLogging",["WAWebBotBizJourneyWamEvent","WAWebBotGating","WAWebChatEntryPoint","WAWebGetSharedSessionId","WAWebWamEnumBotBizActionType","WAWebWamEnumBotBizEntryPoint","WAWebWamEnumBotBizType","WAWebWamEnumBotType"],(function(a,b,c,d,e,f,g){function a(a){if(!d("WAWebBotGating").isBizBot3pEnabled())return;a=new(d("WAWebBotBizJourneyWamEvent").BotBizJourneyWamEvent)({appSessionId:d("WAWebGetSharedSessionId").getSharedSessionId(),botBizEntryPoint:d("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_CARD,botBizActionType:j(a),botBizType:h("3p"),botType:i("3p")});a.commit()}function b(){if(!d("WAWebBotGating").isBizBot3pEnabled())return;var a=new(d("WAWebBotBizJourneyWamEvent").BotBizJourneyWamEvent)({appSessionId:d("WAWebGetSharedSessionId").getSharedSessionId(),botBizEntryPoint:d("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_DEEPLINK,botBizActionType:d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_DEEPLINK_CLICK,botBizType:h("3p"),botType:i("3p")});a.commit()}function c(a,b,c){if(a==="3p"&&!d("WAWebBotGating").isBizBot3pEnabled()||a==="1p"&&!d("WAWebBotGating").isBizBot1pEnabled())return;var e;switch(c){case d("WAWebChatEntryPoint").ChatEntryPoint.Vcard:e=d("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.SHARED_BOT_BIZ_CARD;break;case d("WAWebChatEntryPoint").ChatEntryPoint.Chatlist:e=d("WAWebWamEnumBotBizEntryPoint").BOT_BIZ_ENTRY_POINT.BOT_BIZ_CHAT;break;default:e=void 0}c=new(d("WAWebBotBizJourneyWamEvent").BotBizJourneyWamEvent)({appSessionId:d("WAWebGetSharedSessionId").getSharedSessionId(),botBizActionType:j(b),botBizEntryPoint:e,botBizType:h(a),botType:i(a)});c.commit()}function h(a){switch(a){case"1p":return d("WAWebWamEnumBotBizType").BOT_BIZ_TYPE.BOT_BIZ_1P;case"3p":return d("WAWebWamEnumBotBizType").BOT_BIZ_TYPE.BOT_BIZ_3P}}function i(a){switch(a){case"1p":return d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;case"3p":return d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}}function j(a){switch(a){case"card_click":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_CLICK;case"message_click":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_MESSAGE_CLICK;case"view_ai_click":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_CARD_VIEW_AI_CLICK;case"nux_appear":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR;case"nux_dismiss":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_DISMISS;case"nux_select":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_SELECT;case"nux_view_new":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR_NEW;case"nux_view_merged":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_APPEAR_MERGED;case"nux_dismiss_auto_accept":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_DISMISS_AUTO_ACCEPT;case"nux_continue_clicked":return d("WAWebWamEnumBotBizActionType").BOT_BIZ_ACTION_TYPE.BOT_BIZ_NUX_CONTINUE_CLICKED}}g.logBizBot3pContactCardJourneyEvent=a;g.logBizBot3pDeepLinkClickEvent=b;g.logBizBotNuxJourneyEvent=c}),98);
__d("WAWebAiSignalIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="ai-signal";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=13;o=12;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 12 13",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsxs("g",{fill:"currentColor",children:[k.jsx("path",{d:"M6.216 3.376a1.428 1.428 0 1 0 0-2.856 1.428 1.428 0 0 0 0 2.856Zm5.244 1.956a15.06 15.06 0 0 0-1.251-2.185.542.542 0 0 0-.447-.24.542.542 0 0 0-.447.24 14.955 14.955 0 0 0-1.25 2.185.542.542 0 0 0 .017.508c.09.154.248.252.433.267.413.033.832.05 1.247.048.415.001.834-.015 1.247-.048a.542.542 0 0 0 .432-.267.542.542 0 0 0 .018-.508Z"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.293 8.077h.002-.002Zm2.224-3.45a.69.69 0 0 1 .641-.427.69.69 0 0 1 .64.423l.716 1.662a.366.366 0 0 0 .198.195h.002l1.671.714.004.002a.694.694 0 0 1 .415.64.69.69 0 0 1-.415.637l-.004.002-1.673.714a.382.382 0 0 0-.2.202l-.726 1.695a.689.689 0 0 1-.64.418.691.691 0 0 1-.636-.407v-.002l-.78-1.716a.392.392 0 0 0-.196-.193L.92 8.479A.688.688 0 0 1 .5 7.84c0-.119.04-.475.423-.637l1.681-.719a.387.387 0 0 0 .2-.2l.713-1.656Z"})]})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.AiSignalIcon=a}),98);
__d("WAWebAiSignalOutlineIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="ai-signal-outline";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=20;o=20;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 20 20",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",color:"#54656F",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.19034 10.2424L7.79758 7.00011C7.4331 6.15148 6.22737 6.15148 5.86289 7.00011L4.4701 10.2424C4.36364 10.4904 4.16571 10.6878 3.9173 10.7941L0.637898 12.1963C-0.208188 12.5581 -0.213946 13.7529 0.628605 14.1227L3.78312 15.5076C4.02005 15.6115 4.21025 15.7991 4.31737 16.0342L5.84374 19.3845C6.22211 20.215 7.40911 20.2021 7.76927 19.3636L9.19034 16.0552C9.29686 15.8073 9.49472 15.6099 9.74322 15.5036L12.9929 14.114C13.8434 13.7503 13.8434 12.5473 12.9929 12.1837L9.74322 10.7941C9.49472 10.6878 9.29686 10.4904 9.19034 10.2424ZM4.58674 13.6761C4.58686 13.6762 4.58697 13.6762 4.58709 13.6763C5.27402 13.9778 5.82616 14.5219 6.13738 15.205L6.13739 15.205L6.77638 16.6076L7.3527 15.2659L7.35274 15.2658C7.66229 14.5452 8.23699 13.9725 8.9568 13.6647L8.95686 13.6647L10.1632 13.1488L8.95686 12.633L8.95679 12.633C8.237 12.3251 7.66229 11.7524 7.35274 11.0319L7.35271 11.0318L6.83023 9.81548L6.30784 11.0316C6.30781 11.0316 6.30777 11.0317 6.30773 11.0318C5.99811 11.7527 5.4232 12.3252 4.70395 12.6329L4.7036 12.633L3.44069 13.173L4.58674 13.6761ZM7.70052 7.7895C7.70046 7.78964 7.7004 7.78979 7.70033 7.78993L7.70052 7.7895ZM12.2066 12.275L12.2065 12.2751L12.2066 12.275ZM5.93202 18.5733C5.93188 18.5737 5.93175 18.574 5.93162 18.5743L5.93162 18.5743L5.93202 18.5733ZM10.9046 3.45455C11.3049 3.45455 11.6308 3.12973 11.6308 2.72728C11.6308 2.32481 11.3049 2 10.9046 2C10.5044 2 10.1785 2.32485 10.1785 2.72728C10.1785 3.12969 10.5044 3.45455 10.9046 3.45455ZM17.2133 6.97379L17.6637 8.98554L15.697 8.36987L17.2133 6.97379ZM13.6308 2.72728C13.6308 4.23351 12.4103 5.45455 10.9046 5.45455C9.39905 5.45455 8.17847 4.23352 8.17847 2.72728C8.17847 1.22104 9.39905 0 10.9046 0C12.4103 0 13.6308 1.22105 13.6308 2.72728ZM18.0943 4.15827C18.4524 4.2704 18.7236 4.56517 18.8056 4.93156L19.9746 10.1529C20.0566 10.5193 19.937 10.9016 19.6609 11.1559C19.3847 11.4101 18.9939 11.4977 18.6358 11.3855L13.5313 9.78762C13.1732 9.67549 12.902 9.38071 12.82 9.01433C12.7379 8.64795 12.8575 8.26561 13.1337 8.01136L17.0692 4.38795C17.3453 4.1337 17.7361 4.04614 18.0943 4.15827Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.AiSignalOutlineIcon=a}),98);
__d("WAWebBusinessDataSharingIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="business-data-sharing";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=18;o=20;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 20 18",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M14.3 9.30005C14.1 9.10005 14 8.86238 14 8.58705C14 8.31238 14.0917 8.08338 14.275 7.90005L16.175 6.00005H2.00005C1.71672 6.00005 1.47938 5.90405 1.28805 5.71205C1.09605 5.52072 1.00005 5.28338 1.00005 5.00005C1.00005 4.71672 1.09605 4.47905 1.28805 4.28705C1.47938 4.09572 1.71672 4.00005 2.00005 4.00005H16.175L14.275 2.10005C14.0917 1.91672 14 1.68738 14 1.41205C14 1.13738 14.1 0.900049 14.3 0.700049C14.4834 0.516716 14.7167 0.425049 15 0.425049C15.2834 0.425049 15.5167 0.516716 15.7 0.700049L19.3 4.30005C19.4 4.40005 19.4711 4.50838 19.5131 4.62505C19.5544 4.74172 19.5751 4.86672 19.5751 5.00005C19.5751 5.13338 19.5544 5.25838 19.5131 5.37505C19.4711 5.49172 19.4 5.60005 19.3 5.70005L15.7 9.30005C15.5 9.50005 15.2627 9.59572 14.988 9.58705C14.7127 9.57905 14.4834 9.48338 14.3 9.30005ZM4.30005 17.3L0.700049 13.7C0.600049 13.6 0.529382 13.4917 0.488049 13.375C0.446049 13.2584 0.425049 13.1334 0.425049 13C0.425049 12.8667 0.446049 12.7417 0.488049 12.625C0.529382 12.5084 0.600049 12.4 0.700049 12.3L4.30005 8.70005C4.48338 8.51672 4.71272 8.42071 4.98805 8.41205C5.26272 8.40405 5.50005 8.50005 5.70005 8.70005C5.90005 8.88338 6.00405 9.11238 6.01205 9.38705C6.02072 9.66238 5.92505 9.90005 5.72505 10.1L3.82505 12H18C18.2834 12 18.5207 12.0957 18.712 12.287C18.904 12.479 19 12.7167 19 13C19 13.2834 18.904 13.5207 18.712 13.712C18.5207 13.904 18.2834 14 18 14H3.82505L5.72505 15.9C5.90838 16.0834 6.00405 16.3167 6.01205 16.6C6.02072 16.8834 5.92505 17.1167 5.72505 17.3C5.54172 17.5 5.30838 17.6 5.02505 17.6C4.74172 17.6 4.50005 17.5 4.30005 17.3Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.BusinessDataSharingIcon=a}),98);
__d("WAWebDoubleChevronInCircleIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="double-chevron-in-circle";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=19;o=19;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 19 19",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M5.79303 5.94909C6.10056 5.64155 6.59918 5.64155 6.90672 5.94909L9.87657 8.91893C10.1841 9.22647 10.1841 9.72509 9.87657 10.0326L6.90672 13.0025C6.59918 13.31 6.10056 13.31 5.79303 13.0025C5.48549 12.6949 5.48549 12.1963 5.79303 11.8888L8.20603 9.47578L5.79303 7.06278C5.48549 6.75524 5.48549 6.25662 5.79303 5.94909Z",fill:"currentColor"}),k.jsx("path",{d:"M9.99302 5.94909C10.3006 5.64155 10.7992 5.64155 11.1067 5.94909L14.0766 8.91893C14.3841 9.22647 14.3841 9.72509 14.0766 10.0326L11.1067 13.0025C10.7992 13.31 10.3006 13.31 9.99302 13.0025C9.68549 12.6949 9.68549 12.1963 9.99302 11.8888L12.406 9.47578L9.99302 7.06278C9.68549 6.75524 9.68549 6.25662 9.99302 5.94909Z",fill:"currentColor"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.2569 9.5037C18.2569 14.3372 14.3386 18.2555 9.50517 18.2555C4.67171 18.2555 0.753418 14.3372 0.753418 9.5037C0.753418 4.67024 4.67171 0.751953 9.50517 0.751953C14.3386 0.751953 18.2569 4.67024 18.2569 9.5037ZM16.6819 9.5037C16.6819 13.4673 13.4688 16.6805 9.50517 16.6805C5.54156 16.6805 2.32842 13.4673 2.32842 9.5037C2.32842 5.54009 5.54156 2.32695 9.50517 2.32695C13.4688 2.32695 16.6819 5.54009 16.6819 9.5037Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DoubleChevronInCircleIcon=a}),98);
__d("WAWebLightningIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="lightning";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 13 22",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M4.48313 22C4.05536 22 3.72536 21.6211 3.78647 21.1933L4.88647 13.4444H0.608689C-0.466867 13.4444 0.205356 12.5278 0.2298 12.4911C1.7698 9.76556 4.0798 5.73222 7.13536 0.354444C7.25758 0.134444 7.50202 0 7.74647 0C8.17424 0 8.50424 0.378889 8.44313 0.806667L7.34313 8.55556H11.6331C12.122 8.55556 12.3909 8.78778 12.122 9.36222C8.10091 16.3778 5.76647 20.4722 5.09424 21.6456C4.97202 21.8656 4.7398 22 4.48313 22Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LightningIcon=a}),98);
__d("WAWebWdsPictoMetaDataDoubleChevronIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="wds-picto-meta-data-double-chevron";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=70;o=70;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 70 70",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M19.8366 43.656L28.5011 34.983L19.8498 26.3365C18.5433 25.03 18.5433 22.9195 19.8498 21.613C21.1563 20.3065 23.2668 20.3065 24.5733 21.613L35.6031 32.638C36.9096 33.9445 36.9096 36.055 35.6031 37.3615L24.5601 48.413C23.2536 49.7195 21.1431 49.7195 19.8366 48.413C18.5636 47.1065 18.5301 44.9625 19.8366 43.656Z",fill:"#25D366"}),k.jsx("path",{d:"M45.2512 34.983L36.5867 43.656C35.2802 44.9625 35.3137 47.1065 36.5867 48.413C37.8932 49.7195 40.0037 49.7195 41.3102 48.413L52.3532 37.3615C53.6597 36.055 53.6597 33.9445 52.3532 32.638L41.3234 21.613C40.0169 20.3065 37.9064 20.3065 36.5999 21.613C35.2934 22.9195 35.2934 25.03 36.5999 26.3365L45.2512 34.983Z",fill:"#25D366"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.5 35C68.5 16.508 53.492 1.5 35 1.5C16.508 1.5 1.5 16.508 1.5 35C1.5 53.492 16.508 68.5 35 68.5C53.492 68.5 68.5 53.492 68.5 35ZM8.2 35C8.2 20.193 20.193 8.2 35 8.2C49.807 8.2 61.8 20.193 61.8 35C61.8 49.807 49.807 61.8 35 61.8C20.193 61.8 8.2 49.807 8.2 35Z",fill:"#25D366"}),k.jsx("path",{d:"M19.8366 43.656L28.5011 34.983L19.8498 26.3365C18.5433 25.03 18.5433 22.9195 19.8498 21.613C21.1563 20.3065 23.2668 20.3065 24.5733 21.613L35.6031 32.638C36.9096 33.9445 36.9096 36.055 35.6031 37.3615L24.5601 48.413C23.2536 49.7195 21.1431 49.7195 19.8366 48.413C18.5636 47.1065 18.5301 44.9625 19.8366 43.656Z",stroke:"#111B21",strokeWidth:1.5}),k.jsx("path",{d:"M45.2512 34.983L36.5867 43.656C35.2802 44.9625 35.3137 47.1065 36.5867 48.413C37.8932 49.7195 40.0037 49.7195 41.3102 48.413L52.3532 37.3615C53.6597 36.055 53.6597 33.9445 52.3532 32.638L41.3234 21.613C40.0169 20.3065 37.9064 20.3065 36.5999 21.613C35.2934 22.9195 35.2934 25.03 36.5999 26.3365L45.2512 34.983Z",stroke:"#111B21",strokeWidth:1.5}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M68.5 35C68.5 16.508 53.492 1.5 35 1.5C16.508 1.5 1.5 16.508 1.5 35C1.5 53.492 16.508 68.5 35 68.5C53.492 68.5 68.5 53.492 68.5 35ZM8.2 35C8.2 20.193 20.193 8.2 35 8.2C49.807 8.2 61.8 20.193 61.8 35C61.8 49.807 49.807 61.8 35 61.8C20.193 61.8 8.2 49.807 8.2 35Z",stroke:"#111B21",strokeWidth:1.5})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.WdsPictoMetaDataDoubleChevronIcon=a}),98);
__d("WAWebBizBotTosContent.react",["fbt","WAWebAiSignalIcon.react","WAWebAiSignalOutlineIcon.react","WAWebBizGatingUtils","WAWebBox.react","WAWebBusinessDataSharingIcon.react","WAWebDoubleChevronInCircleIcon.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebFlex.react","WAWebLightningIcon.react","WAWebText.react","WAWebUISpacing","WAWebWdsPictoMetaDataDoubleChevronIcon.react","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l={iconUpdatedUI:{color:"x110helo",$$css:!0},lightningIconWrapper:{stroke:"xc35cvv",strokeWidth:"xvlca1e",$$css:!0},lightningIcon:{color:"x19co3pv",$$css:!0},sectionIcon:{width:"xvy4d1p",$$css:!0},sectionDescription:{color:"x14ug900",$$css:!0}};function a(a){a=a.isLearnMoreScreen;var b=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled(),e=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiBrazilEnabled(),f=!a&&d("WAWebBizGatingUtils").isNonBlockingConsumerTosAbpropEnabled();a=function(){return b?null:k.jsx(d("WAWebFlex.react").FlexItem,{xstyle:d("WAWebUISpacing").uiMargin.vert16,children:k.jsx(d("WAWebWdsPictoMetaDataDoubleChevronIcon.react").WdsPictoMetaDataDoubleChevronIcon,{width:67})})};var g=function(){if(f)return k.jsx(d("WAWebText.react").WAWebTextLarge,{weight:"medium",textAlign:"center",children:h._(/*BTDS*/"Get quick help from business chats that use AI from Meta")});var a=e?h._(/*BTDS*/"WhatsApp's parent company Meta receives messages when you chat with a business that uses AI from Meta. They may be used to help AI at Meta get better and safer. {=m2}",[h._implicitParam("=m2",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:h._(/*BTDS*/"Learn more")}))]):h._(/*BTDS*/"WhatsApp's parent company Meta receives messages when you chat with a business that uses AI from Meta. This helps AI get better and safer. {=m2}",[h._implicitParam("=m2",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:h._(/*BTDS*/"Learn more")}))]);return k.jsxs(k.Fragment,{children:[k.jsx(d("WAWebText.react").WAWebTextLarge,{weight:"medium",children:h._(/*BTDS*/"About business chats that use AI from Meta")}),k.jsx(d("WAWebText.react").WAWebTextTitle,{testid:void 0,children:a})]})},j={icon:k.jsx(d("WAWebLightningIcon.react").LightningIcon,{width:24,height:24,viewBox:{x:0,y:-1,width:13,height:24},xstyle:l.lightningIconWrapper,iconXstyle:[l.iconUpdatedUI,l.lightningIcon]}),title:h._(/*BTDS*/"Businesses use AI to provide help 24\/7 and offer customized experiences.")},m={icon:k.jsx(d("WAWebAiSignalIcon.react").AiSignalIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"Messages generated by AI from Meta are marked and may be inaccurate or inappropriate.")},n={icon:k.jsx(d("WAWebAiSignalOutlineIcon.react").AiSignalOutlineIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"Businesses teach AI to give you helpful answers about their products and services.")},o={icon:k.jsx(d("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"This icon means WhatsApp's parent company Meta receives these chats to improve AI quality. You can stop chatting at any time. {=m2}",[h._implicitParam("=m2",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:h._(/*BTDS*/"Learn more")}))])},p={icon:k.jsx(d("WAWebBusinessDataSharingIcon.react").BusinessDataSharingIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"WhatsApp's parent company Meta receives these chats to improve AI quality. You can stop chatting at any time. {=m2}",[h._implicitParam("=m2",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBizBotTosLearnMoreUrl(),children:h._(/*BTDS*/"Learn more")}))])},q={icon:k.jsx(d("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"This icon means WhatsApp's parent company Meta receives these chats and may use them to improve {=m2}.",[h._implicitParam("=m2",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getPrivacyPolicyGenaiUrl(),children:h._(/*BTDS*/"AI at Meta")}))])},r=function(){return f?n:j},s=function(){return f?null:m},t=function(){if(e)return[r(),f?q:{icon:k.jsx(d("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"This icon means Meta receives messages and may use them to improve AI quality. Meta may use service providers to support this experience. You can stop chatting at any time.")},s()];return b?[r(),f?p:{icon:k.jsx(d("WAWebBusinessDataSharingIcon.react").BusinessDataSharingIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"Meta receives messages to improve AI quality. Meta may use service providers to support this experience. You can stop chatting at any time.")},s()]:[r(),f?o:{icon:k.jsx(d("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{width:24,height:24,iconXstyle:l.iconUpdatedUI}),title:h._(/*BTDS*/"This icon means Meta receives messages to improve AI quality. Meta may use service providers to support this experience. You can stop chatting at any time.")},s()]};return k.jsxs(k.Fragment,{children:[a(),k.jsx(d("WAWebBox.react").Box,{flex:!0,direction:"vertical",rowGap:8,xstyle:[d("WAWebUISpacing").uiMargin.top16,d("WAWebUISpacing").uiMargin.bottom8],children:g()}),t().filter(Boolean).map(function(a,b){var e=a.icon;a=a.title;return k.jsxs(d("WAWebFlex.react").FlexRow,{columnGap:24,className:(i||(i=c("stylex")))(d("WAWebUISpacing").uiMargin.vert10,d("WAWebUISpacing").uiPadding.horiz8),align:"center",children:[k.jsx(d("WAWebFlex.react").FlexItem,{shrink:0,xstyle:l.sectionIcon,children:e}),k.jsx(d("WAWebFlex.react").FlexItem,{xstyle:l.sectionDescription,children:a})]},b)})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebCatalogEntrypointIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="catalog-entrypoint";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",children:[k.jsx("title",{children:"catalog"}),k.jsx("desc",{children:"Created with Sketch."}),k.jsxs("g",{id:"catalog",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",children:[k.jsx("g",{id:"Group",transform:"translate(23.000000, 20.000000)"}),k.jsxs("g",{id:"Group-2",transform:"translate(0.000000, 2.000000)",fill:"currentColor",children:[k.jsx("path",{d:"M19.5231962,0.25 L4.4768038,0.25 C3.24356655,0.25 2.16113263,1.07099996 1.82863822,2.25856957 L0.633237306,6.52818064 C0.372658667,7.45888884 0.915906016,8.42461764 1.84661422,8.68519628 C2.00019949,8.72819691 2.15894223,8.75 2.31843358,8.75 L21.6815664,8.75 C22.6480647,8.75 23.4315664,7.96649831 23.4315664,7 C23.4315664,6.84050865 23.4097633,6.68176591 23.3667627,6.52818064 L22.1713618,2.25856957 C21.8388674,1.07099996 20.7564335,0.25 19.5231962,0.25 Z M19.5231962,1.75 C20.0837586,1.75 20.575774,2.1231818 20.7269078,2.66298617 L21.9223087,6.93259723 C21.9284517,6.95453799 21.9315664,6.97721552 21.9315664,7 C21.9315664,7.13807119 21.8196376,7.25 21.6815664,7.25 L2.31843358,7.25 C2.2956491,7.25 2.27297157,7.24688527 2.25103082,7.24074233 C2.1180725,7.20351681 2.04046574,7.06555555 2.07769126,6.93259723 L3.27309217,2.66298617 C3.424226,2.1231818 3.91624141,1.75 4.4768038,1.75 L19.5231962,1.75 Z",id:"Path",fillRule:"nonzero"}),k.jsx("path",{d:"M23,8 L23,8.39401172 C23,9.28097201 22.0068112,10.5 20.7816587,10.5 C19.6338274,10.5 18.701177,9.36689087 18.5866935,8.55847255 C18.4710113,9.36689087 17.5383609,10.5 16.391129,10.5 C15.2426983,10.5 14.3106473,9.36689087 14.1955645,8.55847255 C14.0804817,9.36689087 13.1478313,10.5 12,10.5 C10.8515693,10.5 9.91951831,9.36689087 9.80443548,8.55847255 C9.68995205,9.36689087 8.75670227,10.5 7.60887097,10.5 C6.46103967,10.5 5.52898867,9.36689087 5.41390584,8.55847255 C5.29882302,9.36689087 4.36557323,10.5 3.21834133,10.5 C1.99318875,10.5 1,9.28097201 1,8.39401172 L1,8 L23,8 Z",id:"Fill-9"}),k.jsx("path",{d:"M2,12.75 L2,17.75 C2,18.7164983 2.78350169,19.5 3.75,19.5 L15.75,19.5 C16.7164983,19.5 17.5,18.7164983 17.5,17.75 L17.5,12.75 C17.5,12.3357864 17.1642136,12 16.75,12 C16.3357864,12 16,12.3357864 16,12.75 L16,17.75 C16,17.8880712 15.8880712,18 15.75,18 L3.75,18 C3.61192881,18 3.5,17.8880712 3.5,17.75 L3.5,12.75 C3.5,12.3357864 3.16421356,12 2.75,12 C2.33578644,12 2,12.3357864 2,12.75 Z",id:"Path-2",fillRule:"nonzero"}),k.jsx("path",{d:"M21.5,18.75 L21.5,12.75 C21.5,12.3357864 21.1642136,12 20.75,12 C20.3357864,12 20,12.3357864 20,12.75 L20,18.75 C20,19.1642136 20.3357864,19.5 20.75,19.5 C21.1642136,19.5 21.5,19.1642136 21.5,18.75 Z",id:"Path-2",fillRule:"nonzero"})]})]})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.CatalogEntrypointIcon=a}),98);
__d("WAWebBizBotTos.react",["fbt","WAWebBizBotHeroIcon.react","WAWebBizBotLogging","WAWebBizBotTosContent.react","WAWebBizGatingUtils","WAWebBotTos","WAWebBotTypes","WAWebBox.react","WAWebBusinessDataSharingIcon.react","WAWebCatalogEntrypointIcon.react","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebFbtCommon","WAWebFlex.react","WAWebIcLightbulbIcon.react","WAWebModal.react","WAWebModalManager","WAWebText.react","WAWebTos","WAWebUISpacing","asyncToGeneratorRuntime","react","stylex","useWAWebFocusOnMount","useWAWebListener"],(function(a,b,c,d,e,f,g,h){var i=["ref"],j,k,l;e=l||d("react");var m=j||(j=c("react")),n=e.useEffect,o=e.useImperativeHandle,p=e.useState,q={centerText:{textAlign:"x2b8uid",$$css:!0},startText:{textAlign:"x1yc453h",$$css:!0},icon:{color:"xhslqc4",$$css:!0},sectionIcon:{width:"xvy4d1p",$$css:!0},sectionTitle:{width:"xdzyupr",lineHeight:"x1o2sk6j",$$css:!0},divider:{width:"xw90zxv",height:"xjm9jq1",backgroundColor:"x3x0x6p",$$css:!0}};function a(a){var e=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,i);var f=a.onAccept,g=a.onCancel,j=a.automatedType,l=a.chatEntryPoint;a=p(!1);var r=a[0],s=a[1],t=j===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P,u=d("WAWebBotTos").hasSeenBotTos(),v=t&&d("WAWebBizGatingUtils").isNonBlockingConsumerTosAbpropEnabled();d("useWAWebListener").useListener(d("WAWebTos").TosManager,"change",function(){d("WAWebBotTos").hasAcceptedBizBotTos()&&d("WAWebModalManager").ModalManager.close()});o(e,function(){return{close:function(){d("WAWebModalManager").ModalManager.close()}}});var w=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){s(!0);try{yield d("WAWebBotTos").acceptBizBotTos();yield f==null?void 0:f();d("WAWebModalManager").ModalManager.close();return!0}catch(a){return!1}finally{s(!1)}});return function(){return a.apply(this,arguments)}}();a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebBizBotLogging").logBizBotNuxJourneyEvent(t?"1p":"3p","nux_continue_clicked",l),yield w().then(function(a){a&&d("WAWebBizBotLogging").logBizBotNuxJourneyEvent(t?"1p":"3p","nux_select",l)})});return function(){return a.apply(this,arguments)}}();var x=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebBizBotLogging").logBizBotNuxJourneyEvent(t?"1p":"3p","nux_dismiss",l);if(v||d("WAWebBotTos").hasSeenBotTos()){yield w().then(function(a){a&&d("WAWebBizBotLogging").logBizBotNuxJourneyEvent(t?"1p":"3p","nux_dismiss_auto_accept",l)});return}d("WAWebBotTos").dismissBizBotTos();d("WAWebModalManager").ModalManager.close();g==null||g()});return function(){return a.apply(this,arguments)}}();j=function(){void x()};e=c("useWAWebFocusOnMount")();n(function(){d("WAWebBizBotLogging").logBizBotNuxJourneyEvent(t?"1p":"3p",u?"nux_view_merged":"nux_view_new",l)},[]);var y=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled(),z=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled(),A=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiBrazilEnabled();y=y||z||A;z=[{icon:m.jsx(d("WAWebIcLightbulbIcon.react").IcLightbulbIcon,{width:24,height:24,iconXstyle:q.icon}),title:h._(/*BTDS*/"Explore new AI chat experiences"),subtitle:h._(/*BTDS*/"Be more creative and productive while chatting with AIs from third-party developers.")},{icon:m.jsx(d("WAWebCatalogEntrypointIcon.react").CatalogEntrypointIcon,{width:20,height:20,iconXstyle:q.icon}),title:h._(/*BTDS*/"Faster customer assistance"),subtitle:h._(/*BTDS*/"Businesses use AI to provide help 24\/7 and offer customized shopping experiences.")},{icon:m.jsx(d("WAWebBusinessDataSharingIcon.react").BusinessDataSharingIcon,{width:20,height:20,iconXstyle:q.icon}),title:h._(/*BTDS*/"Help AI get better and safer"),subtitle:h._(/*BTDS*/"Your AI chats are received by Meta, WhatsApp's parent company, to improve its AI quality. You can stop chatting at any time.")}];var B=null;if(A){var C;B=h._(/*BTDS*/"Your personal messages remain end-to-end encrypted. By chatting, you agree to Meta\u2019s {=m2} and {=m6}. Learn more about your {=m8} and how to {=m12}. Your use of WhatsApp is governed by {=m15}.",[h._implicitParam("=m2",m.jsx((A=d("WAWebExternalLink.react")).ExternalLink,{href:(C=d("WAWebFaqUrl")).getPrivacyPolicyGenaiUrl(),children:h._(/*BTDS*/"AI terms")})),h._implicitParam("=m6",m.jsx(A.ExternalLink,{href:C.getBotPrivacyPolicyUrl(),children:h._(/*BTDS*/"Privacy Policy")})),h._implicitParam("=m8",m.jsx(A.ExternalLink,{href:C.getWhatsappBrazilBizBotRightsUrl(),children:h._(/*BTDS*/"rights")})),h._implicitParam("=m12",m.jsx(A.ExternalLink,{href:C.getWhatsappBrazilBizBotObjectUrl(),children:h._(/*BTDS*/"object")})),h._implicitParam("=m15",m.jsx(A.ExternalLink,{href:C.getWhatsappPrivacyPolicyBrazilUrl(),children:h._(/*BTDS*/"WhatsApp\u2019s Privacy Policy")}))])}else v?B=h._(/*BTDS*/"Your personal messages remain end-to-end encrypted. By chatting, you agree to Meta's {=m2} and {=m5}.",[h._implicitParam("=m2",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBotTermsUrl(),children:h._(/*BTDS*/"AI Terms")})),h._implicitParam("=m5",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBotPrivacyPolicyUrl(),children:h._(/*BTDS*/"Privacy Policy")}))]):u?B=h._(/*BTDS*/"Your personal messages remain end-to-end encrypted and are never sent to Meta. Meta uses AI chats consistent with their {=m2}. Business chats that use AI from Meta are subject to Meta's {=m5}.",[h._implicitParam("=m2",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBotPrivacyPolicyUrl(),children:h._(/*BTDS*/"Privacy Policy")})),h._implicitParam("=m5",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBotTermsUrl(),children:h._(/*BTDS*/"AI Terms")}))]):B=h._(/*BTDS*/"Your personal messages remain end-to-end encrypted and are never sent to Meta. Meta uses AI chats consistent with their {=m2}. By clicking Continue, you agree to Meta's {=m5}.",[h._implicitParam("=m2",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBotPrivacyPolicyUrl(),children:h._(/*BTDS*/"Privacy Policy")})),h._implicitParam("=m5",m.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getBMBotTermsUrl(),children:h._(/*BTDS*/"AI Terms")}))]);A=null;v?A=c("WAWebFbtCommon")("OK"):y?A=c("WAWebFbtCommon")("Continue"):A=h._(/*BTDS*/"Accept");return m.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{testid:void 0,okText:A,onOK:a,okSpinner:r===!0,cancelText:h._(/*BTDS*/"Cancel"),onCancel:v?void 0:x,onOverlayClick:j,type:y?void 0:d("WAWebModal.react").ModalTheme.Promote,ref:e,children:m.jsxs(d("WAWebFlex.react").FlexColumn,{align:"center",xstyle:[d("WAWebUISpacing").uiMargin.vertAuto,!y&&d("WAWebUISpacing").uiPadding.bottom16],children:[y?m.jsx(c("WAWebBizBotTosContent.react"),{isLearnMoreScreen:!1}):m.jsxs(m.Fragment,{children:[m.jsx(d("WAWebFlex.react").FlexItem,{xstyle:d("WAWebUISpacing").uiPadding.start10,children:m.jsx(d("WAWebBizBotHeroIcon.react").BizBotHeroIcon,{width:200})}),m.jsx(d("WAWebBox.react").Box,{xstyle:[q.centerText,d("WAWebUISpacing").uiMargin.horiz8,d("WAWebUISpacing").uiMargin.top16,d("WAWebUISpacing").uiMargin.bottom8],children:m.jsx(d("WAWebText.react").WAWebTextLarge,{weight:"bold",children:h._(/*BTDS*/"Chats that use AI")})}),z.map(function(a,b){var e=a.icon,f=a.title;a=a.subtitle;return m.jsxs(d("WAWebFlex.react").FlexRow,{columnGap:16,className:(k||(k=c("stylex")))(d("WAWebUISpacing").uiMargin.horiz8,d("WAWebUISpacing").uiMargin.vert16,d("WAWebUISpacing").uiPadding.horiz8),children:[m.jsx(d("WAWebFlex.react").FlexItem,{shrink:0,xstyle:q.sectionIcon,children:e}),m.jsxs(d("WAWebFlex.react").FlexItem,{xstyle:q.sectionTitle,children:[m.jsx(d("WAWebText.react").WAWebTextTitle,{children:f}),m.jsx(d("WAWebText.react").WAWebTextMuted,{children:a})]})]},b)}),m.jsx("div",babelHelpers["extends"]({},(k||(k=c("stylex"))).props(q.divider,d("WAWebUISpacing").uiMargin.vert16)))]}),m.jsx(d("WAWebBox.react").Box,{xstyle:[!y&&d("WAWebUISpacing").uiMargin.horiz8,d("WAWebUISpacing").uiMargin.vert8],children:m.jsx(d("WAWebText.react").WAWebTextMuted,{xstyle:v?q.centerText:q.startText,children:B})})]})})}a.displayName=a.name+" [from "+f.id+"]";g.BizBotTos=a}),226);
__d("WAWebBizBotTosUtils",["Promise","WAWebBizBotTos.react","WAWebBotGating","WAWebBotTos","WAWebBotTypes","WAWebChatEntryPoint","WAWebContactGetters","WAWebCreateBizBotSysMsgAction","WAWebModalManager","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g){var h,i,j=i||c("react");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c;if(!d("WAWebBotGating").isBizBot1pEnabled()||!((c=a.contact.businessProfile)!=null&&c.isBizBot1p)||d("WAWebBotTos").hasSeenBizBotTos(d("WAWebBotTypes").BizBotType.BIZ_1P)||d("WAWebContactGetters").getIsMe(a.contact))return;return new(h||(h=b("Promise")))(function(c){var e;d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebBizBotTos.react").BizBotTos,{automatedType:d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P,onAccept:b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebCreateBizBotSysMsgAction").maybeCreateBizBot1pDisclosureSysMsg(a),c()}),onCancel:c,chatEntryPoint:(e=a.chatEntryPoint)!=null?e:d("WAWebChatEntryPoint").ChatEntryPoint.Unknown}),{blockClose:!0})})});return k.apply(this,arguments)}g.maybeShowBizBot1pTos=a}),98);
__d("WAWebChatLockUpdateDailyStats",["WAWebDailyAggregatedStatsCollection"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a===void 0&&(a={});var b=d("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.gaddForToday();a.totalFolderChatsCount!=null&&(b.chatLockFolderChatsCount=a.totalFolderChatsCount);a.incFolderOpenCount!=null&&(b.chatLockFolderOpenCount+=a.incFolderOpenCount);a.lockFolderHidden!=null&&(b.chatLockLockFolderHidden=a.lockFolderHidden);a.incNewAddChatCount!=null&&(b.chatLockNewAddChatCount+=a.incNewAddChatCount);a.incNewRemoveChatCount!=null&&(b.chatLockNewRemoveChatCount+=a.incNewRemoveChatCount);a.secretCodeActive!=null&&(b.chatLockSecretCodeActive=a.secretCodeActive)}g.updateChatLockDailyStats=a}),98);
__d("WAWebAddOnModel",["WAWebBaseModel","WAWebModelUtils"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.ack=d("WAWebModelUtils").prop(),b.isSendFailure=d("WAWebModelUtils").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);g.AddOnBaseModel=a}),98);
__d("WAWebCommentModel",["WAWebAck","WAWebAddOnModel","WAWebBaseModel","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.parentMsgKey=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.author=d("WAWebBaseModel").prop(),b.read=d("WAWebBaseModel").prop(),b.ack=d("WAWebBaseModel").prop(),b.body=d("WAWebBaseModel").prop(),b.id=d("WAWebBaseModel").prop(),b.isSendFailure=d("WAWebBaseModel").prop(),b.isFailed=d("WAWebBaseModel").derived(function(){var a=d("WAWebUserPrefsMeUser").isMeAccount(this.author)&&this.ack!=null&&this.ack<d("WAWebAck").ACK.CLOCK;return a||Boolean(this.isSendFailure)},["ack","isSendFailure"]),b.subtype=d("WAWebBaseModel").prop(),b.protocolMessageKey=d("WAWebBaseModel").prop(),b.revokeTimestamp=d("WAWebBaseModel").prop(),b.isOverwrittenByRevoke=d("WAWebBaseModel").prop(),b.revokeSender=d("WAWebBaseModel").session(),b.startOfDaySkew=d("WAWebBaseModel").session(),b.startOfDay=d("WAWebBaseModel").session(),b.links=d("WAWebBaseModel").session(function(){return[]}),b.linksIndexParsed=d("WAWebBaseModel").session(0),b.phoneNumbers=d("WAWebBaseModel").session(function(){return[]}),b.phoneNumbersIndexParsed=d("WAWebBaseModel").session(0),b.type=d("WAWebBaseModel").prop(),b.messageSecret=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebAddOnModel").AddOnBaseModel);a.Proxy="comment";b=d("WAWebBaseModel").defineModel(a);g.Comment=b}),98);
__d("WAWebCommentCollection",["WAWebBaseCollection","WAWebCollectionUtils","WAWebCommentModel","WAWebMsgGetters","WAWebMsgType"],(function(a,b,c,d,e,f,g){e=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.byParent=d("WAWebCollectionUtils").aggregated(function(a){return a.parentMsgKey}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getByMsgKey=function(a){return this.findFirst(function(b){return b.id.equals(a)})};return b}(d("WAWebBaseCollection").BaseCollection);e.model=d("WAWebCommentModel").Comment;function a(a){return new(d("WAWebCommentModel").Comment)({ack:a.ack,body:a.body,id:a.id,parentMsgKey:a.parentMsgKey,author:a.author,t:a.t,type:"comment",read:a.read,messageSecret:a.messageSecret})}function b(a){return new(d("WAWebCommentModel").Comment)({t:a.t,parentMsgKey:a.parentMsgKey,id:a.id,subtype:a.subtype,protocolMessageKey:a.protocolMessageKey,revokeTimestamp:a.revokeTimestamp,isOverwrittenByRevoke:!0,type:d("WAWebMsgType").MSG_TYPE.REVOKED,author:d("WAWebMsgGetters").getSender(a),revokeSender:a.revokeSender})}function c(a){return new(d("WAWebCommentModel").Comment)({t:a.t,parentMsgKey:a.parentMsgKey,id:a.id,type:"ciphertext",author:a.author,ack:a.ack})}f=new e();g.createCommentModel=a;g.createCommentModelFromRevoke=b;g.createCommentModelFromPlaceholder=c;g.CommentCollection=f}),98);
__d("WAWebCommentNotification",["fbt","WANullthrows","WAWebBaseNotification","WAWebContactCollection","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMsgCollection","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var c;b=b.commentMsg;c=a.call(this)||this;c.commentMsg=b;b=d("WAWebMsgCollection").MsgCollection.get(c.commentMsg.parentMsgKey);b!=null&&(c.parentMsg=b);return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(a){if(this.parentMsg==null)return c("WAWebNotificationMuteReason").ParentMsgMissing;if(d("WAWebNotificationHelpers").shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState;if(d("WAWebNotificationHelpers").isMutedAndNotMentioned(this.parentMsg))return c("WAWebNotificationMuteReason").MutedChat;if(d("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.parentMsg))return c("WAWebNotificationMuteReason").ArchivedChat;return d("WAWebNotificationHelpers").isOfflineResumeInProgress()?c("WAWebNotificationMuteReason").OfflineResumeInProgress:null};f.shouldPlaySound=function(){var b=d("WAWebFrontendMsgGetters").getChat(this.commentMsg);return a.prototype.shouldPlaySound.call(this)&&!d("WAWebNotificationHelpers").shouldSquelch(b,!1)};f.getBannerOptions=function(){var a=d("WAWebFrontendMsgGetters").getChat(this.commentMsg);return{wid:a.id,title:d("WAWebNotificationHelpers").getNotificationTitle(a),body:d("WAWebGetNotificationStrings").getNotificationBody(babelHelpers["extends"]({},i(this.commentMsg)))}};f.buildKey=function(){return"comment:"+this.commentMsg.id.toString()};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebFrontendMsgGetters").getChat(this.commentMsg);return d("WAWebNotificationIconUtils").getChatNotificationIcon(a,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();return e}(d("WAWebBaseNotification").WABaseNotification);function i(a){a=d("WAWebContactCollection").ContactCollection.get(c("WANullthrows")(a.author,"comment author cannot be null"));a=a?d("WAWebFrontendContactGetters").getFormattedUser(a):"";a=h._(/*BTDS*/"{name} replied to your announcement message",[h._param("name",a)]);return{body:a.toString()}}g.WACommentNotification=a}),226);
__d("WAWebConsumerTransparencyInfoIconModel",["WAMd5","WATypeUtils","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h=function(a){var b;b=((b=c("WAWebUserPrefsStore").getMaybeMeDevicePn())!=null?b:"").toString();a=a.toString();return c("WAMd5")(b+"-"+a)};a=function(){function a(){this.chatIds=new Set();var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.CTWA_CONSUMER_TRANSPARENCY_INFO_ICON);a instanceof Array&&(this.chatIds=new Set(a.filter(d("WATypeUtils").isString)))}var b=a.prototype;b.add=function(a){this.chatIds.add(h(a)),c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.CTWA_CONSUMER_TRANSPARENCY_INFO_ICON,Array.from(this.chatIds))};b.shouldShowIcon=function(a){var b=this,c=[a];if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.isUser()){a=d("WAWebApiContact").getAlternateUserWid(a);a!=null&&c.push(a)}return c.some(function(a){return b.chatIds.has(h(a))})};return a}();b=new a();g.ConsumerTransparencyInfoIconModel=b}),98);
__d("WAWebCommonCTWAConsumerTransparency",["WAWebBizGatingUtils","WAWebCommonCTWADataSharing","WAWebConsumerTransparencyInfoIconModel"],(function(a,b,c,d,e,f,g){a=function(a){if(!a.contact.isBusiness)return!1;var b=d("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.shouldShowIcon(a.id);return!b&&c("WAWebCommonCTWADataSharing").getCTWAEligibilityFromChat(a)==null?!1:!0};b=function(){return!d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled()&&(d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled()||d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiBrazilEnabled())};e=function(a,b,c){if(b==null||c==null)return;if(!a.contact.isBusiness)return;b=d("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.shouldShowIcon(a.id);if(b)return;d("WAWebConsumerTransparencyInfoIconModel").ConsumerTransparencyInfoIconModel.add(a.id)};g.shouldShowConsumerTransparencyDisclosure=a;g.shouldShowUpdatedConsumerDisclosure=b;g.handleConsumerTransparencyForNewMsg=e}),98);
__d("WAWebCTWABizDataSharingJob",["WALogger","WASmaxBizSettingsGetPrivacySettingRPC","WASmaxBizSettingsSetPrivacySettingRPC","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WASmaxBizSettingsGetPrivacySettingRPC").sendGetPrivacySettingRPC());switch(a.name){case"GetPrivacySettingResponseError":var b=a.value.errorPrivacySettingErrors.value,c=b.code;b=b.text;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] GetPrivacySettingResponseError: fetch data sharing setting failed"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: fetch data sharing setting failed "+c+", "+b);return null;default:a.name;return a.value.privacySmbDataSharingSettingMixin.value}});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a={smbDataSharingSettingMixinArgs:{anyValue:a}};a=(yield d("WASmaxBizSettingsSetPrivacySettingRPC").sendSetPrivacySettingRPC(a));switch(a.name){case"SetPrivacySettingResponseError":var b=a.value.errorPrivacySettingErrors.value,c=b.code;b=b.text;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] SetPrivacySettingResponseError: changing data sharing setting failed"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting failed "+c+", "+b);return null;default:a.name;a.value.privacySmbDataSharingSettingMixin==null&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting returned null value"]))).devConsole("[ctwa][data_sharing] GetPrivacySettingResponseError: changing data sharing setting returned null value");return(b=(c=a.value.privacySmbDataSharingSettingMixin)==null?void 0:c.value)!=null?b:null}});return l.apply(this,arguments)}g.getCtwaBizDataSharingSettingJob=a;g.setCtwaBizDataSharingSettingJob=c}),98);
__d("WAWebCTWADataSharingModel",["WAWebEventEmitter"],(function(a,b,c,d,e,f,g){var h=null,i=new(c("WAWebEventEmitter"))();a=function(a){h=a,i.trigger("update",h)};b=function(){return h};d=function(a){i.on("update",a)};e=function(a){i.off("update",a)};f={subscribeForUpdates:d,unsubscribeFromUpdates:e,setValue:a,getValue:b};g.CTWADataSharingModel=f}),98);
__d("WAWebDataSharingOptInCoolOffModel",["WATimeUtils","WAWebBizGatingUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore","gkx"],(function(a,b,c,d,e,f,g){var h=null;a=function(){var a=d("WAWebBizGatingUtils").smbDataSharingOptInCoolOffSeconds();if(h==null){var b=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF);h=d("WATimeUtils").castToUnixTime(typeof b==="number"?b:0)}return d("WATimeUtils").isInFuture(d("WATimeUtils").futureUnixTime(a,h))};b=function(){h=d("WATimeUtils").unixTime(),c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF,h)};e=function(){c("gkx")("26258")||(h=null,c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_COOL_OFF,null))};f={isCoolOffActive:a,startCoolOff:b,resetCoolOffStartTimestamp:e};g.DataSharingOptInCoolOffModel=f}),98);
__d("WAWebDataSharingUpsellModel",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){var h=null;a=function(){if(h==null){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_UPSELL_ACTIVE);h=a===!0}return h};b=function(){h!==!0&&(h=!0,c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.CTWA_DATA_SHARING_UPSELL_ACTIVE,!0))};e={isUpsellEnabled:a,enableUpsell:b};g["default"]=e}),98);
__d("WAWebCommonCTWADataSharing",["WALogger","WASmaxInBizSettingsEnums","WAWebBizGatingUtils","WAWebCTWABizDataSharingJob","WAWebCTWADataSharingModel","WAWebChatModel","WAWebConversionTupleCollection","WAWebDataSharingOptInCoolOffModel","WAWebDataSharingUpsellModel","WAWebFrontendMsgGetters","WAWebGetCTWAEligibilityFromConversion","WAWebMsgModel","WAWebUserPrefsGeneral","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=2,k={CHAT:"CHAT",MESSAGE:"MESSAGE"},l=function(a){a=c("WAWebConversionTupleCollection").get(a.id);if(!a)return null;var b=a.conversionData;a=a.conversionSource;return d("WAWebGetCTWAEligibilityFromConversion").getCTWAEligibilityFromConversion({conversionData:b,conversionSource:a})};a=function(a){a=c("WAWebConversionTupleCollection").get(a.id);if(!a)return;return a.ctwaSignals};e=function(){var a=d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue(),b=d("WAWebUserPrefsGeneral").getCTWADataSharingCoolOffTimestamp();b=b!=null;b=b&&d("WAWebBizGatingUtils").showDataSharingInSettingsAfterNuxDismiss();var c=d("WAWebUserPrefsGeneral").getCTWAMessageReceived();c=c&&d("WAWebBizGatingUtils").showDataSharingInSettingsAfterCtwaMessageReceived();return(a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"]||a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]||b||c)&&d("WAWebBizGatingUtils").shouldShowSMBDataSharingSettings()};f=function(a){return l(a)==null||!d("WAWebBizGatingUtils").smbDataSharingConsentEnabled()||d("WAWebDataSharingOptInCoolOffModel").DataSharingOptInCoolOffModel.isCoolOffActive()?!1:m(d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue())};var m=function(a){if(a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.notset)return!0;return a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]&&d("WAWebBizGatingUtils").isCTWA3pdCooldownForOptedOutUsersEnabled()&&d("WAWebBizGatingUtils").isCTWAWeb3pdCooldownForOptedOutUsersEnabled()&&d("WAWebUserPrefsGeneral").getCTWADataSharingDisclosureShownCount()<j?!0:!1},n=function(a,b){var c;if(b===k.CHAT)c=d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats;else if(b===k.MESSAGE)c=d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages;else{d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] shouldShowLabelDataSharingDialog: target value must be a chat or a message"])));return!1}return l(a)==null||!c()||d("WAWebDataSharingOptInCoolOffModel").DataSharingOptInCoolOffModel.isCoolOffActive()?!1:m(d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue())},o=function(a,b,e){if(e<1||!d("WAWebBizGatingUtils").smbDataSharingConsentEnabled()||c("WAWebConversionTupleCollection").get(a.id)==null)return!1;e=d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue();a=e===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"];e=e===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]&&b==="order-create"&&c("WAWebDataSharingUpsellModel").isUpsellEnabled();return a||e},p=function(a){if(a.length===0)return!1;var b=[],e=a[0];if(e instanceof d("WAWebMsgModel").Msg){if(!d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages())return!1;b.push(d("WAWebFrontendMsgGetters").getChat(e))}else{if(!d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats())return!1;a.forEach(function(a){a instanceof d("WAWebChatModel").Chat&&b.push(a)})}e=b.some(function(a){return l(a)!=null});if(!e)return!1;a=d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue();e=a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"];a=a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]&&c("WAWebDataSharingUpsellModel").isUpsellEnabled();return e||a},q=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebBizGatingUtils").smbDataSharingConsentEnabled())return null;try{var a=(yield d("WAWebCTWABizDataSharingJob").getCtwaBizDataSharingSettingJob());a&&(d("WAWebCTWADataSharingModel").CTWADataSharingModel.setValue(a),a===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]&&c("WAWebDataSharingUpsellModel").enableUpsell());return a}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][data_sharing] fetchDataSharingSettingAndUpdateModel: fetch data sharing setting failed"]))).devConsole(a);return null}});return function(){return a.apply(this,arguments)}}();a={SMB_DATA_SHARING_ALLOWED_SOURCE:d("WAWebGetCTWAEligibilityFromConversion").SMB_DATA_SHARING_ALLOWED_SOURCE,SmbDataSharingLabelTargetValues:k,getCTWAEligibilityFromChat:l,getCTWASignalsValueFromChat:a,shouldDisplayDataSharingSetting:e,shouldShowOrderDataSharingDialog:f,shouldShowLabelDataSharingDialog:n,shouldDisplayDataSharingOrderOptOutOrUpsell:o,shouldDisplayDataSharingLabelOptOutOrUpsell:p,fetchDataSharingSettingAndUpdateModel:q};g["default"]=a}),98);
__d("WAWebWamEnumCallInitiatorType",[],(function(a,b,c,d,e,f){a=Object.freeze({BUSINESS:0,CONSUMER:1});f.CALL_INITIATOR_TYPE=a}),66);
__d("WAWebWamEnumCtwaConversionType",[],(function(a,b,c,d,e,f){a=Object.freeze({FIRST_MESSAGE:0,DEEP_CONVERSATION:1,FIRST_BIZ_REPLY:2,FIRST_CALL:3,FIRST_LONG_CALL:4,SECOND_MESSAGE:5,SECOND_BIZ_REPLY:6,THIRD_MESSAGE:7,CART_RECEIVED:8,ORDER_CREATED:9,FIRST_MESSAGE_CONTINUATION:10,FIRST_BIZ_REPLY_CONTINUATION:11,SECOND_MESSAGE_CONTINUATION:12,SECOND_BIZ_REPLY_CONTINUATION:13,THIRD_MESSAGE_CONTINUATION:14,FIRST_EXTRA_LONG_CALL:15});f.CTWA_CONVERSION_TYPE=a}),66);
__d("WAWebDeepLinkConversionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCallInitiatorType","WAWebWamEnumCtwaChatCreationMode","WAWebWamEnumCtwaConversionType","WAWebWamEnumTrustBannerAction"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({DeepLinkConversion:[1432,{callInitiator:[8,d("WAWebWamEnumCallInitiatorType").CALL_INITIATOR_TYPE],ctwaChatCreationMode:[4,d("WAWebWamEnumCtwaChatCreationMode").CTWA_CHAT_CREATION_MODE],ctwaConversionType:[3,d("WAWebWamEnumCtwaConversionType").CTWA_CONVERSION_TYPE],ctwaSignals:[9,a.TYPES.STRING],deepLinkConversionData:[2,a.TYPES.STRING],deepLinkConversionSource:[1,a.TYPES.STRING],isPriority:[7,a.TYPES.BOOLEAN],trustBannerAction:[5,d("WAWebWamEnumTrustBannerAction").TRUST_BANNER_ACTION],trustBannerType:[6,a.TYPES.STRING]},[1,1,1],"regular"]},{DeepLinkConversion:[]});g.DeepLinkConversionWamEvent=b}),98);
__d("WAWebCommonCTWALogging",["WAArrayBufferUtils","WALogger","WATimeUtils","WAWebABProps","WAWebConnModel","WAWebConversionTupleModel","WAWebDeepLinkConversionWamEvent","WAWebFrontendMsgGetters","WAWebGetCTWAEligibilityFromConversion","WAWebMsgType","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumCtwaConversionType"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;function p(a){var b=d("WATimeUtils").unixTime()-d("WAWebConversionTupleModel").ConversionTupleExpiry;return a.t<b}function q(a,b){a=b.indexOf(a);return a>=0?b[a-1]:null}function r(a,b){var c;b=q(a,b);return((a=a.from)==null?void 0:a.toString())===(b==null||(c=b.from)==null?void 0:c.toString())}function s(a){var b=0,c=a[a.length-1];while(c&&b<=6){var e;if(p(c))return[null,b];else if(c.ctwaContext)return[c,b];var f=q(c,a);if(!f)break;var g=!d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(c.type);e=((e=c.from)==null?void 0:e.toString())!==((e=f.from)==null?void 0:e.toString());g&&e&&b++;c=f}return[c,b]}function t(a,b){a=(a=a.ctwaContext)!=null?a:{};var c=a.conversionData;a=a.conversionSource;if(c==null||a==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: Attempted to log a DC with no CTWA conversion data or source"])));return}b={ctwaConversionType:d("WAWebWamEnumCtwaConversionType").CTWA_CONVERSION_TYPE[b],deepLinkConversionData:d("WAArrayBufferUtils").arrayBufferToString(c),deepLinkConversionSource:a};void new(d("WAWebDeepLinkConversionWamEvent").DeepLinkConversionWamEvent)(b).commitAndWaitForFlush(!0)}function u(a,b){b===1?(d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: FIRST_BIZ_REPLY"]))),t(a,"FIRST_BIZ_REPLY")):b===3?(d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: SECOND_BIZ_REPLY"]))),t(a,"SECOND_BIZ_REPLY")):b===5&&(d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: DEEP_CONVERSATION"]))),t(a,"DEEP_CONVERSATION"))}function v(a,b){b===0?(d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: FIRST_MESSAGE"]))),t(a,"FIRST_MESSAGE")):b===2?(d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: SECOND_MESSAGE"]))),t(a,"SECOND_MESSAGE")):b===4&&(d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: THIRD_MESSAGE"]))),t(a,"THIRD_MESSAGE"))}function a(a){var b;if(!d("WAWebConnModel").Conn.isSMB)return;if(a.ctwaContext==null)return;if(a.ctwaContext.conversionSource!==d("WAWebGetCTWAEligibilityFromConversion").SMB_DATA_SHARING_ALLOWED_SOURCE||a.ctwaContext.conversionData==null)return;b=(b=d("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:b.toString();if(b!==((b=a.to)==null?void 0:b.toString()))return;if(!d("WAWebABProps").getABPropConfigValue("ctwa_show_ads_data_sharing_after_message"))return;a=d("WAWebUserPrefsGeneral").getCTWAMessageReceived();a!==!0&&d("WAWebUserPrefsGeneral").setCTWAMessageReceived(!0)}function b(a){var b,c,e;if(!d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_dc_logging_enabled"))return;if(!a||a.isNewMsg!==!0)return;if(!d("WAWebConnModel").Conn.isSMB)return;b=(b=d("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:b.toString();if(b==null){d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["ctwa:dc-logging: Cannot get current user"]))).sendLogs("ctwa:dc-logging: Cannot get current user");return}c=(c=(c=d("WAWebFrontendMsgGetters").getChat(a))==null?void 0:c.msgs.toArray())!=null?c:[];if(c.length===0)return;if(a.ctwaContext==null&&r(a,c))return;c=s(c);var f=c[0];c=c[1];if(!f)return;if(c>5)return;b===((e=a.from)==null?void 0:e.toString())?u(f,c):b===((e=a.to)==null?void 0:e.toString())&&v(f,c)}g.maybeSetCtwaMessageReceivedInUserPreferenceStore=a;g.logDeepConversation=b}),98);
__d("WAWebAdModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.ad=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="Ad";b=d("WAWebBaseModel").defineModel(a);g.AdModel=b}),98);
__d("WAWebFetchAdsQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9191121574326058"}),null);
__d("WAWebFetchAdsQuery.graphql",["WAWebFetchAdsQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"options"},c={defaultValue:null,kind:"LocalArgument",name:"page_id"},d=[{kind:"Variable",name:"options",variableName:"options"},{kind:"Variable",name:"page_id",variableName:"page_id"}],e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={kind:"InlineFragment",selections:[e],type:"Node",abstractKey:"__isNode"},g=[{kind:"Literal",name:"supported",value:"304s3R"}],h={alias:null,args:null,kind:"ScalarField",name:"formatted_for_lwi",storageKey:null},i={alias:null,args:[{kind:"Literal",name:"height",value:64},{kind:"Literal",name:"width",value:64}],kind:"ScalarField",name:"thumbnail_image_url",storageKey:"thumbnail_image_url(height:64,width:64)"},j=[{kind:"Literal",name:"metrics",value:["REACH","RESULTS"]}],k={alias:null,args:null,kind:"ScalarField",name:"reach",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"results",storageKey:null},m={alias:null,args:null,concreteType:"AdInsightsNode",kind:"LinkedField",name:"node",plural:!1,selections:[k,l],storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"boosting_status",storageKey:null},o={alias:null,args:null,concreteType:"AdsCreativeSpecification",kind:"LinkedField",name:"creative",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null}],storageKey:null},p={alias:null,args:null,concreteType:"AdsLWIAdGroupSpec",kind:"LinkedField",name:"adgroup_spec",plural:!0,selections:[o],storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};o=[e,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[q,{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[h],storageKey:null},i],storageKey:null},{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[e,{alias:null,args:j,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[m],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[q,n,{alias:null,args:null,concreteType:"AdsLWIAdGroupSpec",kind:"LinkedField",name:"adgroup_spec",plural:!0,selections:[o,e],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[a,c],kind:"Fragment",metadata:null,name:"WAWebFetchAdsQuery",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CTWAAPI",kind:"LinkedField",name:"ctwa",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:d,concreteType:"CTWAAPIAllPageAdsConnection",kind:"LinkedField",name:"all_page_ads",plural:!1,selections:[{alias:null,args:null,concreteType:"CTWAAPIAllPageAdsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[f,{kind:"RequiredField",field:{alias:null,args:g,concreteType:null,kind:"LinkedField",name:"wrapper_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CTWABoostedComponentWrapper",kind:"LinkedField",name:"boosted_component",plural:!1,selections:[{kind:"RequiredField",field:e,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.id"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[{kind:"RequiredField",field:h,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.spent.formatted_for_lwi"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.spent"},{kind:"RequiredField",field:i,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info.thumbnail_image_url"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.boosting_info"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[{kind:"RequiredField",field:e,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group.id"},{alias:null,args:j,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:m,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group.ad_insights.edges.node"}],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.campaign_group"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[{kind:"RequiredField",field:n,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec.boosting_status"},{kind:"RequiredField",field:p,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec.adgroup_spec"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.boosted_component.spec"}],storageKey:null}],type:"CTWAAdsManagementBoostedComponent",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"BoostedComponentAsyncWrapper",kind:"LinkedField",name:"async_request",plural:!1,selections:[{kind:"RequiredField",field:e,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.id"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"boosting_info",plural:!1,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"CurrencyQuantity",kind:"LinkedField",name:"spent",plural:!1,selections:[{kind:"RequiredField",field:h,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.spent.formatted_for_lwi"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.spent"},{kind:"RequiredField",field:i,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info.thumbnail_image_url"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.boosting_info"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdCampaignGroup",kind:"LinkedField",name:"campaign_group",plural:!1,selections:[{kind:"RequiredField",field:e,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.id"},{alias:null,args:j,concreteType:"AdInsightsConnection",kind:"LinkedField",name:"ad_insights",plural:!1,selections:[{alias:null,args:null,concreteType:"AdInsightsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"AdInsightsNode",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"RequiredField",field:k,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.ad_insights.edges.node.reach"},l],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group.ad_insights.edges.node"}],storageKey:null}],storageKey:'ad_insights(metrics:["REACH","RESULTS"])'}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.campaign_group"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"spec",plural:!1,selections:[{kind:"RequiredField",field:n,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec.boosting_status"},{kind:"RequiredField",field:p,action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec.adgroup_spec"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer.async_request.spec"}],storageKey:null}],type:"LWIAdsManagementBoostedComponentAsyncRequest",abstractKey:null}],storageKey:'wrapper_renderer(supported:"304s3R")'},action:"THROW",path:"ctwa.all_page_ads.edges.node.wrapper_renderer"}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads.edges.node"}],storageKey:null}],storageKey:null},action:"THROW",path:"ctwa.all_page_ads"}],storageKey:null},action:"THROW",path:"ctwa"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,a],kind:"Operation",name:"WAWebFetchAdsQuery",selections:[{alias:null,args:null,concreteType:"CTWAAPI",kind:"LinkedField",name:"ctwa",plural:!1,selections:[{alias:null,args:d,concreteType:"CTWAAPIAllPageAdsConnection",kind:"LinkedField",name:"all_page_ads",plural:!1,selections:[{alias:null,args:null,concreteType:"CTWAAPIAllPageAdsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[q,f,{alias:null,args:g,concreteType:null,kind:"LinkedField",name:"wrapper_renderer",plural:!1,selections:[q,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CTWABoostedComponentWrapper",kind:"LinkedField",name:"boosted_component",plural:!1,selections:o,storageKey:null}],type:"CTWAAdsManagementBoostedComponent",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"BoostedComponentAsyncWrapper",kind:"LinkedField",name:"async_request",plural:!1,selections:o,storageKey:null}],type:"LWIAdsManagementBoostedComponentAsyncRequest",abstractKey:null}],storageKey:'wrapper_renderer(supported:"304s3R")'}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("WAWebFetchAdsQuery_facebookRelayOperation"),metadata:{},name:"WAWebFetchAdsQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebFetchAds",["Promise","WACustomError","WALogger","WAPromiseTimeout","WAQplTypes","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebCommonAdsTypes","WAWebFetchAdAccountToken","WAWebFetchAdsQuery.graphql","WAWebOrchestratorNonPersistedJob","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l={type:"error"},m=h!==void 0?h:h=b("WAWebFetchAdsQuery.graphql"),n=90;function a(a){return!d("WAWebBizGatingUtils").adManagementEnabled()?(k||(k=b("Promise"))).resolve({type:"not-enabled"}):d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("fetchAds",function(){return o(a)}).waitUntilCompleted()}function o(a){return d("WAPromiseTimeout").promiseTimeout(p(a),d("WAWebCTWAConstants").MANAGE_ADS_FETCH_TIMEOUT_MS)["catch"](function(a){if(a instanceof d("WACustomError").TimeoutError){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_end");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,d("WAQplTypes").QuickLogActionType.ABORTED);d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchAdsWithTimeout: timeout"])));return{type:"timeout"}}throw a})}function p(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS);d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_start");return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return q({token:b.token,pageId:a}).then(function(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,"fetch_ads_end");a.type!=="success"?(d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,d("WAQplTypes").QuickLogActionType.FAIL),a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type):(a.type,d("WAWebQplQuickPerformanceLoggerModule").QPL.markerEnd(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.MANAGE_ADS_FETCH_ADS,d("WAQplTypes").QuickLogActionType.SUCCESS));return a});b.type;return b})}function q(a){var b=a.token;a=a.pageId;return d("WAWebRelayClient").fetchQuery(m,{page_id:a,options:{from_n_days_ago:n}},{environmentType:"facebook",accessToken:b}).then(function(a){if(a==null)return l;a=a.ctwa;a=a.all_page_ads;a=a.edges;var b=a.reduce(function(a,b){b=b.node;b=b.wrapper_renderer;var c=b.boosted_component;b=b.async_request;[c,b].forEach(function(b){if(b==null)return;b=r(b);b!=null&&a.push(b)});return a},[]);return b.length<a.length?l:{type:"success",ads:b}})["catch"](function(a){var b;if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};(a==null||(b=a.message)==null?void 0:b.startsWith("Relay:"))===!0&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["fetchAdsWithToken: Relay parser error ",""])),a.message).sendLogs("fetch-ads-relay-parser-error");return l})}function r(a){var b,c=a.id,e=a.boosting_info,f=a.spec;a=a.campaign_group;var g=e.thumbnail_image_url;e=e.spent;var h=f.adgroup_spec;f=f.boosting_status;e=e.formatted_for_lwi;var i=a.id;a=s(a);b=(b=a==null?void 0:a.reach)!=null?b:0;a=(a=a==null?void 0:a.conversations)!=null?a:0;g={adId:d("WAWebCommonAdsTypes").asAdId(c),thumbnailUrl:g,boostingStatus:(c=d("WAWebCommonAdsTypes").BoostingStatusEnum.cast(f))!=null?c:d("WAWebCommonAdsTypes").BoostingStatusEnum.UNKNOWN,budget:e,campaignGroupId:d("WAWebCommonAdsTypes").asAdCampaignGroupId(i),conversations:a,reach:b};f=h[0];if(f!=null){c=f.creative;if(c!=null){e=c.body;e!=null&&(g.creativeText=e)}}return g}function s(a){a=a.ad_insights;if(a==null)return;a=a.edges;a=a.reduce(function(a,b){b=b.node;var c=b.reach;b=b.results;a.push({reach:c!=null?c:0,conversations:b!=null?b:0});return a},[]);if(a.length===0)return;return a[0]}g.fetchAds=a}),98);
__d("WAWebAdCollection",["WAWebAdModel","WAWebBaseCollection","WAWebFetchAds","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.loadingInfo=null,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.loadAds=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(this.loadingInfo!=null&&this.loadingInfo.pageId===a)return this.loadingInfo.promise;this.reset();var c=d("WAWebFetchAds").fetchAds(a).then(function(c){var d;c.type==="success"?(b.set(c.ads.map(function(a){return{id:a.adId,ad:a}})),d={result:"success",pageId:a}):c.type==="recovery-required"?d={result:"recovery-required",pageId:a,emailMask:c.emailMask}:(c.type,d={result:c.type,pageId:a});b.trigger("ads-loaded",d)})["finally"](function(){b.loadingInfo=null});this.loadingInfo={promise:c,pageId:a};return c});function c(b){return a.apply(this,arguments)}return c}();return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebAdModel").AdModel;c=new a();g.AdCollection=c}),98);
__d("WAWebBackoff",["err"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.backoffIntervals=[].concat(a);this.cache=new Map();this.resetInterval=(a=b==null?void 0:b.resetInterval)!=null?a:null}var b=a.prototype;b.add=function(a){if(this.get(a))throw c("err")("This entry already exists in the backoff cache");this.cache.set(a,{lastAttempt:Date.now(),intervals:[].concat(this.backoffIntervals),attempts:1})};b.remove=function(a){this.cache["delete"](a)};b.get=function(a){return this.cache.get(a)};b.reset=function(a){this.remove(a),this.add(a)};b.shouldBackoff=function(a){var b=this.get(a);if(this.resetInterval!=null&&b!=null){var c=this.resetInterval,d=Date.now()-b.lastAttempt;if(d>=c){this.remove(a);return!1}}if(b!=null){d=b.intervals[0];if(d!=null){c=Date.now()-b.lastAttempt;if(c<d)return!0}}return!1};b.markAttemptAndShiftInterval=function(a){a=this.get(a);a!=null&&(a.lastAttempt=Date.now(),a.intervals.shift(),a.attempts++)};b.test=function(a){if(this.shouldBackoff(a))return!0;else this.get(a)!=null?this.markAttemptAndShiftInterval(a):this.add(a);return!1};b.getCurrentInterval=function(a){a=this.get(a);if(a!=null)return a.intervals[0]};return a}();g.BackoffCache=a}),98);
__d("WAWebEphemeralGenerateSystemMessage",["WAWebContactSystemMsg","WAWebHandleSingleMsg","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WAWebContactSystemMsg").genDisappearingModeUpdateSystemMsg(a.id,b,c);yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:a.from,newMsg:a,handleSingleMsgOrigin:"ephemeralSystemMsg",preserveOrder:!1})});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebContactSystemMsg").genDisappearingModeUnsupportedSystemMsg(a.id);yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:a.from,newMsg:a,handleSingleMsgOrigin:"ephemeralUnsupportedSystemMsg",preserveOrder:!1})});return i.apply(this,arguments)}g.generateEphemeralNotificationTemplateSystemMessage=a;g.generateEphemeralUnsupportedNotificationTemplateSystemMessage=c}),98);
__d("WAWebEphemeralIsDurationAllowed",[],(function(a,b,c,d,e,f){var g=[86400,604800,7776e3];function a(a){if(a<0)return!1;return a===0?!0:g.includes(a)}f.isEphemeralDurationAllowed=a}),66);
__d("WAWebEphemeralOutOfSyncInfoWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumClientGroupSizeBucket"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({EphemeralOutOfSyncInfo:[3892,{groupSizeBucket:[1,d("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],incomingMessageEphemeralityDuration:[2,a.TYPES.INTEGER],isAGroup:[3,a.TYPES.BOOLEAN],isNewThreadForUser:[5,a.TYPES.BOOLEAN],otherDefaultModeDuration:[6,a.TYPES.INTEGER],threadEphemeralityDuration:[7,a.TYPES.INTEGER],threadId:[8,a.TYPES.STRING],userDefaultModeDuration:[9,a.TYPES.INTEGER]},[1,1,1],"regular"]},{EphemeralOutOfSyncInfo:[]});g.EphemeralOutOfSyncInfoWamEvent=b}),98);
__d("WAWebWamEnumEsrFailureReasonType",[],(function(a,b,c,d,e,f){a=Object.freeze({ESR_ABPROP_OFF:1,DM_RELIABILITY_ABPROP_OFF:2,INVALID_MESSAGE_TYPE:3,OLDER_EPHEMERAL_SETTING_TIMESTAMP:4,NO_EPHEMERAL_INFO:5,ATTEMPTS_EXHAUSTED:6,NO_USER_INFO:7,NO_CHAT_SESSION:8,INVALID_EPHEMERAL_DURATION:9});f.ESR_FAILURE_REASON_TYPE=a}),66);
__d("WAWebWamEnumEsrSendResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,ERROR:2});f.ESR_SEND_RESULT_TYPE=a}),66);
__d("WAWebEphemeralSyncResponseReceiveWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumEsrFailureReasonType","WAWebWamEnumEsrSendResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({EphemeralSyncResponseReceive:[4780,{clientDisappearingModeInitiator:[1,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],clientEphemeralityDuration:[2,a.TYPES.INTEGER],clientEphemeralityInitiator:[3,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],clientEphemeralitySettingTimestamp:[4,a.TYPES.INTEGER],clientEphemeralityTriggerAction:[5,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrDisappearingModeInitiator:[6,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],esrEphemeralityDuration:[7,a.TYPES.INTEGER],esrEphemeralityInitiator:[8,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],esrEphemeralitySettingTimestamp:[9,a.TYPES.INTEGER],esrEphemeralityTriggerAction:[10,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrFailureReason:[11,d("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE],esrResolveResult:[12,d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE],isAGroup:[13,a.TYPES.BOOLEAN],threadId:[14,a.TYPES.STRING]},[1,1,1],"regular"]},{EphemeralSyncResponseReceive:[]});g.EphemeralSyncResponseReceiveWamEvent=b}),98);
__d("WAWebEphemeralSyncResponseSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumEsrFailureReasonType","WAWebWamEnumEsrSendResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({EphemeralSyncResponseSend:[4778,{clientDisappearingModeInitiator:[1,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],clientEphemeralityDuration:[2,a.TYPES.INTEGER],clientEphemeralityInitiator:[3,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],clientEphemeralitySettingTimestamp:[4,a.TYPES.INTEGER],clientEphemeralityTriggerAction:[5,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrDisappearingModeInitiator:[6,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],esrEphemeralityDuration:[7,a.TYPES.INTEGER],esrEphemeralityInitiator:[8,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],esrEphemeralitySettingTimestamp:[9,a.TYPES.INTEGER],esrEphemeralityTriggerAction:[10,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],esrFailureReason:[11,d("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE],esrSendAttempt:[12,a.TYPES.INTEGER],esrSendResult:[13,d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE],isAGroup:[14,a.TYPES.BOOLEAN],messageDisappearingModeInitiator:[15,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],messageEphemeralityDuration:[16,a.TYPES.INTEGER],messageEphemeralityInitiator:[17,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],messageEphemeralitySettingTimestamp:[18,a.TYPES.INTEGER],messageEphemeralityTriggerAction:[19,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],threadId:[20,a.TYPES.STRING]},[1,1,1],"regular"]},{EphemeralSyncResponseSend:[]});g.EphemeralSyncResponseSendWamEvent=b}),98);
__d("WAWebEphemeralSyncResponseWAM",["WAWebABProps","WAWebChatThreadLogging","WAWebEphemeralSyncResponseReceiveWamEvent","WAWebEphemeralSyncResponseSendWamEvent","WAWebEphemeralityWAMUtils","WAWebWamEnumEsrSendResultType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("dm_reliability_logging")}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.to,c=a.changes,e=a.incomingMsgSettings,f=a.localChatSettings;a=a.attempts;if(!h())return;b=new(d("WAWebEphemeralSyncResponseSendWamEvent").EphemeralSyncResponseSendWamEvent)({threadId:yield d("WAWebChatThreadLogging").getChatThreadID(b.toJid()),esrSendResult:d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.SUCCESS,isAGroup:!1,esrDisappearingModeInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(c.initiator),esrEphemeralityDuration:c.duration,esrEphemeralityInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(c.initiatedByMe),esrEphemeralitySettingTimestamp:c.settingTimestamp,esrEphemeralityTriggerAction:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(c.disappearingModeTrigger)});f!=null&&(f.initiator!=null&&b.set({clientDisappearingModeInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(f.initiator)}),f.disappearingModeTrigger!=null&&b.set({clientEphemeralityTriggerAction:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(f.disappearingModeTrigger)}),b.set({clientEphemeralityDuration:f.duration,clientEphemeralityInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(f.initiatedByMe),clientEphemeralitySettingTimestamp:f.settingTimestamp}));e!=null&&(e.initiator!=null&&b.set({messageDisappearingModeInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(e.initiator)}),e.disappearingModeTrigger!=null&&b.set({messageEphemeralityTriggerAction:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(e.disappearingModeTrigger)}),b.set({messageEphemeralityDuration:e.duration,messageEphemeralityInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(e.initiatedByMe),messageEphemeralitySettingTimestamp:e.settingTimestamp}));a!=null&&b.set({esrSendAttempt:a});b.commit()});return i.apply(this,arguments)}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.to,c=a.error;a=a.attempts;if(!h())return;b=new(d("WAWebEphemeralSyncResponseSendWamEvent").EphemeralSyncResponseSendWamEvent)({threadId:yield d("WAWebChatThreadLogging").getChatThreadID(b.toJid()),esrFailureReason:c,esrSendResult:d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.ERROR});a!=null&&b.set({esrSendAttempt:a});b.commit()});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chat,c=a.incomingESRSettings,e=a.localChatSettings;a=a.failureReason;if(!h())return;b=new(d("WAWebEphemeralSyncResponseReceiveWamEvent").EphemeralSyncResponseReceiveWamEvent)({threadId:yield d("WAWebChatThreadLogging").getChatThreadID(b.id.toJid()),isAGroup:!1});c!=null&&(c.initiator!=null&&b.set({esrDisappearingModeInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(c.initiator)}),c.disappearingModeTrigger!=null&&b.set({esrEphemeralityTriggerAction:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(c.disappearingModeTrigger)}),b.set({esrEphemeralityDuration:c.duration,esrEphemeralityInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(c.initiatedByMe),esrEphemeralitySettingTimestamp:c.settingTimestamp}));e!=null&&(e.initiator!=null&&b.set({clientDisappearingModeInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(e.initiator)}),e.disappearingModeTrigger!=null&&b.set({clientEphemeralityTriggerAction:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(e.disappearingModeTrigger)}),b.set({clientEphemeralityDuration:e.duration,clientEphemeralityInitiator:d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(e.initiatedByMe),clientEphemeralitySettingTimestamp:e.settingTimestamp}));a!=null?b.set({esrResolveResult:d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.ERROR,esrFailureReason:a}):b.set({esrResolveResult:d("WAWebWamEnumEsrSendResultType").ESR_SEND_RESULT_TYPE.SUCCESS});b.commit()});return k.apply(this,arguments)}g.sendEphemeralSyncResponseSendWamEvent=a;g.sendEphemeralSyncResponseSendErrorWamEvent=c;g.sendEphemeralSyncResponseReceiveWamEvent=e}),98);
__d("WAWebUpdateEphemeralSettingChatAction",["WALogger","WAWebDBChatEphemeralExemptionData","WAWebDBUpdateChatTable","WAWebEphemeralGenerateSystemMessage","WAWebEphemeralityTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] updateChatEphemeralSettings"]))).devConsole(babelHelpers["extends"]({chat:a.id},b)),yield d("WAWebDBUpdateChatTable").updateChatTable(a.id,babelHelpers["extends"]({},b,{disappearingModeInitiator:b.disappearingModeInitiator,disappearingModeTrigger:b.disappearingModeTrigger!=null?b.disappearingModeTrigger:null})),a.set(b),d("WAWebDBChatEphemeralExemptionData").updateEphemeralDurationCache(a.id,a.ephemeralDuration)});return j.apply(this,arguments)}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield i(a,{ephemeralDuration:0,ephemeralSettingTimestamp:Date.now(),disappearingModeInitiator:d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat}),yield d("WAWebEphemeralGenerateSystemMessage").generateEphemeralUnsupportedNotificationTemplateSystemMessage(a)});return k.apply(this,arguments)}g.updateChatEphemeralSettings=i;g.setChatAsEphemeralityUnsupported=a}),98);
__d("WAWebEphemeralSyncResponse",["WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebABProps","WAWebBackoff","WAWebChatCollection","WAWebChatEphemerality","WAWebChatGetters","WAWebChatThreadLogging","WAWebCommonMsgUtils","WAWebContactCollection","WAWebDBChatEphemeralExemptionData","WAWebDBUpdateChatTable","WAWebDBUpdateMessageTable","WAWebEphemeralGenerateSystemMessage","WAWebEphemeralIsDurationAllowed","WAWebEphemeralOutOfSyncInfoWamEvent","WAWebEphemeralSyncResponseWAM","WAWebEphemeralityResolver","WAWebMsgCollection","WAWebMsgEphemerality","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebOrchestratorNonPersistedJob","WAWebSendMsgRecordAction","WAWebUpdateEphemeralSettingChatAction","WAWebUserPrefsMeUser","WAWebWamEnumEsrFailureReasonType","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;function z(){return d("WAWebABProps").getABPropConfigValue("ephemeral_sync_response")}function A(){d("WAWebABProps").getABPropConfigValue("ephemeral_sync_response"),d("WAWebABProps").getABPropConfigValue("dm_reliability_logging")}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] setting ephemeralOutOfSync on msg"]))).devConsole({msg:a});var b={ephemeralOutOfSync:!0};z()&&(yield d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,b));a.ephemeralOutOfSync=!0;a=d("WAWebMsgCollection").MsgCollection.get(a.id);a&&a.set(b)});return C.apply(this,arguments)}function a(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebChatCollection").ChatCollection.get(a.id.remote);if(!b)throw c("err")("[DMResolve] chat model not found for ESR message");if(d("WAWebChatGetters").getIsGroup(b)){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] EPHEMERAL_SYNC_RESPONSE should not be processed for group chats ",""])),b.id.toLogString()).sendLogs("handle-ephemeral-sync-response");return}A();if(!z()){void d("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:b,failureReason:d("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.ESR_ABPROP_OFF});return}if(b.contact.isEnterprise){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] cannot process EPHEMERAL_SYNC_RESPONSE for enterprise contact ",""])),b.id.toLogString());return}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] processing EPHEMERAL_SYNC_RESPONSE"]))).devConsole({chat:b,msg:a});a={id:a.id,type:a.type,kind:a.kind,ephemeralDuration:a.ephemeralDuration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,disappearingModeInitiator:a.disappearingModeInitiator,disappearingModeTrigger:a.disappearingModeTrigger,disappearingModeInitiatedByMe:a.disappearingModeInitiatedByMe};a=d("WAWebMsgEphemerality").getMsgEphemeralitySettings(a);if(a!=null){if(!d("WAWebEphemeralIsDurationAllowed").isEphemeralDurationAllowed(a.duration)){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] processEphemeralSyncResponse called with invalid setting "," seconds for chat ",""])),a.duration,b.id.toLogString());void d("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:b,failureReason:d("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.INVALID_EPHEMERAL_DURATION});return}var e=d("WAWebChatEphemerality").getChatEphemeralityFields(b);if(d("WAWebEphemeralityResolver").compareEphemeralityFields(e,a)){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Received ESR, but chat and msg settings are already the same"]))).devConsole({originalChatEphemeralSetting:e,msgEphemeralSetting:a});return}d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Updating chat due to EPHEMERAL_SYNC_RESPONSE"]))).devConsole({originalChatEphemeralSetting:e,msgEphemeralSetting:a});b.ephemeralDuration=a.duration;b.ephemeralSettingTimestamp=d("WAWebEphemeralityResolver").resolveSettingTimestamp(a.settingTimestamp);var f=d("WAWebEphemeralityResolver").resolveDisappearingModeTrigger(a.disappearingModeTrigger),g=d("WAWebEphemeralityResolver").resolveDisappearingModeInitiator(a.initiator);b.disappearingModeInitiator=g;b.disappearingModeTrigger=f;b.disappearingModeInitiatedByMe=d("WAWebEphemeralityResolver").resolveDisappearingModeInitiatedByMe(a.initiatedByMe,a.initiator);yield d("WAWebDBUpdateChatTable").updateChatTable(b.id,{ephemeralDuration:b.ephemeralDuration,ephemeralSettingTimestamp:b.ephemeralSettingTimestamp,disappearingModeInitiator:g,disappearingModeTrigger:f,disappearingModeInitiatedByMe:b.disappearingModeInitiatedByMe});d("WAWebDBChatEphemeralExemptionData").updateEphemeralDurationCache(b.id,b.ephemeralDuration);g=d("WAWebEphemeralityResolver").resolveEphermalityDuration(e==null?void 0:e.duration)!==d("WAWebEphemeralityResolver").resolveEphermalityDuration(a==null?void 0:a.duration);g&&(yield d("WAWebEphemeralGenerateSystemMessage").generateEphemeralNotificationTemplateSystemMessage(b,a.duration,null));void d("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseReceiveWamEvent({chat:b,incomingESRSettings:a,localChatSettings:e})}});return D.apply(this,arguments)}var E=new(d("WAWebBackoff").BackoffCache)([1e3*60*3,1e3*60*15,Infinity],{resetInterval:d("WATimeUtils").DAY_SECONDS});function F(a,b,c,d){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){A();if(!z()||!a.isUser()||a.isPSA()||a.isBot()){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] skip sending ESR: disabled or unsupported chat"])));return}if(c("gkx")("26256")){var g;window.esrCount=((g=window.esrCount)!=null?g:0)+1}g=a.toString();if(E.test(g)){var h;d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Not sending ESR to "," due to back off limit"])),a).devConsole({currentBackoff:E.get(a.toString())});h=(h=E.get(g))==null?void 0:h.attempts;h!=null&&void d("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseSendErrorWamEvent({to:a,error:d("WAWebWamEnumEsrFailureReasonType").ESR_FAILURE_REASON_TYPE.ATTEMPTS_EXHAUSTED,attempts:h});return}h=b.duration;var i=b.settingTimestamp,j=b.initiator,k=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),l=new(c("WAWebMsgKey"))({fromMe:!0,remote:a,id:yield c("WAWebMsgKey").newId(),participant:void 0});l={id:l,from:k,to:a,t:d("WATimeUtils").unixTime(),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"ephemeral_sync_response",ephemeralDuration:h,ephemeralSettingTimestamp:i,disappearingModeInitiator:j};var m=new(d("WAWebMsgModel").Msg)(l);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] Sending out EPHEMERAL_SYNC_RESPONSE"]))).devConsole({messageData:l});void d("WAWebEphemeralSyncResponseWAM").sendEphemeralSyncResponseSendWamEvent({to:a,changes:b,incomingMsgSettings:e,localChatSettings:f,attempts:(k=E.get(g))==null?void 0:k.attempts});return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",function(){return d("WAWebSendMsgRecordAction").sendMsgRecord(m)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()});return G.apply(this,arguments)}function H(a,b){return d("WAWebChatGetters").getIsUser(b)&&!b.contact.isEnterprise&&!a.id.fromMe&&d("WAWebMsgEphemerality").messageSupportsEphemerality(a.type)?!0:!1}function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;if(!d("WAWebABProps").getABPropConfigValue("out_of_sync_disappearing_messages_logging"))return;d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["logEphemeralOutOfSync"])));c=(c=d("WAWebChatEphemerality").getEphemeralSetting(b))!=null?c:0;var e=d("WAWebEphemeralityResolver").getEphemeralDurationForUser(d("WAWebContactCollection").ContactCollection.getMeContact()),f=d("WAWebEphemeralityResolver").getEphemeralDurationForUser(b.contact);new(d("WAWebEphemeralOutOfSyncInfoWamEvent").EphemeralOutOfSyncInfoWamEvent)({incomingMessageEphemeralityDuration:a!=null?a:0,isAGroup:d("WAWebChatGetters").getIsGroup(b),threadEphemeralityDuration:c,otherDefaultModeDuration:f!=null?f:0,userDefaultModeDuration:e!=null?e:0,threadId:yield d("WAWebChatThreadLogging").getChatThreadID(b.id.toJid()),isNewThreadForUser:b.msgs.length===0}).commit()});return J.apply(this,arguments)}function e(a,b){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype==="ephemeral_setting";if(!H(a,b)&&!c){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] dropping msg from ephemeral sync"]))).devConsole({msg:a,chat:b});return}var e=d("WAWebMsgEphemerality").getMsgEphemeralitySettings(a),f=d("WAWebChatEphemerality").getChatEphemeralityFields(b);d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] resolving ephemerality using existing chat DM settings:"]))).devConsole({incomingMsgSettings:e,localChatSettings:f,msg:a});var g=d("WAWebEphemeralityResolver").resolveExistingChatDMSettings(e,f),h=d("WAWebEphemeralityResolver").compareEphemeralityFields(f,g),i=d("WAWebEphemeralityResolver").compareEphemeralityFields(e,g);if(g==null||h&&i)d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] neither party is out-of-sync"]))).devConsole(g),E.remove(b.id.toString());else{d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] ESR resolution details: ",""])),JSON.stringify({msgId:a.id.toString(),resolution:g,incomingMsgSettings:e,localChatSettings:f}));if(!h){d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] local is out-of-sync, updating local chat DM settings"])));yield d("WAWebUpdateEphemeralSettingChatAction").updateChatEphemeralSettings(b,{ephemeralSettingTimestamp:g.settingTimestamp,ephemeralDuration:g.duration,disappearingModeInitiator:g.initiator,disappearingModeTrigger:g.disappearingModeTrigger,disappearingModeInitiatedByMe:g.initiatedByMe});!c&&g.duration!==((h=f==null?void 0:f.duration)!=null?h:0)&&(d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] rendering DM system message as duration has changed"]))),yield d("WAWebEphemeralGenerateSystemMessage").generateEphemeralNotificationTemplateSystemMessage(b,g.duration,null))}if(!i){d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] other party is out-of-sync, sending EPHEMERAL_SYNC_RESPONSE"])));if(!d("WAWebCommonMsgUtils").isNotificationType(a.type,a.subtype)){h=(c=e==null?void 0:e.duration)!=null?c:0;g.duration!==h&&(B(a),I(e==null?void 0:e.duration,b));void F(a.from,g,e,f)}}}});return K.apply(this,arguments)}f=F;g.processEphemeralSyncResponse=a;g.syncEphemeralSetting=e;g._sendEphemeralSyncResponse=f}),98);
__d("WAWebEphemeralFbtKic",["fbt","$InternalEnum","WALogger","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebMiscGatingUtils"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u=b("$InternalEnum").Mirrored(["SettingChangeByOthers","SettingChangeByYou","SettingChangeByUnknown","SettingChangeByOthersAsAdmin","SettingChangeByYouAsAdmin","SettingChangeByUnknownAsAdmin","Duration","OutOfSyncInfo","Explanation","ModeChangeByOthers","ModeChangeByYou"]);function a(a,b){a===void 0&&(a=0);return F(u.SettingChangeByOthers,a,b)}function c(a,b){a===void 0&&(a=0);return L(u.SettingChangeByOthers,a,b)}function e(a){a===void 0&&(a=0);return F(u.SettingChangeByYou,a)}function v(a){a===void 0&&(a=0);return F(u.SettingChangeByUnknown,a)}function w(a,b){a===void 0&&(a=0);return F(u.SettingChangeByOthersAsAdmin,a,b)}function x(a,b){a===void 0&&(a=0);return L(u.SettingChangeByOthersAsAdmin,a,b)}function y(a){a===void 0&&(a=0);return F(u.SettingChangeByYouAsAdmin,a)}function z(a){a===void 0&&(a=0);return F(u.SettingChangeByUnknownAsAdmin,a)}function A(a){a===void 0&&(a=0);return F(u.Duration,a)}function B(a){a===void 0&&(a=0);return F(u.OutOfSyncInfo,a)}function C(a){a===void 0&&(a=0);return F(u.Explanation,a)}function D(a,b){a===void 0&&(a=0);return F(u.ModeChangeByOthers,a,b)}function E(a){a===void 0&&(a=0);return F(u.ModeChangeByYou,a)}function F(a,b,c){b===void 0&&(b=0);if(b<0){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralString "," is given invalid duration ",""])),a,b).sendLogs("invalid-duration");return""}if(b===0)return G(a,c);else if(b<=60)return H(a,b,c);else if(b<60*60){var e=Math.floor(b/60);return I(a,e,c)}else if(b<=24*60*60){e=Math.floor(b/60/60);return J(a,e,c)}e=Math.floor(b/24/60/60);return K(a,e,c)}function G(a,b){if(a===u.SettingChangeByOthers&&b!=null)return h._(/*BTDS*/"{person-name} turned off disappearing messages.",[h._param("person-name",b)]);else if(a===u.SettingChangeByYou)return h._(/*BTDS*/"You turned off disappearing messages.");else if(a===u.SettingChangeByUnknown)return h._(/*BTDS*/"Disappearing messages were turned off.");else if(a===u.SettingChangeByOthersAsAdmin&&b!=null)return h._(/*BTDS*/"{person-name} turned off disappearing messages. Click to change.",[h._param("person-name",b)]);else if(a===u.SettingChangeByYouAsAdmin)return h._(/*BTDS*/"You turned off disappearing messages. Click to change.");else if(a===u.SettingChangeByUnknownAsAdmin)return h._(/*BTDS*/"Disappearing messages were turned off. Click to change.");else if(a===u.Duration)return h._(/*BTDS*/"Off");else if(a===u.OutOfSyncInfo)return h._(/*BTDS*/"This message will not disappear from the chat. The sender may be on an old version of WhatsApp.");d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOffString is given invalid type ",""])),a).sendLogs("invalid-ephemeral-string-type");return""}function H(a,b,c){var e=d("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]);else if(a===u.SettingChangeByYou)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.SettingChangeByUnknown)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 second after they're sent, except when kept.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]);else if(a===u.SettingChangeByYouAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to change.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.SettingChangeByUnknownAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to change.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.Duration)return h._(/*BTDS*/"_j{\"*\":\"{number_of_seconds} seconds\",\"_1\":\"1 second\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.OutOfSyncInfo)return h._(/*BTDS*/"_j{\"*\":\"This message will disappear from this chat {number_of_seconds} seconds after it's sent, except when kept.\",\"_1\":\"This message will disappear from this chat 1 second after it's sent, except when kept.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.Explanation)return h._(/*BTDS*/"_j{\"*\":\"New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept.\",\"_1\":\"New messages will disappear from this chat 1 second after they're sent, except when kept.\"}",[h._plural(b,"number_of_seconds")]);else if(a===u.ModeChangeByOthers)return e?h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to set your own default timer.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to set your own default timer.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]):h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to learn more.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to learn more.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]);else if(a===u.ModeChangeByYou&&e)return h._(/*BTDS*/"_j{\"*\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to change your default timer.\",\"_1\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to change your default timer.\"}",[h._plural(b,"number_of_seconds")]);d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnSecondsString is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function I(a,b,c){var e=d("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]);else if(a===u.SettingChangeByYou)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.SettingChangeByUnknown)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 minute after they're sent, except when kept.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]);else if(a===u.SettingChangeByYouAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to change.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.SettingChangeByUnknownAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to change.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.Duration)return h._(/*BTDS*/"_j{\"*\":\"{number_of_minutes} minutes\",\"_1\":\"1 minute\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.OutOfSyncInfo)return h._(/*BTDS*/"_j{\"*\":\"This message will disappear from this chat {number_of_minutes} minutes after it's sent, except when kept.\",\"_1\":\"This message will disappear from this chat 1 minute after it's sent, except when kept.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.Explanation)return h._(/*BTDS*/"_j{\"*\":\"New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept.\",\"_1\":\"New messages will disappear from this chat 1 minute after they're sent, except when kept.\"}",[h._plural(b,"number_of_minutes")]);else if(a===u.ModeChangeByOthers)return e?h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to set your own default timer.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to set your own default timer.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]):h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to learn more.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to learn more.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]);else if(a===u.ModeChangeByYou&&e)return h._(/*BTDS*/"_j{\"*\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to change your default timer.\",\"_1\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to change your default timer.\"}",[h._plural(b,"number_of_minutes")]);d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnMinutesString is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function J(a,b,c){var e=d("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]);else if(a===u.SettingChangeByYou)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.SettingChangeByUnknown)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 hour after they're sent, except when kept.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]);else if(a===u.SettingChangeByYouAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to change.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.SettingChangeByUnknownAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to change.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.Duration)return h._(/*BTDS*/"_j{\"*\":\"{number_of_hours} hours\",\"_1\":\"1 hour\"}",[h._plural(b,"number_of_hours")]);else if(a===u.OutOfSyncInfo)return h._(/*BTDS*/"_j{\"*\":\"This message will disappear from this chat {number_of_hours} hours after it's sent, except when kept.\",\"_1\":\"This message will disappear from this chat 1 hour after it's sent, except when kept.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.Explanation)return h._(/*BTDS*/"_j{\"*\":\"New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept.\",\"_1\":\"New messages will disappear from this chat 1 hour after they're sent, except when kept.\"}",[h._plural(b,"number_of_hours")]);else if(a===u.ModeChangeByOthers)return e?h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to set your own default timer.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to set your own default timer.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]):h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to learn more.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to learn more.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]);else if(a===u.ModeChangeByYou&&e)return h._(/*BTDS*/"_j{\"*\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to change your default timer.\",\"_1\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to change your default timer.\"}",[h._plural(b,"number_of_hours")]);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnHoursString is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function K(a,b,c){var e=d("WAWebMiscGatingUtils").isDefaultDisappearingMessagesEnabled();if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]);else if(a===u.SettingChangeByYou)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept.\"}",[h._plural(b,"number_of_days")]);else if(a===u.SettingChangeByUnknown)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 day after they're sent, except when kept.\"}",[h._plural(b,"number_of_days")]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]);else if(a===u.SettingChangeByYouAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"You turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to change.\",\"_1\":\"You turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_days")]);else if(a===u.SettingChangeByUnknownAsAdmin)return h._(/*BTDS*/"_j{\"*\":\"Disappearing messages were turned on. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to change.\",\"_1\":\"Disappearing messages were turned on. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_days")]);else if(a===u.Duration)return h._(/*BTDS*/"_j{\"*\":\"{number_of_days} days\",\"_1\":\"1 day\"}",[h._plural(b,"number_of_days")]);else if(a===u.OutOfSyncInfo)return h._(/*BTDS*/"_j{\"*\":\"This message will disappear from this chat {number_of_days} days after it's sent, except when kept.\",\"_1\":\"This message will disappear from this chat 1 day after it's sent, except when kept.\"}",[h._plural(b,"number_of_days")]);else if(a===u.Explanation)return h._(/*BTDS*/"_j{\"*\":\"New messages will disappear from this chat {number_of_days} days after they're sent, except when kept.\",\"_1\":\"New messages will disappear from this chat 1 day after they're sent, except when kept.\"}",[h._plural(b,"number_of_days")]);else if(a===u.ModeChangeByOthers)return e?h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to set your own default timer.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to set your own default timer.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]):h._(/*BTDS*/"_j{\"*\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to learn more.\",\"_1\":\"{person-name} uses a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to learn more.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]);else if(a===u.ModeChangeByYou&&e)return h._(/*BTDS*/"_j{\"*\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to change your default timer.\",\"_1\":\"You use a default timer for disappearing messages in new chats. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to change your default timer.\"}",[h._plural(b,"number_of_days")]);d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnDaysString is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function L(a,b,c){b===void 0&&(b=0);if(b<0){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralString "," is given invalid duration ",""])),a,b).sendLogs("invalid-duration");return""}if(b===0)return M(a,c);else if(b<=60)return N(a,b,c);else if(b<60*60){var e=Math.floor(b/60);return O(a,e,c)}else if(b<=24*60*60){e=Math.floor(b/60/60);return P(a,e,c)}e=Math.floor(b/24/60/60);return Q(a,e,c)}function M(a,b){if(a===u.SettingChangeByOthers&&b!=null)return h._(/*BTDS*/"{person-name} turned off disappearing messages.",[h._param("person-name",b)]);else if(a===u.SettingChangeByOthersAsAdmin&&b!=null)return h._(/*BTDS*/"{person-name} turned off disappearing messages. Click to change.",[h._param("person-name",b)]);d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOffL10nComponent is given invalid type ",""])),a).sendLogs("invalid-ephemeral-string-type");return""}function N(a,b,c){if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_seconds} seconds after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 second after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_seconds"),h._param("person-name",c)]);d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnSecondsL10nComponent is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function O(a,b,c){if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_minutes} minutes after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 minute after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_minutes"),h._param("person-name",c)]);d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnMinutesL10nComponent is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function P(a,b,c){if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_hours} hours after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 hour after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_hours"),h._param("person-name",c)]);d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnHoursL10nComponent is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function Q(a,b,c){if(a===u.SettingChangeByOthers&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]);else if(a===u.SettingChangeByOthersAsAdmin&&c!=null)return h._(/*BTDS*/"_j{\"*\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat {number_of_days} days after they're sent, except when kept. Click to change.\",\"_1\":\"{person-name} turned on disappearing messages. New messages will disappear from this chat 1 day after they're sent, except when kept. Click to change.\"}",[h._plural(b,"number_of_days"),h._param("person-name",c)]);d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["getEphemeralOnDaysL10nComponent is given type "," and name ",""])),a,c).sendLogs("invalid-ephemeral-string-type");return""}function R(a){a=d("WAWebContactCollection").ContactCollection.assertGet(a);if(d("WAWebContactGetters").getIsMe(a))return h._(/*BTDS*/"Kept by you");a=d("WAWebFrontendContactGetters").getFormattedName(a);return h._(/*BTDS*/"Kept by {person-name}",[h._param("person-name",a)])}R.displayName=R.name+" [from "+f.id+"]";g.getDisappearingMessageSettingOthersStringKic=a;g.getDisappearingMessageSettingOthersGroupStringKic=c;g.getDisappearingMessageSettingYouStringKic=e;g.getDisappearingMessageSettingUnknownStringKic=v;g.getDisappearingMessageSettingOthersAsAdminStringKic=w;g.getDisappearingMessageSettingOthersAsAdminGroupStringKic=x;g.getDisappearingMessageSettingYouAsAdminStringKic=y;g.getDisappearingMessageSettingUnknownAsAdminStringKic=z;g.getDisappearingMessageDurationStringKic=A;g.getDisappearingMessageOutOfSyncInfoStringKic=B;g.getDisappearingMessageExplanationStringKic=C;g.getDisappearingModeOtherStringKic=D;g.getDisappearingModeYouStringKic=E;g.getKeptByString=R}),226);
__d("WAWebDBEventInvalidateChatEvents",["WAWebDBMessageUtils","WAWebModelStorageUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.between(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(a),d("WAWebDBMessageUtils").endOfChat(a)));yield b.bulkCreateOrMerge(c.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION&&!a.eventInvalidated}).map(function(a){return{id:a.id,eventInvalidated:!0}}))});return function(a){return c.apply(this,arguments)}}())}g.invalidateChatEvents=a}),98);
__d("WAWebInvalidateEventsAction",["WALogger","WAWebDBEventInvalidateChatEvents","WAWebFrontendMsgGetters","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield d("WAWebDBEventInvalidateChatEvents").invalidateChatEvents(a.id),a.msgs.filter(function(a){return d("WAWebFrontendMsgGetters").getAsEventCreation(a)&&!a.eventInvalidated}).forEach(function(a){a.eventInvalidated=!0})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[EVENTS] Failed to invalidate events with error: ",""])),a).devConsole(a)}});return i.apply(this,arguments)}g.invalidateEventMsgsForChat=a}),98);
__d("WAWebCollectionConstants",[],(function(a,b,c,d,e,f){a="collection_has_synced";b=50;c=20;f.COLLECTION_HAS_SYNCED=a;f.PAGE_SIZE=b;f.MSG_PRELOAD_THRESHOLD=c}),66);
__d("WAWebEventMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebCollectionConstants","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebNoop","WAWebSocketConstants","WAWebSocketModel"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(b){var c;c=a.call(this)||this;c.syncPromise=null;c.isFullySynced=!1;c.isInitialized=!1;c.chat=b;c.listenTo(d("WAWebSocketModel").Socket,"change:stream",function(){d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED?c.isFullySynced=!1:d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED&&c["delete"]()});return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){if(this.isInitialized)return(i||(i=b("Promise"))).resolve();var a=this.chat.msgs;if(a==null)return(i||(i=b("Promise"))).resolve();a.length&&this.add(a.filter(j));a=(i||(i=b("Promise"))).resolve();this.chat.msgs.msgLoadState.noEarlierMsgs?this.isFullySynced=!0:a=this.queryEvents({recurse:!1});this.isInitialized=!0;return a};f["delete"]=function(){this.isFullySynced=!1,this.isInitialized=!1,a.prototype["delete"].call(this)};f.queryEvents=function(a){var e=this,f=a.recurse;if(this.syncPromise)return this.syncPromise;if(this.isFullySynced)return(i||(i=b("Promise"))).resolve();var g;a=this.last();a&&(g=a.id);a=(this.syncPromise=d("WAWebMsgCollection").MsgCollection.getEventMsgs(this.chat.id,d("WAWebCollectionConstants").PAGE_SIZE,g).then(function(a){(!a||a.length<d("WAWebCollectionConstants").PAGE_SIZE)&&(e.isFullySynced=!0),e.add(a.filter(j))}).then(function(){e.syncPromise=null;if(e.isFullySynced)e.trigger(d("WAWebCollectionConstants").COLLECTION_HAS_SYNCED);else if(f===!0){e.trigger("partial_sync");return e.queryEvents({recurse:!0})}})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Event msg sync error: "]))).devConsole(a)}))["finally"](function(){e.syncPromise=null});return a};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return b.t-a.t};function j(a){return d("WAWebFrontendMsgGetters").getAsEventCreation(a)!=null}g.EventMsgsCollection=a}),98);
__d("WAWebEventResponseGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createEventResponseCache});b=a.field;c=a.unsafeIdentityGetter;e=a.clearCacheFor;f=e;d=c;a=b("sender");e=b("senderTimestampMs");g.clearEventResponseGetterCacheFor=f;g.getEventResponseUnsafe=d;g.getSender=a;g.getSenderTimestampMs=e}),98);
__d("WAWebFrontendEventResponseGetters",["WAWebEventResponseGetters","WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({root:d("WAWebEventResponseGetters").getEventResponseUnsafe,createCache:d("WAWebGettersCaches").createFrontendEventResponseCache});b=a.clearCacheFor;c=b;g.clearFrontendEventResponseGetterCacheFor=c}),98);
__d("WAWebEventResponseModel",["WAWebAddOnModel","WAWebBaseModel","WAWebEventResponseGetters","WAWebFrontendEventResponseGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.parentMsgKey=d("WAWebBaseModel").prop(),b.eventResponse=d("WAWebBaseModel").prop(),b.senderTimestampMs=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.sender=d("WAWebBaseModel").prop(),b.read=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebEventResponseGetters").clearEventResponseGetterCacheFor(this),d("WAWebFrontendEventResponseGetters").clearFrontendEventResponseGetterCacheFor(this)};return b}(d("WAWebAddOnModel").AddOnBaseModel);b=d("WAWebBaseModel").defineModel(a);g.EventResponse=b}),98);
__d("WAWebEventResponseCollection",["WANullthrows","WAWebAck","WAWebBaseCollection","WAWebCollectionUtils","WAWebEventResponseModel","WAWebMsgGetters","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.byParent=d("WAWebCollectionUtils").aggregated(function(a){return a.parentMsgKey}),b.byIsFailedByMe=d("WAWebCollectionUtils").aggregated(function(a){return a.isSendFailure===!0||d("WAWebUserPrefsMeUser").isMeAccount(a.sender)&&a.ack!=null&&a.ack<d("WAWebAck").ACK.CLOCK}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebEventResponseModel").EventResponse;function a(a){return new(d("WAWebEventResponseModel").EventResponse)(babelHelpers["extends"]({},a,{sender:c("WANullthrows")(d("WAWebMsgGetters").getSender(a))}))}e=new b();g.createEventResponseModel=a;g.EventResponseCollection=e}),98);
__d("WAWebActionToast.react",["WAAbortError","WAPromiseDelays","WAWebNonEmptyString","WAWebNoop","WAWebToast.react","WAWebToastManager","err","react","uniqueID","useWAWebPrevious"],(function(a,b,c,d,e,f,g){var h,i;b=i||d("react");var j=h||(h=c("react")),k=b.useCallback,l=b.useEffect,m=b.useMemo,n=b.useRef,o=b.useState,p=5e3,q={LEFT:"LEFT",RIGHT:"RIGHT"};e=function(a,b){if(!a)throw c("err")("ActionType must have text!");this.text=a;b&&(this.action=b.actionText,this.handler=b.actionHandler)};function r(a){return d("WAWebNonEmptyString").asNonEmptyString(c("uniqueID")((a=d("WAWebNonEmptyString").asMaybeNonEmptyString(a))!=null?a:"action_toast"))}function a(a){var b=a.settleDuration,e=b===void 0?p:b;b=a.toastPosition;b=b===void 0?q.LEFT:b;var f=a.initialAction,g=a.pendingAction,h=a.id,i=h===void 0?r():h,s=a.onDismiss;h=o(f);a=h[0];var t=h[1];h=o(f);var u=h[0],v=h[1];h=o(!0);var w=h[0],x=h[1],y=c("useWAWebPrevious")(a),z=n(null),A=n(null),B=n(null),C=k(function(){if(!u)return;if(!u.handler)return;u.handler()["catch"](c("WAWebNoop"))},[u]);l(function(){f!==y&&(t(f),v(f),x(!0))},[f,y]);var D=m(function(){return new AbortController()},[]),E=D.signal,F=k(function(){s!=null&&s(),D.abort(),d("WAWebToastManager").ToastManager.close(i)},[s,i,D]),G=function(a){z.current&&z.current.controller.abort();var b=new AbortController(),f=b.signal;a=a.then(function(a){if(f.aborted)throw new(d("WAAbortError").AbortError)();v(a);x(!1)})["catch"](function(a){if(a.name!==d("WAAbortError").ABORT_ERROR)v(a),x(!1);else throw a}).then(function(){return d("WAPromiseDelays").delayMs(e,E)}).then(function(){if(f.aborted)throw new(d("WAAbortError").AbortError)();s!=null&&s();d("WAWebToastManager").ToastManager.close(i)})["catch"](d("WAAbortError").catchAbort(c("WAWebNoop")));z.current={promise:a,controller:b}};l(function(){G(g)},[g]);var H=m(function(){if(u!=null){var a=u.action,b=u.handler;if(a!=null&&b!=null)return j.jsx(d("WAWebToast.react").ToastActionBtn,{buttonText:a,onClick:C,ref:A})}return null},[u,C]),I=m(function(){return w?null:j.jsx(d("WAWebToast.react").ToastDismissBtn,{onClick:F,ref:B})},[F,w]);h=m(function(){if(H)return A;return I?B:null},[H,I]);return!u?null:j.jsx(d("WAWebToast.react").ToastBody,{toastPosition:b,actionText:u.text,actionButtons:H!=null?H:void 0,dismissButton:I!=null?I:void 0,focusButtonRef:h})}a.displayName=a.name+" [from "+f.id+"]";g.ToastPosition=q;g.ActionType=e;g.genId=r;g.ActionToast=a}),98);
__d("WAWebInboxFiltersGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("inbox_filters_smb_enabled"):!0}function a(){return h()&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("primary_favorites_sync_support")}function b(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("inbox_filters_smb_enabled")&&d("WAWebABProps").getABPropConfigValue("inbox_filters_custom_smb_enabled")}g.inboxFiltersEnabled=h;g.inboxFavoritesEnabled=a;g.inboxCustomFiltersEnabled=b}),98);
__d("WAWebAddToFavoritesAction",["fbt","WALogger","WATimeUtils","WAWebABProps","WAWebActionToast.react","WAWebConfirmPopup.react","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebFavoritesLogging","WAWebFavoritesSync","WAWebFbtCommon","WAWebInboxFiltersGatingUtils","WAWebL10NHelpers","WAWebListsGatingUtils","WAWebModalManager","WAWebSyncdCoreApi","WAWebToastManager","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react");function l(){return d("WAWebListsGatingUtils").isListsEnabled()?d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Adding to Favourites list"):h._(/*BTDS*/"Adding to Favorites list"):d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Adding to Favourites"):h._(/*BTDS*/"Adding to Favorites")}function m(){return d("WAWebListsGatingUtils").isListsEnabled()?d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Added to Favourites list"):h._(/*BTDS*/"Added to Favorites list"):d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Added to Favourites"):h._(/*BTDS*/"Added to Favorites")}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f;if(!d("WAWebInboxFiltersGatingUtils").inboxFavoritesEnabled())return;var g=(yield d("WAWebDBFavoriteDatabaseApi").getAllFavorites());f=(f=d("WAWebABProps").getABPropConfigValue("favorites_limit"))!=null?f:100;if(g.length+(Array.isArray(a)?a.length:1)>f){d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return d("WAWebModalManager").ModalManager.close()},okText:c("WAWebFbtCommon")("OK"),children:d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"You can't add more than {favorites_limit} favourites",[h._param("favorites_limit",f)]):h._(/*BTDS*/"You can't add more than {favorites_limit} favorites",[h._param("favorites_limit",f)])}));return}var j;if(Array.isArray(a)){var n=(yield d("WAWebDBFavoriteDatabaseApi").getNextFavoriteOrderIndex());j=a.map(function(a){return{id:a.toString(),orderIndex:n++}})}else j=[babelHelpers["extends"]({},a)];e.entryPoint!=null&&d("WAWebFavoritesLogging").logAddingMessagingFavorites(j,e.entryPoint);f=g.concat(j);a=d("WATimeUtils").unixTime();g=(yield c("WAWebFavoritesSync").getFavoritesMutation(f,a));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] addToFavoritesAction, mutation generated"]))).devConsole(g);f=d("WAWebSyncdCoreApi").lockForSync(["favorite","chat"],[g],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebDBFavoriteDatabaseApi").addOrEditFavorites(j)})).then(function(){return d("WAWebFavoriteCollection").FavoriteCollection.add(j.map(function(a){return babelHelpers["extends"]({},a)}))});if(e.suppressToast===!0)yield f;else{a=new(d("WAWebActionToast.react").ActionType)(l());g=f.then(function(){return new(d("WAWebActionToast.react").ActionType)(m())});d("WAWebToastManager").ToastManager.open(k.jsx(d("WAWebActionToast.react").ActionToast,{id:d("WAWebActionToast.react").genId(),initialAction:a,pendingAction:g}))}});return n.apply(this,arguments)}g.addToFavoritesAction=a}),226);
__d("WAWebRemoveFromFavoritesAction",["fbt","WALogger","WATimeUtils","WAWebActionToast.react","WAWebAddToFavoritesAction","WAWebDBFavoriteDatabaseApi","WAWebFavoriteCollection","WAWebFavoritesLogging","WAWebFavoritesSync","WAWebInboxFiltersGatingUtils","WAWebL10NHelpers","WAWebListsGatingUtils","WAWebSyncdCoreApi","WAWebToastManager","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react");function l(){return d("WAWebListsGatingUtils").isListsEnabled()?d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Removing from Favourites list"):h._(/*BTDS*/"Removing from Favorites list"):d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Removing from Favourites"):h._(/*BTDS*/"Removing from Favorites")}function m(){return d("WAWebListsGatingUtils").isListsEnabled()?d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Removed from Favourites list"):h._(/*BTDS*/"Removed from Favorites list"):d("WAWebL10NHelpers").isUsingSupportedBritishEnglishLocale()?h._(/*BTDS*/"Removed from Favourites"):h._(/*BTDS*/"Removed from Favorites")}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!d("WAWebInboxFiltersGatingUtils").inboxFavoritesEnabled())return;var f=a.toString();e.entryPoint!=null&&d("WAWebFavoritesLogging").logRemovingMessagingFavorites([f],e.entryPoint);a=(yield d("WAWebDBFavoriteDatabaseApi").getAllFavorites());var g=a.find(function(a){a=a.id;return a===f});a=a.filter(function(a){a=a.id;return a!==f});var j=d("WATimeUtils").unixTime();a=(yield c("WAWebFavoritesSync").getFavoritesMutation(a,j));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] removeFromFavoritesAction, mutation generated"]))).devConsole(a);j=d("WAWebSyncdCoreApi").lockForSync(["favorite","chat"],[a],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebDBFavoriteDatabaseApi").removeFavorites([f])})).then(function(){return d("WAWebFavoriteCollection").FavoriteCollection.remove([f])});if(e.suppressToast===!0)yield j;else{a=new(d("WAWebActionToast.react").ActionType)(l());j=j.then(function(){return new(d("WAWebActionToast.react").ActionType)(m(),g?{actionText:h._(/*BTDS*/"Undo"),actionHandler:function(){return d("WAWebAddToFavoritesAction").addToFavoritesAction(g,{entryPoint:e.entryPoint})}}:void 0)});d("WAWebToastManager").ToastManager.open(k.jsx(d("WAWebActionToast.react").ActionToast,{id:d("WAWebActionToast.react").genId(),initialAction:a,pendingAction:j}))}});return n.apply(this,arguments)}g.removeFromFavoritesAction=a}),226);
__d("WAWebFavoriteCollection",["WAWebBaseCollection","WAWebContactCollection","WAWebFavoriteModel","WAWebWidFactory"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.listenTo(b,"add",function(a){a=d("WAWebContactCollection").ContactCollection.get(d("WAWebWidFactory").createWid(a.id));a&&a.set("isFavorite",!0)});b.listenTo(b,"remove",function(a){a=d("WAWebContactCollection").ContactCollection.get(d("WAWebWidFactory").createWid(a.id));a&&a.set("isFavorite",!1)});return b}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebFavoriteModel").Favorite;b=new a();g.FavoriteCollection=b}),98);
__d("WAWebFavoriteModel",["WAWebBaseModel","WAWebFavoriteCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.orderIndex=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebFavoriteCollection").FavoriteCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="favorite";b=d("WAWebBaseModel").defineModel(a);g.Favorite=b}),98);
__d("WAWebWamEnumFavoritesUpdateEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({CONTACT_INFO:1,GROUP_INFO:2,CHAT_MORE_OPTIONS:3,CHAT_LONG_PRESS_OPTIONS:4,MESSAGE_FAVORITES_CONTACT_PICKER:5,FAVORITE_SETTINGS:6,FILTER_CONTEXT_MENU:7,FILTER_EMPTY_STATE_ACTION:8,FILTER_MANAGE_FAVORITE_ACTION:9,CALLING_TAB_FAVORITE_PICKER:10,CALLING_TAB_FAVORITE_EDIT:11,CHAT_CONTEXT_MENU:12,CHAT_HEADER_CONTEXT_MENU:13,CALL_LOG_LONG_PRESS_OPTIONS:14,CALL_LOG_MORE_OPTIONS:15});f.FAVORITES_UPDATE_ENTRY_POINT=a}),66);
__d("WAWebMessagingFavoritesUpdateWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumFavoritesUpdateEntryPoint"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MessagingFavoritesUpdate:[5460,{contactFavCountAfterUpdate:[1,a.TYPES.INTEGER],contactFavCountBeforeUpdate:[2,a.TYPES.INTEGER],favoritesUpdateEntryPoint:[3,d("WAWebWamEnumFavoritesUpdateEntryPoint").FAVORITES_UPDATE_ENTRY_POINT],groupFavCountAfterUpdate:[4,a.TYPES.INTEGER],groupFavCountBeforeUpdate:[5,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MessagingFavoritesUpdate:[]});g.MessagingFavoritesUpdateWamEvent=b}),98);
__d("WAWebFavoritesLogging",["WALogger","WAWebFavoriteCollection","WAWebMessagingFavoritesUpdateWamEvent","WAWebWid"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){try{var e=0,f=0,g=0,i=0;d("WAWebFavoriteCollection").FavoriteCollection.forEach(function(a){c("WAWebWid").isGroup(a.id)?g++:e++});f=e;i=g;a.forEach(function(a){c("WAWebWid").isGroup(a.id)?i++:f++});new(d("WAWebMessagingFavoritesUpdateWamEvent").MessagingFavoritesUpdateWamEvent)({favoritesUpdateEntryPoint:b,contactFavCountBeforeUpdate:e,contactFavCountAfterUpdate:f,groupFavCountBeforeUpdate:g,groupFavCountAfterUpdate:i}).commit()}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] logAddingMessagingFavorites, error: ",""])),a).sendLogs("logAddingMessagingFavorites")}}function b(a,b){try{var e=0,f=0,g=0,h=0;d("WAWebFavoriteCollection").FavoriteCollection.forEach(function(a){c("WAWebWid").isGroup(a.id)?g++:e++});f=e;h=g;a.forEach(function(a){c("WAWebWid").isGroup(a)?h--:f--});f=Math.max(f,0);h=Math.max(h,0);new(d("WAWebMessagingFavoritesUpdateWamEvent").MessagingFavoritesUpdateWamEvent)({favoritesUpdateEntryPoint:b,contactFavCountBeforeUpdate:e,contactFavCountAfterUpdate:f,groupFavCountBeforeUpdate:g,groupFavCountAfterUpdate:h}).commit()}catch(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[Favorites] logRemovingMessagingFavorites, error: ",""])),a).sendLogs("logRemovingMessagingFavorites")}}g.logAddingMessagingFavorites=a;g.logRemovingMessagingFavorites=b}),98);
__d("WAWebGroupSafetyCheckModalLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingConfirmPopup.react","asyncToGeneratorRuntime","react","react-loadable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||c("react");a=c("WAWebLazyLoadedRetriable")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("WAWebGroupSafetyCheckModal.react").__setRef("WAWebGroupSafetyCheckModalLoadable").load());return a}),"GroupSafetyCheckModal");d=c("react-loadable")({loader:a,loading:function(a){return i.jsx(c("WAWebLoadingConfirmPopup.react"),{error:Boolean(a.error)})}});g.GroupSafetyCheckModalLoadable=d}),98);
__d("WAWebPsGroupOpenedWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsGroupOpened:[6236,{integrityGroupUserHashedId:[4,a.TYPES.STRING],isGroupSafetyCheckAbpropEnabled:[2,a.TYPES.BOOLEAN],isPartOfGroupSafetyCheckExperiment:[3,a.TYPES.BOOLEAN],openedGroupJid:[1,a.TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupOpened:[]});g.PsGroupOpenedWamEvent=b}),98);
__d("WAWebPsGroupSafetyCheckEnabledWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsGroupSafetyCheckEnabled:[6238,{didJoinByGil:[3,a.TYPES.BOOLEAN],integrityGroupUserHashedId:[4,a.TYPES.STRING],psSafetyCheckGroupJid:[1,a.TYPES.STRING],psWasSafetyCheckGroupInitiallyMuted:[2,a.TYPES.BOOLEAN],wasAddedByContact:[5,a.TYPES.BOOLEAN],willSafetyCheckBeSeen:[6,a.TYPES.BOOLEAN]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckEnabled:[]});g.PsGroupSafetyCheckEnabledWamEvent=b}),98);
__d("WAWebWamEnumPsGroupSafetyCheckExitDialogActions",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP_EXIT_DIALOG_DISMISS:0,GROUP_EXIT_DIALOG_EXIT:1,GROUP_EXIT_DIALOG_EXIT_AND_REPORT:2,COMMUNITY_EXIT_DIALOG_DISMISS:3,COMMUNITY_EXIT_DIALOG_EXIT:4,COMMUNITY_EXIT_DIALOG_EXIT_AND_DELETE:5});f.PS_GROUP_SAFETY_CHECK_EXIT_DIALOG_ACTIONS=a}),66);
__d("WAWebPsGroupSafetyCheckExitDialogWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsGroupSafetyCheckExitDialogActions"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckExitDialog:[6252,{integrityGroupUserHashedId:[3,d("WAWebWamCodegenUtils").TYPES.STRING],psGroupSafetyCheckExitDialogAction:[1,d("WAWebWamEnumPsGroupSafetyCheckExitDialogActions").PS_GROUP_SAFETY_CHECK_EXIT_DIALOG_ACTIONS],psSafetyCheckGroupJid:[2,d("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckExitDialog:[]});g.PsGroupSafetyCheckExitDialogWamEvent=a}),98);
__d("WAWebPsGroupSafetyCheckSheetSeenWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckSheetSeen:[6240,{integrityGroupUserHashedId:[2,d("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckGroupJid:[1,d("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckSheetSeen:[]});g.PsGroupSafetyCheckSheetSeenWamEvent=a}),98);
__d("WAWebWamEnumPsGroupSafetyCheckUiInteractions",[],(function(a,b,c,d,e,f){a=Object.freeze({SEE_CHAT:0,EXIT_GROUP:1,EXIT_COMMUNITY:2,SEE_SCAM_EXAMPLES:3,PRIVACY_SETTINGS:4,HOW_TO_REPORT:5,DOUBLE_CHECK_LINKS:6,DISMISS:7,DRAG_DISMISS:8,X_BUTTON:9,BACK_BUTTON:10});f.PS_GROUP_SAFETY_CHECK_UI_INTERACTIONS=a}),66);
__d("WAWebPsGroupSafetyCheckUiInteractionsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsGroupSafetyCheckUiInteractions"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({PsGroupSafetyCheckUiInteractions:[6242,{integrityGroupUserHashedId:[3,d("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckGroupJid:[1,d("WAWebWamCodegenUtils").TYPES.STRING],psSafetyCheckInteraction:[2,d("WAWebWamEnumPsGroupSafetyCheckUiInteractions").PS_GROUP_SAFETY_CHECK_UI_INTERACTIONS]},[1,1,1],"private",216763284]},{PsGroupSafetyCheckUiInteractions:[]});g.PsGroupSafetyCheckUiInteractionsWamEvent=a}),98);
__d("WAWebGroupSafetyCheckModalLoggingUtils",["WAWebGroupSafetyCheckGatingUtils","WAWebPsGroupOpenedWamEvent","WAWebPsGroupSafetyCheckEnabledWamEvent","WAWebPsGroupSafetyCheckExitDialogWamEvent","WAWebPsGroupSafetyCheckSheetSeenWamEvent","WAWebPsGroupSafetyCheckUiInteractionsWamEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.groupJid;d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckLoggingEnabled()&&new(d("WAWebPsGroupOpenedWamEvent").PsGroupOpenedWamEvent)({isGroupSafetyCheckAbpropEnabled:d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled(),isPartOfGroupSafetyCheckExperiment:d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckIsPartOfExperiment(),openedGroupJid:a}).commit()}function b(a){var b=a.groupJid;a=a.initiallyMuted;d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled()&&new(d("WAWebPsGroupSafetyCheckEnabledWamEvent").PsGroupSafetyCheckEnabledWamEvent)({psSafetyCheckGroupJid:b,psWasSafetyCheckGroupInitiallyMuted:a}).commit()}function c(a){a=a.groupJid;new(d("WAWebPsGroupSafetyCheckSheetSeenWamEvent").PsGroupSafetyCheckSheetSeenWamEvent)({psSafetyCheckGroupJid:a}).commit()}function e(a){var b=a.groupJid;a=a.interaction;new(d("WAWebPsGroupSafetyCheckUiInteractionsWamEvent").PsGroupSafetyCheckUiInteractionsWamEvent)({psSafetyCheckGroupJid:b,psSafetyCheckInteraction:a}).commit()}function f(a){var b=a.groupJid;a=a.interaction;new(d("WAWebPsGroupSafetyCheckExitDialogWamEvent").PsGroupSafetyCheckExitDialogWamEvent)({psSafetyCheckGroupJid:b,psGroupSafetyCheckExitDialogAction:a}).commit()}g.logGroupOpenEvent=a;g.logGroupSafetyCheckEnabledEvent=b;g.logGroupSafetyCheckModalSeenEvent=c;g.logGroupSafetyCheckUIInteractionsEvent=e;g.logGroupSafetyCheckExitDialogUIInteractionsEvent=f}),98);
__d("WAWebGroupSafetyCheckUtils",["WAWebChatGetters","WAWebCmd","WAWebFrontendMsgGetters","WAWebGroupSafetyCheckGatingUtils","WAWebGroupSafetyCheckModalLoadable","WAWebGroupSafetyCheckModalLoggingUtils","WAWebModalManager","WAWebMuteGetters","WAWebNotificationHelpers","WAWebStateUtils","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||c("react");function j(a){if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&!!((a=a.groupMetadata)!=null&&a.groupSafetyCheck)}function a(a,b,c){var e=c===!0&&!b;c=c===!1&&!b;e&&d("WAWebGroupSafetyCheckModalLoggingUtils").logGroupSafetyCheckEnabledEvent({groupJid:a.id.toJid(),initiallyMuted:d("WAWebMuteGetters").getIsMuted(a.mute)});k(a,e,c)}function b(a,b){a=d("WAWebStateUtils").unproxy(a);var c=a.groupMetadata;if(c){c=c.groupSafetyCheck;if(c===!0){c=!b;k(a,c,!c)}}}function e(a){d("WAWebModalManager").ModalManager.open(i.jsx(d("WAWebGroupSafetyCheckModalLoadable").GroupSafetyCheckModalLoadable,{chat:a}),{transition:"modal-flow"})}function f(a){var b=d("WAWebFrontendMsgGetters").getChat(a);return d("WAWebNotificationHelpers").isMeUserMentionedOrQuoted(a)&&l(b)}function k(a,b,c){if(!d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled())return;b?d("WAWebCmd").Cmd.muteChat(a,b,!1,!1):c&&d("WAWebCmd").Cmd.muteChat(a,!1,!1,!1)}function l(a){return j(a)&&!a.isTrusted()&&d("WAWebGroupSafetyCheckGatingUtils").groupSafetyCheckM2Enabled()}g.isGroupSafetyChecked=j;g.handleGroupSafetyCheckStateUpdate=a;g.handleIsTrustedChangeForGroupSafety=b;g.openGroupSafetyCheckModal=e;g.shouldMuteMentionWhileGroupSafetyChecked=f;g.shouldShowGroupSafetyCheckUI=l}),98);
__d("WAWebIndividualNewChatMessageCappingLimitGatingUtils",["WALogger","WAWebABProps","WAWebSubscriptionCollection"],(function(a,b,c,d,e,f,g){var h;function i(){return d("WAWebABProps").getABPropConfigValue("wa_individual_new_chat_msg_capping_limit")}function j(){return d("WAWebABProps").getABPropConfigValue("wa_individual_new_chat_msg_latest_rampup_date")}function a(){var a=d("WAWebSubscriptionCollection").SubscriptionCollection.at(0);d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Subscription creation date: "," "])),a==null?void 0:a.creationTime);return(a==null?void 0:a.creationTime)!=null&&a.creationTime<j()?!1:i()>0}g.isIndividualNewChatMessageCappingEnabled=a}),98);
__d("WAWebIndividualNewChatMessageCappingLimitUtils",["WATimeUtils","WAWebContactGetters","WAWebIndividualNewChatMessageCappingLimitGatingUtils","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h="WANewChatMessageCappingData";function a(){if(!d("WAWebIndividualNewChatMessageCappingLimitGatingUtils").isIndividualNewChatMessageCappingEnabled())return!1;var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(h);if(a==null)return!1;var b=d("WATimeUtils").unixTime();b=b>a.cycle_end_timestamp;if(b){void l(d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE);return!1}return a.capping_status===d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.CAPPED}function c(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(h);a=typeof (a==null?void 0:a.capping_status)==="string"?d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.cast(a.capping_status):null;return a!=null?a:d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE}function e(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(h)}function f(a){var b=a.chat;a=a.contact;if(!d("WAWebContactGetters").getIsUser(a))return!0;if(d("WAWebContactGetters").getIsMe(a))return!0;if(d("WAWebContactGetters").getIsEnterprise(a))return!0;if(d("WAWebContactGetters").getIsSupportAccount(a))return!0;if(a.id.isBot())return!0;if(d("WAWebContactGetters").getIsHosted(a))return!0;if(d("WAWebContactGetters").getIsBroadcast(a))return!0;return d("WAWebContactGetters").getIsPSA(a)?!0:(b==null?void 0:b.getTcToken())!=null}function i(a){return(a=d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.cast(a))!=null?a:d("WAWebUserPrefsTypes").NewChatMessageCappingStatusType.NONE}function j(a){return(a=d("WAWebUserPrefsTypes").NewChatMessageCappingOTEStatusType.cast(a))!=null?a:d("WAWebUserPrefsTypes").NewChatMessageCappingOTEStatusType.ELIGIBLE}function k(a){return(a=d("WAWebUserPrefsTypes").NewChatMessageCappingMVStatusType.cast(a))!=null?a:d("WAWebUserPrefsTypes").NewChatMessageCappingMVStatusType.NOT_ACTIVE}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(h);if(b==null)return;yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(h,babelHelpers["extends"]({},b,{capping_status:a}))});return m.apply(this,arguments)}g.NEW_CHAT_MESSAGE_CAPPING_IDB_KEY=h;g.isUserCapped=a;g.getCappingStatus=c;g.getCappingData=e;g.canSendMsgWhileCapped=f;g.getCappingStatusType=i;g.getCappingOTEStatusType=j;g.getCappingMVStatusType=k;g.resetCappingStatus=l}),98);
__d("WAWebWamEnumCtwaLabelType",[],(function(a,b,c,d,e,f){a=Object.freeze({NEW_ORDER:0,PENDING_PAYMENT:1,PAID:2,ORDER_COMPLETE:3,NEW_CUSTOMER:4,DELIVERED:5,LEAD:6,FOLLOW_UP:7,APPOINTMENT:8,IMPORTANT:9,DO_NEW_ORDER:10,DO_LEAD:11});f.CTWA_LABEL_TYPE=a}),66);
__d("WAWebLabelConstants",["WAWebCTWAConstants","WAWebWamEnumCtwaLabelType"],(function(a,b,c,d,e,f,g){a=["#FF9485","#64C4FF","#FFD429","#DFAEF0","#99B6C1","#55CCB3","#FF9DFF","#D3A91D","#6D7CCE","#D7E752","#00D0E2","#FFC5C7","#93CEAC","#F74848","#00A0F2","#83E422","#FFAF04","#B5EBFF","#9BA6FF","#9368CF"];b=["#A62C71","#90A841","#C1A03F","#792138","#AE8774","#F0B330","#B6B327","#C69FCC","#8B6990","#FF8A8C","#54C265","#FF7B6B","#26C4DC","#57C9FF","#74676A","#7E90A3","#5696FF","#6E257E","#7ACBA5","#243640"];var h=Object.freeze({NEW_CUSTOMER:1,NEW_ORDER:2,PENDING_PAYMENT:3,PAID:4,ORDER_COMPLETE:5,IMPORTANT:6,FOLLOW_UP:7,LEAD:8}),i=Object.freeze({NEW_CUSTOMER:"New customer",NEW_ORDER:"New order",PENDING_PAYMENT:"Pending payment",PAID:"Paid",ORDER_COMPLETE:"Order complete",IMPORTANT:"Important",FOLLOW_UP:"Follow up",LEAD:"Lead"}),j=Object.freeze({NEW_CUSTOMER:"new_customer",NEW_ORDER:"new_order",PENDING_PAYMENT:"pending_payment",PAID:"paid",ORDER_COMPLETE:"order_complete",IMPORTANT:"important",FOLLOW_UP:"follow_up",LEAD:"lead"});c=function(a){switch(a){case i.NEW_CUSTOMER:return h.NEW_CUSTOMER;case i.NEW_ORDER:return h.NEW_ORDER;case i.PENDING_PAYMENT:return h.PENDING_PAYMENT;case i.PAID:return h.PAID;case i.ORDER_COMPLETE:return h.ORDER_COMPLETE;case i.IMPORTANT:return h.IMPORTANT;case i.FOLLOW_UP:return h.FOLLOW_UP;case i.LEAD:return h.LEAD;default:return void 0}};e=function(a){switch(a){case j.NEW_CUSTOMER:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.NEW_CUSTOMER;case j.NEW_ORDER:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.NEW_ORDER;case j.PENDING_PAYMENT:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.PENDING_PAYMENT;case j.PAID:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.PAID;case j.ORDER_COMPLETE:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.ORDER_COMPLETE;case j.IMPORTANT:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.IMPORTANT;case j.FOLLOW_UP:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.FOLLOW_UP;default:return d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.LEAD}};f=function(a){switch(a){case h.NEW_CUSTOMER:return i.NEW_CUSTOMER;case h.NEW_ORDER:case d("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID:return i.NEW_ORDER;case h.PENDING_PAYMENT:return i.PENDING_PAYMENT;case h.PAID:return i.PAID;case h.ORDER_COMPLETE:return i.ORDER_COMPLETE;case h.IMPORTANT:return i.IMPORTANT;case h.FOLLOW_UP:return i.FOLLOW_UP;case h.LEAD:case d("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID:return i.LEAD;default:return void 0}};var k=100,l=72;g.ANDROID_LABEL_COLOR_PALETTE=a;g.IPHONE_LABEL_COLOR_PALETTE=b;g.PREDEFINED_LABEL_IDS=h;g.PREDEFINED_LABEL_NAMES=i;g.mapLabelNameToPredefinedId=c;g.mapCustomLabelSubtypeToCTWALabelType=e;g.mapPredefinedIdToLabelName=f;g.LABEL_NAME_MAX_LENGTH=k;g.LISTS_ROW_HEIGHT=l}),98);
__d("WAWebListUtils",["fbt","WAWebBizGatingUtils","WAWebConnModel","WAWebLabelCollection","WAWebLabelConstants","WAWebMobilePlatforms","WAWebSchemaLabel"],(function(a,b,c,d,e,f,g,h){var i=20,j=22;function k(){return d("WAWebConnModel").Conn.platform===d("WAWebMobilePlatforms").PLATFORMS.SMBI?d("WAWebLabelConstants").IPHONE_LABEL_COLOR_PALETTE:d("WAWebLabelConstants").ANDROID_LABEL_COLOR_PALETTE}function a(a){return k()[a]}var l=function(a,b){a=parseInt(a.id,10);b=parseInt(b.id,10);return Number.isNaN(a)||Number.isNaN(b)?0:a-b},m=function(a){a.sort(l)};f=function(a){if(!d("WAWebBizGatingUtils").isLabelReorderingSyncFromPrimaryEnabled()){m(a);return}a.sort(function(a,b){var c=a.orderIndex-b.orderIndex;return c===0?l(a,b):c})};var n=new Set([d("WAWebSchemaLabel").ListType.UNREAD,d("WAWebSchemaLabel").ListType.GROUPS,d("WAWebSchemaLabel").ListType.FAVORITES]);function b(a){return a==null?!1:n.has(a)}function o(){return d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&d("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().size>0?j:i}function c(a){if(d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var b=o();return a?h._(/*BTDS*/"You can't add more than {max_count} lists",[h._param("max_count",b)]):h._(/*BTDS*/"You can't add more than {max_count} labels",[h._param("max_count",b)])}return a?h._(/*BTDS*/"You can't add more than 20 lists"):h._(/*BTDS*/"You can't add more than 20 labels")}function e(a){var b=h._(/*BTDS*/"You\u2019ve created the maximum number of lists.");if(d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var c=o();return a?b:h._(/*BTDS*/"You can't add more than {max_count} labels",[h._param("max_count",c)])}return a?b:h._(/*BTDS*/"You can't add more than 20 labels")}g.getAllLabelColors=k;g.colorIndexToHex=a;g.sortLabels=f;g.isBuiltInList=b;g.getMaxLabelCount=o;g.getReachMaxLabelCountTextForBizLabelDrawer=c;g.getReachMaxLabelCountText=e}),226);
__d("WAWebLabelGetters",["WAWebGetters","WAWebGettersCaches","WAWebListUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createLabelsCache});b=a.field;c=a.computed;e=b("colorIndex");f=b("color");a=c(function(a){a[0];a=a[1];if(a==null)return;return d("WAWebListUtils").colorIndexToHex(a)},[f,e]);g.getHexColor=a}),98);
__d("WAWebIcLabelFilledIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="ic-label-filled";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"m20.175 13.15-3.525 5a1.9 1.9 0 0 1-.712.625A2 2 0 0 1 15 19H5q-.824 0-1.412-.587A1.93 1.93 0 0 1 3 17V7q0-.824.587-1.412A1.93 1.93 0 0 1 5 5h10q.5 0 .938.225t.712.625l3.525 5q.375.525.375 1.15t-.375 1.15",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.IcLabelFilledIcon=a}),98);
__d("WAWebLabelFilledIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="label-filled";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M15.393 5C16.314 5 17.167 5.447 17.685 6.182L21.812 12L21.346 12.657L17.686 17.816C17.166 18.553 16.314 19 15.393 19L5.81 18.992C4.262 18.992 3 17.738 3 16.19V7.81C3 6.261 4.262 5.008 5.809 5.008L15.393 5Z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LabelFilledIcon=a}),98);
__d("WAWebLabelStackIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="label-stack";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"currentColor",d:"M6.4 4.01c.03-.22.09-.41.17-.57a2.26 2.26 0 0 1 1.85-1.23c.33-.03.87-.04 1.63-.04h5.36l1.2.01a3.14 3.14 0 0 1 2.23 1.1l.74.93 2.05 2.68c.2.26.36.46.45.6a1.23 1.23 0 0 1 .23.76c0 .13-.01.25-.04.36-.04.12-.1.25-.19.39l-.45.61-.2.27a9 9 0 0 0-.41-.56l-.09-.1-2.13-2.78a24 24 0 0 0-.77-.96 4.47 4.47 0 0 0-3.05-1.5c-.3-.02-.7-.03-1.21-.03H8.19c-.77 0-1.3.01-1.61.04l-.19.02Z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LabelStackIcon=a}),98);
__d("useWAWebForceUpdate",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useReducer;function a(){var a=i(function(a){return a+1},0);a[0];a=a[1];return a}g.useForceUpdateDONOTUSE=a}),98);
__d("WAWebLabels.react",["WAWebABProps","WAWebBizGatingUtils","WAWebEmojiText.react","WAWebIcLabelFilledIcon.react","WAWebLabelCollection","WAWebLabelFilledIcon.react","WAWebLabelGetters","WAWebLabelStackIcon.react","WAWebListsGatingUtils","WAWebUISpacing","WDSText.react","react","stylex","useWAWebForceUpdate","useWAWebListener"],(function(a,b,c,d,e,f,g){var h,i,j,k=j||c("react"),l=(h||(h=d("react"))).useMemo,m={container:{display:"x1rg5ohu",flexShrink:"x2lah0s",verticalAlign:"x16dsc37",$$css:!0},name:{flexShrink:"x2lah0s",fontSize:"x1f6kntn",lineHeight:"xggjnk3",color:"x14ug900",$$css:!0},labelFilter:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},labelFilterIconContainer:{display:"x78zum5",flexShrink:"x2lah0s",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"xvy4d1p",height:"xxk0z11",$$css:!0},labelFilterPillIconContainer:{width:"xw4jnvo",height:"x1qx5ct2",$$css:!0},labelFilterName:{flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",flexBasis:"xdl72j9",overflowX:"x6ikm8r",overflowY:"x10wlt62",lineHeight:"x1o2sk6j",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},labelFilterPillName:{color:"xk4n5i7",lineHeight:"x1fc57z9",maxWidth:"x18tx2qf",$$css:!0},drawerTitle:{maxWidth:"x193iq5w",$$css:!0},drawerTitleIconContainer:{flexShrink:"x2lah0s",$$css:!0},drawerTitleName:{flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",flexBasis:"xdl72j9",overflowX:"x6ikm8r",overflowY:"x10wlt62",fontSize:"x1jchvi3",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},containerFull:{display:"x3nfvp2",alignItems:"x6s0dn4",$$css:!0},containerFullCircleIcon:{display:"x1rg5ohu",flexShrink:"x2lah0s",marginTop:"x1y332i5",color:"xhslqc4",$$css:!0},circleIconContainer:{display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"x100vrsf",height:"x1vqgdyp",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},circleIcon:{color:"x17t9dm2",$$css:!0},circleIconSVG:{width:"xw4jnvo",height:"x1qx5ct2",$$css:!0},elipsifyName:{overflowX:"x6ikm8r",overflowY:"x10wlt62",whiteSpace:"xuxw1ft",textOverflow:"xlyipyv",maxWidth:"xw5ewwj",$$css:!0},labelStackIcon:{position:"x10l6tqk",top:"xxk6nc9",$$css:!0},nameWdsChip:{marginInlineStart:"x150mmf0",$$css:!0}};function n(a){if(a.length===0)return;var b=Math.max.apply(Math,a.map(function(a){return parseInt(a,10)}));return Number.isNaN(b)?a[0]:b.toString()}function o(a){a=n(a);return a==null?null:d("WAWebLabelCollection").LabelCollection.get(a)}function p(a){var b=a.color,e=a.name,f=a.renderAsCircle;f=f===void 0?!1:f;var g=a.theme,h=a.iconXstyle;if(d("WAWebABProps").getABPropConfigValue("wds_web_chip")&&g==="label-pill")return k.jsxs("div",{className:"x2lah0s x16dsc37 x3nfvp2 x6s0dn4",children:[k.jsx("span",{className:"x78zum5 x2lah0s x6s0dn4 xl56j7k xw4jnvo x1qx5ct2",children:k.jsx(d("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:b!=null?{color:b}:{},iconXstyle:h,xstyle:e!=null&&m.containerFullCircleIcon})}),k.jsx(c("WDSText.react"),{type:"Body2Emphasized",colorName:"accentEmphasized",xstyle:m.nameWdsChip,children:e})]});a=e!=null?k.jsx("span",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(m.name,d("WAWebUISpacing").uiMargin.start3,(a.theme==="label-filter"||a.theme==="label-pill")&&m.labelFilterName,a.theme==="label-pill"&&m.labelFilterPillName,(a.theme==="label-filter"||a.theme==="label-pill")&&d("WAWebUISpacing").uiMargin.start8,a.theme==="drawer-title"&&m.drawerTitleName,a.theme==="drawer-title"&&d("WAWebUISpacing").uiMargin.start0,a.theme==="user-profile"&&m.elipsifyName),{children:k.jsx(d("WAWebEmojiText.react").EmojiText,{text:e})})):null;var j=(i||(i=c("stylex")))(e==null&&!f&&m.container,f&&m.containerFull,e!=null&&!f&&m.containerFull,g==="label-filter"&&m.labelFilter,g==="drawer-title"&&m.drawerTitle),l=f&&b!=null?{backgroundColor:b}:{};b=f?k.jsx(d("WAWebLabelFilledIcon.react").LabelFilledIcon,{xstyle:m.circleIcon,iconXstyle:m.circleIconSVG}):k.jsx(d("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:b!=null?{color:b}:{},iconXstyle:h,xstyle:e!=null&&m.containerFullCircleIcon});return k.jsxs("div",{className:j,children:[k.jsx("div",{"data-testid":void 0,className:i(f&&m.circleIconContainer,g==="drawer-title"&&m.drawerTitleIconContainer,g==="drawer-title"&&d("WAWebUISpacing").uiMargin.end20,g==="drawer-title"&&d("WAWebUISpacing").uiMargin.start4,(g==="label-filter"||g==="label-pill")&&m.labelFilterIconContainer,g==="label-pill"&&m.labelFilterPillIconContainer),style:l,children:b}),a]})}p.displayName=p.name+" [from "+f.id+"]";function a(a){var b=a.labels,c=a.showName;c=c===void 0?!1:c;var e=a.renderAsCircle;e=e===void 0?!1:e;var f=a.theme;a=a.iconXstyle;var g=d("useWAWebForceUpdate").useForceUpdateDONOTUSE(),h=l(function(){return n(b)},[b]);d("useWAWebListener").useListener(h!=null?d("WAWebLabelCollection").LabelCollection:null,"label_updated_"+(h!=null?h:""),g);if(!d("WAWebBizGatingUtils").canDisplayLabel()&&!d("WAWebListsGatingUtils").isListsEnabled())return null;h=o(b);if(!h||!h.name)return null;if(b.length===1){g=d("WAWebLabelGetters").getHexColor(h);c=c?h.name:null;return k.jsx(p,{color:g,name:c,renderAsCircle:e,theme:f,iconXstyle:a})}g=d("WAWebLabelGetters").getHexColor(h);return k.jsxs("div",{className:"x1rg5ohu x2lah0s x16dsc37 x1n2onr6 xvy4d1p xxk0z11","data-testid":void 0,children:[k.jsx(d("WAWebIcLabelFilledIcon.react").IcLabelFilledIcon,{width:18,height:18,style:g!=null?{color:g}:{},iconXstyle:a,xstyle:m.labelStackIcon}),k.jsx(d("WAWebLabelStackIcon.react").LabelStackIcon,{width:18,height:18,iconXstyle:a,xstyle:m.labelStackIcon})]})}a.displayName=a.name+" [from "+f.id+"]";g.getVisibleLabelId=n;g.Label=p;g.Labels=a}),98);
__d("WAWebListItemParentType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Chat","Contact","Msg"]);f.LabelItemParentType=a}),66);
__d("WAWebBizLabelUtils",["WALogger","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebChatCollection","WAWebChatModel","WAWebContactCollection","WAWebContactModel","WAWebLabelCollection","WAWebListItemParentType","WAWebMsgCollection","WAWebMsgModel","err"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=i(a);a.labels=d("WAWebLabelCollection").LabelCollection.getLabelsForModel(a.id.toString(),b)}function b(a,b,c){b&&b.length>0&&b.forEach(function(b){if(d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&!d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()&&d("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().has(b))return;b=b;var e=null;if(d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()&&d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()&&d("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().has(b)){e=d("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().get(b);var f=k(e);if(f==null)return;b=f}f=d("WAWebLabelCollection").LabelCollection.gadd({id:b});f.labelItemCollection.gadd({id:j(a,b,c),labelId:b,parentId:a,parentType:c,detectedOutcomeOriginalLabelPredefinedId:e});c===d("WAWebListItemParentType").LabelItemParentType.Chat&&f.labelItemCollection.gadd({id:j(a,b,d("WAWebListItemParentType").LabelItemParentType.Contact),labelId:b,parentId:a,parentType:d("WAWebListItemParentType").LabelItemParentType.Contact})})}function e(a,b,c){var e=d("WAWebLabelCollection").LabelCollection.get(b);e=e==null?void 0:e.labelItemCollection;if(!e){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["labelItemCollection does not exist for lableId ",""])),b);return}e.remove(j(a,b,c));c===d("WAWebListItemParentType").LabelItemParentType.Chat&&e.remove(j(a,b,d("WAWebListItemParentType").LabelItemParentType.Contact))}function f(a){switch(a){case d("WAWebListItemParentType").LabelItemParentType.Chat:return d("WAWebChatCollection").ChatCollection;case d("WAWebListItemParentType").LabelItemParentType.Contact:return d("WAWebContactCollection").ContactCollection;case d("WAWebListItemParentType").LabelItemParentType.Msg:return d("WAWebMsgCollection").MsgCollection}}function i(a){if(a instanceof d("WAWebChatModel").Chat)return d("WAWebListItemParentType").LabelItemParentType.Chat;else if(a instanceof c("WAWebContactModel"))return d("WAWebListItemParentType").LabelItemParentType.Contact;else if(a instanceof d("WAWebMsgModel").Msg)return d("WAWebListItemParentType").LabelItemParentType.Msg;throw c("err")("getParentTypeFromModel: model is invalid")}function j(a,b,c){return a+"_"+b+"_"+c}function k(a){if(a==null)return null;var b=null;switch(a){case d("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID:b=d("WAWebCTWAConstants").NEW_ORDER_PREDEFINED_ID;break;case d("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID:b=d("WAWebCTWAConstants").LEAD_PREDEFINED_ID;break;default:return null}a=d("WAWebLabelCollection").LabelCollection.findFirst(function(a){return a.predefinedId===b});return a!=null?a.id:null}function l(a){a=(a=d("WAWebLabelCollection").LabelCollection.get(a))==null?void 0:a.predefinedId;var b=null;switch(a){case d("WAWebCTWAConstants").NEW_ORDER_PREDEFINED_ID:b=d("WAWebCTWAConstants").DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID;break;case d("WAWebCTWAConstants").LEAD_PREDEFINED_ID:b=d("WAWebCTWAConstants").DETECTED_OUTCOME_LEAD_PREDEFINED_ID;break;default:b=null}a=d("WAWebLabelCollection").LabelCollection.getServerAssignedLabelIdMap().entries().find(function(a){a[0];a=a[1];return a===b});return b==null||a==null?null:a[0]}g.initializeLabels=a;g.addToLabelCollection=b;g.removeLabelFromCollection=e;g.getParentCollection=f;g.getParentTypeFromModel=i;g.createLabelItemId=j;g.mapDOLabelPredefinedIdToManualLabelId=k;g.mapManualLabelIdToDetectedOutcomeLabelId=l}),98);
__d("WAWebLabelCollection",["fbt","$InternalEnum","WALogger","WAWebActionToast.react","WAWebAddToFavoritesAction","WAWebBaseCollection","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebChatCollection","WAWebEditLabelAssociationBridge","WAWebLabelModel","WAWebListItemParentType","WAWebListUtils","WAWebListsGatingUtils","WAWebMsgModel","WAWebNoop","WAWebRemoveFromFavoritesAction","WAWebSchemaLabel","WAWebSchemaLabelAssociation","WAWebToastManager","WAWebWid","lodash","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=["id"],l,m=l||c("react"),n=b("$InternalEnum").Mirrored(["IN_PROGRESS","SUCCESS","ERROR"]);function o(a,b){if(b)switch(a){case n.IN_PROGRESS:return h._(/*BTDS*/"Adding to list");case n.SUCCESS:return h._(/*BTDS*/"Added to list");case n.ERROR:return h._(/*BTDS*/"Could not be added to list")}else switch(a){case n.IN_PROGRESS:return h._(/*BTDS*/"Updating list");case n.SUCCESS:return h._(/*BTDS*/"List updated");case n.ERROR:return h._(/*BTDS*/"List could not be updated")}}a=function(a){function b(){var b;b=a.call(this)||this;b.$LabelCollectionImpl$p_1=new Map();b.listenTo(b,"remove",p);return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initializeFromCache=function(b){var c=this;if(d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS1Enabled()){var e=b.filter(function(a){var b=a.type===d("WAWebSchemaLabel").ListType.SERVER_ASSIGNED;b&&c.addToServerAssignedLabelIdMap(a.id,a.predefinedId);return!b});e=e.map(function(a){var b=a.id;a=babelHelpers.objectWithoutPropertiesLoose(a,k);return babelHelpers["extends"]({id:b},a)});this.add(e)}else a.prototype.initializeFromCache.call(this,b)};e.initializeAssociationsFromCache=function(a){a.forEach(function(a){var b=a.labelId,c=a.associationId;a=a.type;d("WAWebBizLabelUtils").addToLabelCollection(c,[b],a===d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid?d("WAWebListItemParentType").LabelItemParentType.Chat:d("WAWebListItemParentType").LabelItemParentType.Msg)})};e.removeAllLabelsMD=function(a){return this.addOrRemoveLabelsMD((a.labels||[]).map(function(a){return{type:"remove",id:a}}),[a])};e.addOrRemoveLabelsMD=function(a,b){a.forEach(function(a){var e=a.id,f=a.listType,g=a.type;b.forEach(function(a){var b=d("WAWebBizLabelUtils").getParentTypeFromModel(a),h=a.id.toString();f===d("WAWebSchemaLabel").ListType.FAVORITES?a.id instanceof c("WAWebWid")&&(g==="add"?d("WAWebAddToFavoritesAction").addToFavoritesAction([a.id],{suppressToast:!0})["catch"](c("WAWebNoop")):d("WAWebRemoveFromFavoritesAction").removeFromFavoritesAction(a.id,{suppressToast:!0})["catch"](c("WAWebNoop"))):g==="add"?d("WAWebBizLabelUtils").addToLabelCollection(h,[e],b):d("WAWebBizLabelUtils").removeLabelFromCollection(h,e,b)})})};e.addOrRemoveLabels=function(a,b){var c=this;if(a.length===0||b.length===0)return;var e=d("WAWebListsGatingUtils").isListsEnabled(),f=e&&b.some(function(a){var b;return((b=(b=a.labels)==null?void 0:b.length)!=null?b:0)>0||!(a instanceof d("WAWebMsgModel").Msg)&&a.isFavorite}),g=d("WAWebActionToast.react").genId(),j=new(d("WAWebActionToast.react").ActionType)(e?o(n.IN_PROGRESS,!f):h._(/*BTDS*/"_j{\"*\":\"Changing {count} labels\",\"_1\":\"Changing {count} label\"}",[h._plural(a.length),h._param("count",a.length)])),k=d("WAWebEditLabelAssociationBridge").editLabelAssociation(this.$LabelCollectionImpl$p_2(a),b).then(function(){c.addOrRemoveLabelsMD(a,b)}).then(function(){return new(d("WAWebActionToast.react").ActionType)(e?o(n.SUCCESS,!f):h._(/*BTDS*/"_j{\"*\":\"{count} labels changed\",\"_1\":\"1 label changed\"}",[h._plural(a.length,"count")]))})["catch"](function(b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["addingNewLabel dropped"]))).devConsole(b);return new(d("WAWebActionToast.react").ActionType)(e?o(n.ERROR,!f):h._(/*BTDS*/"_j{\"*\":\"Some labels could not be updated\",\"_1\":\"The label could not be updated\"}",[h._plural(a.length)]))});d("WAWebToastManager").ToastManager.open(m.jsx(d("WAWebActionToast.react").ActionToast,{id:g,initialAction:j,pendingAction:k}))};e.$LabelCollectionImpl$p_2=function(a){return!d("WAWebBizGatingUtils").isCTWADetectedOutcomeWS4Enabled()?a:a.map(function(a){if(a.type==="remove"){var b=d("WAWebBizLabelUtils").mapManualLabelIdToDetectedOutcomeLabelId(a.id);if(b!=null)return[babelHelpers["extends"]({},a,{listType:d("WAWebSchemaLabel").ListType.SERVER_ASSIGNED,id:b}),a]}return a}).flat(1)};e.getLabelsForModel=function(a,b){return this.filter(function(c){return c.labelItemCollection.get(d("WAWebBizLabelUtils").createLabelItemId(a,c.id,b))}).map(function(a){return a.id})};e.getNextAvailableColor=function(){var a=d("WAWebListUtils").getAllLabelColors(),b=this.map(function(a){return a.colorIndex}).sort(function(a,b){return Number(a)-Number(b)});if(b.length===0)return 0;b=b.findIndex(function(a,b){return a!==b});return b>=0?b:Math.floor(Math.random()*a.length)};e.getChatLabelsWithUnarchivedAssociations=function(){return this.filter(function(a){return a.count===0?!1:a.labelItemCollection.some(function(a){switch(a.parentType){case d("WAWebListItemParentType").LabelItemParentType.Chat:a=d("WAWebChatCollection").ChatCollection.get(a.parentId);return a==null||a.archive===!0||a.isLocked===!0?!1:!0;case d("WAWebListItemParentType").LabelItemParentType.Contact:case d("WAWebListItemParentType").LabelItemParentType.Msg:return!1}})})};e.getActiveLists=function(){return this.filter(function(a){return a.isActive!==!1})};e.getChatLists=function(){return this.filter(function(a){return a.labelItemCollection.length===0?!0:a.labelItemCollection.some(function(a){switch(a.parentType){case d("WAWebListItemParentType").LabelItemParentType.Chat:a=d("WAWebChatCollection").ChatCollection.get(a.parentId);return a==null?!1:a.isLocked===!0?!1:!0;case d("WAWebListItemParentType").LabelItemParentType.Contact:case d("WAWebListItemParentType").LabelItemParentType.Msg:return!1}})})};e.getServerAssignedLabelIdMap=function(){return this.$LabelCollectionImpl$p_1};e.addToServerAssignedLabelIdMap=function(a,b){b!=null&&!this.$LabelCollectionImpl$p_1.has(a)?this.$LabelCollectionImpl$p_1.set(a,b):b==null&&d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["label sync: malformed mutation, unexpected null predefinedId"])))};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebLabelModel").Label;a.staleCollection=!0;function p(a){a=a.labelItemCollection;a.toArray().forEach(function(a){var b=a.parentId,e=a.parentType,f=a.labelId;a=d("WAWebBizLabelUtils").getParentCollection(e).get(b);a&&(a.labels=c("lodash").remove(a.labels,function(a){return a!==f}))})}e=new a();g.LabelCollection=e}),226);
__d("WAWebLabelItemModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.parentType=d("WAWebBaseModel").prop(),b.parentId=d("WAWebBaseModel").prop(),b.labelId=d("WAWebBaseModel").prop(),b.detectedOutcomeOriginalLabelPredefinedId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="labelItem";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebLabelItemCollection",["WAWebBaseCollection","WAWebBizLabelUtils","WAWebLabelItemModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.listenTo(b,"add",h);b.listenTo(b,"remove",i);return b}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebLabelItemModel");function h(a){j(a,!0)}function i(a){j(a,!1)}function j(a,b){var c=d("WAWebBizLabelUtils").getParentCollection(a.parentType).get(a.parentId);if(!c)return;var e=c.labels||[];b?e.includes(a.labelId)||(c.labels=[a.labelId].concat(e)):c.labels=e.filter(function(b){return b!==a.labelId})}g.LabelItemCollection=a}),98);
__d("WAWebLabelModel",["Promise","WAWebBaseModel","WAWebLabelCollection","WAWebLabelItemCollection","WAWebListItemParentType"],(function(a,b,c,d,e,f,g){var h;a=function(a){function c(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.colorIndex=d("WAWebBaseModel").prop(),b.color=d("WAWebBaseModel").prop(),b.count=d("WAWebBaseModel").prop(0),b.messageCount=d("WAWebBaseModel").prop(0),b.chatCount=d("WAWebBaseModel").prop(0),b.orderIndex=d("WAWebBaseModel").prop(),b.predefinedId=d("WAWebBaseModel").prop(),b.isActive=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(),b.isImmutable=d("WAWebBaseModel").prop(),b.stale=d("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.initialize=function(){a.prototype.initialize.call(this),this.labelItemCollection=new(d("WAWebLabelItemCollection").LabelItemCollection)(),this.$LabelImpl$p_1(),this.listenTo(this,"change:name",this.$LabelImpl$p_1),this.listenTo(this,"change:color",this.$LabelImpl$p_1),this.listenTo(this,"change:colorIndex",this.$LabelImpl$p_1),this.listenTo(this,"change:count",this.$LabelImpl$p_1),this.listenTo(this.labelItemCollection,"add",this.$LabelImpl$p_2),this.listenTo(this.labelItemCollection,"remove",this.$LabelImpl$p_2),this.orderIndex==null&&(this.orderIndex=Number(this.id))};e.findImpl=function(a){return(h||(h=b("Promise"))).resolve({id:a})};e.$LabelImpl$p_1=function(){if(!this.name)return;d("WAWebLabelCollection").LabelCollection.trigger("label_updated_"+this.id)};e.$LabelImpl$p_2=function(){var a=this.labelItemCollection.reduce(function(a,b){switch(b.parentType){case d("WAWebListItemParentType").LabelItemParentType.Chat:a[0]++;return a;case d("WAWebListItemParentType").LabelItemParentType.Msg:a[1]++;return a;default:b.parentType;return a}},[0,0]),b=a[0];a=a[1];this.messageCount=a;this.chatCount=b;this.count=b+a};return c}(d("WAWebBaseModel").BaseModel);a.Proxy="label";c=d("WAWebBaseModel").defineModel(a);g.Label=c}),98);
__d("WAWebMemberLabelUtils",[],(function(a,b,c,d,e,f){var g=3e3;function a(){return g}f.getBatchDelayMs=a}),66);
__d("WAWebMemberLabelBulkJob",["Promise","WABatcher","WALogger","WAWebMemberLabelUtils","WAWebSchemaMemberLabel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){return new Map(a)}function l(a,b,c){a=a.memberLabelMap.get(b);return a!=null&&a.lastEditTimestamp>c.lastEditTimestamp}function m(a){var b=a.chatId,c=a.member,d=a.memberLabel;a=a.prevRecord;if(!a)return{chatId:b,memberLabelMap:new Map([[c,d]])};b=k(a.memberLabelMap);if(l(a,c,d))return a;b.set(c,d);return babelHelpers["extends"]({},a,{memberLabelMap:b})}function n(a){var b=a.prevRecord;a=a.member;var c=k(b.memberLabelMap);c["delete"](a);return babelHelpers["extends"]({},b,{memberLabelMap:c})}a=function(){return d("WABatcher").batch({delayMs:d("WAWebMemberLabelUtils").getBatchDelayMs()},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=Array.from(new Set(a.map(function(a){return a.data.chatId}))),e=d("WAWebSchemaMemberLabel").getMemberLabelTable();c=new Map((yield e.bulkGet(c)).filter(Boolean).map(function(a){return[a.chatId,a]}));var f=[];for(a of a){var g=a.type,k=a.data,l=k.chatId,o=k.member;k=k.memberLabel;var p=c.get(l),q=null,r=!1;switch(g){case"UPSERT":if(k==null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsBatched]: memberLabel is null for upsert operation"])));f.push(null);continue}q=m({chatId:l,member:o,memberLabel:k,prevRecord:p});r=!0;break;case"DELETE":if(!p){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsBatched]: no record found for chat ",""])),l);f.push(null);continue}q=n({prevRecord:p,member:o});r=!0;break}q!=null&&c.set(q.chatId,q);f.push(r?a:null)}g=Array.from(c.values());k=[];l=[];for(p of g)p.memberLabelMap.size===0?k.push(p):l.push(p);yield (j||(j=b("Promise"))).all([e.bulkRemove(k.map(function(a){return a.chatId})),e.bulkCreateOrReplace(l)]);return f});return function(b){return a.apply(this,arguments)}}())}();g.updateMemberLabelsBatched=a}),98);
__d("WAWebMemberLabelHistorySync",["Promise","WALogger","WATimeUtils","WAWebBackendApi","WAWebLidMigrationUtils","WAWebMemberLabel.flow","WAWebMemberLabelBridgeApi","WAWebMemberLabelBulkJob","WAWebMemberLabelGating","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMemberLabelGating").isMemberLabelInfraEnabled())return;var c=[];a=a.conversations.filter(function(a){var b=d("WAWebWidFactory").createWid(a.id);return!b.isGroup()?!1:a.participant.length>0}).flatMap(function(b){var c=d("WAWebWidFactory").createWid(b.id),a=d("WAWebWidToJid").widToGroupJid(c);return b.participant.map(function(b){var c;if(b.memberLabel==null)return null;var e=d("WAWebWidFactory").createWid(b.userJid);if(!e)return null;e=d("WAWebLidMigrationUtils").toUserLid(e);if(!e)return null;e=d("WAWebWidToJid").userLidtoLidUserJid(e);b=b.memberLabel;c=d("WAWebMemberLabel.flow").castToMemberLabeString(String((c=b==null?void 0:b.label)!=null?c:""));b=d("WATimeUtils").castToUnixTime(Number(b==null?void 0:b.labelTimestamp));return{chatId:a,member:e,label:c,lastEditTimestamp:b}}).filter(Boolean)});for(a of a){var e=a.chatId,f=a.member,g=a.label,k=a.lastEditTimestamp;c.push(d("WAWebMemberLabelBridgeApi").createUpsert(e,f,{label:g,lastEditTimestamp:k}))}if(c.length===0)return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing "," member label updates"])),c.length);e=(yield (j||(j=b("Promise"))).all(c.map(d("WAWebMemberLabelBulkJob").updateMemberLabelsBatched)));f=e.filter(Boolean);if(f.length===0)return;d("WAWebBackendApi").frontendFireAndForget("updateMemberLabelCollection",{updates:f});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] successfully processed "," member label updates"])),f.length)});return k.apply(this,arguments)}g.processMemberLabels=a}),98);
__d("WAWebMemberLabelKey",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.chatId=a.chatId;this.member=a.member;a=[this.chatId,this.member];this.serialized=a.join("_")}var b=a.prototype;b.toString=function(){return this.serialized};b.equals=function(b){return b instanceof a&&this.toString()===b.toString()};return a}();f["default"]=a}),66);
__d("WAWebMemberLabelBridgeApi",["WALogger","WAWebMemberLabelCollection","WAWebMemberLabelKey"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return{type:"DELETE",data:{chatId:a,member:b}}}function b(a,b,c){return{type:"UPSERT",data:{chatId:a,member:b,memberLabel:c}}}e={updateMemberLabelCollection:function(a){a=a.updates;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsModel] processing "," updates"])),a.length);var b=[],e=[];a.forEach(function(a){var f=a.type;a=a.data;var g=a.chatId,h=a.member;a=a.memberLabel;g=new(c("WAWebMemberLabelKey"))({chatId:g,member:h});switch(f){case"UPSERT":if(a==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[updateMemberLabelsModel] memberLabel is null for upsert operation"])));return}b.push({id:g,label:a.label,lastEditTimestamp:a.lastEditTimestamp});break;case"DELETE":e.push(g);break}});b.length>0&&c("WAWebMemberLabelCollection").add(b,{merge:!0});e.length>0&&c("WAWebMemberLabelCollection").remove(e)}};g.createDelete=a;g.createUpsert=b;g.MemberLabelBridgeApi=e}),98);
__d("WAWebMemberLabelModel",["WAWebBaseModel","WAWebMemberLabelKey"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.label=d("WAWebBaseModel").prop(),b.lastEditTimestamp=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="memberLabel";a.idClass=c("WAWebMemberLabelKey");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebMemberLabelActions",["WAWebMemberLabelJob","WAWebMemberLabelKey","WAWebMemberLabelModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebMemberLabelJob").getMemberLabelsForGroups({chatId:a}));if(!b)return;return Array.from(b.entries()).map(function(b){var d=b[0];b=b[1];d=new(c("WAWebMemberLabelKey"))({chatId:a,member:d});var e=new(c("WAWebMemberLabelModel"))();e.id=d;e.label=b.label;e.lastEditTimestamp=b.lastEditTimestamp;return e})});return h.apply(this,arguments)}g.getMemberLabelsForGroupAction=a}),98);
__d("WAWebMemberLabelCollection",["WAExponentialBackoff","WALogger","WAWebBaseCollection","WAWebMemberLabelActions","WAWebMemberLabelModel","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.$MemberLabelCollection$p_1=new Map(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.$MemberLabelCollection$p_2=function(a,b){var c=this;a&&a.length>0&&a.filter(Boolean).forEach(function(a){c.trigger(a.id.toString(),b(a))})};f.add=function(b,c){b=a.prototype.add.call(this,b,c);this.$MemberLabelCollection$p_2(b,function(a){return a});return b};f.remove=function(b,c){c===void 0&&(c={});b=a.prototype.remove.call(this,b,c);this.$MemberLabelCollection$p_2(b,function(){return null});return b};f.initializeLabelsForChat=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this.$MemberLabelCollection$p_1.get(a);if(b!=null)return b;b=this.$MemberLabelCollection$p_3(a);this.$MemberLabelCollection$p_1.set(a,b);return b});function c(b){return a.apply(this,arguments)}return c}();f.$MemberLabelCollection$p_3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this;try{yield d("WAExponentialBackoff").exponentialBackoff({minTimeout:1e3,retries:3,signal:new AbortController().signal},function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,f){return d("WAWebMemberLabelActions").getMemberLabelsForGroupAction(a).then(function(a){a!=null&&e.add(a)})["catch"](function(e){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[MemberLabelCollection][initialize]: Attempt "," failed for group ",""])),f+1,a).devConsole(e);e=e instanceof Error?e:c("err")(String(e));return b(e)})});return function(a,b){return f.apply(this,arguments)}}())}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MemberLabelCollection][initialize]: All retries failed for group ",""])),a).devConsole(b),this.$MemberLabelCollection$p_1["delete"](a)}});function e(b){return a.apply(this,arguments)}return e}();return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebMemberLabelModel");e=new a();g["default"]=e}),98);
__d("WAWebMessageAssociationUIUtils",["WAWebFrontendMsgGetters","WAWebMessageAssociation.flow","WAWebMsgCollection","WAWebMsgType","WAWebPollCreationUtils","WAWebViewMode.flow","WAWebViewModeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([d("WAWebMsgType").MSG_TYPE.ALBUM,d("WAWebMsgType").MSG_TYPE.POLL_CREATION]);function a(a,b,c){return a==null?null:c&&h.has(b)?Math.min.apply(Math,[a].concat(c.map(function(a){a=a.ack;return a}))):a}function i(a,b){b===void 0&&(b=d("WAWebViewMode.flow").ViewModeSurface.CHAT);return j(d("WAWebMsgCollection").MsgCollection.byParentMessage(a),b)}function b(a,b){b===void 0&&(b=d("WAWebViewMode.flow").ViewModeSurface.CHAT);return d("WAWebMsgCollection").MsgCollection.byChat(a).filter(function(a){a=a.viewMode;return!d("WAWebViewModeUtils").isViewModeVisibleInSurface(b,a)})}function j(a,b){return a.filter(function(a){var c=a.associationType,e=a.parentMsgKey,f=a.viewMode;a=a.pendingDeleteForMe;return c!=null&&e!=null&&!a&&!d("WAWebViewModeUtils").isViewModeVisibleInSurface(b,f)})}function k(a){var b=a.parentMsgKey;a=a.duringDetach;a=a===void 0?!1:a;a=a?1:0;return i(b).length-a>0}function l(a){var b=a.parentMsg;a=a.duringDetach;a=a===void 0?!1:a;switch(b.type){case d("WAWebMsgType").MSG_TYPE.POLL_CREATION:var c=d("WAWebFrontendMsgGetters").getAsPollCreation(b);return c==null?!0:c.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE&&i(b.id).length!==c.pollOptions.length;case d("WAWebMsgType").MSG_TYPE.ALBUM:default:return!k({parentMsgKey:b.id,duringDetach:a})}}function c(a){var b=a.associationType;if(!b)return!0;a=a.parentMsgKey?d("WAWebMsgCollection").MsgCollection.get(a.parentMsgKey):null;switch(b){case d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL:return a!=null&&a.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&!l({parentMsg:a});default:return!0}}g.getLowestAckState=a;g.getHiddenAssociatedMessages=i;g.getHiddenViewModeMessagesForChat=b;g.filterOutVisibleAssociatedMessages=j;g.shouldHideParentMessage=l;g.shouldDisplayOrphanMessage=c}),98);
__d("WAWebGenerateProtocolMessageEditProto",["WAWebE2EProtoGenerator","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb","err","gkx"],(function(a,b,c,d,e,f,g){function a(a){var b,e=a.json;a=a.contextInfo;var f=Boolean(e.matchedText||e.description||e.title),g;b=(b=e.editMsgType)!=null?b:d("WAWebMsgType").MSG_TYPE.CHAT;switch(b){case d("WAWebMsgType").MSG_TYPE.CHAT:f=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CHAT,subtype:f?"url":void 0});g=d("WAWebE2EProtoGenerator").getProtobufMessage(f,void 0,a);break;case d("WAWebMsgType").MSG_TYPE.IMAGE:g={imageMessage:{caption:e.caption,contextInfo:a}};break;case d("WAWebMsgType").MSG_TYPE.VIDEO:g={videoMessage:{caption:e.caption,contextInfo:a}};break;case d("WAWebMsgType").MSG_TYPE.DOCUMENT:g={documentWithCaptionMessage:{message:{documentMessage:{caption:e.caption,contextInfo:a}}}};break;default:if(!c("gkx")("26258")&&b===d("WAWebMsgType").MSG_TYPE.AUDIO)g={audioMessage:{}};else throw c("err")("Unsupported edit msg type: "+b)}return{protocolMessage:{key:d("WAWebE2EProtoUtils").encodeKey(e.protocolMessageKey),type:d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT,timestampMs:e.latestEditSenderTimestampMs,editedMessage:g}}}g["default"]=a}),98);
__d("WAWebGetMyAddOnsRPC",["WASmaxNewslettersMyAddOnsRPC","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.count;a=a.newsletterJid;b=(yield d("WASmaxNewslettersMyAddOnsRPC").sendMyAddOnsRPC({myAddonsLimit:b,myAddonsJid:a}));switch(b.name){case"MyAddOnsResponseSuccess":return{messagesByNewsletter:b.value.myAddonsMessages};case"MyAddOnsResponseServerError":a=b.value.errorIQErrorInternalServerErrorMixin;var c=a.code;a=a.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),a);case"MyAddOnsResponseClientError":c=b.value.myAddonsClientErrors;switch(c.name){case"ItemNotFoundIQErrorResponse":a=c.value.errorIQErrorItemNotFoundMixin;b=a.code;a=a.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(b),a);case"RateLimitedIQErrorResponse":b=c.value.errorIQErrorRateOverlimitMixin;a=b.code;b=b.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),b);case"BadRequestIQErrorResponse":a=c.value.errorIQErrorBadRequestMixin;b=a.code;a=a.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(b),a);case"UnauthorizedIQErrorResponse":b=c.value.errorIQErrorNotAuthorizedMixin;a=b.code;c=b.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),c)}}});return h.apply(this,arguments)}g.getMyNewsletterAddOnsRPC=a}),98);
__d("WAWebNewsletterGetMyAddOnsJob",["Promise","WAJobOrchestratorTypes","WAWebCRUDOperationsNewsletterMyVotes","WAWebDBCreateOrUpdateReactions","WAWebGetMyAddOnsRPC","WAWebNewsletterDBUtils","WAWebOrchestratorNonPersistedJob","WAWebPollOptionHashUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getMyNewsletterAddOns",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebGetMyAddOnsRPC").getMyNewsletterAddOnsRPC(a));b=b.messagesByNewsletter;return i(b,a.newsletterJid)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=a.reduce(function(a,b){var d=b.message;b=b.jid;var e=b!=null?b:c;if(e==null)return a;d.forEach(function(b){var c=k(b,e);c!=null&&a.reactions.push(c);c=l(b,e);c!=null&&a.pollVotes.push(c)});return a},{reactions:[],pollVotes:[]});yield (h||(h=b("Promise"))).all([d("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions(a.reactions),d("WAWebCRUDOperationsNewsletterMyVotes").bulkCreateOrUpdateMyVotes(a.pollVotes)]);return a});return j.apply(this,arguments)}function k(a,b){var c,e;b=d("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(a.serverId,b).toString();var f=a==null||(c=a.newsletterMyReactionMixin)==null?void 0:c.reactionCode;a=a==null||(e=a.newsletterMyReactionMixin)==null?void 0:e.reactionT;return f==null||a==null?null:{parentMsgKey:b,senderUserJid:d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),reactionText:f,timestamp:a*1e3,orphan:0,msgKey:b}}function l(a,b){var c=a.newsletterMyPollVoteMixin;if(c==null)return null;var e=c.votesT;c=c.votesVote;return{chatJid:b,msgServerId:a.serverId,serverTimestampMs:e*1e3,t:e,msgKey:d("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(a.serverId,b).toString(),votes:c.map(function(a){return d("WAWebPollOptionHashUtils").bufferToHex(a.elementValue)})}}g.getMyNewsletterAddOnsJob=a}),98);
__d("WAWebNewsletterLoadingStageManager",["$InternalEnum","WAWebBaseModel","WAWebModelUtils"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["None","Loading","Finished","Failed"]);a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.stage=d("WAWebModelUtils").prop(h.None),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.start=function(){this.stage=h.Loading};c.fail=function(){this.stage=h.Failed};c.end=function(){this.stage=h.Finished};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletterLoadingStage";c=d("WAWebBaseModel").defineModel(a);e=new c({id:"1"});g.NewsletterLoadingStage=h;g.NewsletterLoadingStageManager=e}),98);
__d("WAWebBootstrapNewsletter",["WALogger","WAQplTypes","WAWebNewsletterGatingUtils","WAWebNewsletterGetMyAddOnsJob","WAWebNewsletterLoadingStageManager","WAWebPrimaryFeaturesModel","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebSyncdOrphan","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=5e3,o=null;function a(){if(!d("WAWebNewsletterGatingUtils").isNewsletterEnabled())return;if(o!=null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap already ongoing, returning"])));return o}if(d("WAWebUserPrefsMultiDevice").getNewsletterWasBootstrapped())return;if(d("WAWebNewsletterGatingUtils").isNewsletterEnabledOnPrimary()){o=p();return o}d("WAWebPrimaryFeaturesModel").PrimaryFeatures.on("change:newsletter",function(){if(d("WAWebNewsletterGatingUtils").isNewsletterEnabledOnPrimary()){o=p();return o}})}function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap started"])));var a=d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.NEWSLETTER_BOOSTRAP);d("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.start();try{var b=(yield d("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateAllNewsletterMetadataAction(d("WAWebQueryAndUpdateNewslettersMetadataAction").NewsletterMetadataUpdateEntryPoint.Bootstrap,{messageCount:1,addSystemMsgs:!0,qplEvent:a}));d("WAWebNewsletterGatingUtils").isNewsletterReactionEnabled()&&(yield d("WAWebNewsletterGetMyAddOnsJob").getMyNewsletterAddOnsJob({count:n})["catch"](function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to retrieve my reactions on bootstrap"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-bootstrap-my-reactions-failed")}));d("WAWebUserPrefsMultiDevice").setNewsletterWasBootstrapped();b.success?(yield d("WAWebSyncdOrphan").checkOrphanChats(b.chats.map(function(a){return a.id.toString()})),d("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.end(),a.end(d("WAQplTypes").QuickLogActionType.SUCCESS),d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap completed"])))):(a.end(d("WAQplTypes").QuickLogActionType.FAIL),d("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.fail(),d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap failed"]))).tags("newsletter").sendLogs("newsletter-bootstrap-failed"))}catch(b){a.end(d("WAQplTypes").QuickLogActionType.FAIL),d("WAWebNewsletterLoadingStageManager").NewsletterLoadingStageManager.fail(),d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-bootstrap] Bootstrap failed"]))).tags("newsletter").devConsole(b).sendLogs("newsletter-bootstrap-failed")}finally{o=null}});return q.apply(this,arguments)}g.bootstrapNewsletterBackend=a}),98);
__d("WAWebMexFetchNewsletterDehydratedJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"},b={defaultValue:null,kind:"LocalArgument",name:"input"},c=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}],storageKey:null}]}],storageKey:null}];return{fragment:{argumentDefinitions:[a,b],kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterDehydratedJobQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[b,a],kind:"Operation",name:"WAWebMexFetchNewsletterDehydratedJobQuery",selections:c},params:{id:"30328461880085868",metadata:{},name:"WAWebMexFetchNewsletterDehydratedJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchNewsletterDehydratedJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterDehydratedJobQuery.graphql","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=h!==void 0?h:h=b("WAWebMexFetchNewsletterDehydratedJobQuery.graphql"),j=c("WAWebWid").isNewsletter(a)?"JID":"INVITE";j={input:{key:a,type:j,view_role:e},fetch_wamo_sub:f.fetchWamoSub===!0};e=(yield d("WAWebMexClient").fetchQuery(g,j));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched verification, subscribers count and wamo sub for ",""])),a).tags("GQL","MEX").devConsole({response:e});return e});return j.apply(this,arguments)}g.mexGetNewsletterDehydrated=a}),98);
__d("WAWebMexFetchNewsletterJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"fetch_creation_time"},b={defaultValue:null,kind:"LocalArgument",name:"fetch_full_image"},c={defaultValue:null,kind:"LocalArgument",name:"fetch_viewer_metadata"},d={defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"},e={defaultValue:null,kind:"LocalArgument",name:"input"},f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},h=[f,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],i=[f,g,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}];f=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter",plural:!1,selections:[f,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[g],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{condition:"fetch_creation_time",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null}]},{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:h,storageKey:null},{condition:"fetch_full_image",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:i,storageKey:'picture(type:"IMAGE")'}]},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:i,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:h,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{condition:"fetch_viewer_metadata",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}]}],storageKey:null}]}],storageKey:null}];return{fragment:{argumentDefinitions:[a,b,c,d,e],kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterJobQuery",selections:f,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,c,b,a,d],kind:"Operation",name:"WAWebMexFetchNewsletterJobQuery",selections:f},params:{id:"9305958616175970",metadata:{},name:"WAWebMexFetchNewsletterJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchNewsletterJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterJobQuery.graphql","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=h!==void 0?h:h=b("WAWebMexFetchNewsletterJobQuery.graphql"),j=c("WAWebWid").isNewsletter(a)?"JID":"INVITE",k=j!=="INVITE";j={input:{key:a,type:j,view_role:e},fetch_viewer_metadata:f.fetchViewerMetadata,fetch_full_image:k,fetch_creation_time:f.fetchCreationTime===!0,fetch_wamo_sub:f.fetchWamoSub===!0};e=(yield d("WAWebMexClient").fetchQuery(g,j));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched get newsletter job for ",""])),a).tags("GQL","MEX").devConsole({response:e});return e});return j.apply(this,arguments)}g.mexGetNewsletter=a}),98);
__d("WAWebMexNewsletterParseUtils",["WAJids","WAWebCommonNewsletterEnums","WAWebNewsletterGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){if(a!=null&&(a==null?void 0:a.id)!=null){var b,c,e,f,g,u,v,w,x,y,z,A,B,C;b=(b=a.thread_metadata)==null?void 0:b.creation_time;c=(c=a.thread_metadata)==null?void 0:c.invite;e=(e=a.thread_metadata)==null?void 0:e.name;f=(f=a.thread_metadata)==null?void 0:f.subscribers_count;g=(g=a.viewer_metadata)==null?void 0:g.mute;u=(u=a.thread_metadata)==null?void 0:u.verification;v=(v=a.state)==null?void 0:v.type;w=(w=a.thread_metadata)==null?void 0:w.description;x=(x=a.viewer_metadata)==null?void 0:x.role;y=(y=a.thread_metadata)==null?void 0:y.picture;z=(z=a.thread_metadata)==null?void 0:z.preview;A=(A=a.thread_metadata)==null||(A=A.settings)==null||(A=A.reaction_codes)==null?void 0:A.value;B=(B=a.thread_metadata)==null||(B=B.wamo_sub)==null?void 0:B.plan_id;C=(C=a.viewer_metadata)==null?void 0:C.wamo_sub_status;b=babelHelpers["extends"]({idJid:d("WAJids").toNewsletterJid(a.id),newsletterCreationTimeMetadataMixin:(a=h(b))!=null?a:null,newsletterInviteLinkMetadataMixin:(b=i(c))!=null?b:null,newsletterNameMetadataMixin:(a=j(e))!=null?a:null,newsletterSubscribersMetadataMixin:(c=k(f))!=null?c:null,newsletterMutedMetadataMixin:(b=l(g))!=null?b:null,newsletterVerificationMetadataMixin:(e=m(u))!=null?e:null,newsletterStateMetadataMixin:(a=n(v))!=null?a:null,newsletterDescriptionMetadataMixin:(f=o(w))!=null?f:null,newsletterMembershipMetadataMixin:(c=p(x))!=null?c:null,newsletterPictureMetadataMixin:(g=r([y,z]))!=null?g:null,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterPrivacyMetadataMixin:null},A!=null&&{newsletterReactionCodesSettingMetadataMixin:q(A)});d("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()&&(b.newsletterWamoSubPlanIdMetadataMixin=s(B),b.newsletterWamoSubStatusMetadataMixin=t(C));return b}return null}function h(a){if(a!=null)return{creationTimeValue:Number(a)}}function i(a){if(a!=null)return{inviteCode:a}}function j(a){if(a!=null){return{nameId:a.id,nameUpdateTime:Number(a==null?void 0:a.update_time),nameElementValue:(a=a==null?void 0:a.text)!=null?a:""}}}function k(a){if(a!=null)return{subscribersCount:Number(a)}}function l(a){if(a!=null){var b="undefined";a.toLowerCase()==="off"?b="off":a.toLowerCase()==="on"&&(b="on");return{mutedState:b}}}function m(a){if(a!=null){a=a.toLowerCase()==="unverified"?"unverified":"verified";return{verificationState:a}}}function n(a){var b;(a==null?void 0:a.toLowerCase())==="active"?b="active":(a==null?void 0:a.toLowerCase())==="suspended"?b="suspended":(a==null?void 0:a.toLowerCase())==="geosuspended"&&(b="geosuspended");if(b!=null)return{stateType:b}}function o(a){var b=a==null?void 0:a.text,c=a==null?void 0:a.update_time;if(a!=null&&b!=null&&c!=null)return{descriptionQueryDescriptionResponseMixin:{id:a.id,updateTime:Number(c),elementValue:b}}}function p(a){if(a!=null){var b;switch(a.toLowerCase()){case"admin":b="admin";break;case"guest":b="guest";break;case"owner":b="owner";break;case"subscriber":b="subscriber";break}if(b!=null)return{membershipType:b}}}function q(a){switch(a){case"ALL":return d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All;case"BLOCKLIST":return d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Blocklist;case"NONE":return d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.None;case"BASIC":return d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Basic;default:return null}}function r(a){var b=[];for(a of a)if(a==null)continue;else if(a!=null&&a.type!=null){var c=a.type.toLowerCase()==="image"?"image":"preview";a.direct_path!=null&&a.direct_path!==""&&a.id!=null&&a.type!=null?b.push({queryPictureDirectPathOrEmptyResponseMixinGroup:{name:"QueryPictureDirectPathResponse",value:{directPath:a.direct_path,type:c,id:a.id}}}):(a.direct_path===""||a.direct_path==null)&&b.push({queryPictureDirectPathOrEmptyResponseMixinGroup:{name:"QueryPictureEmptyResponse",value:{type:"image"}}})}return{picture:[].concat(b)}}function s(a){if(a!=null)return a}function t(a){if(a!=null)switch(a.toLowerCase()){case"active":return d("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE;case"inactive":return d("WAWebCommonNewsletterEnums").WamoSubStatus.INACTIVE;default:return}}g.parseMexNewsletterResponse=a;g.toReactionCodesSettingMixin=q}),98);
__d("WAWebMexNewsletterUtils",["WAJids","WAWebBackendErrors","WAWebCommonNewsletterEnums","WAWebMexFetchNewsletterDehydratedJob","WAWebMexFetchNewsletterJob","WAWebMexNewsletterParseUtils","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c,e;b=(b=a.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:b.anyJid;c=(c=a.queryPayloadsArgs.inviteQueryIQPayload)==null?void 0:c.anyKey;e=(e=(e=a.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:e.anyViewRole)!=null?e:(e=a.queryPayloadsArgs.inviteQueryIQPayload)==null?void 0:e.anyViewRole;b=b!=null?b:c;if(b!=null){l(a)?c=(yield d("WAWebMexFetchNewsletterDehydratedJob").mexGetNewsletterDehydrated(b,i(e),{fetchWamoSub:d("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()})):c=(yield d("WAWebMexFetchNewsletterJob").mexGetNewsletter(b,i(e),{fetchViewerMetadata:j(a),fetchCreationTime:k("hasNewsletterCreationTimeField",a),fetchWamoSub:d("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()}));if(c==null)return;b=d("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(c.xwa2_newsletter);return b}});return h.apply(this,arguments)}function i(a){if(a==null)return"GUEST";switch(a){case"admin":return"ADMIN";case"owner":return"OWNER";case"subscriber":return"SUBSCRIBER";default:return"GUEST"}}function c(a){switch(a){case"OWNER":return d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner;case"SUBSCRIBER":return d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber;case"ADMIN":return d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin;case"GUEST":return d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}}function e(a){switch(a){case d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All:return"ALL";case d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Basic:return"BASIC";case d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.None:return"NONE";case d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.Blocklist:return"BLOCKLIST"}}function f(a){if(a!=null&&a.id!=null){var b,c,e;((b=a.state)==null?void 0:b.type)==="SUSPENDED"&&(e={error:"423"});((b=a.state)==null?void 0:b.type)==="NON_EXISTING"&&(c={error:"404"});return{jid:d("WAJids").toNewsletterJid(a.id),subscriberNotFoundMixin:c,newsletterSuspendedErrorMixin:e}}throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"unexpected_mex_mutation_response")}function j(a){var b,c;b=(b=a.queryPayloadsArgs.jidQueryIQPayload)==null||(b=b.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:b.hasNewsletterMutedField;if(b===!0)return!0;b=(c=a.queryPayloadsArgs.deprecatedInviteQueryIQPayload)==null||(c=c.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:c.hasNewsletterMutedField;if(b===!0)return!0;b=(c=a.queryPayloadsArgs.jidQueryIQPayload)==null||(c=c.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:c.hasNewsletterMembershipField;if(b===!0)return!0;b=(c=a.queryPayloadsArgs.deprecatedInviteQueryIQPayload)==null||(c=c.allNewsletterMetadataIQRequestPayloadMixinArgs)==null?void 0:c.hasNewsletterMembershipField;return b===!0?!0:!1}function k(a,b){var c;c=(c=(c=b.queryPayloadsArgs.jidQueryIQPayload)==null?void 0:c.allNewsletterMetadataIQRequestPayloadMixinArgs)!=null?c:b.queryPayloadsArgs.inviteQueryIQPayload;return c==null||((b=Object.getOwnPropertyDescriptor(c,a))==null?void 0:b.value)===!0}function l(a){a=a.queryPayloadsArgs.jidQueryIQPayload;if(a!=null){a=a.allNewsletterMetadataIQRequestPayloadMixinArgs;return a.hasNewsletterCreationTimeField!==!0&&a.hasNewsletterNameField!==!0&&a.hasNewsletterDescriptionField!==!0&&a.hasNewsletterInviteLinkField!==!0&&a.hasNewsletterHandleField!==!0&&a.hasNewsletterPrivacyField!==!0&&a.hasNewsletterLinkedAccountsField!==!0&&a.hasNewsletterStateField!==!0&&a.newsletterPictureFieldMixinArgs==null&&a.hasNewsletterMembershipField!==!0&&a.hasNewsletterMutedField!==!0&&a.hasNewsletterVerificationField===!0&&a.hasNewsletterSubscribersField===!0}return!1}g.handleMexGetNewsletter=a;g.mapRoleToMembership=c;g.mapReactionCodesSettingToMexInput=e;g.convertMutationResponse=f}),98);
__d("WAWebNewsletterStorageUtils",["WAWebCommonNewsletterEnums","WAWebNewsletterDBConstants"],(function(a,b,c,d,e,f,g){function h(a){switch(a){case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:return d("WAWebNewsletterDBConstants").NewsletterDBMembership.Subscriber;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:return d("WAWebNewsletterDBConstants").NewsletterDBMembership.Admin;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest:return d("WAWebNewsletterDBConstants").NewsletterDBMembership.Guest;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:return d("WAWebNewsletterDBConstants").NewsletterDBMembership.Owner}}function i(a){switch(a){case d("WAWebCommonNewsletterEnums").NewsletterPrivacy.Public:return 0;case d("WAWebCommonNewsletterEnums").NewsletterPrivacy.Private:return 1}}function j(a){switch(a){case d("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE:return 0;case d("WAWebCommonNewsletterEnums").WamoSubStatus.INACTIVE:return 1}}function a(a){var b={id:a.id.toString()};a.creationTime!=null&&(b.creationTime=a.creationTime);a.name!=null&&(b.name=a.name);a.nameUpdateTime!=null&&(b.nameUpdateTime=a.nameUpdateTime);a.description!=null&&(b.description=a.description);a.descriptionUpdateTime!=null&&(b.descriptionUpdateTime=a.descriptionUpdateTime);a.handle!=null&&(b.handle=a.handle);a.inviteCode!=null&&(b.inviteCode=a.inviteCode);a.size!=null&&(b.size=a.size);a.verified!=null&&(b.verified=a.verified);a.membershipType!=null&&(b.membershipType=h(a.membershipType));a.privacy!=null&&(b.privacy=i(a.privacy));if(a.website!=null){var c;b.website=(c=a.website)==null?void 0:c.href}a.reactionCodesSetting!=null&&(b.reactionCodesSetting=a.reactionCodesSetting);a.adminCount!=null&&(b.adminCount=a.adminCount);a.capabilities!=null&&(b.capabilities=new Set(Array.from(a.capabilities).map(function(a){return a})));a.suspended!=null&&(b.suspended=a.suspended);a.geosuspended!=null&&(b.geosuspended=a.geosuspended);a.terminated!=null&&(b.terminated=a.terminated);a.wamoSubPlanId!=null&&(b.wamoSubPlanId=a.wamoSubPlanId);a.wamoSubStatus!=null&&(b.wamoSubStatus=j(a.wamoSubStatus));return b}g.mapNewsletterMembershipTypeForStorage=h;g.mapNewsletterWamoSubStatusForStorage=j;g.createNewsletterMetadataObjectForStorage=a}),98);
__d("WAWebTimedCache",["WALogger","WATimeUtils","WAWebApiHydrateWidsUtil","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a,b){if(a==null)return null;var c=d("WATimeUtils").unixTimeMs(),e=a.timestamp;a=a.value;c=c-e;return c<b?a:null}function m(a){return{timestamp:d("WATimeUtils").unixTimeMs(),value:a}}a=function(){function a(a){var b=a.mapLoad,c=a.mapStore;a=a.getCacheTtlMs;this.$1=b;this.$2=c;this.$3=a}var c=a.prototype;c.get=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=this.$1();a=(a=JSON.stringify(a))!=null?a:"";b=b==null?void 0:b.get(a);a=d("WAWebApiHydrateWidsUtil").hydrateWids(b);return l(a,this.$3())}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to get cache value"]))).tags("newsletter").devConsole(a).sendLogs("[TimedMapCache] Failed to get value from cache");return null}});function c(b){return a.apply(this,arguments)}return c}();c.set=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c;c=(c=this.$1())!=null?c:new Map();a=(a=JSON.stringify(a))!=null?a:"";b=m(b);c==null||c.set(a,b);yield this.$2(c)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to set cache value"]))).tags("newsletter").devConsole(a).sendLogs("[TimedMapCache] Failed to set value in cache");return}});function c(b,c){return a.apply(this,arguments)}return c}();c.remove=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=this.$1();if(b==null)return;a=(a=JSON.stringify(a))!=null?a:"";b==null||b["delete"](a);yield this.$2(b)}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to remove cache value"]))).tags("newsletter").devConsole(a).sendLogs("[TimedMapCache] Failed to remove value from cache");return}});function c(b){return a.apply(this,arguments)}return c}();c.pop=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=this.$1();if(a==null)return null;var b=a.entries().next().value;if(b==null)return null;var c=b[0];b=b[1];a==null||a["delete"](c);yield this.$2(a);c=d("WAWebApiHydrateWidsUtil").hydrateWids(b);return l(c,this.$3())}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Failed to pop cache value"]))).tags("newsletter").devConsole(a).sendLogs("[TimedMapCache] Failed to pop value from cache");return null}});function c(){return a.apply(this,arguments)}return c}();c.size=function(){var a=this.$1();return(a=a==null?void 0:a.size)!=null?a:0};return a}();c=function(a){function c(b){var c=b.mapLoad,d=b.mapStore,e=b.getCacheTtlMs;b=b.capacity;c=a.call(this,{mapLoad:c,mapStore:d,getCacheTtlMs:e})||this;c.$TimedLRUMapCache$p_1=b;return c}babelHelpers.inheritsLoose(c,a);var d=c.prototype;d.get=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield a.prototype.get.call(this,b));c!=null&&(yield a.prototype.remove.call(this,b),yield a.prototype.set.call(this,b,c));return c});function d(a){return c.apply(this,arguments)}return d}();d.set=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){yield a.prototype.remove.call(this,b),yield a.prototype.set.call(this,b,c),this.size()>this.$TimedLRUMapCache$p_1&&(yield a.prototype.pop.call(this))});function d(a,b){return c.apply(this,arguments)}return d}();return c}(a);g.getTimedCacheItemValue=l;g.createTimedCacheItem=m;g.TimedMapCache=a;g.TimedLRUMapCache=c}),98);
__d("WAWebUserPrefsNewsletter",["$InternalEnum","WAWebNewsletterGatingUtils","WAWebTimedCache","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.NEWSLETTER_TAB_LAST_SEEN_TIMESTAMP);a=typeof a==="number"?a:0;return a}function e(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.NEWSLETTER_TAB_LAST_SEEN_TIMESTAMP,a)}function f(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_RECOMMENDED_NEWSLETTERS);return d("WAWebTimedCache").getTimedCacheItemValue(a,d("WAWebNewsletterGatingUtils").getRecommendedNewslettersRefreshInterval())}function h(a){a=d("WAWebTimedCache").createTimedCacheItem(a);return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_RECOMMENDED_NEWSLETTERS,a)}var i=b("$InternalEnum").Mirrored(["FULL","LIMITED"]),j=new(d("WAWebTimedCache").TimedMapCache)({mapLoad:function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTERS_SUBSCRIBERS)},mapStore:function(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTERS_SUBSCRIBERS,a)},getCacheTtlMs:d("WAWebNewsletterGatingUtils").getNewsletterSubscriberListCacheRefreshMs});function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={view:i.LIMITED,newsletterJid:a};a={view:i.FULL,newsletterJid:a};yield j.remove(b);yield j.remove(a)});return l.apply(this,arguments)}var m=new(d("WAWebTimedCache").TimedMapCache)({mapLoad:function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_PAGES)},mapStore:function(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_PAGES,a)},getCacheTtlMs:d("WAWebNewsletterGatingUtils").getNewsletterDirectoryPageRefreshInterval}),n=new(d("WAWebTimedCache").TimedMapCache)({mapLoad:function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_CATERGORY_PREVIEW)},mapStore:function(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.WA_WEB_CACHED_NEWSLETTER_DIRECTORY_CATERGORY_PREVIEW,a)},getCacheTtlMs:d("WAWebNewsletterGatingUtils").getNewsletterDirectoryCategoriesPreviewRefreshIntervalMs});g.getNewsletterTabLastSeenTimestamp=a;g.setNewsletterTabLastSeenTimestamp=e;g.getCachedRecommendedNewsletters=f;g.setCachedRecommendedNewsletters=h;g.ValidCachedNewsletterSubscriberKeys=i;g.NewsletterSubscribersCache=j;g.flushCachedNewsletterSubscribers=k;g.NewsletterDirectoryPageCache=m;g.NewsletterDirectoryCategoriesPreviewCache=n}),98);
__d("WAWebMexNewsletterRoleChangeNotificationHandler",["WALogger","WAWebBackendApi","WAWebMexNewsletterUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataJob","WAWebNewsletterStorageUtils","WAWebNewsletterValidationUtils","WAWebUserPrefsMeUser","WAWebUserPrefsNewsletter","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;a=b.xwa2_notify_newsletter_admin_promote!=null?"promote":"demote";c=(c=b.xwa2_notify_newsletter_admin_promote)!=null?c:b.xwa2_notify_newsletter_admin_demote;if(c==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[mex][newsletter][notification][admin-","] Failed to process "," notification, null payload"])),a,a).tags("mex","newsletter").sendLogs("mex-newsletternotification-state-change-fail");return}try{var e=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(c.id),f=k(babelHelpers["extends"]({},c.user));if(!f)return;var g=d("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled()?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow();c=d("WAWebMexNewsletterUtils").mapRoleToMembership(c.user_new_role);if(c==null)return;f.equals(g)?(yield d("WAWebNewsletterMetadataJob").updateNewsletterMetadata({id:e,membershipType:d("WAWebNewsletterStorageUtils").mapNewsletterMembershipTypeForStorage(c)}),d("WAWebBackendApi").frontendFireAndForget("handleMyRoleChangeNotification",{jid:e})):d("WAWebBackendApi").frontendFireAndForget("handleOtherUserRoleChangeNotification",{jid:e,userId:f,newRole:c});yield d("WAWebUserPrefsNewsletter").flushCachedNewsletterSubscribers(e);d("WAWebBackendApi").frontendFireAndForget("displayRoleChangeDesktopNotification",{notification:b})}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[mex][newsletter][notification][admin-","] Failed to process "," notification, error parsing jid"])),a,a).tags("mex","newsletter").devConsole(b).sendLogs("mex-newsletternotification-state-change-fail-"+a)}});return j.apply(this,arguments)}function k(a){var b=a.id;a=a.pn;if(d("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled()){if(b==null)return;return d("WAWebWidFactory").createUserWidOrThrow(b)}if(a==null)return;return d("WAWebWidFactory").createWid(a)}g.mexHandleNewsletterRoleChange=a;g.getUserIdFromPayload=k}),98);
__d("WAWebMexFetchNewsletterEnforcementsJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],b=[{kind:"Variable",name:"channel_id",variableName:"newsletter_id"}],c={alias:null,args:null,kind:"ScalarField",name:"enforcement_creation_time",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"appeal_creation_time",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"appeal_state",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"enforcement_violation_category",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"enforcement_source",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"enforcement_id",storageKey:null},i={kind:"RequiredField",field:h,action:"THROW"},j={alias:null,args:null,kind:"ScalarField",name:"appeal_form_url",storageKey:null},k={alias:null,args:null,concreteType:"XWA2IPViolationReportData",kind:"LinkedField",name:"ip_violation_report_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"report_fbid",storageKey:null},j,{alias:null,args:null,kind:"ScalarField",name:"reporter_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reporter_name",storageKey:null}],storageKey:null},l={alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[k],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"server_msg_id",storageKey:null},n={kind:"InlineFragment",selections:[m],type:"XWA2ChannelServerMsgData",abstractKey:null},o={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"enforcement_target_data",plural:!1,selections:[n],storageKey:null};j={alias:null,args:null,concreteType:"XWA2AppealExtraData",kind:"LinkedField",name:"appeal_extra_data",plural:!1,selections:[j],storageKey:null};var p={alias:null,args:null,concreteType:"XWA2EnforcingEntityData",kind:"LinkedField",name:"enforcing_entity_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"enforcement_origin_workflow",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"enforcement_origin_legal_basis",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"country_codes",storageKey:null};n={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"enforcement_target_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},n],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterEnforcementsJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2ChannelEnforcementsResponse",kind:"LinkedField",name:"xwa2_channel_enforcements",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"profile_picture_deletions",plural:!0,selections:[c,d,e,f,g,i,l],storageKey:null},{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"suspensions",plural:!0,selections:[d,c,e,f,i,g,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[k,o,j],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2ViolatingMessagesEnforcementData",kind:"LinkedField",name:"violating_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[c,d,e,i,f,g,l],storageKey:null},{kind:"RequiredField",field:m,action:"THROW"}],storageKey:null},{alias:null,args:null,concreteType:"XWA2GeosuspendedEnforcementData",kind:"LinkedField",name:"geosuspensions",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[{kind:"RequiredField",field:c,action:"THROW"},d,e,i,f,g,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[k,o,j,p,q,r],storageKey:null}],storageKey:null},{kind:"RequiredField",field:s,action:"THROW"},t],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchNewsletterEnforcementsJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2ChannelEnforcementsResponse",kind:"LinkedField",name:"xwa2_channel_enforcements",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"profile_picture_deletions",plural:!0,selections:[c,d,e,f,g,h,l],storageKey:null},{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"suspensions",plural:!0,selections:[d,c,e,f,h,g,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[k,n,j],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2ViolatingMessagesEnforcementData",kind:"LinkedField",name:"violating_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[c,d,e,h,f,g,l],storageKey:null},m],storageKey:null},{alias:null,args:null,concreteType:"XWA2GeosuspendedEnforcementData",kind:"LinkedField",name:"geosuspensions",plural:!0,selections:[{alias:null,args:null,concreteType:"XWA2BaseEnforcementData",kind:"LinkedField",name:"base_enforcement_data",plural:!1,selections:[c,d,e,h,f,g,{alias:null,args:null,concreteType:"XWA2EnforcementExtraData",kind:"LinkedField",name:"enforcement_extra_data",plural:!1,selections:[k,n,j,p,q,r],storageKey:null}],storageKey:null},s,t],storageKey:null}],storageKey:null}]},params:{id:"9808120992618220",metadata:{},name:"WAWebMexFetchNewsletterEnforcementsJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchNewsletterEnforcementsJob",["WALogger","WATimeUtils","WAWebCommonNewsletterEnums","WAWebCountriesUtils","WAWebLocaleModules","WAWebMexClient","WAWebMexFetchNewsletterEnforcementsJobQuery.graphql","asyncToGeneratorRuntime","filterNulls"],(function(a,b,c,d,e,f,g){var h,i,j,k=h!==void 0?h:h=b("WAWebMexFetchNewsletterEnforcementsJobQuery.graphql");function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={newsletter_id:a};b=(yield d("WAWebMexClient").fetchQuery(k,b));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER][WA-ICE][DSA] fetched all enforcements"]))).tags("GQL","MEX","wa-ice","DSA").devConsole({newsletterJid:a,response:b});a=b==null?void 0:b.xwa2_channel_enforcements;if(a==null){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER][WA-ICE][DSA] MEX enforcements query returned empty response."]))).tags("GQL","MEX","wa-ice","DSA");return null}var e={profilePictureDeletions:[],suspensions:[],violatingMessages:[],geoSuspensions:[]};if(a.profile_picture_deletions!=null){var f=[];a.profile_picture_deletions.forEach(function(a){if(m(a))return;f.push(o(a,d("WAWebCommonNewsletterEnums").EnforcementType.PROFILE_PICTURE_DELETION))});e.profilePictureDeletions=f}if(a.suspensions!=null){var g=[];a.suspensions.forEach(function(a){var b;if(m(a))return;a=o(a,d("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND);a.enforcementType=((b=a.enforcementExtraData)==null||(b=b.enforcementTargetData)==null?void 0:b.serverId)!=null?d("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND_INFORM:d("WAWebCommonNewsletterEnums").EnforcementType.SUSPEND;g.push(a)});e.suspensions=g}if(a.violating_messages!=null){var h=[];a.violating_messages.forEach(function(a){if(m(a.base_enforcement_data))return;h.push(babelHelpers["extends"]({},o(a.base_enforcement_data,d("WAWebCommonNewsletterEnums").EnforcementType.VIOLATING_MSG),{serverId:parseInt(a.server_msg_id,10)}))});e.violatingMessages=h}var l=a.geosuspensions;if(l!=null){var n=[];yield d("WAWebLocaleModules").getCountryData().then(function(a){l.forEach(function(b){var e;if(m(b.base_enforcement_data))return;e=(e=b.country_codes)==null?void 0:e.map(function(b){var c=d("WAWebCountriesUtils").asISOCountryCode(b);b=a[b.toUpperCase()];return c!=null&&b!=null?{countryCode:c,countryName:b}:null});var f=d("WAWebCountriesUtils").asISOCountryCode(b.country_code),g=f!=null?a[f.toUpperCase()]:null;f=g!=null&&f!=null?{countryCode:f,countryName:g}:null;var h;e!=null?h=c("filterNulls")(e):f!=null&&(h=[f]);g=o(b.base_enforcement_data,d("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND);g.enforcementType=((e=g.enforcementExtraData)==null||(e=e.enforcementTargetData)==null?void 0:e.serverId)!=null?d("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND_INFORM:d("WAWebCommonNewsletterEnums").EnforcementType.GEOSUSPEND;h!=null&&((f=h)==null?void 0:f.length)>0&&n.push(babelHelpers["extends"]({},g,{countryCodes:h}))})})["finally"](function(){e.geoSuspensions=n})}return e});return l.apply(this,arguments)}function m(a){return a.appeal_creation_time==null&&a.appeal_state!=="NOT_APPEALED"&&a.appeal_state!=="NON_APPEALABLE"}function n(a){if(a==null)return null;var b=a==null?void 0:a.ip_violation_report_data,c=a==null?void 0:a.enforcement_target_data,d=a==null?void 0:a.enforcing_entity_data,e=a==null?void 0:a.appeal_extra_data,f=a==null?void 0:a.enforcement_origin_workflow;a=a==null?void 0:a.enforcement_origin_legal_basis;var g=null;b!=null&&(g={ipViolationReportData:{reportFbid:b.report_fbid,appealFormUrl:b.appeal_form_url,reporterEmail:b.reporter_email,reporterName:b.reporter_name}});c!=null&&(g=babelHelpers["extends"]({},g,{enforcementTargetData:{serverId:parseInt(c.server_msg_id,10)}}));e!=null&&e.appeal_form_url!=null&&(g=babelHelpers["extends"]({},g,{appealExtraData:{appealFormUrl:e.appeal_form_url}}));d!=null&&d.name!=null&&(g=babelHelpers["extends"]({},g,{enforcingEntityData:{name:d.name}}));f!=null&&(g=babelHelpers["extends"]({},g,{enforcementOriginWorkflow:f}));a!=null&&(g=babelHelpers["extends"]({},g,{enforcementOriginLegalBasis:a}));return g}function o(a,b){var c;return{appealCreationTime:d("WATimeUtils").castToUnixTime(parseInt((c=a.appeal_creation_time)!=null?c:0,10)),enforcementCreationTime:d("WATimeUtils").castToUnixTime(parseInt(a.enforcement_creation_time,10)),appealState:a.appeal_state,enforcementViolationCategory:a.enforcement_violation_category,enforcementId:a.enforcement_id,enforcementType:b,enforcementSource:(c=a.enforcement_source)!=null?c:null,enforcementExtraData:n(a.enforcement_extra_data)}}g.mexFetchNewsletterEnforcements=a}),98);
__d("WAWebNewsletterEnforcementAlertModelUtils",["WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(a,b,c){var e=[];a==null||a.map(function(f){var g;g=(g=f.enforcementExtraData)==null||(g=g.enforcementTargetData)==null?void 0:g.serverId.toString();var h=g!=null?b==null?void 0:b.get(Number(g)):null,i=new Map(),j={id:f.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementViolationCategory:f.enforcementViolationCategory,enforcementType:f.enforcementType,enforcementId:f.enforcementId,enforcementExtraData:f.enforcementExtraData,enforcementSource:f.enforcementSource,appealCreationTime:f.appealCreationTime,appealState:f.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:g,msgData:h};g!=null&&h!=null&&i.set(g,j);a={id:f.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementCreationTime:f.enforcementCreationTime,enforcementViolationCategory:f.enforcementViolationCategory,enforcementType:f.enforcementType,enforcementId:f.enforcementId,enforcementExtraData:f.enforcementExtraData,targetMsgMapForEvidence:i,lastUpdated:Date.now(),enforcementSource:f.enforcementSource,countryCodes:[],appeal:j};e.push(a)});return e}function i(a,b,c){var e=new Map();a.map(function(a){var f={id:a.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementViolationCategory:a.enforcementViolationCategory,enforcementType:a.enforcementType,enforcementId:a.enforcementId,enforcementExtraData:a.enforcementExtraData,enforcementSource:a.enforcementSource,appealCreationTime:a.appealCreationTime,appealState:a.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:a.serverId.toString(),msgData:b==null?void 0:b.get(a.serverId)};e.set(a.serverId.toString(),f)});a=a[0];return a==null?null:{id:a.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementCreationTime:a.enforcementCreationTime,enforcementViolationCategory:a.enforcementViolationCategory,enforcementType:a.enforcementType,enforcementId:a.enforcementId,enforcementExtraData:a.enforcementExtraData,targetMsgMapForEvidence:e,lastUpdated:Date.now(),enforcementSource:a.enforcementSource,countryCodes:[],appeal:{id:a.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementViolationCategory:a.enforcementViolationCategory,enforcementType:a.enforcementType,enforcementId:a.enforcementId,enforcementExtraData:a.enforcementExtraData,enforcementSource:a.enforcementSource,appealCreationTime:a.appealCreationTime,appealState:a.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:a.serverId.toString(),msgData:b==null?void 0:b.get(a.serverId)}}}function j(a,b){var c=[];a==null||a.map(function(e){var f={id:e.enforcementId,chatId:d("WAWebWidFactory").createWid(b),enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,enforcementSource:e.enforcementSource,appealCreationTime:e.appealCreationTime,appealState:e.appealState,appealReason:null,countryCode:null,lastUpdated:Date.now(),serverMsgId:null,msgData:null};a={id:e.enforcementId,chatId:d("WAWebWidFactory").createWid(b),enforcementCreationTime:e.enforcementCreationTime,enforcementViolationCategory:e.enforcementViolationCategory,enforcementType:e.enforcementType,enforcementId:e.enforcementId,enforcementExtraData:e.enforcementExtraData,targetMsgMapForEvidence:null,lastUpdated:Date.now(),enforcementSource:e.enforcementSource,countryCodes:[],appeal:f};c.push(a)});return c}function k(a,b,c){var e=[];a==null||a.map(function(f){var g;g=(g=f.enforcementExtraData)==null||(g=g.enforcementTargetData)==null?void 0:g.serverId.toString();var h=g!=null?b==null?void 0:b.get(Number(g)):null,i=new Map(),j={id:f.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementViolationCategory:f.enforcementViolationCategory,enforcementType:f.enforcementType,enforcementId:f.enforcementId,enforcementExtraData:f.enforcementExtraData,enforcementSource:f.enforcementSource,appealCreationTime:f.appealCreationTime,appealState:f.appealState,appealReason:null,countryCode:f.countryCodes,lastUpdated:Date.now(),serverMsgId:g,msgData:h};g!=null&&h!=null&&i.set(g,j);a={id:f.enforcementId,chatId:d("WAWebWidFactory").createWid(c),enforcementCreationTime:f.enforcementCreationTime,enforcementViolationCategory:f.enforcementViolationCategory,enforcementType:f.enforcementType,enforcementId:f.enforcementId,enforcementExtraData:f.enforcementExtraData,targetMsgMapForEvidence:i,lastUpdated:Date.now(),enforcementSource:f.enforcementSource,countryCodes:f.countryCodes,appeal:j};e.push(a)});return e}function a(a,b,c){var d=[];(a==null?void 0:a.suspensions)!=null&&d.push.apply(d,h(a==null?void 0:a.suspensions,b,c));(a==null?void 0:a.geoSuspensions)!=null&&d.push.apply(d,k(a==null?void 0:a.geoSuspensions,b,c));(a==null?void 0:a.profilePictureDeletions)!=null&&d.push.apply(d,j(a==null?void 0:a.profilePictureDeletions,c));if((a==null?void 0:a.violatingMessages)!=null){a=i(a==null?void 0:a.violatingMessages,b,c);a!=null&&d.push(a)}return d}g.convertNewsletterBaseEnforcementTypeToNewsletterAlert=a}),98);
__d("WAWebGetNewsletterEnforcementAlertsJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterEnforcementsJob","WAWebNewsletterEnforcementAlertModelUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","WAWebSuspendInformDataModelUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,c){c===void 0&&(c=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterEnforcementAlerts",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(a));if(b==null)return;b=(yield d("WAWebMexFetchNewsletterEnforcementsJob").mexFetchNewsletterEnforcements(a));var c=(yield d("WAWebSuspendInformDataModelUtils").populateMsgModels(Array.from(l(b)).sort(function(a,b){return a-b}),a));return{enforcementData:b!=null?d("WAWebNewsletterEnforcementAlertModelUtils").convertNewsletterBaseEnforcementTypeToNewsletterAlert(b,c,a):[],msgModelMap:c}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] GET list of all enforcements for the given newsletter"]))).tags("GQL","MEX","DSA").devConsole({e:a});throw a}}),{priority:c}).waitUntilCompleted()}function i(a){var b;a=a==null||(b=a.filter(function(a){return((a=a.enforcementExtraData)==null||(a=a.enforcementTargetData)==null?void 0:a.serverId)!=null}))==null?void 0:b.map(function(a){return(a=(a=a.enforcementExtraData)==null||(a=a.enforcementTargetData)==null?void 0:a.serverId)!=null?a:0});return a!=null&&a.length>0?a:[]}function j(a){a=a==null?void 0:a.flatMap(function(a){return a.serverId});return a!=null&&a.length>0?a:[]}function k(a){return a==null?[]:a.reduce(function(a,b){b=(b=b.enforcementExtraData)==null||(b=b.enforcementTargetData)==null?void 0:b.serverId;b!=null&&a.push(b);return a},[])}function l(a){if(a==null)return new Set([]);var b=a.suspensions,c=a.violatingMessages;a=a.geoSuspensions;return new Set([].concat(i(b),j(c),k(a)))}g.getNewsletterEnforcementAlerts=a}),98);
__d("WAWebMexCreateNewsletterJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},d=[b,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],e=[b,c,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}];b=[{alias:null,args:[{kind:"Variable",name:"newsletter_input",variableName:"input"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_create",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[c],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:d,storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:d,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscribers_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexCreateNewsletterJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexCreateNewsletterJobMutation",selections:b},params:{id:"8823471724422422",metadata:{},name:"WAWebMexCreateNewsletterJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexCreateNewsletterJob",["WALogger","WAWebMexClient","WAWebMexCreateNewsletterJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=h!==void 0?h:h=b("WAWebMexCreateNewsletterJobMutation.graphql");a={input:{name:a,description:c,picture:e}};c=(yield d("WAWebMexClient").fetchQuery(f,a));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] newsletter created via mex"]))).tags("GQL","MEX").devConsole({response:c});return c});return j.apply(this,arguments)}g.mexCreateNewsletter=a}),98);
__d("WAWebNewsletterCreateQueryJob",["WASmaxNewslettersCreateRPC","WAWebBackendErrors","WAWebMexCreateNewsletterJob","WAWebMexNewsletterParseUtils","WAWebNewsletterRpcUtils","WAWebURLUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var b=a.name,c=a.description;a=a.picture;return h(b,c,a)}function e(){e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.name,c=a.description;a=a.picture;var e=[{pictureType:"image"},{pictureType:"preview"}];b=(yield d("WASmaxNewslettersCreateRPC").sendCreateRPC({createRequestMixinMixinArgs:{setNameMixinMixinArgs:{nameElementValue:b},setNewDescriptionMixinMixinArgs:c!=null?{descriptionElementValue:c}:void 0,setNewPictureMixinMixinArgs:a!=null?{pictureElementValue:a}:void 0,allNewsletterMetadataIQRequestPayloadMixinArgs:{hasNewsletterCreationTimeField:!0,hasNewsletterNameField:!0,newsletterPictureFieldMixinArgs:{pictureArgs:e},hasNewsletterDescriptionField:!0,hasNewsletterInviteLinkField:!0,hasNewsletterHandleField:!0,hasNewsletterSubscribersField:!0,hasNewsletterPrivacyField:!0,hasNewsletterVerificationField:!0,hasNewsletterLinkedAccountsField:!0,hasNewsletterMembershipField:!0,hasNewsletterMutedField:!0}}}));switch(b.name){case"CreateResponseSuccess":return b.value.newsletterNewsletterWithMetadataIQResponsePayloadMixin;case"CreateResponseClientError":c=b.value.badRequestOrRateLimitedIQErrorResponseMixinGroup;switch(c.name){case"BadRequestIQErrorResponse":a=c.value.errorIQErrorBadRequestMixin;e=a.code;a=a.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a);case"RateLimitedIQErrorResponse":e=c.value.errorIQErrorRateOverlimitMixin;a=e.code;c=e.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),c)}break;case"CreateResponseServerError":e=b.value.errorIQErrorInternalServerErrorMixin;a=e.code;c=e.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),c)}});return e.apply(this,arguments)}function h(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f;e!=null&&(f=c("WAWebURLUtils").parseDataURL(e).data);e=(yield d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return d("WAWebMexCreateNewsletterJob").mexCreateNewsletter(a,b,f)}));return d("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(e.xwa2_newsletter_create)});return i.apply(this,arguments)}g.createNewsletterQuery=a}),98);
__d("WAWebNewsletterUpdateNewslettersRecordsJob",["WAJobOrchestratorTypes","WALogger","WAWebOrchestratorNonPersistedJob","WAWebSchemaChat"],(function(a,b,c,d,e,f,g){var h;function a(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateNewsletterChatRecords"])));return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterChatRecords",function(){return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.updateNewsletterChatRecords=a}),98);
__d("WAWebNewsletterCreateJob",["WABase64","WAJobOrchestratorTypes","WALogger","WAWebCreateChat","WAWebNewsletterCreateQueryJob","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","WAWebNewsletterStorageUtils","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterUpdateNewslettersRecordsJob","WAWebOrchestratorNonPersistedJob","WAWebURLUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("createNewsletter",function(){return d("WAWebNewsletterCreateQueryJob").createNewsletterQuery(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return null;var b=d("WAWebNewsletterModelUtils").mapNewsletterToModels(a),c=b.chat;b=b.metadata;try{var e=d("WAWebNewsletterSystemMessages").genNewsletterCreationSystemMessages({id:c.id,name:c.name,t:b.creationTime,role:b.membershipType});yield d("WAWebNewsletterUpdateNewslettersRecordsJob").updateNewsletterChatRecords([d("WAWebCreateChat").createNewsletterObjectForStorage(c)]);yield d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(e);yield d("WAWebNewsletterMetadataJob").updateNewsletterMetadata(d("WAWebNewsletterStorageUtils").createNewsletterMetadataObjectForStorage(b));return{newsletter:a,msgs:e}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][join-notification] Failed to update the db records"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-join-notification-db-fail")}});return function(b){return a.apply(this,arguments)}}())},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function e(a){if(a==null)return null;a=c("WAWebURLUtils").parseDataURL(a).data;a=d("WABase64").decodeB64(a);return new Uint8Array(a)}g.createNewsletter=a;g.encodePicture=e}),98);
__d("WAWebdbCRUDOperationsNewsletterReaction",["WAWebModelStorageUtils","WAWebSchemaNewsletterReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=new Map();a.forEach(function(a){var b=a.parentMsgKey;b=b;var d=c.get(b);d?d.serverTimestamp<=a.serverTimestamp&&c.set(b,a):c.set(b,a)});return d("WAWebModelStorageUtils").getStorage().lock(["newsletter-reactions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=Array.from(c.values()).map(function(a){return a.parentMsgKey});b=(yield a.anyOf(["parentMsgKey"],b));b.forEach(function(a){var b=a.parentMsgKey,d=c.get(b);d&&(d.serverTimestamp<=a.serverTimestamp&&c["delete"](b))});yield a.bulkCreateOrReplace(Array.from(c.values()))});return function(b){return a.apply(this,arguments)}}())}function c(a){return d("WAWebModelStorageUtils").getStorage().lock(["newsletter-reactions"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=a.parentMsgKey;c=(yield h(c));if(c)yield b.bulkCreateOrReplace([c]);else{c=babelHelpers["extends"]({emojiCountMap:new Map(),serverTimestamp:0},a);yield b.createOrReplace(c)}});return function(a){return c.apply(this,arguments)}}())}function e(a){return d("WAWebSchemaNewsletterReactions").getTable().remove(a)}function f(a){return d("WAWebSchemaNewsletterReactions").getTable().bulkRemove(a)}function h(a){return d("WAWebSchemaNewsletterReactions").getTable().get(a)}g.createOrUpdateNewsletterReactions=a;g.createOrUpdateNewsletterReaction=c;g.removeNewsletterReactionsForParentMsg=e;g.bulkRemoveNewsletterReactionsForParentMsg=f;g.getNewsletterReaction=h}),98);
__d("WAWebNewsletterDeleteMessageAddOns",["Promise","WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSchemaMessage","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=[function(a){return d("WAWebdbCRUDOperationsNewsletterReaction").bulkRemoveNewsletterReactionsForParentMsg(a.map(function(a){return a}))}];function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterMessageAddOns",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var c=a.toString();c=(yield d("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["internalId"],[c]));var e=c.map(function(a){return a.id});yield (h||(h=b("Promise"))).all(i.map(function(a){return a(e)}))}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.deleteNewsletterMessageAddOns=a}),98);
__d("WAWebNewsletterDeleteChatJob",["Promise","WALogger","WAWebChatDeleteBridge","WAWebNewsletterDeleteMessageAddOns","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterChat",function(){if(!a.isNewsletter()){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[deleteNewsletterChat][job] Trying to delete a non-newsletter chat"]))).tags("newsletter").devConsole(a).sendLogs("delete-non-newsletter-chat");return(i||(i=b("Promise"))).resolve()}return d("WAWebChatDeleteBridge").deleteFromStorage(a)}).waitUntilCompleted()}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.map(function(a){return a.toJid()});yield (i||(i=b("Promise"))).all(a.map(function(a){return d("WAWebNewsletterDeleteMessageAddOns").deleteNewsletterMessageAddOns(a)}));yield i.all(a.map(function(a){return d("WAWebChatDeleteBridge").deleteFromStorage(a)}));yield d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().bulkRemove(c)});return j.apply(this,arguments)}g.deleteNewsletterChat=a;g.bulkDeleteNewsletterChats=c}),98);
__d("WAWebNewsletterGetAdminCapabilitiesJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterAdminCapabilitiesJob","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterAdminCapabilities",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{return d("WAWebMexFetchNewsletterAdminCapabilitiesJob").mexFetchNewsletterAdminCapabilities(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[NEWSLETTER][getNewsletterAdminCapabilities] Fetching admin capabilities failed, returning default value of empty array"]))).devConsole({e:a});return new Set()}}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getNewsletterAdminCapabilities=a}),98);
__d("WAWebMexFetchNewsletterAdminCountJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"}],b=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"}],c={alias:null,args:null,kind:"ScalarField",name:"admin_count",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchNewsletterAdminCountJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchNewsletterAdminCountJobQuery",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdmin",kind:"LinkedField",name:"xwa2_newsletter_admin",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"29186079397702825",metadata:{},name:"WAWebMexFetchNewsletterAdminCountJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchNewsletterAdminCountJob",["WALogger","WAWebMexClient","WAWebMexFetchNewsletterAdminCountJobQuery.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=h!==void 0?h:h=b("WAWebMexFetchNewsletterAdminCountJobQuery.graphql");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={newsletter_id:a};b=(yield d("WAWebMexClient").fetchQuery(j,b));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched admin count"]))).tags("GQL","MEX").devConsole({newsletterJid:a,response:b});return(a=b.xwa2_newsletter_admin)==null?void 0:a.admin_count});return k.apply(this,arguments)}g.mexFetchNewsletterAdminCount=a}),98);
__d("WAWebNewsletterGetAdminCountJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchNewsletterAdminCountJob","WAWebNewsletterModelUtils","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterAdminCount",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield d("WAWebMexFetchNewsletterAdminCountJob").mexFetchNewsletterAdminCount(a));return b!=null?b:d("WAWebNewsletterModelUtils").DEFAULT_NEWSLETTER_ADMIN_COUNT}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[NEWSLETTER][getNewsletterAdminCount] Fetching admin count failed, returning default value of 0"]))).devConsole({e:a});return d("WAWebNewsletterModelUtils").DEFAULT_NEWSLETTER_ADMIN_COUNT}}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getNewsletterAdminCount=a}),98);
__d("WAWebNewsletterGetMessageUpdatesQuery",["Promise","WANullthrows","WASmaxNewslettersGetNewsletterMessageUpdatesRPC","WATimeUtils","WAWebBackendErrors","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return i(a,b)})}function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.since,f=c.count;c=c.cursor;a=(yield d("WASmaxNewslettersGetNewsletterMessageUpdatesRPC").sendGetNewsletterMessageUpdatesRPC({iqTo:a,messageUpdatesCount:f,messageUpdatesSince:e,messageUpdatesBeforeOrAfterMixinMixinGroupArgs:k(c)}));switch(a.name){case"GetNewsletterMessageUpdatesResponseSuccess":f=a.value.messageUpdatesMessagesNewsletterMessageResponsePayloadMixin;return{updates:f.message,timestamp:(e=f.t)!=null?e:d("WATimeUtils").unixTime()};case"GetNewsletterMessageUpdatesResponseServerError":c=a.value.errorIQErrorInternalServerErrorMixin;f=c.code;e=c.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f),e);case"GetNewsletterMessageUpdatesResponseClientError":c=a.value.getNewsletterMessageUpdatesClientErrors;switch(c.name){case"ItemNotFoundIQErrorResponse":f=c.value.errorIQErrorItemNotFoundMixin;e=f.code;a=f.text;return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a));case"RateLimitedIQErrorResponse":f=c.value.errorIQErrorRateOverlimitMixin;e=f.code;a=f.text;return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a));case"BadRequestIQErrorResponse":f=c.value.errorIQErrorBadRequestMixin;e=f.code;a=f.text;return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a));case"SuspendedIQErrorResponse":f=c.value.errorIQErrorLockedMixin;e=f.code;a=f.text;return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a));case"UnavailableForLegalReasonsResponse":f=c.value.errorIQErrorUnavailableForLegalReasonsGenericMixin;e=f.code;a=f.text;return(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(e),a))}}});return j.apply(this,arguments)}function k(a){return a.after!=null?{messageUpdatesAfterMixin:{messageUpdatesAfter:a.after}}:{messageUpdatesBeforeMixin:{messageUpdatesBefore:c("WANullthrows")(a.before)}}}g.getNewsletterMessageUpdatesQuery=a}),98);
__d("WAWebNewsletterGetMessageUpdatesJob",["WAJobOrchestratorTypes","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterGetMessageUpdatesQuery","WAWebOrchestratorNonPersistedJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["ids"];function a(a,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMessageUpdates",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=c.ids,e=babelHelpers.objectWithoutPropertiesLoose(c,h);e=(yield d("WAWebNewsletterGetMessageUpdatesQuery").getNewsletterMessageUpdatesQuery(a,e));var f=e.updates;e=e.timestamp;f=(yield d("WAWebNewsletterBackendAddOnsUtils").getMsgsAndAddOnsFromUpdates(f,d("WAWebWidFactory").createWid(a),e));yield d("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(babelHelpers["extends"]({},f,{ids:b,timestamp:e}));return babelHelpers["extends"]({},f,{timestamp:e,ids:b})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getNewsletterMessageUpdates=a}),98);
__d("WAWebNewsletterGetMessagesQueryJob",["Promise","WALogger","WASmaxNewslettersGetNewsletterMessagesRPC","WATimeUtils","WAWebBackendErrors","WAWebNewsletterGatingUtils","WAWebNewsletterQueryUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){if((a==null?void 0:a.before)!=null)return{beforeMixin:{messagesBefore:a.before}};return(a==null?void 0:a.after)!=null?{afterMixin:{messagesAfter:a.after}}:void 0}function a(a,b,c){a=d("WAWebNewsletterQueryUtils").getNewsletterMessagesQueryParams(a);return k(a,b,c)}function c(a){var b=a.inviteCode,c=a.messagesCount,e=a.cursor;a=a.qpl;b=d("WAWebNewsletterQueryUtils").getNewsletterMessagesQueryParams(b);return k(b,c,e,a)}function k(a,b,c,d){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){e=j(e);c>d("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[queryNewsletterMessages] "," messages requested"])),c).tags("newsletter").sendLogs("newsletter-server-msg-count-exceeded");f==null||f.markFetchStart();a=(yield d("WASmaxNewslettersGetNewsletterMessagesRPC").sendGetNewsletterMessagesRPC({queryNewsletterParamsMixinArgs:{queryNewsletterParamsArgs:a},newsletterMessageRequestPayloadMixinArgs:{messagesCount:Math.min(c,d("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()),messageDirectionsArgs:e}}));f==null||f.markFetchEnd();switch(a.name){case"GetNewsletterMessagesResponseSuccess":e=a.value.messagesNewsletterMessageResponsePayloadMixin;f=e.message;e=e.t;return{messages:f,end:f.length<c,timestamp:e!=null?e:d("WATimeUtils").unixTime()};case"GetNewsletterMessagesResponseClientError":f=a.value.getNewsletterMessagesClientErrors;switch(f.name){case"ItemNotFoundIQErrorResponse":c=f.value.errorIQErrorItemNotFoundMixin;e=c.text;c=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c,e);case"RateLimitedIQErrorResponse":c=f.value.errorIQErrorRateOverlimitMixin;e=c.text;c=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c,e);case"BadRequestIQErrorResponse":c=f.value.errorIQErrorBadRequestMixin;e=c.text;c=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c,e);case"SuspendedIQErrorResponse":c=f.value.errorIQErrorLockedMixin;e=c.text;c=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c,e);case"UnavailableForLegalReasonsResponse":c=f.value.errorIQErrorUnavailableForLegalReasonsGenericMixin;e=c.text;c=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c,e);case"NotAllowedIQErrorResponse":c=f.value.errorIQErrorNotAllowedMixin;e=c.text;f=c.code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(f,e)}break;case"GetNewsletterMessagesResponseServerError":c=a.value.errorIQErrorInternalServerErrorMixin;f=c.code;e=c.text;return(i||(i=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f),e))}});return l.apply(this,arguments)}g.queryNewsletterMessagesByJid=a;g.queryNewsletterMessagesByInviteCode=c}),98);
__d("WAWebNewsletterGetMessagesJob",["WAJobOrchestratorTypes","WATimeUtils","WAWebJidToWid","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterGetMessagesQueryJob","WAWebNewsletterValidationUtils","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c,e){d("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(a);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMessages",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebNewsletterGetMessagesQueryJob").queryNewsletterMessagesByJid(a,c,e)),f=d("WAWebJidToWid").jidWithTypeToWid({jidType:"newsletter",newsletterJid:a});f=(yield d("WAWebNewsletterBackendAddOnsUtils").getMsgsAndAddOnsFromUpdates(b.messages,f,b.timestamp));return babelHelpers["extends"]({},f,{timestamp:d("WATimeUtils").castToUnixTime(b.timestamp)})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getNewsletterMessages=a}),98);
__d("WAWebMexFetchAllNewslettersMetadataJobQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"fetch_wamo_sub"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},d=[b,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],e=[b,c,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}];b=[{alias:null,args:null,concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_subscribed",plural:!0,selections:[b,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[c],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:d,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:d,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterWamoSubMetadata",kind:"LinkedField",name:"wamo_sub",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"plan_id",storageKey:null}],storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterViewerMetadata",kind:"LinkedField",name:"viewer_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{condition:"fetch_wamo_sub",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"wamo_sub_status",storageKey:null}]}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexFetchAllNewslettersMetadataJobQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexFetchAllNewslettersMetadataJobQuery",selections:b},params:{id:"10041060382573821",metadata:{},name:"WAWebMexFetchAllNewslettersMetadataJobQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexFetchAllNewslettersMetadataJob",["WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchAllNewslettersMetadataJobQuery.graphql","WAWebMexNewsletterParseUtils","WAWebNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=h!==void 0?h:h=b("WAWebMexFetchAllNewslettersMetadataJobQuery.graphql");c=(yield d("WAWebMexClient").fetchQuery(c,{fetch_wamo_sub:(a==null?void 0:a.fetchWamoSub)===!0}));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] fetched all newsletters job"]))).tags("GQL","MEX").devConsole({response:c});return c});return k.apply(this,arguments)}function a(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield j({fetchWamoSub:d("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()})),b=a==null?void 0:a.xwa2_newsletter_subscribed;if(a==null||b==null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(500,"Mex unexpected null response for fetching all metadata");if(b.length===0)return{newsletters:[]};var c=[],e=[];b.filter(function(a){return a!=null}).map(function(a){var b=d("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(a);if(b!=null){var f;(a==null||(f=a.state)==null?void 0:f.type)==="DELETED"?b!=null&&e.push({jid:b.idJid}):c.push(b)}});return c.length>0||e.length>0?{newsletters:c,deletedNewsletters:e.length>0?{id:e}:null}:{newsletters:[]}});return l.apply(this,arguments)}g.mexFetchAllNewsletters=j;g.handleMexGetAllNewsletters=a}),98);
__d("WAWebMexUpdateNewsletterJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"},{defaultValue:null,kind:"LocalArgument",name:"updates"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},d=[b,{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"update_time",storageKey:null}],e=[b,c,{alias:null,args:null,kind:"ScalarField",name:"direct_path",storageKey:null}];b=[{alias:null,args:[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"},{kind:"Variable",name:"updates",variableName:"updates"}],concreteType:"XWA2Newsletter",kind:"LinkedField",name:"xwa2_newsletter_update",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[c],storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadMetadata",kind:"LinkedField",name:"thread_metadata",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterName",kind:"LinkedField",name:"name",plural:!1,selections:d,storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterDescription",kind:"LinkedField",name:"description",plural:!1,selections:d,storageKey:null},{alias:null,args:[{kind:"Literal",name:"type",value:"IMAGE"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"IMAGE")'},{alias:"preview",args:[{kind:"Literal",name:"type",value:"PREVIEW"}],concreteType:"XWA2Picture",kind:"LinkedField",name:"picture",plural:!1,selections:e,storageKey:'picture(type:"PREVIEW")'},{alias:null,args:null,kind:"ScalarField",name:"invite",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"verification",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creation_time",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterThreadSettings",kind:"LinkedField",name:"settings",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2NewsletterReactionCodesSetting",kind:"LinkedField",name:"reaction_codes",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexUpdateNewsletterJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexUpdateNewsletterJobMutation",selections:b},params:{id:"24250201037901610",metadata:{},name:"WAWebMexUpdateNewsletterJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexUpdateNewsletterJob",["WALogger","WAWebMexClient","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c,d,e){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var j=h!==void 0?h:h=b("WAWebMexUpdateNewsletterJobMutation.graphql");a={newsletter_id:a,updates:{name:c,description:e,picture:f,settings:g!=null?{reaction_codes:{value:d("WAWebMexNewsletterUtils").mapReactionCodesSettingToMexInput(g)}}:null}};c=(yield d("WAWebMexClient").fetchQuery(j,a));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] newsletter updated via mex"]))).tags("GQL","MEX").devConsole({response:c});return c});return j.apply(this,arguments)}g.mexUpdateNewsletter=a}),98);
__d("WAWebNewsletterMetadataQueryJob",["WABase64","WAWebMexFetchAllNewslettersMetadataJob","WAWebMexNewsletterParseUtils","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterJob","WAWebNewsletterQueryUtils","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){var a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebMexFetchAllNewslettersMetadataJob").handleMexGetAllNewsletters()});return function(){return a.apply(this,arguments)}}();return d("WAWebNewsletterRpcUtils").runWithBackoff(a)}function c(a,b){var c=d("WAWebNewsletterQueryUtils").getNewsletterMetadataQueryParamArgs(a,b,{creationTime:!0,name:!0,picture:!0,description:!0,inviteLink:!0,handle:!0,subscribers:!0,privacy:!0,verification:!0,linkedAccounts:!0,state:!0});return d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return h(c)})}function e(a,b,c){var e=d("WAWebNewsletterQueryUtils").getNewsletterMetadataQueryParamArgs(a,b,c);return d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return h(e)})}function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebMexNewsletterUtils").handleMexGetNewsletter(a)});return i.apply(this,arguments)}function f(a,b,c){return k(a,b,c)}function j(a){return{idJid:a,newsletterMutedMetadataMixin:null,newsletterCreationTimeMetadataMixin:null,newsletterNameMetadataMixin:null,newsletterPictureMetadataMixin:null,newsletterDescriptionMetadataMixin:null,newsletterInviteLinkMetadataMixin:null,newsletterSubscribersMetadataMixin:null,newsletterPrivacyMetadataMixin:null,newsletterVerificationMetadataMixin:null,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterMembershipMetadataMixin:null,newsletterStateMetadataMixin:null}}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.editName,f=b.editDescription,g=b.editPicture;b=b.editReactionCodesSetting;var h=c.name,i=c.description,j=c.picture;c=c.reactionCodesSetting;var k;j!=null&&(k=d("WABase64").encodeB64(j));var l=m(g,k),n=m(e,h),o=m(f,i),p=b===!0?c:null;j=(yield d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return d("WAWebMexUpdateNewsletterJob").mexUpdateNewsletter(a,n,o,l,p)}));return d("WAWebMexNewsletterParseUtils").parseMexNewsletterResponse(j.xwa2_newsletter_update)});return l.apply(this,arguments)}function m(a,b){if(a===!0)return b!=null?b:""}g.queryAllNewslettersMetadata=a;g.queryNewsletterMetadataByInviteCode=c;g.queryNewsletterMetadataByJid=e;g.editNewsletterMetadataQuery=f;g.emptyNewsletterMetadataType=j}),98);
__d("WAWebNewsletterMetadataJob",["Promise","WAJobOrchestratorTypes","WAWebNewsletterCreateJob","WAWebNewsletterMetadataQueryJob","WAWebOrchestratorNonPersistedJob","WAWebSchemaNewsletterMetadata","WAWebSchemaProfilePicThumb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["id"],i;function a(){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getAllNewslettersMetadata",function(){return d("WAWebNewsletterMetadataQueryJob").queryAllNewslettersMetadata()},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(a,b,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getNewsletterMetadata",function(){return d("WAWebNewsletterMetadataQueryJob").queryNewsletterMetadataByJid(a,b,c)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function e(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMetadata",function(){return Array.isArray(a)?d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().bulkCreateOrMerge(a):d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().createOrMerge(a.id,a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function f(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterMetadata",function(){return d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().remove(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function j(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteNewsletterPicture",function(){return d("WAWebSchemaProfilePicThumb").getProfilePicThumbTable().remove(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function k(a,b,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("editNewsletterMetadata",function(){var e=c.picture;e=d("WAWebNewsletterCreateJob").encodePicture(e);return d("WAWebNewsletterMetadataQueryJob").editNewsletterMetadataQuery(a,b,babelHelpers["extends"]({},c,{picture:e}))},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function l(a,c,e,f){f===void 0&&(f=d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMessageDeliveryUpdates",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var f=(yield d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(a));if(f==null)return(i||(i=b("Promise"))).resolve();var g=f.messageDeliveryUpdates,j=g===void 0?new Map():g;e.forEach(function(a){j==null||j["delete"](a)});c.forEach(function(a){var b=a.id;a=babelHelpers.objectWithoutPropertiesLoose(a,h);j==null||j.set(b,a)});f.messageDeliveryUpdates=j;return d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(a,f)}),{priority:f}).waitUntilCompleted()}function m(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("suspendNewsletter",function(){return d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(a,{id:a,suspended:!0})},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function n(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("geosuspendNewsletter",function(){return d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().merge(a,{id:a,suspended:!0,geosuspended:!0})},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getAllNewslettersMetadata=a;g.getNewsletterMetadata=c;g.updateNewsletterMetadata=e;g.deleteNewsletterMetadata=f;g.deleteNewsletterPicture=j;g.editNewsletterMetadata=k;g.updateNewsletterMessageDeliveryUpdates=l;g.suspendNewsletter=m;g.geosuspendNewsletter=n}),98);
__d("WAWebNewsletterSendMessageQueryJob",["WASmaxMessagePublishNewsletterRPC","WAStanzaUtils","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(a.newsletterJid);a={messageTo:a.newsletterJid,clientNewsletterAndServerOrNewsletterIDMixinGroupArgs:i(a)};a=(yield d("WASmaxMessagePublishNewsletterRPC").sendNewsletterRPC(a));switch(a.name){case"NewsletterResponseSuccess":return{success:!0,ack:{t:a.value.newsletterQuestionResponseOrNewsletterMessageAckMixinGroup.value.t},serverId:a.value.newsletterQuestionResponseOrNewsletterMessageAckMixinGroup.value.serverId};case"NewsletterResponseNegative":return{success:!1,ack:{t:a.value.t,error:a.value.error}}}});return h.apply(this,arguments)}function i(a){switch(a.type){case"reaction":return j(a);case"pollVote":return k(a);case"newsletterQuestionResponse":return l(a);default:return{newsletterClientID:m(a)}}}function j(a){var b=a.reactionCode;b=b!=null&&b!==""?{newsletterReaction:{reactionCode:b}}:{isNewsletterReactionRevoke:!0};return{newsletterClientAndServerID:{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),messageServerId:a.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:b}}}function k(a){var b={voteArgs:a.votes.map(function(a){return{voteElementValue:a}})};return{newsletterClientAndServerID:{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),messageServerId:a.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:{newsletterPollVote:b}}}}function l(a){return{newsletterClientAndServerID:{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),messageServerId:a.parentMsgServerId,newsletterQuestionResponsePublishOrReactionOrReactionRevokeOrPollVoteMixinGroupArgs:{newsletterQuestionResponsePublish:{payloadMixinArgs:{plaintextElementValue:a.payload}}}}}}function m(a){switch(a.type){case"editText":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:{newsletterEdit:{hasWAMOSub:a.isWamoSub,newsletterQuestionReplyOrTextOrMediaMixinGroupArgs:{newsletterText:{payloadMixinArgs:{plaintextElementValue:a.payload}}}}}};case"editMedia":var b=a.contentId==null?null:{senderContentTypeMediaRCATMixinArgs:{plaintextContentId:a.contentId}};return babelHelpers["extends"]({messageId:d("WAStanzaUtils").toStanzaId(a.messageId)},b,{newsletterClientIdContentArgs:{newsletterEdit:{hasWAMOSub:a.isWamoSub,newsletterQuestionReplyOrTextOrMediaMixinGroupArgs:{newsletterMedia:{payloadMixinArgs:{plaintextElementValue:a.payload},plaintextMediatype:a.mediaType}}}}});case"revoke":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:{newsletterRevoke:{hasWAMOSub:a.isWamoSub}}};case"pollCreation":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:{newsletterPollCreation:{payloadMixinArgs:{plaintextElementValue:a.payload},hasWAMOSub:a.isWamoSub,metaContenttype:a.contentType}}};case"pollResultSnapshot":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:{newsletterPollResultSnapshot:{payloadMixinArgs:{plaintextElementValue:a.payload},hasWAMOSub:a.isWamoSub}}};case"text":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:babelHelpers["extends"]({},n({newsletterText:{payloadMixinArgs:{plaintextElementValue:a.payload},hasWAMOSub:a.isWamoSub}},a.isQuestion,a.questionReplyQuotedMessage))};case"url":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),senderContentTypeMediaRCATMixinArgs:{plaintextContentId:a.contentId},newsletterClientIdContentArgs:babelHelpers["extends"]({},n({newsletterMediaPublish:{plaintextMediatype:a.type,payloadMixinArgs:{plaintextElementValue:a.payload},messageMediaId:a.mediaHandle,hasWAMOSub:a.isWamoSub,messageAssociationTypeMixinArgs:a.messageAssociationTypeMixinArgs}},a.isQuestion,a.questionReplyQuotedMessage))};case"audio":case"avatar_sticker":case"document":case"gif":case"image":case"ptt":case"sticker":case"sticker_pack":case"vcard":case"video":return{messageId:d("WAStanzaUtils").toStanzaId(a.messageId),newsletterClientIdContentArgs:babelHelpers["extends"]({},n({newsletterMediaPublish:{plaintextMediatype:a.type,payloadMixinArgs:{plaintextElementValue:a.payload},messageMediaId:a.mediaHandle,hasWAMOSub:a.isWamoSub,messageAssociationTypeMixinArgs:a.messageAssociationTypeMixinArgs}},a.isQuestion,a.questionReplyQuotedMessage))};default:a.type;throw c("err")("Wrong code path for "+a.type)}}function n(a,b,d){if(b)return{newsletterQuestionPublish:{newsletterTextOrMediaPublishMixinGroupArgs:a}};if(d){if(((b=d.quotedResponse.questionResponseInfo)==null?void 0:b.responseServerId)==null)throw c("err")("Missing response server id for question reply");return{newsletterQuestionReplyPublish:{metaParentServerId:d.questionServerId,metaResponseServerId:(b=d.quotedResponse.questionResponseInfo)==null?void 0:b.responseServerId,newsletterTextOrMediaPublishMixinGroupArgs:a}}}return a}g.querySendNewsletterMessage=a}),98);
__d("WAWebNewsletterSendMessageJob",["Promise","WAJobOrchestratorTypes","WALogger","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebMessageAssociation.flow","WAWebNewsletterSendMessageQueryJob","WAWebNewsletterValidationUtils","WAWebOrchestratorNonPersistedJob","WAWebOutgoingMessage","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebSendMsgTypes","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendNewsletterMessage",function(){return m(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function l(a,b){var c=a.type,e=a.msg,f={messageId:e.id.id,newsletterJid:a.newsletterJid,payload:d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,b).readByteArrayView(),isWamoSub:e.isWamoSub===!0||void 0};if(c==="pollCreation")return babelHelpers["extends"]({},f,{type:"pollCreation",contentType:(e==null?void 0:e.pollContentType)===d("WAWebPollCreationUtils").PollContentType.IMAGE?"image":"text"});f=babelHelpers["extends"]({},f,{isQuestion:e.isQuestion,questionReplyQuotedMessage:e.questionReplyQuotedMessage});return c==="media"?babelHelpers["extends"]({},f,{mediaHandle:a.mediaHandle,type:o(b),messageAssociationTypeMixinArgs:n(e),contentId:a.contentId}):babelHelpers["extends"]({},f,{type:c})}function m(a){d("WAWebNewsletterValidationUtils").validateNewsletterJidOrThrow(a.newsletterJid);switch(a.type){case"edit":var e=d("WAWebOutgoingMessage").createOutgoingMsgModelProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,a.msg),f=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,e),g=a.msg.isWamoSub===!0||void 0;f={messageId:a.msg.id.id,newsletterJid:a.newsletterJid,payload:f.readByteArrayView(),isWamoSub:g};g=a.editType==="media"?babelHelpers["extends"]({},f,{type:"editMedia",mediaType:o(e),contentId:a.contentId}):babelHelpers["extends"]({},f,{type:"editText"});return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage(g);case"pollCreation":case"pollResultSnapshot":case"text":case"media":e=d("WAWebOutgoingMessage").createOutgoingMsgModelProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,a.msg);f=l(a,e);return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage(f);case"revoke":return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({messageId:a.messageId,newsletterJid:a.newsletterJid,type:"revoke",isContentMedia:a.isContentMedia,isWamoSub:a.isWamoSub===!0||void 0});case"reaction":return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({type:"reaction",newsletterJid:a.newsletterJid,reactionCode:a.reactionCode,messageId:a.msg.id.id,parentMsgServerId:a.parentMsgServerId});case"pollVote":return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({type:"pollVote",newsletterJid:a.newsletterJid,votes:a.votes,messageId:a.msg.id.id,parentMsgServerId:a.parentMsgServerId});case"newsletterQuestionResponse":g=d("WAWebOutgoingMessage").createOutgoingMessageProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Newsletter,{type:d("WAWebSendMsgTypes").SendMessageRecordType.Addon,data:a.msg});return d("WAWebNewsletterSendMessageQueryJob").querySendNewsletterMessage({messageId:a.msg.id.id,newsletterJid:a.newsletterJid,payload:d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,g).readByteArrayView(),type:"newsletterQuestionResponse",parentMsgServerId:a.parentMsgServerId});default:a.type;return(k||(k=b("Promise"))).reject(c("err")("Unexpected message type: "+a.type))}}function n(a){var b=a.associationType;if(b==null)return null;switch(b){case d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL:return{metaMessageAssociationType:"media_poll"};case d("WAWebMessageAssociation.flow").MessageAssociationType.BOT_PLUGIN:case d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM:case d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Unexpected newsletter message association type: ",""])),b).tags("newsletter").devConsole(a).sendLogs("newsletter-message-association-type-"+b);return null}}function o(a){var b=d("WAWebBackendJobsCommon").mediaTypeFromProtobuf(a);if(b==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to get media type from protobuf"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-media-type-from-protobuf");throw c("err")("Failed to get media type from protobuf")}switch(b){case d("WAWebBackendJobs.flow").EncMediaType.Audio:return"audio";case d("WAWebBackendJobs.flow").EncMediaType.Document:return"document";case d("WAWebBackendJobs.flow").EncMediaType.Gif:return"gif";case d("WAWebBackendJobs.flow").EncMediaType.Image:return"image";case d("WAWebBackendJobs.flow").EncMediaType.Ptt:return"ptt";case d("WAWebBackendJobs.flow").EncMediaType.Sticker:return"sticker";case d("WAWebBackendJobs.flow").EncMediaType.Url:return"url";case d("WAWebBackendJobs.flow").EncMediaType.VCard:return"vcard";case d("WAWebBackendJobs.flow").EncMediaType.Video:return"video";case d("WAWebBackendJobs.flow").EncMediaType.StickerPack:return"sticker_pack";default:d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Unsupported media type"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-unsupported-media-type-"+b);throw c("err")("Unsupported media type "+b)}}g.sendNewsletterMessageJob=a;g.sendNewsletterMessage=m}),98);
__d("WAWebMexUpdateNewsletterUserSettingJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2NewsletterMutationResponse",kind:"LinkedField",name:"xwa2_newsletter_update_user_setting",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"XWA2NewsletterState",kind:"LinkedField",name:"state",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexUpdateNewsletterUserSettingJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexUpdateNewsletterUserSettingJobMutation",selections:b},params:{id:"31938993655691868",metadata:{},name:"WAWebMexUpdateNewsletterUserSettingJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexUpdateNewsletterUserSetting",["WALogger","WAWebMexClient","WAWebMexNewsletterUtils","WAWebMexUpdateNewsletterUserSettingJobMutation.graphql","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=h!==void 0?h:h=b("WAWebMexUpdateNewsletterUserSettingJobMutation.graphql");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];return m({newsletter_id:a,type:"MUTE_ADMIN_ACTIVITY",value:"ON"})});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];return m({newsletter_id:a,type:"MUTE_ADMIN_ACTIVITY",value:"OFF"})});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return o(a)}));b=d("WAWebMexNewsletterUtils").convertMutationResponse(b.xwa2_newsletter_update_user_setting);return[b]});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a={input:a};a=(yield d("WAWebMexClient").fetchQuery(j,a));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] update newsletter notification settings via mex"]))).tags("GQL","MEX").devConsole({response:a});return a});return p.apply(this,arguments)}g.mexMuteNewsletterAdminNotifications=a;g.mexUnmuteNewsletterAdminNotifications=c}),98);
__d("WAWebNewsletterToggleMuteStateJob",["WAJobOrchestratorTypes","WALogger","WAWebMexUpdateNewsletterUserSetting","WAWebMiscErrors","WAWebNewsletterModelUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("muteNewsletter",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield j({newsletterJids:a,muteStateMexFunction:d("WAWebMexUpdateNewsletterUserSetting").mexMuteNewsletterAdminNotifications,muteExpirationValue:d("WAWebNewsletterModelUtils").MUTED_STATE})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("unmuteNewsletter",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield j({newsletterJids:a,muteStateMexFunction:d("WAWebMexUpdateNewsletterUserSetting").mexUnmuteNewsletterAdminNotifications,muteExpirationValue:d("WAWebNewsletterModelUtils").UNMUTED_STATE})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.newsletterJids,c=a.muteStateMexFunction,e=a.muteExpirationValue;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["newsletter setMuteState"])));a=e===d("WAWebNewsletterModelUtils").MUTED_STATE?"mute":"unmute";c=(yield c(b));b=c.filter(function(a){return a.subscriberNotFoundMixin==null}).map(function(a){return a.jid});try{return yield d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(b.map(function(a){return{id:a,muteExpiration:e}}))}catch(b){b instanceof d("WAWebMiscErrors").DbOnLogoutAbort||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][","Newsletter] Failed to persist the mutation on db"])),a).tags("newsletter").devConsole(b).sendLogs("newsletter-"+a+"-db-fail");throw b}});return k.apply(this,arguments)}g.muteNewsletter=a;g.unmuteNewsletter=c}),98);
__d("WAWebNewsletterUpdateMsgsRecordsJob",["Promise","WAJobOrchestratorTypes","WALogger","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebFrontendMsgGetters","WAWebMessageProcessorCache","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebOrchestratorNonPersistedJob","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k(a).waitUntilCompleted()}function k(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("addNewsletterMsgsRecords",function(){return a.length===0?(j||(j=b("Promise"))).resolve():d("WAWebMessageProcessorCache").messageProcessorCache.addMessages(a.map(function(a){return{msg:a}}),!0)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION})}function c(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateNewsletterMsgRecord",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebMsgGetters").getIsNewsletterMsg(a)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMsgRecord] Called on a non-newsletter msg"]))).devConsole(a.id);return}if((yield d("WAWebSchemaMessage").getMessageTable().get(a.id.toString()))==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMsgRecord] Msg not found, skipping"]))).devConsole(a.id);return}var b=a.serverId,c=d("WAWebFrontendMsgGetters").getChat(a),e=l(d("WAWebMsgDataFromModel").msgDataFromMsgModel(a));e=d("WAWebDBMessageSerialization").dbRowFromMessage(e);b!=null&&(e.internalId=d("WAWebDBMessageUtils").craftInternalId(c.id.toJid(),b));yield d("WAWebSchemaMessage").getMessageTable().merge(a.id.toString(),e)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function l(a){delete a.serverId;delete a.rowId;delete a.messageRangeIndex;return a}g.addNewsletterMsgsRecords=a;g.addNewsletterMsgsRecordsJob=k;g.updateNewsletterMsgRecord=c}),98);
__d("WAWebCRUDOperationsNewsletterPollsVotes",["WAWebModelStorageUtils","WAWebSchemaNewsletterPollsVotes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["newsletter-polls-votes"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];b;var c=new Map(a.map(function(a){return[a.parentMsgKey,a]})),d=(yield b.bulkGet(a.map(function(a){return a.parentMsgKey}))).filter(Boolean);d.forEach(function(a){var b=c.get(a.parentMsgKey);b!=null&&b.serverTimestamp<a.serverTimestamp&&c["delete"](a.parentMsgKey)});yield b.bulkCreateOrReplace(Array.from(c.values()))});return function(a){return c.apply(this,arguments)}}())}function c(a){return d("WAWebSchemaNewsletterPollsVotes").getTable().bulkRemove(a)}function e(a){return d("WAWebSchemaNewsletterPollsVotes").getTable().get(a)}g.bulkCreateOrUpdateVotes=a;g.bulkDeleteVotes=c;g.getVote=e}),98);
__d("WAWebNewsletterMapMsgAndAddOns",["Promise","WAWebBackendApi","WAWebNewsletterBackendMsgUtils","WAWebNewsletterDBUtils","WAWebPollOptionHashUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=(yield d("WAWebBackendApi").frontendSendAndReceive("findMsgKeyFromServerId",{from:a,serverId:c}));if(e!=null)return(h||(h=b("Promise"))).resolve(e);e=(yield d("WAWebNewsletterDBUtils").getMessageByServerId(c,a.toJid()));return e==null?void 0:e.id});return j.apply(this,arguments)}function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e,f,g,h;e=(e=a.newsletterReactionsMixin)==null?void 0:e.reactionsReaction;f=(f=a.newsletterPollVotesMixin)==null?void 0:f.votesVote;g=d("WAWebNewsletterBackendMsgUtils").mapNewsletterMsgToMsgData(a,b,((g=e==null?void 0:e.length)!=null?g:0)>0,c);h=(h=g==null?void 0:g.id)!=null?h:yield i(b,a.serverId);b=(b=a.newsletterViewsCountMixin)==null?void 0:b.viewsCountCount;a=(a=(a=a.newsletterResponsesCountMixin)==null?void 0:a.responsesCountCount)!=null?a:0;return{msgData:g,reactionData:l(e,h,c),pollVoteData:m(f,h,c),id:h,viewCount:b,questionResponsesCount:a}});return k.apply(this,arguments)}function l(a,b,c){return b!=null&&a!=null&&a.length>0?{parentMsgKey:b,serverTimestamp:c,emojiCountMap:a.reduce(function(a,b){return a.set(b.code,b.count)},new Map())}:null}function m(a,b,c){return b==null||a==null||a.length===0?null:{parentMsgKey:b,serverTimestamp:c,voteCountMap:a.reduce(function(a,b){return a.set(d("WAWebPollOptionHashUtils").bufferToHex(b.elementValue),b.count)},new Map())}}g.mapMsgAndAddOns=a}),98);
__d("WAWebNewsletterPollsUtils",["WATimeUtils","WAWebNewsletterGatingUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c){var e,f,g=new Map();e=Array.from((e=a==null||(f=a.pollVotesCountMap)==null?void 0:f.values())!=null?e:[]);var i=e.reduce(function(a,b){return a+b},0);e=Math.max.apply(Math,e);var j=a==null?void 0:a.pollVotersMap;for(b of b){var k,l,m,n=Boolean(a==null||(k=a.myVote)==null?void 0:k.has(b.localId));l=Math.max((l=a==null||(m=a.pollVotesCountMap)==null?void 0:m.get(b.localId))!=null?l:0,n?1:0);var o=j==null?void 0:j.get(b.localId),p=n?h(c,a==null?void 0:a.myVoteTs):null;p=(p!=null?[p]:[]).concat((p=o==null?void 0:o.contacts)!=null?p:[]);g.set(b,{isVotedForByMe:n,isCurrentLeader:e>0&&l===e,percentageOfAll:i===0?0:l/i,percentageOfMostVotedForOption:e===0?0:l/e,votes:d("WAWebNewsletterGatingUtils").isNewsletterPollsVotersEnabled()?p.concat((n=o==null?void 0:o.others)!=null?n:[]):[],count:l,mode:"newsletter",contactVoters:p,otherVoters:(n=o==null?void 0:o.others)!=null?n:[]})}return g}function b(a){return{parentMsgKey:a.parentMsgKey.toString(),serverTimestamp:a.serverTimestamp,votesMap:a.voteCountMap}}function h(a,b){return a==null?null:{contact:a,id:a.id,time:(a=d("WATimeUtils").castMillisTimeToUnixTime(b))!=null?a:d("WATimeUtils").unixTime()}}g.aggregateNewsletterVotes=a;g.mapNewsletterVoteToDbRecord=b}),98);
__d("WAWebNewsletterBackendAddOnsUtils",["Promise","WAWebCRUDOperationsNewsletterPollsVotes","WAWebDBProcessEditProtocolMsgs","WAWebModelStorageUtils","WAWebMsgType","WAWebNewsletterMapMsgAndAddOns","WAWebNewsletterMsgEditUtils","WAWebNewsletterPollsUtils","WAWebNewsletterReactionUtils","WAWebSchemaMessage","WAWebStoreMsgs","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.msgs,e=a.reactions,f=a.reactionIdsToRemove,g=a.timestamp,h=a.ids,i=a.viewCounts,j=a.pollVotes,k=a.questionResponsesCounts;e.length>0&&(yield d("WAWebdbCRUDOperationsNewsletterReaction").createOrUpdateNewsletterReactions(e.map(d("WAWebNewsletterReactionUtils").mapReactionDataToDbRecord).filter(Boolean)));f.length>0&&(yield d("WAWebdbCRUDOperationsNewsletterReaction").bulkRemoveNewsletterReactionsForParentMsg(f));j.length>0&&(yield d("WAWebCRUDOperationsNewsletterPollsVotes").bulkCreateOrUpdateVotes(j.map(d("WAWebNewsletterPollsUtils").mapNewsletterVoteToDbRecord)));if(c.length>0){var l=new Map(c.map(function(a){return[a.id.toString(),a]})),m=[],n=[],o=[];a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(c.map(function(a){return a.id.toString()})));a.forEach(function(a){if(a==null)return;var b=l.get(a.id);b!=null&&(b==null?void 0:b.kind)===d("WAWebMsgType").MsgKind.RevokedMessage&&a.type!==d("WAWebMsgType").MSG_TYPE.REVOKED?(n.push(b),o.push(a)):(b==null?void 0:b.t)!=null&&b.t>a.t&&m.push(b)});yield d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(m.map(d("WAWebNewsletterMsgEditUtils").mapMsgToEditProtocolMsgLegacy));yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(o.map(function(a){a=a.id;return a.toString()}));yield d("WAWebStoreMsgs").storeMsgs(n)}h.length>0&&(yield d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.bulkGet(h.map(function(a){return a.toString()})).then(function(a){return a.filter(Boolean)}));b=b.map(function(a){var b,c=a.id,d=a.viewCount;a=a.questionResponsesCount;return{id:c,lastUpdateFromServerTs:g,viewCount:(b=i==null?void 0:i.get(c))!=null?b:d,questionResponsesCount:(b=k==null?void 0:k.get(c))!=null?b:a}});return a.bulkCreateOrMerge(b)});return function(b){return a.apply(this,arguments)}}()))});return i.apply(this,arguments)}function c(a,c,e){return a.reduce(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield a);b=(yield d("WAWebNewsletterMapMsgAndAddOns").mapMsgAndAddOns(b,c,e));if(b==null)return a;var f=b.msgData,g=b.reactionData,h=b.id,i=b.viewCount,j=b.pollVoteData;b=b.questionResponsesCount;h!=null&&(f==null?void 0:f.kind)!==d("WAWebMsgType").MsgKind.RevokedMessage&&a.ids.push(h);f!=null&&a.msgs.push(f);i!=null&&h!=null&&a.viewCounts.set(h.toString(),i);b!=null&&h!=null&&a.questionResponsesCounts.set(h.toString(),b);g==null?h!=null&&a.reactionIdsToRemove.push(h.toString()):a.reactions.push(g);j!=null&&a.pollVotes.push(j);return a});return function(b,c){return a.apply(this,arguments)}}(),(h||(h=b("Promise"))).resolve({ids:[],reactions:[],reactionIdsToRemove:[],msgs:[],viewCounts:new Map(),pollVotes:[],questionResponsesCounts:new Map()}))}g.updateAddOnDbRecords=a;g.getMsgsAndAddOnsFromUpdates=c}),98);
__d("WAWebNewsletterMsgHistoryUtils",["Promise","WALogger","WAWebBackendApi","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterDBUtils","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessagesJob","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function o(a,b){b===void 0&&(b=new Set());var c=[],e=function(){var e=a[g-1].serverId,f=a[g].serverId;if(f==null||e==null)return 0;f=f-e;if(f<=1)return 0;f=Array.from({length:f-1},function(a,b){return b+e+1}).filter(function(a){return a>=d("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID&&!b.has(a)});if(f.length<=0)return 0;while(f.length>0)c.push(f.splice(0,d("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()))},f;for(var g=1;g<a.length;g++){f=e();if(f===0)continue}return c}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.jid,f=a.msgs,g=a.range;a=a.serverIdsToSkip;a=a===void 0?new Set():a;if(f.length<2&&g==null){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Only 1 message for ",""])),e);return f}var p=f[0].serverId,q=f[f.length-1].serverId;if(p==null||q==null)return[];if(p>=d("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND||q>=d("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND)return f;if(q-p+1===f.length&&g==null){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] No gaps to fill for ",", "," - ",""])),e,q,p);return f}d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Looking for gaps for ",", "," - ",""])),e,q,p);if(g!=null){var r=g.start;g=g.end;var s={serverId:Math.min(r,g)-1};r={serverId:Math.max(r,g)+1};g=o([s].concat(f).concat(r),a)}else g=o(f,a);if(g.length===0){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] No gaps identified for ",", "," - ",""])),e,q,p);return f}d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] "," identified for ",""])),g.length,e).devConsole(g);s=g.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebNewsletterGetMessagesJob").getNewsletterMessages(d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(String(e)),a.length,{after:a[0]-1})["catch"](function(){return null}));if(a!=null){d("WAWebBackendApi").frontendFireAndForget("updateNewsletterMessages",a);yield d("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(a);return a.msgs}});return function(b){return a.apply(this,arguments)}}());r=c("lodash").flatten(yield (n||(n=b("Promise"))).all(s)).filter(Boolean);d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecordsJob(r).fireAndForget();d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[fillMsgHistoryGaps] Gaps filled for ",", "," messages retrieved from server"])),e,r.length);return c("lodash").sortBy(f.concat(r),"serverId")});return p.apply(this,arguments)}g.identifyMsgGaps=o;g.fillMsgHistoryGaps=a}),98);
__d("WAWebSuspendInformDataModelUtils",["WALogger","WAWebNewsletterDBUtils","WAWebNewsletterGetMessagesJob","WAWebNewsletterUpdateMsgsRecordsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebNewsletterDBUtils").bulkGetMessagesByServerIds(a,b)),e=[],f=[],g=new Map();a.forEach(function(a){var b=c.get(a);b!=null?g.set(a,b):f.push(a)});a=f[0];var i,j=f[f.length-1];j-a+1===f.length&&(i=(yield d("WAWebNewsletterGetMessagesJob").getNewsletterMessages(b,f.length,{after:a-1})));(j=i)==null||j.msgs.forEach(function(a){if(a==null){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][populateMsgModels] couldn't retrieve message"])));return}e.push(a);a.serverId!=null&&g.set(a.serverId,a)});e.length>0&&(yield d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(e));return g});return i.apply(this,arguments)}g.populateMsgModels=a}),98);
__d("WAWebGetNewsletterContextForForwardedMsg",["WAWebMsgGetters","WAWebMsgType","WAWebNewsletterMetadataCollection","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){if(a.forwardedNewsletterMessageInfo!=null)return a.forwardedNewsletterMessageInfo;if(!d("WAWebMsgGetters").getIsNewsletterMsg(a))return void 0;var b=a.id.remote,e=c("WAWebNewsletterMetadataCollection").get(b);return{newsletterId:d("WAWebWidFactory").asNewsletterWidOrThrow(b),newsletterName:e==null?void 0:e.name,serverMessageId:(b=a.serverId)!=null?b:void 0}}function b(a){var b=a.forwardable,c=a.source,e=a.destination,f=a.isOriginalMsgForwarded;a=a.isQuestionOrQuestionReply;if(!e.isNewsletter())return b;return e.equals(c)&&!f&&b.type!==d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT&&!a?babelHelpers["extends"]({},b,{isForwarded:!1,forwardedNewsletterMessageInfo:void 0,forwardingScore:void 0}):b}g.getNewsletterContextForForwardedMsg=a;g.maybeStripNewsletterForwardMetadata=b}),98);
__d("WAWebNewsletterModelUtils",["WALogger","WATimeUtils","WAWebCommonNewsletterEnums","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebWid","WAWebWidFactory","err","lodash"],(function(a,b,c,d,e,f,g){var h,i,j=1,k=-1,l=0;function m(a){return a==="verified"}function a(a){a=s(a);n(a);return o(a)}function n(a){var b;b=(b=a.newsletterMembershipMetadataMixin)==null?void 0:b.membershipType;b=b==null||b==="guest";if(!b){b="Trying to map an already subscribed newsletter";d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][throwIfNewsletterNotPreview] ",""])),b).tags("newsletter").devConsole(a).sendLogs("newsletter-converting-already-subscribed-newsletter")}}function o(a){a=q(a);a.muteExpiration=k;a.isReadOnly=!0;return a}function p(a){return a==="admin"||a==="owner"}function q(a){var b,e,f,g;b=(b=a.newsletterNameMetadataMixin)==null?void 0:b.nameElementValue;e=(e=a.newsletterMembershipMetadataMixin)==null?void 0:e.membershipType;f=(f=a.newsletterMutedMetadataMixin)==null?void 0:f.mutedState;var h=f==="on"?k:l;g=(g=a.newsletterCreationTimeMetadataMixin)==null?void 0:g.creationTimeValue;a={id:d("WAWebWidFactory").createWid(a.idJid),name:b!=null?b:void 0,isReadOnly:e!=null?!p(e):void 0,muteExpiration:f!=null&&f!=="undefined"?h:void 0,t:g!=null?d("WATimeUtils").castToUnixTime(g):void 0};return c("lodash").pickBy(a,function(a){return a!=null})}function r(a){a=t(a);a.membershipType=d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest;return a}function s(a){return{idJid:a.idJid,newsletterCreationTimeMetadataMixin:a.newsletterCreationTimeMetadataMixin,newsletterNameMetadataMixin:a.newsletterNameMetadataMixin,newsletterPictureMetadataMixin:a.newsletterPictureMetadataMixin,newsletterDescriptionMetadataMixin:a.newsletterDescriptionMetadataMixin,newsletterInviteLinkMetadataMixin:a.newsletterInviteLinkMetadataMixin,newsletterSubscribersMetadataMixin:a.newsletterSubscribersMetadataMixin,newsletterPrivacyMetadataMixin:a.newsletterPrivacyMetadataMixin,newsletterVerificationMetadataMixin:a.newsletterVerificationMetadataMixin,hasNewsletterLinkedAccountsMetadataMixin:!1,newsletterMembershipMetadataMixin:null,newsletterMutedMetadataMixin:{mutedState:"undefined"},newsletterStateMetadataMixin:null}}function b(a){a=s(a);n(a);return r(a)}function t(a){var b,e,f,g,h;b=(b=a.newsletterVerificationMetadataMixin)==null?void 0:b.verificationState;e=(e=a.newsletterStateMetadataMixin)==null?void 0:e.stateType;f=(f=a.newsletterMembershipMetadataMixin)==null?void 0:f.membershipType;g=(g=a.newsletterPrivacyMetadataMixin)==null?void 0:g.privacyType;b=babelHelpers["extends"]({id:d("WAWebWidFactory").createWid(a.idJid),creationTime:(h=a.newsletterCreationTimeMetadataMixin)==null?void 0:h.creationTimeValue,name:(h=a.newsletterNameMetadataMixin)==null?void 0:h.nameElementValue,nameUpdateTime:(h=a.newsletterNameMetadataMixin)==null?void 0:h.nameUpdateTime,description:(h=a.newsletterDescriptionMetadataMixin)==null||(h=h.descriptionQueryDescriptionResponseMixin)==null?void 0:h.elementValue,descriptionUpdateTime:(h=a.newsletterDescriptionMetadataMixin)==null||(h=h.descriptionQueryDescriptionResponseMixin)==null?void 0:h.updateTime,inviteCode:(h=a.newsletterInviteLinkMetadataMixin)==null?void 0:h.inviteCode,size:(h=a.newsletterSubscribersMetadataMixin)==null?void 0:h.subscribersCount,verified:b!=null?m(b):void 0,membershipType:f!=null?d("WAWebCommonNewsletterEnums").NewsletterMembershipType.cast(f):void 0,reactionCodesSetting:Object.prototype.hasOwnProperty.call(a,"newsletterReactionCodesSettingMetadataMixin")?(h=a==null?void 0:a.newsletterReactionCodesSettingMetadataMixin)!=null?h:d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All:void 0,privacy:g!=null?d("WAWebCommonNewsletterEnums").NewsletterPrivacy.cast(g):void 0,website:void 0,suspended:e!=null?d("WAWebCommonNewsletterEnums").NewsletterState.cast(e)===d("WAWebCommonNewsletterEnums").NewsletterState.Suspended||d("WAWebCommonNewsletterEnums").NewsletterState.cast(e)===d("WAWebCommonNewsletterEnums").NewsletterState.GeoSuspended:void 0,geosuspended:e!=null?d("WAWebCommonNewsletterEnums").NewsletterState.cast(e)===d("WAWebCommonNewsletterEnums").NewsletterState.GeoSuspended:void 0},d("WAWebNewsletterGatingUtils").isWamoSubExperienceEnabled()&&{wamoSubPlanId:a.newsletterWamoSubPlanIdMetadataMixin,wamoSubStatus:a.newsletterWamoSubStatusMetadataMixin});return c("lodash").pickBy(b,function(a){return a!=null})}var u="https://pps.whatsapp.net";function v(a){if(a==null||a==="")return null;a=new URL(a,u);return a.href}function w(a,b){a=d("WAWebWidFactory").createWid(a);if(b.length===0)return{id:a};var e,f;for(b of b){var g=b.queryPictureDirectPathOrEmptyResponseMixinGroup;if(g.name==="QueryPictureDirectPathResponse")g.value.type==="preview"?f=g.value:g.value.type==="image"&&(e=g.value);else if(g.name==="QueryPictureEmptyResponse")return{id:a,timestamp:Date.now(),eurl:null,previewEurl:null,eurlStale:!1,stale:!1}}b={id:a,timestamp:Date.now(),tag:(b=(g=e)==null?void 0:g.id)!=null?b:(a=f)==null?void 0:a.id,eurl:v((b=(g=e)==null?void 0:g.directPath)!=null?b:(a=f)==null?void 0:a.directPath),previewEurl:v((g=f)==null?void 0:g.directPath),eurlStale:!1,stale:!1};return c("lodash").pickBy(b,function(a){return a!=null})}function e(a){return{chat:q(a),metadata:t(a),pic:w(a.idJid,(a=(a=a.newsletterPictureMetadataMixin)==null?void 0:a.picture)!=null?a:[])}}function f(a){if(c("WAWebWid").isNewsletter(a)){var b;return(b=c("WAWebNewsletterMetadataCollection").get(a))==null?void 0:b.membershipType}return(b=c("WAWebNewsletterMetadataCollection").filter(function(b){return b.inviteCode===a})[0])==null?void 0:b.membershipType}function x(a){return a===k}function y(a){switch(a){case"INSIGHTS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights;case"PHOTO_POLLS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls;case"QUESTIONS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.QUESTIONS;case"INVITE_ADMINS_BUTTON":return d("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_ADMINS_BUTTON;case"INVITE_FOLLOWERS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_FOLLOWERS;case"ADMIN_NOTIFICATIONS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_NOTIFICATIONS;case"QUIZ":return d("WAWebCommonNewsletterEnums").NewsletterCapability.QUIZ;case"ADMIN_CONTEXT_CARD_1":return d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_1;case"ADMIN_CONTEXT_CARD_2":return d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_2;case"ADMIN_CONTEXT_CARD_3":return d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_3;case"SHARE_STICKER_PACKS":return d("WAWebCommonNewsletterEnums").NewsletterCapability.SHARE_STICKER_PACKS;default:a;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected newsletter capability: ",""])),a).tags("newsletter-capabilities").sendLogs("Unexpected newsletter capability");return d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights}}g.DEFAULT_NEWSLETTER_ADMIN_COUNT=j;g.MUTED_STATE=k;g.UNMUTED_STATE=l;g.mapDirectoryNewsletterToChat=a;g.mapPreviewNewsletterToChat=o;g.isMembershipAdminOrOwner=p;g.mapNewsletterToChat=q;g.mapPreviewNewsletterToMetadata=r;g.convertDirectoryNewsletterMetadataToNewsletterMetadata=s;g.mapDirectoryNewsletterToMetadata=b;g.mapNewsletterToMetadata=t;g.formatProfilePictureURL=v;g.mapPicturesToProfilePicThumb=w;g.mapNewsletterToModels=e;g.getRoleByIdentifier=f;g.isMuted=x;g.getNewsletterCapabilityFromValue=y}),98);
__d("WAWebNewsletterReactionUtils",["WATimeUtils","WAWebContactCollection","WAWebEmoji","WAWebFrontendContactGetters","WAWebProfilePicThumbCollection","WAWebReactionsModels","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a){var b;return{serverTimestamp:(b=a.reactionCountMapTs)!=null?b:d("WATimeUtils").unixTime(),emojiCountMap:(b=a.reactionCountMap)!=null?b:new Map(),parentMsgKey:a.id.toString()}}function b(a){if(a.length===0)return{reactions:[],count:0};a=a.map(i);return h(a)}function h(a){var b=0,c=new Map();for(a of a){var d=a.reactions,e=a.count;b+=e;for(e of d.entries()){d=e[0];var f=e[1],g=f[0];f=f[1];var h=c.get(d);h!=null?(h.count+=f,h.reaction=babelHelpers["extends"]({},h.reaction,{reactionSenders:h.reaction.reactionSenders.concat(g.reactionSenders)}),c.set(d,h)):c.set(d,{reaction:g,count:f})}}h=Array.from(c.values()).sort(function(a,b){var c=a.count;a=a.reaction;var d=b.reaction;b=b.count;if(a.reactionByMe!=null)return-1;return d.reactionByMe!=null?1:b-c}).map(function(b){var a=b.reaction;b=b.count;return[a,b]});return{count:b,reactions:h}}function i(a){var b=new Map(),c=a.myReaction,e=a.myReactionMsgKey,f=new Map(a.reactionCountMap);c!=null&&c!==""&&!f.has(c)&&f.set(c,1);var g=0;f=j(f);for(f of f.entries()){var h=f[0],i=f[1];g+=i.count;b.set(h,[{reactionAggregate:h,reactionSenders:l(h,a),reactionByMe:c!=null&&e!=null&&h===d("WAWebEmoji").EmojiUtil.getEmojiAggregate(c)?{msgKey:e.toString(),orphan:0,parentMsgKey:a.id.toString(),reactionText:d("WAWebEmoji").EmojiUtil.getNormalizedOrTofu(c),senderUserJid:d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid(),timestamp:(h=a.myReactionTs)!=null?h:0}:null},i.count])}return{reactions:b,count:g}}function j(a){var b=new Map();for(a of a.entries()){var c,e=a[0],f=a[1],g=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(e);e=d("WAWebEmoji").EmojiUtil.getNormalizedOrTofu(e);c=(c=b.get(g))!=null?c:{count:0,reactions:new Map()};c.reactions.set(e,f);c.count+=f;b.set(g,c)}return b}function k(a){var b=new Map();a.reactions.map(function(a){var c,e=a.reactionCode;a=a.senderList;e=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(e);c=(c=b.get(e))!=null?c:[];b.set(e,c.concat(a))});return b}function c(a){a=k(a);var b=new Map();for(a of a.entries()){var c=a[0],e=a[1];e=e.sort(function(a,b){a=(a==null?void 0:a.id)!=null?d("WAWebContactCollection").ContactCollection.get(a.id):null;b=(b==null?void 0:b.id)!=null?d("WAWebContactCollection").ContactCollection.get(b.id):null;var c=(a==null?void 0:a.type)==="in",e=(b==null?void 0:b.type)==="in";if(c&&a&&b&&e){a=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(a.id)!=null;b=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(b.id)!=null;return a===b?0:a?-1:1}else if(!c&&!e)return 0;return c?-1:1}).slice(0,5);e=e.map(function(a){return(a==null?void 0:a.id)!=null?a.id:a==null?void 0:a.profileUrl}).filter(Boolean);b.set(c,e)}return b}function e(a){var b=[];a.reactions.map(function(a){var c=a.reactionCode;a=a.senderList;a.map(function(a){if((a==null?void 0:a.id)==null)return;a=d("WAWebContactCollection").ContactCollection.get(a.id);(a==null?void 0:a.type)==="in"&&b.push({reaction:c,contact:a})})});return b.sort(function(a,b){a=d("WAWebFrontendContactGetters").getFormattedUser(a.contact);b=d("WAWebFrontendContactGetters").getFormattedUser(b.contact);return a.localeCompare(b)})}function l(a,b){var c=b.myReaction,e=c!=null&&a===d("WAWebEmoji").EmojiUtil.getEmojiAggregate(c);return[new(d("WAWebReactionsModels").ReactionsSenders)({id:b.id,reactionText:e?c:a,senderUserJid:e?d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid():b.id.remote.toJid(),timestamp:b.reactionCountMapTs})]}function f(a){var b=a.serverTimestamp,c=a.emojiCountMap;a=a.parentMsgKey;if(b==null||c==null)return;return{serverTimestamp:b,emojiCountMap:c,parentMsgKey:a.toString()}}g.mapFrontendReactionToBackend=a;g.aggregateAndSortReactions=b;g.getReactionSendersForFacePile=c;g.getContactReactionSenders=e;g.mapReactionDataToDbRecord=f}),98);
__d("WAWebNewsletterSystemMessages",["Promise","WATimeUtils","WAWebCommonNewsletterEnums","WAWebContactSystemMsg","WAWebMsgKey","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterUpdateMsgsRecordsJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new Map([["newsletter_privacy",10],["newsletter_created",20],["newsletter_admin_context_card",30],["newsletter_deleted",Number.MAX_SAFE_INTEGER]]),j=100,k=2147476647;function a(a){a=a.serverId;return a==null?!1:a<j}function e(a){a=a.serverId;if(a==null)return!1;var b=Array.from(i.values());b=Math.min.apply(Math,b);return a===b}function l(a,b){var e=i.get(b.subtype);b=babelHelpers["extends"]({},d("WAWebContactSystemMsg").genNotificationMsg(a,babelHelpers["extends"]({},b,{type:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_NOTIFICATION,kind:d("WAWebMsgType").MsgKind.NewsletterNotification,serverId:e,templateParams:(b=b.templateParams)!=null?b:[]})),{id:new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:a,id:e!=null?e.toString(10):c("WAWebMsgKey").newId_DEPRECATED()})});return b}function m(a){var b=a.id,c=a.name,e=a.t;a=a.role;a=a!=null?a:d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber;e=e!=null?d("WATimeUtils").castToUnixTime(e):d("WATimeUtils").unixTime();var f=l(d("WAWebWidFactory").createWid(b.toString()),{subtype:"newsletter_privacy",templateParams:[a],t:e});c=l(d("WAWebWidFactory").createWid(b.toString()),{subtype:"newsletter_created",templateParams:c!=null?[c,a]:[],t:e});if(d("WAWebNewsletterGatingUtils").isNewsletterAdminContextCardEnabled(a)){a=l(d("WAWebWidFactory").createWid(b.toString()),{subtype:"newsletter_admin_context_card",templateParams:[b.toString()],t:e});return[f,c,a]}return[f,c]}function f(a){return a.addQueue.enqueue((h||(h=b("Promise"))).resolve().then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;b=m({id:a.id,name:a.name,t:(b=a.newsletterMetadata)==null?void 0:b.creationTime,role:(b=a.newsletterMetadata)==null?void 0:b.membershipType});var c=b.map(d("WAWebMsgModelFromData").msgModelFromMsgData);yield d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(b);a.msgs.add(c,{at:0});return c})))}function n(a){var b=a.id;a=a.name;b=l(d("WAWebWidFactory").createWid(b.toString()),{subtype:"newsletter_deleted",templateParams:[a],t:d("WATimeUtils").unixTime()});return[b]}g.EARLIEST_AVAILABLE_MESSAGE_ID=j;g.LATEST_AVAILABLE_MESSAGE_ID=k;g.isNewsletterSystemMsg=a;g.isEarliestNewsletterSystemMsg=e;g.genNewsletterCreationSystemMessages=m;g.addSystemMessagesToChat=f;g.genNewsletterDeletionSystemMessages=n}),98);
__d("WAWebGetNewsletterCursor",["WAWebNewsletterSystemMessages"],(function(a,b,c,d,e,f,g){function a(a,b,c){c=c.length>0?c:a.toArray();c=b==="before"?(a=c[0])==null?void 0:a.serverId:(a=c[c.length-1])==null?void 0:a.serverId;return c==null?null:(a={},a[b]=h(c),a)}function h(a){return Math.min(Math.max(a,d("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID-1),d("WAWebNewsletterSystemMessages").LATEST_AVAILABLE_MESSAGE_ID)}g.getNewsletterCursor=a}),98);
__d("WAWebNewsletterEnforcementAppealModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.chatId=d("WAWebBaseModel").prop(),b.enforcementViolationCategory=d("WAWebBaseModel").prop(),b.enforcementType=d("WAWebBaseModel").prop(),b.enforcementId=d("WAWebBaseModel").prop(),b.enforcementSource=d("WAWebBaseModel").prop(),b.countryCode=d("WAWebBaseModel").prop(),b.enforcementExtraData=d("WAWebBaseModel").prop(),b.appealState=d("WAWebBaseModel").prop(),b.appealCreationTime=d("WAWebBaseModel").prop(),b.appealReason=d("WAWebBaseModel").prop(),b.lastUpdated=d("WAWebBaseModel").prop(),b.serverMsgId=d("WAWebBaseModel").prop(),b.msgData=d("WAWebBaseModel").prop(),b.additionalAppealReason=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.setAppealState=function(a){this.appealState=a};c.setAppealCreationTime=function(a){this.appealCreationTime=a};c.setAppealReason=function(a){this.appealReason=a};c.setAdditionalAppealReason=function(a){this.additionalAppealReason=a};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletter_enforcement_appeal";b=d("WAWebBaseModel").defineModel(a);g.NewsletterEnforcementAppeal=b}),98);
__d("WAWebNewsletterEnforcementAlertModel",["WAWebBaseModel","WAWebNewsletterEnforcementAppealModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.chatId=d("WAWebBaseModel").prop(),b.enforcementCreationTime=d("WAWebBaseModel").prop(),b.enforcementViolationCategory=d("WAWebBaseModel").prop(),b.enforcementType=d("WAWebBaseModel").prop(),b.enforcementId=d("WAWebBaseModel").prop(),b.enforcementExtraData=d("WAWebBaseModel").prop(),b.enforcementSource=d("WAWebBaseModel").prop(),b.countryCodes=d("WAWebBaseModel").prop(),b.targetMsgMapForEvidence=d("WAWebBaseModel").prop(),b.lastUpdated=d("WAWebBaseModel").prop(),b.appeal=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.set=function(b,c,e){if(typeof b==="string"&&b==="appeal"&&c!=null){if(!(c instanceof d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)){var f=new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(c);return a.prototype.set.call(this,b,f,e)}return a.prototype.set.call(this,b,c,e)}if(typeof b==="string"&&b==="targetMsgMapForEvidence"&&c!=null){if(c instanceof Map){f=new Map();for(var g of c.entries()){var h=g[0],i=g[1];i!=null&&!(i instanceof d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)?f.set(h,new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(i)):f.set(h,i)}return a.prototype.set.call(this,b,f,e)}return a.prototype.set.call(this,b,c,e)}if(typeof b==="object"&&b!=null){h=babelHelpers["extends"]({},b);i=!1;h.appeal!=null&&!(h.appeal instanceof d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)&&(h.appeal=new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(h.appeal),i=!0);g=h.targetMsgMapForEvidence;if(g!=null&&g instanceof Map){f=new Map();for(g of g.entries()){var j=g[0],k=g[1];k!=null&&!(k instanceof d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)?(f.set(j,new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(k)),i=!0):f.set(j,k)}h.targetMsgMapForEvidence=f}if(i)return a.prototype.set.call(this,h,c,e)}return a.prototype.set.call(this,b,c,e)};c.isValidAlertToRender=function(){var a;return((a=this.appeal)==null?void 0:a.appealState)!=="SUCCESS"&&((a=this.appeal)==null?void 0:a.appealState)!=="CONTENT_UNAVAILABLE"||((a=this.targetMsgMapForEvidence)==null||(a=a.values())==null?void 0:a.some(function(a){return a.appealState!=="SUCCESS"&&a.appealState!=="CONTENT_UNAVAILABLE"}))||!1};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletter_enforcement_alert";b=d("WAWebBaseModel").defineModel(a);g.NewsletterEnforcementAlert=b}),98);
__d("WAWebNewsletterEnforcementAlertCollection",["WAWebBaseCollection","WAWebNewsletterEnforcementAlertModel","WAWebNewsletterEnforcementAppealModel"],(function(a,b,c,d,e,f,g){a=function(a,b){return b.enforcementCreationTime-a.enforcementCreationTime};b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.hasAlerts=function(){return this.some(function(a){return a.isValidAlertToRender()})};c.setMsgModelMap=function(a){b.msgModelMap=a};c.getAppeals=function(){var a=[];this.map(function(b){var c;if(((c=b.targetMsgMapForEvidence)==null?void 0:c.values().toArray().length)!==0&&b.targetMsgMapForEvidence!=null)for(c of b.targetMsgMapForEvidence.values())c!=null&&c.appealState!=="NOT_APPEALED"&&c.appealState!=="NON_APPEALABLE"&&a.push(new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(c));else b.appeal!=null&&b.appeal.appealState!=="NOT_APPEALED"&&b.appeal.appealState!=="NON_APPEALABLE"&&a.push(new(d("WAWebNewsletterEnforcementAppealModel").NewsletterEnforcementAppeal)(b.appeal))});return a.sort(function(a,b){return((b=b.appealCreationTime)!=null?b:0)-((b=a.appealCreationTime)!=null?b:0)})};return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebNewsletterEnforcementAlertModel").NewsletterEnforcementAlert;b.comparator=a;c=new b();g.NewsletterEnforcementAlertCollection=c}),98);
__d("WAWebFetchNewsletterProfilePicAction",["WAJids","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c={id:a},e=d("WAJids").toNewsletterJid(a.toString());a=d("WAWebNewsletterModelUtils").getRoleByIdentifier(a);a=(yield d("WAWebNewsletterMetadataJob").getNewsletterMetadata(e,a,{picture:!0}));a=a==null||(b=a.newsletterPictureMetadataMixin)==null?void 0:b.picture;if(a==null)return c;e=d("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(e,a);return babelHelpers["extends"]({},c,{tag:(a=e.tag)!=null?a:void 0,eurl:(c=e.eurl)!=null?c:void 0,previewEurl:(a=e.previewEurl)!=null?a:void 0,stale:e.stale,eurlStale:!1,timestamp:(c=e.timestamp)!=null?c:Date.now()})});return h.apply(this,arguments)}g.fetchNewsletterProfilePic=a}),98);
__d("WAWebNewsletterGetMessageUpdatesAction",["Promise","WAJids","WALogger","WATimeUtils","WAWebNewsletterBridgeApi","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessageUpdatesJob","WAWebNewsletterMetadataJob","WAWebNewsletterSystemMessages","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;function a(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e="[maybeUpdateMsgsAddOns]["+c.id.toJid()+"]";if(a.length===0){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose([""," no messages, exit"])),e);return}a=a.filter(function(a){return a.serverId==null?!1:a.serverId>=d("WAWebNewsletterSystemMessages").EARLIEST_AVAILABLE_MESSAGE_ID&&a.serverId<=d("WAWebNewsletterSystemMessages").LATEST_AVAILABLE_MESSAGE_ID});var f=Math.min.apply(Math,a.map(function(a){return(a=a.lastUpdateFromServerTs)!=null?a:0}));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose([""," init, earliestMsgUpdateTs=",""])),e,f);if(!t(f)){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[maybeUpdateMsgsAddOns] should not update, exiting"])));return}var g=Math.min.apply(Math,a.map(function(a){return a.serverId}).filter(Boolean));d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," updating, earliest server id in batch ",""])),e,g);if(!Number.isSafeInteger(g))return;try{g=g-1;var l=0,s=[];while(l<a.length){var u=Math.min(a.length-l,d("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer());s.push(d("WAWebNewsletterGetMessageUpdatesJob").getNewsletterMessageUpdates(d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(c.id.toJid()),{cursor:{after:g},count:u,since:f>0?f:void 0,ids:a.map(function(a){return a.id})}));g+=u;l+=u}u=(yield (r||(r=b("Promise"))).all(s));u.forEach(function(a){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," updated db records"])),e).devConsole(a),void d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterMessages(a),d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose([""," updated UI, exiting"])),e)})}catch(a){if((a==null?void 0:a.status)===423)try{yield d("WAWebNewsletterMetadataJob").suspendNewsletter(d("WAJids").toNewsletterJid(c.id.toJid())),void d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.suspendNewsletter({id:c.id})}catch(a){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][maybeUpdateMsgsAddOns] Failed to suspend channel "," on receiving 423 error - ",""])),c.id.toString(),a.name).devConsole(a).tags("newsletter").sendLogs("newsletter-maybe-update-msg-addons-suspend-error");return}else if((a==null?void 0:a.status)===451)try{yield d("WAWebNewsletterMetadataJob").geosuspendNewsletter(d("WAJids").toNewsletterJid(c.id.toJid())),void d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.geosuspendNewsletter({id:c.id})}catch(a){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][maybeUpdateMsgsAddOns] Failed to geosuspend channel "," on receiving 451 error - ",""])),c.id.toString(),a.name).devConsole(a).tags("newsletter").sendLogs("newsletter-maybe-update-msg-addons-geosuspend-error");return}d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[maybeUpdateMsgsAddOns] Failed to update messages"]))).devConsole(a).tags("newsletter")}});return s.apply(this,arguments)}function t(a){return!Number.isSafeInteger(a)?!1:d("WATimeUtils").unixTime()-a>d("WAWebNewsletterGatingUtils").getPullMessageUpdatesThresholdSeconds()}g.maybeUpdateMsgsAddOns=a}),98);
__d("WAWebNewsletterGetNewsletterEnforcementAlertAction",["WAJobOrchestratorTypes","WALogger","WAWebGetNewsletterEnforcementAlertsJob","WAWebNewsletterBridgeApi","WAWebNewsletterEnforcementAlertCollection","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=d("WAJobOrchestratorTypes").JOB_PRIORITY.HIGH);d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementAlertAction] Start"])));try{a=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(a.toJid());a=(yield d("WAWebGetNewsletterEnforcementAlertsJob").getNewsletterEnforcementAlerts(a,b));if(a==null)return;b=a.enforcementData;a=a.msgModelMap;d("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.setMsgModelMap(a);void d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterEnforcementAlerts({enforcementAlerts:b})}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementAlertAction] Failed to get NewsletterEnforcements updates"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-to-get-NewsletterEnforcement-alerts")}});return j.apply(this,arguments)}g.getNewsletterEnforcementAlertAction=a}),98);
__d("WAWebNewsletterMessageDeliveryUpdateAction",["WAJids","WAWebNewsletterMetadataJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebNewsletterMetadataJob").updateNewsletterMessageDeliveryUpdates(d("WAJids").toNewsletterJid(a.id.toString()),[],b.map(function(a){return a.serverId}).filter(Boolean));(a=a.newsletterMetadata)==null||a.messageDeliveryUpdates.remove(b.map(function(a){return a.id}))});return h.apply(this,arguments)}g.removeMessageDeliveryUpdates=a}),98);
__d("WAWebNewsletterPullMessagesFromServerAction",["Promise","WAAbortError","WALogger","WARaceSignal","WAWebApiChat","WAWebChatGetters","WAWebChatSeenBridge","WAWebMsgModelFromData","WAWebNewsletterBackendAddOnsUtils","WAWebNewsletterBridgeApi","WAWebNewsletterErrors","WAWebNewsletterGetMessagesJob","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","WAWebStateUtils","WAWebUpdateUnreadChatAction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;function a(a,e){var f=d("WAWebStateUtils").unproxy(a);if(!d("WAWebChatGetters").getIsNewsletter(f)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[pullNewsletterMessagesFromServer] not a newsletter"])));return(q||(q=b("Promise"))).reject(new(d("WAWebNewsletterErrors").UnexpectedNonNewsletterChatError)())}return e.messageCount<0?(q||(q=b("Promise"))).resolve([]):c("WARaceSignal")([e.signal,f.getDeleteSignal()].filter(Boolean),function(a){return v(f,babelHelpers["extends"]({},e,{signal:a}))})}function r(a,b,c){switch(b){case"before":a.msgs.msgLoadState.isLoadingEarlierMsgs=c;break;case"after":a.msgs.msgLoadState.isLoadingRecentMsgs=c;break}}function s(a,c,d){return c.length===0?(q||(q=b("Promise"))).resolve():a.addQueue.enqueue((q||(q=b("Promise"))).resolve().then(function(){a.msgs.add(c,d==="before"?{at:0}:void 0);if(d==="after"){var b,e=Math.max.apply(null,c.map(function(a){return a.t}));a.t=Math.max((b=a.t)!=null?b:0,e)}}))}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebApiChat").getChatMeta(a.id));c=c.unreadCount;c=Math.max(c-b,0);yield d("WAWebChatSeenBridge").markConversationSeen(a.id,c);yield d("WAWebUpdateUnreadChatAction").updateUnreadCountMD(a,0,!1)});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c.signal.aborted)throw new(d("WAAbortError").AbortError)();var e=c.messageCount,f=c.cursor,g=c.shouldUpdateMsg,h=f==null||f.after!=null?"after":"before",p="[pullNewsletterMessagesFromServer]["+a.id.toJid()+"]["+h+"]";d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose([""," start pulling messages"])),p);var u=a.msgs.msgLoadState,v=u.isLoadingEarlierMsgs;u=u.isLoadingRecentMsgs;if(h==="before"&&v){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," early returning loadEarlierPromise"])),p);return a.msgs.loadEarlierPromise}if(h==="after"&&u){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," early returning loadRecentPromise"])),p);return a.msgs.loadRecentPromise}r(a,h,!0);try{if(c.signal.aborted)throw new(d("WAAbortError").AbortError)();var w=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(a.id.toJid());v=(q||(q=b("Promise"))).resolve().then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var i=(yield d("WAWebNewsletterGetMessagesJob").getNewsletterMessages(w,e,f)),j=g!=null?i.msgs.filter(g):i.msgs,k=j.map(d("WAWebMsgModelFromData").msgModelFromMsgData);d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose([""," loaded "," messages from server"])),p,k.length);if(c.signal.aborted)throw new(d("WAAbortError").AbortError)();k.length>0?(yield (q||(q=b("Promise"))).all([d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords(j),x(i),s(a,k,h)]),c.resetUnreadCount===!0&&(yield t(a,k.length)),d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," local collections and db updated"])),p)):d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose([""," no messages retrieved from server, skip models update"])),p);r(a,h,!1);return i.msgs.map(d("WAWebMsgModelFromData").msgModelFromMsgData)}));h==="before"?a.msgs.loadEarlierPromise=v:h==="after"&&(a.msgs.loadRecentPromise=v);return yield v}catch(a){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[pullNewsletterMessagesFromServer] failed to pull newsletter messages from server"]))).tags("newsletter").devConsole(a);throw a}});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.reactions,c=a.pollVotes,e=a.timestamp;d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterAddons], updating"]))).devConsole(b);yield d("WAWebNewsletterBackendAddOnsUtils").updateAddOnDbRecords(a);a=b.map(function(a){return a.parentMsgKey});return d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.updateNewsletterMessages({reactions:b,ids:a,timestamp:e,pollVotes:c})});return y.apply(this,arguments)}g.pullNewsletterMessagesFromServer=a}),98);
__d("WAWebNewsletterReparseMsgAction",["WAWebBackendApi","WAWebHandleMsgTypes.flow","WAWebNewsletterFutureProofUtils","WAWebNewsletterUpdateMsgsRecordsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.futureproofBuffer,c=a.futureproofType,e=a.futureproofSubtype;if(b!=null||c==null)return a;b=d("WAWebNewsletterFutureProofUtils").isMsgSupported(a);b=b.supported;if(!b)return a;b=babelHelpers["extends"]({},a,{type:c,kind:c,subtype:e,futureproofType:void 0,futureproofSubtype:void 0});yield d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords([b]);yield d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{msg:b,chatId:a.id.remote,messageOverwriteOption:d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.RETRY});return b});return h.apply(this,arguments)}g.reparseNewsletterMsg=a}),98);
__d("WAWebWamEnumChannelEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({FOLLOW:1,UNFOLLOW:2,MUTE:3,UNMUTE:4,PREMIUM_SUBSCRIBE:5,PREMIUM_UNSUBSCRIBE:6,CHANNEL_PREMIUM_SETUP:7,CHANNEL_PREMIUM_CANCEL:8,HIDE:9,UNHIDE:10,CREATE:11,DELETE:12});f.CHANNEL_EVENT_TYPE=a}),66);
__d("WAWebNewsletterToggleMuteStateAction",["WAJids","WALogger","WAWebNewsletterAttributionLogging","WAWebNewsletterBridgeApi","WAWebNewsletterCollection","WAWebNewsletterToggleMuteStateJob","WAWebWamEnumChannelEventType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.eventSurface;if(!a.isNewsletter()){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][muteNewsletterAction] called with a non-newsletter chat"]))).tags("newsletter").devConsole(a).sendLogs("mute-not-a-newsletter");return}try{d("WAWebNewsletterAttributionLogging").NewsletterCoreEventLogger.log({eventSurface:b,cid:a,channelCoreEventType:d("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE.MUTE});b=c("WAWebNewsletterCollection").get(a);if(b==null)throw c("err")("Failed to retrieve newsletter");b.mute.promises.mute=d("WAWebNewsletterToggleMuteStateJob").muteNewsletter([d("WAJids").toNewsletterJid(a.toJid())]).then(function(){return{status:200}})["catch"](function(){return{status:400}});yield b.mute.promises.mute;yield d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.muteNewsletter({id:a})}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][muteNewsletterAction] failed to mute the newsletter"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-mute-action-failed")}});return l.apply(this,arguments)}function e(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.eventSurface;if(!a.isNewsletter()){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][unmuteNewsletterAction] called with a non-newsletter chat"]))).tags("newsletter").devConsole(a).sendLogs("mute-not-a-newsletter");return}try{d("WAWebNewsletterAttributionLogging").NewsletterCoreEventLogger.log({eventSurface:b,cid:a,channelCoreEventType:d("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE.UNMUTE});b=c("WAWebNewsletterCollection").get(a);if(b==null)throw c("err")("Failed to retrieve newsletter");b.mute.promises.unmute=d("WAWebNewsletterToggleMuteStateJob").unmuteNewsletter([d("WAJids").toNewsletterJid(a.toJid())]).then(function(){return{status:200}})["catch"](function(){return{status:400}});yield b.mute.promises.unmute;yield d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.unmuteNewsletter({id:a})}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][unmuteNewsletterAction] failed to unmute the newsletter"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-unmute-action-failed")}});return m.apply(this,arguments)}g.muteNewsletterAction=a;g.unmuteNewsletterAction=e}),98);
__d("WAWebQueryAndUpdateNewslettersMetadataAction",["$InternalEnum","Promise","WAJids","WAJobOrchestratorTypes","WALogger","WAWebBackendErrors","WAWebCommonNewsletterEnums","WAWebContactCollection","WAWebContactProfilePicThumbBridge","WAWebCreateChat","WAWebDBBulkPersistProfilePic","WAWebNewsletterBridgeApi","WAWebNewsletterCollection","WAWebNewsletterDeleteChatJob","WAWebNewsletterGetAdminCapabilitiesJob","WAWebNewsletterGetAdminCountJob","WAWebNewsletterGetNewsletterEnforcementAlertAction","WAWebNewsletterMembershipUtil","WAWebNewsletterMetadataCollection","WAWebNewsletterMetadataJob","WAWebNewsletterModelUtils","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterStorageUtils","WAWebNewsletterSystemMessages","WAWebNewsletterUpdateNewslettersRecordsJob","WAWebNoop","WAWebProfilePicThumbCollection","WAWebSchemaChat","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;function x(a){return a!=null&&Number.isInteger(a)&&a>0}var y=b("$InternalEnum").Mirrored(["Bootstrap","DirtyBit","Debug"]);function a(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c={});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Start"])));c=c!=null?c:{};var e=c.messageCount,f=c.addSystemMsgs;c=c.qplEvent;try{c==null||c.annotate({string:{entryPoint:a}});c==null||c.addPoint("getAllNewslettersMetadata_start");var g=(yield d("WAWebNewsletterMetadataJob").getAllNewslettersMetadata()),m=g.newsletters;g=g.deletedNewsletters;var n=m.reduce(function(a,b){var c;a.chats.push(d("WAWebNewsletterModelUtils").mapNewsletterToChat(b));a.metadata.push(d("WAWebNewsletterModelUtils").mapNewsletterToMetadata(b));c=(c=b.newsletterPictureMetadataMixin)==null?void 0:c.picture;c!=null&&a.pics.push(d("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(b.idJid,c));return a},{chats:[],metadata:[],pics:[]}),o=n.chats,p=n.metadata;n=n.pics;c==null||c.addPoint("getAllNewslettersMetadata_end");c==null||c.addPoint("processDeletedNewsletters_start");yield D(g);c==null||c.addPoint("processDeletedNewsletters_end");m=(m=m.map(function(a){return a.idJid})).concat.apply(m,((g==null?void 0:g.id)||[]).map(function(a){return a.jid}));a===y.DirtyBit&&(c==null||c.addPoint("processUnsubscribedNewsletters_start"),yield F(m),c==null||c.addPoint("processUnsubscribedNewsletters_end"));c==null||c.addPoint("fetchAdminCountsForOwnerNewsletter_start");yield (w||(w=b("Promise"))).all(p.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebNewsletterMembershipUtil").iAmOwner(a)){var b=(yield d("WAWebNewsletterGetAdminCountJob").getNewsletterAdminCount(d("WAJids").toNewsletterJid(a.id.toString())));a.adminCount=b}});return function(b){return a.apply(this,arguments)}}()));c==null||c.addPoint("fetchAdminCountsForOwnerNewsletter_start");d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Update local model"])));yield B({chats:o,metadata:p,pics:n,messageCount:e,addSystemMsgs:f,qplEvent:c});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][getNewsletterEnforcementsUpdatesAction] Update local model"])));c==null||c.addPoint("processChannelEnforcementsUpdates_start");yield w.all(p.map(function(a){d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a)&&void d("WAWebNewsletterGetNewsletterEnforcementAlertAction").getNewsletterEnforcementAlertAction(d("WAWebWidFactory").createWid(a.id.toString()),d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION)}));c==null||c.addPoint("processChannelEnforcementsUpdates_end");d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] End"])));return{chats:o,success:!0}}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][queryAndUpdateAllNewsletterMetadataAction] Failed to retrieve the list of newsletters"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-to-retrieve-newsletters");return{success:!1}}});return z.apply(this,arguments)}function e(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateNewsletterMetadataAction] Start"])));try{var e,f,g,h=d("WAWebNewsletterModelUtils").getRoleByIdentifier(a);h=(yield d("WAWebNewsletterMetadataJob").getNewsletterMetadata(a,h,b==null?void 0:b.fields));if(h==null)return;var i=d("WAWebNewsletterModelUtils").mapNewsletterToChat(h),j=d("WAWebNewsletterModelUtils").mapNewsletterToMetadata(h);e=(e=h.newsletterPictureMetadataMixin)==null?void 0:e.picture;e=e?[d("WAWebNewsletterModelUtils").mapPicturesToProfilePicThumb(a,e)]:[];var k=void 0;f=(f=b==null?void 0:b.adminFields)!=null?f:{};f=f.adminCount;f===!0&&(k=(yield d("WAWebNewsletterGetAdminCountJob").getNewsletterAdminCount(a)));f=void 0;g=(g=b==null?void 0:b.adminFields)!=null?g:{};g=g.capabilities;g===!0&&(f=(yield d("WAWebNewsletterGetAdminCapabilitiesJob").getNewsletterAdminCapabilities(a)));yield B({chats:[i],metadata:[babelHelpers["extends"]({},j,{adminCount:k,capabilities:f})],pics:e,messageCount:b==null?void 0:b.messageCount});d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateNewsletterMetadataAction] End"])));return c("WAWebNewsletterCollection").get(h.idJid)}catch(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===405)return;d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][queryAndUpdateNewsletterMetadataAction] Failed to retrieve newsletter metadata"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-to-retrieve-newsletter")}});return A.apply(this,arguments)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.chats,f=a.metadata,g=a.pics,h=a.messageCount,i=a.addSystemMsgs;a=a.qplEvent;d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections] Start"])));var j=H(e,f,g),k=j.filteredChats,l=j.filteredMetadata;j=j.filteredPics;a==null||a.addPoint("updateNewsletterChatRecords_start");yield d("WAWebNewsletterUpdateNewslettersRecordsJob").updateNewsletterChatRecords(k.map(d("WAWebCreateChat").createNewsletterObjectForStorage));a==null||a.addPoint("updateNewsletterChatRecords_end");d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][chat] Persist changes to DB"])));a==null||a.addPoint("updateNewsletterMetadata_start");yield d("WAWebNewsletterMetadataJob").updateNewsletterMetadata(l.map(d("WAWebNewsletterStorageUtils").createNewsletterMetadataObjectForStorage));a==null||a.addPoint("updateNewsletterMetadata_end");d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][metadata] Persist changes to DB"])));a==null||a.addPoint("bulkPersistProfilePicChanges_start");yield d("WAWebDBBulkPersistProfilePic").bulkPersistProfilePicChanges(j.map(function(a){if(!Object.prototype.hasOwnProperty.call(a,"eurl"))return;var b=d("WAWebWidFactory").createWid(a.id.toString());return d("WAWebContactProfilePicThumbBridge").mapProfilePictureToProfilePicThumbRowType(b,{id:b,tag:(b=a.tag)!=null?b:void 0,eurl:(b=a.eurl)!=null?b:void 0,previewEurl:(b=a.previewEurl)!=null?b:void 0,stale:a.stale,eurlStale:!1,timestamp:(b=a.timestamp)!=null?b:Date.now()})}).filter(Boolean));a==null||a.addPoint("bulkPersistProfilePicChanges_end");d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][updateCollections][picture] Persist changes to DB"])));d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction] Update local model"])));c("WAWebNewsletterMetadataCollection").add(f,{merge:!0});d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.add(g,{merge:!0});c("WAWebNewsletterCollection").add(e,{merge:!0});a==null||a.addPoint("pullNewsletterMessagesFromServer_start");d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction][messages] Start"])));x(h)&&(yield (w||(w=b("Promise"))).all(c("WAWebNewsletterCollection").filter(function(a){return!((a=a.newsletterMetadata)!=null&&a.isSuspendedOrTerminated)}).map(function(a){return d("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(a,{messageCount:h,resetUnreadCount:!0}).then(function(b){if(b.filter(function(a){return a.isWamoSub!==!0||d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a.viewMode)}).length===0&&i===!0)return d("WAWebNewsletterSystemMessages").addSystemMessagesToChat(a)})["catch"](c("WAWebNoop"))})));a==null||a.addPoint("pullNewsletterMessagesFromServer_end");d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[newsletters][queryAndUpdateAllNewsletterMetadataAction][messages] End"])));a==null||a.addPoint("contactUpdates_start");k=f.filter(function(a){return a.name}).map(function(a){return{id:a.id,name:a.name}});d("WAWebContactCollection").ContactCollection.add(k,{merge:!0});a==null||a.addPoint("contactUpdates_end")});return C.apply(this,arguments)}function D(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return;var b=a.id.map(function(a){return{id:a.jid.toString(),terminated:!0}});a=a.id.map(function(a){return{id:d("WAWebWidFactory").createWid(a.jid),terminated:!0}});yield d("WAWebNewsletterMetadataJob").updateNewsletterMetadata(b);c("WAWebNewsletterMetadataCollection").add(a,{merge:!0})});return E.apply(this,arguments)}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield d("WAWebSchemaChat").getChatTable().all());c=c.map(function(a){return d("WAWebWidFactory").createWid(a.id)}).filter(function(b){b=d("WAJids").validateNewsletterJid(b.toJid());return b!=null&&!a.includes(b)});var e=[];c.map(function(a){e.push(d("WAWebNewsletterBridgeApi").NewsletterBridgeApi.deleteNewsletter({id:a,keep:!1})),e.push(d("WAWebNewsletterMetadataJob").deleteNewsletterMetadata(a.toString())),e.push(d("WAWebNewsletterDeleteChatJob").deleteNewsletterChat(a)),e.push(d("WAWebNewsletterMetadataJob").deleteNewsletterPicture(a.toString()))});yield (w||(w=b("Promise"))).all(e)});return G.apply(this,arguments)}function H(a,b,e){var f=b.filter(function(a){if(a.membershipType!=null)return a.membershipType===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest;a=c("WAWebNewsletterMetadataCollection").get(a.id);return a==null?!1:a.membershipType===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}).map(function(a){return a.id});a=a.filter(function(a){return!f.includes(a.id)});b=b.filter(function(a){return!f.includes(a.id)});e=e.filter(function(a){return!f.includes(a.id)});return{filteredChats:a,filteredMetadata:b,filteredPics:e}}g.NewsletterMetadataUpdateEntryPoint=y;g.queryAndUpdateAllNewsletterMetadataAction=a;g.queryAndUpdateNewsletterMetadataAction=e;g.updateCollections=B}),98);
__d("WAWebUpdateNewsletterMsgUIAction",["Promise","WAAckLevel","WAJids","WATimeUtils","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterDBUtils","WAWebNewsletterDeleteChatJob","WAWebNewsletterMessageDeliveryUpdateAction","WAWebNewsletterPollVotesModelCollection","WAWebNewsletterReactionCollection","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebReactionsMsgAction","WAWebRevokeMsgAction","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAJids").toNewsletterJid(b.toJid()),f=c("WAWebNewsletterCollection").get(b);f==null&&(f=(yield d("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(e)),f!=null&&c("WAWebNewsletterCollection").add(f));if(f==null){yield d("WAWebNewsletterDeleteChatJob").deleteNewsletterChat(b);return}if(a.type==="reaction")return j(a);if(a.type==="poll_update"){if(a.subtype==="poll_vote")return l(a);return}if(a.subtype==="admin_revoke")return m(a,b);if(a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL)return;yield d("WAWebMsgCollection").MsgCollection.processMultipleMessages(f.id,[babelHelpers["extends"]({},d("WAWebMsgDataFromModel").msgDataFromMsgModel(a),{recvFresh:!0,isNewMsg:!0})],{},"updateNewsletterMessageUI",f.msgs,!0)});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebMsgCollection").MsgCollection.get(a.reactionParentKey),c=a.reactionText;if(b==null)return;var e=b.serverId;if(e==null)return;d("WAWebNewsletterReactionCollection").updateOrCreateMessageReaction({parentMsg:b,reactionMsg:a,reactionCode:c});b={msgKey:a.id.toString(),parentMsgKey:d("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(e,a.from).toString(),senderUserJid:d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),reactionText:c,timestamp:a.t*1e3,orphan:0,read:!0,ack:d("WAAckLevel").ACK.SENT};yield d("WAWebReactionsMsgAction").addOrUpdateReactionsModelCollection(b,{allowNotify:!1})});return k.apply(this,arguments)}function l(a){if(a.pollUpdateParentKey==null)return;var b=d("WAWebMsgCollection").MsgCollection.get(a.pollUpdateParentKey);if(b==null||a.type!==d("WAWebMsgType").MSG_TYPE.POLL_UPDATE)return;var c=a.senderTimestampMs;d("WAWebNewsletterPollVotesModelCollection").updateOrCreatePollVote({msgKey:a.id,parentMsgKey:b.id,selectedOptionLocalIds:new Set(a.selectedOptionLocalIds),timestamp:c!=null?d("WATimeUtils").castToMillisTime(c):d("WATimeUtils").castUnixTimeToMillisTime(d("WATimeUtils").castToUnixTime(a.t))})}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=(e=c("WAWebNewsletterCollection").get(e))==null?void 0:e.msgs.get(a.protocolMessageKey);if(e==null)return(h||(h=b("Promise"))).resolve();d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([e.id.toString()]);yield d("WAWebNewsletterMessageDeliveryUpdateAction").removeMessageDeliveryUpdates(d("WAWebFrontendMsgGetters").getChat(e),[e]);return(h||(h=b("Promise"))).resolve(d("WAWebRevokeMsgAction").revoke(e,{subtype:a.subtype,msgKey:a.id,sender:d("WAWebMsgGetters").getIsSentByMe(a)?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():a.from,revokeTimestamp:a.t,viewMode:a.viewMode}))});return n.apply(this,arguments)}g.updateNewsletterMessageUI=a}),98);
__d("WAWebNewsletterInsightUtils",["$InternalEnum","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum").Mirrored(["Available","Missing"]);function a(a){switch(a){case"OK":return i.Available;case"MISSING":return i.Missing;default:a;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected status"]))).tags("newsletter-admin-insights").devConsole(a);return i.Missing}}g.NewsletterInsightDataStatus=i;g.getNewsletterInsightsDataStatus=a}),98);
__d("WAWebNewsletterAdminInsightsModel",["fbt","WAWebBaseModel","WAWebClock","WAWebModelUtils","WAWebNewsletterInsightUtils","WAWebWid"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.rangeStart=d("WAWebModelUtils").prop(),b.rangeEnd=d("WAWebModelUtils").prop(),b.dataStatus=d("WAWebModelUtils").prop(function(){return d("WAWebNewsletterInsightUtils").NewsletterInsightDataStatus.Available}),b.accountsReached=d("WAWebModelUtils").prop(),b.reachDelta=d("WAWebModelUtils").prop(),b.followersReached=d("WAWebModelUtils").prop(),b.nonFollowersReached=d("WAWebModelUtils").prop(),b.reachByCountry=d("WAWebModelUtils").prop(function(){return[]}),b.followers=d("WAWebModelUtils").prop(),b.followersDelta=d("WAWebModelUtils").prop(),b.followersByCountry=d("WAWebModelUtils").prop(function(){return[]}),b.netFollows=d("WAWebModelUtils").prop(),b.growthChartData=d("WAWebModelUtils").prop(function(){return[]}),b.growthChart=d("WAWebModelUtils").derived(function(){var a=this.growthChartData;return a.length===0?[]:[{data:a,dataLabels:[{label:h._(/*BTDS*/"Net follows"),key:"net-follows"},{label:h._(/*BTDS*/"Follows"),key:"follows"},{label:h._(/*BTDS*/"Unfollows"),key:"unfollows"}],dataSetLabel:{label:h._(/*BTDS*/"Growth"),key:"growth"}}]},["growthChartData"]),b.rangeInDays=d("WAWebModelUtils").derived(function(){var a=this.rangeStart,b=this.rangeEnd;return a==null||b==null?0:d("WAWebClock").Clock.daysDeltaAbs(a,b)+1},["rangeStart","rangeEnd"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletterInsights";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g.NewsletterAdminInsights=b}),226);
__d("WAWebNewsletterSubscriberModel",["WAWebBaseModel","WAWebModelUtils","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebModelUtils").prop(),b.membership=d("WAWebModelUtils").prop(),b.isPendingAdmin=d("WAWebModelUtils").prop(),b.contact=d("WAWebModelUtils").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletterSubscriber";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g.NewsletterSubscriber=b}),98);
__d("WAWebNewsletterBridgeApi",["WALogger","WAWebCommonNewsletterEnums","WAWebContactCollection","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebMexNewsletterRoleChangeNotificationHandler","WAWebMexNewsletterUtils","WAWebMsgCollection","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterAdminInsightsModel","WAWebNewsletterBridgeMsgAddOnsUtils","WAWebNewsletterCollection","WAWebNewsletterEnforcementAlertCollection","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebNewsletterModelUtils","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterQuestionResponseCollection","WAWebNewsletterReportCollection","WAWebNewsletterSubscriberModel","WAWebNewsletterValidationUtils","WAWebProfilePicThumbCollection","WAWebQueryAndUpdateNewslettersMetadataAction","WAWebShouldUpdateLastAddOnPreview","WAWebShowNewsletterMetadataUpdateNotification","WAWebShowNewsletterRoleChangeNotification","WAWebUpdateLastAddOnPreviewChatAction","WAWebUpdateNewsletterMsgUIAction","WAWebUpdateUnreadChatAction","WAWebUserPrefsNewsletter","WAWebWidFactory","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=["id"],m=["id"],n=["id"],o=["id"],p=["id"],q=["id"];function r(a,b){a=c("WAWebNewsletterCollection").get(a);void (a==null?void 0:a.mute.setMute(b,!1,!0))}a={updateNewsletterMessageUI:function(a){var b=a.msg,c=a.chatID;a=a.isOrphan;if(a)return;a=d("WAWebMsgModelFromData").msgModelFromMsgData(b);return d("WAWebUpdateNewsletterMsgUIAction").updateNewsletterMessageUI(a,c)},deleteNewsletter:function(a){var b,e=a.id;a=a.keep;var f=c("WAWebNewsletterCollection")==null?void 0:c("WAWebNewsletterCollection").get(e),g=f==null?void 0:f.newsletterMetadata;if(a){g!=null&&(g.membershipType=d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest);return}a=f==null?void 0:f.msgs;a!=null&&d("WAWebMsgCollection").MsgCollection.remove(a);f==null||f["delete"]();f==null||(b=f.newsletterMetadata)==null||b["delete"]();d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.remove(e)},joinNewsletter:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.newsletter,e=a.metadata,f=a.pic,g=a.msgs;a=a.noEarlierMsgs;b=c("WAWebNewsletterCollection").gadd(b,{merge:!0});g!=null&&(yield d("WAWebMsgCollection").MsgCollection.processMultipleMessages(b.id,g,{isHistory:!0,add:"search"},"joinNewsletter",b.msgs));a===!0&&(b.msgs.msgLoadState.noEarlierMsgs=!0);d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.add(f,{merge:!0});c("WAWebNewsletterMetadataCollection").add(e,{merge:!0})});function e(b){return a.apply(this,arguments)}return e}(),updateNewsletterMetadata:function(a){var b=a.metadata,e=a.newsletter;a=a.pic;var f=b.id;b=babelHelpers.objectWithoutPropertiesLoose(b,l);e.id;e=babelHelpers.objectWithoutPropertiesLoose(e,m);a.id;a=babelHelpers.objectWithoutPropertiesLoose(a,n);c("WAWebNewsletterCollection").gadd(f).set(c("lodash").pickBy(e,function(a){return a!=null}),{merge:!0});c("WAWebNewsletterMetadataCollection").gadd(f).set(c("lodash").pickBy(b,function(a){return a!=null}),{merge:!0});d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(f).set(a,{merge:!0});b.name!=null&&d("WAWebContactCollection").ContactCollection.gadd(f).set({name:b.name},{merge:!0})},muteNewsletter:function(a){a=a.id;r(a,d("WAWebNewsletterModelUtils").MUTED_STATE)},unmuteNewsletter:function(a){a=a.id;r(a,d("WAWebNewsletterModelUtils").UNMUTED_STATE)},updateNewsletterSubscriberCount:function(a){var b,d,e=a.id;a=a.update;e=c("WAWebNewsletterCollection")==null||(b=c("WAWebNewsletterCollection").get(e))==null?void 0:b.newsletterMetadata;if(e==null)return;var f=e.size;d=(d=a.newSubscriberCount)!=null?d:Number(a.increment)+f;e.set("size",d)},updateNewsletterUnreadMsgCount:function(a){a=a.id;a=c("WAWebNewsletterCollection").get(a);a!=null&&d("WAWebUpdateUnreadChatAction").updateUnreadCountMD(a,0,!1)},subscribeToNewsletter:function(a){a=a.newsletter;var b=a.newsletterMetadata;if(b==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[subscribeToNewsletter] called with newsletterMetadata = null"])));return}b.membershipType=d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber;c("WAWebNewsletterCollection").add(a,{merge:!0})},loadNewsletterPreviewChat:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.metadata,e=a.pic,f=a.newsletter;a=a.messages;var g=b.id,h=babelHelpers.objectWithoutPropertiesLoose(b,o);c("WAWebNewsletterMetadataCollection").gadd(g).set(h,{merge:!0});if(e!=null){e.id;h=babelHelpers.objectWithoutPropertiesLoose(e,p);d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(g).set(h,{merge:!0})}d("WAWebContactCollection").ContactCollection.add({id:g,name:b.name},{merge:!0});c("WAWebNewsletterCollection").add(f,{merge:!0});e=c("WAWebNewsletterCollection").get(g);e!=null&&a!=null&&(yield d("WAWebMsgCollection").MsgCollection.processMultipleMessages(e.id,a,{isHistory:!0,add:"search"},"loadPreviewNewsletter",e.msgs));return e});function e(b){return a.apply(this,arguments)}return e}(),terminateNewsletter:function(a){var b=a.id;a=a.msgs;c("WAWebNewsletterMetadataCollection")==null||c("WAWebNewsletterMetadataCollection").gadd(b).set({terminated:!0},{merge:!0});if(a!=null){(b=c("WAWebNewsletterCollection").get(b))==null||b.msgs.add(a)}},updateNewsletterPicture:function(a){a=a.pic;var b=a.id;a=babelHelpers.objectWithoutPropertiesLoose(a,q);d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(b).set(a,{merge:!0})},updateNewsletterMessages:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=a.reactions,e=a.reactionIdsToRemove,f=a.timestamp,g=a.ids,h=a.viewCounts,i=a.pollVotes,j=a.questionResponsesCounts;a=a.msgs;yield (b=d("WAWebNewsletterBridgeMsgAddOnsUtils")).updateReactions({ids:g,reactions:c,reactionIdsToRemove:e});yield b.updatePollVotes({ids:g,pollVotes:i});b.updateViewCounts(h);b.updateQuestionResponsesCounts(j);b.updateLastUpdateTs(g,f);c=a==null?void 0:a.filter(function(a){return a.kind===d("WAWebMsgType").MsgKind.RevokedMessage});c!=null&&c.length>0&&(yield d("WAWebMsgCollection").MsgCollection.processMultipleMessages(c[0].id.remote,c,{},"updateNewsletterMessages"))});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterMessageDeliveryUpdate:function(a){var b,e=a.id,f=a.modelUpdatesToAdd;a=a.modelUpdatesToRemove;e=c("WAWebNewsletterCollection").get(e);if(e==null)return;(b=e.newsletterMetadata)==null||b.messageDeliveryUpdates.remove(a);(b=e.newsletterMetadata)==null||b.messageDeliveryUpdates.add(f.map(function(a){var b=d("WAWebMsgModelFromData").msgModelFromMsgData(a.msgData);d("WAWebMsgCollection").MsgCollection.add(b,{merge:!0});return babelHelpers["extends"]({},a,{msgModel:b})}),{merge:!0})},findMsgKeyFromServerId:function(a){var b,d=a.from,e=a.serverId;a=c("WAWebNewsletterCollection").get(d);return a==null||(b=a.msgs)==null||(b=b.findFirst(function(a){return a.serverId===e}))==null?void 0:b.id},updateMsgsViewed:function(a){a=a.ids;a.forEach(function(a){(a=d("WAWebMsgCollection").MsgCollection.get(a))==null||a.set("viewed",!0)})},updateGeosuspendedCountry:function(a){var b=a.id,d=a.countryCodes;a=a.toAdd;b=c("WAWebNewsletterCollection").get(b);if(b==null)return;if(a){(a=b.newsletterMetadata)==null||a.geosuspendedCountries.add(d.map(function(a){return{id:a,geosuspended:!0}}))}else{(a=b.newsletterMetadata)==null||a.geosuspendedCountries.remove(d.map(function(a){return a}))}},suspendNewsletter:function(a){a=a.id;c("WAWebNewsletterMetadataCollection").gadd(a).set({suspended:!0},{merge:!0})},geosuspendNewsletter:function(a){a=a.id;c("WAWebNewsletterMetadataCollection").gadd(a).set({suspended:!0,geosuspended:!0},{merge:!0})},updateProfilePictureDeletionAlertState:function(a){a=a.newsletterWid;c("WAWebNewsletterMetadataCollection").gadd(a).set({hasProfilePictureDeletionAlerts:!0},{merge:!0})},getActiveNewsletter:function(){var a;return(a=c("WAWebNewsletterCollection").getActive())==null?void 0:a.id},getNewsletterMetadata:function(a){a=a.id;return(a=c("WAWebNewsletterCollection").get(a))==null?void 0:a.newsletterMetadata},handleMyRoleChangeNotification:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.jid;var e=d("WAWebWidFactory").createWid(a);e=c("WAWebNewsletterCollection").get(e);e==null||(b=e.newsletterMetadata)==null||(b=b.subscribers)==null||b.reset();e=e!=null;yield d("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(a,{messageCount:e?void 0:1,fields:{membership:!0,state:!0,creationTime:e?void 0:!0,description:e?void 0:!0,handle:e?void 0:!0,inviteLink:e?void 0:!0,linkedAccounts:e?void 0:!0,muted:e?void 0:!0,name:e?void 0:!0,picture:e?void 0:!0,privacy:e?void 0:!0,subscribers:e?void 0:!0,verification:e?void 0:!0}})});function e(b){return a.apply(this,arguments)}return e}(),displayRoleChangeDesktopNotification:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.notification;var e=a.xwa2_notify_newsletter_admin_promote!=null?"promote":"demote";b=(b=a.xwa2_notify_newsletter_admin_promote)!=null?b:a.xwa2_notify_newsletter_admin_demote;if(b==null)return;a=b!=null?c("WAWebNewsletterCollection").get(b==null?void 0:b.id):null;var f=d("WAWebMexNewsletterRoleChangeNotificationHandler").getUserIdFromPayload(babelHelpers["extends"]({},b.user)),g=d("WAWebMexNewsletterUtils").mapRoleToMembership(b.user_new_role);if(f==null||a==null||g==null)return;b=b.admin&&d("WAWebMexNewsletterRoleChangeNotificationHandler").getUserIdFromPayload(babelHelpers["extends"]({},b.admin));a=a;yield d("WAWebShowNewsletterRoleChangeNotification").showNewsletterRoleChangeNotification({mode:e,user:f,admin:b,chat:a,newRole:g})});function e(b){return a.apply(this,arguments)}return e}(),handleOtherUserRoleChangeNotification:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e,f=a.jid,g=a.userId;a=a.newRole;f=d("WAWebWidFactory").createWid(f);f=c("WAWebNewsletterCollection").get(f);var h=f==null||(b=f.newsletterMetadata)==null||(b=b.subscribers)==null?void 0:b.get(g);if(h!=null)h.membership=a;else{h=d("WAWebContactCollection").ContactCollection.get(g);!h&&d("WAWebNewsletterGatingUtils").isNewsletterMultiAdminLidMigrationEnabled()&&(h=d("WAWebContactCollection").ContactCollection.gadd({id:g,type:"out"}));if(a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin&&h){var i;f==null||(i=f.newsletterMetadata)==null||(i=i.subscribers)==null||i.add(new(d("WAWebNewsletterSubscriberModel").NewsletterSubscriber)({id:g,membership:a,isPendingAdmin:!1,contact:h}))}}f==null||(e=f.newsletterMetadata)==null||(e=e.subscribers)==null||e.sort();if(a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin){var j;f==null||(j=f.newsletterMetadata)==null||(j=j.pendingAdmins)==null||j.remove(g)}});function e(b){return a.apply(this,arguments)}return e}(),updateChatPreviewFromReaction:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.reactionMsgObj;a=a.parentMsgKey;b=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates([d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(babelHelpers["extends"]({},b,{parentMsgKey:a.toString()}))]));b.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(b),d("WAWebUpdateLastAddOnPreviewChatAction").updateModelsForLastAddOnPreview(b))});function c(b){return a.apply(this,arguments)}return c}(),updateChatPreviewFromVote:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.voteMsgObj;a=a.parentMsgKey;b=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates([d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(babelHelpers["extends"]({},b,{parentMsgKey:a}),!1)]));b.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(b),d("WAWebUpdateLastAddOnPreviewChatAction").updateModelsForLastAddOnPreview(b))});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterReports:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.reports;d("WAWebNewsletterReportCollection").NewsletterReportCollection.reset();d("WAWebNewsletterReportCollection").NewsletterReportCollection.add(a)});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterReport:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.report;d("WAWebNewsletterReportCollection").NewsletterReportCollection.add(a,{merge:!0})});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterEnforcementAlerts:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.enforcementAlerts;d("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.reset();d("WAWebNewsletterEnforcementAlertCollection").NewsletterEnforcementAlertCollection.add(a)});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterQuestionResponses:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.responses;a=a.append;a||d("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.reset();d("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.add(b)});function c(b){return a.apply(this,arguments)}return c}(),hideNewsletterQuestionResponse:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.responseServerId,c=a.questionServerId;a=(yield (a=d("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.filter(function(a){return a.responseServerId===b&&a.questionServerId===c}))==null?void 0:a[0]);a!=null&&d("WAWebNewsletterQuestionResponseCollection").QuestionResponseCollection.remove(a)});function c(b){return a.apply(this,arguments)}return c}(),updateMyNewsletterMembershipRole:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.newsletter;a=a.newRole;var e=b.newsletterMetadata;if(e==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMembershipRole] called with newsletterMetadata = null"])));return}e.membershipType=a;c("WAWebNewsletterCollection").add(b,{merge:!0})});function e(b){return a.apply(this,arguments)}return e}(),updateNewsletterMemberRole:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.newsletter,c=a.member;a=a.newRole;var e=b.newsletterMetadata;if(e==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterMembershipRole] called with newsletterMetadata = null"])));return}e=(e=e.subscribers)==null?void 0:e.get(c.id);if(e!=null){e.membership=a;(c=b.newsletterMetadata)==null||(c=c.subscribers)==null||c.sort();e=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(b.id.toJid());yield d("WAWebUserPrefsNewsletter").flushCachedNewsletterSubscribers(e)}});function c(b){return a.apply(this,arguments)}return c}(),displayNewsletterMetadataUpdateNotification:function(a){a=a.notification;var b=a.newsletterId,e=a.actorId;a=a.updates;b=c("WAWebNewsletterCollection").get(b);if(b==null)return;void d("WAWebShowNewsletterMetadataUpdateNotification").showNewsletterMetadataUpdateNotification({chat:b,user:e,updates:a})},expireNewsletterAdminInvites:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.expiredMsgData;a.forEach(function(a){var b=a.id;a=a.newsletterAdminInviteInfo;(b=d("WAWebMsgCollection").MsgCollection.get(b))==null||b.set({newsletterAdminInviteInfo:a})})});function c(b){return a.apply(this,arguments)}return c}(),updateNewsletterInsights:function(a){var b=a.newsletter;a=a.insights;b=b.newsletterMetadata;if(b==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[updateNewsletterInsights] called with newsletterMetadata = null"])));return}var c=b.adminInsights;c==null?b.adminInsights=new(d("WAWebNewsletterAdminInsightsModel").NewsletterAdminInsights)(a):c.set(babelHelpers["extends"]({},a))},handleNewsletterWamoSubStatusChangeNotification:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.jid;a=a.wamoSubStatus;var e=d("WAWebWidFactory").createWid(b);e=c("WAWebNewsletterCollection").get(e);if(e==null)return;var f=e.newsletterMetadata;f!=null&&(f.wamoSubStatus=a);yield d("WAWebQueryAndUpdateNewslettersMetadataAction").queryAndUpdateNewsletterMetadataAction(b);a===d("WAWebCommonNewsletterEnums").WamoSubStatus.ACTIVE&&(yield d("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(e,{messageCount:d("WAWebNewsletterGatingUtils").getMaxMsgCountFromServer()}))});function e(b){return a.apply(this,arguments)}return e}()};g.NewsletterBridgeApi=a}),98);
__d("WAWebNewsletterBridgeMsgAddOnsUtils",["Promise","WAWebMsgCollection","WAWebNewsletterPollVotesModelCollection","WAWebNewsletterReactionCollection","WAWebNoop","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){if(a!=null&&a.size>0)for(a of a.entries()){var b=a[0],c=a[1];b=d("WAWebMsgCollection").MsgCollection.get(b);b==null||b.set("viewCount",c)}}function e(a){if(a!=null&&a.size>0)for(a of a.entries()){var b=a[0],c=a[1];b=d("WAWebMsgCollection").MsgCollection.get(b);b==null||b.set("questionResponsesCount",c)}}function f(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.reactions,f=a.ids;a=a.reactionIdsToRemove;a!=null&&d("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.remove(a);yield (h||(h=b("Promise"))).all((a=f.map(function(a){return d("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.find(a.toString())["catch"](c("WAWebNoop"))}))!=null?a:[]);d("WAWebNewsletterReactionCollection").NewsletterMessageReactionsCollection.add(e.map(function(a){return{id:a.parentMsgKey,reactionCountMap:a.emojiCountMap,reactionCountMapTs:a.serverTimestamp}}),{merge:!0})});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.pollVotes;a=a.ids;yield (h||(h=b("Promise"))).all((a=a.map(function(a){return d("WAWebNewsletterPollVotesModelCollection").NewsletterPollVotesModelCollection.find(a)["catch"](c("WAWebNoop"))}))!=null?a:[]);a=(yield h.all(e.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebMsgCollection").MsgCollection.get(a.parentMsgKey);b=b==null?void 0:b.pollOptions;if(b==null)return;b=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(b));return{id:a.parentMsgKey,pollVotesCountMap:l(a.voteCountMap,b),pollVotesCountMapTs:a.serverTimestamp}});return function(b){return a.apply(this,arguments)}}())));d("WAWebNewsletterPollVotesModelCollection").NewsletterPollVotesModelCollection.add(a.filter(Boolean),{merge:!0})});return k.apply(this,arguments)}function l(a,b){var c=new Map();for(a of a.entries()){var d=a[0],e=a[1];c.set(b.getLocalIdForHexHash(d),e)}return c}function m(a,b){b!=null&&a.forEach(function(a){a=d("WAWebMsgCollection").MsgCollection.get(a);a==null||a.set("lastUpdateFromServerTs",b)})}g.updateViewCounts=a;g.updateQuestionResponsesCounts=e;g.updateReactions=f;g.updatePollVotes=j;g.updateLastUpdateTs=m}),98);
__d("WAWebGetEphemeralFieldsMsgActionsUtils",["WAWebABProps","WAWebChatEphemerality","WAWebChatGetters"],(function(a,b,c,d,e,f,g){function a(a){var b={};d("WAWebChatEphemerality").isEphemeralSettingOn(a)&&(b.ephemeralDuration=d("WAWebChatEphemerality").getEphemeralSetting(a));var c=d("WAWebChatEphemerality").getEphemeralSettingTimestamp(a);c!=null&&(b.ephemeralSettingTimestamp=c);c=d("WAWebChatEphemerality").getDisappearingModeInitiator(a);c!=null&&(b.disappearingModeInitiator=c);if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){c=d("WAWebChatEphemerality").getDisappearingModeTrigger(a);c!=null&&(b.disappearingModeTrigger=c);c=d("WAWebChatEphemerality").getDisappearingModeInitiatedByMe(a);c!=null&&(b.disappearingModeInitiatedByMe=c)}if(d("WAWebChatGetters").getIsGroup(a)&&d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){c=d("WAWebChatEphemerality").getDisappearingModeTriggerGroups(a);c!=null&&(b.disappearingModeTrigger=c);c=d("WAWebChatEphemerality").getDisappearingModeInitiatedByMeGroups(a);c!=null&&(b.disappearingModeInitiatedByMe=c)}return babelHelpers["extends"]({},b)}g.getEphemeralFields=a}),98);
__d("WAWebMexCreateNewsletterAdminInviteJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"newsletter_id"},{defaultValue:null,kind:"LocalArgument",name:"user_id"}],b=[{kind:"Variable",name:"newsletter_id",variableName:"newsletter_id"},{kind:"Variable",name:"user_id",variableName:"user_id"}],c={alias:null,args:null,kind:"ScalarField",name:"invite_expiration_time",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexCreateNewsletterAdminInviteJobMutation",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdminInviteCreateResponse",kind:"LinkedField",name:"xwa2_newsletter_admin_invite_create",plural:!1,selections:[c],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexCreateNewsletterAdminInviteJobMutation",selections:[{alias:null,args:b,concreteType:"XWA2NewsletterAdminInviteCreateResponse",kind:"LinkedField",name:"xwa2_newsletter_admin_invite_create",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"9387141988078609",metadata:{},name:"WAWebMexCreateNewsletterAdminInviteJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexCreateNewsletterAdminInviteJob",["WANullthrows","WATimeUtils","WAWebLidMigrationUtils","WAWebMexClient","WAWebMexCreateNewsletterAdminInviteJobMutation.graphql","WAWebNewsletterRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=h!==void 0?h:h=b("WAWebMexCreateNewsletterAdminInviteJobMutation.graphql");function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebNewsletterRpcUtils").runWithBackoff(function(){return k(a,b)})});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebLidMigrationUtils").toUserLidOrThrow(b);a=(yield d("WAWebMexClient").fetchQuery(i,{newsletter_id:a,user_id:b.toString()}));b=a.xwa2_newsletter_admin_invite_create;a=c("WANullthrows")(b==null?void 0:b.invite_expiration_time);return{inviteExpiration:d("WATimeUtils").castToUnixTime(Number.parseInt(a,10))}});return l.apply(this,arguments)}g.createNewsletterAdminInvite=a}),98);
__d("WAWebNewsletterSendMsgAction",["Promise","WAAckLevel","WALogger","WANullthrows","WATimeUtils","WAWebChatGetters","WAWebDBProcessEditProtocolMsgs","WAWebFrontendMsgGetters","WAWebGetEphemeralFieldsMsgActionsUtils","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMexCreateNewsletterAdminInviteJob","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgKey","WAWebMsgLinks","WAWebMsgModel","WAWebMsgModelFromData","WAWebMsgRcatUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterErrors","WAWebNewsletterGatingUtils","WAWebNewsletterSendMessageJob","WAWebNewsletterSendMsgActionUtils","WAWebNewsletterUpdateMsgsRecordsJob","WAWebNewsletterValidationUtils","WAWebPollsGatingUtils","WAWebSendMsgChatAction","WAWebSendMsgResultAction","WAWebSendTextMsgChatAction","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;function a(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=d("WAWebStateUtils").unproxy(a);if(!d("WAWebChatGetters").getIsNewsletter(a))throw new(d("WAWebNewsletterErrors").UnexpectedNonNewsletterChatError)();b=(yield d("WAWebSendTextMsgChatAction").createTextMsgData(a,b,e));if(b==null)throw c("err")("Failed to generate MsgData");d("WAWebNewsletterSendMsgActionUtils").validateMsgDataForMsgSend(b,a);e=new(d("WAWebMsgModel").Msg)(b);b=d("WAWebMsgLinks").getLinksFromMsg(e).length>0?"media":"text";return E({chat:a,msg:e,type:b})});return u.apply(this,arguments)}function e(a){var c=d("WAWebFrontendMsgGetters").getChat(a);return d("WAWebFrontendMsgGetters").getAsMms(a)?(t||(t=b("Promise"))).resolve():E({chat:c,msg:a,type:"text"})}function f(a,c,e){if(!d("WAWebChatGetters").getIsNewsletter(a))return(t||(t=b("Promise"))).reject(new(d("WAWebNewsletterErrors").UnexpectedNonNewsletterChatError)());c=c instanceof d("WAWebMsgModel").Msg?c:new(d("WAWebMsgModel").Msg)(c);c.local=!0;return E({chat:a,msg:c,type:"media",uploadMediaMsg:e})}function v(a){a.wamMessageSendReporter=new(d("WAWebMessageSendReporter").MessageSendReporter)(a),a.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:a.to,mediaType:a.getWamMediaType(),messageType:a.getWamMessageType()})}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=d("WAWebDBProcessEditProtocolMsgs").generateMessageEdit(d("WAWebMsgDataFromModel").msgDataFromMsgModel(a),d("WAWebMsgDataFromModel").msgDataFromMsgModel(b));c=c.editedMsgData;a.set(c);c=d("WAWebMsgGetters").getIsMedia(a);var e=d("WAWebMsgGetters").getLinkPreview(a),f=d("WAWebMsgRcatUtils").getContentIdString(a,!0);f=f!=null&&d("WAWebNewsletterGatingUtils").isRCATFieldGenerationEnabled()?f:null;c=(yield d("WAWebNewsletterSendMessageJob").sendNewsletterMessageJob({type:"edit",editType:c||e?"media":"text",msg:a,newsletterJid:d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(a.id.remote.toJid()),contentId:f}));void b.updateAck(d("WAAckLevel").ACK.SENT);return{t:c.ack.t,messageSendResult:c.success===!0?d("WAWebSendMsgResultAction").SendMsgResult.OK:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to edit message"]))).devConsole(a).tags("newsletter").sendLogs("newsletter-edit-fail");return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}});return x.apply(this,arguments)}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgData;a=a.chat;if(!d("WAWebNewsletterGatingUtils").isNewsletterPollsCreationEnabled()){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Poll creation is not enabled"]))).tags("newsletter").sendLogs("poll-creation-not-enabled");throw c("err")("Poll creation is not enabled")}b=new(d("WAWebMsgModel").Msg)(b);a=(yield E({chat:a,msg:b,type:"pollCreation"}));return[b,a]});return z.apply(this,arguments)}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgData;a=a.chat;if(!d("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled()){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Poll forwarding is not enabled"]))).tags("newsletter").sendLogs("poll-forwarding-not-enabled");throw c("err")("Poll forwarding is not enabled")}b=new(d("WAWebMsgModel").Msg)(b);a=(yield E({chat:a,msg:b,type:"pollResultSnapshot"}));return[b,a]});return B.apply(this,arguments)}function C(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebFrontendMsgGetters").getIsMms(b)){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Forwarding MMS messages is not supported"]))).devConsole("Forwarding MMS messages must be done via MediaPrep");return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}var c=(yield d("WAWebNewsletterSendMsgActionUtils").prepMsgDataForForward(b));return E({chat:a,msg:d("WAWebMsgModelFromData").msgModelFromMsgData(c),type:b.type===d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT&&d("WAWebPollsGatingUtils").isPollResultSnapshotPollTypeEnvelopeEnabled()?"pollResultSnapshot":"text"})});return D.apply(this,arguments)}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.chat,e=a.type,f=a.uploadMediaMsg,g=a.msg;v(g);d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Sending message "," -> ",""])),(a=g)==null?void 0:a.id,c.id.toJid());(a=g.wamMessageSendPerfReporter)==null||a.startRenderedStage();yield c.addQueue.enqueue((t||(t=b("Promise"))).resolve(g)).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebNewsletterUpdateMsgsRecordsJob").addNewsletterMsgsRecords([d("WAWebMsgDataFromModel").msgDataFromMsgModel(g)]),c.msgs.add(a),c.t=g.t});return function(b){return a.apply(this,arguments)}}());(a=g.wamMessageSendPerfReporter)==null||a.postRenderedStage();try{try{f!=null&&(g=(yield f(g)))}catch(a){throw new(d("WAWebNewsletterErrors").NewsletterMediaUploadError)()}(a=g.wamMessageSendPerfReporter)==null||a.startReadyToSendStage();f=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(c.id.toJid());a=d("WAWebMsgRcatUtils").getContentIdString(g,!0);a=e==="media"?{msg:g,type:e,newsletterJid:f,mediaHandle:g.mediaHandle,contentId:a!=null&&d("WAWebNewsletterGatingUtils").isRCATFieldGenerationEnabled()?d("WAWebMsgRcatUtils").getContentIdString(g,!0):null}:{msg:g,type:e,newsletterJid:f};(e=g.wamMessageSendPerfReporter)==null||e.postReadyToSendStage();(f=g.wamMessageSendPerfReporter)==null||f.startWrittenWireStage();e=(yield c.sendQueue.enqueue(d("WAWebNewsletterSendMessageJob").sendNewsletterMessageJob(a)));(f=g.wamMessageSendPerfReporter)==null||f.postWrittenWireStage();switch(e.success){case!0:d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Sent message "," -> ",""])),(a=g)==null?void 0:a.id,c.id.toJid());f=e.serverId;if(f==null)throw new(d("WAWebNewsletterErrors").MissingNewsletterServerIdError)();g.serverId=e.serverId;g.t=e.ack.t;void g.updateAck(d("WAAckLevel").ACK.SENT,!0);try{(a=g.wamMessageSendPerfReporter)==null||a.startSavedStage();yield d("WAWebNewsletterUpdateMsgsRecordsJob").updateNewsletterMsgRecord(g);(f=g.wamMessageSendPerfReporter)==null||f.postSavedStage()}catch(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to persist sent message on db"]))).tags("newsletter").devConsole(a).sendLogs("newsletter-send-message-db-fail")}(a=g.wamMessageSendReporter)==null||a.postSuccess();return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK};case!1:d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to send message, "," from server"])),e.ack.error).tags("newsletter").devConsole(e.ack.error).sendLogs("newsletter-send-message-fail-server");void g.updateAck(d("WAAckLevel").ACK.FAILED,!0);(f=g.wamMessageSendReporter)==null||f.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!1});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}}catch(b){b instanceof d("WAWebNewsletterErrors").MissingNewsletterServerIdError?d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Empty serverId returned from server"]))).tags("newsletter").sendLogs("newsletter-empty-server-id"):d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to send message"]))).tags("newsletter").devConsole(b);void g.updateAck(d("WAAckLevel").ACK.FAILED,!0);(a=g.wamMessageSendReporter)==null||a.postFailure({result:b instanceof d("WAWebNewsletterErrors").NewsletterMediaUploadError?d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!1});return b instanceof d("WAWebNewsletterErrors").NewsletterMediaUploadError?{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}:{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}finally{g.wamMessageSendReporter=null,g.wamMessageSendPerfReporter=null}});return F.apply(this,arguments)}function G(a,b){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.newsletterWid,f=b.invitee,g=b.inviteMessage;b=b.base64Thumb;try{a=d("WAWebStateUtils").unproxy(a);f=(yield d("WAWebMexCreateNewsletterAdminInviteJob").createNewsletterAdminInvite(d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(e.toJid()),f));f=f.inviteExpiration;var h=c("WANullthrows")(c("WAWebNewsletterCollection").get(e)),i=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();i=babelHelpers["extends"]({ack:d("WAAckLevel").ACK.CLOCK,from:i,id:new(c("WAWebMsgKey"))({from:i,to:a.id,id:yield c("WAWebMsgKey").newId(),participant:void 0,selfDir:"out"}),local:!0,t:d("WATimeUtils").unixTime(),to:a.id,type:"newsletter_admin_invite",kind:"newsletterAdminInvite",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,isNewMsg:!0,newsletterAdminInviteInfo:{newsletterId:d("WAWebWidFactory").asNewsletterWidOrThrow(e),newsletterName:h==null?void 0:h.name,inviteExpiration:c("WANullthrows")(f),inviteMessage:g,pictureThumbnail:b}},d("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(a));return d("WAWebSendMsgChatAction").addAndSendMsgToChat(a,i)[1]}catch(a){d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[sendNewsletterAdminInviteMessage] Failed to send message ",""])),a).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-to-send-admin-invite");return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}});return H.apply(this,arguments)}function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.newsletterWid,f=b.inviteMessage;b=b.base64Thumb;try{a=d("WAWebStateUtils").unproxy(a);var g=c("WANullthrows")(c("WAWebNewsletterCollection").get(e)),h=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();h=babelHelpers["extends"]({ack:d("WAAckLevel").ACK.CLOCK,from:h,id:new(c("WAWebMsgKey"))({from:h,to:a.id,id:yield c("WAWebMsgKey").newId(),participant:void 0,selfDir:"out"}),local:!0,t:d("WATimeUtils").unixTime(),to:a.id,type:"newsletter_follower_invite",kind:"newsletterFollowerInvite",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,broadcast:!0,isNewMsg:!0,newsletterFollowerInviteInfo:{newsletterId:d("WAWebWidFactory").asNewsletterWidOrThrow(e),newsletterName:g==null?void 0:g.name,inviteMessage:f,pictureThumbnail:b}},d("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(a));return d("WAWebSendMsgChatAction").addAndSendMsgToChat(a,h)[1]}catch(a){d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[sendNewsletterFollowerInviteMessage] Failed to send message ",""])),a).tags("newsletter").devConsole(a).sendLogs("newsletter-failed-to-send-follower-invite");return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}});return J.apply(this,arguments)}g.sendNewsletterTextMsg=a;g.resendNewsletterMsg=e;g.sendNewsletterMediaMsg=f;g.sendNewsletterEditMsg=w;g.sendNewsletterPollCreationMsg=y;g.sendNewsletterPollResultSnapshotMsg=A;g.forwardNewsletterMessage=C;g.sendNewsletterAdminInviteMessage=G;g.sendNewsletterFollowerInviteMessage=I}),98);
__d("WAWebNewsletterSendMsgActionUtils",["WAWebFrontendMsgGetters","WAWebMediaConstants","WAWebMediaGetUploadOriginForChat","WAWebMediaOpaqueData","WAWebMediaUploadMmsThumbnail","WAWebMmsMediaTypes","WAWebMsgModelFromData","WAWebMsgModelUtils","WAWebNewsletterErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebMsgModelUtils").notRefiningTypeIsUrl(a)?i(a):a});return h.apply(this,arguments)}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebFrontendMsgGetters").getAsUrl(d("WAWebMsgModelFromData").msgModelFromMsgData(a));if(b==null)return a;var e=b.thumbnailHQ;if(e==null)return a;e=(yield c("WAWebMediaUploadMmsThumbnail")({thumbnail:yield c("WAWebMediaOpaqueData").createFromBase64Jpeg(e),mediaType:d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK,uploadOrigin:c("WAWebMediaGetUploadOriginForChat")(d("WAWebFrontendMsgGetters").getChat(b.unsafe())),forwardedFromWeb:!0,timeout:d("WAWebMediaConstants").MMS_THUMBNAIL_UPLOAD_TIMEOUT,isViewOnce:!1}));b=e.filehash;e=e.mediaEntry;return babelHelpers["extends"]({},a,{thumbnailDirectPath:e==null?void 0:e.directPath,thumbnailSha256:b,thumbnailEncSha256:void 0,mediaKey:void 0,mediaKeyTimestamp:void 0})});return j.apply(this,arguments)}function e(a,b){if(a.quotedParticipant!=null&&a.quotedParticipant!==b.id)throw new(d("WAWebNewsletterErrors").UnexpectedNewsletterQuotedParticipantMismatchError)()}g.prepMsgDataForForward=a;g.validateMsgDataForMsgSend=e}),98);
__d("WAWebNewsletterViewModeUIUtils",["WAWebMessageAssociationUIUtils","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b===void 0&&(b=d("WAWebViewMode.flow").ViewModeSurface.CHAT);a=d("WAWebMessageAssociationUIUtils").getHiddenViewModeMessagesForChat(a,b);b=a.map(function(a){return a.serverId}).filter(Boolean);return new Set(b)}g.getHiddenMessageServerIdsForChat=a}),98);
__d("WAWebChatFlowTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Group:"group",Broadcast:"broadcast",Chat:"chat",Community:"community",Newsletter:"newsletter"});f.ChatKindType=a}),66);
__d("WAWebInfoFlowStep",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["GroupInfo","BroadcastInfo","ContactInfo","NewsletterInfo","DeleteNewsletter","NewsletterAdminCenter","NewsletterInsights","NewsletterLink","NewsletterSettings","NewsletterTransferOwnershipSelection","NewsletterTransferOwnership","ProductDetail","ProductCollection","ProductLink","ProductInfo","CatalogLink","Cart","Catalog","ProductList","Starred","Wallpaper","Kept","GroupSettings","MediaGallery","GroupInviteLink","PendingParticipants","Verification","DefaultEphemerality","Ephemeral","SentForAdminReview","SaveContactFlow","EventInfo","AllEvents","LimitSharing","Notifications"]);f.InfoFlowStep=a}),66);
__d("WAWebHostedGroupUtils",["fbt","WAWebABProps","WAWebFrontendContactGetters"],(function(a,b,c,d,e,f,g,h){a=function(){return d("WAWebABProps").getABPropConfigValue("is_capi_groups_alpha_enabled")};b=function(a,b){b===void 0&&(b=!1);return b?h._(/*BTDS*/"{ownerName} uses a secure service from Meta to manage this chat.",[h._param("ownerName",d("WAWebFrontendContactGetters").getFormattedName(a))]):h._(/*BTDS*/"{ownerName} uses a secure service from Meta to manage this chat. Tap to learn more.",[h._param("ownerName",d("WAWebFrontendContactGetters").getFormattedName(a))])};g.isWAHostedGroupEnabled=a;g.getSecureServicesBannerText=b}),226);
__d("WAWebParticipantListUtils",["fbt","WAWebABProps","WAWebAlphaRegex","WAWebContactGetters","WAWebFbtIntlList","WAWebFrontendContactGetters","WAWebHostedGroupUtils","WAWebMiscGatingUtils","fbs","partitionArray"],(function(a,b,c,d,e,f,g,h){function a(a){if(a.participants.length===0)return h._(/*BTDS*/"Group").toString();if(a.participants.length===1){var b;b=(b=a.participants.head())==null?void 0:b.contact;if(b!=null&&d("WAWebContactGetters").getIsMe(b))return h._(/*BTDS*/"You").toString()}b=i(a,!0);if(b.length===1)return b[0];else if(b.length<=3)return c("WAWebFbtIntlList")(b,c("WAWebFbtIntlList").CONJUNCTIONS.AND,c("WAWebFbtIntlList").DELIMITERS.COMMA).toString();if(b.length>=4){a=b[0];var e=h._(/*BTDS*/"_j{\"*\":\"{other_participants} others\",\"_1\":\"1 other\"}",[h._plural(b.length-1,"other_participants")]).toString();return c("WAWebFbtIntlList")([a,e],c("WAWebFbtIntlList").CONJUNCTIONS.AND).toString()}return b.join()}function b(a,b,e){b===void 0&&(b=!1);e===void 0&&(e=!1);if(a.participants.length===0)return e?c("fbs")._(/*BTDS*/"Waiting for others to join").toString():c("fbs")._(/*BTDS*/"Group").toString();if(a.participants.length===1){e=(e=a.participants.head())==null?void 0:e.contact;if(e!=null&&d("WAWebContactGetters").getIsMe(e))return h._(/*BTDS*/"You").toString()}e=i(a,b);if(e.length===1)return e.pop();a=c("WAWebFbtIntlList")(e,c("WAWebFbtIntlList").CONJUNCTIONS.AND,c("WAWebFbtIntlList").DELIMITERS.COMMA);return a.toString()}function i(a,b){b===void 0&&(b=!1);var e=a.participants.length;b?b=a.participants.filter(function(a){return!d("WAWebContactGetters").getIsMe(a.contact)}):b=a.participants;var f=b.filter(function(a){return d("WAWebContactGetters").getIsMyContact(a.contact)});b=b.filter(function(a){return!d("WAWebContactGetters").getIsMyContact(a.contact)});var g=[];d("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")&&e>=3&&(g=b.filter(function(a){return d("WAWebContactGetters").getNotifyName(a.contact)!=null}));e=b.filter(function(a){return!g.includes(a)});b=e;e=[];d("WAWebMiscGatingUtils").isDropLastNameEnabled()?e=f.map(function(b){b=b.contact;return a.hasUniqueShortNameMention(b)?d("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(b):d("WAWebFrontendContactGetters").getFormattedName(b).replace(/\s/g," ")}):e=f.map(function(a){a=d("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(a.contact);return a});f=[];d("WAWebMiscGatingUtils").isDropLastNameEnabled()?f=g.map(function(a){a=a.contact;var b=d("WAWebContactGetters").getNotifyName(a);b=b!=null?b:d("WAWebFrontendContactGetters").getFormattedName(a);return"~"+b.replace(/\s/g," ")}):f=g.map(function(a){var b=d("WAWebContactGetters").getNotifyName(a.contact);b=b!=null?b:d("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(a.contact);a=b.split(/\s/);a=a[0];return"~"+(c("WAWebAlphaRegex").exec(a)?a:b)});b=b.map(function(a){return d("WAWebFrontendContactGetters").getFormattedName(a.contact)});return e.sort().concat(f.sort().concat(b.sort()))}function j(a){a=d("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(a);var b=a.split(/\s/);b=b[0];return c("WAWebAlphaRegex").exec(b)?b:a}function k(a,b){a=a;var e=c("partitionArray")(a,function(a){return d("WAWebContactGetters").getIsMe(a.contact)}),f=e[0];e=e[1];a=e.concat(f);if(d("WAWebMiscGatingUtils").isDropLastNameEnabled())return a.map(function(a){a=a.contact;return b.hasUniqueShortNameMention(a)?d("WAWebFrontendContactGetters").getFormattedShortNameWithNonBreakingSpaces(a):d("WAWebFrontendContactGetters").getFormattedName(a).replace(/\s/g," ")}).filter(Boolean);if(d("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&b.hasCapi===!0){e=c("partitionArray")(a,function(a){return a.id.equals(b.owner)});f=e[0];e=e[1];a=f.concat(e)}return a.map(function(a){return j(a.contact)}).filter(Boolean)}function e(a){return k(a.participants.toArray(),a)}function f(a){return k(a.participants.getAdmins(),a)}function l(a){var b=a.participants.length;if(b===0)return h._(/*BTDS*/"Group call").toString();a=i(a,!1);if(b===1)return a[0];if(b===2)return c("WAWebFbtIntlList")(a.slice(0,2),c("WAWebFbtIntlList").CONJUNCTIONS.AND).toString();a=a[0];b=b-1;b=h._(/*BTDS*/"_j{\"*\":\"{other_participants} others\",\"_1\":\"1 other\"}",[h._plural(b,"other_participants")]).toString();return c("WAWebFbtIntlList")([a,b],c("WAWebFbtIntlList").CONJUNCTIONS.AND).toString()}g.calculateUnnamedGroupParticipantsList=a;g.calculateUnnamedGroupFullParticipantsList=b;g.getFirstNameForContact=j;g.calculateParticipantsList=e;g.calculateAdminsList=f;g.formatParticipantNames=l}),226);
__d("WAWebNotificationsNewsletterMetadataUpdateNotification",["fbt","WATimeUtils","WAWebBaseNotification","WAWebChatFlowTypes","WAWebCmd","WAWebContactCollection","WAWebFbtIntlList","WAWebInfoFlowStep","WAWebNotificationIconUtils","WAWebParticipantListUtils","WAWebWidFormat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function c(b){var c;c=a.call(this)||this;c.updates=b.updates;c.user=b.user;c.chat=b.chat;return c}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.buildKey=function(){return"newslowner:"+this.chat.id.toString()+":"+this.user.toString()+":"+d("WATimeUtils").unixTime().toString()};e.getBannerOptions=function(){var a=this,b=this.updates.some(function(a){a=a.item;return a==="reaction_setting"})?d("WAWebInfoFlowStep").InfoFlowStep.NewsletterSettings:d("WAWebInfoFlowStep").InfoFlowStep.NewsletterInfo;return{wid:this.chat.id,title:this.chat.name,body:this.getNotificationBody(),onClick:function(){d("WAWebCmd").Cmd.openNewsletterProfile(a.chat,b)}}};e.getNotificationBody=function(){var a=this.getActor();return j(a,this.updates).toString()};e.getActor=function(){var a=d("WAWebContactCollection").ContactCollection.get(this.user);return a!=null?d("WAWebParticipantListUtils").getFirstNameForContact(a):d("WAWebWidFormat").widToFormattedUser(this.user)};e.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();e.matchesChat=function(a){return a.equals(this.chat)};e.getChatKind=function(){return d("WAWebChatFlowTypes").ChatKindType.Newsletter};return c}(d("WAWebBaseNotification").WABaseNotification);function i(a){switch(a){case"name":return h._(/*BTDS*/"name");case"description":return h._(/*BTDS*/"description");case"profile_picture":return h._(/*BTDS*/"profile picture");case"reaction_setting":return h._(/*BTDS*/"reaction settings")}}function j(a,b){if(b.length===1&&b[0].item==="name"){var d=b[0].value;return h._(/*BTDS*/"{actor} changed the channel name to \"{updateValue}\".",[h._param("actor",a),h._param("updateValue",d)])}d=b.map(function(a){a=a.item;return i(a)});b=c("WAWebFbtIntlList")(d,c("WAWebFbtIntlList").CONJUNCTIONS.AND,c("WAWebFbtIntlList").DELIMITERS.COMMA);return h._(/*BTDS*/"{actor} changed the channel {update}.",[h._param("actor",a),h._param("update",b.toString())])}g.WANewsletterMetadataUpdateNotification=a}),226);
__d("WAWebNotificationsNewsletterRoleChangeNotification",["fbt","WAWebBaseNotification","WAWebChatFlowTypes","WAWebContactCollection","WAWebNotificationIconUtils","WAWebParticipantListUtils","WAWebUserPrefsMeUser","WAWebWidFormat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function c(b){var c;c=a.call(this)||this;c.mode=b.mode;c.admin=b.admin;c.user=b.user;c.chat=b.chat;return c}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.buildKey=function(){return"newsladmin:"+this.chat.id.toString()+":"+this.mode+":"+this.user.toString()};e.getBannerOptions=function(){var a=this.getNotificationUser(),b=d("WAWebUserPrefsMeUser").isMeAccount(this.user);return{wid:this.chat.id,title:this.chat.name,body:i[this.mode](a,b).toString()}};e.getNotificationUser=function(){var a=this.mode==="ownership"?this.admin:this.user;if(a==null)return null;a=d("WAWebContactCollection").ContactCollection.get(a);return a!=null?d("WAWebParticipantListUtils").getFirstNameForContact(a):d("WAWebWidFormat").widToFormattedUser(this.user)};e.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getChatNotificationIcon(this.chat,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();e.matchesChat=function(a){return this.chat.equals(a)};e.getChatKind=function(){return d("WAWebChatFlowTypes").ChatKindType.Newsletter};return c}(d("WAWebBaseNotification").WABaseNotification);var i={promote:function(a,b){return b?h._(/*BTDS*/"You are now an admin."):h._(/*BTDS*/"{who} is now an admin.",[h._param("who",a)])},demote:function(a,b){return b?h._(/*BTDS*/"You are no longer an admin."):h._(/*BTDS*/"{who} is no longer an admin.",[h._param("who",a)])},ownership:function(a){return a==null?h._(/*BTDS*/"You are now the channel owner."):h._(/*BTDS*/"{who} made you the channel owner.",[h._param("who",a)])}};g.WANewsletterRoleChangeNotification=a}),226);
__d("WAWebShowNewsletterMetadataUpdateNotification",["WAWebNewsletterMembershipUtil","WAWebNotificationController","WAWebNotificationsNewsletterMetadataUpdateNotification","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chat,c=a.user;a=a.updates;var e=b.newsletterMetadata;if(e==null)return;if(!d("WAWebNewsletterMembershipUtil").iAmOwner(e))return;if(d("WAWebUserPrefsMeUser").isMeAccount(c))return;if(a.length===0)return;return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsNewsletterMetadataUpdateNotification").WANewsletterMetadataUpdateNotification)({chat:b,user:c,updates:a}))});return h.apply(this,arguments)}g.showNewsletterMetadataUpdateNotification=a}),98);
__d("WAWebShowNewsletterRoleChangeNotification",["Promise","WAWebCommonNewsletterEnums","WAWebNewsletterMembershipUtil","WAWebNotificationController","WAWebNotificationsNewsletterRoleChangeNotification","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){var h;function a(a){var c=a.newRole,e=a.mode,f=a.chat,g=a.admin;a=a.user;var i=f.newsletterMetadata;if(i==null)return(h||(h=b("Promise"))).resolve();var j=e==="promote"&&d("WAWebUserPrefsMeUser").isMeAccount(a)&&c===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner;if(j)return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsNewsletterRoleChangeNotification").WANewsletterRoleChangeNotification)({mode:"ownership",chat:f,admin:g,user:a}));j=d("WAWebNewsletterMembershipUtil").iAmOwner(i)&&e==="promote"&&c===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin&&!d("WAWebUserPrefsMeUser").isMeAccount(a);i=e==="demote"&&c===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber&&!d("WAWebUserPrefsMeUser").isMeAccount(a)&&a.toJid()===(g==null?void 0:g.toJid());c=e==="demote"&&d("WAWebUserPrefsMeUser").isMeAccount(a)&&a.toJid()!==(g==null?void 0:g.toJid());return j||i||c?d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsNewsletterRoleChangeNotification").WANewsletterRoleChangeNotification)({mode:e,chat:f,admin:g,user:a})):(h||(h=b("Promise"))).resolve()}g.showNewsletterRoleChangeNotification=a}),98);
__d("WAWebWamEnumChannelEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,UPDATES_TAB:1,DIRECTORY:2,LINK:3,DEEPLINK:4,FORWARDED_MESSAGE:5,DIRECTORY_SEARCH:6,RECOMMENDED_LIST:7,NOTIFICATION:8,UPDATES_TAB_SEARCH:9,STATUS:10,ADMIN_INVITE_MESSAGE:11,MEDIA_BROWSER:12,SIMILAR_CHANNEL:13,DIRECTORY_CATEGORIES:14,DIRECTORY_CATEGORIES_SEARCH:15,NEWSLETTER_MEDIA_GALLERY_MEDIA:16,NEWSLETTER_MEDIA_GALLERY_LINKS:17,THREAD_CHAIN_PILL:18,THREAD_CHAIN_SWIPE_UP:19,RECENT_SEARCHES:20,NEWSLETTER_CREATION_UPDATES_TAB:21,NEWSLETTER_CREATION_DIRECTORY:22,NEWSLETTER_CREATION_DIRECTORY_CATEGORIES:23,INVITE_CONTACTS_TO_FOLLOW_MESSAGE:24,MUSIC_ATTRIBUTION_BOTTOM_SHEET_FROM_CHAT:25});f.CHANNEL_ENTRY_POINT=a}),66);
__d("WAWebWamEnumChannelEntryPointApp",[],(function(a,b,c,d,e,f){a=Object.freeze({EXTERNAL_UNKNOWN:1,WHATSAPP:2});f.CHANNEL_ENTRY_POINT_APP=a}),66);
__d("WAWebWamEnumChannelEntryPointMetadata",[],(function(a,b,c,d,e,f){a=Object.freeze({STATUS_HEADER:1,LINK_TOOLTIP:2,LINK_BUTTON:3,POST_TOOLTIP:4});f.CHANNEL_ENTRY_POINT_METADATA=a}),66);
__d("WAWebWamEnumChannelEventSurface",[],(function(a,b,c,d,e,f){a=Object.freeze({CHANNEL_UPDATES_HOME:1,CHANNEL_THREAD:2,CHANNEL_DIRECTORY:3,CHANNEL_DIRECTORY_SEARCH:4,CHANNEL_PROFILE:5,CHANNEL_UPDATES_HOME_SEARCH:6,CHANNEL_DIRECTORY_CATEGORIES:7,CHANNEL_DIRECTORY_CATEGORIES_SEARCH:8});f.CHANNEL_EVENT_SURFACE=a}),66);
__d("WAWebWamEnumChannelEventUnit",[],(function(a,b,c,d,e,f){a=Object.freeze({RECOMMENDED_CHANNELS:1,SIMILAR_CHANNELS:2,RECENT_SEARCHES:3});f.CHANNEL_EVENT_UNIT=a}),66);
__d("WAWebChannelCoreEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChannelEntryPoint","WAWebWamEnumChannelEntryPointApp","WAWebWamEnumChannelEntryPointMetadata","WAWebWamEnumChannelEventSurface","WAWebWamEnumChannelEventType","WAWebWamEnumChannelEventUnit","WAWebWamEnumTsSurface"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ChannelCoreEvent:[4692,{channelCoreEventSequenceNumber:[8,a.TYPES.INTEGER],channelCoreEventType:[1,d("WAWebWamEnumChannelEventType").CHANNEL_EVENT_TYPE],channelDirectorySessionId:[7,a.TYPES.INTEGER],channelDiscoveryQueryId:[15,a.TYPES.STRING],channelDiscoverySearchId:[16,a.TYPES.STRING],channelEntryPoint:[2,d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT],channelEntryPointApp:[3,d("WAWebWamEnumChannelEntryPointApp").CHANNEL_ENTRY_POINT_APP],channelEntryPointMetadata:[10,d("WAWebWamEnumChannelEntryPointMetadata").CHANNEL_ENTRY_POINT_METADATA],channelEventUnit:[12,d("WAWebWamEnumChannelEventUnit").CHANNEL_EVENT_UNIT],cid:[4,a.TYPES.STRING],directoryChannelIndex:[9,a.TYPES.INTEGER],discoverySurface:[14,d("WAWebWamEnumTsSurface").TS_SURFACE],entryPointMetadata:[5,a.TYPES.STRING],eventSurface:[6,d("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE],similarChannelsSessionId:[13,a.TYPES.INTEGER],unifiedSessionId:[17,a.TYPES.STRING],updatesTabSessionId:[18,a.TYPES.INTEGER]},[1,1,1],"regular"]},{ChannelCoreEvent:[]});g.ChannelCoreEventWamEvent=b}),98);
__d("WAWebSimilarNewsletterSessionId",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo;function j(){return 1+Math.floor(Number.MAX_SAFE_INTEGER*Math.random())}function a(){var a=i(function(){return j()},[]);return a}function b(a){return a}g.generateSessionId=j;g.useSimilarNewslettersSessionId=a;g.newsletterSessionIdToInt=b}),98);
__d("WAWebNewsletterAttributionLogging",["WALogger","WAWebChannelCoreEventWamEvent","WAWebCommonNewsletterEnums","WAWebNewsletterCollection","WAWebNewsletterDirectoryFilterUtils","WAWebNewsletterGatingUtils","WAWebSimilarNewsletterSessionId","WAWebWamEnumChannelEntryPoint","WAWebWamEnumChannelEntryPointApp","WAWebWamEnumTsSurface"],(function(a,b,c,d,e,f,g){var h=["cid","eventSurface","channelCoreEventType","similarChannelSessionId","eventUnit","entryPoint"],i;function j(a){switch(a){case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.LINK:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.RECOMMENDED_LIST:case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.UPDATES_TAB:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_UPDATES_HOME;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_CATEGORIES:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_DIRECTORY_CATEGORIES;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.FORWARDED_MESSAGE:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_CATEGORIES_SEARCH:case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.DIRECTORY_SEARCH:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_DIRECTORY_CATEGORIES_SEARCH;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.STATUS:return d("WAWebWamEnumTsSurface").TS_SURFACE.STATUS_VIEWER_SHEET;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.ADMIN_INVITE_MESSAGE:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHAT_THREAD;case d("WAWebWamEnumChannelEntryPoint").CHANNEL_ENTRY_POINT.SIMILAR_CHANNEL:return d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_PROFILE;default:d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected entry point: ",""])),a).tags("newsletter-logging").sendLogs("Unexpected entry point in newsletter open logging");return d("WAWebWamEnumTsSurface").TS_SURFACE.UNKNOWN}}function k(){return c("WAWebNewsletterCollection").some(function(a){return((a=a.newsletterMetadata)==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber})?1:0}a=function(){function a(){this.$6={}}var b=a.prototype;b.setChannelEntryPoint=function(a){this.$1=a};b.setChannelEntryPointMetadata=function(a){this.$4=a};b.setSimilarChannelsSessionId=function(a){this.$5=a};b.setNewsletterDirectoryLoggingData=function(a){this.$6=a};b.getSimilarChannelsSessionId=function(){return this.$5};b.getIsSimilarUnitMountedForChat=function(a){return a.equals(this.$7)};b.setIsSimilarUnitMountedForChat=function(a){this.$7=a};b.getSimilarChannelsSessionIdForLogging=function(){var a=this.$5;if(a==null)return;return d("WAWebSimilarNewsletterSessionId").newsletterSessionIdToInt(a)};b.setDirectorySessionId=function(a){this.$2=a};b.getDirectorySessionIdForLogging=function(){return this.$2};b.getNewsletterDirectoryLoggingData=function(){return this.$6};b.setDirectoryFilter=function(a){if(a==null){this.$3=null;return}switch(a){case d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Recommended:return this.$3="all";case d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.New:return this.$3="new";case d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Popular:return this.$3="popular";case d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Featured:return this.$3="featured";case d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.Trending:return this.$3="most_active";default:return this.$3=null}};b.log=function(a){var b,c=a.cid,e=a.eventSurface,f=a.channelCoreEventType,g=a.similarChannelSessionId,i=a.eventUnit,l=a.entryPoint;a=babelHelpers.objectWithoutPropertiesLoose(a,h);b=JSON.stringify(babelHelpers["extends"]({has_followed_channels:k(),pill_type:(b=this.$3)!=null?b:void 0},d("WAWebNewsletterGatingUtils").isDirectoryCategoriesLoggingEnabled()?a:{}));new(d("WAWebChannelCoreEventWamEvent").ChannelCoreEventWamEvent)({cid:c.user,eventSurface:e,channelCoreEventType:f,channelEntryPointApp:d("WAWebWamEnumChannelEntryPointApp").CHANNEL_ENTRY_POINT_APP.WHATSAPP,channelEntryPoint:(a=l!=null?l:this.$1)!=null?a:void 0,channelDirectorySessionId:(c=this.$2)!=null?c:void 0,entryPointMetadata:b,similarChannelsSessionId:g!=null?d("WAWebSimilarNewsletterSessionId").newsletterSessionIdToInt(g):void 0,channelEntryPointMetadata:this.$4,channelEventUnit:i!=null?i:void 0,discoverySurface:l!=null?j(l):void 0}).commit()};return a}();b=new a();g.getDiscoverySurfaceFromChannelEntryPoint=j;g.NewsletterCoreEventLogger=b}),98);
__d("WAWebNewsletterCollection",["WAWebChatCollection"],(function(a,b,c,d,e,f,g){a=new(d("WAWebChatCollection").ChatCollectionImpl)();g["default"]=a}),98);
__d("WAWebNewsletterGeosuspendedCountryModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.geosuspended=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletter_geosuspended_country";b=d("WAWebBaseModel").defineModel(a);g.GeosuspendedCountry=b}),98);
__d("WAWebNewsletterGeosuspendedCountryCollection",["WAWebBaseCollection","WAWebNewsletterGeosuspendedCountryModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebNewsletterGeosuspendedCountryModel").GeosuspendedCountry;g["default"]=a}),98);
__d("WAWebNewsletterMessageDeliveryUpdateModel",["WAWebBaseModel","WAWebMsgKey"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.serverId=d("WAWebBaseModel").prop(),b.msgModel=d("WAWebBaseModel").prop(),b.code=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletter_message_update";a.idClass=c("WAWebMsgKey");b=d("WAWebBaseModel").defineModel(a);g.NewsletterMessageDeliveryUpdate=b}),98);
__d("WAWebNewsletterMessageDeliveryUpdateCollection",["WAWebBaseCollection","WAWebNewsletterMessageDeliveryUpdateModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebNewsletterMessageDeliveryUpdateModel").NewsletterMessageDeliveryUpdate;g["default"]=a}),98);
__d("WAWebNewsletterMetadataCollection",["Promise","WALogger","WAWebBaseCollection","WAWebCollectionUtils","WAWebNewsletterMetadataModel","WAWebWid","err"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(){var e;for(var f=arguments.length,g=new Array(f),j=0;j<f;j++)g[j]=arguments[j];return(e=a.call.apply(a,[this].concat(g))||this,e.byInviteCode=d("WAWebCollectionUtils").aggregated(function(a){return a.inviteCode}),e.findImpl=function(a){if(c("WAWebWid").isNewsletter(a))return(i||(i=b("Promise"))).resolve({id:a});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["newsletterMetadata:find trying to fetch non-newsletter wid ",""])),a.toString());return(i||(i=b("Promise"))).reject(c("err")("newsletterMetadata:find trying to fetch non-newsletter  wid "+a.toString()))},babelHelpers.assertThisInitialized(e))||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(e,a);return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebNewsletterMetadataModel").NewsletterMetadata;a.staleCollection=!0;e=new a();g["default"]=e}),98);
__d("WAWebNewsletterMetricUtils",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=60*60*24,i=30,j="infinite";function a(a){a=d("WATimeUtils").pastUnixTime(h*(i-1),a);return a}var k=b("$InternalEnum")({UniqueVisitorsOverPeriod:1,NewUniqueVisitorsOverPeriod:2,NetFollowsOverPeriod:3,UniqueVisitorOverPeriodByRole:4,UniqueVisitorOverPeriodByCountry:5,FollowersOverPeriod:6,FollowersOverPeriodByCountry:7,FollowsPerDay:8,UnfollowsPerDay:9});function c(a){a=a.flatMap(function(a){return a.getMetrics()});a=a.reduce(function(a,b){var c=a.enumSet,d=a.metricRequests,e=k.cast(b.id);if(e==null)return a;if(c.has(e))return a;c.add(e);d.push(b);return a},{enumSet:new Set(),metricRequests:[]});a=a.metricRequests;return a}function e(a){return a!==j&&Math.abs(a)<Number.EPSILON}function f(a){return new Date(a).setHours(0,0,0,0)}g.INSIGHT_DAYS_COVERED=i;g.DELTA_INFINITE=j;g.getInsightPeriodStart=a;g.NewsletterInsightMetricQuery=k;g.getUniqueMetricRequests=c;g.isDeltaValueZero=e;g.roundToNearestDay=f}),98);
__d("WAWebNewsletterMetadataModel",["WAWebBaseModel","WAWebClock","WAWebCommonNewsletterEnums","WAWebModelUtils","WAWebNewsletterGeosuspendedCountryCollection","WAWebNewsletterMembershipUtil","WAWebNewsletterMessageDeliveryUpdateCollection","WAWebNewsletterMetadataCollection","WAWebNewsletterMetricUtils","WAWebNewsletterPendingAdminsCollection","WAWebNewsletterSubscribersCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.id=d("WAWebModelUtils").prop(),b.creationTime=d("WAWebModelUtils").prop(),b.name=d("WAWebModelUtils").prop(),b.nameUpdateTime=d("WAWebModelUtils").prop(),b.description=d("WAWebModelUtils").prop(),b.descriptionUpdateTime=d("WAWebModelUtils").prop(),b.handle=d("WAWebModelUtils").prop(),b.inviteCode=d("WAWebModelUtils").prop(),b.size=d("WAWebModelUtils").prop(),b.verified=d("WAWebModelUtils").prop(),b.membershipType=d("WAWebModelUtils").prop(),b.privacy=d("WAWebModelUtils").prop(),b.website=d("WAWebModelUtils").prop(),b.messageDeliveryUpdates=d("WAWebModelUtils").collection(c("WAWebNewsletterMessageDeliveryUpdateCollection")),b.reactionCodesSetting=d("WAWebModelUtils").prop(),b.wamoSubPlanId=d("WAWebModelUtils").prop(),b.wamoSubStatus=d("WAWebModelUtils").prop(),b.suspended=d("WAWebModelUtils").prop(!1),b.geosuspended=d("WAWebModelUtils").prop(!1),b.hasProfilePictureDeletionAlerts=d("WAWebModelUtils").prop(!1),b.geosuspendedCountries=d("WAWebModelUtils").collection(c("WAWebNewsletterGeosuspendedCountryCollection")),b.capabilities=d("WAWebModelUtils").prop(function(){return new Set()}),b.adminInsights=d("WAWebModelUtils").session(),b.adminCount=d("WAWebModelUtils").prop(1),b.pendingAdmins=d("WAWebModelUtils").collection(c("WAWebNewsletterPendingAdminsCollection")),b.subscribers=d("WAWebModelUtils").collection(c("WAWebNewsletterSubscribersCollection")),b.terminated=d("WAWebModelUtils").prop(!1),b.similarNewsletters=d("WAWebModelUtils").session(function(){return[]}),b.recentlyFollowedFrom=d("WAWebModelUtils").session(),b.isSuspendedOrTerminated=d("WAWebModelUtils").derived(function(){return this.suspended||this.terminated},["suspended","terminated"]),b.canBeMuted=d("WAWebModelUtils").derived(function(){return d("WAWebNewsletterMembershipUtil").iAmOwner(this)&&this.adminCount>1||d("WAWebNewsletterMembershipUtil").iAmAdmin(this)||d("WAWebNewsletterMembershipUtil").iAmSubscriber(this)},["adminCount","membershipType"]),b.isSubscribedOrOwned=d("WAWebModelUtils").derived(function(){return d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(this)||d("WAWebNewsletterMembershipUtil").iAmSubscriber(this)},["membershipType"]),b.isPreview=d("WAWebModelUtils").derived(function(){return this.membershipType===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest},["membershipType"]),b.showInsightDelta=d("WAWebModelUtils").derived(function(){return d("WAWebClock").Clock.daysDeltaAbs(this.creationTime)>=d("WAWebNewsletterMetricUtils").INSIGHT_DAYS_COVERED},["creationTime"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){var b=this;a.prototype.initialize.call(this);this.listenTo(this.subscribers,"change add reset set remove",function(){b.updateAdminCount()})};e.getCollection=function(){return c("WAWebNewsletterMetadataCollection")};e.resetRecentlyFollowedFrom=function(){this.recentlyFollowedFrom=null};e.updateAdminCount=function(){var a;a=(a=(a=this.subscribers)==null?void 0:a.filter(function(a){a=a.membership;return a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin||a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner}).length)!=null?a:0;this.adminCount=this.membershipType===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner?a+1:a};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletterMetadata";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g.NewsletterMetadata=b}),98);
__d("WAWebNewsletterPendingAdminsCollection",["WAWebBaseCollection","WAWebNewsletterSubscriberModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebNewsletterSubscriberModel").NewsletterSubscriber;g["default"]=a}),98);
__d("WAWebNewsletterPollVotesGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createNewsletterPollVotesCache});b=a.field;c=a.unsafeIdentityGetter;e=a.clearCacheFor;f=e;d=c;a=b("ack");g.clearNewsletterPollVotesGetterCacheFor=f;g.getNewsletterPollVotesUnsafe=d;g.getAck=a}),98);
__d("WAWebFrontendNewsletterPollVotesGetters",["WAWebAck","WAWebGetters","WAWebGettersCaches","WAWebNewsletterPollVotesGetters"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({root:d("WAWebNewsletterPollVotesGetters").getNewsletterPollVotesUnsafe,createCache:d("WAWebGettersCaches").createFrontendNewsletterPollVotesCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;a=b("isSendFailure",{"default":!1});e=c(function(a){var b=a[0];a=a[1];b=b!=null&&b<d("WAWebAck").ACK.CLOCK;return b||Boolean(a)},[d("WAWebNewsletterPollVotesGetters").getAck,a]);g.clearFrontendNewsletterPollVotesGetterCacheFor=f;g.getIsFailed=e}),98);
__d("WAWebNewsletterPollVotesModel",["WATimeUtils","WAWebAddOnModel","WAWebBaseModel","WAWebFrontendNewsletterPollVotesGetters","WAWebModelUtils","WAWebMsgKey","WAWebNewsletterPollVotesGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebModelUtils").prop(),b.pollVotesCountMap=d("WAWebModelUtils").prop(function(){return new Map()}),b.pollVotesCountMapTs=d("WAWebModelUtils").prop(),b.myVote=d("WAWebModelUtils").prop(function(){return new Set()}),b.myVoteTs=d("WAWebModelUtils").prop(),b.isUnvote=d("WAWebModelUtils").prop(!1),b.msgKey=d("WAWebModelUtils").prop(),b.pollVotersMap=d("WAWebModelUtils").prop(function(){return new Map()}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebNewsletterPollVotesGetters").clearNewsletterPollVotesGetterCacheFor(this),d("WAWebFrontendNewsletterPollVotesGetters").clearFrontendNewsletterPollVotesGetterCacheFor(this)};c.updateMyVote=function(a,b,c){var e,f;if(b<((e=this.myVoteTs)!=null?e:0))return;e=(e=this.myVote)!=null?e:new Set();var g=(f=this.pollVotesCountMap)!=null?f:new Map();Array.from(e).forEach(function(a){var b;b=(b=g.get(a))!=null?b:0;g.set(a,Math.max(b-1,0))});Array.from(a).forEach(function(a){var b;b=(b=g.get(a))!=null?b:0;g.set(a,b+1)});this.msgKey=c;this.pollVotesCountMap=g;this.myVote=a;this.myVoteTs=d("WATimeUtils").castToMillisTime(b)};c.updatePollVotersMap=function(a,b){if(b==null){this.pollVotersMap=a;return}a=a.get(b);if(a!=null){var c=new Map(this.pollVotersMap);c.set(b,a);this.pollVotersMap=c}};return b}(d("WAWebAddOnModel").AddOnBaseModel);a.Proxy="newsletterPollVote";a.idClass=c("WAWebMsgKey");b=d("WAWebBaseModel").defineModel(a);g.NewsletterPollVotes=b}),98);
__d("WAWebNewsletterPollVotesModelCollection",["WATimeUtils","WAWebBaseCollection","WAWebCRUDOperationsNewsletterMyVotes","WAWebCRUDOperationsNewsletterPollsVotes","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgKey","WAWebNewsletterPollVotesModel","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){e=function(a){function e(){var e;for(var f=arguments.length,g=new Array(f),h=0;h<f;h++)g[h]=arguments[h];return(e=a.call.apply(a,[this].concat(g))||this,e.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.toString();var b=(yield d("WAWebCRUDOperationsNewsletterPollsVotes").getVote(a)),e=(yield d("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([a]));e=e[0];if(e==null)throw new(d("WAWebMiscErrors").NotFoundError)("No votes found");var f=e.id.remote.toJid(),g=e.serverId;e=e.pollOptions;f=g!=null?yield d("WAWebCRUDOperationsNewsletterMyVotes").getMyVote(f,g):null;if(e==null)throw new(d("WAWebMiscErrors").NotFoundError)("No pollOptions found");if(b==null&&f==null)throw new(d("WAWebMiscErrors").NotFoundError)("No polls to display");g={id:c("WAWebMsgKey").fromString(a),pollVotesCountMap:new Map()};var h=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(e));b!=null&&(g.pollVotesCountMap=new Map(Array.from(b.votesMap.entries()).map(function(a){var b=a[0];a=a[1];return[h.getLocalIdForHexHash(b),a]})),g.pollVotesCountMapTs=d("WATimeUtils").castToUnixTime(b.serverTimestamp));if(f!=null){g.myVote=new Set(f.votes.map(function(a){return h.getLocalIdForHexHash(a)}));var i=g.pollVotesCountMap;g.myVote.forEach(function(a){i!=null&&!i.has(a)&&i.set(a,1)});g.myVoteTs=d("WATimeUtils").castToMillisTime(f.serverTimestampMs);g.ack=f.ack}return g});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(e))||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(e,a);return e}(d("WAWebBaseCollection").BaseCollection);e.model=d("WAWebNewsletterPollVotesModel").NewsletterPollVotes;function a(a){var b=a.msgKey,c=a.parentMsgKey,d=a.selectedOptionLocalIds;a=a.timestamp;c=h.gadd({id:c});c.updateMyVote(d,a,b);return c}var h=new e();g.updateOrCreatePollVote=a;g.NewsletterPollVotesModelCollection=h}),98);
__d("WAWebNewsletterReactionModel",["WATimeUtils","WAWebBaseModel","WAWebModelUtils","WAWebMsgKey","WAWebReactionsBEUtils"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebModelUtils").prop(),b.parentMsgServerId=d("WAWebModelUtils").prop(),b.myReactionMsgKey=d("WAWebModelUtils").prop(),b.reactionCountMap=d("WAWebModelUtils").prop(),b.reactionCountMapTs=d("WAWebModelUtils").prop(),b.myReaction=d("WAWebModelUtils").prop(),b.myReactionTs=d("WAWebModelUtils").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){var b;a.prototype.initialize.call(this);this.reactionCountMap=(b=this.reactionCountMap)!=null?b:new Map()};c.updateMyReaction=function(a){return a===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT?this.$NewsletterMessageReactionsImpl$p_1():this.$NewsletterMessageReactionsImpl$p_2(a)};c.$NewsletterMessageReactionsImpl$p_2=function(a){var b,c=this.myReaction;this.reactionCountMap=(b=this.reactionCountMap)!=null?b:new Map();b=this.reactionCountMap;var d=b.get(a);b.set(a,(d!=null?d:0)+1);d=c!=null?b.get(c):null;if(d!=null&&c!=null){d=d-1;d>0?b.set(c,d):b["delete"](c)}this.$NewsletterMessageReactionsImpl$p_3(a)};c.$NewsletterMessageReactionsImpl$p_1=function(){var a,b=this.myReaction;if(b==null)return;this.reactionCountMap=(a=this.reactionCountMap)!=null?a:new Map();a=this.reactionCountMap;var c=a.get(b);if(c==null)return;c>1?a.set(b,c-1):a["delete"](b);this.$NewsletterMessageReactionsImpl$p_3(null)};c.$NewsletterMessageReactionsImpl$p_3=function(a){this.myReactionTs=d("WATimeUtils").unixTime(),this.myReaction=a};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletterReaction";a.idClass=c("WAWebMsgKey");b=d("WAWebBaseModel").defineModel(a);g.NewsletterMessageReactions=b}),98);
__d("WAWebNewsletterReactionCollection",["WATimeUtils","WAWebBaseCollection","WAWebDBGetReactions","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgKey","WAWebNewsletterDBUtils","WAWebNewsletterReactionModel","WAWebReactionsBEUtils","WAWebUserPrefsMeUser","WAWebdbCRUDOperationsNewsletterReaction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){e=function(a){function e(){var e;for(var f=arguments.length,g=new Array(f),h=0;h<f;h++)g[h]=arguments[h];return(e=a.call.apply(a,[this].concat(g))||this,e.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebdbCRUDOperationsNewsletterReaction").getNewsletterReaction(a)),e=(yield d("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([a]));e=e[0];if(e==null)throw new(d("WAWebMiscErrors").NotFoundError)("No reactions found");var f=e.id.remote.toJid();e=e.serverId;f=e!=null?yield d("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(e,f):null;f=f!=null?yield d("WAWebDBGetReactions").existsReactionAddressingModeInsensitive({parentMsgKey:f.toString(),senderUserJid:d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString()}):null;if(b==null&&f==null)throw new(d("WAWebMiscErrors").NotFoundError)("No reactions to display");a={id:c("WAWebMsgKey").fromString(a)};e!=null&&(a.parentMsgServerId=e);b!=null&&(a.reactionCountMap=b.emojiCountMap,a.reactionCountMapTs=d("WATimeUtils").castToUnixTime(b.serverTimestamp));f!=null&&f.reactionText!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&(a.myReactionMsgKey=c("WAWebMsgKey").from(f.msgKey),a.myReaction=f.reactionText,a.myReactionTs=d("WATimeUtils").castToUnixTime(f.timestamp));return a});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(e))||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(e,a);return e}(d("WAWebBaseCollection").BaseCollection);e.model=d("WAWebNewsletterReactionModel").NewsletterMessageReactions;var h=new e();function a(a){var b=a.parentMsg,c=a.reactionCode;a=a.reactionMsg;b=h.gadd({id:b.id,myReactionMsgKey:a.id});b.updateMyReaction(c);return b}g.NewsletterMessageReactionsCollection=h;g.updateOrCreateMessageReaction=a}),98);
__d("WAWebNewsletterReportModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.reportStatus=d("WAWebBaseModel").prop(),b.creationTime=d("WAWebBaseModel").prop(),b.newsletterName=d("WAWebBaseModel").prop(),b.newsletterId=d("WAWebBaseModel").prop(),b.serverMsgId=d("WAWebBaseModel").prop(),b.responseServerMsgId=d("WAWebBaseModel").prop(),b.notifyName=d("WAWebBaseModel").prop(),b.appeal=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="newsletter_report";b=d("WAWebBaseModel").defineModel(a);g.NewsletterReport=b}),98);
__d("WAWebNewsletterReportCollection",["WAWebBaseCollection","WAWebNewsletterReportModel"],(function(a,b,c,d,e,f,g){a=function(a,b){var c;c=((c=b.appeal.creationTime)!=null?c:0)-((c=a.appeal.creationTime)!=null?c:0);return c!==0?c:b.creationTime-a.creationTime};b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebNewsletterReportModel").NewsletterReport;b.comparator=a;c=new b();g.NewsletterReportCollection=c}),98);
__d("WAWebNewsletterSubscribersCollection",["WAWebBaseCollection","WAWebCommonNewsletterEnums","WAWebContactGetters","WAWebFrontendContactGetters","WAWebNewsletterSubscriberModel"],(function(a,b,c,d,e,f,g){a=function(a,b){if(a.membership===b.membership){if(!d("WAWebContactGetters").getIsMyContact(a.contact))return 1;if(!d("WAWebContactGetters").getIsMyContact(b.contact))return-1;var c=d("WAWebFrontendContactGetters").getFormattedUser(a.contact),e=d("WAWebFrontendContactGetters").getFormattedUser(b.contact);return c.localeCompare(e)}if(a.membership===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner)return-1;return b.membership===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner?1:a.membership===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin?-1:1};b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebNewsletterSubscriberModel").NewsletterSubscriber;b.comparator=a;g["default"]=b}),98);
__d("WAWebPsaVerifiedBlueIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="psa-verified-blue";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=20;o=20;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 20 20",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.595 8.23978L17.7696 9.43025L17.7615 9.42221C18.0795 9.74022 18.0795 10.2538 17.7614 10.5718L16.5868 11.7623L17.011 13.3849C17.117 13.817 16.8641 14.2655 16.4318 14.3797L14.8167 14.82L14.3762 16.4345C14.2539 16.8666 13.8134 17.1275 13.3811 17.0134L11.7578 16.5894L10.5669 17.7635C10.4119 17.9185 10.1998 18 9.99592 18C9.792 18 9.57991 17.9185 9.42493 17.7635L8.234 16.5894L6.61076 17.0134C6.17844 17.1275 5.7298 16.8666 5.6156 16.4345L5.17512 14.82L3.56003 14.3797C3.13587 14.2574 2.87484 13.817 2.98904 13.3849L3.4132 11.7623L2.23859 10.5718C1.92047 10.2538 1.92047 9.74009 2.23859 9.42209L3.4132 8.23162L2.98904 6.60899C2.87484 6.17684 3.12771 5.72837 3.56003 5.61422L5.17512 5.17391L5.6156 3.55943C5.73796 3.13543 6.17844 2.87451 6.61076 2.98866L8.234 3.41266L9.42493 2.2385C9.74305 1.9205 10.2569 1.9205 10.5751 2.2385L11.766 3.41266L13.3892 2.98866C13.8216 2.88266 14.2702 3.13543 14.3844 3.56759L14.8249 5.18206L16.44 5.62237C16.8723 5.74468 17.1333 6.18499 17.0191 6.61715L16.595 8.23978ZM9.37506 12.7678C9.21482 12.9279 9.01452 13 8.80621 13C8.5979 13 8.3976 12.9199 8.23736 12.7678L6.23435 10.7658C5.92188 10.4535 5.92188 9.94895 6.23435 9.63664C6.54682 9.32432 7.05158 9.32432 7.36405 9.63664L8.7982 11.0701L12.636 7.23423C12.9484 6.92192 13.4532 6.92192 13.7656 7.23423C14.0781 7.54655 14.0781 8.05105 13.7656 8.36336L11.5784 10.5656L9.37506 12.7678Z",fill:"#007BFC",style:{fill:"#007BFC",fillOpacity:1}})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.PsaVerifiedBlueIcon=a}),98);
__d("WAWebPsaVerifiedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="psa-verified";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=18;o=18;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 18 18",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 18 18",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("polygon",{id:"Star-2",fill:"#00DA60",points:"9,16 7.1,16.9 5.8,15.2 3.7,15.1 3.4,13 1.5,12 2.2,9.9 1.1,8.2 2.6,6.7 2.4,4.6 4.5,4 5.3,2 7.4,2.4 9,1.1 10.7,2.4 12.7,2 13.6,4 15.6,4.6 15.5,6.7 17,8.2 15.9,9.9 16.5,12 14.7,13 14.3,15.1 12.2,15.2 10.9,16.9 "}),k.jsx("polygon",{id:"Check-Icon",fill:"#FFFFFF",points:"13.1,7.3 12.2,6.5 8.1,10.6 5.9,8.5 5,9.4 8,12.4 "})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.PsaVerifiedIcon=a}),98);
__d("WAWebNewsletterName.react",["fbt","WALogger","WAWebEmojiText.react","WAWebFbtCommon","WAWebFormatConfiguration","WAWebMiscGatingUtils","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","react","useWAWebModelValues"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react");b={verified:{flexGrow:"x1c4vz4f",display:"x3nfvp2",overflowX:"xuce83p",overflowY:"x1bft6iq",textOverflow:"x1i7k8ik",whiteSpace:"xq9mrsl",alignItems:"x6s0dn4",$$css:!0},newsletterIcon:{display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",marginInlineStart:"xwklpps",$$css:!0}};function a(a){var b=a.chat,c=a.element,e=a.highlightText,f=a.titlify,g=a.ellipsify,h=a.breakWord,i=a.onClick,j=a.className,n=a.xstyle,o=a.testid;o=a.checkmarkLarge;o=o===void 0?!1:o;var p=a.skipCheckMark;p=p===void 0?!1:p;a=a.selectable;var q=d("useWAWebModelValues").useModelValues(b,["id","newsletterMetadata"]);q=d("useWAWebModelValues").useOptionalModelValues(q.newsletterMetadata,["verified"]);b=m(b);e=e!=null&&e!==""?d("WAWebFormatConfiguration").SearchName({terms:[e]}):void 0;b=k.jsx(d("WAWebEmojiText.react").EmojiText,{text:b,element:c,className:j,xstyle:n,formatters:e,titlify:f,ellipsify:g,breakWord:h,direction:"auto",inlineblock:!0,onClick:i,testid:void 0,selectable:a});c=(q==null?void 0:q.verified)===!0;return k.jsx(l,{verified:c,checkmarkLarge:o,skipCheckMark:p,children:b})}a.displayName=a.name+" [from "+f.id+"]";function l(a){var b=a.checkmarkLarge,c=a.children,e=a.skipCheckMark;a=a.verified;var f;if(a&&!e){a=h._(/*BTDS*/"Verified channel");e=b?24:16;f=k.jsx("div",{className:"x78zum5 x6s0dn4 xl56j7k xwklpps",children:d("WAWebMiscGatingUtils").isBlueEnabled()?k.jsx(d("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{"aria-label":a,width:e,height:e}):k.jsx(d("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{"aria-label":a})})}return k.jsxs("span",{className:"x1c4vz4f x3nfvp2 xuce83p x1bft6iq x1i7k8ik xq9mrsl x6s0dn4",children:[c,f]})}l.displayName=l.name+" [from "+f.id+"]";function m(a){a=d("useWAWebModelValues").useModelValues(a,["id","newsletterMetadata","formattedTitle"]);var b=d("useWAWebModelValues").useOptionalModelValues(a.newsletterMetadata,["name","verified"]);if((b==null?void 0:b.name)!=null)return b.name;if(a.formattedTitle!=null)return a.formattedTitle;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][NewsletterName] undefined name"]))).tags("newsletter").devConsole("Undefined newsletter metadata name or chat.formattedTitle for "+a.id.toString()+" ").sendLogs("newsletter-undefined-name");return c("WAWebFbtCommon")("Untitled Channel")}g.styles=b;g.NewsletterName=a}),226);
__d("WAWebGenerateRequestPaymentMessageProto",["WAWebPaymentsProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;var b=d("WAWebPaymentsProtoUtils").generatePaymentsNoteMessage(a);return{requestPaymentMessage:{amount1000:a.amount1000,expiryTimestamp:a._paymentExpiryTimestamp,requestFrom:a._paymentRequestFrom,currencyCodeIso4217:a._currencyCodeIso4217,noteMessage:b}}}g["default"]=a}),98);
__d("WAWebGenerateSendPaymentMessageProto",["WAWebE2EProtoUtils","WAWebPaymentsProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){a=a.json;var b=a.paymentRequestMessageKey?{fromMe:a.paymentRequestMessageKey.fromMe,remoteJid:d("WAWebE2EProtoUtils").encodeJid(a.paymentRequestMessageKey.remote),id:a.paymentRequestMessageKey.id,participant:d("WAWebE2EProtoUtils").encodeJid(a.paymentRequestMessageKey.participant)}:void 0;return{sendPaymentMessage:{requestMessageKey:b,noteMessage:d("WAWebPaymentsProtoUtils").generatePaymentsNoteMessage(a)}}}g["default"]=a}),98);
__d("WAWebPaymentsProtoUtils",["WAWebE2EProtoGenerator","WAWebE2EProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){if(a.paymentNoteMsg==null)return;var b={stanzaId:a.quotedStanzaID,mentionedJid:a.mentionedJidList&&a.mentionedJidList.map(d("WAWebE2EProtoUtils").encodeJid),isForwarded:a.isForwarded,forwardingScore:a.forwardingScore,groupMentions:[],statusAttributions:[]},c=d("WAWebE2EProtoUtils").encodeJid(a.quotedParticipant);c!=null&&(b.participant=c);if(a.quotedMsg){c=d("WAWebE2EProtoGenerator").getProtobufMessage(a.quotedMsg,void 0,void 0,void 0,"quoted");b.quotedMessage=d("WAWebE2EProtoUtils").getMutableMessageProtobuf(c)}return d("WAWebE2EProtoGenerator").getProtobufMessage(Object.assign(a.paymentNoteMsg,{_isPaymentNoteMsg:!0}),void 0,b)}g.generatePaymentsNoteMessage=a}),98);
__d("WAWebPaymentRequestMsgAction",["WAWebDBProcessPaymentMessages","WAWebMsgCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new(d("WAWebMsgCollection").MsgCollection.constructor.model)(a);b=(yield d("WAWebDBProcessPaymentMessages").processPaymentMessages([b]));b&&b.forEach(function(b){var c=d("WAWebMsgCollection").MsgCollection.get(b.id);c?c.set(b,{merge:!0}):b.id===a.id.toString()&&(a.type=b.type,a.templateParams=b.templateParams)})});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=new(d("WAWebMsgCollection").MsgCollection.constructor.model)(a);a=(yield d("WAWebDBProcessPaymentMessages").processPaymentMessages([a]));a&&a.forEach(function(a){var b=d("WAWebMsgCollection").MsgCollection.get(a.id);b&&b.set(a,{merge:!0})})});return i.apply(this,arguments)}g.cancelOrDeclinePaymentRequest=a;g.fulfillPaymentRequest=c}),98);
__d("WAWebFormatPaymentMsg",["fbt","WAWebWidToFormattedNameOrNumber"],(function(a,b,c,d,e,f,g,h){function a(a){var b=c("WAWebWidToFormattedNameOrNumber")(a.remote);return a.fromMe?h._(/*BTDS*/"You invited {otherUser} to use payments",[h._param("otherUser",b)]):h._(/*BTDS*/"{otherUser} invited you to use payments",[h._param("otherUser",b)])}g.formatPaymentInviteMessageText=a}),226);
__d("WAWebPinInChatGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createPinInChatsCache});b=a.field;c=a.unsafeIdentityGetter;e=a.clearCacheFor;f=e;d=c;a=b("sender");e=b("ack");g.clearPinInChatGetterCacheFor=f;g.getPinInChatUnsafe=d;g.getSender=a;g.getAck=e}),98);
__d("WAWebFrontendPinInChatGetters",["WAWebAck","WAWebGetters","WAWebGettersCaches","WAWebPinInChatGetters","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({root:d("WAWebPinInChatGetters").getPinInChatUnsafe,createCache:d("WAWebGettersCaches").createFrontendPinInChatsCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;a=b("isSendFailure",{"default":!1});e=c(function(a){var b=a[0],c=a[1];a=a[2];b=d("WAWebUserPrefsMeUser").isMeAccount(b)&&c!=null&&c<d("WAWebAck").ACK.CLOCK;return b||Boolean(a)},[d("WAWebPinInChatGetters").getSender,d("WAWebPinInChatGetters").getAck,a]);g.clearFrontendPinInChatGetterCacheFor=f;g.getIsFailed=e}),98);
__d("WAWebPinInChatModel",["WATimeUtils","WAWebAddOnModel","WAWebBaseModel","WAWebFrontendPinInChatGetters","WAWebPinInChatGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.msgKey=d("WAWebBaseModel").prop(),b.parentMsgKey=d("WAWebBaseModel").prop(),b.senderTimestampMs=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.sender=d("WAWebBaseModel").prop(),b.chatId=d("WAWebBaseModel").prop(),b.pinType=d("WAWebBaseModel").prop(),b.pinExpiryDuration=d("WAWebBaseModel").prop(),b.id=d("WAWebBaseModel").prop(),b.read=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebPinInChatGetters").clearPinInChatGetterCacheFor(this),d("WAWebFrontendPinInChatGetters").clearFrontendPinInChatGetterCacheFor(this)};c.leftExpirationTime=function(){var a;a=((a=this.t)!=null?a:Math.floor(this.senderTimestampMs/1e3))+((a=this.pinExpiryDuration)!=null?a:0);return a-d("WATimeUtils").unixTime()};return b}(d("WAWebAddOnModel").AddOnBaseModel);b=d("WAWebBaseModel").defineModel(a);g.PinInChat=b}),98);
__d("WAWebPinInChatCollection",["WATimeUtils","WAWebBaseCollection","WAWebCollectionUtils","WAWebFrontendPinInChatGetters","WAWebPinInChatModel","WAWebPinMsgConstants","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.byChatId=d("WAWebCollectionUtils").aggregated(function(a){return a.chatId}),b.byIsFailedByMe=d("WAWebCollectionUtils").aggregated(function(a){return d("WAWebFrontendPinInChatGetters").getIsFailed(a)&&d("WAWebUserPrefsMeUser").isMeAccount(a.sender)}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.deleteByParentMessageKey=function(a){this.remove(h(a))};c.getByMsgKey=function(a){return this.findFirst(function(b){return b.msgKey.equals(a)})};c.getByParentMsgKey=function(a){return this.get(h(a))};return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebPinInChatModel").PinInChat;b.comparator=function(a,b){return Number(b.t)-Number(a.t)};function h(a){return"!!"+a.toString()}function i(a){var b;if(a.senderTimestampMs==null)return!1;var c=a.pinExpiryDuration!=null;a=((b=a.t)!=null?b:Math.floor(a.senderTimestampMs/1e3))+((b=a.pinExpiryDuration)!=null?b:0);return c&&a<d("WATimeUtils").unixTime()}function a(a){return a.pinType===d("WAWebPinMsgConstants").PIN_STATE.PIN&&a.parentMsgKey!=null&&!i(a)}c=new b();g.getPinInChatId=h;g.isPinExpired=i;g.isPinValid=a;g.PinInChatCollection=c}),98);
__d("WAWebDBPollsInvalidateChatPolls",["WAWebDBMessageUtils","WAWebModelStorageUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.between(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(a),d("WAWebDBMessageUtils").endOfChat(a)));yield b.bulkCreateOrMerge(c.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&!a.pollInvalidated}).map(function(a){return{id:a.id,pollInvalidated:!0}}))});return function(a){return c.apply(this,arguments)}}())}g.invalidateChatPolls=a}),98);
__d("WAWebPollsInvalidateChatPollMsgsAction",["WALogger","WAWebDBPollsInvalidateChatPolls","WAWebFrontendMsgGetters","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield d("WAWebDBPollsInvalidateChatPolls").invalidateChatPolls(a.id),a.msgs.filter(function(a){return d("WAWebFrontendMsgGetters").getAsPollCreation(a)&&!a.pollInvalidated}).forEach(function(a){a.pollInvalidated=!0})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[POLLS] Failed to invalidate polls with error: ",""])),a).devConsole(a)}});return i.apply(this,arguments)}g.invalidateChatPollMsgs=a}),98);
__d("WAWebPollsPollVoteCollection",["WANullthrows","WAWebApiContact","WAWebBaseCollection","WAWebLidMigrationUtils","WAWebMaybe","WAWebPollsPollVoteModel","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getVoteFromSenderAddressingModeInsensitive=function(a){var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a));return this.findFirst(function(c){return c.sender.equals(a)||c.sender.equals(b)})};c.getUnreadCount=function(){return this.filter(function(a){return a.selectedOptionLocalIds.length>0&&!a.read&&!d("WAWebUserPrefsMeUser").isMeAccount(a.sender)}).length};c.getVoteCount=function(){return this.filter(function(a){return a.selectedOptionLocalIds.length>0}).length};return b}(d("WAWebBaseCollection").BaseCollection);h.model=d("WAWebPollsPollVoteModel").PollVote;b=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.$PollVoteCollectionImpl$p_1=new Map(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.add=function(b,c){b=a.prototype.add.call(this,b,c);c=j(b.filter(Boolean));for(c of c){var d=c[0],e=c[1];d=this.getForParentAddressingModeInsensitive([d]);d=d[0];d.add(e)}return b};c.remove=function(b,c){b=a.prototype.remove.call(this,b,c);c=j(b.filter(Boolean));for(c of c){var d=c[0],e=c[1];this.getForParentAddressingModeInsensitive([d])[0].remove(e)}return b};c.reset=function(){a.prototype.reset.call(this);for(var b of this.$PollVoteCollectionImpl$p_1.values())b.reset();this.$PollVoteCollectionImpl$p_1.clear()};c.getForParentAddressingModeInsensitive=function(a){var b=this;return a.map(function(a){return b.$PollVoteCollectionImpl$p_2(a)})};c.$PollVoteCollectionImpl$p_2=function(a){var b,c=this;b=(b=this.$PollVoteCollectionImpl$p_1.get(a.toString()))!=null?b:d("WAWebMaybe").ifSome(d("WAWebLidMigrationUtils").getAlternateMsgKey(a),function(a){return c.$PollVoteCollectionImpl$p_1.get(a.toString())});b==null&&(b=new h(),b.add(this.filter(function(b){return b.parentMsgKey.equals(a)})),this.$PollVoteCollectionImpl$p_1.set(a.toString(),b));return b};c.getByMsgKey=function(a){return this.get(i(a))};return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebPollsPollVoteModel").PollVote;function i(a){return"!!"+a.toString()}function a(a){return new(d("WAWebPollsPollVoteModel").PollVote)(babelHelpers["extends"]({id:i(a.msgKey)},a))}e=new b();function j(a){var b=new Map();if(!a)return b;a.forEach(function(a){var d=a.parentMsgKey;b.has(d)||b.set(d,[]);c("WANullthrows")(b.get(d)).push(a)});return b}g.GroupedPollVoteCollection=h;g.createPollVoteModel=a;g.PollVoteCollection=e}),98);
__d("WAWebPollVoteGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createPollVotesCache});b=a.field;c=a.computed;e=a.unsafeIdentityGetter;f=a.clearCacheFor;d=f;a=e;f=b("parentMsgKey");e=b("sender");var h=b("ack"),i=b("t"),j=b("senderTimestampMs");b=b("selectedOptionLocalIds");b=c(function(a){a=a[0];return a.length===0},[b]);c=c(function(a){var b=a[0];a=a[1];return b==null||b===0?a:b*1e3},[i,j]);g.clearPollVoteGetterCacheFor=d;g.getPollVoteUnsafe=a;g.getParentMsgKey=f;g.getSender=e;g.getAck=h;g.getIsUnvote=b;g.getTimestamp=c}),98);
__d("WAWebPollsPollVoteModel",["WAWebAddOnModel","WAWebBaseModel","WAWebFrontendPollVoteGetters","WAWebPollVoteGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.msgKey=d("WAWebBaseModel").prop(),b.parentMsgKey=d("WAWebBaseModel").prop(),b.selectedOptionLocalIds=d("WAWebBaseModel").prop(),b.senderTimestampMs=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.sender=d("WAWebBaseModel").prop(),b.read=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebPollVoteGetters").clearPollVoteGetterCacheFor(this),d("WAWebFrontendPollVoteGetters").clearFrontendPollVoteGetterCacheFor(this)};c.getData=function(){return{msgKey:this.msgKey,parentMsgKey:this.parentMsgKey,selectedOptionLocalIds:this.selectedOptionLocalIds,senderTimestampMs:this.senderTimestampMs,t:this.t,sender:this.sender,ack:this.ack,read:this.read}};return b}(d("WAWebAddOnModel").AddOnBaseModel);a.Proxy="poll_vote";b=d("WAWebBaseModel").defineModel(a);g.PollVote=b}),98);
__d("WAWebPollsVoteNotification",["fbt","WAWebBaseNotification","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebNotificationController","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebPollsPollVoteCollection","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var c;b=b.creationMsg;c=a.call(this)||this;c.$PollVoteNotification$p_3=function(){c.$PollVoteNotification$p_2.getUnreadCount()===0&&c.closeBanner()};c.$PollVoteNotification$p_1=b;c.$PollVoteNotification$p_2=d("WAWebPollsPollVoteCollection").PollVoteCollection.getForParentAddressingModeInsensitive([b.id])[0];c.bodyText=i({unreadCount:c.$PollVoteNotification$p_2.getUnreadCount(),pollName:c.$PollVoteNotification$p_1.pollName});return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldPlaySound=function(){var b=d("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return a.prototype.shouldPlaySound.call(this)&&!d("WAWebNotificationHelpers").shouldSquelch(b,!1)};f.shouldMute=function(a){if(d("WAWebNotificationHelpers").shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState;if(d("WAWebNotificationHelpers").isMutedAndNotMentioned(this.$PollVoteNotification$p_1.unsafe()))return c("WAWebNotificationMuteReason").MutedChat;if(d("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.$PollVoteNotification$p_1.unsafe()))return c("WAWebNotificationMuteReason").ArchivedChat;if(!c("gkx")("26258")&&d("WAWebNotificationHelpers").shouldIgnoreGroupMsg(this.$PollVoteNotification$p_1.unsafe()))return c("WAWebNotificationMuteReason").IgnoreGroupMsg;return d("WAWebNotificationHelpers").isOfflineResumeInProgress()?c("WAWebNotificationMuteReason").OfflineResumeInProgress:null};f.shouldSquelch=function(){if(d("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey()))return null;var a=d("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return d("WAWebNotificationHelpers").shouldSquelch(a,!1)?c("WAWebNotificationMuteReason").GroupFlood:null};f.afterBannerShown=function(a){var b=this;this.$PollVoteNotification$p_2.on("change add remove reset",this.$PollVoteNotification$p_3);a.waitForClose().then(function(){b.$PollVoteNotification$p_2.off("change add remove reset",b.$PollVoteNotification$p_3)})};f.buildKey=function(){return"vote:"+this.$PollVoteNotification$p_1.id.toString()};f.matchesChat=function(a){return d("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe()).equals(a)};f.getChatKind=function(){return d("WAWebFrontendChatGetters").getKind(d("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe()))};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebFrontendMsgGetters").getChat(this.$PollVoteNotification$p_1.unsafe());return d("WAWebNotificationIconUtils").getChatNotificationIcon(a,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=this.$PollVoteNotification$p_1,b=d("WAWebFrontendMsgGetters").getChat(a.unsafe());return{wid:b.id,msgId:a.id.toString(),tag:this.buildKey(),title:d("WAWebNotificationHelpers").getNotificationTitle(b),body:d("WAWebGetNotificationStrings").getNotificationBody(babelHelpers["extends"]({},this.$PollVoteNotification$p_4(),{msgDir:d("WAWebFrontendMsgGetters").getDir(a)}))}};f.$PollVoteNotification$p_4=function(){return{body:this.bodyText}};return e}(d("WAWebBaseNotification").WABaseNotification);function i(a){var b=a.unreadCount;a=a.pollName;return h._(/*BTDS*/"_j{\"*\":\"{number_of_votes} new votes: \\ud83d\\udcca {pollName}\",\"_1\":\"1 new vote: \\ud83d\\udcca {pollName}\"}",[h._plural(b,"number_of_votes"),h._param("pollName",a)]).toString()}g.PollVoteNotification=a}),226);
__d("WAWebPremiumMessageHydrateMessageAction",["WASyncAction.pb","WAWebContactCollection","WAWebContactGetters","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WAWebContactCollection").ContactCollection.get(a.id.remote);if(c==null)return;switch(b.type){case d("WASyncAction.pb").SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType.PERSONALIZED:b=h(b,c);a.mediaData==null?a.set("body",b):a.set("caption",b);break;default:a.type=d("WAWebMsgType").MSG_TYPE.UNKNOWN;break}}function h(a,b){a=i(a,b);return a}function i(a,b){b=d("WAWebContactGetters").getPremiumMessageName(b);return b===""?a.message.replaceAll(/ ?<<customer_name>>/g,""):a.message.replace(/<<customer_name>>/g,b)}g.hydratePremiumMessage=a}),98);
__d("WAWebPremiumMessageCollection",["WAWebBaseCollection","WAWebPremiumMessageModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebPremiumMessageModel").PremiumMessage;b=new a();g.PremiumMessageCollection=b}),98);
__d("WAWebPremiumMessageModel",["WAWebBaseModel","WAWebMsgCollection","WAWebPremiumMessageHydrateMessageAction"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(),b.message=d("WAWebBaseModel").prop(),b.isDeleted=d("WAWebBaseModel").prop(),b.sentMessageIds=d("WAWebBaseModel").prop(),b.mediaId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.listenTo(this,"change:message change:sentMessageIds change:type",this.hydrateMessages)};c.hydrateMessages=function(){var a=this;d("WAWebMsgCollection").MsgCollection.getModelsArray().filter(function(b){return b.smbClientCampaignId===a.id}).forEach(function(b){d("WAWebPremiumMessageHydrateMessageAction").hydratePremiumMessage(b,a)})};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="premium_message";b=d("WAWebBaseModel").defineModel(a);g.PremiumMessage=b}),98);
__d("WaWebPDFNCommonUtils",["fbt","$InternalEnum","WAWebTos","WAWebUserDisclosureCollection","isStringNullOrEmpty","stylex"],(function(a,b,c,d,e,f,g,h){var i,j="ACCEPTED";f=b("$InternalEnum").Mirrored(["Meta","WhatsApp"]);b=b("$InternalEnum").Mirrored(["Blocking","NonBlocking"]);function a(a){var b=d("WAWebUserDisclosureCollection").UserDisclosureCollection.get(a);return b!=null&&b.accepted?!0:d("WAWebTos").TosManager.getState(a)===j}function e(a,b){var d,e,f,g,h,i=a==null||(d=a.privacyDisclosureModal)==null?void 0:d.bullets;i!=null&&i.forEach(function(a){a.text=k(a.text,b),c("isStringNullOrEmpty")(a.secondaryText)||(a.secondaryText=k(a.secondaryText,b))});var j=a==null||(e=a.privacyDisclosureModal)==null?void 0:e.footer;j=j!=null?k(j,b):j;var m={icon:a==null||(f=a.privacyDisclosureModal)==null?void 0:f.icon,iconSvg:a==null||(g=a.privacyDisclosureModal)==null?void 0:g.iconSvg,iconDescription:a==null||(h=a.privacyDisclosureModal)==null?void 0:h.iconDescription};a=l(a);return{bulletContent:i,footerContent:j,okText:a,headerContent:m}}function k(a,b){var d=new DOMParser();d=d.parseFromString(a,"text/html");a=b!=null?b:{};var e=a.linkXstyle;d.querySelectorAll("a").forEach(function(a){a.setAttribute("target","_blank"),e&&a.setAttribute("class",(i||(i=c("stylex")))(e))});return d.body.innerHTML}function l(a){var b;return(a=a==null||(b=a.privacyDisclosureModal)==null||(b=b.primaryButton)==null?void 0:b.label)!=null?a:h._(/*BTDS*/"Continue")}g.PdfnTheme=f;g.PdfnNoticeType=b;g.hasAcceptedTos=a;g.getFormattedPdfnContent=e}),226);
__d("WAWebFrontendConstants",[],(function(a,b,c,d,e,f){a=100;b=1024;c=264;f.SCROLL_FUDGE=a;f.LAYOUT_2COLUMNS_MAX_WIDTH=b;f.QR_EDGE=c}),66);
__d("WAWebBizCatalogUtils",["Promise","WATypeUtils","WAWebCatalogCollection","WAWebFrontendConstants","WAWebNonEmptyString","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i=3;function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.getData().length||0;c=!a.getCanLoadMore()||!n(c,a.listItemHeight);var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerAnnotate(b,{bool:{IsCached:c,IsConsumer:!e.equals(a.catalog.id)}});if(c)return!0;yield a.loadMore(!0);b=a.getData().length||0;return n(b,a.listItemHeight)?a.loadInitialItems():!0});return k.apply(this,arguments)}e=function(){function a(a,b,d,e){this.loading=null;this.catalog=a;this.collectionId=b;this.forCatalogManager=d;this.listItemHeight=e;if(!c("isStringNullOrEmpty")(b)){this.canLoadMoreCollectionItems=a.collections.length>0?((d=this.catalog.collections.get(b))==null?void 0:d.afterCursor)!=="":!0}else this.canLoadMoreAllItems=a.productCollection.length>0?!!this.catalog.afterCursor:!0}var e=a.prototype;e.loadMore=function(a){var e=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(h||(h=b("Promise"))).resolve();var f=this.collectionId;if(!c("isStringNullOrEmpty")(f)){a=a===!0?d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTION_VIEW_ALL:void 0;this.loading=this.catalog.collections.findCollectionProducts(this.catalog.id,f,!1,a).then(function(){var a;e.canLoadMoreCollectionItems=!!((a=e.catalog.collections.get(f))!=null&&a.afterCursor);e.loading=null})}else this.loading=d("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){e.canLoadMoreAllItems=!!e.catalog.afterCursor,e.loading=null});return this.loading};e.loadInitialItems=function(){var a=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTION_VIEW_ALL;return j(this,a)};e.getCanLoadMore=function(){return this.canLoadMoreCollectionItems||this.canLoadMoreAllItems};e.getData=function(){var a=this.collectionId;if(!c("isStringNullOrEmpty")(a)){a=((a=this.catalog.collections.get(a))==null?void 0:a.productCollection.getProductModels(this.forCatalogManager))||[]}else a=this.catalog.productCollection.getProductModels(this.forCatalogManager)||[];return a.map(function(a){return{product:a,collection:void 0}})};return a}();f=function(){function a(a,b,c,d){this.loading=null,this.catalog=a,this.forCatalogManager=b,this.listItemHeight=c,this.canLoadMoreCollections=a.collections.length>0?!!this.catalog.collections.afterCursor:!0,this.canLoadMoreCatalog=a.productCollection.length>0?!!this.catalog.afterCursor:!0,this.canLogQpl=d}var c=a.prototype;c.loadMore=function(a){var c=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(h||(h=b("Promise"))).resolve();if(this.canLoadMoreCollections){a=this.canLogQpl&&a===!0?d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW:void 0;this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,i,this.forCatalogManager,a).then(function(){c.canLoadMoreCollections=!!c.catalog.collections.afterCursor,c.loading=null})}else this.loading=d("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){c.canLoadMoreCatalog=!!c.catalog.afterCursor,c.loading=null});return this.loading};c.loadInitialItems=function(){var a=this.canLogQpl?d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_COLLECTIONS_VIEW:void 0;return j(this,a)};c.getCanLoadMore=function(){return this.canLoadMoreCollections||this.canLoadMoreCatalog};c.getData=function(){var a=this,b=this.catalog.collections.getCollectionModels(this.forCatalogManager);b=b.reduce(function(b,c){b===void 0&&(b=[]);var d=c.productCollection.getProductModels(a.forCatalogManager)||[];if(d.length!==0){var e;b.push({collection:c,product:void 0});d.length>i&&(d.length=i);(e=b).push.apply(e,d.map(function(a){return{product:a,collection:c}}))}return b},[]);var c=b.length>0;if(this.canLoadMoreCollections)return b;c&&b.push({allItems:{totalItemsCount:b.length}});c=this.catalog.productCollection.getProductModels(this.forCatalogManager).map(function(a){return{product:a,collection:void 0}});b.push.apply(b,c);return b};return a}();var l=function(){function a(a,b,c,d){this.loading=null,this.canLoadMoreCollections=!0,this.catalog=a,this.forCatalogManager=b,this.listItemHeight=c,this.canLogQpl=d}var c=a.prototype;c.loadMore=function(a){var c=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(h||(h=b("Promise"))).resolve();if(this.canLoadMoreCollections){a=this.canLogQpl&&a===!0?d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW:void 0;this.loading=this.catalog.collections.findCollectionsList(this.catalog.id,i,this.forCatalogManager,a).then(function(){c.canLoadMoreCollections=!!c.catalog.collections.afterCursor,c.loading=null})}return this.loading||(h||(h=b("Promise"))).resolve()};c.loadInitialItems=function(){var a=this.canLogQpl?d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_COLLECTIONS_MANAGEMENT_VIEW:void 0;return j(this,a)};c.getCanLoadMore=function(){return this.canLoadMoreCollections};c.resetData=function(){var a;(a=this.catalog)!=null&&a.collections&&(this.catalog.collections.reset(),this.catalog.collections.afterCursor="");this.canLoadMoreCollections=!0};c.getData=function(){return this.catalog.collections.getCollectionModels(this.forCatalogManager).map(function(a){return{collection:a,product:void 0}})};return a}(),m=function(){function a(a,b,c){this.loading=null,this.canLoadMore=!0,this.catalog=a,this.catalog.stale=!0,this.catalog.markProductCollectionOld(),this.catalog.productCollection.reset(),this.listItemHeight=b,this.collectionId=d("WAWebNonEmptyString").asMaybeNonEmptyString(c)}var e=a.prototype;e.loadMore=function(){var a=this;if(this.loading)return this.loading;if(!this.getCanLoadMore())return(h||(h=b("Promise"))).resolve();this.canLoadMore&&(c("isStringNullOrEmpty")(this.collectionId)?this.loading=d("WAWebCatalogCollection").CatalogCollection.update(this.catalog.id).then(function(){a.canLoadMore=!!a.catalog.afterCursor,a.loading=null}):this.loading=d("WAWebCatalogCollection").CatalogCollection.findCollectionMembership(this.catalog.id,this.collectionId).then(function(){a.canLoadMore=!!a.catalog.afterCursor,a.loading=null}));return this.loading||(h||(h=b("Promise"))).resolve()};e.loadInitialItems=function(){return j(this)};e.getCanLoadMore=function(){return this.canLoadMore};e.getData=function(){return this.catalog.productCollection.getProductModels(!0).map(function(a){return{product:a,collection:void 0}})};return a}();function n(a,b){return a*b<window.innerHeight}var o=function(){function a(a){this.dataSource=a}var c=a.prototype;c.isScrollAtBottom=function(a){return a.scrollTop+d("WAWebFrontendConstants").SCROLL_FUDGE>=a.scrollHeight-a.clientHeight};c.willLoadMore=function(a){return Boolean(this.dataSource.loading||this.isScrollAtBottom(a))};c.onScroll=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(this.dataSource.loading){yield this.dataSource.loading;return!0}if(this.isScrollAtBottom(b)){yield this.dataSource.loadMore();return!0}return!1});function c(b,c){return a.apply(this,arguments)}return c}();return a}();function a(a,b,e){a=d("WAWebCatalogCollection").CatalogCollection.get(a);var f,g;if(!a)return void 0;if(!c("isStringNullOrEmpty")(b)&&e){var h=a.productCollection.get(e.id);f=h&&a.productCollection.indexOf(h);return{productId:e.id.toString(),productIndex:d("WATypeUtils").isNumber(f)&&f>-1?f.toString():void 0}}if(!c("isStringNullOrEmpty")(b)){h=a.collections.get(b);g=h&&a.collections.indexOf(h);a=e&&(h==null?void 0:h.productCollection.get(e.id));f=a&&(h==null?void 0:h.productCollection.indexOf(a))}return{collectionId:b||"",productId:e==null?void 0:e.id.toString(),collectionIndex:d("WATypeUtils").isNumber(g)&&g>-1?g.toString():void 0,productIndex:d("WATypeUtils").isNumber(f)&&f>-1?f.toString():void 0}}g.SingleCollectionDataSource=e;g.CatalogWithCollectionsDataSource=f;g.CollectionsDataSource=l;g.CollectionsContentDataSource=m;g.CatalogListItemScrollHelper=o;g.getProductStatsInFetched=a}),98);
__d("WAWebChangeProfilePicThumb",["Promise","WAWebApiContact","WAWebBackendApi","WAWebContactProfilePicThumbBridge","WAWebProfilePicConstants","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[j(a,c)];if(a.isUser()){a=d("WAWebApiContact").getAlternateUserWid(a);a&&e.push(j(a,c))}yield (h||(h=b("Promise"))).all(e)});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b===d("WAWebProfilePicConstants").ProfilePicCommand.Remove)yield d("WAWebContactProfilePicThumbBridge").persistProfilePicToDB(a),d("WAWebBackendApi").frontendFireAndForget("removeProfilePicThumb",{wid:a});else return d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("setProfilePicThumb",{wid:a})});return k.apply(this,arguments)}g.changeProfilePicThumb=a}),98);
__d("WAWebProfilePicThumbCollection",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebBackendErrors","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebChatCollection","WAWebChatGetters","WAWebContactCollection","WAWebContactProfilePicThumbBridge","WAWebGroupType","WAWebNewsletterCollection","WAWebProfilePicPrivacyTokenGating","WAWebProfilePicThumbModel","WAWebSocketConstants","WAWebSocketModel","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsKeys","WAWebVcardParsingUtils","WAWebWid","asyncToGeneratorRuntime","cr:17219"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;a=function(a){function e(){var e,f;f=a.call(this)||this;f.findImpl=function(a){var e,f,g,h,i=a.isNewsletter()?c("WAWebNewsletterCollection"):d("WAWebChatCollection").ChatCollection;i=i.get(a);var j=(i==null||(e=i.groupMetadata)==null?void 0:e.groupType)===d("WAWebGroupType").GroupType.COMMUNITY,k=c("WAWebUnjoinedSubgroupMetadataCollection").get(a.toString());if(i!=null&&i.isReadOnly&&!j&&!(i!=null&&d("WAWebChatGetters").getIsNewsletter(i))&&k==null||i!=null&&(f=i.groupMetadata)!=null&&f.terminated||i!=null&&(g=i.newsletterMetadata)!=null&&g.terminated||i!=null&&(h=i.newsletterMetadata)!=null&&h.isPreview)return(n||(n=b("Promise"))).resolve({id:a,stale:!0});else if((c("WAWebWid").isUser(a)||c("WAWebWid").isGroup(a)||c("WAWebWid").isNewsletter(a))&&!c("WAWebWid").isPSA(a)){var l;j=j?a:i==null||(l=i.groupMetadata)==null?void 0:l.parentGroup;k!=null&&(j=k.parentGroupId);if(d("WAWebSocketModel").Socket.stream!==d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED){if(d("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&c("WAWebWid").isUser(a)){var m;i=d("WAWebContactCollection").ContactCollection.get(a);k=d("WAWebChatCollection").ChatCollection.get(a);return d("WAWebContactProfilePicThumbBridge").requestProfilePicFromServer(a,j,k==null?void 0:k.tcToken,(k==null?void 0:k.tcToken)==null?i==null||(m=i.maybeCommonGroupChatModel)==null?void 0:m.id:null)}return d("WAWebContactProfilePicThumbBridge").requestProfilePicFromServer(a,j)}return(n||(n=b("Promise"))).resolve({id:a,stale:!0})}return(n||(n=b("Promise"))).resolve({id:a,tag:null})};f._getUpdatedProfilePicModel=function(a){return{tag:a.tag,raw:void 0,stale:!1,eurl:a.eurl,eurlStale:!1,previewEurl:a.previewEurl,previewDirectPath:a.previewDirectPath,fullDirectPath:a.fullDirectPath,filehash:a.filehash,timestamp:Date.now()}};var g=(e=b("cr:17219"))==null?void 0:e.getWindowsBridge();g&&f.listenTo(f,"add remove change:timestamp",function(a,b,c){(b=g.pictures)==null||b.notifyUpdate(a)});return f}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.get=function(b){var c=a.prototype.get.call(this,b);this.isProfilePicRefreshNeeded(c==null?void 0:c.timestamp,c==null?void 0:c.eurlStale)&&(c==null||c.markStale({eurl:!0}));return!this.modelClass.prototype.isIdType(b)?c:c};f.resyncPicturesByWid=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;try{a=(yield d("WAWebContactProfilePicThumbBridge").profilePicResync(a.map(function(a){return{id:a}})));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures success"])));a.forEach(function(a){var c=b._getUpdatedProfilePicModel(a),d=b.get(a.id);d?d.set(c):b.add(babelHelpers["extends"]({id:a.id},c))})}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncMyProfilePicture failed: ",""])),a)}});function c(b){return a.apply(this,arguments)}return c}();f.resyncPictures=function(a){var c=this;return a.length===0?(n||(n=b("Promise"))).resolve():d("WAWebContactProfilePicThumbBridge").profilePicResync(a.map(function(a){return{id:a.id,tag:a.tag}})).then(function(b){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures success"]))),b.forEach(function(a){var b=c.get(a.id);b&&b.set(c._getUpdatedProfilePicModel(a))}),a.forEach(function(a){a.eurlStale&&c.update(a.id),a.stale=!1})})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status===423||a.status===429?d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures blocked ",""])),a.status):a.status>=400&&d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures dropped: ",""])),String(a))}))["catch"](function(a){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ProfilePicThumbStore:resyncPictures dropped: ",""])),String(a))})};f.findThumbnailWid=function(a){var b=this;return a.find(function(a){return(a=b.get(a))==null?void 0:a.img})};f.getThumbnailWidFromVcard=function(a){if(!a)return null;var b=d("WAWebVcardParsingUtils").vcardPhoneNumberWids(a);if(b.length>0){var c;return(c=this.findThumbnailWid(b))!=null?c:b[0]}c=d("WAWebVcardParsingUtils").vcardLidWid(a);return c!=null?c:null};f.isProfilePicRefreshNeeded=function(a,b){b===void 0&&(b=!1);if(a==null||b)return!0;b=Date.now()-a;return b>d("WATimeUtils").WEEK_MILLISECONDS};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebProfilePicThumbModel").ProfilePicThumb;a.staleCollection=!0;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.PROFILE_PIC_THUMB_COLLECTION,trigger:"change:tag",policy:d("WAWebBaseCachePolicy").CACHE_POLICY.NONE,delay:5e3};e=new a();g.ProfilePicThumbCollection=e}),98);
__d("WAWebProfilePicThumbModel",["WALogger","WAWebBaseModel","WAWebChatCollection","WAWebMediaHosts","WAWebMediaHostsRouteSelection","WAWebMmsClientSelectHost","WAWebMmsMediaTypes","WAWebProfilePicConstants","WAWebProfilePicThumbCollection","WAWebUserPrefsMeUser","WAWebWid","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k={SINGLE:"SINGLE",GROUP:"GROUP"};a=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.id=d("WAWebBaseModel").prop(),b.tag=d("WAWebBaseModel").prop(),b.raw=d("WAWebBaseModel").prop(),b.eurl=d("WAWebBaseModel").prop(),b.previewEurl=d("WAWebBaseModel").prop(),b.fullDirectPath=d("WAWebBaseModel").prop(),b.previewDirectPath=d("WAWebBaseModel").prop(),b.filehash=d("WAWebBaseModel").prop(),b.stale=d("WAWebBaseModel").session(!0),b.eurlStale=d("WAWebBaseModel").session(!1),b.pendingPic=d("WAWebBaseModel").session(),b.timestamp=d("WAWebBaseModel").session(),b.hostRetryCount=d("WAWebBaseModel").session(0),b.lastHostUsed=d("WAWebBaseModel").session(),b.img=d("WAWebBaseModel").derived(function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;return!this.tag?void 0:this.previewDirectPath!=null?this.$ProfilePicThumbImpl$p_1(this.previewDirectPath,this.filehash):this.previewEurl},["tag","raw","stale","eurl","eurlStale","previewEurl","previewDirectPath","hostRetryCount"]),b.imgFull=d("WAWebBaseModel").derived(function(){if((this.raw||!this.tag)&&this.stale)return null;if(this.raw)return void 0;return!this.tag?void 0:this.fullDirectPath!=null?this.$ProfilePicThumbImpl$p_1(this.fullDirectPath,this.filehash):this.eurl},["tag","raw","stale","eurl","eurlStale","fullDirectPath","hostRetryCount"]),b.fallbackType=d("WAWebBaseModel").derived(function(){if(c("WAWebWid").isUser(this.id))return k.SINGLE;else if(c("WAWebWid").isGroup(this.id))return k.GROUP;return k.GROUP},["id"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.markStale=function(a){this.stale=!0,(a==null?void 0:a.eurl)===!0&&(this.eurlStale=!0)};e.markMms4HostSuccess=function(){this.hostRetryCount=0};e.markMms4HostFailure=function(){this.hostRetryCount++,d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["increased mms4 retry count: ",""])),this.hostRetryCount).tags("mms4")};e.validate=function(){if(!this.stale&&!this.eurlStale)return;return this.getCollection().update(this.id)};e.canSet=function(){if(c("WAWebWid").isGroup(this.id)){var a,b=d("WAWebChatCollection").ChatCollection.get(this.id);b=b==null||(a=b.groupMetadata)==null?void 0:a.participants.iAmRestrictedMember();return!b}return d("WAWebUserPrefsMeUser").isMeAccount(this.id)?!0:!1};e.canDelete=function(){var a=!c("isStringNullOrEmpty")(this.tag);if(c("WAWebWid").isGroup(this.id)&&a){var b,e=d("WAWebChatCollection").ChatCollection.get(this.id);e=e==null||(b=e.groupMetadata)==null?void 0:b.participants.iAmRestrictedMember();return!e}return d("WAWebUserPrefsMeUser").isMeAccount(this.id)&&a?!0:!1};e.getCollection=function(){return d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection};e.$ProfilePicThumbImpl$p_1=function(a,b){var c=d("WAWebProfilePicConstants").DEFAULT_HOSTNAME;try{c=this.$ProfilePicThumbImpl$p_2(a,b).hostname}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to resolve mms4 hostname for profile-pic, falling back to static host. Error : ","."])),a).tags("mms4")}d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Using mms4 download url for profile-pic with host name ","."])),c).tags("mms4");return"https://"+c+a};e.$ProfilePicThumbImpl$p_2=function(a,b){a=d("WAWebMediaHosts").mediaHosts.getCachedHostsInfo({directPath:a,encFilehash:b,operation:d("WAWebMediaHostsRouteSelection").OPERATIONS.DOWNLOAD,type:d("WAWebMmsMediaTypes").MEDIA_TYPES.PPIC});b=a.selectedHost;a=a.fallbackHost;b=c("WAWebMmsClientSelectHost")({selectedHost:b,fallbackHost:a,attemptCount:this.hostRetryCount,lastHostUsed:this.lastHostUsed,lastFetchMadeProgress:this.hostRetryCount===0});this.lastHostUsed=b;return b};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="profilePicThumb";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g.ProfilePicThumbImpl=a;g.ProfilePicThumb=b}),98);
__d("WAWebNewsletterQuestionResponseModel",["WAWebAck","WAWebAddOnModel","WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.parentMsgKey=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.body=d("WAWebBaseModel").prop(),b.id=d("WAWebBaseModel").prop(),b.responseServerId=d("WAWebBaseModel").prop(),b.questionServerId=d("WAWebBaseModel").prop(),b.senderNotifyName=d("WAWebBaseModel").prop(),b.replied=d("WAWebBaseModel").prop(!1),b.senderPictureDirectPath=d("WAWebBaseModel").prop(),b.isSentByMe=d("WAWebBaseModel").prop(!1),b.senderId=d("WAWebBaseModel").prop(),b.isSendFailure=d("WAWebBaseModel").prop(),b.isFailed=d("WAWebBaseModel").derived(function(){var a=this.isSentByMe&&this.ack!=null&&this.ack<d("WAWebAck").ACK.CLOCK;return a||Boolean(this.isSendFailure)},["ack","isSendFailure"]),b.links=d("WAWebBaseModel").session(function(){return[]}),b.linksIndexParsed=d("WAWebBaseModel").session(0),b.phoneNumbers=d("WAWebBaseModel").session(function(){return[]}),b.phoneNumbersIndexParsed=d("WAWebBaseModel").session(0),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebAddOnModel").AddOnBaseModel);a.Proxy="newsletterQuestionResponse";b=d("WAWebBaseModel").defineModel(a);g.NewsletterQuestionResponse=b}),98);
__d("WAWebNewsletterQuestionResponseCollection",["WAWebBaseCollection","WAWebCollectionUtils","WAWebNewsletterQuestionResponseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.byParent=d("WAWebCollectionUtils").aggregated(function(a){return a.parentMsgKey}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebNewsletterQuestionResponseModel").NewsletterQuestionResponse;b=new a();g.QuestionResponseCollection=b}),98);
__d("WAWebQuickReplyEnum",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({TEXT:"text",ADDRESS_SMART_DEFAULT:"address_smart_default",HOURS_SMART_DEFAULT:"hours_smart_default",PROFILE_SMART_DEFAULT:"profile_smart_default",PIX_KEY_SMART_DEFAULT:"pix_key_smart_default"});f.QuickReplyTypes=a}),66);
__d("WAWebQuickReplyGetters",["WAWebGetters","WAWebGettersCaches","WAWebQuickReplyEnum"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createQuickReplyCache});b=a.field;c=a.computed;e=a.unsafeIdentityGetter;f=a.clearCacheFor;a=f;f=e;e=b("id");b=b("count");c=c(function(a){a=a[0];a=(a=d("WAWebQuickReplyEnum").QuickReplyTypes.cast(a))!=null?a:d("WAWebQuickReplyEnum").QuickReplyTypes.TEXT;switch(a){case d("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT:return d("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT;case d("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT:return d("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT;case d("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT:return d("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT;case d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT;default:return d("WAWebQuickReplyEnum").QuickReplyTypes.TEXT}},[e]);g.clearQuickReplyGetterCacheFor=a;g.getQuickReplyUnsafe=f;g.getCount=b;g.getType=c}),98);
__d("WAWebFrontendQuickReplyGetters",["WAWebGetters","WAWebGettersCaches","WAWebQuickReplyGetters"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({root:d("WAWebQuickReplyGetters").getQuickReplyUnsafe,createCache:d("WAWebGettersCaches").createFrontendQuickReplyCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;a=b("pendingCount");e=c(function(a){var b=a[0];a=a[1];return b+a},[d("WAWebQuickReplyGetters").getCount,a]);g.clearFrontendQuickReplyGetterCacheFor=f;g.getTotalCount=e}),98);
__d("WAWebBizQuickReplyBridge",["Promise","WAWebSchemaQuickReply"],(function(a,b,c,d,e,f,g){var h;function a(a){(h||(h=b("Promise"))).resolve();var c=a.id,e=a.shortcut,f=a.count,g=a.message;a=a.keywords;c={id:c,shortcut:e,count:f,message:g,keywords:a};e=d("WAWebSchemaQuickReply").getQuickReplyTable().createOrReplace(c);return e}g.updateQuickReply=a}),98);
__d("WAWebQuickReplyModel",["WAWebBaseModel","WAWebBizQuickReplyBridge","WAWebFrontendQuickReplyGetters","WAWebQuickReplyEnum","WAWebQuickReplyGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.shortcut=d("WAWebBaseModel").prop(),b.message=d("WAWebBaseModel").prop(),b.count=d("WAWebBaseModel").prop(),b.keywords=d("WAWebBaseModel").prop(),b.pendingCount=d("WAWebBaseModel").session(0),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.useOnce=function(){this.isSmartDefault()?(this.count+=1,void d("WAWebBizQuickReplyBridge").updateQuickReply(this)):this.pendingCount+=1};c.isSmartDefault=function(){switch(d("WAWebQuickReplyGetters").getType(this)){case d("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT:case d("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT:case d("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT:case d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return!0;default:return!1}};c.hideFromGroupChat=function(){switch(d("WAWebQuickReplyGetters").getType(this)){case d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return!0;default:return!1}};c.hideForRecipientCountryCode=function(a){switch(d("WAWebQuickReplyGetters").getType(this)){case d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT:return a!=="BR";default:return!1}};c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebQuickReplyGetters").clearQuickReplyGetterCacheFor(this),d("WAWebFrontendQuickReplyGetters").clearFrontendQuickReplyGetterCacheFor(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="quickReply";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebQuickReplyCollection",["WAWebBaseCollection","WAWebFrontendQuickReplyGetters","WAWebQuickReplyModel","WAWebQuickReplySmartDefaults"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.smartDefaultsAdded=!1,b.sortQuickReply=function(a,b){var c=d("WAWebFrontendQuickReplyGetters").getTotalCount(a),e=d("WAWebFrontendQuickReplyGetters").getTotalCount(b);return c===e?a.id<b.id?-1:1:c>e?-1:1},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.addSmartDefaultsIfNeeded=function(){this.smartDefaultsAdded===!1&&(d("WAWebQuickReplySmartDefaults").addSmartDefaults(),this.smartDefaultsAdded=!0)};c.filterShortcuts=function(a){var b=this.filter(function(b){b=b.shortcut;return b.toLowerCase().startsWith(a.toLowerCase())});return b.sort(this.sortQuickReply)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebQuickReplyModel");b=new a();g.QuickReplyCollection=b}),98);
__d("WAWebBizFrontendGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeaturesModel"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.paymentInfoSyncSupport&&d("WAWebABProps").getABPropConfigValue("order_details_payment_instructions_sync_enabled")}function b(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&d("WAWebABProps").getABPropConfigValue("payments_br_pix_phase_1_seller_sync_enabled")}function c(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&d("WAWebABProps").getABPropConfigValue("payments_br_pix_quick_reply_enabled")}function e(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("payments_br_force_copy_pix_cta_enabled")}function f(){return d("WAWebABProps").getABPropConfigValue("payments_br_copy_pix_code_api_merchant_enabled")}function h(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.customPaymentMethodsSyncSupport&&d("WAWebABProps").getABPropConfigValue("payments_br_pix_on_web")}g.isOrderDetailsPaymentInstructionsSyncEnabled=a;g.isCustomPaymentMethodsSyncEnabled=b;g.isPixInQuickReplyEnabled=c;g.isForceCopyPixCTAEnabled=e;g.isAPICopyPixCTAEnabled=f;g.isPixOnWebEnabled=h}),98);
__d("WAWebBrazilPixKeyFormattingUtils",["fbt","WAWebUserPrefsTypes"],(function(a,b,c,d,e,f,g,h){"use strict";var i=/^(\d{3})(\d{3})(\d{3})(\d{2})$/g,j="$1.$2.$3-$4",k=/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/g,l="$1.$2.$3/$4-$5",m=/^(\+\d{2})(\d{2})(\d{4,5})(\d{4})$/g,n="$2 $3-$4";function a(a,b){if(b==null)return a;switch(b){case d("WAWebUserPrefsTypes").PixKeyType.CPF:return o(a);case d("WAWebUserPrefsTypes").PixKeyType.CNPJ:return p(a);case d("WAWebUserPrefsTypes").PixKeyType.PHONE:return q(a);case d("WAWebUserPrefsTypes").PixKeyType.EMAIL:case d("WAWebUserPrefsTypes").PixKeyType.EVP:return a}}function b(a,b){if(b==null)return a;switch(b){case d("WAWebUserPrefsTypes").PixKeyType.PHONE:return a.substr(3);default:return a}}function c(a){a=(a=d("WAWebUserPrefsTypes").PixKeyType.cast(a))!=null?a:d("WAWebUserPrefsTypes").PixKeyType.PHONE;switch(a){case d("WAWebUserPrefsTypes").PixKeyType.CPF:return h._(/*BTDS*/"CPF");case d("WAWebUserPrefsTypes").PixKeyType.CNPJ:return h._(/*BTDS*/"CNPJ");case d("WAWebUserPrefsTypes").PixKeyType.PHONE:return h._(/*BTDS*/"Phone");case d("WAWebUserPrefsTypes").PixKeyType.EMAIL:return h._(/*BTDS*/"Email");case d("WAWebUserPrefsTypes").PixKeyType.EVP:return h._(/*BTDS*/"EVP")}}function o(a){return a.replace(i,j)}function p(a){return a.replace(k,l)}function q(a){return a.replace(m,n)}g.getFormattedPixKey=a;g.getCopiedPixKey=b;g.getPixKeyTypeLabel=c}),226);
__d("WAWebUserPrefsCustomPaymentMethods",["WALogger","WAWebUserPrefsKeys","WAWebUserPrefsLocalStorage","WAWebUserPrefsTypes"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function m(a){return a!=null&&o(a.display_name)&&o(a.credentialId)&&o(a.key)&&o(a.key_type)&&d("WAWebUserPrefsTypes").PixKeyType.cast(a.key_type)!=null&&o(a.country)}function a(){var a;a=(a=n())==null?void 0:a.pix;return m(a)&&a?a:null}function n(){var a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.CUSTOM_PAYMENT_METHODS);return a}function b(a){var b={};a.forEach(function(a){var c=d("WAWebUserPrefsTypes").WACustomPaymentMethodType.cast(a.type);if(c==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["invalid custom payment method type: ",""])),a.type).sendLogs("monitor-errors");return}switch(c){case d("WAWebUserPrefsTypes").WACustomPaymentMethodType.PIX_KEY:var e,f;c=(c=a.metadata.filter(function(a){return a.key==="pix_key"}))==null||(c=c.at(0))==null?void 0:c.value;if(c==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["pix_key is null"]))).sendLogs("monitor-errors");return}e=(e=a.metadata.filter(function(a){return a.key==="pix_key_type"}))==null||(e=e.at(0))==null?void 0:e.value;if(e==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["pix_key_type is null"]))).sendLogs("monitor-errors");return}e=d("WAWebUserPrefsTypes").PixKeyType.cast(e.toUpperCase());if(e==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["pix_key_type is invalid"]))).sendLogs("monitor-errors");return}f=(f=a.metadata.filter(function(a){return a.key==="pix_display_name"}))==null||(f=f.at(0))==null?void 0:f.value;if(f==null){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["pix_display_name is null"]))).sendLogs("monitor-errors");return}b.pix={credentialId:a.credentialId,key:c,key_type:e,display_name:f,country:a.country};break}});c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.CUSTOM_PAYMENT_METHODS,b)}function e(){var a;a=(a=n())==null?void 0:a.pix;return m(a)}function o(a,b){b===void 0&&(b=!1);return b&&a==null?!0:typeof a==="string"&&a.trim().length>0}g.getPIX=a;g.setCustomPaymentMethods=b;g.isPIXValid=e;g.isStringFieldValid=o}),98);
__d("WAWebQuickReplySmartDefaults",["fbt","WAWebBizFrontendGatingUtils","WAWebBrazilPixKeyFormattingUtils","WAWebBusinessProfileCollection","WAWebBusinessProfileUtils","WAWebContactCollection","WAWebFrontendContactGetters","WAWebQuickReplyCollection","WAWebQuickReplyEnum","WAWebQuickReplyModel","WAWebUserPrefsCustomPaymentMethods","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g,h){function a(){o(),i(),j(),k()}function i(){var a=d("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT,b=m();!d("WAWebQuickReplyCollection").QuickReplyCollection.get(a)?b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add(b,{merge:!0}):b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add({id:a,message:b.message},{merge:!0})}function j(){var a=d("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT,b=n();!d("WAWebQuickReplyCollection").QuickReplyCollection.get(a)?b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add(b,{merge:!0}):b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add({id:a,message:b.message},{merge:!0})}function k(){var a=d("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT,b=l();!d("WAWebQuickReplyCollection").QuickReplyCollection.get(a)?b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add(b,{merge:!0}):b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add({id:a,message:b.message},{merge:!0})}function l(){var a,b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(b==null)return;b=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(b);if(b!=null&&(a=b.businessHours)!=null&&a.config){var e=d("WAWebQuickReplyEnum").QuickReplyTypes.HOURS_SMART_DEFAULT;b=d("WAWebBusinessProfileUtils").quickReplyHoursStr(b.businessHours);return new(c("WAWebQuickReplyModel"))({id:e,shortcut:h._(/*BTDS*/"Hours").toString(),message:b,count:-1,keywords:[]})}}function m(){var a=d("WAWebContactCollection").ContactCollection.getMeContact();if(a){var b=d("WAWebQuickReplyEnum").QuickReplyTypes.PROFILE_SMART_DEFAULT;return new(c("WAWebQuickReplyModel"))({id:b,shortcut:h._(/*BTDS*/"Profile").toString(),message:d("WAWebFrontendContactGetters").getDisplayName(a),count:-1,keywords:[]})}}function n(){var a=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(a==null)return;a=d("WAWebBusinessProfileCollection").BusinessProfileCollection.get(a);if((a==null?void 0:a.latitude)!=null||(a==null?void 0:a.longitude)!=null||(a==null?void 0:a.address)!=null){var b=d("WAWebQuickReplyEnum").QuickReplyTypes.ADDRESS_SMART_DEFAULT;a=a.address||h._(/*BTDS*/"Map location");var e="\ud83d\udccd";return new(c("WAWebQuickReplyModel"))({id:b,shortcut:h._(/*BTDS*/"Address").toString(),message:h._(/*BTDS*/"{pinEmoji} {address}",[h._param("pinEmoji",e),h._param("address",a)]).toString(),count:-1,keywords:[]})}}function o(){var a=d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT,b=p();d("WAWebQuickReplyCollection").QuickReplyCollection.get(a)?b?d("WAWebQuickReplyCollection").QuickReplyCollection.add({id:a,message:b.message},{merge:!0}):d("WAWebQuickReplyCollection").QuickReplyCollection.remove(a):b&&d("WAWebQuickReplyCollection").QuickReplyCollection.add(b,{merge:!0})}function p(){if(d("WAWebBizFrontendGatingUtils").isPixInQuickReplyEnabled()){var a=d("WAWebUserPrefsCustomPaymentMethods").getPIX();if(a){var b=d("WAWebQuickReplyEnum").QuickReplyTypes.PIX_KEY_SMART_DEFAULT;return new(c("WAWebQuickReplyModel"))({id:b,shortcut:h._(/*BTDS*/"Pix").toString(),message:d("WAWebBrazilPixKeyFormattingUtils").getFormattedPixKey(a.key,a.key_type),count:-1,keywords:[]})}}}g.addSmartDefaults=a;g.getOrUpdatePixKeySmartDefault=o}),226);
__d("WAWebReactionsMsgAction",["WAAbortError","WAJobOrchestratorTypes","WALogger","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebAddonGatingUtils","WAWebDBCreateOrUpdateReactions","WAWebLidMigrationUtils","WAWebMaybe","WAWebMessageAddOnType","WAWebMsgCollection","WAWebMsgModel","WAWebMsgReactionsBridge","WAWebNotificationBackend","WAWebOrchestratorNonPersistedJob","WAWebReactionDataUtils","WAWebReactionGatingUtils","WAWebReactionNotificationUtils","WAWebReactionsBEUtils","WAWebReactionsCollection","WAWebReactionsMsgActionUtils","WAWebSendAddonMsgChatAction","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=["senderUserJid"],i,j,k,l,m,n;function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.allowNotify;var c=a.parentMsgKey,e=d("WAWebReactionDataUtils").reactionRowToReactionMsgData(a);b=Boolean(b)&&!d("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(e);var f;b?f=(yield d("WAWebReactionsCollection").ReactionsCollection.find(c)):f=d("WAWebReactionsCollection").ReactionsCollection.getAddressingModeInsensitive(c);if(f){d("WAWebReactionsCollection").ReactionsCollection.addOrUpdateReaction(a);f=f.reactions.length>0;yield d("WAWebMsgReactionsBridge").updateHasReactionInParent(c,f)}else a.reactionText!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&(yield d("WAWebMsgReactionsBridge").updateHasReactionInParent(c,!0)),d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions Reaction Model does not exist for this parentMsg"])));b&&!d("WAWebReactionGatingUtils").isReactionNotificationAddOnApiEnabled()&&(d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions Notify for this reaction"]))),d("WAWebNotificationBackend").showReactionNotification(e))});return p.apply(this,arguments)}function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions([a]));a=a[0];if(!a){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["actions:addOrUpdateReactions reaction was not added or updated in the DB"])));return}o(a,{allowNotify:b});return a});return q.apply(this,arguments)}function e(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a.senderUserJid;var c=babelHelpers.objectWithoutPropertiesLoose(a,h);b=(b=d("WAWebReactionsCollection").ReactionsCollection.getExistingSenderModelFromReactionDetails(c))!=null?b:d("WAWebMaybe").ifSome(d("WAWebLidMigrationUtils").getAlternateMsgKey(c.msgKey),function(a){return d("WAWebReactionsCollection").ReactionsCollection.getExistingSenderModelFromReactionDetails(babelHelpers["extends"]({},c,{msgKey:a}))});if(b==null){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["WAWebReactionsUtils:resendUpdateFailedPropsForSentReactionsDBAndModel Reactions model not found for this message id"])));return}yield s(a,b.timestamp)});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=d("WAWebMsgCollection").MsgCollection.get(a.parentMsgKey),g=a.parentMsgKey,h=a.msgKey;if(f){g=g.remote;var i=d("WAWebReactionsMsgActionUtils").getFromForReactionMessage(f);f=(yield d("WAWebReactionsMsgActionUtils").getReactionMsgData(f,a.reactionText,i,h,Math.floor(e/1e3),g,e));if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(f)){i=(yield d("WAWebSendAddonMsgChatAction").addAndSendAddonToChat(f));if(i.messageSendResult!==d("WAWebSendMsgResultAction").SendMsgResult.OK)throw c("err")("Reaction send error");return}var j=new(d("WAWebMsgModel").Msg)(f);yield d("WAWebAddOnsUpdateSendStatesAction").updateAddOnSendStatesAction(new Map([[d("WAWebMessageAddOnType").MessageAddOnType.Reaction,[{msgKey:a.msgKey.toString(),ack:d("WAWebAck").ACK.CLOCK,isSendFailure:!1}]]]));return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSendMsgRecordAction").sendMsgRecord(j)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}});return t.apply(this,arguments)}function f(a){for(a of a){var b=!d("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(a);b&&(d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["actions:handleReactionNotification Notify for this reaction"]))).devConsole(a),d("WAWebNotificationBackend").showReactionNotification(a)["catch"](d("WAAbortError").catchAbort(function(a){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["actions:handleReactionNotification - notification aborted ",""])),a)})))}}g.addOrUpdateReactionsModelCollection=o;g.addOrUpdateReactions=a;g.resendUpdateFailedPropsForSentReactionsDBAndModel=e;g.handleReactionNotification=f}),98);
__d("WAWebReactionsMsgActionUtils",["WALogger","WANullthrows","WAWebAck","WAWebAddonEncryption","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebReferentialMsgKey","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){a=Boolean((a=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata)==null?void 0:a.isCag);var b=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow();return a?b:d("WAWebUserPrefsMeUser").getMePnUserOrThrow()}function e(a,b,c,d,e,f,g){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,j,k){var l,m=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(f,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon);e.equals(m.from)||d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["create reaction: "," and "," do not match"])),e.toLogString(),m.from.toLogString()).tags("messaging").sendLogs("reactionMsgData: from is not matching",{sampling:.01});j.equals(m.to)||d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["create reaction: "," and "," do not match"])),j.toLogString(),m.to.toLogString()).tags("messaging").sendLogs("reactionMsgData: to is not matching",{sampling:.01});if((l=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata)!=null&&l.isCag){l=self.crypto.getRandomValues(new Uint8Array(12));var n={type:d("WAWebMsgType").MsgKind.ReactionDecrypted,encode:{text:b,senderTimestampMs:k}};n=(yield d("WAWebAddonEncryption").encryptAddOn(n,{messageSecret:c("WANullthrows")(a.messageSecret,"Parent message missing message secret"),iv:l,stanzaId:a.id.id,originalMessageSender:d("WAWebMsgGetters").getOriginalSender(a.unsafe()),addOnSender:d("WAWebWidFactory").asUserWidOrThrow(e)}));n=n.encPayload;return{id:f,type:d("WAWebMsgType").MSG_TYPE.REACTION_ENC,kind:d("WAWebMsgType").MsgKind.ReactionEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:g,from:e,to:j,author:m.author,ack:d("WAWebAck").ACK.CLOCK,targetMessageKey:d("WAWebReferentialMsgKey").getReferentialMsgKey(a),encPayload:n,encIv:l.buffer}}return{id:f,reactionParentKey:d("WAWebReferentialMsgKey").getReferentialMsgKey(a),type:d("WAWebMsgType").MSG_TYPE.REACTION,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,t:g,from:e,to:j,author:m.author,ack:d("WAWebAck").ACK.CLOCK,reactionText:b,reactionTimestamp:k,read:!0}});return j.apply(this,arguments)}g.getFromForReactionMessage=a;g.getReactionMsgData=e}),98);
__d("WAWebNotificationsBaseReactionNotification",["WALogger","WANullthrows","WAWebBaseNotification","WAWebConstantsDeprecated","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebNotificationController","WAWebNotificationHelpers","WAWebNotificationMuteReason","WAWebReactionNotificationUtils","WAWebReactionsCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=function(a){function e(b){var e;b=b.reactionMsg;e=a.call(this)||this;e.$WABaseReactionNotification$p_1=function(){d("WAWebFrontendMsgGetters").getChat(e.parentMsg)!=null&&e.parentMsg!=null&&d("WAWebFrontendMsgGetters").getChat(e.parentMsg).reactionSquelch===c("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE&&(e.parentMsg.squelch=c("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE)};d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: constructor"]))).devConsole({reactionMsg:b});e.reactionMsg=b;b=d("WAWebMsgCollection").MsgCollection.get(c("WANullthrows")(e.reactionMsg.reactionParentKey).toString());if(b==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: parentMsg is not present in the MsgCollection. It may need to be hydrated."]))).devConsole(e);return babelHelpers.assertThisInitialized(e)}e.parentMsg=b;return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.beforeBannerShown=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.parentMsg==null)return;var a=(yield d("WAWebReactionsCollection").ReactionsCollection.findAddressingModeInsensitive(this.parentMsg.id.toString()));if(a){a=d("WAWebReactionsCollection").ReactionsCollection.getAggregateEmojiAndSender(a,d("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg).toString());a=a.reactionSenderModel;this.reactionSender=a}else d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: Reaction model not found"])))});function c(){return a.apply(this,arguments)}return c}();f.afterBannerShown=function(a){var b=this;if(this.reactionSender!=null){var c=this.reactionSender,e=d("WAWebFrontendMsgGetters").getMaybeChat(this.parentMsg);c.on("revoked change:read",this.closeBanner);e==null||e.on("change:reactionSquelch",this.$WABaseReactionNotification$p_1);a.waitForClose().then(function(){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["WAReactionNotification: cleaning up reaction notification"]))),c.off("revoked change:read",b.closeBanner),e==null||e.off("change:reactionSquelch",b.$WABaseReactionNotification$p_1)})}};f.shouldMute=function(a){if(c("WAWebEnvironment").isWindows&&this.reactionMsg.viewed===!0)return c("WAWebNotificationMuteReason").IgnoreViewedMsgs;if(d("WAWebReactionNotificationUtils").nonHydratedShouldMuteReactionNotification(this.reactionMsg))return c("WAWebNotificationMuteReason").NonHydratedReaction;if(this.parentMsg==null)return c("WAWebNotificationMuteReason").ParentMsgMissing;if(this.shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState};f.shouldSquelch=function(){var a=d("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey());if(a)return null};f.buildKey=function(){return"reaction:"+this.parentMsg.id.toString()+"-"+d("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg).toString()};f.shouldMuteDueToAppState=function(a){return d("WAWebNotificationHelpers").shouldMuteDueToAppState(a)};return e}(d("WAWebBaseNotification").WABaseNotification);g.WABaseReactionNotification=a}),98);
__d("WAWebNotificationsReactionNotification",["WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNoop","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebNotificationsBaseReactionNotification","WAWebReactionNotificationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function e(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(b){b=a.prototype.shouldMute.call(this,b);if(b!=null)return b;b=d("WAWebFrontendMsgGetters").getChat(this.parentMsg);if(d("WAWebMuteGetters").getIsMuted(b.mute))return c("WAWebNotificationMuteReason").MutedChat;return d("WAWebReactionNotificationUtils").isArchivedChat(b)?c("WAWebNotificationMuteReason").ArchivedChat:null};f.shouldSquelch=function(){if(a.prototype.shouldSquelch.call(this)==null)return null;var b=d("WAWebFrontendMsgGetters").getChat(this.parentMsg);if(d("WAWebNotificationHelpers").shouldSquelch(b,!1))return c("WAWebNotificationMuteReason").GroupFlood;return d("WAWebReactionNotificationUtils").shouldSquelchReactionMessage(b,this.parentMsg)?c("WAWebNotificationMuteReason").ReactionFlood:null};f.matchesChat=function(a){return d("WAWebFrontendMsgGetters").getChat(this.parentMsg).equals(a)};f.getChatKind=function(){return d("WAWebFrontendChatGetters").getKind(d("WAWebFrontendMsgGetters").getChat(this.parentMsg))};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebFrontendMsgGetters").getChat(this.parentMsg);return d("WAWebNotificationIconUtils").getChatNotificationIcon(a,this.abortController.signal)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=this.parentMsg,b=d("WAWebFrontendMsgGetters").getChat(a),e=d("WAWebReactionNotificationUtils").getNotificationPartsForChatReaction(a,this.reactionMsg),f=e.action,g=e.author;e=e.body;f=d("WAWebGetNotificationStrings").getNotificationBody({action:f,author:g,body:e,msgDir:d("WAWebFrontendMsgGetters").getDir(a)});return{wid:b.id,msgId:a.id.toString(),onClick:c("WAWebNoop"),tag:a.id.toString(),doNotOpenChat:!1,title:d("WAWebNotificationHelpers").getNotificationTitle(b),body:f}};return e}(d("WAWebNotificationsBaseReactionNotification").WABaseReactionNotification);g.WAReactionNotification=a}),98);
__d("WAWebNotificationsStatusReactionNotification",["WANullthrows","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebNotificationsBaseReactionNotification","WAWebReactionNotificationUtils","WAWebStatusNotificationUtils","asyncToGeneratorRuntime","cr:7293"],(function(a,b,c,d,e,f,g){e=(a=b("cr:7293"))!=null?a:{};var h=e.getStatusReactionsSetting;f=function(a){function e(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(b){b=a.prototype.shouldMute.call(this,b);return b!=null?b:(h==null?void 0:h())===!1?c("WAWebNotificationMuteReason").MutedStatusReaction:null};f.matchesChat=function(a){return a.id.isStatus()};f.getChatKind=function(){return null};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getNotificationIconByWid(d("WAWebReactionNotificationUtils").getReactionSenderJid(this.reactionMsg),this.abortController.signal,d("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=this.parentMsg,b=d("WAWebReactionNotificationUtils").getNotificationPartsForStatusReaction(a,this.reactionMsg),e=b.action,f=b.author;b=b.body;e=d("WAWebGetNotificationStrings").getNotificationBody({action:e,body:b,msgDir:d("WAWebFrontendMsgGetters").getDir(a)});b=function(){d("WAWebStatusNotificationUtils").openStatusViewer(a)};return{wid:a.id.remote,msgId:a.id.toString(),onClick:b,tag:a.id.toString(),doNotOpenChat:!0,title:c("WANullthrows")(f),body:e}};f.shouldMuteDueToAppState=function(b){return c("WAWebEnvironment").isWindows?!1:a.prototype.shouldMuteDueToAppState.call(this,b)};return e}(d("WAWebNotificationsBaseReactionNotification").WABaseReactionNotification);g.WAStatusReactionNotification=f}),98);
__d("WAWebChatContactUtils",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a,b){b===void 0&&(b=!0);return a==null||a===""?"":"~"+(b?"\u202f":"")+a}function b(a){return a==null||a===""?"":h._(/*BTDS*/"Maybe {notifyName}",[h._param("notifyName",a)])}g.getFormattedNotifyName=a;g.getAccessibleNotifyName=b}),226);
__d("WAWebReactionNotificationUtils",["fbt","WANullthrows","WAWebChatContactUtils","WAWebChatGetters","WAWebConstantsDeprecated","WAWebContactCollection","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebEmoji","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebGroupMetadataCollection","WAWebMsgGetters","WAWebMsgType","WAWebMuteCollection","WAWebMuteGetters","WAWebNotificationHelpers","WAWebReactionsBEUtils","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWidFormat"],(function(a,b,c,d,e,f,g,h){function i(a){return d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}function a(a){var b=a.read,c=a.reactionText,e=i(a).toString();if(b===!0)return!0;if(d("WAWebUserPrefsMeUser").isSerializedWidMe(e))return!0;if(!a.reactionParentKey.fromMe)return!0;if(c===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT)return!0;if(d("WAWebNotificationHelpers").isOfflineResumeInProgress())return!0;return d("WAWebMuteGetters").getIsMuted(d("WAWebMuteCollection").MuteCollection.globalReactionsMute())?!0:!1}function b(a,b){if(!d("WAWebChatGetters").getIsGroup(a))return!1;var e=Date.now(),f=b.squelch||0;if(e>f){c("WAWebGroupMetadataCollection").find(a.id).then(function(e){if(e!=null){e=d("WAWebNotificationHelpers")._calculateTimeoutFromGroupMetadata(a.id,e);e=Date.now()+e;b.squelch=e;a.reactionSquelch===c("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE&&(a.reactionSquelch=e)}});return!1}return!0}function j(a,b){b=i(b);var c=d("WAWebContactCollection").ContactCollection.gadd(b);a=d("WAWebFrontendMsgGetters").getChat(a);a=d("WAWebElevatedPushNamesFlag").elevatedPushNamesM2Enabled(a);if(b.isLid()&&c.phoneNumber){b=d("WAWebContactCollection").ContactCollection.get(c.phoneNumber);var e=d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(b)&&a,f=b!=null?d("WAWebContactGetters").getNotifyName(b):null;b=(b=b==null?void 0:b.name)!=null?b:e&&f!=null?d("WAWebChatContactUtils").getFormattedNotifyName(f).toString():d("WAWebWidFormat").widToFormattedUser(c.phoneNumber)}else{e=d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(c)&&a;b=(f=c.name)!=null?f:e&&d("WAWebContactGetters").getNotifyName(c)!=null?d("WAWebChatContactUtils").getFormattedNotifyName(d("WAWebContactGetters").getNotifyName(c)).toString():d("WAWebWidFormat").widToFormattedUser(c.id)}return b}function e(a,b){var c,e;d("WAWebMsgGetters").getIsGroupMsg(a)&&(e=j(a,b));b=(b=d("WAWebEmoji").EmojiUtil.normalizeEmojiFromString(b.reactionText))!=null?b:d("WAWebEmoji").OPEN_BOX_CHAR;b=h._(/*BTDS*/"Reacted {emoji} to",[h._param("emoji",b)]);a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&!a.shouldShowNotificationPreview()?c=h._(/*BTDS*/"a message"):(c=d("WAWebGetNotificationStrings").getNotificationMessageBody(a),c=h._(/*BTDS*/"\"{originalMessageBody}\"",[h._param("originalMessageBody",c)]));return{body:c.toString(),author:e,action:b.toString()}}function f(a,b){return{body:h._(/*BTDS*/"Liked your status").toString(),author:j(a,b)}}function k(a){if(!d("WAWebSettingsGetters").getShowArchiveV2(c("WAWebSettingsModel")))return!1;return!a.archive?!1:!0}g.getReactionSenderJid=i;g.nonHydratedShouldMuteReactionNotification=a;g.shouldSquelchReactionMessage=b;g.getNotificationPartsForChatReaction=e;g.getNotificationPartsForStatusReaction=f;g.isArchivedChat=k}),226);
__d("WAWebReactionsCollection",["WALogger","WATypeUtils","WAWebAck","WAWebApiContact","WAWebBaseCollection","WAWebEmoji","WAWebLidMigrationUtils","WAWebMsgCollection","WAWebMsgKey","WAWebMsgReactionsBridge","WAWebReactionsBEUtils","WAWebReactionsModels","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMsgCollection").MsgCollection.hydrateOrGetMessages([a]));a=a[0];return d("WAWebMsgReactionsBridge").sendQueryReactions(a)});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.findAddressingModeInsensitive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield this.find(a,b));if(e!=null)return e;e=d("WAWebLidMigrationUtils").getAlternateMsgKey(c("WAWebMsgKey").fromString(String(a)));if(e!=null)return this.find(e,b)});function e(b,c){return a.apply(this,arguments)}return e}();f.getAddressingModeInsensitive=function(a){var b;return(b=this.get(a))!=null?b:this._getByAltId(a)};f._getByAltId=function(b){b=b instanceof c("WAWebMsgKey")?b:c("WAWebMsgKey").from(String(b));b=d("WAWebLidMigrationUtils").getAlternateMsgKey(b);if(b!=null)return a.prototype.get.call(this,b)};f.addOrUpdateReaction=function(a){if(a.reactionText===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT)return this.removeReaction(a);var b=this.getAddressingModeInsensitive(a.parentMsgKey);if(b){var c=this.getAggregateEmojiAndSender(b,a.senderUserJid),e=c.reactionSenderModel;c=c.reactionAggregateWithSender;if(c&&e){if(e.id.toString()===a.msgKey&&e.ack!==a.ack){e.ack=a.ack;e.isSendFailure===!0&&a.ack!=null&&a.ack>=d("WAWebAck").ACK.SENT&&(e.isSendFailure=!1,e.trigger("change:isSendFailure"));e.trigger("change:ack");return}else if(a.timestamp>e.timestamp){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Removing previous reaction"])));d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid)&&(e.trigger("revoked"),c.set({hasReactionByMe:!1}));this._addNewReactionToAggregate(a,b);c.aggregateEmoji===d("WAWebEmoji").EmojiUtil.getEmojiAggregate(a.reactionText)?(c.senders.remove(e.id),b.reactions.trigger("change:senders")):this._removeAggregateEmojiAndSender(b,e,c);return}d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Did not update because timestamp was smaller than previous reaction"])));return}this._addNewReactionToAggregate(a,b)}else d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:addOrUpdateReaction Reactions model not found for this message id"])))};f.removeReaction=function(a){if(d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid))return this._removeSelfReaction(a);var b=this.get(a.parentMsgKey);if(b){a=this.getAggregateEmojiAndSender(b,a.senderUserJid);var c=a.reactionAggregateWithSender;a=a.reactionSenderModel;c&&a&&(this._removeAggregateEmojiAndSender(b,a,c),a.trigger("revoked"),d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:removeReaction"]))))}else d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:removeReaction no reactions model found"])))};f._addNewReactionToAggregate=function(a,b){var e=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(a.reactionText),f=b.reactions.get(e),g=c("WAWebMsgKey").fromString(a.msgKey);g=new(d("WAWebReactionsModels").ReactionsSenders)(babelHelpers["extends"]({},a,{id:g}));var h=d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid);f?(h&&(f.set({hasReactionByMe:!0}),b.set({reactionByMe:a})),f.senders.add(g),b.reactions.sort(),f.trigger("change:senders")):(h&&b.set({reactionByMe:a}),b.reactions.add({aggregateEmoji:e,hasReactionByMe:h,id:e,senders:[g]}))};f._removeAggregateEmojiAndSender=function(a,b,c){c.senders.remove(b.id),c.senders.length===0?a.reactions.remove(c.id):a.reactions.sort(),c.trigger("change:senders")};f.getAggregateEmojiAndSender=function(a,b){var c=null,e=null,f=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").createUserWidOrThrow(b));for(var g=0;g<a.reactions.length;g++){var h=a.reactions.at(g),i=h==null?void 0:h.senders.findFirst(function(a){return a.senderUserJid===b||f!=null&&a.senderUserJid===f.toString()});if(i){c=i;e=h;break}}return{reactionSenderModel:c,reactionAggregateWithSender:e}};f._removeSelfReaction=function(a){var b=this.get(a.parentMsgKey);b==null||b.set({reactionByMe:null});if(b){a=this.getAggregateEmojiAndSender(b,a.senderUserJid);var c=a.reactionAggregateWithSender;a=a.reactionSenderModel;c==null||c.set({hasReactionByMe:!1});c&&a&&(this._removeAggregateEmojiAndSender(b,a,c),a.trigger("revoked"))}};f.markReactionsAsRead=function(a){for(a of this._getSendersByMsgKeys(a))a.read=!0};f._getSendersByMsgKeys=function(a){if(a.length===0)return[];a=new Set(a);var b=[];for(var c of this.toArray())for(var e of c.reactions.toArray())for(var f of a){var g=e.senders.get(f);if(g!=null){b.push(g);a["delete"](f);if(a.size===0)return b}}d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:markReactionsAsRead Reaction sender model not found"])));return b};f.getSenderByMsgKey=function(a){for(var b of this.toArray())for(var c of b.reactions.toArray()){var d=c.senders.get(a);if(d!=null)return d}};f.getExistingSenderModelFromReactionDetails=function(a){var b=a.parentMsgKey,c=a.msgKey;a=a.reactionText;a=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(a);b=this.get(b);if(b){b=b.reactions.get(a);a=b==null?void 0:b.senders.get(c);return a}d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:getExistingSenderModelFromReactionDetails Reactions sender model not found for this message id"])));return};f.shouldUpdateAck=function(a,b){a=this.getExistingSenderModelFromReactionDetails(a);if(a){a=a.ack;return d("WATypeUtils").isNumber(b)&&(a===void 0||a==null||b>a||b===d("WAWebAck").ACK.FAILED)?!0:!1}d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["reactions_collection:shouldUpdateAck Reaction sender model not found"])));return!1};f.deleteReactionsByParentMessageKey=function(a){this.remove(a)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebReactionsModels").Reactions;e=new a();g.ReactionsCollection=e}),98);
__d("WAWebReactionsModels",["WAWebAck","WAWebAddOnModel","WAWebBaseModel","WAWebCollection","WAWebContactCollection","WAWebMsgCollection","WAWebMsgKey","WAWebReactionsCollection","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","lodash"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.msgKey=d("WAWebBaseModel").prop(),b.parentMsgKey=d("WAWebBaseModel").prop(),b.reactionText=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(),b.senderUserJid=d("WAWebBaseModel").prop(),b.read=d("WAWebBaseModel").prop(),b.orphan=d("WAWebBaseModel").prop(),b.isFailed=d("WAWebBaseModel").derived(function(){if(this.id.remote.isNewsletter())return!1;var a=d("WAWebUserPrefsMeUser").isSerializedWidMe(this.senderUserJid)&&this.ack!=null&&this.ack<d("WAWebAck").ACK.CLOCK;return a||Boolean(this.isSendFailure)},["ack","isSendFailure"]),b.senderObj=d("WAWebBaseModel").session(),b.parentMsg=d("WAWebBaseModel").derived(function(){return this.$ReactionsSendersSkeleton$p_1().assertGet(this.parentMsgKey)}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){a.prototype.initialize.call(this);if(c("WAWebWid").isNewsletter(this.senderUserJid))return;var b=d("WAWebContactCollection").ContactCollection.gadd(d("WAWebWidFactory").createUserWidOrThrow(this.senderUserJid));this.addChild("senderObj",b)};e.$ReactionsSendersSkeleton$p_1=function(){return d("WAWebMsgCollection").MsgCollection};e.isEqual=function(a){return this.id.equals(a.id)};return b}(d("WAWebAddOnModel").AddOnBaseModel);a.Proxy="reactionsSenders";a.idClass=c("WAWebMsgKey");e=(b=d("WAWebBaseModel")).defineModel(a);var h=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebCollection"));h.model=e;h.comparator=function(a,b){if(d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid))return-1;else if(d("WAWebUserPrefsMeUser").isSerializedWidMe(b.senderUserJid))return 1;return b.timestamp-a.timestamp};f=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.aggregateEmoji=d("WAWebBaseModel").prop(),b.hasReactionByMe=d("WAWebBaseModel").prop(),b.senders=d("WAWebBaseModel").collection(h),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(b.BaseModel);f.Proxy="aggReactions";a=b.defineModel(f);var i=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebCollection"));i.model=a;i.comparator=function(a,b){var c=b.senders.length-a.senders.length;if(a.hasReactionByMe)return-1;else if(b.hasReactionByMe)return 1;if(c===0){b=b.senders.at(0);a=a.senders.at(0);if(b&&a)return b.timestamp-a.timestamp}return c};f=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.reactionByMe=d("WAWebBaseModel").prop(),b.reactions=d("WAWebBaseModel").collection(i),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.unreadSenders=function(){return c("lodash").flatMap(this.reactions.toArray(),function(a){return a.senders.toArray()}).filter(function(a){return!a.read&&!d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid)})};e.getReactionSenderModel=function(a,b){a=this.reactions.get(a);a=a==null?void 0:a.senders.findFirst(function(a){return a.senderUserJid===b});return a};e.getCollection=function(){return d("WAWebReactionsCollection").ReactionsCollection};return b}(b.BaseModel);f.Proxy="reactions";f.idClass=c("WAWebMsgKey");b=b.defineModel(f);g.ReactionsSenders=e;g.ReactionsSendersCollection=h;g.AggReactions=a;g.AggReactionsCollection=i;g.Reactions=b}),98);
__d("WAWebRecentReactionModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.reactionText=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="recentReaction";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebRecentReactionsCollection",["Promise","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebDebounce","WAWebRecentReactionModel","WAWebUserPrefsKeys"],(function(a,b,c,d,e,f,g){var h,i=16,j=100;a=function(a){function d(){var d;d=a.call(this)||this;d.findImpl=function(a){return(h||(h=b("Promise"))).resolve({id:a})};d.listenTo(d,"add",c("WAWebDebounce")(function(){return d._sortTrim()},j));return d}babelHelpers.inheritsLoose(d,a);var e=d.prototype;e._sortTrim=function(){var a=this.length;if(!a)return;this.sort();a>i&&this.remove(this.slice(i))};return d}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebRecentReactionModel");a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.RECENT_REACTIONS_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3};a.comparator=function(a,b){return b.timestamp-a.timestamp};e=new a();g.RECENT_REACTIONS_LIMIT=i;g.LISTENER_DEBOUNCE_WAIT=j;g.RecentReactionsCollection=e}),98);
__d("WAWebApiStatus",["Promise","WAJids","WALogger","WATimeUtils","WAWebAck","WAWebDBMessageSerialization","WAWebDBMessageStoreUtils","WAWebDBMessageUtils","WAWebDbEncryptionKey","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebWidFactory","asyncToGeneratorRuntime","justknobx","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getAllStatuses: Lid migration stage: ",""])),d("WAWebLidStatusMigrationGating").getLidStatusMigrationStage());return d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey().then(function(){var a=[m(),n()];return(l||(l=b("Promise"))).all(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.flat(1);var b=[],e=[];a.forEach(function(a){!a.author?(d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Author is null for status message"]))),d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Author is null for status with message id: ",""])),a.id)):d("WATimeUtils").happenedWithin(d("WATimeUtils").castToUnixTime(a.t),d("WATimeUtils").DAY_SECONDS)&&a.type!==d("WAWebMsgType").MSG_TYPE.REVOKED?a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&e.push(d("WAWebDBMessageSerialization").messageFromDbRow(a)):b.push(a.id)});yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(b);a=e.map(function(a){return babelHelpers["extends"]({},a,{id:new(c("WAWebMsgKey"))({id:a.id.id,remote:a.id.remote,fromMe:a.id.fromMe,participant:a.id.participant==null?void 0:d("WAWebLidStatusMigrationUtils").matWidConvert(a.id.participant)}),from:d("WAWebLidStatusMigrationUtils").matWidConvert(a.from),author:a.author==null?void 0:d("WAWebLidStatusMigrationUtils").matWidConvert(a.author)})});a=c("lodash").groupBy(a,function(a){var b;return a.from.isStatus()&&a.author!=null?a.author.toString():(b=d("WAWebMsgGetters").getSender(a))!=null?b:a.from.toString()});var f=[];for(var g in a){var h=a[g],k=h.filter(function(a){return a.ack<d("WAWebAck").ACK.READ}).length,l=h[h.length-1].t;f.push({id:d("WAWebWidFactory").createWid(g),unreadCount:k,totalCount:h.length,t:l,_msgs:h})}return f});return function(b){return a.apply(this,arguments)}}())})}function m(){var a=d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID);return d("WAWebDBMessageStoreUtils").queryChatMessageHelper(d("WAWebDBMessageUtils").beginningOfChat(a),d("WAWebDBMessageUtils").endOfChat(a),{lowerInclusive:!1,upperInclusive:!1})}function n(){try{if(c("justknobx")._("550"))return d("WAWebDBMessageStoreUtils").queryGroupStatusMsgsHelper()}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["getAllGroupStatusesPromise: ",""])),a).sendLogs("query-group-status")}return(l||(l=b("Promise"))).resolve([])}g.getAllStatuses=a}),98);
__d("WAWebPostSendStatusFailure",["WAErrors","WALogger","WAWebBackendErrors","WAWebHandleMsgError","WAWebSendMsgResultAction","WAWebWamEnumMessageSendResultType"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError){var c;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-server-error");(c=b.sendReporter)==null||c.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}else if(a instanceof d("WAWebHandleMsgError").MessageValidationError){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-validation-error");(c=b.sendReporter)==null||c.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_INVALID_PROTOBUF,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}else if(a instanceof d("WAWebHandleMsgError").MessageSentAckError){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message, get error ack"]))).sendLogs("status-send-ack-error");(c=b.sendReporter)==null||c.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}else if(a instanceof d("WAErrors").BufferTooLargeError){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message, get error ack"]))).sendLogs("status-send-too-large-error");(c=b.sendReporter)==null||c.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_PAYLOAD_TOO_BIG,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message"]))).sendLogs("status-send-fail");(a=b.sendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}g.postStatusSendFailure=a}),98);
__d("WAWebSendMsgMetricReporter",["WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMsgType","WAWebWamMsgUtils"],(function(a,b,c,d,e,f,g){a=function(a){var b={createSendReporter:function(b){return new(d("WAWebMessageSendReporter").MessageSendReporter)(a,b)},sendReporter:null,sendPerfReporter:null};Object.defineProperty(b,"sendReporter",{get:function(){return a.wamMessageSendReporter},set:function(b){a.wamMessageSendReporter=b},enumerable:!0});Object.defineProperty(b,"sendPerfReporter",{get:function(){var b;return(b=a.wamMessageSendPerfReporter)!=null?b:null},set:function(b){a.wamMessageSendPerfReporter=b},enumerable:!0});return b};b=function(a){var b=new(d("WAWebMessageSendReporter").MessageSendReporter)(a),c=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:a.to,mediaType:d("WAWebWamMsgUtils").getWamMediaType(a),messageType:d("WAWebWamMsgUtils").getWamMessageType(a)});if(a.kind===d("WAWebMsgType").MsgKind.ProtocolAddonRevoke){var e;(e=c)==null||e.setIsRevokeMessage(!0)}e={createSendReporter:function(b){return new(d("WAWebMessageSendReporter").MessageSendReporter)(a,b)},sendReporter:null,sendPerfReporter:null};Object.defineProperty(e,"sendReporter",{get:function(){return b},set:function(a){b=a},enumerable:!0});Object.defineProperty(e,"sendPerfReporter",{get:function(){return c},set:function(a){c=a},enumerable:!0});return e};g.createMsgModelMetricReporter=a;g.createAddonMetricReporter=b}),98);
__d("WAWebSendStatusMsgAction",["invariant","WAJids","WALogger","WATimeUtils","WAWebAck","WAWebDBProcessMessage","WAWebEncryptAndSendStatusMsg","WAWebLidStatusMigrationUtils","WAWebMessageSendPerfReporter","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebOutgoingMessage","WAWebPostSendStatusFailure","WAWebSendMsgMetricReporter","WAWebSendMsgResultAction","WAWebSendMsgTypes","WAWebStatusCollection","WAWebStatusGatingUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumMessageSendResultType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s=4286237861;function a(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["sendStatusTextMsgAction: start to send text messege"])));a=(yield x(a));a!=null||h(0,73062);var c=new(d("WAWebMsgModel").Msg)(a);c.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:c.to,mediaType:c.getWamMediaType(),messageType:c.getWamMessageType()});var e=d("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(c);e.sendReporter=(b=e.sendReporter)!=null?b:e.createSendReporter();(b=e.sendPerfReporter)==null||b.startRenderedStage();yield d("WAWebStatusCollection").StatusCollection.addStatusMessages(c.author,[c]);d("WAWebStatusCollection").StatusCollection.handleUpdate(a,!1);(b=e.sendPerfReporter)==null||b.postRenderedStage();(b=e.sendPerfReporter)==null||b.startSavedStage();yield d("WAWebDBProcessMessage").storeMessages([a],c.to);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendStatusTextMsgAction: store text messege"])));(b=e.sendPerfReporter)==null||b.postSavedStage();return v(c,a,e)});return t.apply(this,arguments)}function e(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: start to send status messege"])));a=babelHelpers["extends"]({},a,{id:new(c("WAWebMsgKey"))({fromMe:a.id.fromMe,remote:a.id.remote,id:a.id.id,participant:a.id.participant?d("WAWebLidStatusMigrationUtils").matWidConvert(a.id.participant):void 0}),from:d("WAWebLidStatusMigrationUtils").matWidConvert(a.from),author:d("WAWebLidStatusMigrationUtils").matWidConvert(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()),cannotBeRanked:d("WAWebStatusGatingUtils").canCheckStatusRankingPosterGating()});var f=new(d("WAWebMsgModel").Msg)(a);f.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:f.to,mediaType:f.getWamMediaType(),messageType:f.getWamMessageType()});var g=d("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(f);g.sendReporter=(e=g.sendReporter)!=null?e:g.createSendReporter();(e=g.sendPerfReporter)==null||e.startRenderedStage();yield d("WAWebStatusCollection").StatusCollection.addStatusMessages(f.author,[f]);d("WAWebStatusCollection").StatusCollection.handleUpdate(a,!1);(e=g.sendPerfReporter)==null||e.postRenderedStage();(e=g.sendPerfReporter)==null||e.startSavedStage();yield d("WAWebDBProcessMessage").storeMessages([a],f.to);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: store media messege"])));(e=g.sendPerfReporter)==null||e.postSavedStage();(e=g.sendPerfReporter)==null||e.startReadyToSendStage();yield f.waitForPrep();try{yield b(f)}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[status] failed to send status message with ",""])),a).sendLogs("status-send-media-error");(e=g.sendReporter)==null||e.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UPLOAD,isTerminal:!0});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UPLOAD}}(b=g.sendPerfReporter)==null||b.postReadyToSendStage();d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["sendStatusMediaMsgAction: media prep done for status messege"]))).devConsole(a);return v(f,a,g)});return u.apply(this,arguments)}function v(a,b,c){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: send status messege ",""])),a.id).devConsole(b);b={type:d("WAWebSendMsgTypes").SendMessageRecordType.Message,data:a};var e=d("WAWebOutgoingMessage").createOutgoingMessageProtobuf(d("WAWebOutgoingMessage").OutgoingMessageOriginType.Status,b);d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: generate protobuf"]))).devConsole(e);try{yield d("WAWebEncryptAndSendStatusMsg").encryptAndSendStatusMsg(b,e,c);(b=c.sendReporter)==null||b.postSuccess();void a.updateAck(d("WAWebAck").ACK.SENT);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: done"])));return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK}}catch(b){void a.updateAck(d("WAWebAck").ACK.FAILED);d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["_sendStatusMessage: failed with ",""])),b);return d("WAWebPostSendStatusFailure").postStatusSendFailure(b,c)}});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(a.text||"").trim();if(b==="")return null;var e=d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID),f=d("WAWebLidStatusMigrationUtils").matWidConvert(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()),g=d("WAWebLidStatusMigrationUtils").matWidConvert(f);g=new(c("WAWebMsgKey"))({from:f,to:e,id:yield c("WAWebMsgKey").newId(),participant:g,selfDir:"out"});g={id:g,body:b,author:f,backgroundColor:(g=a.color)!=null?g:s,type:"chat",kind:d("WAWebMsgType").MsgKind.Chat,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:void 0,t:d("WATimeUtils").unixTime(),from:f,to:e,isNewMsg:!0,local:!0,ack:d("WAWebAck").ACK.CLOCK,font:(b=a.font)!=null?b:void 0,messageSecret:d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()?self.crypto.getRandomValues(new Uint8Array(32)):null,cannotBeRanked:d("WAWebStatusGatingUtils").canCheckStatusRankingPosterGating()};return g});return y.apply(this,arguments)}g.sendStatusTextMsgAction=a;g.sendStatusMediaMsgAction=e;g.createTextStatusMsgData=x}),98);
__d("WAWebStatusGetters",["WALogger","WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){var h;a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createStatusCache});b=a.field;c=a.computed;e=a.unsafeIdentityGetter;f=a.clearCacheFor;a=f;f=e;e=b("id");var i=b("t"),j=b("unreadCount");b=b("totalCount");var k=c(function(a){a=a[0];return a>0},[j]);c=c(function(a){var b=a[0];a=a[1];var c=a-b;if(Number.isFinite(c))return c;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Bad status read count, ",", ",""])),a,b);return 0},[j,b]);g.clearStatusGetterCacheFor=a;g.getStatusUnsafe=f;g.getId=e;g.getT=i;g.getUnreadCount=j;g.getTotalCount=b;g.getHasUnread=k;g.getReadCount=c}),98);
__d("WAWebWebcStatusSessionWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcStatusSession:[1880,{webcStatusMutedItemCount:[4,a.TYPES.INTEGER],webcStatusMutedRowCount:[7,a.TYPES.INTEGER],webcStatusRecentItemCount:[2,a.TYPES.INTEGER],webcStatusRecentRowCount:[5,a.TYPES.INTEGER],webcStatusSessionId:[1,a.TYPES.INTEGER],webcStatusViewedItemCount:[3,a.TYPES.INTEGER],webcStatusViewedRowCount:[6,a.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcStatusSession:[]});g.WebcStatusSessionWamEvent=b}),98);
__d("WAWebWebcStatusSyncWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcStatusSync:[1878,{webcStatusMutedItemCount:[4,a.TYPES.INTEGER],webcStatusMutedRowCount:[7,a.TYPES.INTEGER],webcStatusRecentItemCount:[2,a.TYPES.INTEGER],webcStatusRecentRowCount:[5,a.TYPES.INTEGER],webcStatusSyncT:[1,a.TYPES.TIMER],webcStatusViewedItemCount:[3,a.TYPES.INTEGER],webcStatusViewedRowCount:[6,a.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcStatusSync:[]});g.WebcStatusSyncWamEvent=b}),98);
__d("WAWebStatusCollection",["Promise","WAJids","WALogger","WATimeUtils","WAWebApiContact","WAWebBaseCollection","WAWebContactGetters","WAWebContactStatusBridge","WAWebGroupMetadataCollection","WAWebLidMigrationUtils","WAWebLidStatusMigrationUtils","WAWebMediaOpaqueData","WAWebMsgCollection","WAWebMsgGetters","WAWebStatusGetters","WAWebStatusModel","WAWebUserPrefsMeUser","WAWebWebcStatusSessionWamEvent","WAWebWebcStatusSyncWamEvent","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty","sumOfArray"],(function(a,b,c,d,e,f,g){var h,i,j,k=3600*24;a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.findImpl=function(a){return(j||(j=b("Promise"))).resolve({id:a})},c.findQueryImpl=function(){return d("WAWebContactStatusBridge").queryStatusAll()},babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.findQuery=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c,d){var e=this;c=(yield a.prototype.findQuery.call(this,c,d));d=c||[];yield (j||(j=b("Promise"))).all(d.map(function(a){if(!a)return;var c=0;a.msgs.forEach(function(b){c<a._msgs.length&&a._msgs[c].id.toString()===b.id.toString()?++c:b["delete"]()});return a._msgs.length>0?e.addStatusMessages(a.id,a._msgs):(j||(j=b("Promise"))).resolve()}));return d});function d(a,b){return c.apply(this,arguments)}return d}();f.sync=function(){var a=this,b=window.performance.now();return this.findQuery({},{set:this.hasSynced()})["finally"](function(){a.trigger("sync")}).then(function(c){var e=window.performance.now();e=Math.round(e-b);a.logMetrics({type:"sync",syncTime:e});a.forEach(function(a){a.msgs.length>a.totalCount&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Total count: ",", msgs length: ",""])),a.totalCount,a.msgs.length)});return c})};f.logMetrics=function(a){var b;a.type==="sync"?b=new(d("WAWebWebcStatusSyncWamEvent").WebcStatusSyncWamEvent)({webcStatusSyncT:a.syncTime}):b=new(d("WAWebWebcStatusSessionWamEvent").WebcStatusSessionWamEvent)({webcStatusSessionId:a.sessionId});a=this.filter(function(a){return!d("WAWebContactGetters").getIsMe(a.contact)});var e=a.filter(function(a){return!d("WAWebContactGetters").getCalculatedStatusMute(a.contact)}),f=e.filter(function(a){return d("WAWebStatusGetters").getHasUnread(a)}),g=e.filter(function(a){return!d("WAWebStatusGetters").getHasUnread(a)});a=a.filter(function(a){return d("WAWebContactGetters").getCalculatedStatusMute(a.contact)});var h=c("sumOfArray")(e.map(function(a){return a.unreadCount}));e=c("sumOfArray")(e.map(function(a){return d("WAWebStatusGetters").getReadCount(a)}));var i=c("sumOfArray")(a.map(function(a){return a.totalCount}));b.webcStatusRecentItemCount=h;b.webcStatusRecentRowCount=f.length;b.webcStatusViewedItemCount=e;b.webcStatusViewedRowCount=g.length;b.webcStatusMutedItemCount=i;b.webcStatusMutedRowCount=a.length;b.commit()};f.hasSynced=function(){return!0};f.getStatusModel=function(a,b){var c=this.get(a);if(c==null&&b){b=a!=null?d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a)):null;c=b!=null?this.get(b):null}return c};f.handleUpdate=function(a,b){var e;e=(e=d("WAWebMsgGetters").getSender(a))!=null?e:a.from;a.id.remote.isStatus()&&(e=a.id.fromMe?d("WAWebLidStatusMigrationUtils").matWidConvert(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()):a.author);if(this.hasSynced()){if(b)return!0;b=a.subtype==="sender_revoke";var f=e?this.getStatusModel(e,b):null;if(f){var g=f.totalCount===f.msgs.length;if(b){var h=a.protocolMessageKey,j=h!=null?d("WAWebLidMigrationUtils").getAlternateMsgKey(h):null,k=!1;h!=null&&(k=f.containsMessage(h)||f.containsMessage(j));if(k!==!0)return!0;k=h==null?void 0:h.toString();h=j==null?void 0:j.toString();j={totalCount:f.totalCount-1};f!=null&&f.isUnreadMessage(k)&&(h==null||f!=null&&f.isUnreadMessage(h))&&(j.unreadCount=f.unreadCount-1);f.set(j)}else{k={totalCount:f.totalCount+1,t:a.t};a.invis!==!0&&(k.unreadCount=f.unreadCount+1);f.set(k)}!g&&!c("isStringNullOrEmpty")(a.body)&&c("WAWebMediaOpaqueData").createFromBase64Jpeg(a.body).then(function(a){f.pic=a})["catch"](function(){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[StatusCollection] failed to create from base64 jpeg"]))).sendLogs("failed-to-create-from-base64-jpeg")});return g}if(b)return!0;if(e){h={id:e,t:a.t,unreadCount:a.invis===!0?0:1,totalCount:1};this.add(h)}return!0}return!1};f.addStatusMessages=function(a,c){return(j||(j=b("Promise"))).all([this.$StatusCollectionImpl$p_1(d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID),c.filter(function(a){return a.id.remote.isStatus()})),this.$StatusCollectionImpl$p_1(a,c.filter(function(a){return!a.id.remote.isStatus()&&d("WAWebMsgGetters").getIsStatus(a)}))]).then(function(a){var b=a[0];a=a[1];return b.concat(a)})};f.$StatusCollectionImpl$p_1=function(a,c){return c.length===0?(j||(j=b("Promise"))).resolve([]):d("WAWebMsgCollection").MsgCollection.processMultipleMessages(a,c,{add:"after",isHistory:!0},"addStatusMessages")};f.getUnexpired=function(a){var b=this.filter(function(a){var b;if(a.totalCount<=0)return!1;if(a.isExpired())return!1;if(d("WAWebContactGetters").getIsMe(a.contact))return!1;if(d("WAWebContactGetters").getIsMyContact(a.contact))return!0;if(d("WAWebContactGetters").getIsPSA(a.contact))return!1;return d("WAWebContactGetters").getIsGroup(a.contact)&&(c("WAWebGroupMetadataCollection")==null||(b=c("WAWebGroupMetadataCollection").get(a.contact.id))==null||(b=b.participants)==null?void 0:b.iAmMember())===!0?!0:!1});if(a){a=b.filter(function(a){return a.unreadCount>0});return a}a=b.filter(function(a){return a.unreadCount===0});return a};f.getMyStatus=function(){var a=this.filter(function(a){return d("WAWebContactGetters").getIsMe(a.contact)});if(a.length===0)return;else if(d("WATimeUtils").unixTime()-a[0].t>k)return;return a[0]};f.getPSAStatus=function(){var a=this.filter(function(a){return d("WAWebContactGetters").getIsPSA(a.contact)});if(a.length===0)return;return a[0]};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebStatusModel");a.comparator=function(a,b){return b.t-a.t};e=new a();g.StatusCollection=e}),98);
__d("WAWebFrontendStatusGetters",["WAWebGetters","WAWebGettersCaches","WAWebStatusGetters"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({root:d("WAWebStatusGetters").getStatusUnsafe,createCache:d("WAWebGettersCaches").createFrontendStatusCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;d=b("msgs");a=b("msgsChanged");e=b("contact");b=c(function(a){a[0];a=a[1];return a.last()},[a,d]);g.clearFrontendStatusGetterCacheFor=f;g.getContact=e;g.getLastStatus=b}),98);
__d("WAWebStatusPSAUtils",["WATimeUtils"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.length===0)return-1;var c=0,d=b[0].campaignId;for(var e=1;e<b.length;e++){var f=b[e],g=f.id;f=f.campaignId;d!==f?(d=f,c=0):c++;if(g.toString()===a.toString())return c}return-1}function b(a){var b=h(a),c=[];Object.keys(b).forEach(function(a){var d=b[a],e=d.numberOfStatus;d=d.numberOfReadStatus;e=e-d;c.push(a+":"+e)});return c.join(",")}function h(a){var b={};a.forEach(function(a){var c=a.t,d=a.campaignId,e=a.campaignDuration;a=a.statusPSAReadTimestamp;if(!d)return;b[d]||(b[d]={id:d,t:c,duration:e,firstReadTimestamp:null,numberOfStatus:0,numberOfReadStatus:0});c=b[d];c.numberOfStatus++;a!=null&&(c.numberOfReadStatus++,(c.firstReadTimestamp==null||a<c.firstReadTimestamp)&&(c.firstReadTimestamp=a))});return b}function i(a,b){var c=a.firstReadTimestamp;if(c!=null)return d("WATimeUtils").unixTime()-c>b;c=a.duration;return c!=null?d("WATimeUtils").unixTime()-a.t>c:!1}function c(a,b){var c=h(a);return Object.keys(c).every(function(a){return i(c[a],b)})}g.getPsaCampaignIndex=a;g.getPsaCampaignsString=b;g.getPSACampaigns=h;g.isCampaignExpired=i;g.isExpiredStatusPSA=c}),98);
__d("WAWebStatusModel",["Promise","WALogger","WATimeUtils","WAWebAck","WAWebAlarm","WAWebAppTracker","WAWebBaseModel","WAWebCollectionConstants","WAWebCommonMsgUtils","WAWebContactCollection","WAWebContactStatusBridge","WAWebFrontendMsgGetters","WAWebFrontendStatusGetters","WAWebMsgGetters","WAWebMsgModelUtils","WAWebNoop","WAWebNotificationBackend","WAWebStatusCollection","WAWebStatusGatingUtils","WAWebStatusGetters","WAWebStatusPSAUtils","WAWebSuperChatMsgs","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=3600*24,r=1e3;a=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.unreadCount=d("WAWebBaseModel").prop(0),b.totalCount=d("WAWebBaseModel").prop(0),b.pic=d("WAWebBaseModel").prop(),b._msgs=d("WAWebBaseModel").prop(function(){return[]}),b.readKeys=d("WAWebBaseModel").session(function(){return{}}),b.contact=d("WAWebBaseModel").session(),b.expireTimer=d("WAWebBaseModel").session(),b.expireTs=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){var b=this;a.prototype.initialize.call(this);this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd(this.id));this.listenTo(this.msgs,"add bulk_add",function(){self.setTimeout(function(){b.setupStatusExpiration()})});this.listenTo(this,"change:msgsChanged",function(){var a=d("WAWebFrontendStatusGetters").getLastStatus(b);a&&(b.t=a.t)});this.listenTo(this.msgs,"remove",function(a){if(a.isGroupStatus!==!0)return;b.totalCount=Math.max(0,b.totalCount-1);a.ack&&a.ack<d("WAWebAck").ACK.READ&&(b.unreadCount=Math.max(0,b.unreadCount-1));b.totalCount===0&&b.onEmptyMRM()});this.listenTo(this.msgs,"add",function(a){d("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled()&&!d("WAWebMsgGetters").getIsSentByMe(a)&&Boolean(d("WAWebMsgGetters").getStatusMentioned(a))&&[d("WAWebCommonMsgUtils").EventType.DEFAULT,d("WAWebCommonMsgUtils").EventType.AMBIENT].includes(d("WAWebFrontendMsgGetters").getEventType(a))&&void d("WAWebNotificationBackend").showStatusNotification(a)})};f.isExpired=function(){return this.id.isPSA()?d("WAWebStatusPSAUtils").isExpiredStatusPSA(this.msgs.toArray(),q):d("WATimeUtils").unixTime()-this.t>q};f.setupStatusExpiration=function(){var a=this,b=this.msgs.at(0);if(!b)return;if(typeof this.expireTs==="number"&&this.expireTs<=b.t)return;var e=1;e=b.t+q+e;e<d("WATimeUtils").unixTime()?self.setTimeout(function(){a.expireMsg()}):(this.expireTimer=c("WAWebAlarm").setGlobalTimeout(this.expireMsg.bind(this),e*r,this.expireTimer),this.expireTs=b.t)};f._removeSingleMsg=function(a){var b=this.msgs;this.unreadCount>this.totalCount-1&&this.unreadCount--;this.totalCount--;b.remove(a);a["delete"]()};f.expireMsg=function(){if(this.id.isPSA()){this.expirePSAMsg();return}d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.PurgeStatuses);var a=this.msgs;while(a.length>0){var b=a.at(0);if(!b)break;var e=b.t+q>d("WATimeUtils").unixTime();if(e)break;c("gkx")("26258")||(d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Expiring message with ID:"]))).devConsole(b.id,"msg timestamp:",b.t,"global unix time:",d("WATimeUtils").unixTime()),d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unread count:"]))).devConsole(this.unreadCount,"total count:",this.totalCount),d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["msgs.length:"]))).devConsole(a.length));this._removeSingleMsg(b)}d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.PurgeStatuses);this.expireTs=void 0;this.expireTimer=void 0;this.totalCount!==0&&this.setupStatusExpiration()};f.expirePSAMsg=function(){var a=this,b,e=d("WAWebStatusPSAUtils").getPSACampaigns(this.msgs.toArray());(b=d("WAWebAppTracker")).AppTracker.start(b.AppTrackerType.PurgeStatuses);this.msgs.forEach(function(b){var f=b.campaignId;if(f==null)return;f=d("WAWebStatusPSAUtils").isCampaignExpired(e[f],q);if(!f)return;c("gkx")("26258")||(d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Expiring campaignID:"]))).devConsole(b.campaignId,"campaignDuration:",b.campaignDuration,"- msg with ID:",b.id,"msg timestamp:",b.t,"global unix time:",d("WATimeUtils").unixTime()),d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unread count:"]))).devConsole(a.unreadCount,"total count:",a.totalCount),d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["msgs.length:"]))).devConsole(a.msgs.length));a._removeSingleMsg(b)});b.AppTracker.stop(b.AppTrackerType.PurgeStatuses);this.expireTs=void 0;this.expireTimer=void 0;this.totalCount!==0&&this.setupStatusExpiration()};f.isUnreadMessage=function(a){if(a==null)return!1;var b=d("WAWebMsgModelUtils").getReadMsgKeys(this.msgs.toArray());b=b.find(function(b){return b===a})==null;return b&&this.readKeys[a]!==!0};f.revokeMsgs=function(a){var b=this,c=new Set(a);a=this.msgs.filter(function(a){return c.has(a.id.toString())});a.forEach(function(a){return b._removeSingleMsg(a)});this.totalCount===0&&(this.expireTs=void 0,this.expireTimer=void 0)};f["delete"]=function(){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Status deleted with total count: ",""])),this.totalCount),a.prototype["delete"].call(this),this.expireTimer&&c("WAWebAlarm").clearTimeout(this.expireTimer),this.expireTs!=null&&(this.expireTs=void 0),this.getCollection().remove(this.id),d("WAWebStatusGetters").clearStatusGetterCacheFor(this),d("WAWebFrontendStatusGetters").clearFrontendStatusGetterCacheFor(this)};f.onEmptyMRM=function(){var a=this;d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Status onEmptyMRM with total count: ",", noEarlierMsgs: ",""])),this.totalCount,this.msgs.msgLoadState.noEarlierMsgs?"true":"false");if(this.msgs.msgLoadState.noEarlierMsgs&&this.totalCount===0){this["delete"]();return}this.totalCount>0&&this.loadMore()["catch"](c("WAWebNoop"))["finally"](function(){a.msgs.length||a["delete"]()})};f.loadMore=function(a){a===void 0&&d("WAWebCollectionConstants").PAGE_SIZE;if(this.msgs.msgLoadState.noEarlierMsgs)return(p||(p=b("Promise"))).resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;this.msgs.msgLoadState.noEarlierMsgs=!0;return(p||(p=b("Promise"))).resolve()};f.handleReadStatus=function(a){a=a.toString();this.readKeys[a]||(this.readKeys[a]=!0,this.unreadCount>0&&this.unreadCount--)};f.sendReadStatus=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("WAWebContactStatusBridge").sendReadStatus(a,b,c));b&&this.handleReadStatus(a.id)});function c(b,c,d){return a.apply(this,arguments)}return c}();f.getCollection=function(){return d("WAWebStatusCollection").StatusCollection};f.containsMessage=function(a){return a==null?!1:this.msgs.toArray().some(function(b){return b.id.toString()===a.toString()})};return e}(c("WAWebSuperChatMsgs"));a.Proxy="status";a.idClass=c("WAWebWid");e=d("WAWebBaseModel").defineModel(a);g["default"]=e}),98);
__d("WAWebStatusNotification",["fbt","WANullthrows","WAWebBaseNotification","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebMsgGetters","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebStatusCollection","WAWebStatusNotificationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var e;b=b.msg;e=a.call(this)||this;e.msg=b;e.status=d("WAWebStatusCollection").StatusCollection.getStatusModel(c("WANullthrows")(d("WAWebMsgGetters").getSender(e.msg),"[WAStatusNotification]: status poster cannot be null"),!1);return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(a){if(d("WAWebNotificationHelpers").appIsActive())return c("WAWebNotificationMuteReason").AppState;if((a=this.status)!=null&&a.contact&&d("WAWebContactGetters").getCalculatedStatusMute((a=this.status)==null?void 0:a.contact))return c("WAWebNotificationMuteReason").MutedStatus;return d("WAWebNotificationHelpers").isOfflineResumeInProgress()?c("WAWebNotificationMuteReason").OfflineResumeInProgress:null};f.shouldPlaySound=function(){return a.prototype.shouldPlaySound.call(this)};f.getBannerOptions=function(){var a=this,b=h._(/*BTDS*/"Mentioned you privately in a status").toString(),e=this.status?d("WAWebFrontendContactGetters").getFormattedName(this.status.contact):d("WAWebFrontendContactGetters").getFormattedName(c("WANullthrows")(d("WAWebContactCollection").ContactCollection.get(this.msg.author)));b=d("WAWebGetNotificationStrings").getNotificationBody({body:b,msgDir:d("WAWebFrontendMsgGetters").getDir(this.msg)});var f=function(){d("WAWebStatusNotificationUtils").openStatusViewer(a.msg)};return{wid:this.msg.author,title:c("WANullthrows")(e),body:b,onClick:f}};f.buildKey=function(){return"status-msg:"+this.msg.id.toString()};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getNotificationIconByWid(c("WANullthrows")(d("WAWebMsgGetters").getSender(this.msg)),this.abortController.signal,d("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function e(){return a.apply(this,arguments)}return e}();return e}(d("WAWebBaseNotification").WABaseNotification);g.WAStatusNotification=a}),226);
__d("WAWebXViewerIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="x-viewer";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"currentColor",d:"M19.8,5.8l-1.6-1.6L12,10.4L5.8,4.2L4.2,5.8l6.2,6.2l-6.2,6.2l1.6,1.6l6.2-6.2l6.2,6.2l1.6-1.6L13.6,12 L19.8,5.8z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.XViewerIcon=a}),98);
__d("WAWebStatusLoadingQuoted.react",["WAWebBackIcon.react","WAWebLazyLoadLoading.react","WAWebModalManager","WAWebXViewerIcon.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.error,e=a.text;a=a.retry;var f=function(){return d("WAWebModalManager").ModalManager.closeMedia()};return i.jsxs("div",{className:"x10l6tqk x13vifvy x1o0tod x1bpt9pm xh8yej3 x5yr21d x1280gxy","data-animate-status-viewer":!0,children:[i.jsx("button",{className:"x10l6tqk xoyzfg9 x1i4sgur xhtitgo x17t9dm2",onClick:f,children:i.jsx(d("WAWebXViewerIcon.react").XViewerIcon,{})}),i.jsx("button",{className:"x10l6tqk xoyzfg9 x18hw5r0 xhtitgo x78zum5 x17t9dm2",onClick:f,children:i.jsx(d("WAWebBackIcon.react").BackIcon,{directional:!0})}),i.jsx(c("WAWebLazyLoadLoading.react"),{error:b,text:e,retry:a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebStatusQuotedFlowLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadable","WAWebStatusLoadingQuoted.react","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebLazyLoadedRetriable")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("WAWebStatusQuotedFlow.react").__setRef("WAWebStatusQuotedFlowLoadable").load());return a}),"StatusQuotedFlow");d=c("WAWebLoadable")({loader:a,loading:function(a){return i.jsx(c("WAWebStatusLoadingQuoted.react"),{error:Boolean(a.error)})}});g.requireBundle=a;g.StatusQuotedFlowLoadable=d}),98);
__d("WAWebStatusNotificationUtils",["fbt","WAWebModalManager","WAWebMsgGetters","WAWebStatusCollection","WAWebStatusQuotedFlowLoadable","WAWebToast.react","WAWebToastManager","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b=d("WAWebMsgGetters").getSender(a);if(b==null){d("WAWebToastManager").ToastManager.open(j.jsx(d("WAWebToast.react").Toast,{msg:h._(/*BTDS*/"Sender not found")}));return}void d("WAWebStatusCollection").StatusCollection.find(b).then(function(b){var c=function(){d("WAWebToastManager").ToastManager.open(j.jsx(d("WAWebToast.react").Toast,{msg:h._(/*BTDS*/"Status update not found")}))};d("WAWebModalManager").ModalManager.openMedia(j.jsx(d("WAWebStatusQuotedFlowLoadable").StatusQuotedFlowLoadable,{status:b,msgKey:a.id,onMsgNotFound:c,onClose:function(){return d("WAWebModalManager").ModalManager.closeMedia()}}),{transition:"quoted-status-modal"})})}g.openStatusViewer=a}),226);
__d("WAWebHistorySyncStickers",["WABase64","WALogger","WALongInt","WATimeUtils","WAWebHistorySyncNotificationUtils","WAWebMediaTypes","WAWebRecentStickerCollectionMd","WAWebUserPrefsAppStateSync","WAWebUserPrefsTypes"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function a(a,b){if(a.recentStickers==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: received empty recentStickers protobuf"])));return}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: processing recent stickers from history. total of "," stickers received."])),a.recentStickers.length);a=a.recentStickers.map(function(a){var b=a.fileSha256;if(b==null){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty filehash from initial sticker history"])));return null}var c=a.fileEncSha256,e=a.mediaKey;(c==null||e==null)&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty fileEncSha256 or mediaKey from initial sticker history"]))),d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: Got an empty fileEncSha256 or mediaKey from initial sticker history with filehash ",""])),d("WABase64").encodeB64(b)));return[{id:d("WABase64").encodeB64(b),directPath:a.directPath,filehash:d("WABase64").encodeB64(b),encFilehash:c!=null?d("WABase64").encodeB64(c):null,mediaKey:e!=null?d("WABase64").encodeB64(e):"",mediaKeyTimestamp:d("WATimeUtils").unixTime(),width:a.width,height:a.height,mimetype:a.mimetype,type:d("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0,weight:a.weight},(b=d("WALongInt").maybeNumberOrThrowIfTooLarge(a.lastStickerSentTs))!=null?b:0,null]}).filter(Boolean);d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: "," stickers need to be added after sticker construction."])),a.length);d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.replaceAndEnqueue(a,!0);d("WAWebUserPrefsAppStateSync").setNonCriticalDataSyncStatus((a={},a[d("WAWebUserPrefsTypes").NonCriticalDataSyncStatusType.RECENT_STICKER_INITIALIZED]=d("WAWebUserPrefsTypes").RecentStickerInitializedStatusType.SUCCESS,a));d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Recent Stickers completed, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(b))}g.processRecentStickers=a}),98);
__d("WAWebStickerUtils",["$InternalEnum","Promise","WACryptoSha256","WALogger","WAPromiseProps","WAWebABProps","WAWebFeatureDetectionDetectWebpSupport","WAWebInMemoryLottieStickerCache","WAWebMediaDataUtils","WAWebMediaMmsV4Download","WAWebStickerMetadataParsing","WAWebStickerMimeUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j="metadata",k="customProps",l=512,m=512,n=b("$InternalEnum").Mirrored(["WEBP","LOTTIE"]);function o(a){return d("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType===a?n.LOTTIE:n.WEBP}function p(a){if(a==null)return d("WAWebStickerMetadataParsing").DEFAULT_STICKER_METADATA;try{a=(a=(a=a[j])==null?void 0:a[k])!=null?a:{};return d("WAWebStickerMetadataParsing").toStickerMetadata(a)}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["extractMetaDataFromLottieSticker: Failed to parse metadata out of lottie sticker, returning default metadata."]))).devConsole(a);return d("WAWebStickerMetadataParsing").DEFAULT_STICKER_METADATA}}function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(o(a.type)===n.LOTTIE){c=c.filehash;if(c!=null){var e=d("WAWebInMemoryLottieStickerCache").InMemoryLottieStickerCache.get(c);e==null&&(e=(yield d("WAWebInMemoryLottieStickerCache").extractAndSetLottieJSONInMemoryCache(c,a)));c=p(e);return(i||(i=b("Promise"))).resolve(babelHelpers["extends"]({},c,{size:a.size,fullWidth:l,fullHeight:m}))}}return d("WAWebFeatureDetectionDetectWebpSupport").detectWebpSupport().then(function(c){return c?d("WAPromiseProps").promiseProps({widthHeight:d("WAWebMediaDataUtils").getImageWidthHeightNoOpaque(a),webpData:d("WAWebMediaDataUtils").parseWebpNoOpaque(a)}).then(function(b){return{fullWidth:b.widthHeight.width,fullHeight:b.widthHeight.height,animationDuration:b.webpData.animationDuration,firstFrameLength:b.webpData.firstFrameLength,singleLoopDuration:b.webpData.singleLoopDuration,emojis:b.webpData.emojis,isAnimated:b.webpData.animationDuration>0,size:a.size,isFirstParty:b.webpData.isFirstParty,isFromStickerMaker:b.webpData.isFromStickerMaker,stickerPackId:b.webpData.stickerPackId,stickerPackName:b.webpData.stickerPackName,stickerPackPublisher:b.webpData.stickerPackPublisher,isAvatar:b.webpData.isAvatar,isAiSticker:b.webpData.isAiSticker,stickerMakerSourceType:b.webpData.stickerMakerSourceType,accessibilityLabel:b.webpData.accessibilityLabel}}):d("WAWebMediaDataUtils").parseWebpNoOpaque(a).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b.animationDuration,e=b.firstFrameLength,f=b.singleLoopDuration,g=b.emojis,h=b.isFirstParty,i=b.isFromStickerMaker,j=b.stickerPackId,k=b.stickerPackName,l=b.stickerPackPublisher,m=b.isAvatar,n=b.isAiSticker,o=b.stickerMakerSourceType;b=b.accessibilityLabel;if(c>0)return{animationDuration:c,firstFrameLength:e,singleLoopDuration:f,emojis:g,isAnimated:!0,size:a.size,isFirstParty:h,isFromStickerMaker:i,stickerPackId:j,stickerPackName:k,stickerPackPublisher:l,isAvatar:m,isAiSticker:n,stickerMakerSourceType:o,accessibilityLabel:b};e=(yield d("WAWebMediaDataUtils").decodeWebpToRGBANoOpaque(a));return{animationDuration:c,rgbaBuffer:e.rgbaBuffer,rgbaWidth:e.width,rgbaHeight:e.height,emojis:g,isAnimated:!1,size:a.size,isFirstParty:h,isFromStickerMaker:i,stickerPackId:j,stickerPackName:k,stickerPackPublisher:l,isAvatar:m,isAiSticker:n,stickerMakerSourceType:o,accessibilityLabel:b}});return function(a){return c.apply(this,arguments)}}())})});return q.apply(this,arguments)}function r(a){return a.replaceAll(/\s+/g,"")}function e(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=new Blob([a],{type:d("WAWebStickerMimeUtils").WhatsAppLottieStickerMimeType});a=(yield d("WAWebMediaMmsV4Download").extractLottieJSON(a,b));if(a==null)throw c("err")("Failed to extract lottie json from zipped sticker");return t(a)});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=v(a,j);var b=new TextEncoder();b=b.encode(a).buffer;a=(yield d("WACryptoSha256").sha256Base64(b));return a});return u.apply(this,arguments)}function v(a,b){a=r(a);try{a=JSON.parse(a);delete a[b];return JSON.stringify(a)}catch(a){throw c("err")("removeKeyFromString: Failed to parse lottie json "+a)}}function f(){var a={},b=d("WAWebABProps").getABPropConfigValue("gimmick_phase_two_data_suffix");b=new URLSearchParams(b);b.forEach(function(b,c){a[c]=b});return a}g.METADATA_OBJECT=j;g.LOTTIE_STICKER_FULL_WIDTH=l;g.LOTTIE_STICKER_FULL_HEIGHT=m;g.StickerFileType=n;g.getStickerFileType=o;g.extractMetaDataFromLottieSticker=p;g.parseStickerMetadata=a;g.removeSpacesAndEmptyLines=r;g.getLottieStickerFilehashFromZippedStickerBuffer=e;g.calculateLottieStickerFilehash=t;g.removeKeyFromString=v;g.getStickerFetchParamsFromABConfig=f}),98);
__d("WAWebWamEnumQueryType",[],(function(a,b,c,d,e,f){a=Object.freeze({STICKER_STORE_DATA:0,PREVIEW_IMAGE_DOWNLOAD:1,STICKER_PACK_DATA:2,STICKER_SEARCH:3,DISCOVERY_PACK:4});f.QUERY_TYPE=a}),66);
__d("WAWebStickerCommonQueryToStaticServerWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumQueryType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({StickerCommonQueryToStaticServer:[2740,{httpResponseCode:[2,a.TYPES.INTEGER],params:[3,a.TYPES.STRING],queryLatencyMs:[4,a.TYPES.TIMER],queryType:[1,d("WAWebWamEnumQueryType").QUERY_TYPE]},[1,1,1],"regular"]},{StickerCommonQueryToStaticServer:[]});g.StickerCommonQueryToStaticServerWamEvent=b}),98);
__d("WAWebFetchFirstPartyStickerPacksAction",["WAWebL10N","WAWebL10NCountryCodes","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerUtils","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h="https://static.whatsapp.net/sticker";function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebStickerUtils").getStickerFetchParamsFromABConfig();e=babelHelpers["extends"]({},e,a);a=c("WAWebURLUtils").build(h,e);var f=new(d("WAWebStickerCommonQueryToStaticServerWamEvent").StickerCommonQueryToStaticServerWamEvent)();f.startQueryLatencyMs();b=(yield c("WAWebPonyfillsFetch")(a,{signal:b.signal}));f.markQueryLatencyMs();f.set({httpResponseCode:b.status,params:new(c("WAWebPonyfillsUrlSearchParams"))(e).toString(),queryType:d("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_PACK_DATA});f.commit();if(!b.ok)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(a,b.status.toString(),"Invalid response from WhatsApp stickers endpoint");e=(yield b.json());if(e==null||e.length===0)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(a,b.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(e));return e});return j.apply(this,arguments)}function k(a,b){a={id:a["sticker-pack-id"],name:a.name,publisher:a.publisher,description:a.description,fileSize:Number(a["file-size"]),imageDataHash:a["image-data-hash"],animated:a.animated===1,previewImageIds:a["preview-image-ids"],trayImageId:a["tray-image-id"],trayImagePreview:a["tray-image-preview"],index:b!=null?b:0};return a}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=c("WAWebL10N").getNormalizedLocale();b=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone((b=d("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:b.user)||"default";e={cat:"sticker_store_data",id:"all",lg:e,country:b};b=(yield i(e,{signal:a.signal}));return b.map(function(a,b){return k(a,b)})});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=c("WAWebL10N").getNormalizedLocale();b={cat:"sticker_pack_data",id:a.id,lg:b};b=(yield i(b,{signal:a.signal}));a=b[0];return k(a)});return m.apply(this,arguments)}g.fetchFirstPartyStickerPacks=a;g.fetchFirstPartyStickerPack=e}),98);
__d("WAWebFetchFirstPartyStickersAction",["WAWebL10N","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerUtils","WAWebURLUtils","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h="https://static.whatsapp.net/sticker";function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebStickerUtils").getStickerFetchParamsFromABConfig();e=babelHelpers["extends"]({},e,{cat:"sticker_pack_data",id:a,lg:c("WAWebL10N").getNormalizedLocale()});a=c("WAWebURLUtils").build(h,e);var f=new(d("WAWebStickerCommonQueryToStaticServerWamEvent").StickerCommonQueryToStaticServerWamEvent)();f.startQueryLatencyMs();b=(yield c("WAWebPonyfillsFetch")(a,{signal:b==null?void 0:b.signal}));f.markQueryLatencyMs();f.set({httpResponseCode:b.status,params:new(c("WAWebPonyfillsUrlSearchParams"))(e).toString(),queryType:d("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_PACK_DATA});f.commit();if(!b.ok)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(a,b.status.toString(),"Invalid response from WhatsApp stickers endpoint");e=(yield b.json());if(e==null||e.length===0)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(a,b.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(e));return e[0].stickers.map(function(a,b){return{mimetype:a.mimetype,width:a.width,height:a.height,index:b,filehash:a["file-hash"],directPath:a["direct-path"],mediaKey:a["media-key"],id:a["file-hash"],deprecatedMms3Url:a.url,encFilehash:a["enc-file-hash"],mediaKeyTimestamp:0}})});return i.apply(this,arguments)}g.fetchFirstPartyStickers=a}),98);
__d("WAWebLinkDevicePhoneNumberEntryInputFormatUtils",["WACcToIso","WAIsoToCc","WALogger","WAPhoneFindCC","WAPhoneUtils"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.countryCodeIso;a=a.phoneNumberWithoutCountryCode;if(b==null)return i(a);var e=c("WAIsoToCc")[b];e=d("WAPhoneUtils").compileCountryRegexes(String(e));if(e==null)return null;b=m(""+c("WAIsoToCc")[b]+a);var f=b.phoneNumberWithoutCountryCode;a=j(e);b=Math.max.apply(Math,a);if(f.length>b)return i(f);b=a.filter(function(a){return a>=f.length}).map(function(a){return k(f,a)});for(a of e.formats){e=a.testAndFormat(f);if(e!=null)return{formattedInputValue:e,placeholder:""};for(e of b){var g=a.testAndFormat(e);if(g!=null)return l({phoneNumberWithoutCountryCode:f,formattedPaddedNumber:g})}}return i(f)}function i(a){return{formattedInputValue:a,placeholder:""}}function j(a){a=a.lengths;return typeof a==="number"?[a]:a.sort(function(a,b){return a-b})}function k(a,b){return a+"_".repeat(b-a.length)}function l(a){var b=a.phoneNumberWithoutCountryCode;a=a.formattedPaddedNumber;if(b==="")return{formattedInputValue:"",placeholder:a};b=Array.from(a.matchAll(/\d/g));b=b.pop().index;b=b+1;return{formattedInputValue:a.substr(0,b),placeholder:a.substr(b)}}function b(a,b){a=d("WAPhoneUtils").compileCountryRegexes(String(a));return a==null?!1:a.formats.some(function(a){return a.testAndFormat(b)!=null})}function m(a){a=a.replaceAll(/[^\d]/g,"");var b=n(a),d=a;if(b!=null){var e=c("WAIsoToCc")[b];d=d.replace(new RegExp("^"+e),"")}return{countryCodeIso:b,phoneNumberWithoutCountryCode:d,fullRawPhoneNumber:a}}function n(a){a=d("WAPhoneFindCC").findCC(a);return c("WACcToIso")[parseInt(a,10)]}function e(a,b,c){a=n(a);a!==b&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[compareCountryCodeOutput] Country code mismatch in ",""])),c).sendLogs("country-code-mismatch",{sampling:.01})}function f(a,b,c){if(b==null){a=a?"+":"";return""+a+c}return"+"+b+" "+c}g.formatPhoneNumberInput=a;g.isPhoneNumberValid=b;g.cleanPhoneNumberInputValue=m;g.getCountryCodeIso=n;g.compareCountryCodeOutput=e;g.getFullFormattedInputValue=f}),98);
__d("WAWebMediaHostsUtil",["WAWebMediaHosts","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h="https://static.whatsapp.net";a=c("lodash").memoize(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebMediaHosts").mediaHosts.getHostsInfoByBucket({preferredBuckets:[1]}));a=a.selectedHost;return a!=null?"https://"+a.hostname:h}));g.getStaticMediaHostName=a}),98);
__d("WAWebSearchFirstPartyStickersAction",["WAWebCurrentUser","WAWebL10NCountryCodes","WAWebLinkDevicePhoneNumberEntryInputFormatUtils","WAWebMediaHostsUtil","WAWebMiscErrors","WAWebPonyfillsFetch","WAWebPonyfillsUrlSearchParams","WAWebStickerCommonQueryToStaticServerWamEvent","WAWebStickerModel","WAWebStickerUtils","WAWebURLUtils","WAWebUserPrefsMeUser","WAWebWamEnumQueryType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=250,i="https://static.whatsapp.net",j="/sticker",k="/wa/static/sticker";function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;e=(e=d("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:e.user;var f=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(e);d("WAWebCurrentUser").isEmployee()&&e!=null&&d("WAWebLinkDevicePhoneNumberEntryInputFormatUtils").compareCountryCodeOutput(e,f,"searchFirstPartyStickers");e=f||"default";f=0;var g=0;while(f<=h)f+=3+encodeURIComponent(a[g++]).length;f=a.slice(0,g-1).join(",");a={country:e};g=(yield d("WAWebMediaHostsUtil").getStaticMediaHostName());e=g===i?""+g+j:""+g+k;g=d("WAWebStickerUtils").getStickerFetchParamsFromABConfig();e=c("WAWebURLUtils").build(e,babelHelpers["extends"]({},g,{cat:"sticker_search",terms:f,_nc_cat:1},a));g=new(d("WAWebStickerCommonQueryToStaticServerWamEvent").StickerCommonQueryToStaticServerWamEvent)();g.startQueryLatencyMs();f=(yield c("WAWebPonyfillsFetch")(e,{signal:b==null?void 0:b.signal}));g.markQueryLatencyMs();g.set({httpResponseCode:f.status,params:new(c("WAWebPonyfillsUrlSearchParams"))(a).toString(),queryType:d("WAWebWamEnumQueryType").QUERY_TYPE.STICKER_SEARCH});g.commit();if(!f.ok)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(e,f.status.toString(),"Invalid response from WhatsApp stickers endpoint");b=(yield f.json());if(b==null)throw new(d("WAWebMiscErrors").InvalidServerResponseError)(e,f.status.toString(),"Invalid response from WhatsApp stickers endpoint: "+JSON.stringify(b));return b.map(function(a,b){return new(d("WAWebStickerModel").StickerModel)({mimetype:a.mimetype,width:a.width,height:a.height,filehash:a["file-hash"],directPath:a["direct-path"],mediaKey:a["media-key"],id:a["file-hash"],encFilehash:a["enc-file-hash"],mediaKeyTimestamp:0,index:b})})});return l.apply(this,arguments)}g.searchFirstPartyStickers=a}),98);
__d("WAWebFavoriteStickerModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.sticker=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(),b.stickerHashWithoutMeta=d("WAWebBaseModel").prop(),b.isFavorite=d("WAWebBaseModel").prop(),b.deviceId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="favoriteSticker";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebWebpCalculateWebpFilehashWithoutMetadata",["WACryptoSha256","WAWebWebp"],(function(a,b,c,d,e,f,g){function a(a){var b,c=new Uint8Array(a);b=(b=d("WAWebWebp").findWebpChunk(c,d("WAWebWebp").Chunk.EXIF))!=null?b:d("WAWebWebp").findWebpChunk(c,d("WAWebWebp").Chunk.XMP);if(b==null)return d("WACryptoSha256").sha256Base64(a);a=c.slice(0,b.position);c=a.byteLength-d("WAWebWebp").CHUNK_HEADER_SIZE;a.set(d("WAWebWebp").numberToLittleEndian(c),d("WAWebWebp").FOUR);return d("WACryptoSha256").sha256Base64(a)}g["default"]=a}),98);
__d("WAWebFavoriteStickerCollection",["Promise","WABaseGlobals","WAJids","WALogger","WAWebABProps","WAWebBaseCollection","WAWebFavoriteStickerModel","WAWebIdleTaskRunner","WAWebMediaAutoDownloadQueue","WAWebMediaStore","WAWebSchemaFavoriteStickers","WAWebStickerModel","WAWebStickerUtils","WAWebWebpCalculateWebpFilehashWithoutMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;function q(a,b){return a.timestamp<b.timestamp?1:-1}a=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b._comparator=function(a,b){return q(a,b)},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebFavoriteStickerModel");e=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b._comparator=function(a,b){return q(a,b)},b._emojiToCollection=new Map(),b._hasInitializedFromCache=!1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.add=function(b,c){b=a.prototype.add.call(this,b,c);c=d("WAWebABProps").getABPropConfigValue("web_autodownload_stickers");if(c)for(c of b){if(!c)break;this._enqueueStickerAutoDownload(c)}return b};f._enqueueStickerAutoDownload=function(a){void d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a.sticker,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)};f.remove=function(b,c){return a.prototype.remove.call(this,b,c)};f.reset=function(){a.prototype.reset.call(this)};f._addSaveTask=function(){var a=this;(!this._idleTaskId||!d("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this._idleTaskId))&&(this._idleTaskId=d("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){a._saveToDb()}))};f._saveToDb=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.toArray().map(function(a){var b=a.sticker.toDbData();return{id:a.id,timestamp:a.timestamp,sticker:{index:b.index,width:b.width,height:b.height,size:b.size,mimetype:b.mimetype,filehash:b.filehash,directPath:b.directPath,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp,encFilehash:b.encFilehash,deprecatedMms3Url:b.deprecatedMms3Url,type:"sticker"},stickerHashWithoutMeta:a.stickerHashWithoutMeta,isFavorite:a.isFavorite,deviceId:a.deviceId}});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to save stickers in DB with length: ",""])),a.length);try{var b=d("WAWebSchemaFavoriteStickers").getFavoriteStickersTable(),c=(yield b.count());d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: before save, stickers in DB with length: ",""])),c);yield b.clear();yield b.bulkCreateOrReplace(a);c=(yield b.count());d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: after save, stickers in DB with length: ",""])),c)}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["FavoriteStickerCollection attempt to save to database failed"]))).devConsole(a).sendLogs(a)}});function c(){return a.apply(this,arguments)}return c}();f._dbDataToModel=function(a){return new(c("WAWebFavoriteStickerModel"))({id:a.id,timestamp:a.timestamp,stickerHashWithoutMeta:a.stickerHashWithoutMeta,sticker:new(d("WAWebStickerModel").StickerModel)(a.sticker)})};f._getStickerHashWithoutMeta=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebMediaStore").LruMediaStore.get(a));if(e==null)return a;b=d("WAWebStickerUtils").getStickerFileType(b);return b===d("WAWebStickerUtils").StickerFileType.LOTTIE?d("WAWebStickerUtils").getLottieStickerFilehashFromZippedStickerBuffer(e,a):c("WAWebWebpCalculateWebpFilehashWithoutMetadata")(e)});function e(b,c){return a.apply(this,arguments)}return e}();f.addOrUpdateStickers=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=this;f===void 0&&(f=d("WAJids").interpretAsNumber(d("WAJids").extractDeviceId(d("WABaseGlobals").getMyDeviceJid())));var h=a.filter(function(a){return!g.get(a.id)});d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: length of stickers will be enqueued: ",""])),a.length);if(h.length===0)return;a=(yield (p||(p=b("Promise"))).all(h.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return new(c("WAWebFavoriteStickerModel"))({id:a.filehash,sticker:a,stickerHashWithoutMeta:yield g._getStickerHashWithoutMeta(a.filehash,a.mimetype),timestamp:e,isFavorite:!0,deviceId:f})});return function(b){return a.apply(this,arguments)}}())));this.addAndSort(a);this._hasInitializedFromCache&&(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to save collection to DB."]))),this._addSaveTask())});function e(b,c,d){return a.apply(this,arguments)}return e}();f.addAndSort=function(a){this.add(a),this.sort()};f.removeAndSave=function(a,b){b===void 0&&(b={});a=this.remove(a,b);a.length&&(d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: length of stickers will be removed: ",""])),a.length),this._addSaveTask());return a};f.initializeFromCache=function(a){var b=this;d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Favorite Stickers: need to initialize stickers from DB with length: ",""])),a.length);a=a.map(function(a){return b._dbDataToModel(a)});this.addAndSort(a);var c=this.toArray();if(c.length>0){var e=new Set(a.map(function(a){return a.id}));c.some(function(a){return!e.has(a.id)})&&this._addSaveTask()}this._hasInitializedFromCache=!0};f.updateFavoriteStickerWithNewSticker=function(a,b){a=this.get(a);if(a==null)return;a.sticker=new(d("WAWebStickerModel").StickerModel)(b.toDbData());this.set([a],{remove:!1,add:!1,silent:!0,sort:!1});this._addSaveTask()};f.getSuggestionsFromEmoji=function(a){return(a=this._emojiToCollection.get(a))==null?void 0:a.map(function(a){return a.sticker})};return e}(d("WAWebBaseCollection").BaseCollection);e.model=c("WAWebFavoriteStickerModel");f=new e();g.FavoriteStickerCollection=f}),98);
__d("WAWebRecentStickerCollection",["WALogger","WANullthrows","WAWebBaseCollection","WAWebConnModel","WAWebMobilePlatforms","WAWebStickerModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=32;a=function(a){function e(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b._comparator=function(a,c){return d("WAWebConnModel").Conn.platform===d("WAWebMobilePlatforms").PLATFORMS.ANDROID?b._getWeight(c)-b._getWeight(a):a.index>c.index?1:-1},b._syncStatus="NONE",b._weightMap=new Map(),b._sortTrimScale=function(){var a=b.length;if(!a)return;b.sort();if(a>i){for(var d=i;d<a;d++)b._weightMap["delete"](c("WANullthrows")(b.at(d)).id);b.remove(b.slice(i))}d=b.head();var e=b.last();if(d&&e&&b._getWeight(d)<10&&b._getWeight(e)>.01)return;b.forEach(function(c,d){b._weightMap.set(c.id,1+3*((a-d)/a))})},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f._getWeight=function(a){return c("WANullthrows")(this._weightMap.get(a.id))};f.enqueue=function(a){if(a.length===0)return;d("WAWebConnModel").Conn.platform===d("WAWebMobilePlatforms").PLATFORMS.ANDROID?this._enqueueAndroid(a):this._enqueueiOS(a)};f.addStickerWithMediaData=function(a){a=new(d("WAWebStickerModel").StickerModel)(a);a.id||(a.id=a.filehash);this.enqueue([a])};f._enqueueAndroid=function(a){var b=this;a.forEach(function(a){b.get(a.id)||(b._weightMap.set(a.id,0),b.add(a)),b.forEach(function(c){var d=b._getWeight(c);c.id===a.id?d+=1:d*=.9;b._weightMap.set(c.id,Math.round(1e3*d)/1e3)})});this._sortTrimScale()};f._enqueueiOS=function(a){var b=this;this.forEach(function(a,b){a.index=i+b});var c=new Set(a.map(function(a){return a.id}));a=a.reduce(function(a,b){if(c.has(b.id)){c["delete"](b.id);return[b].concat(a)}return a},[]).slice(0,i);a.forEach(function(a,c){var d=b.get(a.id);d?d.index=c:b.add({id:a.id,deprecatedMms3Url:a.deprecatedMms3Url,directPath:a.directPath,filehash:a.filehash,encFilehash:a.encFilehash,mediaKey:a.mediaKey,mediaKeyTimestamp:a.mediaKeyTimestamp,width:a.width,height:a.height,size:a.size,mimetype:a.mimetype,type:a.type,index:c})});this.sort();this.remove(this.slice(i))};f.sync=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield this._sync()});function c(){return a.apply(this,arguments)}return c}();f._sync=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this._syncStatus==="INPROGRESS")return;this._syncStatus="INPROGRESS";try{yield this.findQuery({},{set:!0}),this.sort(),this._syncStatus="SUCCESS"}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["collection:recent_sticker:_sync error "]))).devConsole(a),this._syncStatus="FAILURE"}});function c(){return a.apply(this,arguments)}return c}();f.isSynced=function(){return this._syncStatus==="SUCCESS"||this._syncStatus==="FAILURE"};f.reset=function(){this._syncStatus="NONE";this._weightMap.clear();return a.prototype.reset.call(this)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebStickerModel").StickerModel;e=new a();g.RecentStickerCollection=e}),98);
__d("WAWebRecentStickerModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.sticker=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(),b.msgId=d("WAWebBaseModel").prop(),b.weight=d("WAWebBaseModel").prop(),b.isNewSticker=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="recentSticker";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebRecentStickerCollectionMd",["WALogger","WATimeUtils","WAWebABProps","WAWebBaseCollection","WAWebIdleTaskRunner","WAWebMediaAutoDownloadQueue","WAWebMediaStorage","WAWebMsgCollection","WAWebRecentStickerModel","WAWebSchemaRecentStickers","WAWebStickerModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=32;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b._hasInitializedFromCache=!1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.remove=function(b,c){return a.prototype.remove.call(this,b,c)};f.add=function(b,c){b=a.prototype.add.call(this,b,c);c=d("WAWebABProps").getABPropConfigValue("web_autodownload_stickers");if(c)for(c of b){if(!c)break;this._enqueueStickerAutoDownload(c)}return b};f._enqueueStickerAutoDownload=function(a){void d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a.sticker,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)};f.reset=function(){a.prototype.reset.call(this)};f._comparator=function(a,b){return a.weight!==b.weight?a.weight<b.weight?1:-1:a.timestamp<b.timestamp?1:-1};f._dbDataToModel=function(a){var b;return new(c("WAWebRecentStickerModel"))({id:a.id,timestamp:a.timestamp,msgId:a.msgId,sticker:new(d("WAWebStickerModel").StickerModel)(a.sticker),weight:(b=a.weight)!=null?b:1,isNewSticker:a.isNewSticker})};f._addSaveTask=function(){var a=this;(!this._idleTaskId||!d("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this._idleTaskId))&&(this._idleTaskId=d("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){a._saveToDb()}))};f._saveToDb=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.toArray().map(function(a){var b=a.sticker.toDbData();return{id:a.id,timestamp:a.timestamp,msgId:a.msgId,weight:a.weight,sticker:{id:b.id,index:b.index,width:b.width,height:b.height,size:b.size,mimetype:b.mimetype,filehash:b.filehash,directPath:b.directPath,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp,encFilehash:b.encFilehash,deprecatedMms3Url:b.deprecatedMms3Url,isAvatar:b.isAvatar,type:"sticker"}}});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: need to save stickers in DB with length: ",""])),a.length);try{var b=d("WAWebSchemaRecentStickers").getRecentStickersTable(),c=(yield b.count());d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: before save, stickers in DB with length: ",""])),c);yield b.clear();yield b.bulkCreateOrReplace(a);c=(yield b.count());d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: after save, stickers in DB with length: ",""])),c)}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["RecentStickerCollection attempt to save to database failed"]))).sendLogs(a)}});function c(){return a.apply(this,arguments)}return c}();f.addStickerWithMediaData=function(a){var b=a.mediaKey,c=a.mediaData,e=a.encFilehash,f=a.id;a=a.stickerSentTs;this.addNewSticker(new(d("WAWebStickerModel").StickerModel)(babelHelpers["extends"]({},c,{mediaKey:b,encFilehash:e})),f.toString(),a)};f.addNewSticker=function(a,b,c){a.id||(a.id=a.filehash);var e=this.get(a.id)==null;this.addStickersAndPersistToDB([[a.toDbData(),c!=null?c:d("WATimeUtils").unixTimeMs(),b]],e)};f.addStickersAndPersistToDB=function(a,b){var c=this;b===void 0&&(b=!1);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: length of stickers will be enqueued: ",""])),a.length);if(a.length===0)return;var e=new Set(a.map(function(a){return a[0].id}));a=a.reduce(function(a,b){var c=b[0],d=b[1];b=b[2];if(e.has(c.id)){e["delete"](c.id);c=[[c,d,b]];return c.concat(a)}return a},[]);var f=[],g=[];a.forEach(function(a){var d=a[0],e=a[1];a=a[2];var h=c.get(d.id);if(h)h.timestamp<=e&&(h.timestamp=e),g.push(h);else{h=c._dbDataToModel({id:d.id,timestamp:e,sticker:{id:d.id,index:d.index,width:d.width,height:d.height,size:d.size,mimetype:d.mimetype,filehash:d.filehash,directPath:d.directPath,mediaKey:d.mediaKey,mediaKeyTimestamp:d.mediaKeyTimestamp,encFilehash:d.encFilehash,deprecatedMms3Url:d.deprecatedMms3Url,isAvatar:d.isAvatar,type:"sticker"},msgId:a,weight:d.weight!=null?Number(d.weight.toFixed(2)):1,isNewSticker:b});f.push(h);g.push(h)}});g.length>0&&(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: adjust weight and resort stickers."]))),this.adjustWeight(g),this.addAndSort(f),this._hasInitializedFromCache&&(d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: need to save collection to DB."]))),this._addSaveTask()))};f.replaceAndEnqueue=function(a,b){b===void 0&&(b=!1);if(this.length>0){var c=this.map(function(a){return a.id});this.remove(c)}if(a.length===0){this._addSaveTask();return}this.addStickersAndPersistToDB(a,b)};f.updateDirectPath=function(a,b){a=this.get(a);a!=null&&a.sticker?(a.sticker.directPath=b,this.set([a],{remove:!1,add:!1,silent:!0,sort:!1}),this._addSaveTask()):d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["updateDirectPaths called with a stickerId that doesn't match any in the collection"])))};f.updateStickerMediaData=function(a,b){a=this.get(a);if(b==null||a==null)return;b.directPath!=null&&(a.sticker.directPath=b.directPath);b.encFilehash!=null&&(a.sticker.encFilehash=b.encFilehash);b.mediaKey&&(a.sticker.mediaKey=b.mediaKey);b.mediaKeyTimestamp&&(a.sticker.mediaKeyTimestamp=b.mediaKeyTimestamp);this.set([a],{remove:!1,add:!1,silent:!0,sort:!1});this._addSaveTask()};f.updateRecentStickerWithNewSticker=function(a,b){a=this.get(a);if(a==null)return;a.sticker=new(d("WAWebStickerModel").StickerModel)(b.toDbData());this.set([a],{remove:!1,add:!1,silent:!0,sort:!1});this._addSaveTask()};f.associateStickerWithMsg=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;b=(yield d("WAWebMsgCollection").MsgCollection.getMessagesById([b]));b=b.messages;var e=((c=a.mediaObject)==null?void 0:c.associatedMsgs())||[];a.mediaObject&&(e.length===0||!b.some(function(a){return e.includes(a)}))&&d("WAWebMediaStorage").associateMediaWithMsg(a.mediaObject,b[b.length-1])});function c(b,c){return a.apply(this,arguments)}return c}();f.initializeFromCache=function(a){var b=this;this._hasInitializedFromCache=!0;a=a.map(function(a){a=b._dbDataToModel(a);a.msgId!=null&&b.associateStickerWithMsg(a.sticker,a.msgId);return a});var c=this.toArray();c.length>0&&a.forEach(function(a){return a.weight=Number((a.weight*Math.pow(.9,c.length)).toFixed(2))});this.addAndSort(a);if(c.length){var d=new Set(a.map(function(a){return a.id}));c.some(function(a){return!d.has(a)})&&this._addSaveTask()}};f.addAndSort=function(a){this.add(a),this.sort(),this.length>t&&this._hasInitializedFromCache&&(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: stickers length "," is over the limit."])),this.length),this.set(this.toArray().slice(0,t)))};f.removeAndSave=function(a,b){b===void 0&&(b={});a=this.remove(a,b);a.length&&this._addSaveTask();d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: stickers length "," after remove."])),this.length);return a};f.removeAllRecentAvatarStickers=function(){var a=this.filter(function(a){return a.sticker.isAvatar===!0});if(a.length===0){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: no avatar stickers found, skip removing."])));return[]}d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: removing all "," avatar stickers."])),a.length);return this.removeAndSave(a)};f.adjustWeight=function(a){var b=new Set(a.map(function(a){return a.id}));this.filter(function(a){return!b.has(a.id)}).forEach(function(a){return a.weight=Number((a.weight*.9).toFixed(2))});a.forEach(function(a){a.isNewSticker===!0?a.isNewSticker=void 0:a.weight=Number((a.weight+1).toFixed(2))})};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebRecentStickerModel");e=new a();g.RecentStickerCollectionMd=e}),98);
__d("WAWebStickerCollection",["WAWebBaseCollection","WAWebStickerModel","err"],(function(a,b,c,d,e,f,g){a={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"};b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var d=b.prototype;d.fetch=function(a){throw c("err")(this.constructor.name+".fetch is not implemented")};return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebStickerModel").StickerModel;e=new b();g.FETCH_STATE=a;g.StickerCollectionImpl=b;g.StickerCollection=e}),98);
__d("WAWebStickerDownloadCollection",["WALogger","WATimeUtils","WAWebIdleTaskRunner","WAWebSchemaStickerDownload","WAWebStickerPackCollectionMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;a=function(a){function c(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.addAndPersist=function(a){if(this.get(a.id)!=null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sticker Download: sticker pack already exists in collection"])));return}this.add(a);this.$StickerDownloadCollectionImpl$p_2()};e.removeAndPersist=function(a){a=this.remove(a);a.length&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Sticker Download: length of stickers will be removed: ",""])),a.length),this.$StickerDownloadCollectionImpl$p_2());return a};e.$StickerDownloadCollectionImpl$p_2=function(){var a=this;(!this.$StickerDownloadCollectionImpl$p_1||!d("WAWebIdleTaskRunner").IdleCallbackTasks.isInQueue(this.$StickerDownloadCollectionImpl$p_1))&&(this.$StickerDownloadCollectionImpl$p_1=d("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){a.$StickerDownloadCollectionImpl$p_3()}))};e.$StickerDownloadCollectionImpl$p_3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.toArray().map(function(a){return{id:a.id,timestamp:d("WATimeUtils").unixTime()}});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: need to save sticker downloads in DB with length: ",""])),a.length);try{var b=d("WAWebSchemaStickerDownload").getStickerDownloadTable(),c=(yield b.count());d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: before save, sticker downloads in DB with length: ",""])),c);yield b.clear();yield b.bulkCreateOrReplace(a);c=(yield b.count());d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Sticker Downloads: after save, sticker downloads in DB with length: ",""])),c)}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["StickerDownloadCollection attempt to save to database failed"]))).sendLogs(a)}});function c(){return a.apply(this,arguments)}return c}();return c}(d("WAWebStickerPackCollectionMd").StickerPackCollection);c=new a();g.StickerDownloadCollection=c}),98);
__d("WAWebStickerModel",["WALogger","WATimeUtils","WAWebABProps","WAWebBaseModel","WAWebMedia","WAWebMediaData","WAWebMediaTypes","once"],(function(a,b,c,d,e,f,g){var h;a=c("once")(function(){return new i({id:"placeholder",isPlaceholder:!0})});b=c("once")(function(){return new i({id:"createButton",isCreateButton:!0})});e=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.mediaData=d("WAWebBaseModel").session(),b.mediaObject=d("WAWebBaseModel").prop(),b.deprecatedMms3Url=d("WAWebBaseModel").prop(),b.directPath=d("WAWebBaseModel").prop(),b.filehash=d("WAWebBaseModel").prop(),b.height=d("WAWebBaseModel").prop(),b.index=d("WAWebBaseModel").prop(),b.mediaKey=d("WAWebBaseModel").prop(),b.mediaKeyTimestamp=d("WAWebBaseModel").prop(),b.mimetype=d("WAWebBaseModel").prop(),b.size=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(d("WAWebMediaTypes").OUTWARD_TYPES.STICKER),b.encFilehash=d("WAWebBaseModel").prop(),b.width=d("WAWebBaseModel").prop(),b.weight=d("WAWebBaseModel").prop(),b.stickerPackId=d("WAWebBaseModel").prop(),b.stickerPackName=d("WAWebBaseModel").prop(),b.stickerPackPublisher=d("WAWebBaseModel").prop(),b.isPlaceholder=d("WAWebBaseModel").prop(),b.isCreateButton=d("WAWebBaseModel").prop(),b.isAvatar=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){var b=this;a.prototype.initialize.call(this);var e=new(c("WAWebMediaData"))();this.addChild("mediaData",e);d("WAWebABProps").getABPropConfigValue("web_sticker_suggestions_enable")&&this.listenTo(e,"change:emojis",function(a){a.emojis!=null&&(a.emojis.length&&b.trigger("sticker_mediaData_emojis_updated"),b.stopListening(e,"change:emojis"))});!this.isPlaceholder&&!this.isCreateButton&&d("WAWebMedia").registerSticker(this)};e.downloadMedia=function(a){var b=this;return d("WAWebMedia").downloadStickerOrStickerPackIcon(this,"STICKER",a)["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id: ",", error: ",""])),b.id,String(a.stack||a)).tags("non-sad").sendLogs("sticker-panel:sticker download failed")})};e.toDbData=function(){return{id:this.id||this.filehash,index:this.index||0,width:this.width,height:this.height,size:this.size,mimetype:this.mimetype,filehash:this.filehash,directPath:this.directPath,mediaKey:this.mediaKey,mediaKeyTimestamp:this.mediaKeyTimestamp!=null?this.mediaKeyTimestamp:d("WATimeUtils").unixTime(),encFilehash:this.encFilehash,deprecatedMms3Url:this.deprecatedMms3Url,isAvatar:this.isAvatar,type:d("WAWebMediaTypes").OUTWARD_TYPES.STICKER,weight:this.weight}};e["delete"]=function(){a.prototype["delete"].call(this),d("WAWebMedia").deregisterSticker(this)};return b}(d("WAWebBaseModel").BaseModel);e.Proxy="sticker";e.getPlaceholder=a;e.getCreateButton=b;var i=d("WAWebBaseModel").defineModel(e);i.getPlaceholder=a;g.Sticker=e;g.StickerModel=i}),98);
__d("WAWebStickerPackCollectionMd",["$InternalEnum","WAAbortError","WALogger","WATimeUtils","WAWebBaseCollection","WAWebFetchFirstPartyStickerPacksAction","WAWebL10N","WAWebStickerConstants","WAWebStickerPackModelMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=b("$InternalEnum").Mirrored(["INITIAL","PENDING","SUCCESS","ERROR"]);a=function(a){function e(){var b;b=a.call(this)||this;b.fetchState=l.INITIAL;b.packFetchState=new Map();b.$StickerPackCollection$p_1=null;b.$StickerPackCollection$p_2=new Map();b.$StickerPackCollection$p_3=null;b.$StickerPackCollection$p_4=new Map();b.listenTo(c("WAWebL10N"),"locale_change",function(){return b.$StickerPackCollection$p_5()});return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.$StickerPackCollection$p_5=function(){this.$StickerPackCollection$p_6(),this.reset()};f.$StickerPackCollection$p_6=function(){var a;(a=this.$StickerPackCollection$p_3)==null||a.abort();this.$StickerPackCollection$p_3=null;this.$StickerPackCollection$p_4.forEach(function(a){return a.abort()});this.$StickerPackCollection$p_4.clear();this.$StickerPackCollection$p_7();this.$StickerPackCollection$p_8();this.$StickerPackCollection$p_1=null;this.$StickerPackCollection$p_2.clear()};f.$StickerPackCollection$p_9=function(a){if(a===this.fetchState)return;this.fetchState=a;this.trigger("change:fetchState",a)};f.$StickerPackCollection$p_7=function(){this.$StickerPackCollection$p_9(l.INITIAL)};f.$StickerPackCollection$p_10=function(a,b){if(b===this.packFetchState.get(a))return;this.packFetchState.set(a,b);this.trigger("change:packFetchState",a,b)};f.$StickerPackCollection$p_8=function(){this.packFetchState.clear(),this.trigger("change:packFetchState")};f.$StickerPackCollection$p_11=function(a,b,c){var d=this;this.$StickerPackCollection$p_12(a,b,function(b,e){var f=c[e-a];if(!b)f&&d.add(f);else if(!f){var g=b;while(g)d.remove(g),g=d.at(e)}else b.id===f.id&&(b.imageDataHash!==f.imageDataHash||b.index!==f.index)?(d.remove(b,{silent:!0}),d.add(f)):(d.remove(b),d.add(f))});this.$StickerPackCollection$p_8();this.$StickerPackCollection$p_2.clear()};f.$StickerPackCollection$p_12=function(a,b,c){for(a=a;a<b;a++){var d=this.at(a);c(d,a)}};f.fetch=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;if(this.fetchState===l.PENDING||this.fetchState===l.SUCCESS&&d("WATimeUtils").unixTime()-((a=this.$StickerPackCollection$p_1)!=null?a:0)<d("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT)return;this.$StickerPackCollection$p_9(l.PENDING);this.$StickerPackCollection$p_1=d("WATimeUtils").unixTime();this.$StickerPackCollection$p_3=new AbortController();try{a=(yield d("WAWebFetchFirstPartyStickerPacksAction").fetchFirstPartyStickerPacks({signal:this.$StickerPackCollection$p_3.signal}));var b=Math.max(this.length,a.length);this.$StickerPackCollection$p_11(0,b,a);this.$StickerPackCollection$p_9(l.SUCCESS)}catch(a){this.$StickerPackCollection$p_9(l.ERROR);if(a.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["First party sticker packs request cancelled"])));return}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["First party sticker packs request failed: error: ",""])),a).sendLogs("sticker-packs-fetch-request-failed")}});function c(){return a.apply(this,arguments)}return c}();f.fetchStickerPack=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(!a)return;if(this.get(a))return;var c=this.packFetchState.get(a);b=(b=this.$StickerPackCollection$p_2.get(a))!=null?b:0;if(c===l.PENDING||c===l.SUCCESS&&d("WATimeUtils").unixTime()-b<d("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT)return;this.$StickerPackCollection$p_10(a,l.PENDING);this.$StickerPackCollection$p_2.set(a,d("WATimeUtils").unixTime());c=new AbortController();this.$StickerPackCollection$p_4.set(a,c);try{b=(yield d("WAWebFetchFirstPartyStickerPacksAction").fetchFirstPartyStickerPack({id:a,signal:c.signal}));this.$StickerPackCollection$p_10(a,l.SUCCESS);this.add(b)}catch(b){this.$StickerPackCollection$p_10(a,l.ERROR);if(b.name===d("WAAbortError").ABORT_ERROR){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["First party sticker pack request cancelled"])));return}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["First party sticker pack request failed: error: ",""])),b).sendLogs("sticker-packs-fetch-request-failed")}});function c(b){return a.apply(this,arguments)}return c}();f["delete"]=function(){a.prototype["delete"].call(this),this.stopListening(),this.$StickerPackCollection$p_6()};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebStickerPackModelMd").StickerPackModel;a.comparator=function(a,b){if(a.index<b.index)return-1;return a.index>b.index?1:0};e=new a();g.FetchState=l;g.StickerPackCollection=a;g.StickerPackCollectionMd=e}),98);
__d("WAWebStickerPackModel",["Promise","WALogger","WAWebBaseModel","WAWebMedia","WAWebMediaData","WAWebMediaTypes","WAWebStickerPackStickerCollection","err"],(function(a,b,c,d,e,f,g){var h,i,j,k="placeholder:",l="image/png";a=function(a){var b=a.index;a=a.page;return new m({id:""+k+b,index:b,page:a})};e=function(a){function e(){var b;for(var f=arguments.length,g=new Array(f),h=0;h<f;h++)g[h]=arguments[h];return(b=a.call.apply(a,[this].concat(g))||this,b.id=d("WAWebBaseModel").prop(),b.index=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.page=d("WAWebBaseModel").prop(),b.url=d("WAWebBaseModel").prop(),b.mimetype=d("WAWebBaseModel").prop(l),b.mediaData=d("WAWebBaseModel").session(),b.mediaObject=d("WAWebBaseModel").prop(),b.directPath=d("WAWebBaseModel").prop(),b.filehash=d("WAWebBaseModel").prop(),b.mediaKey=d("WAWebBaseModel").prop(),b.mediaKeyTimestamp=d("WAWebBaseModel").prop(),b.size=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(d("WAWebMediaTypes").OUTWARD_TYPES.IMAGE),b.encFilehash=d("WAWebBaseModel").prop(),b.deprecatedMms3Url=d("WAWebBaseModel").derived(function(){return this.isFirstParty?"":this.url},["url","isFirstParty"]),b.stickers=d("WAWebBaseModel").derived(function(){this.$StickerPack$p_1=this.$StickerPack$p_1||new(c("WAWebStickerPackStickerCollection"))(this.id.split("#")[0],this.isFirstParty);return this.$StickerPack$p_1},["id"]),b.isPlaceholder=d("WAWebBaseModel").derived(function(){return e.isPlaceholderId(this.id)},["id"]),b.isFirstParty=d("WAWebBaseModel").derived(function(){return Boolean(this.url)&&!this.mediaKey},["url","mediaKey"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){a.prototype.initialize.call(this);!this.isPlaceholder&&!this.isFirstParty&&(this.addChild("mediaData",new(c("WAWebMediaData"))({renderableUrl:""})),d("WAWebMedia").registerStickerPackIcon(this));var b=c("err")("StickerPackModel is not initialized");d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["StickerPackModel ",""])),b).sendLogs("used-legacy-sticker-pack")};f.downloadMedia=function(){var a=this;return this.isPlaceholder||this.isFirstParty?(j||(j=b("Promise"))).resolve():d("WAWebMedia").downloadStickerOrStickerPackIcon(this,"STICKER_PACK")["catch"](function(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["id: ",", error: ",""])),a.id,String(b.stack||b)).sendLogs("sticker-panel:sticker-pack download failed")})};f["delete"]=function(){a.prototype["delete"].call(this),d("WAWebMedia").deregisterStickerPackIcon(this)};return e}(d("WAWebBaseModel").BaseModel);e.Proxy="stickerPack";e.createPlaceholder=a;e.isPlaceholderId=function(a){return new RegExp("^"+k).test(a)};var m=d("WAWebBaseModel").defineModel(e);m.createPlaceholder=a;m.isPlaceholderId=e.isPlaceholderId;g.PRE_PLACEHOLDER_ID=k;g.StickerPackModel=m}),98);
__d("WAWebStickerPackModelMd",["WAWebBaseModel","WAWebStickerPackStickerCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.index=d("WAWebBaseModel").prop(),b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.publisher=d("WAWebBaseModel").prop(),b.description=d("WAWebBaseModel").prop(),b.fileSize=d("WAWebBaseModel").prop(),b.imageDataHash=d("WAWebBaseModel").prop(),b.animated=d("WAWebBaseModel").prop(),b.previewImageIds=d("WAWebBaseModel").prop(),b.trayImageId=d("WAWebBaseModel").prop(),b.trayImagePreview=d("WAWebBaseModel").prop(),b.stickers=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){a.prototype.initialize.call(this);var b=!0;this.stickers=new(c("WAWebStickerPackStickerCollection"))(this.id,b)};e.toDBData=function(){return{id:this.id}};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="stickerPackMd";b=d("WAWebBaseModel").defineModel(a);g.StickerPack=a;g.StickerPackModel=b}),98);
__d("WAWebStickerPackStickerCollection",["Promise","WATimeUtils","WAWebFetchFirstPartyStickersAction","WAWebNoop","WAWebStickerCollection","WAWebStickerConstants","WAWebStickerPackModel"],(function(a,b,c,d,e,f,g){var h;a=function(a){function e(b,c){var d;d=a.call(this)||this;d.stickerPackId=b;d.isFirstParty=c;d._firstPartyFetchTimestamp=null;b=e._cache[d.stickerPackId];if(b)return b||babelHelpers.assertThisInitialized(d);var f,g=d;Object.defineProperty(d,"fetchState",{get:function(){return f},set:function(a){f!==a&&(f=a,g.trigger("change:fetchState",a))}});return d}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.fetch=function(a){var e,f=this;e=this.isFirstParty&&d("WATimeUtils").unixTime()-((e=this._firstPartyFetchTimestamp)!=null?e:0)>=d("WAWebStickerConstants").STICKER_PACK_FETCH_TIMEOUT;(a||e)&&this.fetchState!==d("WAWebStickerCollection").FETCH_STATE.PENDING&&delete this._fetchPromise;if(this._fetchPromise)return this._fetchPromise;this.fetchState=d("WAWebStickerCollection").FETCH_STATE.PENDING;if(d("WAWebStickerPackModel").StickerPackModel.isPlaceholderId(this.stickerPackId)){this._fetchPromise=new(h||(h=b("Promise")))(c("WAWebNoop"));return this._fetchPromise}if(this.isFirstParty)this._firstPartyFetchTimestamp=d("WATimeUtils").unixTime(),a=d("WAWebFetchFirstPartyStickersAction").fetchFirstPartyStickers(this.stickerPackId);else return(h||(h=b("Promise"))).resolve();this._fetchPromise=a.then(function(a){var b=Math.max(f.length||a.length);f._resetRange(0,b,a);f.fetchState=d("WAWebStickerCollection").FETCH_STATE.SUCCESS})["catch"](function(){f.fetchState=d("WAWebStickerCollection").FETCH_STATE.ERROR});return this._fetchPromise};f._resetRange=function(a,b,c){var d=this;this._forEachInRange(a,b,function(b,e){e=c[e-a];!b?e&&d.add(e):!e?d.remove(b):b.id===e.id?b.set(e):(d.remove(b),d.add(e))})};f._forEachInRange=function(a,b,c){for(a=a;a<b;a++){var d=this.at(a);c(d,a)}};return e}(d("WAWebStickerCollection").StickerCollectionImpl);a._cache={};a.comparator=function(a,b){if(a.index<b.index)return-1;return a.index>b.index?1:0};g["default"]=a}),98);
__d("WAWebStickerSearchCollection",["WALogger","WAWebBaseCollection","WAWebEmoji","WAWebEmojiKeywordToUnicode","WAWebSearchFirstPartyStickersAction","WAWebStickerModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j={HAPPY:["\ud83d\ude02","\ud83e\udd23","\ud83d\ude00","\ud83d\ude01","\ud83d\ude06","\ud83d\ude42","\ud83d\ude07","\u263a\ufe0f","\ud83d\ude04","\ud83d\ude03"],LOVE:["\ud83d\ude0d","\ud83d\ude18","\u2764\ufe0f","\ud83d\udc95","\ud83e\udd70","\ud83d\ude17","\ud83d\ude19","\ud83d\ude3b","\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc69","\ud83d\udc90","\ud83d\udc8c","\ud83d\udc9b","\ud83d\udc9a","\ud83d\udc99","\ud83d\udc9c","\ud83d\udc93","\ud83d\udc98","\ud83d\udc8f","\ud83d\udc91","\ud83c\udf39","\ud83e\udd1f","\ud83c\udfe9"],GREETINGS:["\ud83d\udc4b","\ud83d\ude02","\ud83e\udd23","\ud83d\ude4f","\u270b","\ud83e\uddd5","\ud83d\udeb6\u200d\u2640\ufe0f","\ud83d\udeb6","\ud83d\udc60","\ud83e\udd7e","\ud83d\ude48","\ud83e\udd9b","\ud83c\udf3a","\u26a1","\ud83c\udfaf","\ud83d\ude84","\ud83d\ude85","\ud83d\udc92","\ud83d\uded5","\ud83d\udee3\ufe0f","\ud83d\udd49\ufe0f","\ud83d\udd0a"],SAD:["\ud83d\ude2d","\ud83d\ude14","\ud83d\ude22","\ud83d\ude1e","\ud83d\ude1f","\ud83d\ude15","\ud83d\ude41","\u2639\ufe0f","\ud83d\ude16","\ud83d\ude2b","\ud83d\ude29","\ud83e\udd7a","\ud83d\ude25","\ud83d\ude13","\ud83d\ude2a","\ud83d\ude3f","\ud83d\udca7","\ud83d\udc94"],ANGRY:["\ud83d\ude20","\ud83d\ude21","\ud83d\ude24","\ud83d\udc7a","\ud83d\udca2","\ud83d\uddef\ufe0f","\ud83d\udc7f"],CELEBRATE:["\ud83e\udd73","\ud83e\udd42","\ud83c\udf88","\ud83c\udf8a","\ud83c\udf89"]};a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.$StickerSearchCollectionImpl$p_1=new Map(),b.$StickerSearchCollectionImpl$p_2=!1,b.$StickerSearchCollectionImpl$p_4=!0,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.isFetchingData=function(){return this.$StickerSearchCollectionImpl$p_4};e.hasFetchedData=function(){return this.$StickerSearchCollectionImpl$p_2};e.setStartFetching=function(){this.$StickerSearchCollectionImpl$p_4=!0,this.trigger("start_fetching")};e.setStopFetching=function(){this.$StickerSearchCollectionImpl$p_4=!1,this.trigger("stop_fetching")};e.search=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){this.$StickerSearchCollectionImpl$p_3!==b&&this.$StickerSearchCollectionImpl$p_2&&a.prototype["delete"].call(this);var c=b.trim().toUpperCase();if(this.$StickerSearchCollectionImpl$p_1.has(b)){var e=this.$StickerSearchCollectionImpl$p_1.get(b);if(e!=null){this.add(e);this.$StickerSearchCollectionImpl$p_3=b;return}d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["StickerMoodCollection cache was invalid, re-searching."])))}e=[];if(Object.prototype.hasOwnProperty.call(j,c))e.push.apply(e,j[c]);else{c=d("WAWebEmoji").EmojiUtil.containsOnlyEmoji(c)?d("WAWebEmoji").EmojiUtil.splitEmojis(c):d("WAWebEmojiKeywordToUnicode").emojiKeywordToUnicodeSearch(c);if(c==null||c.length===0){this.$StickerSearchCollectionImpl$p_3=b;this.setStopFetching();a.prototype["delete"].call(this);return}e.push.apply(e,c)}this.setStartFetching();c=[];try{c=(yield d("WAWebSearchFirstPartyStickersAction").searchFirstPartyStickers(e))}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Sticker search request failed: error: ",""])),a).sendLogs("sticker-search-request-failed");this.setStopFetching();return}this.$StickerSearchCollectionImpl$p_1.set(b,c);this.$StickerSearchCollectionImpl$p_2=!0;this.$StickerSearchCollectionImpl$p_3=b;this.add(c);this.setStopFetching()});function e(a){return c.apply(this,arguments)}return e}();e.searchMood=function(a){return this.search(a)};e["delete"]=function(){a.prototype["delete"].call(this),this.$StickerSearchCollectionImpl$p_1=new Map(),this.$StickerSearchCollectionImpl$p_2=!1,this.$StickerSearchCollectionImpl$p_4=!1};return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebStickerModel").StickerModel;c=new a();g.StickerSearchCollection=c}),98);
__d("WAWebTextStatusCollection",["fbt","WAWebBaseCollection","WAWebStatusContactAction","WAWebTextStatusModel","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g,h){b=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.findImpl=function(a){a=a instanceof c("WAWebWid")?d("WAWebWidFactory").asUserWidOrThrow(a):d("WAWebWidFactory").createUserWidOrThrow(a);return d("WAWebStatusContactAction").getStatus(a)},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);b.model=c("WAWebTextStatusModel");b.idClass=c("WAWebWid");b.staleCollection=!0;function a(){return h._(/*BTDS*/"Hey there! I am using WhatsApp.").toString()}e=new b();g.getDefaultTextStatus=a;g.TextStatusCollection=e}),226);
__d("WAWebTextStatusModel",["WAWebBaseModel","WAWebTextStatusCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.status=d("WAWebBaseModel").prop(),b.stale=d("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebTextStatusCollection").TextStatusCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="textStatus";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebUsernameKeyVerificationModalLoadable",["JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingModal.react","asyncToGeneratorRuntime","react","react-loadable"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebLazyLoadedRetriable")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("WAWebUsernameKeyVerificationModal.react").__setRef("WAWebUsernameKeyVerificationModalLoadable").load());return a}),"UsernameKeyVerificationModal");d=c("react-loadable")({loader:a,loading:function(a){return i.jsx(c("WAWebLoadingModal.react"),{error:Boolean(a.error)})}});g.UsernameKeyVerificationModalLoadable=d}),98);
__d("WAWebUsernameKeyVerificationFlow",["Promise","WAWebModalManager","WAWebUsernameKeyVerificationModalLoadable","WAWebUsernameUtils","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g){var h,i,j=i||c("react");function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.username,e=a.initWithError;a=d("WAWebUsernameUtils").getLIDByUsername(c);return a?a:new(h||(h=b("Promise")))(function(a){var b=j.jsx(d("WAWebUsernameKeyVerificationModalLoadable").UsernameKeyVerificationModalLoadable,{username:c,onKeyVerificationSuccess:function(b){return a(b)},onKeyVerificationCancel:function(){return a(null)},initWithError:e===!0});d("WAWebModalManager").ModalManager.open(b)})});return k.apply(this,arguments)}g.usernameKeyVerificationFlow=a}),98);
__d("WAWebUsernameUtils",["WAWebContactCollection","WAWebFrontendContactGetters","WAWebLidMigrationUtils","WAWebUsernameTypes"],(function(a,b,c,d,e,f,g){function a(){var a=new Uint8Array(4);self.crypto.getRandomValues(a);a=Array.from(a,function(a){return(a%10).toString()});a=a.join("");return d("WAWebUsernameTypes").asUsernameKey(a)}function b(a){var b=d("WAWebContactCollection").ContactCollection.findFirst(function(b){return b.username===a});if(!b||!b.id.isUser())return null;b=d("WAWebLidMigrationUtils").toUserLid(b.id);return b}function c(a){a=a?d("WAWebLidMigrationUtils").toUserLid(a):null;a=a?d("WAWebContactCollection").ContactCollection.get(a):null;return a?d("WAWebFrontendContactGetters").getIsUsernameContact(a):!1}function e(a){if(a==="exists"||a==="key-required")return!0;a;return!1}g.generateUsernameKeySuggestion=a;g.getLIDByUsername=b;g.getIsUsernameContactByLid=c;g.usernameInputIsValid=e}),98);
__d("WAWebVoipWaCallEnums",["$InternalEnum","WASyncAction.pb"],(function(a,b,c,d,e,f,g){f=(e=b("$InternalEnum"))({None:0,Calling:1,PreacceptReceived:2,ReceivedCall:3,AcceptSent:4,AcceptReceived:5,CallActive:6,CallActiveElseWhere:7,ReceivedCallWithoutOffer:8,Rejoining:9,Link:10,ConnectedLonely:11,PreCalling:12,CallStateEnding:13,CallBCallStarting:14});var h=e({Undefined:0,Connected:1,Missed:2,Declined:3,Canceled:4,Unavailable:5,AcceptedElsewhere:6,MissedNotificationsMuted:7});b=e({Invalid:0,Canceled:1,Missed:2,Unavailable:3,Rejected:4,Connected:5,AcceptedElsewhere:6,Failed:7,ConnectedLonely:8});function a(a){switch(a){case h.Connected:return d("WASyncAction.pb").CallLogRecord$CallResult.CONNECTED;case h.Missed:case h.MissedNotificationsMuted:return d("WASyncAction.pb").CallLogRecord$CallResult.MISSED;case h.Declined:return d("WASyncAction.pb").CallLogRecord$CallResult.REJECTED;case h.Canceled:return d("WASyncAction.pb").CallLogRecord$CallResult.CANCELLED;case h.AcceptedElsewhere:return d("WASyncAction.pb").CallLogRecord$CallResult.ACCEPTEDELSEWHERE;case h.Unavailable:return d("WASyncAction.pb").CallLogRecord$CallResult.UNAVAILABLE;case h.Undefined:return d("WASyncAction.pb").CallLogRecord$CallResult.INVALID}}var i=e({Invalid:0,Connected:1,Incoming:2,Receipt:3,Rejected:4,Terminated:5,TimedOut:6,CreatingCall:7,Invisible:8,Visible:9,CancelOffer:10,Invited:11}),j=e({Invalid:0,Connected:1,Invited:2});function c(a){switch(a){case i.Connected:return d("WASyncAction.pb").CallLogRecord$CallResult.CONNECTED;case i.Incoming:case i.Receipt:case i.Terminated:case i.TimedOut:case i.CancelOffer:return d("WASyncAction.pb").CallLogRecord$CallResult.MISSED;case i.Rejected:return d("WASyncAction.pb").CallLogRecord$CallResult.REJECTED;case i.Invited:case i.CreatingCall:case i.Invisible:case i.Visible:case i.Invalid:return d("WASyncAction.pb").CallLogRecord$CallResult.INVALID}}var k=e({None:0,CallOfferSent:1,CallOfferReceived:2,CallOfferAcked:3,CallOfferNacked:4,CallOfferReceiptReceived:5,CallAcceptFailed:6,CallAcceptSent:7,CallAcceptReceived:8,CallPreacceptReceived:9,CallTerminateReceived:10,CallRejectReceived:11,CallOfferResend:12,AudioStreamStarted:13,P2PNegotiationSuccess:14,RelayCreateSuccess:15,CallStateChanged:16,P2PNegotiationFailed:17,MediaStreamError:18,AudioInitError:19,NoSamplingRatesForAudioRecord:20,SendOfferFailed:21,HandleOfferFailed:22,SendAcceptFailed:23,HandlePreAcceptFailed:24,HandleAcceptFailed:25,WillCreateSoundPort:26,SoundPortCreateFailed:27,TransportCandSendFailed:28,P2PTransportCreateFailed:29,P2PTransportMediaCreateFailed:30,P2PTransportStartFailed:31,P2PTransportRestartSuccess:32,MissingRelayInfo:33,ErrorGatheringHostCandidates:34,MediaStreamStartError:35,RelayLatencySendFailed:36,RelayElectionSendFailed:37,CallEnding:38,CallCaptureBufferFilled:39,CallCaptureEnded:40,RxTimeout:41,TxTimeout:42,RxTrafficStarted:43,RxTrafficStopped:44,RTCPPacketReceived:45,RTCPByeReceived:46,RelayBindsFailed:47,SoundPortCreated:48,AudioDriverRestart:49,Echo:50,SelfVideoStateChanged:51,PeerVideoStateChanged:52,VideoPortCreated:53,VideoPortCreateFailed:54,VideoDecodeStarted:55,VideoRenderStarted:56,VideoCaptureStarted:57,VideoPreviewFailed:58,VideoPreviewReady:59,VideoPreviewShouldMinimize:60,VideoStreamCreateError:61,VideoRenderFormatChanged:62,VideoCodecMismatch:63,VideoDecodePaused:64,VideoDecodeResumed:65,VideoEncodeFatalError:66,VideoDecodeFatalError:67,BatteryLevelLow:68,PeerBatteryLevelLow:69,GroupInfoChanged:70,FieldstatsReady:71,CallWaitingStateChanged:72,MuteStateChanged:73,InterruptionStateChanged:74,RxTrafficStateForPeerChanged:75,HandleAcceptReceiptFailed:76,GroupParticipantLeft:77,AudioRouteChangeRequest:78,HandleAcceptAckFailed:79,CallMissed:80,WeakWiFiSwitchedToCellular:81,CallAutoConnect:82,RejectedDecryptionFailure:83,PeerDeviceOrientationChanged:84,HandleOfferAckFailed:85,PendingCallAutoRejected:86,FDLeakDetected:87,RestartCamera:88,AudioTestReplayFinished:89,SyncDevices:90,VideoCodecStateChanged:91,CallFatal:92,UpdateJoinableCallLog:93,LobbyNacked:94,PlayCallTone:95,SendJoinableClientPollCriticalEvent:96,SendLinkedGroupCallDowngradedCriticalEvent:97,UpdateVoipSettings:98,VoipErrDetectorEvent:99,SpeakerStatusChanged:100,LonelyStateTimeout:101,MutedByOthers:102,LinkCreateAcked:103,LinkCreateNacked:104,HeartbeatNacked:105,CallLinkStateChanged:106,LobbyTimeout:107,MuteRequestFailed:108,LinkQueryNacked:109,LinkJoinNacked:110,CallGridRankingChanged:111,GroupCallBufferHandleMessages:112,RemoveUserNacked:113,VideoRenderingStateChanged:114,UserRemoved:115,ScreenShare:116,NetHealthStatusChanged:117,ReminderSetAcked:118,HighDataUsageDetected:119,LidCallerDisplayInfo:120,EagerCallDismiss:121,OfferPeekTimeout:122,NetHealthStatusChangedV2:123,AutoVideoPauseStateChanged:124,BCallCreated:125,BCallCreateFailed:126,BCallAudienceUpdated:127,CallSummaryReceived:128,BCallJoinFailed:129,BCallEndFailed:130,BCallJoined:131,BCallLeaveFailed:132,ScreenContentType:133,BCallEnded:134,BCallStartNotify:135,LinkEditAcked:136,LinkEditNacked:137,Update1to1CallLog:138,CallLinkSelfStateChanged:139,DataChannelReady:140,AudioTxStarted:141,HandleGroupCallReminder:142,VoiceChatWaveReceived:143,DataChannelConnectionTimeout:144,ReactionStateChanged:145,VideoStateChanged:146,PeerVideoPermissionChanged:147,RaiseHandStateChanged:148,RelayListUpdate:156,Max:157}),l=e({Unknown:0,AudioCapture:1,AudioPlayback:2,VideoCapture:4,DesktopCapture:8}),m=e({Disabled:0,Enabled:1,Paused:2,UpgradeRequest:3,UpgradeAccept:4,UpgradeReject:5,Stopped:6,UpgradeRejectByTimeout:7,UpgradeCancel:8,UpgradeCancelByTimeout:9,UnknownPeer:10,UpgradeRequestV2:11,Error:20});e=e({Unknown:0,ParticipantAllocationFailure:1,SetupError:2,TxTimeout:3,RxTimeout:4,VideoStreamCreateError:5,VideoPortCreateFailed:6,NoSamplingRatesForAudioRecord:7,AudioInitError:8});g.CallState=f;g.CallResult=h;g.CallLogResult=b;g.getSyncCallResultFromCallResultNative=a;g.CallParticipantState=i;g.CallSummaryUserState=j;g.getSyncParticipantCallResultFromParticipantState=c;g.CallEvent=k;g.DeviceTypeEnum=l;g.VideoState=m;g.CallFatalReasonCode=e}),98);
__d("WAWebVoipActionWriteCallLogSync",["WALogger","WALongInt","WANullthrows","WAPromiseEach","WAResolvable","WATimeUtils","WAWebCallLogUtils","WAWebCmd","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsHistorySync","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebVoipActionWriteCallLogImpl","WAWebVoipWaCallEnums","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p=[],q=null;function r(){if(q!=null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: listener already registered"])));return q.promise}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: setting up listener"])));q=new(d("WAResolvable").Resolvable)();var a=q;d("WAWebCmd").Cmd.on("on_initial_chat_synced",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: listener called, "," pending call log records"])),p.length),yield d("WAPromiseEach").promiseEach(p,function(b,c){return t(b).then(function(){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generated call log message, after initial history sync complete, from history sync: ",""])),b.fromHistorySync),a.resolve(),p=[],q=null})})}));return a.promise}function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete())d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generating call log message, after initial history sync complete, from history sync: ",""])),a.fromHistorySync),yield t(a);else{d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["generateCallLogFromCallSyncRecord: generating call log message, before initial history sync complete, from history sync: ",""])),a.fromHistorySync);p.push(a);return r()}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.callLogRecord,e=a.fromHistorySync;e=e===void 0?!1:e;a=a.shouldHideInConversation;a=a===void 0?!1:a;var f={message:"generateCallLogFromCallSyncdRecord: failed to find chat target details for call log syncd record",log:"generate-call-log-message-syncd-failed"};e&&(f={message:"generateCallLogFromCallHistorySyncRecord: failed to find chat target details for call log history sync record",log:"generate-call-log-message-history-sync-failed"});var g=b.callCreatorJid,h=b.callResult,i=b.callId,j=b.groupJid,k=b.startTime,l=b.silenceReason,m=b.isVideo,p=b.isCallLink;p=p===void 0?!1:p;var q=b.callLinkToken,r;g=g!=null&&g!==""?d("WAWebWidFactory").createWid(g):d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();try{r=(yield d("WAWebCallLogUtils").getCallLogTargetDetails({callCreatorWid:g,callId:i,groupJid:c("isStringNullOrEmpty")(j)?null:d("WAWebWidFactory").createWid(j),participants:b.participants.map(function(a){return a.userJid!=null&&a.userJid!==""?d("WAWebWidFactory").createWid(a.userJid):null}).filter(Boolean)}))}catch(a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),f.message,a).devConsole(a);return}i=r;j=i.msgKeyId;var s=i.fromMe,t=i.callCreatorUserWid,u=i.chatId,v=i.participant;i=i.viewMode;try{j={id:new(c("WAWebMsgKey"))({remote:u,participant:v,fromMe:s,id:j}),type:d("WAWebMsgType").MSG_TYPE.CALL_LOG,kind:d("WAWebMsgType").MsgKind.CallLog,viewMode:a||e||p?d("WAWebViewMode.flow").ViewModeType.HISTORY_SYNCED_CALL_LOG:i,callOutcome:d("WAWebCallLogUtils").getCallOutcomeFromCallResultSyncProto(c("WANullthrows")(h,"generateCallLogFromCallSyncRecord: callResult is null from call log record sync")),callSilenceReason:l!=null?d("WAWebCallLogUtils").getCallSilenceReason(l):void 0,isVideoCall:m!=null?m:!1,callCreator:g,callDuration:b.duration==null?void 0:(v=d("WALongInt").maybeNumber(b.duration))!=null?v:void 0,callParticipants:b.participants.filter(function(a){return a.userJid!=null}).map(function(a){return{participant:d("WAWebWidFactory").createWid(c("WANullthrows")(a.userJid)),outcome:a.callResult!=null?d("WAWebCallLogUtils").getCallParticipantStateFromCallResultSyncProto(a.callResult):d("WAWebVoipWaCallEnums").CallParticipantState.Invalid}}),from:t,t:(s=d("WALongInt").maybeNumber(k))!=null?s:d("WATimeUtils").unixTime(),to:u,isCallLink:p!=null?p:!1,callLinkToken:q!=null?q:void 0};yield d("WAWebVoipActionWriteCallLogImpl").writeVoipCallLogMessageImpl(u,j,!1)}catch(a){e?f.message="generateCallLogFromCallHistorySyncRecord: failed to generate call log message from history sync":f.message="generateCallLogFromCallSyncRecord: failed to generate call log message from syncd",d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),f.message,a).tags("nexus-voip").devConsole(a).sendLogs(f.log)}});return u.apply(this,arguments)}g.generateCallLogFromCallSyncRecord=a}),98);
__d("WAWebVoipCallsTabPanelManager",["WAWebTypedEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebTypedEventEmitter"));b=new a();g["default"]=b}),98);
__d("WAWebVoipActionWriteCallLogImpl",["Promise","WAResolvable","WAWebChatGetExistingBridge","WAWebCmd","WAWebFindChatAction","WAWebGetMessageCache","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebMessageQueue","WAWebMsgCollection","WAWebSendMsgChatAction","WAWebUpdateMessageUIAction","WAWebVoipCallsTabPanelManager","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g,i=(yield d("WAWebChatGetExistingBridge").getExisting(a));i&&i.ephemeralDuration!=null?g=babelHelpers["extends"]({},e,{ephemeralDuration:i.ephemeralDuration}):g=e;var j=new(d("WAResolvable").Resolvable)();void d("WAWebMessageQueue").onMessageQueue({chatWid:a,isOffline:f,msgCategory:null,action:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=k(g).then(function(a){j.resolve(a)});return f?(h||(h=b("Promise"))).resolve():a});function c(){return a.apply(this,arguments)}return c}()});return j.promise;function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var g=null;if(f)d("WAWebCmd").Cmd.isMainStreamReadyMd&&void d("WAWebUpdateMessageUIAction").updateUI(a,e),yield d("WAWebGetMessageCache").getMessageCache().addMessages([{msg:e}],!1);else{var i=d("WAWebMsgCollection").MsgCollection.get(e.id);if(i)yield (h||(h=b("Promise"))).all([i.applyUpdate(e),yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:a,newMsg:e,handleSingleMsgOrigin:"voipNotification",messageOverwriteOption:d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.VOIP_CALL_LOG})]),g=i;else{i=(yield d("WAWebFindChatAction").findOrCreateLatestChat(a,"voipCallLog"));i=i.chat;var j=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:a,newMsg:e,handleSingleMsgOrigin:"voipNotification"});return b});return function(a){return c.apply(this,arguments)}}();g=(yield d("WAWebSendMsgChatAction").addMsgToChat(i,e,j))}}c("WAWebVoipCallsTabPanelManager").trigger("onWriteCallLogMessage");return g});return l.apply(this,arguments)}});return i.apply(this,arguments)}g.writeVoipCallLogMessageImpl=a}),98);
__d("WAWebPttAudioChannels",["WAWebEventEmitter"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.registerMedia=function(a){var b=this,c=null,d=function(){c=b.claim(a,function(){a.pause()})},e=function(){c==null||c()};a.addEventListener("play",d);a.addEventListener("pause",e);return function(){c==null||c(),a.removeEventListener("play",d),a.removeEventListener("pause",e)}};c.claim=function(a,b){var c=this,d=this.$AudioChannel$p_1;d!=null&&a!==d.key&&(d.pause(),this.trigger("paused_DEPRECATED_DO_NOT_USE",d.key));this.$AudioChannel$p_1={key:a,pause:b};return function(){var b;a===((b=c.$AudioChannel$p_1)==null?void 0:b.key)&&(c.$AudioChannel$p_1=null)}};return b}(c("WAWebEventEmitter"));b=new a();g.MainAudioChannel=b}),98);
__d("WAWebCallCollection",["WALogger","WAWebBaseCollection","WAWebCallModel","WAWebNoop","WAWebPttAudioChannels","lodash"],(function(a,b,c,d,e,f,g){var h;a=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.pendingOffers={},b.pendingVoipCapChecks={},b.isInConnectedCall=!1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.processIncomingCall=function(a,b,e){if(this.get(a)!=null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["voip:processIncomingCall: Attempting to add existing call with call ID"]))).devConsole(a);return this.get(a)}var f=e;e={id:a,isGroup:(e=f==null?void 0:f.isGroupCall)!=null?e:Boolean(f==null?void 0:f.groupWid),groupJid:f==null?void 0:f.groupWid};b!=null&&(e.peerJid=b);f&&(Object.keys(f).forEach(function(a){f[a]==null&&delete f[a]}),c("lodash").merge(e,f));this.add(e,{merge:!0});return this.get(a)};e.cleanupPendingOffer=function(a){delete this.pendingOffers[a]};e.setActiveCall=function(a){var b;this.activeCall=a;this.trigger("change:activeCall",a);(b=this.$CallCollectionImpl$p_1)==null||b.call(this);a!=null&&(this.$CallCollectionImpl$p_1=d("WAWebPttAudioChannels").MainAudioChannel.claim(this,c("WAWebNoop")))};e.setIsInConnectedCall=function(a){this.isInConnectedCall!==a&&(this.isInConnectedCall=a,this.trigger("change:isInConnectedCall",a))};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebCallModel");b=new a();e=b;g["default"]=e}),98);
__d("WAWebCallModel",["WALogger","WAWebBaseModel","WAWebCallCollection","WAWebCmd","WAWebConnModel","WAWebEnvironment","WAWebNoop","WAWebPttAudioChannels","WAWebVoipWaCallEnums"],(function(a,b,c,d,e,f,g){var h;a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.msg=d("WAWebBaseModel").prop(),b.peerJid=d("WAWebBaseModel").prop(),b.offerTime=d("WAWebBaseModel").prop(),b.isVideo=d("WAWebBaseModel").prop(!1),b.isGroup=d("WAWebBaseModel").prop(!1),b.groupJid=d("WAWebBaseModel").prop(),b.groupCallParticipants=d("WAWebBaseModel").prop(),b.outgoing=d("WAWebBaseModel").prop(!1),b.isSilenced=d("WAWebBaseModel").prop(!1),b.offerReceivedWhileOffline=d("WAWebBaseModel").prop(!1),b.isVoiceChat=d("WAWebBaseModel").prop(!1),b.silenceReason=d("WAWebBaseModel").prop(),b.selfVideoState=d("WAWebBaseModel").prop(),b.peerVideoState=d("WAWebBaseModel").prop(),b.peerVideoJid=d("WAWebBaseModel").prop(),b.selfMicMuted=d("WAWebBaseModel").prop(!1),b.peerMicMuted=d("WAWebBaseModel").prop(!1),b.$Call$p_1=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.getState=function(){return this.$Call$p_1};e.setState=function(a){this.$Call$p_1=a,this.trigger("change:state"),this.$Call$p_2()};e.shouldShowVideoUI=function(){if(this.selfVideoState==null&&this.peerVideoState==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["voip: shouldShowVideoUI: selfVideoState and peerVideoState are null"])));return this.isVideo}return this.shouldShowSelfPreview()||this.shouldShowPeerVideo()};e.shouldShowSelfPreview=function(){return this.isVideo?!0:this.selfVideoState===d("WAWebVoipWaCallEnums").VideoState.Enabled};e.shouldShowPeerVideo=function(){return this.peerVideoState===d("WAWebVoipWaCallEnums").VideoState.Enabled};e.$Call$p_2=function(){if(c("WAWebEnvironment").isWindows)return;var a=this.getState();if(!d("WAWebConnModel").Conn.tosShowCallNotification||!this.peerJid)return;if(!this.offerReceivedWhileOffline&&a===d("WAWebVoipWaCallEnums").CallState.ReceivedCall){d("WAWebCmd").Cmd.alertCall(this.peerJid,this.id,this.isVideo,this.isGroup,this.isSilenced);a=d("WAWebPttAudioChannels").MainAudioChannel.claim(this,c("WAWebNoop"));a()}else d("WAWebCmd").Cmd.cancelCall(this.peerJid)};e.getCollection=function(){return c("WAWebCallCollection")};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="call";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebVoipJsonParserNative",[],(function(a,b,c,d,e,f){"use strict";function a(a){try{return JSON.parse(a)}catch(a){return null}}f.parseJsonFromNativeBridge=a}),66);
__d("WAWebVoipJsonParserPayloads",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Call","JoinableCall"]);c=b("$InternalEnum")({Create:1,Update:2,Delete:3});f.FieldstatsPayloadType=a;f.UpdateJoinableCallLogType=c}),66);
__d("WAWebVoipJsonParsersWeb",["WACamelCase","WALogger","WATimeUtils","WAWebUserPrefsMeUser","WAWebVoipJsonParserNative","WAWebVoipJsonParserPayloads","WAWebWamCodegenUtils","WAWebWidFactory","err","isStringNullOrEmpty","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k={parseCallStateChangedData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call ending data");a=k.parseCallInfo(JSON.stringify(a.call_info));return{CallState:a.callState,call_info:a}},parseUpdateJoinableCallLogData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid update joinable call log data");var b=a.call_summary;return{CallId:a.call_id,ParticipantUserJids:a.participant_user_jids.map(function(a){return l(a)}),CallCreatorDeviceJid:m(a.call_creator_device_jid),Type:a.type,InitialPeerJid:m(a.initial_peer_jid),GroupJid:m(a.group_jid),IsCaller:a.is_caller,VideoEnabled:a.video_enabled,IsFromOffer:a.is_from_offer,CallLinkToken:a.link_token,ScheduledId:a.scheduled_id,IsLightweight:a.is_lightweight,NumParticipants:a.num_participants,CallParticipantInfos:a.participant_infos.map(function(a){return{jid:l(a.jid),result:a.state}}),CallSummary:b!=null?{CallCreatorJid:m(b.call_creator_jid),CallId:b.call_id,IsVideo:b.is_video_call,CallDuration:b.call_duration,UsersCount:b.users_count,Users:b.users.map(function(a){return{Jid:m(a.jid),PhoneJid:m(a.phone_jid),State:a.state}})}:null,Result:a.call_log_result,LinkCreatorJid:m(a.link_creator_jid)}},parseRejectedDecryptionFailureData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call ending data");return babelHelpers["extends"]({},a,{PeerDeviceJid:l(a.PeerDeviceJid)})},parseSyncDeviceData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid sync device data");return a.map(function(a){return{PHash:a.phash,UserRawJid:d("WAWebWidFactory").createWid(a.user_raw_jid)}})},parseCallEndingData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call ending data");return{peerJid:l(a.peer_jid),fromMe:a.from_me,groupJid:m(a.group_jid),callId:a.call_id,callLinkToken:a.call_link_token,isCallLink:a.is_call_link,scheduledId:a.scheduled_id,startTime:d("WATimeUtils").castToUnixTime(a.start_time),connectTime:a.connect_time!=null?Math.floor(a.connect_time/1e3):null,endTime:d("WATimeUtils").castToUnixTime(a.end_time),result:a.result,videoCall:a.video_call,participantEntries:a.participant_entries.map(function(a){return{jid:l(a.jid),result:a.result}}),callCreatorJid:m(a.call_creator_jid),initialPeerJid:m(a.initial_peer_jid)}},parseCallMissedData:function(a){var b,e;a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call missed data");b=(b=a.group_info)!=null&&b.participants?a.group_info.participants.map(function(a){return{jid:l(a.user_jid),result:a.state}}):(b=(b=a.call_participant_infos)==null?void 0:b.map(function(a){return{jid:l(a.jid),result:a.state}}))!=null?b:[];return{CallId:a.call_id,PeerUserJid:m(a.peer_user_jid),GroupJid:m(a.group_jid),IsVideoCall:a.is_video_call,GroupInfo:a.group_info?{Participants:(e=a.group_info.participants)==null?void 0:e.map(function(a){return{UserJid:l(a.user_jid),State:a.state}})}:null,CallParticipantInfos:b,TimeElapsedSinceCallOffer:d("WATimeUtils").castToUnixTime((e=a.time_elapsed_since_call_offer)!=null?e:0)}},parseUpdate1to1CallLogData:function(a){throw c("err")("Not implemented")},parseGroupInfoChangedData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid group info changed data");var b=null;a.participants!=null&&(b=a.participants.map(function(a){return{participant:l(a.jid),outcome:a.state}}));return{CallId:a.call_id,CallParticipants:b}},parseRelayListUpdateData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid relay list update data");return{event_type:a.event_type,num_relays:a.num_relays,relays:a.relays,relay_key:a.relay_key,relay_tokens:a.relay_tokens}},parseFieldstatsData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid field stats data");if(a.call_ended_stats!=null){var b=Object.fromEntries(Object.entries(a.call_ended_stats).map(function(a){var b=a[0];a=a[1];b=b==="abtest_bucket"?"callTestBucket":b==="peer_raw_jid"?null:c("WACamelCase")(b,{treatNumbersAsWordBoundaries:!1});if(b==null)return null;try{var e=d("WAWebWamCodegenUtils").metrics.getEvent("Call",b);return e.type==="boolean"?[b,!!a]:[b,a]}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["voip: fieldstats ready: metric undefined for ",""])),b).devConsole(a);return null}}).filter(Boolean));return{eventType:d("WAWebVoipJsonParserPayloads").FieldstatsPayloadType.Call,stats:b,uploadInRealtime:a.upload_in_realtime}}if(a.joinable_call_stats!=null){b=Object.fromEntries(Object.entries(a.joinable_call_stats).map(function(a){var b=a[0];a=a[1];b=c("WACamelCase")(b,{treatNumbersAsWordBoundaries:!1});try{var e=d("WAWebWamCodegenUtils").metrics.getEvent("JoinableCall",b);return e.type==="boolean"?[b,!!a]:[b,a]}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["voip: fieldstats ready: metric undefined for ",""])),b);return null}}).filter(Boolean));return{eventType:d("WAWebVoipJsonParserPayloads").FieldstatsPayloadType.JoinableCall,stats:b,uploadInRealtime:a.upload_in_realtime}}throw c("err")("Invalid field stats data: no stats object found")},parseVideoStateChangedData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid video state changed data");var b=a.is_self;if(b==null&&a.jid!=null){var e=m(a.jid);b=e?d("WAWebUserPrefsMeUser").isMeAccount(e):void 0}return{videoState:a.video_state,isSelf:b,userJid:a.jid?m(a.jid):null,callMediaStateChanged:a.call_media_state_changed}},parseCallRejectReceivedData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call reject received data");return{callId:a.call_id,peerUserJid:l(a.peer_user_jid),reason:a.reason}},parseCallFatalData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call fatal data");return{reasonCode:a.reason_code}},parseRelayBindsFailedData:function(a){a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid relay binds failed data");return{selfBadAsn:a.self_bad_asn}},parseCallInfo:function(a){var b;a=d("WAWebVoipJsonParserNative").parseJsonFromNativeBridge(a);if(a==null)throw c("err")("Invalid call info data");return{callState:a.call_state,callId:a.call_id,globalCallId:a.global_call_id,relayCallUuid:a.relay_call_uuid,selfParticipantUuid:a.self_participant_uuid,peerJid:m(a.peer_jid),initialPeerJid:m(a.initial_peer_jid),creatorJid:m(a.creator_jid),creatorDeviceJid:m(a.creator_device_jid),isCaller:a.is_caller,callDuration:a.call_duration,callActiveDuration:a.call_active_duration,audioDuration:a.audio_duration,videoDuration:a.video_duration,callEnding:a.call_ending,callEndedByMe:a.call_ended_by_me,callResult:a.call_result,callSetupErrorType:a.call_setup_error_type,bytesSent:a.bytes_sent,bytesReceived:a.bytes_received,videoEnabledAtCallStart:a.video_enabled_at_call_start,videoEnabled:a.video_enabled,videoCaptureStarted:a.video_capture_started,videoPreviewStarted:a.video_preview_started,avAutoAcceptEnabled:a.av_auto_accept_enabled,avDowngradeEnabled:a.av_downgrade_enabled,groupAvUpgradable:a.group_av_upgradable,selfCameraFrontFacing:a.self_camera_front_facing,aecMode:a.aec_mode,isGroupCall:a.is_group_call,isUpgradedGroupCallBeforeConnected:a.is_upgraded_group_call_before_connected,enableGroupCall:a.enable_group_call,isGroupCallCreatedOnServer:a.is_group_call_created_on_server,isJoinableGroupCall:a.is_joinable_group_call,initialGroupTransactionId:a.initial_group_transaction_id,connectedLimit:a.connected_limit,participantCount:a.participant_count,participants:a.participants.map(function(a){return{jid:l(a.jid),state:a.state,videoState:a.video_state,isMuted:a.is_muted}}),canInviteNewParticipant:a.can_invite_new_participant,canSwitchAudioVideo:a.can_switch_audio_video,rotateVideo:a.rotate_video,callWaitingInfo:{hasWaitingCall:a.call_waiting_info.has_waiting_call,waitingCallId:a.call_waiting_info.waiting_call_id,waitingPeerJid:m(a.call_waiting_info.waiting_peer_jid),waitingGroupJid:m(a.call_waiting_info.waiting_group_jid),waitingIsVideo:a.call_waiting_info.waiting_is_video},groupJid:m(a.group_jid),linkToken:(b=a.link_token)!=null?b:"",scheduledId:a.scheduled_id,isLightweight:a.is_lightweight,isPhashBased:a.is_phash_based,phash:a.phash,canRingAll:a.can_ring_all,offerEpochTimeMs:a.offer_epoch_time_ms,isBcall:a.is_bcall,isBcallBroadcaster:a.is_bcall_broadcaster,isBotCall:a.is_bot_call,vcExtendable:a.vc_extendable,isWaitingRoomEnabled:a.is_waiting_room_enabled,isWaitingRoomAdmin:a.is_waiting_room_admin,isInWaitingRoom:a.is_in_waiting_room}}};a=k;function l(a){return c("nullthrows")(m(a),"createVoipJid: received unexpected null")}function m(a){if(!a||c("isStringNullOrEmpty")(a.raw_jid))return null;try{return d("WAWebWidFactory").createWid(a.raw_jid)}catch(b){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["createVoipJid: failed to create wid from raw jid"]))).devConsole(b,a.raw_jid).sendLogs("create-voip-jid-failed");return null}}g["default"]=a}),98);
__d("useWAWebAsync",["react","useWAWebStableCallback"],(function(a,b,c,d,e,f,g){var h;b=h||d("react");var i=b.useEffect,j=b.useState,k={loading:!0,error:null,value:null};function a(a,b){var d=c("useWAWebStableCallback")(a);a=j(k);var e=a[0],f=a[1];i(function(){var a=new AbortController();f(k);d(a.signal).then(function(b){a.signal.aborted||f({loading:!1,error:null,value:b})})["catch"](function(a){f({loading:!1,error:a,value:null})});return function(){a.abort()}},[d].concat(b));return e}g["default"]=a}),98);
__d("useWAWebInterval",["react","useWAWebStableCallback"],(function(a,b,c,d,e,f,g){var h;b=h||d("react");var i=b.useCallback,j=b.useEffect,k=b.useRef;function a(a,b,d){b===void 0&&(b=0);d=d!=null?d:{};d=d.immediate;var e=d===void 0?!1:d,f=c("useWAWebStableCallback")(a),g=k(),h=i(function(){g.current&&self.clearInterval(g.current)},[]),l=i(function(){h(),g.current=self.setInterval(f,b)},[h,b,f]);j(function(){e&&l();return h},[e,l,h]);return[l,h]}g["default"]=a}),98);
__d("WAWebCallTimer.react",["WALogger","WAWebClock","WAWebVoipJsonParsersWeb","WAWebVoipStackInterface","WAWebVoipWaCallEnums","asyncToGeneratorRuntime","react","stylex","useWAWebAsync","useWAWebInterval"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||c("react"),m=(i||(i=d("react"))).useState,n={timerContainer:{minWidth:"x2c5eco",fontSize:"x1f6kntn",color:"x1pse0pq",fontWeight:"xo1l8bm",textAlign:"x2b8uid",paddingTop:"x16ovd2e",$$css:!0}};function a(a){var e=a.callState;a=a.xstyle;var f=c("useWAWebAsync")(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(e!==d("WAWebVoipWaCallEnums").CallState.CallActive)return null;try{var b=(yield d("WAWebVoipStackInterface").getVoipStackInterface());if(a.aborted)return null;if((b==null?void 0:b.type)==="web"){b=(yield b.getCallInfo());if(a.aborted)return null;if(b){a=c("WAWebVoipJsonParsersWeb").parseCallInfo(b);b=Math.floor(a.callActiveDuration/1e3);return Date.now()-b*1e3}}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WAWebCallTimer: Failed to get initial call duration, starting from 0"]))).devConsole(a);return Date.now()}return null});return function(b){return a.apply(this,arguments)}}(),[e]),g=m(function(){return Date.now()});g=g[0];var i=g;!f.loading&&!f.error&&f.value!=null&&(i=f.value);g=m(0);f=g[0];var k=g[1];c("useWAWebInterval")(function(){var a=Date.now();a=Math.floor((a-i)/1e3);k(a)},1e3,{immediate:e===d("WAWebVoipWaCallEnums").CallState.CallActive});return e!==d("WAWebVoipWaCallEnums").CallState.CallActive?null:l.jsx("div",babelHelpers["extends"]({},(j||(j=c("stylex"))).props(n.timerContainer,a),{role:"timer",children:d("WAWebClock").Clock.durationStr(f)}))}a.displayName=a.name+" [from "+f.id+"]";g.WAWebCallTimer=a}),98);
__d("WAWebCallLogUtils",["fbt","WALogger","WANullthrows","WATimeUtils","WAWebCallLogMsgData.flow","WAWebCallTimer.react","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebLid1X1MigrationGating","WAWebMsgGetters","WAWebMsgKey","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebVoipWaCallEnums","WAWebWidFactory","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react");function a(a,b){return a===d("WAWebVoipWaCallEnums").CallState.Calling?h._(/*BTDS*/"Calling..."):a===d("WAWebVoipWaCallEnums").CallState.PreacceptReceived?h._(/*BTDS*/"Ringing..."):a===d("WAWebVoipWaCallEnums").CallState.ReceivedCall||a===d("WAWebVoipWaCallEnums").CallState.ReceivedCallWithoutOffer?b!=null&&b.isVideoCall?h._(/*BTDS*/"Video call"):h._(/*BTDS*/"Voice call"):a===d("WAWebVoipWaCallEnums").CallState.AcceptSent||a===d("WAWebVoipWaCallEnums").CallState.AcceptReceived?h._(/*BTDS*/"Connecting..."):a===d("WAWebVoipWaCallEnums").CallState.CallActive?k.jsx(d("WAWebCallTimer.react").WAWebCallTimer,{callState:a}):a!=null?d("WAWebVoipWaCallEnums").CallState.getName(a):"unknown"}a.displayName=a.name+" [from "+f.id+"]";function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.callCreatorWid,e=a.callId,f=a.groupJid,g=a.peerWid;a=a.participants;a=a===void 0?[]:a;var h,j=d("WAWebViewMode.flow").ViewModeType.VISIBLE;b=(yield m({callDestinationWid:b}));var k=d("WAWebUserPrefsMeUser").isMeAccount(b);a=a.filter(function(a){return a!=null&&!d("WAWebUserPrefsMeUser").isMeAccount(a)});if(f!=null)f=f,h=b;else if(!k)f=b;else if(a.length===1){var l=a[0];f=(yield m({callDestinationWid:l}))}else g!=null?f=(yield m({callDestinationWid:g})):(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["voip: getCallLogTargetDetails: call log message will be added to self chat"]))),f=b,j=a.length>0?d("WAWebViewMode.flow").ViewModeType.CALL_LOG_AD_HOC_GROUP_CALL:d("WAWebViewMode.flow").ViewModeType.HIDDEN);return{msgKeyId:e!=null?e:yield c("WAWebMsgKey").newId(),fromMe:k,callCreatorUserWid:b,chatId:f,participant:h,viewMode:j}});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.callDestinationWid;a=a.groupJid;var c=d("WAWebWidFactory").asUserWidOrThrow(b),e=!c.isLid()&&d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();a=!a&&(c.isLid()||e);if(a){e=(yield d("WAWebFindChatAction").findOrCreateLatestChat(b,"voipCallLog"));a=e.chat;c=d("WAWebWidFactory").asUserWidOrThrow(a.id)}return c});return n.apply(this,arguments)}function o(a){switch(a){case 0:return d("WAWebCallLogMsgData.flow").CallOutcome.Completed;case 1:return d("WAWebCallLogMsgData.flow").CallOutcome.Rejected;case 2:return d("WAWebCallLogMsgData.flow").CallOutcome.Canceled;case 3:return d("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case 4:case 6:case 9:return d("WAWebCallLogMsgData.flow").CallOutcome.Missed;case 5:case 7:case 8:return d("WAWebCallLogMsgData.flow").CallOutcome.Failed;case 10:return d("WAWebCallLogMsgData.flow").CallOutcome.Ongoing;default:return d("WAWebCallLogMsgData.flow").CallOutcome.Unknown}}function p(a){switch(a){case 0:return d("WAWebVoipWaCallEnums").CallParticipantState.Connected;case 1:return d("WAWebVoipWaCallEnums").CallParticipantState.Rejected;case 2:return d("WAWebVoipWaCallEnums").CallParticipantState.Terminated;case 4:case 6:case 9:return d("WAWebVoipWaCallEnums").CallParticipantState.Terminated;case 10:return d("WAWebVoipWaCallEnums").CallParticipantState.Connected;case 3:case 5:case 7:case 8:return d("WAWebVoipWaCallEnums").CallParticipantState.Invalid;default:return d("WAWebVoipWaCallEnums").CallParticipantState.Invalid}}function q(a){switch(a){case d("WAWebVoipWaCallEnums").CallResult.Connected:return d("WAWebCallLogMsgData.flow").CallOutcome.Completed;case d("WAWebVoipWaCallEnums").CallResult.Missed:case d("WAWebVoipWaCallEnums").CallResult.MissedNotificationsMuted:return d("WAWebCallLogMsgData.flow").CallOutcome.Missed;case d("WAWebVoipWaCallEnums").CallResult.Declined:return d("WAWebCallLogMsgData.flow").CallOutcome.Rejected;case d("WAWebVoipWaCallEnums").CallResult.Canceled:return d("WAWebCallLogMsgData.flow").CallOutcome.Canceled;case d("WAWebVoipWaCallEnums").CallResult.AcceptedElsewhere:return d("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case d("WAWebVoipWaCallEnums").CallResult.Unavailable:case d("WAWebVoipWaCallEnums").CallResult.Undefined:return d("WAWebCallLogMsgData.flow").CallOutcome.Unknown}}function r(a){switch(a){case d("WAWebVoipWaCallEnums").CallState.None:return d("WAWebCallLogMsgData.flow").CallOutcome.Completed;case d("WAWebVoipWaCallEnums").CallState.CallActiveElseWhere:return d("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere;case d("WAWebVoipWaCallEnums").CallState.Calling:case d("WAWebVoipWaCallEnums").CallState.PreacceptReceived:case d("WAWebVoipWaCallEnums").CallState.ReceivedCall:case d("WAWebVoipWaCallEnums").CallState.AcceptSent:case d("WAWebVoipWaCallEnums").CallState.AcceptReceived:case d("WAWebVoipWaCallEnums").CallState.CallActive:case d("WAWebVoipWaCallEnums").CallState.ReceivedCallWithoutOffer:case d("WAWebVoipWaCallEnums").CallState.Rejoining:case d("WAWebVoipWaCallEnums").CallState.Link:case d("WAWebVoipWaCallEnums").CallState.ConnectedLonely:case d("WAWebVoipWaCallEnums").CallState.PreCalling:case d("WAWebVoipWaCallEnums").CallState.CallStateEnding:case d("WAWebVoipWaCallEnums").CallState.CallBCallStarting:return d("WAWebCallLogMsgData.flow").CallOutcome.Ongoing}}function s(a){switch(a){case 1:return"scheduled";case 2:return"privacy";case 3:return"lightweight";default:return void 0}}function t(a,b){return a!=null&&b!=null&&a.isSameAccountAndAddressingMode(b)}function u(a,b){return a.length!==b.length?!1:a.every(function(a){return b.some(function(b){return t(a,b)})})}function v(a,b){var c,e;c=(c=d("WAWebMsgGetters").getIsCallLink(a))!=null?c:!1;e=(e=d("WAWebMsgGetters").getIsCallLink(b))!=null?e:!1;if(c||e)return!1;c=d("WAWebMsgGetters").getSender(a);e=d("WAWebMsgGetters").getSender(b);if(!t(c,e))return!1;c=d("WAWebMsgGetters").getTo(a);e=d("WAWebMsgGetters").getTo(b);if(!t(c,e))return!1;c=d("WAWebMsgGetters").getIsVideoCall(a)===d("WAWebMsgGetters").getIsVideoCall(b)&&d("WAWebMsgGetters").getIsSentByMe(a)===d("WAWebMsgGetters").getIsSentByMe(b)&&d("WAWebMsgGetters").getIsGroupCall(a)===d("WAWebMsgGetters").getIsGroupCall(b);if(!c)return!1;e=d("WAWebMsgGetters").getIsMissedCall(a)===d("WAWebMsgGetters").getIsMissedCall(b);if(!e)return!1;c=(d("WAWebMsgGetters").getIsCallSilenced(a)&&!d("WAWebMsgGetters").getIsSentByMe(a))===(d("WAWebMsgGetters").getIsCallSilenced(b)&&!d("WAWebMsgGetters").getIsSentByMe(b));if(!c)return!1;if(!d("WATimeUtils").sameDay(d("WATimeUtils").castToUnixTime(d("WAWebMsgGetters").getT(a)),d("WATimeUtils").castToUnixTime(d("WAWebMsgGetters").getT(b))))return!1;c=(e=a.callParticipants)==null?void 0:e.map(function(a){return a.participant});e=(a=b.callParticipants)==null?void 0:a.map(function(a){return a.participant});b=c!=null&&e!=null&&u(c,e);return b}function w(a){if(a.length===0)return[];var b=[],e=c("WANullthrows")(d("WAWebFrontendMsgGetters").getAsCallLog(a[0]),"[mergeCallRecords] record is not a call log record"),f=[e.unsafe()];for(var g=1;g<a.length;g++){var h=c("WANullthrows")(d("WAWebFrontendMsgGetters").getAsCallLog(a[g]),"[mergeCallRecords] record is not a call log record");v(e,h)?f.push(h.unsafe()):(b.push({mergedMsgs:f}),e=h,f=[h.unsafe()])}b.push({mergedMsgs:f});return b}g.getCallStateText=a;g.getCallLogTargetDetails=e;g.get1x1CallLidOrPnDestination=m;g.getCallOutcomeFromCallResultSyncProto=o;g.getCallParticipantStateFromCallResultSyncProto=p;g.getCallOutcomeFromCallResultNative=q;g.getCallOutcomeFromCallState=r;g.getCallSilenceReason=s;g.shouldMergeCallLogRecords=v;g.mergeCallRecords=w}),226);
__d("WAWebWamEnumMultideviceActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({LOGIN:0,LOGOUT:1,CUSTOM_AGENT_NAME:2,MESSAGE_INFO:3,ACTIVE:4,DELETE:5});f.MULTIDEVICE_ACTION_TYPE=a}),66);
__d("WAWebMdExpansionAgentBrowserMdIdWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMultideviceActionType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdExpansionAgentBrowserMdId:[3390,{agentId:[1,a.TYPES.STRING],browserId:[2,a.TYPES.STRING],companionMdId:[5,a.TYPES.INTEGER],isCustomAgentName:[6,a.TYPES.BOOLEAN],isNewAgent:[9,a.TYPES.BOOLEAN],loginTimestamp:[3,a.TYPES.INTEGER],logoutTimestamp:[4,a.TYPES.INTEGER],mdLinkedCount:[8,a.TYPES.INTEGER],multideviceAction:[7,d("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE]},[1,1,1],"regular"]},{MdExpansionAgentBrowserMdId:[]});g.MdExpansionAgentBrowserMdIdWamEvent=b}),98);
__d("WAWebBizAgentAction",["WALogger","WATimeUtils","WAWebAgentCollection","WAWebAgentModelUtils","WAWebBizGatingUtils","WAWebCmd","WAWebMdExpansionAgentBrowserMdIdWamEvent","WAWebMiscBrowserUtils","WAWebMsgCollection","WAWebSchemaMessage","WAWebUnattributedMessageCollection","WAWebUserPrefsMeUser","WAWebWamEnumMultideviceActionType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){return a.author.user!==((a=d("WAWebUserPrefsMeUser").getMaybeMePnUser())==null?void 0:a.user)?!0:!1}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){if(i(b)||!d("WAWebAgentModelUtils").canUserSeeMessageAttribution())return;var e=b.author.getDeviceId();b=d("WAWebAgentCollection").AgentCollection.getByDeviceId(e);if(b==null){var f=c.map(function(a){return{id:a.id.toString(),deviceId:e}});d("WAWebUnattributedMessageCollection").UnattributedMessageCollection.add(f);f.forEach(function(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["agent: unknown agent with device id::",", delaying attribution of message id::",""])),e,a.id)});return}f=c.map(function(a){return d("WAWebMsgCollection").MsgCollection.get(a.id)}).filter(Boolean).filter(function(a){return a.agentId==null});var a=String(b.id);f.forEach(function(b){b.agentId=a});c=f.map(function(b){b=b.id.toString();return{id:b,agentId:a}});yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)});return j.apply(this,arguments)}function e(a){if(a.agentId!=null||!d("WAWebAgentModelUtils").canUserSeeMessageAttribution())return a.agentId;a=d("WAWebUserPrefsMeUser").getMaybeMeDevicePn();if(a!=null){a=d("WAWebAgentCollection").AgentCollection.getByDeviceId(a.getDeviceId());if(a!=null)return a.id}}var k,l;function f(a){l=a}function m(a,b){b===void 0&&(b=!1);if(!d("WAWebBizGatingUtils").isMultiDeviceAgentsLoggingEnabled())return;new(d("WAWebMdExpansionAgentBrowserMdIdWamEvent").MdExpansionAgentBrowserMdIdWamEvent)(babelHelpers["extends"]({agentId:k},a)).commitAndWaitForFlush(b)}function n(a){l!=null&&m(babelHelpers["extends"]({},a,l,{multideviceAction:d("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.LOGIN}))}function o(){if(!d("WAWebBizGatingUtils").isMultiDeviceAgentsLoggingEnabled())return;var a=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),b=c("WAWebMiscBrowserUtils").persistentExpiringId();d("WAWebCmd").Cmd.on("logout",function(){m({browserId:b,companionMdId:a,logoutTimestamp:d("WATimeUtils").unixTimeWithoutClockSkewCorrection(),multideviceAction:d("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.LOGOUT},!0)});document.addEventListener("visibilitychange",function(){document.hidden||m({browserId:b,companionMdId:a,multideviceAction:d("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.ACTIVE})});var e=d("WAWebAgentCollection").AgentCollection.getByDeviceId(a);e!=null?(k=e.id,n({browserId:b,companionMdId:a})):d("WAWebCmd").Cmd.on(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,function(){var c=d("WAWebAgentCollection").AgentCollection.getByDeviceId(a);(c==null?void 0:c.id)!=null&&k==null&&(k=c.id,n({browserId:b,companionMdId:a}))})}function p(a){a=a!=null?d("WAWebAgentCollection").AgentCollection.get(a):void 0;var b=c("WAWebMiscBrowserUtils").persistentExpiringId();m({browserId:b,agentId:a==null?void 0:a.id,companionMdId:a==null?void 0:a.deviceId,multideviceAction:d("WAWebWamEnumMultideviceActionType").MULTIDEVICE_ACTION_TYPE.MESSAGE_INFO})}g.updateUnattributedMessages=a;g.getAgentId=e;g.setShouldLogAgentLogin=f;g.initializeAgentLog=o;g.logMessageInfo=p}),98);
__d("WAWebBizBusinessChangeAction",["WAWebBusinessProfileCollection","WAWebConnModel","WAWebContactGetters","WAWebStateUtils"],(function(a,b,c,d,e,f,g){a=function(a){a=d("WAWebStateUtils").unproxy(a);var b=a.businessProfile,c=a.id,e=a.isBusiness||d("WAWebContactGetters").getIsMe(a)&&d("WAWebConnModel").Conn.isSMB;e&&!b?a.addChild("businessProfile",d("WAWebBusinessProfileCollection").BusinessProfileCollection.gadd(c)):!e&&b&&(a.stopListening(b),a.businessProfile=void 0,b["delete"]())};g.handleBusinessChange=a}),98);
__d("WAWebQueryBusinessCategoriesJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("businessCategoriesResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("response");var b=[],c="";try{var d=a.maybeChild("not_a_biz");d==null||d.forEachChildWithTag("category",function(a){c=a.attrString("id")});d=a.child("categories");d.forEachChildWithTag("category",function(a){var d=a.attrString("id");a=a.contentString();b.push({id:d,localized_display_name:a,not_a_biz:c.length?d===c:!1})})}catch(a){}return{categories:b,notABizId:c}});function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c="profile_typeahead";c=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"fb:thrift_iq",id:b.generateId(),type:"get"},b.wap("request",{op:b.CUSTOM_STRING(c),type:"catkit",v:"1"},b.wap("query",null,a)));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(c,h));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode);else return b.result});return i.apply(this,arguments)}g.queryBusinessCategories=a}),98);
__d("WAWebBusinessProfileCategoriesBridge",["WAWebBizLogQplEvents","WAWebQueryBusinessCategoriesJob"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebBizLogQplEvents").qplPointProfileCatsView("datasource_start");return d("WAWebQueryBusinessCategoriesJob").queryBusinessCategories(a).then(function(a){d("WAWebBizLogQplEvents").qplPointProfileCatsView("datasource_end");return a})}g.queryBusinessCategories=a}),98);
__d("WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9797519763673469"}),null);
__d("WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql",["WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogCommerceSettingsResponse",kind:"LinkedField",name:"xfb_whatsapp_smb_commerce_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cart_enabled",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",selections:c},params:{id:b("WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementUpdateCommerceSettings",["Promise","WALogger","WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForCommerceSettingsEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["updateCommerceSettings: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['updateCommerceSettings: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").commitMutation(n,{input:b},{environmentType:"facebook",accessToken:a})}).then(function(a){if(a==null)return m;a=a.xfb_whatsapp_smb_commerce_settings;if(a==null)return m;return(a==null?void 0:a.cart_enabled)==null?m:{type:"success",result:a.cart_enabled}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["updateCommerceSettingsWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.updateCommerceSettings=a}),98);
__d("WAWebBusinessProfileJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizCatalogManagementUpdateCommerceSettings","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("businessProfileResponse",function(a){a.assertTag("iq"),a.assertFromServer()}),i=new(c("WADeprecatedWapParser"))("commerceSettingsResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("commerce_settings");a=a.child("cart").attrString("enabled");return a==="true"});function j(a){var b=a.note,c=a.timezone,e=a.config,f=[];Object.keys(e).forEach(function(a){var b=e[a];if(b==null)return;var c=b.mode;b=b.hours;if(b)for(b of b){var d=b[0],g=b[1];f.push({day_of_week:a,mode:c,open_time:d,close_time:g})}else f.push({day_of_week:a,mode:c})});a=[];b!=null&&b!==""&&a.push(d("WAWap").wap("business_hours_note",null,b));a.push.apply(a,f.map(function(a){a=d("WAWap").wap("business_hours_config",{day_of_week:d("WAWap").CUSTOM_STRING(a.day_of_week),mode:d("WAWap").CUSTOM_STRING(a.mode),open_time:a.open_time!=null?d("WAWap").CUSTOM_STRING(a.open_time.toString()):d("WAWap").DROP_ATTR,close_time:a.close_time!=null?d("WAWap").CUSTOM_STRING(a.close_time.toString()):d("WAWap").DROP_ATTR});return a}));return d("WAWap").wap("business_hours",{timezone:c?d("WAWap").CUSTOM_STRING(c):d("WAWap").DROP_ATTR},a)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,smax_id:b.SMAX_ID(c("WAWapDeprecatedSmaxID").CommerceSettingsSet),xmlns:"fb:thrift_iq",id:b.generateId(),type:"set"},b.wap("commerce_settings",null,b.wap("cart",{enabled:b.CUSTOM_STRING(a.toString())})));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,i));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);else return a.result});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(b==null)throw c("err")("updateCartEnabledGraphQL: meUser is null");b=(yield d("WAWebBizCatalogManagementUpdateCommerceSettings").updateCommerceSettings({biz_jid:b.toJid(),cart_enabled:a}));if(b.type==="success")return b.result;else if(b.type==="graphql-error")d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(b.error);else if(b.type==="recovery-required")return k(a);else b.type;throw c("err")("updateCartEnabledGraphQL: error handling flow not implemented for "+JSON.stringify(b))});return n.apply(this,arguments)}function a(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebBizGatingUtils").graphQLForCommerceSettingsEnabled()?m(a):k(a)});return o.apply(this,arguments)}function e(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=a.address,e=a.description,f=a.categories,g=a.email,i=a.website;a=a.businessHours;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:biz",id:b.generateId(),type:"set"},b.wap("business_profile",{v:"3",mutation_type:"delta"},c!==void 0?d("WAWap").wap("address",null,c):null,e!==void 0?d("WAWap").wap("description",null,e):null,g!==void 0?d("WAWap").wap("email",null,g):null,i&&i.length===0?d("WAWap").wap("website",null):null,i&&i.length>0?d("WAWap").wap("website",null,i[0].url):null,i&&i.length>1?d("WAWap").wap("website",null,i[1].url):null,f?d("WAWap").wap("categories",null,f.map(function(a){return d("WAWap").wap("category",{id:d("WAWap").CUSTOM_STRING(a.id)})})):null,a?j(a):null));c=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!c.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c.errorCode)});return p.apply(this,arguments)}function f(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;a=(e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,xmlns:"w:biz",id:e.generateId(),type:"set"},e.wap("business_profile",{v:"3",mutation_type:"delta"},e.wap("cover_photo",{op:"update",id:e.CUSTOM_STRING(a.toString()),ts:e.CUSTOM_STRING(b.toString()),token:e.CUSTOM_STRING(c)})));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,h));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode)});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:biz",id:b.generateId(),type:"set"},b.wap("business_profile",{v:"3",mutation_type:"delta"},b.wap("cover_photo",{op:"delete",id:b.CUSTOM_STRING(a)})));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode)});return s.apply(this,arguments)}g.updateCartEnabled=a;g.editBusinessProfile=e;g.sendCoverPhoto=f;g.deleteCoverPhoto=r}),98);
__d("WAWebBizBusinessProfileAction",["WALogger","WAPromiseDelays","WAWebBusinessCategoriesResultModel","WAWebBusinessProfileCategoriesBridge","WAWebBusinessProfileCollection","WAWebBusinessProfileJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebQueryBusinessProfile","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","cr:3128","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(!c("gkx")("26258")){var f;f=(f=b("cr:3128")==null?void 0:b("cr:3128").debugSmbConfigs.delayBusinessProfileQuery)!=null?f:0;f&&(d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[queryBusinessProfile] delaying "," seconds before querying business profile"])),f),yield d("WAPromiseDelays").delayMs(f*1e3))}f=(yield d("WAWebQueryBusinessProfile").queryBusinessProfile(a,e));if(!c("gkx")("26258")){var g;a=b("cr:3128")==null?void 0:b("cr:3128").debugSmbConfigs.mockBusinessProfileId;e=b("cr:3128")==null||(g=b("cr:3128").debugSmbConfigs)==null?void 0:g.mockBusinessProfileQueryPayload;e&&f[0].wid.equals(a)&&(d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[queryBusinessProfile] merging mock payload to the busines profile"]))).devConsole({response:f,mockPayload:e}),f[0].profile=babelHelpers["extends"]({},f[0].profile,e))}return f});return l.apply(this,arguments)}function e(a){return a===d("WAWebBusinessCategoriesResultModel").BUSINESS_CATEGORY_EMPTY_STR_ID?d("WAWebBusinessProfileCategoriesBridge").queryBusinessCategories(""):d("WAWebBusinessProfileCategoriesBridge").queryBusinessCategories(a)}function f(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebBusinessProfileJob").updateCartEnabled(a));var b=d("WAWebBusinessProfileCollection").BusinessProfileCollection.getValid(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()),c=b==null?void 0:b.profileOptions;b&&c&&(c.cartEnabled=a,d("WAWebBusinessProfileCollection").BusinessProfileCollection.add(b,{merge:!0}))});return m.apply(this,arguments)}function n(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] fetching business public key certificate from server"])));return d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.getPublicKey(a))}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] fetching signed user info from server"])));a=(yield d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.getSignedUserInfo(a)));var b=a.phoneNumber,e=a.phoneNumberSignature,f=a.phoneNumberSignatureExpiration;a=a.businessDomain;if(b==null||f==null||e==null||a==null)throw c("err")("Unexpected null or undefined");return{phoneNumber:b,phoneNumberSignature:e,phoneNumberSignatureExpiration:f,businessDomain:a}});return p.apply(this,arguments)}g.queryBusinessProfile=a;g.queryBusinessCategories=e;g.updateCartEnabled=f;g.queryBusinessPublicKey=n;g.querySignedUserInfo=o}),98);
__d("WAWebChatAssignmentLogEvents.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["CONTACT_INFO_SCREEN","CONVERSATION_MENU","MULTI_SELECT","SYSTEM_MESSAGE"]);f.ChatAssignmentEntryPointType=a}),66);
__d("WAWebChatAssignmentSystemMsg",["WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function a(a,b,e){var f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),g=c("WAWebMsgKey").newId_DEPRECATED();g=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:a,id:g});return{id:g,t:e,type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:b==null?"chat_assignment_unassign":"chat_assignment",from:a,to:f,templateParams:b==null?[]:[b.name]}}g.genChatAssignmentNotificationTemplateMsg=a}),98);
__d("WAWebBizChatAssignmentAction",["Promise","WATimeUtils","WAWebAgentCollection","WAWebBizChatAssignmentOpenedAction","WAWebBizGatingUtils","WAWebChatAssignmentCollection","WAWebChatAssignmentLogEvents","WAWebChatAssignmentLogEvents.flow","WAWebChatAssignmentModel","WAWebChatAssignmentSync","WAWebChatAssignmentSystemMsg","WAWebChatAssignmentUtils","WAWebChatCollection","WAWebCmd","WAWebHandleSingleMsg","WAWebMobilePlatforms","WAWebNotificationController","WAWebNotificationsChatAssignmentNotification","WAWebSchemaChatAssignment","WAWebSyncdCoreApi","WAWebSyncdOrphan","WAWebUserPrefsMeUser","WAWebUserPrefsStore","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebChatAssignmentUtils").canAssignChats())return;var e=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId(),f=a.map(function(a){var c=a.chat.id.toString({legacy:!0});a=a.agentId;var f=d("WAWebAgentCollection").AgentCollection.getByDeviceId(e);f=(f==null?void 0:f.deviceId)===e&&b!==d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.MULTI_SELECT&&b!==d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONTACT_INFO_SCREEN;return{id:c+"_"+(a||""),chatId:c,agentId:a!=null?a:"",chatOpenedByAgent:f}}),g=a.map(function(a){return a.chat.assignedAgent!=null});yield d("WAWebSyncdCoreApi").lockForSync(["chat-assignment"],yield c("WAWebChatAssignmentSync").createChatAssignmentMutations(f),function(){return k(f)});a.forEach(function(c,e){d("WAWebChatAssignmentLogEvents").logChatAssignment(c.chat,(c=c.agentId)!=null?c:"",g[e],b,a.length)});m(a.map(function(a){var b=a.chat;a=a.agentId;a=d("WAWebAgentCollection").AgentCollection.get(a!=null?a:"");return{chatId:b.id,agent:a,timestamp:d("WATimeUtils").unixTime()}}));c("WAWebUserPrefsStore").setUser("chat_assignment_agent_has_assigned_chats",!0);f.filter(function(a){a=a.chatOpenedByAgent;return a===!0}).forEach(function(a){a=d("WAWebChatCollection").ChatCollection.get(a.chatId);a!=null&&d("WAWebBizChatAssignmentOpenedAction").markChatAsOpened(a,!0)})});return i.apply(this,arguments)}function j(a){return d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getModelsArray().filter(function(b){b=b.chatId;return a.includes(b)}).map(function(a){return a.id})}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=j(a.map(function(a){a=a.chatId;return a})),e=a.map(function(a){var b=a.id,c=a.chatId,e=a.agentId;a=a.chatOpenedByAgent;return new(d("WAWebChatAssignmentModel").ChatAssignment)({id:b,chatId:c,agentId:e,chatOpenedByAgent:a,agent:d("WAWebAgentCollection").AgentCollection.get(e)})});d("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(c);d("WAWebChatAssignmentCollection").ChatAssignmentCollection.add(e);e=d("WAWebSchemaChatAssignment").getChatAssignmentTable();yield (h||(h=b("Promise"))).all([e.bulkRemove(c),e.bulkCreateOrMerge(a)])});return l.apply(this,arguments)}function m(a){if(!d("WAWebBizGatingUtils").chatAssignmentSystemMessagesEnabled())return;a.forEach(function(a){var b=a.chatId,c=a.agent;a=a.timestamp;var e=d("WAWebChatCollection").ChatCollection.get(b);d("WAWebHandleSingleMsg").handleSingleMsg({chatId:b,newMsg:d("WAWebChatAssignmentSystemMsg").genChatAssignmentNotificationTemplateMsg(b,c,a),handleSingleMsgOrigin:"chatAssignmentSystemMsg"}).then(function(){e!=null&&d("WAWebChatAssignmentLogEvents").logSystemMessageGeneratedFromCompanion(e)})["catch"](function(){e!=null&&d("WAWebChatAssignmentLogEvents").logSystemMessageFailedToGenerate(e)})})}function e(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMobilePlatforms").isSMB())return;a=j([a.toString({legacy:!0})]);yield d("WAWebSchemaChatAssignment").getChatAssignmentTable().bulkRemove(a);d("WAWebChatAssignmentCollection").ChatAssignmentCollection.remove(a)});return n.apply(this,arguments)}function f(){d("WAWebCmd").Cmd.once(d("WAWebCmd").APP_STATE_SYNC_COMPLETED,function(){d("WAWebSyncdOrphan").checkOrphanAgents(d("WAWebAgentCollection").AgentCollection.getModelsArray().map(function(a){a=a.id;return a})),d("WAWebSyncdOrphan").checkOrphanChatAssignments(d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getModelsArray().map(function(a){a=a.id;return a}))})}function o(a,b){if(!d("WAWebBizGatingUtils").chatAssignmentNotificationsEnabled()||!d("WAWebChatAssignmentUtils").canAssignChats())return;var c=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();a=a.filter(function(a){a=d("WAWebAgentCollection").AgentCollection.get(a.agentId);return(a==null?void 0:a.deviceId)===c});if(a.length===0)return;d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsChatAssignmentNotification").WAWebNotificationsChatAssignmentNotification)({chats:a.map(function(a){return d("WAWebWidFactory").createWid(a.chatId)}),assignmentTimestamps:b}))}g.changeChatAssignment=a;g.createChatAssignmentSystemMsgs=m;g.removeChatAssignmentsForChat=e;g.checkOrphanAssignments=f;g.triggerChatAssignmentNotification=o}),98);
__d("WAWebBizChatAssignmentOpenedAction",["WAWebAgentCollection","WAWebChatAssignmentCollection","WAWebChatAssignmentOpenedStatusSync","WAWebChatAssignmentUtils","WAWebSchemaChatAssignment","WAWebSyncdCoreApi","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.forEach(function(a){var b=a.id;a=a.chatOpenedByAgent;b=d("WAWebChatAssignmentCollection").ChatAssignmentCollection.get(b);b&&b.set("chatOpenedByAgent",a)});var b=d("WAWebSchemaChatAssignment").getChatAssignmentTable();yield b.bulkCreateOrMerge(a)});return i.apply(this,arguments)}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebChatAssignmentUtils").canAssignChats())return;var e=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();a=a.id;var f=(e=d("WAWebAgentCollection").AgentCollection.getByDeviceId(e))==null?void 0:e.id;if(f==null)return;e=[{chatId:a,agentId:f,chatOpened:b}];var g=e.map(function(a){a=a.chatId.toString({legacy:!0});return{id:a+"_"+f,chatId:a,agentId:f,chatOpenedByAgent:b}});yield d("WAWebSyncdCoreApi").lockForSync(["chat-assignment"],yield c("WAWebChatAssignmentOpenedStatusSync").createChatOpenedMutations(g),function(){return h(g)})});return j.apply(this,arguments)}g.updateLocalOpenedState=h;g.markChatAsOpened=a}),98);
__d("WAWebBizInteractiveMessageQuickReplyAction",["WANullthrows","WAWebCarouselMsgUtils","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.isCarouselCard)return i(a,b);b=k(a,b);var c=d("WAWebSchemaMessage").getMessageTable();c=(yield c.get(a.id.toString()));yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge([{id:c==null?void 0:c.id,interactivePayload:b}]);a.set("interactivePayload",b)});return h.apply(this,arguments)}function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=k(a.interactivePayload,b);var e=c("WANullthrows")(d("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(a)),f=c("WANullthrows")(e.carouselCardsParsed).slice(),g=f.findIndex(function(b){return b.id.toString()===a.id.toString()});f[g]=babelHelpers["extends"]({},f[g],{interactivePayload:b});g=d("WAWebSchemaMessage").getMessageTable();var h=(yield g.get(e.id.toString()));yield g.bulkCreateOrMerge([{id:h==null?void 0:h.id,carouselCardsParsed:f}]);e.set("carouselCardsParsed",f);a.set("interactivePayload",b)});return j.apply(this,arguments)}function k(a,b){var c;return babelHelpers["extends"]({},a,{buttons:a==null||(c=a.buttons)==null?void 0:c.map(function(a,c){if(a.buttonParamsJson===void 0)return a;var d=JSON.parse(a.buttonParamsJson);b===c&&(d.disabled=!0);return{name:a.name,buttonParamsJson:JSON.stringify(d)}})})}g.markInteractiveButtonClicked=a;g.rebuildInteractivePayloadWithDisabledButton=k}),98);
__d("WAWebBizProductCatalogAction",["WAWebBizCreateProductInquiry","WAWebBizProductCatalogBridge","WAWebBusinessProfileCollection","WAWebCatalogCollection","WAWebCatalogVariantHelper","WAWebCmd","WAWebComposeBoxActions","WAWebDrawerManager","WAWebFindChatAction","WAWebFrontendConstants","WAWebMsgCollection","WAWebStateUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c,d,e,f){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g){var h;c===void 0&&(c=100);e===void 0&&(e=100);var i,j,k,l=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a));h=(h=d("WAWebCatalogCollection").CatalogCollection.get(a))==null?void 0:h.productCollection.get(b);d("WAWebCatalogVariantHelper").shouldRequestVariantInfo(l,h)&&(i=d("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,j=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,k=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE);return d("WAWebBizProductCatalogBridge").queryProduct(a,b,c,e,f,g,i,j,k)});return h.apply(this,arguments)}function c(a,b,c,e,f,g,h,i,j,k){c===void 0&&(c=5);e===void 0&&(e=100);f===void 0&&(f=100);h===void 0&&(h=!1);return d("WAWebBizProductCatalogBridge").queryCatalog(a,b,c,e,f,g,h,i,j,k)}function e(a,b,c,e,f){c===void 0&&(c=100);e===void 0&&(e=100);return d("WAWebBizProductCatalogBridge").queryProductList(a,b,c,e,f)}function f(a,b){return d("WAWebBizProductCatalogBridge").appealProduct(a,b)}function i(a,b,c){return d("WAWebBizProductCatalogBridge").reportProduct(a,b,c)}function j(a,b,c){b===void 0&&(b=100);c===void 0&&(c=100);return d("WAWebBizProductCatalogBridge").addProduct(a,b,c)}function k(a,b,c){b===void 0&&(b=100);c===void 0&&(c=100);return d("WAWebBizProductCatalogBridge").editProduct(a,b,c)}function l(a){return d("WAWebBizProductCatalogBridge").deleteProducts(a)}function m(a,b,c){var e=a.catalogWid;if(!b)return;b=b.productCollection.get(a.id);var f=b?d("WAWebStateUtils").unproxy(b):d("WAWebStateUtils").unproxy(a);if(!f)return;b=f.getProductImageCollectionHead();var g=b==null?void 0:b.mediaData;if(!g)return;d("WAWebFindChatAction").findOrCreateLatestChat(e,"bizProductCatalogAction").then(function(a){var b=a.chat;d("WAWebCmd").Cmd.openChatFromUnread(b).then(function(a){if(a){a=d("WAWebStateUtils").unproxy(d("WAWebBizCreateProductInquiry").createProductInquiry(f,b.id,e,g,c==null?void 0:c.session.toString()));d("WAWebMsgCollection").MsgCollection.add(a);b.composeQuotedMsg=a;d("WAWebComposeBoxActions").ComposeBoxActions.focus(b);window.innerWidth<=d("WAWebFrontendConstants").LAYOUT_2COLUMNS_MAX_WIDTH&&d("WAWebDrawerManager").DrawerManager.closeDrawerRight()}})})}g.queryProduct=a;g.queryCatalog=c;g.queryProductList=e;g.appealProduct=f;g.reportProduct=i;g.addProduct=j;g.editProduct=k;g.deleteProducts=l;g.sendProductToChat=m}),98);
__d("WAWebBizProductMessageListAction",["WAWebMsgCollection"],(function(a,b,c,d,e,f,g){function a(a,b){var c;b=d("WAWebMsgCollection").MsgCollection.get(b);var e=b==null||(c=b.list)==null||(c=c.productListInfo)==null||(c=c.headerImage)==null?void 0:c.productId;a.id===e&&b!=null&&(b.productHeaderImageRejected=!0)}g.updateProductListHeaderImageRejected=a}),98);
__d("WAWebBizUpdateContactsWithVerifiedNamesAction",["WANullthrows","WAWebApiVerifiedBusinessName","WAWebBusinessProfileTypes","WAWebContactCollection","WAWebHandleMsgTypes.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){var c={};for(a of a){var e=a.id;c[e.user]=a}for(e of b){a=e.id;if(a.isBot())continue;b=c[a.user];a=Boolean(b);b=b||{};var f=b.level,g=b.name,h=b.isApi,i=b.isSmb;b=b.privacyMode;h=Boolean(h);a={isBusiness:a,isEnterprise:h,isSmb:Boolean(i),verifiedLevel:d("WAWebBusinessProfileTypes").convertLevel(f),verifiedName:g,privacyMode:b};e.set(a)}}a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebApiVerifiedBusinessName").getAllVerifiedNames()).filter(Boolean).map(function(a){var b=a.id,e=a.name,f=a.level,g=a.isApi,h=a.isSmb;a=a.privacyMode;return{id:d("WAWebWidFactory").createUserWidOrThrow(b),name:e,level:f,isApi:g,isSmb:h,privacyMode:a?{actualActors:c("WANullthrows")(d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(a.actualActors)),hostStorage:c("WANullthrows")(d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(a.hostStorage)),privacyModeTs:a.privacyModeTs}:null}});h(a,d("WAWebContactCollection").ContactCollection.toArray())});return function(){return a.apply(this,arguments)}}();g.updateContactsWithVerifiedNames=h;g.applyContactBusinessProps=a}),98);
__d("WAWebBizVerifiedNameAction",["Promise","WAWebBizUpdateContactsWithVerifiedNamesAction","WAWebChatCollection","WAWebFrontendChatGetters","WAWebHandleBusinessNameChangeLidHelpers","WAWebHandlePrivacyModeUpdateMsgAction","WAWebSchemaVerifiedBusinessName","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;yield (h||(h=b("Promise"))).all(a.map(function(a){var b=a.id;a=a.verifiedName;a=a==null?void 0:a.privacyMode;if(a==null)return;b=d("WAWebChatCollection").ChatCollection.getLatestChatForWid(b);if(b==null||d("WAWebFrontendChatGetters").getShouldAppearInList(b)===!0)return;return d("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(b.id,a,{chat:b,bypassVerifiedNameUpdate:!0,shouldRunMATonWid:!1})}));a=d("WAWebHandleBusinessNameChangeLidHelpers").getVerifiedNamesToUpdateLidAware(a).map(function(a){var b=a.id;a=a.verifiedName;if(a==null)return null;var c=a.level,d=a.serial,e=a.name,f=a.isApi,g=a.isSmb;a=a.privacyMode;return{id:b.isLid()?b.toString():b.user,level:c,serial:d,name:e,isApi:f,isSmb:g,privacyMode:a?{actualActors:a.actualActors,hostStorage:a.hostStorage,privacyModeTs:a.privacyModeTs}:null}}).filter(Boolean);yield d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().bulkCreateOrReplace(a);yield d("WAWebBizUpdateContactsWithVerifiedNamesAction").applyContactBusinessProps()});return i.apply(this,arguments)}g.handleVerifiedNameSync=a}),98);
__d("WAWebBizOrderAction",["WAWebBizOrderBridge"],(function(a,b,c,d,e,f,g){function a(a,b,c,e,f){return d("WAWebBizOrderBridge").queryOrder(a,b,c,e,f)}function b(a,b){return d("WAWebBizOrderBridge").createOrder(a,b)}g.queryOrder=a;g.createOrder=b}),98);
__d("WAWebFindChatAction",["WAAbortError","WALogger","WAWebApiContact","WAWebChatGetExistingBridge","WAWebCheckChatExistsOrCreate","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMessageProcessUtils","WAWebSyncContactJob","WAWebUsernameTypes","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s;function a(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!c("WAWebWid").isUser(a))return u(a,b).then(function(a){a=a.chat;return a});var f=(yield d("WAWebChatGetExistingBridge").getExisting(a));return f?f:u(a,b,e).then(function(a){a=a.chat;return a})});return t.apply(this,arguments)}function u(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f={chatId:a};if(a.isRegularUser())if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: using migration rules (chat: ",", origin: ",")"])),f.chatId.toLogString(),b);var g=d("WAWebLidMigrationUtils").toUserLid(a);g==null&&(d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: could not convert targetId to lid for chatOrigin ",""])),b).sendLogs("findOrCreateLatestChat_lid_not_found",{sampling:.01}),yield d("WAWebSyncContactJob").syncContactListJob([a],!0,"query"),g=d("WAWebLidMigrationUtils").toUserLidOrThrow(a));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: current lid: ",""])),g.toLogString());f=(yield d("WAWebMessageProcessUtils").selectChatForOneOnOneMessage({lid:g}));d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: selected destination: ",""])),f.chatId.toLogString())}else if(a.isLid()&&b!=="username_contactless_search"){g=(yield d("WAWebChatGetExistingBridge").getExisting(f.chatId));if(g==null){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: applying pre-migration rules (chat: ",", origin: ",")"])),f.chatId.toLogString(),b);g=d("WAWebApiContact").getPhoneNumber(a);if(g==null){b!=="voipCallLog"&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules. source: ",""])),b).sendLogs("findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules");throw c("err")("findOrCreateLatestChat: could not find phone number for lid while enforcing pre-migration rules")}f={chatId:g}}}d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: after chat selection (chat: ",", origin: ",")"])),f.chatId.toLogString(),b);a=e!=null?e:{};g=a.forceUsync;e=a.isGroupJoin;var t=a.signal;a=a.nextPrivacyMode;if(t!=null&&t.aborted)throw new(d("WAAbortError").AbortError)();t=(yield d("WAWebChatGetExistingBridge").getExisting(f.chatId));if(t)return{chat:t,created:!1};t={createdLocally:!0};e===!0&&(t.notSpam=!0);e=f.chatId;if(e.isLid()){e=d("WAWebApiContact").getPhoneNumber(e);b==="username_contactless_search"?e!=null?(f.chatId=e,d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating pn chat with ",""])),f.chatId.toLogString())):(t.lidOriginType=d("WAWebUsernameTypes").LidOriginType.GENERAL,d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating username chat with ",""])),f.chatId.toLogString())):(t.lidOriginType=d("WAWebUsernameTypes").LidOriginType.GENERAL,d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: creating lid chat with ",", origin ",""])),f.chatId.toLogString(),b));d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat will create Lid chat for origin ",""])),b).sendLogs("findOrCreateLatestChat will create Lid chat")}d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["findOrCreateLatestChat: will create chat with ",", origin ",""])),f.chatId.toLogString(),b);e=(yield d("WAWebCheckChatExistsOrCreate").checkChatExistsOrCreate({destinationChat:f,msgMeta:null,chatOriginType:b,initialProps:t,options:{forceUsync:g,nextPrivacyMode:a}}));b=(yield d("WAWebChatGetExistingBridge").getExisting(f.chatId));if(b==null){throw c("err")("findChat: new chat not found "+((t=f.chatId)==null?void 0:t.toLogString()))}return{chat:b,created:!e}});return v.apply(this,arguments)}g.findExistingChat=a;g.findOrCreateLatestChat=u}),98);
__d("WAWebSetArchiveChatActionUtils",["WALogger","WAWebSettingsGetters","WAWebSettingsModel"],(function(a,b,c,d,e,f,g){var h;function a(a){if(d("WAWebSettingsGetters").getShowArchiveV2(c("WAWebSettingsModel")))return!1;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["archive:shouldUnarchiveChat unarchive chat"])));return!0}g.shouldUnarchiveChat=a}),98);
__d("WAWebWamEnumWebcQueryTriggerType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,USER_SCROLL:1,NEW_MESSAGE_PREFETCH:2,SEARCH_RESULT_CLICK:3});f.WEBC_QUERY_TRIGGER_TYPE=a}),66);
__d("WAWebHandleNewMsgAction",["Promise","WAFilteredCatch","WALogger","WATimeUtils","WAWebApiChat","WAWebBackendErrors","WAWebBotGenTypingIndicatorMsg","WAWebChangePresenceHandlerAction","WAWebChatGetters","WAWebChatLoadMessages","WAWebCmd","WAWebCollectionConstants","WAWebCommonCTWAConsumerTransparency","WAWebCommonCTWALogging","WAWebCommonMsgUtils","WAWebConversionTupleCollection","WAWebDBUpdateChatTable","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebGroupUnreadMessageType","WAWebHandleMsgReceiptCommon","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMmSignalSharingLoggingEvents","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNoop","WAWebRichOrderStatusLogger","WAWebSchemaChat","WAWebSendSpamChatAction","WAWebSetArchiveChatActionUtils","WAWebUnreadMentionModel","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumWebcQueryTriggerType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;function s(){return!d("WAWebCmd").Cmd.isOfflineDeliveryEnd}var t=!1;function a(a,e){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat chatId: "," type: ",", sub type: ",""])),a.id.toLogString(),e.type,e.subtype);if(d("WAWebChatGetters").getIsNewsletter(a)&&!d("WAWebNewsletterGatingUtils").isNewsletterEnabled())return(r||(r=b("Promise"))).resolve();if(!e)return(r||(r=b("Promise"))).resolve();var f=(r||(r=b("Promise"))).resolve();d("WAWebMsgGetters").getIsSentByMe(e)&&!a.notSpam&&!d("WAWebChatGetters").getIsNewsletter(a)&&(f=d("WAWebSendSpamChatAction").sendNotSpam(a,!1));return d("WAWebFrontendMsgGetters").getEventType(e)===d("WAWebCommonMsgUtils").EventType.IGNORE?(r||(r=b("Promise"))).resolve():f.then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b={};a.promises.updateSortTime&&a.promises.updateSortTime.abortController.abort();d("WAWebMsgGetters").getIsSentByMeFromWeb(e)&&(a.archive&&(d("WAWebSetArchiveChatActionUtils").shouldUnarchiveChat(d("WAWebMsgGetters").getIsSentByMe(e))&&(d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat model: unarchiving chat"]))),b.archive=!1)));a.promises.setArchive&&a.promises.setArchive.abortController.abort();!d("WAWebChatGetters").getIsNewsletter(a)&&e.subtype!==d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&(!d("WAWebMsgGetters").getIsSentByMe(e)?c("WAWebChangePresenceHandlerAction")({id:a.id,participant:e.author,type:"idle"},!1):a.markedUnread=!1);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: before updating chat table ",""])),a.id.toLogString());try{yield d("WAWebDBUpdateChatTable").updateChatTable(a.id,b)}catch(b){var f=(yield d("WAWebSchemaChat").getChatTable().get(a.id.toString()));d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: unable to update chat table for id:",". chat exists in db: "," error: ",""])),a.id.toLogString(),f!=null,b).sendLogs("handle-new-msg-cannot-update-chat");throw b}f=babelHelpers["extends"]({},b);try{if(s()&&(d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,e.viewMode)||(b=d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&b.includes(e.type)))d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: updating UI immediatelly ",""])),a.id.toLogString()),f.t=e.t,(d("WAWebFrontendMsgGetters").getEventType(e)===d("WAWebCommonMsgUtils").EventType.AMBIENT||d("WAWebFrontendMsgGetters").getEventType(e)===d("WAWebCommonMsgUtils").EventType.DEFAULT)&&!e.id.fromMe&&(f.unreadCount=a.unreadCount+1||1,a.activeUnreadCount>0&&(f.activeUnreadCount=a.activeUnreadCount+1));else{b=(yield d("WAWebApiChat").getChatMeta(a.id));var g=b.unreadCount;b=b.timestamp;f.unreadCount=g;f.t=b;a.activeUnreadCount>0&&(f.activeUnreadCount=a.activeUnreadCount+Number(d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,e.viewMode)))}f.unreadDividerOffset=0}catch(c){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg: unable to find metadata from chat table for id:",". stack: ",""])),a.id.toLogString(),c.stack);if(!t){var h;t=!0;g=(yield d("WAWebSchemaChat").getChatTable().get(a.id.toString()));b=a.accountLid?yield d("WAWebSchemaChat").getChatTable().get((b=a.accountLid)==null?void 0:b.toString()):null;d("WAWebLidMigrationUtils").logLidMetadata();d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg error chat_id: ",", account_lid: ",", chat by id: ",", chat by accountLid ",""])),a.id.toLogString(),(h=a.accountLid)==null?void 0:h.toLogString(),g!=null,b!=null).tags("missing-lid");d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["onNewMsg: unable to find metadata from chat table for id:",". stack: ",""])),a.id.toLogString(),c.stack).sendLogs("onNewMsg: unable to find metadata from chat table")}}return f})).then(function(b){a.set(b);e.ctwaContext!=null&&(d("WAWebCommonCTWAConsumerTransparency").handleConsumerTransparencyForNewMsg(a,e.ctwaContext.conversionData,e.ctwaContext.conversionSource),d("WAWebCommonCTWALogging").maybeSetCtwaMessageReceivedInUserPreferenceStore(e));var f=c("WAWebConversionTupleCollection").get(a.id);if(f)f.timestamp=d("WATimeUtils").unixTime();else if(e.ctwaContext!=null){f=e.ctwaContext;var g=f.conversionSource;f=f.conversionData;c("WAWebConversionTupleCollection").add({conversionSource:g,conversionData:f,id:a.id,timestamp:d("WATimeUtils").unixTime()},{merge:!0})}g=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();e.type==="gp2"&&(e.subtype==="add"||e.subtype==="create")&&a.getGroupMetadataCollection().trigger("group_participant_change_"+g.toString(),a.id);if(!d("WAWebMsgGetters").getIsSentByMe(e)){switch(d("WAWebFrontendMsgGetters").getEventType(e)){case d("WAWebCommonMsgUtils").EventType.DEFAULT:case d("WAWebCommonMsgUtils").EventType.AMBIENT:d("WAWebFrontendMsgGetters").getEventType(e)===d("WAWebCommonMsgUtils").EventType.DEFAULT&&d("WAWebCmd").Cmd.alertNewMsg(e);a.msgs.length<d("WAWebCollectionConstants").MSG_PRELOAD_THRESHOLD&&!d("WAWebChatGetters").getIsNewsletter(a)&&d("WAWebChatLoadMessages").loadEarlierMsgs(a,void 0,d("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["catch"](function(a){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["chat:onNewMsg failed\n",""],["chat:onNewMsg failed\\n",""])),a)});break;case d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:(e.type===d("WAWebMsgType").MSG_TYPE.CALL_LOG&&!c("WAWebEnvironment").isWindows||e.subtype==="sender_invite")&&d("WAWebCmd").Cmd.alertNewMsg(e);break;case d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:if(e.type==="gp2"&&e.subtype==="add"&&d("WAWebUserPrefsMeUser").isMeAccount(e.recipients[0])&&!a.contact.name)return;d("WAWebCmd").Cmd.alertNewMsg(e);f=a.getGroupMetadataCollection();f.trigger("group_participant_change_"+g.toString(),a.id);break;default:break}f=e.mediaData;f&&(f.type==="image"||f.type==="video")&&d("WAWebCmd").Cmd.newMediaMsg(e);b.unreadCount!=null&&b.unreadCount>0&&!s()&&d("WAWebHandleMsgReceiptCommon").processOrphanPeerReceipt(e.id);if(d("WAWebMsgGetters").getIsImportantMessage(e)){g=new(c("WAWebUnreadMentionModel"))({id:e.id.toString(),timestamp:e.t});(f=a.groupMetadata)==null||f.unreadMentionMetadata.addUnreadMentions(g,d("WAWebGroupUnreadMessageType").UnreadMessageType.NEW_MESSAGE);if(a.archiveAtMentionViewedInDrawer){b=new Map();b.set(a.id.toString(),!1);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["handleNewMsgForChat: will mark chat for archive"])));d("WAWebApiChat").updateChatArchiveDrawer(b);a.archiveAtMentionViewedInDrawer=!1}}}else a.activeUnreadCount>0&&(a.activeUnreadCount=0,a.markedUnread=!1);void d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingNewMessageEvent({chat:a,newMsg:e});void d("WAWebRichOrderStatusLogger").logRichOrderStatusInconsistencies(e)})}g.handleNewMsgForChat=a}),98);
__d("WAWebSendAddonMsgChatAction",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSendMsgRecordAction","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSendMsgRecordAction").sendAddonRecord(a)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.addAndSendAddonToChat=a}),98);
__d("WAWebSendClearChatAction",["fbt","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebChatConstants","WAWebClearChatUtils","WAWebStateUtils","WAWebToastManager","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react");function a(a,b){return l(d("WAWebStateUtils").unproxy(a),b)}function l(a,c){var e=d("WAWebClearChatUtils").initClearChat(a,c),f=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Clearing chat")),g=e.then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){a.endOfHistoryTransferType=d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY;return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Chat cleared"))}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){if(a.status>=400)return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't clear chat."))}))["catch"](function(b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendClear dropped"]))).devConsole(b);return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't clear chat."),{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return l(a,c)}})});d("WAWebToastManager").ToastManager.open(k.jsx(d("WAWebActionToast.react").ActionToast,{initialAction:f,pendingAction:g}));return d("WAWebClearChatUtils").finalizeClearChat(a,e)}g.sendClear=a}),226);
__d("WAWebBizShowOrderEphemeralSystemAction",["WAWebBizGatingUtils","WAWebDBChatEphemeralExemptionData","WAWebDBEphemeralDisplayedExemptions","WAWebOrderEphemeralExemptionUtil","WAWebOrderSystemMsg"],(function(a,b,c,d,e,f,g){function a(a,b){if(!d("WAWebBizGatingUtils").inOrderMessagesEphemeralExceptionEnabled())return null;var c=a.safe(),e=a.interactiveType;a=a.nativeFlowName;if(!d("WAWebOrderEphemeralExemptionUtil").isMessageTypeExemptedFromDisappearing(c.type,e,a))return null;c={id:b.id.toString(),ephemeralDuration:b.ephemeralDuration,ephemeralDisplayedExemptions:b.ephemeralDisplayedExemptions};if(d("WAWebOrderEphemeralExemptionUtil").shouldShowOrderExemptionSystemMessage(c)){b.ephemeralDisplayedExemptions=d("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS;d("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(b.id,b.ephemeralDuration,d("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS);return d("WAWebOrderSystemMsg").getOrderEphemeralExemptionSystemMsg(b.id)}else d("WAWebOrderEphemeralExemptionUtil").shouldUnsetChatEphemeralDisplayedExemption(c)&&(b.ephemeralDisplayedExemptions=d("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.UNSET,d("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(b.id,b.ephemeralDuration,d("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.UNSET));return null}g.getMaybeSystemMsgForOrderEphemeralExemption=a}),98);
__d("WAWebEmptyChatSystemMsg",["WAWebInitialSystemMsg","WAWebMsgGetters","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("WAWebMsgGetters").getIsGroupMsg(a)&&b.msgs.length===0){return c("WAWebInitialSystemMsg")(b.id,b.contact.privacyMode,(a=b.contact.businessProfile)==null?void 0:a.automatedType)}return null});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebLidMigrationFrontendUtils",["WALogger","WAWebCurrentUser","WAWebLidMigrationUtils","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{if(d("WAWebLidMigrationUtils").shouldHaveAccountLid(a.id)){var e,f=(yield d("WAWebSchemaChat").getChatTable().get(a.id.toString())),g=d("WAWebLidMigrationUtils").toLid(a.id);d("WAWebLidMigrationUtils").logLidMetadata();e="isEmployee? "+d("WAWebCurrentUser").isEmployee().toString()+", source: "+c+",\n      input chat.id: "+a.id.toLogString()+". input chat.account_lid: "+((e=(e=a.accountLid)==null?void 0:e.toLogString())!=null?e:"")+",\nchat exist in db: "+(f!=null).toString()+", db chat account lid: "+((f==null?void 0:f.accountLid)==null?"null":d("WAWebWidFactory").createWid(f==null?void 0:f.accountLid).toLogString())+"\nchat.id lid mapping: "+((e=g==null?void 0:g.toLogString())!=null?e:"")+",\nmsg kind: "+((g=b==null?void 0:b.kind)!=null?g:"")+" "+((e=b==null?void 0:b.type)!=null?e:"")+" "+((g=b==null?void 0:b.subtype)!=null?g:"");if(a.accountLid==null)d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: model does not have account_lid. ",""])),e).sendLogs("no-account-lid-for-send").tags("missing-lid");else if(f==null)d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: chat does not exist in DB. ",""])),e).sendLogs("chat-not-in-db-for-new-message").tags("missing-lid");else if(f.accountLid==null)d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: DB does not have account_lid. ",""])),e).sendLogs("db-chat-has-empty-accountlid-for-new-message").tags("missing-lid");else{d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid: chat is in DB and has account_lid. chat id: ",", account lid: "," ",""])),a.id.toLogString(),(b=a.accountLid)==null?void 0:b.toLogString(),c)}}}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["validateMissingAccountLid unexpected error while validating chat. ",""])),a)}});return m.apply(this,arguments)}g.validateMissingAccountLid=a}),98);
__d("WAWebSendMsgChatAction",["Promise","WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebApiGroupInviteV4Store","WAWebAppTracker","WAWebBizAgentAction","WAWebBizShowOrderEphemeralSystemAction","WAWebDBProcessMessage","WAWebDBRevokeInviteV4","WAWebEmptyChatSystemMsg","WAWebLid1X1MigrationGating","WAWebLidMigrationFrontendUtils","WAWebLidMigrationUtils","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgInfoUtils","WAWebMsgModel","WAWebMsgType","WAWebOrchestratorNonPersistedJob","WAWebPrivacyMode_WORKER_INCOMPATIBLE","WAWebSendMsgRecordAction","WAWebStateUtils","WAWebWamMsgUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;function a(a,b,c){return q(d("WAWebStateUtils").unproxy(a),b,c)}function e(a,b){return s(d("WAWebStateUtils").unproxy(a),b)}function f(a,b,c){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=function(a){return(o||(o=b("Promise"))).resolve(a)});c=(yield c);c=d("WAWebMsgCollection").MsgCollection.add(babelHelpers["extends"]({},c))[0];if(c)return r(a,e(c))});return p.apply(this,arguments)}function q(a,e,f){f===void 0&&(f=void 0);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat start chatId: ",""])),a.id.toLogString());var g;e=(o||(o=b("Promise"))).resolve(e).then(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat consistent msg id? ",". ",", ",""])),a.id.equals(b.id.remote),a.id.toLogString(),(e=b.id.remote)==null?void 0:e.toLogString());yield d("WAWebLidMigrationFrontendUtils").validateMissingAccountLid(a,b,"addAndSendMsgToChat");e=d("WAWebPrivacyMode_WORKER_INCOMPATIBLE").getPrivacyModeFromModel(a.id);b=babelHelpers["extends"]({},b,{agentId:d("WAWebBizAgentAction").getAgentId(b)});e&&(b.privacyModeWhenSent=e);e=new(d("WAWebMsgModel").Msg)(b);var f=d("WAWebMsgCollection").MsgCollection.add(e)[0];if(f){var h;e=Boolean((e=a.groupMetadata)==null?void 0:e.isLidAddressingMode);e=d("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(a.id,d("WAWebWamMsgUtils").msgIsLid(f,a.id,e));f.wamMessageSendReporter=new(d("WAWebMessageSendReporter").MessageSendReporter)(f,e);f.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:f.to,mediaType:f.getWamMediaType(),messageType:f.getWamMessageType()});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat before system messages ",""])),a.id.toLogString());g=(yield c("WAWebEmptyChatSystemMsg")(f,a));if(!g){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat before ephemeral system messages"])));e=d("WAWebBizShowOrderEphemeralSystemAction").getMaybeSystemMsgForOrderEphemeralExemption(f,a);e&&(g=[e])}d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["_addAndSendMsgToChat after system messages"])));e=g?[].concat(g,[b]):[b];(h=f.wamMessageSendPerfReporter)==null||h.startSavedStage();return d("WAWebDBProcessMessage").storeMessages(e,a.id).then(function(a){(a=f.wamMessageSendPerfReporter)==null||a.postSavedStage();if(f.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE){var b=parseInt(f.inviteCodeExp,10),c=f.from.isLid()?d("WAWebLidMigrationUtils").toLid(f.to):f.to;if(!c){a=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[group-invites] isLidMigrated: ",""])),a);a="[group-invites] failed to get lid mapping when revoking existing duplicate group invite";d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["",""])),a).sendLogs(a);return}return d("WAWebDBRevokeInviteV4").revokeGroupInviteV4(f.from.toString(),c.toString(),f.inviteGrp,b).then(function(){return d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(f.id.toString(),{id:f.id.toString(),from:f.from.toString(),to:c.toString(),groupId:f.inviteGrp,expiration:b,expired:d("WATimeUtils").unixTime()>=b})})}}).then(function(){return f.waitForPrep().then(function(){return f})})}throw new(d("WAWebMiscErrors").ModelCreateError)("Msg",b)});return function(a){return e.apply(this,arguments)}}());var p=r(a,e,g);e=f?p.then(f).then(function(){return p}):p;f=s(a,e);return[p,f]}function r(a,b,c){return a.addQueue.enqueue(b).then(function(b){var e;d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.SendMessage);(e=b.wamMessageSendPerfReporter)==null||e.startRenderedStage();c&&a.msgs.add(c);return a.msgs.add(b)[0]}).then(function(b){var c;a.createdLocally=!1;(c=b.wamMessageSendPerfReporter)==null||c.postRenderedStage();return b})}function s(a,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield a.sendQueue.enqueue(c));return d("WAWebSendMsgRecordAction").sendMsgRecord(b)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.addAndSendMsgToChat=a;g.resendMsgToChat=e;g.addMsgToChat=f}),98);
__d("WAWebBlocklistUtils",["WAWebABProps","WAWebBlockContants","WAWebSpamConstants","WAWebWamEnumBlockEntryPoint"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("rbi_pre_tick_report")}function a(a){if(h())return!0;switch(a){case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardBlock:case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardBlockSuspicious:case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsBlock:case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsBlockSuspicious:case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReport:case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReportSuspicious:case d("WAWebBlockContants").BlockEntryPoint.OneToOneOldSpamBannerBlock:return!0;default:return!1}}function b(){return d("WAWebABProps").getABPropConfigValue("report_block_improvements_for_groups_enabled")}function c(a){switch(a){case d("WAWebBlockContants").BlockEntryPoint.OneToOneOldSpamBannerBlock:case d("WAWebBlockContants").BlockEntryPoint.BizOldSpamBannerBlock:return d("WAWebSpamConstants").SpamFlow.OneToOneOldSpamBannerBlock;case d("WAWebBlockContants").BlockEntryPoint.BizSpamBannerBlock:return d("WAWebSpamConstants").SpamFlow.BizSpamBannerBlock;case d("WAWebBlockContants").BlockEntryPoint.ChatListBlock:return d("WAWebSpamConstants").SpamFlow.ChatListBlock;case d("WAWebBlockContants").BlockEntryPoint.ChatListNoInsubBlock:return d("WAWebSpamConstants").SpamFlow.ChatListNoInsubBlock;case d("WAWebBlockContants").BlockEntryPoint.NotificationBlock:return d("WAWebSpamConstants").SpamFlow.NotificationBlock;case d("WAWebBlockContants").BlockEntryPoint.OverflowMenuBlock:return d("WAWebSpamConstants").SpamFlow.OverflowMenuBlock;default:return d("WAWebSpamConstants").SpamFlow.Block}}function e(a){switch(a){case d("WAWebSpamConstants").SpamFlow.OverflowMenuReport:return d("WAWebBlockContants").BlockEntryPoint.OverflowMenuReport;case d("WAWebSpamConstants").SpamFlow.MediaViewer:return d("WAWebBlockContants").BlockEntryPoint.MediaViewer;case d("WAWebSpamConstants").SpamFlow.MessageMenu:return d("WAWebBlockContants").BlockEntryPoint.MessageMenu;case d("WAWebSpamConstants").SpamFlow.AccountInfoReport:return d("WAWebBlockContants").BlockEntryPoint.AccountInfoReport;case d("WAWebSpamConstants").SpamFlow.OneToOneChatSpamBannerReport:return d("WAWebBlockContants").BlockEntryPoint.OneToOneChatSpamBannerReport;case d("WAWebSpamConstants").SpamFlow.ChatFmxCardSafetyToolsReport:return d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReport;case d("WAWebSpamConstants").SpamFlow.ChatFmxCardSafetyToolsReportSuspicious:return d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReportSuspicious;default:return null}}function f(a){if(a==null)return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.OTHER;switch(a){case d("WAWebBlockContants").BlockEntryPoint.OneToOneOldSpamBannerBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ONE_TO_ONE_OLD_SPAM_BANNER_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.OneToOneSpamBannerBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ONE_TO_ONE_SPAM_BANNER_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.AccountInfo:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ACCOUNT_INFO;case d("WAWebBlockContants").BlockEntryPoint.AccountInfoReport:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ACCOUNT_INFO_REPORT;case d("WAWebBlockContants").BlockEntryPoint.BizOldSpamBannerBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.BIZ_OLD_SPAM_BANNER_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.BizSpamBannerBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.BIZ_SPAM_BANNER_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.BlockHeaderChat:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.BLOCK_HEADER_CHAT;case d("WAWebBlockContants").BlockEntryPoint.CallLog:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CALL_LOG;case d("WAWebBlockContants").BlockEntryPoint.Chat:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT;case d("WAWebBlockContants").BlockEntryPoint.ChatListBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_LIST_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.ChatListContextMenuBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_LIST_CONTEXT_MENU_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.ChatListNoInsubBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_LIST_NOINSUB_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.NotificationBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.NOTIFICATION_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.OverflowMenuBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.OVERFLOW_MENU_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.OverflowMenuReport:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.OVERFLOW_MENU_REPORT;case d("WAWebBlockContants").BlockEntryPoint.Profile:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.PROFILE;case d("WAWebBlockContants").BlockEntryPoint.TriggeredBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.TRIGGERED_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.BlockList:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.BLOCK_LIST;case d("WAWebBlockContants").BlockEntryPoint.MediaViewer:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.MEDIA_VIEWER;case d("WAWebBlockContants").BlockEntryPoint.MessageMenu:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.MESSAGE_MENU;case d("WAWebBlockContants").BlockEntryPoint.OneToOneChatSpamBannerReport:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ONE_TO_ONE_SPAM_BANNER_REPORT;case d("WAWebBlockContants").BlockEntryPoint.StatusPostReport:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.STATUS_POST_REPORT;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardBlockSuspicious:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_BLOCK_SUSPICIOUS;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsBlock:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_SAFETY_TOOLS_BLOCK;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsBlockSuspicious:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_SAFETY_TOOLS_BLOCK_SUSPICIOUS;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReport:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_SAFETY_TOOLS_REPORT;case d("WAWebBlockContants").BlockEntryPoint.ChatFmxCardSafetyToolsReportSuspicious:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.CHAT_FMX_CARD_SAFETY_TOOLS_REPORT_SUSPICIOUS;case d("WAWebBlockContants").BlockEntryPoint.OneToOneBlockedChatComposer:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.ONE_TO_ONE_BLOCKED_CHAT_COMPOSER;default:return d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.OTHER}}function i(a){switch(a){case d("WAWebBlockContants").BlockEntryPoint.Profile:return 1;case d("WAWebBlockContants").BlockEntryPoint.ChatListBlock:return 2;case d("WAWebBlockContants").BlockEntryPoint.BlockList:return 1;default:return null}}function j(a){switch(a){case d("WAWebBlockContants").BlockEntryPoint.Profile:return 3;case d("WAWebBlockContants").BlockEntryPoint.ChatListBlock:return 4;case d("WAWebBlockContants").BlockEntryPoint.BlockList:return 5;default:return null}}g.isReportPreCheckedForOneToOneChats=a;g.isRBIForGroupsEnabled=b;g.getSpamFlowFromBlockEntryPoint=c;g.getBlockEntryPointFromSpamFlow=e;g.getBlockEventMetricFromBlockEntryPoint=f;g.getBlockPsaRemoveEntryPointFromBlockEntryPoint=i;g.getUnblockPsaRemoveEntryPointFromBlockEntryPoint=j}),98);
__d("WAWebReportGatingUtils",["WAWebABProps","WAWebChatGetters","WAWebMsgGetters","WAWebNewsletterGatingUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){return d("WAWebABProps").getABPropConfigValue("private_osa_reporting_enabled")}function a(){return d("WAWebABProps").getABPropConfigValue("private_messaging_uk_osa_enabled")}function b(a,b){var c=!1;a!=null?c=d("WAWebChatGetters").getIsNewsletter(a):b!=null&&(c=d("WAWebMsgGetters").getIsNewsletterMsg(b));return c===!0?d("WAWebNewsletterGatingUtils").isNewsletterAusOSAReportingEnabled():h()}g.isAusOSAReportingEnabled=h;g.isUKOSAReportingEnabled=a;g.isPostReportingAusOSAModalEnabled=b}),98);
__d("WAWebSendSpamChatAction",["fbt","Promise","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebBlockContactAction","WAWebBlocklistUtils","WAWebChatGetters","WAWebExitGroupAction","WAWebFrontendMsgGetters","WAWebMiscErrors","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingLoggingEvents","WAWebModalManager","WAWebMsgGetters","WAWebMsgType","WAWebNoop","WAWebReportGatingUtils","WAWebReportSpamJob","WAWebSendClearChatAction","WAWebSpamConstants","WAWebStateUtils","WAWebToastManager","gkx","react","requireDeferred"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p=o||c("react"),q=c("requireDeferred")("WAWebAusOSAReportModalTrigger").__setRef("WAWebSendSpamChatAction");function a(a){var b=a.spamFlow,c=a.chat,e=a.msg;a=a.msgType;if(d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled()){d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingReportVerificationEvent({chat:c,spamFlow:b});var f=d("WAWebBlocklistUtils").getBlockEventMetricFromBlockEntryPoint(d("WAWebBlocklistUtils").getBlockEntryPointFromSpamFlow(b));d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingUserReportEvent({chat:c,blockEntryPointMetric:f})}return v({chat:c,spamFlow:b,msg:e,msgType:a})}function e(a,b){return w(d("WAWebStateUtils").unproxy(a),b)}function f(a,b){b===void 0&&(b=d("WAWebSpamConstants").SpamFlow.MessageMenu);a=d("WAWebStateUtils").unproxy(a);return v({chat:d("WAWebFrontendMsgGetters").getChat(a),spamFlow:b,msg:a})}function r(a,b){b===void 0&&(b=d("WAWebSpamConstants").SpamFlow.MessageMenu);return z(d("WAWebStateUtils").unproxy(a),b)}function s(a){var b=a.chat;a=a.spamFlow;return x(d("WAWebStateUtils").unproxy(b),a)}function t(a,b){return y(d("WAWebStateUtils").unproxy(a),b)}function u(){return{couldntSendReportMsg:h._(/*BTDS*/"Couldn't send report"),sendingReportMsg:h._(/*BTDS*/"Sending report"),reportSentMsg:h._(/*BTDS*/"Report sent"),reportSentMsgV2:h._(/*BTDS*/"Thank you for reporting."),reportNotSentMsg:h._(/*BTDS*/"Report not sent"),tryAgainMsg:h._(/*BTDS*/"Try again.")}}function v(a){var e=a.spamFlow,f=a.chat,g=a.msg,h=a.toastId,j=h===void 0?d("WAWebActionToast.react").genId():h,k=a.msgType;h=u();a=h.sendingReportMsg;var l=h.couldntSendReportMsg,m=h.tryAgainMsg,o=h.reportSentMsgV2,q=f!=null?d("WAWebStateUtils").unproxy(f):f,r=(h=q==null?void 0:q.promises)!=null?h:null;if(r!=null&&r.sendSpamReport)return r.sendSpamReport;var s;if(k===d("WAWebMsgType").MSG_TYPE.STATUS&&g!=null&&!d("WAWebMsgGetters").getIsGroupStatus(g))s=d("WAWebReportSpamJob").reportStatus(e,g).then(function(a){var b;if((a==null?void 0:a.errorCode)!=null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);if((a==null||(b=a.reportIdMixin)==null?void 0:b.reportId)!=null)return a.reportIdMixin.reportId});else{if(!r)return new(n||(n=b("Promise")))(c("WAWebNoop"));g!=null?s=r.sendSpamReport=d("WAWebReportSpamJob").reportSpam(d("WAWebFrontendMsgGetters").getChat(g),e,g).then(function(a){var b;if((a==null?void 0:a.errorCode)!=null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);if((a==null||(b=a.reportIdMixin)==null?void 0:b.reportId)!=null)return a.reportIdMixin.reportId}):q!=null&&(s=r.sendSpamReport=d("WAWebReportSpamJob").reportSpam(q,e).then(function(a){var b;if((a==null?void 0:a.errorCode)!=null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);if((a==null||(b=a.reportIdMixin)==null?void 0:b.reportId)!=null)return a.reportIdMixin.reportId}))}if(!s)return new(n||(n=b("Promise")))(c("WAWebNoop"));f=new(d("WAWebActionToast.react").ActionType)(a);h=s.then(function(a){return a!=null&&g!=null&&d("WAWebReportGatingUtils").isPostReportingAusOSAModalEnabled(q,g)?null:new(d("WAWebActionToast.react").ActionType)(o)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){return!c("gkx")("26258")&&a.statusCode===548?new(d("WAWebActionToast.react").ActionType)(a.message):new(d("WAWebActionToast.react").ActionType)(l)}))["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["reportSpam dropped"]))).devConsole(a);return new(d("WAWebActionToast.react").ActionType)(l,{actionText:m,actionHandler:function(){return v({chat:q,spamFlow:e,msg:g,toastId:j,msgType:k})}})});d("WAWebToastManager").ToastManager.open(p.jsx(d("WAWebActionToast.react").ActionToast,{id:j,initialAction:f,pendingAction:h}));return s["finally"](function(){r!=null&&r.sendSpamReport&&(r.sendSpamReport=null)})}function w(a,c,e){c===void 0&&(c=!1);e===void 0&&(e=d("WAWebActionToast.react").genId());var f=a.promises,g=a.notSpam;if(g)return(n||(n=b("Promise"))).resolve();if(f.sendNotSpam)return f.sendNotSpam;g=f.sendNotSpam=d("WAWebReportSpamJob").sendNotSpamJob(a);if(c){var i=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Marking as not spam")),k=g.then(function(){return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Marked as not spam"))})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(){return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mark as not spam"))}))["catch"](function(b){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendNotSpam dropped"]))).devConsole(b);return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mark as not spam"),{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return w(a,c,e)}})});d("WAWebToastManager").ToastManager.open(p.jsx(d("WAWebActionToast.react").ActionToast,{id:e,initialAction:i,pendingAction:k}))}return g.then(function(){a.set({notSpam:!0});if(d("WAWebChatGetters").getIsGroup(a)){var b;(b=a.groupMetadata)==null||b.set({trusted:!0})}})["finally"](function(){a.isTrusted(),f.sendNotSpam=null})}function x(a,c){var e=a.promises,f=a.contact;if(e.reportSpamBlockClear)return e.reportSpamBlockClear;if(d("WAWebChatGetters").getIsGroup(a))return(n||(n=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)());var g=d("WAWebBlocklistUtils").getBlockEntryPointFromSpamFlow(c);a=v({chat:a,spamFlow:c});e.reportSpamBlockClear=a.then(function(){return d("WAWebBlockContactAction").blockContact({contact:f,blockEntryPoint:g})})["finally"](function(){e.reportSpamBlockClear=null});return e.reportSpamBlockClear}function y(a,e){var f=a.promises,g=a.isReadOnly;if(f.reportSpamExitClear)return f.reportSpamExitClear;if(!d("WAWebChatGetters").getIsGroup(a))return(n||(n=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)());e=v({chat:a,spamFlow:e});if(g)g=e;else{var h=d("WAWebExitGroupAction").sendExitGroup(a);g=(n||(n=b("Promise"))).all([e,h])}f.reportSpamExitClear=g.then(function(){return d("WAWebSendClearChatAction").sendClear(a,!1)})["catch"](c("WAWebNoop"))["finally"](function(){f.reportSpamExitClear=null});return f.reportSpamExitClear}function z(a,b){var c=a.senderObj,e=d("WAWebFrontendMsgGetters").getChat(a),g=e.promises;if(g.reportMessageBlock)return g.reportMessageBlock;var h=d("WAWebBlocklistUtils").getBlockEntryPointFromSpamFlow(b);e=v({chat:e,spamFlow:b,msg:a});g.reportMessageBlock=e.then(function(a){d("WAWebModalManager").ModalManager.close();a!=null&&d("WAWebReportGatingUtils").isAusOSAReportingEnabled()&&q.load().then(function(b){return b.WAWebAusOSAReportModalTrigger(a)})["catch"](function(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error opening Aus OSA modal while reporting a message: ",""])),a).sendLogs("report-message-aus-osa-error")});return d("WAWebBlockContactAction").blockContact({contact:c,blockEntryPoint:h})["catch"](function(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Error in blocking while reporting a message: ",""])),a).sendLogs("report-block-message-error")})})["catch"](function(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Error while reporting and blocking a message : ",""])),a).sendLogs("report-block-message-error")})["finally"](function(){g.reportMessageBlock=null});return g.reportMessageBlock}g.sendReport=a;g.sendNotSpam=e;g.sendMessageReport=f;g.sendMessageReportBlock=r;g.sendReportBlock=s;g.sendSpamExitClear=t}),226);
__d("WAWebSendTcTokenChatAction",["WALogger","WATimeUtils","WAWebChatCollection","WAWebLidMigrationUtils","WAWebSchemaChat","WAWebSetPrivacyTokensJob","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isUserNotPSA()||a.isBot())return;var b=d("WAWebChatCollection").ChatCollection.get(a);if(b==null)return;if(!d("WAWebTrustedContactsUtils").shouldSendNewToken(b.tcTokenSenderTimestamp))return;try{var c=d("WATimeUtils").unixTime(),e=d("WAWebLidMigrationUtils").toPn(a);if(e==null)return;yield d("WAWebSetPrivacyTokensJob").issuePrivacyToken(e,[d("WAWebSetPrivacyTokensJob").TokenType.TrustedContact],c);e={tcTokenSenderTimestamp:c};b.set(e);yield d("WAWebSchemaChat").getChatTable().merge(a.toString(),e)}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendTcToken failed - ",""])),a).verbose().devConsole(a).sendLogs("send-tc-token-failed")}});return i.apply(this,arguments)}g.sendTcToken=a}),98);
__d("WAWebSendTextMsgChatAction",["WAJobOrchestratorTypes","WALogger","WAWebABProps","WAWebAppTracker","WAWebBizAgentAction","WAWebBizBotTosUtils","WAWebBotGating","WAWebBotMessageSecret","WAWebBotProfileCollection","WAWebBotSystemMsg","WAWebChatGetters","WAWebDBProcessMessage","WAWebEmptyChatSystemMsg","WAWebGetEphemeralFieldsMsgActionsUtils","WAWebLidMigrationFrontendUtils","WAWebLimitSharingPropMappingUtils","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMessagingGatingUtils","WAWebMsgDataUtils","WAWebMsgInfoUtils","WAWebMsgModel","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebOrchestratorNonPersistedJob","WAWebPresenceChatAction","WAWebPrivacyMode_WORKER_INCOMPATIBLE","WAWebProductCatalogLogEvents","WAWebQuestionsGatingUtils","WAWebSendMsgRecordAction","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c={});a=d("WAWebStateUtils").unproxy(a);b=(yield l(a,b,c));if(!b)return;yield d("WAWebBizBotTosUtils").maybeShowBizBot1pTos(a);return n(a,b)});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e===void 0&&(e={});b=(b||"").trim();if(b==="")return null;var f=e,g=f.linkPreview,j=f.quotedMsg,k=f.mentionedJidList,l=f.groupMentions,m=f.quotedMsgAdminGroupJid,n=f.quotedMsgAdminGroupSubject,o=f.quotedMsgAdminParentGroupJid,p=f.selectedId,q=f.selectedIndex,r=f.selectedCarouselCardIndex,s=f.ctwaContext,t=f.encryptedCommentFields,u=f.isWamoSub,v=f.paymentLinkMetadata,w=f.isQuestion;f=f.questionReplyQuotedMessage;d("WAWebPresenceChatAction").clearPresence(a);var x;if(j)x=j.msgContextInfo(a.id);else if(m!=null&&n!=null&&o!=null)x={quotedRemoteJid:m,quotedGroupSubject:n,quotedParentGroupJid:o};else if(m!=null)x={quotedRemoteJid:m};else if(w===!0)if(d("WAWebQuestionsGatingUtils").isQuestionSenderEnabledForMsgType(a,d("WAWebMsgType").MSG_TYPE.CHAT))x={isQuestion:!0};else{d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[questions] Unsupported question message type: ",""])),d("WAWebMsgType").MSG_TYPE.CHAT).tags("questions").devConsole(a,b,e).sendLogs("questions-unsupported-message-type-"+d("WAWebMsgType").MSG_TYPE.CHAT);return null}else if(f)if(d("WAWebQuestionsGatingUtils").isQuestionReplySenderEnabledForMsgType(a,d("WAWebMsgType").MSG_TYPE.CHAT))x={questionReplyQuotedMessage:f};else{d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[questions] Unsupported question reply message type: ",""])),d("WAWebMsgType").MSG_TYPE.CHAT).tags("questions").devConsole(a,b,e).sendLogs("questions-unsupported-reply-message-type-"+d("WAWebMsgType").MSG_TYPE.CHAT);return null}var y;a.limitSharing!=null&&(y=a.limitSharing,y.initiatedByMe=d("WAWebUserPrefsMeUser").isMeAccount(y.initiatedBy),c("WAWebWid").isGroup(a.id)&&typeof y.trigger==="string"&&(y.trigger=d("WAWebLimitSharingPropMappingUtils").getLimitSharingTriggerFromGroupSettingsChange(y.trigger)),delete y.initiatedBy);n=babelHelpers["extends"]({},g);o=babelHelpers["extends"]({},n,x,{mentionedJidList:k,groupMentions:l,ctwaContext:s,body:b,subtype:Object.keys(n).length>0?"url":null,urlText:a.urlText,urlNumber:a.urlNumber,botMsgBodyType:e.botMsgBodyType},yield d("WAWebMsgDataUtils").genOutgoingMsgData(a,"chat"),{paymentLinkMetadata:v,limitSharing:y});a.urlText&&(a.urlText=void 0);a.urlNumber&&(a.urlNumber=void 0);q!=null&&(o.type="template_button_reply",o.selectedId=p,o.selectedIndex=q,o.selectedCarouselCardIndex=r);o.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&Object.assign(o,d("WAWebGetEphemeralFieldsMsgActionsUtils").getEphemeralFields(a));m=d("WAWebPrivacyMode_WORKER_INCOMPATIBLE").getPrivacyModeFromModel(a.id);m!=null&&(o.privacyModeWhenSent=m);o.agentId=d("WAWebBizAgentAction").getAgentId(o);if(d("WAWebBotGating").isBotEnabled()){w=k==null?void 0:k.find(function(a){return a.isBot()});if(w!=null&&w.isBot()){o.invokedBotWid=w;f=j==null?void 0:j.botTargetSenderJid;f!=null&&!d("WAWebUserPrefsMeUser").isMeAccount(f)&&(o.botTargetSenderJid=j==null?void 0:j.botTargetSenderJid)}}g=a.isCAGAdmin();l=o.subtype==="url"&&d("WAWebABProps").getABPropConfigValue("web_youtube_rcat_chat_generation_enabled");b=Boolean(d("WAWebBotGating").isBotEnabled()&&((s=o.invokedBotWid)==null?void 0:s.isBot()));n=Boolean(d("WAWebBotGating").isBotEnabled()&&o.to.isBot());e=d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(o.type,o.subtype);(g||l||b||n||e)&&(o.messageSecret=self.crypto.getRandomValues(new Uint8Array(32)));b&&(o.botMessageSecret=(yield d("WAWebBotMessageSecret").genBotMsgSecretFromMsgSecret(o.messageSecret)));if(b||n){var z;b?z=o.invokedBotWid:n&&(z=o.to);if(z!=null){p=(v=d("WAWebBotProfileCollection").BotProfileCollection.get(z))==null?void 0:v.personaId;p!=null&&(o.botPersonaId=p)}}j&&j.type===d("WAWebMsgType").MSG_TYPE.PRODUCT&&d("WAWebProductCatalogLogEvents").logProductMessageBusinessSend(j,j.sessionId);t&&(o.type=d("WAWebMsgType").MSG_TYPE.COMMENT,o.encIv=t==null?void 0:t.encIv,o.encPayload=t==null?void 0:t.encPayload,o.targetMessageKey=t==null?void 0:t.targetMessageKey);u===!0&&d("WAWebChatGetters").getIsNewsletter(a)&&d("WAWebNewsletterGatingUtils").isWamoSubCreatorExperienceSupported()&&(o.isWamoSub=!0);return o});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f,g;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["addAndSendTextMsg chat: ",""])),a.id.toLogString());yield d("WAWebLidMigrationFrontendUtils").validateMissingAccountLid(a,e,"addAndSendTextMsg");var h=new(d("WAWebMsgModel").Msg)(e),i=d("WAWebBotSystemMsg").getMaybeSysMsgForBotInvoke(h,a);f=[].concat((f=(yield c("WAWebEmptyChatSystemMsg")(h,a)))!=null?f:[],[i]).filter(Boolean);g=Boolean((g=a.groupMetadata)==null?void 0:g.isLidAddressingMode);g=d("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(a.id,d("WAWebWamMsgUtils").msgIsLid(e,a.id,g));h.wamMessageSendReporter=new(d("WAWebMessageSendReporter").MessageSendReporter)(h,g);h.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:h.to,mediaType:h.getWamMediaType(),messageType:h.getWamMessageType()});d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.SendMessage);(g=h.wamMessageSendPerfReporter)==null||g.startRenderedStage();f.length>0&&a.msgs.add(f);a.msgs.add(h);(g=h.wamMessageSendPerfReporter)==null||g.postRenderedStage();a.createdLocally=!1;var k=f.length>0?[].concat(f,[e]):[e];return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;(b=h.wamMessageSendPerfReporter)==null||b.startSavedStage();yield d("WAWebDBProcessMessage").storeMessages(k,a.id);i&&(yield a.updateBotInvokeSystemMsgCreated());(b=h.wamMessageSendPerfReporter)==null||b.postSavedStage();b=(yield d("WAWebSendMsgRecordAction").sendMsgRecord(h));return b}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()});return o.apply(this,arguments)}g.sendTextMsgToChat=a;g.createTextMsgData=l;g.addAndSendTextMsg=n}),98);
__d("WAWebSendUnstarAllChatAction",["fbt","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebChatCollection","WAWebChatSendStarMsgsBridge","WAWebStarredMsgCollection","WAWebStateUtils","WAWebToastManager","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react");function a(a,b){return l(a,b?d("WAWebStateUtils").unproxy(b):b)}function l(a,b){var c=b?b.promises:d("WAWebChatCollection").ChatCollection.promises,e=b?b.id:void 0;if(c.sendUnstarAll)return c.sendUnstarAll;e=c.sendUnstarAll=d("WAWebChatSendStarMsgsBridge").sendUnstarAll(a,e);var f=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Unstarring all messages")),g=e.then(function(){return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"All messages unstarred"))})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){if(a.statusCode>=400)return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't unstar all messages"))}))["catch"](function(c){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendUnstarAll dropped"]))).devConsole(c);return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't unstar all messages"),{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return l(a,b)}})});d("WAWebToastManager").ToastManager.open(k.jsx(d("WAWebActionToast.react").ActionToast,{initialAction:f,pendingAction:g}));return e.then(function(){a.forEach(function(a){a.set("star",!1)}),b?d("WAWebStarredMsgCollection").removeStarredMsgs(a):(d("WAWebStarredMsgCollection").AllStarredMsgsCollection.reset(),d("WAWebChatCollection").ChatCollection.forEach(function(a){a.starredMsgs&&a.starredMsgs.reset()}))})["finally"](function(){c.sendUnstarAll=null})}g.unstarAllMessages=a}),226);
__d("WAWebUpdateDraftMessageChatJob",["WAAbortError","WAJobOrchestratorTypes","WAWebDBChatSerialization","WAWebDBUpdateChatTable","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatId,c=a.draftMessage;a=a.abortSignal;b=d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateDraftMessageChat",function(a){if(a.abortSignal.aborted)throw new(d("WAAbortError").AbortError)();return d("WAWebDBUpdateChatTable").updateChatTable(a.chatId,d("WAWebDBChatSerialization").serializeChat({draftMessage:a.draftMessage}))},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({chatId:b,draftMessage:c,abortSignal:a});yield b});return h.apply(this,arguments)}g.updateDraftMessageChat=a}),98);
__d("WAWebUpdateDraftMessageChatAction",["WAWebChatCollection","WAWebNewsletterCollection","WAWebUpdateDraftMessageChatJob","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a,b){var e=c("WAWebWid").isNewsletter(a)?c("WAWebNewsletterCollection").get(a):d("WAWebChatCollection").ChatCollection.get(a),f=new AbortController(),g=d("WAWebUpdateDraftMessageChatJob").updateDraftMessageChat({chatId:a,draftMessage:b,abortSignal:f.signal});g["finally"](function(){if(e){var a;(e==null||(a=e.promises.updateDraftMessage)==null?void 0:a.promise)===g&&(e.promises.updateDraftMessage=null)}});if(e){a=e.promises;a.updateDraftMessage!=null&&a.updateDraftMessage.abortController.abort();e.draftMessage=b;e.promises.updateDraftMessage={promise:g,abortController:f}}return g}g.updateDraftMessageChat=a}),98);
__d("WAWebUpdateLastAddOnPreviewChatAction",["WAWebChatCollection","WAWebMsgKey","WAWebNewsletterCollection","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){a.forEach(function(a,b){b=c("WAWebWid").isNewsletter(b)?c("WAWebNewsletterCollection").get(b):d("WAWebChatCollection").ChatCollection.get(b);if(b==null)return;b.set({chatlistPreview:a,lastReactionPreview:void 0})})}function b(a){var b=new Set(a.map(function(a){return c("WAWebMsgKey").fromString(a).remote.toString()}));b.forEach(function(b){var e;e=(e=d("WAWebChatCollection").ChatCollection.get(b))!=null?e:c("WAWebNewsletterCollection").get(b);if(e==null)return;b=(b=e.chatlistPreview)==null?void 0:b.parentMsgKey;b!=null&&a.includes(b)&&e.unset(["chatlistPreview","lastReactionPreview"])})}g.updateModelsForLastAddOnPreview=a;g.deleteModelsForLastAddOnPreview=b}),98);
__d("WAWebUpdateUnreadChatAction",["fbt","Promise","WAFilteredCatch","WALogger","WAShiftTimer","WAWebABProps","WAWebActionToast.react","WAWebApiChat","WAWebBackendErrors","WAWebChatGetters","WAWebChatSeenBridge","WAWebCmd","WAWebConstantsDeprecated","WAWebCurrentUser","WAWebDBUpdateChatTable","WAWebNoop","WAWebPromiseQueue","WAWebSendReadReceiptJob","WAWebStateUtils","WAWebStreamModel","WAWebToastManager","WAWebUim","asyncToGeneratorRuntime","err","gkx","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=p||c("react");function a(a,b,c){c===void 0&&(c=!0);return v(d("WAWebStateUtils").unproxy(a),b,c)}function e(){var a=null,c=new(d("WAShiftTimer").ShiftTimer)(function(b){var c=b.chat_;b=b.afterAvailable;void s(c,b);a=null});return function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){if(a!=null){var f=a,g=f[0];f=f[1];var h=g.id.toString(),i=b.id.toString();h!==i&&(c.cancel(),void s(g,f),a=null)}if(!c.isScheduled()){h=d("WAWebABProps").getABPropConfigValue("web_resume_optimized_read_receipt_send_interval");c.onOrAfter(h,{chat_:b,afterAvailable:e})}a=[b,e]});return function(a,b){return e.apply(this,arguments)}}()}var r=e();e=function(a,b){b===void 0&&(b=!0);return!d("WAWebCmd").Cmd.isOfflineDeliveryEnd?r(a,b):s(a,b)};function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!0);if(d("WAWebCurrentUser").isEmployee()&&d("WAWebUim").isCmdPressed()){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sendSeen: skip since cmd is pressed"])));return}a=d("WAWebStateUtils").unproxy(a);yield (o||(o=b("Promise"))).all([x(a,c),I(a,c)])["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["sendSeen: got status ",""])),a.status)}))});return t.apply(this,arguments)}function f(a,b,c){return A(d("WAWebStateUtils").unproxy(a),b,c)}function u(a){C(d("WAWebStateUtils").unproxy(a))}function v(a,e,f,g){g===void 0&&(g=d("WAWebActionToast.react").genId());!e?a.markedUnread=!1:a.active&&(a.markedUnread=!0);var j=a.promises;if(j.markUnread)return j.markUnread;var k=j.markUnread=e?y(a):(o||(o=b("Promise"))).all([x(a),I(a)]),l=e?new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Marking as unread")):new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Marking as read")),m=k.then(function(){var b=e?h._(/*BTDS*/"Marked as unread"):h._(/*BTDS*/"Marked as read");return!f?new(d("WAWebActionToast.react").ActionType)(b):new(d("WAWebActionToast.react").ActionType)(b,{actionText:h._(/*BTDS*/"Undo"),actionHandler:function(){return v(a,!e,f,g)}})})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){if(a.status>=400)return e?new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mark chat as unread.")):new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mark chat as read."));throw c("err")("invalid response status")}))["catch"](function(){var b=e?h._(/*BTDS*/"Couldn't mark chat as unread."):h._(/*BTDS*/"Couldn't mark chat as read.");return!f?new(d("WAWebActionToast.react").ActionType)(b):new(d("WAWebActionToast.react").ActionType)(b,{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return v(a,e,f,g)}})});d("WAWebToastManager").ToastManager.open(q.jsx(d("WAWebActionToast.react").ActionToast,{id:g,initialAction:l,pendingAction:m}));return k.then(c("WAWebNoop"))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["markUnread: got status ",""])),a.status)}))["finally"](function(){j.markUnread=null})}function w(a){c("gkx")("26258")||d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[update-unread]: ",""])),a)}function x(a,e){e===void 0&&(e=!0);w("sendSeen: start");if(a.markedUnread||a.unreadCount===0){w("markedUnread: "+String(a.markedUnread));w("unreadCount: "+a.unreadCount);w("sendSeen: end-1");return(o||(o=b("Promise"))).resolve()}if(!d("WAWebStreamModel").Stream.available&&e){w("stream unavailable");a.listenToOnce(d("WAWebStreamModel").Stream,"change:available",function(){return x(a)});w("sendSeen: end-2");return(o||(o=b("Promise"))).resolve()}w("stream available");w("unreadCount: "+a.unreadCount);w("pendingSeenCount: "+a.pendingSeenCount);var f=a.unreadCount-a.pendingSeenCount;w("unreadCountDelta: "+f);e=a.unreadCount===-1&&f===-1;if(f<=0&&!e){w("sendSeen: end-3");return(o||(o=b("Promise"))).resolve()}a.disableUnreadAnchor=!0;a.pendingSeenCount=a.unreadCount;w("pendingSeenCount set to: "+a.unreadCount);var g=function(){a.pendingSeenCount-=f,w("pendingSeenCount set to "+a.pendingSeenCount),a.pendingSeenCount<0&&(d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["models:chat:sendSeen unread "," pending: "," delta: ",""])),a.unreadCount,a.pendingSeenCount,f),a.pendingSeenCount=0)};e=c("gkx")("26258")?a.getLastMsgKeyForAction():a.lastReceivedKey;return d("WAWebChatSeenBridge").sendConversationSeen(a,e,f).then(function(){D(a,f)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){g();return(o||(o=b("Promise"))).reject(a)})).then(function(){w("sendSeen: end-4")})}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.getLastMsgKeyForAction();try{yield d("WAWebChatSeenBridge").sendConversationUnseen(a.id,c),u(a)}catch(c){return d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(c){a.markedUnread=!1;return(o||(o=b("Promise"))).reject(c)})(c)}});return z.apply(this,arguments)}function A(a,b,c){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!1);w("markSeen: start - "+String(c));var f=null;c!=null?c>0&&c<=a.unreadCount?f=a.unreadCount-c:c===-1&&(a.unreadCount<=0&&(f=0)):f=0;var g=f==null?(o||(o=b("Promise"))).resolve():d("WAWebChatSeenBridge").markConversationSeen(a.id,f);yield g;if(c!=null&&e){g=a.pendingSeenCount-c;a.pendingSeenCount=Math.max(0,g);w("pendingSeenCount set to "+a.pendingSeenCount)}f!=null&&(a.unreadCount=f,w("unreadCount set to "+f));a.unreadMsgAnchor=void 0;a.markedUnread=!1;a.unreadDividerOffset=0;w("markSeen: end")});return B.apply(this,arguments)}function C(a){(a.unreadCount===0||a.unreadCount===c("WAWebConstantsDeprecated").MARKED_AS_UNREAD)&&(a.active&&(a.markedUnread=!0),d("WAWebChatSeenBridge").markConversationUnseen(a.id).then(function(){a.unreadCount=c("WAWebConstantsDeprecated").MARKED_AS_UNREAD}))}function D(a,b,c){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!0);var e=(yield d("WAWebApiChat").getChatMeta(a.id));e=e.unreadCount;w("updateUnreadCount: old "+a.unreadCount+", new "+e);a.unreadCount=e;a.unreadDividerOffset=0;a.unreadMsgAnchor=void 0;a.markedUnread=!1;if(c){e=a.pendingSeenCount-b;a.pendingSeenCount=Math.max(0,e)}});return E.apply(this,arguments)}function F(a){if(d("WAWebChatGetters").getIsGroup(a)){(a=a.groupMetadata)==null||a.unreadMentionMetadata.reset()}}function G(a){c("gkx")("26258")||d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/send-seen] ",""])),a)}var H=new(d("WAWebPromiseQueue").PromiseQueue)();function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!0);if(a.unreadEditTimestampMs==null)return;G("sendSeen: start - "+String(a.unreadEditTimestampMs));if(!d("WAWebStreamModel").Stream.available&&c){a.listenToOnce(d("WAWebStreamModel").Stream,"change:available",function(){return I(a)});G("sendSeen: end - stream unavailable");return}var e=a.unreadEditTimestampMs;yield H.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(a.unreadEditTimestampMs==null){G("sendSeen: end - no unread edits");return}yield d("WAWebSendReadReceiptJob").markEditedMsgsRead(a.id,{trusted:a.trusted});G("sendSeen: marked edit as read");if(e!==a.unreadEditTimestampMs){G("sendSeen: end - has new unread edits");return}a.unreadEditTimestampMs=null;d("WAWebDBUpdateChatTable").updateChatTable(a.id,{unreadEditTimestampMs:null});G("sendSeen: end - all edits are marked as read")}))});return J.apply(this,arguments)}g.markUnread=a;g.sendSeenDebounced=e;g.sendSeen=s;g.markSeen=f;g.markUnseen=u;g.updateUnreadCountMD=D;g.clearUnreadMentions=F}),226);
__d("WAWebUpdateSubgroupsCommunityAction",["WAWebApiUnjoinedSubgroupMetadataStore","WAWebChatCollection","WAWebGroupMetadataCollection","WAWebGroupQueryBridge","WAWebGroupUnjoinedSubgroupJob","WAWebUnjoinedSubgroupMetadataCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){a.joinedSubgroups=c("WAWebGroupMetadataCollection").filter(function(b){var c;return((c=b.parentGroup)==null?void 0:c.equals(a.id))&&b.participants.iAmMember()}).map(function(a){return a.id})}function i(a){a.unjoinedSubgroups=c("WAWebUnjoinedSubgroupMetadataCollection").filter(function(b){return b.parentGroupId.equals(a.id)}).map(function(a){return a.id})}function a(a,b){d("WAWebApiUnjoinedSubgroupMetadataStore").removeUnjoinedSubgroupMetadataFromStorage(b),j(b),i(a),h(a)}function e(a,b){c("WAWebGroupMetadataCollection").add({id:b,parentGroup:null},{merge:!0}),h(a)}function f(a,b){var c=d("WAWebChatCollection").ChatCollection.get(b.toString()),e=c==null?void 0:c.groupMetadata;if(c==null||e==null)return;h(a);if(e.participants.length===0||!a.participants.iAmAdmin()&&e.hiddenSubgroup===!0||!a.hasJoined())return;b={id:b,subject:c.formattedTitle,defaultSubgroup:!!e.defaultSubgroup,generalSubgroup:!!e.generalSubgroup,parentGroupId:a.id,membershipApprovalMode:e.membershipApprovalMode,hiddenSubgroup:!!e.hiddenSubgroup};void d("WAWebGroupUnjoinedSubgroupJob").updateUnjoinedSubgroupsJob([b],a.id);k([b],a.id)}function j(a){c("WAWebUnjoinedSubgroupMetadataCollection").remove(a.toString())}function k(a,b,d){d===void 0&&(d=!0);a.forEach(function(a){if(!d){j(a.id);return}var e=a.subject,f=a.subjectTime,g=c("WAWebUnjoinedSubgroupMetadataCollection").get(a.id.toString());g&&(g.subjectTime||0)>(f||0)&&(e=g.subject,f=g.subjectTime);c("WAWebUnjoinedSubgroupMetadataCollection").add(babelHelpers["extends"]({},a,{parentGroupId:b,subject:e,subjectTime:f}),{merge:!0})});a=c("WAWebGroupMetadataCollection").get(b.toString());a&&i(a)}function l(a,b){var d=c("WAWebUnjoinedSubgroupMetadataCollection").filter(function(a){return a.parentGroupId.equals(b)}).map(function(a){return a.id});d=d.filter(function(b){return!a.includes(b)});c("WAWebUnjoinedSubgroupMetadataCollection").remove(d)}function m(a,b,e){e===void 0&&(e=!0),a.forEach(function(a){var f=a.id,g=a.subject,h=a.generalSubgroup,i=a.hiddenSubgroup;g!=null&&d("WAWebGroupQueryBridge").updateSubject(f,g);c("WAWebGroupMetadataCollection").add(babelHelpers["extends"]({},a,{parentGroup:e?b:null,generalSubgroup:e?h:null,hiddenSubgroup:e?i:null}),{merge:!0})}),h(c("WAWebGroupMetadataCollection").assertGet(b.toString()))}function n(a){a=d("WAWebChatCollection").ChatCollection.get(a.toString());return a==null||!((a=a.groupMetadata)!=null&&a.participants.iAmMember())}function o(a){return a.filter(function(a){return n(a)})}function p(a){var b=o(a.map(function(a){a=a.id;return a}));return a.filter(function(a){return b.includes(a.id)})}function q(a,b){a=c("WAWebUnjoinedSubgroupMetadataCollection").get(a);a!=null&&(a.membershipApprovalRequest=b)}function r(a,b){void d("WAWebApiUnjoinedSubgroupMetadataStore").updateMembershipApprovalRequestinDB(a,b),q(a,b)}function s(a){a=a.map(function(a){return{id:a.id,size:a.participantCount}});c("WAWebUnjoinedSubgroupMetadataCollection").add(a,{merge:!0})}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebApiUnjoinedSubgroupMetadataStore").updateSizeInDB(a),s(a)});return u.apply(this,arguments)}g.updateJoinedSubgroups=h;g.updateUnjoinedSubgroups=i;g.subgroupUnjoinedToJoined=a;g.unlinkParentGroup=e;g.subgroupJoinedToUnjoined=f;g.updateUnjoinedSubgroupsInCollection=k;g.cleanUnjoinedSubgroupsInCollection=l;g.updateJoinedSubgroupsInCollection=m;g.determineUnjoined=n;g.getUnjoinedSubgroups=p;g.updateMembershipApprovalRequest=r;g.updateUnjoinedSubgroupSize=t}),98);
__d("WAWebAddMeContactAction",["WAJids","WAWebContactCollection","WAWebLidAwareContactsDB","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAJids").toPhoneUserJid(a.user);yield c("WAWebLidAwareContactsDB").createOrMerge(b,{id:b});d("WAWebContactCollection").ContactCollection.gadd(a)});return h.apply(this,arguments)}g.addMeToContacts=a}),98);
__d("WAWebBlockUserJob",["WALogger","WASmaxBlocklistsUpdateBlockListRPC","WASmaxPsaChatBlockSetRPC","WAWebApiContact","WAWebLidAwareContactsDB","WAWebUserPrefsMultiDevice","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a={blockingAction:a};a=(yield d("WASmaxPsaChatBlockSetRPC").sendChatBlockSetRPC(a));switch(a.name){case"ChatBlockSetResponseServerError":var b=a.value.errorChatBlockError.value,c=b.code;b=b.text;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["blockUnblockPSAUser: server response with ",", ",""])),c,b);return{errorCode:Number(c),errorText:b};default:a.name}});return m.apply(this,arguments)}function n(a){return a==null?null:{bizOptOutReason:a.reason,bizOptOutReasonDescription:a.reasonDescription,bizOptOutEntryPoint:a.entryPoint,bizOptOutFirstMessage:a.firstMessage,bizOptOutBusinessDiscoveryEntryPoint:a.businessDiscoveryEntryPoint,bizOptOutBusinessDiscoveryTimestamp:a.businessDiscoveryTimestamp,bizOptOutBusinessDiscoveryId:a.businessDiscoveryId}}function e(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebUserPrefsMultiDevice").getBlocklistHash()),c=a.lid?yield p(a.lid,a.action):r(a.wid,a.action),e=n(a.bizOptOutArgs);e={bizOptOutArgs:e!=null?e:null,itemDhash:b!=null?b:null,updateBlockListBlockOrUpdateBlockListUnblockItemMixinGroupArgs:c};b=(yield d("WASmaxBlocklistsUpdateBlockListRPC").sendUpdateBlockListRPC(e));switch(b.name){case"UpdateBlockListResponseInvalidRequest":c=b.value.errorUpdateBlocklistErrors.value;e=c.code;c=c.text;d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["blockUnblockUser: server response with ",", ",""])),e,c);return{errorCode:Number(e),errorText:c};case"UpdateBlockListResponseServerError":e=b.value.errorServerErrors.value;c=e.code;e=e.text;d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["blockUnblockUser: server response with ",", ",""])),c,e);return{errorCode:Number(c),errorText:e};default:b.name,d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["block/unblock ",": success"])),a.bizOptOutArgs!=null?"biz":"user")}});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebWidToJid").userLidtoLidUserJid(a);if(b==="block"){a=(yield s(a));return{updateBlockListBlockItem:{updateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroupArgs:{updateBlockListMigratedBlockItem:{itemJid:c,blocklistIdsArgs:u(a)}}}}}b;return{updateBlockListUnblockItem:{itemJid:c}}});return q.apply(this,arguments)}function r(a,b){a=d("WAWebWidToJid").widToUserJid(a);if(b==="block")return{updateBlockListBlockItem:{updateBlockListOrUpdateBlockListNonMigratedBlockItemMixinGroupArgs:{updateBlockListNonMigratedBlockItem:{itemJid:a}}}};b;return{updateBlockListUnblockItem:{itemJid:a}}}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield c("WAWebLidAwareContactsDB").get(a.toString()));if(!b){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[blocklist] getBlocklistIdentifier: lid contact not found for ",""])),a).sendLogs("no-lid-contact");return null}if(b.phoneNumber!=null&&b.username!=null)return b.name!=null?{pn:d("WAWebWidFactory").createUserWidOrThrow(b.phoneNumber)}:{username:b.username};if(b.username!=null)return{username:b.username};a=d("WAWebApiContact").getPhoneNumber(a);if(a!=null)return{pn:a};return b.displayNameLID!=null?{displayName:b.displayNameLID}:null});return t.apply(this,arguments)}function u(a){if(a==null)return{isUnknownIdentifier:!0};else if(a.pn!=null)return{pnJid:{anyPnJid:d("WAWebWidToJid").widToUserJid(a.pn)}};else if(a.username!=null)return{username:{anyUsername:a.username}};a.displayName;return{displayName:{anyDisplayName:a.displayName}}}g.blockUnblockPSAUser=a;g.blockUnblockUser=e;g.getBlocklistIdentifier=s}),98);
__d("WAWebUpdateBlocklistDbJob",["WALogger","WAWebQueryBlockListJob","WAWebSchemaBlocklist","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebQueryBlockListJob").getBlockingStatusForPSAUser());try{if(b){yield k(a,!0);return!0}yield k(a,!1);return!1}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["failed to update blocking status of psa user"]))).verbose().devConsole(a).sendLogs("Failed to update blocking status of psa user");throw c("err")("failed to update blocking status of psa user")}});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.toString();try{b?yield d("WAWebSchemaBlocklist").getBlocklistTable().createOrReplace({id:a}):yield d("WAWebSchemaBlocklist").getBlocklistTable().remove(a)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["updateBlocklistDbJob failed"]))).verbose().devConsole(a).sendLogs("Failed to update blocklist db");throw c("err")("updateBlocklistDbJob failed")}});return l.apply(this,arguments)}g.updateBlockingStatusForPSAUser=a;g.updateBlocklistDbJob=k}),98);
__d("WAWebBlockContactAction",["fbt","Promise","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebBlockUserJob","WAWebBlocklistCollection","WAWebBlocklistMigration","WAWebBlocklistUtils","WAWebChatCollection","WAWebFrontendContactGetters","WAWebMmSignalSharingLoggingEvents","WAWebStateUtils","WAWebToastManager","WAWebUpdateBlocklistDbJob","WAWebWamBlockEventReporter","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=m||c("react");function a(a){var b=a.contact,c=a.blockEntryPoint;a=a.bizOptOutArgs;var e=d("WAWebBlocklistUtils").getBlockEventMetricFromBlockEntryPoint(c);d("WAWebWamBlockEventReporter").logBlockEvent({contact:b,blockEntryPoint:e,isBlock:!0});var f=d("WAWebChatCollection").ChatCollection.get(b.id);d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingBlockVerificationEvent({chat:f,reason:a==null?void 0:a.reason,blockEntryPointMetric:e});d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingUserBlockEvent({chat:f,blockEntryPointMetric:e});d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingUserBlockWithReasonEvent({chat:f,reason:a==null?void 0:a.reason,blockEntryPointMetric:e});return p(d("WAWebStateUtils").unproxy(b),!0,c,a)}function e(a,b){var c=d("WAWebBlocklistUtils").getBlockEventMetricFromBlockEntryPoint(b);d("WAWebWamBlockEventReporter").logBlockEvent({contact:a,blockEntryPoint:c,isBlock:!1});return p(d("WAWebStateUtils").unproxy(a),!1,b)}function f(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebUpdateBlocklistDbJob").updateBlockingStatusForPSAUser(a));a=a;b?d("WAWebBlocklistCollection").BlocklistCollection.add({id:a}):d("WAWebBlocklistCollection").BlocklistCollection.remove(a)});return o.apply(this,arguments)}function p(a,c,e,f,g){var h=a.isContactBlocked,i=c&&h;h=!c&&!h;if(i||h)return(l||(l=b("Promise"))).resolve();i=r(a,c?"block":"unblock",e,f).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a&&a.errorCode!=null)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);a=a.targetWid;yield d("WAWebUpdateBlocklistDbJob").updateBlocklistDbJob(a,c);c?d("WAWebBlocklistCollection").BlocklistCollection.add({id:a}):d("WAWebBlocklistCollection").BlocklistCollection.remove(a)});return function(b){return a.apply(this,arguments)}}());h=function(){return p(a,!c,e,f,g)};var j=function(){return p(a,c,e,f,g)};q(a,i,c,h,j,g);return i}function q(a,b,c,e,f,g){g===void 0&&(g=d("WAWebActionToast.react").genId());var j=d("WAWebFrontendContactGetters").getFormattedName(a);a=c?new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Blocking {member}",[h._param("member",j)])):new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Unblocking {member}",[h._param("member",j)]));b=b.then(function(){var a=c?h._(/*BTDS*/"{member} blocked",[h._param("member",j)]):h._(/*BTDS*/"{member} unblocked",[h._param("member",j)]);return new(d("WAWebActionToast.react").ActionType)(a,{actionText:h._(/*BTDS*/"Undo"),actionHandler:e})})["catch"](function(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError){if(a.statusCode>=400)throw c?new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't block {member}",[h._param("member",j)])):new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't unblock {member}",[h._param("member",j)]))}else{d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["action:setBlock dropped"]))).devConsole(a);a=c?h._(/*BTDS*/"Couldn't block {member}",[h._param("member",j)]):h._(/*BTDS*/"Couldn't unblock {member}",[h._param("member",j)]);throw new(d("WAWebActionToast.react").ActionType)(a,{actionText:h._(/*BTDS*/"Try again."),actionHandler:f})}});d("WAWebToastManager").ToastManager.open(n.jsx(d("WAWebActionToast.react").ActionToast,{id:g,initialAction:a,pendingAction:b}))}function r(a,b,c,d){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){if(a.id.isPSA()){var f=(yield d("WAWebBlockUserJob").blockUnblockPSAUser(b));return f!=null&&f.errorCode?f:{targetWid:a.id}}if(d("WAWebBlocklistMigration").isBlocklistMigrated()){f=t(a,c);yield d("WAWebBlockUserJob").blockUnblockUser({lid:f,action:b,bizOptOutArgs:e});return{targetWid:f}}c=a.id;f=a.phoneNumber;a=b==="block"&&c.isLid();a=a&&f!=null?f:c;yield d("WAWebBlockUserJob").blockUnblockUser({wid:a,action:b,bizOptOutArgs:e});return{targetWid:a}});return s.apply(this,arguments)}function t(a,b){a=a.id;if(a.isLid())return a;var c=d("WAWebChatCollection").ChatCollection.get(a);if(c){if(c.accountLid)return c.accountLid;c="[blocklist] no accountLid for chat: "+c.id.toLogString()+", entryPoint: "+(b!=null?b:"null");d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["",""])),c).sendLogs("blocklist-no-accountlid-chat");throw c}c="[blocklist] trying to block a pn contact (id: "+a.toLogString()+") without a chat,  entryPoint: "+(b!=null?b:"null");d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["",""])),c).sendLogs("blocklist-pn-contact-without-chat");throw c}g.blockContact=a;g.unblockContact=e;g.updatePSAUserBlockingStatus=f}),226);
__d("WAWebBizVerifiedLevelToString",["WAWebBusinessProfileTypes"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH:return"high";case d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.LOW:return"low";case d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.UNKNOWN:default:return"unknown"}}g["default"]=a}),98);
__d("WAWebGetOrQueryUsyncInfoContactAction",["Promise","WALogger","WAPromiseCache","WAWebBackendErrors","WAWebBizUpdateVerifiedInfoAction","WAWebBizVerifiedLevelToString","WAWebChatCollection","WAWebContactCollection","WAWebQueryExistsJob","WAWebUpdateDisappearingModeForContact","WAWebUsync","WAWebUsyncUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e===void 0?{forceUsync:!1}:e;e=e.forceUsync;var f=d("WAWebContactCollection").ContactCollection.get(a);if(e!==!0&&f!=null&&(f.name!=null||d("WAWebChatCollection").ChatCollection.get(a)!=null)){return{wid:a,biz:f.isBusiness,bizInfo:f.isBusiness?{verifiedName:{level:c("WAWebBizVerifiedLevelToString")(f.verifiedLevel),serial:null,name:f.verifiedName,isApi:Boolean(f.isEnterprise),isSmb:Boolean(f.isSmb),privacyMode:f.privacyMode}}:null,disappearingMode:{duration:(e=f.disappearingModeDuration)!=null?e:0,settingTimestamp:(e=f.disappearingModeSettingTimestamp)!=null?e:0}}}e=(yield d("WAWebQueryExistsJob").queryWidExists(a));if(e){var g=e.biz,h=e.bizInfo,i=e.disappearingMode;g&&h!=null&&(yield d("WAWebBizUpdateVerifiedInfoAction").updateVerifiedInfo(a,h.verifiedName));i&&f!=null&&(yield d("WAWebUpdateDisappearingModeForContact").updateDisappearingModeForContact(a,i.duration,i.settingTimestamp));return e}return(j||(j=b("Promise"))).reject(c("err")("Invalid number"))});return k.apply(this,arguments)}function e(){var a=new(c("WAPromiseCache"))(d("WAWebQueryExistsJob").queryPhoneExists,{maxCached:100,maxAge:36e4,shouldCache:function(a){return!!a}});return a}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying for biz info"]))).devConsole({wid:a});var b=new(d("WAWebUsyncUser").USyncUser)(),c=new(d("WAWebUsync").USyncQuery)();a.isLid()?b.withId(a):b.withPhone(a.toString());c.withUser(b);c.withBusinessProtocol();b=(yield c.execute());c=b.error.all;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[usync] biz info response"]))).devConsole({res:b,error:c});if(c)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(c.errorCode,c.errorText);c=b.list;if(c.length!==1)return null;b=c[0];c=b.id;b=b.business;b!=null&&(yield d("WAWebBizUpdateVerifiedInfoAction").updateVerifiedInfo(a,b.verifiedName));a={wid:c,biz:b!=null,bizInfo:b};return a});return l.apply(this,arguments)}g.getOrQueryUsyncInfo=a;g.usyncContactCached=e;g.queryUsyncBusiness=f}),98);
__d("WAWebWamEnumPhoneNumHyperlinkActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({PHONE_NUM_HYPERLINK_MSG_RECEIVED:1,LONG_PRESS_PHONE_NUM_HYPERLINK:2,CLICK_PHONE_NUM_HYPERLINK:3,CLICK_CALL:4,CLICK_ADD_TO_CONTACTS:5,CLICK_MESSAGE_ON_WHATSAPP:6,CLICK_COPY_PHONE_NUMBER:7,CLOSE_DIALOG_BOX:8,MESSAGE_SENT:9,CLICK_CALL_ON_WHATSAPP:10,CLICK_INVITE_TO_WHATSAPP:11});f.PHONE_NUM_HYPERLINK_ACTION_TYPE=a}),66);
__d("WAWebPsPhoneNumberHyperlinkWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPhoneNumHyperlinkActionType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsPhoneNumberHyperlink:[3266,{isPhoneNumHyperlinkOwner:[1,a.TYPES.BOOLEAN],phoneNumHyperlinkAction:[2,d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE],phoneNumberStatusOnWa:[3,a.TYPES.BOOLEAN],sequenceNumber:[4,a.TYPES.INTEGER]},[1,1,1],"private",113760892]},{PsPhoneNumberHyperlink:[]});g.PsPhoneNumberHyperlinkWamEvent=b}),98);
__d("WAWebPhoneNumberContactAction",["fbt","WAWebComposeBoxActions","WAWebCopyToClipboard","WAWebModalManager","WAWebOpenChatFlow.react","WAWebPsPhoneNumberHyperlinkWamEvent","WAWebToast.react","WAWebToastManager","WAWebUserPrefsMeUser","WAWebWamEnumPhoneNumHyperlinkActionType","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a,b,c){d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebOpenChatFlow.react").OpenChatFlow,{targetId:{targetId:b},onSuccess:function(a){a=a.chat;k(a,c)},msgText:null}),{transition:"modal-flow"}),new(d("WAWebPsPhoneNumberHyperlinkWamEvent").PsPhoneNumberHyperlinkWamEvent)({phoneNumHyperlinkAction:d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_MESSAGE_ON_WHATSAPP,isPhoneNumHyperlinkOwner:d("WAWebUserPrefsMeUser").isMeAccount(b),phoneNumberStatusOnWa:!0}).commit()}function b(a,b,c){void d("WAWebCopyToClipboard").copyTextToClipboard(a),d("WAWebToastManager").ToastManager.open(j.jsx(d("WAWebToast.react").Toast,{msg:h._(/*BTDS*/"Copied to clipboard.")})),new(d("WAWebPsPhoneNumberHyperlinkWamEvent").PsPhoneNumberHyperlinkWamEvent)({phoneNumHyperlinkAction:d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_COPY_PHONE_NUMBER,isPhoneNumHyperlinkOwner:c,phoneNumberStatusOnWa:Boolean(b)}).commit()}function e(a,b){new(d("WAWebPsPhoneNumberHyperlinkWamEvent").PsPhoneNumberHyperlinkWamEvent)({phoneNumHyperlinkAction:d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLICK_PHONE_NUM_HYPERLINK,isPhoneNumHyperlinkOwner:b,phoneNumberStatusOnWa:Boolean(a)}).commit()}function f(a,b){new(d("WAWebPsPhoneNumberHyperlinkWamEvent").PsPhoneNumberHyperlinkWamEvent)({phoneNumHyperlinkAction:d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.CLOSE_DIALOG_BOX,isPhoneNumHyperlinkOwner:b,phoneNumberStatusOnWa:Boolean(a)}).commit()}function k(a,b){if(!a)return;d("WAWebComposeBoxActions").ComposeBoxActions.addMsgSendingLogAttributes(a,{handleOnce:function(){new(d("WAWebPsPhoneNumberHyperlinkWamEvent").PsPhoneNumberHyperlinkWamEvent)({phoneNumHyperlinkAction:d("WAWebWamEnumPhoneNumHyperlinkActionType").PHONE_NUM_HYPERLINK_ACTION_TYPE.MESSAGE_SENT,isPhoneNumHyperlinkOwner:b,phoneNumberStatusOnWa:!0}).commit()}})}g.handleOpenChat=a;g.handleCopyPhoneNumber=b;g.logClickOnPhoneNumber=e;g.logCloseDialog=f}),226);
__d("WAWebStatusContactAction",["fbt","Promise","WALogger","WAWebActionToast.react","WAWebChatCollection","WAWebContactStatusBridge","WAWebMiscErrors","WAWebTextStatusCollection","WAWebToastManager","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l=k||c("react");function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWebChatCollection").ChatCollection.getLatestChatForWid(a))==null?void 0:b.tcToken;b={wid:a,tcToken:b};b=(yield d("WAWebContactStatusBridge").getStatus(b));if(b.stale===!0){var c=d("WAWebTextStatusCollection").TextStatusCollection.get(a);if(c)return{id:a,status:c.status}}b=(c=b.status)!=null?c:d("WAWebTextStatusCollection").getDefaultTextStatus();return{id:a,status:b}});return m.apply(this,arguments)}function n(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){e===void 0&&(e=d("WAWebActionToast.react").genId());f===void 0&&(f=!1);var g=a.trim();if(!g)return(j||(j=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)());g=d("WAWebContactStatusBridge").setMyStatus(g);var k=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Changing About\u2026")),m=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),o=d("WAWebTextStatusCollection").TextStatusCollection.assertGet(m).status,p=g.then(function(a){if(a.status===200){var b=f?void 0:{actionText:h._(/*BTDS*/"Undo"),actionHandler:function(){return n(o,c,e,!0)}};return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"About changed"),b)}else if(a.status>=400)return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't change About."))})["catch"](function(b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:statusCollection:setMyStatus dropped"]))).devConsole(b);throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't change About."),{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return n(a,c,e)}})});d("WAWebToastManager").ToastManager.open(l.jsx(d("WAWebActionToast.react").ActionToast,{id:e,initialAction:k,pendingAction:p,onDismiss:c}));k=(yield g);k.status===200&&(d("WAWebTextStatusCollection").TextStatusCollection.assertGet(m).status=a)});return o.apply(this,arguments)}g.getStatus=a;g.setMyStatus=n}),226);
__d("WAWebGroupExitJob",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","WAWebJidToWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new(c("WADeprecatedWapParser"))("leaveGroupsResultParser",function(a){a.assertAttr("type","result");a=a.child("leave");a=a.mapChildren(function(a){return{id:d("WAWebJidToWid").groupJidToWid(a.attrGroupJid("id")),code:a.hasAttr("error")?a.attrInt("error"):200}});return a}),j=new(c("WADeprecatedWapParser"))("leaveCommunitiesResultParser",function(a){a.assertAttr("type","result");a=a.child("leave");a=a.mapChildren(function(a){return{id:d("WAWebJidToWid").groupJidToWid(a.attrGroupJid("parent_group_jid")),code:a.hasAttr("error")?a.attrInt("error"):200}});return a});function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c;a=a.map(function(a){return d("WAWap").wap("group",{id:d("WAWebCommsWapMd").GROUP_JID(a)})});c=(c=d("WAWap")).wap("iq",{to:c.G_US,type:"set",xmlns:"w:g2",id:c.generateId()},c.wap("leave",null,a));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(c,i));return a.success?a.result:(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText))});return l.apply(this,arguments)}function a(a){return k([a]).then(function(a){return a[0]})}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c;a=a.map(function(a){return d("WAWap").wap("linked_groups",{parent_group_jid:d("WAWebCommsWapMd").GROUP_JID(a)})});c=(c=d("WAWap")).wap("iq",{to:c.G_US,type:"set",xmlns:"w:g2",id:c.generateId()},c.wap("leave",null,a));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(c,j));return a.success?a.result:(h||(h=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText))});return n.apply(this,arguments)}function e(a){return m([a]).then(function(a){return a[0]})}g.leaveGroup=a;g.leaveCommunities=m;g.leaveCommunity=e}),98);
__d("WAWebExitGroupAction",["fbt","Promise","WAFilteredCatch","WALogger","WAWebActionToast.react","WAWebBackendErrors","WAWebChatGetters","WAWebGroupExitJob","WAWebInvalidateEventsAction","WAWebMiscErrors","WAWebPollsInvalidateChatPollMsgsAction","WAWebSchemaChat","WAWebStateUtils","WAWebToastManager","WAWebUserPrefsMeUser","err","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m=l||c("react");function a(a){return n(d("WAWebStateUtils").unproxy(a))}function n(a){var c=a.promises;if(!d("WAWebChatGetters").getIsGroup(a))return(k||(k=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)());if(c.sendExit)return c.sendExit;var e=c.sendExit=d("WAWebGroupExitJob").leaveGroup(a.id).then(function(a){if(a.code!==200)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.code)}),f=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Exiting group")),g=e.then(function(){return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Exited group"))})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){if(a.status>=400)return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't exit group."))}))["catch"](function(b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["actions:chat:sendExit dropped"]))).devConsole(b);return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't exit group."),{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return n(a)}})});d("WAWebToastManager").ToastManager.open(m.jsx(d("WAWebActionToast.react").ActionToast,{initialAction:f,pendingAction:g}));return e.then(function(){return o(a)})["finally"](function(){c.sendExit=null})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(){return!1}))}function o(a){var e;if(!d("WAWebChatGetters").getIsGroup(a))return(k||(k=b("Promise"))).resolve(!0);(e=a.groupMetadata)==null||e.participants.remove(d("WAWebUserPrefsMeUser").getMePnUserOrThrow());return d("WAWebSchemaChat").getChatTable().merge(a.id.toString(),{isReadOnly:!0}).then(function(){a.isReadOnly=!0;void d("WAWebPollsInvalidateChatPollMsgsAction").invalidateChatPollMsgs(a);void d("WAWebInvalidateEventsAction").invalidateEventMsgsForChat(a);return!0})["catch"](function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["failed to merge chat table"]))).verbose().devConsole(a).sendLogs("failed to merge chat table when exiting group: "+a);throw c("err")("failed to merge chat table")})}g.sendExitGroup=a}),226);
__d("WAWebFindGroupMetadataAction",["Promise","WALogger","WAWebDBParticipantTypes","WAWebGroupDatabaseJob","WAWebGroupMetadataCollection","WAWebGroupQueryBridge","WAWebWamNumberToSizeBucket","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["hasIncompleteParticipantInformation"],i,j,k,l,m,n,o,p;function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: start find group metadata for ",""])),a);var e=null,f=null,g=function(){return void 0},q=c("WAWebGroupMetadataCollection").get(a);if(!q){e=(yield d("WAWebGroupDatabaseJob").getGroupMetadataJob(a));if(!e){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query missing group participant"])),a);return d("WAWebGroupQueryBridge").sendQueryGroup(a)}e.subject!=null&&d("WAWebGroupQueryBridge").updateSubject(a,e.subject)}else{if(q.participantQueryPromise){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - pending participant query"])),a);return q.participantQueryPromise.then(function(){return{id:a}})}q.participantQueryPromise=new(p||(p=b("Promise")))(function(a){g=a})}try{if(!q||q.stale){f=(yield d("WAWebGroupDatabaseJob").getGroupParticipantJob(a));if(!f){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query missing group participant"])),a);return d("WAWebGroupQueryBridge").sendQueryGroup(a)}}var r;if(e){e=e;e.hasIncompleteParticipantInformation;e=babelHelpers.objectWithoutPropertiesLoose(e,h);r=e}e=babelHelpers["extends"]({id:a},r,{participants:(e=f)==null?void 0:e.participants,pastParticipants:(e=f)==null?void 0:e.pastParticipants,deviceStale:f?f.staleType===d("WAWebDBParticipantTypes").STALE_TYPES.DEVICE:void 0,cachedDeviceCount:(e=f)==null?void 0:e.deviceCount,cachedDeviceSizeBucket:(e=f)!=null&&e.deviceCount?c("WAWebWamNumberToSizeBucket")(f.deviceCount):null});if(((f=f)==null?void 0:f.staleType)===d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query stale group participant"])),a);f=(yield d("WAWebGroupQueryBridge").sendQueryGroup(a));(f==null?void 0:f.participants)!=null&&(e.participants=f.participants)}d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: end find group metadata for ",""])),a);return e}catch(b){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["findGroupMetadata: "," - query group participant error: ",""])),a,b);throw b}finally{g(),q&&(q.participantQueryPromise=null)}});return q.apply(this,arguments)}g.findGroupMetadata=a}),98);
__d("WAWebSendForNeededAddRequest",["WALogger","WAWebCmd","WAWebContactCollection"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,e){if(!a.participants)return;e=e!=null?e:a.gid;e||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Group add request was provided with undefined gid");var f=[];a.participants.forEach(function(a){if(a.code!=="403")return;var b=d("WAWebContactCollection").ContactCollection.gadd(a.userWid,{silent:!0});f.push(babelHelpers["extends"]({},a,{contact:b}))});f.length>0&&e&&d("WAWebCmd").Cmd.openGroupsV4InviteRequestFlow(f,e,b,c)}g.sendForNeededAddRequest=a}),98);
__d("WAWebGroupInviteV4Job",["WALogger","WASmaxGroupsAcceptGroupAddRPC","WASmaxGroupsGetGroupInfoRPC","WASmaxGroupsRevokeRequestCodeRPC","WAWebGroupsQueryApi","WAWebJidToWid","WAWebSetUsernameJob","WAWebUsernameGatingUtils","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(a,b,c,d,e){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){b=(yield d("WASmaxGroupsGetGroupInfoRPC").sendGetGroupInfoRPC({addRequestArgs:{addRequestExpiration:parseInt(b,10),addRequestAdmin:d("WAWebWidToJid").widToUserJid(e),addRequestCode:a},iqTo:c,queryPhash:f}));switch(b.name){case"GetGroupInfoResponseSuccess":if(b.value.group==null)return{status:200,phashMatch:!0};e=d("WAWebGroupsQueryApi").parseGroupSmax(b.value.group);return{status:200,groupMetadata:e};case"GetGroupInfoResponseClientError":a=b.value.errorGetGroupInfoClientErrors.value;c=a.code;f=a.text;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInviteV4: failed ",":",""])),Number(c),f);return{status:Number(c)};case"GetGroupInfoResponseServerError":e=b.value.errorServerErrors.value;a=e.code;f=e.text;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["queryGroupInviteV4: failed ",":",""])),a,f);return{status:Number(a)}}});return n.apply(this,arguments)}function c(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WASmaxGroupsAcceptGroupAddRPC").sendAcceptGroupAddRPC({iqTo:c,acceptCode:a,acceptExpiration:parseInt(b,10),acceptAdmin:d("WAWebWidToJid").widToUserJid(e)}));switch(a.name){case"AcceptGroupAddResponseSuccess":return{status:200,gid:d("WAWebJidToWid").groupJidToWid(c)};case"AcceptGroupAddResponseGroupJoinRequestSuccess":return{status:200,gid:d("WAWebJidToWid").groupJidToWid(c)};case"AcceptGroupAddResponseClientError":b=a.value.errorAcceptGroupAddClientErrors.value;e=b.code;c=b.text;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["joinGroupViaInviteV4: failed ",":",""])),e,c);return{status:Number(e)};case"AcceptGroupAddResponseServerError":b=a.value.errorServerErrors.value;c=b.code;e=b.text;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["joinGroupViaInviteV4: failed ",":",""])),c,e);return{status:Number(c)}}});return o.apply(this,arguments)}function e(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WASmaxGroupsRevokeRequestCodeRPC").sendRevokeRequestCodeRPC({participantArgs:a.map(function(a){return{participantJid:d("WAWebWidToJid").widToUserJid(a)}}),iqTo:b}));switch(a.name){case"RevokeRequestCodeResponseSuccess":b=a.value.revokeParticipant;if(d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){b=b.reduce(function(a,b){var c=b.jid;b=(b=b.usernameAttMixin)==null?void 0:b.username;b!=null&&a.push({userId:d("WAWebJidToWid").userJidToUserWid(c),username:b});return a},[]);b.length>0&&(yield d("WAWebSetUsernameJob").setUsernamesJob(b))}return{status:200};case"RevokeRequestCodeResponseClientError":b=a.value.errorClientErrors.value;var c=b.code;b=b.text;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["revokeGroupInviteV4: failed ",":",""])),c,b);return{status:Number(c)};case"RevokeRequestCodeResponseServerError":b=a.value.errorServerErrors.value;c=b.code;a=b.text;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["revokeGroupInviteV4: failed ",":",""])),c,a);return{status:Number(c)}}});return p.apply(this,arguments)}g.queryGroupInviteV4=a;g.joinGroupViaInviteV4=c;g.revokeGroupInviteV4=e}),98);
__d("WAWebInviteV4QueryGroupAction",["WAWebApiGroupInviteV4Store","WAWebChatCollection","WAWebContactCollection","WAWebGroupInviteV4Job","WAWebGroupMetadataCollection","WAWebLidMappingUsernameLearnUtils","WAWebPhashUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){var g=null,h=c("WAWebGroupMetadataCollection").get(e);h&&(g=(yield d("WAWebPhashUtils").phashV1(h.participants.map(function(a){return a.id}))));return d("WAWebGroupInviteV4Job").queryGroupInviteV4(a,b,e,f,g).then(function(a){if(a.phashMatch===!0)return{status:200,phashMatch:!0};if(a.groupMetadata!=null){var b=babelHelpers["extends"]({},a.groupMetadata);return d("WAWebLidMappingUsernameLearnUtils").processParsedGroupInfosForLidMappingAndUsernames([b]).then(function(){return b})}return{status:a.status}}).then(function(a){if(a.status!=null&&a.status>0)return a;if(a.id!=null){d("WAWebContactCollection").ContactCollection.gadd(a.id);return a}a=c("WAWebGroupMetadataCollection").assertGet(d("WAWebWidFactory").createWidFromWidLike(e));var b=d("WAWebChatCollection").ChatCollection.assertGet(a.id).contact.name;return{id:a.id,owner:a.owner,creation:a.creation,desc:a.desc,descId:a.descId,descOwner:a.descOwner,descTime:a.descTime,restrict:a.restrict,announce:a.announce,ephemeralDuration:a.ephemeralDuration,membershipApprovalMode:a.membershipApprovalMode,reportToAdminMode:a.reportToAdminMode,growthLockExpiration:a.growthLockExpiration,growthLockType:a.growthLockType,noFrequentlyForwarded:a.noFrequentlyForwarded,subject:b,participants:a.participants.map(function(a){return{id:a.id,isAdmin:a.isAdmin,isSuperAdmin:a.isSuperAdmin}})}})});return h.apply(this,arguments)}function e(a,b,c,e){return d("WAWebGroupInviteV4Job").joinGroupViaInviteV4(a,b,c,e)}function f(a,b){return d("WAWebGroupInviteV4Job").revokeGroupInviteV4(a,b)}function i(a,b){return d("WAWebApiGroupInviteV4Store").getPendingParticipants(a,b)}g.queryGroupInviteV4Info=a;g.joinGroupViaInviteV4=e;g.revokeGroupInviteV4=f;g.getPendingParticipants=i}),98);
__d("WAWebChangePresenceHandlerAction",["Promise","WAWebChatCollection","WAWebLidMigrationUtils","WAWebPresenceCollection","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=25e3;function j(a,b){var c=a.type;(c==="typing"||c==="recording_audio")&&(a.type=b.isOnline?"available":"unavailable")}function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!0);var e=a.id;if(!d("WAWebUserPrefsMeUser").isMeAccount(e)){e=d("WAWebPresenceCollection").PresenceCollection.get(e);e&&(l(e,a),c&&e.set({stale:!1}))}return(h||(h=b("Promise"))).resolve()});return k.apply(this,arguments)}function l(a,b){var c=!1;typeof b.type==="undefined"?b.type=a.chatstate.type||"unavailable":b.type==="idle"&&(c=!0,b.type=a.isOnline?"available":"unavailable");a.isGroup&&b.type!=="available"&&!c&&(b.updateTime=Date.now());var e;if(a.isGroup){var f=b.participant;if(f==null)return;var g=b.id;g=d("WAWebChatCollection").ChatCollection.get(g);if(g==null)return;if(d("WAWebLidMigrationUtils").toPn(f)==null)return;b.id=f;b.participant=void 0;e=a.chatstates.gadd(b.id)}else e=a.chatstate;(!c||e.type==="typing"||e.type==="recording_audio")&&e.set(b);e.expireTimerId&&self.clearTimeout(e.expireTimerId);e.type==="typing"||e.type==="recording_audio"?e.expireTimerId=self.setTimeout(function(){return j(e,a)},i):e.expireTimerId=void 0;g=a.forceDisplay||a.isOnline||a.isUser&&!a.chatstate.deny;a.set({hasData:!0,isSubscribed:!0,forceDisplay:g})}g["default"]=a}),98);
__d("WAWebAddOnsUpdateAddOnAcksApi",["Promise","WAAckLevel","WANullthrows","WATypeUtils","WAWebBackendApi","WAWebDBAddOnProviders","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];b=c("WANullthrows")(d("WAWebDBAddOnProviders").getProviderForAddOnType(b));return b.updateAcks==null?void 0:b.updateAcks(a,function(){return!0})})));for(a of a)if(a.status==="rejected")throw a.reason});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(Array.from(a).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a=a[1];var e=c("WANullthrows")(d("WAWebDBAddOnProviders").getProviderForAddOnType(b));e=(yield e.updateAcks==null?void 0:e.updateAcks(a,function(a,b){return k(a.ack,b.ack)}));if(e==null||e.length===0)return;return[b,e]});return function(b){return a.apply(this,arguments)}}())));var e=new Map(a.map(function(a){return a.value}).filter(Boolean));d("WAWebBackendApi").frontendFireAndForget("updateAddOnCollectionAcks",{updatesByType:e});for(e of a)if(e.status==="rejected")throw e.reason});return j.apply(this,arguments)}function k(a,b){return d("WATypeUtils").isNumber(b)&&(a==null||b>a||b===d("WAAckLevel").ACK.FAILED)}g.updateAddOnAcks=a;g.maybeUpdateAddOnAcks=e}),98);
__d("WAWebAddOnsUpdateSendStatesAction",["Promise","WAWebAddOnsUpdateAddOnAcksApi","WAWebCommentCollection","WAWebMessageAddOnType","WAWebMsgKey","WAWebMsgType","WAWebPinInChatCollection","WAWebPollsPollVoteCollection","WAWebReactionsCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){var c=l(a);if(c==null)return;d("WAWebAddOnsUpdateAddOnAcksApi").maybeUpdateAddOnAcks(new Map([[c,[{msgKey:a.id.toString(),ack:b}]]]))}function e(a,c){var d=l(a);return d==null?(h||(h=b("Promise"))).resolve():i(new Map([[d,[babelHelpers["extends"]({msgKey:a.id.toString()},c)]]]))}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();for(var c of a){var e=c[0],f=c[1];f=f.map(function(a){return a.ack==null?null:{msgKey:a.msgKey,ack:a.ack}}).filter(Boolean);b.set(e,f)}yield d("WAWebAddOnsUpdateAddOnAcksApi").updateAddOnAcks(b);k(a)});return j.apply(this,arguments)}function k(a){for(a of a){var b=a[0],d=a[1];for(d of d){var e=m(b,c("WAWebMsgKey").from(d.msgKey));if(e==null)continue;d.ack!=null&&(e.ack=d.ack);d.isSendFailure!=null&&(e.isSendFailure=d.isSendFailure)}}}function l(a){switch(a.type){case d("WAWebMsgType").MSG_TYPE.REACTION:case d("WAWebMsgType").MSG_TYPE.REACTION_ENC:return d("WAWebMessageAddOnType").MessageAddOnType.Reaction;case d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:if(a.subtype==="poll_vote")return d("WAWebMessageAddOnType").MessageAddOnType.PollVote;break;case d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE:return d("WAWebMessageAddOnType").MessageAddOnType.PinMessage;case d("WAWebMsgType").MSG_TYPE.COMMENT:return d("WAWebMessageAddOnType").MessageAddOnType.Comment}return null}function m(a,b){switch(a){case d("WAWebMessageAddOnType").MessageAddOnType.Reaction:return d("WAWebReactionsCollection").ReactionsCollection.getSenderByMsgKey(b);case d("WAWebMessageAddOnType").MessageAddOnType.PollVote:return d("WAWebPollsPollVoteCollection").PollVoteCollection.getByMsgKey(b);case d("WAWebMessageAddOnType").MessageAddOnType.PinMessage:return d("WAWebPinInChatCollection").PinInChatCollection.getByMsgKey(b);case d("WAWebMessageAddOnType").MessageAddOnType.Comment:return d("WAWebCommentCollection").CommentCollection.getByMsgKey(b);case d("WAWebMessageAddOnType").MessageAddOnType.KeepInChat:case d("WAWebMessageAddOnType").MessageAddOnType.MessageEdit:case d("WAWebMessageAddOnType").MessageAddOnType.ReactionEnc:case d("WAWebMessageAddOnType").MessageAddOnType.Unknown:return null}}g.maybeUpdateAddOnAckForMsgAction=a;g.updateAddOnSendStatesForMsgAction=e;g.updateAddOnSendStatesAction=i;g.updateAddOnCollectionsSendStatesAction=k}),98);
__d("WAWebFutureproofReparseMsgsAction",["Promise","WALogger","WAWebAddonGatingUtils","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebHandleMsgProcess","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterReparseMsgAction","WAWebProcessMsgInfoForLid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=a.futureproofBuffer,c=a.futureproofParams;if(d("WAWebMsgGetters").getIsNewsletterMsg(a))return yield d("WAWebNewsletterReparseMsgAction").reparseNewsletterMsg(a);if(b!=null){if(c){var e=c.info,f=c.msgMeta;d("WAWebLidMigrationUtils").shouldHaveAccountLid(e.chat)&&e.accountLid==null&&(yield d("WAWebProcessMsgInfoForLid").maybeProcesMsgInfoForLid({msgInfo:e,msgMeta:f}));yield d("WAWebHandleMsgProcess").processDecryptedMessageProto(babelHelpers["extends"]({},c,{decrypted:b,reparsing:!0}))}return a}d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: No futureproof buffer"])));return null}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: reparse error: ",""])),a).sendLogs("reparse-futureproof-error");return null}});return m.apply(this,arguments)}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var c=[],e=[];a.forEach(function(a){var b=d("WAWebDBMessageSerialization").messageFromDbRow(a),f=d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(a.type)||Boolean(d("WAWebDBAddOnProviders").getAddOnProviderForFutureproofMsg(b));f?c.push(b):a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&e.push(b)});yield (k||(k=b("Promise"))).all(e.map(function(a){return l(a)}));yield k.all(c.map(function(a){return l(a)}))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["reparseFutureproof: processFutureproof error"])))}});return n.apply(this,arguments)}g.reparseFutureproof=l;g.processFutureproof=a}),98);
__d("WAWebAvatarGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("enable_avatars_on_web_companion")}g.avatarsOnWebEnabled=a}),98);
__d("WAWebMediaLinkPreviewUtils",["WATimeUtils","WAWebDisplayType"],(function(a,b,c,d,e,f,g){var h=30*24*60*60;function i(a){a=d("WATimeUtils").unixTime()-a>h;return a}var j=7/5;function a(a,b){var c=Boolean(a.thumbnailDirectPath||a.thumbnailHQ)&&a.thumbnailHeight!=null&&a.thumbnailWidth!=null;if(!c)return!1;c=i(a.t);if(c)return!1;c=b===d("WAWebDisplayType").DISPLAY_TYPE.GALLERY;if(c)return!1;return b===d("WAWebDisplayType").DISPLAY_TYPE.STATUS&&a.thumbnailHeight!=null&&a.thumbnailWidth!=null?a.thumbnailWidth/a.thumbnailHeight>=j:!0}g.HQ_PREVIEW_LIFESPAN=h;g.hqLinkPreviewExpired=i;g.displayHighQualityLinkPreview=a}),98);
__d("WAWebProcessMultipleMsgsAction",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebAddAndReorderMsgsActionsUtils","WAWebAvatarGatingUtils","WAWebBotGenTypingIndicatorMsg","WAWebBotTypes","WAWebChatCollection","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebGetMsgUpdatesActionsUtils","WAWebLidStatusMigrationUtils","WAWebMedia","WAWebMediaAutoDownloadQueue","WAWebMediaDownloadMmsThumbnail","WAWebMediaLinkPreviewUtils","WAWebMediaTypes","WAWebMiscGatingUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebRecentStickerCollection","WAWebRecentStickerCollectionMd","WAWebStatusCollection","WAWebStickerModel","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b,c,d,e){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j){var k,m=(yield c("WAWebGetMsgUpdatesActionsUtils")(a,e,f,j)),o=m.filteredRecs,p=m.reorderRecs;m=m.updates;m=(yield (l||(l=b("Promise"))).all(m));m=m.filter(function(a){return(a==null?void 0:a.associationType)!=null});d("WAWebMsgCollection").MsgCollection.makeParentMessagesVisibleInChat(m);if(o.length===0&&p.length===0){if(a&&f.pendingMsgsDone===!0){m=(m=d("WAWebChatCollection").ChatCollection.get(a))!=null?m:c("WAWebNewsletterCollection").get(a);m&&(m.pendingMsgs=!1)}return e.map(function(a){return d("WAWebMsgCollection").MsgCollection.get(a.id)}).filter(Boolean)}if(!a)return n(o).then(function(){return e.reduce(function(a,b){b=d("WAWebMsgCollection").MsgCollection.get(b.id);b!=null&&d("WAWebFrontendMsgGetters").getChat(b)!=null&&a.push(b);return a},[])});m=e[0];if(d("WAWebMsgGetters").getIsStatus(m)){var q;q=(q=d("WAWebMsgGetters").getSender(m))!=null?q:m.from;c("WAWebWid").isStatus(a)&&(q=m.id.fromMe?d("WAWebLidStatusMigrationUtils").matWidConvert(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()):m.author);m=d("WAWebStatusCollection").StatusCollection.find(q)}else m=(yield d("WAWebFindChatAction").findExistingChat(a,g));var r=(yield m);q=(yield n(o));g=f.add==="after"||f.add==="last";m=!f.isHistory;var s;o=!1;var t=r.id.isBot();k=((k=r.contact.businessProfile)==null?void 0:k.isBizBot3p)===!0;if((t||k)&&f.isHistory===!1){t=r.msgs.last();(t==null?void 0:t.subtype)===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&(t==null||t["delete"]({skipUpdatingSortTime:!0}))}q.forEach(function(a){a.subtype==="biz_bot_1p_disclosure"?r.set({bizBotSystemMsgType:d("WAWebBotTypes").BizBotType.BIZ_1P}):a.subtype==="biz_bot_3p_disclosure"&&r.set({bizBotSystemMsgType:d("WAWebBotTypes").BizBotType.BIZ_3P})});f.add==="unread"?(k=j,r.msgChunks.push(k),s=f.firstUnreadKey):f.add==="last"&&f.resume===!0?(k=j,o=!0):k=typeof j==="function"?j():j;c("WAWebAddAndReorderMsgsActionsUtils")(e,q,p,r,g,k||r.msgs,s,o);f.pendingMsgsDone===!0&&(r.pendingMsgs=!1);m&&c("WAWebWid").isBroadcast(a)&&!c("WAWebWid").isStatus(a)&&q.forEach(function(a){if(!a)return;a.recvFresh&&!d("WAWebMsgGetters").getIsNotification(a)&&d("WAWebMsgModelUtils").broadcastFanout(a)});if(!((t=f.isHistory)!=null?t:!1)){j=q.map(function(a){var b,c=d("WAWebMsgGetters").getIsSentByMe(a)&&a.type===d("WAWebMsgType").MSG_TYPE.STICKER;if(!c)return;if(a.isAvatar===!0&&!d("WAWebAvatarGatingUtils").avatarsOnWebEnabled())return;c=a.mediaData;var e=a.mediaObject,f=a.id.toString();e=e==null?void 0:e.entries.entries[0];return{sticker:new(d("WAWebStickerModel").StickerModel)({id:c.filehash,directPath:c.directPath,filehash:c.filehash,encFilehash:(b=e==null?void 0:e.getEncfilehash())!=null?b:c.encFilehash,mediaKey:(b=e==null?void 0:e.getMediaKey())!=null?b:c.mediaKey,mediaKeyTimestamp:c.mediaKeyTimestamp!=null?c.mediaKeyTimestamp:d("WATimeUtils").unixTime(),width:c.fullWidth,height:c.fullHeight,size:c.size,mimetype:c.mimetype,isAvatar:a.isAvatar,type:d("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0}),timestamp:(e=a.stickerSentTs)!=null?e:0,msgId:f}}).filter(Boolean);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processed "," recent sticker messages"])),j.length);j.forEach(function(a){return d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd.addNewSticker(a.sticker,a.msgId,a.timestamp)})}p=q.map(function(a){var b=a.isNewMsg&&d("WAWebMsgGetters").getIsSentByMe(a)&&a.type===d("WAWebMsgType").MSG_TYPE.STICKER,c=a.mediaData;if(!b)return;b=a.mediaKey;if(b==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[sticker] Unexpected null media key"]))).sendLogs("sticker-unexpected-null-media-key");return}return{id:c.filehash,directPath:c.directPath,filehash:c.filehash,encFilehash:c.encFilehash,mediaKey:b,mediaKeyTimestamp:c.mediaKeyTimestamp!=null?c.mediaKeyTimestamp:d("WATimeUtils").unixTime(),width:c.fullWidth,height:c.fullHeight,size:c.size,mimetype:c.mimetype,type:d("WAWebMediaTypes").OUTWARD_TYPES.STICKER,index:0}}).filter(Boolean);d("WAWebRecentStickerCollection").RecentStickerCollection.enqueue(p);d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()&&q.filter(function(a){return!d("WAWebMsgGetters").getIsStatus(a)}).map(function(a){return d("WAWebFrontendMsgGetters").getAsAutoDownloadableMedia(a)}).filter(Boolean).forEach(function(a){d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MEDIA)});d("WAWebABProps").getABPropConfigValue("download_document_thumb_mms_enabled")&&q.map(function(a){return d("WAWebFrontendMsgGetters").getAsDoc(a)}).filter(Boolean).forEach(function(a){d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL):void c("WAWebMediaDownloadMmsThumbnail")({chat:null,msg:a,isPreload:!0})});q.map(function(a){return d("WAWebFrontendMsgGetters").getAsUrl(a)}).filter(Boolean).forEach(function(a){if(d("WAWebMediaLinkPreviewUtils").hqLinkPreviewExpired(a.t))return;d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL,null):void c("WAWebMediaDownloadMmsThumbnail")({msg:a,isPreload:!0,chat:null})});if(d("WAWebABProps").getABPropConfigValue("download_status_thumb_mms_enabled")){g=d("WAWebUserPrefsGeneral").getLastStatusUsage();k=1e3*60*60*24;(g==null||Date.now()-g<14*k)&&q.filter(function(a){return d("WAWebMsgGetters").getIsStatus(a)}).map(function(a){return d("WAWebFrontendMsgGetters").getAsImage(a)||d("WAWebFrontendMsgGetters").getAsVideo(a)}).filter(Boolean).forEach(function(a){d("WAWebMiscGatingUtils").webMediaAutoDownloadEnabled()?d("WAWebMediaAutoDownloadQueue").AutoDownloadQueue.enqueue(a,d("WAWebMediaAutoDownloadQueue").AutoDownloadTypes.MMS_THUMBNAIL):void d("WAWebMedia").downloadStatusThumbnail({msg:a,isPreload:!0})})}return e.map(function(a){return d("WAWebMsgCollection").MsgCollection.get(a.id)}).filter(Boolean)});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebMsgCollection").MsgCollection.add(a,{merge:!0});c=c.reduce(function(b,c,e){c==null&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Get empty message with id ","."])),a[e].id).sendLogs("msgPrepWork-empty-message");c!=null&&c.subtype!=="is_hosted_group"&&b.push(c);return b},[]);yield (l||(l=b("Promise"))).all(c.map(function(a){return a.waitForPrep()["catch"](function(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed! ",""])),String(a)).devConsole(a).sendLogs("bad-msg-prep")})}));return c});return o.apply(this,arguments)}g._processMultipleMessages=a}),98);
__d("WAWebRevokeMsgConstants",["WATimeUtils"],(function(a,b,c,d,e,f,g){a=2.5*d("WATimeUtils").DAY_SECONDS;b=12*d("WATimeUtils").HOUR_SECONDS;c=30*d("WATimeUtils").DAY_SECONDS;g.REVOKE_WINDOW=a;g.REVOKE_WINDOW_RECEIVER_MARGIN=b;g.NEWSLETTER_REVOKE_WINDOW=c}),98);
__d("WAWebSendRevokeMessageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({SendRevokeMessage:[1348,{messageMediaType:[2,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[1,d("WAWebWamEnumMessageType").MESSAGE_TYPE],revokeSendDelay:[3,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{SendRevokeMessage:[]});g.SendRevokeMessageWamEvent=a}),98);
__d("WAWebRevokeMsgAction",["Promise","WAJobOrchestratorTypes","WALogger","WATimeUtils","WAWebAck","WAWebAddonProcessRevoke","WAWebApiChat","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebBotGating","WAWebChatGetters","WAWebCmd","WAWebDBProcessMessage","WAWebDBStoreRevokeMsgs","WAWebErrorType","WAWebFrontendMsgGetters","WAWebFtsClient","WAWebLabelCollection","WAWebMedia","WAWebMessageAssociationGatingUtils","WAWebMessageSendPerfReporter","WAWebMsgActionCapability","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgModelUtils","WAWebMsgType","WAWebNoop","WAWebOrchestratorNonPersistedJob","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebRevokeMsgConstants","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","WAWebSendRevokeMessageWamEvent","WAWebSimpleSignalPNToFBIDMigration","WAWebStateUtils","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime","err","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function a(a,b,c){return a.type==="message"?p({type:"message",data:d("WAWebStateUtils").unproxy(a.data)},b,c):p(a,b,c)}function o(a,b){return s(d("WAWebStateUtils").unproxy(a),b)}function p(a,b,c,d){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h;g===void 0&&(g=!1);var i=a.data;if(e===d("WAWebCmd").Revoke.Sender&&!i.id.fromMe&&!d("WAWebMsgActionCapability").canBotResponseBeRevokeByInvoker(i))return(n||(n=b("Promise"))).reject(c("err")("revoking received message"));var j=i.id.remote.isGroup()&&a.type==="addon"?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow();h=i.id.remote.isGroup()&&((h=d("WAWebFrontendMsgGetters").getChat(i).groupMetadata)==null?void 0:h.isLidAddressingMode);var p=void 0;i.id.remote.isGroup()&&(p=h===!0?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():j);var q=new(c("WAWebMsgKey"))({id:yield c("WAWebMsgKey").newId(),remote:i.id.remote,fromMe:!0,participant:p}),s=r(e),t=d("WATimeUtils").unixTime(),u=t-d("WAWebMsgGetters").getT(i),v={id:q,from:h===!0?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():j,to:i.id.remote,author:p,t:t,type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:r(e),protocolMessageKey:i.id,clearMedia:!!f,local:!0,revokeDuration:u,revokeTimestamp:t,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE};if(a.type==="addon")return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a.data;if(b.kind!==d("WAWebMsgType").MsgKind.CommentDecrypted)throw c("err")("_sendRevoke: only decrypted comment can be revoked from the UI");var e=babelHelpers["extends"]({},v,{kind:d("WAWebMsgType").MsgKind.ProtocolAddonRevoke,targetMessageKey:b.parentMsgKey,revokeAddonType:b.type}),f=(yield d("WAWebSendMsgRecordAction").sendAddonRecord(e)),g=f.messageSendResult;g===d("WAWebSendMsgResultAction").SendMsgResult.OK?(new(d("WAWebSendRevokeMessageWamEvent").SendRevokeMessageWamEvent)({messageType:d("WAWebWamMsgUtils").getWamMessageType(i),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(i),revokeSendDelay:u}).commit(),yield d("WAWebAddonProcessRevoke").processSentRevokeMsg(babelHelpers["extends"]({},e,{t:d("WAWebMsgGetters").getT(i),ack:d("WAWebAck").ACK.SENT}),b)):d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["failed to send revoke addon"]))).tags("addons","messaging").sendLogs("failedSendRevokeMsg: "+b.type);return f}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted();var w=babelHelpers["extends"]({},v);if(d("WAWebBotGating").isBotEnabled()){h=null;e=(p=i.mentionedJidList)==null?void 0:p.find(function(a){return a.isBot()});f=d("WAWebMsgGetters").getSender(i);f&&f.isBot()?h=f:e!=null&&i.isForwarded!==!0&&(h=e);if(h!=null){h=(p=d("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidInvoke(h))!=null?p:h}w.botRespOrInvocationRevokeBotWid=h;i.botTargetSenderJid instanceof c("WAWebWid")&&(w.botTargetSenderJid=i.botTargetSenderJid)}var x=new(d("WAWebMsgModel").Msg)(w);x.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:x.to,mediaType:x.getWamMediaType(),messageType:x.getWamMessageType()});x.wamMessageSendPerfReporter.setIsRevokeMessage(!0);return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessage",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e;(e=x.wamMessageSendPerfReporter)==null||e.startSavedStage();yield d("WAWebDBProcessMessage").storeMessages([w],d("WAWebFrontendMsgGetters").getChat(i).id);(e=x.wamMessageSendPerfReporter)==null||e.postSavedStage()}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["_sendRevoke: failed to storeMessages into storage"]))).verbose().devConsole(a).sendLogs("storeMessages failed");throw a}e=(yield d("WAWebSendMsgRecordAction").sendMsgRecord(x));e=e.messageSendResult;if(g){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["_sendRevoke path for associated with bot plugin msg"])));throw c("err")("Expected exit for associated with bot plugin msg")}if(e===d("WAWebSendMsgResultAction").SendMsgResult.OK){new(d("WAWebSendRevokeMessageWamEvent").SendRevokeMessageWamEvent)({messageType:d("WAWebWamMsgUtils").getWamMessageType(i),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(i),revokeSendDelay:u}).commit();return d("WAWebDBStoreRevokeMsgs").processRevokeMsgs([{revokeMsgKey:i.id,newMsgKey:q,timestamp:d("WAWebMsgGetters").getT(i),revokeTimestamp:t,subtype:s,sender:j,disappearingModeInitiator:i.disappearingModeInitiator,ephemeralDuration:i.ephemeralDuration,ephemeralSettingTimestamp:i.ephemeralSettingTimestamp,viewMode:x.viewMode}]).then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([i.id.toString()]);yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(d("WAWebFrontendMsgGetters").getChat(i).id.toString(),[i.id.toString()]));o(a.data,{msgKey:q,subtype:s,sender:j,revokeTimestamp:t,viewMode:x.viewMode});return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK}}))}return(n||(n=b("Promise"))).resolve({messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN})}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()});return q.apply(this,arguments)}function e(a,b){void p({type:"message",data:d("WAWebStateUtils").unproxy(a)},b,!1,!0)["catch"](function(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[bot revoke] sendAssociatedBotPluginRevoke: ",""])),a.message)})}function f(a,b,c){return p({type:"message",data:d("WAWebStateUtils").unproxy(a)},b,c,!1)}function r(a){switch(a){case d("WAWebCmd").Revoke.Sender:return"sender_revoke";case d("WAWebCmd").Revoke.Admin:return"admin_revoke"}}function s(a,b){var e,f,g=d("WAWebFrontendMsgGetters").getMaybeChat(a),h=g!=null&&d("WAWebChatGetters").getIsNewsletter(g)?d("WAWebRevokeMsgConstants").NEWSLETTER_REVOKE_WINDOW:d("WAWebRevokeMsgConstants").REVOKE_WINDOW;h=h+d("WAWebRevokeMsgConstants").REVOKE_WINDOW_RECEIVER_MARGIN;h=d("WATimeUtils").unixTime()-a.t<=h;if(!h){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["revoke: outside of revoke window, "," has not been revoked"])),a.id.toString());return}d("WAWebLabelCollection").LabelCollection.removeAllLabelsMD(a);d("WAWebMsgModelUtils").typeIsMms(a)&&d("WAWebMedia").deregisterMsg(a);g==null||g.removeFromCollection(a);a.trigger("revoked");d("WAWebMsgGetters").clearMsgGetterCacheFor(a);d("WAWebFrontendMsgGetters").clearFrontendMsgGetterCacheFor(a);var k=a.getCollection();h=a.id;a.msgChunk&&a.msgChunk.replaceId(h,b.msgKey);k.replaceId(h,b.msgKey);e=(e=g==null?void 0:g.isUnreadMsg(a))!=null?e:!1;f=(f=g==null?void 0:g.isActiveUnreadMsg(a))!=null?f:!1;var l=a.associationType;if(l!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){l=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(l);l&&l.processorType===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&a.detachAssociatedMsg()}l={isOverwrittenByRevoke:!0,id:b.msgKey,type:d("WAWebMsgType").MSG_TYPE.REVOKED,subtype:b.subtype==="admin_revoke"?"admin":"sender",revokeSender:b.sender,revokeTimestamp:b.revokeTimestamp,protocolMessageKey:h,body:void 0,caption:void 0,clientUrl:void 0,deprecatedMms3Url:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,doNotPlayInline:void 0,paymentLinkMetadata:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,groupMentions:void 0,vcardList:void 0,star:!1,kicState:void 0,kicTimestampMs:void 0,kicKey:void 0,errorCode:d("WAWebErrorType").SendFailureErrorCode.NoError,isSendFailure:!1,viewMode:(l=b.viewMode)!=null?l:d("WAWebViewMode.flow").ViewModeType.VISIBLE,associationType:void 0,parentMsgKey:void 0};a.set(l);a.trigger("change:msgKey",{newKey:b.msgKey,oldKey:h});g&&(h.equals(g.lastReceivedKey)&&(g.lastReceivedKey=b.msgKey),g.composeQuotedMsg===a&&(g.composeQuotedMsg=null),e&&(g.unreadCount=Math.max(g.unreadCount-1,0),g.unreadDividerOffset+=1,d("WAWebApiChat").reduceChatUnreadCount(g.id.toString())),f&&(g.activeUnreadCount=Math.max(g.activeUnreadCount-1,0)));if(c("WAWebWid").isBroadcast(h.remote)){l=d("WAWebMsgModelUtils").getBroadcastFanoutKeys(h);e=d("WAWebMsgModelUtils").getBroadcastFanoutKeys(b.msgKey);if(!l||!e||l.length!==e.length){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["cannot fanout revoke: "," ",""])),String(l),String(e)).devConsole(l,e);return}c("lodash").zip(l,e).forEach(function(a){var c=k.get(a[0]);c&&o(c,{msgKey:a[1],subtype:b.subtype,sender:b.sender})});d("WAWebFtsClient").ftsClient.purge([String(a.rowId)])["catch"](c("WAWebNoop"));f=g?g.id.toString():a.id.remote.toString();d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([h.toString()]);d("WAWebPersistedJobManager").getJobManager().fireAndForget(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(f.toString(),[h.toString()]))}}g.sendRevoke=a;g.revoke=o;g.sendAssociatedBotPluginRevoke=e;g.sendAssociatedChildMsgRevoke=f}),98);
__d("WAWebCodeMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableCode,{selectable:a,appTextTemplate:"```${appText}```",children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebExtractRangeFromMatch",[],(function(a,b,c,d,e,f){function a(a,b){b===void 0&&(b=0);var c=a.index,d=a[0],e=c+d.length-1;e=[c,c,e,e,a];if(b){b=(a=a[b])!=null?a:"";e[1]=c+d.indexOf(b);e[2]=e[1]+b.length-1}return e}f["default"]=a}),66);
__d("WAWebExtractRangesUsingRegex",["WAWebExtractRangeFromMatch"],(function(a,b,c,d,e,f,g){function a(a,b,d,e){d===void 0&&(d=0);var f=[];b.lastIndex=0;var g;while((g=b.exec(a))&&b.lastIndex>0)e&&(g=e(g,b)),g&&f.push(c("WAWebExtractRangeFromMatch")(g,d));return f}g["default"]=a}),98);
__d("WAWebFormatMutator",["err"],(function(a,b,c,d,e,f,g){a=function(){function a(){}a.match=function(a,b,d){throw c("err")("Subclasses of `Mutator` must override `match()`")};a.mutate=function(a,b,c){return a};return a}();a.nestable=function(){return!0};a.format=!0;a.fragment=!1;a.compatibility=!1;a.mutates=!1;g["default"]=a}),98);
__d("WAWebCreateRegexMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator"],(function(a,b,c,d,e,f,g){function a(a,b,d){b===void 0&&(b=0);return function(e){function f(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(f,e);f.match=function(e){return c("WAWebExtractRangesUsingRegex")(e,a,b,d)};return f}(c("WAWebFormatMutator"))}g["default"]=a}),98);
__d("WAWebCodeFormatMutator",["WAWebCodeMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j=/```([\s\S]*?\S[\s\S]*?)```/g;a=c("WAWebCreateRegexMutator")(j,1);b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){b=d.selectable;d=b===void 0?!1:b;return i.jsx(c("WAWebCodeMutatorComponent.react"),{selectable:d,children:a})};return b}(a);b.format=!1;d=function(a){return a.replace(j," ")};g.Code=b;g.removeCodeBlocks=d}),98);
__d("WAWebProcessAddonsJob",["WAJobOrchestratorTypes","WAWebDBProcessEditProtocolMsgs","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("processEditProtocolMsgs",function(a){return d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(a.msgs)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgs:a});yield a});return h.apply(this,arguments)}g.processEditProtocolMsgsJob=a}),98);
__d("WAWebSendMessageEditAction",["PaymentLink","Promise","WAJobOrchestratorTypes","WALogger","WANullthrows","WATimeUtils","WAWebChatGetters","WAWebCodeFormatMutator","WAWebDBMessageDelete","WAWebDBMsgUtils","WAWebDBProcessMessage","WAWebDBUpdateMessageTable","WAWebErrorType","WAWebFrontendMsgGetters","WAWebLidMigrationUtils","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMessageSendPerfReporter","WAWebMessageSendReporter","WAWebMessagingGatingUtils","WAWebMsgActionCapability","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgInfoUtils","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgModel","WAWebMsgModelFromData","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebNewsletterSendMsgAction","WAWebOrchestratorNonPersistedJob","WAWebProcessAddonsJob","WAWebSendMsgRecordAction","WAWebSendMsgResultAction","WAWebStateUtils","WAWebViewMode.flow","WAWebWamMsgUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){d("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:a.t,editTsInSeconds:c,msgKey:a.id})?yield b.updateErrorCode(d("WAWebErrorType").SendFailureErrorCode.NoError):(yield a.updateErrorCode(d("WAWebErrorType").SendFailureErrorCode.EditWindowExpired),yield b.updateErrorCode(d("WAWebErrorType").SendFailureErrorCode.EditWindowExpired))});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b!=null&&(yield d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,{count:b}))});return s.apply(this,arguments)}function a(a){var c=d("WAWebMsgGetters").getLatestEditMsgKey(a);return c==null||!d("WAWebMsgActionCapability").canEditText(a)?(o||(o=b("Promise"))).resolve():d("WAWebDBMsgUtils").getMsgByMsgKey(c).then(function(b){if(b)return w(d("WAWebStateUtils").unproxy(a),d("WAWebMsgModelFromData").msgModelFromMsgData(b))})["catch"](function(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][resendLatestEdit] re-sending edit protocol message failed, the last edited msg was not found"]))).devConsole({error:a})})}function e(a,e,f){if(d("WAWebMsgGetters").getIsNewsletterMsg(a)?!d("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():!d("WAWebMessageEditGatingUtils").sendTextEditEnabled()){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] send is disabled, "," will not be edited"])),a.id.toString());return(o||(o=b("Promise"))).resolve()}d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] handle send message edit"]))).devConsole({msg:a,text:e,options:f});if(!d("WAWebMsgActionCapability").canEditText(a)&&!d("WAWebMsgActionCapability").canEditCaption(a))return(o||(o=b("Promise"))).reject(c("err")("Cannot edit message"));e=t(d("WAWebStateUtils").unproxy(a),e,f);return y(d("WAWebStateUtils").unproxy(a),e)}function t(a,b,e){var f=d("WAWebFrontendMsgGetters").getChat(a),g=d("WAWebLidMigrationUtils").getMeUserLidOrJidForChat(f,d("WAWebMsgKeyUtils").TranslateMsgKeyType.EditMessage);f=d("WAWebChatGetters").getIsGroup(f)?d("WAWebWidFactory").asUserWidOrThrow(g):void 0;f=new(c("WAWebMsgKey"))({id:c("WAWebMsgKey").newId_DEPRECATED(),remote:a.id.remote,fromMe:!0,participant:f});var h=e.linkPreview,i=e.mentionedJidList;e=e.groupMentions;g={id:f,from:g,to:a.id.remote,type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,protocolMessageKey:a.id,local:!0,t:d("WATimeUtils").unixTime(),mentionedJidList:i,groupMentions:e,latestEditMsgKey:f,latestEditSenderTimestampMs:d("WATimeUtils").unixTimeMs(),editMsgType:a.type,errorCode:d("WAWebErrorType").SendFailureErrorCode.NoError,messageSecret:d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()?a.messageSecret:null};switch(c("WANullthrows")(d("WAWebMessageEditUtils").getMsgEditType(a.type))){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:g=babelHelpers["extends"]({},g,{body:b.trim(),title:(i=h==null?void 0:h.title)!=null?i:void 0,matchedText:(e=h==null?void 0:h.matchedText)!=null?e:void 0,description:h==null?void 0:h.description,thumbnail:(f=h==null?void 0:h.thumbnail)!=null?f:void 0,richPreviewType:h==null?void 0:h.richPreviewType,doNotPlayInline:h==null?void 0:h.doNotPlayInline,inviteGrpType:h==null?void 0:h.inviteGrpType,thumbnailDirectPath:h==null?void 0:h.thumbnailDirectPath,thumbnailSha256:h==null?void 0:h.thumbnailSha256,thumbnailEncSha256:h==null?void 0:h.thumbnailEncSha256,thumbnailHeight:h==null?void 0:h.thumbnailHeight,thumbnailWidth:h==null?void 0:h.thumbnailWidth,mediaKey:(a=h==null?void 0:h.mediaKey)!=null?a:void 0,mediaKeyTimestamp:(i=h==null?void 0:h.mediaKeyTimestamp)!=null?i:void 0,paymentLinkMetadata:(e=d("PaymentLink").getPaymentLinkMessageMetadata(h,d("WAWebCodeFormatMutator").removeCodeBlocks(b)))!=null?e:void 0});break;case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:g=babelHelpers["extends"]({},g,{caption:b.trim()});break;case d("WAWebMessageEditUtils").MsgEditType.EventEdit:case d("WAWebMessageEditUtils").MsgEditType.RichResponseEdit:break}return g}function u(a,b,c,d){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a.latestEditMsgKey&&(yield d("WAWebDBMessageDelete").removeMessagesFromHistory([a.latestEditMsgKey.toString()]));try{e.startSavedStage(),yield d("WAWebDBProcessMessage").storeMessages([b],c),e.postSavedStage()}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMessageEdit] failed to store protocol msg data in message table"]))).verbose().devConsole(a).sendLogs("storeSentMessageEdit failed");throw a}e.startRenderedStage();yield d("WAWebProcessAddonsJob").processEditProtocolMsgsJob([b]);e.postRenderedStage()});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebMsgGetters").getIsNewsletterMsg(a)?yield d("WAWebNewsletterSendMsgAction").sendNewsletterEditMsg(a,b):yield d("WAWebSendMsgRecordAction").sendMsgRecord(b),e=c.messageSendResult,f=c.t;c=c.count;d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] edit protocol msg sent with result"]))).devConsole({messageSendResult:e,t:f});if(e!==d("WAWebSendMsgResultAction").SendMsgResult.OK){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] failed to send edit protocol message"]))).devConsole({editProtocolMsg:b});return}yield p(a,b,f);yield r(a,c);void a.updateAck(b.ack);a.isSendFailure=b.isSendFailure===!0||b.errorCode===d("WAWebErrorType").SendFailureErrorCode.EditWindowExpired;d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[message-edit][sendMsgEditRecord] parent msg status to send edit protocol message"]))).devConsole({msg:a})});return x.apply(this,arguments)}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e,f=new(d("WAWebMsgModel").Msg)(c),g=d("WAWebFrontendMsgGetters").getChat(a);e=Boolean((e=g.groupMetadata)==null?void 0:e.isLidAddressingMode);e=d("WAWebWamMsgUtils").msgIsLid(a,g.id,e);g=d("WAWebMsgInfoUtils").getGroupMessageSendReporterOptions(g.id,e);g.originalMessage=a;f.wamMessageSendReporter=new(d("WAWebMessageSendReporter").MessageSendReporter)(f,g);f.wamMessageSendPerfReporter=new(d("WAWebMessageSendPerfReporter").MessageSendPerfReporter)({chatWid:f.to,mediaType:f.getWamMediaType(),messageType:f.getWamMessageType()});var h=f.wamMessageSendPerfReporter;yield d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("sendMessageEdit",function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var d=b.msgData;b=b.chatId;yield u(d,c,b,h);yield w(a,f)});return function(a){return d.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgData:d("WAWebMsgDataFromModel").msgDataFromMsgModel(a),chatId:d("WAWebFrontendMsgGetters").getChat(a).id})});return z.apply(this,arguments)}g.resendLatestEdit=a;g.sendMessageEdit=e;g.createEditMsgData=t;g.addAndSendMessageEdit=y}),98);
__d("WAWebContactBlockedErrorAction",["WACustomError"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,c){b=a.call(this,b)||this;b.contact=c;return b}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("ContactBlocked"));g["default"]=a}),98);
__d("WAWebOutgoingMessageTone",["WAWebNoop","WAWebUserPrefsNotifications","bx"],(function(a,b,c,d,e,f,g){var h=new window.Audio(c("bx").getURL(c("bx")("9562")));function a(){d("WAWebUserPrefsNotifications").getOutgoingMessageSound()&&h.play()["catch"](c("WAWebNoop"))}g.playOutgoingMessageTone=a}),98);
__d("WAWebChatUtmCache",[],(function(a,b,c,d,e,f){a=function(){function a(){this.utmReadChatIds=new Set()}var b=a.prototype;b.deleteChatId=function(a){this.utmReadChatIds["delete"](a)};b.hasRead=function(a){return this.utmReadChatIds.has(a)};b.read=function(a){this.utmReadChatIds.add(a)};b.clearAll=function(){this.utmReadChatIds.clear()};return a}();b=new a();f["default"]=b}),66);
__d("WAWebUtmBizPrefs",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(a,b){var e=h(),f=Date.now();e[a]=babelHelpers["extends"]({addedTime:f},b);c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify(e))}function b(a){var b=h();delete b[a];c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify(b))}function e(a){var b=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.CHAT_UTM);if(b==null)return null;try{return JSON.parse(b)[a]}catch(a){return null}}function h(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.CHAT_UTM);if(a==null)return{};try{return(a=JSON.parse(a))!=null?a:{}}catch(a){return{}}}function f(){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.CHAT_UTM,JSON.stringify({}))}g.persistUtmtoLocalStorage=a;g.removeUtmFromLocalStorage=b;g.getUtmFromLocalStorage=e;g.getAllUtmsFromLocalStorage=h;g.clearAllUtmFromLocalStorage=f}),98);
__d("WAWebUpdateUtmAction",["WAWebBizGatingUtils","WAWebChatUtmCache","WAWebUtmBizPrefs"],(function(a,b,c,d,e,f,g){function a(a,b){if(!d("WAWebBizGatingUtils").isUtmTrackingEnabled())return;a=a.toString();d("WAWebUtmBizPrefs").persistUtmtoLocalStorage(a,b);c("WAWebChatUtmCache").deleteChatId(a)}function b(a){a=a.toString();d("WAWebUtmBizPrefs").removeUtmFromLocalStorage(a);c("WAWebChatUtmCache").read(a)}function e(a){if(!d("WAWebBizGatingUtils").isUtmTrackingEnabled())return null;a=a.toString();if(c("WAWebChatUtmCache").hasRead(a))return null;var b=d("WAWebUtmBizPrefs").getUtmFromLocalStorage(a);b==null&&c("WAWebChatUtmCache").read(a);return b}g.addUtmToChat=a;g.clearUtmAfterMessageSent=b;g.getUtmForChat=e}),98);
__d("WAWebUtmBizUtils",["WAWebBizGatingUtils","WAWebMsgGetters","WAWebStateUtils"],(function(a,b,c,d,e,f,g){function a(a,b){return a.contact.isEnterprise&&!j(b)&&!h(a,b)}function h(a,b){a=i(a);if(a==null||a.t==null)return!1;a=a.t*1e3;return a>b.addedTime}function i(a){a=d("WAWebStateUtils").unproxy(a);for(var b=a.msgs.length-1;b>=0;b--){var c=a.msgs.at(b);if(c&&!d("WAWebMsgGetters").getIsSentByMe(c))return c}return void 0}function j(a){var b=Date.now(),c=d("WAWebBizGatingUtils").utmTrackingExpirationInHours()*60*60*1e3;return a.addedTime+c<=b}g.isUtmValid=a;g.hasUtmExpired=j}),98);
__d("WAWebSendMsgRecordAction",["Promise","WAErrors","WAFilteredCatch","WALogger","WANullthrows","WAWebABProps","WAWebAck","WAWebAddOnsUpdateSendStatesAction","WAWebAddonSendMsgData","WAWebBackendErrors","WAWebBlocklistCollection","WAWebBotGenTypingIndicatorMsg","WAWebCommonMsgSubtypeTypes","WAWebConstantsDeprecated","WAWebContactBlockedErrorAction","WAWebContactCollection","WAWebExternalCtxConfig","WAWebExternalEntryPointPrefs","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebHandleMsgError","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgType","WAWebMsgUtilsBridge","WAWebNoop","WAWebOutgoingMessageTone","WAWebReactionsBEUtils","WAWebSendMsgMetricReporter","WAWebSendMsgRecordBridge","WAWebSendMsgResultAction","WAWebSendSpamChatAction","WAWebSingleEmojiDailyUtils","WAWebUpdateUnreadChatAction","WAWebUpdateUtmAction","WAWebUserPrefsMeUser","WAWebUtmBizUtils","WAWebWamEnumMessageSendResultType","WAWebWamMsgUtils","WAWebWebcMessageSendWamEvent","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendMsgRecord"])));var c=d("WAWebSendMsgMetricReporter").createMsgModelMetricReporter(a);c.sendReporter=(b=c.sendReporter)!=null?b:c.createSendReporter();b=a.id.remote;var e=(yield d("WAWebFindChatAction").findExistingChat(b,"sendMsgRecord"));if(e.contact.isEnterprise&&!d("WAWebMsgGetters").getIsGroupMsg(a)){b=d("WAWebUpdateUtmAction").getUtmForChat(b);b!=null&&d("WAWebUtmBizUtils").isUtmValid(e,b)&&(a.utm=b)}a.isNewMsg=!0;return r({type:"message",data:a},e,c)});return p.apply(this,arguments)}function e(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebSendMsgMetricReporter").createAddonMetricReporter(a),c=(yield d("WAWebFindChatAction").findExistingChat(a.id.remote,"sendMsgRecord"));return r({type:"addon",data:a},c,b)});return q.apply(this,arguments)}function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=a.data,h=c("WANullthrows")(g.to),p=g.id,q=p.remote;c("WAWebWid").isGroup(h)&&(yield c("WAWebGroupMetadataCollection").find(h));e.isTrusted()||d("WAWebSendSpamChatAction").sendNotSpam(e)["catch"](c("WAWebNoop"));var r=g.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&["sender_revoke","admin_revoke"].includes(g.subtype),s=g.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&g.subtype===d("WAWebCommonMsgSubtypeTypes").MsgSubtype.EphemeralSyncResponse,t=d("WAWebMsgGetters").getIsReaction(g)&&g.reactionText===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT;if(!d("WAWebMsgGetters").getIsGroupMsg(g)&&!r&&!t&&d("WAWebBlocklistCollection").BlocklistCollection.get(h))return(o||(o=b("Promise"))).reject(new(c("WAWebContactBlockedErrorAction"))("Contact is blocked",d("WAWebContactCollection").ContactCollection.assertGet(h)));var u;r||(u=new(d("WAWebWebcMessageSendWamEvent").WebcMessageSendWamEvent)({messageType:d("WAWebWamMsgUtils").getWamMessageType(g),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(g),messageIsForward:Boolean(g.isForwarded)}));s||void d("WAWebUpdateUnreadChatAction").sendSeen(e);a.type!=="addon"&&g.type!==d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT&&!s&&!r&&d("WAWebMsgCollection").MsgCollection.trigger(c("WAWebConstantsDeprecated").NEW_MSG_SENT);return(o||(o=b("Promise"))).resolve().then(function(){return a.type==="message"?d("WAWebSendMsgRecordBridge").sendMsgRecord(a.data,f):d("WAWebAddonSendMsgData").sendAddonProcess(a.data,f)}).then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=p.fromMe&&d("WAWebUserPrefsMeUser").isMePrimary(q)?d("WAWebAck").ACK.READ:d("WAWebAck").ACK.SENT;a.type==="message"&&(void a.data.updateAck(f),d("WAWebAddOnsUpdateSendStatesAction").maybeUpdateAddOnAckForMsgAction(a.data,f));d("WAWebBotGenTypingIndicatorMsg").maybeGenBotTypingIndicatorMessage(e,g);u&&(u.markMessageSendT(),u.commit());!r&&d("WAWebABProps").getABPropConfigValue("single_emoji_logging_enabled")&&d("WAWebSingleEmojiDailyUtils").maybeIncrementSingleEmojiDailyStatsCount(g);g.utm!=null&&d("WAWebUpdateUtmAction").clearUtmAfterMessageSent(q);yield d("WAWebMsgUtilsBridge").logMessageSendForChatThreadLogging(g);[d("WAWebMsgType").MSG_TYPE.PROTOCOL,d("WAWebMsgType").MSG_TYPE.REACTION,d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT].includes(g.type)||(e.lastReceivedKey=p);!c("gkx")("26258")&&!r&&!s&&d("WAWebOutgoingMessageTone").playOutgoingMessageTone();d("WAWebExternalCtxConfig").isCtxLoggingEnabled()&&d("WAWebExternalEntryPointPrefs").deleteExternalEntryPoint(q);return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.OK,t:b.t,count:b.count}});return function(a){return f.apply(this,arguments)}}())["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,function(a){a.status!==408&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Phone responded ",""])),a.status).sendLogs("send-not-200");(a=f.sendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_NETWORK,isTerminal:!1});f.sendReporter=null;return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_NETWORK}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAErrors").BufferTooLargeError,function(){var a;(a=f.sendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_PAYLOAD_TOO_BIG,isTerminal:!0});f.sendReporter=null;return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebHandleMsgError").MessageValidationError,function(){var a;(a=f.sendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_INVALID_PROTOBUF,isTerminal:!0});f.sendReporter=null;return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebHandleMsgError").MessageSentAckError,function(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["model:msg:createRecord dropped msg: ",""])),g.id.toString()).devConsole(g.type);d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(a)).devConsole(a).sendLogs("send-msg-server-nack-error");(a=f.sendReporter)==null||a.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0});f.sendReporter=null;return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}}))["catch"](function(b){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["model:msg:createRecord dropped msg: ",""])),g.id.toString()).devConsole(g.type);a.type==="message"?d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(b)).devConsole(b).tags("messaging").sendLogs("send-msg-error"):d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Got error ",""])),String(b)).tags("messaging","addons").sendLogs("send-addon-error: "+g.type);(b=f.sendReporter)==null||b.postFailure({result:d("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.ERROR_UNKNOWN,isTerminal:!0});f.sendReporter=null;return{messageSendResult:d("WAWebSendMsgResultAction").SendMsgResult.ERROR_UNKNOWN}})});return s.apply(this,arguments)}g.sendMsgRecord=a;g.sendAddonRecord=e}),98);
__d("WAWebUpdateMessageUIAction",["WALogger","WAWebBackendErrors","WAWebCommonMsgUtils","WAWebDBProcessMessage","WAWebHandleForMessageRange","WAWebHandleForMessageRangeEnums","WAWebHandleMsgTypes.flow","WAWebMsgCollection","WAWebMsgGetters","WAWebStatusCollection","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){e===void 0&&(e=d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE);f===void 0&&(f=!0);g===void 0&&(g=!1);e={add:"after",update:e!==d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,isHistory:!1};g=!g;g=(yield d("WAWebHandleForMessageRange").handleForActiveMessageRange(a,b,g));if(g.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage))return;g=g.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.SkipUI);var k=d("WAWebMsgCollection").MsgCollection.get(b.id);k&&((d("WAWebCommonMsgUtils").isPlaceholderMsg(k.type)||d("WAWebCommonMsgUtils").isFutureproofMsg(k.type))&&!(d("WAWebCommonMsgUtils").isPlaceholderMsg(b.type)||d("WAWebCommonMsgUtils").isFutureproofMsg(b.type))||d("WAWebCommonMsgUtils").isRichResponseMsg(k.type)&&d("WAWebCommonMsgUtils").isSomewhatParsedRichResponseMsg(b)?e.update=!0:k.fromQuotedMsg?d("WAWebMsgCollection").MsgCollection.remove(k):g=!0);try{d("WAWebMsgGetters").getIsStatus(b)&&d("WAWebStatusCollection").StatusCollection.handleUpdate(b,!1),g||(yield d("WAWebMsgCollection").MsgCollection.processMultipleMessages(a,[babelHelpers["extends"]({},b,{recvFresh:!0,isNewMsg:!0})],e,"updateMessageUIAction",null,f))}catch(e){if(e instanceof d("WAWebBackendErrors").LogoutDrop)return;if(e instanceof d("WAWebDBProcessMessage").PreviousMsgNotUpdatableError){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: PreviousMsgNotUpdatableError"])),String(b.id),String(a));return}!c("gkx")("26258")?d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(b.id),String(a),e.name,e.message,e.stack).tags("messaging").devConsole(e).sendLogs("msg_handler for MD: error storing/processing single message"):d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(b.id),String(a),e.name,e.message,e.stack).tags("messaging").devConsole(e)}});return k.apply(this,arguments)}function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebMsgCollection").MsgCollection.get(a.id);a!=null&&a["delete"]()});return l.apply(this,arguments)}g.updateUI=a;g.removePlaceholder=e}),98);
__d("WAWebHandleAddChats",["Promise","WAAsyncSleep","WALogger","WALongInt","WAWebABProps","WAWebBackendApi","WAWebChatConstants","WAWebCollectionConstants","WAWebConnModel","WAWebLid1X1MigrationGating","WAWebLogoutReasonConstants","WAWebMobilePlatforms","WAWebSchemaChat","WAWebSchemaMessage","WAWebSocketLogoutJob","asyncToGeneratorRuntime","isEmptyIterable"],(function(a,b,c,d,e,f,g){var h=["pendingInitialLoading","disappearingModeInitiator","disappearingModeTrigger","accountLid"],i,j,k,l,m,n;function o(a){return{ephemeralSettingTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.ephemeralSettingTimestamp),tcTokenSenderTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.tcTokenSenderTimestamp),tcTokenTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.tcTokenTimestamp)}}function p(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return;try{a=a.filter(function(a){return a.id.isRegularUser()&&a.accountLid==null});a.length>0&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: no account_lid for "," chats. first: ",""])),a.length,a[0].id.toLogString()).sendLogs("add-chats-no-account-lid").tags("missing-lid")}catch(a){}}function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: "," chats"])),a.length);p(a);return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a.map(function(a){a.pendingInitialLoading;var b=a.disappearingModeInitiator,c=a.disappearingModeTrigger,d=a.accountLid,e=babelHelpers.objectWithoutPropertiesLoose(a,h);e=babelHelpers["extends"]({},e,{id:a.id.toString(),muteExpiration:0,isAutoMuted:!1},o(e),{endOfHistoryTransferType:a.endOfHistoryTransferType});d!=null&&(e.accountLid=d.toString());b!=null&&(e.disappearingModeInitiator=b);c!=null&&(e.disappearingModeTrigger=c);return e}))["catch"](function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){return r(b,a)});return function(a){return c.apply(this,arguments)}}()).then(function(){return d("WAWebBackendApi").frontendSendAndReceive("chatCollectionAdd",{things:a.map(function(a){var b;return babelHelpers["extends"]({},a,{accountLid:(b=a.accountLid)!=null?b:void 0},o(a),{endOfHistoryTransferType:d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.cast(a.endOfHistoryTransferType)})}),options:{merge:!0}})}).then(function(){(d("WAWebConnModel").Conn.platform===d("WAWebMobilePlatforms").PLATFORMS.IPHONE||d("WAWebConnModel").Conn.platform===d("WAWebMobilePlatforms").PLATFORMS.SMBI)&&(c("isEmptyIterable")(a)?d("WAWebBackendApi").frontendFireAndForget("msgCollectionTrigger",{name:d("WAWebCollectionConstants").COLLECTION_HAS_SYNCED}):self.setTimeout(function(){d("WAWebBackendApi").frontendFireAndForget("msgCollectionTrigger",{name:d("WAWebCollectionConstants").COLLECTION_HAS_SYNCED})},2500)),d("WAWebBackendApi").frontendFireAndForget("chatCollectionTrigger",{name:d("WAWebCollectionConstants").COLLECTION_HAS_SYNCED,args:{count:a.length}})})});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebABProps").getABPropConfigValue("wa_web_logout_db_hist_sync_failed");c&&(yield t(b));d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["handleAddChats: bulkCreateOrMerge failed: is lid migrated: "," logout: ",". error: ",""])),d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),c,a.stack).sendLogs("fail-to-add-chats-history-sync",c?{sendLogsType:d("WALogger").SendLogsType.USER_FORCEFULLY_LOGGED_OUT_SAD}:void 0);if(c){yield d("WAAsyncSleep").asyncSleep(5e3);return d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.WebFailAddChat)}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield d("WAWebSchemaChat").getChatTable().all()),e=c.map(function(a){return a.id}),f=new Set(c.map(function(a){return a.accountLid}));d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["fail-add-chat: existingChatIds: ",", existingChatAccountLids: ",""])),e,Array.from(f));var g=[];e=function*(){var a=h.accountLid;if(a==null)return 0;if(f.has(a.toString())){var b=c.find(function(b){return b.accountLid===a.toString()});if(!b)return 0;g.push(v(b.id))}};for(var h of a){a=(yield* e());if(a===0)continue}yield (n||(n=b("Promise"))).all(g)});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],a+"_",a+"_z",{lowerInclusive:!0,upperInclusive:!1,shouldDecrypt:!1}));b=b.map(function(a){return{type:a.type,subtype:a.subtype}}).map(function(a){return JSON.stringify(a)}).join(",");d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["messages pre-existing before history for chat ",": [","]"])),a,b)});return w.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebHistoryMsgHandlerAction",["Promise","WAAckLevel","WAFilteredCatch","WAJids","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebABProps","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebAdvHostedAccountTypeSystemMsg","WAWebApiContact","WAWebApiFilterAndReplaceMessages","WAWebApiHistorySyncNotification","WAWebBackendApi","WAWebBackendErrors","WAWebBackendJobs.flow","WAWebBizAiAgentGating","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebBizGatingUtils","WAWebBotTypes","WAWebChatConstants","WAWebCheckUpdateOrphanReactions","WAWebContactCollection","WAWebCountriesUtils","WAWebCryptoCurve25519","WAWebCurrentUser","WAWebDBCreateLidPnMappings","WAWebDBProcessInitialHistorySyncMessage","WAWebDBReportingTokenUtils","WAWebEphemeralityTypes","WAWebEphemeralityUtils","WAWebHandleAddChats","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebHistorySyncNotificationUtils","WAWebHistorySyncStickers","WAWebLidAwareContactsDB","WAWebLidMigrationUtils","WAWebLidStatusMigrationUtils","WAWebLimitSharingProtoUtils","WAWebMemberLabelHistorySync","WAWebMessageAssociationGatingUtils","WAWebMessageReceiptBatcher","WAWebMessagingGatingUtils","WAWebMobilePlatforms","WAWebMsgAGMProcessing","WAWebMsgKey","WAWebMsgProcessingApiUtils","WAWebMsgType","WAWebNoop","WAWebProcessMessageAssociationMessages","WAWebProtobufsAdv.pb","WAWebProtobufsE2E.pb","WAWebProtobufsHistorySync.pb","WAWebReportingTokenUtils","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSyncBootstrap","WAWebSyncdOrphan","WAWebUserPrefsHistorySync","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsMeUser","WAWebUserPrefsModelStorage","WAWebUserPrefsMultiDevice","WAWebUsernameTypes","WAWebVoipActionWriteCallLogSync","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;function a(a,b,c,d,e,f,g,h){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,i,j,k){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[history sync] starts hanlding initial sync msgs"])));var C=[],D={},E={},F=new Map(),G={},H=[],I=0,K=[],L=d("WAWebHistorySyncNotificationUtils").getLidMappingAsStringSet(k);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["first lid mappings for initial sync. count: ",". ","..."])),L==null?void 0:L.size,d("WAWebHistorySyncNotificationUtils").getLidsForLogging(L)).verbose();var M=new Map(),N=d("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&(yield d("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0;k=function*(a){d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing conversation "," with "," messages"])),a.id,a.messages.length);var b=d("WAWebWidFactory").createWid(a.id);if(b.isNewsletter())return 0;if(b.isUser())if(b.isLid()){var g=a.pnJid;g!=null&&C.push({lid:b,pn:d("WAWebWidFactory").createUserWidOrThrow(g)});g=a.displayName;var h=a.shareOwnPn;if(g!=null||h!=null){var i={};g!=null&&(i.displayNameLID=g);h!=null&&(i.shareOwnPn=h);f.push({lid:b,data:i})}}else if(a.lidJid!=null){g=d("WAWebWidFactory").createUserLidOrThrow(a.lidJid);C.push({lid:g,pn:b})}var j=[];I+=a.messages.length;var k=[],l=new Set(),m=[];a.messages.length===0&&(D[a.id]=-1);c("isStringNullOrEmpty")(a.pHash)||(G[a.id]=a.pHash);var n;a.messages.forEach(function(f,g){var h,i;if(g===a.messages.length-1){var o=d("WALongInt").maybeNumberOrThrowIfTooLarge(f.msgOrderId);o!=null&&(D[a.id]=o)}o=(f==null||(h=f.message)==null||(h=h.message)==null||(h=h.protocolMessage)==null?void 0:h.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE;if(o){d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping request welcome message"])));return}o=(f==null||(i=f.message)==null||(i=i.message)==null||(i=i.protocolMessage)==null?void 0:i.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE;if(o){d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Dropping memu onboarding message"])));return}if(d("WAWebMobilePlatforms").isSMB()&&d("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&g===0&&b.isUser()&&a.systemMessageToInsert!=null)switch(a.systemMessageToInsert){case d("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.E2EE_MSG:if(N)break;o=d("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(b,d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE);k.push(o);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(o);break;case d("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.NE2EE_SELF:if(!N)break;g=d("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeSelfTransitionToCoexNotificationMsg(b,d("WAWebUserPrefsMeUser").getMePnUserOrThrow());k.push(g);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(g);break;case d("WAWebProtobufsHistorySync.pb").PrivacySystemMessage.NE2EE_OTHER:o=d("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(b,d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED);k.push(o);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgHistorySyncInsert(o)}g=d("WAWebHistorySyncNotificationUtils").parseWebMsgInfoAndReturnNullOnFailure(b,f.message,e,L,M);o=((o=f.message)==null||(o=o.message)==null||(o=o.commentMessage)==null?void 0:o.targetMessageKey)==null;var p=(g==null?void 0:g.associationType)!=null;if(o){g!=null&&l.has(g.id.toString())&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&l["delete"](g==null?void 0:g.id.toString());g!=null&&g.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&g.ctwaContext!=null||k.push(g);o=(o=f.message)==null||(o=o.message)==null||(o=o.extendedTextMessage)==null||(o=o.contextInfo)==null?void 0:o.externalAdReply;var q=g!=null?g:{},r=q.id,s=q.from;q=q.to;if(o!=null&&(r==null?void 0:r.fromMe)!=null&&s!=null&&q!=null&&d("WAWebBizGatingUtils").shouldGenerateAGMMsgs(o)){r=new(c("WAWebMsgKey"))({fromMe:!r.fromMe,remote:b,id:c("WAWebMsgKey").newId_DEPRECATED()});o=d("WAWebMsgAGMProcessing").genHistoryAutomatedGreetingMsg({msgKey:r,ctwaContext:o,to:s,from:q,msgTimestamp:(r=f.message)==null?void 0:r.messageTimestamp});k.push(o)}}if(g!=null&&p&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){s=g.parentMsgKey.toString();l.add(s);m.push(g)}j=j.concat(d("WAWebAddonProcessMsgsUtils").parseHistorySyncMsg({webMsgInfo:f.message,parsedWebMsgInfo:g,isFromCag:(q=a.isDefaultSubgroup)!=null?q:!1}));(g==null?void 0:g.subtype)==="biz_bot_1p_disclosure"&&(n=d("WAWebBotTypes").BizBotType.BIZ_1P);(g==null?void 0:g.subtype)==="biz_bot_3p_disclosure"&&(n=d("WAWebBotTypes").BizBotType.BIZ_3P)});var o;if(l.size>0&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){h=d("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache(m,l);h!=null&&h.validAssociatedMsgs&&(o=d("WAWebApiFilterAndReplaceMessages").validateMsgFn(h==null?void 0:h.validAssociatedMsgs))}k=d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessagesInitialHistorySync(k,o);k=k.reverse();i=a.contactPrimaryIdentityKey;if(i&&c("WAWebWid").isUser(b)){g=d("WAWebSignalCommonUtils").bufferToStr(d("WAWebCryptoCurve25519").toSignalCurvePubKey(i));K.push({userId:d("WAWebWidFactory").asUserWidOrThrow(b),identityKey:g})}var p,q,r;if(((h=a.disappearingMode)==null?void 0:h.initiator)!=null)switch(a.disappearingMode.initiator){case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:p=d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat;q=d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;break;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:p=d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe;q=d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;r=!0;break;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:p=d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther;q=d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;r=!1;break}if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_daily_logs")){if(((i=a.disappearingMode)==null?void 0:i.trigger)!=null){g=d("WAWebEphemeralityUtils").getDisappearingModeTriggerFromProtobuf(a.disappearingMode.trigger);g!=null&&(q=g)}((h=a.disappearingMode)==null?void 0:h.initiatedByMe)!=null&&(r=a.disappearingMode.initiatedByMe)}i=a.tcToken!=null&&a.tcTokenTimestamp!=null;g=S(b,a);if(g.result==="skip-chat")return 0;else if(g.result==="extracted"){h=g.accountLid;if(F.has(h)){d("WALogger").DEV(w||(w=babelHelpers.taggedTemplateLiteralLoose(["duplicated accountLid: ",", existingChatId: ",", new chatId: ",""])),h.toString(),c("WANullthrows")(F.get(h)).toString(),b.toString());d("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: Found duplicated accountLid during initial sync"]))).sendLogs("duplicated-account-lid-in-history-sync");return 0}F.set(h,b)}if(d("WAWebCurrentUser").isEmployee()){d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["handleInitialSyncMsgs: incoming chat info: ",", ",", ",""])),b,(h=g.accountLid)!=null?h:"n/a",b.isRegularUser()?d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(b)):"n/a")}h=g.accountLid;h={t:d("WALongInt").maybeNumberOrThrowIfTooLarge((g=a.conversationTimestamp)!=null?g:a.lastMsgTimestamp),accountLid:h,id:b,unreadCount:a.unreadCount,ephemeralDuration:a.ephemeralExpiration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,disappearingModeInitiator:p,disappearingModeTrigger:q,disappearingModeInitiatedByMe:r,endOfHistoryTransferType:(g=a.endOfHistoryTransferType)!=null?g:d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,name:a.name,notSpam:a.notSpam,pendingInitialLoading:!1,unreadMentionCount:a.unreadMentionCount,tcToken:i?a.tcToken:null,tcTokenTimestamp:i?a.tcTokenTimestamp:null,tcTokenSenderTimestamp:a.tcTokenSenderTimestamp,bizBotSystemMsgType:n,isLocked:a.locked,limitSharing:d("WAWebLimitSharingProtoUtils").getLimitSharingFromProtocolHistorySyncConversation(a),capiThreadControl:d("WAWebBizAiAgentGating").isAiAgentThreadStatusHistorySyncEnabled()?a.maibaAiThreadEnabled===!0?d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN:a.maibaAiThreadEnabled===!1?d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_PASSED:a.maibaAiThreadEnabled===void 0?d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.UNKNOWN:function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+a.maibaAiThreadEnabled)}():d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.UNKNOWN};if(b.isLid()){g=a.lidOriginType;if(g!=null){i=d("WAWebUsernameTypes").LidOriginType.cast(g);i!==d("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&i!==d("WAWebUsernameTypes").LidOriginType.GENERAL&&d("WALogger").ERROR(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: invalid lidOriginType received."]))).sendLogs("handleInitialSyncMsgs: invalid lidOriginType received: "+g);h.lidOriginType=i}else h.lidOriginType=d("WAWebUsernameTypes").LidOriginType.GENERAL}a.archived!=null&&(h.archive=a.archived);try{d("WAWebHistorySyncNotificationUtils").saveGroupMetadataForLeftGroup(a,h.id)}catch(a){d("WALogger").WARN(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[history sync] history_sync_notification_handler: saveGroupMetadataForLeftGroup failed"]))).tags("history-sync").devConsole(a)}Object.prototype.hasOwnProperty.call(E,a.id)?d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[history sync] found duplicated conversation id during initial sync"]))):H.push(h);E[a.id]={chatInfo:h,msgs:k,unifiedAddons:j}};var O;for(var P of a.conversations){O=(yield* k(P));if(O===0)continue}for(O of a.accounts){k=T(O);k&&j.push(k)}C.length>0&&(d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[history sync] saving "," LIDxPN mappings obtained from conversations"])),C.length),yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:C,flushImmediately:!0,identityChangeHandlingEnabled:!1,learningSource:"other"}));g.mdBootstrapMessagesCount=I;g.mdBootstrapChatsCount=a.conversations.length;d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(g,e.historySyncStepStartedTs,!0,i);c("WAWebSyncBootstrap").markInitialHistorySyncCountDebugStats(I,H.length);var Q=0,U=[];K.forEach(function(a){var b=a.userId;a=a.identityKey;!b.isLid()&&d("WAWebApiContact").getCurrentLid(b)==null&&b.isRegularUser()&&Q++;try{var c=d("WAWebSignalCommonUtils").createSignalAddress(b).toString();b.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())?d("WAWebHistorySyncNotificationUtils").checkSelfHistorySyncIdentity(c,a)["catch"](function(){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: can't save the identity key."],["[history sync] handleInitialSyncMsgs: can\\'t save the identity key."]))).sendLogs("failed-self-identity-check-from-history-sync")}):U.push({identifier:c,identityKey:a})}catch(a){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: can't save the identity key."],["[history sync] handleInitialSyncMsgs: can\\'t save the identity key."])))}});yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkCreateIdentity(U);Q>0&&d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: there are Identities with missing LIDs: ",""])),Q).sendLogs("handleInitialSyncMsgs: there are Identities with missing LIDs",{sampling:.01});yield c("WAWebHandleAddChats")(H);yield R(E);yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(e.msgKey,e.syncType,e.chunkOrder);void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:h,startTs:e.historySyncStepStartedTs,isSuccess:!0,forceFlushWamBuffer:!0});d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial sync messages complete, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e,I,H.length));d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set history initial sync boundary with length ",""])),Object.keys(D).length);yield (J||(J=b("Promise"))).all([d("WAWebHistorySyncNotificationUtils").handleChatThreadLoggingMetadata(a),d("WAWebUserPrefsHistorySync").setHistoryInitialSyncBoundary(D),a.companionMetaNonce!=null?d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAWebCompanionMetaNonce",a.companionMetaNonce):null]);d("WAWebUserPrefsModelStorage").setInitialGroupPhash(G);d("WAWebHistorySyncNotificationUtils").reportMissingMapping(M)});return K.apply(this,arguments)}function e(a,b,c,d,e){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h){d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing status"])));f.mdBootstrapMessagesCount=a.statusV3Messages.length;d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(f,e.historySyncStepStartedTs,!0,h);a.statusV3Messages.sort(function(a,b){a=a.messageTimestamp;b=b.messageTimestamp;return d("WATimeUtils").castToUnixTime(parseInt(a,10))-d("WATimeUtils").castToUnixTime(parseInt(b,10))});var i=[];yield (J||(J=b("Promise"))).all(a.statusV3Messages.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=null,f=[];a.key.fromMe===!0?(e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=a.userReceipt.filter(function(a){return a.readTimestamp!=null&&a.readTimestamp!==0})):e=d("WAWebWidFactory").createWid(c("WANullthrows")(a.participant));e={type:d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS,externalId:c("WANullthrows")(a.key.id),ts:d("WATimeUtils").castToUnixTime(parseInt(a.messageTimestamp,10)),edit:-1,isHsm:!1,count:null,chat:d("WAWebWidFactory").createWid(d("WAJids").STATUS_JID),author:c("WANullthrows")(e),pushname:null,isDirect:!1};var g=d("WAWebBackendJobs.flow").CiphertextType.Skmsg;e=(yield d("WAWebMsgProcessingApiUtils").parseMessage({info:e,ciphertextType:g,msgProtobuf:c("WANullthrows")(a.message),hsmInfo:null}));g=e.renderableMsgs&&e.renderableMsgs;if(!g||g.length!==1)return(J||(J=b("Promise"))).resolve();e=g[0].id;var h=g[0].author,j=babelHelpers["extends"]({},g[0],{author:h?d("WAWebLidStatusMigrationUtils").matWidConvert(h):h,id:new(c("WAWebMsgKey"))({fromMe:e.fromMe,remote:e.remote,id:e.id,participant:e.participant==null?void 0:d("WAWebLidStatusMigrationUtils").matWidConvert(e.participant)})});if(a.participant==="0@s.whatsapp.net")return(J||(J=b("Promise"))).resolve();g=a.ignore===!0;g&&(j=babelHelpers["extends"]({},j,{invis:!0,ack:d("WAAckLevel").ACK.READ}));yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:j.id.remote,newMsg:j,handleSingleMsgOrigin:"historyStatusMessages"});f.forEach(function(a){var b;b=d("WALongInt").numberOrThrowIfTooLarge((b=a.readTimestamp)!=null?b:0);a=d("WAWebWidFactory").createWid(a.userJid);void d("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ts:b,ack:d("WAAckLevel").ACK.READ,receiverId:a,msgKeys:[j.id.toString()]})});if(d("WAWebMessagingGatingUtils").isReportingTagSyncingEnabled()&&((h=a.reportingTokenInfo)==null?void 0:h.reportingTag)!=null){j=babelHelpers["extends"]({},j,{reportingTokenInfo:{reportingTag:new Uint8Array((e=a.reportingTokenInfo)==null?void 0:e.reportingTag),version:d("WAWebReportingTokenUtils").REPORTING_TOKEN_VERSION.HISTORY_SYNC}})}i.push(j);return!0});return function(b){return a.apply(this,arguments)}}()));yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(e.msgKey,e.syncType,e.chunkOrder);void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:g,startTs:e.historySyncStepStartedTs,isSuccess:!0});d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing Status complete, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(e,a.statusV3Messages.length));void d("WAWebDBReportingTokenUtils").handleHistorySyncedReportingInfo(i)});return L.apply(this,arguments)}function f(a,b,c,d,e){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[history sync] processing history non blocking data"]))),d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(c,b.historySyncStepStartedTs,!0,f),a.pastParticipants!=null&&a.pastParticipants.length>0&&(yield d("WAWebHistorySyncNotificationUtils").processPastParticipants(a,b)),a.callLogRecords!=null&&a.callLogRecords.length>0&&(yield N(a,b)),a.conversations!=null&&(yield d("WAWebMemberLabelHistorySync").processMemberLabels(a)),d("WAWebHistorySyncStickers").processRecentStickers(a,b),void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:e,startTs:b.historySyncStepStartedTs,isSuccess:!0})});return M.apply(this,arguments)}function N(a,b){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing call log records"]))),a.callLogRecords.sort(function(a,b){a=a.startTime;b=b.startTime;return d("WATimeUtils").castToUnixTime(parseInt(a,10))-d("WATimeUtils").castToUnixTime(parseInt(b,10))}),yield (J||(J=b("Promise"))).all(a.callLogRecords.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebVoipActionWriteCallLogSync").generateCallLogFromCallSyncRecord({callLogRecord:a,fromHistorySync:!0})});return function(b){return a.apply(this,arguments)}}())),d("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing call log records complete, ",""])),d("WAWebHistorySyncNotificationUtils").getHistorySyncLogDetailsString(c,a.callLogRecords.length))});return O.apply(this,arguments)}function P(a,b,c,d,e){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){d("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[history sync] start processing initial pushname"])));d("WAWebHistorySyncNotificationUtils").commitHistoryDownloadedMetric(e,b.historySyncStepStartedTs,!0,g);e=a.pushnames.map(function(a){return{id:a.id||"",pushname:a.pushname||""}});yield c("WAWebLidAwareContactsDB").bulkCreateOrMerge(e,"HistoryMsgHandlerAction.handlePushName");yield d("WAWebApiHistorySyncNotification").updateCurrentlyProcessed(b.msgKey,b.syncType,b.chunkOrder);var h=[];a.pushnames.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.id||""),c=d("WAWebContactCollection").ContactCollection.get(b);h.push({id:b,pushname:a.pushname||"",type:(c==null?void 0:c.type)||"out",name:c==null?void 0:c.name});if(!b.isLid()){b=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(b));b!=null&&h.push({id:b,pushname:a.pushname||"",type:(c==null?void 0:c.type)||"out",name:c==null?void 0:c.name})}});d("WAWebContactCollection").ContactCollection.add(h,{merge:!0});void d("WAWebHistorySyncNotificationUtils").commitHistoryDataAppliedMetric({historySyncDataAppliedMetric:f,startTs:b.historySyncStepStartedTs,isSuccess:!0});d("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[history sync] storing initial pushname complete with "," records"])),a.pushnames.length)});return Q.apply(this,arguments)}function R(a){var e={add:"last",isHistory:!0},f=Object.keys(a).map(function(b){return d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:d("WAWebWidFactory").createWid(b),msgObjs:a[b].msgs,meta:e,processMessagesOrigin:"historyMsgHandlerAction",chatMsgsCollection:null})});return(J||(J=b("Promise"))).all([].concat(f,[d("WAWebDBProcessInitialHistorySyncMessage").storeInitialSyncMessages(a)])).then(function(){var b;b=(b=Array.prototype).concat.apply(b,Object.keys(a).map(function(b){return a[b].msgs.map(function(a){return a.id.toString()})}));d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(b)["catch"](function(){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed update for orphan reactions"]))).sendLogs("failed-update-for-orphan-reactions")});return d("WAWebSyncdOrphan").checkOrphanMutations(b,Object.keys(a))}).then(function(){var c;return(J||(J=b("Promise"))).all((c=Array.prototype).concat.apply(c,Object.keys(a).map(function(b){return a[b].unifiedAddons}))).then(function(a){var b;return d("WAWebAddonProcessMsgs").processHistoryMsgs((b=[]).concat.apply(b,a))})})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").LogoutDrop,c("WAWebNoop")))["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Error: ",", message: ",", stack: ",""])),a.name,a.message,a.stack).devConsole(a).sendLogs("msg_handler for MD: error storing/processing multiple messages")})}function S(a,b){if(!d("WAWebLidMigrationUtils").shouldHaveAccountLid(a))return{result:"not-needed"};if(b.accountLid!=null){b=d("WAWebWidFactory").createUserLidOrThrow(b.accountLid);return{result:"extracted",accountLid:b}}if(a.isLid())return{result:"extracted",accountLid:a};d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] handleInitialSyncMsgs: Migrated account not sending accountLid for a PN chat in history sync"]))).devConsole(a.toString()).sendLogs("missing-account-lid-in-history-sync");return{result:"skip-chat"}}function T(a){var b=a.lid,c=a.username;a=a.countryCode;if(b==null||c==null&&a==null)return;b=d("WAWebWidFactory").createUserWidOrThrow(b);var e;a!=null&&(e=d("WAWebCountriesUtils").asISOCountryCode(a),!e&&d("WAWebCurrentUser").isEmployee()&&d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[history sync] invalid country code retrieved"]))).sendLogs("invalid-country-code-for-username-history-sync",{sampling:.01}));if(c!=null){a={userId:b,username:c};e!=null&&(a.usernameCountryCode=e);return a}else if(e!=null)return{userId:b,usernameCountryCode:e}}g.handleInitialSyncMsgs=a;g.handleStatusMessages=e;g.handleNonBlockingData=f;g.handlePushName=P;g.getUsernameUpdate=T}),98);
__d("WAWebAddAndReorderMsgsActionsUtils",["WALogger","WAWebMsgModelUtils"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c,e,f,g,h,j){a=i(a,b,c,e,g);d("WAWebMsgModelUtils").addRecordsToChat(a.msgs,e,f,a.collection,h,j)}function i(a,b,c,e,f){var g={},i={},j,k,l,m=c.length,n=f;if(m===0)return{msgs:b,collection:n};for(j=0;j<m;j++)k=c[j],i[k.id]=k;m=b.length;for(j=0;j<m;j++){k=b[j];if(!k)continue;g[k.id]=k}var o=[];m=a.length;for(j=0;j<m;j++){k=a[j];if(!k)continue;l=g[k.id];l&&o.push(l);l=i[k.id];if(l)if(l.recvFresh)o.push(l),e.removeMsg(l),l.unset("recvFresh");else{c=e.getAllCMCs();b=c.find(function(a){return a.get(l.id)});f&&b===f||(b?(b.forEach(function(a){o.push(a),delete i[a.id]}),b===e.msgs?(e.replaceMsgsCollection(f),n=e.msgs):(e.notifyMsgCollectionMerge(f,b,f),e.removeMsgsCollection(b))):(d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["models:Msg:reorder trying to merge CMC of orphaned message ",""])),k.id).devConsole(k),o.push(i[k.id])))}}return{msgs:o,collection:n}}g["default"]=a}),98);
__d("WAWebButtonModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.displayText=d("WAWebBaseModel").prop(),b.selected=d("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="replyButton";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebTemplateButtonModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.displayText=d("WAWebBaseModel").prop(),b.subtype=d("WAWebBaseModel").prop(),b.url=d("WAWebBaseModel").prop(),b.phoneNumber=d("WAWebBaseModel").prop(),b.selectionId=d("WAWebBaseModel").prop(),b.selected=d("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="templateButton";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebGetMsgUpdatesActionsUtils",["Promise","WALogger","WANullthrows","WATypeUtils","WAWebAck","WAWebButtonCollection","WAWebButtonModel","WAWebChatCollection","WAWebDBGroupParticipant","WAWebEphemeralSyncResponse","WAWebErrorType","WAWebFrontendMsgGetters","WAWebGroupSystemMsg","WAWebGroupType","WAWebHandleSingleMsg","WAWebInvalidateEventsAction","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMessageAssociationUIUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebPaymentRequestMsgAction","WAWebPollsInvalidateChatPollMsgsAction","WAWebRevokeMsgAction","WAWebTemplateButtonCollection","WAWebTemplateButtonModel","WAWebViewMode.flow","WAWebWid","asyncToGeneratorRuntime","gkx","lodash","vulture"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;function a(a,b,c,d){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var x=[],z=[],D=[],E=0;yield (y||(y=b("Promise"))).all(e.map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e;b.id instanceof c("WAWebMsgKey")||(b.self!=null&&c("vulture")("X8gT5EynTHw_I5RNAG6VZDmVN0Q="),E++,b.id=new(c("WAWebMsgKey"))({from:b.from,to:b.to,id:b.id,participant:b.participant,selfDir:b.self}));d("WATypeUtils").isString(a)&&c("WAWebWid").isBroadcast(a)&&delete b.broadcast;b.type==="ptt"&&!b.id.fromMe&&b.ack<d("WAWebAck").ACK.CLOCK&&(b.ack=d("WAWebAck").ACK.CLOCK);b.hydratedButtons!=null&&A(b);b.dynamicReplyButtons!=null&&B(b);(e=d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&e.includes(b.type)&&d("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:b})&&(b.viewMode=d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER);var v=d("WAWebMsgCollection").MsgCollection.get(b.id);if(b.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&b.subtype!=="ephemeral_setting"&&b.subtype!=="share_phone_number"&&b.subtype!=="event_edit_decrypted")switch(b.subtype){case"admin_revoke":var w;e=d("WAWebLidMigrationUtils").getAlternateMsgKey(b.protocolMessageKey);v=(w=d("WAWebMsgCollection").MsgCollection.get(b.protocolMessageKey))!=null?w:e!=null?d("WAWebMsgCollection").MsgCollection.get(e):null;if(v)if(!d("WAWebMsgGetters").getIsGroupMsg(v))d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: "," has not been revoked"])),v.id.toString()),d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoke was sent to a non-group chat"])));else if(!c("WAWebWid").equals(v.id.remote,b.id.remote))d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: "," has not been revoked"])),v.id.toString()),d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoke came for the different group than the original message was in"])));else{d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: admin revoked ",""])),v.id.toString());w=new(d("WAWebMsgModel").Msg)(b);e=c("WANullthrows")(d("WAWebFrontendMsgGetters").getChat(v).groupMetadata);var y=c("WANullthrows")(d("WAWebMsgGetters").getSender(w)),F=e.isLidAddressingMode===!0?d("WAWebLidMigrationUtils").toLid(y):d("WAWebLidMigrationUtils").toPn(y),G=F!=null?e.participants.get(F):null;if((!G||!G.isAdmin)&&F!=null){e.participants.add({id:F,isAdmin:!0},{merge:!0});if(!G){e={actionType:d("WAWebGroupType").GROUP_ACTIONS.ADD,participants:[{id:F,isAdmin:!0,isSuperAdmin:!1}],reason:null};d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[system message] msg updates - ADD - ADMIN"])));G=(yield d("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:{author:void 0,chatId:d("WAWebFrontendMsgGetters").getChat(v).id,ts:w.t},action:e}));void d("WAWebHandleSingleMsg").handleSingleMsg({chatId:G.from,newMsg:G,handleSingleMsgOrigin:"handleGroupAction"})}d("WAWebDBGroupParticipant").markGroupParticipantStale({group:d("WAWebFrontendMsgGetters").getChat(v).id})["catch"](function(){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: failed to mark group participant as stale"]))).sendLogs("failed-to-mark-group-participant-as-stale")})}d("WAWebRevokeMsgAction").revoke(v,{msgKey:w.id,subtype:w.subtype,sender:y,revokeTimestamp:w.t})}break;case"sender_revoke":F=d("WAWebLidMigrationUtils").getAlternateMsgKey(b.protocolMessageKey);v=(e=d("WAWebMsgCollection").MsgCollection.get(b.protocolMessageKey))!=null?e:F!=null?d("WAWebMsgCollection").MsgCollection.get(F):null;if(v){var H;G=new(d("WAWebMsgModel").Msg)(b);w=(y=v)==null?void 0:y.botTargetSenderJid;e=d("WAWebMsgGetters").getSender(G);w!=null&&(H=v.id.participant)!=null&&H.isBot()&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(w,e))&&e!=null?(d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: bot invoker revoked bot's response: ",""])),v.id.toString()),d("WAWebRevokeMsgAction").revoke(v,{msgKey:G.id,subtype:G.subtype,sender:e,revokeTimestamp:G.t})):c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(d("WAWebMsgGetters").getIsGroupStatus(v)?v.id.participant:d("WAWebMsgGetters").getSender(v),e))&&e!=null?(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: sender revoked ",""])),v.id.toString()),d("WAWebMsgGetters").getIsStatus(v)&&v.msgChunk&&v.msgChunk.remove(v),d("WAWebRevokeMsgAction").revoke(v,{msgKey:G.id,subtype:G.subtype,sender:e,revokeTimestamp:G.t})):d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: sender revoke: sender mismatch: "," <> ",""])),G.id.toString(),v.id.toString())}break;case"bot_request_welcome":case"bot_memu_onboarding":case"member_label":break;default:d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["unknown protocolMessage ",""])),b.id.toString()).devConsole(b);break}else if(v&&!d("WAWebFrontendMsgGetters").getAsRevoked(v)){b.ack<v.ack&&delete b.ack;for(F in b)Object.prototype.hasOwnProperty.call(b,F)&&typeof b[F]==="undefined"&&delete b[F];v.type!==b.type&&(b.subtype=b.subtype||void 0);f.isHistory===!0&&(b.isNewMsg=!1);y=["t","id","from","to"];var I=v.t?c("lodash").omit(b,y):b;w=v.applyUpdate(I).then(function(){return v});D.push(w);if(c("WAWebWid").isBroadcast(v.id.remote)){e=d("WAWebMsgModelUtils").getBroadcastFanoutKeys(v);e&&e.forEach(function(a){a=d("WAWebMsgCollection").MsgCollection.get(a);a&&D.push(a.applyUpdate(I).then(function(){return v}))})}f.isHistory===!0&&(v.recvFresh||g)&&!v.search?(d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:handle:processMM:","",""])),v.recvFresh?"dup:":"overlap:",String(v.id)),z.push(v)):f.isHistory===!0&&v.search?(v.search=!1,d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:handle:processMM load search as history ",""])),String(v.id)),x.push({id:v.id})):f.add==="search"&&x.push({id:v.id})}else{b.subtype==="payment_action_request_declined"||b.subtype==="payment_transaction_request_cancelled"?D.push(d("WAWebPaymentRequestMsgAction").cancelOrDeclinePaymentRequest(b)):b.type===d("WAWebMsgType").MSG_TYPE.PAYMENT&&b.subtype==="send"&&D.push(d("WAWebPaymentRequestMsgAction").fulfillPaymentRequest(b));F=(G=d("WAWebChatCollection").ChatCollection.get(b.id.remote))!=null?G:c("WAWebNewsletterCollection").get(b.id.remote);f.add==="search"&&(b.search=!0);d("WAWebMsgGetters").getIsUnreadType(b)&&b.id.fromMe&&b.ack===d("WAWebAck").ACK.CLOCK&&(b.isSendFailure=!0);b.errorCode===d("WAWebErrorType").SendFailureErrorCode.EditWindowExpired&&(b.isSendFailure=!0);f.update!==!0&&x.push(b);f.isHistory!==!0&&f.add!=="search"&&F&&D.push(C(b,F));b.ephemeralOutOfSync&&d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ephemeralOutOfSync msgId="," chatId=",""])),b.id.toString(),F==null?void 0:F.id.toString())}});return function(a){return e.apply(this,arguments)}}()));E>0&&(d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: el.id is not a MsgKey: "," of "," messages"])),E,e.length),c("gkx")("26258")||d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["getMsgUpdates: el.id is not a MsgKey"]))).sendLogs("forgot-to-create-msgkey"));return{filteredRecs:x,reorderRecs:z,updates:D}});return z.apply(this,arguments)}function A(a){var b=function(a,b){b=a.index!=null?a.index:b;b=""+b;if(a.quickReplyButton)return new(c("WAWebTemplateButtonModel"))({id:b,displayText:a.quickReplyButton.displayText,selectionId:a.quickReplyButton.id,subtype:"quick_reply"});else if(a.callButton)return new(c("WAWebTemplateButtonModel"))({id:b,displayText:a.callButton.displayText,phoneNumber:a.callButton.phoneNumber,subtype:"call"});return new(c("WAWebTemplateButtonModel"))({id:b,displayText:(b=a.urlButton)==null?void 0:b.displayText,url:(b=a.urlButton)==null?void 0:b.url,subtype:"url"})};a.buttons=new(d("WAWebTemplateButtonCollection").TemplateButtonCollection)();a.buttons.add(a.hydratedButtons.map(b))}function B(a){var b=function(a){var b=a.buttonId;a=a.buttonText;return new(c("WAWebButtonModel"))({id:b,displayText:a==null?void 0:a.displayText})};a.replyButtons=new(d("WAWebButtonCollection").ButtonCollection)();a.replyButtons.add(a.dynamicReplyButtons.map(b))}function C(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(!a.isNewMsg||!a.recvFresh){d("WALogger").WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["processLiveMessage should not be called with history message id: ",", type: ",", subType: ",", isNewMsg: ",", recvFresh: ",""])),a.id.toString(),a.type,a.subtype,a.isNewMsg,a.recvFresh).devConsole(a).sendLogs("bad-process-live-message-call",{sampling:.001});return(y||(y=b("Promise"))).resolve()}a.type===d("WAWebMsgType").MSG_TYPE.GP2&&a.subtype==="delete"&&(c.isReadOnly=!0,void d("WAWebPollsInvalidateChatPollMsgsAction").invalidateChatPollMsgs(c),void d("WAWebInvalidateEventsAction").invalidateEventMsgsForChat(c));yield d("WAWebEphemeralSyncResponse").syncEphemeralSetting(a,c)});return D.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebGetPushServerSettingsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=new(c("WADeprecatedWapParser"))("getPushServerSettings",function(a){if(!a.hasChild("error")){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getPushServerSettings: success"]))).tags("push-notification");var b=a.child("settings");b=b.attrString("webserverkey");return b}b=a.child("error");a=b.attrInt("code");b=b.attrString("text");d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getPushServerSettingsRequest: server response with ",", ",""])),a,b).tags("push-notification");return{errorCode:a,errorText:b}}),k=(e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,type:"get",xmlns:"urn:xmpp:whatsapp:push",id:e.generateId()},e.wap("settings",null));function a(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WADeprecatedSendIq").deprecatedSendIq(k,j));if(!a.success){var b=a.errorCode,c=a.errorText;return{errorCode:b,errorText:c}}return a.result});return l.apply(this,arguments)}g.getPushServerSettings=a}),98);
__d("WAWebSetPushConfigJob",["WABase64","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WANullthrows","WAWap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=new(c("WADeprecatedWapParser"))("setPushConfig",function(a){if(!a.hasChild("error")){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["setPushConfig: success"]))).tags("push-notification");return}a=a.child("error");var b=a.attrInt("code");a=a.attrString("text");d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["setPushConfig: server response with ",", ",""])),b,a).tags("push-notification");return{errorCode:b,errorText:a}});function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:push",id:b.generateId()},b.wap("config",{platform:"web",endpoint:b.CUSTOM_STRING(a.endpoint),auth:b.CUSTOM_STRING(d("WABase64").encodeB64(c("WANullthrows")(a.getKey("auth")))),p256dh:b.CUSTOM_STRING(d("WABase64").encodeB64(c("WANullthrows")(a.getKey("p256dh"))))}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,j));if(!a.success){b=a.errorCode;var e=a.errorText;return{errorCode:b,errorText:e}}return a.result});return k.apply(this,arguments)}g.setPushConfig=a}),98);
__d("WAWebSubscribePushManagerAction",["fbt","WABase64","WALogger","WAWebABProps","WAWebBackgroundSyncReporter","WAWebFbtCommon","WAWebGetPushServerSettingsJob","WAWebL10N","WAWebMiscErrors","WAWebMuteCollection","WAWebNotificationConstants","WAWebPushNotificationsGatingUtils","WAWebSetPushConfigJob","WAWebSetWorkerLocalStorage","WAWebUserPrefsGeneral","WAWebUserPrefsNotifications","WAWebUserPrefsScreenLock","WAWebWamEnumOnboardSources","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;function a(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications())return;d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to update push manager started"])));if("serviceWorker"in navigator){var a,b,e,f=d("WAWebMuteCollection").MuteCollection.getGlobalOfflineNotifications();f=H(f);var g=d("WAWebUserPrefsScreenLock").getScreenLockEnabled();a=f&&((a=window.Notification)==null?void 0:a.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED&&d("WAWebPushNotificationsGatingUtils").canEnableOfflineNotifications()&&!g;b=(yield (b=window.navigator.serviceWorker)==null?void 0:b.ready);if(b==null){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to check and update push manager due to no service worker registration"])));return}var h=b==null||(e=b.pushManager)==null||e.getSubscription==null?void 0:e.getSubscription();if(h==null){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to get push manager"])));return}if(b.scope!==window.location.origin+window.location.pathname){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] the current service worker scope is invalid, service worker scope: ",", current scope: ",""])),b.scope,window.location.origin+window.location.pathname);return}b=(yield h)!=null;d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] isOfflineNotificationsEnabled: ",",\n    hasPushSubscription: ",", canEnableOfflineNotifications: ",", isScreenLockEnabled : ",""])),f,b,d("WAWebPushNotificationsGatingUtils").canEnableOfflineNotifications(),g);a?b?(I(),c("WAWebL10N").on("locale_change",function(){I()})):void D():b&&void F()}});return C.apply(this,arguments)}function e(a){a?void D():void F()}function D(){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebPushNotificationsGatingUtils").canEnableOfflineNotifications())return;d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to subscribe push manager started"])));try{var a;if(!("serviceWorker"in navigator)){d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to service worker does not exist"])));return}a=(yield (a=window.navigator.serviceWorker)==null?void 0:a.ready);if(a==null){d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to service worker is not ready yet"])));return}var b=(yield a.pushManager.getSubscription());if(b!=null){d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to push manager is already subscribed"])));return}b=(yield d("WAWebGetPushServerSettingsJob").getPushServerSettings());if(b.errorCode!=null){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to unable to get push server settings with error code ",""])),b.errorCode);return}b=new Uint8Array(d("WABase64").decodeB64UrlSafe(String(b)));b={userVisibleOnly:!0,applicationServerKey:b};a=(yield a.pushManager.subscribe(b));b=(yield d("WAWebSetPushConfigJob").setPushConfig(a));if((b==null?void 0:b.errorCode)!=null){d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to send client push subscription data to server failure with error ",""])),b.errorText);return}yield d("WAWebSetWorkerLocalStorage").setWorkerLocalStorage();yield I();d("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] successfully subscribed push manager"])))}catch(a){d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to error: ",""])),a)}});return E.apply(this,arguments)}function F(){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications())return!1;d("WALogger").DEV(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to unsubscribe push manager started"])));try{var a;if(!("serviceWorker"in navigator)){d("WALogger").DEV(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to service worker does not exist"])));return!1}a=(yield (a=window.navigator.serviceWorker)==null?void 0:a.ready);if(a==null){d("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to no service worker registration"])));return!1}a=(yield a.pushManager.getSubscription());if(a==null){d("WALogger").DEV(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to no active push subscription"])));return!1}a=(yield a.unsubscribe());yield d("WAWebSetWorkerLocalStorage").clearWorkerLocalStorage()["catch"](function(a){if(!(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort))throw a});d("WALogger").DEV(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] successfully unsubscribed push manager"])));return a}catch(a){d("WALogger").WARN(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to error: ",""])),a);return!1}});return G.apply(this,arguments)}function H(a){var b;if(!a&&((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED&&d("WAWebMuteCollection").MuteCollection.getGlobalNotifications()&&d("WAWebUserPrefsNotifications").getOfflineNotificationsEnabledOnce()!==!0&&d("WAWebABProps").getABPropConfigValue("web_background_sync_v2")){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] Enable background sync for users once"])));d("WAWebUserPrefsNotifications").setOfflineNotificationsEnabledOnce();d("WAWebMuteCollection").MuteCollection.setGlobalOfflineNotifications(!0);d("WAWebBackgroundSyncReporter").logBackgroundSyncAdoptionEvent({offboardSource:null,onboardSource:d("WAWebWamEnumOnboardSources").ONBOARD_SOURCES.AUTO_ENABLE});return!0}return a}function I(){var a=c("WAWebFbtCommon")("WhatsApp"),b=h._(/*BTDS*/"Syncing messages in the background"),e=h._(/*BTDS*/"Syncing messages complete"),f;d("WAWebPushNotificationsGatingUtils").canSupportNotificationActions()&&(f=h._(/*BTDS*/"Go to app"));void d("WAWebUserPrefsGeneral").setOfflineNotificationContent({notificationTitle:a.toString(),notificationText:b.toString(),notificationSyncCompleteText:e.toString(),notificationSettingActionText:(a=f)==null?void 0:a.toString()})}g.updatePushManager=a;g.handleOfflineNotifications=e;g.unsubscribePushManager=F}),226);
__d("WAWebAppScreen",["$InternalEnum","WAWebStreamModel","err"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["CLIENT_EXPIRED_DIALOG","ANOTHER_SESSION","UNSUPPORTED_TAKEOVER","QR","SYNCING","OFFLINE","PROXYBLOCK","CONFLICT","TOS_BLOCK","SMB_TOS_BLOCK","DEPRECATED_VERSION","MAIN","STARTUP","TEMP_BAN","LOGOUT","SCREEN_LOCK","SERVICE_UNAVAILABLE"]);function a(a){var b,e=a.anotherSession,f=a.isUnsupportedTakeover,g=a.updating,i=a.hardExpired,j=a.mainLoaded,k=a.mode,l=a.screenLocked;if((b=a.temporaryBan)!=null&&b.banned)return h.TEMP_BAN;if(a.serviceUnavailable===!0)return h.SERVICE_UNAVAILABLE;if(a.startLogout)return h.LOGOUT;if(g||i)return h.CLIENT_EXPIRED_DIALOG;if(f)return h.UNSUPPORTED_TAKEOVER;if(e)return h.ANOTHER_SESSION;if(l)return!j?h.STARTUP:h.SCREEN_LOCK;switch(k){case d("WAWebStreamModel").StreamMode.QR:return h.QR;case d("WAWebStreamModel").StreamMode.SYNCING:return h.SYNCING;case d("WAWebStreamModel").StreamMode.OFFLINE:return h.OFFLINE;case d("WAWebStreamModel").StreamMode.PROXYBLOCK:return h.PROXYBLOCK;case d("WAWebStreamModel").StreamMode.CONFLICT:return h.CONFLICT;case d("WAWebStreamModel").StreamMode.TOS_BLOCK:return h.TOS_BLOCK;case d("WAWebStreamModel").StreamMode.SMB_TOS_BLOCK:return h.SMB_TOS_BLOCK;case d("WAWebStreamModel").StreamMode.DEPRECATED_VERSION:return h.DEPRECATED_VERSION;case d("WAWebStreamModel").StreamMode.MAIN:if(!j)return h.STARTUP;return a.stayInSync?h.SYNCING:h.MAIN}throw c("err")("[app] render Error invalid StreamMode: "+k)}g.AppScreen=h;g.getScreen=a}),98);
__d("WAWebWamEnumErrorType",[],(function(a,b,c,d,e,f){a=Object.freeze({ERROR_FETCHING_AGENT_NAME:0,ERROR_FETCHING_CHAT:1,ERROR_OTHER:2});f.ERROR_TYPE=a}),66);
__d("WAWebWamEnumMdChatAssignmentAssignmentType",[],(function(a,b,c,d,e,f){a=Object.freeze({ASSIGNED:0,UNASSIGNED:1});f.MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE=a}),66);
__d("WAWebWamEnumMdChatAssignmentChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP:0,BROADCAST_LIST:1,INDIVIDUAL:2,COMMUNITY:3,CHANNEL:4,INTEROP:5});f.MD_CHAT_ASSIGNMENT_CHAT_TYPE=a}),66);
__d("WAWebWamEnumMdChatAssignmentSecondaryActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTION_SYSTEM_MESSAGE_ADDED_TO_CHAT_HISTORY:0,ACTION_SYSTEM_MESSAGE_CREATION_ERROR:1,ACTION_SYSTEM_MESSAGE_RENDERED:2,ACTION_CHAT_STATUS_TICKER_SHOWN:3,ACTION_TOOLTIP_SHOWN:4});f.MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE=a}),66);
__d("WAWebWamEnumMdChatAssignmentSourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,BOOTSTRAP:1});f.MD_CHAT_ASSIGNMENT_SOURCE_TYPE=a}),66);
__d("WAWebMdChatAssignmentSecondaryActionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumErrorType","WAWebWamEnumMdChatAssignmentAssignmentType","WAWebWamEnumMdChatAssignmentChatType","WAWebWamEnumMdChatAssignmentSecondaryActionType","WAWebWamEnumMdChatAssignmentSourceType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdChatAssignmentSecondaryAction:[3716,{mdChatAssignmentSecondaryActionAgentId:[1,a.TYPES.STRING],mdChatAssignmentSecondaryActionAssignmentType:[8,d("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE],mdChatAssignmentSecondaryActionBrowserId:[2,a.TYPES.STRING],mdChatAssignmentSecondaryActionChatType:[3,d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE],mdChatAssignmentSecondaryActionError:[4,d("WAWebWamEnumErrorType").ERROR_TYPE],mdChatAssignmentSecondaryActionMdId:[5,a.TYPES.INTEGER],mdChatAssignmentSecondaryActionSource:[6,d("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE],mdChatAssignmentSecondaryActionType:[7,d("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE]},[1,1,1],"regular"]},{MdChatAssignmentSecondaryAction:[]});g.MdChatAssignmentSecondaryActionWamEvent=b}),98);
__d("WAWebWamEnumChatAssignmentActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTION_ASSIGNED:0,ACTION_UNASSIGNED:1,ACTION_REASSIGNED:2});f.CHAT_ASSIGNMENT_ACTION_TYPE=a}),66);
__d("WAWebWamEnumChatAssignmentChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:0,GROUP:1,COMMUNITY:2,CHANNEL:3});f.CHAT_ASSIGNMENT_CHAT_TYPE=a}),66);
__d("WAWebWamEnumChatAssignmentEntryPointType",[],(function(a,b,c,d,e,f){a=Object.freeze({CONVERSATION_OVERFLOW_MENU:0,CONTACT_INFO_SCREEN:1,MULTI_SELECT:2,SYSTEM_MESSAGE:3,CHAT_LIST_SWIPE:4,AI_REPLIES:5});f.CHAT_ASSIGNMENT_ENTRY_POINT_TYPE=a}),66);
__d("WAWebMdChatAssignmentWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatAssignmentActionType","WAWebWamEnumChatAssignmentChatType","WAWebWamEnumChatAssignmentEntryPointType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MdChatAssignment:[3752,{assignerAgentId:[1,a.TYPES.STRING],assignerBrowserId:[2,a.TYPES.STRING],assignerMdId:[3,a.TYPES.INTEGER],chatAssignmentAction:[4,d("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE],chatAssignmentAgentId:[5,a.TYPES.STRING],chatAssignmentBrowserId:[6,a.TYPES.STRING],chatAssignmentChatType:[7,d("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE],chatAssignmentEntryPoint:[8,d("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE],chatAssignmentMdId:[9,a.TYPES.INTEGER],chatsCnt:[10,a.TYPES.INTEGER]},[1,1,1],"regular"]},{MdChatAssignment:[]});g.MdChatAssignmentWamEvent=b}),98);
__d("WAWebChatAssignmentLogEvents",["WAWebABProps","WAWebAgentCollection","WAWebBizGatingUtils","WAWebChatAssignmentLogEvents.flow","WAWebChatCollection","WAWebMdChatAssignmentSecondaryActionWamEvent","WAWebMdChatAssignmentWamEvent","WAWebMiscBrowserUtils","WAWebUserPrefsMeUser","WAWebWamEnumChatAssignmentActionType","WAWebWamEnumChatAssignmentEntryPointType","WAWebWamEnumMdChatAssignmentAssignmentType","WAWebWamEnumMdChatAssignmentSecondaryActionType","WAWebWamEnumMdChatAssignmentSourceType"],(function(a,b,c,d,e,f,g){function h(){var a=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();return d("WAWebAgentCollection").AgentCollection.getModelsArray().find(function(b){return b.deviceId===a})}function i(a,b){var e=h(),f=d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_system_messages_logging_v2_enabled");f||delete b.mdChatAssignmentSecondaryActionAssignmentType;return new(d("WAWebMdChatAssignmentSecondaryActionWamEvent").MdChatAssignmentSecondaryActionWamEvent)(babelHelpers["extends"]({mdChatAssignmentSecondaryActionAgentId:(f=e==null?void 0:e.id)!=null?f:"",mdChatAssignmentSecondaryActionBrowserId:c("WAWebMiscBrowserUtils").persistentExpiringId(),mdChatAssignmentSecondaryActionChatType:a==null?void 0:a.getMdChatAssignmentChatType(),mdChatAssignmentSecondaryActionMdId:(f=e==null?void 0:e.deviceId)!=null?f:-1},b))}function a(a){if(!d("WAWebBizGatingUtils").chatAssignmentEnabled())return;i(a,{mdChatAssignmentSecondaryActionSource:d("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:d("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_TOOLTIP_SHOWN}).commit()}function b(a){if(!d("WAWebBizGatingUtils").chatAssignmentEnabled())return;i(a,{mdChatAssignmentSecondaryActionAssignmentType:a.assignedAgent==null?d("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.ASSIGNED:d("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.UNASSIGNED,mdChatAssignmentSecondaryActionSource:d("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.BOOTSTRAP,mdChatAssignmentSecondaryActionType:d("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_SYSTEM_MESSAGE_ADDED_TO_CHAT_HISTORY}).commit()}function e(a){if(!d("WAWebBizGatingUtils").chatAssignmentEnabled())return;i(a,{mdChatAssignmentSecondaryActionAssignmentType:a.assignedAgent==null?d("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.ASSIGNED:d("WAWebWamEnumMdChatAssignmentAssignmentType").MD_CHAT_ASSIGNMENT_ASSIGNMENT_TYPE.UNASSIGNED,mdChatAssignmentSecondaryActionSource:d("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:d("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_SYSTEM_MESSAGE_CREATION_ERROR}).commit()}function f(a){if(!d("WAWebBizGatingUtils").chatAssignmentEnabled())return;a=d("WAWebChatCollection").ChatCollection.get(a);if(a==null)return;i(a,{mdChatAssignmentSecondaryActionSource:d("WAWebWamEnumMdChatAssignmentSourceType").MD_CHAT_ASSIGNMENT_SOURCE_TYPE.NONE,mdChatAssignmentSecondaryActionType:d("WAWebWamEnumMdChatAssignmentSecondaryActionType").MD_CHAT_ASSIGNMENT_SECONDARY_ACTION_TYPE.ACTION_CHAT_STATUS_TICKER_SHOWN}).commit()}function j(a,b,e){var f=h(),g=d("WAWebAgentCollection").AgentCollection.get(b),i=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();b=b===(f==null?void 0:f.id);return new(d("WAWebMdChatAssignmentWamEvent").MdChatAssignmentWamEvent)(babelHelpers["extends"]({assignerAgentId:(f=f==null?void 0:f.id)!=null?f:"",assignerBrowserId:c("WAWebMiscBrowserUtils").persistentExpiringId(),assignerMdId:i,chatAssignmentAgentId:(f=g==null?void 0:g.id)!=null?f:"",chatAssignmentBrowserId:b?c("WAWebMiscBrowserUtils").persistentExpiringId():"",chatAssignmentChatType:a.getChatAssignmentChatType(),chatAssignmentMdId:(i=g==null?void 0:g.deviceId)!=null?i:-1},e))}function k(a){switch(a){case d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.MULTI_SELECT:return d("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.MULTI_SELECT;case d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.SYSTEM_MESSAGE:return d("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.SYSTEM_MESSAGE;case d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONVERSATION_MENU:return d("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.CONVERSATION_OVERFLOW_MENU;case d("WAWebChatAssignmentLogEvents.flow").ChatAssignmentEntryPointType.CONTACT_INFO_SCREEN:return d("WAWebWamEnumChatAssignmentEntryPointType").CHAT_ASSIGNMENT_ENTRY_POINT_TYPE.CONTACT_INFO_SCREEN}}function l(a,b,c,e,f){if(!d("WAWebBizGatingUtils").chatAssignmentEnabled())return;var g;b===""?g=d("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_UNASSIGNED:c?g=d("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_REASSIGNED:g=d("WAWebWamEnumChatAssignmentActionType").CHAT_ASSIGNMENT_ACTION_TYPE.ACTION_ASSIGNED;j(a,b,{chatAssignmentAction:g,chatAssignmentEntryPoint:k(e),chatsCnt:f}).commit()}g.logNuxShown=a;g.logSystemMessageGeneratedFromCompanion=b;g.logSystemMessageFailedToGenerate=e;g.logChatStatusTickerShown=f;g.logChatAssignment=l}),98);
__d("WAWebWamEnumChatsFolderType",[],(function(a,b,c,d,e,f){a=Object.freeze({INBOX:1,ARCHIVED:2});f.CHATS_FOLDER_TYPE=a}),66);
__d("WAWebWamEnumContactType",[],(function(a,b,c,d,e,f){a=Object.freeze({CONSUMER:1,SMB:2,ENTERPRISE:3});f.CONTACT_TYPE=a}),66);
__d("WAWebBusinessTemplateRichOrderStatusWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({BusinessTemplateRichOrderStatus:[7076,{actionTypeRichOrderStatus:[1,a.TYPES.STRING],businessJid:[2,a.TYPES.STRING],chatsFolderType:[3,d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],contactType:[4,d("WAWebWamEnumContactType").CONTACT_TYPE],isBizIntent:[5,a.TYPES.BOOLEAN],isInsubContact:[6,a.TYPES.BOOLEAN],isMuted:[7,a.TYPES.BOOLEAN],readReceiptsEnabled:[8,a.TYPES.BOOLEAN],templateId:[9,a.TYPES.STRING]},[1,1,1],"private",113760892]},{BusinessTemplateRichOrderStatus:[]});g.BusinessTemplateRichOrderStatusWamEvent=b}),98);
__d("WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PsRichOrderStatusMessageInconsistentPayloadReceived:[6938,{businessJid:[1,a.TYPES.STRING],hasCurrencyChanged:[2,a.TYPES.BOOLEAN],hasHeaderImageChanged:[3,a.TYPES.BOOLEAN],hasItemImageChanged:[4,a.TYPES.BOOLEAN],hasItemNameChanged:[5,a.TYPES.BOOLEAN],hasItemNumberChanged:[6,a.TYPES.BOOLEAN],hasItemPriceChanged:[7,a.TYPES.BOOLEAN],hasItemQuantityChanged:[8,a.TYPES.BOOLEAN],hasItemVariantChanged:[9,a.TYPES.BOOLEAN]},[1,1,1],"private",113760892]},{PsRichOrderStatusMessageInconsistentPayloadReceived:[]});g.PsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent=b}),98);
__d("WAWebWamEnumQbmFlag",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,TRANSACTIONAL:1,PROMOTIONAL:2,OTP:3,MARKETING_MESSAGE_SMB:4});f.QBM_FLAG=a}),66);
__d("WAWebQbmRichOrderStatusInteractionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType","WAWebWamEnumEntryPoint","WAWebWamEnumQbmFlag"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({QbmRichOrderStatusInteraction:[6940,{actionTypeRichOrderStatus:[1,a.TYPES.STRING],chatsFolderType:[2,d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],contactType:[3,d("WAWebWamEnumContactType").CONTACT_TYPE],decisionId:[4,a.TYPES.STRING],deltaTime:[5,a.TYPES.INTEGER],deltaTimeReceived:[6,a.TYPES.INTEGER],entryPoint:[7,d("WAWebWamEnumEntryPoint").ENTRY_POINT],hsmTagStr:[8,a.TYPES.STRING],isBizIntent:[9,a.TYPES.BOOLEAN],isBroadcastMessage:[10,a.TYPES.BOOLEAN],isInsubContact:[11,a.TYPES.BOOLEAN],isMuted:[12,a.TYPES.BOOLEAN],messageIdHmac:[13,a.TYPES.STRING],qbmFlag:[14,d("WAWebWamEnumQbmFlag").QBM_FLAG],readReceiptsEnabled:[15,a.TYPES.BOOLEAN],threadIdHmac:[16,a.TYPES.STRING],unifiedSessionId:[17,a.TYPES.STRING]},[1,1,1],"regular"]},{QbmRichOrderStatusInteraction:[]});g.QbmRichOrderStatusInteractionWamEvent=b}),98);
__d("WAWebRichOrderStatusLogger",["$InternalEnum","Promise","WAWebABProps","WAWebBusinessTemplateRichOrderStatusWamEvent","WAWebChatGetters","WAWebChatThreadLogging","WAWebContactCollection","WAWebContactGetters","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebOrderStatus","WAWebOrderStatusButton","WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent","WAWebQbmRichOrderStatusInteractionWamEvent","WAWebUnifiedSession","WAWebUserPrefsGeneral","WAWebUtilsPnhSmbLoggingHelper","WAWebWamEnumChatsFolderType","WAWebWamEnumContactType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;e=b("$InternalEnum")({ORDER_TRACKING_URL_CLICK:"order_tracking_url_click",VIEW_ORDER_PRIMARY_CLICK:"view_order_primary_click",VIEW_ORDER_SECONDARY_CLICK:"view_order_secondary_click",VIEW_ORDER_ITEM_PLACEHOLDER_CLICK:"view_order_item_placeholder_click",ORDER_ITEM_ROW_CLICK:"order_item_row_click",ORDER_NUMBER_COPY:"order_number_copy",TRACKING_NUMBER_COPY:"tracking_number_copy",MESSAGE_HEADER_CLICK:"message_header_click",MESSAGE_CTA_CLICK:"message_cta_click"});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(!d("WAWebABProps").getABPropConfigValue("utility_order_status_logging_enabled"))return;var e=d("WAWebFrontendMsgGetters").getChat(a),f=d("WAWebContactCollection").ContactCollection.get(e.id),g=f?d("WAWebContactGetters").getIsBusiness(f):!1,i=g?d("WAWebWamEnumContactType").CONTACT_TYPE.SMB:d("WAWebWamEnumContactType").CONTACT_TYPE.ENTERPRISE,j=e.archive?d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.ARCHIVED:d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.INBOX,k=d("WAWebUnifiedSession").UnifiedSessionManager.getSessionId(),l=d("WAWebChatGetters").getMuteExpiration(e);l=l>Date.now();f=f?d("WAWebContactGetters").getIsMyContact(f):!1;var m=Date.now(),n=d("WAWebMsgGetters").getT(a);n=Math.round((m-n*1e3)/1e3);var o=d("WAWebChatGetters").getId(e).toString(),p=d("WAWebMsgGetters").getId(a);p=(yield (h||(h=b("Promise"))).all([d("WAWebChatThreadLogging").getMessageIDHMAC(p.toString()),d("WAWebChatThreadLogging").getChatThreadIDHMAC(o)]));o=p[0];p=p[1];var q=d("WAWebMsgGetters").getClientReceivedTsMillis(a);m=q!=null?Math.round((m-q)/1e3):void 0;q=d("WAWebUserPrefsGeneral").getUserPrivacySettings();q=q.readReceipts!=="none";new(d("WAWebQbmRichOrderStatusInteractionWamEvent").QbmRichOrderStatusInteractionWamEvent)({actionTypeRichOrderStatus:c,chatsFolderType:j,contactType:i,deltaTime:n,deltaTimeReceived:m,isInsubContact:f,isMuted:l,messageIdHmac:o!=null?o:void 0,readReceiptsEnabled:q,threadIdHmac:p!=null?p:void 0,unifiedSessionId:k!=null?k:void 0}).commit();new(d("WAWebBusinessTemplateRichOrderStatusWamEvent").BusinessTemplateRichOrderStatusWamEvent)({actionTypeRichOrderStatus:c,businessJid:d("WAWebUtilsPnhSmbLoggingHelper").jidToPnString(d("WAWebChatGetters").getId(e)),chatsFolderType:j,contactType:i,isBizIntent:g,isInsubContact:f,isMuted:l,readReceiptsEnabled:q,templateId:(n=a.templateId)!=null?n:void 0}).commit()});return i.apply(this,arguments)}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebABProps").getABPropConfigValue("utility_order_status_logging_enabled"))return;var b=d("WAWebOrderStatusButton").getOrderStatusButton(a);if(!b)return;var c=d("WAWebFrontendMsgGetters").getChat(a),e=d("WAWebOrderStatus").getMergedOrderStatus(c,b);e=e.firstMessage;if(!e)return;var f=d("WAWebOrderStatusButton").getOrderStatusButton(e);if(!f)return;a=a.mediaData.filehash!==e.mediaData.filehash;e=b.order.items||[];var g=f.order.items||[];b=b.order.currency!==f.order.currency;f=e.length!==g.length;var h=!1,i=!1,j=!1,k=!1,l=!1;for(var m=0;m<Math.min(e.length,g.length);m++){var n,o=e[m],p=g[m];h||(h=o.name!==p.name);i||(i=o.quantity!==p.quantity);j||(j=o.variant!==p.variant);k||(k=o.image.file_sha256!==p.image.file_sha256);l||(l=((n=o.amount)==null?void 0:n.value)!==((n=p.amount)==null?void 0:n.value)||((n=o.amount)==null?void 0:n.offset)!==((o=p.amount)==null?void 0:o.offset))}new(d("WAWebPsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent").PsRichOrderStatusMessageInconsistentPayloadReceivedWamEvent)({businessJid:d("WAWebUtilsPnhSmbLoggingHelper").jidToPnString(d("WAWebChatGetters").getId(c)),hasCurrencyChanged:b,hasHeaderImageChanged:a,hasItemImageChanged:k,hasItemNameChanged:h,hasItemNumberChanged:f,hasItemPriceChanged:l,hasItemQuantityChanged:i,hasItemVariantChanged:j}).commit()});return j.apply(this,arguments)}g.RichOrderStatusActionType=e;g.logRichOrderStatusInteraction=a;g.logRichOrderStatusInconsistencies=c}),98);
__d("WAWebTemplateButtonSubtype",[],(function(a,b,c,d,e,f){a={QUICK_REPLY:"quick_reply",CALL:"call",URL:"url"};f.TEMPLATE_BUTTON_SUBTYPE=a}),66);
__d("WAWebOTPHelper",["fbt","WALogger","WAWebABProps","WAWebCopyToClipboard","WAWebMsgDataFromModel","WAWebOTPLoggingHelper","WAWebTemplateButtonSubtype","WAWebToast.react","WAWebToastManager","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react");function a(a){if(d("WAWebABProps").getABPropConfigValue("web_otp_copy_code_disabled"))return!1;if(!navigator.clipboard)return!1;var b=a.url;if(a.subtype!==d("WAWebTemplateButtonSubtype").TEMPLATE_BUTTON_SUBTYPE.URL||b==null)return!1;try{a=new URL(b);return l(a)!=null}catch(a){return!1}}function l(a){var b;return(b=m(a))!=null?b:n(a)}function b(a){var b=a.url;if(a.subtype!==d("WAWebTemplateButtonSubtype").TEMPLATE_BUTTON_SUBTYPE.URL||b==null)return null;try{a=new URL(b);return l(a)}catch(a){return null}}function e(a,b){var c=a.url;if(a.subtype!==d("WAWebTemplateButtonSubtype").TEMPLATE_BUTTON_SUBTYPE.URL||c==null)return;a=new URL(c);c=l(a);if(c==null)return;d("WAWebCopyToClipboard").copyTextToClipboard(c).then(function(a){if(!a)return;d("WAWebToastManager").ToastManager.open(k.jsx(d("WAWebToast.react").Toast,{msg:h._(/*BTDS*/"Code copied")}))})["catch"](function(){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[otp] failed to copy code"]))).sendLogs("otp-copy-code-failed")});void d("WAWebOTPLoggingHelper").logOTPButtonClick(d("WAWebMsgDataFromModel").msgDataFromMsgModel(b))}function m(a){var b=d("WAWebABProps").getABPropConfigValue("unified_otp_copy_code_url");return!a.toString().startsWith(b)?null:a.toString().slice(b.length)}function n(a){var b=d("WAWebABProps").getABPropConfigValue("unified_otp_retriever_url");if(!a.toString().startsWith(b))return null;b=a.searchParams;a=b.get("code");if(a==null)return null;b="otp";return a.startsWith(b)?a.slice(b.length):a}g.isOTPCopyCodeButton=a;g.getOTPCode=l;g.getOTPCodeFromButton=b;g.copyOTPCode=e}),226);
__d("WAWebWamEnumCtaFallbackReason",[],(function(a,b,c,d,e,f){a=Object.freeze({NO_OTP_REQUEST_RECEIVED:0,OTP_REQUEST_EXPIRED:1,HASH_MISMATCH:2,NO_ACTIVITY_LISTENING_ON_THIRD_PARTY_APP:3,OTHER:4,NO_PACKAGE_NAME_ON_MESSAGE:5,NO_CTA_DISPLAY_NAME:6,INCOMPATIBLE_OS_VERSION:7,NO_RETRIEVER_BUTTON:8,FEATURE_DISABLED:9,AMBIGUOUS_DELIVERY_DESTINATION:10});f.CTA_FALLBACK_REASON=a}),66);
__d("WAWebWamEnumCtaType",[],(function(a,b,c,d,e,f){a=Object.freeze({COPY_CODE:0,AUTOFILL:1});f.CTA_TYPE=a}),66);
__d("WAWebWamEnumOtpEventSource",[],(function(a,b,c,d,e,f){a=Object.freeze({NOTIFICATION_CTA:0,NOTIFICATION_BODY:1,CHAT_CTA:2,OTHER:3,OTP_MESSAGE:4,OTP_MESSAGE_INFO:5,OTP_CONFIGURATION:6,OTP_REQUEST_SENDER:7,OTP_ZERO_TAP_SENDER:8,OTP_CONF_OPTION:9});f.OTP_EVENT_SOURCE=a}),66);
__d("WAWebWamEnumOtpEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({CLICK:0,IMPRESSION:1,OTP_CODE_REQUESTED:2,OTP_CODE_SENT:3,MESSAGE_RECEIVED:4,MESSAGE_READ:5,MESSAGE_DELETED:6,ZERO_TAP_ENABLED:7,ZERO_TAP_DISABLED:8,ZERO_TAP_NOTICE_VIEWED:9,CLEAR_CHAT:10,ZERO_TAP_SEND_CODE_STARTED:11,ZERO_TAP_SEND_CODE_COMPLETED:12,ZERO_TAP_SEND_CODE_FAILED:13,OTP_CONF_OPT_ZERO_TAP_FLAG_ENABLED:14,OTP_CONF_OPT_ZERO_TAP_FLAG_DISABLED:15,HANDSHAKE_CONFIRMATION_SENT:16,FEEDBACK_BUTTON_CLICK:17});f.OTP_EVENT_TYPE=a}),66);
__d("WAWebWamEnumOtpProductType",[],(function(a,b,c,d,e,f){a=Object.freeze({ONE_TAP:0,ZERO_TAP:1,COPY_CODE:2});f.OTP_PRODUCT_TYPE=a}),66);
__d("WAWebOtpRetrieverWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatsFolderType","WAWebWamEnumCtaFallbackReason","WAWebWamEnumCtaType","WAWebWamEnumOtpEventSource","WAWebWamEnumOtpEventType","WAWebWamEnumOtpProductType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({OtpRetriever:[3468,{businessLid:[26,a.TYPES.INTEGER],businessLidOrJid:[28,a.TYPES.STRING],businessPhoneNumber:[1,a.TYPES.INTEGER],chatId:[19,a.TYPES.STRING],chatsFolderType:[12,d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE],ctaFallbackReason:[2,d("WAWebWamEnumCtaFallbackReason").CTA_FALLBACK_REASON],ctaType:[3,d("WAWebWamEnumCtaType").CTA_TYPE],isKeepChatsArchivedEnabled:[13,a.TYPES.BOOLEAN],isMessageNotificationEnabled:[14,a.TYPES.BOOLEAN],isNotificationEnabled:[15,a.TYPES.BOOLEAN],messageReceivedElapsedTimeSeconds:[11,a.TYPES.INTEGER],otpCorrelationId:[20,a.TYPES.STRING],otpEventSource:[5,d("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE],otpEventType:[6,d("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE],otpFailureReason:[16,a.TYPES.STRING],otpHandshakeElapsedTimeMs:[21,a.TYPES.INTEGER],otpHandshakeId:[23,a.TYPES.STRING],otpIosAutofillDisabled:[29,a.TYPES.BOOLEAN],otpMaskLinkedDevices:[24,a.TYPES.BOOLEAN],otpProductType:[7,d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE],otpSdkVersion:[22,a.TYPES.STRING],otpSenderAttributes:[27,a.TYPES.STRING],otpSessionId:[8,a.TYPES.STRING],receiverCountryCode:[18,a.TYPES.STRING],templateId:[17,a.TYPES.STRING],thirdPartyPackageNameFromIntent:[9,a.TYPES.STRING],thirdPartyPackageSignatureHash:[10,a.TYPES.STRING],waDeviceId:[25,a.TYPES.INTEGER]},[1,1,1],"private",113760892]},{OtpRetriever:[]});g.OtpRetrieverWamEvent=b}),98);
__d("WAWebOTPLoggingHelper",["WACryptoSha256","WAWebABProps","WAWebDBMessageSerialization","WAWebFrontendMsgGetters","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebLinkDevicePhoneNumberEntryInputFormatUtils","WAWebMsgGetters","WAWebMuteGetters","WAWebOtpRetrieverWamEvent","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebWamEnumChatsFolderType","WAWebWamEnumCtaType","WAWebWamEnumOtpEventSource","WAWebWamEnumOtpEventType","WAWebWamEnumOtpProductType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMsgGetters").getIsAuthenticationMessage(a))return;var b=new(d("WAWebOtpRetrieverWamEvent").OtpRetrieverWamEvent)({ctaType:d("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:d("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.CHAT_CTA,otpEventType:d("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.CLICK});yield m(b,a);b.commit()});return h.apply(this,arguments)}function e(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(!d("WAWebMsgGetters").getIsAuthenticationMessage(a))return;var c=new(d("WAWebOtpRetrieverWamEvent").OtpRetrieverWamEvent)({ctaType:d("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:d("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:d("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_RECEIVED});b=(b=d("WAWebUserPrefsMeUser").getMaybeMeDevicePn())==null?void 0:b.getDeviceId();b!=null&&(c.waDeviceId=b);yield m(c,a);c.commit()});return i.apply(this,arguments)}function f(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebDBMessageSerialization").messageFromDbRow(a);if(!d("WAWebMsgGetters").getIsAuthenticationMessage(a))return;var b=new(d("WAWebOtpRetrieverWamEvent").OtpRetrieverWamEvent)({ctaType:d("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:d("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:d("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_READ});yield m(b,a);b.commit()});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMsgGetters").getIsAuthenticationMessage(a))return;var b=new(d("WAWebOtpRetrieverWamEvent").OtpRetrieverWamEvent)({ctaType:d("WAWebWamEnumCtaType").CTA_TYPE.COPY_CODE,otpEventSource:d("WAWebWamEnumOtpEventSource").OTP_EVENT_SOURCE.OTP_MESSAGE,otpEventType:d("WAWebWamEnumOtpEventType").OTP_EVENT_TYPE.MESSAGE_DELETED});yield m(b,a);b.commit()});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a.otpSessionId=(yield r(b));a.receiverCountryCode=String(d("WAWebLinkDevicePhoneNumberEntryInputFormatUtils").getCountryCodeIso(d("WAWebUserPrefsMeUser").getMePnUserOrThrow().user));o(a,b);var c=b.templateId;c!=null&&(a.templateId=c);c=s(b);c!=null&&(a.otpProductType=c);p(a);q(a,b)});return n.apply(this,arguments)}function o(a,b){var c=b.from.user,e=d("WAWebABProps").getABPropConfigValue("otp_lid_migration_enabled");if(e&&c!=null){e=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();e=e?d("WAWebLidMigrationUtils").toLid(b.from):b.from;a.businessLidOrJid=e?e.toString():c;return}c!=null&&(a.businessPhoneNumber=Number(c))}function p(a){a.isKeepChatsArchivedEnabled=d("WAWebSettingsGetters").getShowArchiveV2(c("WAWebSettingsModel")),a.isNotificationEnabled=d("WAWebUserPrefsNotifications").getGlobalNotifications()}function q(a,b){b=d("WAWebFrontendMsgGetters").getMaybeChat(b);if(b==null)return;a.chatsFolderType=b.archive?d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.ARCHIVED:d("WAWebWamEnumChatsFolderType").CHATS_FOLDER_TYPE.INBOX;a.isMessageNotificationEnabled=!d("WAWebMuteGetters").getIsMuted(b.mute)}function r(a){return d("WACryptoSha256").sha256Str(a.id.id)}function s(a){a=a.hydratedButtons;if(a==null||a.length===0)return null;var b=d("WAWebABProps").getABPropConfigValue("unified_otp_copy_code_url"),c=d("WAWebABProps").getABPropConfigValue("unified_otp_retriever_url");for(a of a){var e;e=(e=a.urlButton)==null?void 0:e.url;if(e==null)continue;if(e.startsWith(b))return d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.COPY_CODE;else if(e.startsWith(c)){e=(e=new URL(e))==null?void 0:e.searchParams;e=e.get("otp_type");if(e!=null)switch(e){case"COPY_CODE":return d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.COPY_CODE;case"ONE_TAP":return d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ONE_TAP;case"ZERO_TAP":return d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ZERO_TAP;default:continue}else return d("WAWebWamEnumOtpProductType").OTP_PRODUCT_TYPE.ONE_TAP}}return null}g.logOTPButtonClick=a;g.logOTPMessageReceived=e;g.logOTPMessageRead=f;g.logOTPMessageDeleted=k}),98);
__d("WAWebUtilsPnhSmbLoggingHelper",["WAWebContactCollection"],(function(a,b,c,d,e,f,g){function a(a){if(a!=null){if(!a.isLid())return a.user;var b=d("WAWebContactCollection").ContactCollection.get(a);if(a.isLid()&&(b==null?void 0:b.phoneNumber)!=null)return b.phoneNumber.user}return"-1"}g.jidToPnString=a}),98);
__d("WAWebCatalogVariantHelper",["fbt","$InternalEnum","WAWebBizGatingUtils","WAWebLinkedCatalogHelper"],(function(a,b,c,d,e,f,g,h){"use strict";e=100;f="listing_details,types,availability,variant_properties";function a(a,b){var c;c=b!=null&&b.variantInfo!=null&&((c=b.variantInfo.listing_details)==null?void 0:c.description)==null&&b.variantInfo.variant_properties==null;return Boolean(!c&&a&&d("WAWebLinkedCatalogHelper").isLinkedCatalog(a.id)&&d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled())}var i=b("$InternalEnum")({COLOR:"color",SIZE:"size",MATERIAL:"material",PATTERN:"pattern",GENDER:"gender",AGE_GROUP:"age group"});function c(a,b){var c=i.cast(a.toLocaleLowerCase("en-US"));if(c==null)return a;switch(c){case i.COLOR:return b==null?h._(/*BTDS*/"Color"):h._(/*BTDS*/"_j{\"*\":\"{number} Colors\",\"_1\":\"Color\"}",[h._plural(b,"number")]);case i.SIZE:return h._(/*BTDS*/"Size");case i.MATERIAL:return h._(/*BTDS*/"Material");case i.PATTERN:return h._(/*BTDS*/"Pattern");case i.GENDER:return h._(/*BTDS*/"Gender");case i.AGE_GROUP:return h._(/*BTDS*/"Age group")}}g.VARIANT_THUMBNAIL_IMAGE_SIZE=e;g.FULL_VARIANT_INFO_FIELDS=f;g.shouldRequestVariantInfo=a;g.VariantOptionName=i;g.getVariantTypeOptions=c}),226);
__d("WAWebAnnouncementSpeakerIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="announcement-speaker";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=212;o=212;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 212 212",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"currentColor",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M89.5827 83.703C89.5827 82.9635 89.9699 82.278 90.6032 81.8962L119.16 64.6781C122.059 62.8863 125.902 64.8549 125.902 68.1319V137.101C125.902 140.308 122.206 142.288 119.301 140.639L90.6507 124.368C89.9905 123.993 89.5827 123.293 89.5827 122.534V83.703ZM46 96.2616C46 88.6676 52.5042 82.5114 60.5276 82.5114H80.209C81.3743 82.5114 82.3189 83.4561 82.3189 84.6213V121.652C82.3189 122.817 81.3743 123.762 80.209 123.762H75.6957L82.4837 147.779C83.0001 149.606 81.9267 151.465 80.0861 151.931L72.2787 153.908C70.4381 154.374 68.5274 153.271 68.0111 151.443L60.2202 123.878C60.2089 123.838 60.1983 123.798 60.1886 123.758C52.3218 123.588 46 117.498 46 110.012V96.2616ZM161.187 71.6946C160.374 70.6624 158.814 70.5245 157.751 71.3468L154.102 74.1721C153.034 74.9983 152.876 76.4799 153.682 77.5251C159.328 84.8487 162.362 93.7105 162.303 102.817C162.244 111.919 159.096 120.741 153.361 127.996C152.536 129.039 152.66 130.516 153.704 131.345L157.352 134.241C158.396 135.07 159.964 134.936 160.799 133.901C167.981 125.002 171.926 114.114 171.999 102.874C172.072 91.624 168.263 80.6813 161.187 71.6946ZM145.914 81.0162C145.113 79.9754 143.55 79.8499 142.494 80.6798L138.867 83.5311C137.806 84.3649 137.664 85.8456 138.444 86.9079C141.82 91.5035 143.641 96.9856 143.626 102.62C143.612 108.251 141.767 113.72 138.373 118.298C137.582 119.364 137.702 120.84 138.746 121.669L142.394 124.564C143.438 125.393 145.009 125.261 145.823 124.211C150.664 117.973 153.303 110.423 153.323 102.642C153.342 94.8522 150.735 87.2808 145.914 81.0162Z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.AnnouncementSpeakerIcon=a}),98);
__d("WAWebAvatarSpinner.react",["fbt","WAWebClassnames","WAWebSpinner.react","react","stylex"],(function(a,b,c,d,e,f,g,h){var i=["ref"],j,k,l=j||c("react"),m={container:{position:"x10l6tqk",top:"x13vifvy",insetInlineStart:"x1o0tod",display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",width:"xh8yej3",height:"x5yr21d",backgroundColor:"x1honnu5",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0}};function a(a){var b=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,i);var e=a.className,f=a.xstyle;a=a.size;a=a===void 0?50:a;return l.jsx("div",{"aria-label":h._(/*BTDS*/"Loading photo"),ref:b,className:d("WAWebClassnames").classnamesConvertMeToStylexPlease((k||(k=c("stylex")))(m.container,f),e),children:l.jsx(d("WAWebSpinner.react").Spinner,{size:a,stroke:3,color:"solidwhite"})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebChatProfilePictureGatingUtils",["WAWebABProps","WAWebWid"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebABProps").getABPropConfigValue("group_chat_profile_pictures_v2_enabled")}function a(a){return h()&&a!=null&&c("WAWebWid").isUser(a)&&!c("WAWebWid").isPSA(a)}g.shouldDisplayInitialsInProfilePicture=a}),98);
__d("WAWebCommunityGeneralChatImage.react",["bx","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j=c("bx").getURL(c("bx")("10639"));b=""+window.location.origin+j;function a(){return i.jsx("div",{className:"x10l6tqk x13vifvy x1o0tod xh8yej3 x5yr21d x1xsqp64 x18d0r48 x1vjfegm",style:{backgroundImage:"url("+j+")"},"aria-hidden":!0})}a.displayName=a.name+" [from "+f.id+"]";g.GeneralChatPlaceholderFullUrl=b;g.CommunityGeneralChatImage=a}),98);
__d("WAWebCommunitySquircleIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="community-squircle";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=180;p=180;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 180 180",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M90 0C1.43051e-05 0 0 0 0 90C0 180 1.43051e-05 180 90 180C180 180 180 180 180 90C180 0 180 0 90 0Z",fill:"currentColor",className:j(m==null?void 0:m.background)}),k.jsx("path",{transform:"translate(30, 52)",fillRule:"evenodd",clipRule:"evenodd",d:"M86.0728 25.3655C86.1287 25.7634 86.2023 26.1501 86.2934 26.5313C86.3389 26.7247 86.3886 26.9126 86.4426 27.0949C86.5491 27.4658 86.6736 27.831 86.8156 28.1888C87.0246 28.7152 87.2706 29.2248 87.5516 29.7138C87.7381 30.0342 87.939 30.3491 88.1538 30.6475C88.7962 31.5513 89.5655 32.3502 90.4362 33.0177C91.0223 33.4638 91.6483 33.8505 92.3056 34.1725C92.8094 34.4169 93.3294 34.6237 93.8617 34.7913C94.2205 34.9018 94.5877 34.9957 94.9632 35.0731C95.7326 35.2269 96.5143 35.3046 97.2978 35.3051C103.567 35.3051 108.649 30.0362 108.649 23.5368C108.649 17.0373 103.567 11.7684 97.2978 11.7684C96.5142 11.7662 95.7322 11.8439 94.9632 12.0005C94.5915 12.0741 94.2238 12.1682 93.8617 12.2822C93.3296 12.448 92.8095 12.6529 92.3056 12.8955C90.663 13.6984 89.2368 14.9092 88.1538 16.4205C87.9406 16.7244 87.7381 17.0338 87.5516 17.3598C87.2695 17.8481 87.0235 18.3579 86.8156 18.8847C86.6755 19.2383 86.5492 19.6029 86.4426 19.9731C86.3883 20.161 86.3385 20.3488 86.2934 20.5367C86.2023 20.9179 86.1287 21.3046 86.0728 21.7024C85.9037 22.9172 85.9037 24.1508 86.0728 25.3655ZM33.9272 25.3655C33.8739 25.7634 33.7977 26.1501 33.7071 26.5313C33.6617 26.7247 33.6119 26.9126 33.5579 27.0949C33.4514 27.4658 33.3269 27.8309 33.1849 28.1888C32.9755 28.7151 32.7294 29.2247 32.4484 29.7138C32.2624 30.0342 32.0615 30.3491 31.8467 30.6475C31.204 31.551 30.4347 32.3499 29.5642 33.0177C28.9782 33.4638 28.3521 33.8505 27.6948 34.1725C27.191 34.4169 26.6709 34.6237 26.1387 34.7913C25.7795 34.9018 25.4123 34.9957 25.0371 35.0731C24.2677 35.2268 23.486 35.3045 22.7024 35.3051C16.4334 35.3051 11.3514 30.0362 11.3514 23.5368C11.3514 17.0373 16.4334 11.7684 22.7024 11.7684C23.4861 11.7663 24.2681 11.844 25.0371 12.0005C25.4089 12.0742 25.7765 12.1682 26.1387 12.2822C26.6708 12.448 27.1908 12.6529 27.6948 12.8955C29.3375 13.6984 30.7636 14.9092 31.8467 16.4205C32.0599 16.7244 32.2624 17.0338 32.4484 17.3598C32.7304 17.8482 32.9766 18.3579 33.1849 18.8847C33.325 19.2383 33.4513 19.6029 33.5579 19.9731C33.6116 20.161 33.6613 20.3488 33.7071 20.5367C33.7977 20.9179 33.8718 21.3046 33.9272 21.7024C34.0963 22.9172 34.0963 24.1508 33.9272 25.3655ZM119.343 54.0764C119.204 53.836 119.05 53.5733 118.862 53.2826C118.66 52.9695 118.432 52.6341 118.171 52.2764C117.909 51.9186 117.62 51.5385 117.295 51.1472C116.97 50.7559 116.615 50.3534 116.224 49.9398C114.625 48.2625 112.798 46.8262 110.799 45.6746C110.168 45.3056 109.497 44.9591 108.788 44.6292C108.767 44.6181 108.748 44.6125 108.728 44.6013C100.676 41.1728 91.6054 41.1728 83.5538 44.6013C83.4404 44.6516 83.3336 44.7075 83.2235 44.7634C83.0429 44.8472 82.8778 44.9423 82.7027 45.0317C82.8007 45.0876 82.9003 45.1379 82.9978 45.1938C84.9925 46.3455 86.8856 47.6696 88.6562 49.1516C89.8126 50.1167 90.913 51.1488 91.952 52.2428C92.5945 52.9136 93.1818 53.5788 93.7185 54.2273C94.269 54.8925 94.7513 55.513 95.1817 56.1055C95.6249 56.7148 96.0075 57.2794 96.3488 57.7993C96.6719 58.3024 96.9455 58.7496 97.1817 59.1633C97.6294 59.9211 97.9634 60.7426 98.1726 61.6005L98.2601 62.2042H116.6C118.478 62.2042 120 60.682 120 58.8042V55.3676C119.81 54.9225 119.591 54.491 119.343 54.0764ZM77.6389 15.6162C77.5508 14.9906 77.435 14.382 77.292 13.7846C77.2208 13.4859 77.1425 13.1873 77.0577 12.8942C76.8886 12.3081 76.6929 11.7389 76.4727 11.181C76.1444 10.3541 75.7576 9.55357 75.3153 8.78587C75.0228 8.27866 74.7075 7.78837 74.3694 7.31498C72.6729 4.93631 70.4305 3.03412 67.8456 1.78084C67.0544 1.39541 66.2367 1.07141 65.3992 0.811523C64.8349 0.63682 64.2576 0.48466 63.6683 0.366313C62.4595 0.123014 61.231 0 59.9997 0C49.8923 0 42.1622 8.01379 42.1622 18.496C42.1622 28.9781 49.8923 36.9863 59.9997 36.9863C61.231 36.9863 62.4595 36.8633 63.6683 36.62C64.2576 36.5016 64.8349 36.3495 65.3992 36.1748C66.2367 35.9149 67.0544 35.5909 67.8456 35.2055C70.4305 33.9522 72.6729 32.05 74.3694 29.6713C74.7072 29.1979 75.0225 28.7076 75.3153 28.2004C75.7576 27.4327 76.1444 26.6322 76.4727 25.8053C76.6902 25.2474 76.8886 24.6726 77.0577 24.0921C77.1425 23.799 77.2208 23.5004 77.292 23.2017C77.435 22.6043 77.5508 21.9957 77.6389 21.3701C77.9042 19.462 77.9042 17.5243 77.6389 15.6162ZM93.0965 61.4246C92.8978 61.0703 92.6696 60.6818 92.4021 60.2532C92.1144 59.7961 91.7847 59.299 91.4118 58.7733C91.039 58.2476 90.623 57.6876 90.1612 57.1162C89.6993 56.5448 89.1905 55.9448 88.6326 55.3448C87.7365 54.3736 86.7887 53.456 85.7938 52.5964C84.2613 51.2774 82.6237 50.0979 80.8992 49.0708C79.999 48.5337 79.0431 48.0195 78.0315 47.5395C78.0039 47.522 77.9751 47.5067 77.9453 47.4938C73.2477 45.2653 67.3414 43.7111 59.9989 43.7111C52.6564 43.7111 46.7496 45.2653 42.0526 47.4938C41.8888 47.5681 41.7398 47.6538 41.5803 47.7338C40.8941 48.0709 40.2347 48.4252 39.6009 48.7851C39.2573 48.9851 38.9214 49.1851 38.5931 49.3851C37.0554 50.3392 35.5882 51.4126 34.204 52.5964C33.209 53.4558 32.2612 54.3734 31.3652 55.3448C30.8084 55.9448 30.3001 56.5391 29.8367 57.1162C29.3732 57.6933 28.9583 58.2419 28.5854 58.7733C28.2126 59.3047 27.8834 59.7961 27.5957 60.2532C27.3282 60.6818 27.1 61.0703 26.9018 61.4246C26.8833 61.4521 26.8664 61.4807 26.8511 61.5103C26.6425 61.8817 26.4728 62.2074 26.3385 62.476C26.0699 63.0131 25.9459 63.3159 25.9459 63.3159V70.5726C25.9459 72.4504 27.4682 73.9726 29.3459 73.9726H90.6541C92.5318 73.9726 94.0541 72.4504 94.0541 70.5726V63.3159C93.7702 62.6666 93.4505 62.035 93.0965 61.4246ZM21.7773 61.6062C21.8277 61.1833 21.9651 60.7758 22.1807 60.4102C22.3487 60.086 22.4749 59.6948 22.7367 59.2421C23.0271 58.7447 23.2558 58.3032 23.5732 57.8057C23.9132 57.2804 24.2785 56.7159 24.7161 56.1179C25.1536 55.5199 25.6319 54.8883 26.1698 54.24C26.7076 53.5917 27.2983 52.921 27.9447 52.2392C30.4236 49.6351 33.2397 47.3846 36.3159 45.5492C36.6355 45.3592 36.965 45.1692 37.2973 44.9847C37.1535 44.9121 37.0218 44.8339 36.8724 44.7668C36.7622 44.7109 36.652 44.655 36.5418 44.6047C32.5724 42.8404 28.2751 41.9636 23.9418 42.0338C19.6088 41.9636 15.3116 42.8405 11.3424 44.6047C11.3215 44.6159 11.3028 44.6215 11.2818 44.6326C10.5721 44.9624 9.90032 45.3089 9.26825 45.6778C8.05739 46.376 6.90772 47.1782 5.83185 48.0754C5.1338 48.66 4.46803 49.2832 3.83757 49.9421C3.44632 50.3557 3.08887 50.7581 2.76521 51.1493C2.44064 51.5406 2.14858 51.9206 1.88682 52.2783C1.62507 52.636 1.39363 52.9713 1.19139 53.2843C1.00403 53.5749 0.826588 53.8376 0.68717 54.0779C0.224832 54.8716 0 55.369 0 55.369V58.8042C0 60.682 1.52223 62.2042 3.4 62.2042H21.7371L21.7773 61.6062Z",fill:"#fff",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.CommunitySquircleIcon=a}),98);
__d("WAWebDefaultBroadcastIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="default-broadcast";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=212;o=212;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 212 212",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"#DFE5E7",className:"background",d:"M106.251,0.5C164.653,0.5,212,47.846,212,106.25S164.653,212,106.25,212C47.846,212,0.5,164.654,0.5,106.25 S47.846,0.5,106.251,0.5z"}),k.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M152.168,54.014l-11.66,4.364v95.453l11.744,4.161L152.168,54.014z M49.742,121.662l18.892,6.698 c0,0.14-0.021,0.274-0.021,0.414c0,14.507,11.782,26.269,26.318,26.269c8.39,0,15.849-3.935,20.669-10.039l18.328,6.495v-90.66 L49.742,92.355V121.662L49.742,121.662z M108.302,142.417c-3.455,3.371-8.169,5.458-13.371,5.458 c-9.818,0-17.921-7.419-19.005-16.934L108.302,142.417z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultBroadcastIcon=a}),98);
__d("WAWebDefaultCommunityRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-community-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 48 48",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M15.029 24.901a9.5 9.5 0 0 0-2.965.346c-.592.167-1.264.44-1.828.875-.576.444-1.1 1.108-1.203 2.022-.048.427-.033 1.342-.021 1.86.02.924.777 1.996 1.684 1.996h3.767c-.224-.475-.357-1.356-.374-1.918-.016-.551-.06-2.039.048-2.828.055-.412.153-.797.281-1.154a5.4 5.4 0 0 1 .61-1.199M33.937 32h3.767c.907 0 1.663-1.072 1.684-1.996.012-.518.027-1.433-.021-1.86-.104-.914-.627-1.578-1.203-2.022-.564-.435-1.236-.708-1.828-.875a9.5 9.5 0 0 0-2.965-.346c.24.35.45.748.61 1.199.129.357.227.742.282 1.154.107.79.064 2.277.048 2.828-.017.562-.15 1.443-.374 1.918",fill:"#606263",className:j(m==null?void 0:m.primary)}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.803 24.383a16 16 0 0 1 4.397-.616c1.818 0 3.335.308 4.397.616.548.159 1.202.383 1.788.743.594.366 1.183.913 1.477 1.734q.117.321.17.696c.076.56.047 1.82.028 2.46-.027.918-.781 1.984-1.684 1.984H18.024c-.903 0-1.657-1.066-1.684-1.984-.019-.64-.048-1.9.028-2.46q.053-.375.17-.696c.294-.821.883-1.368 1.477-1.734.585-.36 1.24-.585 1.787-.743m10.591-4.632a3.37 3.37 0 0 1 3.377-3.369 3.37 3.37 0 0 1 3.378 3.37 3.38 3.38 0 0 1-3.378 3.381 3.38 3.38 0 0 1-3.378-3.382M19.696 17.51A4.51 4.51 0 0 1 24.2 13a4.51 4.51 0 0 1 4.504 4.51 4.5 4.5 0 0 1-4.504 4.496 4.5 4.5 0 0 1-4.504-4.497m-8.444 2.242a3.37 3.37 0 0 1 3.378-3.369 3.37 3.37 0 0 1 3.377 3.37 3.38 3.38 0 0 1-3.377 3.381 3.38 3.38 0 0 1-3.378-3.382",fill:"#606263",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultCommunityRefreshedIcon=a}),98);
__d("WAWebDefaultContactRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-contact-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 48 48",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M24 23q-1.857 0-3.178-1.322Q19.5 20.357 19.5 18.5t1.322-3.178T24 14t3.178 1.322Q28.5 16.643 28.5 18.5t-1.322 3.178T24 23m-6.75 10q-.928 0-1.59-.66-.66-.662-.66-1.59v-.9q0-.956.492-1.758A3.3 3.3 0 0 1 16.8 26.87a16.7 16.7 0 0 1 3.544-1.308q1.8-.435 3.656-.436 1.856 0 3.656.436T31.2 26.87q.816.422 1.308 1.223T33 29.85v.9q0 .928-.66 1.59-.662.66-1.59.66z",fill:"#606263",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultContactRefreshedIcon=a}),98);
__d("WAWebDefaultGroupIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-group";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 212 212",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M105.946 0.25C164.318 0.25 211.64 47.596 211.64 106C211.64 164.404 164.318 211.75 105.945 211.75C47.571 211.75 0.25 164.404 0.25 106C0.25 47.596 47.571 0.25 105.946 0.25Z",fill:"#DFE5E7",className:j(m==null?void 0:m.background)}),k.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M102.282 77.2856C102.282 87.957 93.8569 96.5713 83.3419 96.5713C72.827 96.5713 64.339 87.957 64.339 77.2856C64.339 66.6143 72.827 58 83.3419 58C93.8569 58 102.282 66.6143 102.282 77.2856ZM150.35 80.1427C150.35 89.9446 142.612 97.857 132.954 97.857C123.296 97.857 115.5 89.9446 115.5 80.1427C115.5 70.3409 123.296 62.4285 132.954 62.4285C142.612 62.4285 150.35 70.3409 150.35 80.1427ZM83.3402 109.428C68.5812 109.428 39 116.95 39 131.928V143.714C39 147.25 41.8504 148 45.3343 148H121.346C124.83 148 127.68 147.25 127.68 143.714V131.928C127.68 116.95 98.0991 109.428 83.3402 109.428ZM126.804 110.853C127.707 110.871 128.485 110.886 129 110.886C143.759 110.886 174 116.95 174 131.929V141.571C174 145.107 171.15 148 167.666 148H134.854C135.551 146.007 135.995 143.821 135.995 141.571L135.75 131.071C135.75 121.51 130.136 117.858 124.162 113.971C122.772 113.067 121.363 112.15 120 111.143C119.981 111.123 119.962 111.098 119.941 111.07C119.893 111.007 119.835 110.931 119.747 110.886C121.343 110.747 124.485 110.808 126.804 110.853Z",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultGroupIcon=a}),98);
__d("WAWebDefaultGroupRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-group-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 48 48",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.822 21.678Q19.143 23 21 23t3.178-1.322T25.5 18.5t-1.322-3.178Q22.857 14 21 14t-3.178 1.322T16.5 18.5t1.322 3.178M12.66 32.34q.66.66 1.589.661h13.5q.928 0 1.59-.66.66-.662.66-1.59v-.9q0-.956-.492-1.758A3.3 3.3 0 0 0 28.2 26.87a16.7 16.7 0 0 0-3.544-1.308q-1.8-.435-3.656-.436-1.856 0-3.656.436T13.8 26.869a3.3 3.3 0 0 0-1.308 1.223A3.3 3.3 0 0 0 12 29.85v.9q0 .928.66 1.59m21.09.66h-2.392A4.16 4.16 0 0 0 32 30.75v-.9c0-1-.263-1.95-.788-2.804a5.3 5.3 0 0 0-1.675-1.713q.563.093 1.119.228 1.8.436 3.544 1.308.815.422 1.308 1.223.492.802.492 1.758v.9q0 .928-.661 1.59-.66.66-1.59.66M27 23a4.6 4.6 0 0 1-1.18-.147c1.105-1.211 1.68-2.692 1.68-4.353s-.575-3.142-1.68-4.353A4.6 4.6 0 0 1 27 14q1.856 0 3.178 1.322Q31.5 16.643 31.5 18.5t-1.322 3.178T27 23",fill:"#606263",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultGroupRefreshedIcon=a}),98);
__d("WAWebDefaultNewsletterIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-newsletter";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 212 212",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("rect",{width:212,height:212,rx:106,fill:"currentColor",className:j(m==null?void 0:m.background)}),k.jsx("path",{d:"M157.123 99.0265C154.027 75.5432 134.626 56.8186 111.097 54.6979C80.5503 51.9047 55.3184 75.388 54.7508 105.906C54.5444 116.872 58.7239 126.286 60.8395 130.32L54.6992 150.648C53.5124 154.579 57.1759 158.252 61.0975 157.062L81.1179 151.062C88.7546 155.304 97.3201 157.528 106.092 157.528C136.742 157.528 161.2 130.527 157.072 99.0265H157.123ZM85.7103 119.82C87.1034 121.889 86.9486 124.682 85.1943 126.441C82.8723 128.82 79.0024 128.355 77.1448 125.562C73.3781 119.975 71.1593 113.199 71.1593 105.958C71.1593 98.7161 73.5329 91.4229 77.6092 85.6813C79.4152 83.1468 83.1819 82.9916 85.4007 85.2158C87.2066 87.0262 87.3614 89.8194 85.9167 91.8884C83.1303 95.8712 81.5307 100.733 81.5307 105.958C81.5307 111.182 83.1303 115.837 85.8135 119.768L85.7103 119.82ZM106.35 113.716C102.067 113.716 98.61 110.251 98.61 105.958C98.61 101.664 102.067 98.1989 106.35 98.1989C110.633 98.1989 114.09 101.664 114.09 105.958C114.09 110.251 110.633 113.716 106.35 113.716ZM134.471 126.337C132.665 128.872 128.899 129.027 126.732 126.803C124.926 124.993 124.771 122.199 126.216 120.13C129.002 116.148 130.653 111.234 130.653 106.009C130.653 100.785 128.95 95.7678 126.112 91.7849C124.616 89.6642 124.719 86.8193 126.525 84.9572C128.692 82.7847 132.407 82.8882 134.265 85.4227C138.496 91.216 140.973 98.3023 140.973 106.061C140.973 113.82 138.548 120.648 134.471 126.389V126.337Z",fill:"#FFFFFF",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultNewsletterIcon=a}),98);
__d("WAWebDefaultUserColorIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="default-user-color";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=212;o=212;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 212 212",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"currentColor",className:"background",d:"M106.251,0.5C164.653,0.5,212,47.846,212,106.25S164.653,212,106.25,212C47.846,212,0.5,164.654,0.5,106.25 S47.846,0.5,106.251,0.5z"}),k.jsxs("g",{children:[k.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M173.561,171.615c-0.601-0.915-1.287-1.907-2.065-2.955c-0.777-1.049-1.645-2.155-2.608-3.299 c-0.964-1.144-2.024-2.326-3.184-3.527c-1.741-1.802-3.71-3.646-5.924-5.47c-2.952-2.431-6.339-4.824-10.204-7.026 c-1.877-1.07-3.873-2.092-5.98-3.055c-0.062-0.028-0.118-0.059-0.18-0.087c-9.792-4.44-22.106-7.529-37.416-7.529 s-27.624,3.089-37.416,7.529c-0.338,0.153-0.653,0.318-0.985,0.474c-1.431,0.674-2.806,1.376-4.128,2.101 c-0.716,0.393-1.417,0.792-2.101,1.197c-3.421,2.027-6.475,4.191-9.15,6.395c-2.213,1.823-4.182,3.668-5.924,5.47 c-1.161,1.201-2.22,2.384-3.184,3.527c-0.964,1.144-1.832,2.25-2.609,3.299c-0.778,1.049-1.464,2.04-2.065,2.955 c-0.557,0.848-1.033,1.622-1.447,2.324c-0.033,0.056-0.073,0.119-0.104,0.174c-0.435,0.744-0.79,1.392-1.07,1.926 c-0.559,1.068-0.818,1.678-0.818,1.678v0.398c18.285,17.927,43.322,28.985,70.945,28.985c27.678,0,52.761-11.103,71.055-29.095 v-0.289c0,0-0.619-1.45-1.992-3.778C174.594,173.238,174.117,172.463,173.561,171.615z"}),k.jsx("path",{fill:"#FFFFFF",className:"primary",d:"M106.002,125.5c2.645,0,5.212-0.253,7.68-0.737c1.234-0.242,2.443-0.542,3.624-0.896 c1.772-0.532,3.482-1.188,5.12-1.958c2.184-1.027,4.242-2.258,6.15-3.67c2.863-2.119,5.39-4.646,7.509-7.509 c0.706-0.954,1.367-1.945,1.98-2.971c0.919-1.539,1.729-3.155,2.422-4.84c0.462-1.123,0.872-2.277,1.226-3.458 c0.177-0.591,0.341-1.188,0.49-1.792c0.299-1.208,0.542-2.443,0.725-3.701c0.275-1.887,0.417-3.827,0.417-5.811 c0-1.984-0.142-3.925-0.417-5.811c-0.184-1.258-0.426-2.493-0.725-3.701c-0.15-0.604-0.313-1.202-0.49-1.793 c-0.354-1.181-0.764-2.335-1.226-3.458c-0.693-1.685-1.504-3.301-2.422-4.84c-0.613-1.026-1.274-2.017-1.98-2.971 c-2.119-2.863-4.646-5.39-7.509-7.509c-1.909-1.412-3.966-2.643-6.15-3.67c-1.638-0.77-3.348-1.426-5.12-1.958 c-1.181-0.355-2.39-0.655-3.624-0.896c-2.468-0.484-5.035-0.737-7.68-0.737c-21.162,0-37.345,16.183-37.345,37.345 C68.657,109.317,84.84,125.5,106.002,125.5z"})]})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultUserColorIcon=a}),98);
__d("WAWebDefaultUserSquareIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox","innerStyles"],i,j,k=i||c("react"),l="default-user-square";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox,m=a.innerStyles;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var n;if(i){var o=i.x;o=o===void 0?0:o;var p=i.y;p=p===void 0?0:p;var q=i.width;q=q===void 0?0:q;i=i.height;i=i===void 0?0:i;n=[o,p,q,i].join(" ")}o=212;p=212;(e!=null||f!=null)&&(o=e,p=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:n!=null?n:"0 0 212 212",height:o,width:p,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 212 212",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"#DFE5E7",d:"M0,0h212v212H0V0z",className:j(m==null?void 0:m.background)}),k.jsx("path",{fill:"#FFFFFF",d:"M106,125.5c2.6,0,5.2-0.3,7.7-0.7c1.2-0.2,2.4-0.5,3.6-0.9c1.8-0.5,3.5-1.2,5.1-2c2.2-1,4.2-2.3,6.1-3.7 c2.9-2.1,5.4-4.6,7.5-7.5c0.7-1,1.4-1.9,2-3c0.9-1.5,1.7-3.2,2.4-4.8c0.5-1.1,0.9-2.3,1.2-3.5c0.2-0.6,0.3-1.2,0.5-1.8 c0.3-1.2,0.5-2.4,0.7-3.7c0.3-1.9,0.4-3.8,0.4-5.8s-0.1-3.9-0.4-5.8c-0.2-1.3-0.4-2.5-0.7-3.7c-0.1-0.6-0.3-1.2-0.5-1.8 c-0.4-1.2-0.8-2.3-1.2-3.5c-0.7-1.7-1.5-3.3-2.4-4.8c-0.6-1-1.3-2-2-3c-2.1-2.9-4.6-5.4-7.5-7.5c-1.9-1.4-4-2.6-6.1-3.7 c-1.6-0.8-3.3-1.4-5.1-2c-1.2-0.4-2.4-0.7-3.6-0.9c-2.5-0.5-5-0.7-7.7-0.7c-21.2,0-37.3,16.2-37.3,37.3 C68.7,109.3,84.8,125.5,106,125.5z M175,173.9c-0.4-0.7-0.9-1.5-1.4-2.3c-0.6-0.9-1.3-1.9-2.1-3c-0.8-1-1.6-2.2-2.6-3.3 s-2-2.3-3.2-3.5c-1.7-1.8-3.7-3.6-5.9-5.5c-3-2.4-6.3-4.8-10.2-7c-1.9-1.1-3.9-2.1-6-3.1c-0.1,0-0.1-0.1-0.2-0.1 c-9.8-4.4-22.1-7.5-37.4-7.5s-27.6,3.1-37.4,7.5c-0.3,0.2-0.7,0.3-1,0.5c-1.4,0.7-2.8,1.4-4.1,2.1c-0.7,0.4-1.4,0.8-2.1,1.2 c-3.4,2-6.5,4.2-9.1,6.4c-2.2,1.8-4.2,3.7-5.9,5.5c-1.2,1.2-2.2,2.4-3.2,3.5s-1.8,2.2-2.6,3.3c-0.8,1-1.5,2-2.1,3 c-0.6,0.8-1,1.6-1.4,2.3c0,0.1-0.1,0.1-0.1,0.2v0.1c-9.6,15-9.6,32.9-9.6,32.9s61.2,0,78.7,0h0.1c17.4,0,78.8,0,78.8,0 S184.7,189,175,173.9z",className:j(m==null?void 0:m.primary)})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DefaultUserSquareIcon=a}),98);
__d("WAWebDisappearingIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="disappearing";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=36;o=36;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 36 36",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M18 31.5C18.0909 31.5 18.1817 31.4991 18.2722 31.4973C19.1005 31.4809 19.7586 30.7961 19.7422 29.9679C19.7258 29.1396 19.041 28.4815 18.2128 28.4979C18.142 28.4993 18.0711 28.5 18 28.5V31.5ZM18 7.5C18.0711 7.5 18.142 7.5007 18.2128 7.50211C19.041 7.51853 19.7258 6.86039 19.7422 6.03213C19.7586 5.20387 19.1005 4.51912 18.2722 4.5027C18.1817 4.5009 18.0909 4.5 18 4.5V7.5ZM24.5153 6.17374C23.7901 5.77341 22.8776 6.03683 22.4772 6.76211C22.0769 7.48739 22.3403 8.39988 23.0656 8.8002C23.1891 8.86838 23.3111 8.93898 23.4316 9.01195C24.1401 9.44118 25.0625 9.21475 25.4917 8.5062C25.921 7.79765 25.6945 6.87529 24.986 6.44605C24.8311 6.35223 24.6742 6.26144 24.5153 6.17374ZM29.554 11.014C29.1247 10.3055 28.2024 10.079 27.4938 10.5083C26.7852 10.9375 26.5588 11.8599 26.9881 12.5684C27.061 12.6889 27.1316 12.8109 27.1998 12.9344C27.6001 13.6597 28.5126 13.9231 29.2379 13.5228C29.9632 13.1224 30.2266 12.2099 29.8263 11.4847C29.7386 11.3258 29.6478 11.1689 29.554 11.014ZM31.4973 17.7278C31.4809 16.8995 30.7961 16.2414 29.9679 16.2578C29.1396 16.2742 28.4815 16.959 28.4979 17.7872C28.4993 17.858 28.5 17.9289 28.5 18C28.5 18.0711 28.4993 18.142 28.4979 18.2128C28.4815 19.041 29.1396 19.7258 29.9679 19.7422C30.7961 19.7586 31.4809 19.1005 31.4973 18.2722C31.4991 18.1817 31.5 18.0909 31.5 18C31.5 17.9091 31.4991 17.8183 31.4973 17.7278ZM29.8263 24.5153C30.2266 23.7901 29.9632 22.8776 29.2379 22.4772C28.5126 22.0769 27.6001 22.3403 27.1998 23.0656C27.1316 23.1891 27.061 23.3111 26.9881 23.4316C26.5588 24.1401 26.7852 25.0625 27.4938 25.4917C28.2024 25.921 29.1247 25.6945 29.554 24.986C29.6478 24.8311 29.7386 24.6742 29.8263 24.5153ZM24.986 29.554C25.6945 29.1247 25.921 28.2024 25.4917 27.4938C25.0625 26.7852 24.1401 26.5588 23.4316 26.9881C23.3111 27.061 23.1891 27.1316 23.0656 27.1998C22.3403 27.6001 22.0769 28.5126 22.4772 29.2379C22.8776 29.9632 23.7901 30.2266 24.5153 29.8263C24.6742 29.7386 24.8311 29.6478 24.986 29.554Z"}),k.jsx("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M18.0001 4.5C18 4.5 17.9999 4.5 17.9998 4.5C10.5439 4.5 4.49976 10.5442 4.49976 18C4.49976 25.4558 10.5439 31.5 17.9998 31.5C17.9999 31.5 18 31.5 18.0001 31.5V28.5C18 28.5 17.9999 28.5 17.9998 28.5C12.2008 28.5 7.49976 23.799 7.49976 18C7.49976 12.201 12.2008 7.5 17.9998 7.5C17.9999 7.5 18 7.5 18.0001 7.5V4.5Z"}),k.jsx("path",{fill:"currentColor",d:"M23.3247 12.0107C23.669 11.7525 24.1507 11.7867 24.455 12.091V12.091C24.7593 12.3953 24.7935 12.877 24.5353 13.2213L19.9714 19.3066C19.2589 20.2566 17.8701 20.3553 17.0304 19.5156V19.5156C16.1907 18.6759 16.2894 17.2871 17.2394 16.5746L23.3247 12.0107Z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DisappearingIcon=a}),98);
__d("WAWebDisappearingMessagesRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="disappearing-messages-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C12.0547 22 12.1094 21.9996 12.1639 21.9987C12.7775 21.9888 13.2669 21.4834 13.257 20.8698C13.2471 20.2563 12.7417 19.7669 12.1281 19.7767C12.0855 19.7774 12.0428 19.7778 12 19.7778C7.70445 19.7778 4.22222 16.2955 4.22222 12C4.22222 7.70445 7.70445 4.22222 12 4.22222C12.0428 4.22222 12.0855 4.22257 12.1281 4.22325C12.7417 4.23314 13.2471 3.74375 13.257 3.13018C13.2669 2.51661 12.7775 2.0112 12.1639 2.00132C12.1094 2.00044 12.0547 2 12 2Z",fill:"currentColor"}),k.jsx("path",{d:"M16.8592 3.25814C16.3231 2.95957 15.6465 3.15213 15.3479 3.68825C15.0493 4.22437 15.2419 4.90102 15.778 5.19959C15.8522 5.24089 15.9256 5.28338 15.9983 5.32703C16.5243 5.643 17.2069 5.4727 17.5229 4.94665C17.8389 4.4206 17.6686 3.738 17.1425 3.42203C17.0491 3.36591 16.9546 3.31127 16.8592 3.25814Z",fill:"currentColor"}),k.jsx("path",{d:"M19.0534 6.47712C19.5794 6.16115 20.262 6.33145 20.578 6.8575C20.6341 6.95093 20.6887 7.04537 20.7419 7.14077C21.0404 7.67689 20.8479 8.35353 20.3118 8.65211C19.7756 8.95068 19.099 8.75811 18.8004 8.22199C18.7591 8.14782 18.7166 8.07439 18.673 8.00173C18.357 7.47568 18.5273 6.79309 19.0534 6.47712Z",fill:"currentColor"}),k.jsx("path",{d:"M21.9987 11.8361C21.9888 11.2225 21.4834 10.7331 20.8698 10.743C20.2563 10.7529 19.7669 11.2583 19.7767 11.8719C19.7774 11.9145 19.7778 11.9572 19.7778 12C19.7778 12.0428 19.7774 12.0855 19.7767 12.1281C19.7669 12.7417 20.2563 13.2471 20.8698 13.257C21.4834 13.2669 21.9888 12.7775 21.9987 12.1639C21.9996 12.1094 22 12.0547 22 12C22 11.9453 21.9996 11.8906 21.9987 11.8361Z",fill:"currentColor"}),k.jsx("path",{d:"M20.3118 15.3479C20.8479 15.6465 21.0404 16.3231 20.7419 16.8592C20.6887 16.9546 20.6341 17.0491 20.578 17.1425C20.262 17.6686 19.5794 17.8389 19.0534 17.5229C18.5273 17.2069 18.357 16.5243 18.673 15.9983C18.7166 15.9256 18.7591 15.8522 18.8004 15.778C19.099 15.2419 19.7756 15.0493 20.3118 15.3479Z",fill:"currentColor"}),k.jsx("path",{d:"M17.1425 20.578C17.6686 20.262 17.8389 19.5794 17.5229 19.0534C17.2069 18.5273 16.5243 18.357 15.9983 18.673C15.9256 18.7166 15.8522 18.7591 15.778 18.8004C15.2419 19.099 15.0493 19.7756 15.3479 20.3118C15.6465 20.8479 16.3231 21.0404 16.8592 20.7419C16.9546 20.6887 17.0491 20.6341 17.1425 20.578Z",fill:"currentColor"}),k.jsx("path",{d:"M16.7811 7.6229C16.5556 7.39749 16.1988 7.37213 15.9438 7.5634L11.3327 11.0217C10.6836 11.5085 10.6161 12.4574 11.1899 13.0312L11.3728 13.2141C11.9465 13.7878 12.8954 13.7204 13.3823 13.0713L16.8406 8.46018C17.0318 8.20516 17.0065 7.84831 16.7811 7.6229Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DisappearingMessagesRefreshedIcon=a}),98);
__d("WAWebDoubleChevronIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="double-chevron";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=66;o=66;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 66 66",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M52.1731 31.43L41.2382 16.1374C40.3179 14.8382 38.8292 14.0532 37.2323 14.0532C33.1994 14.0532 30.8716 18.6004 33.1994 21.8755L41.1299 32.9999L33.1994 44.1243C30.8446 47.3994 33.1994 51.9466 37.2323 51.9466C38.8292 51.9466 40.345 51.1616 41.2652 49.8624L52.2002 34.5698C52.8498 33.6224 52.8498 32.3774 52.1731 31.43Z",fill:"currentColor"}),k.jsx("path",{d:"M33.2264 31.43L22.3186 16.1374C21.3712 14.8382 19.8826 14.0532 18.2856 14.0532C14.2527 14.0532 11.8979 18.6004 14.2527 21.8755L22.1832 32.9999L14.2527 44.1243C11.8979 47.3994 14.2527 51.9466 18.2856 51.9466C19.8826 51.9466 21.3983 51.1616 22.3186 49.8624L33.2535 34.5698C33.9031 33.6224 33.9031 32.3774 33.2264 31.43Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.DoubleChevronIcon=a}),98);
__d("WAWebHasAcceptedBizBotTos",["WAWebBotTos","WAWebTos","react","useWAWebListener"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useState;function a(){var a=i(d("WAWebBotTos").hasAcceptedBizBotTos),b=a[0],c=a[1];d("useWAWebListener").useListener(d("WAWebTos").TosManager,"change",function(){c(d("WAWebBotTos").hasAcceptedBizBotTos())});return b}g.useHasAcceptedBizBotTos=a}),98);
__d("WAWebIdleComponent.react",["WAWebIdleTaskRunner","WAWebWid","react","useLazyRef","useWAWebPrevious"],(function(a,b,c,d,e,f,g){var h,i;b=i||d("react");var j=h||(h=c("react")),k=b.useEffect,l=b.useState;function a(a){var b=a.children,e=a.onComplex,f=a.waitIdle,g=f===void 0?!1:f,h=a.id;f=l(function(){return d("WAWebIdleTaskRunner").UIBusyTasks.isBusy()});var i=f[0],m=f[1],n=function(){m(!1)},o=c("useLazyRef")(function(){return g?d("WAWebIdleTaskRunner").UIBusyTasks.enqueue(n):null}),p=c("useWAWebPrevious")(h);k(function(){return function(){g&&o.current!=null&&d("WAWebIdleTaskRunner").UIBusyTasks.dequeue(o.current)}},[]);k(function(){if(!c("WAWebWid").equals(p,h)||!g){i&&o.current!=null&&d("WAWebIdleTaskRunner").UIBusyTasks.dequeue(o.current);var a=d("WAWebIdleTaskRunner").UIBusyTasks.isBusy();a&&g&&(o.current=d("WAWebIdleTaskRunner").UIBusyTasks.enqueue(n));m(a)}},[h,o,i,p,g]);return i&&g?j.jsx(j.Fragment,{children:b}):e()}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebInitialsFromNameUtils",["$InternalEnum","WAWebL10N"],(function(a,b,c,d,e,f,g){e=b("$InternalEnum").Mirrored(["ARABIC","LATIN","HEBREW","THAI","GUJARATI","DEVANAGARI","CYRILLIC","BENGALI","HAN"]);f=new RegExp(/[\u0600-\u0604\u0606-\u060B\u060D-\u061A\u061C-\u061E\u0620-\u063F\u0641-\u064A\u0656-\u066F\u0671-\u06DC\u06DE-\u06FF\u0750-\u077F\u0870-\u088E\u0890\u0891\u0898-\u08E1\u08E3-\u08FF\uFB50-\uFBC2\uFBD3-\uFD3D\uFD40-\uFD8F\uFD92-\uFDC7\uFDCF\uFDF0-\uFDFF\uFE70-\uFE74\uFE76-\uFEFC]/);b=new RegExp(/[A-Za-z\xAA\xBA\xC0-\xD6\xD8-\xF6\xF8-\u0249\u02E0-\u02E4\u1D00-\u1D25\u1D2C-\u1D5C\u1D62-\u1D65\u1D6B-\u1D77\u1D79-\u1DBE\u1E00-\u1EFF\u2071\u207F\u2090-\u209C\u212A\u212B\u2132\u214E\u2160-\u2188\u2C60-\u2C7F\uA722-\uA787\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA7FF\uAB30-\uAB5A\uAB5C-\uAB64\uAB66-\uAB69\uFB00-\uFB06\uFF21-\uFF3A\uFF41-\uFF5A]/);var h=new RegExp(/[\u0591-\u05C7\u05D0-\u05EA\u05EF-\u05F4\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFB4F]/),i=new RegExp(/[\u0E01-\u0E3A\u0E40-\u0E5B]/),j=new RegExp(/[\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1\u0AF9-\u0AFF]/),k=new RegExp(/[\u0900-\u0950\u0955-\u0963\u0966-\u097F\uA8E0-\uA8FF]/),l=new RegExp(/[\u0400-\u0484\u0487-\u052F\u1C80-\u1C88\u1D2B\u1D78\u2DE0-\u2DFF\uA640-\uA69F\uFE2E\uFE2F]/),m=new RegExp(/[\u0980-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FE]/),n=new RegExp(/[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]/),o=new Map([[e.ARABIC,f],[e.LATIN,b],[e.HEBREW,h],[e.THAI,i],[e.GUJARATI,j],[e.DEVANAGARI,k],[e.CYRILLIC,l],[e.BENGALI,m],[e.HAN,n]]),p=new RegExp(/[\u093A\u093B\u093E-\u094C\u094E\u094F\u0955-\u0957\u0962\u0963]/),q=new RegExp(/[\u09BE-\u09CC\u09E2\u09E3]/),r=new RegExp(/[\u0ABE-\u0ACC\u0AE2\u0AE3]/),s=new RegExp(/[\u0E30-\u0E59]/),t=a([f,i,j,k,m]),u=a([k,m,j]),v=a(Array.from(o.values()));function w(a){return Array.from(o.keys()).find(function(b){b=o.get(b);return b==null?void 0:b.test(a)})}function x(a){return t.test(a)}function y(a){return n.test(a)}function z(a){return v.test(a)}function a(a){return new RegExp(a.map(function(a){return a.source}).join("|"))}function A(a){var b=!1;a.firstName!=null&&(b=x(a.firstName));var c=a.firstName!=null&&a.firstName!==""&&!y(a.firstName);b=b!==!0&&a.lastName!=null&&a.lastName!=="";a.firstName!=null&&a.firstName!==""&&n.test(a.firstName)&&!b&&(c=!0);a=a.lastName===""&&a.firstName==="";a=c!==!0&&b!==!0&&!a;return{showFirstNameInitial:c,showLastNameInitial:b,showPushnameInitial:a}}function B(a,b,d){a=a==null?void 0:a.trim();var e=null;a!=null&&b!=null&&(a==null?void 0:a.length)>0?e=b.trim().replace(a,"").trim():e=b==null?void 0:b.trim();b=c("WAWebL10N").getFullLocale();a=a==null?void 0:a.toLocaleUpperCase(b);e=(e=e)==null?void 0:e.toLocaleUpperCase(b);d=d==null?void 0:d.toLocaleUpperCase(b);return{firstName:a,lastName:e,pushname:d}}function C(a){var b=a.charAt(0);a=a.charAt(1);var c=null,d=null;k.test(b)?(c=k,d=p):m.test(b)?(c=m,d=q):j.test(b)&&(c=j,d=r);if(c==null||d==null)return;return a!=null&&c.test(b)&&!d.test(b)&&d.test(a)?b+a:c.test(b)?b:null}function D(a,b){var c=a.charAt(0);if(u.test(a))return C(a);if(c!=null&&i.test(c)&&s.test(c)){var d=a==null?void 0:a.slice(1).trim();d=d==null?void 0:d.charAt(0);return z(d)&&!s.test(d)?d:null}if(y(a)&&!b)return a.slice(0,2);return z(c)?c:null}function E(a){a=B(a.shortName,a.name,a.pushname);var b=A(a),c=null,d=null,e=a.firstName,f=b.showFirstNameInitial===!0&&b.showLastNameInitial===!1;b.showFirstNameInitial===!0&&e!=null&&(c=D(e,f));b.showLastNameInitial===!0&&a.lastName!=null&&(d=D(a.lastName,f));b.showPushnameInitial===!0&&a.pushname!=null&&(c=D(a.pushname,!0),d=null);c!=null&&d!=null&&w(c)!==w(d)&&(d=null);return{firstInitial:c,secondInitial:d}}function d(a){return E({shortName:a==null?void 0:a.shortName,name:a==null?void 0:a.name,pushname:a==null?void 0:a.pushname})}g.InitialsAlphabets=e;g.supportedAlphabetsMap=o;g.getInitialsFromNames=E;g.getInitialsFromContact=d}),98);
__d("WAWebInitialsProfilePicture.react",["$InternalEnum","WABidi","WAWebInitialsFromNameUtils","react","stylex","useWAWebGroupColors"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k=b("$InternalEnum").Mirrored(["Default","GroupChatProfilePicture","NewsletterQuestionsResponses"]),l={initialsBackground:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",color:"x1awj2ng",display:"x78zum5",alignItems:"x6s0dn4",justifyContent:"xl56j7k",$$css:!0},initialsNewsletterResponses:{width:"x100vrsf",height:"x1vqgdyp",$$css:!0},initialsDefault:{width:"xh8yej3",height:"x5yr21d",$$css:!0}};function a(a){var b=a.backgroundColorId,e=a.initialsData;a=a.theme;a=a===void 0?k.Default:a;b=d("useWAWebGroupColors").useGroupsColorStyle(b,"background");var f=e.firstInitial!=null&&e.secondInitial!=null,g=d("WAWebInitialsFromNameUtils").supportedAlphabetsMap.get(d("WAWebInitialsFromNameUtils").InitialsAlphabets.HAN),h=!1;if(g&&e.secondInitial!=null&&g.test(e==null?void 0:e.secondInitial)){g=((g=e.secondInitial)==null?void 0:g.length)||0;h=g>1}g=e.firstInitial!=null&&d("WABidi").dir(e.firstInitial)==="rtl"?"rtl":"ltr";var m=a===k.NewsletterQuestionsResponses?l.initialsNewsletterResponses:l.initialsDefault;return j.jsx("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(l.initialsBackground,m,b),{children:j.jsxs("div",babelHelpers["extends"]({dir:g},{0:{},8:{className:"x1aueamr"},4:{className:"x1f6kntn"},12:{className:"x1f6kntn"},2:{className:"x1nxh6w3"},10:{className:"x1nxh6w3"},6:{className:"x1nxh6w3"},14:{className:"x1nxh6w3"},1:{className:"x1ncwhqj"},9:{className:"x1ncwhqj"},5:{className:"x1ncwhqj"},13:{className:"x1ncwhqj"},3:{className:"x1ncwhqj"},11:{className:"x1ncwhqj"},7:{className:"x1ncwhqj"},15:{className:"x1ncwhqj"}}[!!(a===k.Default)<<3|!!(a===k.GroupChatProfilePicture)<<2|!!(a===k.GroupChatProfilePicture&&f)<<1|!!h<<0],{children:[j.jsx("div",{"data-testid":void 0,className:"x1rg5ohu xk50ysn",children:e.firstInitial}),j.jsx("div",{"data-testid":void 0,className:"x1rg5ohu xk50ysn",children:e.secondInitial})]}))}))}a.displayName=a.name+" [from "+f.id+"]";g.ThemeType=k;g.InitialsProfilePicture=a}),98);
__d("WAWebWaChatPsaIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="wa-chat-psa";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=360;o=360;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 360 360",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",id:"Layer_1",x:"0px",y:"0px",enableBackground:"new 0 0 360 360",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fill:"#25D366",opacity:1,stroke:"none",d:" M173.000000,361.000000  C115.353172,361.000000 58.206341,361.000000 1.029757,361.000000  C1.029757,241.061493 1.029757,121.122963 1.029757,1.092220  C120.896820,1.092220 240.793732,1.092220 360.845337,1.092220  C360.845337,120.999847 360.845337,240.999893 360.845337,361.000000  C298.456329,361.000000 235.978165,361.000000 173.000000,361.000000  M197.063446,92.379547  C195.411438,92.174431 193.762665,91.937508 192.106949,91.768898  C156.937073,88.187309 128.342728,100.457565 108.074654,129.217316  C87.867386,157.890823 86.575523,188.910645 101.408730,220.531891  C102.965797,223.851242 103.232262,226.553955 102.266563,229.950317  C98.463707,243.324921 94.899605,256.767395 91.084465,270.781311  C93.123474,270.351715 94.548683,270.112305 95.941422,269.748505  C108.650543,266.428864 121.320129,262.946716 134.088593,259.875153  C136.551529,259.282684 139.727280,259.569855 142.010056,260.646881  C157.967712,268.175995 174.705978,270.917206 192.102615,268.776276  C234.755585,263.527069 268.624664,226.903122 270.011841,184.898880  C271.516479,139.337418 241.558502,101.014793 197.063446,92.379547  z"}),k.jsx("path",{fill:"#FCFEFD",opacity:1,stroke:"none",d:" M197.474182,92.506378  C241.558502,101.014793 271.516479,139.337418 270.011841,184.898880  C268.624664,226.903122 234.755585,263.527069 192.102615,268.776276  C174.705978,270.917206 157.967712,268.175995 142.010056,260.646881  C139.727280,259.569855 136.551529,259.282684 134.088593,259.875153  C121.320129,262.946716 108.650543,266.428864 95.941422,269.748505  C94.548683,270.112305 93.123474,270.351715 91.084465,270.781311  C94.899605,256.767395 98.463707,243.324921 102.266563,229.950317  C103.232262,226.553955 102.965797,223.851242 101.408730,220.531891  C86.575523,188.910645 87.867386,157.890823 108.074654,129.217316  C128.342728,100.457565 156.937073,88.187309 192.106949,91.768898  C193.762665,91.937508 195.411438,92.174431 197.474182,92.506378  M253.181854,196.536774  C255.711929,186.169617 256.004150,175.664429 253.541946,165.353546  C246.119568,134.271210 226.847565,114.125397 195.518936,107.758392  C164.775314,101.510277 138.969528,111.918282 120.761078,137.417480  C102.516304,162.967529 102.122711,190.360199 117.175308,217.804871  C119.110695,221.333557 119.630486,224.226303 118.452988,227.999252  C116.305588,234.880005 114.631348,241.908432 112.534187,249.714706  C121.244263,247.449783 128.886383,245.269287 136.634216,243.571182  C138.823502,243.091385 141.697876,243.342087 143.623520,244.406097  C187.851929,268.844574 240.426270,246.301453 253.181854,196.536774  z"}),k.jsx("path",{fill:"#26D367",opacity:1,stroke:"none",d:" M253.113434,196.950668  C240.426270,246.301453 187.851929,268.844574 143.623520,244.406097  C141.697876,243.342087 138.823502,243.091385 136.634216,243.571182  C128.886383,245.269287 121.244263,247.449783 112.534187,249.714706  C114.631348,241.908432 116.305588,234.880005 118.452988,227.999252  C119.630486,224.226303 119.110695,221.333557 117.175308,217.804871  C102.122711,190.360199 102.516304,162.967529 120.761078,137.417480  C138.969528,111.918282 164.775314,101.510277 195.518936,107.758392  C226.847565,114.125397 246.119568,134.271210 253.541946,165.353546  C256.004150,175.664429 255.711929,186.169617 253.113434,196.950668  M159.161896,144.300629  C157.596588,142.566147 156.289551,139.760483 154.415009,139.308472  C149.758347,138.185654 145.465286,139.125748 141.936844,143.335083  C135.938049,150.491486 133.889008,158.646042 136.794312,167.095337  C139.180939,174.036118 142.985977,180.714874 147.247849,186.742218  C159.314850,203.807953 175.066055,216.142273 195.540466,221.815857  C205.004898,224.438538 213.684128,223.322174 221.218109,216.594635  C225.301636,212.948212 226.861237,207.950836 225.754288,203.034790  C225.255310,200.818695 221.393539,199.207153 218.857986,197.645233  C216.319427,196.081421 213.584717,194.800613 210.844025,193.606903  C202.134613,189.813538 203.863739,189.749985 198.366028,196.614182  C197.431046,197.781570 196.301865,198.814072 195.495682,200.059845  C193.532318,203.093781 191.249756,202.866211 188.234161,201.544495  C177.255371,196.732590 168.560989,189.383530 161.641464,179.587280  C158.640030,175.338043 158.010895,172.193756 162.204178,168.482956  C166.102249,165.033386 166.959518,160.921555 164.134537,156.022842  C162.157837,152.595093 161.014969,148.686508 159.161896,144.300629  z"}),k.jsx("path",{fill:"#FCFEFD",opacity:1,stroke:"none",d:" M159.330811,144.646652  C161.014969,148.686508 162.157837,152.595093 164.134537,156.022842  C166.959518,160.921555 166.102249,165.033386 162.204178,168.482956  C158.010895,172.193756 158.640030,175.338043 161.641464,179.587280  C168.560989,189.383530 177.255371,196.732590 188.234161,201.544495  C191.249756,202.866211 193.532318,203.093781 195.495682,200.059845  C196.301865,198.814072 197.431046,197.781570 198.366028,196.614182  C203.863739,189.749985 202.134613,189.813538 210.844025,193.606903  C213.584717,194.800613 216.319427,196.081421 218.857986,197.645233  C221.393539,199.207153 225.255310,200.818695 225.754288,203.034790  C226.861237,207.950836 225.301636,212.948212 221.218109,216.594635  C213.684128,223.322174 205.004898,224.438538 195.540466,221.815857  C175.066055,216.142273 159.314850,203.807953 147.247849,186.742218  C142.985977,180.714874 139.180939,174.036118 136.794312,167.095337  C133.889008,158.646042 135.938049,150.491486 141.936844,143.335083  C145.465286,139.125748 149.758347,138.185654 154.415009,139.308472  C156.289551,139.760483 157.596588,142.566147 159.330811,144.646652  z"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.WaChatPsaIcon=a}),98);
__d("WAWebDetailImage.react",["fbt","$InternalEnum","WALogger","WAShiftTimer","WAWebAnnouncementSpeakerIcon.react","WAWebAvatarSpinner.react","WAWebBizGatingUtils","WAWebChatCollection","WAWebChatCommunityUtils","WAWebChatEphemerality","WAWebChatGetters","WAWebChatProfilePictureGatingUtils","WAWebClassnames","WAWebCommonCTWAConsumerTransparency","WAWebCommunityGatingUtils","WAWebCommunityGeneralChatImage.react","WAWebCommunitySquircleIcon.react","WAWebContactCollection","WAWebDefaultBroadcastIcon.react","WAWebDefaultCommunityRefreshedIcon.react","WAWebDefaultContactRefreshedIcon.react","WAWebDefaultGroupIcon.react","WAWebDefaultGroupRefreshedIcon.react","WAWebDefaultNewsletterIcon.react","WAWebDefaultUserColorIcon.react","WAWebDefaultUserIcon.react","WAWebDefaultUserSquareIcon.react","WAWebDisappearingIcon.react","WAWebDisappearingMessagesRefreshedIcon.react","WAWebDoubleChevronIcon.react","WAWebDoubleChevronInCircleIcon.react","WAWebEnvironment","WAWebGroupType","WAWebHasAcceptedBizBotTos","WAWebIcVisibilityOffIcon.react","WAWebIdleComponent.react","WAWebImg.react","WAWebInitialsFromNameUtils","WAWebInitialsProfilePicture.react","WAWebKeyboardIsKeyActivation","WAWebMiscErrors","WAWebMiscGatingUtils","WAWebMmsClientIsErrorRetryable","WAWebPREGatingUtils","WAWebProfilePicThumbCollection","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","WAWebSingleChevronInCircleIcon.react","WAWebStateUtils","WAWebUIRefreshGatingUtils","WAWebUISpacing","WAWebUnjoinedSubgroupMetadataCollection","WAWebUseIsKeyboardUser","WAWebUserPrefsMeUser","WAWebWaChatPsaIcon.react","WAWebWid","WDSFocusStateStyles","cr:5981","gkx","react","stylex","useLazyRef","useWAWebEventTargetValue","useWAWebForceUpdate","useWAWebGroupColors","useWAWebListener","useWAWebModelValues"],(function(a,b,c,d,e,f,g,h){var i,j,k,l;e=l||d("react");var m=j||(j=c("react")),n=e.useEffect,o=e.useRef,p=e.useState,q=e.useTransition,r=new Set(),s=b("cr:5981")==null?void 0:b("cr:5981").InternalStatusWarningImageOverlay,t=b("$InternalEnum").Mirrored(["ExtraSmall","Small","Medium","Large","Refresh","None"]),u=b("$InternalEnum").Mirrored(["Low","High"]),v=b("$InternalEnum").Mirrored(["Circle","Square","Squircle"]),w=b("$InternalEnum").Mirrored(["GroupChatProfilePicture","Status","MediaHub","GroupStatus"]),x={announcementSpeaker:{color:"xo1mcw5",$$css:!0},communitySquircle:{color:"x17k9de1",$$css:!0},newsletter:{color:"x17k9de1",$$css:!0},avatarDefaultPSA:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},dimmed:{opacity:"xavfwda",$$css:!0},avatar:{position:"x1n2onr6",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},status:{backgroundColor:"x1gle93d",$$css:!0},avatarSquare:{borderStartStartRadius:"x1bczwif",borderStartEndRadius:"x17un8ov",borderEndEndRadius:"x1e7945m",borderEndStartRadius:"x11o6v7j",$$css:!0},avatarImage:{position:"x1n2onr6",display:"x1lliihq",width:"xh8yej3",height:"x5yr21d",overflowX:"x6ikm8r",overflowY:"x10wlt62",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",objectFit:"xl1xv1r",objectPosition:"x115dhu7",opacity:"xg01cxk",transition:"x17vty23",$$css:!0},isLoaded:{opacity:"x1hc1fzr",$$css:!0},avatarImageNoTransition:{transition:"xq2gx43",$$css:!0},avatarSquircle:{clipPath:"x1f2iure",borderStartStartRadius:"x1bczwif",borderStartEndRadius:"x17un8ov",borderEndEndRadius:"x1e7945m",borderEndStartRadius:"x11o6v7j",$$css:!0},groupProfilePicture:{position:"x10l6tqk",insetInlineStart:"x1nobqc8",left:null,right:null,width:"xgd8bvy",height:"x1fgtraw",$$css:!0},groupProfilePictureInBubble:{width:"x14qfxbe",height:"xc9qbxq",$$css:!0},svgSize:{width:"xh8yej3",height:"x5yr21d",$$css:!0},profilePictureOutlineRefreshed:{outline:"x4u6w88",outlineOffset:"x1g40iwv",$$css:!0},circleIconRefreshed:{borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",backgroundColor:"x1od0jb8",$$css:!0},squircleIconRefreshed:{clipPath:"x1f2iure",backgroundColor:"x1od0jb8",$$css:!0},avatarBorder:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x16jw5py",borderInlineEndColor:"x13dr7gu",borderBottomColor:"xd9srri",borderInlineStartColor:"x1ia0k5z",$$css:!0},avatarProfileRingBorder:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x1y9zq84",borderInlineEndColor:"xt9xd2u",borderBottomColor:"x3tsejo",borderInlineStartColor:"x1ahzpo1",boxSizing:"x9f619",$$css:!0},avatarDefaultAnnouncementGroup:{backgroundColor:"xfn3atn",$$css:!0},inviteModal:{borderTopWidth:"x1ktv7sr",borderInlineEndWidth:"x142x0oa",borderBottomWidth:"xv7zg05",borderInlineStartWidth:"x12dgle5",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopColor:"x19bsprb",borderInlineEndColor:"x2cy9dh",borderBottomColor:"x1eeqclz",borderInlineStartColor:"x1mx0rqa",backgroundColor:"x16w0wmm",$$css:!0},outline:{borderTopColor:"xx42vgk",borderInlineEndColor:"xbogo7e",borderBottomColor:"x120ee7l",borderInlineStartColor:"x1vb5itz",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",$$css:!0},badge:{position:"x10l6tqk",insetInlineEnd:"xhu3bip",bottom:"x48lskh",zIndex:"x16uhe5s",boxSizing:"x9f619",width:"xw4jnvo",height:"x1qx5ct2",pointerEvents:"x47corl",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",$$css:!0},chatList:{backgroundColor:"x1280gxy",$$css:!0},conversationHeader:{backgroundColor:"x1h3rtpe",$$css:!0},subgroupJoinModal:{backgroundColor:"x1280gxy",width:"x1849jeq",height:"x1gnnpzl",insetInlineEnd:"xtijo5x",left:null,right:null,bottom:"x1ey2m1c",$$css:!0},adsDataSharingIconBackground:{backgroundColor:"x1c7u0tx",$$css:!0},badgeIconSVG:{width:"x1xp8n7a",height:"xmix8c7",$$css:!0},polls:{borderTopWidth:"x178xt8z",borderInlineEndWidth:"x1lun4ml",borderBottomWidth:"xso031l",borderInlineStartWidth:"xpilrb4",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",$$css:!0},pollsSender:{borderTopColor:"x3ewwah",borderInlineEndColor:"xzt7qbt",borderBottomColor:"x1xnb2cf",borderInlineStartColor:"xphqdy3",$$css:!0},pollsReceiver:{borderTopColor:"xm7onvi",borderInlineEndColor:"xxy6lca",borderBottomColor:"x4728lr",borderInlineStartColor:"x4bbfdb",$$css:!0},backgroundFill:{fill:"x1flh12g",$$css:!0},primaryFill:{fill:"xvt3oi1",$$css:!0},badgeIconPathSVG:{color:"xhslqc4",$$css:!0},dataSharingIcon:{color:"xhslqc4",$$css:!0},dataSharingUpdatedStyleIcon:{color:"xrl28ub",$$css:!0},dataSharingNewStyleIcon:{backgroundColor:"x1c7u0tx",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",color:"xhslqc4",$$css:!0},subgroupJoinModalSvgStyle:{width:"xgd8bvy",height:"x1fgtraw",$$css:!0},groupProfilePictureSticky:{position:"x7wzq59",top:"x1eu8d0j",$$css:!0}},y=100;function z(a){var b,e=a.profilePicThumbImg,f=a.spinnerClassName,g=a.spinnerXstyle,h=a.spinnerSize,i=a.imgClassName,j=a.imgXstyle,l=a.alt,s=a.onLoad,t=a.profilePicThumb,u=a.loader,w=u===void 0?!1:u;u=a.theme;var z=a.loadingAnimation;z=z===void 0?!0:z;var A=a.id,B=p(!1),C=B[0],D=B[1];B=p(e);var E=B[0];B=B[1];var F=E!=null&&d("WAWebPREGatingUtils").isPREChatMovingEnabled()?r.has(E):!1;A=p(F?!1:(A instanceof c("WAWebWid")&&(A==null?void 0:A.isBot()))!==!0);var G=A[0],H=A[1];A=p(F);F=A[0];var I=A[1];A=d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled();var J=o(Boolean(e)),K=o(!1),L=u!=="business",M=c("useLazyRef")(function(){return w&&L?new(d("WAShiftTimer").ShiftTimer)(function(){D(!0)}):null});u=q();u[0];var N=u[1];e!==E&&(B(e),H(!0),I(!1),D(!1));u=function(a){N(function(){var b;(b=M.current)==null||b.cancel();t.markMms4HostSuccess();H(!1);I(!0);s==null||s();b=a.target;E!=null&&b instanceof HTMLImageElement&&b.complete&&d("WAWebPREGatingUtils").isPREChatMovingEnabled()&&r.add(E)})};B=function(a){var b;(b=M.current)==null||b.cancel();if(a instanceof d("WAWebMiscErrors").ServerStatusError)switch(a.status){case 403:t.markStale({eurl:!0});K.current||(K.current=!0,t.validate());break;case 410:t.markStale();break;default:d("WAWebMmsClientIsErrorRetryable").isRetriableStatusCode(a.status)&&t.markMms4HostFailure();break}H(!1);I(!1)};n(function(){var a,b=M;(a=b.current)==null||a.onOrAfter(y);return function(){var a;(a=b.current)==null||a.cancel()}},[t,M]);e=function(){return!L?!1:!!w&&C&&G&&!(!d("WAWebStateUtils").unproxy(t).stale&&!E)};i=d("WAWebClassnames").classnamesConvertMeToStylexPlease((b={},b[i]=typeof i==="string",b),(k||(k=c("stylex")))(z===!1&&J.current&&x.avatarImageNoTransition,x.avatarImage,a.shape===v.Square&&x.avatarSquare,a.shape===v.Squircle&&x.avatarSquircle,!G&&x.isLoaded,A&&a.shape!==v.Squircle&&x.profilePictureOutlineRefreshed,j));var O,P;e()&&(O=m.jsx(c("WAWebAvatarSpinner.react"),{className:f,xstyle:g,size:h}));E&&(P=m.jsx(c("WAWebImg.react"),{src:E,hasPrivacyChecks:!0,crossOrigin:!1,className:i,draggable:!1,onLoad:u,onError:B,alt:l}));b=F?null:a.defaultIcon;z===!1&&(b=P!=null?null:a.defaultIcon);return m.jsxs(m.Fragment,{children:[O,b,P]})}z.displayName=z.name+" [from "+f.id+"]";function A(a){var b=d("useWAWebModelValues").useModelValues(a.profilePicThumb,["imgFull"]);return m.jsx(z,babelHelpers["extends"]({},a,{profilePicThumbImg:b.imgFull}))}A.displayName=A.name+" [from "+f.id+"]";function B(a){var b=d("useWAWebModelValues").useModelValues(a.profilePicThumb,["img"]);return m.jsx(z,babelHelpers["extends"]({},a,{profilePicThumbImg:b.img}))}B.displayName=B.name+" [from "+f.id+"]";function C(a){if(a==="group_profile_picture"||a==="group_profile_picture_in_bubble")return w.GroupChatProfilePicture;if(a==="status")return w.Status;if(a==="media_hub")return w.MediaHub;return a==="group_status"?w.GroupStatus:null}var D=28;function E(a){if(typeof a==="string")switch(a){case t.ExtraSmall:return 40;case t.Small:return 49;case t.Medium:return 100;case t.Large:return 200;case t.Refresh:return 128;case t.None:return void 0}else return a}function a(a){var b,e,f=a.id,g=a.size,j=a.quality,l=j===void 0?u.Low:j,n=a.loader,p=a.onClick,q=a.onLoad;j=a.quoted;var r=a.shape,w=a.border,y=a.waitIdle,z=a.ephemeralIcon,H=a.checkmarkIcon,I=a.hiddenSubgroupIcon,J=a.theme,K=a.alt,L=a.xstyle,M=a.authorColor,N=a.loadPicture,O=N===void 0?!0:N;N=a.loadAnimation;var P=N===void 0?!0:N;N=a.tabIndex;var Q=a.ariaLabel,R=a.testId,aa=a.tabOrder;R=a.showOutline;R=R===void 0?!1:R;var ba=a.enableAdsDataSharingIcon,S=a.enableBizAiDataSharingIcon;S=S===void 0?!1:S;var T=a.groupProfilePictureSticky;T=T===void 0?!1:T;var U=d("useWAWebForceUpdate").useForceUpdateDONOTUSE(),ca=o(null),V=c("WAWebUseIsKeyboardUser")();V=V.isKeyboardUser;var W=d("WAWebChatCollection").ChatCollection.get(f),da=d("WAWebHasAcceptedBizBotTos").useHasAcceptedBizBotTos(),X;typeof g==="number"?X=g>0?g:t.Small:X=g!=null?g:t.Small;var ea={height:E(X),width:E(X)};p&&(ea.cursor="pointer");var Y,Z;if(W!=null&&(b=W.groupMetadata)!=null&&(b=b.participants)!=null&&b.iAmMember()){if(d("WAWebChatGetters").getIsGroup(W)){Y=(X=W.groupMetadata)==null?void 0:X.groupType;Z=W.groupMetadata}}else{X=c("WAWebUnjoinedSubgroupMetadataCollection").get(f.toString());Y=X==null?void 0:X.groupType;Z=X}d("useWAWebListener").useListener(W!=null&&d("WAWebChatGetters").getIsGroup(W)?Z:W,"change:ephemeralDuration",U);X=c("useWAWebEventTargetValue")(Z,"change:hiddenSubgroup",function(){var a;return((a=Z)==null?void 0:a.hiddenSubgroup)===!0});var fa=(k||(k=c("stylex")))(x.avatar,J==="status"&&x.status,r===v.Square&&x.avatarSquare,r===v.Squircle&&x.avatarSquircle,J==="group_profile_picture"&&x.groupProfilePicture,J==="group_profile_picture_in_bubble"&&x.groupProfilePictureInBubble,J==="status_profile_photo_ring"&&x.avatarProfileRingBorder,J==="invite_modal"&&x.inviteModal,(J==="polls_sender"||J==="polls_receiver")&&x.polls,J==="polls_sender"&&x.pollsSender,J==="polls_receiver"&&x.pollsReceiver,d("WAWebChatCommunityUtils").isIntegrityDeactivatedCommunity(W)&&x.dimmed,w===!0&&x.avatarBorder,Y===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&x.avatarDefaultAnnouncementGroup,p!=null&&V&&J==="group_profile_picture"&&d("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,p!=null&&V&&J==="chatlist_header_profile_photo"&&d("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,R&&x.outline,J==="group_profile_picture"&&T&&x.groupProfilePictureSticky,L);U=function(a){if(c("WAWebKeyboardIsKeyActivation")(a)){(a=ca.current)==null||a.click()}};var ga=p!=null?{tabIndex:N,role:"button","aria-label":Q,onKeyDown:U}:{};w=C(J);var $=m.jsx(G,{id:f,quoted:j,groupType:Y,theme:w,authorColor:M,shape:a.shape});if((J==="group_profile_picture"||J==="typing_indicator")&&d("WAWebChatProfilePictureGatingUtils").shouldDisplayInitialsInProfilePicture(f)){V=d("WAWebContactCollection").ContactCollection.get(f);if(V){R=d("WAWebInitialsFromNameUtils").getInitialsFromContact(V);(R.firstInitial!=null||R.secondInitial!=null)&&($=m.jsx(d("WAWebInitialsProfilePicture.react").InitialsProfilePicture,{initialsData:R,theme:d("WAWebInitialsProfilePicture.react").ThemeType.GroupChatProfilePicture,backgroundColorId:M!=null?M:1}))}else d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[GCPP] User contact not in collection"])))}T=function(){var a,b;O?b=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(f):b=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.get(f);b?l===u.High?a=m.jsx(A,{profilePicThumb:b,defaultIcon:$,loader:n,onLoad:q,alt:K,shape:r,id:f}):a=m.jsx(B,{profilePicThumb:b,defaultIcon:$,loader:n,onLoad:q,alt:K,loadingAnimation:P,shape:r,id:f}):a=$;return m.jsxs("div",babelHelpers["extends"]({"data-testid":void 0,ref:ca,"data-tab":aa},ga,{className:fa,style:ea,onClick:p,children:[a,!c("gkx")("26258")&&(typeof g!=="number"||g>=D)&&s?m.jsx(s,{id:f}):null]}))};L=!c("WAWebEnvironment").isWindows||y===!0?m.jsx(c("WAWebIdleComponent.react"),{id:f,onComplex:T,waitIdle:y,children:m.jsx("div",babelHelpers["extends"]({ref:ca},ga,{className:fa,style:ea,onClick:p,children:$}))}):T();if(a.emojiBadge!=null&&d("WAWebUserPrefsMeUser").isMeAccount(f))return m.jsxs("div",{className:"x1n2onr6","aria-label":h._(/*BTDS*/"Profile picture, text status emoji set"),children:[m.jsx("div",{className:"x10l6tqk xhu3bip x48lskh x16uhe5s x9f619 xw4jnvo x1qx5ct2 x47corl x1c9tyrk xeusxvb x1pahc9y x1ertn4p x1h3rtpe",children:a.emojiBadge}),L]});Q=(N=W==null||(e=W.contact.businessProfile)==null?void 0:e.isBizBot1p)!=null?N:!1;U=da&&d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled();j=S&&Q&&U;w=Boolean(z!=null&&W&&d("WAWebChatEphemerality").isEphemeralSettingOn(W));J=ba===!0&&W!=null&&d("WAWebCommonCTWAConsumerTransparency").shouldShowConsumerTransparencyDisclosure(W);V=I!=null&&H==null&&X;if(j||w===!0||H||J||V){M=(R=z!=null?z:H)!=null?R:I;return m.jsxs("div",{className:"x1n2onr6","aria-label":h._(/*BTDS*/"Profile picture, disappearing messages on"),children:[m.jsx("div",babelHelpers["extends"]({},(k||(k=c("stylex"))).props(x.badge,d("WAWebUISpacing").uiPadding.all1,M==="chat-list"&&x.chatList,M==="conversation-header"&&x.conversationHeader,M==="subgroup-join-modal"&&x.subgroupJoinModal,J&&x.adsDataSharingIconBackground),{children:m.jsx(F,{iconScheme:M,shouldShowEphemeralIcon:w,shouldShowHiddenSubgroupIcon:V,shouldShowAdsDataSharingIcon:J,shouldShowBizAiDataSharingIcon:j})})),L]})}return L}a.displayName=a.name+" [from "+f.id+"]";function F(a){var b=a.iconScheme,c=a.shouldShowAdsDataSharingIcon;c=c===void 0?!1:c;var e=a.shouldShowBizAiDataSharingIcon;e=e===void 0?!1:e;var f=a.shouldShowEphemeralIcon;f=f===void 0?!1:f;a=a.shouldShowHiddenSubgroupIcon;a=a===void 0?!1:a;if(e)return m.jsx(d("WAWebDoubleChevronInCircleIcon.react").DoubleChevronInCircleIcon,{iconXstyle:[x.svgSize,x.badgeIconSVG,x.dataSharingUpdatedStyleIcon]});if(c)return d("WAWebBizGatingUtils").shouldUseNewContentForConsumerDisclosure()?m.jsx(d("WAWebSingleChevronInCircleIcon.react").SingleChevronInCircleIcon,{iconXstyle:[x.svgSize,x.badgeIconSVG,x.dataSharingNewStyleIcon]}):d("WAWebCommonCTWAConsumerTransparency").shouldShowUpdatedConsumerDisclosure()?m.jsx(d("WAWebSingleChevronInCircleIcon.react").SingleChevronInCircleIcon,{iconXstyle:[x.svgSize,x.badgeIconSVG,x.dataSharingUpdatedStyleIcon]}):m.jsx(d("WAWebDoubleChevronIcon.react").DoubleChevronIcon,{iconXstyle:[x.svgSize,x.badgeIconSVG,x.dataSharingIcon]});e=d("WAWebMiscGatingUtils").isBlueEnabled()?d("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon:d("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon;f===!0?c=d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()?d("WAWebDisappearingMessagesRefreshedIcon.react").DisappearingMessagesRefreshedIcon:d("WAWebDisappearingIcon.react").DisappearingIcon:a?c=d("WAWebIcVisibilityOffIcon.react").IcVisibilityOffIcon:c=e;return m.jsx(c,{xstyle:x.badgeIconPathSVG,iconXstyle:[x.svgSize,x.badgeIconSVG,b==="subgroup-join-modal"&&x.subgroupJoinModalSvgStyle]})}F.displayName=F.name+" [from "+f.id+"]";function G(a){var b=a.authorColor,e=a.groupType,f=a.id,g=a.quoted,h=a.shape,i=a.theme;a=a.xstyle;var j=d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled(),k=j?m.jsx(d("WAWebDefaultContactRefreshedIcon.react").DefaultContactRefreshedIcon,{iconXstyle:[x.svgSize,x.circleIconRefreshed,x.profilePictureOutlineRefreshed,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill}}):m.jsx(d("WAWebDefaultUserIcon.react").DefaultUserIcon,{iconXstyle:[x.svgSize,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill,background:x.backgroundFill}});c("WAWebWid").isUser(f)&&!c("WAWebWid").isPSA(f)&&g?k=m.jsx(d("WAWebDefaultUserSquareIcon.react").DefaultUserSquareIcon,{iconXstyle:[x.svgSize,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill,background:x.backgroundFill}}):c("WAWebWid").isGroup(f)?e===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?k=m.jsx(d("WAWebAnnouncementSpeakerIcon.react").AnnouncementSpeakerIcon,{iconXstyle:[x.svgSize,x.announcementSpeaker,a],directional:!0,"aria-hidden":!0}):e===d("WAWebGroupType").GroupType.COMMUNITY||h===v.Squircle?k=j?m.jsx(d("WAWebDefaultCommunityRefreshedIcon.react").DefaultCommunityRefreshedIcon,{iconXstyle:[x.svgSize,x.communitySquircle,x.squircleIconRefreshed,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill}}):m.jsx(d("WAWebCommunitySquircleIcon.react").CommunitySquircleIcon,{iconXstyle:[x.svgSize,x.communitySquircle,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill,background:x.backgroundFill}}):e===d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP&&d("WAWebCommunityGatingUtils").communityGeneralChatUIEnabled()?k=m.jsx(d("WAWebCommunityGeneralChatImage.react").CommunityGeneralChatImage,{}):k=j?m.jsx(d("WAWebDefaultGroupRefreshedIcon.react").DefaultGroupRefreshedIcon,{iconXstyle:[x.svgSize,x.circleIconRefreshed,x.profilePictureOutlineRefreshed,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill}}):m.jsx(d("WAWebDefaultGroupIcon.react").DefaultGroupIcon,{iconXstyle:[x.svgSize,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill,background:x.backgroundFill}}):c("WAWebWid").isBroadcast(f)?k=m.jsx(d("WAWebDefaultBroadcastIcon.react").DefaultBroadcastIcon,{iconXstyle:[x.svgSize,a],"aria-hidden":!0}):c("WAWebWid").isPSA(f)?k=m.jsx(d("WAWebWaChatPsaIcon.react").WaChatPsaIcon,{iconXstyle:[x.svgSize,x.avatarDefaultPSA,a],"aria-hidden":!0}):c("WAWebWid").isNewsletter(f)&&(k=m.jsx(d("WAWebDefaultNewsletterIcon.react").DefaultNewsletterIcon,{iconXstyle:[x.svgSize,x.newsletter,a],"aria-hidden":!0,innerStyles:{primary:x.primaryFill,background:x.backgroundFill}}));g=m.createElement("div",babelHelpers["extends"]({},{0:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d"},4:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d xfimr68 x1jpgh95"},2:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xgd8bvy x1fgtraw"},6:{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xfimr68 x1jpgh95 xgd8bvy x1fgtraw"},1:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xh8yej3 x5yr21d x1n2onr6 x1lliihq"},5:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xh8yej3 x5yr21d xfimr68 x1jpgh95 x1n2onr6 x1lliihq"},3:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xgd8bvy x1fgtraw x1n2onr6 x1lliihq"},7:{className:"x13vifvy x1o0tod x6s0dn4 xl56j7k xfimr68 x1jpgh95 xgd8bvy x1fgtraw x1n2onr6 x1lliihq"}}[!!(i===w.Status)<<2|!!(i===w.MediaHub)<<1|!!(i===w.GroupStatus)<<0],{key:"default"}),k);h=d("useWAWebGroupColors").useGroupsColorStyle(b!=null?b:1,"color");i===w.GroupChatProfilePicture&&(g=m.jsx("div",{className:"x10l6tqk x13vifvy x1o0tod x78zum5 x6s0dn4 xl56j7k xh8yej3 x5yr21d",children:m.jsx(d("WAWebDefaultUserColorIcon.react").DefaultUserColorIcon,{iconXstyle:[x.svgSize,a],xstyle:h})},"default"));return g}G.displayName=G.name+" [from "+f.id+"]";g.DetailImageSize=t;g.DetailImageQuality=u;g.DetailImageShape=v;g.DefaultIconThemeType=w;g.DetailImageCommon=z;g.getSize=E;g.DetailImage=a;g.ImageIcon=F;g.DefaultIcon=G}),226);
__d("WAWebFormatComponentUtils",[],(function(a,b,c,d,e,f){function a(a){a=typeof a==="string"?[a]:[].concat(a);typeof a[0]==="string"&&(a[0]=a[0].replace(" ",""));return a}f.removeFirstLeadingSpace=a}),66);
__d("WAWebBlockQuoteMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","WAWebUISpacing","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={quote:{display:"x1rg5ohu",position:"x1n2onr6",width:"xh8yej3",color:"xhslqc4",$$css:!0},quotedColor:{color:"x15rks2t",borderTopColor:"x1b4hy2t",borderInlineEndColor:"x1273586",borderBottomColor:"x1tnzt7h",borderInlineStartColor:"x1mi4oqr",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var e=a.inline;e=e===void 0?!1:e;var f=a.quoted;f=f===void 0?!1:f;var g=a.selectable;a=a.text;a=d("WABidi").dir(a);var h=a==="rtl"!==c("WAWebL10N").isRTL(),l="> ";return e?j.jsx(d("WAWebCopyPasteSelectable.react").SelectableSpan,{dir:a,selectable:g,prePlainText:l,className:{0:"xt0psk2 x14atkfc xhslqc4 xct1zlm x1t7ytsu x19mw7rs x7phf20 xaso8d8",2:"xt0psk2 x14atkfc x15rks2t x1b4hy2t x1273586 x1tnzt7h xct1zlm x1t7ytsu x19mw7rs x7phf20 xaso8d8",1:"xt0psk2 x14atkfc xct1zlm x1t7ytsu x7phf20 xaso8d8 xhslqc4 x1if355w x18b5jzi xp93uhy x1p8j9ns x1gabggj",3:"xt0psk2 x14atkfc xct1zlm x1t7ytsu x7phf20 xaso8d8 x15rks2t x1b4hy2t x1tnzt7h x1mi4oqr x1if355w x18b5jzi xp93uhy x1p8j9ns x1gabggj"}[!!f<<1|!!h<<0],children:b}):j.jsxs(d("WAWebCopyPasteSelectable.react").SelectableBlockQuote,{dir:a,selectable:g,prePlainText:l,className:(i||(i=c("stylex")))([k.quote,f&&k.quotedColor,!f&&d("WAWebUISpacing").uiMargin.vert4]),children:[j.jsx("div",babelHelpers["extends"]({},{0:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy x1518k6t xkqq1k2 x91jh78 x1xkn691 x4oqio7"},2:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy x1518k6t xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtijo5x"},1:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtwfq29"},3:{className:"x10l6tqk x1o0tod x13vifvy x5yr21d x1g8rjiy xkqq1k2 x91jh78 x1xkn691 x4oqio7 xtijo5x xtwfq29"}}[!!h<<1|!!f<<0])),j.jsx("div",babelHelpers["extends"]({},{0:{className:"x1rg5ohu x1gx403c xj0a0fe xeaf4i8"},1:{className:"x1rg5ohu xj0a0fe xeaf4i8 x1c1uobl x1q3ajuy"}}[!!h<<0],{children:d("WAWebFormatComponentUtils").removeFirstLeadingSpace(b)}))]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebBulletedListItemMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function j(a){if(a==null||a==="")return;return d("WABidi").dir(a)}function k(a){a=j(a)==="rtl";return a!==c("WAWebL10N").isRTL()}function a(a){var b=a.children;b=b===void 0?"":b;var c=a.inline;c=c===void 0?!1:c;var e=a.selectable,f=a.symbol;a=a.text;if(c)return i.jsxs(d("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:e,children:["\u2022",b]});c=f+" ";return i.jsx("li",babelHelpers["extends"]({dir:"auto"},{0:{className:"x1g0dm76 x1jieuv1 xo7wnuk x1gznph8 x1rkpvhg xlu7um4 xm78dhd x1r4uxqn"},1:{className:"x1jieuv1 xo7wnuk xlu7um4 xm78dhd x1r4uxqn xp4054r x1c1uobl xpdmqnj xh6kr0w xl717p"}}[!!k(a)<<0],{children:i.jsx(d("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:e,prePlainText:c,children:d("WAWebFormatComponentUtils").removeFirstLeadingSpace(b)})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebNumberedListItemMutatorComponent.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebFormatComponentUtils","WAWebL10N","WAWebUISpacing","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={dirMismatch:{textAlign:"xp4054r",listStylePosition:"x1cy9i3i",$$css:!0}};function l(a){if(a==null||a==="")return;return d("WABidi").dir(a)}function m(a){a=l(a)==="rtl";return a!==c("WAWebL10N").isRTL()}function a(a){var b=a.children;b=b===void 0?"":b;var e=a.inline;e=e===void 0?!1:e;var f=a.numbering,g=a.selectable;a=a.text;if(e)return j.jsxs(d("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:g,children:[f,b]});e=f+" ";return j.jsx("li",babelHelpers["extends"]({dir:"auto",value:f.replace(".","")},(i||(i=c("stylex"))).props([m(a)&&k.dirMismatch,d("WAWebUISpacing").uiPadding.start2]),{children:j.jsx(d("WAWebCopyPasteSelectable.react").SelectableSpan,{selectable:g,prePlainText:e,children:d("WAWebFormatComponentUtils").removeFirstLeadingSpace(b)})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebTextMutatorComponentUtils",["WAWebBulletedListItemMutatorComponent.react","WAWebNumberedListItemMutatorComponent.react"],(function(a,b,c,d,e,f,g){function a(a){a=Array.isArray(a)?a:[a];var b=[],d=[];for(a of a)if(typeof a==="string"&&a.match(/^\r?\n$/)&&d.length)d.push(a);else if(a!=null&&typeof a==="object"&&(a.type===c("WAWebBulletedListItemMutatorComponent.react")||a.type===c("WAWebNumberedListItemMutatorComponent.react")))d.push(a);else{var e=a;d.length&&(b.push({isList:!0,children:d}),d=[],typeof e==="string"&&(e=e.replace(/^\r?\n/g,"")));b.push({isList:!1,children:e})}d.length&&b.push({isList:!0,children:d});return b}g.groupListChildren=a}),98);
__d("WAWebBulletedListMutatorComponent.react",["WAWebL10N","WAWebTextMutatorComponentUtils","WAWebUISpacing","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={ul:{wordBreak:"x13faqbe",whiteSpace:"xeaf4i8",position:"x1n2onr6",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var e=a.inline;e=e===void 0?!1:e;var f=a.largerIndentation,g=f===void 0?!1:f;f=a.quoted;var h=f===void 0?!1:f;if(e)return b;var l=[];d("WAWebTextMutatorComponentUtils").groupListChildren(b).forEach(function(a,b){a.isList?l.push(j.jsx("ul",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(k.ul,!h&&d("WAWebUISpacing").uiMargin.vert4,d("WAWebUISpacing").uiMargin.start18,g?d("WAWebUISpacing").uiMargin.start18:d("WAWebUISpacing").uiMargin.start8),{dir:c("WAWebL10N").isRTL()?"rtl":"ltr",children:a.children}),b)):l.push(a.children)});return l}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebFormatFilter",[],(function(a,b,c,d,e,f){function a(a,b){if(a.length===1)return a;var c=[],d;while(d=a.pop()){var e=d,f=e[0],g=e[3];e=e[4];e=b[e];var h=e[0];e=e[2];var i=!0,j=c.length;for(j=j-1;j>=0;--j){var k=c[j],l=k[2],m=k[3];k=k[4];if(f>m)continue;m=b[k];k=m[0];m=m[2];if(g>l){if(e<m&&c.splice(j,1))continue;i=!1;break}if(k.mutates&&!(i=!1))break;if(h.compatibility){h.nestable(k)||(i=!1);break}if(!h.nestable(k)&&!k.compatibility&&e<m&&c.splice(j,1))continue;if(!h.compatibility&&!k.format){i=!1;break}}i&&c.push(d)}return c}f["default"]=a}),66);
__d("WAWebFormatFlatten",[],(function(a,b,c,d,e,f){function a(a){var b=[];for(var c=0;c<a.length;++c)for(var d=0;d<a[c].length;++d){var e=a[c][d],f=e[0];e=e[1];b.push([f,e,c])}return b}f["default"]=a}),66);
__d("WAWebFormatMatch",[],(function(a,b,c,d,e,f){function a(a,b,c){c===void 0&&(c=Infinity);var d=[];for(var e=0;e<b.length;++e){var f=b[e],g=f[0];f=f[1];g=g.match(a,f,c);f=[];var h=g.length;for(var i=0,j=g[i];i<h;j=g[++i])f[i]=[j[0],j[1],j[2],j[3],e,j[4]];f.length&&d.push(f)}for(i=0;i<d.length;i++){h=b[d[i][0][4]][0].conflictResolvers;if(!h)continue;for(j=0;j<d.length;j++){g=b[d[j][0][4]][0];f=h.get(g);f==null||f(d[i],d[j])}}e=[];for(c=0;c<d.length;++c)e[c]=d[c].length-1;a=[];g=0;while(d.length){for(f=0,j=-1;f<d.length;++f)d[f][e[f]][0]>j&&(g=f,j=d[f][e[f]][0]);a.push(d[g][e[g]]);--e[g]<0&&(d.splice(g,1),e.splice(g,1))}return a}f["default"]=a}),66);
__d("WAWebFormatParse",["WAUnicodeUtils","WAWebFormatFilter","WAWebFormatFlatten","WAWebFormatMatch","WAWebFormatParseTree"],(function(a,b,c,d,e,f,g){function a(a,b,d){d===void 0&&(d=Infinity);return h(a,c("WAWebFormatFlatten")(b),d)}function h(a,b,e){e===void 0&&(e=Infinity);var f=c("WAWebFormatMatch")(a,b,e);f=f.length?c("WAWebFormatParseTree")(a,c("WAWebFormatFilter")(f,b),b):{children:[{type:"text",value:a}]};b=d("WAUnicodeUtils").numCodepoints(a);e<b&&i(f,{limit:e});return f}function i(a,b){if(b.limit<=0)return;if(a.type&&a.type==="text"){if(a.value.length>=b.limit){var c=d("WAUnicodeUtils").toArray(a.value);c.length>=b.limit&&(c=c.slice(0,b.limit));a.value=c.join("");b.limit-=c.length}else b.limit-=a.value.length;return}else if(a.type&&a.type==="delimiter")return;c=0;while(c<a.children.length){i(a.children[c],b);if(b.limit<=0)break;c++}a.children=a.children.slice(0,c+1)}g.parse=a;g._parse=h}),98);
__d("WAWebFormatParseTree",["WAWebFormatParse"],(function(a,b,c,d,e,f,g){function a(a,b,c){var e={children:[]},f=0,g=e,i=0;for(var j=0;j<b.length;++j){var k=b[j],l=k[0],m=k[1];while(g.parent&&l>(i=g.match[2])){f<=i&&g.children.push({type:"text",value:a.substring(f,i+1)});f=g.match[3]+1;if(g.mutator.fragment){var n=g.parent.children;n.pop();n.push.apply(n,g.children)}i!==g.match[3]&&g.parent.children.push({type:"delimiter",value:a.substring(i+1,f)});g=g.parent}f<l&&g.children.push({type:"text",value:a.substring(f,l)});n=c[k[4]];var o=n[0];n=n[1];var p=o.mutates;f=m;l!==m&&g.children.push({type:"delimiter",value:a.substring(l,m)});l={children:[],match:k,mutator:o,opts:n,parent:g};if(p){m=a.substring(k[1],k[2]+1);n=o.mutate(m,k[5]);p=h(o,c,l);m=d("WAWebFormatParse")._parse(n,p);l.children=m.children;f=k[2]+1}g.children.push(l);g=l}do{if(!g.match)continue;o=g.match;n=o[2];p=o[3];f<=n&&g.children.push({type:"text",value:a.substring(f,n+1)});f=p+1;if(g.mutator.fragment){m=g.parent.children;m.pop();m.push.apply(m,g.children)}n!==p&&g.parent.children.push({type:"delimiter",value:a.substring(n+1,f)})}while(g.parent&&(g=g.parent)&&g.parent);f!==a.length&&g.children.push({type:"text",value:a.substring(f)});return e}function h(a,b,c){a=a.format;var d=[];c=i(c);for(var e=0;e<b.length;++e){if(!a&&!b[e][0].compatibility)continue;if(c.includes(b[e][0]))continue;d.push(b[e])}return d}function i(a){a=a;var b=[];do a.mutator&&b.push(a.mutator);while(a.parent&&(a=a.parent));return b}g["default"]=a}),98);
__d("WAWebFormatSerialize",["err"],(function(a,b,c,d,e,f,g){function a(a,b,c){return a.onRoot(i(a,b.children,c),c)}function h(a,b,d){if(b.type){var e=b.value;switch(b.type){case"text":return a.onText(e,d);case"delimiter":return a.onDelimiter(e,d);default:throw c("err")("Invalid node type")}}return a.onMutator(b.mutator,i(a,b.children,d),b.match[5],b.opts,d)}function i(a,b,c){return b.reduce(function(b,d){b.push(h(a,d,c));return b},[])}g["default"]=a}),98);
__d("WAWebFormat",["WAWebFormatParse","WAWebFormatSerialize"],(function(a,b,c,d,e,f,g){function a(a,b,e,f,g){g===void 0&&(g=Infinity);return c("WAWebFormatSerialize")(e,d("WAWebFormatParse").parse(a,b,g),f)}g["default"]=a}),98);
__d("WAWebFormatSerializer",["err"],(function(a,b,c,d,e,f,g){a=function(){function a(){}a.onMutator=function(a,b,d,e,f){throw c("err")("Subclasses of `Serializer` must override `onMutator()`")};a.onRoot=function(a,b){throw c("err")("Subclasses of `Serializer` must override `onRoot()`")};a.onText=function(a,b){throw c("err")("Subclasses of `Serializer` must override `onText()`")};a.onDelimiter=function(a,b){throw c("err")("Subclasses of `Serializer` must override `onDelimiter()`")};return a}();g["default"]=a}),98);
__d("WAWebJsxTextSerializer",[],(function(a,b,c,d,e,f){function a(a){return a}f["default"]=a}),66);
__d("WAWebNumberedListMutatorComponent.react",["WAWebL10N","WAWebTextMutatorComponentUtils","WAWebUISpacing","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={ol:{wordBreak:"x13faqbe",whiteSpace:"xeaf4i8",position:"x1n2onr6",listStyleType:"x3yw8vx",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var e=a.inline;e=e===void 0?!1:e;var f=a.largerIndentation,g=f===void 0?!1:f;f=a.quoted;var h=f===void 0?!1:f;if(e)return b;var l=[];d("WAWebTextMutatorComponentUtils").groupListChildren(b).forEach(function(a,b){a.isList?l.push(j.jsx("ol",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(k.ol,d("WAWebUISpacing").uiMargin.start30,!h&&d("WAWebUISpacing").uiMargin.vert4,g?d("WAWebUISpacing").uiMargin.start30:d("WAWebUISpacing").uiMargin.start20),{dir:c("WAWebL10N").isRTL()?"rtl":"ltr",children:a.children}),b)):l.push(a.children)});return l}a.displayName=a.name+" [from "+f.id+"]";a.displayName="NumberedList";g["default"]=a}),98);
__d("WAWebJsxSerializer.react",["WAWebBulletedListMutatorComponent.react","WAWebFormatSerializer","WAWebJsxTextSerializer","WAWebNumberedListMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=(h||d("react")).cloneElement;a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebFormatSerializer"));a.onText=c("WAWebJsxTextSerializer");a.onDelimiter=function(a){return void 0};a.onRoot=function(a){k(a);return j(a)};a.onMutator=function(a,b,c,d){return a.jsx(j(b),c,d)};function j(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];if(d===void 0)continue;if(typeof d==="string"){b.push(d);continue}var e="jsx-child-"+c;b.push(i(d,{key:e}))}return b}function k(a){var b=-1;for(var d of a){var e;if((d==null?void 0:d.type)!==c("WAWebNumberedListMutatorComponent.react"))continue;var f=d==null||(e=d.props)==null?void 0:e.children;if(Array.isArray(f))for(f of f){var g,h=f==null||(g=f.props)==null?void 0:g.numbering;h!=null&&(b=Math.max(b,parseInt(h,10)))}}if(b>=10)for(h=0;h<a.length;h++){f=a[h];if((f==null?void 0:f.type)!==c("WAWebNumberedListMutatorComponent.react")&&(f==null?void 0:f.type)!==c("WAWebBulletedListMutatorComponent.react"))continue;a[h]=i(f,{largerIndentation:!0})}}g["default"]=a}),98);
__d("WAWebHocComponent_DEPRECATED.react",["WANullthrows","react"],(function(a,b,c,d,e,f,g){var h;b=(h||d("react")).Component;function a(a){if(typeof a==="string")return a;if(!a)return"Component";var b=a.displayName;if(b!=null&&b!=="")return b;b=a.name;return b!=null&&b!==""?b:"Component"}e=function(a){function b(b){var c;c=a.call(this,b)||this;c.setComponent=function(a){c.component=a};c.state=babelHelpers["extends"]({},c.state);return c}babelHelpers.inheritsLoose(b,a);var d=b.prototype;d.getComponent=function(){return this.component instanceof b?this.component.getComponent():c("WANullthrows")(this.component)};return b}(b);g.getHocComponentDisplayName=a;g.WrappedComponent=e}),98);
__d("WAWebListenerHoc_DEPRECATED",["WAAbortError","WALogger","WAWebCmd","WAWebDocumentFlushed","WAWebHocComponent_DEPRECATED.react","WAWebUIListener","react"],(function(a,b,c,d,e,f,g){var h,i,j=i||c("react"),k=function(){function a(){var a=this;this._mounted=!1;this._unmounted=!1;this._listeners=new Set();this._remove=function(b){b.disengage(),a._listeners["delete"](b)}}var b=a.prototype;b._add=function(a){if(this._unmounted){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Listener added after unmounting"])));return}this._listeners.add(a);this._mounted&&a.engage()};b.internalUseOnlyMarkMounted=function(){this._mounted=!0,this._listeners.forEach(function(a){a.engage()})};b.internalUseOnlyMarkUnmounted=function(){this._unmounted=!0,this._listeners.forEach(this._remove),this._abortController&&this._abortController.abort()};b.add=function(a,b,c,e){var f=this;a=new(d("WAWebUIListener").Listener)(a,b,function(){f._unmounted||c.apply(this,arguments)},e,c);this._add(a)};b.addOnce=function(a,b,c,e){var f=this,g=new(d("WAWebUIListener").Listener)(a,b,function(){f._remove(g),f._unmounted||c.apply(this,arguments)},e,c);this._add(g)};b.remove=function(a,b,c,d){var e=this;this._listeners.forEach(function(f){f.represents(a,b,c,d)&&e._remove(f)})};b.uiIdle=function(a){if(d("WAWebCmd").Cmd.uiBusy){this.addOnce(d("WAWebCmd").Cmd,"ui_idle",a);return}this._abortController=this._abortController||new AbortController();d("WAWebDocumentFlushed").documentFlushed({signal:this._abortController.signal}).then(function(){a()},function(a){if(a.name!==d("WAAbortError").ABORT_ERROR)throw a})};b.testsOnlyGetListeners=function(){return this._listeners};return a}();function a(a){var b,c;return b=function(b){function c(){var a;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(a=b.call.apply(b,[this].concat(d))||this,a.listeners=new k(),babelHelpers.assertThisInitialized(a))||babelHelpers.assertThisInitialized(a)}babelHelpers.inheritsLoose(c,b);var d=c.prototype;d.componentDidMount=function(){this.listeners.internalUseOnlyMarkMounted()};d.componentWillUnmount=function(){this.listeners.internalUseOnlyMarkUnmounted()};d.render=function(){return j.jsx(a,babelHelpers["extends"]({ref:this.setComponent},this.props,{listeners:this.listeners}))};return c}(d("WAWebHocComponent_DEPRECATED.react").WrappedComponent),b.defaultProps=(c=a.defaultProps)!=null?c:void 0,b.displayName="Listener("+d("WAWebHocComponent_DEPRECATED.react").getHocComponentDisplayName(a)+")",b.wrappedComponent=null,b}g.Listeners=k;g.ListenerHOC=a}),98);
__d("WAWebEmojiText.react",["WABidi","WANullthrows","WAWebBlockQuoteMutatorComponent.react","WAWebBulletedListMutatorComponent.react","WAWebClassnames","WAWebCopyPasteSelectable.react","WAWebDebounce","WAWebEmoji","WAWebFormat","WAWebFormatConfiguration","WAWebJsxSerializer.react","WAWebL10N","WAWebListenerHoc_DEPRECATED","WAWebNonEmptyString","WAWebNumberedListMutatorComponent.react","WAWebUA","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j;a=j||d("react");var k=h||(h=c("react"));b=a.PureComponent;var l=a.createRef,m=[c("WAWebBulletedListMutatorComponent.react"),c("WAWebNumberedListMutatorComponent.react"),c("WAWebBlockQuoteMutatorComponent.react")],n={breakWord:{wordBreak:"x13faqbe",$$css:!0},clickable:{cursor:"x1ypdohk",":hover_textDecoration":"xt0b8zv",$$css:!0},dirMismatch:{display:"x1lliihq",width:"xh8yej3",$$css:!0},ellipsify:{flexGrow:"x1iyjqo2",overflowX:"x6ikm8r",overflowY:"x10wlt62",position:"x1n2onr6",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0},inlineblock:{display:"x1rg5ohu",$$css:!0},displayBlock:{display:"x1lliihq",$$css:!0},multiline:{whiteSpace:"x1fj9vlw",$$css:!0},preserveWhitespace:{whiteSpace:"x126k92a",$$css:!0},preformatted:{whiteSpace:"x1sdyfia",width:"xm6i5cn",display:"x1rg5ohu",$$css:!0}};e={SMALL:"SMALL",LARGE:"LARGE"};var o=4096,p=12;function q(a){return d("WAWebEmoji").EmojiUtil.containsEmoji(a.substring(0,o))}f=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.state={text:String(b.props.text||""),ellipsified:null},b.refContainer=l(),b.$1=!1,b.$2=c("WAWebDebounce")(function(){b.setState({ellipsified:null},b.ellipsify)},10),b.$3=function(a){var b=[],e=c("WAWebL10N").LR("ltr","rtl"),f=function(a){var b;if(a==null)return e;if(typeof a==="string"){var c;return(c=d("WABidi").dir(a))!=null?c:e}return f(a==null||(b=a.props)==null||(b=b.children)==null?void 0:b[0])},g=[],h=function(){if(g.length===0)return;b.push({dir:f(g[0]),content:g});g=[]};for(a of a)if(typeof a==="string"){var i=a.split(/(\r?\n)/);i.forEach(function(a){a!==""&&g.push(a),a.match(/\r?\n/)&&h()})}else m.includes(a.type)?(h(),b.push({dir:e,content:[a]})):g.push(a);h();return b},b.ellipsify=function(){var a=b.refContainer.current;if(!a)return;var e=c("WANullthrows")(a.parentElement),f=a.querySelectorAll("img");if(!f.length)return;var g=a.clientWidth;a.style.overflow="visible";g=a.clientWidth!==g;a.style.overflow="hidden";if(!g)return;g=Boolean(c("WAWebL10N").isRTL())===Boolean(b.props.dirMismatch);e=g?e.clientWidth-u(e,a)-p:p;e=s(f,e,g);g=f[e];b.setState({ellipsified:d("WAWebNonEmptyString").asMaybeNonEmptyString(r(a,g))})},b.$4=function(){return q(b.state.text)&&b.ellipsify()},b.$5=function(a,d){var e=b.props.direction,f=b.$3(a);return f.map(function(a,b){var g=e==null||a.dir===e||a.dir==="rtl"===c("WAWebL10N").isRTL(),h=g?null:a.dir,i=f.length-1===b;g={0:"",2:"x1lliihq xh8yej3",1:"x1lliihq",3:"xh8yej3 x1lliihq"}[!!!g<<1|!!(!i&&g)<<0];return k.jsxs("span",{dir:h,className:g,children:[a.content,i&&d?String.fromCodePoint(8230):null]},b)})},b.$6=function(){if(b.$1)return;b.$1=!0;b.props.listeners.add(window,"resize",b.$2)},b.componentDidMount=function(){!d("WAWebUA").UA.supportsEmojiEllipsification&&b.props.ellipsify&&q(b.state.text)&&b.$6();if(d("WAWebUA").UA.supportsEmojiEllipsification||!b.props.ellipsify)return;b.$4()},b.$7=function(){if(!b.$1)return;b.$1=!1;b.props.listeners.remove(window,"resize",b.$2)},b.render=function(){if(!b.state.text)return null;var a=b.props,e=a.onClick,f=a.ellipsify,g=a.dirMismatch,h=a.inferLinesDirection,j=a.inlineblock,l=a.direction,m=a.textLimit,p=a.multiline,q=a.preserveWhitespace,r=a.preformatted,s=a.breakWord,t=a.emojiXstyle;a=a.displayBlock;var u=b.state.ellipsified!=null?b.state.ellipsified:b.state.text;l=l==="inherit"?null:l||"auto";var v=!!b.props.selectable;t=b.props.formatters||d("WAWebFormatConfiguration").EmojiOnly({selectable:v,emojiXstyle:t});m=m?m:Infinity;f&&u.length>o&&m>o&&(m=o);g=g===!0&&!h;h=d("WAWebClassnames").classnamesConvertMeToStylexPlease(b.props.className,(i||(i=c("stylex")))(f&&n.ellipsify,j&&n.inlineblock,a&&n.displayBlock,e&&n.clickable,g&&n.dirMismatch,p&&n.multiline,q===!0&&n.preserveWhitespace,r===!0&&n.preformatted,s&&n.breakWord,b.props.xstyle));f=u;j=c("WAWebFormat")(f,t,c("WAWebJsxSerializer.react"),void 0,m);a=b.state.ellipsified!=null||u.length>m;g=b.props.inferLinesDirection?b.$5(j,a):j;q=(p=b.props.title)!=null?p:b.state.text;return k.jsx(d("WAWebCopyPasteSelectable.react").Selectable,{"data-testid":void 0,className:h,dir:l,element:b.props.element,onClick:e,ref:b.refContainer,selectable:v,"aria-label":(r=b.props.ariaLabel)!=null?r:void 0,title:b.props.titlify?q:void 0,style:{minHeight:((s=b.props.minTextHeight)!=null?s:0)+"px"},children:g})},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.getElement=function(){return this.refContainer.current};b.getDerivedStateFromProps=function(a,b){var c,e=null;c=String((c=a.text)!=null?c:"");c!==b.text&&(e={text:c});if(d("WAWebUA").UA.supportsEmojiEllipsification||!a.ellipsify||e==null)return e;q(c)||(e=babelHelpers["extends"]({},e,{ellipsified:null}));return e};e.getWidth=function(){var a=this.refContainer.current;return!a?0:a.getBoundingClientRect().width};e.componentDidUpdate=function(a,b){if(d("WAWebUA").UA.supportsEmojiEllipsification||!this.props.ellipsify||b.text===this.state.text)return;q(this.state.text)?(this.$2(),this.$6()):this.$7()};e.componentWillUnmount=function(){this.$2.cancel()};return b}(b);f.defaultProps={element:"span",emojiSize:e.SMALL,textLimit:Infinity};a=d("WAWebListenerHoc_DEPRECATED").ListenerHOC(f);b=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.getElement=function(){return b.getComponent().getElement()},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getWidth=function(){return this.getComponent().getWidth()};return b}(a);function r(a,b,c){c===void 0&&(c={found:!1});if(a===b){c.found=!0;return""}else if(a instanceof HTMLImageElement)return a.alt;else if(a.nodeType===Node.TEXT_NODE)return a.nodeValue;var d=t(a),e="",f=0;while(f<a.childNodes.length){e+=r(a.childNodes[f],b,c);if(c.found)break;else f++}if(d==null)return e;f=d[0];a=d[1];return""+f+e+a}function s(a,b,c){var d=0;while(d<a.length){var e=a[d];if(c&&e.offsetLeft+e.clientWidth>=b)break;if(!c&&e.offsetLeft<=b)break;d++}return d}function t(a){if(a instanceof Element)switch(a.tagName){case"CODE":return["```","```"];case"STRONG":return["*","*"];case"EM":return["_","_"];case"DEL":return["~","~"];case"LI":return["* ",""];default:return null}return null}function u(a,b){var c=0;a=a.childNodes;for(var d=0;d<a.length;d++){var e=a[d];if(e===b)break;c+=e instanceof Element?e.clientWidth:0}return c}g.EMOJI_SIZE=e;g.EmojiText=b}),98);
__d("WAWebLockScreenResolver",["WAComms","WALogger","WAResolvable","WAWebChatCollection","WAWebCmd","WAWebCryptoEncKeyHelper","WAWebDbEncryptionKey","WAWebModalManager","WAWebMsgCollection","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;c=function(){function a(){this.deferred=new(d("WAResolvable").Resolvable)()}var b=a.prototype;b.waitForPasscode=function(){var a;d("WAWebCmd").Cmd.openLockScreenModal();return(a=this.deferred)==null?void 0:a.promise};b.waitForPasscodeAfterIncorrectAttempt=function(){var a;this.deferred=new(d("WAResolvable").Resolvable)();d("WAWebCmd").Cmd.incorrectPasscodeLockScreen();return(a=this.deferred)==null?void 0:a.promise};b.enterPasscode=function(a){this.deferred.resolve(a)};b.correctPasscodeEntered=function(a){this.deferred=new(d("WAResolvable").Resolvable)(),d("WAWebCmd").Cmd.correctPasscodeLockScreen(a),d("WAWebModalManager").ModalManager.close()};return a}();e=new c();function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebUserPrefsInfoStore").waNoiseInfo.cachedPasscodeDerivedKey==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[screeen-lock] passcode derived key is null when trying to encrypt"]))).sendLogs("[screeen-lock] passcode derived key is null when trying to encrypt");location.reload();return}var a=d("WAComms").getComms();if(a==null){location.reload();return}var b=d("WAWebChatCollection").ChatCollection.getActive();b&&d("WAWebCmd").Cmd.closeChat(b);yield d("WAWebMsgCollection").MsgCollection.encryptAndClearModels();d("WAWebUserPrefsInfoStore").waNoiseInfo.resetCachedPasscodeDerivedKey();d("WAWebDbEncryptionKey").DbEncKeyStore.deleteKeyCache();d("WAWebDbEncryptionKey").DbEncKeyStore.resetDB();if(a.softCloseSocket)a.softCloseSocket();else{location.reload();return}yield d("WAWebCryptoEncKeyHelper").initEncSalt();a.socketLoop.start()});return i.apply(this,arguments)}g.LockScreenResolvable=e;g.lockScreenAndTriggerUnlockFlow=a}),98);
__d("WAWebChatAssignmentIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="chat-assignment";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=16;o=20;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 20 16",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M12.7 7.9998C14.7 7.9998 16.3 6.3998 16.3 4.3998C16.3 2.3998 14.7 0.799805 12.7 0.799805C10.7 0.799805 9.1 2.3998 9.1 4.3998C9.1 6.3998 10.7 7.9998 12.7 7.9998ZM12.7 9.7998C10.3 9.7998 5.5 10.9998 5.5 13.3998V15.1998H20V13.3998C19.9 10.9998 15.1 9.7998 12.7 9.7998Z",fill:"currentColor"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.09961 8.06427H0.0996094V6.25781H7.09961V8.06427Z",fill:"currentColor"}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.85521 7.11619L3.51172 4.7727L4.77368 3.51074L8.37912 7.11619L4.77368 10.7216L3.51172 9.45968L5.85521 7.11619Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.ChatAssignmentIcon=a}),98);
__d("WAWebSvgButton.react",["WAWebUnstyledButton.react","WDSFocusStateStyles","react"],(function(a,b,c,d,e,f,g){var h=["ref"],i=["Icon","disabled","onClick","type","title","aria-label","aria-haspopup","aria-expanded","dataTab","className_DONOTUSE","xstyle","testid","tabIndex"],j,k=j||c("react"),l={disabled:{opacity:"x5dmra7",$$css:!0}};function a(a){var b=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var e=a.Icon,f=a.disabled,g=a.onClick,j=a.type,m=a.title,n=a["aria-label"],o=a["aria-haspopup"],p=a["aria-expanded"],q=a.dataTab,r=a.className_DONOTUSE,s=a.xstyle,t=a.testid;t=a.tabIndex;a=babelHelpers.objectWithoutPropertiesLoose(a,i);return k.jsx(c("WAWebUnstyledButton.react"),{ref:b,xstyle:[s,d("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus],disabled:f,onClick:g,"aria-label":n,"aria-haspopup":o,"aria-expanded":p,title:m,dataTab:q,className_DONOTUSE:r,type:j,testid:void 0,tabIndex:t,children:k.jsx(e,babelHelpers["extends"]({},a,{xstyle:f===!0&&l.disabled}))})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebName.react",["fbt","WAArrayMoveToFirst","WALogger","WAReplaceRepeatingWhitespace","WAWebABProps","WAWebBusinessProfileTypes","WAWebChatAssignmentIcon.react","WAWebChatContactUtils","WAWebChatGetters","WAWebClassnames","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebEmojiText.react","WAWebErrorBoundary.react","WAWebFormatConfiguration","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebGroupMetadataCollection","WAWebGroupType","WAWebLabels.react","WAWebLidMigrationUtils","WAWebMiscGatingUtils","WAWebNewsletterName.react","WAWebParticipantListUtils","WAWebPsaVerifiedBlueIcon.react","WAWebPsaVerifiedIcon.react","WAWebSvgButton.react","WAWebUISpacing","WAWebUserPrefsMeUser","WAWebWamEnumOppositeVisibleIdentificationType","cr:17281","react","stylex","useWAWebChatValues","useWAWebContactValues","useWAWebForceUpdate","useWAWebListener","useWAWebModelValues"],(function(a,b,c,d,e,f,g,h){var i=["chat","selectable"],j=["chat","selectable"],k=["chat"],l=["contact"],m,n,o,p=n||c("react"),q={spaceBefore:{"::before_content":"xjuopq5","::before_whiteSpace":"xulcptl",$$css:!0},chatAssignmentIconAssignedToYou:{color:"x29oog3",$$css:!0},chatAssignmentIconAssignedToOthers:{color:"xms21op",$$css:!0},icon:{display:"x78zum5",flex:"x3psx0u",verticalAlign:"x16dsc37",$$css:!0},labels:{display:"x3nfvp2",alignItems:"x6s0dn4",height:"x5yr21d",color:"x1eqw3am",verticalAlign:"x16dsc37",$$css:!0},hasLabels:{display:"x1jfb8zj",overflowX:"xuce83p",overflowY:"x1bft6iq",textOverflow:"x1i7k8ik",whiteSpace:"xq9mrsl",marginInlineEnd:"x11t971q",$$css:!0}},r=function(a){var b=a.contact,c=a.showNotifyName,e=a.elevatedPushNamesEnabled,f=a.useLiftMeUp,g=a.useDisplayName,i=a.useShortName,j=a.useVerifiedName,k=a.you;a=a.showMessageYourselfName;var l=e&&d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(b);if(a&&d("WAWebContactGetters").getIsMe(b)){return{displayName:h._(/*BTDS*/"{nameOrPhoneNumber}",[h._param("nameOrPhoneNumber",j?b.verifiedName:(a=b.name)!=null?a:d("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(b))])}}a=d("WAWebFrontendContactGetters").getDisplayName(b);var m=d("WAWebContactGetters").getPushname(b);if(g&&a){g=d("WAWebFrontendContactGetters").getDisplayNameType(b);return g===d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER&&f&&m!=null?{displayName:"~"+m}:{displayName:a}}if(i&&!l){g=d("WAWebFrontendContactGetters").getFormattedShortName(b);if(g)return{displayName:g}}if(e&&m&&d("WAWebFrontendContactGetters").getIsUsernameContact(b))return{displayName:"~"+m};if(j&&b.verifiedName)return{displayName:b.verifiedName};if(k&&d("WAWebContactGetters").getIsMe(b))return{displayName:d("WAWebFrontendContactGetters").getFormattedName(b)};if(c&&l){a=d("WAWebContactGetters").getNotifyName(b);if(a!=null)return{displayName:e?d("WAWebChatContactUtils").getFormattedNotifyName(a):"~"+a,displayNameAriaLabel:d("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?d("WAWebChatContactUtils").getAccessibleNotifyName(a):void 0}}if(!f)return{displayName:d("WAWebFrontendContactGetters").getFormattedUser(b)};i=d("WAWebFrontendContactGetters").getFormattedUserAndType(b).type;if(i===d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER&&m!=null)return{displayName:b.verifiedName};else if(d("WAWebContactGetters").getIsBusiness(b)&&b.verifiedLevel===d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH)return{displayName:b.verifiedName};return{displayName:"~"+m}},s=function(a){var b=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();if(a.some(function(a){return a.deviceId===b})){var c=h._(/*BTDS*/"Assigned to you");c=p.jsx(d("WAWebChatAssignmentIcon.react").ChatAssignmentIcon,{width:18,height:12,xstyle:[d("WAWebUISpacing").uiMargin.end4,q.chatAssignmentIconAssignedToYou],title:c})}else if(a.length>0){a=h._(/*BTDS*/"Assigned to {agentName}",[h._param("agentName",a[0].name)]);c=p.jsx(d("WAWebChatAssignmentIcon.react").ChatAssignmentIcon,{width:18,height:12,xstyle:[d("WAWebUISpacing").uiMargin.end4,q.chatAssignmentIconAssignedToOthers],title:a})}else c=null;return c};function t(a){var e=a.contact,f=a.element;f=f===void 0?"span":f;var g=a.highlightText,i=a.titlify,j=a.ellipsify,k=a.breakWord,l=a.you;l=l===void 0?!1:l;var n=a.selectable,t=a.useShortName;t=t===void 0?!1:t;var u=a.useDisplayName;u=u===void 0?!1:u;var v=a.onClick,w=a.showLabelIcon;w=w===void 0?!1:w;var x=a.showBusinessCheckmark,y=a.showNotifyName;y=y===void 0?!1:y;var z=a.elevatedPushNamesEnabled;z=z===void 0?!1:z;var A=a.useLiftMeUp;A=A===void 0?!1:A;var B=a.useVerifiedName;B=B===void 0?!1:B;var C=a.firstLabel,D=a.xstyle,E=a.showChatAssignmentIcon;E=E===void 0?!1:E;var F=a.assignedAgents;F=F===void 0?[]:F;var G=a.skipCheckMark;G=G===void 0?!1:G;var H=a.showMessageYourselfName;H=H===void 0?!1:H;var I=a.testid;I=a.isVerifiedNewsletter;var J=a.makeCheckmarkClickable;J=J===void 0?!1:J;var K=a.checkmarkLarge;K=K===void 0?!1:K;var L=a.truncateName,M=a.emojiXstyle,N=d("useWAWebContactValues").useContactValues(e.id,[d("WAWebContactGetters").getIsPSA,d("WAWebContactGetters").getIsIAS,d("WAWebContactGetters").getIsCAPISupportAccount,d("WAWebFrontendContactGetters").getFormattedUser,d("WAWebFrontendContactGetters").getFormattedName,d("WAWebFrontendContactGetters").getFormattedShortName,d("WAWebFrontendContactGetters").getFormattedUsernameOrPhone,d("WAWebFrontendContactGetters").getDisplayName,d("WAWebContactGetters").getLabels,d("WAWebContactGetters").getName,d("WAWebContactGetters").getNotifyName,d("WAWebContactGetters").getIsMe,d("WAWebContactGetters").getVerifiedName,d("WAWebContactGetters").getId]),O=N[0],P=N[1],Q=N[2],R=N[3],S=N[4],T=N[5];N[6];N[7];var U=N[8],V=N[9];N[10];N[11];N[12];N=N[13];var W;g!=null&&g!==""&&(W=d("WAWebFormatConfiguration").SearchName({terms:[g]}));g=r({contact:e,showNotifyName:y,elevatedPushNamesEnabled:z,useLiftMeUp:A,useDisplayName:u,useShortName:t,useVerifiedName:B,you:l,showMessageYourselfName:H});e=g.displayName;y=g.displayNameAriaLabel;if(!e){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["displayName:",",\n               formattedName:",",\n               name:",",\n               formattedShortName:",",\n               formattedUser:",""])),e,S,V,T,R).sendLogs("display name is null or undefined");return""}z=d("WAWebLidMigrationUtils").getShouldShowLidDebugUI(N)&&b("cr:17281");A=c("WAReplaceRepeatingWhitespace")(e.toString());u=p.jsxs("div",babelHelpers["extends"]({},{0:{className:"x78zum5"},1:{className:"xuxw1ft x6ikm8r x10wlt62 xlyipyv x78zum5"}}[!!(L===!0)<<0],{children:[p.jsx(d("WAWebEmojiText.react").EmojiText,{text:A,ariaLabel:y!=null?c("WAReplaceRepeatingWhitespace")(y.toString()):void 0,element:f,className:d("WAWebClassnames").classnamesConvertMeToStylexPlease(null,a.className),formatters:W,titlify:i,ellipsify:j,breakWord:k,direction:"auto",selectable:n,inlineblock:!0,onClick:v,xstyle:D,testid:void 0,emojiXstyle:M}),H&&p.jsx(d("WAWebEmojiText.react").EmojiText,{emojiXstyle:M,testid:void 0,text:h._(/*BTDS*/"(You)"),xstyle:q.spaceBefore}),z&&b("cr:17281")&&p.jsx(b("cr:17281"),{})]}));t=a.labels||U;t!=null&&t.length&&C!=null&&c("WAArrayMoveToFirst")(t,C);B=w===!0&&t!=null&&t.length?p.jsx(d("WAWebLabels.react").Labels,{labels:t,showName:!1,iconXstyle:d("WAWebUISpacing").uiPadding.start4}):null;l=!G&&(O||P||Q||Boolean(x)||I);g=E?s(F):null;if(l===!0){if(d("WAWebMiscGatingUtils").isBlueEnabled()){S=K?24:16;V=J&&v?p.jsx(c("WAWebSvgButton.react"),{height:S,width:S,Icon:d("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,"aria-label":h._(/*BTDS*/"Verified information"),onClick:v}):p.jsx(d("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{height:S,width:S})}else V=p.jsx(d("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{});return p.jsxs("div",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(d("WAWebNewsletterName.react").styles.verified),{children:[u,p.jsx("div",babelHelpers["extends"]({},o.props(I===!0?d("WAWebNewsletterName.react").styles.newsletterIcon:[q.icon,d("WAWebUISpacing").uiMargin.top1,d("WAWebUISpacing").uiMargin.start3]),{children:V})),p.jsxs("div",{className:"x3nfvp2 x6s0dn4 x5yr21d x1eqw3am x16dsc37",children:[g,B]})]}))}return g||B?p.jsxs("div",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(d("WAWebNewsletterName.react").styles.verified),{children:[u,p.jsxs("div",{className:"x3nfvp2 x6s0dn4 x5yr21d x1eqw3am x16dsc37",children:[g,B]})]})):p.jsx("div",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(d("WAWebNewsletterName.react").styles.verified),{children:u}))}t.displayName=t.name+" [from "+f.id+"]";function u(a){var e=a.chat,f=a.element,g=a.highlightText,i=a.titlify,j=a.ellipsify,k=a.breakWord,l=a.onClick,m=a.showLabelIcon,n=a.firstLabel,r=a.className,t=a.xstyle,u=a.showChatAssignmentIcon;u=u===void 0?!1:u;var v=a.assignedAgents;v=v===void 0?[]:v;var w=a.testid;w=a.overrideCommunityAnnouncementGroupName;w=w===void 0?!1:w;var x=a.checkmarkLarge;x=x===void 0?!1:x;var y,z=d("useWAWebChatValues").useChatValues(a.chat.id,[d("WAWebFrontendChatGetters").getFormattedTitle,d("WAWebChatGetters").getLabels]);z[0];z=z[1];var A=d("useWAWebModelValues").useModelValues(a.groupMetadata,["support","isUnnamed","participants","groupType","isLidAddressingMode","isCag","parentGroup"]),B=d("useWAWebForceUpdate").useForceUpdateDONOTUSE();d("useWAWebListener").useListener(A.participants,"bulk_add bulk_remove reset sort change:isAdmin change:isSuperAdmin remove add",B);g!=null&&g!==""&&(y=d("WAWebFormatConfiguration").SearchName({terms:[g]}));B=a.labels||z;B!=null&&B.length&&n!=null&&c("WAArrayMoveToFirst")(B,n);g=m===!0&&B!=null&&B.length?p.jsx(d("WAWebLabels.react").Labels,{labels:B,showName:!1}):null;a=w&&A.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?h._(/*BTDS*/"Announcements"):c("WAReplaceRepeatingWhitespace")(A!=null&&A.isUnnamed?d("WAWebParticipantListUtils").calculateUnnamedGroupFullParticipantsList(A,!0):e.title());z=d("WAWebLidMigrationUtils").getShouldShowLidDebugUIForGroups(A.isLidAddressingMode);n=A.parentGroup;B=n?((m=c("WAWebGroupMetadataCollection").get(n))==null?void 0:m.isLidAddressingMode)===!0:!1;w=d("WAWebLidMigrationUtils").getShouldShowLidDebugUIForGroups(B);e=p.jsxs(p.Fragment,{children:[p.jsx(d("WAWebEmojiText.react").EmojiText,{text:a,element:f,className:r,xstyle:t,formatters:y,titlify:i,ellipsify:j,breakWord:k,direction:"auto",inlineblock:!0,onClick:l,testid:void 0}),z&&b("cr:17281")&&p.jsx(b("cr:17281"),{isCAG:A.isCag}),w&&b("cr:17281")&&p.jsx(b("cr:17281"),{isParentGroup:!0})]});n=A.support;if(n){m=x?24:20;return p.jsxs("div",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(d("WAWebNewsletterName.react").styles.verified,!!g&&q.hasLabels),{children:[e,p.jsx("div",babelHelpers["extends"]({},o.props(q.icon,d("WAWebUISpacing").uiMargin.top1,d("WAWebUISpacing").uiMargin.start3),{children:d("WAWebMiscGatingUtils").isBlueEnabled()?p.jsx(d("WAWebPsaVerifiedBlueIcon.react").PsaVerifiedBlueIcon,{width:m,height:m}):p.jsx(d("WAWebPsaVerifiedIcon.react").PsaVerifiedIcon,{})})),p.jsx("div",babelHelpers["extends"]({},o.props(q.labels,d("WAWebUISpacing").uiMargin.start8),{children:g}))]}))}B=u?s(v):null;return B||g?p.jsxs("span",{className:"x1jfb8zj xuce83p x1bft6iq x1i7k8ik xq9mrsl x11t971q",children:[e,p.jsxs("div",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(q.labels,d("WAWebUISpacing").uiMargin.start8),{children:[B,g]}))]}):e}u.displayName=u.name+" [from "+f.id+"]";function v(a){var b;b=(b=d("useWAWebChatValues").useOptionalChatValues((b=a.chat)==null?void 0:b.id,[d("WAWebChatGetters").getIsUser,d("WAWebChatGetters").getIsNewsletter,d("WAWebFrontendChatGetters").getGroupMetadata,d("WAWebFrontendChatGetters").getFormattedTitle]))!=null?b:[!1,!1,null,null];var c=b[0],e=b[1],f=b[2],g=b[3];if(a.chat&&f!=null&&!c&&!e){b=a.chat;a.selectable;var h=babelHelpers.objectWithoutPropertiesLoose(a,i);return p.jsx(d("WAWebErrorBoundary.react").ErrorBoundary,{name:"group-name",fallback:function(){return p.jsx("span",{children:g})},children:p.jsx(u,babelHelpers["extends"]({chat:b,groupMetadata:f},h))})}if(a.chat&&!c&&e){b=a.chat;f=a.selectable;h=babelHelpers.objectWithoutPropertiesLoose(a,j);return p.jsx(d("WAWebNewsletterName.react").NewsletterName,babelHelpers["extends"]({chat:b,selectable:f},h))}if(a.chat){c=a.chat;e=babelHelpers.objectWithoutPropertiesLoose(a,k);b=c.contact;f=e}else{h=a.contact;c=babelHelpers.objectWithoutPropertiesLoose(a,l);b=h;f=c}return p.jsx(t,babelHelpers["extends"]({contact:b},f))}v.displayName=v.name+" [from "+f.id+"]";function a(a){var b=a.chat,d=a.contact;a=a.xstyle;return p.jsxs("span",babelHelpers["extends"]({},(o||(o=c("stylex"))).props(a),{children:[p.jsx(v,{contact:d,useShortName:Boolean(d.shortName),showNotifyName:!0,elevatedPushNamesEnabled:!0,useLiftMeUp:!0}),p.jsx("span",{children:"\xa0\u2022\xa0"}),b.groupMetadata&&p.jsx(u,{chat:b,groupMetadata:b.groupMetadata})]}))}a.displayName=a.name+" [from "+f.id+"]";g.ContactName=t;g.GroupName=u;g.Name=v;g.ContactAndGroupName=a}),226);
__d("WAWebNotificationTone",["Promise","WAWebNoop","bx"],(function(a,b,c,d,e,f,g){var h,i=new window.Audio(c("bx").getURL(c("bx")("9561")));function a(){i.play()["catch"](c("WAWebNoop"))}function d(a){return(h||(h=b("Promise"))).resolve(a)}g.playNotification=a;g.cachePath=d}),98);
__d("WAWebBaseNotification",["Promise","WAAbortError","WALogger","WAWebBuildConstants","WAWebEnvironment","WAWebMuteCollection","WAWebNotificationBanner","WAWebNotificationConstants","WAWebNotificationTone","asyncToGeneratorRuntime","cr:3133","err"],(function(a,b,c,d,e,f,g){var h,i;e=(a=b("cr:3133"))!=null?a:{};var j=e.shouldShowBanner,k=e.shouldSuppressBanner;f=function(){function a(){var a=this;this.creationAt=Date.now();this.closeBanner=function(){a.notificationBanner!=null&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WABaseNotification:_closeNotification()"]))),a.notificationBanner.close())}}var e=a.prototype;e.shouldPlaySound=function(){return c("WAWebEnvironment").isWindows&&Number(d("WAWebBuildConstants").WINDOWS_BUILD)>=257300?!1:d("WAWebMuteCollection").MuteCollection.getGlobalSounds()};e.shouldMute=function(a){return null};e.shouldShowBanner=function(){return j?j():window.Notification&&window.Notification.permission===d("WAWebNotificationConstants").PERMISSION_ALLOWED&&d("WAWebMuteCollection").MuteCollection.getGlobalNotifications()};e.shouldSquelch=function(){return null};e.shouldSuppressBanner=function(a){return!!k&&k(a)};e.buildKey=function(){throw c("err")("WABaseNotification: must implement `buildKey` method")};e.getBannerOptions=function(){throw c("err")("WABaseNotification: must implement `getBannerOptions` method")};e.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw c("err")("WABaseNotification: must implement `getIcon` method")});function d(){return a.apply(this,arguments)}return d}();e.matchesChat=function(a){return!1};e.beforeBannerShown=function(){return(i||(i=b("Promise"))).resolve()};e.afterBannerShown=function(a){};e.getChatKind=function(){throw c("err")("WABaseNotification: must implement `getChatKind` method")};e.performLogging=function(){};e.isReplyable=function(){return!1};e.triggerNotification=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield this.shouldMute(a));a||(a=(yield this.shouldSquelch()));var b=!1;if(a)if(this.shouldSuppressBanner(a))b=!0;else throw new(d("WAAbortError").AbortError)("Notification mute/squelched "+a);var c;(yield this.shouldShowBanner())&&(yield this.beforeBannerShown(),c=(yield this.showBanner(b)),this.afterBannerShown(c),this.performLogging());!a&&(yield this.shouldPlaySound())&&this.playSound();return c});function c(b){return a.apply(this,arguments)}return c}();e.showBanner=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);this.abortController=new AbortController();var b=this.getBannerOptions(),e=(yield this.getIcon());if(this.abortController.signal.aborted)throw new(d("WAAbortError").AbortError)("Aborted through abortController");if(!c("WAWebEnvironment").isWindows&&window.Notification.permission!==d("WAWebNotificationConstants").PERMISSION_ALLOWED)throw new(d("WAAbortError").AbortError)("Permission Denied");b=new(c("WAWebNotificationBanner"))(babelHelpers["extends"]({},b,{icon:e,key:this.buildKey(),isReplyable:this.isReplyable(),suppressBanner:a}));this.notificationBanner=b;return b});function e(b){return a.apply(this,arguments)}return e}();e.playSound=function(){d("WAWebNotificationTone").playNotification()};return a}();g.WABaseNotification=f}),98);
__d("WAWebBannerContextMenuActions",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["None","MuteChatForEightHours","MuteChatForOneWeek","MuteChat","DisableNotifications"]);c=a;f["default"]=c}),66);
__d("WAWebMuteExpirations",["fbt","WAWeb-moment","WAWebClock"],(function(a,b,c,d,e,f,g,h){var i=[{getLabel:function(){return h._(/*BTDS*/"8 hours")},duration:8,radioId:"8-hours"},{getLabel:function(){return h._(/*BTDS*/"1 week")},duration:7*24,radioId:"1-week"},{getLabel:function(){return h._(/*BTDS*/"Always")},duration:Number.POSITIVE_INFINITY,radioId:"always"}];function a(){return i[0].duration}function b(a){return a===Number.POSITIVE_INFINITY?d("WAWebClock").MUTE_ALWAYS_EXPIRATION_SENTINEL:a*60*60+c("WAWeb-moment")().unix()}g.ALL_MUTE_DURATIONS=i;g.getDefaultMuteDuration=a;g.calculateMuteExpiration=b}),226);
__d("WAWebBaseNotificationBanner",["Promise","WALogger","WATypeUtils","WAWebBannerContextMenuActions","WAWebChatCollection","WAWebChatEntryPoint","WAWebChatMessageSearch","WAWebCmd","WAWebComposeBoxActions","WAWebEnvironment","WAWebGroupType","WAWebL10N","WAWebModalManager","WAWebMsgCollection","WAWebMsgType","WAWebMuteCollection","WAWebMuteExpirations","WAWebNewsletterCollection","WAWebNoop","WAWebSendTextMsgChatAction","WAWebUserPrefsGeneral","asyncToGeneratorRuntime","cr:3133"],(function(a,b,c,d,e,f,g){var h=["title","notification","renotify","footer","isReplyable","contextMenuItems","suppressBanner"],i,j,k,l,m,n;e=(a=b("cr:3133"))!=null?a:{};var o=e.closeMessageNotification,p=e.showMessageNotification;f=function(){function a(a,e,f,g,h){var j=this;this.isReplyable=!1;this.close=function(){j.$3().then(function(){j.notification&&d("WATypeUtils").isFunction(j.notification.close)&&j.notification.close(),o==null||o(j.key,j.tag)})["catch"](c("WAWebNoop"))};this.$4=function(){j.waitingPromise.resolver();window.removeEventListener("beforeunload",j.close);var a=j.notification;a&&(a.removeEventListener("click",j.$5),a.removeEventListener("close",j.$4));j.msg&&j.msg.off("change:type",j.$6)};this.$5=function(){j.$1==null||j.$1();window.focus();var a=j.chat,b=j.msg,e=j.doNotOpenChat==null?!1:j.doNotOpenChat;if(!a)return;if(!e){var f,g;e=b&&b!==a.msgs.last()?d("WAWebChatMessageSearch").getSearchContext(a,b.id):void 0;if(((f=a.groupMetadata)==null?void 0:f.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&(g=a.groupMetadata)!=null&&g.parentGroup&&b!=null&&(b.subtype===d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_PROMOTE||b.subtype===d("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE)){d("WAWebCmd").Cmd.openCommunityHome((f=a.groupMetadata)==null?void 0:f.parentGroup)}else{b=c("WAWebEnvironment").isWindows?d("WAWebCmd").Cmd.openChatFromUnread(a,d("WAWebChatEntryPoint").ChatEntryPoint.Notification):d("WAWebCmd").Cmd.openChatAt({chat:a,msgContext:e,chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Notification});void b.then(function(b){b&&d("WAWebComposeBoxActions").ComposeBoxActions.focus(a)})}}d("WAWebModalManager").ModalManager.closeMedia();void j.increaseNotificationEngagement({isClick:!0});j.close()};this.$6=function(){if(!j.msg||j.msg.type!==d("WAWebMsgType").MSG_TYPE.REVOKED)return;j.close()};this.msg=e!=null?d("WAWebMsgCollection").MsgCollection.get(e):null;this.chat=(e=d("WAWebChatCollection").ChatCollection.get(a))!=null?e:c("WAWebNewsletterCollection").get(a);this.tag=f;this.key=g;this.$1=h.onClick;this.canBlock=h.canBlock;this.doNotOpenChat=h.doNotOpenChat;this.isReplyable=h.isReplyable;e=new(n||(n=b("Promise")))(function(a){j.waitingPromise={resolver:a}});this.waitingPromise.promise=e;try{this.$2(g,f,h)}catch(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to create notification: ",":",""])),a.name,a.message).devConsole(a),this.waitingPromise.resolver()}}var e=a.prototype;e.$3=function(){return(n||(n=b("Promise"))).resolve()};e.waitForClose=function(){return this.waitingPromise.promise};e.detach=function(){this.$4()};e.click=function(){this.$5()};e.quickReply=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this.chat;b&&b.isReadOnly!==!0&&this.isReplyable&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["quickReply inside WAWebBaseNotificationBanner"]))),yield d("WAWebSendTextMsgChatAction").sendTextMsgToChat(b,a));this.$4()});function c(b){return a.apply(this,arguments)}return c}();e.$2=function(a,b,e){var f=e.title,g=e.notification,i=e.renotify,j=e.footer,m=e.isReplyable,n=e.contextMenuItems,o=e.suppressBanner;e=babelHelpers.objectWithoutPropertiesLoose(e,h);e.body&&e.body.charCodeAt(0)>=128&&(e.body=" "+e.body);i=babelHelpers["extends"]({tag:b,renotify:i!=null?i:Boolean(b),dir:"auto",lang:c("WAWebL10N").getNormalizedLocale(),silent:!0},e);if(p)p({key:a,tag:b,title:f,body:i.body,icon:i.icon,footer:j,contextMenuItems:n,isReplyable:m,suppressBanner:o,chat:this.chat});else{this.notification=new g(f,i);(e=this.notification)==null||e.addEventListener("error",function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["native notification error"]))).devConsole(a)});(a=this.notification)==null||a.addEventListener("close",function(a){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["native notification close"]))).devConsole(a)});(b=this.notification)==null||b.addEventListener("click",this.$5);(j=this.notification)==null||j.addEventListener("close",this.$4)}this.msg&&this.msg.on("change:type",this.$6);window.addEventListener("beforeunload",this.close);void this.increaseNotificationEngagement({isShow:!0})};e.contextMenuClick=function(a){var b=this.chat;if(!b)return;switch(a){case c("WAWebBannerContextMenuActions").MuteChatForEightHours:this.$7(b,d("WAWebMuteExpirations").ALL_MUTE_DURATIONS[0].duration);break;case c("WAWebBannerContextMenuActions").MuteChatForOneWeek:this.$7(b,d("WAWebMuteExpirations").ALL_MUTE_DURATIONS[1].duration);break;case c("WAWebBannerContextMenuActions").MuteChat:this.$7(b,d("WAWebMuteExpirations").ALL_MUTE_DURATIONS[2].duration);break;case c("WAWebBannerContextMenuActions").DisableNotifications:d("WAWebMuteCollection").MuteCollection.setGlobalNotifications(!1);break;case c("WAWebBannerContextMenuActions").None:break}this.$4()};e.$7=function(a,b){a.mute.mute({expiration:d("WAWebMuteExpirations").calculateMuteExpiration(b),sendDevice:!0})["catch"](function(a){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mute failed: ",""])),a)})};e.increaseNotificationEngagement=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a===void 0?{}:a;var c=a.isShow;c=c===void 0?!1:c;a=a.isClick;a=a===void 0?!1:a;var e=(yield d("WAWebUserPrefsGeneral").getNotificationEngagement());void d("WAWebUserPrefsGeneral").setNotificationContentEngagement({totalNotifShown:((b=e==null?void 0:e.totalNotifShown)!=null?b:0)+(c?1:0),totalNotifTapToOpen:((b=e==null?void 0:e.totalNotifTapToOpen)!=null?b:0)+(a?1:0)})});function c(b){return a.apply(this,arguments)}return c}();return a}();g["default"]=f}),98);
__d("WAWebCurrencyData",[],(function(a,b,c,d,e,f){a="USD";b=2;c={ADP:0,AFN:0,ALL:0,BHD:3,BIF:0,BYR:0,CLF:4,CLP:0,DJF:0,ESP:0,GNF:0,IQD:0,IRR:0,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MRO:0,OMR:3,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,UGX:0,UYI:0,UYW:4,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0};d={AC:["SHP"],AD:["EUR"],AE:["AED"],AF:["AFN"],AG:["XCD"],AI:["XCD"],AL:["ALL"],AM:["AMD"],AO:["AOA"],AR:["ARS"],AS:["USD"],AT:["EUR"],AU:["AUD"],AW:["AWG"],AX:["EUR"],AZ:["AZN"],BA:["BAM"],BB:["BBD"],BD:["BDT"],BE:["EUR"],BF:["XOF"],BG:["BGN"],BH:["BHD"],BI:["BIF"],BJ:["XOF"],BL:["EUR"],BM:["BMD"],BN:["BND"],BO:["BOB"],BQ:["USD"],BR:["BRL"],BS:["BSD"],BT:["BTN","INR"],BV:["NOK"],BW:["BWP"],BY:["BYN"],BZ:["BZD"],CA:["CAD"],CC:["AUD"],CD:["CDF"],CF:["XAF"],CG:["XAF"],CH:["CHF"],CI:["XOF"],CK:["NZD"],CL:["CLP"],CM:["XAF"],CN:["CNY"],CO:["COP"],CR:["CRC"],CU:["CUP","CUC"],CV:["CVE"],CW:["ANG"],CX:["AUD"],CY:["EUR"],CZ:["CZK"],DE:["EUR"],DG:["USD"],DJ:["DJF"],DK:["DKK"],DM:["XCD"],DO:["DOP"],DZ:["DZD"],EA:["EUR"],EC:["USD"],EE:["EUR"],EG:["EGP"],EH:["MAD"],ER:["ERN"],ES:["EUR"],ET:["ETB"],EU:["EUR"],FI:["EUR"],FJ:["FJD"],FK:["FKP"],FM:["USD"],FO:["DKK"],FR:["EUR"],GA:["XAF"],GB:["GBP"],GD:["XCD"],GE:["GEL"],GF:["EUR"],GG:["GBP"],GH:["GHS"],GI:["GIP"],GL:["DKK"],GM:["GMD"],GN:["GNF"],GP:["EUR"],GQ:["XAF"],GR:["EUR"],GS:["GBP"],GT:["GTQ"],GU:["USD"],GW:["XOF"],GY:["GYD"],HK:["HKD"],HM:["AUD"],HN:["HNL"],HR:["HRK"],HT:["HTG","USD"],HU:["HUF"],IC:["EUR"],ID:["IDR"],IE:["EUR"],IL:["ILS"],IM:["GBP"],IN:["INR"],IO:["USD"],IQ:["IQD"],IR:["IRR"],IS:["ISK"],IT:["EUR"],JE:["GBP"],JM:["JMD"],JO:["JOD"],JP:["JPY"],KE:["KES"],KG:["KGS"],KH:["KHR"],KI:["AUD"],KM:["KMF"],KN:["XCD"],KP:["KPW"],KR:["KRW"],KW:["KWD"],KY:["KYD"],KZ:["KZT"],LA:["LAK"],LB:["LBP"],LC:["XCD"],LI:["CHF"],LK:["LKR"],LR:["LRD"],LS:["ZAR","LSL"],LT:["EUR"],LU:["EUR"],LV:["EUR"],LY:["LYD"],MA:["MAD"],MC:["EUR"],MD:["MDL"],ME:["EUR"],MF:["EUR"],MG:["MGA"],MH:["USD"],MK:["MKD"],ML:["XOF"],MM:["MMK"],MN:["MNT"],MO:["MOP"],MP:["USD"],MQ:["EUR"],MR:["MRU"],MS:["XCD"],MT:["EUR"],MU:["MUR"],MV:["MVR"],MW:["MWK"],MX:["MXN"],MY:["MYR"],MZ:["MZN"],NA:["NAD","ZAR"],NC:["XPF"],NE:["XOF"],NF:["AUD"],NG:["NGN"],NI:["NIO"],NL:["EUR"],NO:["NOK"],NP:["NPR"],NR:["AUD"],NU:["NZD"],NZ:["NZD"],OM:["OMR"],PA:["PAB","USD"],PE:["PEN"],PF:["XPF"],PG:["PGK"],PH:["PHP"],PK:["PKR"],PL:["PLN"],PM:["EUR"],PN:["NZD"],PR:["USD"],PS:["ILS","JOD"],PT:["EUR"],PW:["USD"],PY:["PYG"],QA:["QAR"],RE:["EUR"],RO:["RON"],RS:["RSD"],RU:["RUB"],RW:["RWF"],SA:["SAR"],SB:["SBD"],SC:["SCR"],SD:["SDG"],SE:["SEK"],SG:["SGD"],SH:["SHP"],SI:["EUR"],SJ:["NOK"],SK:["EUR"],SL:["SLL"],SM:["EUR"],SN:["XOF"],SO:["SOS"],SR:["SRD"],SS:["SSP"],ST:["STN"],SV:["USD"],SX:["ANG"],SY:["SYP"],SZ:["SZL"],TA:["GBP"],TC:["USD"],TD:["XAF"],TF:["EUR"],TG:["XOF"],TH:["THB"],TJ:["TJS"],TK:["NZD"],TL:["USD"],TM:["TMT"],TN:["TND"],TO:["TOP"],TR:["TRY"],TT:["TTD"],TV:["AUD"],TW:["TWD"],TZ:["TZS"],UA:["UAH"],UG:["UGX"],UM:["USD"],US:["USD"],UY:["UYU"],UZ:["UZS"],VA:["EUR"],VC:["XCD"],VE:["VES"],VG:["USD"],VI:["USD"],VN:["VND"],VU:["VUV"],WF:["XPF"],WS:["WST"],XK:["EUR"],YE:["YER"],YT:["EUR"],ZA:["ZAR"],ZM:["ZMW"],ZW:["USD"]};f.DEFAULT_CURRENCY=a;f.DEFAULT_DIGITS=b;f.CURRENCY_DIGITS=c;f.REGION_TO_CURRENCY=d}),66);
__d("WAWebCurrencyUtils",["WAWebCurrencyData","WAWebL10N"],(function(a,b,c,d,e,f,g){var h={IDR:"in-ID",MXN:"es-MX",INR:"en-IN"},i=new Set(["DZD","ARS","AUD","BDT","BOB","BRL","GBP","CAD","CLP","CNY","COP","CRC","CZK","DKK","EGP","EUR","GTQ","HNL","HKD","HUF","ISK","INR","IDR","ILS","JPY","KES","KRW","MOP","MYR","MXN","NZD","NIO","NGN","NOK","PKR","PYG","PEN","PHP","PLN","QAR","RON","RUB","SAR","SGD","ZAR","SEK","CHF","TWD","THB","TRY","AED","USD","UYU","VEF","VND"]),j=["es-ES","pt-BR"],k=function(){var a;return[(a=c("WAWebL10N")).getFullLocale(),a.normalizeLocaleToBcp47Compliant(a.getNormalizedLocale()),a.normalizeLocaleToBcp47Compliant(a.getLocale())].filter(Boolean)},l=function(a,b,c,d){d===void 0&&(d=k());var e="symbol";j.includes(Array.isArray(d)?d[0]:d)&&(e="code");return new Intl.NumberFormat(d,babelHelpers["extends"]({style:"currency",currency:a,currencyDisplay:e},c)).format(b)},m=function(a,b,c,d){return l(a,b/1e3,c,d)};function n(a){return new Intl.NumberFormat(a).format(1.1).substring(1,2)}function o(a){return new Intl.NumberFormat(a).format(1e4).substring(2,3)}function p(a,b){b=m(b,0,{},a);return b.replace(/\d+([,.]\d+)?/g,"").trim()}function a(a,b){var c=k(),d=n(c);c=p(c,a);a=m(a,b);b=a.replace(c,"").trim();a=b.indexOf(d);d=a===-1?b:b.substring(0,a);b=a===-1?"":b.substring(a);return{symbol:c,integer:d,decimal:b}}function b(a){return p(h[a],a)}function q(a,b){var c=k();a=p(c,a);var d=o(c);c=n(c);return r(b,a,c,d)}function r(a,b,c,d){a=a.replace(b,"").trim();b=a.split(d).join("");a=parseFloat(b.replace(c,".")||"0");return Math.round(a*1e3)}function e(a,b){if(b==null||b.trim().length===0)return!1;var c=k(),d=o(c),e=n(c);if(b.match("/[^0-9"+d+e+"]/"))return!1;c=p(c,a);var f=q(a,b);a=m(a,f);f=a.replace(c,"").trim();a=f.indexOf(e);c=a===-1?f:f.substring(0,a);d=f.split(d).join("");a=d.indexOf(e);e=a===-1?d:d.substring(0,a);return b===f||b===c||b===d||b===e?!0:!1}function f(a,b,c,e){var f=k(),g=d("WAWebCurrencyData").CURRENCY_DIGITS[a]!==void 0?d("WAWebCurrencyData").CURRENCY_DIGITS[a]:d("WAWebCurrencyData").DEFAULT_DIGITS;a=q(a,b);if(c!=null&&a<c)return!1;if(e!=null&&a>e)return!1;c=b.replace(/\D+$/g,"");e=n(f);return Number.isNaN(a)||c!==b||(b.split(e)[1]||"").length>g?!1:!0}function s(a){a=d("WAWebCurrencyData").REGION_TO_CURRENCY[a.toUpperCase()];return(a==null?void 0:a.length)>0?a[0]:d("WAWebCurrencyData").DEFAULT_CURRENCY}function t(a){return i.has(a)}g.formatAmount=l;g.formatAmount1000=m;g.formatAmount1000ToParts=a;g.formatLocalSymbol=b;g.valueFromString=q;g.parseValueFromString=r;g.validateAmountString=e;g.validatePriceString=f;g.currencyForCountryShortcode=s;g.isSupportedCurrency=t}),98);
__d("WAWebGetInteractiveFooterText",["fbt","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderStatusButton","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var b=d("WAWebOrderStatusButton").getOrderStatusButton(a);if(b!=null){b=b.order;var e=b.tracking;b=b.shipping_method;if(e)return e.courier_name+" \u2022 "+e.tracking_ref;e=c("isStringNullOrEmpty")(b)?h._(/*BTDS*/"Not available"):b;return h._(/*BTDS*/"Shipping method: {shipping_method}",[h._param("shipping_method",e)]).toString()}}return a.footer}g.getInteractiveFooterText=a}),226);
__d("WAWebBizFormatInteractiveMsg",["fbt","WAWebBizOrderDetailsParams","WAWebBrazilPixKeyFormattingUtils","WAWebCurrencyUtils","WAWebGetInteractiveFooterText","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebOrderDetails","WAWebOrderPaymentStatus","WAWebOrderStatus","WAWebOrderStatusButton","WAWebUserPrefsTypes"],(function(a,b,c,d,e,f,g,h){function a(a,b){b=b===void 0?{}:b;b=b.formatAsSearchResult;b=b===void 0?!1:b;if(a.interactiveType===c("WAWebInteractiveMessageType").SHOPS_STOREFRONT){var d;return a.caption||((d=a.interactiveHeader)==null?void 0:d.title)||""}if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){d=m(a);if(d!=null)return d}if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){d=l(a);if(d!=null)return d}if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){d=j(a);if(d!=null)return d}return[(d=a.interactiveHeader)==null?void 0:d.title,b?(d=a.interactiveHeader)==null?void 0:d.subtitle:null,a.caption,a.footer].filter(Boolean).join("\n")}function i(a){switch(a){case d("WAWebOrderStatus").OrderStatus.Pending:return h._(/*BTDS*/"Order pending");case d("WAWebOrderStatus").OrderStatus.Canceled:return h._(/*BTDS*/"Order canceled");case d("WAWebOrderStatus").OrderStatus.PartiallyShipped:return h._(/*BTDS*/"Order partially shipped");case d("WAWebOrderStatus").OrderStatus.Complete:return h._(/*BTDS*/"Order completed \ud83c\udf89");case d("WAWebOrderStatus").OrderStatus.Shipped:return h._(/*BTDS*/"Order shipped");case d("WAWebOrderStatus").OrderStatus.Processing:return h._(/*BTDS*/"Order processing");case d("WAWebOrderStatus").OrderStatus.PaymentRequested:return h._(/*BTDS*/"Payment requested");case d("WAWebOrderStatus").OrderStatus.PreparingToShip:return h._(/*BTDS*/"Order preparing to ship");case d("WAWebOrderStatus").OrderStatus.Delivered:return h._(/*BTDS*/"Order delivered \ud83c\udf89");case d("WAWebOrderStatus").OrderStatus.Confirmed:return h._(/*BTDS*/"Order confirmed");case d("WAWebOrderStatus").OrderStatus.Delayed:return h._(/*BTDS*/"Order delayed");case d("WAWebOrderStatus").OrderStatus.OutForDelivery:return h._(/*BTDS*/"Order out for delivery");case d("WAWebOrderStatus").OrderStatus.Failed:return h._(/*BTDS*/"Order failed");case d("WAWebOrderStatus").OrderStatus.Refunded:return h._(/*BTDS*/"Order refunded")}}function j(a){var b=d("WAWebOrderStatus").getOrderStatusInfo(a);if(b==null)return null;var c=d("WAWebOrderStatusButton").getOrderStatusButton(a);if(c!=null){b=i(b.status).toString();var e=a.caption,f=d("WAWebGetInteractiveFooterText").getInteractiveFooterText(a);c=h._(/*BTDS*/"Order #{order-id}",[h._param("order-id",c.reference_id)]);return[b,c,e,f].filter(Boolean).join("\n")}return k(a)}function k(a){var b=d("WAWebOrderStatus").getOrderStatusInfo(a);if(b==null)return null;if(d("WAWebOrderStatus").hasOrderStatusButton(a)){var c=i(b.status).toString(),e=a.caption;return["*"+c+"*",e].filter(Boolean).join("\n")}return n(a.caption,b.status)}function l(a){a=d("WAWebOrderDetails").getOrderInfo(a);if(a==null)return null;var b=a.items,c=a.totalAmount;a=a.currency;a=d("WAWebCurrencyUtils").formatAmount(a,c);return b.length!==0?b[0].name+" \xb7 "+a:a}function m(a){var b,c,e;a=d("WAWebOrderDetails").getOrderInfo(a);if(a==null)return null;a=a==null?void 0:a.paymentSettings;var f=h._(/*BTDS*/"Pix");a=a==null||(b=a.at(0))==null?void 0:b[d("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE];c=(c=a==null?void 0:a.merchant_name)!=null?c:"";e=(e=a==null?void 0:a.key)!=null?e:"";a=d("WAWebUserPrefsTypes").PixKeyType.cast(a==null?void 0:a.key_type);return c+" \xb7 "+f.toString()+": "+d("WAWebBrazilPixKeyFormattingUtils").getFormattedPixKey(e,a)}function b(a){var b=d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a);return b==null?null:o(a.caption,b==null?void 0:b.paymentStatus).toString()}function e(a){a=d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a);return a==null?null:p(a==null?void 0:a.paymentMethod)}function n(a,b){var c="";switch(b){case d("WAWebOrderStatus").OrderStatus.Pending:c=h._(/*BTDS*/"Status: Pending");break;case d("WAWebOrderStatus").OrderStatus.Canceled:c=h._(/*BTDS*/"Status: Canceled");break;case d("WAWebOrderStatus").OrderStatus.PartiallyShipped:c=h._(/*BTDS*/"Status: Partially shipped");break;case d("WAWebOrderStatus").OrderStatus.Complete:c=h._(/*BTDS*/"Status: Complete");break;case d("WAWebOrderStatus").OrderStatus.Shipped:c=h._(/*BTDS*/"Status: shipped");break;case d("WAWebOrderStatus").OrderStatus.Processing:c=h._(/*BTDS*/"Status: Processing");break;case d("WAWebOrderStatus").OrderStatus.PaymentRequested:c=h._(/*BTDS*/"Status: Payment requested");break;case d("WAWebOrderStatus").OrderStatus.PreparingToShip:c=h._(/*BTDS*/"Status: Preparing to ship");break;case d("WAWebOrderStatus").OrderStatus.Delivered:c=h._(/*BTDS*/"Status: Delivered");break;case d("WAWebOrderStatus").OrderStatus.Confirmed:c=h._(/*BTDS*/"Status: Confirmed");break;case d("WAWebOrderStatus").OrderStatus.Delayed:c=h._(/*BTDS*/"Status: Delayed");break;case d("WAWebOrderStatus").OrderStatus.OutForDelivery:c=h._(/*BTDS*/"Status: Out for delivery");break;case d("WAWebOrderStatus").OrderStatus.Failed:c=h._(/*BTDS*/"Status: Failed");break;case d("WAWebOrderStatus").OrderStatus.Refunded:c=h._(/*BTDS*/"Status: Refunded");break}return a!=null&&a.toLowerCase().includes(c.toString().toLowerCase())?a||"":(c.toString()+"\n"+(a||"")).trim()}function o(a,b){var c="";switch(b){case d("WAWebOrderPaymentStatus").OrderPaymentStatus.Captured:c=h._(/*BTDS*/"Payment: Paid");break;case d("WAWebOrderPaymentStatus").OrderPaymentStatus.Pending:c=h._(/*BTDS*/"Payment: Pending");break;case d("WAWebOrderPaymentStatus").OrderPaymentStatus.Failed:c=h._(/*BTDS*/"Payment: Failed");break}return(c.toString()+"\n"+(a!=null?a:"")).trim()}function p(a){var b="";switch(a){case d("WAWebOrderPaymentStatus").OrderPaymentMethod.PaymentInstruction:b=h._(/*BTDS*/"Paying outside WhatsApp");break;case d("WAWebOrderPaymentStatus").OrderPaymentMethod.Confirm:b=h._(/*BTDS*/"Order confirmed");break}return b.toString()}g.formatInteractive=a;g.getOrderStatusButtonBodyTitle=i;g.formatOrderStatusMessagePreview=j;g.formatOrderStatusMessageBody=k;g.formatOrderDetailsMessagePreview=l;g.formatPaymentInfoMessagePreview=m;g.formatOrderPaymentStatusMessage=b;g.formatOrderPaymentMethodMessage=e;g.appendPrefilledMsg=n;g.appendPrefilledOrderPaymentMsg=o}),226);
__d("WAWebFormatCallLog",["fbt","WAWebMsgGetters"],(function(a,b,c,d,e,f,g,h){function a(a){if(d("WAWebMsgGetters").getIsCallSilenced(a))return h._(/*BTDS*/"Silenced unknown caller");var b=i(a.subtype);if(b!=null)return b;var c=d("WAWebMsgGetters").getCallOutcome(a),e=d("WAWebMsgGetters").getIsAdHocGroupCall(a),f=d("WAWebMsgGetters").getIsMissedCall(a);a=d("WAWebMsgGetters").getIsVideoCall(a);c&&(b=j(e,f,a));return b!=null?b:""}function i(a){switch(a){case"miss":return h._(/*BTDS*/"Missed voice call");case"miss_video":return h._(/*BTDS*/"Missed video call");case"miss_group":case"miss_group_video":return h._(/*BTDS*/"Missed group call")}}function j(a,b,c){if(b)return a?h._(/*BTDS*/"Missed group call"):c?h._(/*BTDS*/"Missed video call"):h._(/*BTDS*/"Missed voice call");return a?h._(/*BTDS*/"Group call"):c?h._(/*BTDS*/"Video call"):h._(/*BTDS*/"Voice call")}g["default"]=a}),226);
__d("WAWebFormatEventDateString",["fbt","WATimeUtils","WAWeb-moment","WAWebClock","WAWebL10N"],(function(a,b,c,d,e,f,g,h){function a(a,b){a=d("WATimeUtils").castToUnixTime(a);var e=c("WAWeb-moment").unix(a);if(b==null||b===0)return i(e,{maybeShowAmPm:!0});b=d("WATimeUtils").castToUnixTime(b);var f=c("WAWeb-moment").unix(b);if(d("WATimeUtils").sameDay(a,b)){a=e.format("a")===f.format("a");return h._(/*BTDS*/"{start-date} - {end-time}",[h._param("start-date",i(e,{maybeShowAmPm:!a})),h._param("end-time",i(f,{maybeShowAmPm:!0,timeOnly:!0,lowercase:!0}))])}return h._(/*BTDS*/"{start-date} - {end-date}",[h._param("start-date",i(e,{maybeShowAmPm:!0})),h._param("end-date",i(f,{maybeShowAmPm:!0,lowercase:!0}))])}function i(a,b){var e=b.maybeShowAmPm&&!d("WAWebClock").Clock.getIs24Hour(),f=d("WATimeUtils").unixTime(),g=d("WATimeUtils").castToUnixTime(a.unix());if(b.timeOnly===!0)return d("WAWebClock").Clock.timestampStr(g);var i="LT";e===!1&&(i="h:mm");e=d("WATimeUtils").sameDay(d("WATimeUtils").castToUnixTime(c("WAWeb-moment")().subtract(1,"day").unix()),g);if(e)return b.lowercase===!0?h._(/*BTDS*/"yesterday, {time}",[h._param("time",a.format(i))]):h._(/*BTDS*/"Yesterday, {time}",[h._param("time",a.format(i))]);e=d("WATimeUtils").sameDay(f,g);if(e)return b.lowercase===!0?h._(/*BTDS*/"today, {time}",[h._param("time",a.format(i))]):h._(/*BTDS*/"Today, {time}",[h._param("time",a.format(i))]);f=d("WATimeUtils").sameDay(d("WATimeUtils").castToUnixTime(c("WAWeb-moment")().add(1,"day").unix()),g);if(f)return b.lowercase===!0?h._(/*BTDS*/"tomorrow, {time}",[h._param("time",a.format(i))]):h._(/*BTDS*/"Tomorrow, {time}",[h._param("time",a.format(i))]);e="ddd, MMM D";g="MMM D, YYYY";c("WAWebL10N").getLanguage()!=="en"&&(e="LL",g="LL");f=a.isSame(c("WAWeb-moment")(),"year");return f?h._(/*BTDS*/"{date}, {time}",[h._param("date",a.format(e)),h._param("time",a.format(i))]):h._(/*BTDS*/"{date}, {time}",[h._param("date",a.format(g)),h._param("time",a.format(i))])}g.getEventDateStringFor=a}),226);
__d("WAWebFormatNfmText",["WAWebBizFormatInteractiveMsg","WAWebInteractiveMessagesNativeFlowName"],(function(a,b,c,d,e,f,g){function h(a){if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){var b=d("WAWebBizFormatInteractiveMsg").formatOrderStatusMessageBody(a);if(b!=null)return b}else if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS){b=d("WAWebBizFormatInteractiveMsg").formatOrderPaymentStatusMessage(a);if(b!=null)return b}else if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD){b=d("WAWebBizFormatInteractiveMsg").formatOrderPaymentMethodMessage(a);if(b!=null)return b}return a.caption||""}function a(a){if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){var b=d("WAWebBizFormatInteractiveMsg").formatOrderDetailsMessagePreview(a);if(b!=null)return b}else if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){b=d("WAWebBizFormatInteractiveMsg").formatPaymentInfoMessagePreview(a);if(b!=null)return b}return h(a)}g.formatNFMText=h;g.formatNFMTextPreview=a}),98);
__d("WAWebFormatOversizedMsg",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a){return h._(/*BTDS*/"This message can't be viewed in WhatsApp Web. View it on your phone instead.")}function b(a){return h._(/*BTDS*/"This message can't be viewed in WhatsApp Web. View it on your phone instead.")}g.formatOversizedMsgText=a;g.formatOversizedMsgNotification=b}),226);
__d("WAWebRichResponseStrings",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";function a(){return h._(/*BTDS*/"This response type isn't supported on this device yet. View the response on your phone.")}g.getWholeRichResponseUnsupportedText=a}),226);
__d("WAWebFormatUnknownMsg",["fbt","WAWebCommonMsgUtils","WAWebMsgGetters","WAWebMsgType","WAWebRichResponseStrings"],(function(a,b,c,d,e,f,g,h){function i(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?h._(/*BTDS*/"You received a channel update on your phone, but your version of WhatsApp Web doesn't support it."):h._(/*BTDS*/"You received a message on your phone, but your version of WhatsApp Web doesn't support it.")}function j(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?h._(/*BTDS*/"You sent a channel update from your phone, but your version of WhatsApp Web doesn't support it"):h._(/*BTDS*/"You sent a message from your phone, but your version of WhatsApp Web doesn't support it.")}function k(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?h._(/*BTDS*/"You received a channel update, but your version of WhatsApp doesn't support it."):h._(/*BTDS*/"You received a message, but your version of WhatsApp doesn't support it.")}function l(a){return d("WAWebMsgGetters").getIsSentByMe(a)?j(a):i(a)}function a(a){if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.REACTION)return d("WAWebMsgGetters").getIsSentByMe(a)?h._(/*BTDS*/"To see reactions, restart WhatsApp on your computer. If you still do not see them, update your app."):h._(/*BTDS*/"You received a reaction. Update your version of WhatsApp to see reactions.");else if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.futureproofSubtype==="message_edit")return d("WAWebMsgGetters").getIsSentByMe(a)?h._(/*BTDS*/"You sent an edited message. You can see it if you're on the latest version of WhatsApp."):h._(/*BTDS*/"You received an edited message. You can see it if you're on the latest version of WhatsApp.");else if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)return d("WAWebMsgGetters").getIsSentByMe(a)?l(a):h._(/*BTDS*/"A message in this chat was kept from disappearing.");else if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE)return d("WAWebMsgGetters").getIsSentByMe(a)?h._(/*BTDS*/"You used pinned messages in this chat. Upgrade to the latest version of WhatsApp on this device to use pinned messages here too."):h._(/*BTDS*/"Pinned messages were used in this chat. Upgrade to the latest version of WhatsApp to see and use pinned messages too.");else if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.ALBUM)return h._(/*BTDS*/"Media files");else if(a.type===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE)return h._(/*BTDS*/"This message can't be shown on WhatsApp Web. Open WhatsApp on your phone to view.");else if(d("WAWebCommonMsgUtils").isRichResponseMsg(a.type))return d("WAWebRichResponseStrings").getWholeRichResponseUnsupportedText();else if(a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.CALL_LOG)return h._(/*BTDS*/"This message can\u2019t be displayed here. Please open WhatsApp on your phone to view the message.");if(d("WAWebMsgGetters").getIsSentByMe(a))return l(a);switch(a.subtype){case"phone":return k(a);case"phone_only_feature":return h._(/*BTDS*/"This message can't be shown on WhatsApp Web. Open WhatsApp on your phone to view.");default:return l(a)}}function b(a){if(a.futureproofType===d("WAWebMsgType").MSG_TYPE.REACTION)return h._(/*BTDS*/"You received a reaction. Update your version of WhatsApp to see reactions.");switch(a.subtype){case"phone":return k(a);case"phone_only_feature":return h._(/*BTDS*/"This message can't be shown on WhatsApp Web. Open WhatsApp on your phone to view.");default:return i(a)}}g.defaultFutureproofMsgText=l;g.formatUnknownMsgText=a;g.formatUnknownMsgNotification=b}),226);
__d("WAWebVcardUtils",["fbt","WATypeUtils","WAWebFbtIntlList","WAWebVcardParsingUtils","err","lodash"],(function(a,b,c,d,e,f,g,h){function a(a){var b;b=(b=a.ORG)==null?void 0:b[0];a=(a=a.TITLE)==null?void 0:a[0];if(b&&Array.isArray(b.value)&&b.value.length>0){var e=null;a!=null&&a.value&&(e=(""+a.value).trim());a=b.value;b=a[0];a=a.slice(1);a.push(b);b=c("WAWebFbtIntlList")(a.map(function(a){return d("WATypeUtils").isString(a)?a.trim():""}).filter(function(a){return a.length}),c("WAWebFbtIntlList").CONJUNCTIONS.NONE,c("WAWebFbtIntlList").DELIMITERS.COMMA).toString();return(e||"")+((a=e)!=null&&a.length&&b.length?" - ":"")+b}return""}function b(a){var b;b=(b={jabber:h._(/*BTDS*/"Jabber"),"skype-username":h._(/*BTDS*/"Skype"),skype:h._(/*BTDS*/"Skype"),msn:h._(/*BTDS*/"Windows Live"),aim:h._(/*BTDS*/"AIM"),yahoo:h._(/*BTDS*/"Yahoo"),icq:h._(/*BTDS*/"ICQ"),"wa-biz-description":h._(/*BTDS*/"Description")},b[d("WAWebVcardParsingUtils").WA_BIZ_NAME]=h._(/*BTDS*/"Business name"),b);b=a.properties["X-ABLabel"]||b[a.type.toLowerCase()];if(b!=null&&b!=="")return d("WAWebVcardParsingUtils").clean(String(b));var e={TEL:[[["cell"],h._(/*BTDS*/"Mobile")],[["iphone"],h._(/*BTDS*/"iPhone")],[["main"],h._(/*BTDS*/"Main")],[["home","fax"],h._(/*BTDS*/"Home fax")],[["work","fax"],h._(/*BTDS*/"Work fax")],[["home"],h._(/*BTDS*/"Home")],[["work"],h._(/*BTDS*/"Work")],[["pager"],h._(/*BTDS*/"Pager")],[[],h._(/*BTDS*/"Home")]],EMAIL:[[["home"],h._(/*BTDS*/"Home")],[["work"],h._(/*BTDS*/"Work")],[["internet"],h._(/*BTDS*/"Email")]],URL:[[["home"],h._(/*BTDS*/"Home")],[["work"],h._(/*BTDS*/"Work")]],ADR:[[["home"],h._(/*BTDS*/"Home")],[["work"],h._(/*BTDS*/"Work")]]};b=a.type;c("lodash").forOwn(e,function(c){if(c){var d=c[0];c=c[1];if(Array.from(new Set(d).difference(new Set((d=(d=a.properties)==null||(d=d.type)==null?void 0:d.map(function(a){return a.toLowerCase()}))!=null?d:[]))).length===0){b=c;return!1}}});return b}function i(a){return j(a.map(function(a){return a.displayName})).toString()}function j(a){var b=a.find(function(a){return!!a});if(!a.length)return h._(/*BTDS*/"No contacts");if(!b)return h._(/*BTDS*/"_j{\"*\":\"{count} contacts\",\"_1\":\"1 contact\"}",[h._plural(a.length,"count")]);return a.length===1?b:h._(/*BTDS*/"_j{\"*\":\"{contactName} and {count} other contacts\",\"_1\":\"{contactName} and 1 other contact\"}",[h._plural(a.length-1,"count"),h._param("contactName",b)])}function e(a){if(a.length===0)throw c("err")("No vcards provided");return a.length===1?a[0]:{displayName:i(a),vcard:a.map(function(a){return a.vcard}).join("\n"),isMultiVcard:!0}}g.vcardGetOrganizationString=a;g.vcardGetType=b;g.getNameString=i;g.getNameStringFromNames=j;g.mergeVcards=e}),226);
__d("WAWebGetNotificationStrings",["fbt","WABidi","WALogger","WAWebAlbumsFormatAlbumMessageText","WAWebBizFormatInteractiveMsg","WAWebClock","WAWebContactCollection","WAWebContactGetters","WAWebCurrencyUtils","WAWebFormatBroadcastNotification","WAWebFormatCallLog","WAWebFormatE2ENotification","WAWebFormatEventDateString","WAWebFormatGroupNotification","WAWebFormatNfmText","WAWebFormatOversizedMsg","WAWebFormatPaymentMsg","WAWebFormatRevokedMsg","WAWebFormatUnknownMsg","WAWebFrontendMsgGetters","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebL10N","WAWebMsgGetters","WAWebMsgType","WAWebUA","WAWebUnformatMsg","WAWebVcardUtils","WAWebWidToFormattedNameOrNumber","cr:4404","fbs"],(function(a,b,c,d,e,f,g,h){var i,j,k;b=(b=b("cr:4404"))!=null?b:{};var l=b.getNotificationBodyForPreviewOff;function a(a){var b=a.shouldShowNotificationPreview(),e=a.safe(),f="";if(l&&!b)return l().toString();switch(e.type){case"chat":b&&(f=c("WAWebUnformatMsg")(a,a.body));break;case"image":var g="";d("WAWebUA").UA.hasEmoji&&(g=e.isViewOnce?"1\ufe0f\u20e3 ":"\ud83d\udcf7 ");f=g+(b&&c("WAWebUnformatMsg")(a,a.caption)||c("fbs")._(/*BTDS*/"Photo").toString());break;case"product":g=d("WAWebUA").UA.hasEmoji?"\ud83d\uded2 ":"";f=g+(d("WAWebFrontendMsgGetters").getText(a)&&c("WAWebUnformatMsg")(a,d("WAWebFrontendMsgGetters").getText(a))||h._(/*BTDS*/"Product").toString());break;case"interactive":if(a.interactiveType===c("WAWebInteractiveMessageType").SHOPS_STOREFRONT){g=d("WAWebUA").UA.hasEmoji?"\ud83d\udecd\ufe0f  ":"";f=g+c("WAWebUnformatMsg")(a,a.body!=null?a.body:(g=a.interactiveHeader)==null?void 0:g.title)||"";break}if(a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){g=a;f=d("WAWebBizFormatInteractiveMsg").formatOrderDetailsMessagePreview(g)||((g=a.caption)!=null?g:"");g=d("WAWebUA").UA.hasEmoji?"\ud83d\udcc3  ":"";f=g+f;break}if(a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){g=a;f=d("WAWebBizFormatInteractiveMsg").formatPaymentInfoMessagePreview(g)||((g=a.caption)!=null?g:"");break}if(a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS){g=a;f=d("WAWebBizFormatInteractiveMsg").formatOrderStatusMessagePreview(g)||((g=a.caption)!=null?g:"");break}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),a.type);return"";case"native_flow":if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS){g=a;var n=d("WAWebUA").UA.hasEmoji?"\ud83d\udcc3  ":"";f=n+(d("WAWebFormatNfmText").formatNFMTextPreview(g)||((n=a.caption)!=null?n:""));break}if(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO){g=a;f=d("WAWebFormatNfmText").formatNFMTextPreview(g)||((n=a.caption)!=null?n:"");break}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),a.type);return"";case"sticker":g=d("WAWebUA").UA.hasEmoji?"\ud83d\udc9f":"";f=h._(/*BTDS*/"{stickerIcon} Sticker",[h._param("stickerIcon",g)]);break;case"video":n="";a.isGif?(n=d("WAWebUA").UA.hasEmoji?"\ud83d\udc7e ":"",g=b&&c("WAWebUnformatMsg")(a,a.caption)||"GIF"):(d("WAWebUA").UA.hasEmoji&&(n=e.isViewOnce?"1\ufe0f\u20e3 ":"\ud83c\udfa5 "),g=b&&c("WAWebUnformatMsg")(a,a.caption)||c("fbs")._(/*BTDS*/"Video").toString(),e.isViewOnce||(g=g+" ("+d("WAWebClock").Clock.durationStr(a.duration)+")"));f=""+n+g;break;case"ptv":n=d("WAWebUA").UA.hasEmoji?"\ud83c\udfa5 ":"";g=b&&c("WAWebUnformatMsg")(a,a.caption)||h._(/*BTDS*/"Video note");g=g.toString()+" ("+d("WAWebClock").Clock.durationStr(a.duration)+")";f=""+n+g;break;case"ptt":n="";g=h._(/*BTDS*/"Voice message").toString();d("WAWebUA").UA.hasEmoji&&(n=e.isViewOnce?"1\ufe0f\u20e3 ":"\ud83c\udfa4 ");e.isViewOnce||(g=g+" ("+d("WAWebClock").Clock.durationStr(a.duration)+")");f=""+n+g;break;case"audio":n=d("WAWebUA").UA.hasEmoji?"\ud83c\udfb5 ":"";f=n+" "+c("fbs")._(/*BTDS*/"Audio").toString()+" ("+d("WAWebClock").Clock.durationStr(a.duration)+")";break;case"location":g=d("WAWebUA").UA.hasEmoji?"\ud83d\udccd ":"";a.isLive?n=b&&c("WAWebUnformatMsg")(a,a.comment)||h._(/*BTDS*/"Live location").toString():n=b&&a.loc||c("fbs")._(/*BTDS*/"Location").toString();f=g+" "+n;break;case"groups_v4_invite":f=h._(/*BTDS*/"WhatsApp group invite");break;case"newsletter_admin_invite":f=h._(/*BTDS*/"WhatsApp channel admin invite");break;case"gp2":f=c("WAWebFormatGroupNotification")(a,!0);break;case"broadcast_notification":f=c("WAWebFormatBroadcastNotification")(a);break;case"notification":f=(g=a.body)!=null?g:"";break;case"vcard":n=d("WAWebUA").UA.hasEmoji?"\ud83d\udc64 ":"";f=n+(a.subtype||c("fbs")._(/*BTDS*/"Contact").toString());break;case"multi_vcard":g=d("WAWebUA").UA.hasEmoji?"\ud83d\udc65 ":"";f=g+d("WAWebVcardUtils").getNameString(a.vcardList).toString();break;case"document":if(a.isVcardOverMmsDocument){n=d("WAWebUA").UA.hasEmoji?"\ud83d\udc64 ":"";f=n+(a.filename||h._(/*BTDS*/"_j{\"*\":\"{count} contacts\",\"_1\":\"1 contact\"}",[h._plural(a.pageCount,"count")]).toString());break}g=d("WAWebUA").UA.hasEmoji?"\ud83d\udcc4 ":"";n=a.caption;(a.caption==null||a.caption==="")&&(n=a.filename);f=g+(b&&c("WAWebUnformatMsg")(a,n)||c("fbs")._(/*BTDS*/"Document").toString());break;case"e2e_notification":f=d("WAWebFormatE2ENotification").formatE2ENotification(e);break;case"call_log":f=c("WAWebFormatCallLog")(a);break;case"ciphertext":f=h._(/*BTDS*/"Waiting for this message. This may take a while.");break;case"revoked":f=d("WAWebFormatRevokedMsg").formatRevokedMsg(e);break;case"payment":f=m(a);break;case"oversized":f=d("WAWebFormatOversizedMsg").formatOversizedMsgNotification(a);break;case"unknown":f=d("WAWebFormatUnknownMsg").formatUnknownMsgNotification(a);break;case"list":f=(((g=a.list)==null?void 0:g.title)||"")+" "+(((b=a.list)==null?void 0:b.description)||"");break;case"list_response":f=(((n=a.listResponse)==null?void 0:n.title)||"")+" "+(((g=a.listResponse)==null?void 0:g.description)||"");break;case"poll_result_snapshot":case"poll_creation":b=d("WAWebUA").UA.hasEmoji?"\ud83d\udcca ":"";f=""+b+c("WAWebUnformatMsg")(a,a.pollName);break;case"event_creation":n=d("WAWebUA").UA.hasEmoji?"\ud83d\udcc6 ":"";b=a.eventStartTime!=null?d("WAWebFormatEventDateString").getEventDateStringFor(a.eventStartTime,(g=a.eventEndTime)!=null?g:void 0):null;f=h._(/*BTDS*/"{eventIcon} Invited you to an event: {eventName} {eventTime}",[h._param("eventIcon",n),h._param("eventName",a.eventName),h._param("eventTime",b)]);break;case"album":g=d("WAWebUA").UA.hasEmoji?"\ud83d\udcf7 ":"";n=c("WAWebAlbumsFormatAlbumMessageText")({msg:a,options:{}});f=h._(/*BTDS*/"{albumIcon}{photoAndVideoCountText}",[h._param("albumIcon",g),h._param("photoAndVideoCountText",n)]);break;case"order":b=d("WAWebUA").UA.hasEmoji?"\ud83d\uded2 ":"";f=h._(/*BTDS*/"_j{\"*\":\"{shoppingCartIcon}{count} items{message}\",\"_1\":\"{shoppingCartIcon}1 item{message}\"}",[h._plural(a.itemCount,"count"),h._param("shoppingCartIcon",b),h._param("message",a.message!=null&&a.message!==""?"\n"+a.message:"")]);break;case"sticker-pack":g=d("WAWebUA").UA.hasEmoji?"\ud83d\udc9f ":"";f=h._(/*BTDS*/"{stickerPackIcon} Sticker Pack",[h._param("stickerPackIcon",g)]);break;case"notification_template":case"protocol":case"hsm":case"template_button_reply":case"debug":case"debug_placeholder":case"interactive_response":case"keep_in_chat":case"request_phone_number":case"automated_greeting_message":case"rich_response":case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:case"message_history_notice":return"";case"quarantined":n=d("WAWebUA").UA.hasEmoji?"\ud83d\udeab ":"";b=a.quarantineExtractedText!=null&&a.quarantineExtractedText!==""?a.quarantineExtractedText:"Attachment blocked by your settings";f=""+n+b;break;default:e.type;d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["getNotificationBody: Unrecognized type ",""])),a.type);return""}return f.toString()}function e(a){var b=a.msgDir,e=c("WAWebL10N").isRTL()?"rtl":"ltr";if(a.body&&a.author==null&&a.action==null)return a.body;var f=a.body,g=a.author;a=a.action;g==null&&(g="");a==null?a="":a=e==="ltr"?c("WAWebL10N").isolateLTR(a):c("WAWebL10N").isolateRTL(a);if(g){var h=d("WABidi").dir(g);if(e==="ltr"&&(!b||b==="ltr")&&(!h||h==="ltr"))return a?g+"\u200e: "+a+"\u200e "+f+"\u200e":g+"\u200e: "+f+"\u200e";else if(e==="ltr"&&(!b||b==="ltr"))return a?"\u200e\u202b"+g+"\u202c: "+a+"\u200e "+f+"\u200e":"\u200e\u202b"+g+"\u202c: "+f+"\u200e";else if(e==="ltr"&&(!h||h==="ltr"))return a?g+"\u200e: "+a+"\u200e \u202b"+f+"\u202c\u200e":g+"\u200e: \u202b"+f+"\u202c\u200e";else if(e==="ltr")return a?"\u202b"+g+"\u200f: "+a+" "+f+"\u200f":"\u202b"+g+"\u200f: "+f+"\u200f";else if((!b||b==="rtl")&&(!h||h==="rtl"))return a?g+"\u200f: "+a+"\u200f "+f+"\u200f":g+"\u200f: "+f+"\u200f";else if(!b||b==="rtl")return a?"\u200f\u202a"+g+"\u202c: "+a+"\u200f "+f+"\u200f":"\u200f\u202a"+g+"\u202c: "+f+"\u200f";else if(!h||h==="rtl")return a?g+"\u200f: "+a+"\u200f \u202a"+f+"\u202c\u200f":g+"\u200f: \u202a"+f+"\u202c\u200f";return a?"\u202a"+g+"\u200e: "+a+" "+f+"\u200e":"\u202a"+g+"\u200e: "+f+"\u200e$"}return a?a+" "+f:f}function m(a){if(a.subtype==="invite")return d("WAWebFormatPaymentMsg").formatPaymentInviteMessageText(a.id);var b=a.paymentCurrency&&a.paymentAmount1000;if(!b)return h._(/*BTDS*/"Payment message \u2022 Amount unavailable");if(a.subtype!=="send"&&a.subtype!=="request")return h._(/*BTDS*/"Payment message. Open WhatsApp on your phone to view.");var e;b=d("WAWebCurrencyUtils").formatAmount1000(a.paymentCurrency,a.paymentAmount1000);var f=c("WAWebWidToFormattedNameOrNumber")(d("WAWebMsgGetters").getSender(a)),g=c("WAWebWidToFormattedNameOrNumber")(a.paymentMessageReceiverJid),i=d("WAWebContactCollection").ContactCollection.get(a.paymentMessageReceiverJid);i=i!=null&&d("WAWebContactGetters").getIsMe(i);var j=a.paymentAmount1000/1e3;a.subtype==="send"?d("WAWebMsgGetters").getIsGroupMsg(a)?e=i?h._(/*BTDS*/"_j{\"*\":\"{senderName} sent {amount} to you\"}",[h._param("amount",b,[0,j]),h._param("senderName",f)]):h._(/*BTDS*/"_j{\"*\":\"{senderName} sent {amount} to {receiverName}\"}",[h._param("amount",b,[0,j]),h._param("senderName",f),h._param("receiverName",g)]):e=h._(/*BTDS*/"_j{\"*\":\"Sent {amount} to you\"}",[h._param("amount",b,[0,j])]):d("WAWebMsgGetters").getIsGroupMsg(a)?e=i?h._(/*BTDS*/"_j{\"*\":\"{senderName} requested {amount} from you\"}",[h._param("amount",b,[0,j]),h._param("senderName",f)]):h._(/*BTDS*/"_j{\"*\":\"{senderName} requested {amount} from {receiverName}\"}",[h._param("amount",b,[0,j]),h._param("senderName",f),h._param("receiverName",g)]):e=h._(/*BTDS*/"_j{\"*\":\"Requested {amount} from you\"}",[h._param("amount",b,[0,j])]);return e}function n(a){a===void 0&&(a=1);return h._(/*BTDS*/"_j{\"*\":\"{newMessageCount} new messages\",\"_1\":\"1 new message\"}",[h._plural(a,"newMessageCount")])}n.displayName=n.name+" [from "+f.id+"]";g.getNotificationMessageBody=a;g.getNotificationBody=e;g.getPluralMessageNotificationBody=n}),226);
__d("WAWebNotificationBackend",["Promise","WAWebAiHandoffNotification","WAWebCommentNotification","WAWebMsgGetters","WAWebNotificationController","WAWebNotificationsDeviceSwitchNotification","WAWebNotificationsMsgNotification","WAWebNotificationsReactionNotification","WAWebNotificationsStatusReactionNotification","WAWebPollsVoteNotification","WAWebStatusGatingUtils","WAWebStatusNotification"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsMsgNotification").WAMsgNotification)({msg:a}))}function c(a){return d("WAWebStatusGatingUtils").isStatusLikesReceiveEnabled()&&d("WAWebMsgGetters").getIsStatus(a)?d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsStatusReactionNotification").WAStatusReactionNotification)({reactionMsg:a})):d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsReactionNotification").WAReactionNotification)({reactionMsg:a}))}function e(a){return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebCommentNotification").WACommentNotification)({commentMsg:a}))}function f(a){return d("WAWebNotificationController").WANotificationController.closeOrCancelNotification("comment:"+a.toString())}function i(a){a=new(d("WAWebPollsVoteNotification").PollVoteNotification)({creationMsg:a});var c=d("WAWebNotificationController").WANotificationController.getNotification(a.buildKey());return c instanceof d("WAWebPollsVoteNotification").PollVoteNotification&&c.bodyText===a.bodyText?(h||(h=b("Promise"))).resolve():d("WAWebNotificationController").WANotificationController.triggerNotification(a)}function j(a){return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebNotificationsDeviceSwitchNotification").WADeviceSwitchNotification)(a))}function k(a){return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebAiHandoffNotification").AiHandoffNotification)({chat:a}))}function l(){d("WAWebNotificationController").WANotificationController.closeOrCancelAllNotifications()}function m(a){d("WAWebNotificationController").WANotificationController.closeOrCancelNotificationsForChat(a)}function n(a){return d("WAWebNotificationController").WANotificationController.triggerNotification(new(d("WAWebStatusNotification").WAStatusNotification)({msg:a}))}function o(a){d("WAWebNotificationController").WANotificationController.setAppContext(a)}g.showMsgNotification=a;g.showReactionNotification=c;g.showCommentNotification=e;g.removeCommentNotification=f;g.showPollVoteNotification=i;g.showDeviceSwitchNotification=j;g.showAiHandoffNotification=k;g.shutdownAsNeeded=l;g.closeNotifications=m;g.showStatusNotification=n;g.setAppContext=o}),98);
__d("WAWebNotificationBanner",["WAWebBaseNotificationBanner","WAWebEmoji","WAWebURLUtils"],(function(a,b,c,d,e,f,g){a=function(a){function b(b){var e=b.wid,f=b.msgId,g=b.tag,h=b.title,i=b.body,j=b.icon,k=b.onClick,l=b.renotify,m=b.doNotOpenChat,n=b.key,o=b.footer,p=b.isReplyable,q=b.contextMenuItems;b=b.suppressBanner;return a.call(this,e,f,g,n,{title:d("WAWebEmoji").EmojiUtil.normalizeAllEmojis(h),notification:window.Notification,body:d("WAWebEmoji").EmojiUtil.normalizeAllEmojis(i),icon:c("WAWebURLUtils").relToAbs(j),onClick:k,renotify:l,doNotOpenChat:m,footer:o,isReplyable:p,contextMenuItems:q,suppressBanner:b})||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebBaseNotificationBanner"));g["default"]=a}),98);
__d("WAWebNotificationController",["WAAbortError","WALogger","WAWebCmd","WAWebEnvironment","WAWebFrontendMsgGetters","WAWebNotificationsMsgNotification","asyncToGeneratorRuntime","cr:4692"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=(a=b("cr:4692"))!=null?a:null;e=function(){function a(){var a=this;this.map=new Map();this.lastMsgNotifByChat=new Map();this.$1=null;this.$2=null;n&&(this.$1=new n(this));c("WAWebEnvironment").isWindows&&d("WAWebCmd").Cmd.on("offline_delivery_end",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: show lastest unread msg due to offline delivery end"]))),a.$3()}))}var e=a.prototype;e.notificationExists=function(a){return this.map.has(a)};e.getNotification=function(a){return this.map.get(a)};e.closeOrCancelNotification=function(a){var b=this.getNotification(a);b&&(b.notificationBanner?b.notificationBanner.close():b.abortController&&b.abortController.abort(),this.$4(a))};e.closeOrCancelAllNotifications=function(){var a=this;this.map.forEach(function(b,c){a.closeOrCancelNotification(c)})};e.closeOrCancelNotificationsForChat=function(a){var b=this;this.map.forEach(function(c,d){c.matchesChat(a)&&b.closeOrCancelNotification(d)})};e.triggerNotification=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=a.buildKey();this.$5(c,a);try{var e,f=(yield a.triggerNotification((e=this.$2)==null?void 0:e.call(this)));if(f!=null){if(d("WAWebNotificationsMsgNotification").shouldReplaceMsgNotificationManually()&&a instanceof d("WAWebNotificationsMsgNotification").WAMsgNotification){var g=d("WAWebFrontendMsgGetters").getChat(a.msg).id.toString(),h=this.lastMsgNotifByChat.get(g);h&&self.setTimeout(function(){return h.close()},2e3);this.lastMsgNotifByChat.set(g,f);f.waitForClose().then(function(){b.lastMsgNotifByChat.get(g)===f&&b.lastMsgNotifByChat["delete"](g)})}f.waitForClose().then(function(){b.$4(c)})}else d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: notification not invoked:"]))).devConsole(a),this.$4(c)}catch(e){d("WAAbortError").catchAbort(function(e){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: notification aborted: ",""])),e).devConsole(a),b.$4(c)})(e)}return a});function c(b){return a.apply(this,arguments)}return c}();e.setAppContext=function(a){this.$2=a};e.$3=function(){var a=null;this.map.forEach(function(b,c){(a==null||b.creationAt>a.creationAt)&&(a=b)});a?void this.triggerNotification(a):d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController: showLastestUnreadMsgNotification: no unread msg notification found"])))};e.$5=function(a,b){this.map.set(a,b)};e.$4=function(a,b){var c=this.getNotification(a);if(c==null){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController:_removeNotificationFromMap cannot find notification in map with key: ",""])),a);return}if(b!=null&&c!==b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["WANotificationController:_removeNotificationFromMap not removing due to strict equality"])));return}this.map["delete"](a)};return a}();f=new e();g.WANotificationController=f}),98);
__d("WAWebNotificationHelpers",["fbt","WANullthrows","WAWebChatCollection","WAWebChatGetters","WAWebCmd","WAWebEnvironment","WAWebFbtCommon","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebMsgGetters","WAWebMuteGetters","WAWebOfflineHandler","WAWebParticipantListUtils","WAWebQuotedMsgModelUtils","WAWebSettingsGetters","WAWebSettingsModel","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","gkx"],(function(a,b,c,d,e,f,g,h){function i(){return document.hasFocus()}function a(){return d("WAWebOfflineHandler").OfflineMessageHandler.isResumeOnSocketDisconnectInProgress()||!d("WAWebCmd").Cmd.isOfflineDeliveryEnd}function b(a,b){b===void 0&&(b=!0);if(!d("WAWebChatGetters").getIsGroup(a))return!1;if(d("WAWebChatGetters").getIsGroup(a)&&a.isReadOnly)return!1;var e=Date.now(),f=a.squelch||0;if(e>f){if(!b)return!1;c("WAWebGroupMetadataCollection").find(a.id).then(function(b){if(b!=null){b=j(a.id,b);a.squelch=Date.now()+b}});return!1}return!0}function j(a,b){a=b.participants.length;return Math.min(120,30+5*a)*1e3}function e(a){return!!((a=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata)!=null&&a.isParentGroup)}function f(a){if(c("gkx")("26258"))return!1;if(!d("WAWebMsgGetters").getIsGroupMsg(a))return!1;if(l(a))return!1;return d("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg()?!0:!1}function k(a){var b=d("WAWebFrontendMsgGetters").getChat(a);if(b==null)return!1;if(!d("WAWebMuteGetters").getIsMuted(b.mute))return!1;if(!d("WAWebChatGetters").getIsGroup(b))return!0;if(l(a)){b=d("WAWebChatCollection").ChatCollection.get(d("WAWebMsgGetters").getSender(a));return b!=null&&d("WAWebMuteGetters").getIsMuted(b.mute)===!0}return!0}function l(a){var b=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();return a.isMentioned(b)||d("WAWebQuotedMsgModelUtils").isQuotedMsg(a,b)}function m(a){var b=d("WAWebFrontendMsgGetters").getChat(a);if(!d("WAWebSettingsGetters").getShowArchiveV2(c("WAWebSettingsModel")))return!1;if(!b.archive)return!1;if(!d("WAWebChatGetters").getIsGroup(b))return!0;if(l(a)){b=d("WAWebChatCollection").ChatCollection.get(d("WAWebMsgGetters").getSender(a));return b!=null&&d("WAWebMuteGetters").getIsMuted(b.mute)===!0}return!0}function n(a){return d("WAWebChatGetters").getIsGroup(a)?h._(/*BTDS*/"WhatsApp group message"):h._(/*BTDS*/"WhatsApp message")}function o(a){var b;if(a.isLocked)return c("WAWebFbtCommon")("WhatsApp").toString();if((b=a.groupMetadata)!=null&&b.isUnnamed)return d("WAWebParticipantListUtils").calculateUnnamedGroupFullParticipantsList(c("WANullthrows")(a.groupMetadata),!0);b=a.msgs.last();if((b==null?void 0:b.subtype)==="sender_invite"){var e=d("WAWebFrontendContactGetters").getFormattedName(a.contact);return b!=null&&b.templateParams&&(b==null?void 0:b.templateParams[0])==="true"?h._(/*BTDS*/"{receiver_name} accepted your invite",[h._param("receiver_name",e)]).toString():h._(/*BTDS*/"{receiver_name} joined WhatsApp",[h._param("receiver_name",e)]).toString()}return d("WAWebFrontendContactGetters").getFormattedName(a.contact)||n(a).toString()}function p(a){return c("WAWebEnvironment").isWindows?i()&&(a==null?void 0:a.isChatsSurfaceActive)===!0:i()}g.appIsActive=i;g.isOfflineResumeInProgress=a;g.shouldSquelch=b;g._calculateTimeoutFromGroupMetadata=j;g.isCommunityHomeAdd=e;g.shouldIgnoreGroupMsg=f;g.isMutedAndNotMentioned=k;g.isMeUserMentionedOrQuoted=l;g.isArchivedAndNotMentioned=m;g.getNotificationTitle=o;g.shouldMuteDueToAppState=p}),226);
__d("WAWebNotificationIconUtils",["WAAbortError","WACustomError","WAFilteredCatch","WALogger","WAPromiseRaceAbort","WAPromiseTimeout","WAWebChatGetters","WAWebNotificationTone","WAWebProfilePicThumbCollection","asyncToGeneratorRuntime","bx"],(function(a,b,c,d,e,f,g){var h,i=(e=c("bx")).getURL(e("11319")),j=e.getURL(e("9555")),k=e.getURL(e("9556")),l=e.getURL(e("11370"));function m(a){return d("WAWebChatGetters").getIsNewsletter(a)?l:d("WAWebChatGetters").getIsGroup(a)?j:k}function a(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return a.isLocked?i:o(a.id,b,c!=null?c:m(a))});return n.apply(this,arguments)}function o(a,b,e){return d("WAPromiseTimeout").promiseTimeout(c("WAPromiseRaceAbort")(d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.find(a),b),1500,"showNotificationTimeout").then(function(a){if(b.aborted)throw new(d("WAAbortError").AbortError)();a=(a=a==null?void 0:a.img)!=null?a:e;return d("WAWebNotificationTone").cachePath(a)})["catch"](d("WAFilteredCatch").filteredCatch(d("WACustomError").TimeoutError,function(b){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["NotificationBackend:IconLoadTimeoutError:",""])),a.toString()).devConsole(b);return d("WAWebNotificationTone").cachePath(e)}))}g.USER_DEFAULT_ICON=k;g.getDefaultChatNotificationIcon=m;g.getChatNotificationIcon=a;g.getNotificationIconByWid=o}),98);
__d("WAWebNotificationsChatAssignmentNotification",["fbt","WANullthrows","WAWebBaseNotification","WAWebChatCollection","WAWebChatGetters","WAWebConnModel","WAWebFrontendChatGetters","WAWebGetNotificationStrings","WAWebMuteGetters","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var e,f=b.chats;b=b.assignmentTimestamps;e=a.call(this)||this;e.$WAWebNotificationsChatAssignmentNotification$p_1=function(){};e.chats=f.map(function(a){return d("WAWebChatCollection").ChatCollection.get(a)}).filter(function(a){return a!=null});e.primaryChat=c("WANullthrows")(e.chats[0]);e.assignmentTimestamps=b;e.businessName=(f=d("WAWebConnModel").Conn.pushname)!=null?f:h._(/*BTDS*/"Admin").toString();return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldMute=function(a){if(d("WAWebNotificationHelpers").shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState;if(this.chats.filter(function(a){return a&&d("WAWebMuteGetters").getIsMuted(a.mute)}).length===this.chats.length)return c("WAWebNotificationMuteReason").MutedChat;if(this.chats.filter(function(a){return a==null?void 0:a.archive}).length===this.chats.length)return c("WAWebNotificationMuteReason").ArchivedChat;return d("WAWebNotificationHelpers").isOfflineResumeInProgress()?c("WAWebNotificationMuteReason").OfflineResumeInProgress:null};f.buildKey=function(){return"chat_assignment:"+this.chats.map(function(a){return a==null?void 0:a.id.toString()}).join("-")+this.assignmentTimestamps};f.matchesChat=function(a){return this.chats.length>1?!1:this.primaryChat.equals(a)};f.getChatKind=function(){return d("WAWebFrontendChatGetters").getKind(this.primaryChat)};f.performLogging=function(){};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getNotificationIconByWid(d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),this.abortController.signal,d("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=d("WAWebGetNotificationStrings").getNotificationBody(babelHelpers["extends"]({},i(this.primaryChat,this.businessName,this.chats.length)));return{wid:this.primaryChat.id,title:this.businessName,body:a,onClick:this.$WAWebNotificationsChatAssignmentNotification$p_1}};return e}(d("WAWebBaseNotification").WABaseNotification);function i(a,b,c){var e;c===1?d("WAWebChatGetters").getIsGroup(a)?e=h._(/*BTDS*/"{businessName} assigned you to chat with the group {chatName}",[h._param("businessName",b),h._param("chatName",a.formattedTitle)]):e=h._(/*BTDS*/"{businessName} assigned you a chat with {chatName}",[h._param("businessName",b),h._param("chatName",a.formattedTitle)]):e=h._(/*BTDS*/"{businessNme} assigned you {numberOfChats}",[h._param("businessNme",b),h._param("numberOfChats",c)]);return{body:e.toString()}}g.WAWebNotificationsChatAssignmentNotification=a}),226);
__d("WAWebNotificationsDeviceSwitchNotification",["fbt","WAWebBaseNotification","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(b){var c,d=b.wid;b=b.otpCode;c=a.call(this)||this;c.wid=d;c.otpCode=b;return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldPlaySound=function(){return a.prototype.shouldPlaySound.call(this)};f.shouldMute=function(a){return d("WAWebNotificationHelpers").appIsActive()?c("WAWebNotificationMuteReason").AppState:null};f.buildKey=function(){return"registration:"+this.wid.toString()};f.getChatKind=function(){return null};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getNotificationIconByWid(this.wid,this.abortController.signal,d("WAWebNotificationIconUtils").USER_DEFAULT_ICON)});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=h._(/*BTDS*/"Do not share it with anyone. Your code is {otpCode}.",[h._param("otpCode",this.otpCode)]).toString(),b=h._(/*BTDS*/"Code for new phone").toString();return{wid:this.wid,title:b,body:a,doNotOpenChat:!0}};return e}(d("WAWebBaseNotification").WABaseNotification);g.WADeviceSwitchNotification=a}),226);
__d("WAWebMediaUtils",["WABinary"],(function(a,b,c,d,e,f,g){function h(a){return btoa(String.fromCharCode.apply(null,d("WABinary").Binary.build(a).readByteArrayView()))}function a(a){return"data:image/jpeg;base64,"+h(a)}g.convertToBase64=h;g.convertToDataURI=a}),98);
__d("WAWebNotificationsMsgNotification",["fbt","WAWebBaseNotification","WAWebBizAiAgentStatusUtils","WAWebBotGating","WAWebBotTypes","WAWebChatThreadLogging","WAWebElevatedPushNamesFlag","WAWebEnvironment","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGetNotificationStrings","WAWebGroupSafetyCheckUtils","WAWebMediaUtils","WAWebMsgGetters","WAWebMsgType","WAWebNotificationController","WAWebNotificationEngagementWamEvent","WAWebNotificationHelpers","WAWebNotificationIconUtils","WAWebNotificationMuteReason","WAWebUA","WAWebViewMode.flow","WAWebViewModeUtils","asyncToGeneratorRuntime","cr:3133","cr:4404","gkx"],(function(a,b,c,d,e,f,g,h){e=(a=b("cr:3133"))!=null?a:{};var i=e.shouldIgnoreSquelchForGroupMention,j=e.isReplyable,k=e.getContextMenuItems;a=(f=b("cr:4404"))!=null?f:{};var l=a.getMessageNotificationFooter,m=a.getNotificationBodyForPreviewOff,n=new Set([d("WAWebMsgType").MSG_TYPE.ALBUM]);e=function(a){function e(b){var c;b=b.msg;c=a.call(this)||this;c.msg=b;return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.shouldPlaySound=function(){return a.prototype.shouldPlaySound.call(this)&&!d("WAWebMsgGetters").getIsEdited(this.msg)};f.shouldMute=function(a){if(c("WAWebEnvironment").isWindows&&this.msg.viewed)return c("WAWebNotificationMuteReason").IgnoreViewedMsgs;var b=d("WAWebFrontendMsgGetters").getChat(this.msg);if(d("WAWebNotificationHelpers").shouldMuteDueToAppState(a))return c("WAWebNotificationMuteReason").AppState;if(d("WAWebGroupSafetyCheckUtils").shouldMuteMentionWhileGroupSafetyChecked(this.msg))return c("WAWebNotificationMuteReason").GroupSafetyCheck;if(d("WAWebNotificationHelpers").isMutedAndNotMentioned(this.msg))return c("WAWebNotificationMuteReason").MutedChat;if(d("WAWebNotificationHelpers").isArchivedAndNotMentioned(this.msg))return c("WAWebNotificationMuteReason").ArchivedChat;if(d("WAWebNotificationHelpers").isCommunityHomeAdd(this.msg))return c("WAWebNotificationMuteReason").IgnoreAddedToCommunityHome;if(!c("gkx")("26258")&&d("WAWebNotificationHelpers").shouldIgnoreGroupMsg(this.msg))return c("WAWebNotificationMuteReason").IgnoreGroupMsg;if(d("WAWebMsgGetters").getIsFutureproof(this.msg))return c("WAWebNotificationMuteReason").IgnoreFutureProof;if(d("WAWebNotificationHelpers").isOfflineResumeInProgress())return c("WAWebNotificationMuteReason").OfflineResumeInProgress;if(d("WAWebMsgGetters").getIsBizContentPlaceholder(this.msg))return c("WAWebNotificationMuteReason").IgnoreBizContentPlaceholder;if(d("WAWebMsgGetters").getIsCallSilenced(this.msg))return c("WAWebNotificationMuteReason").IgnoreCallMsgs;if(b.id.isBot()&&(!d("WAWebBotGating").isBotEnabled()||this.msg.botMsgBodyType===d("WAWebBotTypes").BotMsgBodyType.VOICE))return c("WAWebNotificationMuteReason").IgnoreBotMsgs;if(o(this.msg))return c("WAWebNotificationMuteReason").IgnoreInternalSilentTag;if(!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.NOTIFICATION,this.msg.viewMode))return c("WAWebNotificationMuteReason").IgnoreHiddenViewModeMsgs;return d("WAWebBizAiAgentStatusUtils").shouldMuteNotification(b)?c("WAWebNotificationMuteReason").AIRepliesOn:null};f.shouldSquelch=function(){var a=d("WAWebNotificationController").WANotificationController.notificationExists(this.buildKey());if(a&&(d("WAWebMsgGetters").getIsEdited(this.msg)||n.has(this.msg.type)))return null;return i!=null&&i(this.msg)?null:d("WAWebNotificationHelpers").shouldSquelch(d("WAWebFrontendMsgGetters").getChat(this.msg))?c("WAWebNotificationMuteReason").GroupFlood:null};f.buildKey=function(){var a;return"msg:"+((a=(a=this.msg.latestEditMsgKey)==null?void 0:a.toString())!=null?a:this.msg.id.toString())};f.matchesChat=function(a){return a.equals(d("WAWebFrontendMsgGetters").getMaybeChat(this.msg))};f.getChatKind=function(){return d("WAWebFrontendChatGetters").getKind(d("WAWebFrontendMsgGetters").getChat(this.msg))};f.getDefaultIcon=function(){return d("WAWebMsgGetters").getIsProductListMessage(this.msg)?d("WAWebMediaUtils").convertToDataURI(d("WAWebMsgGetters").getProductListHeaderImage(this.msg)):d("WAWebNotificationIconUtils").getDefaultChatNotificationIcon(d("WAWebFrontendMsgGetters").getChat(this.msg))};f.getIcon=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebNotificationIconUtils").getChatNotificationIcon(d("WAWebFrontendMsgGetters").getChat(this.msg),this.abortController.signal,this.getDefaultIcon())});function c(){return a.apply(this,arguments)}return c}();f.getBannerOptions=function(){var a=this.msg,e=p(a);a=d("WAWebGetNotificationStrings").getNotificationBody(babelHelpers["extends"]({},e,{msgDir:d("WAWebFrontendMsgGetters").getDir(a)}));var f=d("WAWebFrontendMsgGetters").getChat(this.msg),g=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebChatThreadLogging").getChatThreadID(f.id.toJid()));new(d("WAWebNotificationEngagementWamEvent").NotificationEngagementWamEvent)({threadId:a}).commit()});return function(){return a.apply(this,arguments)}}();return{wid:f.id,msgId:this.msg.id.toString(),tag:q()?this.msg.id.toString():f.id.toString(),title:d("WAWebNotificationHelpers").getNotificationTitle(f),body:a,onClick:function(){c("gkx")("26258")||g()},renotify:!d("WAWebMsgGetters").getIsEdited(this.msg),footer:e.footer,contextMenuItems:this.getContextMenuItems()}};f.isReplyable=function(){var a;return(a=j==null?void 0:j(this.msg))!=null?a:!1};f.getContextMenuItems=function(){var a;return(a=k==null?void 0:k(this.msg))!=null?a:[]};return e}(d("WAWebBaseNotification").WABaseNotification);function o(a){return!c("gkx")("26258")&&((a=a.body)==null||(a=a.toLowerCase())==null?void 0:a.includes("@silent"))===!0}function p(a){var b=null,c=d("WAWebFrontendMsgGetters").getChat(a),e=d("WAWebElevatedPushNamesFlag").elevatedPushNamesM2Enabled(c);e=d("WAWebMsgGetters").getIsGroupMsg(a)||d("WAWebMsgGetters").getIsMetaBotInvokeResponse(a)?a.displayName({withPushName:e,withPushNameOnly:e,newPushNameFormatting:e,showVerifiedName:e}):void 0;if(c.isLocked)return{body:d("WAWebGetNotificationStrings").getPluralMessageNotificationBody(c.unreadCount).toString()};else if(a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&!a.shouldShowNotificationPreview()){var f;f=(f=m==null?void 0:m())!=null?f:null;f!=null?b=f:d("WAWebMsgGetters").getIsGroupMsg(a)?e!=null?(b=h._(/*BTDS*/"Message from {name}",[h._param("name",e)]),e=void 0):b=h._(/*BTDS*/"New message"):b=d("WAWebGetNotificationStrings").getPluralMessageNotificationBody(c.unreadCount)}else a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="sender_invite"?a.templateParams&&a.templateParams[0]==="true"?b=h._(/*BTDS*/"Say hello on WhatsApp!"):b=h._(/*BTDS*/"Say hello!"):b=d("WAWebGetNotificationStrings").getNotificationMessageBody(a);a=(f=l==null?void 0:l(c.unreadCount))!=null?f:null;return babelHelpers["extends"]({body:b.toString(),author:e},a!=null&&{footer:a.toString()})}function q(){return d("WAWebUA").UA.isBlink&&d("WAWebUA").UA.os===d("WAWebUA").OS_TYPE.MAC}g.eligibleMessagesForNotificationRetriggering=n;g.WAMsgNotification=e;g.getNotificationParts=p;g.shouldReplaceMsgNotificationManually=q}),226);
__d("WAWebStateConcern",["WALogger","WAWebBaseMirror","WAWebBaseModel","WAWebCollections","WAWebProxyStateFactory","WAWebStreamModel"],(function(a,b,c,d,e,f,g){var h,i,j,k;b("WAWebCollections");function l(a){if(typeof a==="string")return a;return a.toString?a.toString():"Invalid Object"}function m(a,b,c,e){var f={$ProxyState$ComponentName:{value:a},proxyBitMask:{value:d("WAWebBaseMirror").genBitMask(b.prototype.mirrorMask,c)}},g=function(b){var c={};c.enumerable=!0;c.get=function(){return this.$ProxyState$state.get(b)};c.set=function(){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(['READ ONLY: Cannot write to proxied property "','", created in <'," />, it is not writable."])),b,a)};e||(c.set=function(a){this.$ProxyState$state.set(b,a)});f[b]=c};for(c of c)g(c);function i(a){b.call(this,a)}i.prototype=Object.create(b.prototype,f);i.prototype.constructor=i;return i}a=function(){function a(a,b,c,e,f){f===void 0&&(f=!1);this.componentName=a;this.name=b;this.$1=e;this.keys=c;e=d("WAWebProxyStateFactory").ProxyStates[b];e||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(['Unknown StateHOC concern type "','"'])),b).sendLogs("state-hoc-error");this.$2=e;this.$3=m(a,e,c,f)}var b=a.prototype;b.getModel=function(a){return a instanceof this.$2?a.$ProxyState$state:a};b.getModelAndValidate=function(a){a=a instanceof this.$2?a.$ProxyState$state:a;if(!a){d("WAWebStreamModel").Stream.mode===d("WAWebStreamModel").StreamMode.MAIN&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," was not supplied the "," model with keys ","."])),this.componentName,this.name,String(this.keys)).sendLogs("state-hoc-error");return null}if(!(a instanceof d("WAWebBaseModel").BaseModel)){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," given invalid object for ",": ",""])),this.componentName,this.name,l(a)).sendLogs("state-hoc-error");return null}return a};b.createProxy=function(a){return new this.$3(a)};b.attachConcern=function(a,b,c){a.incObservers(!this.$1),a.mirror.addListener(c,b,this)};b.detachConcern=function(a,b){a.decObservers(),a.mirror.removeListener(b)};return a}();g["default"]=a}),98);
__d("WAWebCxtUrl",["WAWebL10N"],(function(a,b,c,d,e,f,g){var h="https://faq.whatsapp.com";function i(a){return h+"/cxt/?entrypointid="+a+"&platform=web&lang="+c("WAWebL10N").getNormalizedLocale()}function a(){return i("invite-via-link-unavailable")}function b(){return i("community-no-longer-available")}g.getGroupInviteGrowthLockedFaqUrl=a;g.getCommunityNotAvailableFaqUrl=b}),98);
__d("WAWebSuspendedCommunityModalLoadable",["fbt","JSResourceForInteraction","WAWebLazyLoadedRetriable","WAWebLoadingConfirmPopup.react","asyncToGeneratorRuntime","react","react-loadable"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");a=c("WAWebLazyLoadedRetriable")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("WAWebSuspendedCommunityModal.react").__setRef("WAWebSuspendedCommunityModalLoadable").load());return a.SuspendedCommunityModal}),"SuspendedCommunityModal");d=c("react-loadable")({loader:a,loading:function(a){return j.jsx(c("WAWebLoadingConfirmPopup.react"),{title:h._(/*BTDS*/"This community is no longer available"),error:Boolean(a.error)})}});g.SuspendedCommunityModalLoadable=d}),226);
__d("WAWebSuspendedCommunityUtils",["fbt","WAWebChatCollection","WAWebConfirmPopup.react","WAWebCxtUrl","WAWebExternalLink.react","WAWebModalManager","WAWebSuspendedCommunityModalLoadable","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");e="community-suspend-appeal";function a(){d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){d("WAWebModalManager").ModalManager.close()},onCancel:function(){d("WAWebModalManager").ModalManager.close(),d("WAWebExternalLink.react").openExternalLink(d("WAWebCxtUrl").getCommunityNotAvailableFaqUrl())},okText:h._(/*BTDS*/"Dismiss"),cancelText:h._(/*BTDS*/"Learn more"),title:h._(/*BTDS*/"This community is no longer available.")}),{transition:"modal-flow"})}function b(a){a=(a=a.groupMetadata)==null?void 0:a.parentGroup;if(a==null)return;a=d("WAWebChatCollection").ChatCollection.get(a);if(a==null)return;d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebSuspendedCommunityModalLoadable").SuspendedCommunityModalLoadable,{community:a}),{transition:"modal-flow"})}g.SUSPENDED_COMMUNITY_SUPPORT_TAG=e;g.openTerminatedCommunityModal=a;g.openSuspendedCommunityModal=b}),226);
__d("WAWebGetThreadType",["WAWebChatGetters","WAWebGroupType","WAWebWamEnumThreadType"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebChatGetters").getIsBroadcast(a))return d("WAWebWamEnumThreadType").THREAD_TYPE.BROADCAST;else if(d("WAWebChatGetters").getIsNewsletter(a))return d("WAWebWamEnumThreadType").THREAD_TYPE.CHANNEL;a=a==null?void 0:a.groupMetadata;if(!a)return d("WAWebWamEnumThreadType").THREAD_TYPE.INDIVIDUAL;switch(a.groupType){case d("WAWebGroupType").GroupType.COMMUNITY:return d("WAWebWamEnumThreadType").THREAD_TYPE.PARENT_GROUP;case d("WAWebGroupType").GroupType.DEFAULT:return d("WAWebWamEnumThreadType").THREAD_TYPE.GROUP;case d("WAWebGroupType").GroupType.LINKED_SUBGROUP:return d("WAWebWamEnumThreadType").THREAD_TYPE.SUB_GROUP;case d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP:return d("WAWebWamEnumThreadType").THREAD_TYPE.DEFAULT_SUB_GROUP;case d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP:return d("WAWebWamEnumThreadType").THREAD_TYPE.SUB_GROUP}}g.getThreadType=a}),98);
__d("WAWebWamEnumUserRoleType",[],(function(a,b,c,d,e,f){a=Object.freeze({MEMBER:0,ADMIN:1,CADMIN:2});f.USER_ROLE_TYPE=a}),66);
__d("WAWebGetUserRole",["WAWebWamEnumUserRoleType"],(function(a,b,c,d,e,f,g){function a(a){a=a==null?void 0:a.groupMetadata;if(a==null)return null;var b=a.participants.iAmAdmin();a=b&&a.isParentGroup;if(a===!0)return d("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.CADMIN;else if(b===!0)return d("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.ADMIN;return d("WAWebWamEnumUserRoleType").USER_ROLE_TYPE.MEMBER}g.getUserRole=a}),98);
__d("WAWebGroupJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","WAWebWamEnumThreadType","WAWebWamEnumTsSurface","WAWebWamEnumUserRoleType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({GroupJourney:[4512,{actionType:[1,d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES],appSessionId:[2,d("WAWebWamCodegenUtils").TYPES.STRING],groupSize:[3,d("WAWebWamCodegenUtils").TYPES.INTEGER],surface:[4,d("WAWebWamEnumSurfaceType").SURFACE_TYPE],threadType:[5,d("WAWebWamEnumThreadType").THREAD_TYPE],uiSurface:[7,d("WAWebWamEnumTsSurface").TS_SURFACE],userRole:[6,d("WAWebWamEnumUserRoleType").USER_ROLE_TYPE]},[1,1,1],"regular"]},{GroupJourney:[]});g.GroupJourneyWamEvent=a}),98);
__d("WAWebCommunityGroupJourneyEventImpl",["WALogger","WAWebGetSharedSessionId","WAWebGetThreadType","WAWebGetUserRole","WAWebGroupJourneyWamEvent","WAWebWamEnumSurfaceType"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(a){var b=a.action,c=a.surface;a=a.chat;this.action=b;this.surface=c;this.chat=a;this.sessionId=d("WAWebGetSharedSessionId").getSharedSessionId()}a.inviteModalSourceToSurface=function(a){switch(a){case"community_home":return d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_HOME;case"community_nav":return d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV;case"subgroup_switcher":return d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV_SHEET;case"invite_link":return d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT;case"group_mention":return d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT;case"other":d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["No relevant communtiy journey log for this invite modal"])));return null}};var b=a.prototype;b.shouldLogThreadType=function(){switch(this.surface){case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHATLIST:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_HOME:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_TAB:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_NAV_SHEET:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.COMMUNITY_SETTINGS:case d("WAWebWamEnumSurfaceType").SURFACE_TYPE.GROUP_INFO:return!0;default:return!1}};b.getThreadType=function(){var a;return!this.shouldLogThreadType()||((a=this.chat)==null?void 0:a.groupMetadata)==null?null:d("WAWebGetThreadType").getThreadType(this.chat)};b.getGroupSize=function(){var a;a=(a=this.chat)==null?void 0:a.groupMetadata;return a==null?0:(a=a.participants.length)!=null?a:0};b.getUserRole=function(){return d("WAWebGetUserRole").getUserRole(this.chat)};b.commit=function(){var a=new(d("WAWebGroupJourneyWamEvent").GroupJourneyWamEvent)({actionType:this.action,appSessionId:this.sessionId,surface:this.surface,groupSize:this.getGroupSize()}),b=this.getThreadType();b!=null&&(a.threadType=b);b=this.getUserRole();b!=null&&(a.userRole=b);a.commit()};return a}();g.CommunityGroupJourneyEvent=a}),98);
__d("WAWebMessageCommunityCard.react",["WAWebArrowForwardIcon.react","WAWebChatCollection","WAWebChatGroupUtils","WAWebCmd","WAWebCommunityGeneralChatImage.react","WAWebCommunityGroupJourneyEventImpl","WAWebCommunitySquircleIcon.react","WAWebDetailImage.react","WAWebDrawerManager","WAWebFlex.react","WAWebGroupMetadataCollection","WAWebText_DONOTUSE.react","WAWebUISpacing","WAWebUnstyledButton.react","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","WAWebWid","WAWebWidFactory","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={communitySquircle:{color:"x17k9de1",$$css:!0},footerButton:{color:"xo1mcw5",display:"x78zum5",justifyContent:"xl56j7k",borderTopWidth:"x178xt8z",borderTopStyle:"x13fuv20",borderTopColor:"xx42vgk",width:"xh8yej3",$$css:!0},list:{textAlign:"x1yc453h",position:"x1n2onr6",$$css:!0}};function a(a){var b=a.title,e=a.subtitle,f=a.body,g=a.footer,h=a.subgroupId,l=a.openNavigation,m=l===void 0?!1:l,n=a.onFooterClick,o=null;a.communityId&&(o=a.communityId instanceof c("WAWebWid")?a.communityId:d("WAWebWidFactory").createWid(a.communityId));var p=h?d("WAWebChatCollection").ChatCollection.get(h):null;a=p?Boolean(d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(p)||((l=p.groupMetadata)==null?void 0:l.isParentGroup)):!1;l=p?d("WAWebChatGroupUtils").isCommunityGeneralGroup(p):!1;var q=function(a){var b;if(!o||!((b=c("WAWebGroupMetadataCollection").get(o))!=null&&b.hasJoined()))return;p&&new(d("WAWebCommunityGroupJourneyEventImpl").CommunityGroupJourneyEvent)({action:d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.COMMUNITY_RICH_SYSTEM_MESSAGE_CLICK,surface:d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:p}).commit();a&&(a.preventDefault(),a.stopPropagation());if(n)return n();if(!m){d("WAWebDrawerManager").DrawerManager.existsDrawerRight(function(a){!a&&o&&d("WAWebCmd").Cmd.openCommunityTabbedInfo(o)});return}d("WAWebCmd").Cmd.openCommunityHome(o)},r;l||(o?r=j.jsx(d("WAWebDetailImage.react").DetailImage,{id:o,shape:d("WAWebDetailImage.react").DetailImageShape.Squircle}):r=j.jsx(d("WAWebCommunitySquircleIcon.react").CommunitySquircleIcon,{width:49,height:49,iconXstyle:k.communitySquircle}));var s;l?s=j.jsx("div",{className:"x1c9tyrk xeusxvb x1pahc9y x1ertn4p xpyat2d x1exxlbk x1n2onr6",children:j.jsx(d("WAWebCommunityGeneralChatImage.react").CommunityGeneralChatImage,{})}):h&&!a&&(s=j.jsxs(j.Fragment,{children:[j.jsx(d("WAWebDetailImage.react").DetailImage,{id:h,xstyle:d("WAWebUISpacing").uiMargin.end8}),j.jsx(d("WAWebArrowForwardIcon.react").ArrowForwardIcon,{directional:!0,xstyle:d("WAWebUISpacing").uiMargin.end8})]}));l=j.jsxs(d("WAWebFlex.react").FlexRow,{justify:"center",align:"center",children:[s,r]});a=j.jsxs("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(d("WAWebUISpacing").uiMargin.top8,d("WAWebUISpacing").uiMargin.bottom12),{children:[j.jsx(d("WAWebText_DONOTUSE.react").TextHeader,{color:"primary",weight:"medium",level:"3",children:b}),e!=null?j.jsx(d("WAWebText_DONOTUSE.react").Text,{as:"p",size:"13",children:e}):null]}));h=g!=null?j.jsx(c("WAWebUnstyledButton.react"),{xstyle:[k.footerButton,d("WAWebUISpacing").uiPadding.all12],onClick:q,children:j.jsx(d("WAWebText_DONOTUSE.react").Text,{as:"span",size:"14",weight:"medium",children:g})}):null;return j.jsxs(j.Fragment,{children:[j.jsxs("div",babelHelpers["extends"]({},i.props(d("WAWebUISpacing").uiPadding.horiz24,d("WAWebUISpacing").uiPadding.top12,f&&d("WAWebUISpacing").uiPadding.bottom16),{children:[l,a,f]})),h]})}a.displayName=a.name+" [from "+f.id+"]";function b(a){a=a.items;return j.jsx("ul",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(k.list,d("WAWebUISpacing").uiMargin.start24),{children:a.map(function(a,b){return j.jsx("li",{className:"xo7wnuk x1a8jhtq x1hmns74",children:a},b)})}))}b.displayName=b.name+" [from "+f.id+"]";g.MessageCommunityCard=a;g.BulletedList=b}),98);
__d("WAWebMessageCommunityLinkGroup.react",["fbt","WAWebFormatParticipantNames","WAWebGroupMetadataCollection","WAWebMessageCommunityCard.react","WAWebUserPrefsMeUser","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b,e,f=a.templateParams,g=a.clickable,i=a.author;a=a.chat;var l=f[0],m=c("WAWebGroupMetadataCollection").get(l);m=m==null?void 0:m.participants.iAmAdmin();b=(b=a.groupMetadata)==null?void 0:b.membershipApprovalMode;e=(e=a.groupMetadata)==null?void 0:e.hiddenSubgroup;e===!0?e=h._(/*BTDS*/"Only people in the community who have been invited can see and join this group."):b===!0?e=h._(/*BTDS*/"Anyone in the community can request to join this group."):e=h._(/*BTDS*/"Anyone in the community can join this group.");b=[h._(/*BTDS*/"As a member, you can join groups in the community and get admin announcements."),e,h._(/*BTDS*/"Your profile is visible to admins.")];e=[h._(/*BTDS*/"Members in this group are now community members."),e];var n=m===!0?h._(/*BTDS*/"Manage the community"):h._(/*BTDS*/"Explore the community");return j.jsx(d("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:l,subgroupId:a.id,title:k({templateParams:f,clickable:g,author:i}),body:j.jsx(d("WAWebMessageCommunityCard.react").BulletedList,{items:m===!0?e:b}),footer:n,openNavigation:!m})}a.displayName=a.name+" [from "+f.id+"]";function k(a){var b=a.templateParams,c=a.clickable;a=a.author;var e=a?d("WAWebFormatParticipantNames").getFormattedName(a,c):null;c=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:b[0],asString:!c,alternativeStringName:b[1]});b=Boolean(!c);a=d("WAWebUserPrefsMeUser").isMeAccount(a);if(!b)return a?h._(/*BTDS*/"You added this group to the community: {community}",[h._param("community",c)]):e!=null?h._(/*BTDS*/"{author} added this group to the community: {community}",[h._param("author",e),h._param("community",c)]):h._(/*BTDS*/"This group was added to the community: {community}",[h._param("community",c)]);return a?h._(/*BTDS*/"You added this group to a community"):e!=null?h._(/*BTDS*/"{author} added this group to a community",[h._param("author",e)]):h._(/*BTDS*/"This group was added to a community")}g.MessageCommunityLinkGroup=a;g.communityLinkGroupTitle=k}),226);
__d("WAWebMessageCommunitySubgroupWelcome.react",["fbt","WAWebFormatParticipantNames","WAWebMessageCommunityCard.react","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b=a.templateParams,c=a.clickable,e=a.author;a=a.chat;var f=b[0],g=[h._(/*BTDS*/"As a member, you can join groups in the community and get admin announcements."),h._(/*BTDS*/"Your profile is visible to admins.")],i=h._(/*BTDS*/"Explore the community");return j.jsx(d("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:f,subgroupId:a.id,title:k({templateParams:b,clickable:c,author:e}),body:j.jsx(d("WAWebMessageCommunityCard.react").BulletedList,{items:g}),footer:i,openNavigation:!0})}a.displayName=a.name+" [from "+f.id+"]";function k(a){var b=a.templateParams,c=a.clickable;a=a.author;a=a?d("WAWebFormatParticipantNames").getFormattedName(a,c):null;c=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:b[0],asString:!c,alternativeStringName:b[1]});b=Boolean(!c);return!b?a!=null?h._(/*BTDS*/"{user_name} added you to a group in the community: {community}",[h._param("user_name",a),h._param("community",c)]):h._(/*BTDS*/"You joined a group via invite in the community: {community}",[h._param("community",c)]):a!=null?h._(/*BTDS*/"{user_name} added you to a group in a community",[h._param("user_name",a)]):h._(/*BTDS*/"You joined a group via invite in a community")}g.MessageCommunitySubgroupWelcome=a;g.communitySubgroupWelcomeTitle=k}),226);
__d("WAWebMessageCommunityWelcomeAdmin.react",["fbt","WAWebFormatLinkNotification","WAWebGroupMetadataCollection","WAWebMessageCommunityCard.react","WAWebUISpacing","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","isStringNullOrEmpty","react","stylex"],(function(a,b,c,d,e,f,g,h){var i,j,k=i||c("react");function a(a){var b=a.templateParams,e=a.chat;a=a.author;var f=b.length>0?b[0]:null,g;f instanceof c("WAWebWid")?g=f:c("isStringNullOrEmpty")(f)||(g=d("WAWebWidFactory").createWid(f));f=g!=null?c("WAWebGroupMetadataCollection").get(g):null;f!=null&&f.parentGroup&&(g=f.parentGroup);f=d("WAWebUserPrefsMeUser").isMeAccount((f=e.groupMetadata)==null?void 0:f.owner);if(!f)return k.jsx("div",babelHelpers["extends"]({},(j||(j=c("stylex"))).props(d("WAWebUISpacing").uiPadding.horiz12,d("WAWebUISpacing").uiPadding.top5,d("WAWebUISpacing").uiPadding.bottom6),{children:d("WAWebFormatLinkNotification").formatLinkNotification("community_create",a,null,b,!0)}));if(g==null)return null;f=k.jsx("div",babelHelpers["extends"]({},(j||(j=c("stylex"))).props(d("WAWebUISpacing").uiPadding.horiz10),{children:h._(/*BTDS*/"Send important admin updates to all your members at once.")}));var i=h._(/*BTDS*/"Manage community");return k.jsx(d("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:g,subgroupId:e.id,title:l({templateParams:b,chat:e,author:a}),subtitle:f,footer:i})}a.displayName=a.name+" [from "+f.id+"]";function l(a){var b=a.templateParams,c=a.chat;a=a.author;c=d("WAWebUserPrefsMeUser").isMeAccount((c=c.groupMetadata)==null?void 0:c.owner);return!c?d("WAWebFormatLinkNotification").formatLinkNotifAsFbt("community_create",a,null,b):h._(/*BTDS*/"Welcome to your community!")}l.displayName=l.name+" [from "+f.id+"]";g.MessageCommunityWelcomeAdmin=a;g.communityWelcomeAdminTitle=l}),226);
__d("WAWebMessageCommunityWelcomeMember.react",["fbt","WAWebFormatParticipantNames","WAWebMessageCommunityCard.react","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b=a.templateParams,c=a.clickable,e=a.author;a=a.chat;b=b[0];e=e?d("WAWebFormatParticipantNames").getFormattedName(e,c):null;c=[j.jsx(j.Fragment,{children:e==null||e===""?h._(/*BTDS*/"You joined this community"):h._(/*BTDS*/"{author} added you",[h._param("author",e)])}),h._(/*BTDS*/"Admins will send all members important community announcements here")];e=h._(/*BTDS*/"See community info");return j.jsx(d("WAWebMessageCommunityCard.react").MessageCommunityCard,{communityId:b,subgroupId:a.id,title:k(),body:j.jsx(d("WAWebMessageCommunityCard.react").BulletedList,{items:c}),footer:e})}a.displayName=a.name+" [from "+f.id+"]";function k(){return h._(/*BTDS*/"Welcome to the community!")}k.displayName=k.name+" [from "+f.id+"]";g.MessageCommunityWelcomeMember=a;g.communityWelcomeMemberTitle=k}),226);
__d("WAWebBizGetCustomUrlUserGraphqlQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"data"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"data"}],concreteType:"WAWebBizGetCustomUrlUserGraphqlQueryResponse",kind:"LinkedField",name:"xwa_custom_url_get_user",plural:!1,selections:[{alias:null,args:null,concreteType:"boolean",kind:"ScalarField",name:"success",plural:!1,storageKey:null},{alias:null,args:null,concreteType:"WAWebBizGetCustomUrlUser",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"string",name:"jid",kind:"ScalarField",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"number",kind:"ScalarField",name:"error_code",plural:!1,storageKey:null},{alias:null,args:null,concreteType:"string",kind:"ScalarField",name:"error_text",plural:!1,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizGetCustomUrlUserGraphqlQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizGetCustomUrlUserGraphqlQuery",selections:b},params:{id:"WAWebBizGetCustomUrlUserGraphqlQuery",metadata:{},name:"WAWebBizGetCustomUrlUserGraphqlQuery",operationKind:"query",text:null}}}();b=a;f["default"]=b}),66);
__d("WAWebBizGetCustomUrlUserGraphql",["WAWebBizGetCustomUrlUserGraphqlQuery.graphql","WAWebGraphQLServerError","WAWebRelayClient","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebRelayClient").fetchQuery(h!==void 0?h:h=b("WAWebBizGetCustomUrlUserGraphqlQuery.graphql"),{data:{custom_url:{path:a}}}).then(i)["catch"](function(a){if(a instanceof d("WAWebGraphQLServerError").GraphQLServerError){var b;return{type:"graphql-error",errorCode:(b=(b=a.source)==null?void 0:b.errors[0].code)!=null?b:0,errorText:(a=(b=a.source)==null?void 0:b.errors[0].message)!=null?a:""}}return{type:"graphql-error",errorCode:0,errorText:"unknown error"}})});return function(b){return a.apply(this,arguments)}}();function i(a){var b,c;if(!(a!=null&&(b=a.xwa_custom_url_get_user)!=null&&b.success)===!0){var d,e,f=a==null||(d=a.xwa_custom_url_get_user)==null?void 0:d.error_code,g=a==null||(e=a.xwa_custom_url_get_user)==null?void 0:e.error_text;return{type:"error",errorCode:j(f),errorText:g!=null?g:""}}f=a==null||(c=a.xwa_custom_url_get_user)==null||(c=c.user)==null?void 0:c.jid;return f==null||f===""?{type:"error",errorCode:500,errorText:"null or missing userJid"}:{type:"success",user:{jid:f}}}function j(a){switch(a){case"CODE_404":return 404;case"CODE_400":return 400;case"CODE_403":return 403;case"CODE_500":return 500;default:return 0}}g.queryCustomUrlUser=a;g.parseResponse=i}),98);
__d("WAWebBizGetCustomUserJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("customURLResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("user");a=a.attrUserJid("jid");return{user:{jid:a}}});function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{smax_id:b.SMAX_ID(c("WAWapDeprecatedSmaxID").BtmCustomUrlGetUser),xmlns:"fb:thrift_iq",type:"get",to:b.S_WHATSAPP_NET,id:b.generateId()},b.wap("custom_url",null,b.wap("path",null,a)));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,h));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);return a.result});return i.apply(this,arguments)}g.getUserByCustomURL=a}),98);
__d("WAWebBizGetWidFromPathCustomUrlAction",["WALogger","WAWebBackendErrors","WAWebBizGatingUtils","WAWebBizGetCustomUrlUserGraphql","WAWebBizGetCustomUserJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(d("WAWebBizGatingUtils").isGetCustomUrlUserGraphqlMigrationEnabled()){var c=(yield k(a));c!=null&&(b=d("WAWebWidFactory").createUserWidOrThrow(c))}else try{c=(yield d("WAWebBizGetCustomUserJob").getUserByCustomURL(a));b=d("WAWebWidFactory").createUserWidOrThrow(c.user.jid)}catch(a){if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError){a.statusCode!==404&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[custom-url] Error fetching user by custom url ",""])),a.message).sendLogs("get-user-by-custom-url-error");return null}throw a}return b});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebBizGetCustomUrlUserGraphql").queryCustomUrlUser(a));if(a.type==="error"){a.errorCode!==404&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[custom-url] Error fetching user by custom url "," ",""])),a.errorCode,a.errorText).sendLogs("get-user-by-custom-url-graphql-error");return null}return(a=a.user)==null?void 0:a.jid});return l.apply(this,arguments)}g.getWidfromPath=a}),98);
__d("WAWebOpenChatFlow.react",["fbt","$InternalEnum","WAAbortError","WALogger","WAPromiseDelays","WATimeUtils","WAWebBizGetWidFromPathCustomUrlAction","WAWebBotProfileCollection","WAWebCmd","WAWebComposeBoxActions","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebFbtCommon","WAWebFindChatAction","WAWebFlex.react","WAWebLinkify","WAWebNoop","WAWebQueryExistsJob","WAWebSpinner.react","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebUsernameKeyVerificationFlow","asyncToGeneratorRuntime","err","react","useWAWebFlow"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m=l||d("react"),n=k||(k=c("react")),o=m.useEffect,p=m.useRef,q=250,r=500,s=new Map();function a(){s.clear()}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isUser())return a;var b=s.get(a.user);if(b)return b;b=(yield d("WAWebQueryExistsJob").queryWidExists(a));b=b==null?a:b.wid;s.set(a.user,b);return b});return u.apply(this,arguments)}var v=b("$InternalEnum").Mirrored(["Confirm","Error"]);function e(a){var e=d("useWAWebFlow").useFlow(),f=e[0],g=e[1],k=p(),l=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a.targetId,c=b.targetId,e=b.customURL,f=b.username;b=b.usernameKey;if(c!=null)return{wid:c,lookupMetod:"directWid"};if(e!=null){var g=(yield d("WAWebBizGetWidFromPathCustomUrlAction").getWidfromPath(e));if(g)return{wid:g,lookupMetod:"customURL"};if(f==null)return null}if(f!=null){if(d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()){g=(yield d("WAWebQueryExistsJob").queryUsernameExists(f,b));(g==null?void 0:g.keyRequired)===!0?(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["OpenChatFlow: username query returned keyRequired"]))),b=(yield d("WAWebUsernameKeyVerificationFlow").usernameKeyVerificationFlow({username:f,initWithError:b!=null}))):b=g==null?void 0:g.wid;if(b!=null)return{wid:b,lookupMetod:"username"}}return null}d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["OpenChatFlow chatWid couldn't be created from provided props."]))).devConsole({targetId:c,customURL:e,username:f})});return function(){return c.apply(this,arguments)}}(),m=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=a.msgText,e=a.ctwaContextLinkData,f=a.clearPreviousText;f=f===void 0?!1:f;if(e){var g=d("WAWebLinkify").findLink(e.sourceUrl||"",!1,d("WAWebUserPrefsMeUser").getMaybeMePnUser());g=(g==null?void 0:g.suspiciousCharacters)!=null&&g.suspiciousCharacters.size>0;g&&(e=void 0)}e&&(c=e.icebreaker);b.active&&c!=null&&c!==""?(f&&d("WAWebComposeBoxActions").ComposeBoxActions.setTextContent(b,""),d("WAWebComposeBoxActions").ComposeBoxActions.paste(b,c),e&&d("WAWebComposeBoxActions").ComposeBoxActions.setCtwaContextLinkData(b,e)):(f&&b.setComposeContents({text:""}),c!=null&&c!==""&&b.setComposeContents({text:c,timestamp:d("WATimeUtils").unixTime()}),yield d("WAWebCmd").Cmd.openChatFromUnread(b).then(function(a){a&&(d("WAWebComposeBoxActions").ComposeBoxActions.focus(b),e&&d("WAWebComposeBoxActions").ComposeBoxActions.setCtwaContextLinkData(b,e))}));a.sendLogAttributes!=null&&d("WAWebComposeBoxActions").ComposeBoxActions.addMsgSendingLogAttributes(b,a.sendLogAttributes)});return function(a){return c.apply(this,arguments)}}(),s=function(){g.push(v.Error)};e=function(){var a;(a=k.current)==null||a.controller.abort();k.current=void 0;g.end()};o(function(){var e=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=!1,f=new AbortController();d("WAPromiseDelays").delayMs(q).then(function(){if(f.signal.aborted)throw new(d("WAAbortError").AbortError)();e=!0;g.push(v.Confirm)})["catch"](d("WAAbortError").catchAbort(c("WAWebNoop")));var h=Date.now(),i=new AbortController(),j=i.signal,n=(yield l());if(n==null){var o=a.targetId.fallbackURL;o!=null&&d("WAWebExternalLink.react").openExternalLink(o);g.end();return}o=n.wid;var p=n.lookupMetod;n=t(o).then(function(a){var b;b=(b=d("WAWebBotProfileCollection").BotProfileCollection.getDefaultBot())==null?void 0:b.id;if(a.isBot()&&(b==null||!b.equals(a)))throw c("err")("invalid bot chat");return d("WAWebFindChatAction").findOrCreateLatestChat(a,"debugOpenChatFlow",{forceUsync:!0})}).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(j.aborted)throw new(d("WAAbortError").AbortError)();e||f.abort();var c=Date.now()-h;c=e?Math.max(r+q-c,0):0;yield m(b.chat);yield d("WAPromiseDelays").delayMs(c);g.end();a.onSuccess(babelHelpers["extends"]({},b,{successWidLookupMethod:p}))});return function(a){return c.apply(this,arguments)}}())["catch"](d("WAAbortError").catchAbort(c("WAWebNoop")))["catch"](function(b){f.abort(),a.onError==null||a.onError(b),s()});k.current={controller:i,promise:n}});return function(){return e.apply(this,arguments)}}();e()["catch"](c("WAWebNoop"))},[]);if(g.step==null)return null;var u=null;switch(g.step){case v.Confirm:u=n.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{title:h._(/*BTDS*/"Starting chat"),onCancel:e,cancelText:h._(/*BTDS*/"Cancel"),children:n.jsx(d("WAWebFlex.react").FlexRow,{justify:"center",align:"center",children:n.jsx(d("WAWebSpinner.react").Spinner,{stroke:6,size:24})})});break;case v.Error:a.customError!=null?u=a.customError:u=n.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return g.end()},okText:c("WAWebFbtCommon")("OK"),children:h._(/*BTDS*/"Phone number shared via url is invalid.")});break}return n.jsx(f,{flow:g,children:u})}e.displayName=e.name+" [from "+f.id+"]";g.clearChatIdCorrectionCache=a;g.OpenChatFlow=e}),226);
__d("WAWebBlockQuoteFormatMutator",["WAWebBlockQuoteMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=/(?:^)\>(\s(?! +)[^\n]+(?:$)(?:\n|$))/gm;b=/(?:^)\>(\s(?! +)[^\n]*(?:$)(?:\n|$))/gm;d=c("WAWebCreateRegexMutator")(a,1);e=c("WAWebCreateRegexMutator")(b,1);f=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){var e=d.selectable;e=e===void 0?!1:e;var f=d.inline;f=f===void 0?!1:f;d=d.quoted;d=d===void 0?!1:d;b=b[1];return i.jsx(c("WAWebBlockQuoteMutatorComponent.react"),{selectable:e,inline:f,text:b,quoted:d,children:a})};return b}(d);f.unformatDecorations={pre:">"};a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(e);g.BlockQuote=f;g.BlockQuoteWithEmpty=a}),98);
__d("WAWebAdjustDelimitedRange",[],(function(a,b,c,d,e,f){function a(a){return function(b,c){var d=2*a.length+b[1].length;d=b[0].length-d;d>0&&(b.index+=d,b[0]=b[0].slice(d));c.lastIndex--;return b}}f["default"]=a}),66);
__d("WAWebBoldFormatRegex",[],(function(a,b,c,d,e,f){a=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))\*(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|\u20E3|\uFE0F\u20E3)((?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))\*(?=$|(?!\u20E3|\uFE0F\u20E3))(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g;b=a;f["default"]=b}),66);
__d("WAWebBoldMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableStrong,{selectable:a,appTextTemplate:"*${appText}*",children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebBoldFormatMutator",["WAWebAdjustDelimitedRange","WAWebBoldFormatRegex","WAWebBoldMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebAdjustDelimitedRange")("*");b=c("WAWebCreateRegexMutator")(c("WAWebBoldFormatRegex"),1,a);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){b=d.selectable;d=b===void 0?!1:b;return i.jsx(c("WAWebBoldMutatorComponent.react"),{selectable:d,children:a})};return b}(b);g["default"]=d}),98);
__d("WAWebBotCommandMutatorComponent.react",["WAWebClickable.react","WAWebComposeBoxActions","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j={link:{color:"x1ph7ams",$$css:!0}};function a(a){a=a.children;var b=a===void 0?"":a;a=function(){d("WAWebComposeBoxActions").ComposeBoxActions.paste(null,String(b)+" ",{insertLeadingSpace:!0})};return i.jsx(d("WAWebClickable.react").Clickable,{as:"span",xstyle:j.link,onClick:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g.BotCommandMutatorComponent=a}),98);
__d("WAWebBotCommandFormatMutator",["WAWebBotCommandMutatorComponent.react","WAWebExtractRangesUsingRegex","WAWebFormatMutator","escapeRegex","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.match=function(a,b){b=b!=null?b:{};b=b.commands;if(!b||b.length===0)return[];b=b.map(function(a){return c("escapeRegex")("/"+a.name)});b=new RegExp("("+b.join("|")+")(?=$|\\s)","gmi");var d=!1;return c("WAWebExtractRangesUsingRegex")(a,b,0,function(a){if(d)return null;d=!0;return a})};return b}(c("WAWebFormatMutator"));a.format=!1;a.jsx=function(a,b){return i.jsx(d("WAWebBotCommandMutatorComponent.react").BotCommandMutatorComponent,{children:a})};g.BotCommand=a}),98);
__d("WAWebBulletedListFormatMutator",["WAWebBulletedListMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=/((?:^)(?:[\*\-\] (?! +)(?:[^\n]+)(?:\n(?:[\*\-\] (?! +)[^\n]+)){0,})(?:\n|$))/gm;b=c("WAWebCreateRegexMutator")(a,0);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){return i.jsx(c("WAWebBulletedListMutatorComponent.react"),babelHelpers["extends"]({},d,{children:a}))};return b}(b);d.nestable=function(){return!1};g["default"]=d}),98);
__d("WAWebBulletedListItemFormatMutator",["WAWebBulletedListFormatMutator","WAWebBulletedListItemMutatorComponent.react","WAWebCreateRegexMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");b=/(?:^)[\*\]( (?! +)[^\n]+(?:$))/gm;d=/(?:^)\-( (?! +)[^\n]+(?:$))/gm;e=/(?:^)\*( (?! +)[^\n]*(?:$))/gm;f=/(?:^)\-( (?! +)[^\n]*(?:$))/gm;var j=new Set([c("WAWebBulletedListFormatMutator")]);function a(a,b){a=c("WAWebCreateRegexMutator")(a,1);a=(a=function(a){function d(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(d,a);d.jsx=function(a,d,e){var f=e.selectable;f=f===void 0?!1:f;e=e.inline;d=d[1];return i.jsx(c("WAWebBulletedListItemMutatorComponent.react"),{inline:e,selectable:f,text:d,symbol:b,children:a})};return d}(a),a.displayName="BulletedListItem",a.nestable=function(a){return j.has(a)},a.unformatDecorations={pre:b},a);return a}b=a(b,"*");d=a(d,"-");e=a(e,"*");a=a(f,"-");g.BulletedListItem=b;g.HyphenListItem=d;g.BulletedListItemWithEmpty=e;g.HyphenListItemWithEmpty=a}),98);
__d("WAWebEmojiMutatorComponent.react",["WAWebEmoji.react","WAWebMessageLargeEmoji.react","react","useWAWebABPropConfigValue"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.emoji,e=a.selectable,f=a.size;a=a.xstyle;d("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji");d("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji_feb2025");return f==="xlarge"?i.jsx(d("WAWebMessageLargeEmoji.react").LargeEmoji,{emoji:b,xstyle:a,size:d("WAWebMessageLargeEmoji.react").SIZE.XLARGE,element:"span",selectable:e}):i.jsx(c("WAWebEmoji.react"),{emoji:b,xstyle:a,selectable:e,size:f})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebEmojiFormatMutator",["WAUnicodeUtils","WAWebEmoji","WAWebEmojiMutatorComponent.react","WAWebExtractRangesUsingRegex","WAWebFormatMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){a=b[0];b=d.size;var e=d.selectable;e=e===void 0?!1:e;d=d.emojiXstyle;return i.jsx(c("WAWebEmojiMutatorComponent.react"),{emoji:a,size:b,selectable:e,xstyle:d})};b.match=function(a,b,e){b=e!=null&&e!==0?e:a.length;e=d("WAUnicodeUtils").firstNCodepoints(a,b);return c("WAWebExtractRangesUsingRegex")(e,d("WAWebEmoji").EmojiUtil.emojiRegex(),0,j)};return b}(c("WAWebFormatMutator"));a.compatibility=!0;function j(a,b){return!d("WAWebEmoji").EmojiUtil.getGlyphId(a[0])?null:a}g["default"]=a}),98);
__d("WAWebHeadingFormatMutator",["$InternalEnum","WAWebBotGating","WAWebCreateRegexMutator","WAWebRichTextHeading.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j=b("$InternalEnum")({LEVEL_1:1,LEVEL_2:2,LEVEL_3:3,LEVEL_4:4});a=/^(#{1,4})\s([^\n]+)(?:$)(?:\n|$)/gm;e=c("WAWebCreateRegexMutator")(a,2);function k(a){switch(a){case"#":return j.LEVEL_1;case"##":return j.LEVEL_2;case"###":return j.LEVEL_3;case"####":return j.LEVEL_4;default:return j.LEVEL_4}}f=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b){a=b[2];b=b[1];return i.jsx(c("WAWebRichTextHeading.react"),{level:k(b),text:a})};return b}(e);var l=new Set([j.LEVEL_1,j.LEVEL_2]),m=new Set([j.LEVEL_3,j.LEVEL_4]),n=function(a){return l.has(a)},o=function(a){return m.has(a)};b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b){a=b[2];var e=k(b[1]);if(n(e)&&d("WAWebBotGating").isRichResponseHeadingReceiverEnabled())return i.jsx(c("WAWebRichTextHeading.react"),{level:e,text:a});return o(e)&&d("WAWebBotGating").isRichResponseSubheadingReceiverEnabled()?i.jsx(c("WAWebRichTextHeading.react"),{level:e,text:a}):i.jsx("span",{children:b[0]})};return b}(e);a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b){a=b[2];return i.jsx("span",{children:a})};return b}(e);g.HeadingLevel=j;g.RegexMutator=e;g.Heading=f;g.AIRichResponseHeading=b;g.HeadlessHeading=a}),98);
__d("WAWebRichTextHeading.react",["WAWebHeadingFormatMutator","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={base:{display:"x1rg5ohu",width:"xh8yej3",$$css:!0},LEVEL_1:{fontSize:"x1q74xe4",lineHeight:"x1slxwg",marginBottom:"x12nagc",$$css:!0},LEVEL_2:{fontSize:"x1aueamr",lineHeight:"xgif2c7",marginBottom:"x12nagc",$$css:!0},LEVEL_3:{fontSize:"x1603h9y",lineHeight:"x101yacv",marginBottom:"x12nagc",$$css:!0},LEVEL_4:{fontSize:"x1lkfr7t",lineHeight:"x19v9tvf",marginBottom:"x12nagc",$$css:!0}};function l(a){switch(a){case d("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_1:return[k.base,k.LEVEL_1];case d("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_2:return[k.base,k.LEVEL_2];case d("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_3:return[k.base,k.LEVEL_3];case d("WAWebHeadingFormatMutator").HeadingLevel.LEVEL_4:return[k.base,k.LEVEL_4]}}function a(a){var b=a.level;a=a.text;return j.jsx("span",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(l(b)),{children:a}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebHighlightMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableSpan,{className:"matched-text",selectable:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebHighlightFormatMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebHighlightMutatorComponent.react","WAWebL10N","escapeRegex","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.match=function(a,b){if(!b)return[];var d=b.terms,e=b.boundary;e=e===void 0?!1:e;b=b.ignoreDiacritics;b=b===void 0?!1:b;if(!d.length||d.every(function(a){return a.length===0}))return[];b=b&&c("WAWebL10N").isLatinAlphabetLanguage(a)&&d.every(function(a){return c("WAWebL10N").isLatinAlphabetLanguage(a)})&&!c("WAWebL10N").isRTL();a=b?c("WAWebL10N").removeAccents(a):a;a=c("WAWebExtractRangesUsingRegex")(a,j(d,e,b));return a};return b}(c("WAWebFormatMutator"));a.jsx=function(a,b,d){b=d.selectable;return i.jsx(c("WAWebHighlightMutatorComponent.react"),{selectable:b,children:a})};function j(a,b,d){d=d?a.map(function(a){return c("WAWebL10N").removeAccents(a)}):a;a=d.filter(function(a){return a.trim().length>0});d=a.map(c("escapeRegex")).join("|");return c("WAWebL10N").isRTL()?new RegExp((b?"(?:^|\\b)":"")+"(\\S+)?("+d+")(\\S+)?","ig"):new RegExp((b?"(?:^|\\b)":"")+"("+d+")","ig")}g["default"]=a}),98);
__d("WAWebInlineCodeFormatRegex",[],(function(a,b,c,d,e,f){a=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))`(?![\t-\r `\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))`(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g;b=a;f["default"]=b}),66);
__d("WAWebInlineCodeMutatorComponent.react",["WAWebCopyPasteSelectable.react","WAWebUISpacing","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react"),k={code:{borderStartStartRadius:"xbrszos",borderStartEndRadius:"xea3l6g",borderEndEndRadius:"x18isctg",borderEndStartRadius:"x2q3nzr",backgroundColor:"x1bu39yj",color:"x1bvqhpb",$$css:!0},quotedColor:{color:"x15rks2t",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var e=a.quoted;a=a.selectable;return j.jsx(d("WAWebCopyPasteSelectable.react").SelectableCode,{selectable:a,appTextTemplate:"`${appText}`",className:(i||(i=c("stylex")))(k.code,e&&k.quotedColor,d("WAWebUISpacing").uiPadding.horiz4,d("WAWebUISpacing").uiPadding.vert2),children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebInlineCodeFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebInlineCodeFormatRegex","WAWebInlineCodeMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebAdjustDelimitedRange")("`");b=c("WAWebCreateRegexMutator")(c("WAWebInlineCodeFormatRegex"),1,a);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){b=d.selectable;b=b===void 0?!1:b;d=d.quoted;d=d===void 0?!1:d;return i.jsx(c("WAWebInlineCodeMutatorComponent.react"),{selectable:b,quoted:d,children:a})};return b}(b);d.format=!1;g["default"]=d}),98);
__d("WAWebItalicFormatRegex",[],(function(a,b,c,d,e,f){a=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))_((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))_(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g;b=a;f["default"]=b}),66);
__d("WAWebItalicMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableEm,{selectable:a,appTextTemplate:"_${appText}_",children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebItalicFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebItalicFormatRegex","WAWebItalicMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebAdjustDelimitedRange")("_");b=c("WAWebCreateRegexMutator")(c("WAWebItalicFormatRegex"),1,a);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){b=d.selectable;d=b===void 0?!1:b;return i.jsx(c("WAWebItalicMutatorComponent.react"),{selectable:d,children:a})};return b}(b);g["default"]=d}),98);
__d("WAWebLinkMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j={link:{textDecoration:"x1bvjpef x1lku1pv x11iimpl xbvygy2 x1wp9yj1 x1e2wovf",color:"x1ph7ams x17f7hit",backgroundColor:"xn69kzl",textUnderlineOffset:"xrys4gj xhmieyt",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var c=a.className,e=a.dataTab,f=a.href,g=a.onClick;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableLink,{onClick:function(a){g==null||g()},onContextMenu:function(a){g==null||g()},className:c,xstyle:j.link,href:f,title:f,target:"_blank",rel:"noopener noreferrer",selectable:a,dataTab:e,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebStrikethroughFormatRegex",[],(function(a,b,c,d,e,f){a=/(?:^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))~((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])(?:[\0-\t\x0B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))~(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/g;b=a;f["default"]=b}),66);
__d("WAWebStrikethroughMutatorComponent.react",["WAWebCopyPasteSelectable.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableDel,{selectable:a,appTextTemplate:"~${appText}~",children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebStrikethroughFormatMutator",["WAWebAdjustDelimitedRange","WAWebCreateRegexMutator","WAWebStrikethroughFormatRegex","WAWebStrikethroughMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=c("WAWebAdjustDelimitedRange")("_");b=c("WAWebCreateRegexMutator")(c("WAWebStrikethroughFormatRegex"),1,a);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){b=d.selectable;return i.jsx(c("WAWebStrikethroughMutatorComponent.react"),{selectable:b,children:a})};return b}(b);g["default"]=d}),98);
__d("WAWebSuspiciousLinkPopup.react",["fbt","WAWebCmd","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebFaqUrl","WAWebModal.react","WAWebModalManager","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react"),l=(i||(i=d("react"))).Fragment,m=".",n=function(){d("WAWebModalManager").ModalManager.close(),d("WAWebCmd").Cmd.closeLongLinkModal(!0)};function a(a){var b=a.link;a=function(){var a=b.href;d("WAWebExternalLink.react").openExternalLink(a);d("WAWebModalManager").ModalManager.close();d("WAWebCmd").Cmd.closeLongLinkModal(!0)};var c=b.suspiciousCharacters,e=b.domain,f=b.href,g=e.split(m),i=g.map(function(a,b){var d=!1,e=a.split("").map(function(a,e){var f=c!=null&&c.has(a);d=f||d;f=f?"x117nqv4":void 0;return k.jsx("span",{className:f,children:a},b+"-"+e+"-"+a)}),f=d?"xghrzdh":void 0;return k.jsxs(l,{children:[k.jsx("span",{className:f,children:e}),b+1!==g.length?k.jsx("span",{children:m}):null]},b+"-"+a)});f=f.split(e);e=f[0];f=f[1];return k.jsxs(d("WAWebConfirmPopup.react").ConfirmPopup,{title:h._(/*BTDS*/"Suspicious link"),okText:h._(/*BTDS*/"Cancel"),cancelText:h._(/*BTDS*/"Open link"),onOK:n,onCancel:a,type:d("WAWebModal.react").ModalTheme.LinkPopup,children:[k.jsxs("div",{className:"xyorhqc",children:[h._(/*BTDS*/"This link contains unusual characters. It may be trying to appear as another site.")," ",k.jsx(d("WAWebExternalLink.react").ExternalLink,{href:d("WAWebFaqUrl").getSuspiciousLinkFaqUrl(),children:h._(/*BTDS*/"Learn more")})]}),k.jsxs("div",{className:"x104kibb x1jquxbb x1anpbxc x6ikm8r x10wlt62 x1fc57z9 xlyipyv x1mzt3pk x1gzmk7r x1ua5tub",children:[e,i,f]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebSuspiciousLinkMutatorComponent.react",["WAWebCmd","WAWebCopyPasteSelectable.react","WAWebModalManager","WAWebSuspiciousLinkPopup.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.children;b=b===void 0?"":b;var e=a.className,f=a.dataTab,g=a.link,h=a.onClick;a=a.selectable;return i.jsx(d("WAWebCopyPasteSelectable.react").SelectableLink,{className:e,onClick:function(){d("WAWebModalManager").ModalManager.open(i.jsx(c("WAWebSuspiciousLinkPopup.react"),{link:g})),d("WAWebCmd").Cmd.openLongLinkModal(),h==null||h()},onContextMenu:function(a){h==null||h()},selectable:a,style:{cursor:"pointer"},dataTab:f,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebLinkFormatMutator",["WAWebBoldFormatMutator","WAWebCodeFormatMutator","WAWebFormatMutator","WAWebInlineCodeFormatMutator","WAWebItalicFormatMutator","WAWebLinkMutatorComponent.react","WAWebStrikethroughFormatMutator","WAWebSuspiciousLinkMutatorComponent.react","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j=h||c("react");b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){var e=d.selectable;e=e===void 0?!1:e;var f=d.linkXstyle,g=d.onLinkClick;d=d.dataTab;var h=b.href,k=b.suspiciousCharacters;return k!=null&&k.size?j.jsx(c("WAWebSuspiciousLinkMutatorComponent.react"),{onClick:g,className:(i||(i=c("stylex")))(f),link:b,selectable:e,dataTab:d,children:a}):j.jsx(c("WAWebLinkMutatorComponent.react"),{className:(i||(i=c("stylex")))(f),onClick:g,href:h,selectable:e,dataTab:d,children:a})};return b}(c("WAWebFormatMutator"));b.format=!1;b.compatibility=!0;b.match=function(a,b,c){if(!b)return[];a=b.links;c=a===void 0?[]:a;return c.map(k)};b.conflictResolvers=new Map([[c("WAWebBoldFormatMutator"),a],[c("WAWebItalicFormatMutator"),a],[c("WAWebStrikethroughFormatMutator"),a],[c("WAWebInlineCodeFormatMutator"),a],[d("WAWebCodeFormatMutator").Code,a]]);function k(a){var b=a.index,c=a.url;c=b+c.length-1;return[b,b,c,c,a]}function a(a,b){var c=0,d=0;while(c<a.length&&d<b.length){var e=b[d][3]-a[c][3];if(e>0)c++;else if(e<0)d++;else{e=b[d][3]-b[d][2];a[c][2]-=e;a[c][3]-=e;var f=a[c][5];f.href=f.href.slice(0,-e);f.path=f.path&&f.path.slice(0,-e);f.url=f.url.slice(0,-e);d++;c++}}}g["default"]=b}),98);
__d("WAWebNumberedListFormatMutator",["WAWebCreateRegexMutator","WAWebNumberedListMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=/((?:^)(?:(\d{1,2})\. (?! +)(?:[^\n]+)(?:\n(?:(\d{1,2})\. [^\n]+)){0,})(?:\n|$))/gm;b=c("WAWebCreateRegexMutator")(a,0);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){return i.jsx(c("WAWebNumberedListMutatorComponent.react"),babelHelpers["extends"]({},d,{children:a}))};return b}(b);d.nestable=function(){return!1};g["default"]=d}),98);
__d("WAWebNumberedListItemFormatMutator",["WAWebCreateRegexMutator","WAWebNumberedListFormatMutator","WAWebNumberedListItemMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");b=/(?:^)(\d{1,2}\.)( (?! +)[^\n]+(?:$))/gm;d=/(?:^)(\d{1,2}\.)( (?! +)[^\n]*(?:$))/gm;var j=new Set([c("WAWebNumberedListFormatMutator")]);function a(a){a=c("WAWebCreateRegexMutator")(a,2);a=(a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){var e=d.selectable;e=e===void 0?!1:e;d=d.inline;var f=b[1];b=b[2];return i.jsx(c("WAWebNumberedListItemMutatorComponent.react"),{inline:d,selectable:e,text:b,numbering:f,children:a})};return b}(a),a.displayName="NumberedListItem",a.nestable=function(a){return j.has(a)},a.unformatDecorations={pre:function(a){return a[1]}},a);return a}e=a(b);f=a(d);g.NumberedListItem=e;g.NumberedListItemWithEmpty=f}),98);
__d("WAWebWamEnumUrlStatusClicked",[],(function(a,b,c,d,e,f){a=Object.freeze({ONE_CLICK:1,TWO_CLICKS:2,NO_CLICK:3});f.URL_STATUS_CLICKED=a}),66);
__d("WAWebLongLinkPop.react",["fbt","WAWebCmd","WAWebConfirmPopup.react","WAWebExternalLink.react","WAWebModal.react","WAWebModalManager","WAWebWamEnumUrlStatusClicked","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react"),k=function(){d("WAWebModalManager").ModalManager.close(),d("WAWebCmd").Cmd.closeLongLinkModal(!0)};function a(a){var b=a.link,c=function(){var c;((c=a.statusItemViewEventRef)==null?void 0:c.current)!=null&&(a.statusItemViewEventRef.current.urlStatusClicked=d("WAWebWamEnumUrlStatusClicked").URL_STATUS_CLICKED.TWO_CLICKS);d("WAWebModalManager").ModalManager.close();d("WAWebExternalLink.react").openExternalLink(b.href)};return j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{title:h._(/*BTDS*/"Open in browser"),okText:h._(/*BTDS*/"Open link"),cancelText:h._(/*BTDS*/"Cancel"),onOK:c,onCancel:k,type:d("WAWebModal.react").ModalTheme.LinkPopup,children:j.jsx("div",{children:b.href})})}a.displayName=a.name+" [from "+f.id+"]";g.LongLinkPopup=a}),226);
__d("WAWebStatusContext",["react"],(function(a,b,c,d,e,f,g){var h;a=(h||d("react")).createContext;b=a({statusItemViewEventRef:null});g.StatusContext=b}),98);
__d("WAWebLongLinkMutatorComponent.react",["WAWebCmd","WAWebCopyPasteSelectable.react","WAWebLongLinkPop.react","WAWebModalManager","WAWebStatusContext","WAWebSuspiciousLinkMutatorComponent.react","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j,k=j||c("react"),l=(h||(h=d("react"))).useContext,m={link:{cursor:"x1ypdohk",$$css:!0}};function a(a){var b=a.children;b=b===void 0?"":b;var e=a.dataTab,f=a.link,g=a.selectable;a=a.xstyle;var h=l(d("WAWebStatusContext").StatusContext),j=h.statusItemViewEventRef;return(h=f.suspiciousCharacters)!=null&&h.size?k.jsx(c("WAWebSuspiciousLinkMutatorComponent.react"),{className:(i||(i=c("stylex")))(a),link:f,selectable:g,children:b}):k.jsx(d("WAWebCopyPasteSelectable.react").SelectableLink,{dataTab:e,onClick:function(a){a.preventDefault(),d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebLongLinkPop.react").LongLinkPopup,{link:f,statusItemViewEventRef:j})),d("WAWebCmd").Cmd.openLongLinkModal()},selectable:g,className:(i||(i=c("stylex")))(m.link,a),children:b})}a.displayName=a.name+" [from "+f.id+"]";g.LongLink=a}),98);
__d("WAWebStatusLinkFormatMutator",["WAWebLinkFormatMutator","WAWebLongLinkMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react"),j=34,k=12,l="...";function m(a,b){a=Math.min(b.length,Math.max(b.length-k,b.length+a.length-j));return b.length-a}function n(a,b){a=b.length>k||b.length+a.length>j?b.slice(0,m(a,b)):b;return a}function o(a){var b=a.domain;a=a.path;return[b.replace(/^www\./,""),a==null||a.length===1?"":a]}function p(a,b){var c=n(a,b);a=a+(c.length===1?"":c);a=a.length>j?""+l+a.slice(a.length-j):a;b=b!==c?l:"";return a+b}a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(b,c,e){b=o(c);var f=b[0];b=b[1];var g=p(f,b);if(g!==f+b){var h;return i.jsx(d("WAWebLongLinkMutatorComponent.react").LongLink,{xstyle:e.linkXstyle,selectable:(h=e.selectable)!=null?h:!1,link:c,dataTab:e.dataTab,children:g})}return a.jsx.call(this,[f+b],c,e)};return b}(c("WAWebLinkFormatMutator"));g.cleanUrl=o;g.redactUrl=p;g.StatusLink=a}),98);
__d("WAWebFormatConfiguration",["WAWebABProps","WAWebBlockQuoteFormatMutator","WAWebBoldFormatMutator","WAWebBotCommandFormatMutator","WAWebBotGating","WAWebBulletedListFormatMutator","WAWebBulletedListItemFormatMutator","WAWebCodeFormatMutator","WAWebEmojiFormatMutator","WAWebGroupMentionFormatMutator","WAWebHeadingFormatMutator","WAWebHighlightFormatMutator","WAWebInlineCodeFormatMutator","WAWebItalicFormatMutator","WAWebLinkFormatMutator","WAWebMentionFormatMutator","WAWebNoop","WAWebNumberedListFormatMutator","WAWebNumberedListItemFormatMutator","WAWebPhoneNumberFormatMutator","WAWebRawGroupMentionFormatMutator","WAWebRawMentionMutator","WAWebRawShortNameMentionFormatMutator","WAWebStatusLinkFormatMutator","WAWebStrikethroughFormatMutator","WAWebTextMentionFormatMutator","cr:6000","gkx"],(function(a,b,c,d,e,f,g){a=function(a){a=a===void 0?{}:a;var b=a.selectable;a=a.emojiXstyle;return[[[c("WAWebEmojiFormatMutator"),{selectable:b,emojiXstyle:a}]]]};e=function(a){a=a===void 0?{}:a;a=a.selectable;return[[[c("WAWebEmojiFormatMutator"),{selectable:a,size:"large"}]]]};f=function(a){a=a===void 0?{}:a;var b=a.links,e=a.selectable,f=a.linkXstyle,g=a.emojiXstyle;a=a.dataTab;return[[[d("WAWebCodeFormatMutator").Code,{selectable:e}]],[[d("WAWebStatusLinkFormatMutator").StatusLink,{links:b,selectable:e,linkXstyle:f,dataTab:a}]],[[c("WAWebBoldFormatMutator"),{selectable:e}],[c("WAWebItalicFormatMutator"),{selectable:e}],[c("WAWebStrikethroughFormatMutator"),{selectable:e}]],[[c("WAWebEmojiFormatMutator"),{selectable:e,size:"xlarge",emojiXstyle:g}]]]};var h=function(a){a=a===void 0?{}:a;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[c("WAWebEmojiFormatMutator"),{selectable:a}]]]},i=function(a){a=a===void 0?{}:a;a=a.selectable;return[[[c("WAWebEmojiFormatMutator"),{selectable:a}]]]},j=function(a){a=a===void 0?{}:a;var e=a.mentions,f=a.groupMentions,g=a.links,h=a.phoneNumbers,i=a.selectable,j=a.trusted,k=a.fromMe,l=a.fromChatWid,m=a.commands,n=a.parseInlineCode;n=n===void 0?!1:n;var o=a.parseLists;o=o===void 0?!1:o;var p=a.parseQuotes;p=p===void 0?!1:p;var q=a.parseHeadings;q=q===void 0?!1:q;var r=a.onLinkClick;r=r===void 0?c("WAWebNoop"):r;a=a.terms;a=a===void 0?null:a;h=j&&h!=null&&h.length>0?[[c("WAWebPhoneNumberFormatMutator"),{phoneNumbers:h,selectable:i,fromMe:k}]]:null;var s;(d("WAWebBotGating").isBizBot3pEnabled()||d("WAWebBotGating").isMetaBotCommandsEnabled())&&m&&m.length>0&&(s=[[d("WAWebBotCommandFormatMutator").BotCommand,{commands:m,selectable:i}]]);return[[[d("WAWebCodeFormatMutator").Code,{selectable:i}]],n?[[c("WAWebInlineCodeFormatMutator"),{selectable:i}]]:null,o?[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:i}]]:null,o?[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:i}]]:null,o?[[c("WAWebBulletedListFormatMutator"),{selectable:i}]]:null,o?[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:i}]]:null,o?[[c("WAWebNumberedListFormatMutator"),{selectable:i}]]:null,j?[[c("WAWebLinkFormatMutator"),{links:g,selectable:i,onLinkClick:r}]]:null,e?[[c("WAWebMentionFormatMutator"),{mentions:e,selectable:i}]]:null,q?[[d("WAWebHeadingFormatMutator").Heading,{selectable:i}]]:null,f?[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:f,selectable:i,fromChatWid:l}]]:null,!c("gkx")("26258")&&b("cr:6000")?b("cr:6000")(i):null,h,[[c("WAWebBoldFormatMutator"),{selectable:i}],[c("WAWebItalicFormatMutator"),{selectable:i}],[c("WAWebStrikethroughFormatMutator"),{selectable:i}]],[[c("WAWebEmojiFormatMutator"),{selectable:i}]],p?[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:i}]]:null,s,a!=null?[[c("WAWebHighlightFormatMutator"),{terms:a,ignoreDiacritics:!0}]]:null].filter(Boolean)},k=function(a){var b=a.boundary,e=a.terms,f=a.selectable,g=a.mentions;a=a.groupMentions;return[[[c("WAWebTextMentionFormatMutator"),{mentions:g,selectable:f}]],[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:a,selectable:f,clickable:!1}]],[[c("WAWebBoldFormatMutator"),{selectable:f}],[c("WAWebItalicFormatMutator"),{selectable:f}],[c("WAWebStrikethroughFormatMutator"),{selectable:f}]],[[c("WAWebHighlightFormatMutator"),{terms:e,boundary:b,selectable:f,ignoreDiacritics:!0}]],[[c("WAWebEmojiFormatMutator"),{selectable:f}]]]},l=function(a){var b=a.terms;a=a.emojiXstyle;return[[[c("WAWebHighlightFormatMutator"),{terms:b,ignoreDiacritics:!0}]],[[c("WAWebEmojiFormatMutator"),{emojiXstyle:a,selectable:!1}]]]},m=function(a){a===void 0&&(a={});var b=d("WAWebABProps").getABPropConfigValue("enable_clear_formatted_preview");a=a;var e=a.mentions,f=a.groupMentions,g=a.selectable;a=a.isDraftMessage;return[b?null:[[d("WAWebCodeFormatMutator").Code,{selectable:g}]],e?[[c("WAWebTextMentionFormatMutator"),{mentions:e,selectable:g,lastMessage:!0,isDraftMessage:a}]]:null,f?[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:f,selectable:g,clickable:!1,lastMessage:!0,isDraftMessage:a}]]:null,b?null:[[c("WAWebBoldFormatMutator"),{selectable:g}],[c("WAWebItalicFormatMutator"),{selectable:g}],[c("WAWebStrikethroughFormatMutator"),{selectable:g}]],[[c("WAWebEmojiFormatMutator"),{selectable:g}]]].filter(Boolean)},n=function(a){var b=a.boundary,e=a.mentions,f=a.groupMentions,g=a.terms;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebTextMentionFormatMutator"),{mentions:e,selectable:a}]],[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:f,selectable:a,clickable:!1}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[c("WAWebHighlightFormatMutator"),{terms:g,boundary:b,selectable:a}]],[[c("WAWebEmojiFormatMutator"),{selectable:a}]]]},o=function(a){a=a===void 0?{}:a;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[c("WAWebEmojiFormatMutator"),{selectable:a}]]]},p=function(a){var b=a.mentions,e=a.groupMentions;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebInlineCodeFormatMutator"),{selectable:a}]],[[c("WAWebTextMentionFormatMutator"),{mentions:b,selectable:a}]],[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:e,selectable:a,clickable:!1}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[c("WAWebEmojiFormatMutator"),{selectable:a}]],[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:a}]]].filter(Boolean)},q=function(a){var b=a.mentions,e=a.groupMentions;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebInlineCodeFormatMutator"),{selectable:a,quoted:!0}]],[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:a}]],[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:a}]],[[c("WAWebBulletedListFormatMutator"),{selectable:a,quoted:!0}]],[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:a}]],[[c("WAWebNumberedListFormatMutator"),{selectable:a,quoted:!0}]],[[c("WAWebTextMentionFormatMutator"),{mentions:b,selectable:a,theme:{quoted:!0}}]],[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:e,selectable:a,theme:{quoted:!0},clickable:!1}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]],[[c("WAWebEmojiFormatMutator"),{selectable:a}]],[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:a,quoted:!0}]]].filter(Boolean)},r=function(a){var b=a.mentions,e=a.groupMentions;a=a.selectable;return[[[d("WAWebCodeFormatMutator").Code,{selectable:a}]],[[c("WAWebRawMentionMutator"),{mentions:b,selectable:a}]],[[d("WAWebRawGroupMentionFormatMutator").RawGroupMention,{groupMentions:e}]],[[c("WAWebBoldFormatMutator"),{selectable:a}],[c("WAWebItalicFormatMutator"),{selectable:a}],[c("WAWebStrikethroughFormatMutator"),{selectable:a}]]].filter(Boolean)},s=function(a){var b=a.mentions,e=a.groupMentions,f=a.selectable;a=a.groupMetadata;return[[[d("WAWebCodeFormatMutator").Code,{selectable:f}]],[[c("WAWebInlineCodeFormatMutator"),{selectable:f}]],[[c("WAWebRawShortNameMentionFormatMutator"),{mentions:b,selectable:f,groupMetadata:a}]],[[d("WAWebRawGroupMentionFormatMutator").RawGroupMention,{groupMentions:e}]],[[c("WAWebBoldFormatMutator"),{selectable:f}],[c("WAWebItalicFormatMutator"),{selectable:f}],[c("WAWebStrikethroughFormatMutator"),{selectable:f}]],[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:f}]]].filter(Boolean)},t=function(a){var e=a.links,f=Boolean(a.expandedFormattingEnabled);a=Boolean((a=a.bulletPointsEnabled)!=null?a:f);var g=!0;return[[[d("WAWebCodeFormatMutator").Code,{selectable:g}]],f?[[c("WAWebInlineCodeFormatMutator"),{selectable:g}]]:null,a?[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:g}]]:null,a?[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:g}]]:null,a?[[c("WAWebBulletedListFormatMutator"),{selectable:g}]]:null,f?[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:g}]]:null,f?[[c("WAWebNumberedListFormatMutator"),{selectable:g}]]:null,[[c("WAWebLinkFormatMutator"),{links:e,selectable:g}]],[[c("WAWebBoldFormatMutator"),{selectable:g}],[c("WAWebItalicFormatMutator"),{selectable:g}],[c("WAWebStrikethroughFormatMutator"),{selectable:g}]],!c("gkx")("26258")&&b("cr:6000")?b("cr:6000")(g):null,[[c("WAWebEmojiFormatMutator"),{selectable:g}]],f?[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:g}]]:null].filter(Boolean)},u=function(a){var e=Boolean(a==null?void 0:a.expandedFormattingEnabled);a=Boolean((a=a==null?void 0:a.bulletPointsEnabled)!=null?a:e);var f=!0;return[[[d("WAWebCodeFormatMutator").Code,{selectable:f}]],e?[[c("WAWebInlineCodeFormatMutator"),{selectable:f}]]:null,a?[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:f}]]:null,a?[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:f}]]:null,a?[[c("WAWebBulletedListFormatMutator"),{selectable:f}]]:null,e?[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:f}]]:null,e?[[c("WAWebNumberedListFormatMutator"),{selectable:f}]]:null,[[c("WAWebBoldFormatMutator"),{selectable:f}],[c("WAWebItalicFormatMutator"),{selectable:f}],[c("WAWebStrikethroughFormatMutator"),{selectable:f}]],!c("gkx")("26258")&&b("cr:6000")?b("cr:6000")(f):null,[[c("WAWebEmojiFormatMutator"),{selectable:f}]],e?[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:f}]]:null].filter(Boolean)},v=function(a){a=a===void 0?{}:a;var b=a.links,d=a.selectable;a=a.trusted;return[a===!0?[[c("WAWebLinkFormatMutator"),{links:b,selectable:d}]]:null,[[c("WAWebEmojiFormatMutator"),{selectable:d}]]].filter(Boolean)},w=function(a){a===void 0&&(a={});a=a;var b=a.mentions,e=a.groupMentions,f=a.selectable;a=a.isDraftMessage;return[[[d("WAWebCodeFormatMutator").Code,{selectable:f}]],[[c("WAWebInlineCodeFormatMutator"),{selectable:f}]],[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:f,inline:!0}]],[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:f,inline:!0}]],[[c("WAWebBulletedListFormatMutator"),{selectable:f,inline:!0}]],[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:f,inline:!0}]],[[c("WAWebNumberedListFormatMutator"),{selectable:f,inline:!0}]],b?[[c("WAWebTextMentionFormatMutator"),{mentions:b,selectable:f,lastMessage:!0,isDraftMessage:a}]]:null,e?[[d("WAWebGroupMentionFormatMutator").GroupMention,{groupMentions:e,selectable:f,clickable:!1,lastMessage:!0,isDraftMessage:a}]]:null,[[c("WAWebBoldFormatMutator"),{selectable:f}],[c("WAWebItalicFormatMutator"),{selectable:f}],[c("WAWebStrikethroughFormatMutator"),{selectable:f}]],[[c("WAWebEmojiFormatMutator"),{selectable:f}]],[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:f,inline:!0}]]].filter(Boolean)},x=function(a){var b=a.selectable,e=a.parseHeadings;e=e===void 0?!0:e;var f=a.parseHeadlessHeadings;f=f===void 0?!1:f;var g=a.parseLists;g=g===void 0?!0:g;var h=a.parseQuotes;h=h===void 0?!0:h;var i=a.parseInlineCode;i=i===void 0?!0:i;var j=a.showLinks;j=j===void 0?!0:j;var k=a.links;a=a.onLinkClick;a=a===void 0?c("WAWebNoop"):a;return[[[d("WAWebCodeFormatMutator").Code,{selectable:b}]],i?[[c("WAWebInlineCodeFormatMutator"),{selectable:b}]]:null,[[c("WAWebBoldFormatMutator"),{selectable:b}],[c("WAWebItalicFormatMutator"),{selectable:b}],[c("WAWebStrikethroughFormatMutator"),{selectable:b}]],[[c("WAWebEmojiFormatMutator"),{selectable:b}]],h?[[d("WAWebBlockQuoteFormatMutator").BlockQuote,{selectable:b}]]:null,g?[[d("WAWebBulletedListItemFormatMutator").BulletedListItem,{selectable:b}]]:null,g?[[d("WAWebBulletedListItemFormatMutator").HyphenListItem,{selectable:b}]]:null,g?[[c("WAWebBulletedListFormatMutator"),{selectable:b}]]:null,g?[[d("WAWebNumberedListItemFormatMutator").NumberedListItem,{selectable:b}]]:null,g?[[c("WAWebNumberedListFormatMutator"),{selectable:b}]]:null,j?[[c("WAWebLinkFormatMutator"),{links:k,selectable:b,onLinkClick:a}]]:null,e?[[d("WAWebHeadingFormatMutator").AIRichResponseHeading,{selectable:b}]]:null,f?[[d("WAWebHeadingFormatMutator").HeadlessHeading,{selectable:b}]]:null].filter(Boolean)};g.EmojiOnly=a;g.LargeEmojiOnly=e;g.StatusText=f;g.StatusCaption=h;g.Compatibility=i;g.Conversation=j;g.Search=k;g.SearchName=l;g.LastMessage=m;g.FTSMessage=n;g.QuickReply=o;g.Unformat=p;g.QuotedMention=q;g.FormattedNotification=r;g.FormattedGroupNotification=s;g.TrustedGroupDesc=t;g.UntrustedGroupDesc=u;g.HeaderAndFooter=v;g.InlineMessage=w;g.RichResponse=x}),98);
__d("WAWebFormatRevokedMsg",["fbt","WAWebContactCollection","WAWebFrontendContactGetters","WAWebMsgGetters","WAWebWidFormat"],(function(a,b,c,d,e,f,g,h){var i=function(a){var b=d("WAWebContactCollection").ContactCollection.get(a);return!b?d("WAWebWidFormat").widToFormattedUser(a):b.shortName||b.name||d("WAWebFrontendContactGetters").getDisplayName(b)};function j(a){if(d("WAWebMsgGetters").getIsRevokedByMe(a))return h._(/*BTDS*/"You deleted this message as admin");else if(a.revokeSender==null)return h._(/*BTDS*/"This message was deleted by an admin");return h._(/*BTDS*/"This message was deleted by admin {admin}",[h._param("admin",i(a.revokeSender))])}function k(a){return d("WAWebMsgGetters").getIsSentByMe(a)?h._(/*BTDS*/"You deleted this message"):h._(/*BTDS*/"This message was deleted")}function a(a){var b;b=(b=a.subtype)!=null?b:"sender";switch(b){case"sender":return k(a);case"admin":return j(a)}}function b(a){var b;b=(b=a.subtype)!=null?b:"sender";switch(b){case"sender":return k(a);case"admin":return d("WAWebMsgGetters").getIsNewsletterMsg(a)?l(a):j(a)}}function l(a){return d("WAWebMsgGetters").getIsRevokedByMe(a)?h._(/*BTDS*/"You deleted this update"):h._(/*BTDS*/"This update was deleted")}g.formatRevokedComment=a;g.formatRevokedMsg=b}),226);
__d("WAWebGroupMentionFormatMutator",["WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebGroupMetadataCollection","WAWebRichTextInputConst","WAWebTextGroupMentionWrapperMutatorComponent.react","WAWebUnjoinedSubgroupMetadataCollection","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.match=function(a,b){if(!b)return[];var e=b.groupMentions,f=b.isDraftMessage;b=b.fromChatWid;this.fromChatWid=b;if(f===!0){f=c("WAWebExtractRangesUsingRegex")(a,new RegExp(d("WAWebRichTextInputConst").groupJidRegexStr,"g"));for(var g=0;g<f.length;++g){var h=f[g][4][1],i=c("WAWebUnjoinedSubgroupMetadataCollection").get(h)||c("WAWebGroupMetadataCollection").get(h);if(!i||!i.subject)return[];f[g][4]={groupJid:h.slice(1),groupSubject:i.subject,fromChatWid:b}}return f}if(!e||Object.keys(e).length===0)return[];h=k(e);i=c("WAWebExtractRangesUsingRegex")(a,h);for(g=0;g<i.length;++g){f=i[g][4][0];i[g][4]={groupJid:f.slice(1),groupSubject:e[f],fromChatWid:b}}return i};b.jsx=function(a,b,d){a=d.selectable;var e=d.theme,f=d.clickable;f=f===void 0?!0:f;d=d.lastMessage;return i.jsx(c("WAWebTextGroupMentionWrapperMutatorComponent.react"),{groupSubject:b.groupSubject,groupJid:b.groupJid,selectable:a,clickable:f,theme:e,lastMessage:d,fromChatWid:this.fromChatWid})};return b}(c("WAWebFormatMutator"));a.compatibility=!0;function j(a){var b=/[\\^$.*+?()[\]{}|]/g,c=RegExp(b.source);return a&&c.test(a)?a.replace(b,"\\$&"):a}function k(a){a=Object.keys(a).map(j).join("|");return new RegExp("("+a+")","g")}g.GroupMention=a}),98);
__d("WAWebInternFormatRegex",[],(function(a,b,c,d,e,f){a=/(^|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))(([DPST\u017F][0-9]{6,16})|(L[0-9]{6,16}[A-Z\u017F\u212A]{0,5})|(r[A-Z\u017F\u212A]{2,32}[0-9A-F]{8,40}))(?=$|(?:[\t-\r -\/:-@\[-`\{-~\xA0-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u037E\u0384\u0385\u0387\u03F6\u0482\u055A-\u055F\u0589\u058A\u058D-\u058F\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0600-\u060F\u061B\u061C\u061E\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070D\u070F\u07F6-\u07F9\u07FE\u07FF\u0830-\u083E\u085E\u08E2\u0964\u0965\u0970\u09F2\u09F3\u09FA\u09FB\u09FD\u0A76\u0AF0\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0C84\u0D4F\u0D79\u0DF4\u0E3F\u0E4F\u0E5A\u0E5B\u0F01-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F85\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u104A-\u104F\u109E\u109F\u10FB\u1360-\u1368\u1390-\u1399\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DB\u1800-\u180A\u180E\u1940\u1944\u1945\u19DE-\u19FF\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B6A\u1B74-\u1B7C\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2000-\u2064\u2066-\u206F\u207A-\u207E\u208A-\u208E\u20A0-\u20BF\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2775\u2794-\u2B73\u2B76-\u2B95\u2B98-\u2BC8\u2BCA-\u2BFE\u2CE5-\u2CEA\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAA77-\uAA79\uAADE\uAADF\uAAF0\uAAF1\uAB5B\uABEB\uFB29\uFBB2-\uFBC1\uFD3E\uFD3F\uFDFC\uFDFD\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD]|\uD800[\uDD00-\uDD02\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9B\uDDA0\uDDD0-\uDDFC\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDC77\uDC78\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEC8\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB-\uDCC1\uDCCD\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3F]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3F\uDF44\uDF45]|\uD81B[\uDE97-\uDE9A]|\uD82F[\uDC9C\uDC9F-\uDCA3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD73-\uDD7A\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDE8\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85-\uDE8B]|\uD83A[\uDD5E\uDD5F]|\uD83B[\uDCAC\uDCB0\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD10-\uDD6B\uDD70-\uDDAC\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED4\uDEE0-\uDEEC\uDEF0-\uDEF9\uDF00-\uDF73\uDF80-\uDFD8]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDD00-\uDD0B\uDD10-\uDD3E\uDD40-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF\uDE60-\uDE6D]|\uDB40[\uDC01\uDC20-\uDC7F]))/gi;b=a;f["default"]=b}),66);
__d("WAWebInternMutatorComponent.react",["WAWebLinkMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){return i.jsx(c("WAWebLinkMutatorComponent.react"),babelHelpers["extends"]({},a,{children:a.children}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebInternFormatMutator",["WAWebCreateRegexMutator","WAWebInternFormatRegex","WAWebInternMutatorComponent.react","WAWebLinkFormatMutator","WAWebMentionFormatMutator","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");b=c("WAWebCreateRegexMutator")(c("WAWebInternFormatRegex"),2,a);d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){d=d.selectable;d=d===void 0?!1:d;b=k(b);return i.jsx(c("WAWebInternMutatorComponent.react"),{href:b,selectable:d,children:a})};return b}(b);d.format=!1;d.compatibility=!0;d.nestable=function(a){return a!==c("WAWebLinkFormatMutator")&&a!==c("WAWebMentionFormatMutator")};function a(a,b){b=a[1];b&&(a.index+=b.length,a[0]=a[0].slice(b.length));return a}var j="https://www.internalfb.com/intern/bunny/?q=";function k(a){a[0];a[1];a[2];var b=a[3],c=a[4];a=a[5];return""+j+((b=b!=null?b:c)!=null?b:a)}g["default"]=d}),98);
__d("WAWebMentionFormatMutator",["WAWebContactCollection","WAWebExtractRangesUsingRegex","WAWebFormatMutator","WAWebMentionMutatorComponent.react","WAWebRichTextInputConst","WAWebWidFactory","escapeRegex","isEmptyObject","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.match=function(a,b){if(!b)return[];var e=b.mentions,f=b.groupMetadata;b=b.isDraftMessage;if(b===!0){b=c("WAWebExtractRangesUsingRegex")(a,new RegExp(d("WAWebRichTextInputConst").userJidRegexStr,"g"));for(var g=0;g<b.length;++g){var h=b[g][4][1];h=d("WAWebWidFactory").createUserWidOrThrow(h);h=d("WAWebContactCollection").ContactCollection.get(h);if(h==null)return[];b[g][4]={contact:h,groupMetadata:f}}return b}if(!e||c("isEmptyObject")(e))return[];h=j(e);g=c("WAWebExtractRangesUsingRegex")(a,h);for(b=0;b<g.length;++b)g[b][4]={contact:e[g[b][4][0]],groupMetadata:f};return g};b.jsx=function(a,b,d){a=d.selectable;d=d.lastMessage;return i.jsx(c("WAWebMentionMutatorComponent.react"),{mentionMeta:b,selectable:a,lastMessage:d})};return b}(c("WAWebFormatMutator"));a.compatibility=!0;function j(a){a=Object.keys(a).map(c("escapeRegex")).join("|");return new RegExp("("+a+")","g")}g["default"]=a}),98);
__d("WAWebPhoneNumberFormatMutator",["WAWebFormatMutator","WAWebInternFormatMutator","WAWebLinkFormatMutator","WAWebMentionFormatMutator","WAWebPhoneNumberMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){a=d.selectable;a=a===void 0?!1:a;d=d.fromMe;b=b.phone;return i.jsx(c("WAWebPhoneNumberMutatorComponent.react"),{phoneNumber:b,selectable:a,fromMe:d})};return b}(c("WAWebFormatMutator"));a.format=!1;a.compatibility=!0;a.nestable=function(a){return a!==c("WAWebLinkFormatMutator")&&a!==c("WAWebInternFormatMutator")&&a!==c("WAWebMentionFormatMutator")};a.match=function(a,b,c){if(!b)return[];a=b.phoneNumbers;c=a===void 0?[]:a;return c.map(j)};function j(a){var b=a.index,c=a.phone;c=b+c.length-1;return[b,b,c,c,a]}g["default"]=a}),98);
__d("WAWebRawGroupMentionFormatMutator",["WAWebGroupMentionFormatMutator"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebGroupMentionFormatMutator").GroupMention);a.mutates=!0;a.mutate=function(a,b){a=b.groupSubject;return"@"+a};g.RawGroupMention=a}),98);
__d("WAWebRawMentionMutator",["WAWebABProps","WAWebChatContactUtils","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendContactGetters","WAWebMentionFormatMutator"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebMentionFormatMutator"));a.mutates=!0;a.mutate=function(a,b){a=b.contact;b=d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(a)&&d("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?d("WAWebChatContactUtils").getFormattedNotifyName(d("WAWebContactGetters").getNotifyName(a),!1).toString():d("WAWebFrontendContactGetters").getDisplayName(a);return"@"+b};g["default"]=a}),98);
__d("WAWebRawShortNameMentionFormatMutator",["WAWebFrontendContactGetters","WAWebMentionFormatMutator","WAWebMiscGatingUtils"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebMentionFormatMutator"));a.mutates=!0;a.mutate=function(a,b){a=b.contact;b=b.groupMetadata;return d("WAWebMiscGatingUtils").isDropLastNameEnabled()&&b&&b.hasUniqueShortNameMention(a)?"@"+a.shortName:"@"+d("WAWebFrontendContactGetters").getDisplayName(a)};g["default"]=a}),98);
__d("WAWebTextMentionFormatMutator",["WAWebMentionFormatMutator","WAWebTextMentionMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);b.jsx=function(a,b,d){a=b.contact;b=d.selectable;var e=d.theme;d=d.lastMessage;return i.jsx(c("WAWebTextMentionMutatorComponent.react"),{contact:a,selectable:b,theme:e,lastMessage:d})};return b}(c("WAWebMentionFormatMutator"));g["default"]=a}),98);
__d("WAWebWrapperDisplayTypeContext",["react"],(function(a,b,c,d,e,f,g){var h;a=(h||d("react")).createContext;b=a(null);g["default"]=b}),98);
__d("WAWebMentionMutatorComponentBase.react",["WABidi","WAWebCopyPasteSelectable.react","WAWebDisplayType","WAWebEmojiFormatMutator","WAWebFormat","WAWebJsxSerializer.react","WAWebUIRefreshGatingUtils","WAWebWrapperDisplayTypeContext","react","stylex"],(function(a,b,c,d,e,f,g){var h,i,j,k=j||c("react"),l=(h||(h=d("react"))).use,m={gallery:{color:"x1heor9g",$$css:!0},matchedMention:{cursor:"x1ypdohk",color:"x1ph7ams",$$css:!0},lastMessage:{fontWeight:"xk50ysn",$$css:!0},matchedMentionRefresh:{color:"xo1mcw5",fontWeight:"x1xlr1w8",textDecoration:"x1hl2dhg",":hover_textDecoration":"xt0b8zv",":focus-visible_textDecoration":"xbvygy2",":focus-visible_color":"x17f7hit",":focus-visible_backgroundColor":"xp30eni",":focus-visible_textUnderlineOffset":"xhmieyt",$$css:!0}};function a(a){var b=l(c("WAWebWrapperDisplayTypeContext")),e=a.onClick,f=a.theme,g=a.selectable,h=a.text,j=a.jid,n=a.ariaLabel;a=a.lastMessage;var o=d("WABidi").dir(h)||"auto";f=(f=f==null?void 0:f.quoted)!=null?f:!1;var p=c("WAWebFormat")(h,[[[c("WAWebEmojiFormatMutator"),{selectable:g}]]],c("WAWebJsxSerializer.react"),void 0,Infinity);f=e&&!f;b=b===d("WAWebDisplayType").DISPLAY_TYPE.GALLERY;f=[f===!0&&m.matchedMention,a===!0&&m.lastMessage,f===!0&&a!==!0&&d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()&&m.matchedMentionRefresh,b&&m.gallery];return k.jsxs(d("WAWebCopyPasteSelectable.react").SelectableSpan,{dir:"auto","data-jid":j,"data-display":h,className:(i||(i=c("stylex")))(f),onClick:e,plainText:"@"+h,selectable:g,"aria-label":n,selectAll:!0,appTextTemplate:"\u200b"+j+"\u200b",children:["@",k.jsx("span",{dir:o,children:p})]})}a.displayName=a.name+" [from "+f.id+"]";g.MentionBase=a}),98);
__d("WAWebChatTextMentionMutatorComponent.react",["WAWebABProps","WAWebChatContactUtils","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendContactGetters","WAWebMentionMutatorComponentBase.react","react","useWAWebContactValues"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.contact,c=a.onClick,e=a.theme,f=a.selectable,g=a.lastMessage;a=d("useWAWebContactValues").useContactValues(a.contact.id,[d("WAWebContactGetters").getId,d("WAWebFrontendContactGetters").getDisplayName,d("WAWebContactGetters").getNotifyName]);var h=a[0],j=a[1];a=a[2];var k;d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(b)&&d("WAWebABProps").getABPropConfigValue("elevated_push_names_v2_m2_enabled")?(b=d("WAWebChatContactUtils").getFormattedNotifyName(a,!1).toString(),k=d("WAWebChatContactUtils").getAccessibleNotifyName(a).toString()):b=j;return i.jsx(d("WAWebMentionMutatorComponentBase.react").MentionBase,{text:b,jid:h.toString(),onClick:c,theme:e,selectable:f,ariaLabel:k,lastMessage:g})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebMentionMutatorComponent.react",["WAWebTextMentionWrapperMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.mentionMeta,d=a.theme,e=a.selectable;a=a.lastMessage;return i.jsx(c("WAWebTextMentionWrapperMutatorComponent.react"),{contact:b.contact,theme:d,selectable:e,lastMessage:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebPhoneNumberMutatorComponent.react",["WAWebPhoneNumberWrapperMutatorComponent.react","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.phoneNumber,d=a.selectable;a=a.fromMe;return i.jsx(c("WAWebPhoneNumberWrapperMutatorComponent.react"),{selectable:d,phoneNumber:b,fromMe:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebChatRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="chat-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.00013 9L0.940133 5.53C0.540219 4.86348 1.01283 4 1.79012 4H19.3335C20.8062 4 22.0001 5.19391 22.0001 6.66667V17.3333C22.0001 18.8061 20.8062 20 19.3335 20H5.6668C4.19404 20 3.00013 18.8061 3.00013 17.3333V9ZM5.00013 8.44603L3.53252 6H19.3335C19.7017 6 20.0001 6.29848 20.0001 6.66667V17.3333C20.0001 17.7015 19.7017 18 19.3335 18H5.6668C5.29861 18 5.00013 17.7015 5.00013 17.3333V8.44603Z",fill:"currentColor"}),k.jsx("path",{d:"M7.00013 10C7.00013 9.44772 7.44785 9 8.00013 9H17.0001C17.5524 9 18.0001 9.44772 18.0001 10C18.0001 10.5523 17.5524 11 17.0001 11H8.00013C7.44785 11 7.00013 10.5523 7.00013 10Z",fill:"currentColor"}),k.jsx("path",{d:"M7.00013 14C7.00013 13.4477 7.44785 13 8.00013 13H14.0001C14.5524 13 15.0001 13.4477 15.0001 14C15.0001 14.5523 14.5524 15 14.0001 15H8.00013C7.44785 15 7.00013 14.5523 7.00013 14Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.ChatRefreshedIcon=a}),98);
__d("WAWebCopyRefreshedIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="copy-refreshed";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=24;o=24;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 24 24",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),fill:"none",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M9 18C8.45 18 7.97917 17.8042 7.5875 17.4125C7.19583 17.0208 7 16.55 7 16V4C7 3.45 7.19583 2.97917 7.5875 2.5875C7.97917 2.19583 8.45 2 9 2H18C18.55 2 19.0208 2.19583 19.4125 2.5875C19.8042 2.97917 20 3.45 20 4V16C20 16.55 19.8042 17.0208 19.4125 17.4125C19.0208 17.8042 18.55 18 18 18H9ZM9 16H18V4H9V16ZM5 22C4.45 22 3.97917 21.8042 3.5875 21.4125C3.19583 21.0208 3 20.55 3 20V7C3 6.71667 3.09583 6.47917 3.2875 6.2875C3.47917 6.09583 3.71667 6 4 6C4.28333 6 4.52083 6.09583 4.7125 6.2875C4.90417 6.47917 5 6.71667 5 7V20H15C15.2833 20 15.5208 20.0958 15.7125 20.2875C15.9042 20.4792 16 20.7167 16 21C16 21.2833 15.9042 21.5208 15.7125 21.7125C15.5208 21.9042 15.2833 22 15 22H5Z",fill:"currentColor"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.CopyRefreshedIcon=a}),98);
__d("WAWebPhoneNumberWrapperMutatorComponent.react",["fbt","WALogger","WAPhoneUtils","WAWebChatRefreshedIcon.react","WAWebCopyPasteSelectable.react","WAWebCopyRefreshedIcon.react","WAWebDropdownItem.react","WAWebFlex.react","WAWebGetOrQueryUsyncInfoContactAction","WAWebPhoneNumberContactAction","WAWebSpinner.react","WAWebText.react","WAWebUIRefreshGatingUtils","WAWebUimUie.react","WAWebUimUieMenu.react","asyncToGeneratorRuntime","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l=k||c("react"),m=(j||(j=d("react"))).useState,n={spinnerContainer:{width:"xc5o50y",height:"x6hvgyk",$$css:!0},spinnerText:{marginTop:"xcxhlts",paddingInlineStart:"x1gx403c",paddingInlineEnd:"x1q3ajuy",textAlign:"x2b8uid",$$css:!0},menuItem:{paddingInlineStart:"x1iw51ew",paddingInlineEnd:"xde1mab",$$css:!0},textualLinkRefreshed:{color:"xo1mcw5",fontWeight:"x1xlr1w8",textDecoration:"x1hl2dhg",":hover_textDecoration":"xt0b8zv",":focus-visible_textDecoration":"xbvygy2",":focus-visible_color":"x17f7hit",":focus-visible_backgroundColor":"xp30eni",":focus-visible_textUnderlineOffset":"xhmieyt",$$css:!0}};function a(a){var e=a.fromMe,f=a.phoneNumber;a=a.selectable;var g=m(null),j=g[0],k=g[1];g=m(null);var o=g[0],p=g[1];g=m(null);var q=g[0],r=g[1];g=m(null);var s=g[0],t=g[1];function u(a){var c;q&&q.isCached(f)?c=q:(c=d("WAWebGetOrQueryUsyncInfoContactAction").usyncContactCached(),r(c));function e(a,b){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield c.getOrRun(a));w(a,b)}catch(a){w(null,b),t(null),d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handlePhoneClick getUsync failed with exceptions ",""])),a).sendLogs("handlePhoneClick-getUsync")}});return g.apply(this,arguments)}c.isCached(f)||v(a);e(f,a)}function v(a){var b=l.jsxs(d("WAWebFlex.react").FlexColumn,{xstyle:n.spinnerContainer,align:"center",justify:"center",children:[l.jsx(d("WAWebSpinner.react").Spinner,{size:50,stroke:4,color:"highlight"}),l.jsx(d("WAWebText.react").WAWebTextSmall,{as:"span",xstyle:n.spinnerText,children:h._(/*BTDS*/"Checking phone number...")},"phone_number_wrapper_loading_text")]});p({menu:b,event:a});k(null)}function w(a,b){var c=[],g=d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled();if(a!=null&&a.wid){var i=d("WAPhoneUtils").formatPhone(a.wid.user);c.push(l.jsx(d("WAWebDropdownItem.react").DropdownItem,{testid:void 0,xstyle:n.menuItem,action:function(b){return d("WAWebPhoneNumberContactAction").handleOpenChat(b,a.wid,e)},icon:g?l.jsx(d("WAWebChatRefreshedIcon.react").ChatRefreshedIcon,{}):null,children:h._(/*BTDS*/"Chat with {chat-with-phoneNumber}",[h._param("chat-with-phoneNumber",l.jsx("span",{dir:"ltr",children:i}))])},"message-on-whatsapp"))}c.push(l.jsx(d("WAWebDropdownItem.react").DropdownItem,{testid:void 0,xstyle:n.menuItem,action:function(){return d("WAWebPhoneNumberContactAction").handleCopyPhoneNumber(f,a==null?void 0:a.wid,e)},icon:g?l.jsx(d("WAWebCopyRefreshedIcon.react").CopyRefreshedIcon,{}):null,children:h._(/*BTDS*/"Copy phone number")},"copy-phone-number"));p(null);k({menu:c,event:b});t(a==null?void 0:a.wid);d("WAWebPhoneNumberContactAction").logClickOnPhoneNumber(a==null?void 0:a.wid,e)}g=null;var x=null;j&&(g=l.jsx(d("WAWebUimUie.react").UIE,{displayName:"ContextMenu",escapable:!0,popable:!0,dismissOnWindowResize:!0,requestDismiss:function(){k(null),d("WAWebPhoneNumberContactAction").logCloseDialog(s,e)},children:l.jsx(c("WAWebUimUieMenu.react"),{contextMenu:j})}));o&&(x=l.jsx(d("WAWebUimUie.react").UIE,{displayName:"ContextSpinner",escapable:!0,popable:!0,dismissOnWindowResize:!0,requestDismiss:function(){p(null)},children:l.jsx(c("WAWebUimUieMenu.react"),{contextMenu:o})}));return l.jsxs(l.Fragment,{children:[l.jsx(d("WAWebCopyPasteSelectable.react").SelectableLink,{onClick:u,selectable:a,xstyle:d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()&&n.textualLinkRefreshed,style:{cursor:"pointer"},children:f}),g,x]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebShortNameTextMentionMutatorComponent.react",["WAWebContactGetters","WAWebFrontendContactGetters","WAWebMentionMutatorComponentBase.react","WAWebMiscGatingUtils","react","useWAWebContactValues","useWAWebModelValues"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){var b=a.contact,c=a.onClick,e=a.theme,f=a.selectable,g=a.lastMessage,h=d("useWAWebContactValues").useContactValues(a.contact.id,[d("WAWebContactGetters").getId,d("WAWebFrontendContactGetters").getDisplayName,d("WAWebContactGetters").getShortName,d("WAWebContactGetters").getIsMyContact]),j=h[0],k=h[1],l=h[2];h[3];var m=d("useWAWebModelValues").useModelValues(a.groupMetadata,["uniqueShortNameMap"]);h=function(){return d("WAWebMiscGatingUtils").isDropLastNameEnabled()&&m&&m.hasUniqueShortNameMention(b)?l:k};a=h();return i.jsx(d("WAWebMentionMutatorComponentBase.react").MentionBase,{text:a,jid:j.toString(),theme:e,selectable:f,onClick:c,lastMessage:g})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebGroupMetadataContext",["react"],(function(a,b,c,d,e,f,g){var h;a=(h||d("react")).createContext;b=a(null);g["default"]=b}),98);
__d("WAWebTextGroupMentionWrapperMutatorComponent.react",["WALogger","WAWebChatCollection","WAWebChatEntryPoint","WAWebCmd","WAWebCommunityGroupJourneyEventImpl","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebGroupMetadataContext","WAWebMentionMutatorComponentBase.react","WAWebUnjoinedSubgroupMetadataCollection","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","react"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=k||c("react"),m=(j||(j=d("react"))).useContext;function a(a){var b,e=m(c("WAWebGroupMetadataContext")),f=function(){var b=a.fromChatWid;b&&new(d("WAWebCommunityGroupJourneyEventImpl").CommunityGroupJourneyEvent)({action:d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.SUBGROUP_MENTION_CLICK,surface:d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:d("WAWebChatCollection").ChatCollection.get(b)}).commit();b=c("WAWebUnjoinedSubgroupMetadataCollection").get(a.groupJid);if(b){d("WAWebCmd").Cmd.openCommunitySubgroupJoinModal(b,"group_mention");return}b=c("WAWebGroupMetadataCollection").get(a.groupJid);b?d("WAWebFindChatAction").findOrCreateLatestChat(b.id,"groupMentionWrapper").then(function(b){b=b.chat;void d("WAWebCmd").Cmd.openChatBottom(b,d("WAWebChatEntryPoint").ChatEntryPoint.Mention).then(function(b){b&&new(d("WAWebCommunityGroupJourneyEventImpl").CommunityGroupJourneyEvent)({action:d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.GROUP_NAVIGATION,surface:d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:d("WAWebChatCollection").ChatCollection.get(a.groupJid)}).commit()})})["catch"](function(a){return d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to find chat from group mention even though we have gmd for it"]))).devConsole(a)}):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["No local model found for given group mention JID"]))).devConsole(a.groupJid)};b=(b=(b=a.theme)==null?void 0:b.quoted)!=null?b:!1;e=c("WAWebGroupMetadataCollection").get((e=e==null?void 0:e.parentGroup)!=null?e:"");e=e!=null?e.joinedSubgroups.some(function(b){return b.toString()===a.groupJid})||e.unjoinedSubgroups.some(function(b){return b.toString()===a.groupJid}):!1;e=a.clickable===!0&&e===!0&&b===!1;b=e?f:void 0;return l.jsx(d("WAWebMentionMutatorComponentBase.react").MentionBase,{text:a.groupSubject,jid:a.groupJid,theme:a.theme,selectable:a.selectable,lastMessage:a.lastMessage,onClick:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebTextMentionMutatorComponent.react",["WAWebChatTextMentionMutatorComponent.react","WAWebClickable.react","WAWebDisplayType","WAWebGroupMetadataContext","WAWebMiscGatingUtils","WAWebShortNameTextMentionMutatorComponent.react","WAWebWrapperDisplayTypeContext","react"],(function(a,b,c,d,e,f,g){var h,i,j=i||c("react"),k=(h||(h=d("react"))).useContext;function a(a){var b=k(c("WAWebGroupMetadataContext")),e=k(c("WAWebWrapperDisplayTypeContext")),f=j.jsx(c("WAWebChatTextMentionMutatorComponent.react"),babelHelpers["extends"]({},a));d("WAWebMiscGatingUtils").isDropLastNameEnabled()&&b&&(f=j.jsx(c("WAWebShortNameTextMentionMutatorComponent.react"),babelHelpers["extends"]({},a,{groupMetadata:b})));if(d("WAWebMiscGatingUtils").messageListA11yRedesignEnabled()&&e===d("WAWebDisplayType").DISPLAY_TYPE.CONVERSATION)return j.jsx(d("WAWebClickable.react").Clickable,{as:"span",onClick:a.onClick,children:f});return e===d("WAWebDisplayType").DISPLAY_TYPE.EDITING?j.jsx("span",{className:"x1ph7ams",children:f}):f}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WAWebTextMentionWrapperMutatorComponent.react",["fbt","WAWebBotProfileCollection","WAWebChatCollection","WAWebChatEntryPoint","WAWebChatGroupUtils","WAWebCmd","WAWebConfirmPopup.react","WAWebDisplayType","WAWebFindChatAction","WAWebModalManager","WAWebSimpleSignalPNToFBIDMigration","WAWebTextMentionMutatorComponent.react","WAWebWrapperDisplayTypeContext","react"],(function(a,b,c,d,e,f,g,h){var i,j,k=j||c("react"),l=(i||(i=d("react"))).useContext;function a(a){var b=a.contact,e=a.lastMessage,f=a.selectable;a=a.theme;var g=l(c("WAWebWrapperDisplayTypeContext")),i=function(){var a,c;a=(a=d("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidInvoke(b.id))!=null?a:b.id;c=(c=d("WAWebBotProfileCollection").BotProfileCollection.getDefaultBot())==null?void 0:c.id;if(a.isBot()&&!a.equals(c)&&!d("WAWebChatCollection").ChatCollection.get(a)){d("WAWebModalManager").ModalManager.open(k.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){d("WAWebModalManager").ModalManager.close()},children:h._(/*BTDS*/"Starting a new chat with a bot is currently not supported on WhatsApp Web.")}));return}c=d("WAWebChatGroupUtils").getOneToOneContactFromGroupContact(a,"text_mention");if(c==null)return;d("WAWebFindChatAction").findOrCreateLatestChat(c,"textMentionWrapper").then(function(a){a=a.chat;return d("WAWebCmd").Cmd.openChatBottom(a,d("WAWebChatEntryPoint").ChatEntryPoint.Mention)})},j;g!==d("WAWebDisplayType").DISPLAY_TYPE.EDITING&&(j=i);return k.jsx(c("WAWebTextMentionMutatorComponent.react"),{contact:b,theme:a,selectable:f,onClick:j,lastMessage:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebSystemMessageGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return Boolean(d("WAWebABProps").getABPropConfigValue("system_msg_text_styling"))}function b(){return Boolean(d("WAWebABProps").getABPropConfigValue("system_msg_truncation"))}g.systemMessageActionTextStylingEnabled=a;g.systemMessageTextTruncationEnabled=b}),98);
__d("WAWebFormatAddNotification",["fbt","WAWebSystemMessageGatingUtils","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.author,c=a.authorClickable,e=a.subject,f=a.subjectClickable,g=a.participantsClickable;a=a.participantsCount;var i=d("WAWebSystemMessageGatingUtils").systemMessageTextTruncationEnabled();if(b){if(d("WAWebSystemMessagesUtils").isMe(b))return i&&a!=null&&a>3?h._(/*BTDS*/"You added {names} and {participants_count} more",[h._param("names",g),h._param("participants_count",a-2)]):h._(/*BTDS*/"You added {names}",[h._param("names",g)]);else if(d("WAWebSystemMessagesUtils").isMe(e))return c!=null?h._(/*BTDS*/"{user_name} added you",[h._param("user_name",c)]):h._(/*BTDS*/"A member added you");return c!=null?i&&a!=null&&a>3?h._(/*BTDS*/"{user_name} added {names}, {participants_count} more",[h._param("user_name",c),h._param("names",g),h._param("participants_count",a-2)]):h._(/*BTDS*/"{user_name} added {names}",[h._param("user_name",c),h._param("names",g)]):i&&a!=null&&a>3?h._(/*BTDS*/"A member added {names}{participants_count} more",[h._param("names",g),h._param("participants_count",a-2)]):h._(/*BTDS*/"A member added {names}",[h._param("names",g)])}else if(d("WAWebSystemMessagesUtils").isMe(e))return h._(/*BTDS*/"You were added");return h._(/*BTDS*/"{user_name} was added",[h._param("user_name",f)])}g.formatAddNotification=a}),226);
__d("WAWebFormatAnnounceNotification",["fbt","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.author,c=a.authorClickable;a=a.body;return a==="on"?d("WAWebSystemMessagesUtils").isMe(b)?h._(/*BTDS*/"You allowed only admins to send messages to this group"):h._(/*BTDS*/"{user_name} changed this group's settings to allow only admins to send messages to this group",[h._param("user_name",c)]):d("WAWebSystemMessagesUtils").isMe(b)?h._(/*BTDS*/"You changed this group's settings to allow all members to send messages to this group"):h._(/*BTDS*/"{user_name} changed this group's settings to allow all members to send messages to this group",[h._param("user_name",c)])}g.formatAnnounceNotification=a}),226);
__d("WAWebFormatBroadcastNotification",["fbt","WAWebFormatParticipantNames"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.subtype,c=a.body;a=a.recipients;if(b==="create"){c=parseInt(c,10);return h._(/*BTDS*/"_j{\"*\":\"You created a broadcast list with {count} recipients\",\"_1\":\"You created a broadcast list with 1 recipient\"}",[h._plural(c,"count")]).toString()}else if(b==="add"){c=a.length;return h._(/*BTDS*/"_j{\"*\":\"{name} were added to the list\",\"_1\":\"{name} added to the list\"}",[h._plural(c),h._param("name",d("WAWebFormatParticipantNames").getFormattedNames(a,!1))]).toString()}else if(b==="remove"){c=a.length;return h._(/*BTDS*/"_j{\"*\":\"{name} were removed from the list\",\"_1\":\"{name} removed from the list\"}",[h._plural(c),h._param("name",d("WAWebFormatParticipantNames").getFormattedNames(a,!1))]).toString()}return""}g["default"]=a}),226);
__d("WAWebFormatCommunityOwnerUpdateNotification",["fbt","WAWebChatCommunityUtils","WAWebFormatParticipantNames","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.author,c=a.templateParams;a=a.clickable;var e=b?d("WAWebFormatParticipantNames").getFormattedName(b,a):null;c=d("WAWebChatCommunityUtils").getNewCommunityOwnerFromTemplateParams(c);a=c!=null?d("WAWebFormatParticipantNames").getFormattedName(c,a):null;if(b!=null){if(d("WAWebSystemMessagesUtils").isMe(b))return h._(/*BTDS*/"You assigned {user_name} as the new owner.",[h._param("user_name",a)]);else if(d("WAWebSystemMessagesUtils").isMe(c))return h._(/*BTDS*/"{user_name} assigned you as the new owner. Learn more",[h._param("user_name",e)]);return h._(/*BTDS*/"{author_name} assigned {user_name} as the new owner.",[h._param("author_name",e),h._param("user_name",a)])}return d("WAWebSystemMessagesUtils").isMe(c)?h._(/*BTDS*/"You are the new owner. Learn more"):h._(/*BTDS*/"{user_name} is the new owner.",[h._param("user_name",a)])}g.formatCommunityOwnerUpdateNotification=a}),226);
__d("WAWebFormatCreateNotification",["fbt","WAWebSystemMessagesUtils","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(a){var b=a.chat,c=a.author,e=a.authorClickable,f=a.groupSubject;a=a.groupSubjectAsString;a=a?f:j.jsx(d("WAWebSystemMessagesUtils").FormattedText,{text:f});if(d("WAWebSystemMessagesUtils").isMe(c))return f?h._(/*BTDS*/"You created group \"{group_subject}\"",[h._param("group_subject",a)]):h._(/*BTDS*/"You created this group");else if(f)return e!=null?h._(/*BTDS*/"{user_name} created group \"{group_subject}\"",[h._param("user_name",e),h._param("group_subject",a)]):h._(/*BTDS*/"An admin created group \"{group_subject}\"",[h._param("group_subject",a)]);if(e!=null){c=b?b.title():"";return c.trim()===""?h._(/*BTDS*/"{user_name} created this group",[h._param("user_name",e)]):h._(/*BTDS*/"{user_name} created group \"{group_subject}\"",[h._param("user_name",e),h._param("group_subject",c)])}return h._(/*BTDS*/"An admin created this group")}a.displayName=a.name+" [from "+f.id+"]";g.formatCreateNotification=a}),226);
__d("WAWebFormatCreatedSubgroupSuggestionNotification",["fbt","WAWebFormatParticipantNames","WAWebSystemMessageGatingUtils"],(function(a,b,c,d,e,f,g,h){function a(a,b,c){a=d("WAWebFormatParticipantNames").getFormattedName(a,c);c=b[0];b=d("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();return b?h._(/*BTDS*/"{suggestion-owner} suggested the group \"{suggested-group-name}\"",[h._param("suggestion-owner",a),h._param("suggested-group-name",c)]):h._(/*BTDS*/"{suggestion-owner} suggested the group \"{suggested-group-name}\". Click to approve or reject.",[h._param("suggestion-owner",a),h._param("suggested-group-name",c)])}g["default"]=a}),226);
__d("WAWebFormatDeleteNotification",["fbt","WAWebChatGroupUtils"],(function(a,b,c,d,e,f,g,h){function a(a){a=a.chat;return d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(a)?h._(/*BTDS*/"This community is no longer available"):d("WAWebChatGroupUtils").isSupportGroup(a)?h._(/*BTDS*/"This chat has been closed"):h._(/*BTDS*/"This group has ended")}g.formatDeleteNotification=a}),226);
__d("WAWebWamEnumSystemMessageTypeType",[],(function(a,b,c,d,e,f){a=Object.freeze({E2E_ENCRYPTED_MESSAGES_CALLS:1,E2E_ENCRYPTED_MESSAGES:2,E2E_ENCRYPTED_BROADCAST_LIST:3,E2E_ENCRYPTED_MESSAGE_YOURSELF:4,OFFICIAL_ACCOUNT_INFO:8,GROUP_ADD:9,GROUP_RESET_INVITE:10,COMMUNITY_DESCRIPTION_CHANGED:11,GROUP_DESCRIPTION_CHANGED:12,GROUP_PARTICIPANTS_CHANGED:13,COMMUNITY_MEMBERS_CHANGED:14,GROUP_INVITE_LINK_UNAVAILABLE:15,GROUP_INVITE_LINK_AVAILABLE:16,GROUP_JOIN_REQUEST:17,GROUP_SUGGEST:18});f.SYSTEM_MESSAGE_TYPE_TYPE=a}),66);
__d("WAWebFormatDescriptionNotification",["fbt","WAWebSystemMessageGatingUtils","WAWebSystemMessagesUtils","WAWebWamEnumSystemMessageTypeType"],(function(a,b,c,d,e,f,g,h){var i=d("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();function j(a){var b=a.author,c=a.authorClickable,e=a.isParentGroup;e=e===void 0?!1:e;a=a.shouldFormatAsLastMsg;a=a===void 0?!1:a;if(a){if(d("WAWebSystemMessagesUtils").isMe(b))return e===!0?{text:h._(/*BTDS*/"You changed the community description"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:h._(/*BTDS*/"You changed the group description"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED};else if(c!=null)return e===!0?{text:h._(/*BTDS*/"{user_name} changed the community description",[h._param("user_name",c)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:h._(/*BTDS*/"{user_name} changed the group description",[h._param("user_name",c)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED};return e===!0?{text:h._(/*BTDS*/"A member changed the community description"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:h._(/*BTDS*/"A member changed the group description"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED}}if(d("WAWebSystemMessagesUtils").isMe(b))return e===!0?{text:i?h._(/*BTDS*/"You changed the community description"):h._(/*BTDS*/"You changed the community description. Click to view"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:i?h._(/*BTDS*/"You changed the group description"):h._(/*BTDS*/"You changed the group description. Click to view."),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED};else if(c!=null)return e===!0?{text:i?h._(/*BTDS*/"{user_name} changed the community description",[h._param("user_name",c)]):h._(/*BTDS*/"{user_name} changed the community description. Click to view",[h._param("user_name",c)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:i?h._(/*BTDS*/"{user_name} changed the group description",[h._param("user_name",c)]):h._(/*BTDS*/"{user_name} changed the group description. Click to view",[h._param("user_name",c)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_DESCRIPTION_CHANGED};return e===!0?{text:i?h._(/*BTDS*/"A member changed the community description"):h._(/*BTDS*/"A member changed the community description. Click to view"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}:{text:i?h._(/*BTDS*/"A member changed the group description"):h._(/*BTDS*/"A member changed the group description. Click to view"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.COMMUNITY_DESCRIPTION_CHANGED}}function a(a){var b=a.author,c=a.authorClickable,d=a.isParentGroup;d=d===void 0?!1:d;a=a.shouldFormatAsLastMsg;a=a===void 0?!1:a;return j({author:b,authorClickable:c,isParentGroup:d,shouldFormatAsLastMsg:a}).text}g.formatDescriptionNotification=a}),226);
__d("WAWebLimitSharingGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("render_updated_disclosure")}function b(){return d("WAWebABProps").getABPropConfigValue("limit_sharing_enabled_for_group_chat")}function c(){return d("WAWebABProps").getABPropConfigValue("limit_sharing_enabled_for_1on1_chat")}function e(){return d("WAWebABProps").getABPropConfigValue("limit_sharing_update_enabled_web")}function f(){return d("WAWebABProps").getABPropConfigValue("limit_sharing_protocol_message_receiver_enabled")}function h(){return d("WAWebABProps").getABPropConfigValue("advanced_chat_privacy_content_update_july_25")}g.isRenderUpdatedDisclosureGatingEnabled=a;g.isLimitSharingSetterGatingEnabledForGroupChat=b;g.isLimitSharingSetterGatingEnabledFor1on1Chat=c;g.isLimitSharingSetterUpdateGatingEnabledForWeb=e;g.isLimitSharingReceiverGatingEnabledForChat=f;g.isLimitSharingContentUpdateJuly25Enabled=h}),98);
__d("WAWebFormatE2ENotification",["fbt","WALogger","WAWebChatGetters","WAWebChatGroupUtils","WAWebContactCollection","WAWebContactGetters","WAWebFormatE2ENotificationForDeviceChange","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebLimitSharingGatingUtils","WAWebMsgGetters","WAWebSupportChatStrings","WAWebSystemMessageGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumSystemMessageTypeType","WAWebWid","WAWebWidFormat"],(function(a,b,c,d,e,f,g,h){var i;function j(a){var b=d("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled();switch(a.subtype){case"identity":var e=a.body==null?null:d("WAWebContactCollection").ContactCollection.get(a.body);if(e!=null&&d("WAWebContactGetters").getIsMe(e)){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["generateE2ENotification: receive identity notification of self"]))).sendLogs("SelfIdentityNotificationError");var f=d("WAWebFrontendMsgGetters").getChat(a.unsafe());if(d("WAWebChatGetters").getIsUser(f)){var g=f.contact?d("WAWebFrontendContactGetters").getFormattedName(f.contact):d("WAWebWidFormat").widToFormattedUser(f.id);return{text:b?h._(/*BTDS*/"Your security code with {contactName} changed",[h._param("contactName",g)]):h._(/*BTDS*/"Your security code with {contactName} changed. Click to learn more",[h._param("contactName",g)])}}else if(d("WAWebChatGetters").getIsGroup(f))return{text:b?h._(/*BTDS*/"Your security code with all members changed"):h._(/*BTDS*/"Your security code with all members changed. Click to learn more")};else if(d("WAWebChatGetters").getIsBroadcast(f))return{text:b?h._(/*BTDS*/"Your security code with all recipients changed"):h._(/*BTDS*/"Your security code with all recipients changed. Click to learn more")}}g=e?d("WAWebFrontendContactGetters").getFormattedName(e):d("WAWebWidFormat").widToFormattedUser(a.body);return{text:b?h._(/*BTDS*/"Your security code with {contactName} changed",[h._param("contactName",g)]):h._(/*BTDS*/"Your security code with {contactName} changed. Click to learn more",[h._param("contactName",g)])};case"device":return{text:d("WAWebFormatE2ENotificationForDeviceChange").formatE2ENotificationForDeviceChange(a),enumType:d("WAWebFormatE2ENotificationForDeviceChange").getE2ENotificationForDeviceChangeEnum(a)};case"encrypt":f=a.id.remote;if(c("WAWebWid").isGroup(f)){if(d("WAWebChatGroupUtils").isSupportGroup(d("WAWebFrontendMsgGetters").getMaybeChat(a.unsafe())))return{text:d("WAWebSupportChatStrings").SupportChatSystemMessage()};return d("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:b?h._(/*BTDS*/"Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them"):h._(/*BTDS*/"Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}:{text:b?h._(/*BTDS*/"Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them"):h._(/*BTDS*/"Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}}else if(d("WAWebMsgGetters").getIsCAPISupport(a))return{text:d("WAWebSupportChatStrings").SupportChatSystemMessage()};else if(c("WAWebWid").isBroadcast(f))return{text:b?h._(/*BTDS*/"Messages you send to this broadcast list are secured with end-to-end encryption"):h._(/*BTDS*/"Messages you send to this broadcast list are secured with end-to-end encryption. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_BROADCAST_LIST};else if(d("WAWebUserPrefsMeUser").isMeAccount(f))return d("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:b?h._(/*BTDS*/"Messages to yourself are end-to-end encrypted. No one else, not even WhatsApp, can read, listen to, or share them"):h._(/*BTDS*/"Messages to yourself are end-to-end encrypted. No one else, not even WhatsApp, can read, listen to, or share them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGE_YOURSELF}:{text:b?h._(/*BTDS*/"Messages to yourself are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them"):h._(/*BTDS*/"Messages to yourself are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGE_YOURSELF};return d("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:b?h._(/*BTDS*/"Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them"):h._(/*BTDS*/"Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES}:{text:b?h._(/*BTDS*/"Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them"):h._(/*BTDS*/"Messages are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES};case"encrypt_now":return d("WAWebLimitSharingGatingUtils").isRenderUpdatedDisclosureGatingEnabled()?{text:b?h._(/*BTDS*/"Messages and calls are now end-to-end encrypted. Only people in this chat can read, listen to, or share them"):h._(/*BTDS*/"Messages and calls are now end-to-end encrypted. Only people in this chat can read, listen to, or share them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES_CALLS}:{text:b?h._(/*BTDS*/"Messages and calls are now end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them"):h._(/*BTDS*/"Messages and calls are now end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.E2E_ENCRYPTED_MESSAGES_CALLS};case"e2e_identity_unavailable":return{text:h._(/*BTDS*/"Security code notifications are no longer available for this chat")};case"chat_psa":return{text:b?h._(/*BTDS*/"This is an official account of WhatsApp"):h._(/*BTDS*/"This is an official account of WhatsApp. Click to learn more"),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.OFFICIAL_ACCOUNT_INFO};default:return{text:""}}}function a(a){return j(a).text}function b(a){return j(a).enumType}g.formatE2ENotification=a;g.getE2ENotificationEnum=b}),226);
__d("WAWebFormatE2ENotificationForDeviceChange",["fbt","invariant","WAWebChatGetters","WAWebContactCollection","WAWebContactGetters","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebSystemMessageGatingUtils","WAWebWidFormat"],(function(a,b,c,d,e,f,g,h,i){function j(a,b){b===void 0&&(b=!1);a.subtype==="device"||i(0,56347);var c=d("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled(),e=a.body?d("WAWebContactCollection").ContactCollection.get(a.body):null,f,g=a.devicesAdded===1&&a.devicesRemoved===0,j=a.devicesAdded===0&&a.devicesRemoved===1,k=!g&&!j;if(e!=null&&d("WAWebContactGetters").getIsMe(e)){var l=d("WAWebFrontendMsgGetters").getChat(a.unsafe());if(d("WAWebChatGetters").getIsUser(l)){var m=d("WAWebFrontendContactGetters").getFormattedName(l.contact);!b?f=c?h._(/*BTDS*/"Your security code with {contactName} changed",[h._param("contactName",m)]):h._(/*BTDS*/"Your security code with {contactName} changed. Click to learn more",[h._param("contactName",m)]):g?a.isThisDeviceAdded?f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a login on this device.",[h._param("contactName",m)]):f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a login on a new device of yours.",[h._param("contactName",m)]):j?f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a logout from one of your devices.",[h._param("contactName",m)]):k&&(f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a login or logout from one or more of your devices.",[h._param("contactName",m)]))}else d("WAWebChatGetters").getIsGroup(l)?!b?f=c?h._(/*BTDS*/"Your security code with all members changed"):h._(/*BTDS*/"Your security code with all members changed. Click to learn more"):g?a.isThisDeviceAdded?f=h._(/*BTDS*/"Your security code with all members changed because there was a login on this device. To verify a contact's security code, open their Contact Info page and click \"Encryption\"."):f=h._(/*BTDS*/"Your security code with all members changed because there was a login on a new device of yours. To verify a contact's security code, open their Contact Info page and click \"Encryption\""):j?f=h._(/*BTDS*/"Your security code with all members changed because there was a logout from one of your devices. To verify a contact's security code, open their Contact Info page and click \"Encryption\"."):k&&(f=h._(/*BTDS*/"Your security code with all members changed because there was a login or logout from one or more of your devices. To verify a contact's security code, open their Contact Info page and click \"Encryption\".")):d("WAWebChatGetters").getIsBroadcast(l)&&(!b?f=c?h._(/*BTDS*/"Your security code with all recipients changed"):h._(/*BTDS*/"Your security code with all recipients changed. Click to learn more"):g?a.isThisDeviceAdded?f=h._(/*BTDS*/"Your security code with all recipients changed because there was a login on this device. To verify a contact's security code, open their Contact Info page and click \"Encryption\"."):f=h._(/*BTDS*/"Your security code with all recipients changed because there was a login on a new device of yours. To verify a contact's security code, open their Contact Info page and click \"Encryption\"."):j?f=h._(/*BTDS*/"Your security code with all recipients changed because there was a logout from one of your devices. To verify a contact's security code, open their Contact Info page and click \"Encryption\"."):k&&(f=h._(/*BTDS*/"Your security code with all recipients changed because there was a login or logout from one or more of your devices. To verify a contact's security code, open their Contact Info page and click \"Encryption\".")))}else{m=a.body;e=m==null?null:d("WAWebContactCollection").ContactCollection.get(m);l=e?d("WAWebFrontendContactGetters").getFormattedName(e):d("WAWebWidFormat").widToFormattedUser(m);!b?f=c?h._(/*BTDS*/"Your security code with {contactName} changed",[h._param("contactName",l)]):h._(/*BTDS*/"Your security code with {contactName} changed. Click to learn more",[h._param("contactName",l)]):g?f=h._(/*BTDS*/"Your security code with {contactName} changed because they registered WhatsApp on their phone again.",[h._param("contactName",l)]):j?f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a logout from one of their devices.",[h._param("contactName",l)]):k&&(f=h._(/*BTDS*/"Your security code with {contactName} changed because there was a login or logout from one or more of their devices.",[h._param("contactName",l)]))}f!=null||i(0,56348);return{text:f}}function a(a,b){b===void 0&&(b=!1);return j(a,b).text}function b(a,b){b===void 0&&(b=!1);return j(a,b).enumType}g.formatE2ENotificationForDeviceChange=a;g.getE2ENotificationForDeviceChangeEnum=b}),226);
__d("WAWebFormatEphemeralSetting",["fbt","WALogger","WANullthrows","WAWebABProps","WAWebBizCoexGatingUtils","WAWebChatEphemerality","WAWebContactCollection","WAWebContactGetters","WAWebEphemeralConstants","WAWebEphemeralFbtKic","WAWebEphemeralityTypes","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebWid","err"],(function(a,b,c,d,e,f,g,h){var i,j;function a(a){a=m(a);var b=a.newDuration;a=a.initiatingUser;var e=d("WAWebUserPrefsMeUser").isMeAccount(c("WANullthrows")(a));if(e)e=d("WAWebEphemeralFbtKic").getDisappearingModeYouStringKic(b);else{a=d("WAWebContactCollection").ContactCollection.gadd(c("WANullthrows")(a));e=d("WAWebEphemeralFbtKic").getDisappearingModeOtherStringKic(b,d("WAWebFrontendContactGetters").getFormattedName(a))}return e}function b(a){return r(d("WAWebStateUtils").unproxy(a.unsafe()))}function k(a){if(d("WAWebFrontendMsgGetters").getChat(a)!=null){var b=d("WAWebFrontendMsgGetters").getChat(a).msgs;a=b.indexOf(a);for(a=a-1;a>=0;a--){var c=b.at(a);if(c!=null&&c.type!=="debug"&&(c.type!=="gp2"||c.subtype==="ephemeral"))return c}}}function l(a){a=k(a);if(a!=null){if(a.ephemeralDuration!=null&&a.ephemeralDuration>0)return!0;if((a.subtype==="ephemeral"||a.subtype==="disappearing_mode")&&a.templateParams[0]!=null&&a.templateParams[0]!=="0")return!0}return!1}function m(a){var b,d;a.templateParams.length?(d=parseInt(a.templateParams[0],10),b=a.templateParams[1]):(b=a.ephemeralSettingUser,d=a.ephemeralDuration);if(d==null)throw c("err")("Duration cannot be null for DM notification");return{newDuration:d!=null?d:0,disappearingModeTrigger:null,initiatingUser:b}}function n(a){var b,c;a.ephemeralSettingUser!==void 0?c=a.ephemeralSettingUser:c=a.from;return{newDuration:(b=a.ephemeralDuration)!=null?b:0,disappearingModeTrigger:a.disappearingModeTrigger,initiatingUser:c}}function o(a){var b=a.initiatorUsername,c=a.initiatorIsMe;a=a.state;if(c){if(a==="update")return h._(/*BTDS*/"You updated the message timer.");else if(a==="on")return h._(/*BTDS*/"You turned on disappearing messages.");return h._(/*BTDS*/"You turned off disappearing messages.")}else if(b!=null){if(a==="update")return h._(/*BTDS*/"{name} updated the message timer.",[h._param("name",b)]);else if(a==="on")return h._(/*BTDS*/"{name} turned on disappearing messages.",[h._param("name",b)]);return h._(/*BTDS*/"{name} turned off disappearing messages.",[h._param("name",b)])}if(a==="update")return h._(/*BTDS*/"The message timer was updated.");else if(a==="on")return h._(/*BTDS*/"Disappearing messages was turned on.");return h._(/*BTDS*/"Disappearing messages was turned off.")}function p(a){a=d("WAWebEphemeralConstants").getDurationForString(a);var b=a.duration;a=a.unit;switch(a){case d("WAWebEphemeralConstants").DurationUnit.Seconds:return h._(/*BTDS*/"_j{\"*\":\"{duration} seconds\",\"_1\":\"1 second\"}",[h._plural(b,"duration")]);case d("WAWebEphemeralConstants").DurationUnit.Minutes:return h._(/*BTDS*/"_j{\"*\":\"{duration} minutes\",\"_1\":\"1 minute\"}",[h._plural(b,"duration")]);case d("WAWebEphemeralConstants").DurationUnit.Hours:return h._(/*BTDS*/"_j{\"*\":\"{duration} hours\",\"_1\":\"1 hour\"}",[h._plural(b,"duration")]);case d("WAWebEphemeralConstants").DurationUnit.Days:return h._(/*BTDS*/"_j{\"*\":\"{duration} days\",\"_1\":\"1 day\"}",[h._plural(b,"duration")]);case d("WAWebEphemeralConstants").DurationUnit.Weeks:d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingMessageDurationString: Weeks are not an option for DM system messages"])));return h._(/*BTDS*/"_j{\"*\":\"{duration} weeks\",\"_1\":\"1 week\"}",[h._plural(b,"duration")])}}function q(a){a=p(a);return h._(/*BTDS*/"New messages will disappear from this chat {dm-duration} after they're sent, except when kept.",[h._param("dm-duration",a)])}function r(a){var b=null;switch(a.type){case"gp2":case"notification_template":b=m(a);break;case"protocol":b=n(a);break;default:break}if(b==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Cannot parse msg to build DM system message"]))).tags("DM","DDM").devConsole(a);throw c("err")("Cannot parse msg to build DM system message")}var e=null,f=d("WAWebUserPrefsMeUser").isMePrimary(b.initiatingUser);if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&b.disappearingModeTrigger===d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting)return s(f);var g=null;!b.newDuration?g="off":l(a)?g="update":g="on";g==="update"&&!d("WAWebABProps").getABPropConfigValue("dm_updated_system_message")&&(g="on");if(b.initiatingUser!=null&&!f){var h=d("WAWebContactCollection").ContactCollection.gadd(b.initiatingUser);e=d("WAWebContactGetters").getIsMyContact(h)?d("WAWebFrontendContactGetters").getFormattedName(h):d("WAWebFrontendContactGetters").getFormattedUsernameOrPhone(h)}h=d("WAWebFrontendMsgGetters").getMaybeChat(a);h=h&&d("WAWebChatEphemerality").shouldShowEphemeralSetting(h)&&(c("WAWebWid").isUser(h.id)||((a=h.groupMetadata)==null?void 0:a.canSetEphemeralSetting()));return t({newDuration:b.newDuration,state:g,initiatorUsername:e,initiatorIsMe:f,userCanChange:h===!0})}function s(a){var b=h._(/*BTDS*/"Disappearing messages are no longer supported with this business."),c=h._(/*BTDS*/"Disappearing messages are no longer supported with your business.");return a?c:b}function t(a){var b=a.newDuration,c=a.state,d=a.initiatorUsername,e=a.initiatorIsMe;a=a.userCanChange;d=o({initiatorUsername:d,initiatorIsMe:e,state:c});e=h._(/*BTDS*/"Click to change.");if(!b)return a!==!0?d:h._(/*BTDS*/"{dm-sm-event} {dm-sm-action}",[h._param("dm-sm-event",d),h._param("dm-sm-action",e)]);c=q(b);return a!==!0?h._(/*BTDS*/"{dm-sm-event} {dm-sm-explanation}",[h._param("dm-sm-event",d),h._param("dm-sm-explanation",c)]):h._(/*BTDS*/"{dm-sm-event} {dm-sm-explanation} {dm-sm-action}",[h._param("dm-sm-event",d),h._param("dm-sm-explanation",c),h._param("dm-sm-action",e)])}function e(){return h._(/*BTDS*/"Disappearing messages are not supported in this chat. Your messages will not disappear.")}g.getDefaultDisappearingModeSystemMessageText=a;g.getDisappearingModeUpdateSystemMessageText=b;g.getDisappearingMessageDurationString=p;g.formatEphemeralSetting=r;g.buildEphemeralSystemMessage=t;g.getDMUnsupportedSystemMessageText=e}),226);
__d("WAWebFormatAllowNonAdminSubGroupCreationNotification",["fbt","WAWebCommunityGatingUtils","WAWebGroupType"],(function(a,b,c,d,e,f,g,h){function a(a,b){b=b[0]&&d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(b[0].toString())===d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On;a=Boolean((a=a.groupMetadata)==null?void 0:a.participants.iAmAdmin());if(b)return a?h._(/*BTDS*/"Everyone in this community can now add groups. Click to change."):h._(/*BTDS*/"Everyone in this community can now add groups.");return d("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()?a?h._(/*BTDS*/"Only community admins can add groups. Members can suggest groups for admin approval. Click to change."):h._(/*BTDS*/"Only community admins can add groups. Members can suggest groups for admin approval."):a?h._(/*BTDS*/"Only admins in this community can now add groups. Click to change."):h._(/*BTDS*/"Only admins in this community can now add groups.")}g["default"]=a}),226);
__d("WAWebMessageCommunityEmptySubgroupWelcomeTitle.react",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a){return h._(/*BTDS*/"You created the group: {subgroup_name}",[h._param("subgroup_name",a)])}g.communityEmptySubgroupWelcomeTitle=a}),226);
__d("WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react",["fbt","WAWebCommunityGatingUtils","WAWebGroupType"],(function(a,b,c,d,e,f,g,h){function a(a,b){b=(b=d("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.cast((b=b[0])==null?void 0:b.toString()))!=null?b:d("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.Full;if(b===d("WAWebGroupType").GeneralChatAutoAddDisabledReasonEnum.Server)return h._(/*BTDS*/"New community members will no longer be automatically added.");return d("WAWebCommunityGatingUtils").communityGeneralChatV2Enabled()?h._(/*BTDS*/"\"{subgroup_name}\" is now full.",[h._param("subgroup_name",a)]):h._(/*BTDS*/"\"{subgroup_name}\" is now full. New community members will no longer be automatically added to it.",[h._param("subgroup_name",a)])}g.communityGeneralChatAutoAddDisabledNotification=a}),226);
__d("WAWebMessageCommunityGeneralChatWelcomeTitle.react",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a){return h._(/*BTDS*/"Welcome to the group: {subgroup_name}",[h._param("subgroup_name",a)])}g.communityGeneralChatWelcomeTitle=a}),226);
__d("WAWebFormatGroupNotification",["fbt","WALogger","WAWebChatGroupUtils","WAWebContactCollection","WAWebFormatAddNotification","WAWebFormatAllowNonAdminSubGroupCreationNotification","WAWebFormatAnnounceNotification","WAWebFormatCommunityOwnerUpdateNotification","WAWebFormatCreateNotification","WAWebFormatCreatedSubgroupSuggestionNotification","WAWebFormatDeleteNotification","WAWebFormatDescriptionNotification","WAWebFormatEphemeralSetting","WAWebFormatLeaveNotification","WAWebFormatLinkNotification","WAWebFormatMembershipApprovalNotification","WAWebFormatParticipantNames","WAWebFormatPictureNotification","WAWebFormatPromoteDemoteNotification","WAWebFormatRemoveNotification","WAWebFormatReportToAdminNotification","WAWebFormatRestrictNotification","WAWebFormatSubjectNotification","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebL10N","WAWebMessageCommunityEmptySubgroupWelcomeTitle.react","WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react","WAWebMessageCommunityGeneralChatWelcomeTitle.react","WAWebMessageCommunityLinkGroup.react","WAWebMessageCommunitySubgroupWelcome.react","WAWebMessageCommunityWelcomeAdmin.react","WAWebMessageCommunityWelcomeMember.react","WAWebUserPrefsMeUser","WAWebWidFormat"],(function(a,b,c,d,e,f,g,h){var i;function a(a,b){var e="",f=a.get("type"),g=a.get("subtype"),j=a.displayName(),k=a.get("author"),l=a.get("body"),m,n;b=!!b;if(f!=="gp2")return e;f=a.recipients||[];var o=d("WAWebFormatParticipantNames").getFormattedNames(f,!1),p=f[0],q=p?d("WAWebContactCollection").ContactCollection.get(p):void 0;q=q?d("WAWebFrontendContactGetters").getFormattedName(q):p?d("WAWebWidFormat").widToFormattedUser(p):"";switch(g){case"add":e=d("WAWebFormatAddNotification").formatAddNotification({author:k,authorClickable:j,subject:p,subjectClickable:q,participantsClickable:o});break;case"remove":e=d("WAWebFormatRemoveNotification").formatRemoveNotification({author:k,authorClickable:j,subject:p,subjectClickable:q,participantsClickable:o});break;case"leave":e=d("WAWebFormatLeaveNotification").formatLeaveNotification({body:l,subject:p,participantsClickable:o});break;case"picture":e=d("WAWebFormatPictureNotification").formatPictureNotification({author:k,authorClickable:j,body:l});break;case"subject":e=d("WAWebFormatSubjectNotification").formatSubjectNotification(d("WAWebFrontendMsgGetters").getChat(a),k,j,l);break;case"modify":m=d("WAWebWidFormat").widToFormattedUser(k);n=d("WAWebWidFormat").widToFormattedUser(p);e=m===j?h._(/*BTDS*/"{name} changed to {new_number}",[h._param("name",j),h._param("new_number",n)]):h._(/*BTDS*/"{name} changed their phone number to a new number.",[h._param("name",j)]);break;case"create":e=d("WAWebFormatCreateNotification").formatCreateNotification({author:k,authorClickable:j,groupSubject:l,groupSubjectAsString:!0});break;case"delete":e=d("WAWebFormatDeleteNotification").formatDeleteNotification({chat:d("WAWebFrontendMsgGetters").getChat(a)});break;case"promote":case"demote":case"linked_group_promote":case"linked_group_demote":e=d("WAWebFormatPromoteDemoteNotification").formatPromoteDemoteNotification({subtype:g,subject:p,subjectClickable:q,participantsClickable:o,participantsCount:f.length});break;case"invite":e=d("WAWebUserPrefsMeUser").isMeAccount(p)?h._(/*BTDS*/"You joined via an invite link"):h._(/*BTDS*/"{name} joined via an invite link",[h._param("name",q)]);break;case"revoke_invite":e=d("WAWebUserPrefsMeUser").isMeAccount(k)?h._(/*BTDS*/"You reset this group's invite link. Click to view the new invite link."):h._(/*BTDS*/"{name} reset this group's invite link. Click to view the new invite link.",[h._param("name",j)]);break;case"description":e=d("WAWebFormatDescriptionNotification").formatDescriptionNotification({author:k,authorClickable:j,shouldFormatAsLastMsg:b});break;case"parent_group_description":e=d("WAWebFormatDescriptionNotification").formatDescriptionNotification({author:k,authorClickable:j,isParentGroup:!0,shouldFormatAsLastMsg:b});break;case"announce":e=d("WAWebFormatAnnounceNotification").formatAnnounceNotification({author:k,authorClickable:j,body:l});break;case"restrict":e=d("WAWebFormatRestrictNotification").formatRestrictNotification({author:k,authorClickable:j,templateParams:a.templateParams});break;case"no_frequently_forwarded":l==="on"?e=d("WAWebUserPrefsMeUser").isMeAccount(k)?h._(/*BTDS*/"You changed this group's settings to not allow messages that have been forwarded many times."):h._(/*BTDS*/"{name} changed this group's settings to not allow messages that have been forwarded many times.",[h._param("name",j)]):e=d("WAWebUserPrefsMeUser").isMeAccount(k)?h._(/*BTDS*/"You changed this group's settings to allow messages that have been forwarded many times."):h._(/*BTDS*/"{name} changed this group's settings to allow messages that have been forwarded many times.",[h._param("name",j)]);break;case"announce_msg_bounce":e=h._(/*BTDS*/"Only admins can message this group.");break;case"v4_add_invite_sent":e=h._(/*BTDS*/"You invited {participants}",[h._param("participants",o)]).toString();break;case"v4_add_invite_join":e=h._(/*BTDS*/"{participants} joined using your invite",[h._param("participants",o)]).toString();break;case"ephemeral":return d("WAWebFormatEphemeralSetting").formatEphemeralSetting(a);case"growth_locked":e=h._(/*BTDS*/"Invite via link became unavailable. Click to learn more.");break;case"growth_unlocked":e=h._(/*BTDS*/"Invite via link became available again. Click to view the new invite link.");break;case"linked_group_join":case"parent_group_link":case"parent_group_link_membership_approval":case"sibling_group_link":case"sub_group_link":case"parent_group_unlink":case"sibling_group_unlink":case"sub_group_unlink":case"integrity_parent_group_unlink":case"delete_parent_group":case"delete_parent_group_unlink":case"auto_add":case"default_sub_group_admin_add":case"invite_auto_add":e=d("WAWebFormatLinkNotification").formatLinkNotifAsFbt(g,k,p,a.templateParams);break;case"community_participant_add_rich":case"community_invite_rich":case"community_invite_auto_add_rich":case"subgroup_admin_triggered_auto_add":case"subgroup_admin_triggered_invite_auto_add":e=d("WAWebMessageCommunityWelcomeMember.react").communityWelcomeMemberTitle();break;case"sub_group_participant_add_rich":case"sub_group_invite_rich":e=d("WAWebMessageCommunitySubgroupWelcome.react").communitySubgroupWelcomeTitle({templateParams:a.templateParams,clickable:!1,author:k});break;case"community_link_parent_group_rich":e=d("WAWebMessageCommunityLinkGroup.react").communityLinkGroupTitle({templateParams:a.templateParams,clickable:!1,author:k});break;case"community_create":e=d("WAWebMessageCommunityWelcomeAdmin.react").communityWelcomeAdminTitle({templateParams:a.templateParams,author:k,chat:d("WAWebFrontendMsgGetters").getChat(a)});break;case"membership_approval_mode":case"membership_approval_request":case"created_membership_requests":e=d("WAWebFormatMembershipApprovalNotification").formatMembershipApprovalNotification(g,k,a.templateParams);break;case"ephemeral_keep_in_chat":e=h._(/*BTDS*/"Disappearing messages now support keeping messages in the chat. Click to learn more.");break;case"initial_pHash_mismatch":case"default_sub_group_promote":case"default_sub_group_demote":d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(d("WAWebFrontendMsgGetters").getChat(a))?e=h._(/*BTDS*/"Community members have changed. Click to view"):e=h._(/*BTDS*/"Group members have changed. Click to view");break;case"allow_admin_reports":e=d("WAWebFormatReportToAdminNotification").formatReportToAdminNotification(k,a.templateParams);break;case"allow_non_admin_sub_group_creation":e=c("WAWebFormatAllowNonAdminSubGroupCreationNotification")(d("WAWebFrontendMsgGetters").getChat(a),a.templateParams);break;case"empty_subgroup_create":m=a.templateParams[2];e=d("WAWebMessageCommunityEmptySubgroupWelcomeTitle.react").communityEmptySubgroupWelcomeTitle(m);break;case"created_subgroup_suggestion":e=c("WAWebFormatCreatedSubgroupSuggestionNotification")(k,a.templateParams,!1);break;case"general_chat_add":n=a.templateParams[1];e=d("WAWebMessageCommunityGeneralChatWelcomeTitle.react").communityGeneralChatWelcomeTitle(n);break;case"general_group_auto_add_disabled":e=d("WAWebMessageCommunityGeneralChatAutoAddDisabledNotification.react").communityGeneralChatAutoAddDisabledNotification(d("WAWebFrontendMsgGetters").getChat(a).formattedTitle,a.templateParams);break;case"community_owner_update":e=d("WAWebFormatCommunityOwnerUpdateNotification").formatCommunityOwnerUpdateNotification({author:k,templateParams:a.templateParams,clickable:!1});break;default:d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wa:formatGroupNotification:unknown message subtype: ",""])),g);break}c("WAWebL10N").isRTL()&&(e=c("WAWebL10N").forceRTL(String(e)));return e}g["default"]=a}),226);
__d("WAWebFormatLeaveNotification",["fbt","WAWebGroupType","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.body,c=a.subject;a=a.participantsClickable;if(c)return d("WAWebSystemMessagesUtils").isMe(c)?h._(/*BTDS*/"You left"):h._(/*BTDS*/"{user_name} left",[h._param("user_name",a)]);else if(b===d("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT)return h._(/*BTDS*/"This community is no longer available");return h._(/*BTDS*/"This group has ended")}g.formatLeaveNotification=a}),226);
__d("WAWebStringsWithMultiplePluralParts",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a,b){return h._(/*BTDS*/"_j{\"*\":{\"*\":\"{count} messages couldn't be forwarded because {contact} is on a version of WhatsApp that doesn't support them.\"},\"_1\":{\"_1\":\"1 message couldn't be forwarded because {contact} is on a version of WhatsApp that doesn't support it.\"}}",[h._plural(a,"count"),h._plural(a),h._param("contact",b)]).toString()}function b(a,b){return h._(/*BTDS*/"_j{\"*\":{\"*\":\"{count} messages couldn't be forwarded because the file is missing or {contact} is on a version of WhatsApp that doesn't support them.\"},\"_1\":{\"_1\":\"1 message couldn't be forwarded because the file is missing or {contact} is on a version of WhatsApp that doesn't support it.\"}}",[h._plural(a,"count"),h._plural(a),h._param("contact",b)]).toString()}function c(a,b){return i(a,b).toString()}function i(a,b){return h._(/*BTDS*/"_j{\"*\":{\"*\":\"Groups {group-names} were added\"},\"_1\":{\"_1\":\"Group {group-names} was added\"}}",[h._plural(b),h._plural(b),h._param("group-names",a.formattedNames)])}function d(a,b){return j(a,b).toString()}function j(a,b){return h._(/*BTDS*/"_j{\"*\":{\"*\":\"The groups {group-names} were removed\"},\"_1\":{\"_1\":\"The group {group-names} was removed\"}}",[h._plural(b),h._plural(b),h._param("group-names",a.formattedNames)])}g.getCannotForwardCapabilityContactString=a;g.getCannotForwardFileMissingAndCapabilityContactString=b;g.getCommunityGroupsAddedString=c;g.getCommunityGroupsAddedStringComponent=i;g.getCommunityGroupsRemovedString=d;g.getCommunityGroupsRemovedStringComponent=j}),226);
__d("WAWebFormatLinkNotification",["fbt","WALogger","WAWebFormatParticipantNames","WAWebPairList","WAWebStringsWithMultiplePluralParts","WAWebUserPrefsMeUser","WAWebWid"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v=function(a){return a instanceof c("WAWebWid")&&d("WAWebUserPrefsMeUser").isMeAccount(a)};function w(a){return!a}function a(a,b,c,d){return x(a,b,c,d,!1)}function x(a,b,c,e,f){var g=b?d("WAWebFormatParticipantNames").getFormattedName(b,f,a):null,h=c?d("WAWebFormatParticipantNames").getFormattedName(c,f):null;switch(a){case"parent_group_link":return H(e,f,b,g);case"sibling_group_link":return I(e,f,b,g,a);case"sub_group_link":break;case"parent_group_unlink":return G(e,f,b,g);case"integrity_parent_group_unlink":return F(e,f);case"delete_parent_group_unlink":case"delete_parent_group":return E(e,g,b,f);case"sibling_group_unlink":return J(e,f,b,g);case"sub_group_unlink":break;case"community_create":return K(e,f,b,g);case"linked_group_join":return L(c,h);case"auto_add":case"default_sub_group_admin_add":return M(e,f,g);case"invite_auto_add":return N(e,f,c,h);default:d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wa:formatLinkNotification:unknown message subtype: ",""])),a);break}}function y(a){return h._(/*BTDS*/"You created the community \"{community_name}\"",[h._param("community_name",a)])}function z(){return h._(/*BTDS*/"You created the community")}function A(a,b){return h._(/*BTDS*/"{author} created the community \"{community_name}\"",[h._param("author",a),h._param("community_name",b)])}function B(a){return h._(/*BTDS*/"{author} created the community",[h._param("author",a)])}function C(a){return h._(/*BTDS*/"The community \"{community_name}\" was created",[h._param("community_name",a)])}function D(){return h._(/*BTDS*/"The community was created")}function E(a,b,c,e){var f;a[0]!=null&&typeof a[0]==="string"&&!w(a[0])&&(f=d("WAWebFormatParticipantNames").getClickableDeactivatedCommunityName(a[0],e));if(f!=null&&b!=null){if(v(c)){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["generateDeleteParentGroupNotification: render community deactivate, I am author"])));return h._(/*BTDS*/"You deactivated the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(f,!e))])}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["generateDeleteParentGroupNotification: render community deactivate, I am not author"])));return h._(/*BTDS*/"{author} deactivated the community {community}",[h._param("author",b),h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(f,!e))])}if(v(c))return h._(/*BTDS*/"You deactivated a community");return b!=null?h._(/*BTDS*/"{author} deactivated a community",[h._param("author",b)]):h._(/*BTDS*/"A community was deactivated")}function F(a,b){a=d("WAWebFormatParticipantNames").getClickableIntegrityDeactivateCommunityName(a[0],a[1],b,!0);if(a!=null){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["generateIntegrityParentGroupUnlinkNotification"])));return h._(/*BTDS*/"This group is no longer part of the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}return h._(/*BTDS*/"This group is no longer part of a community")}function G(a,b,c,e){a=a.slice(0);a=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:a[0],asString:!b,alternativeStringName:a[1]});if(a!=null&&v(c)){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, I am author"])));return h._(/*BTDS*/"You removed this group from the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(a==null&&v(c))return h._(/*BTDS*/"You removed this group from a community");else if(a!=null&&c!=null){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, I am not author"])));return h._(/*BTDS*/"{author} removed this group from the community {community}",[h._param("author",e),h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(a!=null&&c==null){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupUnlinkNotification, no author"])));return h._(/*BTDS*/"This group was removed from the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(a==null&&c!=null)return h._(/*BTDS*/"{author} removed this group from a community",[h._param("author",e)]);return h._(/*BTDS*/"This group was removed from a community")}function H(a,b,c,e){a=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:a[0],asString:!b,alternativeStringName:a[1]});if(!w(a)&&v(c)){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, I am author"])));return h._(/*BTDS*/"You added this group and its members to the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(w(a)&&v(c))return h._(/*BTDS*/"You added this group and its members to a community");else if(!w(a)&&c!=null){d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, I am not author"])));return h._(/*BTDS*/"{author} added this group and its members to the community {community}",[h._param("author",e),h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(!w(a)&&c==null){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["generateParentGroupLinkNotification, no author"])));return h._(/*BTDS*/"This group and its members were added to the community {community}",[h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}else if(w(a)&&c!=null)return h._(/*BTDS*/"{author} added this group and its members to a community",[h._param("author",e)]);return h._(/*BTDS*/"This group and its members were added to a community")}function I(a,b,c,e,f){a=a.slice(0);f=d("WAWebFormatParticipantNames").getFormattedGroupListForCommunity(a,!b,f);a=d("WAWebPairList").unFlattenPairList(a).length;if(c!=null&&!v(c))return f==null?h._(/*BTDS*/"_j{\"*\":\"{author} added {count} groups\",\"_1\":\"{author} added 1 group\"}",[h._plural(a,"count"),h._param("author",e)]):h._(/*BTDS*/"_j{\"*\":\"{author} added the groups {groups}\",\"_1\":\"{author} added the group {groups}\"}",[h._plural(a),h._param("author",e),h._param("groups",f)]);if(f==null)return h._(/*BTDS*/"_j{\"*\":\"{count} groups were added\",\"_1\":\"1 group was added\"}",[h._plural(a,"count")]);return!b?d("WAWebStringsWithMultiplePluralParts").getCommunityGroupsAddedString({formattedNames:f},a):d("WAWebStringsWithMultiplePluralParts").getCommunityGroupsAddedStringComponent({formattedNames:f,count:a},a)}function J(a,b,c,e){a=a.slice(0);var f=d("WAWebFormatParticipantNames").getFormattedGroupListForCommunity(a,!b);a=d("WAWebPairList").unFlattenPairList(a).length;if(c!=null&&!v(c))return f==null?h._(/*BTDS*/"_j{\"*\":\"{author} removed {count} groups\",\"_1\":\"{author} removed 1 group\"}",[h._plural(a,"count"),h._param("author",e)]):h._(/*BTDS*/"_j{\"*\":\"{author} removed the groups {groups}\",\"_1\":\"{author} removed the group {groups}\"}",[h._plural(a),h._param("author",e),h._param("groups",f)]);if(f==null)return h._(/*BTDS*/"_j{\"*\":\"{count} groups were removed\",\"_1\":\"1 group was removed\"}",[h._plural(a,"count")]);return!b?d("WAWebStringsWithMultiplePluralParts").getCommunityGroupsRemovedString({formattedNames:f},a):d("WAWebStringsWithMultiplePluralParts").getCommunityGroupsRemovedStringComponent({formattedNames:f,count:a},a)}function K(a,b,c,e){b=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:a[0],asString:!b,alternativeStringName:a[1]});if(w(b)){if(e!=null)return B(e);else if(v(c))return z();return D()}if(v(c))return y(b);else if(e!=null)return A(e,b);return C(b)}function L(a,b){return v(a)?h._(/*BTDS*/"You joined from the community"):h._(/*BTDS*/"{author} joined from the community",[h._param("author",b)])}function M(a,b,c){if(a&&a.length>=2){a=d("WAWebFormatParticipantNames").getFormattedCommunityNameWithAlternative({jid:a[0],asString:!b,alternativeStringName:a[1]});if(!w(a)){d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["generateAddNotification"])));return h._(/*BTDS*/"{author} added you to this group and the community {community}",[h._param("author",c),h._param("community",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(a,!b))])}return h._(/*BTDS*/"{author} added you to this group and the community",[h._param("author",c)])}return h._(/*BTDS*/"{author} added you",[h._param("author",c)])}function N(a,b,c,e){var f,g=!1;a&&a.length>=3&&(f=d("WAWebFormatParticipantNames").getFormattedNameIfExists(a[0]),f==null&&(f=a[1]),a[2]==="true"&&(g=!0));if(!g){if(v(c)){if(!w(f)){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["generateInviteAutoAddNotification, I am subject, not part of community"])));return h._(/*BTDS*/"You were added to this community because you joined the group {group-name}",[h._param("group-name",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(f,!b))])}return h._(/*BTDS*/"You were added to this community")}return h._(/*BTDS*/"{user_name} joined",[h._param("user_name",e)])}if(v(c)){if(!w(f)){d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["generateInviteAutoAddNotification, I am subject, has subgroup name"])));return h._(/*BTDS*/"You were added because you joined the group {group-name}",[h._param("group-name",d("WAWebFormatParticipantNames").getCommunityNameInQuotationMarks(f,!b))])}return h._(/*BTDS*/"You were added")}return h._(/*BTDS*/"{user_name} joined",[h._param("user_name",e)])}g.formatLinkNotifAsFbt=a;g.formatLinkNotification=x}),226);
__d("WAWebFormatMembershipApprovalNotification",["fbt","WALogger","WAWebFbtIntlList","WAWebFormatParticipantNames","WAWebGroupType","WAWebSystemMessageGatingUtils","WAWebUserPrefsMeUser","WAWebWamEnumSystemMessageTypeType","WAWebWidFactory"],(function(a,b,c,d,e,f,g,h){var i;function j(a,b,e){var f=d("WAWebSystemMessageGatingUtils").systemMessageActionTextStylingEnabled(),g;b&&(g=d("WAWebFormatParticipantNames").getFormattedName(b,!1));switch(a){case"membership_approval_mode":var j=e[0]&&d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(e[0].toString())===d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On,k=e[1]&&d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.cast(e[1].toString())===d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin;if(j){if(g==null)return{text:k?h._(/*BTDS*/"New members need admin approval to join this group. Click to change."):h._(/*BTDS*/"New members need admin approval to join this group.")};return d("WAWebUserPrefsMeUser").isMeAccount(b)?{text:h._(/*BTDS*/"You turned on admin approval to join this group. Click to change.")}:{text:k?h._(/*BTDS*/"{author} turned on admin approval to join this group. Click to change.",[h._param("author",g)]):h._(/*BTDS*/"{author} turned on admin approval to join this group",[h._param("author",g)])}}return g==null?{text:h._(/*BTDS*/"Admin approval to join this group was turned off.")}:d("WAWebUserPrefsMeUser").isMeAccount(b)?{text:h._(/*BTDS*/"You turned off admin approval to join this group. Click to change.")}:{text:k?h._(/*BTDS*/"{author} turned off admin approval to join this group. Click to change.",[h._param("author",g)]):h._(/*BTDS*/"{author} turned off admin approval to join this group",[h._param("author",g)])};case"membership_approval_request":return{text:f?h._(/*BTDS*/"{author} requested to join",[h._param("author",g)]):h._(/*BTDS*/"{author} requested to join. Click to review.",[h._param("author",g)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_JOIN_REQUEST};case"created_membership_requests":j=e.map(function(a){return d("WAWebFormatParticipantNames").getFormattedName(d("WAWebWidFactory").createWid(a.toString()),!1)});b=j[0];k=j.slice(1);e=c("WAWebFbtIntlList")(k,c("WAWebFbtIntlList").CONJUNCTIONS.NONE,c("WAWebFbtIntlList").DELIMITERS.COMMA);return{text:f?h._(/*BTDS*/"{author} requested to add {authors}",[h._param("author",b),h._param("authors",e)]):h._(/*BTDS*/"{author} requested to add {authors}. Click to review.",[h._param("author",b),h._param("authors",e)]),enumType:d("WAWebWamEnumSystemMessageTypeType").SYSTEM_MESSAGE_TYPE_TYPE.GROUP_JOIN_REQUEST};default:d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wa:formatMembershipApprovalNotification:unknown message subtype: ",""])),a);break}return{text:""}}function a(a,b,c){return j(a,b,c).text}g.formatMembershipApprovalNotification=a}),226);
__d("WAWebL10NEnumeration.react",["fbt"],(function(a,b,c,d,e,f,g,h){function a(a,b){b===void 0&&(b=!1);if(a.length===0)return"";var c=a[0];if(a.length===1){var d=h._(/*BTDS*/"\"{A}\"",[h._param("A",c)]);return b?d.toString():d}d=a[a.length-1];if(a.length===2)return i(c,d,b);c=a.slice(0,a.length-2);a=a[a.length-2];return j(c,a,d,b)}function i(a,b,c){c===void 0&&(c=!1);a=h._(/*BTDS*/"\"{A}\" & \"{B}\"",[h._param("A",a),h._param("B",b)]);return c?a.toString():a}function j(a,b,c,d){d===void 0&&(d=!1);var e=function(a,b){return h._(/*BTDS*/"\"{A},\" {B}",[h._param("A",b),h._param("B",a)])};a=a.reverse();a=d?a.reduce(function(a,b){return e(a,b).toString()},""):a.reduce(function(a,b){return e(a,b)},null);a=h._(/*BTDS*/"{A}\"{B}\" & \"{C}\"",[h._param("A",a),h._param("B",b),h._param("C",c)]);return d?a.toString():a}g["default"]=a}),226);
__d("WAWebFormatParticipantNames",["fbt","WAWebClickableLink.react","WAWebCmd","WAWebCommunityGroupJourneyEventImpl","WAWebComposeBoxActions","WAWebConfirmPopup.react","WAWebContactCollection","WAWebEmojiText.react","WAWebFbtIntlList","WAWebFindChatAction","WAWebGroupMetadataCollection","WAWebL10NEnumeration.react","WAWebModalManager","WAWebName.react","WAWebPairList","WAWebReachoutTimelockRestrictedModalLoadable","WAWebReachoutTimelockUtils","WAWebSuspendedCommunityUtils","WAWebToast.react","WAWebToastManager","WAWebUnjoinedSubgroupMetadataCollection","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumSurfaceType","fbs","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react"),k={linkColor:{color:"x1bvqhpb",$$css:!0}};function l(a,b){return function(c){c&&(c.preventDefault(),c.stopPropagation()),void d("WAWebFindChatAction").findOrCreateLatestChat(a,"formatParticipantNames").then(function(a){var c=a.chat;if(d("WAWebReachoutTimelockUtils").isUserReachoutTimelocked()&&!d("WAWebReachoutTimelockUtils").canSendMsgWhileTimelocked({chat:c,contact:c.contact})){d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebReachoutTimelockRestrictedModalLoadable").ReachoutTimelockRestrictedModalLoadable,{}));return}b==="sibling_group_link"&&new(d("WAWebCommunityGroupJourneyEventImpl").CommunityGroupJourneyEvent)({action:d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.GROUP_SYSTEM_MESSAGE_CLICK,surface:d("WAWebWamEnumSurfaceType").SURFACE_TYPE.CHAT,chat:c}).commit();void d("WAWebCmd").Cmd.openChatFromUnread(c).then(function(a){a&&d("WAWebComposeBoxActions").ComposeBoxActions.focus(c)})})}}function m(a){return function(b){b&&(b.preventDefault(),b.stopPropagation()),d("WAWebCmd").Cmd.openCommunityHome(a,void 0)}}function a(a){return function(b){b&&(b.preventDefault(),b.stopPropagation()),d("WAWebCmd").Cmd.openCommunityTabbedInfo(a,void 0,!1,!0)}}function n(a){return function(b){b&&(b.preventDefault(),b.stopPropagation()),d("WAWebModalManager").ModalManager.open(j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:function(){return d("WAWebModalManager").ModalManager.close()},children:h._(/*BTDS*/"You are no longer a member of the community \"{community}\"",[h._param("community",j.jsx(d("WAWebName.react").Name,{contact:a}))])}))}}function o(){d("WAWebToastManager").ToastManager.open(j.jsx(d("WAWebToast.react").Toast,{msg:h._(/*BTDS*/"This community no longer exists")}))}function p(a,b){return b?j.jsx(c("WAWebClickableLink.react"),{onClick:o,xstyle:k.linkColor,children:j.jsx(d("WAWebEmojiText.react").EmojiText,{text:a})}):a}function b(a,b,c,e){var f=d("WAWebContactCollection").ContactCollection.get(a.toString());if(e===!1&&f!=null)return v(a,c?m(a):null);if(b==null||b==="")return null;return e===!1&&c?j.jsx(d("WAWebEmojiText.react").EmojiText,{text:b,onClick:d("WAWebSuspendedCommunityUtils").openTerminatedCommunityModal}):b}function q(a,b){b===void 0&&(b=!1);var e=d("WAWebContactCollection").ContactCollection.get(a.toString());if(!e)return null;if(b)return e.name;b=c("WAWebGroupMetadataCollection").get(a);var f=m(a);b!=null&&b.joinedSubgroups.length||(f=n(e));return v(a,f)}function e(a,b){return b?c("fbs")._(/*BTDS*/"\"{community-name}\"",[c("fbs")._param("community-name",a)]):j.jsx("span",{className:"xuxw1ft",children:h._(/*BTDS*/"\"{community-name}\"",[h._param("community-name",a)])})}function r(a){var b=a.jid,c=a.asString;c=c===void 0?!1:c;a=a.alternativeStringName;b=q(b,c);if(b==null&&a)return p(a,!c);else if(typeof b==="string"&&!c)return j.jsx(d("WAWebEmojiText.react").EmojiText,{text:b});return b}function s(a,b,e){b===void 0&&(b=!1);if(d("WAWebContactCollection").ContactCollection.get(a.toString())!=null&&!b)return v(a,l(a,e));b=c("WAWebUnjoinedSubgroupMetadataCollection").get(a.toString());return b!=null&&b.subject?b.subject:null}function t(a,b,e){b===void 0&&(b=!1);a=d("WAWebPairList").unFlattenPairList(a).map(function(a){var c=a[0];a=a[1];c=s(c,b,e);return c!==""&&c!=null?c:a});return c("WAWebL10NEnumeration.react")(a,b)}function u(a,b,c){b===void 0&&(b=!0);if(!a.isUser())return v(a,b?l(a,c):null);b=b?l(a,c):null;return v(a,b)}function v(a,b){a=d("WAWebContactCollection").ContactCollection.gadd(a,{silent:!0});return j.jsx(d("WAWebName.react").Name,{contact:a,showNotifyName:!0,elevatedPushNamesEnabled:!0,onClick:b})}v.displayName=v.name+" [from "+f.id+"]";function w(a,b,d){b===void 0&&(b=!0);d===void 0&&(d=!1);if(!Array.isArray(a))return u(a,b);a=a.map(function(a){return u(a,b)});return c("WAWebFbtIntlList")(a,d?c("WAWebFbtIntlList").CONJUNCTIONS.NONE:c("WAWebFbtIntlList").CONJUNCTIONS.AND,c("WAWebFbtIntlList").DELIMITERS.COMMA)}g.openCommunity=m;g.openCommunityInfo=a;g.getClickableDeactivatedCommunityName=p;g.getClickableIntegrityDeactivateCommunityName=b;g.getCommunityNameInQuotationMarks=e;g.getFormattedCommunityNameWithAlternative=r;g.getFormattedNameIfExists=s;g.getFormattedGroupListForCommunity=t;g.getFormattedName=u;g.getFormattedNames=w}),226);
__d("WAWebFormatPictureNotification",["fbt","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.author,c=a.authorClickable;a=a.body;if(a==="remove")return d("WAWebSystemMessagesUtils").isMe(b)?h._(/*BTDS*/"You deleted this group's icon"):c!=null?h._(/*BTDS*/"{user_name} deleted this group's icon",[h._param("user_name",c)]):h._(/*BTDS*/"A member deleted this group's icon");else if(d("WAWebSystemMessagesUtils").isMe(b))return h._(/*BTDS*/"You changed this group's icon");return c!=null?h._(/*BTDS*/"{user_name} changed this group's icon",[h._param("user_name",c)]):h._(/*BTDS*/"A member changed this group's icon")}g.formatPictureNotification=a}),226);
__d("WAWebFormatPromoteDemoteNotification",["fbt","WALogger","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){var i;function a(a){var b=a.subtype,c=a.participantsCount,e=a.subject,f=a.subjectClickable;a=a.participantsClickable;switch(b){case"promote":return c===1&&d("WAWebSystemMessagesUtils").isMe(e)?h._(/*BTDS*/"You're now an admin"):h._(/*BTDS*/"_j{\"*\":\"{participant_names} are now admins\",\"_1\":\"{participant_names} is now an admin\"}",[h._plural(c),h._param("participant_names",a)]);case"demote":return c===1&&d("WAWebSystemMessagesUtils").isMe(e)?h._(/*BTDS*/"You're no longer an admin"):h._(/*BTDS*/"_j{\"*\":\"{participant_names} are no longer admins\",\"_1\":\"{participant_names} is no longer an admin\"}",[h._plural(c),h._param("participant_names",a)]);case"linked_group_promote":return d("WAWebSystemMessagesUtils").isMe(e)?h._(/*BTDS*/"You're now a community admin"):h._(/*BTDS*/"{name} is now a community admin",[h._param("name",f)]);case"linked_group_demote":return d("WAWebSystemMessagesUtils").isMe(e)?h._(/*BTDS*/"You're no longer a community admin"):h._(/*BTDS*/"{name} is no longer a community admin",[h._param("name",f)]);default:d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wa:formatPromoteDemoteNotification:unknown message subtype: ",""])),b);return""}}g.formatPromoteDemoteNotification=a}),226);
__d("WAWebFormatRemoveNotification",["fbt","WAWebLidMigrationUtils","WAWebSystemMessagesUtils","WAWebWid"],(function(a,b,c,d,e,f,g,h){function a(a){var b=a.author,e=a.authorClickable,f=a.subject,g=a.subjectClickable;a=a.participantsClickable;if(b){if(c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(b,f)))return h._(/*BTDS*/"You were removed");else if(d("WAWebSystemMessagesUtils").isMe(b))return h._(/*BTDS*/"You removed {names}",[h._param("names",a)]);else if(d("WAWebSystemMessagesUtils").isMe(f))return e!=null?h._(/*BTDS*/"{user_name} removed you",[h._param("user_name",e)]):h._(/*BTDS*/"A member removed you");return e!=null?h._(/*BTDS*/"{user_name} removed {names}",[h._param("user_name",e),h._param("names",a)]):h._(/*BTDS*/"A member removed {names}",[h._param("names",a)])}else if(d("WAWebSystemMessagesUtils").isMe(f))return h._(/*BTDS*/"You were removed");return h._(/*BTDS*/"{user_name} was removed",[h._param("user_name",g)])}g.formatRemoveNotification=a}),226);
__d("WAWebFormatReportToAdminNotification",["fbt","WAWebFormatParticipantNames","WAWebGroupType","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g,h){function a(a,b){var c=b[0]&&d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.cast(b[0].toString())===d("WAWebGroupType").GroupSettingChangeSystemMessageToggleEnabled.On;b=b[1]&&d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.cast(b[1].toString())===d("WAWebGroupType").GroupSettingChangeSystemMessageIsAdmin.Admin;var e=d("WAWebUserPrefsMeUser").isMeAccount(a);if(e){e=h._(/*BTDS*/"You turned on send for admin review for this group. Click to change.");var f=h._(/*BTDS*/"You turned off send for admin review for this group. Click to change.");return c?e:f}if(a){e=d("WAWebFormatParticipantNames").getFormattedName(a,!1);f=h._(/*BTDS*/"{author} turned on send for admin review for this group. Click to change.",[h._param("author",e)]);a=h._(/*BTDS*/"{author} turned off send for admin review for this group. Click to change.",[h._param("author",e)]);var g=h._(/*BTDS*/"{author} turned on send for admin review for this group. Click to learn more.",[h._param("author",e)]);e=h._(/*BTDS*/"{author} turned off send for admin review for this group. Click to learn more.",[h._param("author",e)]);return b?c?f:a:c?g:e}f=h._(/*BTDS*/"Send for admin review is turned on for this group. Click to change.");a=h._(/*BTDS*/"Send for admin review is turned off for this group. Click to change.");g=h._(/*BTDS*/"Send for admin review is turned on for this group. Click to learn more.");e=h._(/*BTDS*/"Send for admin review is turned off for this group. Click to learn more.");return b?c?f:a:c?g:e}g.formatReportToAdminNotification=a}),226);
__d("WAWebFormatRestrictNotification",["fbt","WAWebSystemMessagesUtils"],(function(a,b,c,d,e,f,g,h){var i=256;function a(a){var b=a.author,c=a.authorClickable;a=a.templateParams;var e=a[0];if(e==="on"){if(a[1]!=null){e=parseInt(a[1],10)||i;return h._(/*BTDS*/"_j{\"*\":\"This group has over {threshold} members so now only admins can edit the group settings\",\"_1\":\"This group has over 1 member so now only admins can edit the group settings\"}",[h._plural(e,"threshold")])}return d("WAWebSystemMessagesUtils").isMe(b)?h._(/*BTDS*/"You changed the settings so only admins can edit the group settings"):c!=null?h._(/*BTDS*/"{user_name} changed the settings so only admins can edit the group settings",[h._param("user_name",c)]):h._(/*BTDS*/"A member changed the settings so only admins can edit the group settings")}else if(d("WAWebSystemMessagesUtils").isMe(b))return h._(/*BTDS*/"You changed the settings so all members can edit the group settings");return c!=null?h._(/*BTDS*/"{user_name} changed the settings so all members can edit the group settings",[h._param("user_name",c)]):h._(/*BTDS*/"A member changed the settings so all members can edit the group settings")}g.formatRestrictNotification=a}),226);
__d("WAWebFormatSubjectNotification",["fbt","WAWebChatGroupUtils","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g,h){function a(a,b,c,e){if(d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(a))return d("WAWebUserPrefsMeUser").isMeAccount(b)?h._(/*BTDS*/"You changed the community's name to \"{community_name}\"",[h._param("community_name",e)]):c!=null?h._(/*BTDS*/"{user} changed the community's name to \"{community_name}\"",[h._param("user",c),h._param("community_name",e)]):h._(/*BTDS*/"A member changed the community's name to \"{community_name}\"",[h._param("community_name",e)]);return d("WAWebUserPrefsMeUser").isMeAccount(b)?h._(/*BTDS*/"You changed the group name to \"{group_name}\"",[h._param("group_name",e)]):c!=null?h._(/*BTDS*/"{user} changed the group name to \"{group_name}\"",[h._param("user",c),h._param("group_name",e)]):h._(/*BTDS*/"A member changed the group name to \"{group_name}\"",[h._param("group_name",e)])}g.formatSubjectNotification=a}),226);
__d("WAWebSystemMessagesUtils",["WAWebEmojiText.react","WAWebUserPrefsMeUser","WAWebWid","react"],(function(a,b,c,d,e,f,g){var h,i=h||c("react");function a(a){return a instanceof c("WAWebWid")&&d("WAWebUserPrefsMeUser").isMeAccount(a)}function b(a){a=a.text;return i.jsx(d("WAWebEmojiText.react").EmojiText,{direction:"auto",text:a})}b.displayName=b.name+" [from "+f.id+"]";g.isMe=a;g.FormattedText=b}),98);
__d("WAWebUnformatSerializer",["WAWebFormatSerializer"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebFormatSerializer"));a.onDelimiter=function(){return void 0};a.onMutator=function(a,b,c){if(a.unformatDecorations!=null){a=a.unformatDecorations;var d=a.pre;a=a.post;return h([typeof d==="function"?d(c):d].concat(b,[a]))}return h(b)};a.onRoot=function(a){return h(a)};a.onText=function(a){return a};function h(a){return a.filter(Boolean).join("")}g["default"]=a}),98);
__d("WAWebUnformatMsg",["WAWebCommonMsgUtils","WAWebFormat","WAWebFormatConfiguration","WAWebFrontendMsgGetters","WAWebMiscGatingUtils","WAWebUnformatSerializer"],(function(a,b,c,d,e,f,g){var h;function i(){h||(h=d("WAWebFormatConfiguration").Unformat({mentions:{}}));return h}function a(a,b){b=b!=null?b:"";if(d("WAWebCommonMsgUtils").isRichResponseMsg(a.type)){var e=d("WAWebFormatConfiguration").RichResponse({links:[],parseHeadlessHeadings:!0,parseHeadings:!1});return c("WAWebFormat")(b,e,c("WAWebUnformatSerializer"))}e=a.mentionMap();var f=a.groupMentionMap();if(!e&&!f)return j(b);if(d("WAWebMiscGatingUtils").isDropLastNameEnabled()){a=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata;if(a){a=d("WAWebFormatConfiguration").FormattedGroupNotification({mentions:e,groupMentions:f,groupMetadata:a});return c("WAWebFormat")(b,a,c("WAWebUnformatSerializer"))}}a=d("WAWebFormatConfiguration").FormattedNotification({mentions:e,groupMentions:f});return c("WAWebFormat")(b,a,c("WAWebUnformatSerializer"))}function j(a){return c("WAWebFormat")(a,i(),c("WAWebUnformatSerializer"))}g["default"]=a}),98);
__d("WAWebWidToFormattedNameOrNumber",["WAWebContactCollection","WAWebFrontendContactGetters","WAWebWidFormat"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAWebContactCollection").ContactCollection.get(a);return b?d("WAWebFrontendContactGetters").getFormattedName(b):d("WAWebWidFormat").widToFormattedUser(a)}g["default"]=a}),98);
__d("WAWebFrontendChatGetters",["WALogger","WAWebBotGating","WAWebChatConstants","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatModelDerivedMethods","WAWebConstantsDeprecated","WAWebContactCollection","WAWebContactGetters","WAWebGetters","WAWebGettersCaches","WAWebGroupType","WAWebHostedGroupUtils","WAWebLastAddOnDBSerialization","WAWebMsgGetters","WAWebMsgType","WAWebPrivacyModeSystemMsg","WAWebWid"],(function(a,b,c,d,e,f,g){var h;b=d("WAWebGetters").createGetterFactories({root:(a=d("WAWebChatGetters")).getChatUnsafe,createCache:d("WAWebGettersCaches").createFrontendChatCache});e=b.field;f=b.computed;b=b.clearCacheFor;b=b;var i=e("groupMetadata"),j=e("contact"),k=e("pendingSeenCount",{"default":0}),l=e("unreadMsgAnchor"),m=e("composeQuotedMsg"),n=e("composeQuotedMsgRemoteJid"),o=e("quotedMsgAdminGroupJid"),p=e("quotedMsgAdminGroupSubject"),q=e("quotedMsgAdminParentGroupJid"),r=e("msgs"),s=e("msgsLength"),t=e("msgsChanged"),u=e("isParentGroup"),v=e("groupType"),w=e("hasCapi"),x=e("createdLocally"),y=e("pendingDeleteForMeCount"),z=e("attachMediaContents"),A=e("formattedTitle"),B=e("assignedAgent"),C=e("isAssignedToMe",{"default":!1}),D=e("mute"),E=e("presence"),F=e("newsletterMetadata"),G=e("promises",{getDefault:function(){return{reportSpamAndBlockSender:void 0,reportSpamBlockClear:void 0,reportSpamExitClear:void 0,sendNotSpam:void 0,sendUnstarAll:void 0,updateSortTime:void 0,setPin:void 0,setArchive:void 0,updateDraftMessage:void 0}}}),H=e("isFavorite",{"default":!1}),I=e("trusted"),J=e("active"),K=e("pendingAction"),L=e("pttRecordingSession"),M=e("unopenedByAssignedAgent",{"default":!1});e=e("mmSignalSharingExpirationWindow");var N=f(function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4];a=a[5];if(c)return a===d("WAWebGroupType").GroupType.COMMUNITY?d("WAWebChatFlowTypes").ChatKindType.Community:d("WAWebChatFlowTypes").ChatKindType.Group;else if(e)return d("WAWebChatFlowTypes").ChatKindType.Broadcast;else if(f)return d("WAWebChatFlowTypes").ChatKindType.Chat;else if(g)return d("WAWebChatFlowTypes").ChatKindType.Newsletter;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat:unknown kind id:",""])),b.toLogString());return void 0},[a.getId,a.getIsGroup,a.getIsBroadcast,a.getIsUser,a.getIsNewsletter,v]);v=f(function(a){var b=a[0];a=a[1];return b&&a===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP},[a.getIsGroup,v]);w=f(function(a){a=a[0];return d("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&a===!0},[w]);var O=f(function(a){var b=a[0];a=a[1];if(!a)return!1;if(b===d("WAWebChatFlowTypes").ChatKindType.Chat){b=d("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(a.privacyMode);if(b===d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB||b===d("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP)return!1}return a.isHosted===!0?!1:!0},[N,j]);k=f(function(a){var b=a[0];a=a[1];return b===c("WAWebConstantsDeprecated").MARKED_AS_UNREAD?b:Math.max(0,b-a)},[a.getUnreadCount,k]);l=f(function(a){var b=a[0],c=a[1];a=a[2];if(b===0)return!1;if(c){var e=c.msgChunk;e=e?e.getModelsArray():[];return c!==e.find(function(a){return d("WAWebMsgGetters").getIsUnreadType(a)})}c=a.last();e=c!=null&&d("WAWebMsgGetters").getIsSentByMe(c);if(e)return!1;if(a.msgLoadState.noEarlierMsgs){c=a.filter(function(a){return d("WAWebMsgGetters").getIsUnreadType(a)});return c.length!==b}return!0},[a.getUnreadCount,l,r]);x=f(function(a){var b=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7];a[8];if(e)return!1;if(b.isBot()&&!d("WAWebBotGating").isBotEnabled())return!1;if(f)return b.user==="chat"?!0:!1;if(c("WAWebWid").isStatus(b))return!1;if(g===d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.NOT_INCLUDED_IN_HIST_SYNC&&j.length===0)return!1;if(h&&i===!0)return!1;a=j.some(function(a){return a.isRealMessage()});return k!==!0||a},[a.getId,a.getIsLocked,a.getIsBroadcast,a.getEndOfHistoryTransferType,a.getIsGroup,u,r,x,s]);s=f(function(a){var b=a[0];a[1];a[2];for(a=b.length-1;a>=0;a--){var c=b.at(a);if(c&&d("WAWebChatModelDerivedMethods").isPreviewMessage(c))return c}if(b.length>0)return b.last()},[r,t,y]);t=f(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];if(!c)return!1;if(!e&&!a)return!1;c=d("WAWebContactCollection").ContactCollection.get(a||b);return c!=null&&d("WAWebContactGetters").getIsMyContact(c)?!1:!0},[a.getId,a.getIsUser,a.getChangeNumberOldJid,a.getChangeNumberNewJid]);y=f(function(a){var b=a[0];a=a[1];if(b)return b;if(a)return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromDeprecatedLastReactionPreview(a)},[a.getChatlistPreview,a.getLastReactionPreview]);f=f(function(a){var b,c=a[0];a=a[1];c=c==null||(b=c.text)==null?void 0:b.trim();if(c!=null&&c!=="")return!0;return a?!0:!1},[a.getDraftMessage,z]);g.clearFrontendChatGetterCacheFor=b;g.getGroupMetadata=i;g.getContact=j;g.getComposeQuotedMsg=m;g.getComposeQuotedMsgRemoteJid=n;g.getQuotedMsgAdminGroupJid=o;g.getQuotedMsgAdminGroupSubject=p;g.getQuotedMsgAdminParentGroupJid=q;g.getMsgs=r;g.getIsParentGroup=u;g.getAttachMediaContents=z;g.getFormattedTitle=A;g.getAssignedAgent=B;g.getIsAssignedToMe=C;g.getMute=D;g.getPresence=E;g.getNewsletterMetadata=F;g.getPromises=G;g.getIsFavorite=H;g.getTrusted=I;g.getActive=J;g.getPendingAction=K;g.getPttRecordingSession=L;g.getUnopenedByAssignedAgent=M;g.getMmSignalSharingExpirationWindow=e;g.getKind=N;g.getIsCAG=v;g.getIsCapiHostedGroup=w;g.getIsE2ee=O;g.getOptimisticUnreadCount=k;g.getShouldShowUnreadDivider=l;g.getShouldAppearInList=x;g.getPreviewMessage=s;g.getShowChangeNumberNotification=t;g.getDerivedLastAddOnPreview=y;g.getHasDraftMessage=f}),98);
__d("WAWebAnimatedEmojiAssetLoader",["WAConcurrentPriorityPromiseQueue","WALogger","WAWebEmojiConst","WAWebMediaHostsUtil","WAWebPonyfillsFetch","WAWebURLUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j="/wa/static/network_resource",k="nw_media";function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){i=i!=null?i:new Map();var e=new(c("WAConcurrentPriorityPromiseQueue"))(5,{emojis:5}),f=(yield d("WAWebMediaHostsUtil").getStaticMediaHostName()),g=""+f+j;d("WAWebEmojiConst").getSupportedAnimatedEmojisAssetIdsMapping(a).forEach(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a=a[1];try{var f,j=c("WAWebURLUtils").build(g,{cat:k,id:a,_nc_cat:1});a=(yield e.enqueue(function(){return c("WAWebPonyfillsFetch")(j)},{group:"emojis",priority:1}));a=(yield a.json());(f=i)==null||f.set(b,a)}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["initAnimatedEmojiAssets: Fetching of animated emoji asset failed"]))).devConsole(a)}});return function(b){return a.apply(this,arguments)}}())});return l.apply(this,arguments)}function e(a){var b;return(b=i)==null?void 0:b.get(a)}g.initAnimatedEmojiAssets=a;g.getAnimatedEmojiAsset=e}),98);
__d("WAWebProductCatalogCatalogConstants",[],(function(a,b,c,d,e,f){a=96;b=120;c=40;d=95;f.PRODUCT_LIST_ITEM_HEIGHT=a;f.CART_PRODUCT_LIST_ITEM_HEIGHT=b;f.MAX_REPLY_PRODUCT_TITLE_LENGTH=c;f.MAX_REPLY_PRODUCT_DESC_LENGTH=d}),66);
__d("WAWebFrontendMsgGetters",["WABidi","WALogger","WANullthrows","WAWebAck","WAWebAnimatedEmojiAssetLoader","WAWebAnimatedEmojiGatingUtils","WAWebBizSystemMsgSubtypes","WAWebChatCollection","WAWebChatGroupUtils","WAWebCommonMsgUtils","WAWebEmoji","WAWebFormatNfmText","WAWebGetters","WAWebGettersCaches","WAWebL10N","WAWebMessageAssociation.flow","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModelUtils","WAWebMsgType","WAWebNewsletterCollection","WAWebNewsletterGatingUtils","WAWebNewsletterMembershipUtil","WAWebProductCatalogCatalogConstants","WAWebProtobufsAICommon.pb","WAWebPtvGatingUtils","WAWebTemplateButtonSubtype","WAWebUserPrefsMeUser","lodash"],(function(a,b,c,d,e,f,g){var h,i;e=d("WAWebGetters").createGetterFactories({root:(b=d("WAWebMsgGetters")).getMsgUnsafe,createCache:d("WAWebGettersCaches").createFrontendMessagesCache});f=e.field;var j=e.computed;e=e.clearCacheFor;e=e;var k=j(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return d("WAWebMsgModelUtils").typeIsMms({type:b,subtype:c,headerType:e,interactiveHeader:a})},[b.getType,b.getSubtype,b.getHeaderType,b.getInteractiveHeader]),l=j(function(a){var b=a[0],c=a[1];a=a[2];return b!=null&&b<d("WAWebAck").ACK.SENT&&c&&a},[b.getAck,k,b.getIsSentByMe]),m=j(function(a){var b=a[0],c=a[1];a=a[2];b=d("WAWebMsgDataUtils").eventTypeFromMsgType(b);if(!a)return d("WAWebCommonMsgUtils").EventType.IGNORE;return c?b===d("WAWebCommonMsgUtils").EventType.IGNORE?d("WAWebCommonMsgUtils").EventType.IGNORE:d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:b},[b.getMsgUnsafe,b.getInvis,b.getIsNewMsg]),n=function(a){switch(a.type){case"interactive":return d("WAWebMsgGetters").getNativeFlowName(a)!=null?d("WAWebFormatNfmText").formatNFMText(a):d("WAWebMsgGetters").getCaption(a);case"native_flow":return d("WAWebFormatNfmText").formatNFMText(a)}return null},o=j(function(a){var b=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],o=a[10],p=a[11],q=a[12],r=a[13],s=a[14],t=a[15];a=a[16];if(m||o)return e===d("WAWebMsgType").MSG_TYPE.CHAT?g:h;switch(e){case"chat":case"interactive_response":case"automated_greeting_message":return g;case"image":case"video":case"ptv":case"document":case"sticker-pack":return h;case"location":return j?i:void 0;case"payment":return k==null?void 0:k.body;case"groups_v4_invite":return i;case"list":return p==null?void 0:p.description;case"product":return c("lodash").truncate(f,{length:d("WAWebProductCatalogCatalogConstants").MAX_REPLY_PRODUCT_TITLE_LENGTH});case"hsm":return g;case"template_button_reply":return g;case"interactive":return q!=null?n(b):h;case"native_flow":return n(b);case"poll_creation":case"poll_result_snapshot":return l;case"newsletter_admin_invite":return r==null?void 0:r.inviteMessage;case"newsletter_follower_invite":return s==null?void 0:s.inviteMessage;case"event_creation":return t;case"quarantined":return a;default:e;return void 0}},[b.getMsgUnsafe,b.getType,b.getTitle,b.getBody,b.getCaption,b.getComment,b.getIsLive,b.getPaymentNoteMsg,b.getPollName,b.getIsFromTemplate,b.getIsDynamicReplyButtonsMsg,b.getList,b.getNativeFlowName,b.getNewsletterAdminInviteInfo,b.getNewsletterFollowerInviteInfo,b.getEventName,b.getQuarantineExtractedText]),p=j(function(a){a=a[0];a=a==null?void 0:a.newsletterId;if(a==null)return!1;a=(a=c("WAWebNewsletterCollection").get(a))==null?void 0:a.newsletterMetadata;return d("WAWebNewsletterMembershipUtil").iAmAdmin(a)&&!d("WAWebNewsletterMembershipUtil").iAmOwner(a)},[b.getNewsletterAdminInviteInfo]),q=j(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];if(b===d("WAWebMsgType").MSG_TYPE.VCARD)return c?d("WABidi").dir(c):void 0;if(e==null)return;b=a!=null&&a.length?e.replace(/@\d+@g.us/,""):e;c=d("WABidi").dir(b);return c},[b.getType,b.getSubtype,o,b.getGroupMentions]),r=j(function(a){a=a[0];return a==="rtl"||a===void 0&&c("WAWebL10N").isRTL()},[q]),s=j(function(a){var b=a[0],c=a[1];a=a[2];return b===d("WAWebMsgType").MSG_TYPE.VCARD?c?d("WABidi").dir(c)==="rtl":!1:!!a&&d("WABidi").dir(a)==="rtl"},[b.getType,b.getSubtype,o]),t=j(function(a){var b=a[0];a=a[1];return b!=null||a!=null},[o,b.getFooter]),u=function(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?c("WAWebNewsletterCollection"):d("WAWebChatCollection").ChatCollection};function a(a){var b=d("WAWebChatCollection").ChatCollection;d("WAWebMsgGetters").getIsNewsletterMsg(a)&&(b=c("WAWebNewsletterCollection"));return c("WANullthrows")(b.get(c("WAWebMsgKey").from(a.id).remote))}var v=function(a){var b=u(a).get(c("WAWebMsgKey").from(a.id).remote);b==null&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getChat: msgKey = ",", type = ",""])),a.id.toString(),a.type),d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getChat: unexpected null chat"]))).sendLogs("get-chat-unexpected-null"));return b},w=function(a){return u(a).get(c("WAWebMsgKey").from(a.id).remote)},x=f("carouselCards"),y=j(function(a){a=a[0];return a==null?null:a.slice()},[x]),z=f("buttons"),A=j(function(a){var b=a[0];a=a[1];return b&&a!=null&&a.length>0},[b.getIsFromTemplate,z]),B=j(function(a){var b=a[0];a=a[1];if(!b)return!1;if(a==null)return!1;b=a.at(0);return b==null?!1:b.subtype===d("WAWebTemplateButtonSubtype").TEMPLATE_BUTTON_SUBTYPE.QUICK_REPLY},[A,z]),C=j(function(a){a=a[0];return a},[b.getMsgUnsafe]),D=j(function(a){a=a[0];return a.type===d("WAWebMsgType").MSG_TYPE.PRODUCT&&a.id&&a.id.id.startsWith(d("WAWebBizSystemMsgSubtypes").PRODUCT_INQUIRY_TYPE)?a:null},[C,b.getType,b.getId]),E=j(function(a){a=a[0];switch(a.type){case d("WAWebMsgType").MSG_TYPE.GP2:return a;default:return null}},[C,b.getType]),F=j(function(a){a=a[0];return a.type===d("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION?a:null},[C,b.getType]),G=j(function(a){a=a[0];return a.type==="product"?a:null},[C,b.getType]),H=j(function(a){a=a[0];return a.type===d("WAWebMsgType").MSG_TYPE.REVOKED?a:null},[C,b.getType]),I=f("associationType"),J=j(function(a){var b=a[0];a[1];var c=a[2],e=a[3];a[4];var f=a[5];a[6];var g=a[7],h=a[8],i=a[9];a=a[10];return(b.type===d("WAWebMsgType").MSG_TYPE.IMAGE||b.type===d("WAWebMsgType").MSG_TYPE.VIDEO&&b.isGif!==!0)&&!c&&!f&&!(h!==d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM&&h!==d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL&&(e!=null||g))&&!i&&!a?b:null},[C,b.getType,b.getIsNotification,b.getCaption,b.getIsForwarded,H,b.getIsGif,b.getQuotedMsg,I,b.getCtwaContext,b.getIsViewOnce]),K=j(function(a){var b=a[0];a=a[1];return d("WAWebMsgModelUtils").notRefiningTypeIsUrl({type:b,subtype:a})},[b.getType,b.getSubtype]),L=j(function(a){var b=a[0];a[1];var c=a[2];a=a[3];if(c)return null;switch(b.type){case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.STICKER:case d("WAWebMsgType").MSG_TYPE.AUDIO:case d("WAWebMsgType").MSG_TYPE.PTT:case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.PTV:case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return b}return a?b:null},[C,b.getType,b.getIsViewOnce,K]),M=j(function(a){var b=a[0];a[1];var c=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7];a=a[8];var j=v(b.unsafe());return b.type===d("WAWebMsgType").MSG_TYPE.STICKER&&!c&&!e&&!f&&!g&&!h&&(a&&d("WAWebNewsletterGatingUtils").isStickerForwardedAttributionEnabled()?!i:!0)&&!d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(j)?b:null},[C,b.getType,b.getIsNotification,H,b.getQuotedMsg,b.getCtwaContext,b.getIsNewsletterMsg,b.getIsForwarded,b.getHasOriginatedFromNewsletter]),N=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT?b:null},[C,b.getType]),O=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.IMAGE?b:null},[C,b.getType]),P=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.VIDEO?b:null},[C,b.getType]),Q=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.AUDIO?b:null},[C,b.getType]),R=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.PTT?b:null},[C,b.getType]),S=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.PTV?b:null},[C,b.getType]),T=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION?b:null},[C,b.getType]),U=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION||b.type===d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT?b:null},[C,b.getType]),V=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT?b:null},[C,b.getType]),aa=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION?b:null},[C,b.getType]),ba=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.ALBUM?b:null},[C,b.getType]),ca=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.CALL_LOG?b:null},[C,b.getType]),da=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE?b:null},[C,b.getType]),ea=j(function(a){var b=a[0];a[1];return d("WAWebMsgModelUtils").typeIsMms(b)?b:null},[C,b.getType]),fa=j(function(a){var b=a[0];a[1];a[2];return d("WAWebMsgModelUtils").typeIsUrl(b)?b:null},[C,b.getType,b.getSubtype]),W=j(function(a){var b=a[0];a[1];return b.type===d("WAWebMsgType").MSG_TYPE.IMAGE||b.type===d("WAWebMsgType").MSG_TYPE.VIDEO?b:null},[C,b.getType]),ga=j(function(a){a[0];var b=a[1],c=a[2];a=a[3];return(b!=null||c!=null)&&a?b!=null?b:c:null},[b.getType,W,R,b.getIsViewOnce]),ha=j(function(a){var b=a[0];a[1];var c=a[2];a=a[3];if(b.type===d("WAWebMsgType").MSG_TYPE.PTT)return b;return b.type===d("WAWebMsgType").MSG_TYPE.AUDIO&&a&&c!=null?b:null},[C,b.getType,b.getWaveform,b.getIsOpus]),X=f("senderObj"),ia=f("mediaData"),ja=f("replyButtons"),ka=f("pendingDeleteForMe",{"default":!1});f=f("botPluginType");var la=j(function(a){var b,c=a[0],e=a[1];a=a[2];return a!=null&&(b=a.id)!=null&&b.isBot()&&(e===d("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.SEARCH||e===d("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.REELS)?c:null},[C,f,X]),ma=j(function(a){var b=a[0];a[1];a=a[2];return b.type===d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE&&a!=null?b:null},[C,b.getType,b.getRichResponse]),na=j(function(a){a=a[0];return d("WAWebMsgModelUtils").getCelebrationAnimationType(a)},[o]),Y=j(function(a){var b=a[0];a=a[1];return d("WAWebMsgModelUtils").isAnimatedEmoji(b,a)},[b.getBody,b.getType]),Z=j(function(a){var b=a[0];a=a[1];return d("WAWebMsgModelUtils").isSingleEmojiMessageText(b,a)},[b.getBody,b.getType]),$=j(function(a){var b=a[0],c=a[1];a=a[2];a=d("WAWebAnimatedEmojiGatingUtils").isStaticSingleEmojiUIEnabled()&&a!=null;return b===d("WAWebMsgType").MSG_TYPE.CHAT&&(c||a)},[b.getType,Y,Z]),oa=j(function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6];a=a[7];e=e!=null||a!=null;return b===d("WAWebMsgType").MSG_TYPE.STICKER?Boolean(!e&&!c&&!(h&&g&&d("WAWebNewsletterGatingUtils").isStickerForwardedAttributionEnabled())&&!i):b===d("WAWebMsgType").MSG_TYPE.CHAT?!e&&f&&!i:b===d("WAWebMsgType").MSG_TYPE.PTV?d("WAWebPtvGatingUtils").isPtvReceivingEnabled():!1},[b.getType,b.getCtwaContext,b.getQuotedMsg,$,b.getHasOriginatedFromNewsletter,b.getIsForwarded,b.getIsQuestion,b.getQuestionReplyQuotedMessage]),pa=j(function(a){a=a[0];if(a==null)return;a=d("WAWebEmoji").EmojiUtil.normalizeEmojiFromString(a);if(a==null)return;return d("WAWebAnimatedEmojiAssetLoader").getAnimatedEmojiAsset(a)},[b.getBody]),qa=j(function(a){var b=a[0],c=a[1],d=a[2];a=a[3];var e;if(b){e=(b=c==null?void 0:c.newsletterId)!=null?b:d.remote}return e!=null?e:a.id},[b.getHasOriginatedFromNewsletter,b.getForwardedNewsletterMessageInfo,b.getId,X]),ra=j(function(a){var b=a[0];a=a[1];return!b&&d("WAWebUserPrefsMeUser").isMeAccount(a)},[b.getIsNewsletterMsg,b.getSender]);j=j(function(a){var b=a[0],c=a[1];a=a[2];b=w(b.unsafe());var d;c&&(d=b==null?void 0:b.contact);return d!=null?d:a},[C,b.getIsNewsletterMsg,X]);g.clearFrontendMsgGetterCacheFor=e;g.getIsMms=k;g.getIsUnsentMedia=l;g.getEventType=m;g.getText=o;g.getIsNewsletterInviteAccepted=p;g.getDir=q;g.getIsRTL=r;g.getRtl=s;g.getHasBodyOrFooter=t;g.getChatCollection=u;g.getCurrentChat=a;g.getChat=v;g.getMaybeChat=w;g.getCarouselCardsCollection=x;g.getCarouselCards=y;g.getButtons=z;g.getHasTemplateButtons=A;g.getIsQuickReply=B;g.getSafeMsg=C;g.getAsProductInquiry=D;g.getAsGroupNotification=E;g.getAsBroadcastNotification=F;g.getAsProduct=G;g.getAsRevoked=H;g.getAssociationType=I;g.getAsAlbumAsset=J;g.getIsUrlMessage=K;g.getAsAutoDownloadableMedia=L;g.getAsGroupedSticker=M;g.getAsDoc=N;g.getAsImage=O;g.getAsVideo=P;g.getAsAudio=Q;g.getAsPtt=R;g.getAsPtv=S;g.getAsPollCreation=T;g.getAsPoll=U;g.getAsPollResultSnapshot=V;g.getAsEventCreation=aa;g.getAsAlbum=ba;g.getAsCallLog=ca;g.getAsPollUpdate=da;g.getAsMms=ea;g.getAsUrl=fa;g.getAsVisualMedia=W;g.getAsViewOnce=ga;g.getAsPttLike=ha;g.getSenderObj=X;g.getMediaData=ia;g.getReplyButtons=ja;g.getPendingDeleteForMe=ka;g.getBotPluginType=f;g.getAsBotPluginCarouselMsg=la;g.getAsRichResponse=ma;g.getCelebrationAnimationCandidate=na;g.getIsAnimatedEmoji=Y;g.getIsSingleEmoji=Z;g.getIsTransparentMsgEmoji=$;g.getIsTransparentMsg=oa;g.getJSONAssetForAnimatedEmoji=pa;g.getMsgSenderId=qa;g.getShouldDisplaySelf=ra;g.getSenderForReplyMsg=j}),98);
__d("WAWebFrontendPollVoteGetters",["WANullthrows","WAWebAck","WAWebContactCollection","WAWebFrontendMsgGetters","WAWebGetters","WAWebGettersCaches","WAWebMsgCollection","WAWebPollVoteGetters","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){b=d("WAWebGetters").createGetterFactories({root:(a=d("WAWebPollVoteGetters")).getPollVoteUnsafe,createCache:d("WAWebGettersCaches").createFrontendPollVotesCache});e=b.field;f=b.computed;b=b.clearCacheFor;b=b;e=e("isSendFailure",{"default":!1});var h=f(function(a){a=a[0];a=c("WANullthrows")(d("WAWebMsgCollection").MsgCollection.get(a));return c("WANullthrows")(d("WAWebFrontendMsgGetters").getAsPollCreation(a))},[a.getParentMsgKey]),i=f(function(a){a=a[0];return d("WAWebContactCollection").ContactCollection.gadd(a)},[a.getSender]);f=f(function(a){var b=a[0],c=a[1];a=a[2];b=d("WAWebUserPrefsMeUser").isMeAccount(b)&&c!=null&&c<d("WAWebAck").ACK.CLOCK;return b||Boolean(a)},[a.getSender,a.getAck,e]);g.clearFrontendPollVoteGetterCacheFor=b;g.getParentMsg=h;g.getSenderObj=i;g.getIsFailed=f}),98);
__d("WAWebUseValuesUtils",["WAWebDummyCacheMap","WAWebGetters","lodash"],(function(a,b,c,d,e,f,g){var h=new(d("WAWebDummyCacheMap").FakeCacheMap)(),i=c("lodash").memoize(function(a){return d("WAWebGetters").createGetterFactories({root:a,createCache:function(){return h}})});a=c("lodash").memoize(function(a){var b=a[0].$$root;b=i(b);b=b.computed;return b(function(a){return a},a)},function(a){return a.map(l).join("-")});var j=new WeakMap(),k=0;function l(a){var b=j.get(a);b==null&&(b=(k++).toString(),j.set(a,b));return b}g.computedForComponent=a}),98);
__d("useWAWebValues",["WAArraysShallowEqual","WANullthrows","WAWebNoop","WAWebUseValuesUtils","react","useWAWebStableCallback"],(function(a,b,c,d,e,f,g){var h;b=h||d("react");var i=b.useEffect,j=b.useMemo,k=b.useRef,l=b.useState,m=function(a){return c("WAWebNoop")};function a(a,b,d){a=n(a,b,d);return c("WANullthrows")(a)}function n(a,b,e){var f=j(function(){return d("WAWebUseValuesUtils").computedForComponent(b)},b),g=l(function(){return a==null?null:f(a)}),h=g[0],n=g[1],p=c("useWAWebStableCallback")(function(){n(function(b){var c=a==null?null:f(a);return o(b,c)?b:c})});g=k(a);var q=g.current;a!==q&&(g.current=a,p());var r=(q=e==null?void 0:e.subscribe)!=null?q:m;i(function(){return r(function(){p()})},[r,p]);return h}function o(a,b){if(a==b)return!0;return a==null||b==null?!1:c("WAArraysShallowEqual")(a,b,function(a,b){if(a===b)return!0;return Array.isArray(a)&&Array.isArray(b)&&a.length===0&&b.length===0?!0:!1})}g.useValues=a;g.useOptionalValues=n}),98);
__d("useWAWebCollectionValues",["invariant","WANullthrows","react","useWAWebListener","useWAWebValues"],(function(a,b,c,d,e,f,g,h){var i;e=i||d("react");var j=e.useCallback,k=e.useMemo,l=e.useState;function a(a,b,d,e){var f=m(a,b,d,e);a=l(function(){return c("WANullthrows")(f,"[useCollectionValues] Expected model to be present in collection")});b=a[0];d=a[1];f!=null&&f!==b&&d(f);return b}function m(a,b,c,e){var f=k(function(){return Array.isArray(a)?a:[a]},[a]),g;typeof c==="function"&&Array.isArray(e)?(g=c,e=e):(Array.isArray(c)||h(0,72179),g=function(a){return a},e=c);c=l(function(){return b==null?null:o(f,b)});var i=c[0],j=c[1],m=function(){var a=b==null?null:o(f,b);(a!==i||(a==null?void 0:a.id.toString())!==(i==null?void 0:i.id.toString()))&&j(a)};m();d("useWAWebListener").useListeners(f.map(function(a){return{source:a,eventOrEvents:"add",callback:function(){m()}}}));c=i==null?null:g(i);return d("useWAWebValues").useOptionalValues(c,e,{subscribe:n(i)})}function b(a,b){return d("useWAWebValues").useValues(a,b,{subscribe:n(a)})}function n(a){return j(function(b){if(a==null)return;a.on("change",b);a.incObservers(!0);return function(){a.decObservers(),a.off("change",b)}},[a])}function o(a,b){for(a of a){var c=a.get(b);if(c!=null)return c}return null}g.useCollectionValues=a;g.useOptionalCollectionValues=m;g.useModelGetterValues=b}),98);
__d("useWAWebChatValues",["WAWebChatCollection","WAWebNewsletterCollection","useWAWebCollectionValues"],(function(a,b,c,d,e,f,g){function a(a,b){return d("useWAWebCollectionValues").useCollectionValues([d("WAWebChatCollection").ChatCollection,c("WAWebNewsletterCollection")],a,b)}function b(a,b){return d("useWAWebCollectionValues").useOptionalCollectionValues([d("WAWebChatCollection").ChatCollection,c("WAWebNewsletterCollection")],a,b)}g.useChatValues=a;g.useOptionalChatValues=b}),98);
__d("useWAWebContactValues",["WAWebContactCollection","useWAWebCollectionValues"],(function(a,b,c,d,e,f,g){function a(a,b){return d("useWAWebCollectionValues").useCollectionValues(d("WAWebContactCollection").ContactCollection,a,b)}function b(a,b){return d("useWAWebCollectionValues").useOptionalCollectionValues(d("WAWebContactCollection").ContactCollection,a,b)}g.useContactValues=a;g.useOptionalContactValues=b}),98);
__d("useWAWebModelValues",["WACustomError","WALogger","WANullthrows","WAWebStateConcern","WAWebStateUtils","react"],(function(a,b,c,d,e,f,g){var h,i;b=i||d("react");var j=b.useCallback,k=b.useEffect,l=b.useRef,m=b.useState,n=function(a){function b(b){b="Received a null value for model key: "+b;return a.call(this,b)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("StateHookMissingModelError"));function a(a,b,e){if(a==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["useModelValues hook received an unexpected `null` model"],["useModelValues hook received an unexpected \\`null\\` model"]))).devConsole("See https://fburl.com/wiki/h7g96q1s for ways to handle this").sendLogs("state-hook-null-model");throw new n("Unknown")}a=o(a,b,e);return c("WANullthrows")(a)}function o(a,b,e){e=e!=null?e:{};var f=e.isStrong,g=f===void 0?!0:f,h=e.componentName,i=a?d("WAWebStateUtils").unproxy(a):null,n=l();function o(){if(!i)return null;if(n.current==null){if(!i)return null;n.current=new(c("WAWebStateConcern"))(h!=null?h:"Hook(useModelValues)",i.proxyName,Array.from(new Set(b)),g,!0)}return n.current}f=m(function(){var a=o();if(!a)return null;var b=a.getModelAndValidate(i);return!b?null:a.createProxy(b)});var p=f[0],q=f[1],r=j(function(a,b){b=a.getModelAndValidate(b);q(b?a.createProxy(b):null)},[]);k(function(){var a=o();if(!a||!p)return;var b=a.getModel(i);a.attachConcern(b,p.proxyBitMask,r);return function(){a.detachConcern(b,r)}},[i,p,r]);e=m(i);a=e[0];f=e[1];e=o();if(a!==i&&e){a&&e.detachConcern(a,r);a=e.getModelAndValidate(i);f(a);q(a?e.createProxy(a):null)}!e&&p!=null&&q(null);return p}g.StateHookMissingModelError=n;g.useModelValues=a;g.useOptionalModelValues=o}),98);
__d("WAWebClearChatUtils",["WAFilteredCatch","WAWebBackendErrors","WAWebChatClearBridge","WAWebNoop","WAWebStatusCollection"],(function(a,b,c,d,e,f,g){function h(a,b){if(a&&b){a.deleteMessages(b);if(a.id&&a.id.isGroup()&&b.length>0){a=d("WAWebStatusCollection").StatusCollection.get(a.id);a==null||a.revokeMsgs(b);(a==null?void 0:a.totalCount)===0&&a["delete"]()}}}function a(a,b){var c=a.promises;if(c.sendClear)return c.sendClear;var e=a.getLastMsgKeyForAction();c.sendClear=d("WAWebChatClearBridge").sendClear(a,e,b);return c.sendClear}function b(a,b){return b.then(function(b){b.result&&h(a,b.result)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").ServerStatusCodeError,c("WAWebNoop")))["finally"](function(){a.promises.sendClear=null})}g.initClearChat=a;g.finalizeClearChat=b}),98);
__d("WAWebCollections",["WAWebAdCollection","WAWebAgentCollection","WAWebBlocklistCollection","WAWebBotProfileCollection","WAWebBusinessCategoriesResultCollection","WAWebBusinessProfileCollection","WAWebCallCollection","WAWebCatalogCollection","WAWebChatAssignmentCollection","WAWebChatCollection","WAWebChatPreferenceCollection","WAWebCommentCollection","WAWebCommunityActivityCollection","WAWebContactCollection","WAWebConversionTupleCollection","WAWebDailyAggregatedStatsCollection","WAWebEmojiVariantCollection","WAWebEventResponseCollection","WAWebFavoriteCollection","WAWebFavoriteStickerCollection","WAWebGroupMetadataCollection","WAWebLabelCollection","WAWebMsgCollection","WAWebMsgInfoCollection","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterMetadataCollection","WAWebOptOutListCollection","WAWebOrderCollection","WAWebPinInChatCollection","WAWebPollsPollVoteCollection","WAWebPremiumMessageCollection","WAWebPresenceCollection","WAWebProfilePicThumbCollection","WAWebQuickReplyCollection","WAWebReactionsCollection","WAWebRecentEmojiCollection","WAWebRecentReactionsCollection","WAWebRecentStickerCollection","WAWebRecentStickerCollectionMd","WAWebStarredMsgCollection","WAWebStatusCollection","WAWebStickerCollection","WAWebStickerPackCollectionMd","WAWebStickerSearchCollection","WAWebSubscriptionCollection","WAWebTextStatusCollection","WAWebUnattributedMessageCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserDisclosureCollection"],(function(a,b,c,d,e,f,g){a={AdCollection:d("WAWebAdCollection").AdCollection,Blocklist:d("WAWebBlocklistCollection").BlocklistCollection,OptOutList:d("WAWebOptOutListCollection").OptOutListCollection,BotProfile:d("WAWebBotProfileCollection").BotProfileCollection,BusinessCategoryResult:d("WAWebBusinessCategoriesResultCollection").BusinessCategoriesResultCollection,BusinessProfile:d("WAWebBusinessProfileCollection").BusinessProfileCollection,Call:c("WAWebCallCollection"),Catalog:d("WAWebCatalogCollection").CatalogCollection,Chat:d("WAWebChatCollection").ChatCollection,ChatAssignment:d("WAWebChatAssignmentCollection").ChatAssignmentCollection,ChatPreference:c("WAWebChatPreferenceCollection"),Contact:d("WAWebContactCollection").ContactCollection,ConversionTuple:c("WAWebConversionTupleCollection"),DailyAggregatedStats:d("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection,EmojiVariant:d("WAWebEmojiVariantCollection").EmojiVariantCollection,FavoriteCollection:d("WAWebFavoriteCollection").FavoriteCollection,GroupMetadata:c("WAWebGroupMetadataCollection"),Label:d("WAWebLabelCollection").LabelCollection,Msg:d("WAWebMsgCollection").MsgCollection,MsgInfo:d("WAWebMsgInfoCollection").MsgInfoCollection,Mute:d("WAWebMuteCollection").MuteCollection,Order:d("WAWebOrderCollection").OrderCollection,PollVote:d("WAWebPollsPollVoteCollection").PollVoteCollection,Presence:d("WAWebPresenceCollection").PresenceCollection,ProfilePicThumb:d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection,QuickReply:d("WAWebQuickReplyCollection").QuickReplyCollection,RecentEmoji:d("WAWebRecentEmojiCollection").RecentEmojiCollection,RecentSticker:d("WAWebRecentStickerCollection").RecentStickerCollection,StarredMsg:d("WAWebStarredMsgCollection").AllStarredMsgsCollection,TextStatus:d("WAWebTextStatusCollection").TextStatusCollection,Status:d("WAWebStatusCollection").StatusCollection,Sticker:d("WAWebStickerCollection").StickerCollection,StickerSearch:d("WAWebStickerSearchCollection").StickerSearchCollection,RecentStickerMD:d("WAWebRecentStickerCollectionMd").RecentStickerCollectionMd,StickerPackCollectionMD:d("WAWebStickerPackCollectionMd").StickerPackCollectionMd,FavoriteSticker:d("WAWebFavoriteStickerCollection").FavoriteStickerCollection,Reactions:d("WAWebReactionsCollection").ReactionsCollection,RecentReactions:d("WAWebRecentReactionsCollection").RecentReactionsCollection,UnjoinedSubgroupMetadataCollection:c("WAWebUnjoinedSubgroupMetadataCollection"),AgentCollection:d("WAWebAgentCollection").AgentCollection,SubscriptionCollection:d("WAWebSubscriptionCollection").SubscriptionCollection,UnattributedMessageCollection:d("WAWebUnattributedMessageCollection").UnattributedMessageCollection,CommunityActivityCollection:c("WAWebCommunityActivityCollection"),CommentCollection:d("WAWebCommentCollection").CommentCollection,PinInChat:d("WAWebPinInChatCollection").PinInChatCollection,NewsletterCollection:c("WAWebNewsletterCollection"),NewsletterMetadataCollection:c("WAWebNewsletterMetadataCollection"),PremiumMessageCollection:d("WAWebPremiumMessageCollection").PremiumMessageCollection,UserDisclosureCollection:d("WAWebUserDisclosureCollection").UserDisclosureCollection,EventResponseCollection:d("WAWebEventResponseCollection").EventResponseCollection};g["default"]=a}),98);
__d("WAWebConversionTupleCollection",["WATimeUtils","WAWebApiParse","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebConversionTupleModel","WAWebUserPrefsKeys"],(function(a,b,c,d,e,f,g){var h=["conversionData"];a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initializeFromCache=function(a){if(!a)return;var b=d("WATimeUtils").unixTime()-d("WAWebConversionTupleModel").ConversionTupleExpiry;a=a.filter(function(a){return a.timestamp-b>0});a=a.map(function(a){var b=a.conversionData;a=babelHelpers.objectWithoutPropertiesLoose(a,h);if(b==null)return a;b=d("WAWebApiParse").parseConversionData(b);return b?babelHelpers["extends"]({},a,{conversionData:b}):a});this.add(a);this.saveToCache()};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebConversionTupleModel").ConversionTuple;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CONVERSION_TUPLE_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();g["default"]=b}),98);
__d("WAWebConversionTupleModel",["WABinary","WALogger","WATimeUtils","WAWebAlarm","WAWebBaseModel","WAWebConversionTupleCollection","WAWebWid"],(function(a,b,c,d,e,f,g){var h=["conversionData"],i,j=7*24*60*60;a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.conversionData=d("WAWebBaseModel").prop(),b.conversionSource=d("WAWebBaseModel").prop(),b.ctwaSignals=d("WAWebBaseModel").prop(),b.timestamp=d("WAWebBaseModel").prop(function(){return d("WATimeUtils").unixTime()}),b.alarmId=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){var b=this;a.prototype.initialize.call(this);this.listenTo(this,"change:timestamp",function(){return b.$ConversionTupleImpl$p_1()});this.$ConversionTupleImpl$p_1()};e.$ConversionTupleImpl$p_1=function(){var a=this,b=this.timestamp+j;if(b<0){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Invalid conversionTuple timer"])));this["delete"]();return}this.alarmId=c("WAWebAlarm").setLocalTimeout(function(){a["delete"]()},b*1e3,this.alarmId)};e.$ConversionTupleImpl$p_2=function(){if(this.alarmId==null)return;c("WAWebAlarm").clearTimeout(this.alarmId);this.alarmId=void 0};e.toJSON=function(){var a=this.serialize(),b=a.conversionData;a=babelHelpers.objectWithoutPropertiesLoose(a,h);if(b instanceof ArrayBuffer){var c=new(d("WABinary").Binary)(b);a.conversionData=c.readString(b.byteLength)}return a};e["delete"]=function(){a.prototype["delete"].call(this),this.getCollection().remove(this.id),this.$ConversionTupleImpl$p_2()};e.getCollection=function(){return c("WAWebConversionTupleCollection")};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="conversionTuple";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g.ConversionTupleExpiry=j;g.ConversionTuple=b}),98);
__d("WAWebProductSelectors",["isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h=function(a){return a.salePriceAmount1000!=null&&(a.salePriceStartDate==null||a.salePriceStartDate<=Date.now())&&(a.salePriceEndDate==null||a.salePriceEndDate>Date.now())},i=function(a){return h(a)?a.salePriceAmount1000:a.priceAmount1000};a=function(a){var b;return h(a)?Math.max(0,((b=a.priceAmount1000)!=null?b:0)-((b=a.salePriceAmount1000)!=null?b:0)):0};b=function(a){var b=a.currency,d=a.priceAmount1000;a=i(a);return c("isStringNullOrEmpty")(b)||d==null||a==null};g.isSalePriceActive=h;g.getActivePrice=i;g.getSavings=a;g.isEmptyPrice=b}),98);
__d("WAWebBizCreateProductInquiry",["WATimeUtils","WAWebAck","WAWebMediaOpaqueData","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebProductSelectors","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function a(a,b,e,f,g){b={ack:d("WAWebAck").ACK.CLOCK,id:new(c("WAWebMsgKey"))({id:"product_inquiry_"+c("WAWebMsgKey").newId_DEPRECATED(),remote:b,fromMe:!0}),from:b,to:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t:d("WATimeUtils").unixTime(),type:d("WAWebMsgType").MSG_TYPE.PRODUCT,kind:d("WAWebMsgType").MsgKind.Product,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,title:a.name,description:a.description,businessOwnerJid:e.toString({legacy:!0}),productId:a.id.toString(),url:a.url,productImageCount:a.getProductImageCollectionCount(),body:f.preview instanceof c("WAWebMediaOpaqueData")?f.preview.getBase64():null,currencyCode:a.currency,priceAmount1000:a.priceAmount1000,salePriceAmount1000:d("WAWebProductSelectors").isSalePriceActive(a)?a.salePriceAmount1000:null,sessionId:g,retailerId:a.retailerId};e=new(d("WAWebMsgModel").Msg)(b);e.mediaData.set(f);return e}g.createProductInquiry=a}),98);
__d("WAWebBusinessCategoriesResultCollection",["WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBusinessCategoriesResultModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function c(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebBizBusinessProfileAction").queryBusinessCategories(a)),c=b.categories;b=b.notABizId;return{id:a,categories:c,notABizId:b}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(c,a);return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebBusinessCategoriesResultModel").BusinessCategoriesResult;a.staleCollection=!0;c=new a();g.BusinessCategoriesResultCollectionImpl=a;g.BusinessCategoriesResultCollection=c}),98);
__d("WAWebBusinessCategoriesResultModel",["WAWebBaseModel","WAWebBusinessCategoriesResultCollection"],(function(a,b,c,d,e,f,g){a="__empty_query__";b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.categories=d("WAWebBaseModel").prop(),b.notABizId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebBusinessCategoriesResultCollection").BusinessCategoriesResultCollection};return b}(d("WAWebBaseModel").BaseModel);b.Proxy="BusinessCategoriesResult";c=d("WAWebBaseModel").defineModel(b);g.BUSINESS_CATEGORY_EMPTY_STR_ID=a;g.BusinessCategoriesResult=c}),98);
__d("WAWebApiDirectConnectionKeys",["WALogger","WAWebSchemaDirectConnectionKeys"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().createOrMerge(a.id,a)}function b(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Removing direct connection keys from persistent DB"])));return d("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().remove(a)}function c(a){return d("WAWebSchemaDirectConnectionKeys").getDirectConnectionKeysTable().get(a)}g.createOrUpdateDirectConnectionKeys=a;g.removeDirectConnectionKeys=b;g.fetchDirectConnectionKeys=c}),98);
__d("WAWebBusinessDirectConnectionModel",["WAWebBaseModel","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.cypher=d("WAWebBaseModel").prop(),b.cypherExpirationTimestamp=d("WAWebBaseModel").prop(),b.cypherType=d("WAWebBaseModel").prop(),b.postcode=d("WAWebBaseModel").prop(),b.postcodeSetByUser=d("WAWebBaseModel").prop(),b.postcodeLocationName=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="business_direct_connection";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebBusinessDirectConnectionCollection",["Promise","WALogger","WANullthrows","WAWebApiDirectConnectionKeys","WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBusinessDirectConnectionModel","WAWebBusinessDirectUtils","WAWebDirectConnectionCypher","WAWebDirectConnectionUtils","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u;a=function(a){function e(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f._getValidCertAndSignedUserInfo=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){if(!e&&c!=null&&c.certificateChain){e=(yield (u||(u=b("Promise"))).all([d("WAWebBusinessDirectUtils").getValidCertificate(d("WAWebDirectConnectionUtils").stringToCertificateString(c.certificateChain)),d("WAWebBizBusinessProfileAction").querySignedUserInfo(a)]));c=e[0];e=e[1];if(c)return{signedUserInfo:e,validCertificate:c}}e=(yield (u||(u=b("Promise"))).all([d("WAWebBizBusinessProfileAction").querySignedUserInfo(a),d("WAWebBusinessDirectUtils").fetchCertificateFullChain(a)]));c=e[0];a=e[1];e=a.certificateString;a=a.leaftCertificateCommonName;if(c.businessDomain!==a)throw new(d("WAWebBusinessDirectUtils").DCCertificateDomainMismatchError)("[direct-connection] certificate common name does not match business domain");a=(yield d("WAWebBusinessDirectUtils").getValidCertificate(e));return{signedUserInfo:c,validCertificate:a}});function c(b,c,d){return a.apply(this,arguments)}return c}();f._getCypherTypeForConversation=function(a,b){return d("WAWebBusinessDirectUtils").userHasSentMessageToBusiness(a)||b?d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode:d("WAWebDirectConnectionCypher").CypherType.Postcode};f._fetchPostcode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(typeof (b==null?void 0:b.postcode)==="string"&&b.postcodeSetByUser===!0){return{postcode:b.postcode,postcodeSetByUser:b.postcodeSetByUser,postcodeLocationName:(b=b.postcodeLocationName)!=null?b:""}}b=(yield d("WAWebBusinessDirectUtils").fetchDefaultPostcode(a));if(b)return babelHelpers["extends"]({},b,{postcodeSetByUser:!1})});function c(b,c){return a.apply(this,arguments)}return c}();f._getCypherFromDborApi=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);var c=(yield d("WAWebApiDirectConnectionKeys").fetchDirectConnectionKeys(a.toJid()));if(!b&&c&&this._isRowDataInGoodCondition(a,c)){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher found in client persistent DB. Using stored cypher ",""])),c.cypherType);return{id:a,cypher:d("WAWebDirectConnectionCypher").stringToCypherString(c.cypher),cypherExpirationTimestamp:c.cypherExpirationTimestamp,cypherType:c.cypherType,certificateChain:c.certificateChain,postcode:c.postcode,postcodeSetByUser:c.postcodeSetByUser,postcodeLocationName:c.postcodeLocationName}}d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher not found / cypher unusable in client DB. Generating direct connection keys"])));var e=this._getCypherTypeForConversation(a,typeof (c==null?void 0:c.postcode)==="string"&&c.postcodeSetByUser===!0);e=(yield this.genNewCypher(a,e,{rowData:c,forceRenew:b}));if(e==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Cannot generate cypher"])));return null}yield d("WAWebApiDirectConnectionKeys").createOrUpdateDirectConnectionKeys(babelHelpers["extends"]({},e,{id:a.toJid(),cypher:d("WAWebDirectConnectionCypher").cypherStringToString(e.cypher)}));return e});function c(b,c){return a.apply(this,arguments)}return c}();f._verifyPostcode=function(a,b){return d("WAWebPersistedJobManager").getJobManager().waitUntilCompleted(d("WAWebPersistedJobDefinitions").jobSerializers.verifyPostcode(a,b))};f._updateModel=function(a){return this.set([a])};f.genNewCypher=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){var g=f.rowData;f=f.forceRenew;d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] new cypher type ",""])),e);f=(yield (u||(u=b("Promise"))).all([this._getValidCertAndSignedUserInfo(a,g,Boolean(f)),this._fetchPostcode(a,g)]));g=f[0];var h=g.validCertificate;g=g.signedUserInfo;f=f[1];if(h==null){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] no certificate returned from the get_public_key IQ"])));return null}if(f==null){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Post code data could not be found"])));return null}var i=c("WANullthrows")(yield d("WAWebBusinessDirectUtils").getCypher(h.chain,f.postcode,g,e));i=i.cypher;g=e===d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?g.phoneNumberSignatureExpiration:null;h=d("WAWebDirectConnectionUtils").certificateStringToString(h.string);return{id:a,cypher:i,cypherExpirationTimestamp:g,cypherType:e,certificateChain:h,postcode:f.postcode,postcodeSetByUser:f.postcodeSetByUser,postcodeLocationName:f.postcodeLocationName}});function e(b,c,d){return a.apply(this,arguments)}return e}();f.verifyAndSavePostcode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){e===void 0&&(e=!1);d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] verify and save postcode called"])));var f=(yield d("WAWebApiDirectConnectionKeys").fetchDirectConnectionKeys(a.toJid())),g=d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode;d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] verify postcode: using cypherType: ",""])),g);f=(yield this._getValidCertAndSignedUserInfo(a,f,e));e=f.validCertificate;f=f.signedUserInfo;if(e==null){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] certificate is null during verify postcode"])));return null}var h=c("WANullthrows")(yield d("WAWebBusinessDirectUtils").getCypher(e.chain,b,f,g)),i=h.cypher,j=h.exportedAesKey;h=h.iv;f=g===d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode?f.phoneNumberSignatureExpiration:null;try{var k=(yield this._verifyPostcode(a,i)),l=k.resultCode;k=k.encryptedLocationName;if(l==="success"&&typeof k==="string"){j=(yield d("WAWebDirectConnectionCypher").decryptDataWithSymmetricKeyToString(j,k,h));k=d("WAWebDirectConnectionUtils").certificateStringToString(e.string);h={cypherExpirationTimestamp:f,certificateChain:k,cypherType:g,postcode:b,postcodeSetByUser:!0,postcodeLocationName:j};yield d("WAWebApiDirectConnectionKeys").createOrUpdateDirectConnectionKeys(babelHelpers["extends"]({id:a.toJid(),cypher:d("WAWebDirectConnectionCypher").cypherStringToString(i)},h));this._updateModel(babelHelpers["extends"]({id:a,cypher:i},h));return{resultCode:l,decryptedLocationName:j}}return{resultCode:l}}catch(c){if(d("WAWebBusinessDirectUtils").errorIsDirectConnectionCypherError421(c)){d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Received 421 from Direct Connection request during verify postcode. Renewing certificate and retrying."])));return this.verifyAndSavePostcode(a,b,!0)}throw c}});function e(b,c,d){return a.apply(this,arguments)}return e}();f.removeCypher=function(a){var c=this.get(a);if(c){d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] removing cypher from cache"])));this.remove(c);return d("WAWebApiDirectConnectionKeys").removeDirectConnectionKeys(a.toJid())}return(u||(u=b("Promise"))).resolve()};f._isCypherInGoodCondition=function(a,b,c,e){return!d("WAWebBusinessDirectUtils").isCypherFromLaunch1(b)&&!d("WAWebBusinessDirectUtils").isCypherExpired(b,c)&&b===this._getCypherTypeForConversation(a,e)};f._isRowDataInGoodCondition=function(a,b){return this._isCypherInGoodCondition(a,b.cypherType,b.cypherExpirationTimestamp,b.postcodeSetByUser===!0)};f._isModelDataInGoodCondition=function(a,b){return this._isCypherInGoodCondition(a,b.cypherType,b.cypherExpirationTimestamp,b.postcodeSetByUser===!0)};f.getCypher=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b===void 0?{}:b;b=b.forceRenew;b=b===void 0?!1:b;var c=b?null:this.get(a);if(!c||!this._isModelDataInGoodCondition(a,c)){d("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher not found / usable cypher in client cache."])));return[].concat(yield this.update(a,{forceRenewDirectConnection:b}))[0]}d("WALogger").DEV(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher found in client cache. Using cached cypher"])));return c});function c(b,c){return a.apply(this,arguments)}return c}();f.findImpl=function(a){return this._getCypherFromDborApi(a)};f._update=function(a,b){b=b.forceRenewDirectConnection;return this._getCypherFromDborApi(a,b)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebBusinessDirectConnectionModel");e=new a();g["default"]=e}),98);
__d("WAWebBusinessDirectUtils",["Promise","WAArraysShallowEqual","WACustomError","WALogger","WANullthrows","WAWeb-moment","WAWebBackendErrors","WAWebBizBusinessProfileAction","WAWebBusinessProfileCollection","WAWebBusinessProfileVersioningBridge","WAWebChatCollection","WAWebDirectConnectionCypher","WAWebDirectConnectionGatingUtils","WAWebDirectConnectionUtils","WAWebDirectConnectionX509","WAWebServerPropConstants","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j="YYYYMMDDTHHmmssZ",k=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("DCCertificateDomainMismatchError"));function a(a,b,e){e===void 0&&(e=c("WAWeb-moment")());if(a!==d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode)return!1;if(b==null)return!0;a=c("WAWeb-moment")(b,j);b=!(a.isValid()&&a.isAfter(e));b&&d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] cypher is expired."])));return b}function e(a){return!a}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebDirectConnectionX509").extractCertificates(d("WAWebDirectConnectionUtils").certificateStringToString(a))),c=(yield d("WAWebDirectConnectionX509").validateCertificates(b.slice(1,-1),b.slice(-1)));c=c.result;return!c?null:{string:a,chain:b}});return l.apply(this,arguments)}function m(a,b,c){switch(a){case d("WAWebDirectConnectionCypher").CypherType.PhoneNumberAndPostcode:return{postcode:b,phone_number:c.phoneNumber,ttl_timestamp:c.phoneNumberSignatureExpiration,phone_number_signature:c.phoneNumberSignature};case d("WAWebDirectConnectionCypher").CypherType.Postcode:return{postcode:b}}}function n(a,b,c,e){e=m(e,b,c);return d("WAWebDirectConnectionCypher").genCypher(a[0],e)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e;a=(yield (i||(i=b("Promise"))).all([d("WAWebBizBusinessProfileAction").queryBusinessPublicKey(a),d("WAWebDirectConnectionX509").fetchFromCABundle()]));var f=a[0].certificate;a=a[1];if(f==null)throw c("err")("[direct-connection] no certificate returned from the get_public_key IQ");f=(yield d("WAWebDirectConnectionX509").extractCertificates(d("WAWebDirectConnectionUtils").certificateStringToString(f)));e=f.length>0?(e=f[0].subject.typesAndValues.find(function(a){return a.type==="2.5.4.3"}))==null?void 0:e.value.valueBlock.value:null;a=c("WANullthrows")(yield d("WAWebDirectConnectionX509").genRootIssuers(f,a));return{certificateString:d("WAWebDirectConnectionX509").encodeToString([].concat(f,a)),leaftCertificateCommonName:e}});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return Boolean(d("WAWebDirectConnectionGatingUtils").supportsDirectConnection()&&d("WAWebChatCollection").ChatCollection.get(a)!=null&&((a=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a)))==null?void 0:a.isBusinessDirectConnection()))});return r.apply(this,arguments)}function s(a){a=d("WAWebChatCollection").ChatCollection.get(a);return!!a&&a.hasMaybeSentMsgToChat()}function t(a){var b;return((b=a.directConnection)==null?void 0:b.enabled)===!0&&typeof ((b=a.directConnection.defaultPostcode)==null?void 0:b.code)==="string"}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a));if((b=a.directConnection)!=null&&b.enabled&&a.directConnection.defaultPostcode)return{postcode:a.directConnection.defaultPostcode.code,postcodeLocationName:a.directConnection.defaultPostcode.locationName}});return v.apply(this,arguments)}var w=421;function x(a){return a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===w}var y=function(a,b){if(a===d("WAWebServerPropConstants").UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS)return!1;a=(d("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersionWithCustomBizProfileOptions(a)&d("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0;b=(d("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersionWithCustomBizProfileOptions(b)&d("WAWebBusinessProfileVersioningBridge").DIRECT_CONNECTION_FLAG)>0;return a!==b},z=function(a,b){return a!=null&&!c("WAArraysShallowEqual")(a,b)};g.timestampFormat=j;g.DCCertificateDomainMismatchError=k;g.isCypherExpired=a;g.isCypherFromLaunch1=e;g.getValidCertificate=f;g.getCypher=n;g.fetchCertificateFullChain=o;g.isCypherNeeded=q;g.userHasSentMessageToBusiness=s;g.businessSupportsPostcode=t;g.fetchDefaultPostcode=u;g.errorIsDirectConnectionCypherError421=x;g.isDirectConnectionFlagChanged=y;g.isDirectConnectionNumbersAbPropChanged=z}),98);
__d("WAWebBusinessProfileCollection",["Promise","WALogger","WAWebABPropsLocalStorage","WAWebApiBusinessProfile","WAWebBaseCollection","WAWebBizBusinessProfileAction","WAWebBizGatingUtils","WAWebBusinessDirectUtils","WAWebBusinessProfileModel","WAWebBusinessProfileUtils","WAWebCmd","WAWebContactCollection","WAWebDirectConnectionGatingUtils","WAWebHandleBizBotAutomatedTypeAction","WAWebHandleBizBotWelcomeMsgProtocolModeAction","WAWebLidMigrationUtils","WAWebServerPropConstants","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;a="catalog_exists";e=function(a){function e(){var b;b=a.call(this)||this;b._inflightDbQueryMap=new Map();var c=d("WAWebABPropsLocalStorage").isABPropsAfterFirstSync()?d("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop():null,e=d("WAWebABPropsLocalStorage").isABPropsAfterFirstSync()?d("WAWebBizGatingUtils").webBizProfileOptions():d("WAWebServerPropConstants").UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS;b.listenTo(d("WAWebCmd").Cmd,"on_ab_props_update",function(){var a=d("WAWebBizGatingUtils").webBizProfileOptions();d("WAWebBusinessDirectUtils").isDirectConnectionFlagChanged(e,a)&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] change in direct connection bit detected. marking relevant biz profiles from abprop numbers as stale"]))),b._markBizProfilesAsStale(d("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop()));e=a;try{a=d("WAWebDirectConnectionGatingUtils").directConnectionBusinessNumbersFromAbprop();d("WAWebBusinessDirectUtils").isDirectConnectionNumbersAbPropChanged(c,a)&&b._markBizProfilesAsStale(Array.from(new Set((c!=null?c:[]).concat(a))));c=a}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] Failed to force update biz profiles on abprop biz numbers change"]))).verbose().devConsole(a).sendLogs("direct-connection-biz-number-abprop-sync-fail"+a)}});return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.findImpl=function(a){return this._findAndParse(a,{queryCatalog:!0})};f._update=function(a,b){return this._findAndParse(a,{queryCatalog:!1,getMerchantCompliance:b==null?void 0:b.getMerchantCompliance})};f._findAndParse=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.queryCatalog;c=c.getMerchantCompliance;var f=this.gadd(a);if(!f.id.isUserNotPSA()||f.id.isFbidBot()){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse businessProfile is only available to users (",")"])),String(a));return(o||(o=b("Promise"))).resolve({id:a})}c=d("WAWebBizBusinessProfileAction").queryBusinessProfile([{wid:f.id,tag:f.tag}],c);c=(yield c);if(!Array.isArray(c)){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Received invalid business profile response"]))).devConsole(c);return null}if(c.length===0){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse No businessProfile found for ",""])),String(a));return{id:a}}c=c[0];var g=c.wid,h=c.tag;g={id:g,tag:h,dataSource:"server"};h=c.profile;if(h){var i=d("WAWebContactCollection").ContactCollection.get(a);i&&!i.isContactSyncCompleted&&(i.set("isBusiness",!0),i.set("forcedBusinessUpdateFromServer",!0));i=d("WAWebBusinessProfileUtils").parseBusinessProfile({id:c.wid,profile:h,queryCatalog:e});c=f.dataSource==="placeholder"?null:f.automatedType;h=i.automatedType;yield d("WAWebHandleBizBotAutomatedTypeAction").handleBizBotAutomatedTypeTransition(f.id,c,h);e=f.dataSource==="placeholder"?null:f.welcomeMsgProtocolMode;c=i.welcomeMsgProtocolMode;yield d("WAWebHandleBizBotWelcomeMsgProtocolModeAction").handleBizBotWelcomeMsgProtocolModeTransition(f.id,e,c);yield d("WAWebApiBusinessProfile").createOrMergeBusinessProfileRecordLidAware({id:g.id,automatedType:i.automatedType,welcomeMsgProtocolMode:i.welcomeMsgProtocolMode,prompts:i.prompts,commands:i.commands,commandsDescription:i.commandsDescription});d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:_findAndParse parse and save business profile from server ",""])),a.toString()).devConsole(i);return babelHelpers["extends"]({},i,g)}return g});function c(b,c){return a.apply(this,arguments)}return c}();f.fetchBizProfile=function(a){var b=this.get(a);b&&b.markStale();return this.find(a)};f.getValid=function(a){a=this.get(a);if(a!=null&&a.isValid())return a};f.markProfileAsStale=function(a){(a=this.get(a))==null||a.markStale()};f.hasBusinessProfileInCache=function(a){return!!this.get(a)};f.convertBusinessProfileIdForLidMigration=function(a){a=a instanceof c("WAWebWid")?a:d("WAWebWidFactory").createWid(a.toString());if(a.isLid()){var b=d("WAWebLidMigrationUtils").toPn(a);if(b!=null)return b}return a};f._markBizProfilesAsStale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;yield (o||(o=b("Promise"))).all(a.map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)}).filter(function(a){return c.hasBusinessProfileInCache(a)}).map(function(a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] forcefully marking biz profile as stale"]))),c.markProfileAsStale(a)}))});function c(b){return a.apply(this,arguments)}return c}();return e}(d("WAWebBaseCollection").BaseCollection);e.model=d("WAWebBusinessProfileModel").BusinessProfile;e.staleCollection=!0;f=new e();g.CATALOG_EXISTS=a;g.BusinessProfileCollection=f}),98);
__d("WAWebBusinessProfileModel",["WAWebBaseModel","WAWebBotGating","WAWebBotTypes","WAWebBusinessProfileCollection","WAWebBusinessProfileTypes","WAWebChatCollection","WAWebChatGroupUtils","WAWebContactCollection","WAWebOrderRequestMsg.flow","WAWebProductCatalogMetaLinkingGatingUtils","WAWebWid"],(function(a,b,c,d,e,f,g){var h="wa.me/";a=3;b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.dataSource=d("WAWebBaseModel").prop("placeholder"),b.tag=d("WAWebBaseModel").prop(),b.description=d("WAWebBaseModel").prop(),b.categories=d("WAWebBaseModel").prop(),b.profileOptions=d("WAWebBaseModel").prop(),b.email=d("WAWebBaseModel").prop(),b.website=d("WAWebBaseModel").prop(),b.latitude=d("WAWebBaseModel").prop(),b.longitude=d("WAWebBaseModel").prop(),b.businessHours=d("WAWebBaseModel").prop(),b.catalogStatus=d("WAWebBaseModel").prop(),b.address=d("WAWebBaseModel").prop(),b.structuredAddress=d("WAWebBaseModel").prop(),b.serviceAreas=d("WAWebBaseModel").prop(),b.legalEntityDetails=d("WAWebBaseModel").prop(),b.fbPage=d("WAWebBaseModel").prop(),b.igProfessional=d("WAWebBaseModel").prop(),b.isProfileLinked=d("WAWebBaseModel").prop(),b.directConnection=d("WAWebBaseModel").prop(),b.customUrlPath=d("WAWebBaseModel").prop(),b.isProfileLocked=d("WAWebBaseModel").prop(!0),b.memberSinceText=d("WAWebBaseModel").prop(),b.customUrl=d("WAWebBaseModel").derived(function(){var a;if(this.customUrlPath!=null)a=this.customUrlPath;else return null;return""+h+a},["customUrlPath"]),b.coverPhoto=d("WAWebBaseModel").prop(),b.automatedType=d("WAWebBaseModel").prop(d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN),b.welcomeMsgProtocolMode=d("WAWebBaseModel").prop(d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE),b.prompts=d("WAWebBaseModel").prop(),b.commandsDescription=d("WAWebBaseModel").prop(),b.commands=d("WAWebBaseModel").prop(),b.stale=d("WAWebBaseModel").session(!0),b.isBizBot3p=d("WAWebBaseModel").derived(function(){return this.automatedType===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P},["automatedType"]),b.isBizBot1p=d("WAWebBaseModel").derived(function(){return this.automatedType===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P},["automatedType"]),b.isCatalogDisabledDueToMetaLinking=d("WAWebBaseModel").derived(function(){return d("WAWebProductCatalogMetaLinkingGatingUtils").shouldDisableCatalogDueToMetaLinkingForProfile(this)},["profileOptions"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){var b=this;a.prototype.initialize.call(this);this.listenTo(this,"change:automatedType",function(){b.$BusinessProfileImpl$p_1(),b.$BusinessProfileImpl$p_2()});this.$BusinessProfileImpl$p_1();this.$BusinessProfileImpl$p_2()};c.markStale=function(){this.stale=!0,this.hasObservers()&&this.getCollection().find(this.id)};c.getCollection=function(){return d("WAWebBusinessProfileCollection").BusinessProfileCollection};c.isValid=function(){return Array.isArray(this.categories)};c.isBusinessDirectConnection=function(){var a;return(a=(a=(a=this.directConnection)==null?void 0:a.enabled)!=null?a:(a=this.profileOptions)==null?void 0:a.directConnection)!=null?a:!1};c.getCatalogType=function(){var a;if(((a=this.profileOptions)==null?void 0:a.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG)return d("WAWebOrderRequestMsg.flow").CatalogType.SMB_META_CATALOG;else if(((a=this.profileOptions)==null?void 0:a.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG)return d("WAWebOrderRequestMsg.flow").CatalogType.NATIVE;return d("WAWebOrderRequestMsg.flow").CatalogType.UNKNOWN};c.$BusinessProfileImpl$p_2=function(){if(!d("WAWebBotGating").isBizBot3pEnabled()||!this.isBizBot3p)return;var a=d("WAWebContactCollection").ContactCollection.get(this.id);a==null||a.updateName()};c.$BusinessProfileImpl$p_1=function(){var a=d("WAWebChatCollection").ChatCollection.getLatestChatForWid(this.id);a&&d("WAWebChatGroupUtils").updateCanSend(a,this)};return b}(d("WAWebBaseModel").BaseModel);b.Proxy="businessProfile";b.idClass=c("WAWebWid");e=d("WAWebBaseModel").defineModel(b);f={description:null,email:null,website:null,latitude:null,longitude:null};g.BUSINESS_URL_DOMAIN=h;g.MAX_BUSINESS_CATEGORIES=a;g.BusinessProfile=e;g.DEFAULTS=f}),98);
__d("WAWebSmbUtilsTimeUtils",["WAWeb-moment","WAWebClock"],(function(a,b,c,d,e,f,g){b="h:mm A";e="h:mmA";f="H:mm";var h="H.mm",i="HH:mm",j="HH.mm",k=[b,e,i,j,f,h];b=function(a){var b;a=a.trim();if(!a)return;for(var d of k){var e=c("WAWeb-moment")(a,d,!0);if(e.isValid()){b=e;break}}if(!b)return;e=b;d=c("WAWeb-moment")().startOf("day");a=e.diff(d);return c("WAWeb-moment").duration(a).asMinutes()};function a(a){return c("WAWeb-moment").utc().startOf("day").add(a,"minutes").format(d("WAWebClock").Clock.timestampStrFormat())}g.timeStringToMinutes=b;g.minutesToTime=a}),98);
__d("WAWebSmbUtils",["fbt","WAWeb-moment","WAWebBusinessProfileTypes","WAWebSmbUtilsTimeUtils"],(function(a,b,c,d,e,f,g,h){function i(a){return c("WAWeb-moment").weekdays(a)}function j(a,b){switch(a==null?void 0:a.mode){case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS:return b?l(a==null?void 0:a.hours):k(a==null?void 0:a.hours);case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:return h._(/*BTDS*/"By appointment only");case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.OPEN_24H:return h._(/*BTDS*/"Open 24 hours");default:return h._(/*BTDS*/"Closed")}}function k(a){return a?a.map(function(a){return a.map(d("WAWebSmbUtilsTimeUtils").minutesToTime).join(" - ")}).join("\n"):""}function l(a){if((a==null?void 0:a.length)===1)return a[0].map(d("WAWebSmbUtilsTimeUtils").minutesToTime).join(" - ");else if((a==null?void 0:a.length)===2){var b,c=(b=d("WAWebSmbUtilsTimeUtils")).minutesToTime(a[0][0]),e=b.minutesToTime(a[0][1]),f=b.minutesToTime(a[1][0]);b=b.minutesToTime(a[1][1]);return h._(/*BTDS*/"{openTime} - {closeTime} and {additionalOpenTime} - {additionalCloseTime}",[h._param("openTime",c),h._param("closeTime",e),h._param("additionalOpenTime",f),h._param("additionalCloseTime",b)])}return""}function a(a,b){var c=a.config,e=new Date().getDay();a=d("WAWebBusinessProfileTypes").DAYS_OF_WEEK.map(function(a,f){a=(e+f)%d("WAWebBusinessProfileTypes").DAYS_OF_WEEK.length;var g=d("WAWebBusinessProfileTypes").DAYS_OF_WEEK[a];a=i(a);g=j(c[g],b).toString();return{day:a,first:f===0,hours:g}});return a}function b(a){var b=a==null?{}:a.config;a=a||{};var e=a.note;a=a.timezone;var f,g=d("WAWebBusinessProfileTypes").DAYS_OF_WEEK.map(function(a,c){var e=b[a],g=!e;c=i(c);var h;e&&(f=e.mode,e.hours&&(h=e.hours.map(function(a){var b=a[0];a=a[1];return[d("WAWebSmbUtilsTimeUtils").minutesToTime(b),d("WAWebSmbUtilsTimeUtils").minutesToTime(a)]})));return{closed:g,dayKey:a,dayName:c,hours:h}}),h=c("WAWeb-moment").weekdays(!0,0);h=c("WAWeb-moment").weekdays().indexOf(h);h=g.splice(h);h=[].concat(h,g);return{days:h,mode:f,note:e,timezone:a}}g.getBusinessHours=a;g.getBusinessHoursForEdit=b}),226);
__d("WAWebBusinessProfileUtils",["fbt","WALogger","WAUpperFirst","WAWebBizGatingUtils","WAWebBotTypes","WAWebBusinessProfileModel","WAWebBusinessProfileTypes","WAWebCatalogCollection","WAWebContactCollection","WAWebExternalLink.react","WAWebSmbUtils","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g,h){var i,j=["business_hours","catalog_status","structured_address","service_areas","profile_options","address","legal_entity_details","fb_page","ig_professional","profile_is_linked","cover_photo","custom_url","automated_type","commands_description","welcome_message_protocol_mode","member_since_text","prompts","commands"],k="catalog_exists",l="https://business.facebook.com/commerce/",m=function(a){var b=a.config;a=a.timezone;var c={};b.forEach(function(a){var b=a.day_of_week,e=a.mode;if(!d("WAWebBusinessProfileTypes").isBusinessHoursDayName(b))return;if(e===d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var f,g=a.open_time;a=a.close_time;c[b]||(c[b]={mode:e,hours:[]});g!=null&&a!=null&&(f=c[b])!=null&&f.hours&&c[b].hours.push([g,a])}else c[b]={mode:e}});return{config:c,timezone:a}},n=function(a){var b,c;return(a==null||(b=a.profile_options)==null?void 0:b.commerce_experience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG||(a==null||(c=a.profile_options)==null?void 0:c.commerce_experience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG&&d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()||(a==null?void 0:a.catalog_status)===k};b=function(a){if(a&&a instanceof d("WAWebBusinessProfileModel").BusinessProfile){var b;return((b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG||((b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.META_CATALOG&&d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()||a.catalogStatus===k}return n(a)};var o=function(a){var b,c;return(a==null||(b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.SHOP&&Boolean(a==null||(c=a.profileOptions)==null?void 0:c.shopURL)};e=function(a){var b,c;return(a==null||(b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE||o(a)&&!!(a!=null&&(c=a.profileOptions)!=null&&c.isBanned)};f=function(a){var b;a=a==null||(b=a.profileOptions)==null?void 0:b.shopURL;a!=null&&a!==""&&d("WAWebExternalLink.react").openExternalLink(a)};var p=function(a){var b;a=a==null||(b=a.profileOptions)==null?void 0:b.commerceManagerURL;a=a!=null&&a!==""?a:l;d("WAWebExternalLink.react").openExternalLink(a)},q=function(a){return n(a)},r=function(a){var b=a.email,d=a.landline_number;a=a.mobile_number;b={email:b};c("isStringNullOrEmpty")(d)||(b.landlineNumber=d);c("isStringNullOrEmpty")(a)||(b.mobileNumber=a);return b},s=function(a){var b=a.email,c=a.landline_number;a=a.mobile_number;return r({email:b,landline_number:c,mobile_number:a})},t=function(a){var b=a.name,c=a.email,d=a.landline_number;a=a.mobile_number;c=r({email:c,landline_number:d,mobile_number:a});return babelHelpers["extends"]({},c,{name:b})},u=function(a){var b=a.entity_name,d=a.entity_type,e=a.is_registered,f=a.entity_type_custom,g=a.customer_care_details;a=a.grievance_officer_details;b={entityName:b,entityType:d,isRegistered:e};c("isStringNullOrEmpty")(f)||(b.entityTypeCustom=f);g&&(b.customerCareDetails=s(g));a&&(b.grievanceOfficerDetails=t(a));return b},v=function(a){var b=a.profile,e=a.id;a=a.queryCatalog;if(!b)return{id:e};var f=b.business_hours,g=b.catalog_status,h=b.structured_address;b.service_areas;var k=b.profile_options,l=b.address,n=b.legal_entity_details,o=b.fb_page,p=b.ig_professional,r=b.profile_is_linked,s=b.cover_photo,t=b.custom_url,v=b.automated_type,w=b.commands_description,x=b.welcome_message_protocol_mode,y=b.member_since_text,z=b.prompts,A=b.commands,B=babelHelpers.objectWithoutPropertiesLoose(b,j),C={id:e};f?C.businessHours=m(f):C.businessHours=null;y!=null&&d("WAWebBizGatingUtils").getFmxAgmEnabled()&&(C.memberSinceText=y);k&&(C.profileOptions={commerceExperience:k.commerce_experience,directConnection:k.direct_connection},k.cart_enabled!=null&&(C.profileOptions.cartEnabled=k.cart_enabled),k.shop_url!=null&&(C.profileOptions.shopURL=k.shop_url),k.commerce_manager_url!=null&&(C.profileOptions.commerceManagerURL=k.commerce_manager_url),k.is_banned!=null&&(C.profileOptions.isBanned=k.is_banned),k.is_profile_edit_disabled!=null&&(C.profileOptions.isProfileEditDisabled=k.is_profile_edit_disabled));q(b)&&(C.catalogStatus=g,a&&d("WAWebCatalogCollection").CatalogCollection.findCarouselCatalog(e).then(function(a){a=Array.isArray(a)?a[0]:a;var b=d("WAWebContactCollection").ContactCollection.get(e);b&&(b.businessCatalog=a)})["catch"](function(a){return d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Store:BusinessProfile:missing catalog"]))).devConsole(a)}));h?C.structuredAddress={streetAddress:h.street_address,cityId:h.city_id,localizedCityName:h.localized_city_name,zipCode:h.zip_code}:C.address=c("isStringNullOrEmpty")(l)?null:l;n&&(C.legalEntityDetails=u(n));o&&(C.fbPage={displayName:o.display_name,likes:o.likes,id:o.id});p&&(C.igProfessional={handle:p.ig_handle,followers:p.followers});r!=null&&(C.isProfileLinked=!!r);t!=null&&(C.customUrlPath=t);C.automatedType=v!=null?v:d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN;C.welcomeMsgProtocolMode=x!=null?x:d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.NONE;C.commandsDescription=w!=null?w:null;C.prompts=z!=null?z:null;C.commands=A!=null?A:null;C.coverPhoto=s!=null?{id:s.id,url:s.url}:null;return babelHelpers["extends"]({},d("WAWebBusinessProfileModel").DEFAULTS,B,C)},w=function(a){var b;return a.address!=null&&a.description!=null&&((b=a.businessHours)==null?void 0:b.config)!=null&&Object.keys(a.businessHours.config).length!==0&&a.email!=null&&((b=a.website)==null?void 0:b.length)!==0},x={OPEN:"open",CLOSED:"closed",OPEN_TODAY:"open_today",CLOSED_TODAY:"closed_today",OPEN_APPOINTMENT:"open_appointment",OPEN_24H:"open_24h",UNKNOWN:"unknown"};function y(a,b){if(a.timezone==null)return{status:"unknown"};b=b||new Date();var c=new Date(b.toLocaleString("en-US",{timeZone:a.timezone}));c=(b.getTime()-c.getTime())/1e3/60;a=a.config[d("WAWebBusinessProfileTypes").DAYS_OF_WEEK[b.getDay()]];if(!a)return{status:x.CLOSED_TODAY};var e=a.mode;switch(e){case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.OPEN_24H:if(a)return{status:x.OPEN_24H};break;case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.APPOINTMENT_ONLY:if(a)return{status:x.OPEN_APPOINTMENT};break;case d("WAWebBusinessProfileTypes").BUSINESS_HOUR_MODES.SPECIFIC_HOURS:e=b.getHours()*60+b.getMinutes();if(((b=a.hours)==null?void 0:b.length)===1){b=a.hours[0][0];var f=a.hours[0][1];if(e>=b&&e<=f)return{status:x.OPEN,openUntil:z(c+f)};else if(e<=b)return{status:x.CLOSED,opensAt:z(c+b)};return{status:x.CLOSED}}else if(((f=a.hours)==null?void 0:f.length)===2){b=a.hours[0][0];f=a.hours[0][1];var g=a.hours[1][0];a=a.hours[1][1];if(e>=b&&e<=f)return{status:x.OPEN,openUntil:z(c+f),additionalOpen:z(c+g),additionalClose:z(c+a)};else if(e<b)return{status:x.CLOSED,opensAt:z(c+b),additionalOpen:z(c+g),additionalClose:z(c+a)};else if(e>=g&&e<=a)return{status:x.OPEN,openUntil:z(c+a)};else if(e<g)return{status:x.CLOSED,opensAt:z(c+g)};return{status:x.CLOSED}}break}return{status:"unknown"}}function z(a){var b=new Date(),c=Math.floor(a/60);b.setHours(c);b.setMinutes(a%60);b.setSeconds(0);return b}function A(a){a=y(a);switch(a.status){case x.OPEN_24H:case x.OPEN_APPOINTMENT:case x.OPEN:return!0;case x.CLOSED:case x.CLOSED_TODAY:default:return!1}}function a(a){var b=A(a)?h._(/*BTDS*/"We're currently *open*"):h._(/*BTDS*/"We're currently *closed*"),e=h._(/*BTDS*/"Our business hours are:");a=d("WAWebSmbUtils").getBusinessHours(a,!0);a=a.map(function(a){return c("WAUpperFirst")(a.day)+": "+a.hours}).join("\n");return[b,e,a].join("\n")}g.CATALOG_EXISTS=k;g.hasCatalog=b;g.hasShop=o;g.isShopBanned=e;g.goToShop=f;g.goToCommerceManager=p;g.parseBusinessProfile=v;g.isCompleteBizProfile=w;g.BUSINESS_OPEN_STATUS=x;g.getBusinessOpenState=y;g.quickReplyHoursStr=a}),226);
__d("WAWebButtonCollection",["WAWebBaseCollection","WAWebButtonModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebButtonModel");g.ButtonCollection=a}),98);
__d("WAWebChatProductMsgsCollection",["Promise","WAWebBaseCollection","WAWebFrontendMsgGetters","WAWebMsgModel"],(function(a,b,c,d,e,f,g){var h;a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.hasProductBefore=!0,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e["delete"]=function(){a.prototype["delete"].call(this),this.stopListening(),this.reset()};e.queryProducts=function(a,c){c=a.msgs;this.hasProductBefore=!1;a=c.filter(function(a){return d("WAWebFrontendMsgGetters").getAsProduct(a)!=null});a.length===0?this.trigger("products_loaded"):this.add(a,{at:0});return(h||(h=b("Promise"))).resolve()};return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return a.t-b.t};g["default"]=a}),98);
__d("WAWebMsgButtonReplyMsgModel",["WAWebBaseModel","WAWebMsgKey"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.unsyncedButtonReplies=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="msgButtonReplyMsg";a.idClass=c("WAWebMsgKey");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebMsgButtonReplyMsgCollection",["WAWebBaseCollection","WAWebMsgButtonReplyMsgModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebMsgButtonReplyMsgModel");g["default"]=a}),98);
__d("WAWebTemplateButtonCollection",["WAWebBaseCollection","WAWebTemplateButtonModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebTemplateButtonModel");a.comparator=function(a,b){if(a.id<b.id)return-1;return a.id>b.id?1:0};g.TemplateButtonCollection=a}),98);
__d("WAWebTemplateButtonReplyMsgCollection",["WAWebBaseCollection","WAWebMsgModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return b.t-a.t};g["default"]=a}),98);
__d("WAWebAgentCollection",["WAWebAgentModel","WAWebAgentModelUtils","WAWebBaseCollection","WAWebConnModel","WAWebSyncdOrphan"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.$AgentCollectionImpl$p_1=new Map();b.triggerDeviceIdMapUpdate=function(){b.$AgentCollectionImpl$p_1=new Map(),b.getModelsArray().forEach(function(a){b.$AgentCollectionImpl$p_1.set(a.deviceId,a)})};b.on("remove reset",b.triggerDeviceIdMapUpdate);d("WAWebConnModel").Conn.on("change:pushname",function(){var a=b.getModelsArray().filter(function(a){return a.deviceId===d("WAWebAgentModelUtils").PRIMARY_DEVICE_ID})[0];a!=null&&a.set("name",d("WAWebAgentModelUtils").getFormattedAgentNameForAgent(a))});return b}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.add=function(b,c){b=a.prototype.add.call(this,b,c);this.triggerDeviceIdMapUpdate();d("WAWebSyncdOrphan").checkOrphanAgents(b.map(function(a){return(a=a==null?void 0:a.id)!=null?a:""}));return b};c.getByDeviceId=function(a){return this.$AgentCollectionImpl$p_1.get(a)};c.initializeFromCache=function(a){this.add(a,{merge:!0})};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebAgentModel").Agent;b=new a();g.AgentCollection=b}),98);
__d("WAWebAgentModel",["WAWebAgentCollection","WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.deviceId=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.isDeleted=d("WAWebBaseModel").prop(!1),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebAgentCollection").AgentCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="agent";b=d("WAWebBaseModel").defineModel(a);g.Agent=b}),98);
__d("WAWebAgentModelUtils",["fbt","WAWebBizGatingUtils","WAWebConnModel","WAWebPremiumAccessEngine"],(function(a,b,c,d,e,f,g,h){function i(){return h._(/*BTDS*/"{business-name} (Admin)",[h._param("business-name",d("WAWebConnModel").Conn.pushname)])}function a(){return d("WAWebBizGatingUtils").isMultiDeviceMessageAttributionEnabled()&&d("WAWebPremiumAccessEngine").isFeatureFlagEnabled("MD_EXTENSION")}var j=0;function k(a,b){return b===j?i().toString():a}function b(a){return k(a.name,a.deviceId)}g.canUserSeeMessageAttribution=a;g.PRIMARY_DEVICE_ID=j;g.getFormattedAgentName=k;g.getFormattedAgentNameForAgent=b}),226);
__d("WAWebUnattributedMessageCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebUnattributedMessageModel","WAWebUserPrefsKeys"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebUnattributedMessageModel").UnattributedMessage;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.UNATTRIBUTED_MESSAGE_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();g.UnattributedMessageCollection=b}),98);
__d("WAWebUnattributedMessageModel",["WAWebBaseModel","WAWebUnattributedMessageCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.deviceId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebUnattributedMessageCollection").UnattributedMessageCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="unattributed_message";b=d("WAWebBaseModel").defineModel(a);g.UnattributedMessage=b}),98);
__d("WAWebPremiumAccessEngine",["Promise","WALogger","WAWebBizGatingUtils","WAWebInitFromStorage","WAWebSubscriptionCollection","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p="{}";c("gkx")("26258")||(p='{"CUSTOM_URL": ["WA_PREMIUM_1"], "MD_EXTENSION": ["WA_PREMIUM_1"]}');var q=new Map(),r=new Map(),s=!1,t=null;function a(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=p);if(s)return;if(d("WAWebBizGatingUtils").isSmbOrangeEnabled()){yield d("WAWebInitFromStorage").restoreSubscriptions();t=A(a);a=z();a.forEach(function(a,b){r.set(b,{subscription:a[0].clone(),hasChanged:!1})});s=!0;yield (o||(o=b("Promise"))).resolve();q.forEach(function(a,b){var c=r.get(b);a.forEach(function(a){try{a((c==null?void 0:c.subscription)||null,(c==null?void 0:c.hasChanged)||!1)}catch(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler during initialize for feature ",", error ",""])),b,a).sendLogs("PremiumAccessEngine")}})})}});return u.apply(this,arguments)}function e(a,c){if(!d("WAWebBizGatingUtils").isSmbOrangeEnabled()){(o||(o=b("Promise"))).resolve().then(function(){return c(null,!1)});return function(){return void 0}}var e=q.get(a);e||(e=new Set(),q.set(a,e));e.add(c);s&&(o||(o=b("Promise"))).resolve().then(function(){var b=r.get(a);try{c((b==null?void 0:b.subscription)||null,(b==null?void 0:b.hasChanged)||!1)}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler during listen for feature ",", error ",""])),a,b).sendLogs("PremiumAccessEngine")}});return function(){var b=q.get(a);b&&b["delete"](c)}}function v(a){if(!d("WAWebBizGatingUtils").isSmbOrangeEnabled())return null;if(!s)throw c("err")("Premium access engine getFeatureFlagState() for feature "+a+" called before initialize()");return(a=(a=r.get(a))==null?void 0:a.subscription)!=null?a:null}function w(a){var b;try{b=v(a)}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(['isFeatureFlagEnabled: trying to read feature "','" before PremiumAccessEngine has been initialized, error ',""])),a,b).sendLogs("isFeatureFlagEnabled")}return b==null?!1:!b.isDeactivated||!1}function f(a){return!s?!1:w(a)}function x(){if(d("WAWebBizGatingUtils").isSmbOrangeEnabled()){if(!s)throw c("err")("Premium access engine update() called before initialize()");var a=z(),b=new Set();r.forEach(function(c,d){if(!a.has(d))c.hasChanged=!0,c.subscription=null,y(d),b.add(d);else{var e,f;e=(e=a.get(d))==null?void 0:e[0];!((f=c.subscription)!=null&&f.equal(e))?(c.hasChanged=!0,c.subscription=e==null?void 0:e.clone(),y(d)):c.hasChanged&&(c.hasChanged=!1,y(d))}});a.forEach(function(a,b){r.has(b)||(r.set(b,{hasChanged:!0,subscription:a[0].clone()}),y(b))});b.forEach(function(a){return r["delete"](a)})}}function y(a){var c=q.get(a),e=r.get(a);c&&e&&c.forEach(function(c){(o||(o=b("Promise"))).resolve().then(function(){c(e.subscription,e.hasChanged)})["catch"](function(b){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: error calling handler for feature ",", error ",""])),a,b).sendLogs("PremiumAccessEngine")})})}function z(){var a=new Map();t&&Object.entries(t).forEach(function(b){var c=b[0];b=b[1];if(c!=="MD_EXTENSION"&&c!=="CUSTOM_URL")return;b=b.map(function(a){return d("WAWebSubscriptionCollection").SubscriptionCollection.get(a)}).filter(Boolean);b.length>0&&(b.length>1&&B(b),a.set(c,b))});return a}function A(a){var b=!1,c=JSON.parse(a);a=Object.keys(c);a.length>0?a.forEach(function(a){var e=c[a];Array.isArray(e)||(b=!0,d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: invalid config for key ",", value is not an array"])),a).sendLogs("PremiumAccessEngine"));e.length===0&&(b=!0,d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: invalid config for key ",", value is empty array"])),a).sendLogs("PremiumAccessEngine"))}):(d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["PremiumAccessEngine: config has no keys"]))),b=!0);return b?null:c}function B(a){a.sort(function(a,b){if(a.isDeactivated&&!b.isDeactivated)return 1;if(!a.isDeactivated&&b.isDeactivated)return-1;if(a.isDeactivated&&b.isDeactivated)return 0;if(a.isAutoRenewing&&!b.isAutoRenewing)return-1;if(b.isAutoRenewing&&!a.isAutoRenewing)return 1;return!a.isAutoRenewing&&!b.isAutoRenewing?(b.expirationDate||0)-(a.expirationDate||0):0})}g.initialize=a;g.listen=e;g.getFeatureFlagState=v;g.isFeatureFlagEnabled=w;g.isInitializedAndFeatureFlagEnabled=f;g.update=x}),98);
__d("WAWebSubscriptionModel",["WAWebBaseModel","lodash"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.isDeactivated=d("WAWebBaseModel").prop(!1),b.isAutoRenewing=d("WAWebBaseModel").prop(!1),b.expirationDate=d("WAWebBaseModel").prop(),b.creationTime=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.equal=function(a){return!a?!1:a.id===this.id&&a.isAutoRenewing===this.isAutoRenewing&&a.isDeactivated===this.isDeactivated&&a.expirationDate===this.expirationDate&&a.creationTime===this.creationTime};e.clone=function(){var a=c("lodash").clone(this);return a};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="subscription";b=d("WAWebBaseModel").defineModel(a);g.Subscription=b}),98);
__d("WAWebSubscriptionCollection",["WAWebBaseCollection","WAWebSubscriptionModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initializeFromCache=function(a){this.add(a,{merge:!0})};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebSubscriptionModel").Subscription;b=new a();g.SubscriptionCollection=b}),98);
__d("WAWebCartCollection",["WALogger","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebCartModel","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebUserPrefsCartLidMigration","WAWebUserPrefsKeys","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;a=function(a){function b(b,c){var d;d=a.call(this)||this;d.imageWidth=100;d.imageHeight=100;b!=null&&(d.imageWidth=b);c!=null&&(d.imageHeight=c);return d}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initializeFromCache=function(a){var b=this;try{a=a||[];a.forEach(function(a){var d=new(c("WAWebCartModel"))({id:a.id,itemCount:a.itemCount,total:a.total,currency:a.currency,message:a.message});b.add(d,{merge:!0});d=b.get(d.id);d==null||d.cartItemCollection.add(a.products,{merge:!0})})}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Error while restoring carts from cache, ",""])),String(a))}};e.findCart=function(a){if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&d("WAWebUserPrefsCartLidMigration").isCartLidMigrationComplete()){var b=d("WAWebLidMigrationUtils").toUserLidOrThrow(d("WAWebWidFactory").createUserWidOrThrow(a));return this.gadd(b.toString())}return this.gadd(a)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebCartModel");a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CART_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3};b=new a();g.CartCollection=b}),98);
__d("WAWebCartItemCollection",["WAWebBaseCollection","WAWebCartItemModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebCartItemModel").CartItem;g.CartItemCollection=a}),98);
__d("WAWebCartItemModel",["WAWebBaseModel","WAWebCartCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.priceAmount1000=d("WAWebBaseModel").prop(),b.currency=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.quantity=d("WAWebBaseModel").prop(),b.imageHash=d("WAWebBaseModel").prop(),b.imageCdnUrl=d("WAWebBaseModel").prop(),b.maxAvailable=d("WAWebBaseModel").prop(),b.variantProperties=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebCartCollection").CartCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="cart-item";b=d("WAWebBaseModel").defineModel(a);g.CartItem=b}),98);
__d("WAWebCartModel",["WAWebBaseModel","WAWebCartCollection","WAWebCartItemCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.products=d("WAWebBaseModel").prop(),b.itemCount=d("WAWebBaseModel").prop(),b.total=d("WAWebBaseModel").prop(),b.currency=d("WAWebBaseModel").prop(),b.message=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.countTotals=function(){var a=this.cartItemCollection.reduce(function(a,b){a.currency.add(b.currency);return{itemCount:a.itemCount+b.quantity,total:a.total+b.quantity*((b=b.priceAmount1000)!=null?b:0),currency:a.currency}},{itemCount:0,total:0,currency:new Set()}),b=a.currency.size===1;b={itemCount:a.itemCount,total:b?a.total:null,currency:b?a.currency.values().next().value:null};this.set(b,{silent:!0})};c.initialize=function(){a.prototype.initialize.call(this),this.cartItemCollection=new(d("WAWebCartItemCollection").CartItemCollection)(),this.listenTo(this,"change:cartItemCollection",this.countTotals)};c.getCollection=function(){return d("WAWebCartCollection").CartCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="cart";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebAssignedAgentsCollection",["WAWebAgentModel","WAWebBaseCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebAgentModel").Agent;g.AssignedAgentsCollection=a}),98);
__d("WAWebChatAssignmentCollection",["WALogger","WAWebAgentCollection","WAWebAssignedAgentsCollection","WAWebBaseCollection","WAWebChatAssignmentModel","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;a=function(a){function b(){var b;b=a.call(this)||this;b.$ChatAssignmentCollectionImpl$p_1=new Map();b.$ChatAssignmentCollectionImpl$p_2=new Map();b.$ChatAssignmentCollectionImpl$p_3=[];b.listenTo(b,"add",b.$ChatAssignmentCollectionImpl$p_4);b.listenTo(b,"remove",b.$ChatAssignmentCollectionImpl$p_5);b.listenTo(b,"change",b.$ChatAssignmentCollectionImpl$p_6);b.listenTo(d("WAWebAgentCollection").AgentCollection,"add",b.$ChatAssignmentCollectionImpl$p_7);return b}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.$ChatAssignmentCollectionImpl$p_4=function(a){this.$ChatAssignmentCollectionImpl$p_1.set(a.chatId,!a.chatOpenedByAgent);var b=this.getAgentCollectionForChatId(d("WAWebWidFactory").createWid(a.chatId));if(a.agent==null){var c=d("WAWebAgentCollection").AgentCollection.get(a.agentId);c!=null?a.agent=c:d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat_assignment_collection:_handleAdd failed"]))).sendLogs("chat_assignment_collection:_handleAdd: attempted to add assignment without agent")}a.agent!=null&&b.add(a.agent)};c.$ChatAssignmentCollectionImpl$p_5=function(a){var b=this.$ChatAssignmentCollectionImpl$p_2.get(a.chatId);b&&b.remove(a.agent);this.$ChatAssignmentCollectionImpl$p_1["delete"](a.chatId)};c.$ChatAssignmentCollectionImpl$p_6=function(a){this.$ChatAssignmentCollectionImpl$p_1.set(a.chatId,!a.chatOpenedByAgent),this.getAgentCollectionForChatId(d("WAWebWidFactory").createWid(a.chatId)).trigger("change",[])};c.$ChatAssignmentCollectionImpl$p_7=function(a){var b=this.$ChatAssignmentCollectionImpl$p_3.filter(function(b){return b.agentId===a.id});this.processChatAssignments(b)};c.processChatAssignments=function(a){var b=this,c=[];a.forEach(function(a){var e,f=d("WAWebAgentCollection").AgentCollection.get(a.agentId);if(((e=b.get(a.id))==null?void 0:e.agent.id)===a.agentId){(e=b.get(a.id))==null||e.set({chatOpenedByAgent:a.chatOpenedByAgent})}else f&&!f.isDeleted?c.push(new(d("WAWebChatAssignmentModel").ChatAssignment)({id:a.id,chatId:a.chatId,chatOpenedByAgent:a.chatOpenedByAgent,agent:f})):b.$ChatAssignmentCollectionImpl$p_3.push(a)});this.add(c,{merge:!0})};c.getChatUnopenedStatus=function(a){return!!this.$ChatAssignmentCollectionImpl$p_1.get(a.toString({legacy:!0}))};c.reset=function(){this.$ChatAssignmentCollectionImpl$p_2.forEach(function(a){a.reset()}),a.prototype.reset.call(this)};c.getAgentCollectionForChatId=function(a){var b=this.$ChatAssignmentCollectionImpl$p_2.get(a.toString({legacy:!0}));b||(b=new(d("WAWebAssignedAgentsCollection").AssignedAgentsCollection)(),this.$ChatAssignmentCollectionImpl$p_2.set(a.toString({legacy:!0}),b));return b};c.initializeFromCache=function(a){this.processChatAssignments(a)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebChatAssignmentModel").ChatAssignment;b=new a();g.ChatAssignmentCollection=b}),98);
__d("WAWebChatAssignmentModel",["WAWebBaseModel","WAWebChatAssignmentCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.chatId=d("WAWebBaseModel").prop(),b.agent=d("WAWebBaseModel").prop(),b.agentId=d("WAWebBaseModel").prop(),b.chatOpenedByAgent=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebChatAssignmentCollection").ChatAssignmentCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="chat_assignment";b=d("WAWebBaseModel").defineModel(a);g.ChatAssignment=b}),98);
__d("WAWebChatAssignmentUtils",["WAWebBizGatingUtils","WAWebPremiumAccessEngine","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebBizGatingUtils").chatAssignmentEnabled()&&d("WAWebPremiumAccessEngine").isInitializedAndFeatureFlagEnabled("MD_EXTENSION")}function a(a){return a==null?!1:a.every(function(a){return i(a)})}function i(a){if(d("WAWebBizGatingUtils").isBizAiChatAssignmentHidingEnabled()===!1)return h();return a==null?!1:h()&&a.capiThreadControl!==d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_TAKEN}function b(a){return a!==!0&&d("WAWebBizGatingUtils").chatAssignmentSystemMessagesEnabled()&&h()}g.canAssignChats=h;g.canAssignAllChats=a;g.canAssignChat=i;g.shouldUseChatAssignmentCTA=b}),98);
__d("WAWebBizOrderGetFriendlyRandomIdAction",[],(function(a,b,c,d,e,f){function a(){var a=typeof BigInt==="function"?BigInt:Number;return a(String(Date.now())+Math.random().toFixed(4).slice(-4)).toString(36).toUpperCase()}f["default"]=a}),66);
__d("WAWebOrderCollection",["Promise","WAWebBaseCollection","WAWebBizOrderAction","WAWebBizOrderGetFriendlyRandomIdAction","WAWebCurrencyUtils","WAWebE2EProtoUtils","WAWebL10NCountryCodes","WAWebOrderModel","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(a){function e(b,c){var d;d=a.call(this)||this;d.width=80;d.height=80;b!=null&&(d.width=b);c!=null&&(d.height=c);return d}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.addOrder=function(){var b=c("WAWebBizOrderGetFriendlyRandomIdAction")(),e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();a.prototype.add.call(this,{id:b,fetchedFromServer:!1,sellerJid:d("WAWebE2EProtoUtils").encodeJid(e),createdAt:Math.round(new Date().getTime()/1e3),currency:d("WAWebCurrencyUtils").currencyForCountryShortcode(d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(e.user)),products:[],tax:null,subtotal:null,total:null});return this.assertGet(b)};f.findOrder=function(a,c,d){var e=this.get(a);return e!=null?(h||(h=b("Promise"))).resolve(e):this.$OrderCollectionImpl$p_1(a,c,d)};f.$OrderCollectionImpl$p_1=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c,e,f){f=(yield d("WAWebBizOrderAction").queryOrder(d("WAWebWidFactory").createWid(e),c,this.width,this.height,f));a.prototype.add.call(this,babelHelpers["extends"]({id:c,fetchedFromServer:!0,sellerJid:e},f));e=this.get(c);if(e!=null)return(h||(h=b("Promise"))).resolve(e)});function e(a,b,d){return c.apply(this,arguments)}return e}();return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebOrderModel");a.staleCollection=!0;e=new a();g.OrderCollection=e}),98);
__d("WAWebOrderItemCollection",["WAWebBaseCollection","WAWebOrderItemModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebOrderItemModel");g.OrderItemCollection=a}),98);
__d("WAWebOrderItemModel",["WAWebBaseModel","WAWebOrderCollection","WAWebOrderItemGetters"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.price=d("WAWebBaseModel").prop(),b.currency=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.quantity=d("WAWebBaseModel").prop(),b.thumbnailId=d("WAWebBaseModel").prop(),b.thumbnailUrl=d("WAWebBaseModel").prop(),b.isCustomItem=d("WAWebBaseModel").prop(),b.isQuantitySet=d("WAWebBaseModel").prop(),b.properties=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebOrderCollection").OrderCollection};c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebOrderItemGetters").clearOrderItemGetterCacheFor(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="order-item";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebOrderGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createOrderCache});b=a.field;c=a.computed;e=a.clearCacheFor;f=e;d=b("products");a=c(function(a){a=a[0];return a.reduce(function(a,b){return a+b.quantity},0)},[d]);g.clearOrderGetterCacheFor=f;g.getTotalItemCount=a}),98);
__d("WAWebOrderModel",["WAWebBaseModel","WAWebOrderCollection","WAWebOrderGetters","WAWebOrderItemCollection","WAWebOrderItemModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.products=d("WAWebBaseModel").prop(),b.itemCount=d("WAWebBaseModel").prop(),b.subtotal=d("WAWebBaseModel").prop(),b.tax=d("WAWebBaseModel").prop(),b.total=d("WAWebBaseModel").prop(),b.currency=d("WAWebBaseModel").prop(),b.createdAt=d("WAWebBaseModel").prop(),b.sellerJid=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){a.prototype.initialize.call(this),this.orderItemCollection=new(d("WAWebOrderItemCollection").OrderItemCollection)(),this.listenTo(this,"change:cartItemCollection",this.triggerItemCollectionUpdate),this.triggerItemCollectionUpdate()};e.triggerItemCollectionUpdate=function(){this.orderItemCollection.set(this.products.map(function(a){return new(c("WAWebOrderItemModel"))(babelHelpers["extends"]({},a))}),{merge:!0})};e.getCollection=function(){return d("WAWebOrderCollection").OrderCollection};e["delete"]=function(){a.prototype["delete"].call(this),d("WAWebOrderGetters").clearOrderGetterCacheFor(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="order";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebProductCatalogLogQplEvents",["WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule"],(function(a,b,c,d,e,f,g){function a(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_MESSAGE_SEND,a)}function b(a){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CATALOG_VIEW,a)}g.qplPointProductMessageSend=a;g.qplPointCatalogView=b}),98);
__d("WAWebCatalogCollection",["Promise","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebBizGatingUtils","WAWebBizProductCatalogAction","WAWebBizProductCatalogBridge","WAWebCatalogModel","WAWebCatalogVariantHelper","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebProductCatalogLogQplEvents","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.selfCatalogErrorEmailMask=null,b.findQueryImpl=function(a,c){return b._findImplCommon(a,c).then(function(a){return[a]})},b.findImpl=function(a){a=b.convertCatalogIdForLidMigration(a);return b._findImplCommon(a)},babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.addMsgAsProduct=function(b){var c=d("WAWebMsgGetters").getBusinessOwnerJid(b.unsafe());c=c!=null?d("WAWebWidFactory").createWid(c):null;if(c==null)return;var e=this.get(c),f=b.productId!=null?e==null?void 0:e.msgProductCollection.get(b.productId):null;e=b.productId!=null?e==null?void 0:e.productCollection.get(b.productId):null;if(e!=null&&e.t&&e.t>=b.t)return;if(f!=null&&f.fetchedFromServer)return;f=d("WAWebBizProductCatalogBridge").mapMsgToProductModel(b);return a.prototype.add.call(this,{id:c,afterCursor:void 0,_msgs:[f],stale:!0,fetchedFromServer:!!e},{merge:!0})};f._queryProduct=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e.catalogWid,g=e.productId,h=e.productMsgMediaData,i=e.width,j=e.height,k=e.shouldFetchComplianceFields;e=e.canLogQpl;i=(yield d("WAWebBizProductCatalogAction").queryProduct(f,g,i,j,k,e));if(i.error==="NOT_FOUND"){j=this.get(f);j==null||j.productCollection.remove(g);return(l||(l=b("Promise"))).reject(new(d("WAWebBackendErrors").E404)("CatalogCollection:findProduct:_queryProduct NOT_FOUND"))}if(!i.data)return a.prototype.add.call(this,{id:f,afterCursor:void 0});k=i.data;if(!k.image_cdn_urls)return(l||(l=b("Promise"))).reject(c("err")("CatalogCollection:findProduct:_queryProduct: could not find image_cdn_urls for product"));e=d("WAWebBizProductCatalogBridge").mapProductResponseToModel(k,f);e.productMsgMediaData=h;if(e.variantInfo!=null){((j=this.get(f))==null?void 0:j.productCollection.get(k.id))==null&&(e.displayPriority=1)}g=[e];return a.prototype.add.call(this,{id:f,afterCursor:void 0,_products:g,_msgs:g},{merge:!0})});function f(a){return e.apply(this,arguments)}return f}();f.findProduct=function(a){var d=a.catalogWid,e=a.productId,f=a.productMsgMediaData,g=a.shouldFetchComplianceFields;a=a.canLogQpl;d=this.convertCatalogIdForLidMigration(d);return c("isStringNullOrEmpty")(e)?(l||(l=b("Promise"))).reject(c("err")("CatalogCollection:findProduct Received productId type "+(e===void 0?"undefined":"null"))):this._queryProduct({catalogWid:d,productId:e,productMsgMediaData:f,shouldFetchComplianceFields:g,canLogQpl:a})};f._queryCatalog=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k,m){a=a?a.index:0;m&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(m,"datasource_catalog_start");var n,o,p;try{d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(n=d("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,o=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,p=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE);f=(yield d("WAWebBizProductCatalogAction").queryCatalog(e,f,10,void 0,void 0,g,k,n,o,p));m&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(m,"datasource_catalog_end");this.hasSelfCatalogErrorEmailMask()&&this.shouldUseCatalogErrorEmailMask(e)&&this.resetSelfCatalogErrorEmailMask();if(!f.data.length)return{id:e,afterCursor:""};var q=[];f.data.forEach(function(a){if(!a.image_cdn_urls)return;q.push(d("WAWebBizProductCatalogBridge").mapProductResponseToModel(a,e))});g={type:"success",catalog:f};this.trigger("catalog-loaded",g);k=this.get(e);k&&k.catalogId!=null&&f.catalog_id!=null&&k.catalogId!==f.catalog_id&&d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Catalog] Catalog model is being reset due to CatalogId changed"]))),this.remove(e));return{id:e,afterCursor:f.paging.cursors.after,_products:q,catalogId:f.catalog_id,catalogType:f.catalog_type,catalogName:f.catalog_name,fetchedFromServer:!0,index:a+q.length}}catch(a){if(a instanceof d("WAWebBackendErrors").AdAccountRecoveryRequiredError&&this.shouldUseCatalogErrorEmailMask(e)){if(c("isStringNullOrEmpty")(a.emailMask)){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Catalog:AdAccountRecoveryRequiredError received empty email mask"]))).sendLogs("catalog email mask empty");return(l||(l=b("Promise"))).reject(new(d("WAWebBackendErrors").AdAccountRecoveryRequiredEmailMaskEmptyError)())}this.updateSelfCatalogErrorEmailMask(a.emailMask)}else if(a instanceof d("WAWebBackendErrors").CatalogIncorrectNonceError&&this.shouldUseCatalogErrorEmailMask(e)){m={type:"incorrect-nonce"};this.trigger("catalog-loaded",m);return(l||(l=b("Promise"))).reject(a)}else{this.hasSelfCatalogErrorEmailMask()&&this.shouldUseCatalogErrorEmailMask(e)&&this.resetSelfCatalogErrorEmailMask();if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===404){g=this.get(e);g!=null&&d("WAWebBizGatingUtils").isCatalogVariantsViewingEnabled()&&(d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[Catalog] Catalog model is being reset due to CatalogId not found anymore."]))),this.remove(e))}}k={type:"error"};this.trigger("catalog-loaded",k);return(l||(l=b("Promise"))).reject(a)}});function e(b,c,d,e,f,g){return a.apply(this,arguments)}return e}();f._findImplCommon=function(a,b){var e=this.get(a),f=e&&!e.stale?e.afterCursor:void 0;a=a instanceof c("WAWebWid")?a:d("WAWebWidFactory").createWid(a.toString());return this._queryCatalog(e,a,f,void 0,void 0,b==null?void 0:b.markerId)};f.findCarouselCatalog=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=this.convertCatalogIdForLidMigration(b);var c=this.get(b);c&&c.set({index:0});b=(yield this._queryCatalog(c,b,void 0,void 0,!1));c&&c.markProductCollectionOld();return a.prototype.add.call(this,b,{merge:!0})});function d(a){return c.apply(this,arguments)}return d}();f.findNextProductPage=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=this.convertCatalogIdForLidMigration(a);b===!0&&d("WAWebProductCatalogLogQplEvents").qplPointCatalogView("datasource_start");a=(yield this.update(a));b===!0&&d("WAWebProductCatalogLogQplEvents").qplPointCatalogView("datasource_end");b=Array.isArray(a)?a[0]:a;return b.productCollection.getProductModels()});function c(b,c){return a.apply(this,arguments)}return c}();f.findCollectionMembership=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,c){b=this.convertCatalogIdForLidMigration(b);var d=this.get(b),e=d&&!d.stale?d.afterCursor:void 0;e=(yield this._queryCatalog(d,b,e,c));a.prototype.add.call(this,e,{merge:!0});d=this.get(b);d&&(d.stale=!1)});function d(a,b){return c.apply(this,arguments)}return d}();f.removeCatalog=function(a){a=this.convertCatalogIdForLidMigration(a);var b=this.get(a);!b?d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Catalog data cleanup called on a non-existent catalogId"]))):this.remove(a)};f.get=function(b){return a.prototype.get.call(this,this.convertCatalogIdForLidMigration(b))};f.assertGet=function(b){return a.prototype.assertGet.call(this,this.convertCatalogIdForLidMigration(b))};f.convertCatalogIdForLidMigration=function(a){a=a instanceof c("WAWebWid")?a:d("WAWebWidFactory").createWid(a.toString());if(!d("WAWebBizGatingUtils").isLidMigrationForCatalogEnabled())return a;if(a.isLid()){var b=d("WAWebLidMigrationUtils").toPn(a);if(b!=null)return b}return a};f.getSelfCatalogErrorEmailMask=function(){return this.selfCatalogErrorEmailMask};f.updateSelfCatalogErrorEmailMask=function(a){this.selfCatalogErrorEmailMask=a,this.trigger("change:selfCatalogErrorEmailMask")};f.resetSelfCatalogErrorEmailMask=function(){this.updateSelfCatalogErrorEmailMask(null)};f.hasSelfCatalogErrorEmailMask=function(){return this.selfCatalogErrorEmailMask!=null};f.shouldUseCatalogErrorEmailMask=function(a){if(a==null)return!1;if(!d("WAWebUserPrefsMeUser").isMeAccount(a))return!1;return!d("WAWebBizGatingUtils").catalogTokenRecoveryEnabled()?!1:!0};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebCatalogModel");a.staleCollection=!0;e=new a();g.CatalogCollection=e}),98);
__d("WAWebCatalogModel",["WANullthrows","WAWebBaseModel","WAWebBizProductCatalogAction","WAWebBizProductCatalogBridge","WAWebCatalogCollection","WAWebProductCollCollection","WAWebProductCollection","WAWebProductModel","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.catalogId=d("WAWebBaseModel").prop(),b.catalogType=d("WAWebBaseModel").prop(),b.catalogName=d("WAWebBaseModel").prop(),b.afterCursor=d("WAWebBaseModel").prop(),b.index=d("WAWebBaseModel").prop(),b.hasCatalogCategories=d("WAWebBaseModel").prop(),b.fetchedFromServer=d("WAWebBaseModel").session(),b._products=d("WAWebBaseModel").session(),b._msgs=d("WAWebBaseModel").session(),b.lastUsedCountryCode=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){a.prototype.initialize.call(this),this.productCollection=new(d("WAWebProductCollection").ProductCollection)(),this.msgProductCollection=new(d("WAWebProductCollection").ProductCollection)(),this.collections=new(d("WAWebProductCollCollection").ProductCollCollection)(),this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()};f.triggerProductUpdate=function(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0};f.triggerMsgUpdate=function(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0};f.markProductCollectionOld=function(){this.productCollection.forEach(function(a){return a.markOld()})};f.addProduct=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=this.id;this.maybeUpdateLastUsedCountryCode((b=a.complianceInfo)==null?void 0:b.countryCodeOrigin);b=(yield d("WAWebBizProductCatalogAction").addProduct(a));b.catalogWid=e;a=this.productCollection.add(b,{merge:!0,at:0})[0];return c("WANullthrows")(a)});function e(b){return a.apply(this,arguments)}return e}();f.editProduct=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=(yield d("WAWebBizProductCatalogAction").editProduct(a));this.maybeUpdateLastUsedCountryCode((b=a.complianceInfo)==null?void 0:b.countryCodeOrigin);b=this.productCollection.add(e,{merge:!0})[0];this.collections&&this.collections.forEach(function(b){b.productCollection.get(a.id)&&b.productCollection.add(e,{merge:!0})});return c("WANullthrows")(b)});function e(b){return a.apply(this,arguments)}return e}();f.refreshProduct=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this.productCollection.get(a);b&&(b.stale=!0);var c=(yield d("WAWebBizProductCatalogAction").queryProduct(this.id,a));if(c.data!=null){var e=d("WAWebBizProductCatalogBridge").mapProductResponseToModel(c.data,this.id);b&&this.productCollection.add(e,{merge:!0});this.collections&&this.collections.forEach(function(b){b.productCollection.get(a)&&b.productCollection.add(e,{merge:!0})})}});function c(b){return a.apply(this,arguments)}return c}();f.maybeUpdateLastUsedCountryCode=function(a){if(a==null)return;this.lastUsedCountryCode=a};f.pullProduct=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebBizProductCatalogAction").queryProduct(this.id,a,void 0,void 0,void 0,b));b.error==="NOT_FOUND"&&this.productCollection.remove(a);if(b.data!=null){a=new(d("WAWebProductModel").Product)(d("WAWebBizProductCatalogBridge").mapProductResponseToModel(b.data,this.id));a.variantInfo!=null&&(this.productCollection.get(a.id)==null&&(a.displayPriority=1));this.updateProduct(a)}});function c(b,c){return a.apply(this,arguments)}return c}();f.updateProduct=function(a){this.productCollection.add(a,{merge:!1});if(a.variantInfo!=null){var b=this.productCollection.get(a.id);b&&b.set("variantInfo",a.variantInfo)}};f.getCollection=function(){return d("WAWebCatalogCollection").CatalogCollection};f.getMostRecentlyApprovedProduct=function(){return this.productCollection.findFirst(function(a){return!a.isHidden&&a.isSanctioned!==!0&&a.reviewStatus==="APPROVED"})};return e}(d("WAWebBaseModel").BaseModel);a.Proxy="catalog";a.idClass=c("WAWebWid");e=d("WAWebBaseModel").defineModel(a);g["default"]=e}),98);
__d("WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9687699931342731"}),null);
__d("WAWebBizCatalogManagementFetchCollectionsQuery.graphql",["WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{kind:"Variable",name:"request",variableName:"request"}],d={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"catalog_type",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},o=[g,n];k=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},h,f,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[f,i,j],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},g,k,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},k,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},l,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[m,l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[h,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[g,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[n,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[f,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},i,j],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:o,storageKey:null}],storageKey:null}];h={alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[m,{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},l],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchCollectionsQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetCollectionsResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collections",plural:!1,selections:[d,e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collections",plural:!0,selections:[f,g,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:k,args:null,argumentDefinitions:[]}],storageKey:null},h],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementFetchCollectionsQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetCollectionsResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collections",plural:!1,selections:[d,e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collections",plural:!0,selections:[f,g,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:k,storageKey:null},h],storageKey:null}],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementFetchCollectionsQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchCollectionsQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementFetchCollections",["Promise","WALogger","WAWebBizCatalogManagementFetchCollectionsQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebProductTypes.flow","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementFetchCollectionsQuery.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForGetCollectionsEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchCollections: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['fetchCollections: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").fetchQuery(n,{request:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){var b,c;if(a==null)return m;b=(b=a.xfb_whatsapp_catalog_collections)==null?void 0:b.collections;if(b==null)return m;c=(c=a.xfb_whatsapp_catalog_collections)==null?void 0:c.paging;c=(c=c==null?void 0:c.after)!=null?c:"";b=b.map(function(a){var b=a.id,c=a.name,f=a.status_info,g=f==null?void 0:f.status;g=(g=g!=null?d("WAWebProductTypes.flow").asProductReviewType(g):void 0)!=null?g:"APPROVED";a=a.products.map(function(a){return e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a)}).map(d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);return{id:b!=null?b:"",name:c!=null?c:"",rejectReason:f==null?void 0:f.reject_reason,commerceUrl:f==null?void 0:f.commerce_url,canAppeal:(f==null?void 0:f.can_appeal)==="true",reviewStatus:g,totalItemsCount:0,products:a,isHidden:!1}});return{type:"success",collectionsResult:{collections:b,afterCursor:c,catalog_type:(b=a.xfb_whatsapp_catalog_collections)==null?void 0:b.catalog_type}}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fetchCollectionsWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.fetchCollections=a}),98);
__d("WAWebQueryProductCollectionsQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},k=[c,j];e=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetCollectionsResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_collections",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductCollection",kind:"LinkedField",name:"collections",plural:!0,selections:[b,c,{alias:null,args:null,concreteType:"XWAProductCatalogCollectionStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[d,e,{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},c,f,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},g,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[e,d],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[b,h,i],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:k,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[j,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},h,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:k,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryProductCollectionsQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryProductCollectionsQuery",selections:e},params:{id:"9430970660362540",metadata:{},name:"WAWebQueryProductCollectionsQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebQueryProductCollections",["errorCode","WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchCollections","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebProductTypes.flow","WAWebQueryProductCollectionsQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k,l=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();try{var c=a.catalogWid,e=a.afterCursor,f=a.limit,g=a.productsCount,h=a.width,k=a.height,l=a.directConnectionEncryptedInfo,m=a.variantInfoFields,n=a.variantThumbnailHeight;a=a.variantThumbnailWidth;c=(yield d("WAWebRelayClient").fetchQuery(i!==void 0?i:i=b("WAWebQueryProductCollectionsQuery.graphql"),{request:{collections:{biz_jid:c.toString(),collection_limit:String(f),item_limit:String(g),after:e,width:String(h),height:String(k),direct_connection_encrypted_info:l,variant_info_fields:m,variant_thumbnail_height:n!=null?String(n):null,variant_thumbnail_width:a!=null?String(a):null}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_COLLECTIONS)}));if((c==null?void 0:c.xwa_product_catalog_get_collections)==null)return{afterCursor:"",collections:[],catalog_type:null};f=c.xwa_product_catalog_get_collections;g=f.collections;e=f.paging;return{afterCursor:(e==null?void 0:e.after)||"",collections:g.map(function(a){var b=a.id,c=a.name,e=a.status_info;a=a.products;var f=e==null?void 0:e.status;f=(f=f!=null?d("WAWebProductTypes.flow").asProductReviewType(f):void 0)!=null?f:"APPROVED";return{id:b||"",name:c||"",canAppeal:(e==null?void 0:e.can_appeal)==="true",isHidden:!1,reviewStatus:f,totalItemsCount:0,products:a.map(d("WAWebBizParseProductGraphql").parseProductGraphQL),rejectReason:e==null?void 0:e.reject_reason,commerceUrl:e==null?void 0:e.commerce_url}}),catalog_type:null}}catch(a){if(a instanceof d("WAWebGraphQLServerError").GraphQLServerError){k=((h=a.source)==null?void 0:h.errors)||[];l=k[0];if((l==null?void 0:l.code)===2498052)return{collections:[],afterCursor:"",catalog_type:null};d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a)}d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_collections query."])));throw new(d("WAWebBackendErrors").CatalogUnknownError)()}});return function(b){return a.apply(this,arguments)}}(),m=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();var b=a.catalogWid,c=a.afterCursor,e=a.limit,f=a.productsCount,g=a.width,h=a.height,i=a.directConnectionEncryptedInfo,j=a.variantInfoFields,l=a.variantThumbnailHeight;a=a.variantThumbnailWidth;b=(yield d("WAWebBizCatalogManagementFetchCollections").fetchCollections({collections:{biz_jid:b.toJid(),after:c,collection_limit:String(e),item_limit:String(f),width:String(g),height:String(h),direct_connection_encrypted_info:i,variant_info_fields:j,variant_thumbnail_height:l!=null?String(l):null,variant_thumbnail_width:a!=null?String(a):null}}));if(b.type==="success")return b.collectionsResult;else if(b.type==="graphql-error"){if(((c=b.error.source.errors[0])==null?void 0:c.code)===2498052)return{collections:[],afterCursor:"",catalog_type:null};d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(b.error)}else b.type;d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["queryCollectionsGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(b));throw new(d("WAWebBackendErrors").CatalogUnknownError)()});return function(b){return a.apply(this,arguments)}}();a=function(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();return b!=null&&b.equals(a.catalogWid)?m(a):l(a)};c=a;g["default"]=c}),98);
__d("WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9547298772047931"}),null);
__d("WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql",["WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{kind:"Variable",name:"request",variableName:"request"}],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},h={alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},g],storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},n=[e,m];l=[{alias:null,args:null,kind:"ScalarField",name:"availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},i,d,{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[d,j,k],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},e,l,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null}],storageKey:null},g,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[f,g],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[e,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[m,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[d,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},j,k],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBWhatsAppCatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:n,storageKey:null}],storageKey:null}];f={alias:null,args:null,concreteType:"XFBWhatsAppCatalogPagingInfo",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetCollectionResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collection",plural:!1,selections:[d,e,h,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:[{kind:"InlineDataFragmentSpread",name:"WAWebBizCatalogManagementParseProductGraphql_product",selections:l,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null},f],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",selections:[{alias:null,args:c,concreteType:"XFBWhatsAppCatalogGetCollectionResponse",kind:"LinkedField",name:"xfb_whatsapp_catalog_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBWhatsAppCatalogCollectionInfo",kind:"LinkedField",name:"collection",plural:!1,selections:[d,e,h,{alias:null,args:null,concreteType:"XFBWhatsAppCatalogProductInfo",kind:"LinkedField",name:"products",plural:!0,selections:l,storageKey:null}],storageKey:null},f],storageKey:null}]},params:{id:b("WAWebBizCatalogManagementFetchSingleCollectionQuery_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementFetchSingleCollectionQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebBizCatalogManagementFetchSingleCollection",["Promise","WALogger","WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql","WAWebBizCatalogManagementParseProductGraphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebProductTypes.flow","WAWebRelayClient"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m={type:"error"},n=h!==void 0?h:h=b("WAWebBizCatalogManagementFetchSingleCollectionQuery.graphql");function a(a){return!d("WAWebBizGatingUtils").graphQLForGetSingleCollectionEnabled()?(l||(l=b("Promise"))).resolve({type:"not-enabled"}):o(a).then(function(a){if(a.type==="success"){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchSingleCollection: success"])));return a}a.type;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(['fetchSingleCollection: failed as "','"'])),a.type);return a})}function o(a){return d("WAWebFetchAdAccountToken").fetchToken().then(function(b){if(b.type==="success")return p(b.token,a).then(function(a){a.type!=="success"?a.type==="auth-failure"?d("WAWebFetchAdAccountToken").markTokenAsInvalid():a.type:a.type;return a});b.type;return b})}function p(a,b){var e;return c("WAWebNetworkStatus").waitIfOffline().then(function(){return d("WAWebRelayClient").fetchQuery(n,{request:b},{environmentType:"facebook",accessToken:a,getInlineDataReader:function(a){e=a}})}).then(function(a){var b;if(a==null)return m;b=(b=a.xfb_whatsapp_catalog_collection)==null?void 0:b.collection;if(b==null)return m;a=(a=a.xfb_whatsapp_catalog_collection)==null?void 0:a.paging;a=(a=a==null?void 0:a.after)!=null?a:"";var c=b.id,f=b.name,g=b.status_info;b=b.products;var h=g==null?void 0:g.status;h=(h=h!=null?d("WAWebProductTypes.flow").asProductReviewType(h):void 0)!=null?h:"APPROVED";b=b.map(function(a){return e(d("WAWebBizCatalogManagementParseProductGraphql").PARSE_PRODUCT_FRAGMENT,a)}).map(d("WAWebBizCatalogManagementParseProductGraphql").parseProductGraphQL);c={id:c!=null?c:"",name:f!=null?f:"",rejectReason:g==null?void 0:g.reject_reason,commerceUrl:g==null?void 0:g.commerce_url,canAppeal:(g==null?void 0:g.can_appeal)==="true",reviewStatus:h,totalItemsCount:0,products:b,isHidden:!1};return{type:"success",collectionsResult:{collections:[c],afterCursor:a,catalog_type:null}}})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fetchSingleCollectionWithToken: failed with error"]))).devConsole(a);if(d("WAWebFetchAdAccountToken").hasGraphQLAuthError(a))return{type:"auth-failure"};return a instanceof d("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:a}:m})}g.fetchSingleCollection=a}),98);
__d("WAWebQueryProductSingleCollectionQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"can_appeal",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"original_image_url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"request_image_url",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},k=[c,j];e=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"request"}],concreteType:"XWAProductCatalogGetSingleCollectionResponseSuccess",kind:"LinkedField",name:"xwa_product_catalog_get_single_collection",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogProductCollection",kind:"LinkedField",name:"collection",plural:!1,selections:[b,c,{alias:null,args:null,concreteType:"XWAProductCatalogCollectionStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[d,e,{alias:null,args:null,kind:"ScalarField",name:"reject_reason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commerce_url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProduct",kind:"LinkedField",name:"products",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"retailer_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_sanctioned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_availability",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_available",storageKey:null},c,f,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shimmed_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"currency",storageKey:null},g,{alias:null,args:null,concreteType:"XWAProductCatalogProductStatusInfo",kind:"LinkedField",name:"status_info",plural:!1,selections:[e,d],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductSalePrice",kind:"LinkedField",name:"sale_price",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"start_date",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end_date",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMedia",kind:"LinkedField",name:"media",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"images",plural:!0,selections:[b,h,i],storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaVideo",kind:"LinkedField",name:"videos",plural:!0,selections:[b,{alias:null,args:null,kind:"ScalarField",name:"original_video_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail_url",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"belongs_to",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"compliance_category",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfo",kind:"LinkedField",name:"compliance_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"importer_name",storageKey:null},{alias:null,args:null,concreteType:"XWAProductCatalogProductComplianceInfoImporterAddress",kind:"LinkedField",name:"importer_address",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"street1",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"street2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"postal_code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"city",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogProductVariantInfo",kind:"LinkedField",name:"variant_info",plural:!1,selections:[{alias:null,args:null,concreteType:"XWACatalogVariantListingDetails",kind:"LinkedField",name:"listing_details",plural:!1,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"multi_price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowest_price",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantAvailability",kind:"LinkedField",name:"availability",plural:!1,selections:[{alias:null,args:null,concreteType:"XWAVariantAvailabilityListing",kind:"LinkedField",name:"listing",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_available",storageKey:null},{alias:null,args:null,concreteType:"XWAVariantAvailabilityListingOption",kind:"LinkedField",name:"options",plural:!0,selections:k,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"product_id",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantTypes",kind:"LinkedField",name:"types",plural:!0,selections:[c,{alias:null,args:null,concreteType:"XWACatalogVariantTypeOption",kind:"LinkedField",name:"options",plural:!0,selections:[j,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImage",kind:"LinkedField",name:"thumbnail_media",plural:!1,selections:[b,{alias:null,args:null,concreteType:"XWAProductCatalogProductMediaImageOriginalDimensions",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},h,i],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogVariantProperties",kind:"LinkedField",name:"variant_properties",plural:!0,selections:k,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XWACatalogPaging",kind:"LinkedField",name:"paging",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"after",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebQueryProductSingleCollectionQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebQueryProductSingleCollectionQuery",selections:e},params:{id:"9546992575408789",metadata:{},name:"WAWebQueryProductSingleCollectionQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebQueryProductSingleCollection",["WALogger","WAWebBackendErrors","WAWebBizCatalogManagementFetchSingleCollection","WAWebBizGatingUtils","WAWebBizParseProductGraphql","WAWebCatalogEventLogger","WAWebGraphQLServerError","WAWebMaybeThrowCatalogErrors","WAWebProductTypes.flow","WAWebQueryProductSingleCollectionQuery.graphql","WAWebRelayClient","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();try{var c=a.catalogWid,e=a.collectionId,f=a.afterCursor,g=a.limit,j=a.width,k=a.height;a=a.directConnectionEncryptedInfo;c=(yield d("WAWebRelayClient").fetchQuery(h!==void 0?h:h=b("WAWebQueryProductSingleCollectionQuery.graphql"),{request:{collection:{biz_jid:c.toString(),id:e,limit:String(g),after:f,width:String(j),height:String(k),direct_connection_encrypted_info:a}}},{eventLogger:d("WAWebCatalogEventLogger").createCatalogEventLogger(d("WAWebCatalogEventLogger").GRAPHQL_CATALOG_ENDPOINT.GET_SINGLE_COLLECTION)}));e=(c==null?void 0:c.xwa_product_catalog_get_single_collection)||{};g=e.collection;f=e.paging;j=g||{};k=j.id;a=j.name;c=j.status_info;e=j.products;g=c==null?void 0:c.status;g=(j=g!=null?d("WAWebProductTypes.flow").asProductReviewType(g):void 0)!=null?j:"APPROVED";return{afterCursor:(f==null?void 0:f.after)||"",catalog_type:null,collections:[{id:k||"",name:a||"",canAppeal:(c==null?void 0:c.can_appeal)==="true",isHidden:!1,reviewStatus:g,totalItemsCount:0,products:e!=null?e.map(d("WAWebBizParseProductGraphql").parseProductGraphQL):[],rejectReason:c==null?void 0:c.reject_reason,commerceUrl:c==null?void 0:c.commerce_url}]}}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(a);d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["GraphQL: Failed fetching xwa_product_catalog_get_single_collection query."])));throw new(d("WAWebBackendErrors").CatalogUnknownError)()}});return function(b){return a.apply(this,arguments)}}(),l=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();var b=a.catalogWid,c=a.collectionId,e=a.afterCursor,f=a.limit,g=a.width,h=a.height;a=a.directConnectionEncryptedInfo;b=(yield d("WAWebBizCatalogManagementFetchSingleCollection").fetchSingleCollection({collection:{biz_jid:b.toJid(),id:c,limit:String(f),after:e,width:String(g),height:String(h),direct_connection_encrypted_info:a}}));if(b.type==="success")return b.collectionsResult;else b.type==="graphql-error"?d("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(b.error):b.type;d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["queryProductSingleCollectionGraphQLByOwner: error handling flow not implemented for ",""])),JSON.stringify(b));throw new(d("WAWebBackendErrors").CatalogUnknownError)()});return function(b){return a.apply(this,arguments)}}();a=function(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();return b!=null&&b.equals(a.catalogWid)?l(a):k(a)};c=a;g["default"]=c}),98);
__d("WAWebProductCollCollection",["WALogger","WAWebBaseCollection","WAWebBizProductCatalogBridge","WAWebBusinessDirectConnectionBridge","WAWebBusinessProfileCollection","WAWebCatalogVariantHelper","WAWebProductCollModel","WAWebQplQuickPerformanceLoggerModule","WAWebQueryProductCollections","WAWebQueryProductSingleCollection","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=100,k=10,l=function(a){a={id:a.id,name:a.name,reviewStatus:a.reviewStatus,totalItemsCount:a.totalItemsCount,canAppeal:a.canAppeal,commerceUrl:a.commerceUrl,rejectReason:a.rejectReason};return a};a=function(a){function e(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.afterCursor="",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.findCollectionsList=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){var g=this;f&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(f,"datasource_collections_start");try{var i,m,n;e=(yield d("WAWebBusinessProfileCollection").BusinessProfileCollection.find(a));d("WAWebCatalogVariantHelper").shouldRequestVariantInfo(e)&&(i=d("WAWebCatalogVariantHelper").FULL_VARIANT_INFO_FIELDS,m=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE,n=d("WAWebCatalogVariantHelper").VARIANT_THUMBNAIL_IMAGE_SIZE);e=(yield d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(d){return c("WAWebQueryProductCollections")({catalogWid:a,afterCursor:g.afterCursor,limit:k,productsCount:b,width:j,height:j,directConnectionEncryptedInfo:d,variantInfoFields:i,variantThumbnailHeight:m,variantThumbnailWidth:n})}));f&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(f,"datasource_collections_end");this.afterCursor=e.afterCursor;this.add(e.collections.map(l),{merge:!0});e.collections.forEach(function(b){var c=g.get(b.id);c&&c.addProducts(b.products.map(function(b){return d("WAWebBizProductCatalogBridge").mapProductResponseToModel(b,a)}))});this.trigger("change")}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed findCollectionsList, error: ",""])),a).verbose().devConsole(a).sendLogs("Find collections list failed");throw a}});function e(b,c,d,e){return a.apply(this,arguments)}return e}();f.getCollectionModels=function(a){var b=this.toArray();return a?b:b.filter(function(a){return!a.isHidden&&a.reviewStatus==="APPROVED"})};f.findCollectionProducts=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){e=this.get(b);var g=e?e.afterCursor:void 0;f&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(f,"datasource_start");try{var h=(yield d("WAWebBusinessDirectConnectionBridge").attemptWithDirectConnectionRetry(a,function(d){return c("WAWebQueryProductSingleCollection")({catalogWid:a,collectionId:b,afterCursor:g,limit:k,width:j,height:j,directConnectionEncryptedInfo:d})}));f&&d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(f,"datasource_end");h.collections.length===1&&(this.add(h.collections.map(l),{merge:!0}),e=this.get(b),e&&(e.addProducts(h.collections[0].products.map(function(b){return d("WAWebBizProductCatalogBridge").mapProductResponseToModel(b,a)})),e.afterCursor=h.afterCursor))}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed findCollectionProducts, error: ",""])),a).verbose().devConsole(a).sendLogs("Find collection products failed");throw a}});function e(b,c,d,e){return a.apply(this,arguments)}return e}();return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebProductCollModel");a.staleCollection=!0;g.ProductCollCollection=a}),98);
__d("WAWebProductCollModel",["WAWebBaseModel","WAWebProductCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.isHidden=d("WAWebBaseModel").prop(),b.reviewStatus=d("WAWebBaseModel").prop(),b.commerceUrl=d("WAWebBaseModel").prop(),b.rejectReason=d("WAWebBaseModel").prop(),b.totalItemsCount=d("WAWebBaseModel").prop(),b.afterCursor=d("WAWebBaseModel").prop(),b.canAppeal=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.productCollection=new(d("WAWebProductCollection").ProductCollection)(),this.afterCursor=void 0};c.addProducts=function(a){this.productCollection.add(a,{merge:!0})};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="productColl";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebProductCollection",["Promise","WAWebBaseCollection","WAWebBizGatingUtils","WAWebProductModel","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h;e={NO_REVIEW:"NO_REVIEW",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"};function a(a,b){return a.displayPriority-b.displayPriority}var i=new Set([e.OUTDATED,e.NO_REVIEW,e.APPROVED,e.REJECTED,e.PENDING]),j=new Set([e.APPROVED]);function k(a){var b=new Set();return a.filter(function(a){if(a.variantInfo!=null){var d;d=(d=a.variantInfo)==null||(d=d.availability)==null?void 0:d.listing.some(function(a){return a&&!c("isStringNullOrEmpty")(a.product_id)&&b.has(a.product_id)});if(d===!0)return!1}b.add(a.id.toString());return!0})}f=function(a){function c(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.getProductModels=function(b){b===void 0&&(b=!1);var c=a.prototype.toArray.call(this);if(a.prototype.length<1)return c;var e=a.prototype.head.call(this);e=e==null?void 0:e.catalogWid;if(!e)return c;var f=b?i:j;e=a.prototype.filter.call(this,function(a){return f.has(a.reviewStatus)&&!a.old});c=k(e);return!b?c.filter(function(a){return!a.isHidden&&(!d("WAWebBizGatingUtils").isCountryOfOriginEnabled()||!a.isSanctioned)}):c};e.add=function(b,c){c=c?a.prototype.add.call(this,b,c):a.prototype.add.call(this,b);this.sort();return c};e.evictImagesFromCache=function(a){a=this.get(a);a&&a.evictImagesFromCache()};e.findImpl=function(a){var c=this.get(a);return c?(h||(h=b("Promise"))).resolve(c):(h||(h=b("Promise"))).resolve({id:a})};return c}(d("WAWebBaseCollection").BaseCollection);f.model=d("WAWebProductModel").Product;f.comparator=a;g.PRODUCT_REVIEW_STATUS=e;g.ProductCollection=f}),98);
__d("WAWebProductImageCollection",["WAWebBaseCollection","WAWebProductImageModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.toArray=function(){var b=this;return a.prototype.filter.call(this,function(a){if(a.old){b.remove(a);return!1}return a})};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebProductImageModel").ProductImage;g.ProductImageCollection=a}),98);
__d("WAWebProductImageModel",["Promise","WABackoffDelay","WALogger","WAPromiseBackoffs","WAWebBaseModel","WAWebCryptoCalculateFilehash","WAWebMedia","WAWebMediaData","WAWebMediaDataUtils","WAWebMediaOpaqueData","WAWebMediaStore","WAWebMediaTypes","WAWebMiscErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k="https://static.whatsapp.net",l=1e3;a=15*60*1e3;var m=10,n=d("WAPromiseBackoffs").createTimer({algo:{type:"fibonacci",first:0,second:1},jitter:.25,max:a});function o(a){a="_productimage_"+(a.includes(k)?a:new URL(a).pathname);return a}e=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(),b.mediaUrl=d("WAWebBaseModel").prop(),b.videoUrl=d("WAWebBaseModel").prop(),b.blobUrl=d("WAWebBaseModel").session(),b.mediaData=d("WAWebBaseModel").session(),b.fetchedFromServer=d("WAWebBaseModel").prop(),b.old=d("WAWebBaseModel").session(!1),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){a.prototype.initialize.call(this),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()};f._processAndUpdateMediaData=function(a){var e=this,f={};a=c("WAWebMediaOpaqueData").createFromData(a,"image/jpeg");d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_processAndUpdateMediaData: before prepRawMedia"])));a=d("WAWebMedia").prepRawMedia(a,{});a.waitForPrep().then(function(a){f=babelHelpers["extends"]({},f,{mediaBlob:a.mediaBlob,type:a.type,mimetype:a.mimetype,fullWidth:a.fullWidth,fullHeight:a.fullHeight});return(j||(j=b("Promise"))).all([typeof a.preview==="string"?c("WAWebMediaOpaqueData").createFromBase64Jpeg(a.preview):(j||(j=b("Promise"))).resolve(null),c("WAWebMediaOpaqueData").createFromData(a.mediaBlob),d("WAWebCryptoCalculateFilehash").calculateFilehashFromBlob(a.mediaBlob)])}).then(function(a){var b=a[0],c=a[1];a=a[2];f=babelHelpers["extends"]({},f,{preview:b,mediaBlob:c,renderableUrl:c.url(),mediaStage:d("WAWebMediaTypes").MediaDataStage.RESOLVED,filehash:a});if(a===e.mediaData.filehash)return;e.mediaData.set(f)})};f.triggerImageUpdate=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;if(!this.fetchedFromServer||!this.mediaUrl)return;this.mediaData||this.addChild("mediaData",new(c("WAWebMediaData"))({mediaStage:d("WAWebMediaTypes").MediaDataStage.PREPARING}));var e=o(this.mediaUrl),f=(yield d("WAWebMediaStore").LruMediaStore.get(e));if(f)return this._processAndUpdateMediaData(f);f={delay:function(a){a=a.taskDuration;var b=l*n();return Math.max(b-a,0)},signal:new AbortController().signal,retries:m};try{f=(yield d("WABackoffDelay").backoff(f,function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield d("WAWebMediaDataUtils").fetchMedia(a.mediaUrl));return!c||!(c.status>=200&&c.status<300)?b(new(d("WAWebMiscErrors").CatalogImageDownloadError)()):c});return function(a){return c.apply(this,arguments)}}()));f=f.result;d("WAWebMediaStore").LruMediaStore.put(e,f);this._processAndUpdateMediaData(f)}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch ",""])),this.mediaUrl).devConsole(a),this.mediaData.set({mediaStage:d("WAWebMediaTypes").MediaDataStage.ERROR_MISSING})}});function e(){return a.apply(this,arguments)}return e}();f.markOld=function(){this.old=!0};f.evictFromCache=function(){if(this.mediaUrl){var a=o(this.mediaUrl);d("WAWebMediaStore").LruMediaStore.del(a)}};return e}(d("WAWebBaseModel").BaseModel);e.Proxy="productImage";f=d("WAWebBaseModel").defineModel(e);g.STATIC_WHATSAPP_IMAGE_URI=k;g.ProductImage=f}),98);
__d("WAWebProductMessageListCollection",["Promise","WAWebBaseCollection","WAWebBizProductCatalogAction","WAWebProductMessageListModel","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(a){function c(){var c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(c=a.call.apply(a,[this].concat(e))||this,c.findQueryImpl=function(a){return c.findImpl(a).then(function(a){return[a]})},c.findImpl=function(a,d){var e=c.get(a);return e==null?(h||(h=b("Promise"))).resolve({id:a}):c._queryProductList(e,d==null?void 0:d.markerId)},babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e._queryProductList=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.catalogId;c=(yield d("WAWebBizProductCatalogAction").queryProductList(c,a.getNextProductBatchToLoad(),void 0,void 0,b));return{id:a.id,_products:c}});function c(b,c){return a.apply(this,arguments)}return c}();e.getOrAdd=function(a,b,c,e,f){var g=this.get(a);if(g!=null)return g;if(e==null)return null;e=d("WAWebWidFactory").createWid(e);g=this.add({id:a,catalogId:e,_productList:b,title:f,requiresDirectConnection:c})[0];return g!=null?g:null};return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebProductMessageListModel").ProductMessageList;a.staleCollection=!0;c=new a();g.ProductMessageListCollection=c}),98);
__d("WAWebProductMessageListModel",["WAWebBaseModel","WAWebBizProductCatalogBridge","WAWebBizProductMessageListAction","WAWebBusinessDirectUtils","WAWebCatalogCollection","WAWebChatCollection","WAWebMsgKey","WAWebProductCollection","WAWebProductMessageListConstant","WAWebProductTypes.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["ERROR","SUCCESS"];a=function(a){function c(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.catalogId=d("WAWebBaseModel").prop(),b.title=d("WAWebBaseModel").prop(),b.requiresDirectConnection=d("WAWebBaseModel").prop(),b._productsLoadingStatus=d("WAWebBaseModel").session(),b._productList=d("WAWebBaseModel").session(),b._products=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.initialize=function(){a.prototype.initialize.call(this),this.productCollection=d("WAWebCatalogCollection").CatalogCollection.gadd({id:this.catalogId}).productCollection,this._productsLoadingStatus=new Map(),this.listenTo(this,"change:_products",this.triggerProductUpdate),this.triggerProductUpdate(),this.listenTo(this.productCollection,"remove",this.triggerProductRemoved),this.listenTo(d("WAWebChatCollection").ChatCollection,"add",this.triggerChatAdded)};e.triggerProductRemoved=function(a){d("WAWebBizProductMessageListAction").updateProductListHeaderImageRejected(a,this.id)};e.triggerProductUpdate=function(){var a=this;if(this._products==null)return;this._products.forEach(function(b){var c=a._getFetchStatus(b);a.setProductLoadingStatus(b.id,c);b.status==="DELETED"&&a.triggerProductRemoved(b);if(b.status!=="DELETED"&&c!=="ERROR"){c=d("WAWebBizProductCatalogBridge").mapProductResponseToModel(b,a.catalogId);c.reviewStatus===d("WAWebProductCollection").PRODUCT_REVIEW_STATUS.REJECTED&&a.triggerProductRemoved(c);a.productCollection.add(c,{merge:!0})}});this._products=void 0};e.triggerChatAdded=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.id.equals(this.catalogId)&&(yield d("WAWebBusinessDirectUtils").isCypherNeeded(this.catalogId))&&(this.productCollection.reset(),this._productsLoadingStatus=new Map())});function c(b){return a.apply(this,arguments)}return c}();e.getNextProductBatchToLoad=function(){var a=this,b=this.getPageSize();b=this._productList.productSections.reduce(function(b,c){c=c.products;return[].concat(b,c.map(function(a){a=a.productId;return a}).filter(Boolean).filter(function(b){return a.getProductLoadingStatus(b)==="NONE"}))},[]).slice(0,b);b.forEach(function(b){return a.setProductLoadingStatus(b,"PENDING")});return b};e.getPageSize=function(){var a=d("WAWebProductTypes.flow").PRODUCT_PAGE_SIZE,b=this.getProductSize();return b<3*a?b:a*2};e.getProductSize=function(){return this._productList.productSections.reduce(function(a,b){b=b.products;return a+b.length},0)};e.setProductLoadingStatus=function(a,b){this._productsLoadingStatus.set(a,b)};e.getProductLoadingStatus=function(a){return this._productsLoadingStatus.get(a)||"NONE"};e.getTotalProductsFetchedOrFailed=function(){return Array.from(this._productsLoadingStatus).filter(function(a){a[0];a=a[1];return h.includes(a)}).length};e.getProductList=function(){return this._productList};e.getSections=function(){return this._productList.productSections};e.getSectionsCount=function(){return this._productList.productSections.reduce(function(a,b){b=b.title;return b!=null&&b!==""?a+1:a},0)};e.isFetching=function(){var a=!1;this._productsLoadingStatus.forEach(function(b){b==="PENDING"&&(a=!0)});return a};e._getFetchStatus=function(a){return a.status===d("WAWebProductMessageListConstant").INVALID_PRODUCT_TOKEN||!a.image_cdn_urls?"ERROR":"SUCCESS"};return c}(d("WAWebBaseModel").BaseModel);a.Proxy="product_list";a.idClass=c("WAWebMsgKey");e=d("WAWebBaseModel").defineModel(a);g.ProductMessageList=e}),98);
__d("WAWebProductModel",["WAWebBaseModel","WAWebBizGatingUtils","WAWebFileUtils","WAWebMediaData","WAWebMediaTypes","WAWebProductImageCollection"],(function(a,b,c,d,e,f,g){a=0;b=4503599627370496;e=10;f=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.old=d("WAWebBaseModel").session(!1),b.checkmark=d("WAWebBaseModel").session(!1),b.id=d("WAWebBaseModel").prop(),b.isHidden=d("WAWebBaseModel").prop(),b.catalogWid=d("WAWebBaseModel").prop(),b.url=d("WAWebBaseModel").prop(),b.signedShimmedUrl=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.description=d("WAWebBaseModel").prop(),b.availability=d("WAWebBaseModel").prop(),b.maxAvailable=d("WAWebBaseModel").prop(),b.reviewStatus=d("WAWebBaseModel").prop(),b.isSanctioned=d("WAWebBaseModel").prop(),b.canAppeal=d("WAWebBaseModel").prop(),b.currency=d("WAWebBaseModel").prop(),b.priceAmount1000=d("WAWebBaseModel").prop(),b.salePriceAmount1000=d("WAWebBaseModel").prop(),b.salePriceStartDate=d("WAWebBaseModel").prop(),b.salePriceEndDate=d("WAWebBaseModel").prop(),b.retailerId=d("WAWebBaseModel").prop(),b.productImageCollection=d("WAWebBaseModel").session(),b.imageCount=d("WAWebBaseModel").prop(),b.displayPriority=d("WAWebBaseModel").prop(),b.videos=d("WAWebBaseModel").prop(),b.variantInfo=d("WAWebBaseModel").prop(),b.additionalImageCdnUrl=d("WAWebBaseModel").prop(),b.additionalImageHashes=d("WAWebBaseModel").prop(),b.imageCdnUrl=d("WAWebBaseModel").prop(),b.imageHash=d("WAWebBaseModel").prop(),b.complianceInfo=d("WAWebBaseModel").prop(),b.importerInformationExempt=d("WAWebBaseModel").prop(),b.productMsgMediaData=d("WAWebBaseModel").session(),b.fetchedFromServer=d("WAWebBaseModel").session(),b.t=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){a.prototype.initialize.call(this),this.productImageCollection=new(d("WAWebProductImageCollection").ProductImageCollection)(),this.listenTo(this,"change:imageCdnUrl",this.triggerMainImageUpdate),this.initImageUpdate()};e.triggerAdditionalImageUpdate=function(){var a,b=this,c=0;(a=this.additionalImageCdnUrl)==null||a.forEach(function(a,d){b.productImageCollection.gadd({id:"_"+(d+1),mediaUrl:a,fetchedFromServer:b.fetchedFromServer,old:!1},{merge:!0}),c=d+1});if(d("WAWebBizGatingUtils").isCatalogVideoViewEnabled()){(a=this.videos)==null||a.forEach(function(a,d){b.productImageCollection.gadd({id:"_"+(d+c+1),mediaUrl:a.thumbnail_url,fetchedFromServer:b.fetchedFromServer,old:!1,videoUrl:a.original_video_url},{merge:!0}),c+=d+1})}this.productImageCollection.filter(function(a,b){return b>c}).forEach(function(a){return a.markOld()})};e.triggerMainImageUpdate=function(){if(this.imageCdnUrl!=null&&this.imageCdnUrl!=="")this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});else{var a;(a=this.productImageCollection.get("_0"))==null||a.markOld()}};e.initImageUpdate=function(){if(!this.fetchedFromServer&&this.productMsgMediaData){for(var a=0;a<this.imageCount;a++)this.productImageCollection.gadd({id:"_"+a,type:"product",mediaData:new(c("WAWebMediaData"))({mediaStage:d("WAWebMediaTypes").MediaDataStage.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});return}this.triggerMainImageUpdate()};e.markOld=function(){this.old=!0};e.lazyloadProductImageCollection=function(){this.triggerAdditionalImageUpdate();return this.productImageCollection};e.getProductImageCollectionCount=function(){return this.productImageCollection.length};e.getProductImageCollectionHead=function(){return this.productImageCollection.head()};e.getHeadImageFile=function(){var a=this.productImageCollection,b=this.name;a=a.head();if(!a)return;var c;a=(a=a.mediaData)==null?void 0:a.mediaBlob;a instanceof Blob?c=a:c=a.getBlob();if(c==null)return;a=d("WAWebFileUtils").createFile([c],b+".jpg",{type:"image/jpeg"});return a};e.evictImagesFromCache=function(){this.productImageCollection.forEach(function(a){return a.evictFromCache()})};e.getPreviewImage=function(){return this.productImageCollection.head()};e.getCollection=function(){return this.collection};e.setIsHidden=function(a){this.isHidden=a};return b}(d("WAWebBaseModel").BaseModel);f.Proxy="product";f=d("WAWebBaseModel").defineModel(f);g.MIN_PRICE=a;g.MAX_PRICE=b;g.MAX_PRODUCT_IMAGES=e;g.Product=f}),98);
__d("WAWebChatComparator",[],(function(a,b,c,d,e,f){a=function(a,b){var c=a.pin||0,d=b.pin||0;if(c||d)return c!==d?c>d?-1:1:a.id.toString()<b.id.toString()?-1:1;c=Math.max(a.previewT||0,a.draftMessageSortTs||0,a.draftAttachMediaContentsSortTs||0,a.t||0);d=Math.max(b.previewT||0,b.draftMessageSortTs||0,b.draftAttachMediaContentsSortTs||0,b.t||0);return c!==d?c>d?-1:1:a.id.toString()<b.id.toString()?-1:1};b=a;f["default"]=b}),66);
__d("WAWebChatCollection",["WALogger","WAWebBaseCollection","WAWebChatComparator","WAWebChatGetters","WAWebChatLockUpdateDailyStats","WAWebChatModel","WAWebIdleTaskRunner","WAWebLidMigrationUtils","WAWebSendUnstarAllChatAction","WAWebSocketConstants","WAWebSocketModel","lodash"],(function(a,b,c,d,e,f,g){var h,i=1e3*60*30;a=function(a){function b(){var b;b=a.call(this)||this;b.notSpam={};b.promises={sendUnstarAll:null};b._sortEnabled=!1;b._viewOnceCleanupTaskQueue=new Set();b.setIndexes=function(){b.forEach(function(a,b){a.initialIndex=b})};b.enableSortListener();b.listenTo(d("WAWebSocketModel").Socket,"change:stream",function(){d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.RESUMING&&b.forEach(function(a){a.pendingMsgs=!1})});b.listenToOnce(b,"sort",c("lodash").debounce(b.setIndexes,100));b._scheduleViewOnceMediaCleanup();b.listenTo(b,"change:isLocked",c("lodash").debounce(function(){d("WAWebChatLockUpdateDailyStats").updateChatLockDailyStats({totalFolderChatsCount:b.filter(function(a){return a.isLocked}).length})},500));return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e._scheduleViewOnceMediaCleanup=function(){var a=this;self.clearTimeout(this._viewOnceCleanupTimeout);this._viewOnceCleanupTimeout=self.setTimeout(function(){d("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){a._runViewOnceMediaCleanup(),a._scheduleViewOnceMediaCleanup()})},i)};e._runViewOnceMediaCleanup=function(){var a=this;this.forEach(function(b){var c=b.id;if(a._viewOnceCleanupTaskQueue.has(c))return;d("WAWebIdleTaskRunner").IdleCallbackTasks.enqueue(function(){a._viewOnceCleanupTaskQueue["delete"](c);var b=a.get(c);(b==null?void 0:b.active)===!1&&b.deregisterExpiredViewOnceBulkMessages(b.msgs)});a._viewOnceCleanupTaskQueue.add(c)})};e.getUnreadCount=function(){return this.filter(function(a){return a.showUnreadInTitle}).length};e.enableSortListener=function(a){if(this._sortEnabled)return;this.listenTo(this,"change:t change:pin change:id change:isLocked change:endOfHistoryTransferType change:isParentGroup change:msgs change:createdLocally change:msgsLength",this.sort);a===!0&&this.sort();this._sortEnabled=!0};e.disableSortListener=function(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)};e.getActive=function(){var a=this.filter(function(a){return a.active});a.length>1&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ChatCollection:getActive more than one active chat"]))).sendLogs("more-than-one-active-chat-in-chat-collection");return a[0]};e.getChatByAccountLid=function(a){var b=this.get(a);if(b)return b;b=d("WAWebLidMigrationUtils").toPn(a);b=b?this.get(b):null;return a.equals(b==null?void 0:b.accountLid)?b:null};e.getLatestChatForWid=function(a){var b=d("WAWebLidMigrationUtils").shouldHaveAccountLid(a)?d("WAWebLidMigrationUtils").toLid(a):null;return b!=null?j.getChatByAccountLid(b):j.get(a)};e.unstarAllMessages=function(a,b){return d("WAWebSendUnstarAllChatAction").unstarAllMessages(a,b)};e.hasAnyUnreadSinceGivenTimestamp=function(a){return this.length===0?!1:this.some(function(b){var c;c=(c=b.t)!=null?c:0;return d("WAWebChatGetters").getHasUnread(b)&&c>a})};e["delete"]=function(){a.prototype["delete"].call(this),this.listenToOnce(this,"sort",c("lodash").debounce(this.setIndexes,100))};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebChatModel").Chat;a.comparator=c("WAWebChatComparator");var j=new a();g.ChatCollectionImpl=a;g.ChatCollection=j}),98);
__d("WAWebChatCommunityUtils",["WAWebChatCollection","WAWebChatGroupUtils","WAWebCommunityGatingUtils","WAWebContactGetters","WAWebGroupMetadataCollection","WAWebGroupType","WAWebLidMigrationUtils","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsMeUser","WAWebWidFactory","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h=91,i=new Set(["add","remove","demote","linked_group_demote"]);function j(a){var b;return!a?!1:(a==null||(b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.COMMUNITY&&d("WAWebChatGroupUtils").isSuspendedGroup(a)&&d("WAWebCommunityGatingUtils").isCommunitySuspendAppealEnabled()}function k(a){var b;return!a?!1:(a==null||(b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.COMMUNITY&&d("WAWebChatGroupUtils").isSuspendedGroup(a)&&d("WAWebChatGroupUtils").isTerminatedGroup(a)}function l(a){if(!(a!=null&&a.groupMetadata))return!1;a=a.groupMetadata;a=a.participants;return a.iAmSuperAdmin()}function a(a){if(!(a!=null&&a.groupMetadata)||k(a)||j(a))return!1;var b=a.groupMetadata,c=b.participants;b=Boolean(b.allowNonAdminSubGroupCreation)&&d("WAWebCommunityGatingUtils").memberAddedGroupsM1Enabled();return b||c.iAmAdmin()||l(a)||d("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()}function b(a){return c("WAWebGroupMetadataCollection").filter(function(b){return b.parentGroup===a&&b.defaultSubgroup===!0}).map(function(a){return a.id})}function e(a,b){return a.map(function(a){var e;e=b?(e=d("WAWebChatCollection").ChatCollection.get(a))==null?void 0:e.formattedTitle:(e=c("WAWebUnjoinedSubgroupMetadataCollection").get(a))==null?void 0:e.subject;return{id:a,subject:e!=null?e:""}})}function f(a){if(!a||!a.contact.name)return!1;var b=d("WAWebChatCollection").ChatCollection.findFirst(function(b){var c;return((c=b.groupMetadata)==null?void 0:c.parentGroup)===a.id&&((c=b.groupMetadata)==null?void 0:c.defaultSubgroup)});return!b||!b.contact.name?!1:b.contact.name!==a.contact.name}function m(a){if(!a)return!1;a=c("WAWebGroupMetadataCollection").get(a);if(!a)return!1;var b=a.participants.iAmAdmin();return a.allowNonAdminSubGroupCreation!==!0&&!b&&d("WAWebCommunityGatingUtils").memberSuggestedGroupsEnabled()}function n(a,b,c){if(b==null)return!0;if(c==null){var e,f;e=(e=d("WAWebLidMigrationUtils").toPn(b.id))!=null?e:b.id;var g=a==null||(f=a.groupMetadata)==null||(f=f.getParentGroupChat())==null||(f=f.groupMetadata)==null?void 0:f.participants;g=Boolean(g==null?void 0:g.iAmAdmin())||e.isUser()&&Boolean(g==null?void 0:g.userIsAdmin(e))}else g=c.iAmCommunityAdmin||c.isSenderAdmin;if(!a||d("WAWebUserPrefsMeUser").isMeAccount(b.id)||d("WAWebContactGetters").getIsMyContact(b)||!d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(a)||g)return!1;return!b.id.isLid()?d("WAWebChatGroupUtils").isCommunityAnnouncementGroup(a):!0}function o(a){a=a.length!==0?a[0].toString():null;return!c("isStringNullOrEmpty")(a)&&d("WAWebWidFactory").isWidlike(a)?d("WAWebWidFactory").createWidFromWidLike(a):null}function p(a,b){b=b.groupMetadata;return Boolean(b==null?void 0:b.isCag)&&i.has(a.subtype)&&!(b!=null&&b.participants.iAmAdmin())}g.SUBGROUP_V2_CHAT_CELL_HEIGHT=h;g.isSuspendedCommunity=j;g.isIntegrityDeactivatedCommunity=k;g.isCommunitySuperAdmin=l;g.canAddGroupToCommunity=a;g.getCagIdFromCommunity=b;g.formatSubgroupUpdateTypes=e;g.cagAndCommunitySubjectDiffer=f;g.isSubgroupSuggestionCreation=m;g.shouldMaskPhoneNumberForChat=n;g.getNewCommunityOwnerFromTemplateParams=o;g.isInvalidCommunitySystemMsg=p}),98);
__d("WAWebChatDocMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.hasDocBefore=!0,c.$ChatDocMsgsCollection$p_1=null,c.count=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(c.$ChatDocMsgsCollection$p_1!=null)return c.$ChatDocMsgsCollection$p_1;var e=a.msgs.filter(j);b=(b=e[0])!=null?b:a.msgs.head();if(b==null)return 0;try{b=(yield d("WAWebMsgCollection").MsgCollection.queryMedia(b.id.remote,Infinity,"before",b.id,"document"));b=(b=b.length)!=null?b:0;var f=b>0&&e.length>0?1:0;c.$ChatDocMsgsCollection$p_1=b+e.length-f;return c.$ChatDocMsgsCollection$p_1}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to count docs for chat ",""])),a.id).verbose().devConsole(b).sendLogs("md-failed-docs-count: "+b.message);return null}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f["delete"]=function(){a.prototype["delete"].call(this),this.stopListening(),this.reset()};f.add=function(b,c){this.$ChatDocMsgsCollection$p_1=null;return a.prototype.add.call(this,b,c)};f.remove=function(b,c){this.$ChatDocMsgsCollection$p_1=null;return a.prototype.remove.call(this,b,c)};f.queryDocs=function(a,e){var f=this;if(e){if(this.queryDocBefore)return this.queryDocBefore;e=this.queryDocBefore=d("WAWebMsgCollection").MsgCollection.queryMedia(e.id.remote,d("WAWebMsgCollection").MEDIA_QUERY_LIMIT,"before",e.id,"document").then(function(a){(!a||a.length<d("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(f.hasDocBefore=!1),f.add(a.filter(j),{at:0})})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["finally"](function(){f.queryDocBefore=null,f.trigger("query_doc_before")});this.trigger("query_doc_before");return e}e=a.msgs;if(this.length===0){if(!e||e.length===0){this.hasDocBefore=!1;return(i||(i=b("Promise"))).resolve()}this.add(e.filter(j),{at:0})}if(a.msgs.msgLoadState.noEarlierMsgs){this.hasDocBefore=!1;return(i||(i=b("Promise"))).resolve()}else if(this.length<=2*d("WAWebMsgCollection").MEDIA_QUERY_LIMIT){e=this.length===0?e.head():this.head();return this.queryDocs(a,e)}return(i||(i=b("Promise"))).resolve()};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;function j(a){return d("WAWebFrontendMsgGetters").getAsDoc(a)!=null&&!a.isVcardOverMmsDocument}g["default"]=a}),98);
__d("WAWebTosCountryGating",["WAWebABPropsInternalNumber","WAWebBizGatingUtils","WAWebHandleMsgTypes.flow"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebBizGatingUtils").countryGatingEnabled()){var b;return((b=a.privacyMode)==null?void 0:b.hostStorage)===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&!d("WAWebABPropsInternalNumber").getFbBrandedNumber(a.id.user)}return!1}g.shouldBlockByCountry=a}),98);
__d("WAWebChatGroupUtils",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebApiContact","WAWebBizAiAgentGating","WAWebBizAiAgentStatusUtils","WAWebBotGating","WAWebBotTos","WAWebChatGetters","WAWebCommunityGatingUtils","WAWebCurrentUser","WAWebDBUpdateChatTable","WAWebFrontendContactGetters","WAWebGroupGatingUtils","WAWebGroupType","WAWebIndividualNewChatMessageCappingLimitUtils","WAWebLid1X1MigrationGating","WAWebNewsletterMembershipUtil","WAWebNoop","WAWebReachoutTimelockUtils","WAWebStateUtils","WAWebTosCountryGating","WAWebTosGating","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a){if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&((a=a.groupMetadata)==null?void 0:a.support)===!0}function m(a){a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&!!((a=a.groupMetadata)!=null&&a.terminated)}function n(a){a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&((a=a.groupMetadata)==null?void 0:a.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP}function a(a){a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&((a=a.groupMetadata)==null?void 0:a.groupType)===d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP}function o(a){if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&!!((a=a.groupMetadata)!=null&&a.suspended)}function e(a){a=d("WAWebStateUtils").unproxy(a);return a.canSend&&!o(a)&&!m(a)}function f(a){var b;a=d("WAWebStateUtils").unproxy(a);return d("WAWebChatGetters").getIsGroup(a)&&((b=a.groupMetadata)==null?void 0:b.growthLockType)==="invite"&&(a.groupMetadata.growthLockExpiration||0)>d("WATimeUtils").unixTime()}function p(a){var b;if(!a)return!1;a=d("WAWebStateUtils").unproxy(a);var c=m(a);b=o(a)&&!((b=a.groupMetadata)!=null&&b.participants.iAmMember());return(c||b)&&!n(a)}function q(a){var b;a=d("WAWebStateUtils").unproxy(a);return((b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&o(a)&&d("WAWebCommunityGatingUtils").isCommunitySuspendAppealEnabled()}function r(a){var b;a=d("WAWebStateUtils").unproxy(a);return((b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&o(a)&&m(a)}function s(){return d("WAWebABProps").getABPropConfigValue("group_suspend_appeal_include_entity_id_enabled")}function t(a){var b;a=d("WAWebStateUtils").unproxy(a);return((b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&m(a)}function u(a){return o(a)||m(a)}function v(a){var e,f=d("WAWebStateUtils").unproxy(a);if(l(f)&&f.isReadOnly)return;a=(k||(k=b("Promise"))).resolve();if(d("WAWebChatGetters").getIsNewsletter(f)){var g=!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(f.newsletterMetadata)||f.isSuspendedOrTerminated();f.isReadOnly!==g&&d("WAWebDBUpdateChatTable").updateChatTable(f.id,{isReadOnly:g}).then(function(){f.isReadOnly=g,A(f)})["catch"](c("WAWebNoop"));return}if(d("WAWebChatGetters").getIsGroup(f)&&!((e=f.groupMetadata)!=null&&e.stale)){var i=((e=f.groupMetadata)==null?void 0:e.groupType)!==d("WAWebGroupType").GroupType.COMMUNITY&&(!((e=f.groupMetadata)!=null&&e.participants.iAmMember())||m(f));f.isReadOnly!==i&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat:updateReadOnly:old ",", new ",""])),f.isReadOnly,i),a=d("WAWebDBUpdateChatTable").updateChatTable(f.id,{isReadOnly:i}).then(function(){f.isReadOnly=i,A(f)}))}a.then(function(){d("WAWebChatGetters").getIsBroadcast(f)&&z(f)})}function w(a){a=d("WAWebStateUtils").unproxy(a);return((a=a.groupMetadata)==null?void 0:a.participants.length)||1}function x(a,b,c){var e=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow();if(e.equals(a))return d("WAWebUserPrefsMeUser").getMePnUserOrThrow();if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return a;if(!a.isLid())return a;e=d("WAWebApiContact").getPhoneNumber(a);if(e==null){d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getOneToOneContactFromGroupContact: could not find PN for Lid ",""])),a.toString());d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getOneToOneContactFromGroupContact: Participant LID does not have PN mapping. context: ",". more context: ",""])),b,c).sendLogs("lid-group-get-one-to-one-contact");return null}return e}function y(a){var b=a.participants;a=(a=a.size)!=null?a:0;a=b.iAmAdmin()?a:b.length;return a}function z(a){if(d("WAWebChatGetters").getIsBroadcast(a)){var b;a.formattedTitle=(b=a.contact.name)!=null?b:((b=(b=a.groupMetadata)==null?void 0:b.participants)!=null?b:[]).map(function(a){return d("WAWebFrontendContactGetters").getFormattedShortName(a.contact)}).join(", ")}else if(d("WAWebChatGetters").getIsUser(a)){a.formattedTitle=(b=d("WAWebFrontendContactGetters").getFormattedUser(a.contact))!=null?b:""}else if(d("WAWebChatGetters").getIsGroup(a)){a.formattedTitle=(b=a.contact.name)!=null?b:(b=a.groupMetadata)==null?void 0:b.subject}else if(d("WAWebChatGetters").getIsNewsletter(a)){a.formattedTitle=(b=a.contact.name)!=null?b:(b=a.newsletterMetadata)==null?void 0:b.name}}function A(a,b){if(a.isReadOnly||a.isAnnounceGrpRestrict===!0||d("WAWebTosGating").shouldBlockByTos(a.contact)||d("WAWebTosGating").shouldBlockByBotTos(a.contact)||d("WAWebTosCountryGating").shouldBlockByCountry(a.contact)||!d("WAWebBotGating").isBotEnabled()&&a.id.isBot()||!d("WAWebBotGating").isFbidBotEnabled()&&a.id.isFbidBot()||d("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&(d("WAWebBizAiAgentStatusUtils").shouldShowAiAgentBlockBar(a)||d("WAWebBizAiAgentStatusUtils").tryToEnableAiAgent(a))){a.canSend=!1;return!1}else if((b=b!=null?b:a.contact.businessProfile)!=null&&b.isBizBot3p&&(!d("WAWebBotGating").isBizBot3pAvailable()||!d("WAWebBotTos").hasAcceptedBizBotTos())){a.canSend=!1;return!1}else if(d("WAWebChatGetters").getIsUser(a))return a.canSend=!(a.contact.isContactBlocked||d("WAWebChatGetters").getIsPSA(a)||d("WAWebChatGetters").getIsIAS(a)||d("WAWebReachoutTimelockUtils").isUserReachoutTimelocked()&&!d("WAWebReachoutTimelockUtils").canSendMsgWhileTimelocked({chat:a,contact:a.contact})||d("WAWebIndividualNewChatMessageCappingLimitUtils").isUserCapped()&&!d("WAWebIndividualNewChatMessageCappingLimitUtils").canSendMsgWhileCapped({chat:a,contact:a.contact}));else if(d("WAWebChatGetters").getIsNewsletter(a))return a.canSend=d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a.newsletterMetadata);a.canSend=!0;return!0}function B(a){return d("WAWebChatGetters").getIsGroup(a)&&d("WAWebGroupGatingUtils").isGroupExitExperienceEnabled()&&!n(a)&&!a.isReadOnly}g.isSupportGroup=l;g.isTerminatedGroup=m;g.isCommunityAnnouncementGroup=n;g.isCommunityGeneralGroup=a;g.isSuspendedGroup=o;g.canSendToGroup=e;g.isInviteGrowthLockedGroup=f;g.isTerminatedGroupOrNotMember=p;g.isSuspendedCommunityAnnouncementGroup=q;g.isIntegrityDeactivatedCommunityAnnouncementGroup=r;g.shouldIncludeEntityIdInAppealRequest=s;g.isDeactivatedCommunityAnnouncementGroup=t;g.shouldBlockCall=u;g.updateReadOnly=v;g.getParticipantCount=w;g.getOneToOneContactFromGroupContact=x;g.getGroupParticipantsCount=y;g.updateTitle=z;g.updateCanSend=A;g.isGroupExitExperienceEnabledForChat=B}),98);
__d("WAWebChatLinkMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAPromiseLoop","WAWebBackendErrors","WAWebBaseCollection","WAWebMsgCollection","WAWebMsgLinks","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.hasLinkBefore=!0,c.$ChatLinkMsgsCollection$p_1=null,c.count=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(c.$ChatLinkMsgsCollection$p_1!=null)return c.$ChatLinkMsgsCollection$p_1;var e=a.msgs.filter(function(a){return d("WAWebMsgLinks").getLinksFromMsg(a).length>0});b=(b=e[0])!=null?b:a.msgs.head();if(b==null)return 0;try{b=(yield d("WAWebMsgCollection").MsgCollection.queryMedia(b.id.remote,Infinity,"before",b.id,"url"));b=(b=b.length)!=null?b:0;var f=b>0&&e.length>0?1:0;c.$ChatLinkMsgsCollection$p_1=b+e.length-f;return c.$ChatLinkMsgsCollection$p_1}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to count medias for chat ",""])),a.id).verbose().devConsole(b).sendLogs("md-failed-medias-count: "+b.message);return null}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f["delete"]=function(){a.prototype["delete"].call(this),this.stopListening(),this.reset()};f.add=function(b,c){this.$ChatLinkMsgsCollection$p_1=null;return a.prototype.add.call(this,b,c)};f.remove=function(b,c){this.$ChatLinkMsgsCollection$p_1=null;return a.prototype.remove.call(this,b,c)};f.queryLinks=function(a,e){var f=this;if(e){if(this.queryLinkBefore)return this.queryLinkBefore;e=this.queryLinkBefore=d("WAWebMsgCollection").MsgCollection.queryMedia(e.id.remote,d("WAWebMsgCollection").MEDIA_QUERY_LIMIT,"before",e.id,"url").then(function(a){(!a||a.length<d("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(f.hasLinkBefore=!1),f.add(a,{at:0}),f.createLinksAndAddMsgs(a)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["finally"](function(){f.queryLinkBefore=null,f.trigger("query_link_before")});this.trigger("query_link_before");return e}e=a.msgs.getModelsArray();if(this.length===0){if(!e||e.length===0){this.hasLinkBefore=!1;return(i||(i=b("Promise"))).resolve()}this.add(e.filter(function(a){return d("WAWebMsgLinks").getLinksFromMsg(a).length>0}),{at:0});this.createLinksAndAddMsgs(e)}if(a.msgs.msgLoadState.noEarlierMsgs){this.hasLinkBefore=!1;return(i||(i=b("Promise"))).resolve()}else if(this.length<=2*d("WAWebMsgCollection").MEDIA_QUERY_LIMIT){e=this.length===0?a.msgs.head():this.head();return this.queryLinks(a,e)}return(i||(i=b("Promise"))).resolve()};f.createLinksAndAddMsgs=function(a){var b=this,c=[];d("WAPromiseLoop").promiseLoop(function(b,e,f){if(a.length===f){b();return}e=a[f];if(e!=null){b=d("WAWebMsgLinks").getLinksFromMsg(e);b.length&&c.push(e)}}).then(function(){b.add(c),b.trigger("query_link_before")})};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return a.t-b.t};g["default"]=a}),98);
__d("WAWebWamEnumWebcMessageQueryDirection",[],(function(a,b,c,d,e,f){a=Object.freeze({LOAD_PREV:0,LOAD_NEXT:1,LOAD_AROUND:2});f.WEBC_MESSAGE_QUERY_DIRECTION=a}),66);
__d("WAWebWebcMessageQueryWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcChatType","WAWebWamEnumWebcMessageQueryDirection","WAWebWamEnumWebcQueryTriggerType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMessageQuery:[1876,{webcAudioMessageCount:[14,a.TYPES.INTEGER],webcBrowserNetworkType:[1,a.TYPES.STRING],webcBrowserStorageQuotaBytes:[20,a.TYPES.INTEGER],webcBrowserStorageQuotaUsedBytes:[21,a.TYPES.INTEGER],webcChatPosition:[2,a.TYPES.INTEGER],webcChatType:[13,d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE],webcDocumentMessageCount:[16,a.TYPES.INTEGER],webcEarliestMessageIndex:[11,a.TYPES.INTEGER],webcEarliestMessageT:[12,a.TYPES.TIMER],webcMessageCount:[4,a.TYPES.INTEGER],webcMessageQueryTrigger:[19,d("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE],webcMessageQueryType:[3,d("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION],webcOtherMessageCount:[18,a.TYPES.INTEGER],webcPhotoMessageCount:[7,a.TYPES.INTEGER],webcPttMessageCount:[15,a.TYPES.INTEGER],webcQueryT:[9,a.TYPES.TIMER],webcResponseBytes:[10,a.TYPES.INTEGER],webcStickerMessageCount:[17,a.TYPES.INTEGER],webcTextMessageCount:[5,a.TYPES.INTEGER],webcVideoMessageCount:[6,a.TYPES.INTEGER]},[1,1,5],"regular"]},{WebcMessageQuery:[]});g.WebcMessageQueryWamEvent=b}),98);
__d("WAWebMsgCountReporter",["WAWebMsgType","WAWebWebcMessageQueryWamEvent"],(function(a,b,c,d,e,f,g){function a(a){return new(d("WAWebWebcMessageQueryWamEvent").WebcMessageQueryWamEvent)({webcResponseBytes:0,webcMessageCount:0,webcTextMessageCount:0,webcVideoMessageCount:0,webcPhotoMessageCount:0,webcAudioMessageCount:0,webcPttMessageCount:0,webcStickerMessageCount:0,webcDocumentMessageCount:0,webcOtherMessageCount:0,webcMessageQueryTrigger:a})}function b(a,b){a.webcMessageCount+=b.length;for(var c=0,e=b[c];c<b.length;++c,e=b[c])switch(e.type){case d("WAWebMsgType").MSG_TYPE.CHAT:case d("WAWebMsgType").MSG_TYPE.LOCATION:case d("WAWebMsgType").MSG_TYPE.PAYMENT:case d("WAWebMsgType").MSG_TYPE.VCARD:case d("WAWebMsgType").MSG_TYPE.CIPHERTEXT:case d("WAWebMsgType").MSG_TYPE.MULTI_VCARD:case d("WAWebMsgType").MSG_TYPE.REVOKED:case d("WAWebMsgType").MSG_TYPE.OVERSIZED:a.webcTextMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.PRODUCT:a.webcPhotoMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.VIDEO:a.webcVideoMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.AUDIO:a.webcAudioMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.PTT:a.webcPttMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.STICKER:a.webcStickerMessageCount+=1;break;case d("WAWebMsgType").MSG_TYPE.DOCUMENT:a.webcDocumentMessageCount+=1;break;default:a.webcOtherMessageCount+=1;break}}g.newMessageQueryEvent=a;g.logMessageCounts=b}),98);
__d("WAWebChatLoadMessages",["Promise","WAAbortError","WABackoffUtils","WAFilteredCatch","WALogger","WANullthrows","WAPromiseDelays","WAPromiseLoop","WARaceSignal","WAStorageEstimator","WAWebBackendErrors","WAWebChatConstants","WAWebChatGetters","WAWebCollectionConstants","WAWebGetNewsletterCursor","WAWebMiscErrors","WAWebMsgCollection","WAWebMsgCountReporter","WAWebNetworkType","WAWebNewsletterGatingUtils","WAWebNewsletterGetMessageUpdatesAction","WAWebNewsletterPullMessagesFromServerAction","WAWebNewsletterSystemMessages","WAWebStateUtils","WAWebSyncGatingUtils","WAWebWamEnumWebcMessageQueryDirection","WAWebWamEnumWebcQueryTriggerType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){a=d("WAWebStateUtils").unproxy(a);c=c;c||(c=a.msgs);if(l(a,c))return(i||(i=b("Promise"))).resolve();if(c.msgLoadState.isLoadingRecentMsgs)return c.loadRecentPromise;a=(yield m(a,"after",c,d("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL,e));c=a.msgs;return c});return j.apply(this,arguments)}function e(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){a=d("WAWebStateUtils").unproxy(a);yield a.waitForChatLoading();var g=c;c=e!=null?e:d("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL;g||(g=a.msgs);if(g.msgLoadState.noEarlierMsgs)return(i||(i=b("Promise"))).resolve();if(g.msgLoadState.isLoadingEarlierMsgs)return g.loadEarlierPromise;var h=g?g.head():null;if(d("WAWebChatGetters").getIsNewsletter(a)&&h!=null&&d("WAWebNewsletterSystemMessages").isEarliestNewsletterSystemMsg(h)){g.msgLoadState.noEarlierMsgs=!0;return[]}e=function(){return h?h.msgChunk:g};c=(yield m(a,"before",g,c,f));f=c.msgs;c=c.hasMoreMsgs;e=e();e&&!c&&(e.msgLoadState.noEarlierMsgs=a.endOfHistoryTransferType!==d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,d("WAWebSyncGatingUtils").isHistorySyncOnDemandEnabled()&&(e.msgLoadState.noEarlierMsgs=e.msgLoadState.noEarlierMsgs&&a.endOfHistoryTransferType!==d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY));return f});return k.apply(this,arguments)}function l(a,b){return a.msgs===b}function m(a,b,c,d,e){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f){var g;b==="after"?g=c.last():g=c.head();var h={};g?h=g.id.clone():h.remote=a.id;h.count=d("WAWebCollectionConstants").PAGE_SIZE;h.direction=b;e=d("WAWebMsgCountReporter").newMessageQueryEvent(e);g=(yield o(a,g,c,d("WAWebMsgCollection").MsgCollection.findQuery.bind(d("WAWebMsgCollection").MsgCollection,h),b,e,!0,f));d("WAWebChatGetters").getIsNewsletter(a)&&d("WAWebNewsletterGatingUtils").isNewsletterReactionEnabled()&&(yield d("WAWebNewsletterGetMessageUpdatesAction").maybeUpdateMsgsAddOns(g,a));h=g.length>=d("WAWebCollectionConstants").PAGE_SIZE;if(h||!d("WAWebChatGetters").getIsNewsletter(a)||!d("WAWebNewsletterGatingUtils").isNewsletterEnabled())return{msgs:g,hasMoreMsgs:h};try{e=g[0];if(b==="before"&&e!=null&&d("WAWebNewsletterSystemMessages").isNewsletterSystemMsg(e))return{msgs:g,hasMoreMsgs:!1};f=g.length>d("WAWebCollectionConstants").PAGE_SIZE;h=f?[]:yield d("WAWebNewsletterPullMessagesFromServerAction").pullNewsletterMessagesFromServer(a,{messageCount:d("WAWebCollectionConstants").PAGE_SIZE-g.length,cursor:d("WAWebGetNewsletterCursor").getNewsletterCursor(c,b,g),resetUnreadCount:!0});e=b==="before"?h.concat(g):g.concat(h);f=e.length>=d("WAWebCollectionConstants").PAGE_SIZE;c=e[0];if(b==="before"&&!f&&(c==null||!d("WAWebNewsletterSystemMessages").isNewsletterSystemMsg(c))){h=(yield d("WAWebNewsletterSystemMessages").addSystemMessagesToChat(a));e.unshift.apply(e,h)}return{msgs:e,hasMoreMsgs:f}}catch(a){return{msgs:g,hasMoreMsgs:!0}}});return n.apply(this,arguments)}function o(a,e,f,g,j,k,l,m){l===void 0&&(l=!0);var n=d("WAWebStateUtils").unproxy(a),o=self.performance.now();j==="after"?(f.msgLoadState.isLoadingRecentMsgs=!0,k.webcMessageQueryType=d("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):j==="before"?(f.msgLoadState.isLoadingEarlierMsgs=!0,k.webcMessageQueryType=d("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):j==="around"&&(f.msgLoadState.isLoadingAroundMsgs=!0,k.webcMessageQueryType=d("WAWebWamEnumWebcMessageQueryDirection").WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND);k.webcBrowserNetworkType=d("WAWebNetworkType").getEffectiveNetworkType();k.webcChatType=n.getWebcChatType();typeof n.initialIndex==="number"&&(k.webcChatPosition=n.initialIndex);a=c("WARaceSignal")([m,n.getDeleteSignal()].filter(Boolean),function(a){return d("WAPromiseLoop").promiseLoop(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c,l,m){if(a.aborted)throw new(d("WAAbortError").AbortError)();l=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(m,12e4,1e3,.1));var q=(i||(i=b("Promise"))).resolve();try{yield q;q=(yield g());if(a.aborted)throw new(d("WAAbortError").AbortError)();k.webcQueryT=Math.ceil(self.performance.now()-o);var r;Array.isArray(q[0])?(r=q[0][0],q.forEach(function(a){return d("WAWebMsgCountReporter").logMessageCounts(k,a)})):(r=q[0],d("WAWebMsgCountReporter").logMessageCounts(k,q));r&&(k.webcEarliestMessageT=r.t,r.msgChunk===n.msgs&&(k.webcEarliestMessageIndex=n.msgs.length-1));d("WAStorageEstimator").estimateStorage().then(function(a){if(a.success){a=a.value;var b=a.quota;a=a.usage;k.webcBrowserStorageQuotaBytes=b;k.webcBrowserStorageQuotaUsedBytes=a}})["finally"](function(){return k.commit()});p(e,f,j);c(q)}catch(a){if(a.name===d("WAAbortError").ABORT_ERROR)throw a;if(m>3||a===404){p(e,f,j);d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["chat:loadMsgs:error ",""])),String(a));return a===404?(i||(i=b("Promise"))).reject(new(d("WAWebBackendErrors").E404)()):(i||(i=b("Promise"))).reject(new(d("WAWebMiscErrors").GaveUpRetry)("Gave up msg fetch after "+m+" tries"))}return l}});return function(a,b,d){return c.apply(this,arguments)}}(),0)})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebMiscErrors").GaveUpRetry,function(){return[]}))["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,function(a){if(l)return[];throw a}));j==="after"?f.loadRecentPromise=a:j==="before"?f.loadEarlierPromise=a:j==="around"&&(f.loadAroundPromise=a);return a}function p(a,b,d){var e=(a==null?void 0:a.msgChunk)&&a.msgChunk!==b;b.msgLoadState.contextLoaded=!0;a&&e&&(c("WANullthrows")(a.msgChunk).msgLoadState.contextLoaded=!0);d==="after"?b.msgLoadState.isLoadingRecentMsgs=!1:d==="before"?b.msgLoadState.isLoadingEarlierMsgs=!1:d==="around"&&(b.msgLoadState.isLoadingAroundMsgs=!1)}g.loadRecentMsgs=a;g.loadEarlierMsgs=e;g.loadMsgsPromiseLoop=o}),98);
__d("WAWebChatMedia",["Promise","WAWebCarouselMsgUtils","WAWebChatMediaMsgsCollection","WAWebFrontendMsgGetters","WAWebMessageAssociationUIUtils","WAWebMsgGetters","WAWebMsgLinks","WAWebStateUtils"],(function(a,b,c,d,e,f,g){var h;function a(a){a=d("WAWebStateUtils").unproxy(a);var b=a.mediaMsgs,c=a.linkMsgs,e=a.docMsgs,f=a.productMsgs;b&&(b["delete"](),b.queryMedia({chat:a}));c&&(c["delete"](),c.queryLinks(a));e&&(e["delete"](),e.queryDocs(a));f&&(f["delete"](),f.queryProducts(a))}function i(a){return d("WAWebMsgGetters").getIsMedia(a)&&!a.isViewOnce}function e(a,b,c){if(!b)return;a=d("WAWebStateUtils").unproxy(a);b=d("WAWebCarouselMsgUtils").flattenMsgs(Array.isArray(b)?b:[b]);var e=[],f=[],g=[],h=[];b.forEach(function(a){i(a)&&e.push(a),d("WAWebFrontendMsgGetters").getAsDoc(a)&&g.push(a),d("WAWebMsgLinks").getGalleryLinks(a).length&&f.push(a),d("WAWebFrontendMsgGetters").getAsProduct(a)!=null&&h.push(a)});b=a.mediaMsgs;if(b&&e.length){var j=babelHelpers["extends"]({},c,{silent:!1});b.add(e,j)}a.linkMsgs&&f.length&&a.linkMsgs.add(f,c);a.docMsgs&&g.length&&a.docMsgs.add(g,c);a.productMsgs&&h.length&&a.productMsgs.add(h,c)}function f(a,b){a=d("WAWebStateUtils").unproxy(a);var e=new(c("WAWebChatMediaMsgsCollection"))(),f=a.getMediaMsgs().filter(d("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage);b||e.add(f);if(!b||b.isViewOnce)return e;(f.includes(b)||b.msgChunk===a.msgs)&&(e.add(f),e.hasMediaAfter=!1);if(!f.includes(b)){a=b.msgChunk!=null?b.msgChunk.slice():[b];f=a.filter(d("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage);b=d("WAWebCarouselMsgUtils").flattenMsgs(f);e.add(b.filter(i))}return e}function j(a){var c=d("WAWebStateUtils").unproxy(a);return c.promises.sendDelete!=null?(h||(h=b("Promise"))).resolve(0):(h||(h=b("Promise"))).all([c.getMediaMsgs(),c.getLinkMsgs(),c.getDocMsgs()].map(function(a){return a.count(c)})).then(function(a){return a.reduce(function(a,b){return a+(b!=null?b:0)},0)})}g.resetMediaMsgs=a;g.addMediaMsgs=e;g.constructMediaMsgs=f;g.countAllMedia=j}),98);
__d("WAWebChatMediaMsgsCollection",["Promise","WAFilteredCatch","WALogger","WAWebBackendErrors","WAWebBaseCollection","WAWebCarouselMsgUtils","WAWebMessageAssociationUIUtils","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModel","WAWebNoop","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j={before:"before",after:"after"};function k(a){return d("WAWebMsgGetters").getIsMedia(a)&&!a.isViewOnce&&d("WAWebMessageAssociationUIUtils").shouldDisplayOrphanMessage(a)}a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.hasMediaBefore=!0,c.hasMediaAfter=!0,c.$ChatMediaMsgsCollection$p_1=null,c.count=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(c.$ChatMediaMsgsCollection$p_1!=null)return c.$ChatMediaMsgsCollection$p_1;var e=a.msgs.filter(k);b=(b=e[0])!=null?b:a.msgs.head();if(b==null)return 0;try{b=(yield d("WAWebMsgCollection").MsgCollection.queryMedia(b.id.remote,Infinity,"before",b.id));b=(b=b.mediaCount)!=null?b:0;var f=b>0&&e.length>0?1:0;c.$ChatMediaMsgsCollection$p_1=b+e.length-f;return c.$ChatMediaMsgsCollection$p_1}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to count medias for chat "," with error ",""])),a.id,b).verbose().devConsole(b).sendLogs("md-failed-medias-count");return null}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f["delete"]=function(){a.prototype["delete"].call(this),this.stopListening()};f.add=function(b,c){this.$ChatMediaMsgsCollection$p_1=null;return a.prototype.add.call(this,b,c)};f.remove=function(b,c){this.$ChatMediaMsgsCollection$p_1=null;return a.prototype.remove.call(this,b,c)};f.getAfter=function(a){a=this.indexOf(a);return a<0||a===this.length-1?null:this.at(a+1)};f.getBefore=function(a){a=this.indexOf(a);return a<=0?null:this.at(a-1)};f.loadEarlierMedias=function(){var a=this.head();if(!a)return;if(a.isCarouselCard){var b;a=(b=d("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(a))!=null?b:a}void this.queryMedia({msg:a})};f.loadRecentMedias=function(){var a=this.last();if(!a)return;if(a.isCarouselCard){var b;a=(b=d("WAWebCarouselMsgUtils").getParentMsgFromCarouselCard(a))!=null?b:a}void this.queryMedia({msg:a,direction:j.after})};f.loadMoreAroundIfNeeded=function(a){if(!a||a.isViewOnce)return;a=this.indexOf(a);a<20&&this.hasMediaBefore&&this.loadEarlierMedias();this.length-a<20&&this.hasMediaAfter&&this.loadRecentMedias()};f.queryMedia=function(a){var e=this,f=a.chat,g=a.msg;a=(a=a.direction)!=null?a:j.before;if(!g&&f){var h=f.msgs;if(!h||h.length===0){this.hasMediaBefore=!1;return new(i||(i=b("Promise")))(function(a){a({eof:!0})})}this.add(h.filter(k),{at:0});var m=this.toArray();if(f.msgs.msgLoadState.noEarlierMsgs){this.hasMediaBefore=!1;return new(i||(i=b("Promise")))(function(a){a({eof:!0})})}else if(m.length<=2*d("WAWebMsgCollection").MEDIA_QUERY_LIMIT){h=m.length===0?h.head():m[0];return this.queryMedia({chat:f,msg:h})}return new(i||(i=b("Promise")))(function(a){a({eof:!1})})}if(g&&a===j.before){if(this.queryMediaBefore)return this.queryMediaBefore;var n=0;this.queryMediaBefore=d("WAWebMsgCollection").MsgCollection.queryMedia(g.id.remote,d("WAWebMsgCollection").MEDIA_QUERY_LIMIT,a,d("WAWebMsgGetters").getIsMedia(g)?g.id:void 0).then(function(b){b=b.messages;(!b||b.length<d("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(e.hasMediaBefore=!1);var a=[];b&&b.length>0&&(a=l(b));e.add(a,{at:0});n=a.length;return{length:n}})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["finally"](function(){e.queryMediaBefore=null,e.trigger("query_media_before",n)});this.trigger("query_media_before",0);return this.queryMediaBefore}else if(g&&a===j.after)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=d("WAWebMsgCollection").MsgCollection.queryMedia(g.id.remote,d("WAWebMsgCollection").MEDIA_QUERY_LIMIT,a,g.id).then(function(b){b=b.messages;(!b||b.length<d("WAWebMsgCollection").MEDIA_QUERY_LIMIT)&&(e.hasMediaAfter=!1);var a=[];b&&b.length>0&&(a=l(b));e.add(a);return{length:a.length}})["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["finally"](function(){e.queryMediaAfter=null,e.trigger("query_media_after")})};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return a.t-b.t};function l(a){return d("WAWebCarouselMsgUtils").flattenMsgs(a).filter(k)}g["default"]=a}),98);
__d("WAWebChatSearchFilters",["$InternalEnum"],(function(a,b,c,d,e,f){var g=b("$InternalEnum")({UNREAD:"unread",FAVORITES:"favorites",GROUP:"group",BROADCAST:"broadcast",CONTACT:"contact",NON_CONTACT:"non_contact",ASSIGNED_TO_YOU:"assigned_to_you",PERSONAL:"personal",BUSINESS:"business",LABELS:"labels"});a=function(a){switch(a){case g.UNREAD:case g.ASSIGNED_TO_YOU:case g.CONTACT:case g.GROUP:case g.LABELS:case g.FAVORITES:return!0;case g.BROADCAST:case g.NON_CONTACT:case g.BUSINESS:case g.PERSONAL:return!1}};c=function(a){switch(a){case g.UNREAD:case g.ASSIGNED_TO_YOU:return!0;case g.BROADCAST:case g.NON_CONTACT:case g.BUSINESS:case g.PERSONAL:case g.CONTACT:case g.GROUP:case g.LABELS:case g.FAVORITES:return!1}};f.SearchFilters=g;f.isFilterExcludedFromSearchTreatmentInInboxFlow=a;f.isFilterExcludedFromSearchTreatmentInNormalFlow=c}),66);
__d("WAWebChatMessageSearch",["WANullthrows","WAWebChatAssignmentUtils","WAWebChatConstants","WAWebChatGetters","WAWebChatLoadMessages","WAWebChatMsgsCollection","WAWebChatSearchFilters","WAWebCollectionConstants","WAWebContactGetters","WAWebFrontendChatGetters","WAWebMessageAssociation.flow","WAWebMsgCollection","WAWebMsgCountReporter","WAWebStateUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumWebcQueryTriggerType","isEmptyObject"],(function(a,b,c,d,e,f,g){function a(a,b,e){var f=d("WAWebStateUtils").unproxy(a),g=d("WAWebMsgCollection").MsgCollection.get(b),h=b,i=e;b=(a=g)==null?void 0:a.parentMsgKey;b&&((e=g)==null?void 0:e.associationType)===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM&&!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,(a=g)==null?void 0:a.viewMode)&&(g=d("WAWebMsgCollection").MsgCollection.get(b),h=b,i=g);var j=g?g.msgChunk:void 0,k=Math.trunc(d("WAWebCollectionConstants").PAGE_SIZE/3*2);if(!j||!j.msgLoadState.contextLoaded){j||(j=new(d("WAWebChatMsgsCollection").ChatMsgsCollection)(),f.msgChunks.push(j),g&&j.add(g));e=g?g.id.clone():h.clone();e.count=k;e.serverId=(a=g)==null?void 0:a.serverId;var l=function(){if(g)return g.msgChunk;if(h!=null){var a=d("WAWebMsgCollection").MsgCollection.get(h);return a!=null&&a.msgChunk?a.msgChunk:j}return j};b=d("WAWebMsgCountReporter").newMessageQueryEvent(d("WAWebWamEnumWebcQueryTriggerType").WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK);d("WAWebChatLoadMessages").loadMsgsPromiseLoop(f,g,j,d("WAWebMsgCollection").MsgCollection.getContext.bind(d("WAWebMsgCollection").MsgCollection,e,l),"around",b,i==null).then(function(a){var b=l();b&&j&&b!==j&&f.notifyMsgCollectionMerge(b,j,b);b=a[0];a=h?d("WAWebMsgCollection").MsgCollection.get(h):g;a&&Array.isArray(b)&&b.length<k&&(c("WANullthrows")(a.msgChunk).msgLoadState.noEarlierMsgs=f.endOfHistoryTransferType!==d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE,j&&a.msgChunk!==j&&(j.msgLoadState.noEarlierMsgs=f.endOfHistoryTransferType!==d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE))})["catch"](function(){i&&(i.isQuotedMsgAvailable=!1)})}return{collection:j,msg:g,key:h,highlightMsg:!0}}function b(a,b,c,e){c===void 0&&(c=1);var f=d("WAWebStateUtils").unproxy(a);if(c===1){a=f.ftsCache[b];if(a)return a;a=d("WAWebMsgCollection").MsgCollection.search(b,c,e,f.id);f.ftsCache[b]=a;var g=function(){f.ftsCache[b]=null};self.setTimeout(g,d("WAWebChatConstants").FTS_TTL);a["catch"](g);return a}return d("WAWebMsgCollection").MsgCollection.search(b,c,e,f.id)}function e(a){a=d("WAWebStateUtils").unproxy(a);a.ftsCache={}}function h(a){return!!d("WAWebChatGetters").getHasUnread(a)&&!d("WAWebChatGetters").getIsBroadcast(a)||d("WAWebChatAssignmentUtils").canAssignChats()&&a.isAssignedToMe&&a.unopenedByAssignedAgent}function f(a,b){b===void 0&&(b={});a=d("WAWebStateUtils").unproxy(a);if(c("isEmptyObject")(b))return!0;if(b.label)return a.labels!=null&&a.labels.includes(b.label);if(b.kind===d("WAWebChatSearchFilters").SearchFilters.UNREAD)return h(a);if(b.kind===d("WAWebChatSearchFilters").SearchFilters.FAVORITES)return a.isFavorite;if(b.kind===d("WAWebChatSearchFilters").SearchFilters.CONTACT)return d("WAWebContactGetters").getIsMyContact(a.contact)&&!d("WAWebContactGetters").getIsGroup(a.contact)&&!d("WAWebChatGetters").getIsBroadcast(a);if(b.kind===d("WAWebChatSearchFilters").SearchFilters.NON_CONTACT)return!d("WAWebContactGetters").getIsMyContact(a.contact)&&!d("WAWebContactGetters").getIsGroup(a.contact)&&!d("WAWebChatGetters").getIsBroadcast(a);if(b.kind===d("WAWebChatSearchFilters").SearchFilters.ASSIGNED_TO_YOU)return d("WAWebChatAssignmentUtils").canAssignChats()&&a.isAssignedToMe;a=d("WAWebFrontendChatGetters").getKind(a);return a!=null&&b.kind===d("WAWebChatSearchFilters").SearchFilters.cast(a)}g.getSearchContext=a;g.fts=b;g.clearFtsCache=e;g.matchFilter=f}),98);
__d("WAWebChatParticipantColor",["WALogger","WAMd5","WAWebContactGetters","WAWebLidMigrationUtils","WAWebStateUtils","WAWebUserPrefsGeneral","lodash"],(function(a,b,c,d,e,f,g){var h;function i(a){var b;a=d("WAWebStateUtils").unproxy(a);if(!a.colors)return;b=(b=(b=a.groupMetadata)==null?void 0:b.participants)!=null?b:[];var e=a.colors;b=Array.from(new Set(Object.keys(e)).difference(new Set(b.map(function(a){return a.id.toString()}).map(c("WAMd5")))));b.forEach(function(a){delete e[a]});b.length&&a.saveAssignedColorsDebounced()}function j(a){a=d("WAWebStateUtils").unproxy(a);a.groupMetadata&&a.listenTo(a.groupMetadata.participants,"remove reset",i);return d("WAWebUserPrefsGeneral").getGroupParticipantAssignedColor(a.id)}function k(a){if(a.isUser()){var b;return(b=d("WAWebLidMigrationUtils").toLid(a))!=null?b:a}return a}function a(a){a=d("WAWebStateUtils").unproxy(a);var b=a.colors;b&&d("WAWebUserPrefsGeneral").setGroupParticipantAssignedColor(a.id,b)}function b(a,b){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebContactGetters").getIsNewsletter(a))return 1;if(b==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["received a null sender wid when getting assigned color"]))).tags("messaging").devConsole(a).sendLogs("unexpected null sender wid for getting assigned color");return 1}var e=a.colors||(a.colors=j(a)),f;b=c("WAMd5")(k(b).toString());if(f=e[b])return f;var g={};c("lodash").forOwn(e,function(a,b){g[a]?g[a].push(b):g[a]=[b]});var i=Number.POSITIVE_INFINITY,l=17;for(var m=1;m<=l;m++)if(!g[m]){f=m;break}else g[m].length<i&&(i=g[m].length,f=m);e[b]=f;a.saveAssignedColorsDebounced();return f}g.saveAssignedColors=a;g.getAssignedColor=b}),98);
__d("WAWebEphemeralKeepInChatAbpropUtils",["WAWebABProps","WAWebRevokeMsgConstants"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("keep_in_chat_undo_duration_limit")||d("WAWebRevokeMsgConstants").REVOKE_WINDOW}function b(){return d("WAWebABProps").getABPropConfigValue("supports_keep_in_chat_in_cag")}g.getUndoKeepInChatExpiration=a;g.isKeepInChatInCAGEnabled=b}),98);
__d("WAWebChatModel",["fbt","Promise","WAAbortError","WAFilteredCatch","WAInOrderPromiseQueue","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebAck","WAWebAlarm","WAWebAppTracker","WAWebBackendErrors","WAWebBaseModel","WAWebBizAiAgentGating","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebBotGating","WAWebBotProfileCollection","WAWebChatAssignmentCollection","WAWebChatCollection","WAWebChatConstants","WAWebChatDocMsgsCollection","WAWebChatEphemerality","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebChatLinkMsgsCollection","WAWebChatLoadMessages","WAWebChatMedia","WAWebChatMediaMsgsCollection","WAWebChatMessageSearch","WAWebChatModelDerivedMethods","WAWebChatParticipantColor","WAWebChatProductMsgsCollection","WAWebChatUpdates","WAWebCmd","WAWebConnModel","WAWebConstantsDeprecated","WAWebContactCollection","WAWebContactGetters","WAWebCurrentUser","WAWebDBEphemeralMessage","WAWebDBUpdateChatTable","WAWebDBUpdateContactTable","WAWebEphemeralKeepInChatAbpropUtils","WAWebEventMsgsCollection","WAWebEventsWaitForBbEvent","WAWebFavoriteCollection","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebGroupSafetyCheckUtils","WAWebGroupType","WAWebGroupUnreadMessageType","WAWebHandleNewMsgAction","WAWebKeptMsgCollection","WAWebL10N","WAWebLidMigrationUtils","WAWebLimitSharingModelUtils","WAWebListsGatingUtils","WAWebMedia","WAWebMobilePlatforms","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgLinks","WAWebMsgModelUtils","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterMetadataCollection","WAWebNoop","WAWebNotificationBackend","WAWebOTPLoggingHelper","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebPresenceChatAction","WAWebPresenceCollection","WAWebProtobufsE2E.pb","WAWebQuotedMsgModelUtils","WAWebReachoutTimelockGatingUtils","WAWebSendSpamChatAction","WAWebStarredMsgCollection","WAWebSuperChatMsgs","WAWebTos","WAWebTosGating","WAWebTrustedContactsUtils","WAWebUnreadMentionModel","WAWebUpdateDraftMessageChatAction","WAWebUpdateLastAddOnPreviewChatAction","WAWebUserPrefsMeUser","WAWebViewOnceState","WAWebWamEnumChatAssignmentChatType","WAWebWamEnumWebcChatType","WAWebWid","asyncToGeneratorRuntime","isStringNullOrEmpty","lodash"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q;a=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.accountLid=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.unreadCount=d("WAWebBaseModel").prop(0),b.unreadDividerOffset=d("WAWebBaseModel").prop(0),b.archive=d("WAWebBaseModel").prop(),b.isReadOnly=d("WAWebBaseModel").prop(),b.isLocked=d("WAWebBaseModel").prop(),b.isAnnounceGrpRestrict=d("WAWebBaseModel").prop(),b.modifyTag=d("WAWebBaseModel").prop(),b.muteExpiration=d("WAWebBaseModel").prop(0),b.isAutoMuted=d("WAWebBaseModel").prop(!1),b.wallpaper=d("WAWebBaseModel").prop(),b.showDoodle=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.notSpam=d("WAWebBaseModel").prop(),b.pin=d("WAWebBaseModel").prop(),b.changeNumberOldJid=d("WAWebBaseModel").prop(),b.changeNumberNewJid=d("WAWebBaseModel").prop(),b.lastReceivedKey=d("WAWebBaseModel").prop(),b.capiThreadControl=d("WAWebBaseModel").prop(),b.ephemeralDuration=d("WAWebBaseModel").prop(),b.ephemeralSettingTimestamp=d("WAWebBaseModel").prop(),b.disappearingModeInitiator=d("WAWebBaseModel").prop(),b.disappearingModeTrigger=d("WAWebBaseModel").prop(),b.disappearingModeInitiatedByMe=d("WAWebBaseModel").prop(),b.createdLocally=d("WAWebBaseModel").prop(),b.pendingAction=d("WAWebBaseModel").session(),b.formattedTitle=d("WAWebBaseModel").session(),b.active=d("WAWebBaseModel").session(),b.pausedTimerId=d("WAWebBaseModel").session(),b.presenceResendTimerId=d("WAWebBaseModel").session(),b.recording=d("WAWebBaseModel").session(),b.typing=d("WAWebBaseModel").session(),b.colors=d("WAWebBaseModel").session(),b.attachMediaContents=d("WAWebBaseModel").session(),b.draftAttachMediaContentsSortTs=d("WAWebBaseModel").session(),b.isComposingPoll=d("WAWebBaseModel").session(!1),b.pttRecordingSession=d("WAWebBaseModel").session(),b.squelch=d("WAWebBaseModel").session(),b.reactionSquelch=d("WAWebBaseModel").session(),b.pendingSeenCount=d("WAWebBaseModel").session(0),b.markedUnread=d("WAWebBaseModel").session(),b.trusted=d("WAWebBaseModel").session(),b.groupSafetyChecked=d("WAWebBaseModel").session(),b.canSend=d("WAWebBaseModel").session(),b.showUnreadInTitle=d("WAWebBaseModel").session(!1),b.activeUnreadCount=d("WAWebBaseModel").session(),b.isFavorite=d("WAWebBaseModel").session(!1),b.promises=d("WAWebBaseModel").session(function(){return{}}),b.ftsCache=d("WAWebBaseModel").session(function(){return{}}),b.composeQuotedMsg=d("WAWebBaseModel").session(),b.composeQuotedMsgRemoteJid=d("WAWebBaseModel").session(),b.quotedMsgAdminGroupJid=d("WAWebBaseModel").session(),b.quotedMsgAdminGroupSubject=d("WAWebBaseModel").session(),b.quotedMsgAdminParentGroupJid=d("WAWebBaseModel").session(),b.groupMetadata=d("WAWebBaseModel").session(),b.newsletterMetadata=d("WAWebBaseModel").session(),b.presence=d("WAWebBaseModel").session(),b.mute=d("WAWebBaseModel").session(),b.contact=d("WAWebBaseModel").session(),b.mediaCount=d("WAWebBaseModel").session(0),b.linkCount=d("WAWebBaseModel").session(0),b.docCount=d("WAWebBaseModel").session(0),b.productCount=d("WAWebBaseModel").session(0),b.pendingDeleteForMeCount=d("WAWebBaseModel").session(0),b.isParentGroup=d("WAWebBaseModel").session(),b.groupType=d("WAWebBaseModel").session(),b.hasCapi=d("WAWebBaseModel").session(),b.unreadMentionsOfMe=d("WAWebBaseModel").prop(),b.unreadMentionCount=d("WAWebBaseModel").prop(),b.hasUnreadMention=d("WAWebBaseModel").prop(!1),b.archiveAtMentionViewedInDrawer=d("WAWebBaseModel").prop(!1),b.hasChatBeenOpened=d("WAWebBaseModel").prop(!1),b.tcToken=d("WAWebBaseModel").prop(),b.tcTokenTimestamp=d("WAWebBaseModel").prop(),b.tcTokenSenderTimestamp=d("WAWebBaseModel").prop(),b.msgUnsyncedButtonReplyMsgs=d("WAWebBaseModel").prop(),b.endOfHistoryTransfer=d("WAWebBaseModel").session(!1),b.endOfHistoryTransferType=d("WAWebBaseModel").prop(),b.pendingInitialLoading=d("WAWebBaseModel").prop(!1),b.lastReactionPreview=d("WAWebBaseModel").prop(),b.chatlistPreview=d("WAWebBaseModel").prop(),b.previewT=d("WAWebBaseModel").prop(),b.unopenedByAssignedAgent=d("WAWebBaseModel").session(!1),b.isAssignedToMe=d("WAWebBaseModel").session(!1),b.assignedAgent=d("WAWebBaseModel").session(),b.unreadEditTimestampMs=d("WAWebBaseModel").prop(),b.celebrationAnimationLastPlayed=d("WAWebBaseModel").prop(0),b.animationCandidateData=d("WAWebBaseModel").prop(),b.draftMessage=d("WAWebBaseModel").prop(),b.draftMessageSortTs=d("WAWebBaseModel").session(),b.ephemeralDisplayedExemptions=d("WAWebBaseModel").prop(),b.hasOpened=d("WAWebBaseModel").prop(),b.botInitialTypingIndicatorMsgId=d("WAWebBaseModel").session(),b.hasCreatedBotInvokeSystemMsg=d("WAWebBaseModel").prop(),b.bizBotSystemMsgType=d("WAWebBaseModel").prop(),b.hasRequestedWelcomeMsg=d("WAWebBaseModel").prop(!1),b.lidOriginType=d("WAWebBaseModel").prop(),b.hasPreloaded=d("WAWebBaseModel").session(!1),b.chatEntryPoint=d("WAWebBaseModel").session(null),b.forceDismissAiAgentBlockBar=d("WAWebBaseModel").session(!1),b.attempToEnableAi=d("WAWebBaseModel").session(!1),b.limitSharing=d("WAWebBaseModel").prop(),b.mmSignalSharingExpirationWindow=d("WAWebBaseModel").prop(),b.toneId=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){var b=this;a.prototype.initialize.call(this);this.$ChatImpl$p_4();this.addQueue=new(c("WAInOrderPromiseQueue"))();this.sendQueue=new(c("WAInOrderPromiseQueue"))();this.$ChatImpl$p_1=new Set();this.$ChatImpl$p_2=new Map();this.$ChatImpl$p_3=new AbortController();this.$ChatImpl$p_5();this.msgs.msgLoadState.contextLoaded=!0;this.addChild("presence",d("WAWebPresenceCollection").PresenceCollection.gadd(this.id));var e=d("WAWebMuteCollection").MuteCollection.get(this.id);e?this.addChild("mute",e):this.addChild("mute",d("WAWebMuteCollection").MuteCollection.gadd({id:this.id,expiration:this.muteExpiration,isAutoMuted:this.isAutoMuted}));this.listenTo(this.mute,"change:expiration",function(){return d("WAWebChatUpdates").updateMuteExpiration(b)});this.listenTo(this.mute,"change:isAutoMuted",function(){return d("WAWebChatUpdates").updateMuteExpiration(b)});this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd(this.id));if(this.name&&!this.contact.name){var f={name:this.name};d("WAWebChatGetters").getIsGroup(this)?this.contact.set(f):d("WAWebChatGetters").getIsNewsletter(this)?this.contact.set(f):d("WAWebDBUpdateContactTable").updateContactTable(this.contact.id,f).then(function(){b.contact.set(f)})}this.listenTo(this.contact,"change:name",function(){return d("WAWebChatGroupUtils").updateTitle(b)});this.listenTo(this.contact,"change:isContactBlocked",function(){return d("WAWebChatGroupUtils").updateCanSend(b)});this.listenTo(this,"change:id change:archive change:unreadCount change:pendingSeenCount change:muteExpiration change:isLocked",this.$ChatImpl$p_6);this.listenTo(d("WAWebFavoriteCollection").FavoriteCollection,"add remove change",function(){b.isFavorite=!!d("WAWebFavoriteCollection").FavoriteCollection.get(b.id.toString())});d("WAWebChatGetters").getIsGroup(this)&&(this.trusted=!0);this.listenTo(d("WAWebTos").TosManager,"change",function(){return d("WAWebChatGroupUtils").updateCanSend(b)});this.listenTo(this.contact,"change:privacyMode",function(){return d("WAWebChatGroupUtils").updateCanSend(b)});if(d("WAWebChatGetters").getIsGroup(this)||d("WAWebChatGetters").getIsBroadcast(this)){e=this.getGroupMetadataCollection();var g;d("WAWebChatGetters").getIsBroadcast(this)&&!e.get(this.id)&&(g=!0);var h=e.gadd(this.id);this.addChild("groupMetadata",h);this.listenTo(h,"change:stale change:announce",this.$ChatImpl$p_7);this.listenTo(h,"change:groupType",function(){b.$ChatImpl$p_6(),b.groupType=h.groupType});this.groupType=h.groupType;this.listenTo(h,"change:hasCapi",function(){b.hasCapi=h.hasCapi});this.hasCapi=h.hasCapi;this.listenTo(h.participants,"change:isAdmin bulk_add bulk_remove",this.$ChatImpl$p_7);this.listenTo(h,"change:trusted change:stale",this.isTrusted);this.listenTo(h,"change:groupSafetyCheck change:stale",this.isGroupSafetyChecked);this.listenTo(h,"change:participants change:stale change:suspended change:terminated",function(){d("WAWebChatGroupUtils").updateReadOnly(b)});this.listenTo(h.participants,"change:contact.formattedShortName",function(){return d("WAWebChatGroupUtils").updateTitle(b)});this.$ChatImpl$p_8(h);this.listenTo(h.unreadMentionMetadata.unreadMentionCollection,"add remove reset",this.$ChatImpl$p_9);this.listenTo(h.unreadMentionMetadata,"change:pendingUnreadMentionCount",this.$ChatImpl$p_9);this.$ChatImpl$p_7();d("WAWebChatGroupUtils").updateReadOnly(this);var i=this.id;this.listenTo(this,"change:isAnnounceGrpRestrict",function(){d("WAWebChatGroupUtils").updateReadOnly(b),d("WAWebChatGroupUtils").updateCanSend(b)});this.listenTo(h,"change:isParentGroup",function(){b.isParentGroup=h.isParentGroup});this.isParentGroup=h.isParentGroup;g&&e.update(i)}else if(d("WAWebChatGetters").getIsNewsletter(this)){e=this.getNewsletterMetadataCollection();i=e.gadd(this.id);this.addChild("newsletterMetadata",i);d("WAWebChatGroupUtils").updateReadOnly(this);d("WAWebChatGroupUtils").updateCanSend(this);this.listenTo(i,"change:membershipType",function(){d("WAWebChatGroupUtils").updateReadOnly(b),d("WAWebChatGroupUtils").updateCanSend(b)})}else this.listenTo(this.presence,"change:isOnline",function(){return d("WAWebPresenceChatAction").presenceOnlineChanged(b)});this.listenTo(this,"change:isReadOnly",function(){(d("WAWebChatGetters").getIsGroup(this)||d("WAWebChatGetters").getIsNewsletter(this))&&(this.isTrusted(),d("WAWebChatGroupUtils").updateCanSend(this));if(d("WAWebChatGetters").getIsGroup(this)){var a=this.getGroupMetadataCollection();a.update(this.id)}});e=this.getCollection();!!e.notSpam[this.id]&&!this.notSpam&&d("WAWebSendSpamChatAction").sendNotSpam(this)["catch"](c("WAWebNoop"));e.notSpam[this.id]=!!this.notSpam;this.notSpam||this.listenTo(this,"change:notSpam",this.$ChatImpl$p_10);d("WAWebChatGroupUtils").updateTitle(this);this.isTrusted();this.groupSafetyChecked=Boolean((i=this.groupMetadata)==null?void 0:i.groupSafetyCheck);d("WAWebChatGroupUtils").updateCanSend(this);this.listenTo(this.contact,"change:name",this.isTrusted);this.listenTo(this.msgs,"add",function(a){d("WAWebHandleNewMsgAction").handleNewMsgForChat(b,a)});this.listenTo(this.msgs,"update_sort_time",function(){return d("WAWebChatUpdates").updateSortTime(b)});this.listenTo(this.msgs,"bulk_add",function(a,c){return d("WAWebChatMedia").addMediaMsgs(b,a,c)});this.listenTo(this.msgs,"add",this.$ChatImpl$p_11);this.listenTo(this.msgs,"bulk_add",this.deregisterExpiredViewOnceBulkMessages);this.listenTo(this.msgs,"add remove change:ephemeralExpirationTimestamp change:kicState",this.$ChatImpl$p_12);this.listenTo(this.msgs,"bulk_add",function(a){a.forEach(function(a){b.$ChatImpl$p_12(a)})});this.listenTo(this.msgs,"change:kicState",function(a){var c=b.keptMsgs;c&&(d("WAWebMsgGetters").getIsKept(a)?c.add(a):c.remove(a))});this.listenTo(this,"change:msgs",function(){return d("WAWebChatMedia").resetMediaMsgs(b)});this.saveAssignedColorsDebounced=c("lodash").debounce(function(){return d("WAWebChatParticipantColor").saveAssignedColors(b)},1e3);this.listenTo(this,"change:active",this.$ChatImpl$p_13);this.pendingAction=0;this.listenTo(this,"change:t change:modifyTag",function(){return d("WAWebChatMessageSearch").clearFtsCache(b)});this.listenTo(c("WAWebL10N"),"locale_change",function(){d("WAWebChatGroupUtils").updateTitle(b)});(d("WAWebConnModel").Conn.isSMB||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebBizLabelUtils").initializeLabels(this);d("WAWebConnModel").Conn.isSMB&&this.$ChatImpl$p_14();this.$ChatImpl$p_6();this.$ChatImpl$p_15();this.id.isFbidBot()&&(d("WAWebBotProfileCollection").BotProfileCollection.get(this.id)||void d("WAWebBotProfileCollection").BotProfileCollection.find(this.id));d("WAWebBizAiAgentGating").isAiAgentAutoReplyEnabled()&&this.listenTo(this,"change:capiThreadControl change:forceDismissAiAgentBlockBar change:attempToEnableAi",function(){d("WAWebChatGroupUtils").updateCanSend(b)});this.listenTo(d("WAWebCmd").Cmd,"reachout_timelock_state_change",function(){return d("WAWebChatGroupUtils").updateCanSend(b)});this.listenTo(d("WAWebCmd").Cmd,"new_chat_message_capping_state_change",function(){return d("WAWebChatGroupUtils").updateCanSend(b)});d("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled()&&this.listenTo(this,"add:tcToken change:tcToken remove:tcToken",function(){return d("WAWebChatGroupUtils").updateCanSend(b)})};f.$ChatImpl$p_14=function(){var a=this;if(d("WAWebBizGatingUtils").chatAssignmentEnabled()){this.set("unopenedByAssignedAgent",d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getChatUnopenedStatus(this.id));var b=d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id);this.set("isAssignedToMe",this.$ChatImpl$p_16());this.set("assignedAgent",b.at(0));this.listenTo(b,"add remove change",function(){a.set("unopenedByAssignedAgent",d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getChatUnopenedStatus(a.id)),a.set("isAssignedToMe",a.$ChatImpl$p_16()),a.set("assignedAgent",b.at(0))})}};f.$ChatImpl$p_8=function(a){var b=this;if(this.unreadMentionsOfMe){var e=new Map(this.unreadMentionsOfMe.map(function(a){return[String(a.id),a]}));this.listenTo(this.msgs,"bulk_add",function(f){for(f of f){var g=f.id.toString();g=e.get(g);if(!g||!b.isUnreadMsg(f))continue;a.unreadMentionMetadata.addUnreadMentions([new(c("WAWebUnreadMentionModel"))(g)],d("WAWebGroupUnreadMessageType").UnreadMessageType.PERSISTANCE_LOAD)}})}this.unreadMentionCount!=null&&(a.unreadMentionMetadata.pendingUnreadMentionCount=this.unreadMentionCount);this.$ChatImpl$p_9()};f.$ChatImpl$p_15=function(){var a=this;this.eventMsgs=new(d("WAWebEventMsgsCollection").EventMsgsCollection)(this);this.listenTo(this.msgs,"bulk_add",function(b,c){b=b.filter(function(a){return d("WAWebFrontendMsgGetters").getAsEventCreation(a)});b.length&&a.getEventMsgs().add(b,c)});this.listenTo(this.msgs,"change:msgs",function(){if(a.eventMsgs){var b;a.eventMsgs["delete"]();void ((b=a.eventMsgs)==null?void 0:b.initialize())}})};f.$ChatImpl$p_16=function(){var a=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().getDeviceId();return d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id).getModelsArray().some(function(b){return b.deviceId===a})};f.$ChatImpl$p_9=function(){d("WAWebChatGetters").getIsGroup(this)&&this.groupMetadata&&(this.hasUnreadMention=this.groupMetadata.unreadMentionMetadata.getUnreadMentionCount()>0)};f.set=function(b,c,d){typeof b==="string"?(b==="muteExpiration"&&this.mute&&this.mute.setMute(c),b==="isAutoMuted"&&this.mute&&this.mute.setAutoMuted(c)):Object.prototype.hasOwnProperty.call(b,"muteExpiration")&&this.mute&&this.mute.setMute(b.muteExpiration,b.isAutoMuted);a.prototype.set.call(this,b,c,d);return this};f.equals=function(a){return this.id.equals(a==null?void 0:a.id)};f.addPendingAction=function(a){var b=this,c=function(){b.decPending()};a.then(c,c);this.pendingAction++};f.decPending=function(){this.pendingAction>0?this.pendingAction--:(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat:onPendingActionUpdate pendingAction value is invalid"]))),this.pendingAction=0)};f.$ChatImpl$p_5=function(){if(d("WAWebFrontendChatGetters").getHasDraftMessage(this)){var a;this.draftMessageSortTs=(a=this.draftMessage)==null?void 0:a.timestamp}else this.draftMessageSortTs!=null&&(this.draftMessageSortTs=null)};f.$ChatImpl$p_4=function(){try{d("WAWebLidMigrationUtils").shouldHaveAccountLid(this.id)&&this.accountLid==null&&(d("WAWebLidMigrationUtils").logLidMetadata(),d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["created chat model without account_lid. isEmployee: ",", chat id: ",""])),d("WAWebCurrentUser").isEmployee(),this.id.toLogString()).sendLogs("chat-model-without-account-lid").tags("missing-lid"))}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["WAWebChatModel: failed to validate lid chat: ",""])),a)}};f.$ChatImpl$p_13=function(){var a=this;d("WAWebChatGetters").getIsGroup(this)&&this.active&&(this.squelch=c("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE,this.reactionSquelch=c("WAWebConstantsDeprecated").SQUELCH_RESET_VALUE,this.hasChatBeenOpened=!0);this.presence.chatActive=this.active;if(!this.active){this.$ChatImpl$p_5();this.getCollection().sort();this.deregisterExpiredViewOnceBulkMessages(this.msgs);var b=Array.from(this.$ChatImpl$p_1);void d("WAWebDBEphemeralMessage").removeExpiredMessagesFromHistory(b).then(function(){var c=b.map(function(a){return a.id.toString()});c.length>0&&(d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview(c),d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a.id.toString(),c)))});this.$ChatImpl$p_1.forEach(function(b){a.$ChatImpl$p_1["delete"](b),b["delete"]({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})})}};f.$ChatImpl$p_10=function(){var a=this.getCollection();a.notSpam[this.id]=this.notSpam;this.isTrusted();this.notSpam&&this.stopListening(this,"change:notSpam")};f.senderMsgCount=function(){return this.getAllMsgs().filter(function(a){return!d("WAWebMsgGetters").getIsSentByMe(a)&&!d("WAWebMsgGetters").getIsNotification(a)}).length};f.isCAGAdmin=function(){var a;a=(a=this.groupMetadata)==null?void 0:a.participants.iAmAdmin();return a!=null?a&&d("WAWebFrontendChatGetters").getIsCAG(this):!1};f.hasMaybeSentMsgToChat=function(){return this.getAllMsgs().some(function(a){return d("WAWebMsgGetters").getIsSentByMe(a)})};f.isTrusted=function(){var a=!1;if(d("WAWebChatGetters").getIsGroup(this)){var b;a=this.isReadOnly||this.notSpam||((b=this.groupMetadata)==null?void 0:b.isTrusted())}else d("WAWebChatGetters").getIsBroadcast(this)?a=!0:d("WAWebChatGetters").getIsNewsletter(this)?a=!0:d("WAWebChatGetters").getIsUser(this)&&(a=this.notSpam||d("WAWebContactGetters").getIsMyContact(this.contact));a!==!0&&this.hasMaybeSentMsgToChat()&&(a=!0);d("WAWebChatGetters").getIsGroup(this)&&a!==this.trusted&&d("WAWebGroupSafetyCheckUtils").handleIsTrustedChangeForGroupSafety(this,Boolean(a));return this.trusted=Boolean(a)};f.isGroupSafetyChecked=function(){var a=!1;if(this.groupMetadata){var b;a=(b=this.groupMetadata)==null?void 0:b.groupSafetyCheck;a!==this.groupSafetyChecked&&d("WAWebGroupSafetyCheckUtils").handleGroupSafetyCheckStateUpdate(this,Boolean(this.trusted),a)}return this.groupSafetyChecked=Boolean(a)};f.isSuspendedOrTerminated=function(){if(d("WAWebChatGetters").getIsGroup(this)){var a;return Boolean((a=this.groupMetadata)==null?void 0:a.isSuspendedOrTerminated())}else if(d("WAWebChatGetters").getIsNewsletter(this)){return Boolean((a=this.newsletterMetadata)==null?void 0:a.isSuspendedOrTerminated)}return!1};f.isSuspended=function(){if(d("WAWebChatGetters").getIsGroup(this)){var a;return Boolean((a=this.groupMetadata)==null?void 0:a.suspended)}else if(d("WAWebChatGetters").getIsNewsletter(this)){return Boolean((a=this.newsletterMetadata)==null?void 0:a.suspended)}return!1};f.canBlockFromNotification=function(){return d("WAWebABProps").getABPropConfigValue("block_from_notification")&&d("WAWebChatGetters").getIsUser(this)&&!this.isTrusted()};f.canToggleFavorite=function(){var a;if(d("WAWebListsGatingUtils").isListsEnabled())return!0;return this.isFavorite?!0:(d("WAWebChatGetters").getIsGroup(this)&&((a=this.groupMetadata)==null?void 0:a.groupType)!==d("WAWebGroupType").GroupType.COMMUNITY&&((a=this.groupMetadata)==null?void 0:a.groupType)!==d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&((a=this.groupMetadata)==null?void 0:a.participants.iAmMember())&&!((a=this.groupMetadata)!=null&&a.isSuspendedOrTerminated())||d("WAWebFrontendChatGetters").getKind(this)===d("WAWebChatFlowTypes").ChatKindType.Chat&&d("WAWebContactGetters").getIsMyContact(this.contact)&&!d("WAWebContactGetters").getId(this.contact).isBot()&&!d("WAWebContactGetters").getIsMe(this.contact))&&this.trusted};f.title=function(){var a;return d("WAWebChatGetters").getIsGroup(this)?(a=this.formattedTitle)!=null?a:h._(/*BTDS*/"Unknown subject").toString():this.formattedTitle};f.getTcToken=function(){return this.tcToken==null||this.tcTokenTimestamp==null?null:d("WAWebTrustedContactsUtils").isTokenExpired(this.tcTokenTimestamp,d("WAWebTrustedContactsUtils").TcTokenMode.Receiver)?null:this.tcToken};f.shouldShowUnreadDivider=function(){return d("WAWebFrontendChatGetters").getShouldShowUnreadDivider(this)};f["delete"]=function(){a.prototype["delete"].call(this);this.getCollection().remove(this.id);this.$ChatImpl$p_3.abort();this.presence["delete"]();d("WAWebCmd").Cmd.closeChat(this);this.groupMetadata&&this.groupMetadata["delete"]();this.mediaMsgs&&this.mediaMsgs["delete"]();this.linkMsgs&&this.linkMsgs["delete"]();this.docMsgs&&this.docMsgs["delete"]();this.productMsgs&&this.productMsgs["delete"]();this.eventMsgs&&this.eventMsgs["delete"]();var b=this.starredMsgs;b&&(b["delete"](),b.stopListening(),b.reset());d("WAWebChatGetters").clearChatGetterCacheFor(this);d("WAWebFrontendChatGetters").clearFrontendChatGetterCacheFor(this)};f.isDirty=function(){return this.unreadCount!==0};f.canPin=function(){var a;if(this.archive)return!1;a=((a=this.promises)==null||(a=a.setArchive)==null?void 0:a.archive)===!0;return!a};f.canArchive=function(){return d("WAWebChatGetters").getIsBroadcast(this)?!1:!0};f.supportsChatLock=function(){return!0};f.hasUnreadEdit=function(){return this.unreadEditTimestampMs!=null};f.setComposeContents=function(a){var b,c=a.text;if(((b=a.text)==null?void 0:b.trim())===""){c=(b=a.text)==null?void 0:b.trim()}b={text:c,ctwaContext:a.ctwaContext,ctwaContextLinkData:a.ctwaContextLinkData,timestamp:a.timestamp,omittedUrl:a.omittedURL};void d("WAWebUpdateDraftMessageChatAction").updateDraftMessageChat(this.id,b)};f.getComposeContents=function(){if(!this.draftMessage)return;var a={timestamp:this.draftMessage.timestamp,text:this.draftMessage.text},b=this.draftMessage,c=b.ctwaContext,d=b.ctwaContextLinkData;b=b.omittedUrl;b!=null&&(a.omittedURL=b);c!=null&&(a.ctwaContext=c);d!=null&&(a.ctwaContextLinkData=d);return a};f.setAttachMediaContents=function(a){this.attachMediaContents=a,this.draftAttachMediaContentsSortTs=Boolean(a)?d("WATimeUtils").unixTime():null};f.isComposingWithUnsavedChanges=function(){return this.isComposingPoll};f.isBusinessGroup=function(){var a;a=(a=this.groupMetadata)==null?void 0:a.participants.getAdmins();if(!a)return!1;for(a of a){var b=d("WAWebContactCollection").ContactCollection.get(a.id);if(b!=null&&b.isBusiness)return!0}return!1};f.isCAG=function(){return d("WAWebFrontendChatGetters").getIsCAG(this)};f.preload=function(){this.msgs.length===1&&d("WAWebChatLoadMessages").loadEarlierMsgs(this)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["catch"](function(a){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["chat:preload failed\n",""],["chat:preload failed\\n",""])),a)})};f.onEmptyMRM=function(){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:Chat:removeMsg 0 messages left, querying..."]))),d("WAWebChatLoadMessages").loadEarlierMsgs(this)["catch"](d("WAFilteredCatch").filteredCatch(d("WAWebBackendErrors").E404,c("WAWebNoop")))["catch"](function(a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["chat:onEmptyMRM failed\n",""],["chat:onEmptyMRM failed\\n",""])),a)})};f.deleteMsgs=function(a,b){this.deleteMsgsBeforeMsgInclusive(void 0,!a,b)};f.deleteMsgsBeforeMsgInclusive=function(a,b,e){b===void 0&&(b=!1);var f;if(!a)f=this.msgs.length;else if(!this.msgs.get(a.id))return;else f=this.msgs.indexOf(a);a=function(a,g,h){return!c("isStringNullOrEmpty")(e)&&!d("WAWebMsgModelUtils").msgMatchesType(a,e)||a.msgChunk===this.msgs&&g>f||b&&a.star||d("WAWebMsgGetters").getIsInitialE2ENotification(a)&&b};this.deleteMsgsPartial(a,!0)};f.deleteMsgsPartial=function(a,b){var e=this;b===void 0&&(b=!1);var f=this.unreadCount;this.getAllCMCs().forEach(function(c){var f=c.filter(function(b,c,d){return!a.apply(e,[b,c,d])});c.remove(f,void 0,b);f.forEach(function(a){d("WAWebMsgGetters").getIsAuthenticationMessage(a)&&void d("WAWebOTPLoggingHelper").logOTPMessageDeleted(d("WAWebMsgDataFromModel").msgDataFromMsgModel(a)),a["delete"]()})});c("lodash").clone(this.msgChunks).forEach(function(a){a.length===0&&e.removeMsgsCollection(a)});if(this.msgs.length>0){var g=f>this.msgs.length?this.msgs.length:f;d("WAWebDBUpdateChatTable").updateChatTable(this.id,{unreadCount:g}).then(function(){e.unreadCount=g,e.msgs.msgLoadState.noEarlierMsgs=e.endOfHistoryTransferType!==d("WAWebChatConstants").ConversationEndOfHistoryTransferModelPropType.INCOMPLETE})}};f.deleteMessages=function(a){var b=function(b,c,d){return!a.includes(b.id.toString())};this.deleteMsgsPartial(b,!0);this.getAllMsgs().length===0&&d("WAWebChatLoadMessages").loadEarlierMsgs(this);void d("WAWebLimitSharingModelUtils").createLimitSharingMsgOnChatClear(this.id)};f.getLastMsgKeyForAction=function(){var a=this.msgs.last(),b;a&&(!this.lastReceivedKey||a.id.fromMe&&a.local&&a.ack===d("WAWebAck").ACK.CLOCK?b=a.id:b=this.lastReceivedKey);return b?b:void 0};f.getWebcChatType=function(){var a=d("WAWebFrontendChatGetters").getKind(this);if(a!=null)switch(a){case d("WAWebChatFlowTypes").ChatKindType.Chat:return d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.INDIVIDUAL;case d("WAWebChatFlowTypes").ChatKindType.Group:return d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.GROUP;case d("WAWebChatFlowTypes").ChatKindType.Broadcast:return d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.BROADCAST_LIST;case d("WAWebChatFlowTypes").ChatKindType.Newsletter:return d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.NEWSLETTER;case d("WAWebChatFlowTypes").ChatKindType.Community:return d("WAWebWamEnumWebcChatType").WEBC_CHAT_TYPE.COMMUNITY}else throw new TypeError("Invalid Chat.kind "+String(a))};f.getMdChatAssignmentChatType=function(){return d("WAWebChatModelDerivedMethods").getMdChatAssignmentChatTypeFn(this)};f.getChatAssignmentChatType=function(){var a=d("WAWebFrontendChatGetters").getKind(this);if(a!=null)switch(a){case d("WAWebChatFlowTypes").ChatKindType.Chat:return d("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.INDIVIDUAL;case d("WAWebChatFlowTypes").ChatKindType.Group:return d("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.GROUP;case d("WAWebChatFlowTypes").ChatKindType.Broadcast:case d("WAWebChatFlowTypes").ChatKindType.Community:return d("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.COMMUNITY;case d("WAWebChatFlowTypes").ChatKindType.Newsletter:return d("WAWebWamEnumChatAssignmentChatType").CHAT_ASSIGNMENT_CHAT_TYPE.CHANNEL}else throw new TypeError("Invalid Chat.kind "+String(a))};f.deregisterExpiredViewOnceBulkMessages=function(a){a.forEach(this.$ChatImpl$p_11)};f.$ChatImpl$p_11=function(a){d("WAWebViewOnceState").isExpired(a.safe())&&(d("WAWebAppTracker").AppTracker.mark(d("WAWebAppTracker").AppTrackerType.PurgeViewOnce),d("WAWebMedia").deregisterMsg(a))};f.$ChatImpl$p_12=function(a){var e=this;c("WAWebAlarm").clearTimeout(this.$ChatImpl$p_2.get(a));this.$ChatImpl$p_2["delete"](a);this.$ChatImpl$p_1["delete"](a);var f=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(a);if(f==null||!this.msgs.includes(a)||d("WAWebMsgGetters").getIsKept(a))return;var g=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){e.$ChatImpl$p_2["delete"](a),!e.active?(yield d("WAWebDBEphemeralMessage").removeExpiredMessagesFromHistory([a]),d("WAWebUpdateLastAddOnPreviewChatAction").deleteModelsForLastAddOnPreview([a.id.toString()]),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.id.toString(),[a.id.toString()])),a["delete"]({skipUpdatingSortTime:!0,doNotResetLastReceived:!0})):e.$ChatImpl$p_1.add(a)});return function(){return c.apply(this,arguments)}}();if(a.isExpired())g();else{f=c("WAWebAlarm").setGlobalTimeout(function(){return void g()},f*1e3);this.$ChatImpl$p_2.set(a,f)}};f.isUnreadMsg=function(a){var b=this.msgs.filter(function(a){return d("WAWebMsgGetters").getIsUnreadType(a)});return b.includes(a,b.length-this.unreadCount)};f.isActiveUnreadMsg=function(a){var b=this.msgs.filter(function(a){return d("WAWebMsgGetters").getIsUnreadType(a)});return b.includes(a,b.length-this.activeUnreadCount)};f.setCelebrationAnimationLastPlayed=function(){this.animationCandidateData&&this.celebrationAnimationLastPlayed<this.animationCandidateData.msgTimestampSeconds&&(this.celebrationAnimationLastPlayed=this.animationCandidateData.msgTimestampSeconds)};f.setChatWallpaper=function(a){this.wallpaper=a;return d("WAWebDBUpdateChatTable").updateChatTable(this.id,{wallpaper:a})};f.setShowDoodle=function(a){this.showDoodle=a;return d("WAWebDBUpdateChatTable").updateChatTable(this.id,{showDoodle:a})};f.setCapiThreadControl=function(a){this.capiThreadControl=a;this.forceDismissAiAgentBlockBar=!1;a===d("WAWebProtobufsE2E.pb").Message$CloudAPIThreadControlNotification$CloudAPIThreadControl.CONTROL_PASSED&&(this.unreadCount=1,d("WAWebNotificationBackend").showAiHandoffNotification(this)["catch"](d("WAAbortError").catchAbort(function(a){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[Maiba] Aborted notification ",""])),a)})));return d("WAWebDBUpdateChatTable").updateChatTable(this.id,{capiThreadControl:a,unreadCount:this.unreadCount})};f.setForceDismissAiAgentBlockingBar=function(a){this.forceDismissAiAgentBlockBar=a};f.setAttempToEnableAi=function(a){this.attempToEnableAi=a};f.getAttempToEnableAi=function(){return this.attempToEnableAi};f.setAnimationCandidateData=function(a){this.animationCandidateData=a};f.$ChatImpl$p_7=function(){var a=this,b=this.groupMetadata;if(d("WAWebChatGetters").getIsGroup(this)&&b!=null&&!b.stale){var c=!b.participants.iAmAdmin()&&b.announce;this.isAnnounceGrpRestrict!==c&&(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["chat:_updateIsAnnounceGrpRestrict:old ",", new: ",""])),this.isAnnounceGrpRestrict,c),d("WAWebDBUpdateChatTable").updateChatTable(this.id,{isAnnounceGrpRestrict:c}).then(function(){return a.isAnnounceGrpRestrict=c}))}};f.sortMsgs=function(a){a=a.map(function(a){var b=c("WANullthrows")(a.msgChunk);return{msg:a,chunkT:c("WANullthrows")(b.at(0)).t,index:b.indexOf(a)}});return a.sort(function(a,b){return a.chunkT===b.chunkT?a.index-b.index:a.chunkT-b.chunkT}).map(function(a){return a.msg})};f.waitForChatLoading=function(){var a=this,d=(q||(q=b("Promise"))).resolve();this.pendingInitialLoading&&(d=c("WAWebEventsWaitForBbEvent")(this,"change:pendingInitialLoading",function(){return!a.pendingInitialLoading}));return d};f.unstarAll=function(){var a=this.getAllMsgs();a.forEach(function(a){a&&(a.star=!1)});d("WAWebStarredMsgCollection").removeStarredMsgs(a)};f.$ChatImpl$p_6=function(){var a,b=!!this.muteExpiration;if(this.archive){this.showUnreadInTitle=!1;return}if(this.isLocked){this.showUnreadInTitle=!1;return}if(this.id.isBot()&&!d("WAWebBotGating").isBotEnabled()){this.showUnreadInTitle=!1;return}if(d("WAWebFrontendChatGetters").getOptimisticUnreadCount(this)<=0){this.showUnreadInTitle=!1;return}if(!d("WAWebChatGetters").getIsGroup(this)){this.showUnreadInTitle=!b;return}if(((a=this.groupMetadata)==null?void 0:a.groupType)===d("WAWebGroupType").GroupType.COMMUNITY){this.showUnreadInTitle=!1;return}if(!b){this.showUnreadInTitle=!0;return}if(!this.msgs||this.msgs.length===0){this.showUnreadInTitle=!1;return}a=!1;b=this.msgs;var c=d("WAWebFrontendChatGetters").getOptimisticUnreadCount(this);c=Math.max(0,b.length-c);for(;c<b.length;c++){var e=this.msgs.at(c);if(!e)continue;var f=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(f!=null&&(e.isMentioned(f)||d("WAWebQuotedMsgModelUtils").isQuotedMsg(e,f))){f=this.getCollection().get(d("WAWebMsgGetters").getSender(e));if(!f||!f.muteExpiration){a=!0;break}}}this.showUnreadInTitle=a};f.removeFromCollection=function(a){a.star&&d("WAWebStarredMsgCollection").removeStarredMsgs([a]);d("WAWebMsgGetters").getIsMedia(a)&&this.mediaMsgs?this.mediaMsgs.remove(a):d("WAWebMsgLinks").getLinksFromMsg(a).length>0&&this.linkMsgs?this.linkMsgs.remove(a):d("WAWebFrontendMsgGetters").getAsDoc(a)&&this.docMsgs?this.docMsgs.remove(a):d("WAWebFrontendMsgGetters").getAsProduct(a)!=null&&this.productMsgs?this.productMsgs.remove(a):d("WAWebFrontendMsgGetters").getAsEventCreation(a)!=null&&this.eventMsgs&&this.eventMsgs.remove(a);d("WAWebMsgGetters").getIsKept(a)&&this.keptMsgs&&this.keptMsgs.remove(a);if(d("WAWebChatGetters").getIsGroup(d("WAWebFrontendMsgGetters").getChat(a))){var b;(b=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata)==null||b.unreadMentionMetadata.removeUnreadMentions(a.id.toString())}};f.getMediaMsgs=function(){this.mediaMsgs||(this.mediaMsgs=new(c("WAWebChatMediaMsgsCollection"))());return this.mediaMsgs};f.getLinkMsgs=function(){this.linkMsgs||(this.linkMsgs=new(c("WAWebChatLinkMsgsCollection"))());return this.linkMsgs};f.getDocMsgs=function(){this.docMsgs||(this.docMsgs=new(c("WAWebChatDocMsgsCollection"))());return this.docMsgs};f.getEventMsgs=function(){this.eventMsgs||(this.eventMsgs=new(d("WAWebEventMsgsCollection").EventMsgsCollection)(this));return this.eventMsgs};f.getParticipantCount=function(){var a;return((a=this.groupMetadata)==null?void 0:a.participants.length)||1};f.iAmAdmin=function(){return this.groupMetadata?this.groupMetadata.participants.iAmAdmin():!1};f.getProductMsgs=function(){this.productMsgs||(this.productMsgs=new(c("WAWebChatProductMsgsCollection"))());return this.productMsgs};f.getStarredMsgs=function(){var a=this,b=this.starredMsgs;b||(this.starredMsgs=b=new(d("WAWebStarredMsgCollection").StarredMsgCollection)(),this.starredMsgs.add(d("WAWebStarredMsgCollection").AllStarredMsgsCollection.filter(function(b){return d("WAWebFrontendMsgGetters").getChat(b)===a})));return b};f.getKeptMsgs=function(){var a=this.keptMsgs;a||(this.keptMsgs=a=new(d("WAWebKeptMsgCollection").KeptMsgCollection)(),this.keptMsgs.add(this.msgs.filter(function(a){return d("WAWebMsgGetters").getIsKept(a)})));return a};f.hasKeptMsgs=function(){return this.msgs.some(function(a){return d("WAWebMsgGetters").getIsKept(a)})};f.canSendPolls=function(){return d("WAWebChatModelDerivedMethods").canSendPolls(this)};f.canInvokeBot=function(){var a;if(!d("WAWebBotGating").isBotEnabled())return!1;if(d("WAWebChatGetters").getIsNewsletter(this))return!1;if(d("WAWebContactGetters").getIsMe(this.contact))return!1;if(d("WAWebFrontendChatGetters").getIsCapiHostedGroup(this))return!1;if(this.id.isBot())return!1;if(d("WAWebChatEphemerality").isEphemeralSettingOn(this))return!1;if(((a=this.contact.businessProfile)==null?void 0:a.isBizBot3p)===!0||((a=this.contact.businessProfile)==null?void 0:a.isBizBot1p)===!0)return!1;if(d("WAWebTosGating").shouldBlockBotInvokeAsTosNotAvailable())return!1;return!d("WAWebMobilePlatforms").isSMB()&&this.contact.isBusiness?!1:!0};f.getAbortController=function(){return this.$ChatImpl$p_3};f.getDeleteSignal=function(){return this.getAbortController().signal};f.getCollection=function(){return d("WAWebChatGetters").getIsNewsletter(this)?c("WAWebNewsletterCollection"):d("WAWebChatCollection").ChatCollection};f.getGroupMetadataCollection=function(){return c("WAWebGroupMetadataCollection")};f.getNewsletterMetadataCollection=function(){return c("WAWebNewsletterMetadataCollection")};f.updateBotInvokeSystemMsgCreated=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebDBUpdateChatTable").updateChatTable(this.id,{hasCreatedBotInvokeSystemMsg:!0}),this.hasCreatedBotInvokeSystemMsg=!0});function c(){return a.apply(this,arguments)}return c}();f.updateBizBotSysMsgCreated=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebDBUpdateChatTable").updateChatTable(this.id,{bizBotSystemMsgType:a}),this.bizBotSystemMsgType=a});function c(b){return a.apply(this,arguments)}return c}();f.supportsKIC=function(){return d("WAWebFrontendChatGetters").getIsCAG(this)&&!d("WAWebEphemeralKeepInChatAbpropUtils").isKeepInChatInCAGEnabled()?!1:!0};return e}(c("WAWebSuperChatMsgs"));a.Proxy="chat";a.idClass=c("WAWebWid");e=d("WAWebBaseModel").defineModel(a);g.Chat=e}),226);
__d("WAWebChatModelDerivedMethods",["WAWebABProps","WAWebChatFlowTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebFrontendChatGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebPollsGatingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumMdChatAssignmentChatType"],(function(a,b,c,d,e,f,g){function a(a){a=d("WAWebFrontendChatGetters").getKind(a);if(a!=null)switch(a){case d("WAWebChatFlowTypes").ChatKindType.Chat:return d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.INDIVIDUAL;case d("WAWebChatFlowTypes").ChatKindType.Group:return d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.GROUP;case d("WAWebChatFlowTypes").ChatKindType.Broadcast:return d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.BROADCAST_LIST;case d("WAWebChatFlowTypes").ChatKindType.Newsletter:return d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.CHANNEL;case d("WAWebChatFlowTypes").ChatKindType.Community:return d("WAWebWamEnumMdChatAssignmentChatType").MD_CHAT_ASSIGNMENT_CHAT_TYPE.COMMUNITY}else throw new TypeError("Invalid Chat.kind "+String(a))}function b(a){return a.type!==d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&(a.type!==d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE||a.subtype==="chat_assignment"||a.subtype==="chat_assignment_unassign"||a.subtype==="limit_sharing_system_message"||a.subtype==="change_username")&&a.type!==d("WAWebMsgType").MSG_TYPE.REACTION&&a.type!==d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.type!==d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT&&a.subtype!=="newsletter_admin_context_card"&&a.subtype!=="newsletter_privacy"&&!a.pendingDeleteForMe&&a.botPluginReferenceIndex==null&&d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST,a.viewMode)}function c(a){if(d("WAWebChatGetters").getIsNewsletter(a))return d("WAWebNewsletterGatingUtils").isNewsletterPollsCreationEnabled();var b=a.groupMetadata;if(b==null)return!0;return d("WAWebFrontendChatGetters").getIsCAG(a)?d("WAWebChatGroupUtils").getGroupParticipantsCount(b)<=d("WAWebABProps").getABPropConfigValue("pnh_cag_disable_polls_group_size")&&d("WAWebPollsGatingUtils").isPollsCreationEnabledInCags():!0}g.getMdChatAssignmentChatTypeFn=a;g.isPreviewMessage=b;g.canSendPolls=c}),98);
__d("WAWebChatMsgsCollectionComparator",[],(function(a,b,c,d,e,f){function a(a,b){return a.serverId==null||b.serverId==null?0:a.serverId-b.serverId}f.msgComparator=a}),66);
__d("WAWebChatMsgsCollection",["invariant","WAWebBaseCollection","WAWebBaseModel","WAWebBizSystemMsgSubtypes","WAWebChatMsgsCollectionComparator","WAWebCommonCTWALogging","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgModel","WAWebViewModeUtils"],(function(a,b,c,d,e,f,g,h){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.noEarlierMsgs=d("WAWebBaseModel").prop(),b.isLoadingEarlierMsgs=d("WAWebBaseModel").prop(),b.isLoadingRecentMsgs=d("WAWebBaseModel").prop(),b.isLoadingAroundMsgs=d("WAWebBaseModel").prop(),b.isRepairingMsgHistory=d("WAWebBaseModel").prop(),b.contextLoaded=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="msgLoad";var i=d("WAWebBaseModel").defineModel(a);b=function(a){function b(){var b;b=a.call(this)||this;b.triggerChangeLast=function(a,c,d){var e=b.last();if(b.$ChatMsgsCollection$p_1!==e){b.$ChatMsgsCollection$p_1=e;var f=!1,g=!!d.add;d=!!d.remove;a!=null&&c.includes(a)&&g&&!d&&(f=!0);b.trigger("change:last",e,f)}};b.msgLoadState=new i({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1,isRepairingMsgHistory:!1});b.listenTo(b,"add remove",b.triggerChangeLast);b.listenTo(b,"sort reset",function(a,c){b.triggerChangeLast(null,a,c!=null?c:{})});return b}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c["delete"]=function(){this.stopListening(),a.prototype["delete"].call(this),this.msgLoadState["delete"]()};c.last=function(){return a.prototype.getModelsArray.call(this).findLast(function(a){return d("WAWebViewModeUtils").isMessageExistingInChat(a)})};c.add=function(b,c){var e=this,f;!Array.isArray(b)?f=b:b.length===1&&(f=b[0]);var g=[];if(f!=null&&(d("WAWebMsgGetters").getIsInitialE2ENotification(f)||d("WAWebMsgGetters").getIsDisappearingModeSystemMessage(f))){var h=this.some(function(a){return d("WAWebMsgGetters").getIsInitialE2ENotification(a)});d("WAWebMsgGetters").getIsInitialE2ENotification(f)&&(h||(g=a.prototype.add.call(this,b,babelHelpers["extends"]({},c,{at:0}))));if(d("WAWebMsgGetters").getIsDisappearingModeSystemMessage(f)){var i=this.some(function(a){return d("WAWebMsgGetters").getIsDisappearingModeSystemMessage(a)});if(!i){i=h?1:0;g=a.prototype.add.call(this,b,babelHelpers["extends"]({},c,{at:i}))}}g&&this.trigger("insert_msgs",g,c)}else{h=f!=null?d("WAWebMsgGetters").getSubtype(f):null;i=h!=null&&d("WAWebBizSystemMsgSubtypes").COEX_MSG_SUBTYPES.includes(h)&&((i=this.last())==null?void 0:i.subtype)===h;i||(g=a.prototype.add.call(this,b,c))}if(g.length>0){h=d("WAWebMsgCollection").MsgCollection.add(g.filter(Boolean),c);h.forEach(function(a){a&&e.isModel(a)&&(a.msgChunk=e)});this.trigger("bulk_add",g,c);h.forEach(function(a){return d("WAWebCommonCTWALogging").logDeepConversation(a)})}return g};c.remove=function(b,c,d){c===void 0&&(c={});d===void 0&&(d=!1);b=a.prototype.remove.call(this,b,c);var e=c?c.silent:!1,f=b.filter(function(a){return!!a});f.length&&e!==!0&&(this.trigger("remove_msgs",f,c),d||this.trigger("update_sort_time"));return b};c.replace=function(a){var b=this;this.msgLoadState=a.msgLoadState;this.loadRecentPromise=a.loadRecentPromise;this.loadEarlierPromise=a.loadEarlierPromise;this.loadAroundPromise=a.loadAroundPromise;a=a.getModelsArray();this.set(a,{silent:!0,merge:!1});a.forEach(function(a){b.isModel(a)&&(a.msgChunk=b)});this.trigger("bulk_add",a)};c.onMsgLoadStateChange=function(a){var b=this,c,d=function(){a()},e=function(){c!=null||h(0,56282);c.off("change",d);var e=b.msgLoadState;e.on("change",d);c=e;a()};c=this.msgLoadState;c.on("change",d);this.on("bulk_add",e);var f=function(){c!=null||h(0,56281),b.off("bulk_add",e),c.off("change",d)};return function(){var a=f;a&&(f=null,a())}};return b}(d("WAWebBaseCollection").BaseCollection);b.model=d("WAWebMsgModel").Msg;b.comparator=d("WAWebChatMsgsCollectionComparator").msgComparator;g.ChatMsgsCollection=b}),98);
__d("WAWebWallpaper",["fbt","WAWebUIRefreshGatingUtils"],(function(a,b,c,d,e,f,g,h){var i="default_chat_wallpaper",j="0.06",k="0.4",l="0.1",m="data-asset-chat-background-dark",n="data-asset-chat-background-beige",o={"#BBE4E5":{doodle:"dark",opacity:"0.42",getColorName:function(){return h._(/*BTDS*/"Cruise")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cruise, Color hex: #BBE4E5, hue: green")}},"#AED8C7":{doodle:"dark",opacity:"0.3",getColorName:function(){return h._(/*BTDS*/"Scandal")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Scandal, Color hex: #AED8C7, hue: green")}},"#7ACBA5":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Monte carlo")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Monte Carlo, Color hex: #7ACBA5, hue: green")}},"#CBDAEC":{doodle:"dark",opacity:"0.42",getColorName:function(){return h._(/*BTDS*/"Hawkes blue")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Hawkes blue, Color hex: #CBDAEC, hue: blue")}},"#66D2D5":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Downy")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Downy, Color hex: #66D2D5, hue: green")}},"#63BDCF":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Seagull")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Seagull, Color hex: #63BDCF, hue: blue")}},"#D6D0F0":{doodle:"dark",opacity:"0.36",getColorName:function(){return h._(/*BTDS*/"Quartz")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Quartz, Color hex: #D6D0F0, hue: White")}},"#CECECE":{doodle:"dark",opacity:"0.36",getColorName:function(){return h._(/*BTDS*/"Very light grey")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Very light grey, Color hex: #CECECE, hue: grey")}},"#D1DABE":{doodle:"dark",opacity:"0.36",getColorName:function(){return h._(/*BTDS*/"Orinoco")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Orinoco, Color hex: #D1DABE, hue: green")}},"#E6E1B1":{doodle:"dark",opacity:"0.42",getColorName:function(){return h._(/*BTDS*/"Tusk")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tusk, Color hex: #E6E1B1, hue: green")}},"#FEEFA9":{doodle:"light",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Cape honey")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cape honey, Color hex: #FEEFA9, hue: Yellow")}},"#FED297":{doodle:"dark",opacity:"0.42",getColorName:function(){return h._(/*BTDS*/"Caramel")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Caramel, Color hex: #FED297, hue: Yellow")}},"#FD9A9B":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Rose bud")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Rose bud, Color hex: #FD9A9B, hue: Red")}},"#FD6769":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Bittersweet")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Bittersweet, Color hex: #FD6769, hue: Orange")}},"#FB4668":{doodle:"dark",opacity:"0.26",getColorName:function(){return h._(/*BTDS*/"Radical red")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Radical red, Color hex: #FB4668, hue: Red")}},"#922040":{doodle:"dark",opacity:"0.17",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Mandarian orange")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Mandarian orange, Color hex: #922040, hue: Orange")}},"#DC6E4F":{doodle:"dark",opacity:"0.2",getColorName:function(){return h._(/*BTDS*/"Flamingo")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Flamingo, Color hex: #DC6E4F, hue: Orange")}},"#644D52":{doodle:"dark",opacity:"0.13",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Buccaneer")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Buccaneer, Color hex: #644D52, hue: Red")}},"#517E7E":{doodle:"dark",opacity:"0.13",getColorName:function(){return h._(/*BTDS*/"Breaker bay")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Breaker bay, Color hex: #517E7E, hue: green")}},"#3190BB":{doodle:"dark",opacity:"0.13",getColorName:function(){return h._(/*BTDS*/"Pelorous")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Pelorous, Color hex: #3190BB, hue: blue")}},"#35558A":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Tory blue")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tory blue, Color hex: #35558A, hue: blue")}},"#55626F":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Fiord")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Fiord, Color hex: #55626F, hue: blue")}},"#1D2326":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Cinder")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cinder, Color hex: #1D2326, hue: grey")}},"#301E34":{doodle:"dark",opacity:"0.1",invertTransparentWallpaperColors:!0,getColorName:function(){return h._(/*BTDS*/"Tolopea")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tolopea, Color hex: #301E34, hue: Violet")}},"#ECF0F1":{doodle:"light",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Solitude")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Solitude, Color hex: #ECF0F1, hue: blue")}},"#FFFEA2":{doodle:"light",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Canary")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Canary, Color hex: #FFFEA2, hue: Yellow")}},"#E7E8D2":{doodle:"light",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Willow Brook")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Willow Brook, Color hex: #E7E8D2, hue: green")}}},p={"#0F2424":{doodle:"dark",opacity:"0.05",getColorName:function(){return h._(/*BTDS*/"Nordic")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Nordic, Color hex: #0F2424, hue: blue")}},"#12261F":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Cardin green")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cardin green, Color hex: #12261F, hue: green")}},"#11241C":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Cardin green")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cardin green, Color hex: #11241C, hue: green")}},"#111E27":{doodle:"dark",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Tangaroa")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tangaroa, Color hex: #111E27, hue: blue")}},"#0F2224":{doodle:"dark",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Nordic")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Nordic, Color hex: #0F2224, hue: blue")}},"#0E2125":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Tiber")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tiber, Color hex: #0E2125, hue: green")}},"#1F1D25":{doodle:"dark",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Black russian")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black russian, Color hex: #1F1D25, hue: grey")}},"#212121":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Nero")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Nero, Color hex: #212121, hue: grey")}},"#1F211C":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Marshland")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Marshland, Color hex: #1F211C, hue: green")}},"#23231B":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Maire")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Maire, Color hex: #23231B, hue: Yellow")}},"#262419":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Black magic")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black magic, Color hex: #262419, hue: brown")}},"#261F17":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Cocoa brown")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cocoa brown, Color hex: #261F17, hue: brown")}},"#261717":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Wood Bark")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Wood Bark, Color hex: #261717, hue: brown")}},"#260F10":{doodle:"dark",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Seal brown, Color hex: #260F10, hue: brown")}},"#260A10":{doodle:"dark",opacity:"0.07",getColorName:function(){return h._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Seal brown, Color hex: #260A10, hue: brown")}},"#19050B":{doodle:"dark",opacity:"0.075",getColorName:function(){return h._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Seal brown, Color hex: #19050B, hue: brown")}},"#21100C":{doodle:"dark",opacity:"0.07",getColorName:function(){return h._(/*BTDS*/"Seal brown")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Seal brown, Color hex: #21100C, hue: brown")}},"#0F0C0C":{doodle:"dark",opacity:"0.065",getColorName:function(){return h._(/*BTDS*/"Black")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black, Color hex: #0F0C0C, hue: Black")}},"#101919":{doodle:"dark",opacity:"0.06",getColorName:function(){return h._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black pearl, Color hex: #101919, hue: blue")}},"#0A1D25":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Cyprus")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Cyprus, Color hex: #0A1D25, hue: green")}},"#0D1523":{doodle:"dark",opacity:"0.065",getColorName:function(){return h._(/*BTDS*/"Blue whale")},getAriaLabel:function(){return h._(/*BTDS*/"Color: blue whale, Color hex: #0D1523, hue: blue")}},"#0D0F11":{doodle:"dark",opacity:"0.07",getColorName:function(){return h._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black pearl, Color hex: #0D0F11, hue: blue")}},"#0A0C0D":{doodle:"dark",opacity:"0.07",getColorName:function(){return h._(/*BTDS*/"Black pearl")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black pearl, Color hex: #0A0C0D, hue: blue")}},"#110B12":{doodle:"dark",opacity:"0.07",getColorName:function(){return h._(/*BTDS*/"Tolopea")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Tolopea, Color hex: #110B12, hue: Violet")}},"#1E1F1F":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Woodsmoke")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Woodsmoke, Color hex: #1E1F1F, hue: grey")}},"#262618":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Black magic")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Black magic, Color hex: #262618, hue: brown")}},"#23231F":{doodle:"dark",opacity:"0.055",getColorName:function(){return h._(/*BTDS*/"Maire")},getAriaLabel:function(){return h._(/*BTDS*/"Color: Maire, Color hex: #23231F, hue: Yellow")}}},q=Object.keys(o),r=Object.keys(p);function s(a){return a==="light"?q:r}function a(a,b){var c=s(b);if(a===i)return i;c=c.findIndex(function(b){return b.toUpperCase()===a.toUpperCase()});return c!==-1?b==="light"?r[c]:q[c]:a}function b(a,b){b=s(b);return a===i?!0:b.some(function(b){return b.toUpperCase()===a.toUpperCase()})}function t(a,b,c){b=b==="light"?o:p;for(var d in b)if(d.toUpperCase()===a.toUpperCase())return b[d][c];return null}function c(a,b){var c=t(a,b,"opacity");if(c)return c;return b==="light"&&a===i?d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()?l:k:j}function e(a,b){if(a===i)return b==="light"?h._(/*BTDS*/"Color: Beige, Color hex: #F5F1EB, hue: Beige"):h._(/*BTDS*/"Color: Black, Color hex: #161717, hue: black");b=b==="light"?o:p;a=(b=b[a])==null||b.getAriaLabel==null?void 0:b.getAriaLabel();return a}function f(a,b){if(a===i)return b==="light"?h._(/*BTDS*/"Beige"):h._(/*BTDS*/"Black");b=b==="light"?o:p;a=(b=b[a])==null?void 0:b.getColorName();return a}function u(a,b){if(b==="light"&&a!==i){var c=t(a,b,"doodle");if(c)return"data-asset-chat-background-"+c}c="data-asset-chat-background-"+b;b==="light"&&a===i&&(d("WAWebUIRefreshGatingUtils").uiRefreshM1Enabled()?c=n:c=m);return c}function v(a,b){return a==="light"&&b!==i?!!t(b,a,"invertTransparentWallpaperColors"):!1}g.DEFAULT_CHAT_WALLPAPER=i;g.getWallpaperColors=s;g.toggleWallpaperColor=a;g.colorExistsInTheme=b;g.getWallpaperColorPropValue=t;g.getDoodleOpacity=c;g.getWallpaperColorAriaLabel=e;g.getWallpaperColorName=f;g.getDoodleAssetName=u;g.invertTransparentWallpaperColors=v}),226);
__d("WAWebChatPreferenceCollection",["WANullthrows","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebChatPreferenceModel","WAWebUserPrefsKeys","WAWebWallpaper"],(function(a,b,c,d,e,f,g){var h={id:d("WAWebChatPreferenceModel").DEFAULT_PREFERENCE,wallpaper:d("WAWebWallpaper").DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0,showDoodle:!0,spellcheck:!0,transformTextEmoji:!0,enterIsSend:!0,showExpandedComposer:!1,autoplayAnimatedImages:!0,hdMediaEnabled:!1};a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initializeFromCache=function(a){a=a||[];this.add([h].concat(a),{merge:!0})};e.get=function(b){return a.prototype.get.call(this,b)||a.prototype.get.call(this,d("WAWebChatPreferenceModel").DEFAULT_PREFERENCE)};e.getDefault=function(){return c("WANullthrows")(a.prototype.get.call(this,d("WAWebChatPreferenceModel").DEFAULT_PREFERENCE))};e["delete"]=function(){a.prototype["delete"].call(this),this.add(h)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebChatPreferenceModel").ChatPreference;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.CHAT_PREFERENCE_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();g["default"]=b}),98);
__d("WAWebChatPreferenceModel",["WAWebBaseModel","WAWebChatPreferenceCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a="defaultPreference";b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.wallpaper=d("WAWebBaseModel").prop(),b.saveToCameraRoll=d("WAWebBaseModel").prop(),b.showDoodle=d("WAWebBaseModel").prop(),b.spellcheck=d("WAWebBaseModel").prop(),b.transformTextEmoji=d("WAWebBaseModel").prop(),b.enterIsSend=d("WAWebBaseModel").prop(),b.showExpandedComposer=d("WAWebBaseModel").prop(),b.autoplayAnimatedImages=d("WAWebBaseModel").prop(),b.hdMediaEnabled=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.getCollection=function(){return c("WAWebChatPreferenceCollection")};return b}(d("WAWebBaseModel").BaseModel);b.Proxy="chatPreference";b.idClass=c("WAWebWid");b.allowedIds=[a];e=d("WAWebBaseModel").defineModel(b);g.DEFAULT_PREFERENCE=a;g.ChatPreference=e}),98);
__d("WAWebChatUnreadMentionCollection",["WAWebCollection","WAWebUnreadMentionModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.oldestUnreadMention=function(){var a;a=(a=this.last())!=null?a:null;a&&this.remove(a);return a};return b}(c("WAWebCollection"));a.model=c("WAWebUnreadMentionModel");a.comparator=function(a,b){return b.timestamp-a.timestamp};g["default"]=a}),98);
__d("WAWebChatGetMessage",["WAWebAck","WAWebCommonMsgUtils","WAWebMsgDataUtils","WAWebMsgGetters","WAWebStateUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WAWebStateUtils").unproxy(a);for(var b=a.msgs.length-1;b>=0;b--){var c=a.msgs.at(b);if(c&&(!c.local||c.ack>d("WAWebAck").ACK.CLOCK))return c}return void 0}function b(a){a=d("WAWebStateUtils").unproxy(a);for(var b=a.msgs.length-1;b>=0;b--){var c=a.msgs.at(b);if(c&&d("WAWebMsgDataUtils").eventTypeFromMsgType(c)!==d("WAWebCommonMsgUtils").EventType.IGNORE)return c}return void 0}function c(a){a=d("WAWebStateUtils").unproxy(a);for(var b=a.msgs.length-1;b>=0;b--){var c=a.msgs.at(b);if(c!=null&&d("WAWebMsgGetters").getIsSentByMe(c))return c}return void 0}g.getLastReceivedMsg=a;g.getLastTimestampMsg=b;g.getLastSentMsg=c}),98);
__d("WAWebChatUpdates",["WAAbortError","WAPromiseDelays","WARaceSignal","WAWebChatGetMessage","WAWebChatLoadMessages","WAWebDBUpdateChatTable","WAWebNoop"],(function(a,b,c,d,e,f,g){function a(a){var b=Number(a.mute.expiration);d("WAWebDBUpdateChatTable").updateChatTable(a.id,{muteExpiration:b}).then(function(){return a.muteExpiration=b})}function b(a){if(a.promises.updateSortTime)return;var b=new AbortController(),e=b.signal;e=c("WARaceSignal")([e,a.getAbortController().signal],function(b){return d("WAPromiseDelays").delayMs(0).then(function(){var b=d("WAWebChatGetMessage").getLastTimestampMsg(a);if(b){a.t=b.t;return}else if(a.msgs.msgLoadState.noEarlierMsgs)return;else if(a.pendingMsgs)return;return d("WAWebChatLoadMessages").loadEarlierMsgs(a)}).then(function(c){if(b.aborted)throw new(d("WAAbortError").AbortError)();if(c){c=d("WAWebChatGetMessage").getLastTimestampMsg(a);a.t=c?c.t:void 0}})["catch"](c("WAWebNoop"))["finally"](function(){a.promises.updateSortTime=void 0})});a.promises.updateSortTime={promise:e,abortController:b}}g.updateMuteExpiration=a;g.updateSortTime=b}),98);
__d("WAWebMuteCollection",["WALogger","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebConnModel","WAWebMuteModel","WAWebUserPrefsKeys","WAWebUserPrefsNotifications","WAWebUserPrefsStore","gkx"],(function(a,b,c,d,e,f,g){var h,i,j=!0,k=!0,l=!0,m=!1,n=!1,o=!1,p=!1,q=!1,r=!1;a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initializeFromCache=function(a){var b=this;Array.isArray(a)&&a.forEach(function(a){d("WAWebMuteModel").GLOBAL_REACTIONS_MUTE===a.id&&b.add(a,{remove:!1})});this.setGlobalCallNotifications(d("WAWebUserPrefsNotifications").getGlobalCallNotifications());this.setGlobalNotifications(d("WAWebUserPrefsNotifications").getGlobalNotifications());this.setGlobalOfflineNotifications(d("WAWebUserPrefsNotifications").getGlobalOfflineNotifications());this.setGlobalSounds(d("WAWebUserPrefsNotifications").getGlobalSounds());this.setGlobalCallRingtone(d("WAWebUserPrefsNotifications").getGlobalCallRingtone());this.setGlobalPreviews(d("WAWebUserPrefsNotifications").getGlobalPreviews());this.setCollapseMuted(d("WAWebUserPrefsNotifications").getCollapseMuted());this.setOutgoingMessageSound(d("WAWebUserPrefsNotifications").getOutgoingMessageSound());this.setIgnoreNondirectGroupMsg(d("WAWebUserPrefsNotifications").getIgnoreNondirectGroupMsg())};e.saveToCache=function(){if(!d("WAWebConnModel").Conn.shouldSaveToCache())return;var a=this.constructor.cachePolicy.id,b=[];d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["models:mute:cache-save: ",""])),String(a));var e=this.get(d("WAWebMuteModel").GLOBAL_REACTIONS_MUTE);e&&b.push(e.toJSON());b.length?c("WAWebUserPrefsStore").setCollection(a,b):d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:mute:cache-save: globalMuteModel or globalReactionsMuteModel does not exist"])))};e.globalReactionsMute=function(){var a=this.get(d("WAWebMuteModel").GLOBAL_REACTIONS_MUTE);if(a)return a;a=new(d("WAWebMuteModel").Mute)({id:d("WAWebMuteModel").GLOBAL_REACTIONS_MUTE});this.add(a);return a};e.getGlobalSounds=function(){return j};e.setGlobalSounds=function(a){j=a,d("WAWebUserPrefsNotifications").setGlobalSounds(a)};e.getGlobalCallRingtone=function(){return l};e.setGlobalCallRingtone=function(a){l=a,d("WAWebUserPrefsNotifications").setGlobalCallRingtone(a)};e.getGlobalNotifications=function(){return m};e.setGlobalNotifications=function(a){m=a,d("WAWebUserPrefsNotifications").setGlobalNotifications(a)};e.getGlobalCallNotifications=function(){return k};e.setGlobalCallNotifications=function(a){k=a,d("WAWebUserPrefsNotifications").setGlobalCallNotifications(a)};e.getGlobalOfflineNotifications=function(){return n};e.setGlobalOfflineNotifications=function(a){n=a,d("WAWebUserPrefsNotifications").setGlobalOfflineNotifications(a)};e.getGlobalPreviews=function(){return o};e.setGlobalPreviews=function(a){o=a,d("WAWebUserPrefsNotifications").setGlobalPreviews(a)};e.getCollapseMuted=function(){return p};e.setCollapseMuted=function(a){p=a,d("WAWebUserPrefsNotifications").setCollapseMuted(a),this.trigger("change:collapseMuted",p)};e.getOutgoingMessageSound=function(){return q};e.setOutgoingMessageSound=function(a){q=a,d("WAWebUserPrefsNotifications").setOutgoingMessageSound(a)};e.getIgnoreNondirectGroupMsg=function(){return c("gkx")("26258")?!1:r};e.setIgnoreNondirectGroupMsg=function(a){if(c("gkx")("26258"))return;r=a;d("WAWebUserPrefsNotifications").setIgnoreNondirectGroupMsg(a)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMuteModel").Mute;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.MUTE_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();g.MuteCollection=b}),98);
__d("WAWebMuteModel",["fbt","Promise","WALogger","WATypeUtils","WAWeb-moment","WAWebActionToast.react","WAWebAlarm","WAWebBaseModel","WAWebChatMuteBridge","WAWebGroupMetadataCollection","WAWebMiscErrors","WAWebMuteCollection","WAWebMuteGetters","WAWebNewsletterGatingUtils","WAWebNewsletterMetadataCollection","WAWebNewsletterToggleMuteStateAction","WAWebToastManager","WAWebUserPrefsMeUser","WAWebWamEnumChannelEventSurface","WAWebWid","err","react"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=v||c("react"),x=-1;a="global_reactions_mute";function y(a,b){if(c("WAWebWid").isGroup(a)&&!b)return"group";return c("WAWebWid").isNewsletter(a)&&!b?"newsletter":"chat"}e=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.expiration=d("WAWebBaseModel").prop(0),b.callExpiration=d("WAWebBaseModel").prop(0),b.isAutoMuted=d("WAWebBaseModel").prop(!1),b.$MuteImpl$p_1=d("WAWebBaseModel").session(),b.$MuteImpl$p_2=d("WAWebBaseModel").session(),b.promises=d("WAWebBaseModel").session(function(){return{mute:null,unmute:null}}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){a.prototype.initialize.call(this),this.expiration!=null&&this.expiration!==0&&this.mute({expiration:this.expiration,isAutoMuted:this.isAutoMuted}),this.callExpiration!=null&&this.callExpiration!==0&&this.muteCall(this.callExpiration)};f.setMute=function(a,b,c){b===void 0&&(b=!1);if(!a&&!this.expiration||a===this.expiration)return;a?this.mute({expiration:a,isAutoMuted:b,sendDevice:c}):this.unmute({sendDevice:c})};f.setAutoMuted=function(a){this.set({isAutoMuted:a})};f.mute=function(a){var e=this,f=a.expiration,g=a.sendDevice,n=a.toastId,o=a.fromMultiselect,p=o===void 0?!1:o;o=a.isAutoMuted;var q=o===void 0?!1:o;o=a.showToast;a=o===void 0?!0:o;var r=f;if(!d("WATypeUtils").isNumber(r)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute called with invalid expiration ",""])),r);return(u||(u=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)())}r=Math.round(r);r>2e9&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute called with wrong units?"," exp:",""])),this.id.toString(),r);var s=function(){d("WAWebMuteGetters").getIsMuted(e)&&(c("WAWebAlarm").clearTimeout(e.$MuteImpl$p_1),e.unset("_unmuteTimer"));if(r===x)d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute "," muted, no expiration"])),e.id.toString());else{var a=r-c("WAWeb-moment")().unix();d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute "," duration:",""])),e.id.toString(),a);e.$MuteImpl$p_1=c("WAWebAlarm").setGlobalTimeout(function(){return void e.unmute()},r*1e3)}e.set({expiration:r,isAutoMuted:q})},t=y(this.id,p);if(g===!0){if(!c("WAWebWid").isNewsletter(this.id)&&this.promises.mute!=null)return this.promises.mute;f=c("WAWebWid").isNewsletter(this.id)?(o=this.promises.mute)!=null?o:(u||(u=b("Promise"))).reject(c("err")("No promise for newsletter mute")):this.promises.mute=d("WAWebChatMuteBridge").sendConversationMute(this.id,r,this.expiration);o=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Muting chat"));t==="group"?o=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Muting group")):t==="newsletter"&&(o=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Muting channel")));var v=n!=null?n:d("WAWebActionToast.react").genId();n=this.promises.mute["catch"](function(a){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:mute dropped"]))).devConsole(a);a=h._(/*BTDS*/"Couldn't mute chat.");t==="group"?a=h._(/*BTDS*/"Couldn't mute group."):t==="newsletter"&&(o=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mute channel")));if(c("WAWebWid").isNewsletter(e.id))return;throw new(d("WAWebActionToast.react").ActionType)(a,{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return e.mute({expiration:r,isAutoMuted:q,sendDevice:g,toastId:v})}})}).then(function(a){if(a.status===200){var b=h._(/*BTDS*/"Chat muted");t==="group"?b=h._(/*BTDS*/"Group muted"):t==="newsletter"&&(b=h._(/*BTDS*/"Notifications turned off"));return p?new(d("WAWebActionToast.react").ActionType)(b):new(d("WAWebActionToast.react").ActionType)(b,{actionText:h._(/*BTDS*/"Undo"),actionHandler:function(){return c("WAWebWid").isNewsletter(e.id)?d("WAWebNewsletterToggleMuteStateAction").unmuteNewsletterAction(e.id,{eventSurface:d("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE.CHANNEL_PROFILE}):e.unmute({sendDevice:g,toastId:v})}})}else if(a.status>=400){if(t==="newsletter")throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Failed to mute channel"));if(t==="group")throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mute group."));throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't mute chat."))}});a&&d("WAWebToastManager").ToastManager.open(w.jsx(d("WAWebActionToast.react").ActionToast,{id:v,initialAction:o,pendingAction:n}));return f.then(function(a){a.status===200&&s()})["finally"](function(){e.promises.mute=null})}s();return(u||(u=b("Promise"))).resolve()};f.muteCall=function(a){var e=this;a=a;if(!d("WATypeUtils").isNumber(a)){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall called with invalid expiration ",""])),a);return(u||(u=b("Promise"))).reject(new(d("WAWebMiscErrors").ActionError)())}a=Math.round(a);a>2e9&&d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall called with wrong units?"," exp:",""])),this.id.toString(),a);d("WAWebMuteGetters").getIsCallMuted(this)&&(c("WAWebAlarm").clearTimeout(this.$MuteImpl$p_2),this.unset("_unmuteCallTimer"));if(a===x)d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall "," muted, no expiration"])),this.id.toString());else{var f=a-c("WAWeb-moment")().unix();d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:muteCall "," duration:",""])),this.id.toString(),f);this.$MuteImpl$p_2=c("WAWebAlarm").setGlobalTimeout(function(){return void e.unmuteCall()},a*1e3)}this.set({callExpiration:a});return(u||(u=b("Promise"))).resolve()};f.canMute=function(){var a=!1;if(d("WAWebUserPrefsMeUser").isMeAccount(this.id))return!1;if(c("WAWebWid").isGroup(this.id)){var b=c("WAWebGroupMetadataCollection").get(this.id);b&&(a=b.participants.iAmMember())}if(d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&c("WAWebWid").isNewsletter(this.id)){b=c("WAWebNewsletterMetadataCollection").get(this.id);b!=null&&(a=b.canBeMuted)}return a||c("WAWebWid").isUser(this.id)};f.$MuteImpl$p_3=function(){c("WAWebAlarm").clearTimeout(this.$MuteImpl$p_1),this.unset("_unmuteTimer"),this.expiration=0};f.$MuteImpl$p_4=function(){c("WAWebAlarm").clearTimeout(this.$MuteImpl$p_2),this.unset("_unmuteCallTimer"),this.callExpiration=0};f.unmute=function(a){var e=this;a=a===void 0?{}:a;var f=a.sendDevice,g=a.toastId,i=a.fromMultiselect;i=i===void 0?!1:i;a=a.showToast;a=a===void 0?!0:a;var j=!1,k=function(){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmute ",""])),e.id.toString()),e.$MuteImpl$p_3(),e.set({isAutoMuted:j})},l=y(this.id,i);if(f===!0){if(!c("WAWebWid").isNewsletter(this.id)&&this.promises.unmute)return this.promises.unmute;i=c("WAWebWid").isNewsletter(this.id)?(i=this.promises.unmute)!=null?i:(u||(u=b("Promise"))).reject(c("err")("No promise for newsletter mute")):this.promises.unmute=d("WAWebChatMuteBridge").sendConversationMute(this.id,0,this.expiration);var m=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Unmuting chat"));l==="group"?m=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Unmuting group")):l==="newsletter"&&(m=new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Unmuting channel")));var n=g||d("WAWebActionToast.react").genId();g=this.promises.unmute["catch"](function(a){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmute dropped"]))).devConsole(a);a=h._(/*BTDS*/"Couldn't unmute chat.");l==="group"?a=h._(/*BTDS*/"Couldn't unmute group."):l==="newsletter"&&(a=h._(/*BTDS*/"Couldn't unmute channel."));if(c("WAWebWid").isNewsletter(e.id))return;throw new(d("WAWebActionToast.react").ActionType)(a,{actionText:h._(/*BTDS*/"Try again."),actionHandler:function(){return e.unmute({sendDevice:f,toastId:n})}})}).then(function(a){if(a.status===200){if(l==="group")return new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Group unmuted"));return l==="newsletter"?new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Notifications turned on"),{actionText:h._(/*BTDS*/"Undo"),actionHandler:function(){return d("WAWebNewsletterToggleMuteStateAction").muteNewsletterAction(e.id,{eventSurface:d("WAWebWamEnumChannelEventSurface").CHANNEL_EVENT_SURFACE.CHANNEL_THREAD})}}):new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Chat unmuted"))}else if(a.status>=400){if(l==="newsletter")throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Failed to unmute channel"));if(l==="group")throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't unmute group."));throw new(d("WAWebActionToast.react").ActionType)(h._(/*BTDS*/"Couldn't unmute chat."))}});a&&d("WAWebToastManager").ToastManager.open(w.jsx(d("WAWebActionToast.react").ActionToast,{id:n,initialAction:m,pendingAction:g}));return i.then(function(a){a.status===200&&k()})["finally"](function(){e.promises.unmute=null})}k();return(u||(u=b("Promise"))).resolve()};f.unmuteCall=function(){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["models:Mute:unmuteCall ",""])),this.id.toString());this.$MuteImpl$p_4();return(u||(u=b("Promise"))).resolve()};f["delete"]=function(){a.prototype["delete"].call(this),this.getCollection().remove(this.id),this.$MuteImpl$p_3(),d("WAWebMuteGetters").clearMuteGetterCacheFor(this)};f.getCollection=function(){return d("WAWebMuteCollection").MuteCollection};return e}(d("WAWebBaseModel").BaseModel);e.Proxy="mute";e.idClass=c("WAWebWid");e.allowedIds=[a];f=d("WAWebBaseModel").defineModel(e);g.GLOBAL_REACTIONS_MUTE=a;g.Mute=f}),226);
__d("WAWebSuperChatMsgs",["WALogger","WAWebBaseModel","WAWebChatMsgsCollection","err","lodash"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.pendingMsgs=d("WAWebBaseModel").prop(),b.labels=d("WAWebBaseModel").prop(),b.msgChunks=d("WAWebBaseModel").session(function(){return[]}),b.lastReceivedKey=d("WAWebBaseModel").session(),b.unreadMsgAnchor=d("WAWebBaseModel").session(),b.disableUnreadAnchor=d("WAWebBaseModel").session(),b.msgsLength=d("WAWebBaseModel").session(),b.msgsChanged=d("WAWebBaseModel").session(0),b.msgs=d("WAWebBaseModel").collection(d("WAWebChatMsgsCollection").ChatMsgsCollection),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){var b=this;a.prototype.initialize.call(this);this.listenTo(this.msgs,"change:last",function(){b.msgsChanged++});this.listenTo(this.msgs,"add remove bulk_add",function(){b.msgsChanged++,b.msgsLength=b.msgs.length})};e.onEmptyMRM=function(){throw c("err")("onEmptyMRM not implemented")};e["delete"]=function(){a.prototype["delete"].call(this),this.getAllCMCs().forEach(function(a){a.forEach(function(a){a["delete"]()}),a["delete"]()})};e.removeMsg=function(a){var b=a.msgChunk;if(!b)return;var c=b.indexOf(a);if(c<0)return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["models:Chat:removeMsg ",""])),a.get("id"));b.remove(a);b.length===0&&(b===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(b))};e.getAllCMCs=function(){return this.msgChunks.concat([this.msgs])};e.getAllMsgs=function(){return c("lodash").flatten(this.getAllCMCs().map(function(a){return a.getModelsArray()}))};e.replaceMsgsCollection=function(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["model:Chat:replaceMsgsCollection:",""])),this.id.toString());var b={msg:a.last()};this.msgs.replace(a);this.notifyMsgCollectionMerge(a,this.msgs,this.msgs,b);this.msgChunks=this.msgChunks.filter(function(b){return b!==a});a["delete"]()};e.removeMsgsCollection=function(a){this.msgChunks=this.msgChunks.filter(function(b){return b!==a}),a["delete"]()};e.notifyMsgCollectionMerge=function(a,b,c,d){this.trigger("change:cmc:merge",a,b,c,d)};return b}(d("WAWebBaseModel").BaseModel);g["default"]=a}),98);
__d("WAWebContactCollection",["Promise","WALogger","WAWebBaseCollection","WAWebContactComparator","WAWebContactGetters","WAWebContactModel","WAWebSocketConstants","WAWebSocketModel","WAWebUserPrefsMeUser","WAWebWid","lodash"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function e(){var e;e=a.call(this)||this;e._sort=c("lodash").debounce(function(){return a.prototype.sort.call(e)},1e3);e._silentSort=c("lodash").debounce(function(){return a.prototype.sort.call(e,{silent:!0})},1e3);e.findImpl=function(a){var c=e.get(a);return c?(i||(i=b("Promise"))).resolve({id:c.id,stale:c.stale}):(i||(i=b("Promise"))).resolve({id:a})};e.listenTo(d("WAWebSocketModel").Socket,"change:stream",function(){d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.RESUMING&&e.forEach(function(a){a.unset("verificationString"),a.unset("verificationBinary")})});return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.sort=function(a){return this};f.ensureSorted=function(){this._sort.flush()};f.initializeFromCache=function(a){if(!a)return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Store:Contact init from cache"])));this.add(a,{silent:!0,merge:!0})};f.isFilteredContact=function(a){return!!a.name&&!d("WAWebContactGetters").getIsMe(a)&&!d("WAWebContactGetters").getIsPSA(a)&&d("WAWebContactGetters").getIsWAContact(a)};f.getFilteredContacts=function(a){var b=a.showMe;b=b===void 0?!1:b;var e=a.showWithoutName;e=e===void 0?!1:e;var f=a.filterFn;f=f===void 0?null:f;a=a.cancelAt;a=a===void 0?null:a;var g=[];for(var h of this._models){if(a!=null&&g.length>=a){g=[];break}if(h.id.isLid())continue;else if(h.id.isBot())continue;else if(c("WAWebWid").isPSA(h.id))continue;else if(d("WAWebContactGetters").getIsMe(h)){if(b){if(f!=null&&f(h)!==!0)continue;g.push(h)}continue}if(!(h.name||e)||!d("WAWebContactGetters").getIsWAContact(h))continue;if(f!=null&&f(h)!==!0)continue;g.push(h)}return g.sort(d("WAWebContactComparator").ContactComparator)};f.getGroupContacts=function(){return this.filter(function(a){return d("WAWebContactGetters").getIsGroup(a)})};f.getMeContact=function(){var a=d("WAWebUserPrefsMeUser").getMaybeMePnUser();return a==null?null:this.get(a)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebContactModel");a.comparator=d("WAWebContactComparator").ContactComparator;e=new a();g.ContactCollectionImpl=a;g.ContactCollection=e}),98);
__d("WAWebContactShortName",["WALogger","WAWebAlphaRegex","WAWebNonEmptyString"],(function(a,b,c,d,e,f,g){var h;function a(a){if(a==null)return null;a=a.split(/\s/);a=a[0];if(c("WAWebAlphaRegex").exec(a))return d("WAWebNonEmptyString").asMaybeNonEmptyString(a);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[short-name] unable to get short name for contact"])));return null}g.getShortName=a}),98);
__d("WAWebContactModel",["fbt","WALogger","WATimeUtils","WAWebAlarm","WAWebApiContact","WAWebBaseModel","WAWebBizBusinessChangeAction","WAWebBizGatingUtils","WAWebBizLabelUtils","WAWebBlocklistCollection","WAWebBotGating","WAWebBusinessProfileCollection","WAWebConnModel","WAWebContactCollection","WAWebContactGetters","WAWebContactManagementGating","WAWebContactShortName","WAWebFrontendContactGetters","WAWebL10N","WAWebListsGatingUtils","WAWebOptOutListCollection","WAWebProfilePicThumbCollection","WAWebTextStatusCollection","WAWebTextStatusGatingUtils","WAWebTextStatusUtils","WAWebUpdateTextStatusForContact","WAWebUsernameGatingUtils","WAWebWid","WAWebWidFactory","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g,h){var i,j,k=1e3;a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.name=d("WAWebBaseModel").prop(),b.shortName=d("WAWebBaseModel").prop(),b.pushname=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop("in"),b.verifiedName=d("WAWebBaseModel").prop(),b.isBusiness=d("WAWebBaseModel").prop(),b.isEnterprise=d("WAWebBaseModel").prop(),b.isSmb=d("WAWebBaseModel").prop(),b.verifiedLevel=d("WAWebBaseModel").prop(),b.privacyMode=d("WAWebBaseModel").prop(),b.statusMute=d("WAWebBaseModel").prop(),b.parentStatusMute=d("WAWebBaseModel").prop(),b.sectionHeader=d("WAWebBaseModel").prop(),b.labels=d("WAWebBaseModel").prop(),b.isContactSyncCompleted=d("WAWebBaseModel").prop(),b.forcedBusinessUpdateFromServer=d("WAWebBaseModel").prop(),b.disappearingModeDuration=d("WAWebBaseModel").prop(),b.disappearingModeSettingTimestamp=d("WAWebBaseModel").prop(),b.textStatusString=d("WAWebBaseModel").prop(),b.textStatusEmoji=d("WAWebBaseModel").prop(),b.textStatusEphemeralDuration=d("WAWebBaseModel").prop(),b.textStatusLastUpdateTime=d("WAWebBaseModel").prop(d("WAWebTextStatusUtils").TEXT_STATUS_NOT_FETCHED),b.textStatusExpiryTs=d("WAWebBaseModel").prop(),b.requestedPnTimestamp=d("WAWebBaseModel").prop(),b.username=d("WAWebBaseModel").prop(),b.usernameKey=d("WAWebBaseModel").prop(),b.usernameCountryCode=d("WAWebBaseModel").prop(),b.syncToAddressbook=d("WAWebBaseModel").prop(!1),b.isContactBlocked=d("WAWebBaseModel").session(!1),b.isContactOptedOut=d("WAWebBaseModel").session(!1),b.isEverOptedOutOfMarketingMessages=d("WAWebBaseModel").session(!1),b.isMarketingMessageThread=d("WAWebBaseModel").session(!1),b.pendingAction=d("WAWebBaseModel").session(),b.promises=d("WAWebBaseModel").session(function(){return{}}),b.status=d("WAWebBaseModel").session(),b.profilePicThumb=d("WAWebBaseModel").session(),b.businessProfile=d("WAWebBaseModel").session(),b.commonGroups=d("WAWebBaseModel").session(),b.businessCatalog=d("WAWebBaseModel").session(),b.locale=d("WAWebBaseModel").session(),b.shareOwnPn=d("WAWebBaseModel").session(),b.phoneNumber=d("WAWebBaseModel").session(),b.displayNameLID=d("WAWebBaseModel").session(),b.isHosted=d("WAWebBaseModel").session(!1),b.isOrHasBeenHosted=d("WAWebBaseModel").session(!1),b.isFavorite=d("WAWebBaseModel").session(!1),b.meTextStatusExpiryTimer=d("WAWebBaseModel").session(),b.maybeCommonGroupChatModel=d("WAWebBaseModel").session(),b.canSendMsgWhileTimelocked=d("WAWebBaseModel").session(!0),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.$Contact$p_1=function(){var a;c("WAWebAlarm").clearTimeout(this.meTextStatusExpiryTimer);this.unset(["meTextStatusExpiryTimer"]);void d("WAWebUpdateTextStatusForContact").updateTextStatusForContact(this.id,(a=d("WAWebTextStatusUtils")).CLEAR_TEXT_STATUS_STRING_VAL,a.CLEAR_TEXT_STATUS_EMOJI_VAL,a.CLEAR_TEXT_STATUS_EPHEMERAL_DURATION_VAL,a.CLEAR_TEXT_STATUS_LAST_UPDATE_TIME_VAL)};e.setupStatusExpiration=function(){var a=this,b=this.textStatusExpiryTs;b!=null&&(this.meTextStatusExpiryTimer!=null&&c("WAWebAlarm").clearTimeout(this.meTextStatusExpiryTimer),b<d("WATimeUtils").unixTime()?self.setTimeout(function(){void a.$Contact$p_1()}):this.meTextStatusExpiryTimer=c("WAWebAlarm").setGlobalTimeout(function(){return a.$Contact$p_1()},b*k,this.meTextStatusExpiryTimer))};e.initialize=function(){var b=this;a.prototype.initialize.call(this);if(!this.id)return;d("WAWebContactGetters").getIsMe(this)&&this.addChild("status",d("WAWebTextStatusCollection").TextStatusCollection.gadd(this.id));d("WAWebContactGetters").getIsMe(this)&&d("WAWebTextStatusGatingUtils").receiveTextStatusEnabled()&&(this.setupStatusExpiration(),this.listenTo(this,"change:textStatusExpiryTs",function(){self.setTimeout(function(){b.setupStatusExpiration()})}));d("WAWebContactGetters").getIsMe(this)&&this.addChild("profilePicThumb",d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(this.id));(this.isBusiness||d("WAWebContactGetters").getIsMe(this)&&d("WAWebConnModel").Conn.isSMB)&&this.addChild("businessProfile",d("WAWebBusinessProfileCollection").BusinessProfileCollection.gadd(this.id));this.listenTo(this,"change:isBusiness",function(){return d("WAWebBizBusinessChangeAction").handleBusinessChange(b)});d("WAWebContactGetters").getIsMe(this)&&this.listenTo(d("WAWebConnModel").Conn,"change:pushname",function(){b.set({pushname:d("WAWebConnModel").Conn.pushname})});this.listenTo(c("WAWebL10N"),"locale_change",function(){b.locale=c("WAWebL10N").getLocale()});this.id.isUser()&&(this.updateContactBlocked(),this.updateContactOptedOutOfMarketingMessages());this.listenTo(this,"change:name",this.updateShortName);this.listenTo(this,"change:name",this.updateName);this.pendingAction=0;(d("WAWebConnModel").Conn.isSMB||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebBizLabelUtils").initializeLabels(this);var e=this.id;if(e.isLid()){e=this.phoneNumber||d("WAWebApiContact").getPhoneNumber(e);e!=null&&this.copyFieldsFromPnContact(e)}else this.id.isUser()&&(this.updateLidFields(),this.listenTo(this,"change:name change:statusMute",function(){b.updateLidFields()}));if(!this.id.isBot())return;if(this.name)return;this.id.user==="13135550002"?this.set({name:"Meta AI"}):this.set({name:h._(/*BTDS*/"AI").toString()});this.set({type:"out"})};e.updateName=function(){var a;!d("WAWebContactGetters").getIsMyContact(this)&&d("WAWebBotGating").isBizBot3pEnabled()&&((a=this.businessProfile)==null?void 0:a.isBizBot3p)===!0&&this.verifiedName!=null&&this.set({name:this.verifiedName})};e.updateShortName=function(){if(d("WAWebContactGetters").getIsUser(this)&&this.name&&!this.shortName){var a=d("WAWebContactShortName").getShortName(this.name);a!=null&&this.set("shortName",a)}};e.getCurrentLidContact=function(){var a=d("WAWebWidFactory").asUserWidOrThrow(this.id);if(a.isLid())return this;a=d("WAWebApiContact").getCurrentLid(a);return a!=null?d("WAWebContactCollection").ContactCollection.get(a):null};e.updateLidFields=function(){var a=this.getCurrentLidContact();a&&(a.set({name:this.name}),a.set({parentStatusMute:this.statusMute}))};e.isActive=function(){var a=this.id;return a.isLid()?a.equals(d("WAWebApiContact").getLatestLid(a)):!0};e.copyFieldsFromPnContact=function(a){var b=this.getCollection().get(a);(b==null?void 0:b.name)!=null&&this.set({name:b.name});(b==null?void 0:b.statusMute)!=null&&this.set({parentStatusMute:b.statusMute});d("WAWebFrontendContactGetters").getIsUsernameContact(this)||this.set({phoneNumber:a})};e.getStatus=function(){c("WAWebWid").user(this.id)||d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["contact:getStatus for non-user ",""])),this.id.toString());return this.status=d("WAWebTextStatusCollection").TextStatusCollection.gadd(this.id)};e.getProfilePicThumb=function(){return this.profilePicThumb=d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.gadd(this.id)};e.addPendingAction=function(a){var b=this,c=function(){b.decPending()};a.then(c,c);this.pendingAction++;return a};e.decPending=function(){this.pendingAction>0?this.pendingAction--:(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["contact:onPendingActionUpdate pendingAction value is invalid"]))),this.pendingAction=0)};e.updateContactBlocked=function(){if(!this.id.isUser())return;if(d("WAWebBlocklistCollection").BlocklistCollection.get(this.id))this.isContactBlocked=!0;else if(this.id.isLid()&&this.phoneNumber!=null)this.isContactBlocked=d("WAWebBlocklistCollection").BlocklistCollection.get(this.phoneNumber)!=null;else{var a=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(this.id));a=a!=null&&d("WAWebBlocklistCollection").BlocklistCollection.get(a)!=null;this.isContactBlocked=a}};e.updateContactOptedOutOfMarketingMessages=function(){if(!this.id.isUser())return;if(d("WAWebOptOutListCollection").OptOutListCollection.get(this.id))this.isContactOptedOut=!0;else if(this.id.isLid()&&this.phoneNumber!=null)this.isContactOptedOut=d("WAWebOptOutListCollection").OptOutListCollection.get(this.phoneNumber)!=null;else{var a=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(this.id));a=a!=null&&d("WAWebOptOutListCollection").OptOutListCollection.get(a)!=null;this.isContactOptedOut=a}this.isContactOptedOut&&(this.isEverOptedOutOfMarketingMessages=!0)};e.setIsMarketingMessageThread=function(a){this.isMarketingMessageThread=a};e.getIsMarketingMessageThread=function(){return this.isMarketingMessageThread};e.$Contact$p_2=function(){var a=d("WAWebFrontendContactGetters").getUsername(this);if(c("isStringNullOrEmpty")(a))return!1;a=d("WAWebFrontendContactGetters").getSearchName(this);if(!c("isStringNullOrEmpty")(a))return!1;a=d("WAWebContactGetters").getSearchVerifiedName(this);return c("isStringNullOrEmpty")(a)};e.$Contact$p_3=function(a,b,e){var f=d("WAWebFrontendContactGetters").getSearchName(this);if((d("WAWebBizGatingUtils").canDisplayLabel()||d("WAWebListsGatingUtils").isListsEnabled())&&!c("isStringNullOrEmpty")(e)){var g=d("WAWebFrontendContactGetters").getUsername(this);return a&&!c("isStringNullOrEmpty")(f)&&!f.includes(a)&&!c("isStringNullOrEmpty")(g)&&!g.includes(a)?!1:Boolean((g=this.labels)==null?void 0:g.includes(e))}if(!a)return!1;if(!c("isStringNullOrEmpty")(f)&&f.includes(a))return!0;g=d("WAWebContactGetters").getUserid(this);if(!c("isStringNullOrEmpty")(g)&&g.includes(a)&&!this.$Contact$p_2())return!0;if(!c("isStringNullOrEmpty")(b)&&!this.$Contact$p_2())if(!this.id.isLid()){if(g!=null&&g.includes(b))return!0}else if(g!=null){e=d("WAWebWidFactory").asUserLidOrThrow(d("WAWebWidFactory").createUserWidOrThrow(g,"lid"));f=d("WAWebApiContact").getPhoneNumber(e);if(f!=null&&f.toString().includes(b))return!0}g=d("WAWebContactGetters").getSearchVerifiedName(this);if(!c("isStringNullOrEmpty")(g)&&g.includes(a))return!0;if(this.pushname&&c("WAWebL10N").accentFold(this.pushname).includes(a))return!0;if(this.username!=null){e=c("WAWebL10N").accentFold(this.username);if(e.includes(a)&&d("WAWebUsernameGatingUtils").usernameDisplayedEnabled())return!0}if(d("WAWebContactGetters").getIsMe(this)){f=c("WAWebL10N").accentFold(h._(/*BTDS*/"Me").toString());if(f.includes(a))return!0}return!1};e.searchMatch=function(a,b,c){if(a.startsWith("@")&&d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var e=a.slice(1).replace(/#.*/,"");return this.$Contact$p_3(e,b,c)||this.$Contact$p_3(a,b,c)}return this.$Contact$p_3(a,b,c)};e.set=function(b,c,e){e=a.prototype.set.call(this,b,c,e);if(typeof b!=="string"&&c!=null&&c.merge&&e){if(d("WAWebContactGetters").getIsPSA(e))return e;if(e.id.isBot())return e;!b.name&&e.name&&(e.unset("name"),e.unset("shortName"));!b.verifiedName&&e.verifiedName&&e.unset("verifiedName")}return e};e.getCollection=function(){return d("WAWebContactCollection").ContactCollection};e.setNotMyContact=function(){this.name&&(this.set("name",void 0),this.set("shortName",void 0),this.set("type","out"))};e.getSyncToAddressbook=function(){var a;return!d("WAWebContactManagementGating").contactManagementEnabled()?!1:(a=this.syncToAddressbook)!=null?a:!0};e.canToggleFavorite=function(){if(d("WAWebListsGatingUtils").isListsEnabled())return!0;return this.isFavorite?!0:d("WAWebContactGetters").getIsMyContact(this)&&!this.id.isBot()&&!d("WAWebContactGetters").getIsMe(this)};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="contact";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),226);
__d("WAWebDailyAggregatedStats",["$InternalEnum","WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NARRATIVE_APPEAR:1,DIALOG_APPEAR:2,DIALOG_SELECT:3});var h=24*60*60*1e3,i=3*7*h;c=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.startTime=d("WAWebBaseModel").prop(),b.pttCancelBroadcast=d("WAWebBaseModel").prop(0),b.pttCancelGroup=d("WAWebBaseModel").prop(0),b.pttCancelIndividual=d("WAWebBaseModel").prop(0),b.pttCancelNewsletter=d("WAWebBaseModel").prop(0),b.pttDraftReviewBroadcast=d("WAWebBaseModel").prop(0),b.pttDraftReviewGroup=d("WAWebBaseModel").prop(0),b.pttDraftReviewIndividual=d("WAWebBaseModel").prop(0),b.pttDraftReviewNewsletter=d("WAWebBaseModel").prop(0),b.pttFastplaybackBroadcast=d("WAWebBaseModel").prop(0),b.pttFastplaybackGroup=d("WAWebBaseModel").prop(0),b.pttFastplaybackIndividual=d("WAWebBaseModel").prop(0),b.pttFastplaybackNewsletter=d("WAWebBaseModel").prop(0),b.pttLockBroadcast=d("WAWebBaseModel").prop(0),b.pttLockGroup=d("WAWebBaseModel").prop(0),b.pttLockIndividual=d("WAWebBaseModel").prop(0),b.pttLockNewsletter=d("WAWebBaseModel").prop(0),b.pttPlaybackBroadcast=d("WAWebBaseModel").prop(0),b.pttPlaybackGroup=d("WAWebBaseModel").prop(0),b.pttPlaybackIndividual=d("WAWebBaseModel").prop(0),b.pttPlaybackNewsletter=d("WAWebBaseModel").prop(0),b.pttRecordBroadcast=d("WAWebBaseModel").prop(0),b.pttRecordGroup=d("WAWebBaseModel").prop(0),b.pttRecordIndividual=d("WAWebBaseModel").prop(0),b.pttRecordNewsletter=d("WAWebBaseModel").prop(0),b.pttSendBroadcast=d("WAWebBaseModel").prop(0),b.pttSendGroup=d("WAWebBaseModel").prop(0),b.pttSendIndividual=d("WAWebBaseModel").prop(0),b.pttSendNewsletter=d("WAWebBaseModel").prop(0),b.pttPausedRecordBroadcast=d("WAWebBaseModel").prop(0),b.pttPausedRecordGroup=d("WAWebBaseModel").prop(0),b.pttPausedRecordIndividual=d("WAWebBaseModel").prop(0),b.pttPausedRecordNewsletter=d("WAWebBaseModel").prop(0),b.pttOutOfChatBroadcast=d("WAWebBaseModel").prop(0),b.pttOutOfChatGroup=d("WAWebBaseModel").prop(0),b.pttOutOfChatIndividual=d("WAWebBaseModel").prop(0),b.pttOutOfChatNewsletter=d("WAWebBaseModel").prop(0),b.goldenBoxContactNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.goldenBoxContactDialogAppearCount=d("WAWebBaseModel").prop(0),b.goldenBoxContactDialogSelectCount=d("WAWebBaseModel").prop(0),b.goldenBoxGroupNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.goldenBoxGroupDialogAppearCount=d("WAWebBaseModel").prop(0),b.goldenBoxGroupDialogSelectCount=d("WAWebBaseModel").prop(0),b.infoScreenContactNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.infoScreenContactDialogAppearCount=d("WAWebBaseModel").prop(0),b.infoScreenContactDialogSelectCount=d("WAWebBaseModel").prop(0),b.infoScreenGroupNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.infoScreenGroupDialogAppearCount=d("WAWebBaseModel").prop(0),b.infoScreenGroupDialogSelectCount=d("WAWebBaseModel").prop(0),b.chatsListNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.chatsListDialogAppearCount=d("WAWebBaseModel").prop(0),b.chatsListDialogSelectCount=d("WAWebBaseModel").prop(0),b.statusListNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.statusListDialogAppearCount=d("WAWebBaseModel").prop(0),b.statusListDialogSelectCount=d("WAWebBaseModel").prop(0),b.callingScreenAudioNarrativeAppearCount=d("WAWebBaseModel").prop(0),b.callingScreenAudioDialogAppearCount=d("WAWebBaseModel").prop(0),b.callingScreenAudioDialogSelectCount=d("WAWebBaseModel").prop(0),b.prinaLastEvent=d("WAWebBaseModel").prop(0),b.communityTabGroupNavigations=d("WAWebBaseModel").prop(0),b.communityTabToHomeViews=d("WAWebBaseModel").prop(0),b.communityTabViews=d("WAWebBaseModel").prop(0),b.communityTabViewsViaContextMenu=d("WAWebBaseModel").prop(0),b.communityNoActionTabViews=d("WAWebBaseModel").prop(0),b.communityHome=d("WAWebBaseModel").prop(function(){return{}}),b.pnhCagActions=d("WAWebBaseModel").prop(function(){return{}}),b.animatedEmojiSend=d("WAWebBaseModel").prop(0),b.singleEmojiSend=d("WAWebBaseModel").prop(0),b.emojiReply=d("WAWebBaseModel").prop(0),b.kicGroupNotificationTaps=d("WAWebBaseModel").prop(0),b.kicGroupNotifications=d("WAWebBaseModel").prop(0),b.kicNotificationTaps=d("WAWebBaseModel").prop(0),b.kicNotifications=d("WAWebBaseModel").prop(0),b.chatLockFolderChatsCount=d("WAWebBaseModel").prop(0),b.chatLockFolderOpenCount=d("WAWebBaseModel").prop(0),b.chatLockLockFolderHidden=d("WAWebBaseModel").prop(null),b.chatLockNewAddChatCount=d("WAWebBaseModel").prop(0),b.chatLockNewRemoveChatCount=d("WAWebBaseModel").prop(0),b.chatLockSecretCodeActive=d("WAWebBaseModel").prop(null),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this)};c.getEndTime=function(){return this.startTime+h};c.shouldBeSubmitted=function(){return!this.isExpired()&&this.getEndTime()<Date.now()};c.isExpired=function(){var a=Date.now()-i;return this.startTime<a};return b}(d("WAWebBaseModel").BaseModel);c.Proxy="daily-aggregated-stats";e=d("WAWebBaseModel").defineModel(c);g.PrinaDailyActionType=a;g.DailyAggregatedStats=e}),98);
__d("WAWebDailyAggregatedStatsCollection",["WANullthrows","WAWebBaseCachePolicy","WAWebBaseCollection","WAWebDailyAggregatedStats","WAWebUserPrefsGeneral","WAWebUserPrefsKeys"],(function(a,b,c,d,e,f,g){var h=24*60*60*1e3;a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.gaddForDate=function(a){var b=d("WAWebUserPrefsGeneral").getDailyStatsStartTime();a=a.getTime()-b;a=Math.floor(a/h);b=b+h*a;return(a=this.get(b))!=null?a:c("WANullthrows")(this.add({id:b.toString(),startTime:b})[0])};e.gaddForToday=function(){return this.gaddForDate(new Date())};e.initializeFromCache=function(a){if(a==null)return;a=a.map(function(a){return new(d("WAWebDailyAggregatedStats").DailyAggregatedStats)(a)}).filter(function(a){return i(a)&&!a.isExpired()});this.add(a)};e.serialize=function(){return this.toArray().filter(function(a){return i(a)&&!a.isExpired()}).map(function(a){return a.toJSON()})};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebDailyAggregatedStats").DailyAggregatedStats;a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.DAILY_AGGREGATED_STATS_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();function i(a){return(a.startTime-d("WAWebUserPrefsGeneral").getDailyStatsStartTime())%h===0}g.DailyAggregatedStatsCollectionImpl=a;g.DailyAggregatedStatsCollection=b}),98);
__d("WAWebSingleEmojiDailyUtils",["$InternalEnum","WALogger","WAWebDailyAggregatedStatsCollection","WAWebFrontendMsgGetters","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["ANIMATED_EMOJI_SEND","SINGLE_EMOJI_SEND","EMOJI_REPLY"]);function a(a){var b=d("WAWebFrontendMsgGetters").getIsSingleEmoji(a);if(b==null)return;b=d("WAWebFrontendMsgGetters").getIsAnimatedEmoji(a);b?j(i.ANIMATED_EMOJI_SEND):j(i.SINGLE_EMOJI_SEND);d("WAWebMsgGetters").getQuotedMsg(a)&&j(i.EMOJI_REPLY)}function j(a){var b=d("WAWebDailyAggregatedStatsCollection").DailyAggregatedStatsCollection.gaddForToday();d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Wam:IncrementSingleEmojiEvent"]))).devConsole(a);switch(a){case i.ANIMATED_EMOJI_SEND:b.animatedEmojiSend++;break;case i.SINGLE_EMOJI_SEND:b.singleEmojiSend++;break;case i.EMOJI_REPLY:b.emojiReply++;break}}g.maybeIncrementSingleEmojiDailyStatsCount=a}),98);
__d("WAWebEmojiVariantModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.variant=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="emojiVariant";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebEmojiVariantCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebEmoji","WAWebEmojiVariantModel","WAWebUserPrefsKeys","err"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.setVariant=function(a,b){a=d("WAWebEmoji").EmojiUtil.getSkinToneBase(a);if(a)this.gadd({id:a,variant:b});else throw c("err")("attempt to store variantless emoji")};e.getVariant=function(a){if(d("WAWebEmoji").EmojiUtil.getSkinToneBase(a)){a=this.get(a);return a?d("WAWebEmoji").EmojiUtil.normalizeEmoji(a.variant):null}throw c("err")("attempt to get variantless emoji")};e.getVariantIfExists=function(a){if(d("WAWebEmoji").EmojiUtil.getSkinToneBase(a)){a=this.get(a);return a?d("WAWebEmoji").EmojiUtil.normalizeEmoji(a.variant):null}return null};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebEmojiVariantModel");a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.EMOJI_VARIANT_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:1e3};b=new a();g.EmojiVariantCollection=b}),98);
__d("WAWebRecentEmojiModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.weight=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="recentEmoji";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebRecentEmojiCollection",["WAWebBaseCachePolicy","WAWebBaseCollection","WAWebEmoji","WAWebRecentEmojiModel","WAWebUserPrefsKeys","lodash"],(function(a,b,c,d,e,f,g){var h=100,i=36;a=function(a){function b(){var b;b=a.call(this)||this;b.dirty=!1;b.listenTo(b,"change:weight change:length",c("lodash").debounce(b._sortTrimScale,h));return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e._sortTrimScale=function(){var a=this.length;if(!a)return;this.sort();a>i&&this.remove(this.slice(i))};e["delete"]=function(){a.prototype["delete"].call(this),this.dirty=!1};e.increment=function(a){var b=d("WAWebEmoji").EmojiUtil.getSkinToneBase(a)||a;this.get(b)||this.add({id:b,weight:0});this.forEach(function(a){a.id===b?a.weight+=1:a.weight*=.9});this.dirty=!0};return b}(d("WAWebBaseCollection").BaseCollection);a.cachePolicy={id:d("WAWebUserPrefsKeys").COLLECTIONS_KEYS.RECENT_EMOJI_COLLECTION,policy:d("WAWebBaseCachePolicy").CACHE_POLICY.LOAD,delay:2e3};a.comparator=function(a,b){return a.weight>b.weight?-1:1};a.model=c("WAWebRecentEmojiModel");b=new a();g.RecentEmojiCollection=b}),98);
__d("WAWebCommunityActivityModel",["$InternalEnum","WATimeUtils","WAWebBaseModel","WAWebModelUtils"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum").Mirrored(["SUB_GROUP_LINK","NEW_COMMUNITY"]);c=5*d("WATimeUtils").DAY_SECONDS;e=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebModelUtils").prop(),b.communityId=d("WAWebModelUtils").prop(),b.type=d("WAWebModelUtils").prop(),b.timestamp=d("WAWebModelUtils").prop(),b.subgroupName=d("WAWebModelUtils").prop(),b.subgroupId=d("WAWebModelUtils").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);e.Proxy="communityActivity";f=d("WAWebBaseModel").defineModel(e);g.ActivityTypeType=a;g.EXPIRATION_TIME_FOR_SUB_GROUP_LINK=c;g.CommunityActivity=f}),98);
__d("WAWebCommunityActivityCollection",["fbt","WATimeUtils","WAWebBaseCollection","WAWebChatCollection","WAWebCommunityActivityModel","WAWebDBMessageStoreUtils","WAWebGroupType","WAWebUnjoinedSubgroupMetadataCollection","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){a=function(a){function e(){var b;b=a.call(this)||this;b.listenTo(c("WAWebUnjoinedSubgroupMetadataCollection"),"add remove change:subject",b.$CommunityActivityCollection$p_1);return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.$CommunityActivityCollection$p_1=function(a){var b=this.findFirst(function(b){return(b=b.subgroupId)==null?void 0:b.equals(a.id)});b!=null&&(b.subgroupName=a.subject)};f.getActivityFor=function(a){return this.filter(function(b){return b.communityId.equals(a)})};f.shouldShowTabBadge=function(){var a;if(this.length===0)return!1;var b=(a=d("WAWebUserPrefsMultiDevice").getCommunityTabLastSeenTimestamp())!=null?a:0;return this.some(function(a){return a.timestamp>b})};f.syncActivityFor=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=this,f=(b=d("WAWebUserPrefsMultiDevice").getCommunityTabLastSeenTimestamp())!=null?b:0;b=(yield d("WAWebDBMessageStoreUtils").getMessagesBefore(a.toString(),function(a){return a.t<d("WATimeUtils").unixTime()-d("WAWebCommunityActivityModel").EXPIRATION_TIME_FOR_SUB_GROUP_LINK}));if(b.length===0)return;b.forEach(function(b){if(b.author==null)return;var g=d("WAWebWidFactory").createWidFromWidLike(b.author);if(d("WAWebUserPrefsMeUser").isMeAccount(g))return;g=b.t;if(b.subtype===d("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_LINK){var i,j;i=d("WAWebWidFactory").createWidFromWidLike((i=b.templateParams)==null?void 0:i[0]);j=(j=d("WAWebChatCollection").ChatCollection.get(i))==null?void 0:j.formattedTitle;if(j==null){var k,l;k=(k=c("WAWebUnjoinedSubgroupMetadataCollection").get(i.toString()))==null?void 0:k.subject;l=(l=b.templateParams)==null?void 0:l[1];k!=null?j=k:typeof l==="string"?j=l:j=h._(/*BTDS*/"unknown subject").toString()}k=new(d("WAWebCommunityActivityModel").CommunityActivity)({id:b.id,type:d("WAWebCommunityActivityModel").ActivityTypeType.SUB_GROUP_LINK,communityId:a,timestamp:g,subgroupName:j,subgroupId:i});e.addDeduppedSubgroupLink([k])}else b.subtype===d("WAWebGroupType").GROUP_ACTIONS.ADD&&(g>f&&e.add({id:a.toString(),communityId:a,timestamp:g,type:d("WAWebCommunityActivityModel").ActivityTypeType.NEW_COMMUNITY}))})});function e(b){return a.apply(this,arguments)}return e}();f.addDeduppedSubgroupLink=function(a){var b=this;a=a.filter(function(a){return!b.some(function(b){return(b=b.subgroupId)==null?void 0:b.equals(a.subgroupId)})});return this.add(a)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebCommunityActivityModel").CommunityActivity;a.comparator=function(a,b){return a.timestamp-b.timestamp};e=new a();g["default"]=e}),226);
__d("WAWebGroupMembershipApprovalRequestCollection",["WAWebCollection","WAWebGroupMembershipApprovalRequestModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebCollection"));a.model=c("WAWebGroupMembershipApprovalRequestModel");a.comparator=function(a,b){return b.t-a.t};g["default"]=a}),98);
__d("WAWebGroupMembershipApprovalRequestModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.addedBy=d("WAWebBaseModel").prop(),b.requestMethod=d("WAWebBaseModel").prop(),b.parentGroupId=d("WAWebBaseModel").prop(),b.contact=d("WAWebBaseModel").session(),b.addedByContact=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd(this.id)),this.addChild("addedByContact",d("WAWebContactCollection").ContactCollection.gadd(this.addedBy))};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="membership_approval_request";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebGroupMetadataCollection",["Promise","WALogger","WAWebBaseCollection","WAWebChatCollection","WAWebFindGroupMetadataAction","WAWebGroupMetadataModel","WAWebIsCagGroupCache","WAWebProfilePicThumbCollection","WAWebUpdateSubgroupsCommunityAction","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j;a=function(a){function e(){var e;e=a.call(this)||this;e._handleIsParentGroupChange=function(a){a.isParentGroup===!0&&void d("WAWebProfilePicThumbCollection").ProfilePicThumbCollection.update(a.id)};e.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(c("WAWebWid").isGroup(a)){var e,f=d("WAWebChatCollection").ChatCollection.get(a);if(f!=null&&f.isReadOnly&&(f==null||(e=f.groupMetadata)==null?void 0:e.stale)===!1){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["groupMetadata: skip trying to find groupMetadata wid ",""])),a.toString());return(j||(j=b("Promise"))).resolve({id:a})}return d("WAWebFindGroupMetadataAction").findGroupMetadata(a).then(function(a){return a==null?a:babelHelpers["extends"]({},a)})}else if(c("WAWebWid").isBroadcast(a))return(j||(j=b("Promise"))).resolve({id:a});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["groupMetadata:find trying to fetch non-group/bclist wid ",""])),a.toString());return(j||(j=b("Promise"))).reject(c("err")("groupMetadata:find trying to fetch non-group/bclist wid "+a.toString()))});return function(b){return a.apply(this,arguments)}}();e.listenTo(e,"add",e._handleGroupAdd);e.listenTo(e,"remove",e._handleGroupRemove);e.listenTo(e,"change:parentGroup",e._handleParentGroupChange);e.listenTo(e,"change:isParentGroup",e._handleIsParentGroupChange);e.listenTo(e,"change:defaultSubgroup",e._handleDefaultSubgroupChange);return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f._handleGroupAdd=function(a){a.defaultSubgroup===!0&&c("WAWebIsCagGroupCache").add(a.id);if(!a.participants.iAmMember())return;var b=a.parentGroup?this.get(a.parentGroup.toString()):null;if(b!=null){a=a.id;d("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(b,a)}};f._handleGroupRemove=function(a){a.defaultSubgroup===!0&&c("WAWebIsCagGroupCache").remove(a.id);if(!a.participants.iAmMember())return;a=a.parentGroup?this.get(a.parentGroup.toString()):null;a!=null&&d("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(a)};f._handleParentGroupChange=function(a,b,c){if(!a.participants.iAmMember())return;a=a.id;b=b!=null?this.get(b.toString()):null;c=c!=null?this.get(c.toString()):null;b!=null?(d("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(b,a),c!=null&&d("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(c)):c!=null&&d("WAWebUpdateSubgroupsCommunityAction").unlinkParentGroup(c,a)};f._handleDefaultSubgroupChange=function(a,b){b===!0?c("WAWebIsCagGroupCache").add(a.id):c("WAWebIsCagGroupCache").remove(a.id)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebGroupMetadataModel");a.staleCollection=!0;e=new a();g["default"]=e}),98);
__d("WAWebGroupMetadataModel",["fbt","Promise","WALogger","WAShiftTimer","WAWebBaseModel","WAWebChatCollection","WAWebCommunityGatingUtils","WAWebContactCollection","WAWebContactGetters","WAWebGroupMembershipApprovalRequestCollection","WAWebGroupMetadataCollection","WAWebGroupParticipantCollection","WAWebGroupPendingParticipantCollection","WAWebGroupType","WAWebInviteV4QueryGroupAction","WAWebMiscGatingUtils","WAWebPastParticipantCollection","WAWebSchemaGroupMetadata","WAWebSubgroupSuggestionCollection","WAWebUnjoinedSubgroupMetadataCollection","WAWebUnreadMentionMetadataModel","WAWebUpdateSubgroupsCommunityAction","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k="https://chat.whatsapp.com/";a=function(a){function e(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.participants=d("WAWebBaseModel").collection(c("WAWebGroupParticipantCollection")),b.pendingParticipants=d("WAWebBaseModel").collection(c("WAWebGroupPendingParticipantCollection")),b.pastParticipants=d("WAWebBaseModel").collection(c("WAWebPastParticipantCollection")),b.membershipApprovalRequests=d("WAWebBaseModel").collection(c("WAWebGroupMembershipApprovalRequestCollection")),b.subgroupSuggestions=d("WAWebBaseModel").collection(c("WAWebSubgroupSuggestionCollection")),b.id=d("WAWebBaseModel").prop(),b.creation=d("WAWebBaseModel").prop(),b.owner=d("WAWebBaseModel").prop(),b.subject=d("WAWebBaseModel").prop(),b.subjectTime=d("WAWebBaseModel").prop(),b.desc=d("WAWebBaseModel").prop(),b.descId=d("WAWebBaseModel").prop(),b.descTime=d("WAWebBaseModel").prop(),b.descOwner=d("WAWebBaseModel").prop(),b.restrict=d("WAWebBaseModel").prop(),b.announce=d("WAWebBaseModel").prop(),b.noFrequentlyForwarded=d("WAWebBaseModel").prop(),b.ephemeralDuration=d("WAWebBaseModel").prop(),b.disappearingModeTrigger=d("WAWebBaseModel").prop(),b.disappearingModeInitiatedByMe=d("WAWebBaseModel").prop(),b.membershipApprovalMode=d("WAWebBaseModel").prop(),b.memberAddMode=d("WAWebBaseModel").prop(),b.memberLinkMode=d("WAWebBaseModel").prop(),b.growthLockExpiration=d("WAWebBaseModel").prop(),b.growthLockType=d("WAWebBaseModel").prop(),b.reportToAdminMode=d("WAWebBaseModel").prop(),b.size=d("WAWebBaseModel").prop(),b.numSubgroups=d("WAWebBaseModel").prop(),b.support=d("WAWebBaseModel").prop(),b.suspended=d("WAWebBaseModel").prop(!1),b.terminated=d("WAWebBaseModel").prop(!1),b.uniqueShortNameMap=d("WAWebBaseModel").prop(),b.isLidAddressingMode=d("WAWebBaseModel").prop(),b.isParentGroup=d("WAWebBaseModel").prop(),b.isParentGroupClosed=d("WAWebBaseModel").prop(),b.parentGroup=d("WAWebBaseModel").prop(),b.defaultSubgroup=d("WAWebBaseModel").prop(),b.generalSubgroup=d("WAWebBaseModel").prop(),b.hiddenSubgroup=d("WAWebBaseModel").prop(),b.groupSafetyCheck=d("WAWebBaseModel").prop(),b.groupAdder=d("WAWebBaseModel").prop(),b.generalChatAutoAddDisabled=d("WAWebBaseModel").prop(),b.lastCommunityPollTimestamp=d("WAWebBaseModel").prop(),b.unjoinedSubgroups=d("WAWebBaseModel").session(function(){return[]}),b.joinedSubgroups=d("WAWebBaseModel").session(function(){return[]}),b.allowNonAdminSubGroupCreation=d("WAWebBaseModel").prop(),b.lastActivityTimestamp=d("WAWebBaseModel").prop(),b.lastSeenActivityTimestamp=d("WAWebBaseModel").prop(),b.lastReportToAdminTimestamp=d("WAWebBaseModel").prop(),b.incognito=d("WAWebBaseModel").prop(),b.hasCapi=d("WAWebBaseModel").prop(),b.stale=d("WAWebBaseModel").session(!0),b.deviceStale=d("WAWebBaseModel").session(!1),b.trusted=d("WAWebBaseModel").session(!0),b.inviteCode=d("WAWebBaseModel").session(),b.groupInviteCodePromise=d("WAWebBaseModel").session(),b.revokeGroupInvitePromise=d("WAWebBaseModel").session(),b.participantQueryPromise=d("WAWebBaseModel").session(),b.deviceQueryPromise=d("WAWebBaseModel").session(),b.unjoinedSubgroupsQueryPromise=d("WAWebBaseModel").session(),b.displayedDesc=d("WAWebBaseModel").session(""),b.revokeGroupsV4AddInvitePromise=d("WAWebBaseModel").session(),b.groupInviteLink=d("WAWebBaseModel").derived(function(){return!this.inviteCode?null:""+k+this.inviteCode},["inviteCode"]),b.cachedDeviceCount=d("WAWebBaseModel").session(),b.cachedDeviceSizeBucket=d("WAWebBaseModel").session(),b.groupType=d("WAWebBaseModel").derived(function(){if(this.defaultSubgroup===!0)return d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;if(this.generalSubgroup===!0)return d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP;if(this.parentGroup!=null)return d("WAWebGroupType").GroupType.LINKED_SUBGROUP;return this.isParentGroup===!0?d("WAWebGroupType").GroupType.COMMUNITY:d("WAWebGroupType").GroupType.DEFAULT},["parentGroup","isParentGroup","defaultSubgroup","generalSubgroup"]),b.isCag=d("WAWebBaseModel").derived(function(){return this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP},["groupType"]),b.isUnnamed=d("WAWebBaseModel").derived(function(){return this.subject===""},["subject"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.isNonAdminAndACAGJREnabled=function(){var a,b=!this.participants.iAmAdmin(),c=this.participants.iAmMember(),e=this.memberAddMode===d("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD;a=(a=this.membershipApprovalMode)!=null?a:!1;return b&&c&&e&&a};f.hasUniqueShortNameMention=function(a){if(!this.uniqueShortNameMap||!a.shortName||!d("WAWebContactGetters").getIsMyContact(a))return!1;a=this.$GroupMetadata$p_2(a.shortName);return(a=this.uniqueShortNameMap.get(a))!=null?a:!1};f.$GroupMetadata$p_2=function(a){return a.toLowerCase().trim()};f.isSuspendedOrTerminated=function(){return this.suspended||this.terminated};f["delete"]=function(){a.prototype["delete"].call(this),this.getCollection().remove(this.id),this.participants["delete"]()};f.canSetSubject=function(){if(this.isSuspendedOrTerminated())return!1;if(this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP)return!1;else if(this.groupType===d("WAWebGroupType").GroupType.COMMUNITY)return this.participants.iAmAdmin();if(!this.participants.iAmMember())return!1;if(this.participants.iAmAdmin())return!this.support;return this.restrict===!0?!1:!this.support};f.canSetDescription=function(){if(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)return!1;if(this.isSuspendedOrTerminated())return!1;return(this.groupType===d("WAWebGroupType").GroupType.COMMUNITY||this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP)&&!this.participants.iAmAdmin()?!1:!this.support};f.searchMatch=function(a){if(a==null)return!1;var b=this.id;b=(b=d("WAWebChatCollection").ChatCollection.get(b))==null?void 0:b.formattedTitle;return b!=null&&b.toLowerCase().includes(a)?!0:!1};f.canSetGroupProperty=function(){if(this.isSuspendedOrTerminated())return!1;if(this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP)return!1;return this.participants.iAmAdmin()?!this.support:!1};f.userCanSetEphemeralSetting=function(a){var b=!this.support;if(this.isSuspendedOrTerminated())return!1;if(a.isUser()){if(!this.participants.userIsMember(a))return!1;if(this.participants.userIsAdmin(a))return b}if(this.restrict)return!1;return this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!1:b};f.canSetEphemeralSetting=function(){var a=this;return d("WAWebUserPrefsMeUser").getMePNandLIDWids().some(function(b){return a.userCanSetEphemeralSetting(d("WAWebWidFactory").asUserWidOrThrow(b))})};f.initialize=function(){var a=this;d("WAWebBaseModel").BaseModel.prototype.initialize.call(this);this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",function(){a.isTrusted(),a.$GroupMetadata$p_3()});this.listenTo(this.participants,"bulk_add bulk_remove reset",this.triggerParticipantsChange);this.listenTo(this,"change:owner",this.isTrusted);this.listenTo(this,"change:isParentGroup",this.$GroupMetadata$p_4);this.listenTo(this,"change:desc",this.$GroupMetadata$p_3);this.listenTo(this,"change:groupType",this.$GroupMetadata$p_3);this.$GroupMetadata$p_3();this.isTrusted();this.$GroupMetadata$p_1=this.$GroupMetadata$p_5();this.listenTo(this.participants,"change:contact.shortName",this.$GroupMetadata$p_6);this.uniqueShortNameMap=new Map();this.unreadMentionMetadata=new(c("WAWebUnreadMentionMetadataModel"))();this.groupType===d("WAWebGroupType").GroupType.COMMUNITY&&this.$GroupMetadata$p_4()};f.$GroupMetadata$p_6=function(){var a;(a=this.$GroupMetadata$p_1)==null||a.debounce(e.UPDATE_NAME_MAP_DEBOUNCE_TIME)};f.triggerParticipantsChange=function(){if(d("WAWebMiscGatingUtils").isDropLastNameEnabled()){var a;(a=this.$GroupMetadata$p_1)==null||a.debounce(e.UPDATE_NAME_MAP_DEBOUNCE_TIME)}this.trigger("change:participants")};f.$GroupMetadata$p_5=function(){var a=this;return new(d("WAShiftTimer").ShiftTimer)(function(){if(d("WAWebMiscGatingUtils").isDropLastNameEnabled()){var b=new Map();a.participants&&a.participants.forEach(function(c){if(c.contact.shortName&&d("WAWebContactGetters").getIsMyContact(c.contact)){c=a.$GroupMetadata$p_2(c.contact.shortName);!b.has(c)?b.set(c,!0):b.set(c,!1)}});a.uniqueShortNameMap=b}})};f.$GroupMetadata$p_7=function(){return this.participants.some(function(a){return a.isAdmin&&d("WAWebContactGetters").getIsMyContact(a.contact)})};f.isTrusted=function(){if(this.stale)return this.trusted;if(this.support)return this.trusted=!0;if(this.owner){if(d("WAWebUserPrefsMeUser").isMeAccount(this.owner))return this.trusted=!0;var a=d("WAWebContactCollection").ContactCollection.get(this.owner);if(a!=null&&d("WAWebContactGetters").getIsMyContact(a))return this.trusted=!0}if(this.groupAdder!=null){a=d("WAWebContactCollection").ContactCollection.get(this.groupAdder);if(a!=null&&d("WAWebContactGetters").getIsMyContact(a))return this.trusted=!0}return!this.$GroupMetadata$p_7()?this.trusted=!1:this.trusted=!0};f.hasJoined=function(){var a=this.id,b=this.groupType,c=this.joinedSubgroups;if(b===d("WAWebGroupType").GroupType.COMMUNITY)return c.length>0;b=d("WAWebChatCollection").ChatCollection.get(a);return!b?!1:b.isReadOnly===!1};f.$GroupMetadata$p_3=function(){this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&!this.canSetDescription()&&(this.desc==null||this.desc==="")?this.displayedDesc=h._(/*BTDS*/"Get the latest announcements from the admins of this community.").toString():this.displayedDesc=this.desc};f.$GroupMetadata$p_4=function(){d("WAWebUpdateSubgroupsCommunityAction").updateJoinedSubgroups(this),d("WAWebUpdateSubgroupsCommunityAction").updateUnjoinedSubgroups(this)};f.revokeGroupsV4AddInvite=function(a){var c=this;if(this.revokeGroupsV4AddInvitePromise)return this.revokeGroupsV4AddInvitePromise;var e=d("WAWebWidToJid").widToGroupJid(this.id),f=this.pendingParticipants;(j||(j=b("Promise"))).resolve();e=d("WAWebInviteV4QueryGroupAction").revokeGroupInviteV4(a,e);return this.revokeGroupsV4AddInvitePromise=e.then(function(b){b.status>=200&&b.status<300&&f.remove(a);return b.status})["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:groupMetadata:participantCollection:revokeGroupsV4AddInvite failed"]))).devConsole(a);return 500})["finally"](function(){c.revokeGroupsV4AddInvitePromise=null})};f.queryGroupsV4PendingInvite=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,b=(yield d("WAWebInviteV4QueryGroupAction").getPendingParticipants(this.id,this.isLidAddressingMode===!0));b.forEach(function(b){a.pendingParticipants.add({id:d("WAWebWidFactory").createUserWidOrThrow(b)})});return});function c(){return a.apply(this,arguments)}return c}();f.getJoinedSubgroupsMetadata=function(){var a=this.getCollection();return this.joinedSubgroups.map(function(b){return a.get(b.toString())}).filter(Boolean)};f.getJoinedSubgroupsChat=function(){return this.joinedSubgroups.map(function(a){return d("WAWebChatCollection").ChatCollection.get(a.toString())}).filter(Boolean)};f.getUnjoinedSubgroupsMetadata=function(){var a=this.getUnjoinedCollection();return this.unjoinedSubgroups.map(function(b){return a.get(b.toString())}).filter(Boolean)};f.getSubgroupsMetadata=function(){return[].concat(this.getJoinedSubgroupsMetadata(),this.getUnjoinedSubgroupsMetadata())};f.getSubgroupSuggestions=function(){var a=new Set();return this.subgroupSuggestions.filter(function(b){var c=b.groupId;b=b.isExistingGroup;return a.has(c.toString())?!1:a.add(c.toString())&&!(b&&!d("WAWebCommunityGatingUtils").memberSuggestedGroupsM3ReceiverEnabled())})};f.getParentGroupChat=function(){var a=this.parentGroup;if(!a)return;return d("WAWebChatCollection").ChatCollection.get(a)};f.isParentGroupParticipant=function(){var a=this.parentGroup;if(!a)return!1;a=this.getCollection().get(a);return a!=null&&a.joinedSubgroups.length?!0:!1};f.getUnjoinedCollection=function(){return c("WAWebUnjoinedSubgroupMetadataCollection")};f.getCollection=function(){return c("WAWebGroupMetadataCollection")};return e}(d("WAWebBaseModel").BaseModel);a.Proxy="groupMetadata";a.idClass=c("WAWebWid");a.UPDATE_NAME_MAP_DEBOUNCE_TIME=200;e=d("WAWebBaseModel").defineModel(a);g["default"]=e}),226);
__d("WAWebGroupParticipantComparator",["WAWebContactComparator"],(function(a,b,c,d,e,f,g){a=function(a,b){return d("WAWebContactComparator").ContactComparator(a.contact,b.contact)};b=a;g["default"]=b}),98);
__d("WAWebGroupParticipantCollection",["WAWebApiContact","WAWebChatCollection","WAWebCollection","WAWebContactCollection","WAWebContactGetters","WAWebGroupMetadataCollection","WAWebGroupParticipantComparator","WAWebGroupParticipantModel","WAWebGroupType","WAWebHostedGroupUtils","WAWebL10N","WAWebProfilePicPrivacyTokenGating","WAWebSchemaGroupMetadata","WAWebSendForNeededAddRequest","WAWebUpdateSubgroupsCommunityAction","WAWebUserPrefsMeUser","WAWebWidFactory","lodash"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,e){var f;e===void 0&&(e={});f=a.call(this,b,e)||this;f.$ParticipantCollection$p_2=function(a,b,c){f.$ParticipantCollection$p_3(a),d("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&c.add===!0&&f.$ParticipantCollection$p_4(a)};f.$ParticipantCollection$p_4=function(a){if(!d("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled())return;if(!f.iAmMember())return;var b=d("WAWebChatCollection").ChatCollection.get(f.parent.id);b&&(b==null?void 0:b.tcToken)==null&&(a==null||a.contact.set({maybeCommonGroupChatModel:b},{isSilent:!0}))};f.$ParticipantCollection$p_3=function(a){var b,c;if(!a||!d("WAWebUserPrefsMeUser").isMeAccount(a.id))return;a=f.parent.id;b=a?(b=d("WAWebChatCollection").ChatCollection.get(a.toString()))==null?void 0:b.groupMetadata:null;b=b==null||(c=b.getParentGroupChat())==null?void 0:c.groupMetadata;if(b==null)return;f.iAmMember()?d("WAWebUpdateSubgroupsCommunityAction").subgroupUnjoinedToJoined(b,a):d("WAWebUpdateSubgroupsCommunityAction").subgroupJoinedToUnjoined(b,a)};f.$ParticipantCollection$p_1=c("lodash").debounce(function(){return f.sort()},1e3);f.sendForNeededAddRequest=function(a){var b,c=f.getChat(),e=f.getGroupMetadata();e=(e=e==null?void 0:e.desc)!=null?e:"";c=(b=(b=c==null?void 0:c.formattedTitle)!=null?b:c==null?void 0:c.name)!=null?b:"";d("WAWebSendForNeededAddRequest").sendForNeededAddRequest(a,c,e,f.parent.id)};f.listenTo(f,"change:contact.name",f.$ParticipantCollection$p_1);f.listenTo(c("WAWebL10N"),"locale_change",f.$ParticipantCollection$p_1);f.listenTo(f,"add remove",f.$ParticipantCollection$p_2);return f}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e["delete"]=function(){this.forEach(function(a){a["delete"]()}),this.stopListening(),this.reset()};e.ensureSorted=function(){this.$ParticipantCollection$p_1.flush()};e.set=function(b,c){c=c||{};c.isParticipantCollectionAdd!==!0&&(c=babelHelpers["extends"]({},c,{remove:!0}));b=a.prototype.set.call(this,b,c);this.trigger("bulk_add",b);c.remove===!0&&this.trigger("bulk_remove",b);return b};e.add=function(b,c){c=c||{};c=babelHelpers["extends"]({},c,{isParticipantCollectionAdd:!0});b=a.prototype.add.call(this,b,c);this.trigger("bulk_add",b);return b};e.remove=function(b,c){c=c||{};b=a.prototype.remove.call(this,b,c);this.trigger("bulk_remove",b);return b};e.canAdd=function(){if(this.iAmAdmin())return!0;var a=this.getGroupMetadata();return this.iAmMember()&&(a==null?void 0:a.memberAddMode)===d("WAWebSchemaGroupMetadata").MemberAddMode.ALL_MEMBER_ADD};e.canTransferOwnership=function(a){if(d("WAWebUserPrefsMeUser").isMeAccount(a.id))return!1;if(!this.iAmSuperAdmin())return!1;if(!a.isAdmin)return!1;a=this.getGroupMetadata();return(a==null?void 0:a.groupType)!==d("WAWebGroupType").GroupType.COMMUNITY?!1:!0};e.canPromote=function(a){if(!a)return!1;if(d("WAWebUserPrefsMeUser").isMeAccount(a.id))return!1;if(!this.iAmAdmin())return!1;if(a.isAdmin)return!1;a=this.getGroupMetadata();return a!=null&&a.isCag?!1:!0};e.canDemote=function(a){if(!a)return!1;if(!this.iAmAdmin())return!1;var b=this.getGroupMetadata();if((b==null?void 0:b.groupType)!==d("WAWebGroupType").GroupType.COMMUNITY&&(b==null?void 0:b.groupType)!==d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&d("WAWebUserPrefsMeUser").isMeAccount(a.id))return!1;var c=a.isSuperAdmin;if(c)return(b==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.COMMUNITY||(b==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?d("WAWebUserPrefsMeUser").isMeAccount(a.id):!1;if(!a.isAdmin)return!1;return(b==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!1:!0};e.canRemove=function(a){if(!a)return!1;if(d("WAWebUserPrefsMeUser").isMeAccount(a.id))return!1;if(!this.iAmAdmin())return!1;var b=this.getGroupMetadata();return b!=null&&b.isCag&&(a.isAdmin||a.isSuperAdmin)?!1:!0};e.canVerifyIdentity=function(a){var b;if(!a)return!1;if(d("WAWebUserPrefsMeUser").isMeAccount(a.id))return!1;var c=this.getGroupMetadata();return d("WAWebHostedGroupUtils").isWAHostedGroupEnabled()&&(c==null?void 0:c.hasCapi)===!0&&a.id.toString()===(c==null||(b=c.owner)==null?void 0:b.toString())?!1:!0};e.userIsMember=function(a){return this.isParticipantWidOrAlternateWidValid(a,function(a){return a!=null})};e.userIsAdmin=function(a){return this.isParticipantWidOrAlternateWidValid(a,function(a){return(a==null?void 0:a.isAdmin)===!0})};e.userIsSuperAdmin=function(a){return this.isParticipantWidOrAlternateWidValid(a,function(a){return(a==null?void 0:a.isSuperAdmin)===!0})};e.isParticipantWidOrAlternateWidValid=function(a,b){var c=this.get(a);if(b(c))return!0;c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a));a=c?this.get(c):null;return b(a)};e.iAmMember=function(){var a=this.getMeParticipant();return a?!0:!1};e.iAmRestrictedMember=function(){var a=this.getGroupMetadata();a=(a==null?void 0:a.restrict)===!0;return a&&!this.iAmAdmin()};e.iAmAdmin=function(){var a=this.getMeParticipant();return(a==null?void 0:a.isAdmin)===!0};e.iAmSuperAdmin=function(){var a=this.getMeParticipant();return(a==null?void 0:a.isSuperAdmin)===!0};e.getAdmins=function(){return this.where({isAdmin:!0})};e.getSuperAdmin=function(){return this.findFirst(function(a){return a.isSuperAdmin})};e.getMyContacts=function(){return this.filter(function(a){a=d("WAWebContactCollection").ContactCollection.get(a.id);return a!=null&&d("WAWebContactGetters").getIsMyContact(a)})};e.getMeParticipant=function(){var a;return(a=this.get(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()))!=null?a:this.get(d("WAWebUserPrefsMeUser").getMeLidUserOrThrow())};e.getChat=function(){var a=this.parent.id;return d("WAWebChatCollection").ChatCollection.get(a)};e.getGroupMetadata=function(){var a=this.parent.id;return c("WAWebGroupMetadataCollection").get(a)};return b}(c("WAWebCollection"));a.model=c("WAWebGroupParticipantModel");a.comparator=c("WAWebGroupParticipantComparator");g["default"]=a}),98);
__d("WAWebGroupParticipantModel",["WAWebBaseModel","WAWebContactCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.isAdmin=d("WAWebBaseModel").prop(),b.isSuperAdmin=d("WAWebBaseModel").prop(),b.leaveTs=d("WAWebBaseModel").prop(),b.leaveReason=d("WAWebBaseModel").prop(),b.contact=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd(this.id))};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="participant";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebGroupPendingParticipantCollection",["WAWebCollection","WAWebGroupParticipantComparator","WAWebGroupParticipantModel","WAWebL10N","lodash"],(function(a,b,c,d,e,f,g){a=function(a){function b(b,d){var e;d===void 0&&(d={});e=a.call(this,b,d)||this;e.$PendingParticipantCollection$p_1=c("lodash").debounce(function(){return e.sort()},1e3);e.listenTo(e,"change:contact.name",e.$PendingParticipantCollection$p_1);e.listenTo(c("WAWebL10N"),"locale_change",e.$PendingParticipantCollection$p_1);return e}babelHelpers.inheritsLoose(b,a);var d=b.prototype;d["delete"]=function(){this.forEach(function(a){a["delete"]()}),this.stopListening(),this.reset()};d.ensureSorted=function(){this.$PendingParticipantCollection$p_1.flush()};d.set=function(b,c){c===void 0&&(c={});c.isParticipantCollectionAdd!==!0&&(c.remove=!0);return a.prototype.set.call(this,b,c)};d.add=function(b,c){c===void 0&&(c={});c.isParticipantCollectionAdd=!0;return a.prototype.add.call(this,b,c)};return b}(c("WAWebCollection"));a.model=c("WAWebGroupParticipantModel");a.comparator=c("WAWebGroupParticipantComparator");g["default"]=a}),98);
__d("WAWebPastParticipantCollection",["WATimeUtils","WAWebCollection","WAWebGroupConstants","WAWebGroupParticipantModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getValidRecords=function(){return this.filter(function(a){a=d("WATimeUtils").castToUnixTime(a.leaveTs);var b=d("WATimeUtils").DAY_SECONDS*d("WAWebGroupConstants").PAST_PARTICIPANT_EXPIRATION_DAYS;return d("WATimeUtils").happenedWithin(a,b)})};return b}(c("WAWebCollection"));a.model=c("WAWebGroupParticipantModel");a.comparator=function(a,b){return b.leaveTs-a.leaveTs};g["default"]=a}),98);
__d("WAWebSubgroupSuggestionCollection",["WAWebBaseCollection","WAWebSubgroupSuggestionModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebSubgroupSuggestionModel");a.comparator=function(a,b){return a.t-b.t};g["default"]=a}),98);
__d("WAWebCellRequestState",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Pending","Loading","Approved","Rejected","Canceled","Error"]);f.State=a}),66);
__d("WAWebSubgroupSuggestionModel",["WAWebBaseModel","WAWebCellRequestState","WAWebContactCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.groupId=d("WAWebBaseModel").prop(),b.parentGroupId=d("WAWebBaseModel").prop(),b.subject=d("WAWebBaseModel").prop(),b.desc=d("WAWebBaseModel").prop(),b.owner=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.isExistingGroup=d("WAWebBaseModel").prop(),b.participantCount=d("WAWebBaseModel").prop(),b.hiddenSubgroup=d("WAWebBaseModel").prop(),b.ownerContact=d("WAWebBaseModel").session(),b.currentState=d("WAWebBaseModel").session(),b.error=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.addChild("ownerContact",d("WAWebContactCollection").ContactCollection.gadd(this.owner)),this.resetState()};c.resetState=function(){this.currentState=d("WAWebCellRequestState").State.Pending,this.error=void 0};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="subgroup_suggestion";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebUnjoinedSubgroupMetadataCollection",["WAWebBaseCollection","WAWebGroupMetadataCollection","WAWebUnjoinedSubgroupMetadataModel","WAWebUpdateSubgroupsCommunityAction"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.listenTo(b,"add",b.$UnjoinedSubgroupMetadataCollection$p_1);b.listenTo(b,"remove",b.$UnjoinedSubgroupMetadataCollection$p_1);b.listenTo(b,"change:parentGroupId",b.$UnjoinedSubgroupMetadataCollection$p_2);return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.$UnjoinedSubgroupMetadataCollection$p_3=function(a){a&&d("WAWebUpdateSubgroupsCommunityAction").updateUnjoinedSubgroups(a)};e.$UnjoinedSubgroupMetadataCollection$p_1=function(a){a=c("WAWebGroupMetadataCollection").get(a.parentGroupId.toString());this.$UnjoinedSubgroupMetadataCollection$p_3(a)};e.$UnjoinedSubgroupMetadataCollection$p_2=function(a,b,d){a=b!=null?c("WAWebGroupMetadataCollection").get(b.toString()):null;b=d!=null?c("WAWebGroupMetadataCollection").get(d.toString()):null;this.$UnjoinedSubgroupMetadataCollection$p_3(a);this.$UnjoinedSubgroupMetadataCollection$p_3(b)};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebUnjoinedSubgroupMetadataModel");b=new a();g["default"]=b}),98);
__d("WAWebUnjoinedSubgroupMetadataModel",["fbt","WAWebBaseModel","WAWebGroupParticipantCollection","WAWebGroupType","WAWebWid"],(function(a,b,c,d,e,f,g,h){a=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.id=d("WAWebBaseModel").prop(),b.subject=d("WAWebBaseModel").prop(),b.subjectTime=d("WAWebBaseModel").prop(),b.parentGroupId=d("WAWebBaseModel").prop(),b.defaultSubgroup=d("WAWebBaseModel").prop(),b.generalSubgroup=d("WAWebBaseModel").prop(),b.desc=d("WAWebBaseModel").prop(),b.creation=d("WAWebBaseModel").prop(),b.owner=d("WAWebBaseModel").prop(),b.size=d("WAWebBaseModel").prop(),b.adminRequestRequired=d("WAWebBaseModel").prop(),b.membershipApprovalMode=d("WAWebBaseModel").prop(),b.membershipApprovalRequest=d("WAWebBaseModel").prop(),b.hiddenSubgroup=d("WAWebBaseModel").prop(),b.suspended=d("WAWebBaseModel").prop(),b.participants=d("WAWebBaseModel").collection(c("WAWebGroupParticipantCollection")),b.groupType=d("WAWebBaseModel").derived(function(){if(this.defaultSubgroup===!0)return d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;return this.generalSubgroup===!0?d("WAWebGroupType").GroupType.LINKED_GENERAL_GROUP:d("WAWebGroupType").GroupType.LINKED_SUBGROUP},["defaultSubgroup","generalSubgroup"]),b.displayedDesc=d("WAWebBaseModel").derived(function(){return this.groupType===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP&&(this.desc==null||this.desc==="")?h._(/*BTDS*/"Get the latest announcements from the admins of this community.").toString():this.desc},["desc","groupType"]),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseModel").BaseModel);a.Proxy="unjoinedSubgroupMetadata";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),226);
__d("WAWebUnreadMentionMetadataModel",["WAWebBaseModel","WAWebChatUnreadMentionCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.unreadMentionCollection=d("WAWebBaseModel").prop(),b.pendingUnreadMentionCount=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){this.unreadMentionCollection=new(c("WAWebChatUnreadMentionCollection"))(),this.pendingUnreadMentionCount=0};e.hasMentionId=function(a){return this.unreadMentionCollection.get(a)!=null};e.addUnreadMentions=function(a,b){this.unreadMentionCollection.add(a)};e.removeUnreadMentions=function(a){this.unreadMentionCollection.remove(a)};e.oldestUnreadMention=function(){return this.unreadMentionCollection.oldestUnreadMention()};e.reset=function(){this.pendingUnreadMentionCount=0,this.unreadMentionCollection.reset()};e.getUnreadMentionCount=function(){return this.pendingUnreadMentionCount+this.unreadMentionCollection.length};return b}(d("WAWebBaseModel").BaseModel);b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebCarouselCardsCollection",["WAWebBaseCollection","WAWebMsgModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.clone=function(){var a=new b();a.add(this.slice());return a};c.getCardsById=function(){var a={};this.forEach(function(b){a[b.id.toString()]=b});return a};return b}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;g["default"]=a}),98);
__d("WAWebCarouselMsgUtils",["WALogger","WAWebMsgCollection"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){if(!a.isCarouselCard){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getParentMsgFromCarouselCard called on non carousel card."]))).sendLogs("getParentMsgFromCarouselCard-error");return}if(a.parentMsgId==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parentMsgId is null on carousel card."]))).sendLogs("getParentMsgFromCarouselCard-error");return}var b=d("WAWebMsgCollection").MsgCollection.get(a.parentMsgId);b==null&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Could not find parent msg (id=",") for carousel card."])),a.parentMsgId).sendLogs("getParentMsgFromCarouselCard-error");return b}function b(a){var b=[],c=function(a){return b.push(a)};for(a of a)a.carouselCards!=null?a.carouselCards.forEach(c):c(a);return b}g.getParentMsgFromCarouselCard=a;g.flattenMsgs=b}),98);
__d("WAWebSettingsFBT",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebConnModel"],(function(a,b,c,d,e,f,g,h){function a(){return h._(/*BTDS*/"Chat wallpaper")}function b(){return h._(/*BTDS*/"Request account info")}function c(){return h._(/*BTDS*/"Channels reports")}function e(){return h._(/*BTDS*/"Business tools")}function f(){return h._(/*BTDS*/"Business profile")}function i(){return h._(/*BTDS*/"Catalog")}function j(){return h._(/*BTDS*/"Orders")}function k(){return h._(/*BTDS*/"Advertise")}function l(){return h._(/*BTDS*/"Quick replies")}function m(){return h._(/*BTDS*/"Labels")}function n(){return h._(/*BTDS*/"Business Help Center")}function o(){return h._(/*BTDS*/"Notifications")}function p(){return h._(/*BTDS*/"Message notifications")}function q(){return h._(/*BTDS*/"Language & time")}function r(){return h._(/*BTDS*/"Use this setting to override the language from your phone")}function s(){return h._(/*BTDS*/"Language")}function t(){return h._(/*BTDS*/"Time format")}function u(){return h._(/*BTDS*/"Media auto-download")}function v(){return h._(/*BTDS*/"Media upload quality")}function w(){return h._(/*BTDS*/"Security")}function x(){return h._(/*BTDS*/"Privacy")}function y(){return h._(/*BTDS*/"Blocked contacts, disappearing messages")}function z(){return d("WAWebABProps").getABPropConfigValue("public_bug_reporting_settings")?h._(/*BTDS*/"Help and feedback"):h._(/*BTDS*/"Help")}function A(){return h._(/*BTDS*/"Help center, contact us, privacy policy")}function B(){return h._(/*BTDS*/"Keyboard shortcuts")}function C(){return h._(/*BTDS*/"Quick actions")}function D(){return h._(/*BTDS*/"Developer")}function E(){return h._(/*BTDS*/"Internal tools, feature flags, debug options")}function F(){return h._(/*BTDS*/"AB Props")}function G(){return h._(/*BTDS*/"Infra Settings")}function H(){return h._(/*BTDS*/"WWW Settings")}function I(){return h._(/*BTDS*/"Message notifications")}function J(){return h._(/*BTDS*/"Show notifications for new messages")}function K(){return h._(/*BTDS*/"Show previews")}function L(){return h._(/*BTDS*/"Get faster performance by syncing messages in the background")}function M(){return h._(/*BTDS*/"Play sounds for outgoing messages")}function N(){return h._(/*BTDS*/"Show reaction notifications")}function O(){return h._(/*BTDS*/"Call notifications")}function P(){return h._(/*BTDS*/"Show notifications for incoming calls")}function Q(){return h._(/*BTDS*/"Incoming calls")}function R(){return h._(/*BTDS*/"Play sounds for incoming calls")}function S(){return h._(/*BTDS*/"Incoming sounds")}function T(){return h._(/*BTDS*/"Play sounds for incoming messages")}function U(){return h._(/*BTDS*/"Last seen and online")}function V(){return h._(/*BTDS*/"Who can see my personal info")}function W(){return h._(/*BTDS*/"Profile photo")}function X(){return h._(/*BTDS*/"About")}function Y(){return h._(/*BTDS*/"Text Status")}function Z(){return h._(/*BTDS*/"Read receipts")}function $(){return h._(/*BTDS*/"Disable link previews")}function aa(){return h._(/*BTDS*/"Block unknown account messages")}function ba(){return h._(/*BTDS*/"Disappearing messages")}function ca(){return h._(/*BTDS*/"Status")}function da(){return h._(/*BTDS*/"Default message timer")}function ea(){return h._(/*BTDS*/"Groups")}function fa(){return h._(/*BTDS*/"Blocked contacts")}function ga(){return h._(/*BTDS*/"App lock")}function ha(){return h._(/*BTDS*/"Theme")}function ia(){return h._(/*BTDS*/"Light")}function ja(){return h._(/*BTDS*/"Dark")}function ka(){return h._(/*BTDS*/"System default")}function la(){return h._(/*BTDS*/"Help Center")}function ma(){return h._(/*BTDS*/"Frequently asked questions")}function na(){return h._(/*BTDS*/"Contact us")}function oa(){return h._(/*BTDS*/"Chat with support to get answers")}function pa(){return h._(/*BTDS*/"Rate the app")}function qa(){return h._(/*BTDS*/"Send feedback")}function ra(){return h._(/*BTDS*/"Technical issues, suggestions")}function sa(){return d("WAWebConnModel").Conn.isSMB?h._(/*BTDS*/"Terms"):h._(/*BTDS*/"Terms and Privacy Policy")}function ta(){var a=d("WAWebBizGatingUtils").showDataSharingInSettingsAfterCtwaMessageReceived()?h._(/*BTDS*/"Your customers' activity"):h._(/*BTDS*/"Ads data sharing");return a}function ua(){return h._(/*BTDS*/"Lists")}function va(){return h._(/*BTDS*/"Manage people and groups")}function wa(){return h._(/*BTDS*/"Log out")}function xa(){return h._(/*BTDS*/"Account")}function ya(){return h._(/*BTDS*/"Security notifications, account info")}function za(){return h._(/*BTDS*/"Chats")}function Aa(){return h._(/*BTDS*/"Theme, wallpaper, chat settings")}function Ba(){return h._(/*BTDS*/"How to delete my account")}function Ca(){return h._(/*BTDS*/"To protect your account and improve device performance, WhatsApp will block messages from unknown accounts if they exceed a certain volume.")}function Da(){return h._(/*BTDS*/"Status ad")}function Ea(){return h._(/*BTDS*/"View details on your phone")}g.wallpaperTitle=a;g.requestAccountInfoTitle=b;g.newsletterReportsTitle=c;g.businessToolsTitle=e;g.businessToolsBusinessProfileTitle=f;g.businessToolsCatalogTitle=i;g.businessToolsOrdersTitle=j;g.businessToolsAdvertiseTitle=k;g.businessToolsQuickRepliesTitle=l;g.businessToolsLabelsTitle=m;g.businessToolsHelpCenterTitle=n;g.notificationsTitle=o;g.notificationsSecondaryTitle=p;g.languageAndTimeTitle=q;g.languageHeaderTitle=r;g.languageTitle=s;g.timeFormatTitle=t;g.mediaAutoDownloadTitle=u;g.mediaUploadQualityTitle=v;g.securityTitle=w;g.privacyTitle=x;g.privacySecondaryTitle=y;g.helpTitle=z;g.helpSecondaryTitle=A;g.keyboardShortcutsTitle=B;g.keyboardShortcutsSecondaryTitle=C;g.developerTitle=D;g.developerSecondaryTitle=E;g.developerABPropsTitle=F;g.developerInfraSettingsTitle=G;g.developerWWWSettingsTitle=H;g.messageNotificationsTitle=I;g.messageNotificationsSubtitle=J;g.showPreviewsTitle=K;g.offlineSyncSubtitle=L;g.outgoingAudioToneSubtitle=M;g.showReactionsTitle=N;g.showCallsTitle=O;g.showCallsSubtitle=P;g.playCallRingtoneTitle=Q;g.playCallRingtoneSubtitle=R;g.soundsTitle=S;g.soundsSubtitle=T;g.privacyLastSeenOnlineEnabledTitle=U;g.privacyPersonalInfoHeaderTitle=V;g.privacyProfilePhotoTitle=W;g.privacyAboutTitle=X;g.privacyTextStatusTitle=Y;g.privacyReadReceiptsTitle=Z;g.privacyLinkPreviewsTitle=$;g.antiBrigadingTitle=aa;g.privacyDMTitle=ba;g.privacyStatusPostingTitle=ca;g.privacyDDMTitle=da;g.privacyGroupsTitle=ea;g.privacyBlockedTitle=fa;g.privacyScreenlockTitle=ga;g.themeTitle=ha;g.themeLightLabel=ia;g.themeDarkLabel=ja;g.themeSystemLabel=ka;g.helpCenterTitle=la;g.helpCenterSubtitle=ma;g.contactUsTitle=na;g.contactUsSubtitle=oa;g.rateTheApp=pa;g.sendFeedbackTitle=qa;g.sendFeedbackSubtitle=ra;g.termsTitle=sa;g.dataSharingTitle=ta;g.listsTitle=ua;g.listsSecondaryTitle=va;g.logoutTitle=wa;g.accountTitle=xa;g.accountSecondaryTitle=ya;g.chatsTitle=za;g.chatsSecondaryTitle=Aa;g.deleteAccountTitle=Ba;g.antiBrigadingDescription=Ca;g.wamoNonAGMMessagePreviewTitle=Da;g.wamoNonAGMMessagePreviewDescription=Ea}),226);
__d("WAWebBizCtwaAGMUtils",["fbt","WAWebABProps","WAWebBizGatingUtils","WAWebCtwaAGMUtils","WAWebMsgType","WAWebSettingsFBT","WAWebURLUtils"],(function(a,b,c,d,e,f,g,h){"use strict";function a(){return h._(/*BTDS*/"View details")}function b(a){return a===d("WAWebCtwaAGMUtils").AGM_SOURCE_APP.WHATSAPP&&d("WAWebBizGatingUtils").getWamoAgmEnabled()?d("WAWebSettingsFBT").wamoNonAGMMessagePreviewTitle():h._(/*BTDS*/"{ad source} ad",[h._param("ad source",a)])}function i(a){return c("WAWebURLUtils").withoutWww(c("WAWebURLUtils").hostname(a))}function e(a){if(a.sourceUrl==null)return null;a=i(a.sourceUrl);a=a.split(".")[0];return a==="fb"?"facebook":a}function f(a){return h._(/*BTDS*/"{ad source} Ad image preview",[h._param("ad source",a)])}function j(){return h._(/*BTDS*/"Error loading photo")}function k(a,b,c){var e=d("WAWebBizGatingUtils").getWamoAgmEnabled();a=a===d("WAWebCtwaAGMUtils").AGM_SOURCE_APP.FACEBOOK||a===d("WAWebCtwaAGMUtils").AGM_SOURCE_APP.INSTAGRAM;b=b===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE&&c===!0&&d("WAWebBizGatingUtils").getFmxAgmEnabled();return e?b:a&&b}function l(a){if(a.type===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE&&a.ctwaContext!=null){a=a.ctwaContext;a=d("WAWebCtwaAGMUtils").extractAGMPayload(a);return(a==null?void 0:a.ctaType)===d("WAWebCtwaAGMUtils").AGM_CTA_TYPE.FLOW?d("WAWebABProps").getABPropConfigValue("flows_wa_web"):!0}return!1}function m(a){var b;return l(a)&&k((b=a.ctwaContext)==null?void 0:b.sourceApp,a.type,((b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown)===!0)}function n(a){a=a.getAllMsgs();a=a.find(function(a){return a.type!==d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&a.type!==d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.type!==d("WAWebMsgType").MSG_TYPE.NOTIFICATION});return(a==null?void 0:a.type)===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE}g.getCtwaDetailsLabel=a;g.getAdSourceLabel=b;g.getHostnameLabel=e;g.getAdImageAlt=f;g.getAdImgError=j;g.isAutomatedGreetingMessage=k;g.isAGMFutureproof=m;g.isCtWAInitiatedChat=n}),226);
__d("WAWebMsgActionCapability",["WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebAck","WAWebBizCoexGatingUtils","WAWebBizCtwaAGMUtils","WAWebBotGating","WAWebBotGenTypingIndicatorMsg","WAWebBotProfileCollection","WAWebBusinessHSMTypes","WAWebChatGetters","WAWebChatGroupUtils","WAWebCommonMsgSubtypeTypes","WAWebContactGetters","WAWebContactModel","WAWebDisplayType","WAWebFrontendChatGetters","WAWebFrontendMsgGetters","WAWebInteractiveMessagesNativeFlowName","WAWebMediaTypes","WAWebMessageAssociation.flow","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMiscGatingUtils","WAWebMobilePlatforms","WAWebMsgGetters","WAWebMsgLinks","WAWebMsgModel","WAWebMsgType","WAWebNewsletterFutureProofUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMembershipUtil","WAWebPinMsgGatingUtils","WAWebPollCreationUtils","WAWebProtobufsE2E.pb","WAWebQuestionsGatingUtils","WAWebRevokeMsgConstants","WAWebSpamUtils","WAWebStateUtils","WAWebUserPrefsMultiDevice","cr:6009"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){return a.isWamoSub===!0&&!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(b)}function l(a){a=a.ctwaContext;return(a==null?void 0:a.sourceApp)==="whatsapp"}function m(a,b){return d("WAWebChatGetters").getIsNewsletter(b)&&a.isWamoSub===!0&&!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(b.newsletterMetadata)&&d("WAWebNewsletterGatingUtils").isWamoSubMessagesSupported()?!1:!0}function e(a,b){if(!q(a))return!1;if(b instanceof c("WAWebContactModel")||!d("WAWebChatGetters").getIsNewsletter(b))return!0;switch(a.type){case d("WAWebMsgType").MSG_TYPE.PTV:return d("WAWebNewsletterGatingUtils").isNewsletterPTVForwardingEnabled();case d("WAWebMsgType").MSG_TYPE.AUDIO:case d("WAWebMsgType").MSG_TYPE.PTT:return d("WAWebNewsletterGatingUtils").isNewsletterAudioFileSendingEnabled()||d("WAWebMsgGetters").getHasOriginatedFromNewsletter(a)}return d("WAWebNewsletterFutureProofUtils").isMsgTypeSupported(a.type)}function n(a,b,c){if(!a.isBot())return!0;if(!d("WAWebBotGating").isAiWebForwardEnabled())return!1;c=d("WAWebBotProfileCollection").BotProfileCollection.get(a);if((c==null?void 0:c.isDefault)!==!0)return!1;if(b.length!==1)return!1;a=b[0].type===d("WAWebMsgType").MSG_TYPE.CHAT;return a}function o(a,b){if(a.isNewsletter())return!0;return b.hasMusicAnnotations===!0?!1:!0}function f(a,b,c){c===void 0&&(c={});a=a.id;return n(a,b,c)&&o(a,c)}function p(a){return a.length===1&&a[0].type===d("WAWebMsgType").MSG_TYPE.CHAT}function q(a){a=d("WAWebStateUtils").unproxy(a);if(a.isCarouselCard||a.carouselCards)return!1;if(a.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL)return!1;var b=d("WAWebFrontendMsgGetters").getMaybeChat(a);if(b!=null&&b.isSuspendedOrTerminated()&&d("WAWebMiscGatingUtils").isGroupSuspendV2Enabled())return!1;var c=b!=null&&d("WAWebChatGetters").getIsNewsletter(b);if(c){if(!d("WAWebNewsletterGatingUtils").isNewsletterMessageForwardSendingEnabled())return!1;if(b!=null&&!m(a,b))return!1}if(d("WAWebMsgGetters").getIsQuestion(a)&&!d("WAWebQuestionsGatingUtils").isQuestionForwardingEnabledForMsg(a))return!1;if(d("WAWebMsgGetters").getQuestionReplyQuotedMessage(a)!=null&&!d("WAWebQuestionsGatingUtils").isQuestionReplyForwardingEnabledForMsg(a))return!1;switch(a.type){case d("WAWebMsgType").MSG_TYPE.CALL_LOG:case d("WAWebMsgType").MSG_TYPE.CIPHERTEXT:case d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER:case d("WAWebMsgType").MSG_TYPE.EVENT_CREATION:case d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE:case d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE:case d("WAWebMsgType").MSG_TYPE.ORDER:case d("WAWebMsgType").MSG_TYPE.OVERSIZED:case d("WAWebMsgType").MSG_TYPE.PAYMENT:case d("WAWebMsgType").MSG_TYPE.QUARANTINED:case d("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER:case d("WAWebMsgType").MSG_TYPE.REVOKED:case d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE:case d("WAWebMsgType").MSG_TYPE.UNKNOWN:return!1;case d("WAWebMsgType").MSG_TYPE.POLL_CREATION:return c&&a.pollContentType!==d("WAWebPollCreationUtils").PollContentType.IMAGE&&d("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled();case d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT:return d("WAWebNewsletterGatingUtils").isNewsletterPollForwardingEnabled();case d("WAWebMsgType").MSG_TYPE.LIST:return((b=a.list)==null?void 0:b.listType)===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST}if(a.type===d("WAWebMsgType").MSG_TYPE.LOCATION&&a.isLive)return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.nativeFlowName!=null)return!1;if(!a.interactiveButtonsReleased())return!1;if(a.ack<d("WAWebAck").ACK.SENT&&d("WAWebMsgGetters").getIsSentByMe(a))return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&a.subtype===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE)return!1;if(d("WAWebFrontendMsgGetters").getAsMms(a)){b=a.mediaData;if(b.mediaStage===d("WAWebMediaTypes").MediaDataStage.EXISTS)return!0;if(b.mediaStage===d("WAWebMediaTypes").MediaDataStage.ERROR_MISSING)return!1;if(b.mediaStage===d("WAWebMediaTypes").MediaDataStage.ERROR_UNSUPPORTED)return!1;if(b.mediaStage!==d("WAWebMediaTypes").MediaDataStage.RESOLVED&&(a.type===d("WAWebMsgType").MSG_TYPE.IMAGE||a.type===d("WAWebMsgType").MSG_TYPE.VIDEO||a.type===d("WAWebMsgType").MSG_TYPE.PTV||a.type===d("WAWebMsgType").MSG_TYPE.PTT)&&(!d("WAWebMsgGetters").getIsNewsletterMsg(a)||!d("WAWebNewsletterGatingUtils").isNewsletterQuickForwardingEnabled()))return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.PTV)if(c){if(!d("WAWebNewsletterGatingUtils").isNewsletterPTVForwardingEnabled())return!1}else if(!d("WAWebMsgGetters").getIsSentByMe(a))return!1;if(a.isViewOnce)return!1;if(d("WAWebFrontendMsgGetters").getIsUnsentMedia(a))return!1}if((b=a.nativeFlowButtons)!=null&&b.length)return!1;if(a.hsmTag===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION)return!1;if(d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((c=a.ctwaContext)==null?void 0:c.sourceApp,a.type,(b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown))return!1;return l(a)?!1:!0}function r(a){var b=d("WAWebStateUtils").unproxy(a);return!q(a)||d("WAWebMsgGetters").getIsFrequentlyForwarded(b)||d("WAWebMsgLinks").getSuspiciousLinks(b).length!==0||d("WAWebFrontendMsgGetters").getAsPttLike(b)!=null||b.type===d("WAWebMsgType").MSG_TYPE.STICKER||!b.interactiveButtonsReleased()||d("WAWebChatGetters").getIsNewsletter(d("WAWebFrontendMsgGetters").getChat(b))&&d("WAWebNewsletterGatingUtils").isNewsletterQuickForwardingEnabled()?!1:d("WAWebFrontendMsgGetters").getAsMms(b)!=null||d("WAWebMsgGetters").getLinkPreview(b)||b.type===d("WAWebMsgType").MSG_TYPE.VCARD||b.type===d("WAWebMsgType").MSG_TYPE.LOCATION||b.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION||b.type===d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT||b.ctwaContext!=null}function s(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebChatGetters").getIsNewsletter(d("WAWebFrontendMsgGetters").getChat(a)))return!1;if(a.isCarouselCard)return!1;return a.ctwaContext!=null&&d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage(a.ctwaContext.sourceApp,a.type,a.ctwaContext.automatedGreetingMessageShown)?!1:(!d("WAWebMsgGetters").getIsEphemeral(a)||a.supportsStarWithKeepInChat())&&!d("WAWebMsgGetters").getIsNotification(a)&&!d("WAWebMsgGetters").getIsFutureproof(a)&&!a.isViewOnce&&a.type!==d("WAWebMsgType").MSG_TYPE.REVOKED&&a.type!==d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER&&!(a.ack<d("WAWebAck").ACK.SENT&&d("WAWebMsgGetters").getIsSentByMe(a))&&a.interactiveButtonsReleased()&&!d("WAWebFrontendMsgGetters").getAsAlbum(a)}function t(a){a=d("WAWebStateUtils").unproxy(a);var b=d("WAWebFrontendMsgGetters").getChat(a);if(a.isViewOnce===!0||a.subtype==="view_once_unavailable_fanout")return!1;if(d("WAWebChatGetters").getIsNewsletter(b)||b.id.isBot())return!1;if(a.isCarouselCard)return!1;if(d("WAWebMsgGetters").getIsGroupMsg(a)){b=c("WANullthrows")(b.groupMetadata);if(!b.participants.iAmMember())return!1;if((b.restrict||b.announce)&&!b.participants.iAmAdmin())return!1}return d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((b=a.ctwaContext)==null?void 0:b.sourceApp,a.type,(b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown)?!1:!d("WAWebMsgGetters").getIsNotification(a)&&!d("WAWebMsgGetters").getIsFutureproof(a)&&!d("WAWebMsgGetters").getIsViewOnce(a)&&a.type!==d("WAWebMsgType").MSG_TYPE.REVOKED&&a.type!==d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER&&!(a.ack<d("WAWebAck").ACK.SENT&&d("WAWebMsgGetters").getIsSentByMe(a))&&a.interactiveButtonsReleased()&&!a.isExpiredAndNotKept()&&d("WAWebPinMsgGatingUtils").isPinnedMessagesM1SenderEnabled()&&!d("WAWebFrontendMsgGetters").getAsAlbum(a)}function u(a,b){var c,e;b===void 0&&(b=!1);if(d("WAWebMsgGetters").getIsBotQuery(a))return!1;var f=d("WAWebFrontendMsgGetters").getChat(a);if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&f!=null&&(c=f.id)!=null&&c.isUser()&&((f==null||(e=f.contact)==null?void 0:e.isHosted)===!0||d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()===!0)&&!d("WAWebABProps").getABPropConfigValue("coex_edit_msg_enabled"))return!1;f=d("WAWebMsgGetters").getIsEdited(a)&&d("WAWebMsgGetters").getIsFailed(a)&&!b||!a.mayFail();return d("WAWebChatGetters").getIsNewsletter(d("WAWebFrontendMsgGetters").getChat(a))?d("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled()&&d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(d("WAWebFrontendMsgGetters").getChat(a).newsletterMetadata)&&f&&!a.isForwarded:d("WAWebMsgGetters").getIsSentByMe(a)&&!a.isForwarded&&a.local&&(d("WAWebMessageEditGatingUtils").sendCagMsgEditEnabled()||!d("WAWebFrontendChatGetters").getIsCAG(d("WAWebFrontendMsgGetters").getChat(a)))&&f&&d("WAWebFrontendMsgGetters").getChat(a).canSend&&!d("WAWebFrontendMsgGetters").getChat(a).contact.isEnterprise}function v(a){var b=d("WAWebMsgGetters").getIsGroupMsg(a),c=d("WAWebMsgGetters").getIsSentByMe(a),e=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata;return!d("WAWebABProps").getABPropConfigValue("report_to_admin_kill_switch")||c||a.isViewOnce||d("WAWebChatGetters").getIsNewsletter(d("WAWebFrontendMsgGetters").getChat(a))||d("WAWebMsgGetters").getIsMetaBotResponse(a)||!b?!1:Boolean(e==null?void 0:e.reportToAdminMode)}function w(a,b){b===void 0&&(b=!1);return(d("WAWebMsgGetters").getIsNewsletterMsg(a)?d("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():d("WAWebMessageEditGatingUtils").sendTextEditEnabled())&&d("WAWebMessageEditUtils").getMsgEditType(a.type)===d("WAWebMessageEditUtils").MsgEditType.TextEdit&&u(a,b)}function x(a,b){b===void 0&&(b=!1);return(d("WAWebMsgGetters").getIsNewsletterMsg(a)?d("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled():d("WAWebMessageEditGatingUtils").sendCaptionEditEnabled())&&d("WAWebMessageEditUtils").getMsgEditType(a.type)===d("WAWebMessageEditUtils").MsgEditType.CaptionEdit&&Boolean(a.caption)&&d("WAWebFrontendMsgGetters").getAsViewOnce(a)==null&&u(a,b)}function y(a){switch(a){case d("WAWebDisplayType").DISPLAY_TYPE.CONVERSATION:case d("WAWebDisplayType").DISPLAY_TYPE.ANNOUNCEMENT:return!0;case d("WAWebDisplayType").DISPLAY_TYPE.NEWSLETTER:return d("WAWebNewsletterGatingUtils").isNewsletterMessageEditingEnabled();default:return!1}}function z(a){if((b("cr:6009")==null?void 0:b("cr:6009").messageEditRestrictionEnabled())===!1)return!0;a=d("WAWebStateUtils").unproxy(a);return d("WAWebMsgGetters").getIsQuestion(a)?!1:(w(a,!0)||x(a,!0))&&d("WAWebMessageEditUtils").isParentWithinEditUIWindow({parentTsInSeconds:a.t,msgKey:a.id})}function A(a){if((b("cr:6009")==null?void 0:b("cr:6009").messageEditRestrictionEnabled())===!1)return!0;a=d("WAWebStateUtils").unproxy(a);return d("WAWebMsgGetters").getIsQuestion(a)?!1:w(a)&&d("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:a.t,msgKey:a.id})}function B(a){if((b("cr:6009")==null?void 0:b("cr:6009").messageEditRestrictionEnabled())===!1)return!0;a=d("WAWebStateUtils").unproxy(a);return d("WAWebMsgGetters").getIsQuestion(a)?!1:x(a)&&d("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:a.t,msgKey:a.id})}function C(a){var b;a=d("WAWebStateUtils").unproxy(a);if(d("WAWebMsgGetters").getIsSentByMe(a)||d("WAWebMsgGetters").getIsPSA(a)||d("WAWebMsgGetters").getIsBotResponse(a))return!1;if(d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((b=a.ctwaContext)==null?void 0:b.sourceApp,a.type,(b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown))return!1;return a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&(a==null?void 0:a.nativeFlowName)===c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW?!0:d("WAWebSpamUtils").isMsgTypeSupportedForMsgLevelReporting(a.type)}function D(a){return d("WATimeUtils").unixTime()-d("WAWebMsgGetters").getT(a)<=d("WAWebRevokeMsgConstants").NEWSLETTER_REVOKE_WINDOW}function E(a){var b,c=d("WAWebFrontendMsgGetters").getCurrentChat(a);if(!d("WAWebChatGetters").getIsNewsletter(c)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["canRevokeNewsletterMsg called on a non-newsletter chat"])));return!1}if(G(a))return!1;b=((b=a.ack)!=null?b:d("WAWebAck").ACK.CLOCK)<d("WAWebAck").ACK.CLOCK;return(D(a)||b)&&d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(c.newsletterMetadata)}function F(a){var b=d("WAWebFrontendMsgGetters").getChat(a);if(!d("WAWebChatGetters").getIsNewsletter(b))return!1;if(!D(a))return!1;if(b.newsletterMetadata==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat doesn't have newsletter metadata, will be impossible to generate message link"])));return!1}if(b.newsletterMetadata.inviteCode==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["chat doesn't have a newsletter invite code, will be impossible to generate message link"])));return!1}if(a.serverId==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["msg doesn't have a server ID, will be impossible to generate message link"])));return!1}if(a.type===d("WAWebMsgType").MSG_TYPE.REVOKED)return!1;return!m(a,b)?!1:!0}function G(a){var b=!1;a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&((a.subtype===d("WAWebCommonMsgSubtypeTypes").MsgSubtype.AdminRevoke||d("WAWebCommonMsgSubtypeTypes").MsgSubtype.SenderRevoke)&&(b=!0));return b||a.type===d("WAWebMsgType").MSG_TYPE.REVOKED}function H(a){var b;if(G(a))return!1;var c=d("WAWebFrontendMsgGetters").getCurrentChat(a);if(d("WAWebChatGetters").getIsNewsletter(c))return E(a);if(d("WAWebChatGetters").getIsGroup(c)&&!((b=c.groupMetadata)!=null&&b.participants.iAmMember())||d("WAWebContactGetters").getIsMe(c.contact)||c.contact.isEnterprise&&!c.contact.id.isBot()||d("WAWebFrontendChatGetters").getIsCapiHostedGroup(c))return!1;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&!d("WAWebChatGetters").getIsGroup(c)&&(c.contact.isHosted===!0||d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()))return!1;return a.type===d("WAWebMsgType").MSG_TYPE.COMMENT?a.ack!=null&&a.ack>=d("WAWebAck").ACK.SENT:d("WAWebMsgGetters").getIsUserCreatedType(a)&&!(a.broadcast!=null&&a.broadcast)&&(a instanceof d("WAWebMsgModel").Msg&&!a.isUnsentPhoneMsg()||d("WAWebMsgGetters").getIsEdited(a))&&!d("WAWebFrontendMsgGetters").getIsUnsentMedia(a)&&!d("WAWebChatGroupUtils").isSuspendedGroup(d("WAWebFrontendMsgGetters").getCurrentChat(a))&&!d("WAWebChatGroupUtils").isTerminatedGroup(d("WAWebFrontendMsgGetters").getCurrentChat(a))}function I(a){var b=a;a instanceof d("WAWebMsgModel").Msg&&(b=d("WAWebStateUtils").unproxy(a));a=d("WATimeUtils").unixTime()-d("WAWebMsgGetters").getT(b)<=d("WAWebRevokeMsgConstants").REVOKE_WINDOW;return H(b)&&b.id.fromMe&&a}function J(a){var b=a;a instanceof d("WAWebMsgModel").Msg&&(b=d("WAWebStateUtils").unproxy(a));a=d("WAWebFrontendMsgGetters").getCurrentChat(b);if(d("WAWebChatGetters").getIsNewsletter(a))return E(b);var c=d("WATimeUtils").unixTime()-d("WAWebMsgGetters").getT(b)<=d("WAWebRevokeMsgConstants").REVOKE_WINDOW;return H(b)&&!b.id.fromMe&&Boolean((b=a.groupMetadata)==null?void 0:b.participants.iAmAdmin())&&c}function K(a){var b=a;a instanceof d("WAWebMsgModel").Msg&&(b=d("WAWebStateUtils").unproxy(a));a=d("WAWebRevokeMsgConstants").REVOKE_WINDOW;var c=d("WAWebMsgGetters").isMetaBotResponseToMyInvoke(b);a=d("WATimeUtils").unixTime()-d("WAWebMsgGetters").getT(b)<=a;return d("WAWebBotGating").isBotEnabled()&&H(b)&&a&&c}function L(a,b){var c;a=d("WAWebStateUtils").unproxy(a);if(d("WAWebFrontendMsgGetters").getChat(a).isSuspendedOrTerminated()&&d("WAWebMiscGatingUtils").isGroupSuspendV2Enabled())return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.STICKER_PACK)return!1;if(d("WAWebFrontendMsgGetters").getAsRevoked(a))return!1;if(a.isViewOnce)return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.VCARD||a.type===d("WAWebMsgType").MSG_TYPE.MULTI_VCARD)return!0;if(!((c=a.mediaData)!=null&&c.isDownloadable())&&b!==!0)return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.STICKER)return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.PTV&&!d("WAWebMsgGetters").getIsSentByMe(a))return!1;return!m(a,d("WAWebFrontendMsgGetters").getChat(a))?!1:!0}function M(a){var b=d("WAWebFrontendMsgGetters").getChat(a);return!d("WAWebMobilePlatforms").isSMB()||d("WAWebChatGetters").getIsNewsletter(b)?!1:!d("WAWebFrontendMsgGetters").getAsRevoked(a)}function N(a){var b;return d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((b=a.ctwaContext)==null?void 0:b.sourceApp,a.type,(b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown)?!1:!d("WAWebChatGetters").getIsNewsletter(d("WAWebFrontendMsgGetters").getChat(a))||E(a)}g.isWamoSubMsgAndNotAdminOrOwner=a;g.isWamoMsg=l;g.canWamoSubMsgBeSharedByUser=m;g.canForwardMsgToChat=e;g.allowedChatOrContactForForwarding=f;g.canForwardMsgToMetaAi=p;g.canForwardMsg=q;g.canQuickForwardMsg=r;g.canStarMsg=s;g.canPinMsg=t;g.canReportToAdmin=v;g.displayTypeSupportsEditing=y;g.canEnterEditingFlow=z;g.canEditText=A;g.canEditCaption=B;g.canReportMsg=C;g.isNewsletterMsgOnServer=D;g.canRevokeNewsletterMsg=E;g.canCopyNewsletterMessageLink=F;g.canSenderRevokeMsg=I;g.canAdminRevokeMsg=J;g.canBotResponseBeRevokeByInvoker=K;g.canDownloadMsg=L;g.canAddLabelToMsg=M;g.canDeleteMsg=N}),98);
__d("WAWebFtsConstants",[],(function(a,b,c,d,e,f){a=60*1e3;b=300;c=30;f.FTS_TTL=a;f.FTS_TYPING_DELAY=b;f.FTS_NUM_RESULTS=c}),66);
__d("WAWebMsgOpaqueData",["WAWebDBMsgOpaqueDataKeys","WAWebMsgKey","WAWebPollsDbUtils","WAWebProtobufsMdStorageMsgRowOpaqueData.pb","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUserPrefsInfoStore").waNoiseInfo.cachedPasscodeDerivedKey;if(b==null){location.reload();return}var c=k(a),e=new Uint8Array(16);self.crypto.getRandomValues(e);b=(yield self.crypto.subtle.encrypt({iv:e,name:"AES-GCM"},b,c));a.encryptedData={iv:e,data:b}});return h.apply(this,arguments)}function e(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.encryptedData;if(c==null)return;b=(yield self.crypto.subtle.decrypt({iv:c.iv,name:"AES-GCM"},b,c.data));j(a,b);a.encryptedData=null});return i.apply(this,arguments)}function j(a,b){b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,b);var c=b.currentMsg;b=b.quotedMsg;c&&m(a,c);a.quotedMsg&&b&&m(a.quotedMsg,c);a.encryptedData=null}function k(a){var b={currentMsg:{},quotedMsg:{}};b.currentMsg=l(a);a.quotedMsg&&(b.quotedMsg=l(a.quotedMsg));a=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,b);return a.readBuffer()}var l=function(a){var b,c={};(b=a.paymentNoteMsg)!=null&&b.body&&(c.paymentNoteMsgBody=a.paymentNoteMsg.body,a.paymentNoteMsg.body=void 0);d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){a[b]&&d("WAWebDBMsgOpaqueDataKeys").MsgKeyFieldsInOpaqueData.includes(b)?c[b]=a[b].toString():c[b]=a[b],a[b]=void 0});c.pollOptions=d("WAWebPollsDbUtils").compressPollOptions(a.pollOptions);a.pollOptions=void 0;c.pollVotesSnapshot=d("WAWebPollsDbUtils").compressPollVotesSnapshot(a.pollVotesSnapshot);a.pollVotesSnapshot=void 0;return c},m=function(a,b){b.paymentNoteMsgBody!=null&&a.paymentNoteMsg&&(a.paymentNoteMsg.body=b==null?void 0:b.paymentNoteMsgBody),d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(e){var f=b[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,e)];f&&d("WAWebDBMsgOpaqueDataKeys").MsgKeyFieldsInOpaqueData.includes(e)?a[e]=c("WAWebMsgKey").fromString(f):a[e]=f}),a.pollOptions=d("WAWebPollsDbUtils").expandPollOptions(b==null?void 0:b.pollOptions),a.pollVotesSnapshot=d("WAWebPollsDbUtils").expandPollVotesSnapshot(b==null?void 0:b.pollVotesSnapshot)};g.encryptDataInMsgModel=a;g.decryptDataInMsgModel=e}),98);
__d("WAWebMsgCollection",["Promise","WALogger","WANullthrows","WAPromiseProps","WATimeUtils","WATypeUtils","WAWebAck","WAWebBackendErrors","WAWebBaseCollection","WAWebBotGenTypingIndicatorMsg","WAWebChatCollection","WAWebCollectionConstants","WAWebCollectionUtils","WAWebDBMessageFindLocal","WAWebDBMsgUtils","WAWebEventsWaitForBbEvent","WAWebFrontendMsgGetters","WAWebFtsConstants","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLidMigrationUtils","WAWebMessageAssociationUIUtils","WAWebMsgDataFromModel","WAWebMsgGetters","WAWebMsgModel","WAWebMsgOpaqueData","WAWebMsgType","WAWebNewsletterMsgHistoryUtils","WAWebNewsletterViewModeUIUtils","WAWebNoop","WAWebProcessMultipleMsgsAction","WAWebProductMessageListCollection","WAWebProtobufsE2E.pb","WAWebSyncButtonState","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWid","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=50;a=function(a){function e(){var e;e=a.call(this)||this;e.pendingAdd={};e.ftsCache={};e.productListMessagesPrefetchChain=(D||(D=b("Promise"))).resolve([]);e._editKeyByParentKey=new Map();e._parentKeyByEditKey=new Map();e._encryptedData=null;e.findQueryImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var f=e,g;switch(a.direction){case"before":case"after":g=a.direction;break;default:g="before";break}var k={add:g,isHistory:!0};d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery: start ",", ",""])),a,g);var l=(yield d("WAWebDBMessageFindLocal").msgFindQuery(g,a));if(l.status>=400){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery error ",""])),l.status);return(D||(D=b("Promise"))).reject(l.status)}var m=f.get(a);c("WAWebWid").isNewsletter(a.remote)&&m!=null&&(l=(yield d("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:a.remote,msgs:g==="before"?l.concat(d("WAWebMsgDataFromModel").msgDataFromMsgModel(m)):[d("WAWebMsgDataFromModel").msgDataFromMsgModel(m)].concat(l),serverIdsToSkip:d("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(a.remote)})));m=function(){var b=f.get(a);if(b!=null)return b.msgChunk;b=d("WAWebChatCollection").ChatCollection.get(a.remote);return b!=null?b.msgs:void 0};l.forEach(function(a){a.invis=!0});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:findQuery:got:",":",""])),l.length,a.direction);return f.processMultipleMessages(a.remote,l,k,"msgCollectionFindQuery",m)});return function(b){return a.apply(this,arguments)}}();e.byParentMessage=d("WAWebCollectionUtils").aggregated(function(a){var b=a.parentMsgKey;a=a.type;return a===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||a===d("WAWebMsgType").MSG_TYPE.UNKNOWN?"UNCATEGORIZED":b},{subscribeToKey:"parentMsgKey"});e.byChat=d("WAWebCollectionUtils").aggregated(function(a){a=a.id;return a.remote});e.listenTo(e,"remove",e.removeFromCollection);return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.removeFromCollection=function(a){var b=d("WAWebFrontendMsgGetters").getMaybeChat(a);b==null||b.removeFromCollection(a)};f.add=function(b,e){b=Array.isArray(b)?b:[b];b=b.filter(function(a){if(a.ephemeralDuration==null||a.ephemeralDuration===0)return!0;a=new(d("WAWebMsgModel").Msg)(a);return!a.isExpiredAndNotKept()});b=a.prototype.add.call(this,b,e);this.makeParentMessagesVisibleInChat(b);c("WAWebSyncButtonState")(b);this._prefetchProductListMessages(b);this.processVCardMessagesForLidMappings(b);this.processEditedMessages(b);return b};f.makeParentMessagesVisibleInChat=function(a){var b=this;a.filter(Boolean).forEach(function(a){var c=a.parentMsgKey;a=a.viewMode;if(c&&!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a)){var e;a=b.get(c);a&&(e=d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&e.includes(a.type)&&!d("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:a,duringDetach:!1})&&!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a==null?void 0:a.viewMode)&&a.set("viewMode",d("WAWebViewMode.flow").ViewModeType.VISIBLE)}})};f.processVCardMessagesForLidMappings=function(a){a=a.reduce(function(a,b){if(b==null)return a;if(b.type!==d("WAWebMsgType").MSG_TYPE.VCARD&&b.type!==d("WAWebMsgType").MSG_TYPE.MULTI_VCARD)return a;b=b.type===d("WAWebMsgType").MSG_TYPE.VCARD?b.getVcardWids():b.getMultiVcardWids();if(b==null)return a;b=b.filter(function(a){return d("WAWebLidMigrationUtils").toUserLid(a)==null});if(b.length===0)return a;if(a==null)return new Set(b);b.forEach(function(b){return a.add(b)});return a},null);if(a==null)return;d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:Array.from(a),shouldSyncDevice:!1,mode:"query"})};f._prefetchProductListMessages=function(a){this.productListMessagesPrefetchChain=a.filter(function(a){var b;return a!=null&&a.isNewMsg&&a.type===d("WAWebMsgType").MSG_TYPE.LIST&&((b=a.list)==null?void 0:b.listType)===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST&&((b=a.list)==null?void 0:b.productListInfo)!=null}).reduce(function(a,b){var c;if(b==null)return a;var e=b.requiresDirectConnection,f=b.isForwarded?b.businessOwnerJid:b.from.toString({legacy:!0});c=(c=b.list)==null?void 0:c.productListInfo;if(f==null||c==null)return a;var g=d("WAWebProductMessageListCollection").ProductMessageListCollection.getOrAdd(b.id,c,e,f,(c=b.list)==null?void 0:c.title);return g!=null&&g.productCollection.getModelsArray().length===0&&!g.isFetching()?a.then(function(){return d("WAWebProductMessageListCollection").ProductMessageListCollection.update(g.id)}):a},this.productListMessagesPrefetchChain)};f.getStarred=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){c={count:typeof c==="number"&&!isNaN(c)?c:d("WAWebCollectionConstants").PAGE_SIZE,chat:a?a:void 0,remote:e==null?void 0:e.remote,id:e==null?void 0:e.id,fromMe:e==null?void 0:e.fromMe,participant:e==null?void 0:e.participant};a={add:"search"};e=(yield d("WAWebDBMessageFindLocal").msgFindQuery("star",c));c=e.status;if(e.status>=400){c===499?d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getStarred error 499 (unimplemented)"]))):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getStarred error ",""])),c);return(D||(D=b("Promise"))).reject(c)}return this.processMultipleMessages(void 0,e,a,"msgCollectionGetStarred")});function c(b,c,d){return a.apply(this,arguments)}return c}();f.getEventMsgs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b={count:typeof b==="number"&&!Number.isNaN(b)?b:d("WAWebCollectionConstants").PAGE_SIZE,chat:a,remote:c==null?void 0:c.remote,id:c==null?void 0:c.id,fromMe:c==null?void 0:c.fromMe,participant:c==null?void 0:c.participant};a={add:"search"};c=(yield d("WAWebDBMessageFindLocal").msgFindQuery("event",b));b=c.status;if(c.status>=400){b===499?d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getEventMsgs error 499 (unimplemented)"]))):d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getEventMsgs error ",""])),b);throw new(d("WAWebBaseCollection").CollectionSilentQueryError)(b)}return this.processMultipleMessages(void 0,c,a,"msgCollectionGetEvents")});function c(b,c,d){return a.apply(this,arguments)}return c}();f.getVoipCallLogMsgs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a={count:typeof a==="number"&&!isNaN(a)?a:d("WAWebCollectionConstants").PAGE_SIZE,chat:void 0,remote:c==null?void 0:c.remote,id:c==null?void 0:c.id,fromMe:c==null?void 0:c.fromMe,participant:c==null?void 0:c.participant};c=(yield d("WAWebDBMessageFindLocal").msgFindQuery("call_log",a));a=c.status;if(c.status>=400){a===499?d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getVoipCallLogMsgs error 499 (unimplemented)"]))):d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getVoipCallLogMsgs error ",""])),a);return(D||(D=b("Promise"))).reject(a)}return this.processMultipleMessages(void 0,c,{add:"search"},"msgCollectionGetVoipCallLogs")});function c(b,c){return a.apply(this,arguments)}return c}();f.getAllMediaMsgs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a={count:a!=null?a:E,chat:void 0,remote:c==null?void 0:c.remote,id:c==null?void 0:c.id,fromMe:c==null?void 0:c.fromMe,participant:c==null?void 0:c.participant,media:"allMedia"};c=(yield d("WAWebDBMessageFindLocal").msgFindQuery("media",a));a=c.status;if(c.status!=null&&c.status>=400){a===499?d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllMediaMsgs error 499 (unimplemented)"]))):d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllMediaMsgs error ",""])),a);return(D||(D=b("Promise"))).reject(a)}return this.processMultipleMessages(void 0,Array.isArray(c)?c:c.messages,{add:"search"},"msgCollectionGetAllMedia")});function c(b,c){return a.apply(this,arguments)}return c}();f.getAllLinksMsgs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a={count:a!=null?a:E,chat:void 0,remote:c==null?void 0:c.remote,id:c==null?void 0:c.id,fromMe:c==null?void 0:c.fromMe,participant:c==null?void 0:c.participant,media:"allLinks"};c=(yield d("WAWebDBMessageFindLocal").msgFindQuery("media",a));a=c.status;if(c.status!=null&&c.status>=400){a===499?d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllLinksMsgs error 499 (unimplemented)"]))):d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllLinksMsgs error ",""])),a);return(D||(D=b("Promise"))).reject(a)}return this.processMultipleMessages(void 0,Array.isArray(c)?c:c.messages,{add:"search"},"msgCollectionGetAllMedia")});function c(b,c){return a.apply(this,arguments)}return c}();f.getAllDocsMsgs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a={count:a!=null?a:E,chat:void 0,remote:c==null?void 0:c.remote,id:c==null?void 0:c.id,fromMe:c==null?void 0:c.fromMe,participant:c==null?void 0:c.participant,media:"allDocs"};c=(yield d("WAWebDBMessageFindLocal").msgFindQuery("media",a));a=c.status;if(c.status!=null&&c.status>=400){a===499?d("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllDocsMsgs error 499 (unimplemented)"]))):d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:getAllDocsMsgs error ",""])),a);return(D||(D=b("Promise"))).reject(a)}return this.processMultipleMessages(void 0,Array.isArray(c)?c:c.messages,{add:"search"},"msgCollectionGetAllMedia")});function c(b,c){return a.apply(this,arguments)}return c}();f.getMessagesById=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(a));return d("WAPromiseProps").promiseProps({messages:this.processMultipleMessages(void 0,a,{add:"search"},"msgCollectionGetMessagesById"),eof:!0,canceled:!1})});function c(b){return a.apply(this,arguments)}return c}();f.hydrateOrGetMessages=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,e=a.filter(function(a){return!b.get(a)});if(e.length>0){var f=(yield this.getMessagesById(e));f=f.messages;if(f.length!==e.length)throw new(d("WAWebBaseCollection").CollectionSilentQueryError)("No message found for one or more ids")}return a.map(function(a){return c("WANullthrows")(b.get(a))})});function e(b){return a.apply(this,arguments)}return e}();f.queryVcard=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebDBMessageFindLocal").queryVcard(a));return this.processMultipleMessages(void 0,a,{add:"search"},"msgCollectionQueryVCard")});function c(b){return a.apply(this,arguments)}return c}();f.incrementalStarredUpdate=function(a){return this.processMultipleMessages(void 0,a,{add:"search"},"msgCollectionIncrementalStarredUpdate")};f.search=function(a,b,c,e,f){var g=this;b===void 0&&(b=1);f===void 0&&(f={});var h=a+"__"+(f.label||f.kind&&f.kind||"");if(b===1&&!e){var i=this.ftsCache[h];if(i)return i;i=this._search(a,b,c,e,f.label,f.kind);this.ftsCache[h]=i;var j=function(){g.ftsCache[h]=null};self.setTimeout(j,d("WAWebFtsConstants").FTS_TTL);i["catch"](j);return i}return this._search(a,b,c,e,f.label,f.kind)};f._search=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,h){a={searchTerm:a,page:d("WATypeUtils").isNumber(c)&&c!==0?c:1,count:d("WATypeUtils").isNumber(e)&&e!==0?e:d("WAWebCollectionConstants").PAGE_SIZE,remote:f,tagToCancel:f?this.pendingSearchTag:void 0,label:g,kind:h};c={add:"search"};e=(yield d("WAWebDBMessageFindLocal").msgFindQuery("search",a));a.tagToCancel===this.pendingSearchTag&&(this.pendingSearchTag=void 0);if(e.status===499)return d("WAPromiseProps").promiseProps({messages:(D||(D=b("Promise"))).resolve([]),eof:!1,canceled:!0});else if(e.status===404)return(D||(D=b("Promise"))).reject(new(d("WAWebBackendErrors").E404)());else if(e.status>=400){d("WALogger").WARN(w||(w=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:search error ",""])),e.status);return(D||(D=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(e.status,"failed to find a msg during fts"))}f=Array.isArray(e)?e:e.messages;g=Array.isArray(e)?!0:e.eof;h=f.filter(function(a){return(a==null?void 0:a.isGroupStatus)!==!0});return d("WAPromiseProps").promiseProps({messages:this.processMultipleMessages(void 0,h,c,"msgCollectionSearch"),eof:g,canceled:!1})});function c(b,c,d,e,f,g){return a.apply(this,arguments)}return c}();f.queryMedia=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){a={remote:a,count:d("WATypeUtils").isNumber(c)&&c!==0?c:d("WAWebCollectionConstants").PAGE_SIZE,id:f==null?void 0:f.id,fromMe:f==null?void 0:f.fromMe,participant:f==null?void 0:f.participant,direction:e||"before",media:g,msgKey:f};c={add:"search"};e=(yield d("WAWebDBMessageFindLocal").msgFindQuery("media",a));if(e.status>=400){d("WALogger").WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["model:Msg:media error ",""])),e.status);return e.status===404?(D||(D=b("Promise"))).reject(new(d("WAWebBackendErrors").E404)()):(D||(D=b("Promise"))).reject(new(d("WAWebBackendErrors").ServerStatusCodeError)(e.status,"failed to find a msg during media query"))}return!g?d("WAPromiseProps").promiseProps({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:this.processMultipleMessages(void 0,e.messages,c,"msgCollectionQueryMedia")}):this.processMultipleMessages(void 0,e,{add:"search"},"msgCollectionQueryMedia")});function c(b,c,d,e,f){return a.apply(this,arguments)}return c}();f.getContext=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this,g=this.get(a),h=c("WAWebWid").isNewsletter(a.remote);if(g&&!g.fromQuotedMsg)return(D||(D=b("Promise"))).all([d("WAWebDBMessageFindLocal").msgFindQuery("before",a),d("WAWebDBMessageFindLocal").msgFindQuery("after",a)]).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var i=c[0];c=c[1];if((!Array.isArray(i)||!Array.isArray(c))&&!h){d("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext fetch error"]))).devConsole(i,c);throw i.status||c.status}i=Array.isArray(i)?i:[];c=Array.isArray(c)?c:[];var j=g.serverId;g.search=!1;return(D||(D=b("Promise"))).all([f.processMultipleMessages(a.remote,!h||j==null?i:yield d("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:a.remote,msgs:i.concat(d("WAWebMsgDataFromModel").msgDataFromMsgModel(g)),range:{start:j-a.count,end:j},serverIdsToSkip:d("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(a.remote)}),{add:"before",isHistory:!0},"msgCollectionGetContext",e),f.processMultipleMessages(a.remote,!h||j==null?c:yield d("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:a.remote,msgs:[d("WAWebMsgDataFromModel").msgDataFromMsgModel(g)].concat(c),range:{start:j,end:j+a.count},serverIdsToSkip:d("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(a.remote)}),{add:"after",isHistory:!0},"msgCollectionGetContext",e)])});return function(a){return c.apply(this,arguments)}}());var i={add:"after",isHistory:!0};return d("WAWebDBMessageFindLocal").msgFindQuery("after",a).then(function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(!Array.isArray(b)){d("WALogger").WARN(z||(z=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:after fetch error"]))).devConsole(b);throw b.status}if(c("WAWebWid").isStatus(b[0].id.remote))throw c("err")("status, stop querying before the msg");var g=a.serverId;return f.processMultipleMessages(a.remote,!h||g==null?b:yield d("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:a.remote,msgs:b,range:{start:g,end:g+a.count},serverIdsToSkip:d("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(a.remote)}),i,"msgCollectionFindQuery",e)});return function(a){return g.apply(this,arguments)}}()).then(function(e){var g=c("WANullthrows")(e[0]),i=g.id.clone();i.count=a.count+1;var j={add:"before",isHistory:!0};return(D||(D=b("Promise"))).all([d("WAWebDBMessageFindLocal").msgFindQuery("before",i).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(!Array.isArray(b)){d("WALogger").WARN(A||(A=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:before fetch error"]))).devConsole(b);throw b.status}var c=b[b.length-1];c.fromQuotedMsg=!1;c=c.id;if(!c.equals(a)){d("WALogger").WARN(B||(B=babelHelpers.taggedTemplateLiteralLoose(["model:msg:getContext:before ctx message mismatch"]))).devConsole(b);throw 405}c=function(){return g.msgChunk};var e=g.serverId;return f.processMultipleMessages(a.remote,!h||e==null?b:yield d("WAWebNewsletterMsgHistoryUtils").fillMsgHistoryGaps({jid:a.remote,msgs:b,range:{start:e,end:e-a.count},serverIdsToSkip:d("WAWebNewsletterViewModeUIUtils").getHiddenMessageServerIdsForChat(a.remote)}),j,"msgCollectionFindQuery",c)});return function(a){return c.apply(this,arguments)}}()),D.resolve(e)])})});function e(b,c){return a.apply(this,arguments)}return e}();f.hasSynced=function(){return c("WAWebEventsWaitForBbEvent")(this,d("WAWebCollectionConstants").COLLECTION_HAS_SYNCED)};f.processMultipleMessages=function(a,b,e,f,g,h){var i=this;h===void 0&&(h=!0);a!=null&&a.isRegularUser()&&d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["processMultipleMessages. processMessageOrigin: ",""])),f).tags("missing-lid");var j=function(){return d("WAWebProcessMultipleMsgsAction")._processMultipleMessages(a,b,e,f,g)};if(a){var k,l=this.pendingAdd[a];l&&h?k=l.then(j):k=j();k["finally"](function(){a&&i.pendingAdd[a]===k&&(i.pendingAdd[a]=null)})["catch"](c("WAWebNoop"));return this.pendingAdd[a]=k}return j()};f.hasUnsentMessages=function(){return this.some(function(a){return a.ack===d("WAWebAck").ACK.CLOCK&&a.local&&d("WAWebMsgGetters").getIsSentByMe(a)})};f.getByEditMsgKey=function(a){a=this._parentKeyByEditKey.get(a.toString());return a&&this.get(a)};f.processEditedMessages=function(a){var b=this;a.forEach(function(a){if(!a||!d("WAWebMsgGetters").getIsEdited(a))return;var c=b._editKeyByParentKey.get(a.id.toString());c!=null&&b._parentKeyByEditKey["delete"](c);c=a.latestEditMsgKey;if(!c)return;b._editKeyByParentKey.set(a.id.toString(),c.toString());b._parentKeyByEditKey.set(c.toString(),a.id)})};f.addInitialBotTypingIndicatorToChat=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c,e=d("WAWebChatCollection").ChatCollection.get(a);if(!e||!(e!=null&&e.id.isBot())&&!((c=e.contact.businessProfile)!=null&&c.isBizBot3p))return;if(e.botInitialTypingIndicatorMsgId!=null){c=this.get(e.botInitialTypingIndicatorMsgId);if(c==null)return;c==null||c["delete"]({skipUpdatingSortTime:!0})}e.set({botInitialTypingIndicatorMsgId:b},{silent:!0});c={id:b,t:d("WATimeUtils").unixTime(),from:a,to:d("WAWebUserPrefsMeUser").getMaybeMePnUser(),type:"chat",subtype:d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE,body:""};void this.processMultipleMessages(a,[babelHelpers["extends"]({},c,{recvFresh:!0,isNewMsg:!0})],{add:"after",isHistory:!1},"createChatOnNewMsg",null,!0)});function c(b,c){return a.apply(this,arguments)}return c}();f.encryptAndClearModels=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this._models.map(function(a){return d("WAWebMsgOpaqueData").encryptDataInMsgModel(a)});yield (D||(D=b("Promise"))).all(a)});function c(){return a.apply(this,arguments)}return c}();f.decryptAndSetModels=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this._models.map(function(b){return d("WAWebMsgOpaqueData").decryptDataInMsgModel(b,a)});yield (D||(D=b("Promise"))).all(c)});function c(b){return a.apply(this,arguments)}return c}();return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;e=new a();g.MEDIA_QUERY_LIMIT=E;g.MsgCollectionImpl=a;g.MsgCollection=e}),98);
__d("WAWebMsgInfoAction",["WAWebAck","WAWebStateUtils","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a,b,e,f){a=d("WAWebStateUtils").unproxy(a);var g=a.id;g=c("WAWebWid").isUser(g.remote);g?h(a,b,e,f):i(a,b,e,f)}function h(a,b,c,e){b===d("WAWebAck").ACK.PLAYED?(a.played.get(c)||(a.playedRemaining-=1),a.played.add({id:c,t:e})):b===d("WAWebAck").ACK.READ?(a.read.get(c)||(a.readRemaining-=1),a.read.add({id:c,t:e})):b===d("WAWebAck").ACK.RECEIVED&&(a.delivery.get(c)||(a.deliveryRemaining-=1),a.delivery.add({id:c,t:e}))}function i(a,b,c,e){var f,g=d("WAWebAck").ACK.CLOCK;a.played.get(c)?g=d("WAWebAck").ACK.PLAYED:a.read.get(c)?g=d("WAWebAck").ACK.READ:a.delivery.get(c)&&(g=d("WAWebAck").ACK.RECEIVED);if(b<=g)return;if(b>d("WAWebAck").ACK.RECEIVED){g=a.delivery.get(c);g?a.delivery.remove(g):a.deliveryRemaining-=1}if(b>d("WAWebAck").ACK.READ){g=a.read.get(c);g?a.read.remove(g):a.readRemaining-=1}b===d("WAWebAck").ACK.READ&&a!=null&&(f=a.id)!=null&&(f=f.remote)!=null&&f.isGroup()&&c!=null&&c.isBot()&&(a.readRemaining+=1);b===d("WAWebAck").ACK.PLAYED?(a.played.get(c)||(a.playedRemaining-=1),a.played.add({id:c,t:e})):b===d("WAWebAck").ACK.READ?(a.read.get(c)||(a.readRemaining-=1),a.read.add({id:c,t:e})):b===d("WAWebAck").ACK.RECEIVED&&(a.delivery.get(c)||(a.deliveryRemaining-=1),a.delivery.add({id:c,t:e}))}g.updateMsgInfo=a}),98);
__d("WAWebMsgInfoCollection",["Promise","WALogger","WAWebApiMessageInfoStore","WAWebBaseCollection","WAWebChatGetters","WAWebHandleMsgTypes.flow","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgInfoAction","WAWebMsgInfoModel","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function m(a,b){var e=b.read,f=b.played,g=b.delivery,i=b.readRemaining,j=b.playedRemaining,k=b.deliveryRemaining;b=b.deliveryPrivacyMode;a={id:a,read:e.map(function(a){return babelHelpers["extends"]({},a)}),readRemaining:i,played:f.map(function(a){return babelHelpers["extends"]({},a)}),playedRemaining:j,delivery:g.map(function(a){return babelHelpers["extends"]({},a)}),deliveryRemaining:k};if(b!=null){e=d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(b.hostStorage);i=d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(b.actualActors);if(i==null||e==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: got unsupported host storage or actual actors"]))).sendLogs("queryMsgInfo-incorrect-enums");throw c("err")("queryMsgInfo: got unsupported host storage or actual actors")}f={hostStorage:e,privacyModeTs:b.privacyModeTs,actualActors:i};a.deliveryPrivacyMode=f}return a}function n(a){var b=a.id;if(d("WAWebChatGetters").getIsNewsletter(a))return b.fromMe;return b.self==="in"||d("WAWebMsgGetters").getIsNotification(a)?!1:d("WAWebUserPrefsMeUser").isMeAccount(a.from)}a=function(a){function e(){var c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=a.call.apply(a,[this].concat(f))||this,c.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebMsgCollection").MsgCollection.get(a);if(!c)return(l||(l=b("Promise"))).reject(new(d("WAWebBaseCollection").CollectionSilentQueryError)("No message found for id: "+a.toString()));else if(!d("WAWebMsgGetters").getIsSentByMe(c)){n(c)&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["message not sent by me: from: ",", fromMe: ",", isMeAccount: ",", type: ",", isNewsletter: ",""])),c.from.toString(),c.id.fromMe,d("WAWebUserPrefsMeUser").isMeAccount(c.from),c.type,d("WAWebChatGetters").getIsNewsletter(c)).sendLogs("msg-info-collection-msg-not-sent-by-me");return(l||(l=b("Promise"))).reject(new(d("WAWebBaseCollection").CollectionSilentQueryError)("message not sent by me"))}var e;try{e=(yield d("WAWebApiMessageInfoStore").queryMsgInfo(a))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: failed to find msg info in storage"]))).verbose().devConsole(a).sendLogs("queryMsgInfo failed");throw a}a=m(a,e);return babelHelpers["extends"]({},a,{usePlayReceipt:c.type===d("WAWebMsgType").MSG_TYPE.PTT||c.isViewOnce})});return function(b){return a.apply(this,arguments)}}(),c.findManyAndUpdate=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map(),e=[];a.forEach(function(a){a=d("WAWebMsgCollection").MsgCollection.get(a);a&&d("WAWebMsgGetters").getIsSentByMe(a)&&e.push(a)});var f;try{f=(yield d("WAWebApiMessageInfoStore").queryMsgInfos(a))}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfos: failed to find msg info in storage"]))).verbose().devConsole(a).sendLogs("queryMsgInfos failed");throw a}e.forEach(function(a){var e=a.id,g=f.get(e.toString());if(!g)return(l||(l=b("Promise"))).reject(new(d("WAWebBaseCollection").CollectionSilentQueryError)("query returned no msg info for msg "+e.toString()));g=babelHelpers["extends"]({},m(e,g),{usePlayReceipt:a.type===d("WAWebMsgType").MSG_TYPE.PTT||a.isViewOnce});a=o.gaddUp(g);c.set(e.toString(),a)});return c});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(c))||babelHelpers.assertThisInitialized(c)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.updateInfo=function(a,b,e,f,g,h){var i=new(c("WAWebMsgKey"))({from:b,to:e,id:a,participant:g});b=new(c("WAWebMsgKey"))({from:b,to:e,id:a});e=this.get(i)||this.get(b);if(e)return d("WAWebMsgInfoAction").updateMsgInfo(e,f,g,h)};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgInfoModel").MsgInfo;a.staleCollection=!0;var o=new a();g.MsgInfoCollection=o}),98);
__d("WAWebMsgInfoGetters",["WAWebGetters","WAWebGettersCaches"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createMsgInfosCache});b=a.field;c=a.clearCacheFor;e=c;f=b("playedRemaining");d=b("readRemaining");a=b("deliveryRemaining");g.clearMsgInfoGetterCacheFor=e;g.getPlayedRemaining=f;g.getReadRemaining=d;g.getDeliveryRemaining=a}),98);
__d("WAWebMsgInfoModel",["WAWebBaseModel","WAWebCollection","WAWebContactCollection","WAWebContactComparator","WAWebMsgInfoCollection","WAWebMsgInfoGetters","WAWebMsgKey","WAWebWid"],(function(a,b,c,d,e,f,g){b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.contact=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.initialize=function(){a.prototype.initialize.call(this),this.addChild("contact",d("WAWebContactCollection").ContactCollection.gadd(this.id))};return b}((a=d("WAWebBaseModel")).BaseModel);b.Proxy="msgInfoParticipant";b.idClass=c("WAWebWid");e=a.defineModel(b);var h=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(c("WAWebCollection"));h.model=e;h.comparator=function(a,b){return d("WAWebContactComparator").ContactComparator(a.contact,b.contact)};f=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.usePlayReceipt=d("WAWebBaseModel").prop(),b.playedRemaining=d("WAWebBaseModel").prop(0),b.readRemaining=d("WAWebBaseModel").prop(0),b.deliveryRemaining=d("WAWebBaseModel").prop(0),b.deliveryPrivacyMode=d("WAWebBaseModel").prop(),b.played=d("WAWebBaseModel").collection(h),b.read=d("WAWebBaseModel").collection(h),b.delivery=d("WAWebBaseModel").collection(h),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebMsgInfoCollection").MsgInfoCollection};c["delete"]=function(){a.prototype["delete"].call(this),d("WAWebMsgInfoGetters").clearMsgInfoGetterCacheFor(this)};return b}(a.BaseModel);f.Proxy="msgInfo";f.idClass=c("WAWebMsgKey");b=a.defineModel(f);g.MsgInfoParticipant=e;g.ParticipantCollection=h;g.MsgInfo=b}),98);
__d("WAWebMsgInfoUtils",["WAWebAgentModelUtils","WAWebBizCtwaAGMUtils","WAWebChatCollection","WAWebFrontendMsgGetters","WAWebGroupType","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){function a(a){var b;if(d("WAWebMsgGetters").getIsNewsletterMsg(a))return!1;if(d("WAWebFrontendMsgGetters").getAsAlbum(a))return!1;if(d("WAWebFrontendMsgGetters").getAsCallLog(a))return!1;if(d("WAWebBizCtwaAGMUtils").isAutomatedGreetingMessage((b=a.ctwaContext)==null?void 0:b.sourceApp,a.type,(b=a.ctwaContext)==null?void 0:b.automatedGreetingMessageShown))return!1;return d("WAWebMsgGetters").getIsSentByMe(a)&&!d("WAWebFrontendMsgGetters").getAsRevoked(a)&&!a.mayFail()&&(!a.isMdHistoryMsg||d("WAWebAgentModelUtils").canUserSeeMessageAttribution()&&a.agentId!=null)?!0:!1}function b(a,b){var c={};a.isGroup()&&(c.groupData=h(a,b));return c}function h(a,b){var c=d("WAWebChatCollection").ChatCollection.get(a);a={groupId:a.toString(),amIAdmin:null,isCag:null,isLid:b,isLidAddressingMode:null,wamTypeOfGroup:null,participantCount:null,deviceCount:null,deviceSizeBucket:null,isCapiGroup:null};b=c==null?void 0:c.groupMetadata;if(b){c=Boolean(b==null?void 0:b.isLidAddressingMode);var e=d("WAWebGroupType").getGroupTypeFromGroupMetadata(b),f=e===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;a.wamTypeOfGroup=d("WAWebGroupType").groupTypeToWamEnum(e);a.isCag=f;a.isLidAddressingMode=c;a.isCapiGroup=b.hasCapi===!0;a.amIAdmin=b.participants.iAmAdmin();a.participantCount=b.participants.length}return a}g.canOpenInfoDrawer=a;g.getGroupMessageSendReporterOptions=b}),98);
__d("WAWebMsgLinks",["WAUnicodeUtils","WAWebABProps","WAWebFrontendMsgGetters","WAWebLinkify","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebStateUtils","uniqueBy"],(function(a,b,c,d,e,f,g){function h(a){var b=a.content,c=a.sender,e=a.cachedValue;e=e===void 0?[]:e;var f=a.currentIndex;f=f===void 0?0:f;a=a.endIndex;a=a===void 0?Infinity:a;if(f>=a)return[e,a];f=d("WAUnicodeUtils").firstNCodepoints(b,a);e=!1;e=d("WAWebLinkify").findLinks(f,e,c);e.length>0&&(e=i(e,b,f,a,c));return[e,a]}var i=function(a,b,c,e,f){if(d("WAWebABProps").getABPropConfigValue("wa_web_dont_linkify_trauncated_links_enabled")!==!0)return a;var g=d("WAUnicodeUtils").numCodepoints(c),h=d("WAUnicodeUtils").numCodepoints(b);if(g<h&&a.length>0){var i=a[a.length-1];h=d("WAUnicodeUtils").numCodepoints(c.slice(0,i.index));c=h+d("WAUnicodeUtils").numCodepoints(i.url);if(c===e){c=d("WAWebLinkify").findLinks(b,!1,f);e=h;b=c[c.length-1];f=e+d("WAUnicodeUtils").numCodepoints(b.url);if(f>g)return a.filter(function(a){return a.href!==i.href})}}return a};function j(a,b){a=d("WAWebStateUtils").unproxy(a);b=b!=null?b:a.linksIndexParsed?a.linksIndexParsed:d("WAWebMsgGetters").getInitialPageSize(a)+1;var c=d("WAWebFrontendMsgGetters").getText(a);if(c==null||a.linksIndexParsed===Infinity)return a.getRawLinks();c=h({content:c,sender:d("WAWebMsgGetters").getSender(a),cachedValue:a.getRawLinks(),currentIndex:a.linksIndexParsed,endIndex:b});b=c[0];c=c[1];a.linksIndexParsed=c;a.setRawLinks(b);return b}function a(a,b){var c=d("WAWebStateUtils").unproxy(a);if(c.pollOptions==null)return null;if(c.getRawPollOptionsToLinks()==null){a=new Map((a=c.pollOptions)==null?void 0:a.map(function(a){var b=h({content:a.name,sender:d("WAWebMsgGetters").getSender(c)});b=b[0];return[a,b]}));c.setRawPollOptionsToLinks(a)}return(a=c.getRawPollOptionsToLinks())==null?void 0:a.get(b)}function k(a,b){if(b){return a.type==="list"&&((b=a.list)==null?void 0:b.listType)===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT&&((b=a.list)==null?void 0:b.title)!=null}return a.isDynamicReplyButtonsMsg===!0&&a.title!=null}function l(a,b){if(a.getRawHeaderLinks().length>0)return a.getRawHeaderLinks();b=h({content:b,sender:d("WAWebMsgGetters").getSender(a),cachedValue:a.getRawHeaderLinks()});b=b[0];b.length>0&&a.setRawHeaderLinks(b);return b}function b(a){a=d("WAWebStateUtils").unproxy(a);if(k(a,!0)){var b;return l(a,((b=a.list)==null?void 0:b.title)||"")}else if(k(a,!1))return l(a,a.title);else if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&((b=a.interactiveHeader)==null?void 0:b.title)!=null)return l(a,a.interactiveHeader.title);return[]}function e(a){a=d("WAWebStateUtils").unproxy(a);var b=a.footer;if(!d("WAWebMsgGetters").getSupportsMessageFooterLinks(a)||b==null)return[];if(a.getRawFooterLinks().length>0)return a.getRawFooterLinks();b=h({content:b,sender:d("WAWebMsgGetters").getSender(a),cachedValue:a.getRawFooterLinks()});b=b[0];b.length>0&&a.setRawFooterLinks(b);return b}function f(a){a=d("WAWebStateUtils").unproxy(a);return c("uniqueBy")(j(a),function(a){return a.href}).filter(function(a){return a.isHttp})}function m(a){a=d("WAWebStateUtils").unproxy(a);return j(a).filter(function(a){return(a=a.suspiciousCharacters)==null?void 0:a.size})}g.getLinksFromMsgImpl=h;g.getLinksFromMsg=j;g.getPollOptionLinks=a;g.shouldDisplayHeaderLinks=k;g.getHeaderLinks=b;g.getFooterLinks=e;g.getGalleryLinks=f;g.getSuspiciousLinks=m}),98);
__d("WAWebSuspendedGroupMediaDownloadFailureModal.react",["fbt","WAWebConfirmPopup.react","WAWebModalManager","react"],(function(a,b,c,d,e,f,g,h){var i,j=i||c("react");function a(){var a=function(){return d("WAWebModalManager").ModalManager.close()};return j.jsx(d("WAWebConfirmPopup.react").ConfirmPopup,{onOK:a,title:h._(/*BTDS*/"Download failed"),children:h._(/*BTDS*/"Media no longer available")})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("WAWebMsgModel",["Promise","WAJids","WALogger","WATimeUtils","WATypeUtils","WAWebAck","WAWebApiContact","WAWebBaseModel","WAWebBizLabelUtils","WAWebBotGenTypingIndicatorMsg","WAWebBotTypes","WAWebBusinessHSMTypes","WAWebBusinessProfileTypes","WAWebCarouselCardsCollection","WAWebChangePresenceHandlerAction","WAWebChatCollection","WAWebChatCommunityUtils","WAWebChatContactUtils","WAWebChatGetMessage","WAWebChatGetters","WAWebChatGroupUtils","WAWebCmd","WAWebCommonMsgUtils","WAWebConnModel","WAWebConstantsDeprecated","WAWebContactCollection","WAWebDBUpdateMessageTable","WAWebDirectConnectionGatingUtils","WAWebEphemeralKeepInChatAbpropUtils","WAWebEphemeralityTypes","WAWebEventsWaitForBbEvent","WAWebFrontendContactGetters","WAWebFrontendMsgGetters","WAWebInvisiblePlaceholderViewModeProcessor","WAWebLabelCollection","WAWebLidMigrationUtils","WAWebMedia","WAWebMediaData","WAWebMediaTypes","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationUIUtils","WAWebMessageReceiptUtils","WAWebMiscGatingUtils","WAWebModalManager","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModelPropUtils","WAWebMsgModelUtils","WAWebMsgType","WAWebMuteCollection","WAWebNewsletterCollection","WAWebNewsletterSendMsgAction","WAWebNotificationsMsgNotification","WAWebPinInChatCollection","WAWebPromiseQueue","WAWebSendMessageEditAction","WAWebSendMsgRecordAction","WAWebStarredMsgCollection","WAWebSuspendedGroupMediaDownloadFailureModal.react","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebVcardParsingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebViewOnceState","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumWebcRmrReasonCode","WAWebWamMsgUtils","WAWebWid","WAWebWidFactory","WAWebWidFormat","asyncToGeneratorRuntime","err","fbs","gkx","isStringNullOrEmpty","lodash","react"],(function(a,b,c,d,e,f,g){var h=["id","t","notifyName","from","to","author","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","quotedType","senderObj","multicast","replyButtons","buttons","latestEditMsgKey","latestEditSenderTimestampMs"],i,j,k,l,m,n,o,p,q=p||c("react");a=function(a){function e(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.id=d("WAWebBaseModel").prop(),b.rowId=d("WAWebBaseModel").prop(),b.serverId=d("WAWebBaseModel").prop(),b.parentServerId=d("WAWebBaseModel").prop(),b.questionResponseInfo=d("WAWebBaseModel").prop(),b.viewCount=d("WAWebBaseModel").prop(),b.viewed=d("WAWebBaseModel").prop(!1),b.body=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(),b.typeFlag=d("WAWebBaseModel").prop(),b.subtype=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.clientReceivedTsMillis=d("WAWebBaseModel").prop(),b.revokeTimestamp=d("WAWebBaseModel").prop(),b.notifyName=d("WAWebBaseModel").prop(),b.from=d("WAWebBaseModel").prop(),b.to=d("WAWebBaseModel").prop(),b.author=d("WAWebBaseModel").prop(),b.ack=d("WAWebBaseModel").prop(),b.invis=d("WAWebBaseModel").prop(),b.isNewMsg=d("WAWebBaseModel").prop(),b.star=d("WAWebBaseModel").prop(!1),b.kicKey=d("WAWebBaseModel").prop(),b.kicState=d("WAWebBaseModel").prop(),b.kicTimestampMs=d("WAWebBaseModel").prop(),b.kicNotified=d("WAWebBaseModel").prop(!1),b.keepType=d("WAWebBaseModel").prop(),b.keptMessageKey=d("WAWebBaseModel").prop(),b.keptCount=d("WAWebBaseModel").prop(),b.recvFresh=d("WAWebBaseModel").prop(),b.caption=d("WAWebBaseModel").prop(),b.interactiveAnnotations=d("WAWebBaseModel").prop(),b.contextInfo=d("WAWebBaseModel").prop(),b.clientUrl=d("WAWebBaseModel").prop(),b.loc=d("WAWebBaseModel").prop(),b.lat=d("WAWebBaseModel").prop(),b.lng=d("WAWebBaseModel").prop(),b.isLive=d("WAWebBaseModel").prop(),b.accuracy=d("WAWebBaseModel").prop(),b.speed=d("WAWebBaseModel").prop(),b.degrees=d("WAWebBaseModel").prop(),b.comment=d("WAWebBaseModel").prop(),b.sequence=d("WAWebBaseModel").prop(),b.shareDuration=d("WAWebBaseModel").prop(),b.finalLat=d("WAWebBaseModel").prop(),b.finalLng=d("WAWebBaseModel").prop(),b.finalAccuracy=d("WAWebBaseModel").prop(),b.finalThumbnail=d("WAWebBaseModel").prop(),b.finalSpeed=d("WAWebBaseModel").prop(),b.finalDegrees=d("WAWebBaseModel").prop(),b.finalTimeOffset=d("WAWebBaseModel").prop(),b.deprecatedMms3Url=d("WAWebBaseModel").prop(),b.directPath=d("WAWebBaseModel").prop(),b.mimetype=d("WAWebBaseModel").prop(),b.duration=d("WAWebBaseModel").prop(),b.filehash=d("WAWebBaseModel").prop(),b.encFilehash=d("WAWebBaseModel").prop(),b.size=d("WAWebBaseModel").prop(),b.filename=d("WAWebBaseModel").prop(),b.streamingSidecar=d("WAWebBaseModel").prop(),b.mediaKey=d("WAWebBaseModel").prop(),b.mediaKeyTimestamp=d("WAWebBaseModel").prop(),b.pageCount=d("WAWebBaseModel").prop(),b.isGif=d("WAWebBaseModel").prop(),b.gifAttribution=d("WAWebBaseModel").prop(),b.accessibilityLabel=d("WAWebBaseModel").prop(),b.isViewOnce=d("WAWebBaseModel").prop(),b.streamable=d("WAWebBaseModel").prop(),b.width=d("WAWebBaseModel").prop(),b.height=d("WAWebBaseModel").prop(),b.thumbnailDirectPath=d("WAWebBaseModel").prop(),b.thumbnailSha256=d("WAWebBaseModel").prop(),b.thumbnailEncSha256=d("WAWebBaseModel").prop(),b.thumbnailHeight=d("WAWebBaseModel").prop(),b.thumbnailWidth=d("WAWebBaseModel").prop(),b.metadataUrl=d("WAWebBaseModel").prop(),b.waveform=d("WAWebBaseModel").prop(),b.staticUrl=d("WAWebBaseModel").prop(),b.stickerPackId=d("WAWebBaseModel").prop(),b.stickerPackName=d("WAWebBaseModel").prop(),b.stickerPackPublisher=d("WAWebBaseModel").prop(),b.stickers=d("WAWebBaseModel").prop(),b.trayIconFileName=d("WAWebBaseModel").prop(),b.stickerPackSize=d("WAWebBaseModel").prop(),b.mediaHandle=d("WAWebBaseModel").prop(),b.scanLengths=d("WAWebBaseModel").prop(),b.scansSidecar=d("WAWebBaseModel").prop(),b.isFromTemplate=d("WAWebBaseModel").prop(!1),b.devicesAdded=d("WAWebBaseModel").prop(),b.devicesRemoved=d("WAWebBaseModel").prop(),b.isThisDeviceAdded=d("WAWebBaseModel").prop(),b.firstFrameLength=d("WAWebBaseModel").prop(),b.firstFrameSidecar=d("WAWebBaseModel").prop(),b.isAnimated=d("WAWebBaseModel").prop(),b.isLottie=d("WAWebBaseModel").prop(),b.matchedText=d("WAWebBaseModel").prop(),b.thumbnail=d("WAWebBaseModel").prop(),b.thumbnailHQ=d("WAWebBaseModel").prop(),b.richPreviewType=d("WAWebBaseModel").prop(),b.doNotPlayInline=d("WAWebBaseModel").prop(),b.rcat=d("WAWebBaseModel").prop(),b.faviconMMSMetadata=d("WAWebBaseModel").prop(),b.title=d("WAWebBaseModel").prop(),b.description=d("WAWebBaseModel").prop(),b.isAdsMedia=d("WAWebBaseModel").prop(!1),b.paymentLinkMetadata=d("WAWebBaseModel").prop(),b.businessOwnerJid=d("WAWebBaseModel").prop(),b.productId=d("WAWebBaseModel").prop(),b.currencyCode=d("WAWebBaseModel").prop(),b.priceAmount1000=d("WAWebBaseModel").prop(),b.salePriceAmount1000=d("WAWebBaseModel").prop(),b.retailerId=d("WAWebBaseModel").prop(),b.url=d("WAWebBaseModel").prop(),b.productImageCount=d("WAWebBaseModel").prop(),b.sessionId=d("WAWebBaseModel").prop(),b.pollName=d("WAWebBaseModel").prop(),b.pollOptions=d("WAWebBaseModel").prop(),b.pollSelectableOptionsCount=d("WAWebBaseModel").prop(),b.pollInvalidated=d("WAWebBaseModel").prop(!1),b.pollContentType=d("WAWebBaseModel").prop(),b.pollType=d("WAWebBaseModel").prop(),b.correctOptionIndex=d("WAWebBaseModel").prop(),b.isSentCagPollCreation=d("WAWebBaseModel").prop(!1),b.pollUpdateParentKey=d("WAWebBaseModel").prop(),b.encPollVote=d("WAWebBaseModel").prop(),b.selectedOptionLocalIds=d("WAWebBaseModel").prop(),b.pollVotesSnapshot=d("WAWebBaseModel").prop(),b.quarantineExtractedText=d("WAWebBaseModel").prop(),b.quarantineOriginalProtobuf=d("WAWebBaseModel").prop(),b.senderTimestampMs=d("WAWebBaseModel").prop(),b.latestEditMsgKey=d("WAWebBaseModel").prop(null),b.latestEditSenderTimestampMs=d("WAWebBaseModel").prop(null),b.editMsgType=d("WAWebBaseModel").prop(),b.recipients=d("WAWebBaseModel").prop(),b.broadcast=d("WAWebBaseModel").prop(),b.quotedMsg=d("WAWebBaseModel").prop(),b.quotedStanzaID=d("WAWebBaseModel").prop(),b.quotedRemoteJid=d("WAWebBaseModel").prop(),b.quotedParticipant=d("WAWebBaseModel").prop(),b.quotedGroupSubject=d("WAWebBaseModel").prop(),b.quotedParentGroupJid=d("WAWebBaseModel").prop(),b.quotedType=d("WAWebBaseModel").prop(),b.mentionedJidList=d("WAWebBaseModel").prop(),b.reporterJidList=d("WAWebBaseModel").prop(),b.groupMentions=d("WAWebBaseModel").prop(),b.footer=d("WAWebBaseModel").prop(),b.hydratedButtons=d("WAWebBaseModel").prop(),b.buttons=d("WAWebBaseModel").session(),b.hsmTag=d("WAWebBaseModel").prop(),b.hsmCategory=d("WAWebBaseModel").prop(),b.templateId=d("WAWebBaseModel").prop(),b.eventName=d("WAWebBaseModel").prop(),b.isEventCanceled=d("WAWebBaseModel").prop(!1),b.eventDescription=d("WAWebBaseModel").prop(),b.eventJoinLink=d("WAWebBaseModel").prop(),b.eventStartTime=d("WAWebBaseModel").prop(),b.eventEndTime=d("WAWebBaseModel").prop(),b.eventLocation=d("WAWebBaseModel").prop(),b.eventInvalidated=d("WAWebBaseModel").prop(!1),b.eventIsScheduledCall=d("WAWebBaseModel").prop(),b.eventExtraGuestsAllowed=d("WAWebBaseModel").prop(),b.selectedId=d("WAWebBaseModel").prop(),b.selectedIndex=d("WAWebBaseModel").prop(),b.selectedCarouselCardIndex=d("WAWebBaseModel").prop(),b.multicast=d("WAWebBaseModel").prop(),b.urlText=d("WAWebBaseModel").prop(),b.urlNumber=d("WAWebBaseModel").prop(),b.statusMentioned=d("WAWebBaseModel").prop(),b.isWamoSub=d("WAWebBaseModel").prop(),b.clearMedia=d("WAWebBaseModel").prop(),b.isVcardOverMmsDocument=d("WAWebBaseModel").prop(!1),b.isCaptionByUser=d("WAWebBaseModel").prop(),b.vcardList=d("WAWebBaseModel").prop(),b.vcardFormattedName=d("WAWebBaseModel").prop(),b.revokeSender=d("WAWebBaseModel").prop(),b.protocolMessageKey=d("WAWebBaseModel").prop(),b.futureproofBuffer=d("WAWebBaseModel").prop(),b.futureproofParams=d("WAWebBaseModel").prop(),b.futureproofType=d("WAWebBaseModel").prop(),b.futureproofSubtype=d("WAWebBaseModel").prop(),b.templateParams=d("WAWebBaseModel").prop(),b.textColor=d("WAWebBaseModel").prop(),b.backgroundColor=d("WAWebBaseModel").prop(),b.font=d("WAWebBaseModel").prop(),b.cannotBeRanked=d("WAWebBaseModel").prop(),b.campaignId=d("WAWebBaseModel").prop(),b.campaignDuration=d("WAWebBaseModel").prop(),b.actionLink=d("WAWebBaseModel").prop(),b.statusPSAReadTimestamp=d("WAWebBaseModel").prop(),b.isForwarded=d("WAWebBaseModel").prop(!1),b.isQuestion=d("WAWebBaseModel").prop(!1),b.questionReplyQuotedMessage=d("WAWebBaseModel").prop(null),b.questionResponsesCount=d("WAWebBaseModel").prop(0),b.readQuestionResponsesCount=d("WAWebBaseModel").prop(0),b.forwardingScore=d("WAWebBaseModel").prop(),b.labels=d("WAWebBaseModel").prop(),b.hasReaction=d("WAWebBaseModel").prop(!1),b.paymentCurrency=d("WAWebBaseModel").prop(),b.paymentAmount1000=d("WAWebBaseModel").prop(),b.paymentMessageReceiverJid=d("WAWebBaseModel").prop(),b.paymentTransactionTimestamp=d("WAWebBaseModel").prop(),b.paymentStatus=d("WAWebBaseModel").prop(),b.paymentTxnStatus=d("WAWebBaseModel").prop(),b.paymentNoteMsg=d("WAWebBaseModel").prop(),b.paymentRequestMessageKey=d("WAWebBaseModel").prop(),b.paymentExpiryTimestamp=d("WAWebBaseModel").prop(),b.paymentInviteServiceType=d("WAWebBaseModel").prop(),b.ephemeralDuration=d("WAWebBaseModel").prop(),b.ephemeralSettingTimestamp=d("WAWebBaseModel").prop(),b.ephemeralOutOfSync=d("WAWebBaseModel").prop(),b.ephemeralSharedSecret=d("WAWebBaseModel").prop(),b.disappearingModeInitiator=d("WAWebBaseModel").prop(),b.ephemeralSettingUser=d("WAWebBaseModel").prop(),b.disappearingModeTrigger=d("WAWebBaseModel").prop(),b.disappearingModeInitiatedByMe=d("WAWebBaseModel").prop(),b.parentMsgKey=d("WAWebBaseModel").prop(),b.associationType=d("WAWebBaseModel").prop(),b.viewMode=d("WAWebBaseModel").prop(),b.messageSecret=d("WAWebBaseModel").prop(),b.originalSelfAuthor=d("WAWebBaseModel").prop(),b.bizPrivacyStatus=d("WAWebBaseModel").prop(),b.privacyModeWhenSent=d("WAWebBaseModel").prop(),b.verifiedBizName=d("WAWebBaseModel").prop(),b.inviteCode=d("WAWebBaseModel").prop(),b.inviteCodeExp=d("WAWebBaseModel").prop(),b.inviteGrp=d("WAWebBaseModel").prop(),b.inviteGrpName=d("WAWebBaseModel").prop(),b.inviteGrpJpegThum=d("WAWebBaseModel").prop(),b.inviteGrpType=d("WAWebBaseModel").prop(),b.threadIds=d("WAWebBaseModel").prop(),b.aiThreadInfo=d("WAWebBaseModel").prop(),b.sellerJid=d("WAWebBaseModel").prop(),b.message=d("WAWebBaseModel").prop(),b.orderTitle=d("WAWebBaseModel").prop(),b.itemCount=d("WAWebBaseModel").prop(),b.orderId=d("WAWebBaseModel").prop(),b.surface=d("WAWebBaseModel").prop(),b.status=d("WAWebBaseModel").prop(),b.token=d("WAWebBaseModel").prop(),b.totalAmount1000=d("WAWebBaseModel").prop(),b.totalCurrencyCode=d("WAWebBaseModel").prop(),b.catalogType=d("WAWebBaseModel").prop(),b.historySyncMetaData=d("WAWebBaseModel").prop(),b.isSendFailure=d("WAWebBaseModel").prop(),b.errorCode=d("WAWebBaseModel").prop(),b.appStateSyncKeyShare=d("WAWebBaseModel").prop(),b.appStateSyncKeyRequest=d("WAWebBaseModel").prop(),b.appStateFatalExceptionNotification=d("WAWebBaseModel").prop(),b.peerDataOperationRequestMessage=d("WAWebBaseModel").prop(),b.peerDataOperationRequestResponseMessage=d("WAWebBaseModel").prop(),b.broadcastParticipants=d("WAWebBaseModel").prop(),b.broadcastEphSettings=d("WAWebBaseModel").prop(),b.broadcastId=d("WAWebBaseModel").prop(),b.smbClientCampaignId=d("WAWebBaseModel").prop(),b.ctwaContext=d("WAWebBaseModel").prop(),b.utm=d("WAWebBaseModel").session(),b.list=d("WAWebBaseModel").prop(),b.listResponse=d("WAWebBaseModel").prop(),b.productListItemCount=d("WAWebBaseModel").prop(),b.productHeaderImageRejected=d("WAWebBaseModel").prop(!1),b.agentId=d("WAWebBaseModel").prop(),b.lastPlaybackProgress=d("WAWebBaseModel").prop(0),b.local=d("WAWebBaseModel").session(!1),b.search=d("WAWebBaseModel").session(),b.msgChunk=d("WAWebBaseModel").session(),b.startOfDay=d("WAWebBaseModel").session(),b.startOfDaySkew=d("WAWebBaseModel").session(),b.quotedMsgKey=d("WAWebBaseModel").session(),b.isQuotedMsgAvailable=d("WAWebBaseModel").session(!0),b.fromQuotedMsg=d("WAWebBaseModel").session(!1),b.senderObj=d("WAWebBaseModel").session(),b.mediaData=d("WAWebBaseModel").session(),b.forwardedFromWeb=d("WAWebBaseModel").session(!1),b.nonce=d("WAWebBaseModel").session(),b.squelch=d("WAWebBaseModel").session(),b.wamMessageSendReporter=d("WAWebBaseModel").session(),b.wamMessageSendPerfReporter=d("WAWebBaseModel").session(),b.pendingDeleteForMe=d("WAWebBaseModel").session(!1),b.isDynamicReplyButtonsMsg=d("WAWebBaseModel").prop(!1),b.dynamicReplyButtons=d("WAWebBaseModel").prop(),b.replyButtons=d("WAWebBaseModel").session(),b.buttonsResponse=d("WAWebBaseModel").prop(),b.selectedButtonId=d("WAWebBaseModel").prop(),b.headerType=d("WAWebBaseModel").prop(),b.nativeFlowName=d("WAWebBaseModel").prop(),b.nativeFlowButtons=d("WAWebBaseModel").prop(),b.interactiveHeader=d("WAWebBaseModel").prop(),b.interactiveType=d("WAWebBaseModel").prop(),b.interactivePayload=d("WAWebBaseModel").prop(),b.nativeFlowInteractiveMsg=d("WAWebBaseModel").prop(),b.carouselCardsParsed=d("WAWebBaseModel").prop(),b.carouselCards=d("WAWebBaseModel").session(),b.isCarouselCard=d("WAWebBaseModel").prop(!1),b.parentMsgId=d("WAWebBaseModel").prop(null),b.callSilenceReason=d("WAWebBaseModel").prop(null),b.callOutcome=d("WAWebBaseModel").prop(),b.isVideoCall=d("WAWebBaseModel").prop(!1),b.callDuration=d("WAWebBaseModel").prop(null),b.callCreator=d("WAWebBaseModel").prop(null),b.callParticipants=d("WAWebBaseModel").prop(null),b.isCallLink=d("WAWebBaseModel").prop(null),b.callLinkToken=d("WAWebBaseModel").prop(null),b.finalCallOutcome=d("WAWebBaseModel").prop(),b.reactionParentKey=d("WAWebBaseModel").prop(),b.reactionText=d("WAWebBaseModel").prop(),b.reactionTimestamp=d("WAWebBaseModel").prop(),b.targetMessageKey=d("WAWebBaseModel").prop(),b.encIv=d("WAWebBaseModel").prop(),b.encPayload=d("WAWebBaseModel").prop(),b.replyCount=d("WAWebBaseModel").prop(),b.pinParentKey=d("WAWebBaseModel").prop(),b.pinMessageType=d("WAWebBaseModel").prop(),b.pinSenderTimestampMs=d("WAWebBaseModel").prop(),b.pinExpiryDuration=d("WAWebBaseModel").prop(),b.revokeDuration=d("WAWebBaseModel").session(),b.isMdHistoryMsg=d("WAWebBaseModel").prop(!1),b.stickerSentTs=d("WAWebBaseModel").prop(0),b.isAvatar=d("WAWebBaseModel").prop(!1),b.bizSource=d("WAWebBaseModel").prop(),b.pmCampaignId=d("WAWebBaseModel").prop(),b.lastUpdateFromServerTs=d("WAWebBaseModel").prop(0),b.botEditType=d("WAWebBaseModel").prop(),b.invokedBotWid=d("WAWebBaseModel").prop(null),b.botMessageSecret=d("WAWebBaseModel").prop(),b.botFeedbackKind=d("WAWebBaseModel").prop(),b.botFeedbackText=d("WAWebBaseModel").prop(),b.botTargetSenderJid=d("WAWebBaseModel").prop(),b.bizBotType=d("WAWebBaseModel").prop(null),b.botPersonaId=d("WAWebBaseModel").prop(),b.activeBotMsgStreamingInProgress=d("WAWebBaseModel").session(!1),b.botEditTimeoutID=d("WAWebBaseModel").session(),b.lastBotEditBodyLength=d("WAWebBaseModel").session(),b.botEditTargetId=d("WAWebBaseModel").session(),b.botRespOrInvocationRevokeBotWid=d("WAWebBaseModel").session(null),b.botResponseTargetId=d("WAWebBaseModel").prop(null),b.botPluginType=d("WAWebBaseModel").prop(null),b.botPluginReferenceIndex=d("WAWebBaseModel").prop(null),b.botPluginSearchProvider=d("WAWebBaseModel").prop(null),b.botPluginSearchUrl=d("WAWebBaseModel").prop(null),b.botPluginSearchQuery=d("WAWebBaseModel").prop(null),b.botPluginMaybeParent=d("WAWebBaseModel").prop(!1),b.botReelPluginThumbnailCdnUrl=d("WAWebBaseModel").prop(null),b.botMessageDisclaimerText=d("WAWebBaseModel").prop(null),b.botMsgBodyType=d("WAWebBaseModel").prop(null),b.isSupportAIMessage=d("WAWebBaseModel").prop(),b.supportCitations=d("WAWebBaseModel").prop(),b.richResponse=d("WAWebBaseModel").prop(),b.forwardedNewsletterMessageInfo=d("WAWebBaseModel").prop(),b.encryptedData=d("WAWebBaseModel").prop(),b.newsletterAdminInviteInfo=d("WAWebBaseModel").prop(),b.newsletterFollowerInviteInfo=d("WAWebBaseModel").prop(),b.reportingTokenInfo=d("WAWebBaseModel").prop(),b.reportingTokenContent=d("WAWebBaseModel").prop(),b.plainProtobufBytes=d("WAWebBaseModel").session(),b.preMatChat=d("WAWebBaseModel").session(),b.senderWithDevice=d("WAWebBaseModel").session(),b.isRetry=d("WAWebBaseModel").session(!1),b.isOffline=d("WAWebBaseModel").session(!1),b.musicArtwork=d("WAWebBaseModel").prop(),b.$MsgImpl$p_1=d("WAWebBaseModel").session(function(){return[]}),b.$MsgImpl$p_2=d("WAWebBaseModel").session(function(){return[]}),b.$MsgImpl$p_3=d("WAWebBaseModel").session(function(){return[]}),b.linksIndexParsed=d("WAWebBaseModel").session(0),b.$MsgImpl$p_4=d("WAWebBaseModel").session(),b.$MsgImpl$p_5=d("WAWebBaseModel").session(function(){return[]}),b.$MsgImpl$p_6=d("WAWebBaseModel").session(function(){return[]}),b.$MsgImpl$p_7=d("WAWebBaseModel").session(function(){return[]}),b.phoneNumbersIndexParsed=d("WAWebBaseModel").session(0),b.$MsgImpl$p_8=d("WAWebBaseModel").session(),b.requiresDirectConnection=d("WAWebBaseModel").prop(null),b.isGroupStatus=d("WAWebBaseModel").prop(),b.isOverwrittenByRevoke=d("WAWebBaseModel").session(!1),b.bizContentPlaceholderType=d("WAWebBaseModel").prop(null),b.hostedBizEncStateMismatch=d("WAWebBaseModel").prop(!1),b.senderOrRecipientAccountTypeHosted=d("WAWebBaseModel").prop(!1),b.placeholderCreatedWhenAccountIsHosted=d("WAWebBaseModel").prop(!1),b.limitSharing=d("WAWebBaseModel").prop(),b.galaxyFlowWAMMessageId=d("WAWebBaseModel").prop(),b.galaxyFlowQPLMessageId=d("WAWebBaseModel").prop(),b.galaxyFlowDisabled=d("WAWebBaseModel").prop(),b.groupHistoryBundleMessageKey=d("WAWebBaseModel").prop(null),b.groupHistoryBundleMetadata=d("WAWebBaseModel").prop(null),b.$MsgImpl$p_18=c("lodash").debounce(function(a,b){d("WAWebDBUpdateMessageTable").updateMessageTable(a,{lastPlaybackProgress:b})},500),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.pendingAckUpdate_TESTONLY=function(){return this.$MsgImpl$p_9};f.initialize=function(){var b=this,e;a.prototype.initialize.call(this);this.carouselCardsParsed!=null&&this.$MsgImpl$p_10();this.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&this.listenTo(this,"change:carouselCardsParsed",this.$MsgImpl$p_10);this.$MsgImpl$p_9=new(d("WAWebPromiseQueue").PromiseQueue)();var f=d("WAWebMsgModelUtils").getValidatedSender(this);f&&(this.addChild("senderObj",d("WAWebContactCollection").ContactCollection.gadd(f.isUser()&&!f.isFbidBot()&&!f.isHosted()&&!f.isNewsletter()?d("WAWebWidFactory").createWid(f.isLid()?d("WAJids").toLidUserJid(f.user):d("WAJids").toPhoneUserJid(f.user)):f)),this.hsmTag===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.MARKETING&&this.senderObj.setIsMarketingMessageThread(!0));this.mentionedJidList=this.mentionedJidList||[];this.groupMentions=this.groupMentions||[];this.mentionedJidList.forEach(function(a){return d("WAWebContactCollection").ContactCollection.gadd(a)});this.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.$MsgImpl$p_11);this.mediaObject=void 0;d("WAWebMsgModelUtils").typeIsMms(this)&&(this.$MsgImpl$p_12(),(!this.isViewOnce||d("WAWebViewOnceState").isUnviewed(this.safe()))&&d("WAWebMedia").registerMsg(this));d("WAWebConnModel").Conn.isSMB&&d("WAWebBizLabelUtils").initializeLabels(this);this.isViewOnce&&(this.listenTo(this,"change:ack",this.$MsgImpl$p_13),this.listenTo(this.mediaData,"change:mediaStage",this.$MsgImpl$p_13));this.listenTo(this,"change:viewMode",this.$MsgImpl$p_14);d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,this.viewMode)||this.$MsgImpl$p_14();c("gkx")("26258")||this.listenTo(this,"change:t",function(){Number.isInteger(b.t)||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Invalid timestamp value in msg, raw ts value: ",", msgId: ",", msgType: ","_",""])),b.t,b.id.toString(),b.type,b.subtype).tags("date_marker").sendLogs("Msg TS updated to invalid value")});d("WAWebMsgGetters").getIsMetaBotResponse(this)&&this.listenTo(this,"change:botEditType",this.$MsgImpl$p_15);this.recvFresh&&(e=this.senderObj)!=null&&(e=e.id)!=null&&e.isBot()&&(this.activeBotMsgStreamingInProgress=!0);this.$MsgImpl$p_15()};f.$MsgImpl$p_14=function(){var a;a=(a=(a=d("WAWebFrontendMsgGetters").getMaybeChat(this))==null?void 0:a.msgs)!=null?a:this.msgChunk;!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,this.viewMode)?(this._triggerNotificationForParentMessage(),this.alterChatFields({messageInHiddenViewMode:!0}),a==null||a.trigger("remove_msgs",[this],{})):a==null||a.trigger("insert_msgs",[this],{});a==null||a.triggerChangeLast(null,a,{})};f.hideParentMessageInChat=function(a){a=a.duringDetach;var b=this.parentMsgKey;if(b){var c;b=this.getCollection().get(b);b&&(c=d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor.compatibleMessageTypes)!=null&&c.includes(b.type)&&d("WAWebMessageAssociationUIUtils").shouldHideParentMessage({parentMsg:b,duringDetach:a})&&b.set("viewMode",d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER)}};f._triggerNotificationForParentMessage=function(){var a=d("WAWebFrontendMsgGetters").getEventType(this),b=this.parentMsgKey;a=this.recvFresh&&!d("WAWebMsgGetters").getIsSentByMe(this)&&(a===d("WAWebCommonMsgUtils").EventType.DEFAULT||a===d("WAWebCommonMsgUtils").EventType.SIGNIFICANT);if(b&&a){a=this.getCollection().get(b);a&&d("WAWebNotificationsMsgNotification").eligibleMessagesForNotificationRetriggering.has(a.type)?d("WAWebCmd").Cmd.alertNewMsg(a):d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Msg: _triggerNotificationForParentMessage: parentMsg for "," not found in MsgCollection or not eligible for notification re-triggering"])),this.id.toString())}};f.$MsgImpl$p_10=function(){var a,b=this.carouselCardsParsed;if(b==null)return;a=(a=(a=this.carouselCards)==null?void 0:a.getCardsById())!=null?a:{};var d=[];for(b of b){var e=b.id.toString();if(a[e]!=null){e=a[e];e.set(b);d.push(e)}else{e=babelHelpers["extends"]({},b);d.push(e)}}e=new(c("WAWebCarouselCardsCollection"))();e.add(d);this.carouselCards=e;this.getCollection().add(e.slice())};f.$MsgImpl$p_15=function(){var a=this;if(this.subtype===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE){var b=d("WAWebBotGenTypingIndicatorMsg").getBotTypingIndicatorTimeout();self.setTimeout(function(){a["delete"]()},b);void c("WAWebChangePresenceHandlerAction")({id:this.id.remote,type:"typing"});return}b=this.botEditType;if(b==null)return;var e=d("WAWebBotGenTypingIndicatorMsg").getBotTypingIndicatorTimeout();switch(b){case d("WAWebBotTypes").BotMsgEditType.LAST:case d("WAWebBotTypes").BotMsgEditType.FULL:this.activeBotMsgStreamingInProgress=!1;this.botEditTimeoutID&&self.clearTimeout(this.botEditTimeoutID);return;default:this.botEditTimeoutID=self.setTimeout(function(){a.activeBotMsgStreamingInProgress=!1,a.botEditType=d("WAWebBotTypes").BotMsgEditType.LAST,void d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,{botEditType:d("WAWebBotTypes").BotMsgEditType.LAST})},e)}};f.getRawLinks=function(){this.type===d("WAWebMsgType").MSG_TYPE.REVOKED&&this.$MsgImpl$p_1.length>0&&this.clearRawLinks();return this.$MsgImpl$p_1};f.setRawLinks=function(a){a.length>0&&(this.$MsgImpl$p_1=a)};f.clearRawLinks=function(){this.$MsgImpl$p_1=[],this.linksIndexParsed=0};f.getRawPollOptionsToLinks=function(){return this.$MsgImpl$p_4};f.setRawPollOptionsToLinks=function(a){this.$MsgImpl$p_4=a};f.getRawHeaderLinks=function(){return this.$MsgImpl$p_2};f.setRawHeaderLinks=function(a){a.length>0&&(this.$MsgImpl$p_2=a)};f.getRawFooterLinks=function(){return this.$MsgImpl$p_3};f.setRawFooterLinks=function(a){a.length>0&&(this.$MsgImpl$p_3=a)};f.getRawPhoneNumbers=function(){return this.$MsgImpl$p_5};f.setRawPhoneNumbers=function(a){a.length>0&&(this.$MsgImpl$p_5=a)};f.clearRawPhoneNumbers=function(){this.$MsgImpl$p_5=[],this.phoneNumbersIndexParsed=0};f.getRawHeaderPhoneNumbers=function(){return this.$MsgImpl$p_6};f.setRawHeaderPhoneNumbers=function(a){a.length>0&&(this.$MsgImpl$p_6=a)};f.getRawFooterPhoneNumbers=function(){return this.$MsgImpl$p_7};f.setRawFooterPhoneNumbers=function(a){a.length>0&&(this.$MsgImpl$p_7=a)};f.$MsgImpl$p_12=function(){this.addChild("mediaData",new(c("WAWebMediaData"))())};f.mayFail=function(){return d("WAWebMsgGetters").getIsSentByMe(this)&&this.ack<d("WAWebAck").ACK.SENT};f.isUnsentPhoneMsg=function(){return!this.local&&d("WAWebMsgGetters").getIsSentByMe(this)&&this.ack<d("WAWebAck").ACK.SENT};f.supportsStarWithKeepInChat=function(){return d("WAWebMsgGetters").getIsEphemeral(this)&&(this.star||this.isGif||d("WAWebMsgGetters").getIsStickerMsg(this))};f.interactiveButtonsReleased=function(){return this.isFromTemplate||!d("WAWebFrontendMsgGetters").getHasTemplateButtons(this)&&this.type!==d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY};f.getVcardWids=function(){return this.type!==d("WAWebMsgType").MSG_TYPE.VCARD?null:d("WAWebVcardParsingUtils").vcardAllWids(d("WAWebMsgGetters").getVcard(this))};f.getMultiVcardWids=function(){if(this.type!==d("WAWebMsgType").MSG_TYPE.MULTI_VCARD)return null;var a=d("WAWebMsgGetters").getVcardList(this).map(function(a){return a.vcard}).filter(Boolean).map(function(a){return d("WAWebVcardParsingUtils").parseMultiVcard(a)}).flat();a=a.map(function(a){return d("WAWebVcardParsingUtils").vcardAllWids(a)}).flat();return Array.from(new Set(a))};f.getLocObject=function(){var a=this.loc;if(a){a=a.split("\n");var b=a[0];a=a[1];a=a===void 0?null:a;return{name:b,addr:a}}return null};f.resumeRemoteUpload=function(){if(d("WAWebMsgGetters").getIsNewsletterMsg(this))return d("WAWebMedia").resumeUploadMsg(this);this.isUnsentPhoneMsg()&&d("WAWebSendMsgRecordAction").sendMsgRecord(this);return this.forceDownloadMediaEvenIfExpensive()};f.forceRMR=function(){return(o||(o=b("Promise"))).reject(c("err")("unimplemented forceRMR"))};f.isForcingRMR=function(){return!1};f.cancelDownload=function(){d("WAWebMedia").cancelDownloadMsg(this)};f.resumeUpload=function(){this.mediaData.mediaStage!==d("WAWebMediaTypes").MediaDataStage.NEED_UPLOAD&&d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["resumeUpload called while state was ",""])),this.mediaData.mediaStage).sendLogs("resume-non-need-upload");return d("WAWebMedia").resumeUploadMsg(this).then(function(a){return a==null?void 0:a.messageSendResult})};f.cancelUpload=function(){d("WAWebMedia").cancelUploadMsg(this)};f.waitForPhoneUpload=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;if(this.mediaData!=null&&Boolean(this.mediaData.filehash)&&!this.isUnsentPhoneMsg())return;this.$MsgImpl$p_8||(this.$MsgImpl$p_8=c("WAWebEventsWaitForBbEvent")(this.mediaData,"change:mediaStage change:filehash",function(){return Boolean(a.mediaData.filehash)&&!a.isUnsentPhoneMsg()}));yield this.$MsgImpl$p_8;this.$MsgImpl$p_8=null});function d(){return a.apply(this,arguments)}return d}();f.forceDownloadMediaEvenIfExpensive=function(){return this.downloadMedia({downloadEvenIfExpensive:!0,rmrReason:d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_CLICK,isUserInitiated:!0})};f.downloadMedia=function(a){var e=this;if(d("WAWebFrontendMsgGetters").getAsRevoked(this))return(o||(o=b("Promise"))).resolve();var f=a.downloadEvenIfExpensive,g=a.rmrReason,h=a.isUserInitiated,i=a.isAutoDownload,j=a.shouldSequenceDownload;if(!h&&!d("WAWebMsgModelPropUtils").isTrusted(this))return(o||(o=b("Promise"))).resolve();if(!d("WAWebMsgGetters").getIsStatus(this)&&d("WAWebFrontendMsgGetters").getChat(this).isSuspendedOrTerminated()&&d("WAWebMiscGatingUtils").isGroupSuspendV2Enabled()){h&&d("WAWebModalManager").ModalManager.open(q.jsx(c("WAWebSuspendedGroupMediaDownloadFailureModal.react"),{}),{transition:"modal-flow"});return(o||(o=b("Promise"))).resolve()}d("WAWebFrontendMsgGetters").getAsMms(this)||d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["id: "," type: ",""])),this.id.toString(),this.type).devConsole(this).sendLogs("media-fault: downloadMedia msg is not mms type");if(this.isUnsentPhoneMsg()){var k=this.$MsgImpl$p_8;k||(k=this.$MsgImpl$p_8=c("WAWebEventsWaitForBbEvent")(this.mediaData,"change:mediaStage change:filehash",function(){return!!e.mediaData.filehash&&!e.isUnsentPhoneMsg()}).then(function(){e.$MsgImpl$p_8=null}));return k.then(function(){return e.downloadMedia(a)})}return d("WAWebMedia").downloadMsg({msg:this,isUserClick:g===d("WAWebWamEnumWebcRmrReasonCode").WEBC_RMR_REASON_CODE.MSG_CLICK,downloadEvenIfExpensive:f,rmrReason:g,rmrData:this.$MsgImpl$p_16(g),mode:h?"manual":"auto",isAutoDownload:i,chatWid:(k=d("WAWebFrontendMsgGetters").getMaybeChat(this))==null?void 0:k.id,shouldSequenceDownload:j})};f.$MsgImpl$p_16=function(a){a={webcRmrReason:a,webcMessageT:this.t};var b=d("WAWebFrontendMsgGetters").getMaybeChat(this);if(b){a.webcChatType=b.getWebcChatType();b.initialIndex!=null&&(a.webcChatPosition=b.initialIndex);var c=this.msgChunk;c&&c===b.msgs&&(a.webcMessageIndex=c.length-c.indexOf(this)-1)}return a};f.applyUpdate=function(a){var c=this;if(a.type&&this.type!==a.type&&d("WAWebMsgModelUtils").typeIsMms(a)){!d("WAWebCommonMsgUtils").isPlaceholderMsg(this.type)&&!d("WAWebMsgGetters").getIsFutureproof(this)&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["updated "," from "," to ",""])),this.id.toString(),this.type,String(a.type)).sendLogs("invalid-type-update");this.$MsgImpl$p_12();d("WAWebMedia").registerMsgEarly(this,a);return d("WAWebMedia").prepareMsg(this).then(function(){c.set(a)})["catch"](function(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["error = ",""])),String(a)).devConsole(a).sendLogs("preregister-error")})}this.set(a);return(o||(o=b("Promise"))).resolve()};f.waitForPrep=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,c=this;a=this.requiresDirectConnection==null?d("WAWebDirectConnectionGatingUtils").genDirectConnectionMessageModifiers(this.type,(a=this.list)==null?void 0:a.listType,this.businessOwnerJid).then(function(a){return c.set(a)}):(o||(o=b("Promise"))).resolve();var e=d("WAWebMsgModelUtils").typeIsMms(this)?d("WAWebMedia").prepareMsg(this):(o||(o=b("Promise"))).resolve();yield a;return e});function c(){return a.apply(this,arguments)}return c}();f.alterChatFields=function(a){var b=this.$MsgImpl$p_17().get(this.id.remote);if(b){var c;(this.id.remote.isBot()||((c=b.contact.businessProfile)==null?void 0:c.isBizBot3p)===!0)&&this.subtype===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE&&b.botInitialTypingIndicatorMsgId&&(b.botInitialTypingIndicatorMsgId.equals(this.id)&&b.set({botInitialTypingIndicatorMsgId:null},{silent:!0}));b.unreadMsgAnchor===this&&(b.unreadMsgAnchor=void 0);c=(a==null?void 0:a.messageInHiddenViewMode)===!0||!a||!a.doNotResetLastReceived;if(c&&b.lastReceivedKey===this.id){c=void 0;var e=d("WAWebChatGetMessage").getLastReceivedMsg(b);e&&(c=e.id);b.lastReceivedKey=c}b.composeQuotedMsg===this&&(a==null?void 0:a.messageInHiddenViewMode)!==!0&&(b.composeQuotedMsg=null)}};f["delete"]=function(b){a.prototype["delete"].call(this);this.botEditTimeoutID&&self.clearTimeout(this.botEditTimeoutID);d("WAWebStarredMsgCollection").AllStarredMsgsCollection.remove(this);d("WAWebPinInChatCollection").PinInChatCollection.deleteByParentMessageKey(this.id);d("WAWebLabelCollection").LabelCollection.removeAllLabelsMD(this);d("WAWebMsgModelUtils").typeIsMms(this)&&d("WAWebMedia").deregisterMsg(this);var c=this.getCollection();d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&d("WAWebMessageAssociationUIUtils").getHiddenAssociatedMessages(this.id).forEach(function(a){a["delete"]()});c.remove(this.id);this.hideParentMessageInChat({duringDetach:!1});this.msgChunk&&this.msgChunk.remove(this.id,{},Boolean(b==null?void 0:b.skipUpdatingSortTime));this.alterChatFields(b);d("WAWebMsgGetters").clearMsgGetterCacheFor(this);d("WAWebFrontendMsgGetters").clearFrontendMsgGetterCacheFor(this)};f.isLastMessage=function(){var a=d("WAWebFrontendMsgGetters").getChat(this).msgs.last();return this.id.equals(a==null?void 0:a.id)};f.msgContextInfo=function(a){var b=this.toJSON();b.id;b.t;b.notifyName;b.from;b.to;b.author;b.ack;b.invis;b.isNewMsg;b.star;b.recvFresh;b.recipients;b.broadcast;b.quotedMsg;b.quotedStanzaID;b.quotedRemoteJid;b.quotedParticipant;b.quotedType;b.senderObj;b.multicast;b.replyButtons;b.buttons;b.latestEditMsgKey;b.latestEditSenderTimestampMs;b=babelHelpers.objectWithoutPropertiesLoose(b,h);var c=this.id,e=null;a&&!c.remote.equals(a)&&(e=c.remote);a=d("WAWebMsgModelUtils").getQuotedParticipantForContextInfo(this);return{quotedMsg:b,quotedParticipant:a,quotedStanzaID:c.id,quotedRemoteJid:e}};f.displayName=function(a){a===void 0&&(a={});a=a;var b=a.showShortName;b=b===void 0?!1:b;var e=a.showVerifiedName;e=e===void 0?!1:e;var f=a.withPushName;f=f===void 0?!1:f;var g=a.withPushNameOnly;g=g===void 0?!1:g;a=a.newPushNameFormatting;a=a===void 0?!1:a;if(!d("WAWebMsgGetters").getSender(this))return"";if(d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getSender(this)))return c("fbs")._(/*BTDS*/"You").toString();if(d("WAWebMsgGetters").getIsPSA(this))return d("WAWebConnModel").Conn.isSMB?c("fbs")._(/*BTDS*/"WhatsApp Business").toString():c("fbs")._(/*BTDS*/"WhatsApp").toString();if(this.senderObj==null)return"";var h=this.senderObj;b=b?h.shortName:void 0;if(!c("isStringNullOrEmpty")(b))return b;else if(h.name)return h.name;if(e&&h.verifiedLevel===d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH&&h.verifiedName)return h.verifiedName;if(d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){b=d("WAWebFrontendContactGetters").getFormattedUsernameAndType(h);if(b!=null)return b.displayName}e=a?d("WAWebChatContactUtils").getFormattedNotifyName(this.notifyName).toString():"~"+this.notifyName;b=f&&this.notifyName?e:"";if(g&&b)return b;f=(a=d("WAWebMsgGetters").getSender(this))!=null&&a.isLid()?d("WAWebFrontendContactGetters").getUserDisplayNameForLid(h):d("WAWebWidFormat").widToFormattedUser(d("WAWebMsgGetters").getSender(this));d("WAWebChatCommunityUtils").shouldMaskPhoneNumberForChat(d("WAWebFrontendMsgGetters").getChat(this),h)&&(f=d("WAWebFrontendContactGetters").getMaskedPhoneLid(h));return""+f+(b?" ":"")+b};f.isMentioned=function(a){return!this.mentionedJidList?!1:this.mentionedJidList.findIndex(function(b){return b.equals(a)})>-1};f.mentionMap=function(){if(!this.mentionedJidList)return null;if(!this.mentionedJidList.length)return null;var a={};this.mentionedJidList.forEach(function(b){a["@"+(c("WAWebWid").user(b)||"")]=d("WAWebContactCollection").ContactCollection.gadd(b)});return a};f.groupMentionMap=function(){var a;if(!this.groupMentions)return null;return!this.groupMentions.length?null:(a=this.groupMentions)==null?void 0:a.reduce(function(a,b){var c="@"+b.groupJid.toString();a[c]=b.groupSubject;return a},{})};f.updateAck=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);var c=this.ack,e=d("WAWebFrontendMsgGetters").getMaybeChat(this);if(!d("WAWebMsgGetters").getIsStatus(this)&&e!=null&&d("WAWebChatGetters").getIsGroup(e)&&this.isMdHistoryMsg&&a>=d("WAWebAck").ACK.RECEIVED&&this.id.fromMe)return;var f=this.id;if(this.id.remote.isStatus()){e=(yield d("WAWebMessageReceiptUtils").fixStatusReceiptKeys([f]));f=e[0]}d("WATypeUtils").isNumber(a)&&(c===void 0||a>c||a===d("WAWebAck").ACK.FAILED)?(this.ack=a,b||this.$MsgImpl$p_9.enqueue(function(){return d("WAWebDBUpdateMessageTable").updateMessageTable(f,{ack:a})})):a===d("WAWebAck").ACK.FAILED&&this.ack===d("WAWebAck").ACK.CLOCK&&(this.ack=d("WAWebAck").ACK.FAILED,this.$MsgImpl$p_9.enqueue(function(){return d("WAWebDBUpdateMessageTable").updateMessageTable(f,{ack:a})}))});function c(b,c){return a.apply(this,arguments)}return c}();f.updateErrorCode=function(a){this.errorCode=a;return d("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{errorCode:a})};f.updateReadQuestionResponsesCount=function(){this.readQuestionResponsesCount=this.questionResponsesCount;return d("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{readQuestionResponsesCount:this.questionResponsesCount})};f.updateGalaxyFlowMsgLoggingIds=function(a,b){this.galaxyFlowWAMMessageId=a;this.galaxyFlowQPLMessageId=b;return d("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{galaxyFlowWAMMessageId:a,galaxyFlowQPLMessageId:b})};f.updateNFMButtonsState=function(a){return d("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{galaxyFlowDisabled:a})};f.updateLastPlaybackProgress=function(a){this.lastPlaybackProgress=a,this.$MsgImpl$p_18(this.id,a)};f.avParams=function(){return d("WAWebMedia").mediaMetadata(this)};f.resend=function(){var a=this;if(d("WAWebMsgGetters").getIsFailed(this)){if(d("WAWebMsgGetters").getIsEdited(this))return d("WAWebSendMessageEditAction").resendLatestEdit(this);var c={ack:d("WAWebAck").ACK.CLOCK};c.isSendFailure=!1;this.$MsgImpl$p_9.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebDBUpdateMessageTable").updateMessageTable(a.id,c),a.set(c)}));if(d("WAWebMsgGetters").getIsNewsletterMsg(this))return d("WAWebNewsletterSendMsgAction").resendNewsletterMsg(this).then(function(a){return a&&a.messageSendResult});return d("WAWebFrontendMsgGetters").getAsMms(this)?d("WAWebMsgGetters").getIsSentByMeFromWeb(this)?this.resumeUpload():this.resumeRemoteUpload():d("WAWebSendMsgRecordAction").sendMsgRecord(this).then(function(a){return a.messageSendResult})}return(o||(o=b("Promise"))).resolve()};f.$MsgImpl$p_11=function(){if(d("WAWebMsgGetters").getIsStatus(this))return;var a=d("WAWebFrontendMsgGetters").getChat(this),b=a.msgs.length;a=a.msgs.indexOf(this);a!==-1&&b-a<=10&&!d("WAWebMsgGetters").getIsSentByMe(this)&&d("WAWebCmd").Cmd.alertNewMsg(this)};f.$MsgImpl$p_13=function(){if(!this.isViewOnce)return;if(this.mediaData==null)return;var a=d("WAWebMsgGetters").getIsSentByMe(this)&&this.ack>=d("WAWebAck").ACK.SENT&&this.mediaData.mediaStage===d("WAWebMediaTypes").MediaDataStage.RESOLVED,b=!d("WAWebMsgGetters").getIsSentByMe(this)&&this.ack>=d("WAWebAck").ACK.PLAYED;(a||b)&&(this.stopListening(this,"change:ack",this.$MsgImpl$p_13),this.stopListening(this.mediaData,"change:mediaStage",this.$MsgImpl$p_13),d("WAWebMedia").deregisterMsg(this))};f.isReaction=function(){return d("WAWebMsgGetters").getIsReaction(this)};f.isEditProtocolMsg=function(){return d("WAWebMsgGetters").getIsEditProtocolMsg(this)};f.getWamDisappearingModeInitiator=function(){var a=this.disappearingModeInitiator;if(a==null)return null;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_ME;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:case d("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_OTHER;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.CHAT}};f.getWamMessageType=function(){return d("WAWebWamMsgUtils").getWamMessageType(this)};f.getWamMediaType=function(){return d("WAWebWamMsgUtils").getWamMediaType(this)};f.getWamEditType=function(){return d("WAWebMsgGetters").getWamEditType(this)};f.getForwardingScoreWhenForwarded=function(){var a=5,b=d("WAWebMsgGetters").getNumTimesForwarded(this)+(d("WAWebMsgGetters").getShouldDisplayAsForwarded(this)?1:0);return b>=a?c("WAWebConstantsDeprecated").FREQUENTLY_FORWARDED_SENTINEL:b};f.isExpired=function(){var a=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);return a==null?!1:a<=d("WATimeUtils").unixTime()};f.isRealMessage=function(){var a=this.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&this.from.equals(d("WAWebUserPrefsMeUser").getMaybeMePnUser());return!a&&!d("WAWebMsgGetters").getIsInitialE2ENotification(this)&&this.type!==d("WAWebMsgType").MSG_TYPE.CALL_LOG&&!d("WAWebMsgGetters").getIsBizNotification(this)&&!["change_number","change_username","masked_thread_created"].includes(this.subtype)&&!d("WAWebMsgGetters").getIsDisappearingModeSystemMessage(this)};f.isExpiredAndNotKept=function(){return this.isExpired()&&!d("WAWebMsgGetters").getIsKept(this)};f.timeUntilExpiration=function(){var a=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);if(a==null)return null;return this.isExpired()?0:a-d("WATimeUtils").unixTime()};f.getCollection=function(){return d("WAWebMsgCollection").MsgCollection};f.$MsgImpl$p_17=function(){return d("WAWebMsgGetters").getIsNewsletterMsg(this)?c("WAWebNewsletterCollection"):d("WAWebChatCollection").ChatCollection};f.safe=function(){return this};f.unsafe=function(){return this};f.$MsgImpl$p_19=function(){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getKicSender(this))};f.keepIsLockedForMe=function(){return this.keepIsLockedByDmSettingsForUser(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())};f.keepIsLockedForUser=function(a){return this.keepIsLockedByDmSettingsForUser(a)};f.keepIsLockedForMeSenderSuperpower=function(){var a=d("WAWebMsgGetters").getKicSender(this);a=c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(a,d("WAWebMsgGetters").getSender(this)));return d("WAWebMsgGetters").getIsUnkept(this)&&a&&!this.$MsgImpl$p_19()};f.keepIsLockedByDmSettingsForUser=function(a){var b;b=d("WAWebChatGetters").getIsGroup(d("WAWebFrontendMsgGetters").getChat(this))?!((b=d("WAWebFrontendMsgGetters").getChat(this).groupMetadata)!=null&&b.userCanSetEphemeralSetting(a)):!1;return b};f.$MsgImpl$p_20=function(){return!d("WAWebFrontendMsgGetters").getChat(this).supportsKIC()?!1:d("WAWebMsgGetters").getIsEphemeral(this)&&this.type!==d("WAWebMsgType").MSG_TYPE.REVOKED&&!this.isViewOnce&&!d("WAWebFrontendMsgGetters").getAsAlbum(this)};f.canShowKeepOrUnkeepOption=function(){return this.canShowKeepOption()||this.canShowUnkeepOption()};f.canShowKeepOption=function(){var a;return this.$MsgImpl$p_20()&&(d("WAWebChatGroupUtils").canSendToGroup(d("WAWebFrontendMsgGetters").getChat(this))||((a=d("WAWebFrontendMsgGetters").getChat(this).groupMetadata)==null?void 0:a.pastParticipants.get(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()))!=null)&&!this.keepIsLockedForMe()&&!this.star&&!this.isGif&&!d("WAWebMsgGetters").getIsStickerMsg(this)};f.canShowUnkeepOption=function(){return d("WAWebMsgGetters").getIsKept(this)&&this.$MsgImpl$p_20()&&(this.canRevokeUnkeep()||this.canShowKeepOption()||this.isGif||d("WAWebMsgGetters").getIsStickerMsg(this))};f.canRevokeUnkeep=function(){if(d("WAWebMsgGetters").getIsSentByMe(this)){var a;if(d("WAWebChatGetters").getIsGroup(d("WAWebFrontendMsgGetters").getChat(this))&&((a=d("WAWebFrontendMsgGetters").getChat(this).groupMetadata)==null?void 0:a.participants.iAmMember())===!0)return!0;else if(d("WAWebChatGetters").getIsUser(d("WAWebFrontendMsgGetters").getChat(this))&&!d("WAWebFrontendMsgGetters").getChat(this).contact.isContactBlocked)return!0}return!1};f.isPastUnkeepExpirationLimit=function(){var a=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(this);if(a!=null){a=Math.trunc(+new Date()/1e3)-a;return d("WAWebMsgGetters").getIsKept(this)&&a>d("WAWebEphemeralKeepInChatAbpropUtils").getUndoKeepInChatExpiration()}return!1};f.shouldShowNotificationPreview=function(){var a;return!((a=d("WAWebFrontendMsgGetters").getAsViewOnce(this))!=null&&a.isViewOnce)&&d("WAWebMuteCollection").MuteCollection.getGlobalPreviews()};f.senderIsGroupParticipant=function(){var a=d("WAWebFrontendMsgGetters").getChat(this).groupMetadata;if(a==null)return!1;var b=d("WAWebMsgGetters").getSender(this);if(b!=null&&a.participants.get(b)!=null)return!0;if(!a.isCag)return!1;b=b!=null?d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(b)):null;return b==null?!1:a.participants.get(b)!=null};f.detachAssociatedMsg=function(){this.hideParentMessageInChat({duringDetach:!0}),this.set({viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,associationType:null,parentMsgKey:null})};f.updateGroupHistoryBundleProcessState=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(this.groupHistoryBundleMetadata==null)return(o||(o=b("Promise"))).reject();yield d("WAWebDBUpdateMessageTable").updateMessageTable(this.id,{groupHistoryBundleMetadata:babelHelpers["extends"]({},this.groupHistoryBundleMetadata,{processState:a})});this.set({groupHistoryBundleMetadata:babelHelpers["extends"]({},this.groupHistoryBundleMetadata,{processState:a})});return(o||(o=b("Promise"))).resolve()});function c(b){return a.apply(this,arguments)}return c}();return e}(d("WAWebBaseModel").BaseModel);a.Proxy="msg";a.idClass=c("WAWebMsgKey");a.kind="__MOCKED_KIND__";e=d("WAWebBaseModel").defineModel(a);g.Msg=e}),226);
__d("WAWebMsgModelPropUtils",["WAWebBusinessProfileTypes","WAWebChatGetters","WAWebContactGetters","WAWebFrontendMsgGetters","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgGetters","WAWebMsgType","WAWebStateUtils","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a){a=d("WAWebStateUtils").unproxy(a);if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE)return a.interactiveType===c("WAWebInteractiveMessageType").SHOPS_STOREFRONT||a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&a.nativeFlowName!=null&&[c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS,c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO].includes(a.nativeFlowName);if(a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW)return a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO;return a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL?a.subtype==="event_edit_decrypted":["image","video","ptv","audio","ptt","location","vcard","multi_vcard","document","ciphertext","debug_placeholder","oversized","unknown","call_log","revoked","sticker","payment","poll_creation","poll_result_snapshot","groups_v4_invite","newsletter_admin_invite","product","order","event_creation","biz_content_placeholder","album","sticker-pack","newsletter_follower_invite"].includes(a.type)}function b(a){a=d("WAWebStateUtils").unproxy(a);if(d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getSender(a)))return!0;if(a.senderObj!=null&&d("WAWebContactGetters").getIsMyContact(a.senderObj))return!0;var b=d("WAWebFrontendMsgGetters").getChat(a);if(d("WAWebChatGetters").getIsGroup(b)||d("WAWebChatGetters").getIsNewsletter(b))return b.isTrusted();if(d("WAWebMsgGetters").getIsPSA(a)||d("WAWebMsgGetters").getIsCAPISupport(a))return!0;if(a.isFromTemplate)return!0;a=d("WAWebChatGetters").getIsGroup(b)?a.senderObj:b.contact;return(a==null?void 0:a.verifiedLevel)===d("WAWebBusinessProfileTypes").VERIFIED_LEVEL.HIGH?!0:b.notSpam}function e(a){a=d("WAWebStateUtils").unproxy(a);return((a=d("WAWebFrontendMsgGetters").getChat(a).groupMetadata)==null?void 0:a.participants.iAmMember())===!0}g.hasSymbol=a;g.isTrusted=b;g.iAmGroupParticipant=e}),98);
__d("WAWebCongratulationsAnimationsGatingUtils",["WAWebABProps","gkx"],(function(a,b,c,d,e,f,g){function a(){return!c("gkx")("26258")&&d("WAWebABProps").getABPropConfigValue("fullscreen_animation_for_keyword")}g.isCongratulationsAnimationsEnabled=a}),98);
__d("WAWebCongratulationsAnimationsUtils",["$InternalEnum","WAWebURLUtils"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["DEFAULT"]),i="https://static.whatsapp.net/wa/static/test";function a(a){var b=null;if(a===h.DEFAULT){a={cat:"test",id:"confetti-falling",test:"1"};b=c("WAWebURLUtils").build(i,a)}return b}g.CelebrationAnimationType=h;g.getCongratulationsAnimationPath=a}),98);
__d("WAWebMsgModelUtils",["WALogger","WAWebAck","WAWebAnimatedEmojiGatingUtils","WAWebBackendErrors","WAWebChatEphemerality","WAWebChatMsgsCollection","WAWebChatPreferenceCollection","WAWebCommonMsgUtils","WAWebCongratulationsAnimationsGatingUtils","WAWebCongratulationsAnimationsUtils","WAWebEmoji","WAWebEmojiConst","WAWebFileUtils","WAWebFindChatAction","WAWebFrontendMsgGetters","WAWebGroupMetadataCollection","WAWebInteractiveMessageHeaderMediaType","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgKey","WAWebMsgModel","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWid","WAWebWidJsonReviver"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;({image:!0,video:!0,audio:!0,ptt:!0,sticker:!0,document:!0,product:!0});function a(a){var b;switch(a.type){case"image":case"video":case"ptv":case"audio":case"ptt":case"sticker":case"document":case"product":case"sticker-pack":case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:return!0;case"protocol":return a.subtype==="history_sync_notification";case d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW:return a.headerType===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE;case d("WAWebMsgType").MSG_TYPE.INTERACTIVE:return Boolean(((b=a.interactiveHeader)==null?void 0:b.mediaType)&&d("WAWebInteractiveMessageHeaderMediaType").IM_MEDIA_HEADER_TYPES.has(a.interactiveHeader.mediaType));default:return!1}}function b(a){return a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&a.subtype==="url"}function e(a){return a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&a.subtype==="url"}function f(a,b){switch(b){case"text":return a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&a.subtype!=="url";case"image":return a.type===d("WAWebMsgType").MSG_TYPE.IMAGE;case"video":return a.type===d("WAWebMsgType").MSG_TYPE.VIDEO&&!a.isGif;case"gif":return a.type===d("WAWebMsgType").MSG_TYPE.VIDEO&&a.isGif;case"audio":return a.type===d("WAWebMsgType").MSG_TYPE.AUDIO;case"ptt":return a.type===d("WAWebMsgType").MSG_TYPE.PTT;case"document":return a.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT;case"location":return a.type===d("WAWebMsgType").MSG_TYPE.LOCATION;case"vcard":return a.type===d("WAWebMsgType").MSG_TYPE.VCARD||a.type===d("WAWebMsgType").MSG_TYPE.MULTI_VCARD;case"url":return a.type===d("WAWebMsgType").MSG_TYPE.CHAT&&a.subtype==="url";case"sticker":return a.type===d("WAWebMsgType").MSG_TYPE.STICKER;case void 0:return!1;default:return!1}}function o(a){if(!a)return null;var b=typeof a.id==="string"?a.id:a.id.id;b=new(c("WAWebMsgKey"))({from:a.from,to:a.to,id:b,participant:a.participant,selfDir:a.self});a.id=b;b=new(d("WAWebMsgModel").Msg)(a);b.fromQuotedMsg=!0;return b}function p(a){if(a.length>1)return null;a=a.filter(function(a){return!d("WAWebMsgGetters").getHasOriginatedFromNewsletter(a)&&(d("WAWebMsgGetters").getIsMedia(a)||d("WAWebFileUtils").isDocument(a))&&Boolean(a.caption)});return a.length===1?a[0]:null}function q(a){var b,e,f;if(a instanceof d("WAWebMsgModel").Msg)e=a,f=a.id;else if(a instanceof c("WAWebMsgKey"))f=a;else{d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["model:msgs:broadcastFanout: unknown msgOrKey: ",""])),String(a)).devConsole(a);return void 0}if(c("WAWebWid").isStatus(f.remote))return;if((a=e)!=null&&a.recipients&&e.recipients.length!==0)b=e.recipients;else{a=c("WAWebGroupMetadataCollection").get(f.remote);a?b=a.participants.map(function(a){return a.id}):d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: ",""])),f.remote.toString())}return b?b.map(function(a){return new(c("WAWebMsgKey"))({fromMe:f.fromMe,remote:a,id:f.id})}):void 0}function r(a){var b;if(!a.invis){var c=q(a);c&&(b=c.map(function(a){return a.remote}),c.forEach(function(b){if(!d("WAWebMsgCollection").MsgCollection.some(function(a){return a.id.equals(b)})){var c=v(a);c.to=b.remote;c.id=b;c.broadcast=!0;var e=d("WAWebMsgCollection").MsgCollection.add(c,{merge:!0});d("WAWebFindChatAction").findOrCreateLatestChat(b.remote,"msgModelBroadcastFanout").then(function(a){var b=a.chat;a=e.reduce(function(a,c){if(c==null)return a;if(c.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL){d("WAWebChatEphemerality").isEphemeralSettingOn(b)&&(c.ephemeralDuration=d("WAWebChatEphemerality").getEphemeralSetting(b));var e=d("WAWebChatEphemerality").getEphemeralSettingTimestamp(b);e!=null&&(c.ephemeralSettingTimestamp=e);e=d("WAWebChatEphemerality").getDisappearingModeInitiator(b);e!=null&&(c.disappearingModeInitiator=e)}a.push(c);return a},[]);s(a,b,!0)})}}))}return b}function s(a,b,c,e,f,g){e=e||b.msgs;if(a.length===0)return;var h=e===b.msgs;if(g)if(h)d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["models:msg:store:resetMostRecentMsgs .msgs === cmc !"]))),t(b,e,a);else{t(b,e,a);g=new(d("WAWebChatMsgsCollection").ChatMsgsCollection)();g.replace(b.msgs);b.msgChunks.push(g);b.replaceMsgsCollection(e);b.msgs.trigger("change:last",b.msgs.last())}else c?h?t(b,e,a):u(e,a):u(e,a,{at:0,silent:a.every(w)});var i=f;i&&!b.unreadMsgAnchor&&(b.disableUnreadAnchor?b.disableUnreadAnchor=!1:b.unreadMsgAnchor=a.find(function(a){return a.id.toString()===i.toString()}))}function t(a,b,c){var d=c.at(-1);if(!d)return;u(b,c);a.lastReceivedKey=d.id}function u(a,b,c){try{a.add(b,c)}catch(a){if(a instanceof d("WAWebBackendErrors").LogoutDrop)d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["setRecords LogoutDrop: ",""])),a.toString()).devConsole(a);else throw a}}function v(a){return a!=null&&typeof a==="object"?JSON.parse(JSON.stringify(a),d("WAWebWidJsonReviver").jsonWidReviver):a}function w(a){return d("WAWebFrontendMsgGetters").getEventType(a)===d("WAWebCommonMsgUtils").EventType.IGNORE}function x(a){return a.filter(function(a){return a.ack===d("WAWebAck").ACK.READ}).map(function(a){return a.id.toString()})}var y=new RegExp(["congratulations","congrats"].join("|"));function z(a){if(!d("WAWebCongratulationsAnimationsGatingUtils").isCongratulationsAnimationsEnabled())return null;if(a!=null){a=y.test(a.toLocaleLowerCase());if(a)return d("WAWebCongratulationsAnimationsUtils").CelebrationAnimationType.DEFAULT}return null}function A(a,b){if(b!==d("WAWebMsgType").MSG_TYPE.CHAT)return;if(a==null||a==="")return;b=d("WAWebEmoji").EmojiUtil.matchLargeEmojiPattern(a);if(b==null||b.length!==1)return;a=d("WAWebEmoji").EmojiUtil.normalizeEmoji(b[0]);return a}function B(a,b){if(!d("WAWebAnimatedEmojiGatingUtils").isAnimatedEmojiEnabled()||!c("WAWebChatPreferenceCollection").get("autoplayAnimatedImages"))return!1;a=A(a,b);return a!=null&&d("WAWebEmojiConst").getSupportedAnimatedEmojis().includes(a)}var C=new Set([(n=d("WAWebMsgType")).MSG_TYPE.NOTIFICATION,n.MSG_TYPE.NOTIFICATION_TEMPLATE,n.MSG_TYPE.GP2,n.MSG_TYPE.BROADCAST_NOTIFICATION,n.MSG_TYPE.E2E_NOTIFICATION,n.MSG_TYPE.CALL_LOG,n.MSG_TYPE.PROTOCOL,n.MSG_TYPE.DEBUG,n.MSG_TYPE.CIPHERTEXT]);function D(a){var b=d("WAWebMsgGetters").getSender(a);if(b==null&&!C.has(a.type)){var c;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Undefined sender for "," subtype:"," from:",", author:",""])),a.id.toString(),a.subtype,a.from.toString(),(c=a.author)==null?void 0:c.toString());d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Messages should have a sender!"]))).sendLogs(a.type+"-msg-missing-sender",{sampling:.01})}return b}function E(a){var b=d("WAWebMsgGetters").getSender(a);d("WAWebMsgGetters").getIsNewsletterMsg(a)?b=a.id.remote:d("WAWebMsgGetters").getIsGroupStatus(a)&&(b=a.author);return b}g.typeIsMms=a;g.typeIsUrl=b;g.notRefiningTypeIsUrl=e;g.msgMatchesType=f;g.createQuotedMsg=o;g.getMediaMsgWithCaptionForForwarding=p;g.getBroadcastFanoutKeys=q;g.broadcastFanout=r;g.addRecordsToChat=s;g.getReadMsgKeys=x;g.getCelebrationAnimationType=z;g.isSingleEmojiMessageText=A;g.isAnimatedEmoji=B;g.getValidatedSender=D;g.getQuotedParticipantForContextInfo=E}),98);
__d("WAWebLogoFacebookIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="logo-facebook";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=28;o=28;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 28 28",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M15.0896028,14.7272727 L15.1043384,26 L4.33333333,26 C1.91438192,26 0,24.0856181 0,21.6666667 L0,4.33333333 C0,1.91438192 1.91438192,0 4.33333333,0 L21.6666667,0 C24.0856181,0 26,1.91438192 26,4.33333333 L26,21.6666667 C26,24.0856181 24.0856181,26 21.6666667,26 L16.3649427,26 L16.3502071,14.7272727 L19.8103776,14.7272727 L20.017785,13.4545455 L16.3550034,13.4545455 L16.3636733,12.4459498 L16.3818182,10.3393939 C16.3818182,8.69776256 17.1633755,7.73939393 18.9587599,7.74051324 L20.1818182,7.68259683 L20.1818182,6.38433052 L20.1617937,6.38468908 C19.4139177,6.39804401 18.7382334,6.4060606 18.2060606,6.4060606 C16.1406731,6.4060606 15.1030303,7.44259476 15.103009,9.67926308 L15.0783339,13.4545455 L11.8018536,13.4545455 L11.8042105,14.7272727 L15.0896028,14.7272727 Z M14.1030303,25 L14.0909091,15.7272727 L10.8060606,15.7272727 L10.8,12.4545455 L14.0848485,12.4545455 L14.1030303,9.67272727 C14.1030303,6.8060606 15.6727273,5.4060606 18.2060606,5.4060606 C19.4060606,5.4060606 21.1818182,5.36363637 21.1818182,5.36363636 L21.1818182,8.63636364 L19.0060606,8.73939393 C17.6060606,8.73939393 17.3818182,9.4060606 17.3818182,10.3393939 L17.3636364,12.4545455 L21.1939394,12.4545455 L20.6606061,15.7272727 L17.3515151,15.7272727 L17.3636364,25 L21.6666667,25 C23.5333333,25 25,23.5333333 25,21.6666667 L25,4.33333333 C25,2.46666667 23.5333333,1 21.6666667,1 L4.33333333,1 C2.46666667,1 1,2.46666667 1,4.33333333 L1,21.6666667 C1,23.5333333 2.46666667,25 4.33333333,25 L14.1030303,25 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),k.jsx("path",{d:"M14.1030303,25 L4.33333333,25 C2.46666667,25 1,23.5333333 1,21.6666667 L1,4.33333333 C1,2.46666667 2.46666667,1 4.33333333,1 L21.6666667,1 C23.5333333,1 25,2.46666667 25,4.33333333 L25,21.6666667 C25,23.5333333 23.5333333,25 21.6666667,25 L17.3636364,25 L17.3515151,15.7272727 L20.6606061,15.7272727 L21.1939394,12.4545455 L17.3636364,12.4545455 L17.3818182,10.3393939 C17.3818182,9.4060606 17.6060606,8.73939393 19.0060606,8.73939393 L21.1818182,8.63636364 L21.1818182,5.36363636 C21.1818182,5.36363637 19.4060606,5.4060606 18.2060606,5.4060606 C15.6727273,5.4060606 14.1030303,6.8060606 14.1030303,9.67272727 L14.0848485,12.4545455 L10.8,12.4545455 L10.8060606,15.7272727 L14.0909091,15.7272727 L14.1030303,25 Z",fillOpacity:.6,fill:"#FFFFFF"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LogoFacebookIcon=a}),98);
__d("WAWebLogoInstagramIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="logo-instagram";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=28;o=28;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 28 28",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M13.0000238,0 C16.0471863,0 16.5726824,0.00844009118 17.9931478,0.0732517966 C19.2870609,0.132267821 20.2814874,0.332106718 21.2226416,0.697902272 C22.1770489,1.06875343 22.952994,1.56696125 23.6930681,2.30698242 C24.4330127,3.04697986 24.9312153,3.82289637 25.3021335,4.77732795 C25.667913,5.71859186 25.8677347,6.71299539 25.9267474,8.00683567 C25.9915599,9.42731803 26,9.95281754 26,13.0000238 C26,16.0471863 25.9915599,16.5726824 25.9267482,17.9931478 C25.8677347,19.2870046 25.667913,20.2814081 25.3021264,21.2226904 C24.9312153,22.1771036 24.4330127,22.9530201 23.6930176,23.6930681 C22.9530201,24.4330127 22.1771036,24.9312153 21.222672,25.3021335 C20.2814081,25.667913 19.2870046,25.8677347 17.9931643,25.9267474 C16.5726824,25.9915599 16.0471863,26 13.0000238,26 C9.95281754,26 9.42731803,25.9915599 8.00685221,25.9267482 C6.71299539,25.8677347 5.71859186,25.667913 4.77730956,25.3021264 C3.82289637,24.9312153 3.04697986,24.4330127 2.30693194,23.6930176 C1.56696125,22.952994 1.06875343,22.1770489 0.697933759,21.2227226 C0.332106718,20.2814874 0.132267821,19.2870609 0.0732525511,17.9931643 C0.00844009118,16.5726824 0,16.0471863 0,13.0000238 C0,9.95281754 0.00844007012,9.42731803 0.0732517966,8.00685221 C0.132267821,6.71293915 0.332106718,5.71851257 0.697902272,4.77735844 C1.06875343,3.82295107 1.56696125,3.04700595 2.30698242,2.30693194 C3.04700595,1.56696125 3.82295107,1.06875343 4.77727742,0.697933759 C5.71851257,0.332106718 6.71293915,0.132267821 8.00683567,0.0732525511 C9.42731803,0.00844007012 9.95281754,0 13.0000238,0 Z M13.0000238,4.1621583 C10.0092642,4.1621583 9.54871163,4.16940019 8.19652181,4.23109475 C7.31647529,4.27122389 6.77862056,4.38554609 6.284987,4.57739421 C5.8537324,4.74499635 5.57155295,4.92857388 5.25004154,5.25012175 C4.92857388,5.57155295 4.74499635,5.8537324 4.57739222,6.28499212 C4.38554609,6.77862056 4.27122389,7.31647529 4.23109353,8.19654849 C4.16940019,9.54871163 4.1621583,10.0092642 4.1621583,13.0000238 C4.1621583,15.9907394 4.16940021,16.4512887 4.23109475,17.8034782 C4.27122389,18.6835247 4.38554609,19.2213794 4.57739421,19.715013 C4.74497012,20.1462001 4.92857819,20.4284149 5.25012175,20.7499585 C5.57155295,21.0714261 5.8537324,21.2550037 6.28499212,21.4226078 C6.77862056,21.6144539 7.31647529,21.7287761 8.19655363,21.7689067 C9.54857728,21.8306006 10.0090682,21.8378417 13.0000238,21.8378417 C15.9909551,21.8378417 16.4514881,21.8306 17.8034782,21.7689053 C18.6835247,21.7287761 19.2213794,21.6144539 19.715013,21.4226058 C20.1462676,21.2550037 20.4284471,21.0714261 20.7499585,20.7498782 C21.0714261,20.4284471 21.2550037,20.1462676 21.4226078,19.7150079 C21.6144539,19.2213794 21.7287761,18.6835247 21.7689065,17.8034515 C21.8305998,16.4512887 21.8378417,15.9907394 21.8378417,13.0000238 C21.8378417,10.0092642 21.8305998,9.54871163 21.7689053,8.19652181 C21.7287761,7.31647529 21.6144539,6.77862056 21.4226058,6.284987 C21.2550037,5.8537324 21.0714261,5.57155295 20.7498782,5.25004154 C20.4284471,4.92857388 20.1462676,4.74499635 19.7150079,4.57739222 C19.2213794,4.38554609 18.6835247,4.27122389 17.8034515,4.23109353 C16.4512887,4.16940021 15.9907394,4.1621583 13.0000238,4.1621583 Z M13.0000238,5.8378417 C16.9555813,5.8378417 20.1621583,9.04443587 20.1621583,13.0000238 C20.1621583,16.9555727 16.9555727,20.1621583 13.0000238,20.1621583 C9.04443587,20.1621583 5.8378417,16.9555813 5.8378417,13.0000238 C5.8378417,9.04442731 9.04442731,5.8378417 13.0000238,5.8378417 Z M13.0000238,16 C14.6568646,16 16,14.6568646 16,13.0000238 C16,11.343141 14.6568701,10 13.0000238,10 C11.3431354,10 10,11.3431354 10,13.0000238 C10,14.6568701 11.343141,16 13.0000238,16 Z M19.8456418,6.59438394 C19.8456418,6.83737839 19.6486491,7.03436203 19.4056161,7.03436203 C19.1626284,7.03436203 18.965638,6.83737614 18.965638,6.59438394 C18.965638,6.35137243 19.1626477,6.15435822 19.4056161,6.15435822 C19.6486298,6.15435822 19.8456418,6.35137018 19.8456418,6.59438394 Z M21.8456418,6.59438394 C21.8456418,5.24680068 20.7531993,4.15435822 19.4056161,4.15435822 C18.0580679,4.15435822 16.965638,5.24681316 16.965638,6.59438394 C16.965638,7.94195587 18.0580691,9.03436203 19.4056161,9.03436203 C20.7531982,9.03436203 21.8456418,7.94196835 21.8456418,6.59438394 Z M13.0000238,1 C9.74099567,1 9.33234294,1.01381388 8.05241535,1.07221326 C6.77515526,1.13046973 5.90283244,1.33334326 5.13954402,1.63000828 C4.35043794,1.93662882 3.68122682,2.34694874 3.01406396,3.01406396 C2.34694874,3.68122682 1.93662882,4.35043794 1.63000828,5.13954402 C1.33334326,5.90283244 1.13046973,6.77515526 1.07221326,8.05241535 C1.01381388,9.33234294 1,9.74099567 1,13.0000238 C1,16.2590043 1.01381388,16.6676571 1.07221326,17.9475847 C1.13046973,19.2248447 1.33334326,20.0971676 1.63000828,20.860456 C1.93662882,21.6495621 2.34694874,22.3187732 3.01406396,22.985936 C3.68122682,23.6530513 4.35043794,24.0633712 5.13954402,24.3700394 C5.90283244,24.6666567 6.77515526,24.8695303 8.05241535,24.9277867 C9.33234294,24.9861861 9.74099567,25 13.0000238,25 C16.2590043,25 16.6676571,24.9861861 17.9475847,24.9277867 C19.2248447,24.8695303 20.0971676,24.6666567 20.860456,24.3700394 C21.6495621,24.0633712 22.3187732,23.6530513 22.985936,22.985936 C23.6530513,22.3187732 24.0633712,21.6495621 24.3700394,20.860456 C24.6666567,20.0971676 24.8695303,19.2248447 24.9277867,17.9475847 C24.9861861,16.6676571 25,16.2590043 25,13.0000238 C25,9.74099567 24.9861861,9.33234294 24.9277867,8.05241535 C24.8695303,6.77515526 24.6666567,5.90283244 24.3700394,5.13954402 C24.0633712,4.35043794 23.6530513,3.68122682 22.985936,3.01406396 C22.3187732,2.34694874 21.6495621,1.93662882 20.860456,1.63000828 C20.0971676,1.33334326 19.2248447,1.13046973 17.9475847,1.07221326 C16.6676571,1.01381388 16.2590043,1 13.0000238,1 Z M13.0000238,3.1621583 C16.2041299,3.1621583 16.5836782,3.17440026 17.8490298,3.23213276 C19.0190179,3.28548292 19.6544088,3.48097316 20.0772565,3.64531072 C20.6373856,3.86299845 21.0371308,4.12303286 21.4570251,4.54297487 C21.8769671,4.96286924 22.1370016,5.3626144 22.3546893,5.92274348 C22.5190268,6.34559117 22.7145171,6.9809821 22.7678672,8.15097025 C22.8255997,9.41632182 22.8378417,9.79587013 22.8378417,13.0000238 C22.8378417,16.2041299 22.8255997,16.5836782 22.7678672,17.8490298 C22.7145171,19.0190179 22.5190268,19.6544088 22.3546893,20.0772565 C22.1370016,20.6373856 21.8769671,21.0371308 21.4570251,21.4570251 C21.0371308,21.8769671 20.6373856,22.1370016 20.0772565,22.3546893 C19.6544088,22.5190268 19.0190179,22.7145171 17.8490298,22.7678672 C16.5838687,22.8255997 16.204368,22.8378417 13.0000238,22.8378417 C9.79563196,22.8378417 9.41617891,22.8255997 8.15097025,22.7678672 C6.9809821,22.7145171 6.34559117,22.5190268 5.92274348,22.3546893 C5.3626144,22.1370016 4.96286924,21.8769671 4.54297487,21.4570251 C4.1230805,21.0371308 3.86299845,20.6373856 3.64531072,20.0772565 C3.48097316,19.6544088 3.28548292,19.0190179 3.23213276,17.8490298 C3.17440026,16.5836782 3.1621583,16.2041299 3.1621583,13.0000238 C3.1621583,9.79587013 3.17440026,9.41632182 3.23213276,8.15097025 C3.28548292,6.9809821 3.48097316,6.34559117 3.64531072,5.92274348 C3.86299845,5.3626144 4.12303286,4.96286924 4.54297487,4.54297487 C4.96286924,4.12303286 5.3626144,3.86299845 5.92274348,3.64531072 C6.34559117,3.48097316 6.9809821,3.28548292 8.15097025,3.23213276 C9.41632182,3.17440026 9.79587013,3.1621583 13.0000238,3.1621583 Z M13.0000238,6.8378417 C9.59671206,6.8378417 6.8378417,9.59671206 6.8378417,13.0000238 C6.8378417,16.4032879 9.59671206,19.1621583 13.0000238,19.1621583 C16.4032879,19.1621583 19.1621583,16.4032879 19.1621583,13.0000238 C19.1621583,9.59671206 16.4032879,6.8378417 13.0000238,6.8378417 Z M13.0000238,17 C10.7908507,17 9,15.2091493 9,13.0000238 C9,10.7908507 10.7908507,9 13.0000238,9 C15.2091493,9 17,10.7908507 17,13.0000238 C17,15.2091493 15.2091493,17 13.0000238,17 Z M20.8456418,6.59438394 C20.8456418,5.79908543 20.2009146,5.15435822 19.4056161,5.15435822 C18.6103652,5.15435822 17.965638,5.79908543 17.965638,6.59438394 C17.965638,7.38968246 18.6103652,8.03436203 19.4056161,8.03436203 C20.2009146,8.03436203 20.8456418,7.38968246 20.8456418,6.59438394 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),k.jsx("path",{d:"M13.0000238,1 C16.2590043,1 16.6676571,1.01381388 17.9475847,1.07221326 C19.2248447,1.13046973 20.0971676,1.33334326 20.860456,1.63000828 C21.6495621,1.93662882 22.3187732,2.34694874 22.985936,3.01406396 C23.6530513,3.68122682 24.0633712,4.35043794 24.3700394,5.13954402 C24.6666567,5.90283244 24.8695303,6.77515526 24.9277867,8.05241535 C24.9861861,9.33234294 25,9.74099567 25,13.0000238 C25,16.2590043 24.9861861,16.6676571 24.9277867,17.9475847 C24.8695303,19.2248447 24.6666567,20.0971676 24.3700394,20.860456 C24.0633712,21.6495621 23.6530513,22.3187732 22.985936,22.985936 C22.3187732,23.6530513 21.6495621,24.0633712 20.860456,24.3700394 C20.0971676,24.6666567 19.2248447,24.8695303 17.9475847,24.9277867 C16.6676571,24.9861861 16.2590043,25 13.0000238,25 C9.74099567,25 9.33234294,24.9861861 8.05241535,24.9277867 C6.77515526,24.8695303 5.90283244,24.6666567 5.13954402,24.3700394 C4.35043794,24.0633712 3.68122682,23.6530513 3.01406396,22.985936 C2.34694874,22.3187732 1.93662882,21.6495621 1.63000828,20.860456 C1.33334326,20.0971676 1.13046973,19.2248447 1.07221326,17.9475847 C1.01381388,16.6676571 1,16.2590043 1,13.0000238 C1,9.74099567 1.01381388,9.33234294 1.07221326,8.05241535 C1.13046973,6.77515526 1.33334326,5.90283244 1.63000828,5.13954402 C1.93662882,4.35043794 2.34694874,3.68122682 3.01406396,3.01406396 C3.68122682,2.34694874 4.35043794,1.93662882 5.13954402,1.63000828 C5.90283244,1.33334326 6.77515526,1.13046973 8.05241535,1.07221326 C9.33234294,1.01381388 9.74099567,1 13.0000238,1 Z M13.0000238,3.1621583 C9.79587013,3.1621583 9.41632182,3.17440026 8.15097025,3.23213276 C6.9809821,3.28548292 6.34559117,3.48097316 5.92274348,3.64531072 C5.3626144,3.86299845 4.96286924,4.12303286 4.54297487,4.54297487 C4.12303286,4.96286924 3.86299845,5.3626144 3.64531072,5.92274348 C3.48097316,6.34559117 3.28548292,6.9809821 3.23213276,8.15097025 C3.17440026,9.41632182 3.1621583,9.79587013 3.1621583,13.0000238 C3.1621583,16.2041299 3.17440026,16.5836782 3.23213276,17.8490298 C3.28548292,19.0190179 3.48097316,19.6544088 3.64531072,20.0772565 C3.86299845,20.6373856 4.1230805,21.0371308 4.54297487,21.4570251 C4.96286924,21.8769671 5.3626144,22.1370016 5.92274348,22.3546893 C6.34559117,22.5190268 6.9809821,22.7145171 8.15097025,22.7678672 C9.41617891,22.8255997 9.79563196,22.8378417 13.0000238,22.8378417 C16.204368,22.8378417 16.5838687,22.8255997 17.8490298,22.7678672 C19.0190179,22.7145171 19.6544088,22.5190268 20.0772565,22.3546893 C20.6373856,22.1370016 21.0371308,21.8769671 21.4570251,21.4570251 C21.8769671,21.0371308 22.1370016,20.6373856 22.3546893,20.0772565 C22.5190268,19.6544088 22.7145171,19.0190179 22.7678672,17.8490298 C22.8255997,16.5836782 22.8378417,16.2041299 22.8378417,13.0000238 C22.8378417,9.79587013 22.8255997,9.41632182 22.7678672,8.15097025 C22.7145171,6.9809821 22.5190268,6.34559117 22.3546893,5.92274348 C22.1370016,5.3626144 21.8769671,4.96286924 21.4570251,4.54297487 C21.0371308,4.12303286 20.6373856,3.86299845 20.0772565,3.64531072 C19.6544088,3.48097316 19.0190179,3.28548292 17.8490298,3.23213276 C16.5836782,3.17440026 16.2041299,3.1621583 13.0000238,3.1621583 Z M13.0000238,6.8378417 C16.4032879,6.8378417 19.1621583,9.59671206 19.1621583,13.0000238 C19.1621583,16.4032879 16.4032879,19.1621583 13.0000238,19.1621583 C9.59671206,19.1621583 6.8378417,16.4032879 6.8378417,13.0000238 C6.8378417,9.59671206 9.59671206,6.8378417 13.0000238,6.8378417 Z M13.0000238,17 C15.2091493,17 17,15.2091493 17,13.0000238 C17,10.7908507 15.2091493,9 13.0000238,9 C10.7908507,9 9,10.7908507 9,13.0000238 C9,15.2091493 10.7908507,17 13.0000238,17 Z M20.8456418,6.59438394 C20.8456418,7.38968246 20.2009146,8.03436203 19.4056161,8.03436203 C18.6103652,8.03436203 17.965638,7.38968246 17.965638,6.59438394 C17.965638,5.79908543 18.6103652,5.15435822 19.4056161,5.15435822 C20.2009146,5.15435822 20.8456418,5.79908543 20.8456418,6.59438394 Z",id:"IG-logo",fillOpacity:.6,fill:"#FFFFFF"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LogoInstagramIcon=a}),98);
__d("WAWebLogoYoutubeIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(a,b,c,d,e,f,g){var h=["iconXstyle","height","width","name","viewBox"],i,j,k=i||c("react"),l="logo-youtube";function a(a){var b=a.iconXstyle,e=a.height,f=a.width,g=a.name,i=a.viewBox;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var m;if(i){var n=i.x;n=n===void 0?0:n;var o=i.y;o=o===void 0?0:o;var p=i.width;p=p===void 0?0:p;i=i.height;i=i===void 0?0:i;m=[n,o,p,i].join(" ")}n=20;o=75;(e!=null||f!=null)&&(n=e,o=f);return k.jsx(d("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers["extends"]({name:g!=null?g:l},a,{children:k.jsxs("svg",{viewBox:m!=null?m:"0 0 75 20",height:n,width:o,preserveAspectRatio:"xMidYMid meet",className:(j||(j=c("stylex")))(b),version:"1.1",children:[k.jsx("title",{children:g!=null?g:l}),k.jsx("path",{d:"M58.0577137,16.5924517 L58.0577137,16.6109096 L54.4614664,16.6109096 L54.435877,16.4445786 C53.9935766,16.6634739 53.4952699,16.777363 52.9520481,16.777363 C52.0069701,16.777363 51.2207817,16.4221346 50.7048004,15.724042 C50.6344039,15.6287022 50.5702014,15.5280378 50.5119372,15.4219109 L50.5119372,16.5924147 L46.683398,16.5924147 L46.683398,16.6109096 L43.0871507,16.6109096 L43.0615614,16.4445786 C42.619261,16.6634739 42.1209542,16.777363 41.5777324,16.777363 C40.6326544,16.777363 39.8464661,16.4221346 39.3304847,15.724042 C39.1528633,15.4834847 39.0146744,15.2090287 38.9118132,14.898461 C38.6441723,15.4298888 38.2837063,15.8583571 37.8229911,16.1655005 C37.198009,16.5821553 36.399029,16.777326 35.4319956,16.7770426 C34.4663993,16.7540523 33.666818,16.5571404 33.0516159,16.1470057 C32.3952164,15.709406 31.9472728,15.0440781 31.7037147,14.1915153 C31.5447488,13.6510314 31.4469181,12.9965579 31.4067673,12.235867 L31.4067673,16.5925257 L27.2243783,16.5925257 L27.2243783,11.4300087 L24.3773733,1.10961535 L28.6991282,1.10961535 L28.8690811,1.89918819 L29.3165231,3.97793852 L29.9567738,1.10961535 L34.2774102,1.10961535 L33.1365212,5.18539989 C33.1442322,5.18016703 33.1519706,5.17496321 33.1597365,5.16978843 C33.7981445,4.7612073 34.5762693,4.5681841 35.492788,4.5681841 C36.4004338,4.5681841 37.1822463,4.76517621 37.8043363,5.17990291 C38.1487847,5.40943954 38.4371395,5.7067374 38.6725808,6.06418313 L38.6725808,4.75316931 L44.1471592,4.75316931 L44.1471592,1.10968933 L52.712821,1.10968933 L52.712821,4.75316931 L57.3893779,4.75316931 L57.3893779,0.610181175 L61.5349622,0.610181175 L61.5349622,4.70857657 C61.8471504,4.6027659 62.1755901,4.54976326 62.5137233,4.54976326 C63.2696894,4.54976326 63.9414049,4.78115764 64.43659,5.24539378 C64.7667068,5.55468494 65.0163437,5.95885855 65.1930604,6.44995282 C65.2727761,6.28602999 65.3610538,6.13229383 65.458189,5.98853377 C66.1229151,5.00473908 67.2126941,4.53117596 68.6169406,4.53117596 C69.5534434,4.53117596 70.3406071,4.7233183 70.9372855,5.13032953 C71.5435056,5.54366138 71.95366,6.17559898 72.1876248,6.98072766 C72.3797416,7.66456937 72.4653282,8.55012146 72.4653282,9.69251096 L72.4653282,12.3755398 L72.3518452,12.3755398 L72.3713658,12.4721766 C72.4058099,12.642692 72.4098437,12.7425382 72.4098437,13.021579 C72.4098437,14.2001549 72.0663789,15.1527839 71.3344147,15.8034187 C70.634676,16.4254086 69.6959688,16.721823 68.5614561,16.721823 C67.1615954,16.721823 66.0766331,16.2286583 65.4293218,15.2303041 C65.3280412,15.074163 65.2365958,14.9066861 65.1546963,14.7277305 C65.0949496,14.8887045 65.0290421,15.0394995 64.9568553,15.1799998 C64.4332835,16.199587 63.5533459,16.7587202 62.4212491,16.7587202 C61.9417607,16.7587202 61.4944835,16.6598433 61.0408162,16.4583658 L61.0086088,16.5924517 L58.0577137,16.5924517 L58.0577137,16.5924517 Z M24.3259002,5.62700608 C24.4236017,6.80523705 24.4550259,7.99393883 24.452758,8.86763092 C24.4527188,8.88030443 24.4527188,8.88030443 24.4527142,8.87879427 C24.4527142,8.93207856 24.4521755,9.02871609 24.4505765,9.16258163 C24.4479325,9.38394029 24.4431816,9.63016676 24.4357956,9.89517645 C24.4146551,10.6536972 24.3765715,11.41283 24.3169931,12.125387 C24.2352291,13.1032848 24.1195818,13.917554 23.9559594,14.5392558 C23.6044034,15.8450354 22.5773994,16.87197 21.265891,17.2253029 C20.4937667,17.4284935 18.9802227,17.5536738 16.85366,17.6336198 C15.8403408,17.6717145 14.7566214,17.6961593 13.6731798,17.7097362 C13.2941932,17.7144854 12.942212,17.7175391 12.626158,17.7192365 C12.4360536,17.7202574 12.2998065,17.7205989 12.2263571,17.7205989 C12.1527485,17.7205989 12.0162686,17.7202415 11.825867,17.7191733 C11.5093529,17.7173974 11.1568676,17.7142027 10.7773413,17.709234 C9.69233025,17.6950295 8.60702899,17.6694544 7.59215165,17.6295952 C5.47232465,17.5463391 3.95962355,17.4161347 3.18134306,17.2053493 C1.87545563,16.8537642 0.848339874,15.8266484 0.495965191,14.5178102 C0.3319537,13.901127 0.215623574,13.0804506 0.133715024,12.0909953 C0.0750181786,11.3819374 0.0374970877,10.6265128 0.0166687608,9.8716942 C0.0093917654,9.60797588 0.00471093513,9.36295002 0.00210595247,9.14267269 C0.000530665118,9.00946639 0,8.91330987 0,8.86029945 C0,8.80701516 0.000538670764,8.71037762 0.00213763803,8.57651208 C0.00478167356,8.35515343 0.00953263464,8.10892695 0.0169186349,7.84391726 C0.0380591243,7.0853965 0.0761427077,6.32626374 0.135721054,5.61370672 C0.217485081,4.63580895 0.333132432,3.82153968 0.496754797,3.19983788 C0.84683331,1.89954626 1.88747318,0.851922236 3.18682324,0.495296018 C3.9589475,0.292105423 5.47249146,0.166925095 7.59905417,0.0869791289 C8.61237336,0.0488844227 9.69609279,0.0244396234 10.7795344,0.0108626608 C11.158521,0.00611345554 11.5105022,0.00305983032 11.8265562,0.00136244031 C12.0166606,0.000341471398 12.1529077,0 12.2263571,0 C12.2998759,0 12.4361942,0.000355316061 12.6263728,0.00141753781 C12.9425189,0.00318333776 13.294595,0.00635996401 13.6736809,0.0113004323 C14.757431,0.0254244933 15.8414699,0.0508545797 16.8551605,0.0904875938 C18.9847305,0.173748977 20.4997674,0.304064932 21.2713711,0.515249619 C22.576591,0.866654965 23.6033241,1.8929005 23.9554197,3.19783538 C24.1252865,3.81933066 24.2440865,4.64037511 24.3259002,5.62700608 Z M22.9903436,3.45981136 C22.7314161,2.4980806 21.9731284,1.73979289 21.0113977,1.48086538 C19.2543895,1 12.2263571,1 12.2263571,1 C12.2263571,1 5.19832465,1 3.44131653,1.46237056 C2.4980806,1.72129807 1.72129807,2.4980806 1.46237056,3.45981136 C1,5.21681947 1,8.86029945 1,8.86029945 C1,8.86029945 1,12.5222742 1.46237056,14.2607875 C1.72129807,15.2225183 2.47958578,15.980806 3.44131653,16.2397335 C5.21681947,16.7205989 12.2263571,16.7205989 12.2263571,16.7205989 C12.2263571,16.7205989 19.2543895,16.7205989 21.0113977,16.2582283 C21.9731284,15.9991159 22.7314161,15.2410131 22.9903436,14.2792824 C23.4527142,12.5222742 23.4527142,8.87879427 23.4527142,8.87879427 C23.4527142,8.87879427 23.471209,5.21681947 22.9903436,3.45981136 Z M9.9884836,12.2263571 L9.9884836,5.4942418 L15.8328474,8.86029945 L9.9884836,12.2263571 Z M33.6063161,15.3149554 C34.0501918,15.6108726 34.6790158,15.7588311 35.4557983,15.777326 C36.214086,15.777326 36.8244152,15.6293674 37.2682909,15.3334502 C37.7121666,15.0375331 38.0265786,14.5566677 38.2300217,13.9278437 C38.4336497,13.280525 38.5261238,12.448258 38.5261238,11.3940531 L38.5261238,9.96995179 C38.5261238,8.8972521 38.4149699,8.04649028 38.2115268,7.41766632 C38.0080838,6.78884237 37.6938568,6.30797699 37.2497961,6.01205983 C36.8059204,5.71614268 36.214086,5.5681841 35.492788,5.5681841 C34.7529951,5.5681841 34.1611608,5.71614268 33.6987902,6.01205983 C33.2549145,6.30797699 32.9220077,6.77034755 32.7000698,7.41766632 C32.4966268,8.0649851 32.3856578,8.91574692 32.3856578,9.96995179 L32.3856578,11.3940531 C32.3856578,12.4297631 32.478132,13.280525 32.6630802,13.9093489 C32.8480284,14.5566677 33.1624404,15.0190383 33.6063161,15.3149554 Z M36.1031171,13.7613903 C35.9736534,14.0942971 35.7702103,14.2422557 35.4742932,14.2422557 C35.1598812,14.2422557 34.9379433,14.0758023 34.8269744,13.7613903 C34.6975106,13.4469784 34.6420262,12.9106285 34.6420262,12.1893305 L34.6420262,9.11918997 C34.6420262,8.41638672 34.6975106,7.8985317 34.8269744,7.5656249 C34.9379433,7.25121292 35.1598812,7.08475952 35.4557983,7.08475952 C35.7702103,7.08475952 35.9736534,7.2327181 36.1031171,7.5656249 C36.2325809,7.8985317 36.2880653,8.41638672 36.2880653,9.11918997 L36.2880653,12.1893305 C36.2880653,12.9106285 36.2325809,13.4469784 36.1031171,13.7613903 Z M67.7478689,11.3755398 L71.4653282,11.3755398 L71.4653282,9.69251096 C71.4653282,8.65680092 71.3911639,7.84302874 71.2248955,7.25119443 C71.0582571,6.67785494 70.7808348,6.23397921 70.3739487,5.95655687 C69.9672476,5.67913454 69.3754133,5.53117596 68.6169406,5.53117596 C67.525931,5.53117596 66.7491485,5.86408276 66.286778,6.54839118 C65.8244074,7.23269961 65.6022846,8.3053993 65.6022846,9.78498507 L65.6022846,11.5050035 C65.6022846,12.9475997 65.8244074,14.0018045 66.2682831,14.686113 C66.7119739,15.3704214 67.4704466,15.721823 68.5614561,15.721823 C69.4678874,15.721823 70.1706906,15.4998851 70.6700508,15.0560094 C71.169411,14.6121337 71.4098437,13.9278253 71.4098437,13.021579 C71.4098437,12.8736204 71.4098437,12.7626515 71.3911639,12.6701773 L69.4861973,12.5592084 C69.4678874,13.1695375 69.4124029,13.5949185 69.2829392,13.853846 C69.1534754,14.1127735 68.9313526,14.2422372 68.5986307,14.2422372 C68.3395183,14.2422372 68.1545701,14.1682579 68.0437861,14.0202994 C67.9141374,13.8908356 67.840343,13.6504029 67.8033534,13.3359909 C67.7663637,13.021579 67.7478689,12.5407136 67.7478689,11.9118896 L67.7478689,11.3755398 Z M68.0252912,7.26968925 C68.1362602,7.12173067 68.3027136,7.04775138 68.5614561,7.06624621 C68.783579,7.06624621 68.9685272,7.1402255 69.0793112,7.26968925 C69.190465,7.39915301 69.2829392,7.62109087 69.3199288,7.95399767 C69.3567335,8.28690447 69.3754133,8.76776985 69.3754133,9.39659381 L69.3754133,10.0993971 L67.7478689,10.0993971 L67.7478689,9.39659381 C67.7478689,8.74927503 67.7663637,8.26840965 67.8033534,7.95399767 C67.840343,7.6395857 67.9141374,7.41764783 68.0252912,7.26968925 Z M28.2058835,11.2275627 L28.2243783,11.2275627 L28.2243783,15.5925257 L30.4067673,15.5925257 L30.4067673,11.2275627 L32.9590528,2.10961535 L30.758169,2.10961535 L29.8334279,6.25245553 C29.5745003,7.4731138 29.4080469,8.32387562 29.3340677,8.84173065 L29.2785832,8.84173065 C29.1676143,8.12043258 29.0011609,7.25117593 28.779223,6.23396071 L27.8914715,2.10961535 L25.6905877,2.10961535 L28.2058835,11.2275627 Z M45.683398,5.75316931 L43.4640194,5.75316931 L43.4640194,13.5764791 C43.390225,13.7614273 43.2605763,13.9093859 43.0756281,14.0203548 C42.8906799,14.1496337 42.7057317,14.2053031 42.5207834,14.2053031 C42.2988456,14.2053031 42.1325771,14.112829 42.040103,13.9278807 C41.9476289,13.7429325 41.8919595,13.4285205 41.8919595,12.9846448 L41.8919595,5.75316931 L39.6725808,5.75316931 L39.6725808,13.1141086 C39.6725808,14.0388497 39.8207243,14.7044783 40.1349514,15.1300442 C40.4493633,15.5554251 40.9304137,15.777363 41.5777324,15.777363 C42.5207834,15.777363 43.2422664,15.3149924 43.704637,14.4087461 L43.7601215,14.4087461 L43.9450697,15.6109096 L45.683398,15.6109096 L45.683398,5.75316931 Z M57.0577137,5.75316931 L54.838335,5.75316931 L54.838335,13.5764791 C54.7645407,13.7614273 54.634892,13.9093859 54.4499438,14.0203548 C54.2649955,14.1496337 54.0800473,14.2053031 53.8950991,14.2053031 C53.6731612,14.2053031 53.5068928,14.112829 53.4144187,13.9278807 C53.3219446,13.7429325 53.2662751,13.4285205 53.2662751,12.9846448 L53.2662751,5.75316931 L51.0468965,5.75316931 L51.0468965,13.1141086 C51.0468965,14.0388497 51.19504,14.7044783 51.509267,15.1300442 C51.823679,15.5554251 52.3047293,15.777363 52.9520481,15.777363 C53.8950991,15.777363 54.6165821,15.3149924 55.0789527,14.4087461 L55.1344371,14.4087461 L55.3193854,15.6109096 L57.0577137,15.6109096 L57.0577137,5.75316931 Z M51.712821,3.90368709 L51.712821,2.10968933 L45.1471592,2.10968933 L45.1471592,3.90368709 L47.3478581,3.90368709 L47.3478581,15.5924147 L49.5119372,15.5924147 L49.5119372,3.90368709 L51.712821,3.90368709 Z M64.4001951,7.32526619 C64.2707314,6.69625729 64.0489784,6.2525665 63.7528763,5.97514417 C63.4569592,5.69772184 63.0317632,5.54976326 62.5137233,5.54976326 C62.1070221,5.54976326 61.7184459,5.66073219 61.3672292,5.90116488 C61.0156427,6.12310275 60.7382203,6.43751473 60.5532721,6.80741117 L60.5349622,6.80741117 L60.5349622,1.61018118 L58.3893779,1.61018118 L58.3893779,15.5924517 L60.2203653,15.5924517 L60.4424881,14.6677106 L60.4977876,14.6677106 C60.664241,15.0006174 60.9231685,15.25936 61.2747551,15.462988 C61.6259718,15.6479362 61.9958682,15.7587202 62.4212491,15.7587202 C63.1795369,15.7587202 63.7158867,15.4075035 64.0672883,14.7231951 C64.4188749,14.0388867 64.6038231,12.9475072 64.6038231,11.4866012 L64.6038231,9.93285118 C64.5851433,8.80485197 64.5296589,7.93559533 64.4001951,7.32526619 Z M62.3657647,11.3386426 C62.3657647,12.0597557 62.328775,12.6146004 62.2732906,13.0216714 C62.2178061,13.4285575 62.1070221,13.7242897 61.9773734,13.8909281 C61.8295998,14.0571965 61.6446516,14.1496706 61.4225287,14.1496706 C61.2375805,14.1496706 61.0711271,14.112866 60.9231685,14.0203918 C60.77521,13.9279177 60.6457462,13.798454 60.5532721,13.6318156 L60.5532721,8.04656426 C60.6274363,7.78763675 60.7567151,7.56569888 60.9416634,7.38075066 C61.1266116,7.21429726 61.3300546,7.12182315 61.5334977,7.12182315 C61.7554355,7.12182315 61.9403838,7.21429726 62.0513527,7.38075066 C62.1808165,7.56569888 62.2547957,7.86161604 62.3102802,8.26831718 C62.3657647,8.69388304 62.3844444,9.2855324 62.3844444,10.0440051 L62.3844444,11.3386426 L62.3657647,11.3386426 Z",fillOpacity:.3,fill:"#263238",fillRule:"nonzero"}),k.jsx("path",{d:"M22.9903436,3.45981136 C23.471209,5.21681947 23.4527142,8.87879427 23.4527142,8.87879427 C23.4527142,8.87879427 23.4527142,12.5222742 22.9903436,14.2792824 C22.7314161,15.2410131 21.9731284,15.9991159 21.0113977,16.2582283 C19.2543895,16.7205989 12.2263571,16.7205989 12.2263571,16.7205989 C12.2263571,16.7205989 5.21681947,16.7205989 3.44131653,16.2397335 C2.47958578,15.980806 1.72129807,15.2225183 1.46237056,14.2607875 C1,12.5222742 1,8.86029945 1,8.86029945 C1,8.86029945 1,5.21681947 1.46237056,3.45981136 C1.72129807,2.4980806 2.4980806,1.72129807 3.44131653,1.46237056 C5.19832465,1 12.2263571,1 12.2263571,1 C12.2263571,1 19.2543895,1 21.0113977,1.48086538 C21.9731284,1.73979289 22.7314161,2.4980806 22.9903436,3.45981136 Z M9.9884836,12.2263571 L15.8328474,8.86029945 L9.9884836,5.4942418 L9.9884836,12.2263571 Z M33.6063161,15.3149554 C33.1624404,15.0190383 32.8480284,14.5566677 32.6630802,13.9093489 C32.478132,13.280525 32.3856578,12.4297631 32.3856578,11.3940531 L32.3856578,9.96995179 C32.3856578,8.91574692 32.4966268,8.0649851 32.7000698,7.41766632 C32.9220077,6.77034755 33.2549145,6.30797699 33.6987902,6.01205983 C34.1611608,5.71614268 34.7529951,5.5681841 35.492788,5.5681841 C36.214086,5.5681841 36.8059204,5.71614268 37.2497961,6.01205983 C37.6938568,6.30797699 38.0080838,6.78884237 38.2115268,7.41766632 C38.4149699,8.04649028 38.5261238,8.8972521 38.5261238,9.96995179 L38.5261238,11.3940531 C38.5261238,12.448258 38.4336497,13.280525 38.2300217,13.9278437 C38.0265786,14.5566677 37.7121666,15.0375331 37.2682909,15.3334502 C36.8244152,15.6293674 36.214086,15.777326 35.4557983,15.777326 C34.6790158,15.7588311 34.0501918,15.6108726 33.6063161,15.3149554 Z M36.1031171,13.7613903 C36.2325809,13.4469784 36.2880653,12.9106285 36.2880653,12.1893305 L36.2880653,9.11918997 C36.2880653,8.41638672 36.2325809,7.8985317 36.1031171,7.5656249 C35.9736534,7.2327181 35.7702103,7.08475952 35.4557983,7.08475952 C35.1598812,7.08475952 34.9379433,7.25121292 34.8269744,7.5656249 C34.6975106,7.8985317 34.6420262,8.41638672 34.6420262,9.11918997 L34.6420262,12.1893305 C34.6420262,12.9106285 34.6975106,13.4469784 34.8269744,13.7613903 C34.9379433,14.0758023 35.1598812,14.2422557 35.4742932,14.2422557 C35.7702103,14.2422557 35.9736534,14.0942971 36.1031171,13.7613903 Z M67.7478689,11.3755398 L67.7478689,11.9118896 C67.7478689,12.5407136 67.7663637,13.021579 67.8033534,13.3359909 C67.840343,13.6504029 67.9141374,13.8908356 68.0437861,14.0202994 C68.1545701,14.1682579 68.3395183,14.2422372 68.5986307,14.2422372 C68.9313526,14.2422372 69.1534754,14.1127735 69.2829392,13.853846 C69.4124029,13.5949185 69.4678874,13.1695375 69.4861973,12.5592084 L71.3911639,12.6701773 C71.4098437,12.7626515 71.4098437,12.8736204 71.4098437,13.021579 C71.4098437,13.9278253 71.169411,14.6121337 70.6700508,15.0560094 C70.1706906,15.4998851 69.4678874,15.721823 68.5614561,15.721823 C67.4704466,15.721823 66.7119739,15.3704214 66.2682831,14.686113 C65.8244074,14.0018045 65.6022846,12.9475997 65.6022846,11.5050035 L65.6022846,9.78498507 C65.6022846,8.3053993 65.8244074,7.23269961 66.286778,6.54839118 C66.7491485,5.86408276 67.525931,5.53117596 68.6169406,5.53117596 C69.3754133,5.53117596 69.9672476,5.67913454 70.3739487,5.95655687 C70.7808348,6.23397921 71.0582571,6.67785494 71.2248955,7.25119443 C71.3911639,7.84302874 71.4653282,8.65680092 71.4653282,9.69251096 L71.4653282,11.3755398 L67.7478689,11.3755398 Z M68.0252912,7.26968925 C67.9141374,7.41764783 67.840343,7.6395857 67.8033534,7.95399767 C67.7663637,8.26840965 67.7478689,8.74927503 67.7478689,9.39659381 L67.7478689,10.0993971 L69.3754133,10.0993971 L69.3754133,9.39659381 C69.3754133,8.76776985 69.3567335,8.28690447 69.3199288,7.95399767 C69.2829392,7.62109087 69.190465,7.39915301 69.0793112,7.26968925 C68.9685272,7.1402255 68.783579,7.06624621 68.5614561,7.06624621 C68.3027136,7.04775138 68.1362602,7.12173067 68.0252912,7.26968925 Z M28.2058835,11.2275627 L25.6905877,2.10961535 L27.8914715,2.10961535 L28.779223,6.23396071 C29.0011609,7.25117593 29.1676143,8.12043258 29.2785832,8.84173065 L29.3340677,8.84173065 C29.4080469,8.32387562 29.5745003,7.4731138 29.8334279,6.25245553 L30.758169,2.10961535 L32.9590528,2.10961535 L30.4067673,11.2275627 L30.4067673,15.5925257 L28.2243783,15.5925257 L28.2243783,11.2275627 L28.2058835,11.2275627 Z M45.683398,5.75316931 L45.683398,15.6109096 L43.9450697,15.6109096 L43.7601215,14.4087461 L43.704637,14.4087461 C43.2422664,15.3149924 42.5207834,15.777363 41.5777324,15.777363 C40.9304137,15.777363 40.4493633,15.5554251 40.1349514,15.1300442 C39.8207243,14.7044783 39.6725808,14.0388497 39.6725808,13.1141086 L39.6725808,5.75316931 L41.8919595,5.75316931 L41.8919595,12.9846448 C41.8919595,13.4285205 41.9476289,13.7429325 42.040103,13.9278807 C42.1325771,14.112829 42.2988456,14.2053031 42.5207834,14.2053031 C42.7057317,14.2053031 42.8906799,14.1496337 43.0756281,14.0203548 C43.2605763,13.9093859 43.390225,13.7614273 43.4640194,13.5764791 L43.4640194,5.75316931 L45.683398,5.75316931 Z M57.0577137,5.75316931 L57.0577137,15.6109096 L55.3193854,15.6109096 L55.1344371,14.4087461 L55.0789527,14.4087461 C54.6165821,15.3149924 53.8950991,15.777363 52.9520481,15.777363 C52.3047293,15.777363 51.823679,15.5554251 51.509267,15.1300442 C51.19504,14.7044783 51.0468965,14.0388497 51.0468965,13.1141086 L51.0468965,5.75316931 L53.2662751,5.75316931 L53.2662751,12.9846448 C53.2662751,13.4285205 53.3219446,13.7429325 53.4144187,13.9278807 C53.5068928,14.112829 53.6731612,14.2053031 53.8950991,14.2053031 C54.0800473,14.2053031 54.2649955,14.1496337 54.4499438,14.0203548 C54.634892,13.9093859 54.7645407,13.7614273 54.838335,13.5764791 L54.838335,5.75316931 L57.0577137,5.75316931 Z M51.712821,3.90368709 L49.5119372,3.90368709 L49.5119372,15.5924147 L47.3478581,15.5924147 L47.3478581,3.90368709 L45.1471592,3.90368709 L45.1471592,2.10968933 L51.712821,2.10968933 L51.712821,3.90368709 Z M64.4001951,7.32526619 C64.5296589,7.93559533 64.5851433,8.80485197 64.6038231,9.93285118 L64.6038231,11.4866012 C64.6038231,12.9475072 64.4188749,14.0388867 64.0672883,14.7231951 C63.7158867,15.4075035 63.1795369,15.7587202 62.4212491,15.7587202 C61.9958682,15.7587202 61.6259718,15.6479362 61.2747551,15.462988 C60.9231685,15.25936 60.664241,15.0006174 60.4977876,14.6677106 L60.4424881,14.6677106 L60.2203653,15.5924517 L58.3893779,15.5924517 L58.3893779,1.61018118 L60.5349622,1.61018118 L60.5349622,6.80741117 L60.5532721,6.80741117 C60.7382203,6.43751473 61.0156427,6.12310275 61.3672292,5.90116488 C61.7184459,5.66073219 62.1070221,5.54976326 62.5137233,5.54976326 C63.0317632,5.54976326 63.4569592,5.69772184 63.7528763,5.97514417 C64.0489784,6.2525665 64.2707314,6.69625729 64.4001951,7.32526619 Z M62.3657647,11.3386426 L62.3844444,11.3386426 L62.3844444,10.0440051 C62.3844444,9.2855324 62.3657647,8.69388304 62.3102802,8.26831718 C62.2547957,7.86161604 62.1808165,7.56569888 62.0513527,7.38075066 C61.9403838,7.21429726 61.7554355,7.12182315 61.5334977,7.12182315 C61.3300546,7.12182315 61.1266116,7.21429726 60.9416634,7.38075066 C60.7567151,7.56569888 60.6274363,7.78763675 60.5532721,8.04656426 L60.5532721,13.6318156 C60.6457462,13.798454 60.77521,13.9279177 60.9231685,14.0203918 C61.0711271,14.112866 61.2375805,14.1496706 61.4225287,14.1496706 C61.6446516,14.1496706 61.8295998,14.0571965 61.9773734,13.8909281 C62.1070221,13.7242897 62.2178061,13.4285575 62.2732906,13.0216714 C62.328775,12.6146004 62.3657647,12.0597557 62.3657647,11.3386426 Z",fillOpacity:.6,fill:"#FFFFFF"})]})}))}a.displayName=a.name+" [from "+f.id+"]";g.LogoYoutubeIcon=a}),98);
__d("WAWebPipConst",["$InternalEnum","WAWebLogoFacebookIcon.react","WAWebLogoInstagramIcon.react","WAWebLogoYoutubeIcon.react"],(function(a,b,c,d,e,f,g){var h={YOUTUBE:"youtube.com",YOUTUBE_MOBILE:"m.youtube.com",YOUTUBE_SHORTENED:"youtu.be",INSTAGRAM:"instagram.com",STREAMABLE:"streamable.com",FACEBOOK:"facebook.com",FBWATCH:"fbwat.ch",FBWATCH_ALT:"fb.watch",SHARECHAT:"sharechat.com"};c=b("$InternalEnum").Mirrored(["FLOATER","OG_FLOATER","MEDIA_VIEWER"]);e=b("$InternalEnum").Mirrored(["OG","YOUTUBE","MSG","VOIP"]);f=16/9;function a(a){switch(a){case h.YOUTUBE:case h.YOUTUBE_MOBILE:case h.YOUTUBE_SHORTENED:return d("WAWebLogoYoutubeIcon.react").LogoYoutubeIcon;case h.INSTAGRAM:return d("WAWebLogoInstagramIcon.react").LogoInstagramIcon;case h.FACEBOOK:return d("WAWebLogoFacebookIcon.react").LogoFacebookIcon;default:return null}}b={ONLINE_VIDEO_URL:{YOUTUBE:[/^https?:\/\/youtu\.be\/(.{11})/,/^https?:\/\/(m\.)?youtube\.com\/watch\?v=(.{11})/,/^https?:\/\/(m\.)?youtube\.com\/shorts\/(.{11})/]}};var i="t",j=/^(\d+h)?(\d+m)?(\d+s)?(\d+)?$/;g.HOSTNAME=h;g.PlayerType=c;g.PiPVideoType=e;g.YOUTUBE_VIDEO_DEFAULT_ASPECT_RATIO=f;g.getAttributionIcon=a;g.URL_PATTERNS=b;g.YOUTUBE_URL_TIME_PARAM_NAME=i;g.YOUTUBE_URL_TIME_PARAM_PATTERN=j}),98);
__d("WAWebUtilsYoutubeUrlParser",["WAWebPipConst","WAWebURLUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAWebPipConst").URL_PATTERNS.ONLINE_VIDEO_URL.YOUTUBE;for(var e=0;e<b.length;e++){var f=c("WAWebURLUtils").withoutWww(a).match(b[e]);if(f)return f[f.length-1]}return null}g.parseYoutubeVideoId=a}),98);
__d("WAWebMsgRcatUtils",["Promise","WABase64","WACryptoHkdf","WACryptoHmac","WANullthrows","WAWebABProps","WAWebFrontendMsgGetters","WAWebMsgGetters","WAWebMsgType","WAWebUserPrefsMeUser","WAWebUtilsYoutubeUrlParser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i="Rcat",j=32;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.nonce!=null)return a.nonce;var b=d("WAWebMsgGetters").getSender(a),c=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(b==null||c==null)return null;if(a.rcat==null||a.messageSecret==null)return null;b=(yield n(a.id.id,a.messageSecret,d("WAWebWidToJid").widToUserJid(b),d("WAWebWidToJid").widToUserJid(c)));a.nonce=b;return b});return k.apply(this,arguments)}function l(a,b,c,d){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=new TextEncoder().encode([a,c,e,i].join(""));c=(yield d("WACryptoHkdf").extractAndExpand(b,a,j));return new Uint8Array(c)});return m.apply(this,arguments)}function n(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield l(a,b,c,e));return d("WABase64").encodeB64UrlSafe(a,!0)});return o.apply(this,arguments)}function p(a,b){a=d("WAWebMsgGetters").getMatchedText(a);if(a==null||a==="")return null;var c=d("WAWebUtilsYoutubeUrlParser").parseYoutubeVideoId(a);return b?c:c!=null?c:a}function q(a){a=p(a,!1);return a==null?null:new TextEncoder().encode(a)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WACryptoHmac").hmacSha256(b,a));return new Uint8Array(b).slice(0,8)});return s.apply(this,arguments)}function e(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=c("WANullthrows")(d("WAWebMsgGetters").getFrom(a)),g=q(a),i=d("WAWebMsgGetters").getMessageSecret(a);if(!d("WAWebABProps").getABPropConfigValue("web_youtube_rcat_chat_generation_enabled")||e.length===0||a.type!==d("WAWebMsgType").MSG_TYPE.CHAT||!d("WAWebFrontendMsgGetters").getIsUrlMessage(a)||i==null||g==null||!d("WAWebMsgGetters").getIsSentByMe(a)||e.length>d("WAWebABProps").getABPropConfigValue("maximum_group_size_for_rcat"))return null;var j=d("WAWebWidToJid").widToUserJid(f),k=new Map();f=e.map(function(b){var c=d("WAWebWidToJid").widToUserJid(b);return l(d("WAWebMsgGetters").getId(a).id,i,j,c).then(function(a){return r(g,a)}).then(function(a){k.set(c,a)})});yield (h||(h=b("Promise"))).all(f);return k});return t.apply(this,arguments)}g.genNonceForMsg=a;g.deriveNonce=l;g.deriveNonceString=n;g.getContentIdString=p;g.genContentBindingForMsg=e}),98);
__d("WAWebQuotedMsgModelUtils",["WALogger","WAWebDBProcessReplyMsgs","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgModelUtils","WAWebStateUtils","WAWebUserPrefsMeUser","WAWebWid","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){a=k(a);a=a?d("WAWebMsgGetters").getSender(a):null;return a!=null?a.equals(b):!1}function k(a){a=d("WAWebStateUtils").unproxy(a);if(a.quotedMsgKey==null){try{var b=d("WAWebDBProcessReplyMsgs").createQuotedMsgKey(a);b!=="missing-stanza-id"&&(a.quotedMsgKey=b)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to create quoted msg key"]))).devConsole(a).sendLogs("qmk-fail")}if(a.quotedMsgKey==null)return null}if(!a.quotedMsg&&!a.paymentRequestMessageKey)return null;b=a.getCollection();var c=a.quotedMsgKey;if(c){var e=b.get(c);if(e)return e.safe();e=d("WAWebLidMigrationUtils").getAlternateMsgKey(c);if(e){c=b.get(e);if(c)return c.safe()}}var f;a.quotedMsg?f=l(a):a.paymentRequestMessageKey&&(f=m(a));if(f==null)return null;a.quotedMsgKey=f.id;f.ephemeralDuration=null;b.add(f.unsafe());return f}function l(a){var b=n(a),e=o(a),f=a.quotedStanzaID;if(!b||!e||c("isStringNullOrEmpty")(f))return null;var g=d("WAWebUserPrefsMeUser").isMeAccount(b),h=g?"out":"in",i=a.quotedRemoteJid?a.quotedRemoteJid:a.id.remote;f={id:f,from:g?e:i,to:g?i:e,self:h,author:b,remote:i};g=c("WAWebWid").isGroup(f.from)||c("WAWebWid").isGroup(f.to);(g||c("WAWebWid").isStatus(i))&&(f.participant=b);Object.assign(f,a.quotedMsg);h=(e=d("WAWebMsgModelUtils").createQuotedMsg(f))!=null?e:void 0;if(h==null)return null;a.selectedCarouselCardIndex!=null&&(h.interactiveHeader=void 0,h.isCarouselCard=!1);return h.safe()}function m(a){var b=n(a),c=o(a);if(!a.paymentRequestMessageKey||!b||!c)return null;b=a.paymentRequestMessageKey.remote?a.paymentRequestMessageKey.remote:a.id.remote;var e=a.paymentRequestMessageKey.fromMe,f=a.paymentRequestMessageKey.self!=null?a.paymentRequestMessageKey.self:e?"out":"in",g=a.paymentRequestMessageKey.participant||a.paymentMessageReceiverJid,h=a.paymentRequestMessageKey.id;h={id:h,from:e?c:b,to:e?b:c,self:f,participant:g,author:g,remote:b,amount1000:a.paymentAmount1000,currency:a.paymentCurrency,receiverJid:d("WAWebMsgGetters").getSender(a),type:a.type,subtype:"request"};return(e=d("WAWebMsgModelUtils").createQuotedMsg(h))==null?void 0:e.safe()}function b(a){a=d("WAWebStateUtils").unproxy(a);return a.quotedMsg==null?a.quotedRemoteJid:null}function e(a){a=d("WAWebStateUtils").unproxy(a);return a.quotedMsg==null?a.quotedGroupSubject:null}function f(a){a=d("WAWebStateUtils").unproxy(a);return a.quotedMsg==null?a.quotedParentGroupJid:null}var n=function(a){a.quotedParticipant==null&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["null quotedParticipant in quotedMsg"]))).devConsole(a).sendLogs("null-quoted-participant");return a.quotedParticipant},o=function(a){var b=d("WAWebUserPrefsMeUser").getMaybeMePnUser();b==null&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["null meUser in quotedMsg"]))).devConsole(a).sendLogs("null-me-user");return b};g.isQuotedMsg=a;g.getQuotedMsgObj=k;g.createQuotedMsgObj=l;g.getQuotedMsgAdminGroupJid=b;g.getQuotedMsgAdminGroupSubject=e;g.getQuotedMsgAdminParentGroupJid=f}),98);
__d("WAWebStarredMsgCollection",["Promise","WALogger","WANullthrows","WAWebBaseCollection","WAWebCollectionConstants","WAWebFrontendMsgGetters","WAWebMsgCollection","WAWebMsgModel","WAWebSocketConstants","WAWebSocketModel"],(function(a,b,c,d,e,f,g){var h,i,j;e=function(a){function e(){var b;b=a.call(this)||this;b.syncPromise=null;b.isSynced=!1;b.listenTo(d("WAWebSocketModel").Socket,"change:stream",function(){d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.DISCONNECTED?b.isSynced=!1:d("WAWebSocketModel").Socket.stream===d("WAWebSocketConstants").SOCKET_STREAM.CONNECTED&&b["delete"]()});return b}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.process=function(a,b,c,d){d!==!0?this.updateMsgs(a,b,c):this["delete"]()};f.sync=function(a){if(this.isSynced)return(j||(j=b("Promise"))).resolve();if(this.syncPromise!=null)return this.syncPromise;var e=this,f,g=this.last();g&&(f=g.id);this.syncPromise=d("WAWebMsgCollection").MsgCollection.getStarred(a,d("WAWebCollectionConstants").PAGE_SIZE,f).then(function(a){a.length&&e.add(a,{silent:!0}),a.length<d("WAWebCollectionConstants").PAGE_SIZE&&(e.isSynced=!0)})["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["starred msg sync error: "]))).devConsole(a)})["finally"](function(){e.syncPromise=null,e.trigger("sync")});this.trigger("sync");return c("WANullthrows")(this.syncPromise,"syncPromise can not be null")};f.updateMsgs=function(a,c,e){var f=this,g=this.syncPromise||(j||(j=b("Promise"))).resolve();this.syncPromise=g.then(function(){if(a){var g=c.length>0?d("WAWebMsgCollection").MsgCollection.incrementalStarredUpdate(c):(j||(j=b("Promise"))).resolve([]);return g.then(function(a){a=a.concat(e);f.isSynced&&f.add(a,{silent:!0});a.forEach(function(a){var b;(b=d("WAWebFrontendMsgGetters").getChat(a).starredMsgs)==null||b.add(a)});f.trigger("sync")})["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["models:starred:update:error: "]))).devConsole(a)})}g=c.concat(e).filter(function(a){return!a.star});l(g)})["finally"](function(){f.syncPromise=null})};f["delete"]=function(){this.isSynced=!1,a.prototype["delete"].call(this)};return e}(d("WAWebBaseCollection").BaseCollection);e.model=d("WAWebMsgModel").Msg;e.comparator=function(a,b){return b.t-a.t};var k=new e();function a(a){k.add(a),a.forEach(function(a){var b;(b=d("WAWebFrontendMsgGetters").getChat(a).starredMsgs)==null||b.add(a)})}function l(a){k.remove(a),a.forEach(function(a){var b;(b=d("WAWebFrontendMsgGetters").getChat(a).starredMsgs)==null||b.remove(a)})}g.StarredMsgCollection=e;g.AllStarredMsgsCollection=k;g.addStarredMsgs=a;g.removeStarredMsgs=l}),98);
__d("WAWebSyncButtonState",["WANullthrows","WAWebBizInteractiveMessageQuickReplyAction","WAWebFrontendMsgGetters","WAWebMsgButtonReplyMsgCollection","WAWebMsgCollection","WAWebMsgGetters","WAWebMsgType","WAWebQuotedMsgModelUtils","WAWebTemplateButtonReplyMsgCollection","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a){h(a),i(a),j(a)}function h(a){var b=function(){var b=a[f];if(!b)return 0;if(b.selectedCarouselCardIndex!=null)return 0;if(k(b)){var e=d("WAWebFrontendMsgGetters").getChat(b);e.msgUnsyncedButtonReplyMsgs==null&&(e.msgUnsyncedButtonReplyMsgs=new(c("WAWebMsgButtonReplyMsgCollection"))());e=e.msgUnsyncedButtonReplyMsgs;var g=d("WAWebQuotedMsgModelUtils").getQuotedMsgObj(b);if(!g)return 0;var h=e.get(g.id);h||(e.add({id:g.id,unsyncedButtonReplies:new(c("WAWebTemplateButtonReplyMsgCollection"))()}),h=e.get(g.id));e=c("WANullthrows")(h);h=e.unsyncedButtonReplies;h.add(b);e=d("WAWebMsgCollection").MsgCollection.get(g.id);if(e!=null&&e.buttons){g=e.buttons.get(""+c("WANullthrows")(b.selectedIndex));g&&(g.selected=!0);h.remove(b)}}else if(b.isFromTemplate&&b.buttons){e=d("WAWebFrontendMsgGetters").getChat(b);g=e.msgUnsyncedButtonReplyMsgs;if(g==null)return 0;h=g.get(b.id);h&&(h.unsyncedButtonReplies.forEach(function(a){a=c("WANullthrows")(b.buttons).get(""+c("WANullthrows")(a.selectedIndex));a&&(a.selected=!0)}),h.unsyncedButtonReplies["delete"]())}},e;for(var f=0;f<a.length;f++){e=b();if(e===0)continue}}function i(a){var b=function(){var b=a[e];if(!b)return 0;if(b.selectedCarouselCardIndex!=null)return 0;if(b.type===d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE&&b.selectedButtonId!=null&&l(b)){var c=d("WAWebQuotedMsgModelUtils").getQuotedMsgObj(b);if(!c)return 0;c=d("WAWebMsgCollection").MsgCollection.get(c.id);if(c!=null&&c.replyButtons){c=c.replyButtons.get(b.selectedButtonId);c&&(c.selected=!0)}}else if(b.isDynamicReplyButtonsMsg&&b.replyButtons&&b.replyButtons.every(function(a){return!a.selected})&&d("WAWebFrontendMsgGetters").getChat(b)){c=Math.max(0,d("WAWebFrontendMsgGetters").getChat(b).msgs.length-1e3);d("WAWebFrontendMsgGetters").getChat(b).msgs.getModelsArray().slice(c).filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE&&a.selectedButtonId!=null&&l(a)&&((a=d("WAWebQuotedMsgModelUtils").getQuotedMsgObj(a))==null?void 0:a.id.toString())===b.id.toString()}).map(function(a){a=a.selectedButtonId;return a}).forEach(function(a){var c;c=(c=b.replyButtons)==null?void 0:c.get(a);c!=null&&(c.selected=!0)})}},c;for(var e=0;e<a.length;e++){c=b();if(c===0)continue}}function j(a){var b=function(){var b=a[f];if(!b)return 0;if(k(b)&&b.selectedCarouselCardIndex!=null){var e=c("WANullthrows")(b.selectedCarouselCardIndex),g=c("WANullthrows")(b.selectedIndex),h=d("WAWebQuotedMsgModelUtils").getQuotedMsgObj(b);if(!h)return 0;h=d("WAWebMsgCollection").MsgCollection.get(h.id);if(h==null)return 0;if(h.carouselCardsParsed==null||h.carouselCardsParsed[e]==null)return 0;var i=h.carouselCardsParsed.slice();i[e]=babelHelpers["extends"]({},i[e],{interactivePayload:d("WAWebBizInteractiveMessageQuickReplyAction").rebuildInteractivePayloadWithDisabledButton(i[e].interactivePayload,g)});h.carouselCardsParsed=i}else if(b.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&b.carouselCardsParsed!=null&&d("WAWebFrontendMsgGetters").getChat(b)){e=Math.max(0,d("WAWebFrontendMsgGetters").getChat(b).msgs.length-1e3);g=d("WAWebFrontendMsgGetters").getChat(b).msgs.getModelsArray().slice(e).filter(function(a){return k(b)&&a.selectedCarouselCardIndex!=null&&((a=d("WAWebQuotedMsgModelUtils").getQuotedMsgObj(a))==null?void 0:a.id.toString())===b.id.toString()});if(g.length===0)return 0;h=c("WANullthrows")(b.carouselCardsParsed).slice();for(i of g){e=c("WANullthrows")(i.selectedCarouselCardIndex);g=c("WANullthrows")(i.selectedIndex);if(h[e]==null)continue;h[e]=babelHelpers["extends"]({},h[e],{interactivePayload:d("WAWebBizInteractiveMessageQuickReplyAction").rebuildInteractivePayloadWithDisabledButton(h[e].interactivePayload,g)})}b.carouselCardsParsed=h}},e;for(var f=0;f<a.length;f++){e=b();if(e===0)continue}}function k(a){return a.type===d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY&&a.selectedIndex!=null&&l(a)}var l=function(a){a=d("WAWebMsgGetters").getSender(a);return a!=null?a.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()):!1};g["default"]=a}),98);
__d("WAWebBlocklistCollection",["WAWebBaseCollection","WAWebBlocklistModel","WAWebContactCollection","WAWebLidMigrationUtils","WAWebWidFactory"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.listenTo(b,"add",function(a){b.$BlocklistCollectionImpl$p_1(a.id,!0)});b.listenTo(b,"remove",function(a){b.$BlocklistCollectionImpl$p_1(a.id,!1)});return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.$BlocklistCollectionImpl$p_1=function(a,b){a=d("WAWebWidFactory").asUserWidOrThrow(a);for(a of[d("WAWebLidMigrationUtils").toPn(a),d("WAWebLidMigrationUtils").toLid(a)])if(a){var c;(c=d("WAWebContactCollection").ContactCollection.get(a))==null||c.set("isContactBlocked",b)}};e.replaceAllWith=function(a){var b=this,d=new Map(a.map(function(a){return[a.toString(),new(c("WAWebBlocklistModel"))({id:a})]}));this.toArray().forEach(function(a){d.has(a.id.toString())?d["delete"](a.id.toString()):b.remove(a)});d.forEach(function(a){return b.add(a)})};e.dedupedList=function(){var a=this;return this.filter(function(b){b=b.contact();var c=b.phoneNumber;return b.id.isLid()&&c!=null?a.get(c)==null:!0})};return b}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebBlocklistModel");b=new a();g.BlocklistCollection=b}),98);
__d("WAWebBlocklistModel",["WAWebBaseModel","WAWebBlocklistCollection","WAWebContactCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.contact=function(){var a=d("WAWebContactCollection").ContactCollection.gadd(this.id);return a};c.getCollection=function(){return d("WAWebBlocklistCollection").BlocklistCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="blocklist";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebKeptMsgCollection",["WAWebBaseCollection","WAWebMsgModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function c(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.isSynced=!0,b.syncPromise=null,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(c,a);var d=c.prototype;d.process=function(){};d.sync=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}();d.updateMsgs=function(){};return c}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebMsgModel").Msg;a.comparator=function(a,b){return b.t-a.t};g.KeptMsgCollection=a}),98);
__d("WAWebUpdateOptOutListDbJob",["WALogger","WAWebSchemaOptOutList","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.toString();try{b?yield d("WAWebSchemaOptOutList").getOptOutListTable().createOrReplace({id:a}):yield d("WAWebSchemaOptOutList").getOptOutListTable().remove(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[WAWebUpdateOptOutListDbJob] updateOptOutListDbJob failed"]))).verbose().devConsole(a).sendLogs("Failed to update optoutlist db");throw c("err")("updateOptOutListDbJob failed")}});return j.apply(this,arguments)}function e(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield d("WAWebSchemaOptOutList").getOptOutListTable().clear()}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[WAWebUpdateOptOutListDbJob] clearOptOutListDbJob failed"]))).devConsole(a);throw c("err")("clearOptOutListDbJob failed")}});return k.apply(this,arguments)}g.updateOptOutListDbJob=a;g.clearOptOutListDbJob=e}),98);
__d("WAWebOptOutListCollection",["Promise","WAWebBaseCollection","WAWebContactCollection","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebOptOutListModel","WAWebUpdateOptOutListDbJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=function(a){return d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?d("WAWebLidMigrationUtils").toLid(a):null};a=function(a){function e(){var c;c=a.call(this)||this;c.updateOptOutListInCollectionAndDb=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.targetWid,e=a.isBlocked;a=d("WAWebWidFactory").asUserWidOrThrow(c);if(e){yield d("WAWebUpdateOptOutListDbJob").updateOptOutListDbJob(a,e);j.add({id:a});return}c=[d("WAWebLidMigrationUtils").toPn(a),i(a)].filter(Boolean);yield (h||(h=b("Promise"))).all(c.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUpdateOptOutListDbJob").updateOptOutListDbJob(a,e),j.remove(a)});return function(b){return a.apply(this,arguments)}}()))});return function(b){return a.apply(this,arguments)}}();c.listenTo(c,"add",function(a){c.$OptOutListCollectionImpl$p_1(a.id,!0)});c.listenTo(c,"remove",function(a){c.$OptOutListCollectionImpl$p_1(a.id,!1)});return c}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.$OptOutListCollectionImpl$p_1=function(a,b){a=d("WAWebWidFactory").asUserWidOrThrow(a);for(a of[d("WAWebLidMigrationUtils").toPn(a),i(a)])if(a){var c=d("WAWebContactCollection").ContactCollection.get(a);c&&(c.set("isContactOptedOut",b),b&&c.set("isEverOptedOutOfMarketingMessages",b))}};f.replaceAllWith=function(a){var b=this,d=new Map(a.map(function(a){return[a.wid.toString(),new(c("WAWebOptOutListModel"))({id:a.wid})]}));this.toArray().forEach(function(a){d.has(a.id.toString())?d["delete"](a.id.toString()):b.remove(a)});d.forEach(function(a){return b.add(a)})};return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebOptOutListModel");var j=new a();g.OptOutListCollection=j}),98);
__d("WAWebOptOutListModel",["WAWebBaseModel","WAWebContactCollection","WAWebOptOutListCollection","WAWebWid"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.contact=function(){var a=d("WAWebContactCollection").ContactCollection.gadd(this.id);return a};c.getCollection=function(){return d("WAWebOptOutListCollection").OptOutListCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="optoutlist";a.idClass=c("WAWebWid");b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebPresenceCollection",["WAWebBaseCollection","WAWebChatCollection","WAWebContactPresenceBridge","WAWebPresenceChatAction","WAWebPresenceModel","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(a){function e(){var d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(d=a.call.apply(a,[this].concat(f))||this,d.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d.gadd(a);if(!b.isUser||c("WAWebWid").isServer(a)||c("WAWebWid").isPSA(a)||c("WAWebWid").isFbidBot(a))return{id:a};yield d._subscribe(a);return{id:a}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(d))||babelHelpers.assertThisInitialized(d)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f._subscribe=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebChatCollection").ChatCollection.get(a);if(a){var b=d("WAWebPresenceChatAction").getChatIdentifier(a);a=a==null?void 0:a.getTcToken();yield d("WAWebContactPresenceBridge").subscribePresence(b,a)}});function c(b){return a.apply(this,arguments)}return c}();f.reSubscribeWhenActive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this.get(a);if(b==null||b.isSubscribed===!1)return;yield this._subscribe(a)});function c(b){return a.apply(this,arguments)}return c}();f.clearAllPresence=function(){this.forEach(function(a){a.reset(),a.set({stale:!0,isSubscribed:!1})})};return e}(d("WAWebBaseCollection").BaseCollection);a.model=d("WAWebPresenceModel").Presence;a.staleCollection=!0;e=new a();g.PresenceCollection=e}),98);
__d("WAWebPresenceEnum",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Info","Business","ChatAssignment","None","LastSeen","E2EE","Self","CommunityName","OnlyAdminsCanSend"]);f.WithholdDisplayStage=a}),66);
__d("WAWebPresenceModel",["fbt","WALogger","WAWebBaseCollection","WAWebBaseModel","WAWebChatAssignmentCollection","WAWebChatAssignmentUtils","WAWebChatCollection","WAWebChatContactUtils","WAWebChatGetters","WAWebClock","WAWebContactCollection","WAWebContactGetters","WAWebElevatedPushNamesFlag","WAWebFrontendChatGetters","WAWebFrontendContactGetters","WAWebGroupType","WAWebPresenceCollection","WAWebPresenceEnum","WAWebPrivacyGatingUtils","WAWebTextStatusGatingUtils","WAWebWid","lodash"],(function(a,b,c,d,e,f,g,h){var i,j,k=3e3,l=5e3,m=2e3;b=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.type=d("WAWebBaseModel").prop(),b.t=d("WAWebBaseModel").prop(),b.deny=d("WAWebBaseModel").prop(),b.updateTime=d("WAWebBaseModel").session(),b.expireTimerId=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}((a=d("WAWebBaseModel")).BaseModel);b.Proxy="chatstate";b.idClass=c("WAWebWid");var n=a.defineModel(b),o=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebBaseCollection").BaseCollection);o.model=n;e=function(a){function b(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.id=d("WAWebBaseModel").prop(),b.isOnline=d("WAWebBaseModel").session(!1),b.stale=d("WAWebBaseModel").session(!0),b.hasData=d("WAWebBaseModel").session(!1),b.isSubscribed=d("WAWebBaseModel").session(!1),b.withholdDisplayStage=d("WAWebBaseModel").session(d("WAWebPresenceEnum").WithholdDisplayStage.None),b.forceDisplay=d("WAWebBaseModel").session(!1),b.chatActive=d("WAWebBaseModel").session(!1),b.withholdDisplayTimer=d("WAWebBaseModel").session(),b.forceDisplayTimer=d("WAWebBaseModel").session(),b.chatstate=d("WAWebBaseModel").session(),b.chatstates=d("WAWebBaseModel").collection(o),b.isGroup=d("WAWebBaseModel").derived(function(){return c("WAWebWid").isGroup(this.id)}),b.isUser=d("WAWebBaseModel").derived(function(){return c("WAWebWid").isUser(this.id)}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.initialize=function(){var b=this;a.prototype.initialize.call(this);var d=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new n(d));this.isGroup?this.listenTo(this.chatstates,"add change",c("lodash").debounce(function(){var a,c=!1;b.chatstates.forEach(function(b){(b.type==="typing"||b.type==="recording_audio")&&(!a||a.updateTime<b.updateTime)&&(a=b),c=c||b.type==="available"});b.set({isOnline:c});b.chatstate.set({id:a?a.id:"",type:a?a.type:"unavailable"})})):this.listenTo(this.chatstate,"change:type",function(){b.chatstate.type==="available"?b.isOnline=!0:b.chatstate.type==="unavailable"&&(b.isOnline=!1)});this.listenTo(this,"change:chatActive",this.$PresenceImpl$p_1)};e["delete"]=function(){a.prototype["delete"].call(this),this.getCollection().remove(this.id),this.chatstate["delete"](),this.chatstates.forEach(function(a){return a["delete"]()})};e.reset=function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(a){a.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})};e.isActive=function(){var a=this.chatstate.type;return this.hasData&&(a==="typing"||a==="recording_audio")};e.getGroupSubtitleText=function(a){if(!this.hasData)return null;if(!this.isGroup){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getGroupSubtitleText is used when presence is not for a group"]))).sendLogs("getGroupSubtitleText-not-group");return null}var b=this.$PresenceImpl$p_2();if(b==null)return null;var c;a=(a=a==null?void 0:a.elevatedPushNamesEnabled)!=null?a:!1;a=d("WAWebElevatedPushNamesFlag").pushNameCanBeUsed(b)&&a;if(a){a=d("WAWebChatContactUtils").getFormattedNotifyName(d("WAWebContactGetters").getNotifyName(b));var e=d("WAWebChatContactUtils").getAccessibleNotifyName(d("WAWebContactGetters").getNotifyName(b));c=this.chatstate.type==="typing"?h._(/*BTDS*/"{member} is typing\u2026",[h._param("member",e)]):h._(/*BTDS*/"{member} is recording audio\u2026",[h._param("member",e)])}else a=d("WAWebFrontendContactGetters").getFormattedShortName(b);return{text:this.chatstate.type==="typing"?h._(/*BTDS*/"{member} is typing\u2026",[h._param("member",a)]):h._(/*BTDS*/"{member} is recording audio\u2026",[h._param("member",a)]),ariaLabel:c}};e.$PresenceImpl$p_2=function(){var a=this.chatstate.id;return!a?null:d("WAWebContactCollection").ContactCollection.get(a)};e.getUserSubtitleText=function(a){a===void 0&&(a=!1);if(!this.hasData)return null;if(!this.isUser){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getUserSubtitleText is used when presence is not for a user"]))).sendLogs("getUserSubtitleText-not-user");return null}var b=this.chatstate;switch(b.type){case"available":return h._(/*BTDS*/"online");case"typing":return a?h._(/*BTDS*/"online"):h._(/*BTDS*/"typing\u2026");case"recording_audio":return a?h._(/*BTDS*/"online"):h._(/*BTDS*/"recording audio\u2026");case"unavailable":return b.deny||b.t==null?null:d("WAWebClock").Clock.lastSeenStr(b.t)}};e.getFormattedString=function(a){if(!this.hasData)return null;else if(this.isGroup){a=this.getGroupSubtitleText(a);if(a!=null)return{text:a.text,ariaLabel:a.ariaLabel}}else if(this.isUser)return{text:this.getUserSubtitleText()};return null};e.getGroupStages=function(a){var b,c,e,f,g=[];((b=a.groupMetadata)==null?void 0:b.groupType)===d("WAWebGroupType").GroupType.LINKED_SUBGROUP&&(c=a.groupMetadata)!=null&&c.participants.iAmMember()&&g.push(d("WAWebPresenceEnum").WithholdDisplayStage.CommunityName);a!=null&&(e=a.groupMetadata)!=null&&e.participants.iAmAdmin()&&(f=a.groupMetadata)!=null&&f.announce?(g.push(d("WAWebPresenceEnum").WithholdDisplayStage.OnlyAdminsCanSend),d("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&a!=null&&d("WAWebFrontendChatGetters").getIsE2ee(a)&&g.push(d("WAWebPresenceEnum").WithholdDisplayStage.E2EE)):d("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&a!=null&&d("WAWebFrontendChatGetters").getIsE2ee(a)?g.push(d("WAWebPresenceEnum").WithholdDisplayStage.E2EE):g.push(d("WAWebPresenceEnum").WithholdDisplayStage.Info);d("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&g.push(d("WAWebPresenceEnum").WithholdDisplayStage.LastSeen);g.push(d("WAWebPresenceEnum").WithholdDisplayStage.None);return g};e.$PresenceImpl$p_1=function(){var a=this,b=this.chatActive;if(b){b=d("WAWebChatAssignmentCollection").ChatAssignmentCollection.getAgentCollectionForChatId(this.id).length>0;var c=this.$PresenceImpl$p_2(),e=c&&d("WAWebContactGetters").getIsMe(c),f=[],g=d("WAWebChatCollection").ChatCollection.get(this.id);g!=null&&d("WAWebChatGetters").getIsGroup(g)?f=this.getGroupStages(g):e===!0?(d("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&g!=null&&d("WAWebFrontendChatGetters").getIsE2ee(g)&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.E2EE),f.push(d("WAWebPresenceEnum").WithholdDisplayStage.Self),p(this,f)):this.hasData?(d("WAWebChatAssignmentUtils").canAssignChat(g)&&b&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.ChatAssignment),(c==null?void 0:c.isBusiness)===!0&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.Business),d("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),f.length>0?f.push(d("WAWebPresenceEnum").WithholdDisplayStage.None):(d("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),f.push(d("WAWebPresenceEnum").WithholdDisplayStage.None))):(d("WAWebChatAssignmentUtils").canAssignChat(g)&&b&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.ChatAssignment),(c==null?void 0:c.isBusiness)===!0&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.Business),d("WAWebPrivacyGatingUtils").isDataPrivacyPhase2Enabled()&&g!=null&&d("WAWebFrontendChatGetters").getIsE2ee(g)?f.push(d("WAWebPresenceEnum").WithholdDisplayStage.E2EE):f.push(d("WAWebPresenceEnum").WithholdDisplayStage.Info),d("WAWebTextStatusGatingUtils").receiveTextStatusForNewSurfacesEnabled()&&f.push(d("WAWebPresenceEnum").WithholdDisplayStage.LastSeen),f.push(d("WAWebPresenceEnum").WithholdDisplayStage.None));p(this,f);this.forceDisplayTimer=self.setTimeout(function(){a.set({forceDisplay:!0,forceDisplayTimer:void 0})},m)}else this.withholdDisplayTimer&&(self.clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(self.clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0)};e.subscribe=function(){return this.getCollection().find(this.id)};e.getCollection=function(){return d("WAWebPresenceCollection").PresenceCollection};return b}(a.BaseModel);e.Proxy="presence";e.idClass=c("WAWebWid");function p(a,b){if(b.length===0)return;var c=b[0],e=b.slice(1);a.set({withholdDisplayStage:c,withholdDisplayTimer:c===d("WAWebPresenceEnum").WithholdDisplayStage.None?null:self.setTimeout(function(){p(a,e)},c===d("WAWebPresenceEnum").WithholdDisplayStage.Business?l:k)})}f=a.defineModel(e);g.processStagesRecursively=p;g.Presence=f;g.Chatstate=n;g.ChatstateCollection=o}),226);
__d("WAWebWamEnumUserNoticeErrorEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_STANZA:1,JSON_FETCH:2,JSON_PARSE:3,IMAGE_FETCH:4,NO_ELIGIBLE_DISCLOSURE:5,DISCLOSURE_STAGE_FETCH:6,UI_TEMPLATE_MISMATCHED:7,ERROR_UNKNOWN:8,SYNC_STAGE_MISMATCH:9,IMAGE_FETCH_400:10,JSON_FETCH_400:11,JSON_FETCH_REDIRECT:12,IMAGE_FETCH_REDIRECT:13,IMAGE_FETCH_FORBIDDEN:14,JSON_FETCH_FORBIDDEN:15,FAIL_TO_SEND_STAGE_TO_SERVER:16});f.USER_NOTICE_ERROR_EVENT=a}),66);
__d("WAWebUserNoticeErrorWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumNoticeType","WAWebWamEnumUserNoticeErrorEvent"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({UserNoticeError:[2474,{noticeType:[4,d("WAWebWamEnumNoticeType").NOTICE_TYPE],userNoticeContentVersion:[2,d("WAWebWamCodegenUtils").TYPES.INTEGER],userNoticeErrorEvent:[3,d("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT],userNoticeId:[1,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{UserNoticeError:[]});g.UserNoticeErrorWamEvent=a}),98);
__d("isNonZeroNumber",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a!=null&&a!==0&&!isNaN(a)}f.isNonZeroNumber=a}),66);
__d("WAWebGetUserDisclosuresContentsQueryJob",["Promise","WAAbortError","WALogger","WAWebConnModel","WAWebCountryCodeUtils","WAWebHttpErrors","WAWebPonyfillsFetch","WAWebURLUtils","WAWebUserNoticeErrorWamEvent","WAWebUserPrefsInfoStore","WAWebUserPrefsMeUser","WAWebWamEnumUserNoticeErrorEvent","asyncToGeneratorRuntime","err","isNonZeroNumber"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m="https://www.whatsapp.com/user-notice/v1/",n=new Set(["ACCEPT","OK"]),o="zz",p="ZZ";function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("isNonZeroNumber").isNonZeroNumber(a)){var e,f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();f=d("WAWebCountryCodeUtils").pnToCountryCodeString(f.user);var g=(yield d("WAWebUserPrefsInfoStore").deviceInfo.get());g=c("WAWebURLUtils").build(m,{id:a,lg:(e=g.lg)!=null?e:o,lc:(e=g.lc)!=null?e:p,cc:f,platform:d("WAWebConnModel").Conn.isSMB?"smbweb":"web"});return r(g,a)}return(l||(l=b("Promise"))).resolve({disclosureId:a})});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=(yield v(a));try{if(a!=null){a=JSON.parse(a);if(a!=null)return x(a,b)}}catch(c){a=new(d("WAWebUserNoticeErrorWamEvent").UserNoticeErrorWamEvent)({userNoticeId:b,userNoticeContentVersion:1,userNoticeErrorEvent:d("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT.JSON_PARSE});a.commit()}}catch(a){if(a.name===d("WAAbortError").ABORT_ERROR)return;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Notice: Error Message : ",""])),a.message).sendLogs("pdfn-notice-content-error");throw new(d("WAWebHttpErrors").HttpNetworkError)()}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return new(l||(l=b("Promise")))(function(b,c){var d=new FileReader();d.onload=function(){var a=String(d.result);b(a)};d.onerror=c;d.readAsDataURL(a)})});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new AbortController();b=b.signal;a=(yield c("WAWebPonyfillsFetch")(a,{signal:b}));b=a.headers.get("Content-Type");if(b==null)return a.text();if(b.includes("image/svg+xml"))return a.text();return b.includes("image/png")?t(yield a.blob()):a.text()});return w.apply(this,arguments)}function x(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=a.policyVersion;if(f==null)throw c("err")("Missing field policyVersion in notice content.");d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Notice:fetchNoticeData successful for policyVersion ",""])),f);var g=A(a);a=z(a);f=parseInt(f,10);var h;try{h=(yield F(g))}catch(a){var i=new(d("WAWebUserNoticeErrorWamEvent").UserNoticeErrorWamEvent)({userNoticeId:e,userNoticeContentVersion:f,userNoticeErrorEvent:d("WAWebWamEnumUserNoticeErrorEvent").USER_NOTICE_ERROR_EVENT.IMAGE_FETCH});i.commit();d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Notice: Icon fetch error : ",""])),a.message).sendLogs("notice-icon-fetch-error")}return(l||(l=b("Promise"))).resolve({disclosureId:e,policyVersion:f,privacyDisclosureModal:h!=null?h:g,endDate:a})});return y.apply(this,arguments)}function z(a){a=a["privacy-disclosure"]&&((a=a["privacy-disclosure"])==null||(a=a.timing)==null||(a=a.end)==null?void 0:a.time);return a==null?null:new Date(a)}function A(a){a=a["privacy-disclosure"]&&B(a["privacy-disclosure"].prompts[0]);return a==null?null:E(a)}function B(a){if(!a)return;C(["icon","iconDescription","title","bullets","primaryButton","nav"],a);C(["light","dark","type"],a.icon);C(["dismissButton","backButton"],a.nav);for(var b=0;b<a.bullets.length;b++)C(["icon","text"],a.bullets[b]);b=a.footer!=null?{footer:a.footer}:{};return babelHelpers["extends"]({icon:{light:a.icon.light,dark:a.icon.dark,type:a.icon.type},iconSvg:{light:"",dark:""},iconDescription:a.iconDescription,title:a.title,bullets:a.bullets,primaryButton:a.primaryButton,nav:{dismissButton:a.nav.dismissButton,backButton:a.nav.backButton}},b)}function C(a,b){a.forEach(function(a){if(!(a in b))throw c("err")("Missing field "+a+" in notice content.")})}var D=function(a){if(!a)return null;var b=a.action;if(b){if(n.has(b))return a;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Notice: Unknown action type ",""])),b)}return null};function E(a){if(!a)return null;a.primaryButton=D(a.primaryButton);return a}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[a==null?void 0:a.icon.light,a==null?void 0:a.icon.dark];for(var d=0;d<((e=a==null?void 0:a.bullets.length)!=null?e:0);d++){var e;e=a==null?void 0:a.bullets[d];e!=null&&(c.push(e.icon.light),c.push(e.icon.dark))}e=c.map(function(a){return a!=null?v(a):(l||(l=b("Promise"))).resolve(null)});d=a;c=(yield (l||(l=b("Promise"))).all(e));e=c[0];var f=c[1];c=c.slice(2);var g=[];for(var h=0;h<((i=a==null?void 0:a.bullets.length)!=null?i:0);h++){var i;i=a==null?void 0:a.bullets[h];if(i!=null){var j=c[h*2],k=c[h*2+1];j!=null&&k!=null?g.push(babelHelpers["extends"]({},i,{iconSvg:{light:j,dark:k}})):g.push(i)}}a&&e!=null&&f!=null&&(d=babelHelpers["extends"]({},a,{bullets:g,iconSvg:{light:e,dark:f}}));return d});return G.apply(this,arguments)}g.getUserDisclosureContentsQueryJob=a;g.attemptFetch=v}),98);
__d("WAWebGetUserDisclosuresContentsJob",["WAJobOrchestratorTypes","WAWebGetUserDisclosuresContentsQueryJob","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getDisclosuresContentsJob",function(){return d("WAWebGetUserDisclosuresContentsQueryJob").getUserDisclosureContentsQueryJob(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getDisclosuresContentsJob=a}),98);
__d("WAWebGetUserDisclosuresContentsAction",["WAWebGetUserDisclosuresContentsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebGetUserDisclosuresContentsJob").getDisclosuresContentsJob(a));return a});return h.apply(this,arguments)}g.getDisclosuresContentAction=a}),98);
__d("WAWebUserDisclosureCollection",["WAWebBaseCollection","WAWebGetUserDisclosuresContentsAction","WAWebUserDisclosureModel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=864e5;a=function(a){function e(){var e;for(var f=arguments.length,g=new Array(f),i=0;i<f;i++)g[i]=arguments[i];return(e=a.call.apply(a,[this].concat(g))||this,e.findImpl=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,f=e.get(a);if(f!=null&&f.privacyDisclosureModal!=null&&f.endDate!=null&&((b=f.endDate)==null?void 0:b.getTime())>new Date().getTime()&&new Date().getTime()-f.lastUpdated.getTime()<h)return f;b=(yield d("WAWebGetUserDisclosuresContentsAction").getDisclosuresContentAction(parseInt(a,10)));if(b!=null){f=new(c("WAWebUserDisclosureModel"))({id:b.disclosureId,policyVersion:b.policyVersion,privacyDisclosureModal:b.privacyDisclosureModal,endDate:b.endDate,lastUpdated:new Date()});e.gadd(f,{merge:!0});return f}});return function(b){return a.apply(this,arguments)}}(),babelHelpers.assertThisInitialized(e))||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.updateNoticeStage=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.id,d=a.accepted;a=a.policyVersion;b=new(c("WAWebUserDisclosureModel"))({id:b,policyVersion:a,accepted:d,lastUpdated:new Date()});this.gadd(b,{merge:!0})});function d(b){return a.apply(this,arguments)}return d}();return e}(d("WAWebBaseCollection").BaseCollection);a.model=c("WAWebUserDisclosureModel");e=new a();g.UserDisclosureCollection=e}),98);
__d("WAWebUserDisclosureModel",["WAWebBaseModel","WAWebUserDisclosureCollection"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.id=d("WAWebBaseModel").prop(),b.policyVersion=d("WAWebBaseModel").prop(),b.privacyDisclosureModal=d("WAWebBaseModel").prop(),b.endDate=d("WAWebBaseModel").prop(),b.accepted=d("WAWebBaseModel").session(),b.lastUpdated=d("WAWebBaseModel").session(),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.getCollection=function(){return d("WAWebUserDisclosureCollection").UserDisclosureCollection};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="userDisclosure";b=d("WAWebBaseModel").defineModel(a);g["default"]=b}),98);
__d("WAWebViewOnceState",["WATimeUtils","WAWebAck","WAWebFrontendMsgGetters","WAWebStateUtils"],(function(a,b,c,d,e,f,g){var h=14*24*60*60;function i(a){a=d("WAWebStateUtils").unproxy(a);return a!=null?d("WAWebFrontendMsgGetters").getAsViewOnce(a.unsafe()):null}function a(a){return!j(a)&&!k(a)}function j(a){return((a=i(a))==null?void 0:a.ack)===d("WAWebAck").ACK.PLAYED}function k(a){a=i(a);if(a==null)return!1;var b=d("WATimeUtils").unixTime()-d("WAWebStateUtils").unproxy(a).t;return!j(a)&&b>=h}g.VIEW_ONCE_EXPIRE_AFTER=h;g.isUnviewed=a;g.isViewed=j;g.isExpired=k}),98);
__d("WAWebUpdaterDownloadStateType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["UPDATE_DOWNLOADED","UPDATE_NOT_AVAILABLE","ERROR"]);f.DownloadState=a}),66);
__d("WAWebSwUpdater",["Promise","WALogger","WAWebBuildConstants","WAWebUpdaterDownloadStateType","WAWebUpdaterVersion"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[sw] update starts. Current app version: ",""])),String(new(d("WAWebUpdaterVersion").Version)(d("WAWebBuildConstants").VERSION_BASE)));var a=navigator.serviceWorker;return a?a.ready.then(function(c){return new(m||(m=b("Promise")))(function(b){var e;function f(a){h(),d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unable to update service worker to version. Error: ",""])),String(a)).sendLogs("[sw] sw-update-failed: "+String(a),{sampling:.1})}function g(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[sw] updated"]))),h(),b(d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED)}function h(){a.removeEventListener("error",f),a.removeEventListener("controllerchange",g)}a.addEventListener("error",f);a.addEventListener("controllerchange",g);(e=c.active)!=null&&(e=e.scriptURL)!=null&&e.includes("serviceworker.js")?void c.unregister():c.update().then(function(){c.installing||(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[sw] update is not available"]))),b(d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE))})["catch"](function(a){f(a),b(d("WAWebUpdaterDownloadStateType").DownloadState.ERROR)})})})["catch"](function(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unable to update serviceworker, error: ",""])),a).sendLogs("sw-update-failed");return d("WAWebUpdaterDownloadStateType").DownloadState.ERROR}):(m||(m=b("Promise"))).resolve(d("WAWebUpdaterDownloadStateType").DownloadState.ERROR)}g.updateSw=a}),98);
__d("WAWebUpdater",["Promise","WALogger","WAWebAlarm","WAWebMiscBrowserUtils","WAWebStreamModel","WAWebSwUpdater","WAWebUpdaterBaseUpdater","WAWebUpdaterDownloadStateType","WAWebUpdaterVersion","cr:6022"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=function(a){function e(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.showSoftUpdateBanner=function(){d("WAWebStreamModel").Stream.needsUpdate=!0};f.update=function(a,e,f){var g=this;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["AppUpdate:update current: "," latest: ",""])),String(this.activeVersion),String(a));var i=++this.latestUpdateIteration,j=a==null?void 0:new(d("WAWebUpdaterVersion").Version)(a);this.clearHardExpiration();typeof f==="number"&&(this.hardExpirationTimer=c("WAWebAlarm").setLocalTimeout(function(){d("WAWebStreamModel").Stream.clientExpired=!0,void g.restart()},Date.now()+f));this.updateInProgress=(k||(k=b("Promise"))).resolve(this.updateInProgress).then(function(){return g._update(j)}).then(function(a){g.updateInProgress=void 0;var b=i!==g.latestUpdateIteration,c=a===d("WAWebUpdaterDownloadStateType").DownloadState.ERROR,h=a===d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE;if(b||c||h)return a;(e===!0||typeof f==="number")&&(d("WAWebStreamModel").Stream.needsUpdate=!0);typeof f==="number"&&g.listenToAndRun(d("WAWebStreamModel").Stream,"change:couldForce",function(){d("WAWebStreamModel").Stream.couldForce&&g.restart()});return a});return this.updateInProgress};f._update=function(a){if(!this.activeVersion.equals(a)&&b("cr:6022")!=null&&b("cr:6022").alive)return d("WAWebSwUpdater").updateSw();a=this.activeVersion.equals(a)?d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE:d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED;return(k||(k=b("Promise"))).resolve(a)};f.killServiceWorker=function(){if(!(b("cr:6022")!=null&&b("cr:6022").alive))return(k||(k=b("Promise"))).resolve();var a=navigator.serviceWorker;if(!a)return(k||(k=b("Promise"))).resolve();d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Killing service worker"])));return a.ready.then(function(a){return a.unregister()}).then(function(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Service worker unregistration status: ",""])),String(a))})};f.restart=function(a){if(a===!0)return this.update(void 0,!0,0);c("WAWebMiscBrowserUtils").hardRefresh();return(k||(k=b("Promise"))).resolve(d("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED)};return e}(d("WAWebUpdaterBaseUpdater").UpdaterBase);e=new a();g.UpdaterImpl=a;g.Updater=e}),98);
__d("WAWebUpdaterBaseUpdater",["WACustomError","WAWebAlarm","WAWebBuildConstants","WAWebEventEmitter","WAWebStreamModel","WAWebUpdaterVersion","WAWebWAWCStorage"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;b=a.call(this)||this;b.$UpdaterBase$p_1=!1;b.latestUpdateIteration=0;b.activeVersion=new(d("WAWebUpdaterVersion").Version)(d("WAWebBuildConstants").VERSION_BASE);c("WAWebWAWCStorage").onVersionChange(function(){return b.setForceUpdateOnTakeOver()});return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.setForceUpdateOnTakeOver=function(){this.$UpdaterBase$p_1=!0};e.shouldForceUpdateOnTakeOver=function(){var a=this.$UpdaterBase$p_1;this.$UpdaterBase$p_1=!1;return!!a};e.isExpired=function(){return!1};e.clearHardExpiration=function(){this.hardExpirationTimer&&(c("WAWebAlarm").clearTimeout(this.hardExpirationTimer),this.hardExpirationTimer=void 0),this.stopListening(d("WAWebStreamModel").Stream,"change:couldForce")};e.update=function(a,b,c,e){throw new(d("WACustomError").UnimplementedMethod)("Updater::update")};e.showSoftUpdateBanner=function(){throw new(d("WACustomError").UnimplementedMethod)("Updater::showSoftUpdateBanner")};e.restart=function(a){throw new(d("WACustomError").UnimplementedMethod)("Updater::restart")};e.manualDownload=function(){throw new(d("WACustomError").UnimplementedMethod)("Updater::manualDownload")};e.killServiceWorker=function(){throw new(d("WACustomError").UnimplementedMethod)("Updater::killServiceWorker")};return b}(c("WAWebEventEmitter"));g.UpdaterBase=a}),98);