;/*FB_PKG_DELIM*/

__d("WAWebAddonCrossWindowUtils",[],(function(a,b,c,d,e,f){function g(a){if(a.realType!=null)return a.realType;return a.revokeAddonType!=null?a.revokeAddonType:a.type}function a(a){return a.type===g(a)}function b(a){a=g(a);switch(a){case"pin_message":case"reaction":case"reaction_enc":case"comment":case"event_edit_encrypted":case"event_response":case"poll_update":case"newsletter_question_response":return!0;case"keep_in_chat":case"unknown":return!1;default:a;return!1}}f.getAddonProcessorType=g;f.isRealAddonType=a;f.isInfraSupportedAddon=b}),66);
__d("WAWebAddonEncryptAddonMsgData",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessRevokeDataUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);if(a.type!==b)return a.kind===d("WAWebMsgType").MsgKind.ProtocolAddonRevoke?d("WAWebAddonProcessRevokeDataUtils").protocolRevokeToRevokeMsgData(a):a}function a(a,b){var c=h(a);if(c!=null)return;c=d("WAWebAddonPluginProcessor").getAddonProcessor(a);c=c.convert;var e=c.toDualEncryptedMsgData,f=c.toDualDecryptedMsgData;if(e==null||f==null)return;return{decrypt:function(){return f(a,b)},encrypt:function(){return e(a,b)}}}g.createDualEncryptionHelper=a}),98);
__d("WAWebAddonInfraError",["$InternalEnum","WACustomError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({UnexpectedError:"unexpected_error",NotSupportedFeature:"not_supported_feature",NotSupportedMsgType:"not_supported_msg_type",UnexpectedMsgType:"unexpected_msg_type",InvalidParentMsgKey:"invalid_parent_msg_key",MissingParentMsg:"missing_parent_msg"});c=function(a){function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("AddonInfraError"));g.AddonInfraErrorCode=a;g.AddonInfraError=c}),98);
__d("WAWebWamEnumDeviceType",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIMARY:1,COMPANION:2});f.DEVICE_TYPE=a}),66);
__d("WAWebWamEnumDsmError",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_SENDER:1,MISSING_DSM:2,INVALID_DSM:3});f.DSM_ERROR=a}),66);
__d("WAWebWamEnumEditType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_EDITED:0,EDITED:1,SENDER_REVOKE:2,ADMIN_REVOKE:3,ADMIN_EDIT:4,PIN:5});f.EDIT_TYPE=a}),66);
__d("WAWebWamEnumMediaType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:1,PHOTO:2,VIDEO:3,AUDIO:4,PTT:5,LOCATION:6,CONTACT:7,DOCUMENT:8,URL:9,CALL:10,GIF:11,FUTURE:12,CONTACT_ARRAY:13,LIVE_LOCATION:14,PROFILE_PIC:15,STICKER:16,HSM:17,PRODUCT_IMAGE:18,TEMPLATE:19,MD_APP_STATE:20,MD_HISTORY_SYNC:21,CATALOG_LINK:22,PRODUCT_LINK:23,ORDER:24,LIST:25,LIST_REPLY:26,BUTTON_MESSAGE:27,BUTTON_RESPONSE_MESSAGE:28,PRODUCT_LIST:29,BUTTON_NFM:30,VIEW_ONCE_IMAGE:31,VIEW_ONCE_VIDEO:32,SHOP_STOREFRONT:33,REACTION:34,INTERACTIVE_NFM:35,INTERACTIVE_RESPONSE_NFM:36,POLL_CREATE:37,POLL_VOTE:38,TEXT:39,KEEP:40,UNKEEP:41,INVISIBLE_HELLO:42,MEDIA_EXPRESS_NOTIFY:43,UNDECRYPTED_MEDIA:44,UNDECRYPTED_TEXT:45,UNDECRYPTED_PAY:46,UNDECRYPTED_POLL:47,UNDECRYPTED_REACTION:48,UNDECRYPTED_MEDIA_NOTIFY:49,VIEW_ONCE_AUDIO:50,SCHEDULED_CALL_CREATE:51,SCHEDULED_CALL_CANCEL:52,PUSH_TO_VIDEO:53,PIN_IN_CHAT:54,INTERACTIVE_CAROUSEL:55,COMMENT:56,EPHEMERAL_SYNC_RESPONSE:57,EVENT_CREATE:58,EVENT_RESPOND:59,LOTTIE_STICKER:60,INTERACTIVE_PRODUCT_CAROUSEL:61,INTERACTIVE_PRODUCT:62,MEDIA_ALBUM:63,STICKER_PACK:64,POLL_RESULT_SNAPSHOT:65,MUSIC_ARTWORK:66,RICH_RESPONSE:67,MOTION_PHOTO:68,MOTION_VIDEO:69});f.MEDIA_TYPE=a}),66);
__d("WAWebWamEnumMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:1,GROUP:2,BROADCAST:3,STATUS:4,CHANNEL:5,INTEROP:6,GREETING:7,MEDIA_HUB:8});f.MESSAGE_TYPE=a}),66);
__d("WAWebWamEnumRevokeType",[],(function(a,b,c,d,e,f){a=Object.freeze({SENDER:0,ADMIN:1});f.REVOKE_TYPE=a}),66);
__d("WAWebMdBadDeviceSentMessageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDeviceType","WAWebWamEnumDsmError","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumRevokeType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdBadDeviceSentMessage:[2176,{dsmError:[2,d("WAWebWamEnumDsmError").DSM_ERROR],editType:[3,d("WAWebWamEnumEditType").EDIT_TYPE],isLid:[4,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],mediaType:[5,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[6,d("WAWebWamEnumMessageType").MESSAGE_TYPE],peerType:[1,d("WAWebWamEnumDeviceType").DEVICE_TYPE],revokeType:[7,d("WAWebWamEnumRevokeType").REVOKE_TYPE]},[1,1,1],"regular"]},{MdBadDeviceSentMessage:[]});g.MdBadDeviceSentMessageWamEvent=a}),98);
__d("WAWebWamEnumE2eFailureReason",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_MESSAGE:0,LEGACY_MESSAGE:1,INVALID_VERSION:2,PRE_KEY_MESSAGE_MISSING_PRE_KEY:3,PRE_KEY_MESSAGE_INVALID_KEY:4,UNTRUSTED_IDENTITY:5,NO_SESSION_AVAILABLE:6,PLAINTEXT_BYTE_MISMATCH:7,UNKNOWN_CIPHERTEXT_TYPE:8,UNKNOWN_CIPHERTEXT_VERSION:9,INVALID_PADDING:10,INVALID_PROTOCOL_BUFFER:11,INVALID_NUMBER_OF_MESSAGE_TYPES:12,INVALID_IMAGE_FILE_LENGTH:13,INVALID_IMAGE_FILE_SHA256:14,INVALID_IMAGE_MEDIA_URL:15,INVALID_IMAGE_MEDIA_KEY:16,INVALID_IMAGE_MIME_TYPE:17,UNKNOWN_V2_TAGS:18,INVALID_EDIT_VERSION:19,INVALID_HSM_NAMESPACE:20,INVALID_HSM_ELEMENT:21,UNKNOWN_PROTOCOL_MESSAGE_TYPE:22,DUPLICATE_MESSAGE:23,FINGERPRINT_IDENTITY_MISMATCH:24,FINGERPRINT_VERSION_MISMATCH:25,INVALID_ARGUMENT:26,INVALID_KEY:27,INVALID_KEY_ID:28,INVALID_MAC:29,NO_MEMORY:30,STALE_KEY_EXCHANGE:31,VRF_SIGNATURE_VERIFICATION_FAILED:32,ERROR_MINIMUM_VALUE:33,ERROR_UNKNOWN:34,INVALID_BROADCAST_STANZA_ATTRIBUTE:35,INVALID_LIST_REPLY_MESSAGE:36,INVALID_LIST_REPLY_ROW_IDENTIFIER:37,INVALID_BUTTONS_RESPONSE_MESSAGE:38,INVALID_BUTTONS_RESPONSE_BUTTON_IDENTIFIER:39,INVALID_ORDER_MESSAGE:40,ERROR_CANCELLED:41,FUTURE_MESSAGE:42,INVALID_EMPTY_PROTOBUF_NOT_ALLOWED:43,SELF_SEND:44,INVALID_MEDIA_MIME_TYPE_TEMPLATE_MESSAGE:45,INVALID_MEDIA_ENC_HASH:46,INVALID_IDENTITY:47,PASSTHROUGH:48,NOT_IN_PENDING_DEVICES:49,EDIT_TYPE_AND_PROTOCOL_MISMATCH:50,DECRYPTION_FAILED:51,DESERIALIZE_INVALID_PROTO_FORMAT:52,DESERIALIZE_RATCHET_KEY_BAD_FORMAT:53,DESERIALIZE_PK_INVALID_PROTO_FORMAT:54,DESERIALZE_PK_KEY_BAD_FORMAT:55,TOO_MANY_MESSAGES_IN_FUTURE:56,EMPTY_VERSION_CONTENT_SUFFIX:57,CONTENT_EXCEEDED_EXPECTED_LENGTH:58,GRP_INVALID_PROTO_FORMAT:59,GRP_INVALID_KEY_FORMAT:60,GRP_VERSION_CONTENT_EMPTY:61,GRP_INVALID_VERSION_CONTENT_LENGTH:62,GRP_SENDER_KEY_INVALID_PROTO_FORMAT:63,GRP_SENDER_KEY_PROTO_ERROR:64,GRP_TOO_MANY_MESSAGES_IN_FUTURE:65,MISSING_MESSAGE_SECRET:66,MESSAGE_SECRET_INVALID:67,INVALID_REACTION_TEXT:68,UNSUPPORTED_MESSAGE_TYPE:69,UNSUPPORTED_IN_INTEROP:70,TARGET_MESSAGE_NOT_FOUND:71,STATUS_FROM_HOSTED_DEVICE_UNSUPPORTED:72,GROUP_MESSAGE_FROM_HOSTED_DEVICE_UNSUPPORTED:73,BROADCAST_FROM_HOSTED_DEVICE_UNSUPPORTED:74,LIVE_LOCATION_FROM_HOSTED_DEVICE_UNSUPPORTED:75,MESSAGE_TYPE_MISMATCH:76,ERROR_SESSION_STATE_UNACKED_PKMSG_GET_BASE_KEY:77,ERROR_SIGNAL_MESSAGE_GET_SENDER_RATCHET_KEY:78,ERROR_SESSION_STATE_GET_ROOT_KEY:79,ERROR_SESSION_STATE_GET_SENDER_RATCHET_KEY_PAIR:80,ERROR_SESSION_STATE_SET_SENDER_CHAIN_KEY:81,ERROR_SESSION_STATE_FIND_RECEIVER_CHAIN:82,ERROR_SESSION_RECORD_DESERIALIZE:83,ERROR_SENDER_KEY_STATE_REMOVE_SENDER_MESSAGE_KEY:84,ERROR_EMPTY_PLAINTEXT_DATA:85,ERROR_MAC_LEN_MISMATCH:86,ERROR_INVALID_MAC_LEN:87,ERROR_INVALID_SIGNATURE_LEN:88,ERROR_SENDER_KEY_LOAD_KEY:89,ERROR_FAST_RATCHET_SENDER_KEY_LOAD_KEY:90,ERROR_UNKNOWN_LOAD_KEY:91,ERROR_UNKNOWN_LOAD_SESSION:92,ERROR_SESSION_RECORD_GET_STATE:93,ERROR_SESSION_STATE_GET_SENDER_CHAIN_KEY:94,ERROR_INVALID_KEY_MATEIRAL_DATA_LEN:95,ERROR_SESSION_STATE_GET_SENDER_RATCHET_KEY:96,ERROR_SESSION_STATE_GET_LOCAL_IDENTITY_KEY:97,ERROR_SESSION_STATE_GET_REMOTE_IDENTITY_KEY:98,ERROR_MEDIA_HASH_VERIFICATION_FAILURE:99,ERROR_CIPHERTEXT_TOO_LONG:100,ERROR_THUMBNAIL_HASH_VERIFICATION_FAILURE:101,ERROR_PARENT_CHILD_SENDER_JID_MISMATCH:102,INVALID_EDIT_MESSAGE:103,INVALID_SESSION:104,INVALID_STATUS_QUESTION_ANSWER_MESSAGE:105,INVALID_REPORTING_TOKEN:106,MISSING_REPORTING_TOKEN:107,INVALID_GUEST_MESSAGE_TYPE:108,INVALID_GUEST_PROTOCOL_BUFFER:109,INVALID_STATUS_STICKER_INTERACTION_MESSAGE:110});f.E2E_FAILURE_REASON=a}),66);
__d("WAWebHandleMsgError",["$InternalEnum","WACustomError","WAWebMdBadDeviceSentMessageWamEvent","WAWebWamEnumDsmError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){c=function(a){function b(b,c){var e;c===d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM?e=a.call(this,"message should be deviceSentMessage")||this:c===d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_SENDER?e=a.call(this,"message should not be deviceSentMessage")||this:c===d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM?e=a.call(this,"invalid deviceSentMessage")||this:e=a.call(this,"unknown deviceSentMessage error")||this;new(d("WAWebMdBadDeviceSentMessageWamEvent").MdBadDeviceSentMessageWamEvent)({peerType:b,dsmError:c}).commit();e.peerType=b;e.dsmError=c;return babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(b,a);return b}((a=d("WACustomError")).customError("DeviceSentMessageError"));e=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("UnknownDeviceMessageError"));f=function(a){function b(b,c,d){var e;e=a.call(this,typeof b==="string"?b:String(b))||this;e.code=b;e.e2eFailureReason=c;e.sendLogs=(b=d==null?void 0:d.sendLogs)!=null?b:!0;return e}babelHelpers.inheritsLoose(b,a);return b}(a.customError("MessageValidationError"));var h=function(a){function b(b){var c;c=a.call(this,"Received Nack error code "+(b!=null?b:"")+" from Server on message sent")||this;c.ackErrorCode=b;return c}babelHelpers.inheritsLoose(b,a);return b}(a.customError("MessageSentAckError"));a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("BizNodeValidationError"));b=b("$InternalEnum")({INVALID_POLL_UPDATE_STANZA:"poll_update_message_stanza_invalid",INVALID_REACTION_STANZA:"reaction_message_stanza_invalid",INVALID_PIN_IN_CHAT_STANZA:"pin_in_chat_message_stanza_invalid",INVALID_COMMENT_STANZA:"comment_message_stanza_invalid",INVALID_EVENT_RESPONSE_STANZA:"event_response_message_stanza_invalid",INVALID_EVENT_EDIT_STANZA:"event_edit_message_stanza_invalid",INVALID_EDIT_STANZA:"edit_message_stanza_invalid",INVALID_NEWSLETTER_EDIT_STANZA:"newsletter_edit_stanza_invalid"});var i=function(a){function b(b){b=a.call(this,b,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_TYPE_MISMATCH)||this;b.name="MessageProtobufMismatchError";return b}babelHelpers.inheritsLoose(b,a);return b}(f),j=function(a){function b(b){b=a.call(this,"Received "+b.length+" message keys: "+b.join(", "),d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_NUMBER_OF_MESSAGE_TYPES)||this;b.name="MessageProtobufInvalidMessageTypes";return b}babelHelpers.inheritsLoose(b,a);return b}(f);g.DeviceSentMessageError=c;g.UnknownDeviceMessageError=e;g.MessageValidationError=f;g.MessageSentAckError=h;g.BizNodeValidationError=a;g.MessageProtobufMismatchErrorCode=b;g.MessageProtobufMismatchError=i;g.MessageProtobufInvalidMessageTypes=j}),98);
__d("WAWebWamEnumMessageSecretAllowedType",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE_POLL:0,MESSAGE_EDIT:1,REACTION:2,COMMENT:3,EVENT_RESPONSE:4,MESSAGE_EVENT_EDIT:5,MESSAGE_REPORTING_TOKEN:6});f.MESSAGE_SECRET_ALLOWED_TYPE=a}),66);
__d("WAWebWamEnumMessageSecretErrorType",[],(function(a,b,c,d,e,f){a=Object.freeze({MISSING_MESSAGE_SECRET:0,WRONG_LENGTH:1,ENCRYPTION_ERROR:2,DECRYPTION_ERROR:3});f.MESSAGE_SECRET_ERROR_TYPE=a}),66);
__d("WAWebMessageSecretErrorsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MessageSecretErrors:[3686,{messageMediaType:[3,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageSecretAllowedList:[1,d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE],messageSecretError:[2,d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE]},[1,1,1],"regular"]},{MessageSecretErrors:[]});g.MessageSecretErrorsWamEvent=a}),98);
__d("WAWebAddonEncryptionError",["$InternalEnum","WALogger","WAWebAddonInfraError","WAWebHandleMsgError","WAWebMessageSecretErrorsWamEvent","WAWebMsgType","WAWebWamEnumE2eFailureReason","WAWebWamEnumMediaType","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType"],(function(a,b,c,d,e,f,g){var h,i,j,k=b("$InternalEnum")({MISSING_MESSAGE_SECRET:"missing_message_secret",WRONG_MESSAGE_SECRET_LENGTH:"wrong_message_secret_length",ENCRYPTION_ERROR:"encryption_error",DECRYPTION_ERROR:"decryption_error"}),l=function(a){function b(b,c){var d="addonType: "+b+", errorCode: "+String(c);d=a.call(this,d,q(c))||this;d.name="DualEncryptionValidationError";m(b,c);return d}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);a=function(a,b){var c=b.messageSecret;if(c==null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parent msg "," secret is missing"])),b.id);throw new l(a,k.MISSING_MESSAGE_SECRET)}if(c.length!==32){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parent msg "," secret is not 32 bytes"])),b.id);throw new l(a,k.WRONG_MESSAGE_SECRET_LENGTH)}return c};function m(a,b){var c=n(a),e=o(a);if(c==null||e==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[DualEncryptionValidationError] missing media type and allowed list value for ",""])),a).sendLogs("dual-encryption-validation-error");throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)}new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretError:p(b),messageMediaType:c,messageSecretAllowedList:e}).commit()}function n(a){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_RESPOND;case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return d("WAWebWamEnumMediaType").MEDIA_TYPE.COMMENT;default:return}}function o(a){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL;case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.REACTION;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.EVENT_RESPONSE;case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_EVENT_EDIT;case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.COMMENT;default:return}}function p(a){switch(a){case k.MISSING_MESSAGE_SECRET:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET;case k.WRONG_MESSAGE_SECRET_LENGTH:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.WRONG_LENGTH;case k.ENCRYPTION_ERROR:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.ENCRYPTION_ERROR;case k.DECRYPTION_ERROR:return d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.DECRYPTION_ERROR}}function q(a){switch(a){case k.MISSING_MESSAGE_SECRET:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET;case k.WRONG_MESSAGE_SECRET_LENGTH:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID;case k.ENCRYPTION_ERROR:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE;case k.DECRYPTION_ERROR:return d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.DECRYPTION_FAILED}}g.DualEncryptionValidationErrorCode=k;g.DualEncryptionValidationError=l;g.getValidatedMessageSecret=a}),98);
__d("WAWebProtobufsProtocol.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({UNKNOWN:0,CHAT_SETTING:1,BIZ_SUPPORTS_FB_HOSTING:2,UNKNOWN_GROUP:3});c={};e={};c.name="MessageKey";c.internalSpec={remoteJid:[1,(f=d("WAProtoConst")).TYPES.STRING],fromMe:[2,f.TYPES.BOOL],id:[3,f.TYPES.STRING],participant:[4,f.TYPES.STRING]};e.internalDefaults={trigger:a.UNKNOWN};e.name="LimitSharing";e.internalSpec={sharingLimited:[1,f.TYPES.BOOL],trigger:[2,f.TYPES.ENUM,a],limitSharingSettingTimestamp:[3,f.TYPES.INT64],initiatedByMe:[4,f.TYPES.BOOL]};g.LimitSharing$Trigger=a;g.MessageKeySpec=c;g.LimitSharingSpec=e}),98);
__d("WAWebProtobufsAICommon.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsProtocol.pb"],(function(a,b,c,d,aa,ba,e){var f;c=(a=b("$InternalEnum"))({UNKNOWN_PLUGIN:0,REELS:1,SEARCH:2});aa=a({UNKNOWN:0,BING:1,GOOGLE:2,SUPPORT:3});ba=a({BOT_LINKED_ACCOUNT_TYPE_1P:0});b=a({UNSPECIFIED:0,WA_BOT_MSG:1});var ca=a({UNKNOWN_TYPE:0,C50:1,SURVEY_PLATFORM:2}),da=a({UNDEFINED_ENTRY_POINT:0,FAVICON:1,CHATLIST:2,AISEARCH_NULL_STATE_PAPER_PLANE:3,AISEARCH_NULL_STATE_SUGGESTION:4,AISEARCH_TYPE_AHEAD_SUGGESTION:5,AISEARCH_TYPE_AHEAD_PAPER_PLANE:6,AISEARCH_TYPE_AHEAD_RESULT_CHATLIST:7,AISEARCH_TYPE_AHEAD_RESULT_MESSAGES:8,AIVOICE_SEARCH_BAR:9,AIVOICE_FAVICON:10,AISTUDIO:11,DEEPLINK:12,NOTIFICATION:13,PROFILE_MESSAGE_BUTTON:14,FORWARD:15,APP_SHORTCUT:16,FF_FAMILY:17,AI_TAB:18,AI_HOME:19,AI_DEEPLINK_IMMERSIVE:20,AI_DEEPLINK:21,META_AI_CHAT_SHORTCUT_AI_STUDIO:22,UGC_CHAT_SHORTCUT_AI_STUDIO:23,NEW_CHAT_AI_STUDIO:24,AIVOICE_FAVICON_CALL_HISTORY:25,ASK_META_AI_CONTEXT_MENU:26,ASK_META_AI_CONTEXT_MENU_1ON1:27,ASK_META_AI_CONTEXT_MENU_GROUP:28,INVOKE_META_AI_1ON1:29,INVOKE_META_AI_GROUP:30,META_AI_FORWARD:31,NEW_CHAT_AI_CONTACT:32,MESSAGE_QUICK_ACTION_1_ON_1_CHAT:33,MESSAGE_QUICK_ACTION_GROUP_CHAT:34,ATTACHMENT_TRAY_1_ON_1_CHAT:35,ATTACHMENT_TRAY_GROUP_CHAT:36}),ea=a({AI_TAB_THREAD:1,AI_HOME_THREAD:2,AI_DEEPLINK_IMMERSIVE_THREAD:3,AI_DEEPLINK_THREAD:4,ASK_META_AI_CONTEXT_MENU_THREAD:5}),fa=a({NONE:0,NULL_STATE:1,TYPEAHEAD:2,USER_INPUT:3,EMU_FLASH:4,EMU_FLASH_FOLLOWUP:5,VOICE:6}),ga=a({CENTER:1,LEFT:2,RIGHT:3}),ha=a({ONCE:1,DAILY:2,WEEKLY:3,BIWEEKLY:4,MONTHLY:5}),ia=a({NOTIFY:1,CREATE:2,DELETE:3,UPDATE:4}),ja=a({UNKNOWN_STATUS:0,AVAILABLE:1,QUOTA_EXCEED_LIMIT:2}),ka=a({UNKNOWN_TYPE:0,LLAMA_PROD:1,LLAMA_PROD_PREMIUM:2}),la=a({UNKNOWN:0,OTHER:1,GOOGLE:2,BING:3}),ma=a({UNKNOWN_PROVIDER:0,OTHER:1,GOOGLE:2,BING:3}),na=a({UNKNOWN:0,PLANNED:1,EXECUTING:2,FINISHED:3}),oa=a({UNKNOWN:0,PROGRESS_INDICATOR:1,RICH_RESPONSE_HEADING:2,RICH_RESPONSE_NESTED_LIST:3,AI_MEMORY:4,RICH_RESPONSE_THREAD_SURFING:5,RICH_RESPONSE_TABLE:6,RICH_RESPONSE_CODE:7,RICH_RESPONSE_STRUCTURED_RESPONSE:8,RICH_RESPONSE_INLINE_IMAGE:9,WA_IG_1P_PLUGIN_RANKING_CONTROL:10,WA_IG_1P_PLUGIN_RANKING_UPDATE_1:11,WA_IG_1P_PLUGIN_RANKING_UPDATE_2:12,WA_IG_1P_PLUGIN_RANKING_UPDATE_3:13,WA_IG_1P_PLUGIN_RANKING_UPDATE_4:14,WA_IG_1P_PLUGIN_RANKING_UPDATE_5:15,WA_IG_1P_PLUGIN_RANKING_UPDATE_6:16,WA_IG_1P_PLUGIN_RANKING_UPDATE_7:17,WA_IG_1P_PLUGIN_RANKING_UPDATE_8:18,WA_IG_1P_PLUGIN_RANKING_UPDATE_9:19,WA_IG_1P_PLUGIN_RANKING_UPDATE_10:20,RICH_RESPONSE_SUB_HEADING:21,RICH_RESPONSE_GRID_IMAGE:22,AI_STUDIO_UGC_MEMORY:23,RICH_RESPONSE_LATEX:24,RICH_RESPONSE_MAPS:25,RICH_RESPONSE_INLINE_REELS:26,AGENTIC_PLANNING:27,ACCOUNT_LINKING:28,STREAMING_DISAGGREGATION:29,RICH_RESPONSE_GRID_IMAGE_3P:30,RICH_RESPONSE_LATEX_INLINE:31,QUERY_PLAN:32,PROACTIVE_MESSAGE:33,RICH_RESPONSE_UNIFIED_RESPONSE:34,PROMOTION_MESSAGE:35,SIMPLIFIED_PROFILE_PAGE:36,RICH_RESPONSE_SOURCES_IN_MESSAGE:37,RICH_RESPONSE_SIDE_BY_SIDE_SURVEY:38,RICH_RESPONSE_UNIFIED_TEXT_COMPONENT:39,AI_SHARED_MEMORY:40,RICH_RESPONSE_UNIFIED_SOURCES:41,RICH_RESPONSE_UNIFIED_DOMAIN_CITATIONS:42,RICH_RESPONSE_UR_INLINE_REELS_ENABLED:43,RICH_RESPONSE_UR_MEDIA_GRID_ENABLED:44,RICH_RESPONSE_UR_TIMESTAMP_PLACEHOLDER:45,RICH_RESPONSE_IN_APP_SURVEY:46,AI_RESPONSE_MODEL_BRANDING:47}),pa=a({UNKNOWN_MODE:0,REASONING_MODE:1}),qa=a({UNKNOWN_FEATURE:0,REASONING_FEATURE:1}),ra=a({UNKNOWN:0,IMAGINE:1,MEMU:2,FLASH:3,EDIT:4}),sa=a({O18_BINARY:0,WAFFLE:1}),ta=a({UNKNOWN:0,BING:1,GOOGLE:2,SUPPORT:3,OTHER:4}),ua=a({BOT_MESSAGE_ORIGIN_TYPE_AI_INITIATED:0}),va=a({UNKNOWN:0,DEFAULT:1,INCOGNITO:2}),wa=a({NONE:0,GENERIC:1}),xa=a({BOT_FEEDBACK_MULTIPLE_POSITIVE_GENERIC:1}),ya=a({BOT_FEEDBACK_MULTIPLE_NEGATIVE_GENERIC:1,BOT_FEEDBACK_MULTIPLE_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_MULTIPLE_NEGATIVE_INTERESTING:4,BOT_FEEDBACK_MULTIPLE_NEGATIVE_ACCURATE:8,BOT_FEEDBACK_MULTIPLE_NEGATIVE_SAFE:16,BOT_FEEDBACK_MULTIPLE_NEGATIVE_OTHER:32,BOT_FEEDBACK_MULTIPLE_NEGATIVE_REFUSED:64,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_VISUALLY_APPEALING:128,BOT_FEEDBACK_MULTIPLE_NEGATIVE_NOT_RELEVANT_TO_TEXT:256}),za=a({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9,BOT_FEEDBACK_NEGATIVE_PERSONALIZED:10,BOT_FEEDBACK_NEGATIVE_CLARITY:11,BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON:12,BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY:13,BOT_FEEDBACK_NEGATIVE:14}),Aa=a({AI_RICH_RESPONSE_TYPE_UNKNOWN:0,AI_RICH_RESPONSE_TYPE_STANDARD:1}),Ba=a({AI_RICH_RESPONSE_UNKNOWN:0,AI_RICH_RESPONSE_GRID_IMAGE:1,AI_RICH_RESPONSE_TEXT:2,AI_RICH_RESPONSE_INLINE_IMAGE:3,AI_RICH_RESPONSE_TABLE:4,AI_RICH_RESPONSE_CODE:5,AI_RICH_RESPONSE_DYNAMIC:6,AI_RICH_RESPONSE_MAP:7,AI_RICH_RESPONSE_LATEX:8,AI_RICH_RESPONSE_CONTENT_ITEMS:9}),Ca=a({AI_RICH_RESPONSE_IMAGE_LAYOUT_LEADING_ALIGNED:0,AI_RICH_RESPONSE_IMAGE_LAYOUT_TRAILING_ALIGNED:1,AI_RICH_RESPONSE_IMAGE_LAYOUT_CENTER_ALIGNED:2}),Da=a({AI_RICH_RESPONSE_CODE_HIGHLIGHT_DEFAULT:0,AI_RICH_RESPONSE_CODE_HIGHLIGHT_KEYWORD:1,AI_RICH_RESPONSE_CODE_HIGHLIGHT_METHOD:2,AI_RICH_RESPONSE_CODE_HIGHLIGHT_STRING:3,AI_RICH_RESPONSE_CODE_HIGHLIGHT_NUMBER:4,AI_RICH_RESPONSE_CODE_HIGHLIGHT_COMMENT:5}),Ea=a({AI_RICH_RESPONSE_DYNAMIC_METADATA_TYPE_UNKNOWN:0,AI_RICH_RESPONSE_DYNAMIC_METADATA_TYPE_IMAGE:1,AI_RICH_RESPONSE_DYNAMIC_METADATA_TYPE_GIF:2});a=a({DEFAULT:0,CAROUSEL:1});var g={},h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Fa={},Ga={},Z={},Ha={},Ia={},Ja={},Ka={},La={},Ma={},Na={},Oa={},Pa={},$={},Qa={},Ra={},Sa={},Ta={},Ua={},Va={},Wa={},Xa={},Ya={},Za={},$a={},ab={},bb={},cb={},db={},eb={};g.name="BotAvatarMetadata";g.internalSpec={sentiment:[1,(f=d("WAProtoConst")).TYPES.UINT32],behaviorGraph:[2,f.TYPES.STRING],action:[3,f.TYPES.UINT32],intensity:[4,f.TYPES.UINT32],wordCount:[5,f.TYPES.UINT32]};h.name="BotPluginMetadata";h.internalSpec={provider:[1,f.TYPES.ENUM,aa],pluginType:[2,f.TYPES.ENUM,c],thumbnailCdnUrl:[3,f.TYPES.STRING],profilePhotoCdnUrl:[4,f.TYPES.STRING],searchProviderUrl:[5,f.TYPES.STRING],referenceIndex:[6,f.TYPES.UINT32],expectedLinksCount:[7,f.TYPES.UINT32],searchQuery:[9,f.TYPES.STRING],parentPluginMessageKey:[10,f.TYPES.MESSAGE,d("WAWebProtobufsProtocol.pb").MessageKeySpec],deprecatedField:[11,f.TYPES.ENUM,c],parentPluginType:[12,f.TYPES.ENUM,c],faviconCdnUrl:[13,f.TYPES.STRING]};i.name="BotSuggestedPromptMetadata";i.internalSpec={suggestedPrompts:[1,f.FLAGS.REPEATED|f.TYPES.STRING],selectedPromptIndex:[2,f.TYPES.UINT32],promptSuggestions:[3,f.TYPES.MESSAGE,j],selectedPromptId:[4,f.TYPES.STRING]};j.name="BotPromptSuggestions";j.internalSpec={suggestions:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,k]};k.name="BotPromptSuggestion";k.internalSpec={prompt:[1,f.TYPES.STRING],promptId:[2,f.TYPES.STRING]};l.name="BotLinkedAccountsMetadata";l.internalSpec={accounts:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,m],acAuthTokens:[2,f.TYPES.BYTES],acErrorCode:[3,f.TYPES.INT32]};m.name="BotLinkedAccount";m.internalSpec={type:[1,f.TYPES.ENUM,ba]};n.name="BotMemoryMetadata";n.internalSpec={addedFacts:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,o],removedFacts:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,o],disclaimer:[3,f.TYPES.STRING]};o.name="BotMemoryFact";o.internalSpec={fact:[1,f.TYPES.STRING],factId:[2,f.TYPES.STRING]};p.name="BotSignatureVerificationMetadata";p.internalSpec={proofs:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,q]};q.name="BotSignatureVerificationUseCaseProof";q.internalSpec={version:[1,f.TYPES.INT32],useCase:[2,f.TYPES.ENUM,b],signature:[3,f.TYPES.BYTES],certificateChain:[4,f.FLAGS.REPEATED|f.TYPES.BYTES]};r.name="BotPromotionMessageMetadata";r.internalSpec={promotionType:[1,f.TYPES.ENUM,ca],buttonTitle:[2,f.TYPES.STRING]};s.name="BotRenderingMetadata";s.internalSpec={keywords:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,t]};t.name="BotRenderingMetadata$Keyword";t.internalSpec={value:[1,f.TYPES.STRING],associatedPrompts:[2,f.FLAGS.REPEATED|f.TYPES.STRING]};u.name="BotMetricsMetadata";u.internalSpec={destinationId:[1,f.TYPES.STRING],destinationEntryPoint:[2,f.TYPES.ENUM,da],threadOrigin:[3,f.TYPES.ENUM,ea]};v.name="BotSessionMetadata";v.internalSpec={sessionId:[1,f.TYPES.STRING],sessionSource:[2,f.TYPES.ENUM,fa]};w.name="BotMediaMetadata";w.internalSpec={fileSha256:[1,f.TYPES.STRING],mediaKey:[2,f.TYPES.STRING],fileEncSha256:[3,f.TYPES.STRING],directPath:[4,f.TYPES.STRING],mediaKeyTimestamp:[5,f.TYPES.INT64],mimetype:[6,f.TYPES.STRING],orientationType:[7,f.TYPES.ENUM,ga]};x.name="BotMemuMetadata";x.internalSpec={faceImages:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,w]};y.name="BotReminderMetadata";y.internalSpec={requestMessageKey:[1,f.TYPES.MESSAGE,d("WAWebProtobufsProtocol.pb").MessageKeySpec],action:[2,f.TYPES.ENUM,ia],name:[3,f.TYPES.STRING],nextTriggerTimestamp:[4,f.TYPES.UINT64],frequency:[5,f.TYPES.ENUM,ha]};z.name="BotModelMetadata";z.internalSpec={modelType:[1,f.TYPES.ENUM,ka],premiumModelStatus:[2,f.TYPES.ENUM,ja],modelNameOverride:[3,f.TYPES.STRING]};A.name="BotProgressIndicatorMetadata";A.internalSpec={progressDescription:[1,f.TYPES.STRING],stepsMetadata:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,B]};B.name="BotProgressIndicatorMetadata$BotPlanningStepMetadata";B.internalSpec={statusTitle:[1,f.TYPES.STRING],statusBody:[2,f.TYPES.STRING],sourcesMetadata:[3,f.FLAGS.REPEATED|f.TYPES.MESSAGE,E],status:[4,f.TYPES.ENUM,na],isReasoning:[5,f.TYPES.BOOL],isEnhancedSearch:[6,f.TYPES.BOOL],sections:[7,f.FLAGS.REPEATED|f.TYPES.MESSAGE,C]};C.name="BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningStepSectionMetadata";C.internalSpec={sectionTitle:[1,f.TYPES.STRING],sectionBody:[2,f.TYPES.STRING],sourcesMetadata:[3,f.FLAGS.REPEATED|f.TYPES.MESSAGE,D]};D.name="BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningSearchSourceMetadata";D.internalSpec={title:[1,f.TYPES.STRING],provider:[2,f.TYPES.ENUM,ma],sourceUrl:[3,f.TYPES.STRING],favIconUrl:[4,f.TYPES.STRING]};E.name="BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningSearchSourcesMetadata";E.internalSpec={sourceTitle:[1,f.TYPES.STRING],provider:[2,f.TYPES.ENUM,la],sourceUrl:[3,f.TYPES.STRING]};F.name="BotCapabilityMetadata";F.internalSpec={capabilities:[1,f.FLAGS.REPEATED|f.TYPES.ENUM,oa]};G.name="BotModeSelectionMetadata";G.internalSpec={mode:[1,f.FLAGS.REPEATED|f.TYPES.ENUM,pa]};H.name="BotQuotaMetadata";H.internalSpec={botFeatureQuotaMetadata:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,I]};I.name="BotQuotaMetadata$BotFeatureQuotaMetadata";I.internalSpec={featureType:[1,f.TYPES.ENUM,qa],remainingQuota:[2,f.TYPES.UINT32],expirationTimestamp:[3,f.TYPES.UINT64]};J.name="BotImagineMetadata";J.internalSpec={imagineType:[1,f.TYPES.ENUM,ra]};K.name="BotAgeCollectionMetadata";K.internalSpec={ageCollectionEligible:[1,f.TYPES.BOOL],shouldTriggerAgeCollectionOnClient:[2,f.TYPES.BOOL],ageCollectionType:[3,f.TYPES.ENUM,sa]};L.name="BotSourcesMetadata";L.internalSpec={sources:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,M]};M.name="BotSourcesMetadata$BotSourceItem";M.internalSpec={provider:[1,f.TYPES.ENUM,ta],thumbnailCdnUrl:[2,f.TYPES.STRING],sourceProviderUrl:[3,f.TYPES.STRING],sourceQuery:[4,f.TYPES.STRING],faviconCdnUrl:[5,f.TYPES.STRING],citationNumber:[6,f.TYPES.UINT32],sourceTitle:[7,f.TYPES.STRING]};N.name="InThreadSurveyMetadata";N.internalSpec={tessaSessionId:[1,f.TYPES.STRING],simonSessionId:[2,f.TYPES.STRING],simonSurveyId:[3,f.TYPES.STRING],tessaRootId:[4,f.TYPES.STRING],requestId:[5,f.TYPES.STRING],tessaEvent:[6,f.TYPES.STRING],invitationHeaderText:[7,f.TYPES.STRING],invitationBodyText:[8,f.TYPES.STRING],invitationCtaText:[9,f.TYPES.STRING],invitationCtaUrl:[10,f.TYPES.STRING],surveyTitle:[11,f.TYPES.STRING],questions:[12,f.FLAGS.REPEATED|f.TYPES.MESSAGE,Q],surveyContinueButtonText:[13,f.TYPES.STRING],surveySubmitButtonText:[14,f.TYPES.STRING],privacyStatementFull:[15,f.TYPES.STRING],privacyStatementParts:[16,f.FLAGS.REPEATED|f.TYPES.MESSAGE,O],feedbackToastText:[17,f.TYPES.STRING]};O.name="InThreadSurveyMetadata$InThreadSurveyPrivacyStatementPart";O.internalSpec={text:[1,f.TYPES.STRING],url:[2,f.TYPES.STRING]};P.name="InThreadSurveyMetadata$InThreadSurveyOption";P.internalSpec={stringValue:[1,f.TYPES.STRING],numericValue:[2,f.TYPES.UINT32],textTranslated:[3,f.TYPES.STRING]};Q.name="InThreadSurveyMetadata$InThreadSurveyQuestion";Q.internalSpec={questionText:[1,f.TYPES.STRING],questionId:[2,f.TYPES.STRING],questionOptions:[3,f.FLAGS.REPEATED|f.TYPES.MESSAGE,P]};R.name="BotMessageOriginMetadata";R.internalSpec={origins:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,S]};S.name="BotMessageOrigin";S.internalSpec={type:[1,f.TYPES.ENUM,ua]};T.name="BotUnifiedResponseMutation";T.internalSpec={sbsMetadata:[1,f.TYPES.MESSAGE,V],mediaDetailsMetadataList:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,U]};U.name="BotUnifiedResponseMutation$MediaDetailsMetadata";U.internalSpec={id:[1,f.TYPES.STRING],highResMedia:[2,f.TYPES.MESSAGE,w],previewMedia:[3,f.TYPES.MESSAGE,w]};V.name="BotUnifiedResponseMutation$SideBySideMetadata";V.internalSpec={primaryResponseId:[1,f.TYPES.STRING]};W.name="AIThreadInfo";W.internalSpec={serverInfo:[1,f.TYPES.MESSAGE,Y],clientInfo:[2,f.TYPES.MESSAGE,X]};X.name="AIThreadInfo$AIThreadClientInfo";X.internalSpec={type:[1,f.TYPES.ENUM,va]};Y.name="AIThreadInfo$AIThreadServerInfo";Y.internalSpec={title:[1,f.TYPES.STRING]};Fa.name="BotMetadata";Fa.internalSpec={avatarMetadata:[1,f.TYPES.MESSAGE,g],personaId:[2,f.TYPES.STRING],pluginMetadata:[3,f.TYPES.MESSAGE,h],suggestedPromptMetadata:[4,f.TYPES.MESSAGE,i],invokerJid:[5,f.TYPES.STRING],sessionMetadata:[6,f.TYPES.MESSAGE,v],memuMetadata:[7,f.TYPES.MESSAGE,x],timezone:[8,f.TYPES.STRING],reminderMetadata:[9,f.TYPES.MESSAGE,y],modelMetadata:[10,f.TYPES.MESSAGE,z],messageDisclaimerText:[11,f.TYPES.STRING],progressIndicatorMetadata:[12,f.TYPES.MESSAGE,A],capabilityMetadata:[13,f.TYPES.MESSAGE,F],imagineMetadata:[14,f.TYPES.MESSAGE,J],memoryMetadata:[15,f.TYPES.MESSAGE,n],renderingMetadata:[16,f.TYPES.MESSAGE,s],botMetricsMetadata:[17,f.TYPES.MESSAGE,u],botLinkedAccountsMetadata:[18,f.TYPES.MESSAGE,l],richResponseSourcesMetadata:[19,f.TYPES.MESSAGE,L],aiConversationContext:[20,f.TYPES.BYTES],botPromotionMessageMetadata:[21,f.TYPES.MESSAGE,r],botModeSelectionMetadata:[22,f.TYPES.MESSAGE,G],botQuotaMetadata:[23,f.TYPES.MESSAGE,H],botAgeCollectionMetadata:[24,f.TYPES.MESSAGE,K],conversationStarterPromptId:[25,f.TYPES.STRING],botResponseId:[26,f.TYPES.STRING],verificationMetadata:[27,f.TYPES.MESSAGE,p],unifiedResponseMutation:[28,f.TYPES.MESSAGE,T],botMessageOriginMetadata:[29,f.TYPES.MESSAGE,R],inThreadSurveyMetadata:[30,f.TYPES.MESSAGE,N],botThreadInfo:[31,f.TYPES.MESSAGE,W],internalMetadata:[999,f.TYPES.BYTES]};Ga.name="BotFeedbackMessage";Ga.internalSpec={messageKey:[1,f.TYPES.MESSAGE,d("WAWebProtobufsProtocol.pb").MessageKeySpec],kind:[2,f.TYPES.ENUM,za],text:[3,f.TYPES.STRING],kindNegative:[4,f.TYPES.UINT64],kindPositive:[5,f.TYPES.UINT64],kindReport:[6,f.TYPES.ENUM,wa],sideBySideSurveyMetadata:[7,f.TYPES.MESSAGE,Z]};Z.name="BotFeedbackMessage$SideBySideSurveyMetadata";Z.internalSpec={selectedRequestId:[1,f.TYPES.STRING],surveyId:[2,f.TYPES.UINT32],simonSessionFbid:[3,f.TYPES.STRING],responseOtid:[4,f.TYPES.STRING],responseTimestampMsString:[5,f.TYPES.STRING],isSelectedResponsePrimary:[6,f.TYPES.BOOL],messageIdToEdit:[7,f.TYPES.STRING],analyticsData:[8,f.TYPES.MESSAGE,Na],metaAiAnalyticsData:[9,f.TYPES.MESSAGE,Ha]};Ha.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData";Ha.internalSpec={surveyId:[1,f.TYPES.UINT32],primaryResponseId:[2,f.TYPES.STRING],testArmName:[3,f.TYPES.STRING],timestampMsString:[4,f.TYPES.STRING],ctaImpressionEvent:[5,f.TYPES.MESSAGE,Ma],ctaClickEvent:[6,f.TYPES.MESSAGE,La],cardImpressionEvent:[7,f.TYPES.MESSAGE,Ka],responseEvent:[8,f.TYPES.MESSAGE,Ja],abandonEvent:[9,f.TYPES.MESSAGE,Ia]};Ia.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyAbandonEventData";Ia.internalSpec={abandonDwellTimeMsString:[1,f.TYPES.STRING]};Ja.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyResponseEventData";Ja.internalSpec={responseDwellTimeMsString:[1,f.TYPES.STRING]};Ka.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCardImpressionEventData";Ka.internalSpec={};La.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCTAClickEventData";La.internalSpec={isSurveyExpired:[1,f.TYPES.BOOL],clickDwellTimeMsString:[2,f.TYPES.STRING]};Ma.name="BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCTAImpressionEventData";Ma.internalSpec={isSurveyExpired:[1,f.TYPES.BOOL]};Na.name="BotFeedbackMessage$SideBySideSurveyMetadata$SideBySideSurveyAnalyticsData";Na.internalSpec={tessaEvent:[1,f.TYPES.STRING],tessaSessionFbid:[2,f.TYPES.STRING]};Oa.name="ForwardedAIBotMessageInfo";Oa.internalSpec={botName:[1,f.TYPES.STRING],botJid:[2,f.TYPES.STRING],creatorName:[3,f.TYPES.STRING]};Pa.name="BotMessageSharingInfo";Pa.internalSpec={botEntryPointOrigin:[1,f.TYPES.ENUM,da],forwardScore:[2,f.TYPES.UINT32]};$.name="AIRichResponseImageURL";$.internalSpec={imagePreviewUrl:[1,f.TYPES.STRING],imageHighResUrl:[2,f.TYPES.STRING],sourceUrl:[3,f.TYPES.STRING]};Qa.name="AIRichResponseGridImageMetadata";Qa.internalSpec={gridImageUrl:[1,f.TYPES.MESSAGE,$],imageUrls:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,$]};Ra.name="AIRichResponseInlineImageMetadata";Ra.internalSpec={imageUrl:[1,f.TYPES.MESSAGE,$],imageText:[2,f.TYPES.STRING],alignment:[3,f.TYPES.ENUM,Ca],tapLinkUrl:[4,f.TYPES.STRING]};Sa.name="AIRichResponseCodeMetadata";Sa.internalSpec={codeLanguage:[1,f.TYPES.STRING],codeBlocks:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,Ta]};Ta.name="AIRichResponseCodeMetadata$AIRichResponseCodeBlock";Ta.internalSpec={highlightType:[1,f.TYPES.ENUM,Da],codeContent:[2,f.TYPES.STRING]};Ua.name="AIRichResponseTableMetadata";Ua.internalSpec={rows:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,Va],title:[2,f.TYPES.STRING]};Va.name="AIRichResponseTableMetadata$AIRichResponseTableRow";Va.internalSpec={items:[1,f.FLAGS.REPEATED|f.TYPES.STRING],isHeading:[2,f.TYPES.BOOL]};Wa.name="AIRichResponseDynamicMetadata";Wa.internalSpec={type:[1,f.TYPES.ENUM,Ea],version:[2,f.TYPES.UINT64],url:[3,f.TYPES.STRING],loopCount:[4,f.TYPES.UINT32]};Xa.name="AIRichResponseUnifiedResponse";Xa.internalSpec={data:[1,f.TYPES.BYTES]};Ya.name="AIRichResponseLatexMetadata";Ya.internalSpec={text:[1,f.TYPES.STRING],expressions:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,Za]};Za.name="AIRichResponseLatexMetadata$AIRichResponseLatexExpression";Za.internalSpec={latexExpression:[1,f.TYPES.STRING],url:[2,f.TYPES.STRING],width:[3,f.TYPES.DOUBLE],height:[4,f.TYPES.DOUBLE],fontHeight:[5,f.TYPES.DOUBLE],imageTopPadding:[6,f.TYPES.DOUBLE],imageLeadingPadding:[7,f.TYPES.DOUBLE],imageBottomPadding:[8,f.TYPES.DOUBLE],imageTrailingPadding:[9,f.TYPES.DOUBLE]};$a.name="AIRichResponseMapMetadata";$a.internalSpec={centerLatitude:[1,f.TYPES.DOUBLE],centerLongitude:[2,f.TYPES.DOUBLE],latitudeDelta:[3,f.TYPES.DOUBLE],longitudeDelta:[4,f.TYPES.DOUBLE],annotations:[5,f.FLAGS.REPEATED|f.TYPES.MESSAGE,ab],showInfoList:[6,f.TYPES.BOOL]};ab.name="AIRichResponseMapMetadata$AIRichResponseMapAnnotation";ab.internalSpec={annotationNumber:[1,f.TYPES.UINT32],latitude:[2,f.TYPES.DOUBLE],longitude:[3,f.TYPES.DOUBLE],title:[4,f.TYPES.STRING],body:[5,f.TYPES.STRING]};bb.name="AIRichResponseContentItemsMetadata";bb.internalSpec={itemsMetadata:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,cb],contentType:[2,f.TYPES.ENUM,a]};cb.name="AIRichResponseContentItemsMetadata$AIRichResponseContentItemMetadata";cb.internalSpec={reelItem:[1,f.TYPES.MESSAGE,db],__oneofs__:{aIRichResponseContentItem:["reelItem"]}};db.name="AIRichResponseContentItemsMetadata$AIRichResponseReelItem";db.internalSpec={title:[1,f.TYPES.STRING],profileIconUrl:[2,f.TYPES.STRING],thumbnailUrl:[3,f.TYPES.STRING],videoUrl:[4,f.TYPES.STRING]};eb.name="AIRichResponseSubMessage";eb.internalSpec={messageType:[1,f.TYPES.ENUM,Ba],gridImageMetadata:[2,f.TYPES.MESSAGE,Qa],messageText:[3,f.TYPES.STRING],imageMetadata:[4,f.TYPES.MESSAGE,Ra],codeMetadata:[5,f.TYPES.MESSAGE,Sa],tableMetadata:[6,f.TYPES.MESSAGE,Ua],dynamicMetadata:[7,f.TYPES.MESSAGE,Wa],latexMetadata:[8,f.TYPES.MESSAGE,Ya],mapMetadata:[9,f.TYPES.MESSAGE,$a],contentItemsMetadata:[10,f.TYPES.MESSAGE,bb]};e.BotPluginMetadata$PluginType=c;e.BotPluginMetadata$SearchProvider=aa;e.BotLinkedAccount$BotLinkedAccountType=ba;e.BotSignatureVerificationUseCaseProof$BotSignatureUseCase=b;e.BotPromotionMessageMetadata$BotPromotionType=ca;e.BotMetricsEntryPoint=da;e.BotMetricsThreadEntryPoint=ea;e.BotSessionSource=fa;e.BotMediaMetadata$OrientationType=ga;e.BotReminderMetadata$ReminderFrequency=ha;e.BotReminderMetadata$ReminderAction=ia;e.BotModelMetadata$PremiumModelStatus=ja;e.BotModelMetadata$ModelType=ka;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningSearchSourcesMetadata$BotPlanningSearchSourceProvider=la;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotSearchSourceProvider=ma;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$PlanningStepStatus=na;e.BotCapabilityMetadata$BotCapabilityType=oa;e.BotModeSelectionMetadata$BotUserSelectionMode=pa;e.BotQuotaMetadata$BotFeatureQuotaMetadata$BotFeatureType=qa;e.BotImagineMetadata$ImagineType=ra;e.BotAgeCollectionMetadata$AgeCollectionType=sa;e.BotSourcesMetadata$BotSourceItem$SourceProvider=ta;e.BotMessageOrigin$BotMessageOriginType=ua;e.AIThreadInfo$AIThreadClientInfo$AIThreadType=va;e.BotFeedbackMessage$ReportKind=wa;e.BotFeedbackMessage$BotFeedbackKindMultiplePositive=xa;e.BotFeedbackMessage$BotFeedbackKindMultipleNegative=ya;e.BotFeedbackMessage$BotFeedbackKind=za;e.AIRichResponseMessageType=Aa;e.AIRichResponseSubMessageType=Ba;e.AIRichResponseInlineImageMetadata$AIRichResponseImageAlignment=Ca;e.AIRichResponseCodeMetadata$AIRichResponseCodeHighlightType=Da;e.AIRichResponseDynamicMetadata$AIRichResponseDynamicMetadataType=Ea;e.AIRichResponseContentItemsMetadata$ContentType=a;e.BotAvatarMetadataSpec=g;e.BotPluginMetadataSpec=h;e.BotSuggestedPromptMetadataSpec=i;e.BotPromptSuggestionsSpec=j;e.BotPromptSuggestionSpec=k;e.BotLinkedAccountsMetadataSpec=l;e.BotLinkedAccountSpec=m;e.BotMemoryMetadataSpec=n;e.BotMemoryFactSpec=o;e.BotSignatureVerificationMetadataSpec=p;e.BotSignatureVerificationUseCaseProofSpec=q;e.BotPromotionMessageMetadataSpec=r;e.BotRenderingMetadataSpec=s;e.BotRenderingMetadata$KeywordSpec=t;e.BotMetricsMetadataSpec=u;e.BotSessionMetadataSpec=v;e.BotMediaMetadataSpec=w;e.BotMemuMetadataSpec=x;e.BotReminderMetadataSpec=y;e.BotModelMetadataSpec=z;e.BotProgressIndicatorMetadataSpec=A;e.BotProgressIndicatorMetadata$BotPlanningStepMetadataSpec=B;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningStepSectionMetadataSpec=C;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningSearchSourceMetadataSpec=D;e.BotProgressIndicatorMetadata$BotPlanningStepMetadata$BotPlanningSearchSourcesMetadataSpec=E;e.BotCapabilityMetadataSpec=F;e.BotModeSelectionMetadataSpec=G;e.BotQuotaMetadataSpec=H;e.BotQuotaMetadata$BotFeatureQuotaMetadataSpec=I;e.BotImagineMetadataSpec=J;e.BotAgeCollectionMetadataSpec=K;e.BotSourcesMetadataSpec=L;e.BotSourcesMetadata$BotSourceItemSpec=M;e.InThreadSurveyMetadataSpec=N;e.InThreadSurveyMetadata$InThreadSurveyPrivacyStatementPartSpec=O;e.InThreadSurveyMetadata$InThreadSurveyOptionSpec=P;e.InThreadSurveyMetadata$InThreadSurveyQuestionSpec=Q;e.BotMessageOriginMetadataSpec=R;e.BotMessageOriginSpec=S;e.BotUnifiedResponseMutationSpec=T;e.BotUnifiedResponseMutation$MediaDetailsMetadataSpec=U;e.BotUnifiedResponseMutation$SideBySideMetadataSpec=V;e.AIThreadInfoSpec=W;e.AIThreadInfo$AIThreadClientInfoSpec=X;e.AIThreadInfo$AIThreadServerInfoSpec=Y;e.BotMetadataSpec=Fa;e.BotFeedbackMessageSpec=Ga;e.BotFeedbackMessage$SideBySideSurveyMetadataSpec=Z;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsDataSpec=Ha;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyAbandonEventDataSpec=Ia;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyResponseEventDataSpec=Ja;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCardImpressionEventDataSpec=Ka;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCTAClickEventDataSpec=La;e.BotFeedbackMessage$SideBySideSurveyMetadata$SidebySideSurveyMetaAiAnalyticsData$SideBySideSurveyCTAImpressionEventDataSpec=Ma;e.BotFeedbackMessage$SideBySideSurveyMetadata$SideBySideSurveyAnalyticsDataSpec=Na;e.ForwardedAIBotMessageInfoSpec=Oa;e.BotMessageSharingInfoSpec=Pa;e.AIRichResponseImageURLSpec=$;e.AIRichResponseGridImageMetadataSpec=Qa;e.AIRichResponseInlineImageMetadataSpec=Ra;e.AIRichResponseCodeMetadataSpec=Sa;e.AIRichResponseCodeMetadata$AIRichResponseCodeBlockSpec=Ta;e.AIRichResponseTableMetadataSpec=Ua;e.AIRichResponseTableMetadata$AIRichResponseTableRowSpec=Va;e.AIRichResponseDynamicMetadataSpec=Wa;e.AIRichResponseUnifiedResponseSpec=Xa;e.AIRichResponseLatexMetadataSpec=Ya;e.AIRichResponseLatexMetadata$AIRichResponseLatexExpressionSpec=Za;e.AIRichResponseMapMetadataSpec=$a;e.AIRichResponseMapMetadata$AIRichResponseMapAnnotationSpec=ab;e.AIRichResponseContentItemsMetadataSpec=bb;e.AIRichResponseContentItemsMetadata$AIRichResponseContentItemMetadataSpec=cb;e.AIRichResponseContentItemsMetadata$AIRichResponseReelItemSpec=db;e.AIRichResponseSubMessageSpec=eb}),98);
__d("WAWebProtobufsCompanionReg.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({UNKNOWN:0,CHROME:1,FIREFOX:2,IE:3,OPERA:4,SAFARI:5,EDGE:6,DESKTOP:7,IPAD:8,ANDROID_TABLET:9,OHANA:10,ALOHA:11,CATALINA:12,TCL_TV:13,IOS_PHONE:14,IOS_CATALYST:15,ANDROID_PHONE:16,ANDROID_AMBIGUOUS:17,WEAR_OS:18,AR_WRIST:19,AR_DEVICE:20,UWP:21,VR:22,CLOUD_API:23,SMARTGLASSES:24});c={};e={};f={};b={};var h={},i={},j={},k={},l={},m={};c.name="DeviceProps";c.internalSpec={os:[1,(d=d("WAProtoConst")).TYPES.STRING],version:[2,d.TYPES.MESSAGE,f],platformType:[3,d.TYPES.ENUM,a],requireFullSync:[4,d.TYPES.BOOL],historySyncConfig:[5,d.TYPES.MESSAGE,e]};e.name="DeviceProps$HistorySyncConfig";e.internalSpec={fullSyncDaysLimit:[1,d.TYPES.UINT32],fullSyncSizeMbLimit:[2,d.TYPES.UINT32],storageQuotaMb:[3,d.TYPES.UINT32],inlineInitialPayloadInE2EeMsg:[4,d.TYPES.BOOL],recentSyncDaysLimit:[5,d.TYPES.UINT32],supportCallLogHistory:[6,d.TYPES.BOOL],supportBotUserAgentChatHistory:[7,d.TYPES.BOOL],supportCagReactionsAndPolls:[8,d.TYPES.BOOL],supportBizHostedMsg:[9,d.TYPES.BOOL],supportRecentSyncChunkMessageCountTuning:[10,d.TYPES.BOOL],supportHostedGroupMsg:[11,d.TYPES.BOOL],supportFbidBotChatHistory:[12,d.TYPES.BOOL],supportAddOnHistorySyncMigration:[13,d.TYPES.BOOL],supportMessageAssociation:[14,d.TYPES.BOOL],supportGroupHistory:[15,d.TYPES.BOOL],onDemandReady:[16,d.TYPES.BOOL],supportGuestChat:[17,d.TYPES.BOOL]};f.name="DeviceProps$AppVersion";f.internalSpec={primary:[1,d.TYPES.UINT32],secondary:[2,d.TYPES.UINT32],tertiary:[3,d.TYPES.UINT32],quaternary:[4,d.TYPES.UINT32],quinary:[5,d.TYPES.UINT32]};b.name="CompanionEphemeralIdentity";b.internalSpec={publicKey:[1,d.TYPES.BYTES],deviceType:[2,d.TYPES.ENUM,a],ref:[3,d.TYPES.STRING]};h.name="CompanionCommitment";h.internalSpec={hash:[1,d.TYPES.BYTES]};i.name="ProloguePayload";i.internalSpec={companionEphemeralIdentity:[1,d.TYPES.BYTES],commitment:[2,d.TYPES.MESSAGE,h]};j.name="PrimaryEphemeralIdentity";j.internalSpec={publicKey:[1,d.TYPES.BYTES],nonce:[2,d.TYPES.BYTES]};k.name="PairingRequest";k.internalSpec={companionPublicKey:[1,d.TYPES.BYTES],companionIdentityKey:[2,d.TYPES.BYTES],advSecret:[3,d.TYPES.BYTES]};l.name="EncryptedPairingRequest";l.internalSpec={encryptedPayload:[1,d.TYPES.BYTES],iv:[2,d.TYPES.BYTES]};m.name="ClientPairingProps";m.internalSpec={isChatDbLidMigrated:[1,d.TYPES.BOOL],isSyncdPureLidSession:[2,d.TYPES.BOOL],isSyncdSnapshotRecoveryEnabled:[3,d.TYPES.BOOL]};g.DeviceProps$PlatformType=a;g.DevicePropsSpec=c;g.DeviceProps$HistorySyncConfigSpec=e;g.DeviceProps$AppVersionSpec=f;g.CompanionEphemeralIdentitySpec=b;g.CompanionCommitmentSpec=h;g.ProloguePayloadSpec=i;g.PrimaryEphemeralIdentitySpec=j;g.PairingRequestSpec=k;g.EncryptedPairingRequestSpec=l;g.ClientPairingPropsSpec=m}),98);
__d("WAWebProtobufsMmsRetry.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({GENERAL_ERROR:0,SUCCESS:1,NOT_FOUND:2,DECRYPTION_ERROR:3});c={};e={};c.name="MediaRetryNotification";c.internalSpec={stanzaId:[1,(f=d("WAProtoConst")).TYPES.STRING],directPath:[2,f.TYPES.STRING],result:[3,f.TYPES.ENUM,a],messageSecret:[4,f.TYPES.BYTES]};e.name="ServerErrorReceipt";e.internalSpec={stanzaId:[1,f.TYPES.STRING]};g.MediaRetryNotification$ResultType=a;g.MediaRetryNotificationSpec=c;g.ServerErrorReceiptSpec=e}),98);
__d("WAWebProtobufsStatusAttributions.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({UNKNOWN:0,STATUS_MIMICRY:1});e=a({UNKNOWN:0,RAY_BAN_META_GLASSES:1,OAKLEY_META_GLASSES:2,HYPERNOVA_GLASSES:3});f=a({UNKNOWN:0,INSTAGRAM:1,FACEBOOK:2,MESSENGER:3,SPOTIFY:4,YOUTUBE:5,PINTEREST:6,THREADS:7,APPLE_MUSIC:8,SHARECHAT:9});b=a({UNKNOWN:0,INTERNAL_RESHARE:1,MENTION_RESHARE:2,CHANNEL_RESHARE:3,FORWARD:4});a=a({UNKNOWN:0,RESHARE:1,EXTERNAL_SHARE:2,MUSIC:3,STATUS_MENTION:4,GROUP_STATUS:5,RL_ATTRIBUTION:6,AI_CREATED:7,LAYOUTS:8});var h={},i={},j={},k={},l={},m={},n={},o={};h.name="StatusAttribution";h.internalSpec={type:[1,(d=d("WAProtoConst")).TYPES.ENUM,a],actionUrl:[2,d.TYPES.STRING],statusReshare:[3,d.TYPES.MESSAGE,n],externalShare:[4,d.TYPES.MESSAGE,m],music:[5,d.TYPES.MESSAGE,l],groupStatus:[6,d.TYPES.MESSAGE,k],rlAttribution:[7,d.TYPES.MESSAGE,j],aiCreatedAttribution:[8,d.TYPES.MESSAGE,i],__oneofs__:{attributionData:["statusReshare","externalShare","music","groupStatus","rlAttribution","aiCreatedAttribution"]}};i.name="StatusAttribution$AiCreatedAttribution";i.internalSpec={source:[1,d.TYPES.ENUM,c]};j.name="StatusAttribution$RLAttribution";j.internalSpec={source:[1,d.TYPES.ENUM,e]};k.name="StatusAttribution$GroupStatus";k.internalSpec={authorJid:[1,d.TYPES.STRING]};l.name="StatusAttribution$Music";l.internalSpec={authorName:[1,d.TYPES.STRING],songId:[2,d.TYPES.STRING],title:[3,d.TYPES.STRING],author:[4,d.TYPES.STRING],artistAttribution:[5,d.TYPES.STRING],isExplicit:[6,d.TYPES.BOOL]};m.name="StatusAttribution$ExternalShare";m.internalSpec={actionUrl:[1,d.TYPES.STRING],source:[2,d.TYPES.ENUM,f],duration:[3,d.TYPES.INT32],actionFallbackUrl:[4,d.TYPES.STRING]};n.name="StatusAttribution$StatusReshare";n.internalSpec={source:[1,d.TYPES.ENUM,b],metadata:[2,d.TYPES.MESSAGE,o]};o.name="StatusAttribution$StatusReshare$Metadata";o.internalSpec={duration:[1,d.TYPES.INT32],channelJid:[2,d.TYPES.STRING],channelMessageId:[3,d.TYPES.INT32],hasMultipleReshares:[4,d.TYPES.BOOL]};g.StatusAttribution$AiCreatedAttribution$Source=c;g.StatusAttribution$RLAttribution$Source=e;g.StatusAttribution$ExternalShare$Source=f;g.StatusAttribution$StatusReshare$Source=b;g.StatusAttribution$Type=a;g.StatusAttributionSpec=h;g.StatusAttribution$AiCreatedAttributionSpec=i;g.StatusAttribution$RLAttributionSpec=j;g.StatusAttribution$GroupStatusSpec=k;g.StatusAttribution$MusicSpec=l;g.StatusAttribution$ExternalShareSpec=m;g.StatusAttribution$StatusReshareSpec=n;g.StatusAttribution$StatusReshare$MetadataSpec=o}),98);
__d("WAWebProtobufsE2E.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsAICommon.pb","WAWebProtobufsAdv.pb","WAWebProtobufsCompanionReg.pb","WAWebProtobufsMmsRetry.pb","WAWebProtobufsProtocol.pb","WAWebProtobufsStatusAttributions.pb"],(function(a,b,aa,c,ba,ca,d){var e,f,g;aa=(a=b("$InternalEnum"))({FIRST_PARTY:0,THIRD_PARTY:1,USER_CREATED:2});ba=a({MASK_LINKED_DEVICES:0});ca=a({UNKNOWN:0,AUDIO:1,VIDEO:2});b=a({CONNECTED:0,MISSED:1,FAILED:2,REJECTED:3,ACCEPTED_ELSEWHERE:4,ONGOING:5,SILENCED_BY_DND:6,SILENCED_UNKNOWN_CALLER:7});var da=a({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2}),ea=a({UNKNOWN:0,CANCEL:1}),fa=a({UNKNOWN:0,VOICE:1,VIDEO:2}),ga=a({UNKNOWN:0,GOING:1,NOT_GOING:2,MAYBE:3}),ha=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),ia=a({UNKNOWN:0,REACTION:1}),ja=a({POLL:0,QUIZ:1}),ka=a({UNKNOWN:0,TEXT:1,IMAGE:2}),la=a({UNKNOWN:0,DISPLAY_TEXT:1}),ma=a({UNKNOWN:0,RESPONSE:1,NATIVE_FLOW:2}),na=a({UNKNOWN:0,EMPTY:1,TEXT:2,DOCUMENT:3,IMAGE:4,VIDEO:5,LOCATION:6}),oa=a({UNKNOWN:0,EVENT_EDIT:1,MESSAGE_EDIT:2}),pa=a({DEFAULT:0,PARENT:1}),qa=a({DEFAULT:0,EXTENSIONS_1:1}),ra=a({UNKNOWN:0,HSCROLL_CARDS:1,ALBUM_IMAGE:2}),sa=a({UNKNOWN_SURFACE:0,FB:1,IG:2,WA:3}),ta=a({UNKNOWN:0,SINGLE_SELECT:1}),ua=a({UNKNOWN:0,SINGLE_SELECT:1,PRODUCT_LIST:2}),va=a({CATALOG:1}),wa=a({INQUIRY:1,ACCEPTED:2,DECLINED:3}),xa=a({QUESTION_ANSWER:1}),ya=a({UNKNOWN:0,FBPAY:1,NOVI:2,UPI:3}),za=a({GREGORIAN:1,SOLAR_HIJRI:2}),Aa=a({MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7}),Ba=a({GENERATION_ERROR:1,CHUNK_CONSUMED:2,TIMEOUT:3,SESSION_EXHAUSTED:4,CHUNK_EXHAUSTED:5,DUPLICATED_REQUEST:6}),Ca=a({REQUEST_SUCCESS:0,REQUEST_TIME_EXPIRED:1,DECLINED_SHARING_HISTORY:2,GENERIC_ERROR:3,ERROR_REQUEST_ON_NON_SMB_PRIMARY:4,ERROR_HOSTED_DEVICE_NOT_CONNECTED:5,ERROR_HOSTED_DEVICE_LOGIN_TIME_NOT_SET:6}),Da=a({NOTIFY_LAUNCH:1}),Ea=a({UPLOAD_STICKER:0,SEND_RECENT_STICKER_BOOTSTRAP:1,GENERATE_LINK_PREVIEW:2,HISTORY_SYNC_ON_DEMAND:3,PLACEHOLDER_MESSAGE_RESEND:4,WAFFLE_LINKING_NONCE_FETCH:5,FULL_HISTORY_SYNC_ON_DEMAND:6,COMPANION_META_NONCE_FETCH:7,COMPANION_SYNCD_SNAPSHOT_FATAL_RECOVERY:8,COMPANION_CANONICAL_USER_NONCE_FETCH:9,HISTORY_SYNC_CHUNK_RETRY:10,GALAXY_FLOW_ACTION:11}),h=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6,NO_HISTORY:7}),Fa=a({EMPTY:0,NON_EMPTY:1}),Ga=a({REVOKE:0,EPHEMERAL_SETTING:3,EPHEMERAL_SYNC_RESPONSE:4,HISTORY_SYNC_NOTIFICATION:5,APP_STATE_SYNC_KEY_SHARE:6,APP_STATE_SYNC_KEY_REQUEST:7,MSG_FANOUT_BACKFILL_REQUEST:8,INITIAL_SECURITY_NOTIFICATION_SETTING_SYNC:9,APP_STATE_FATAL_EXCEPTION_NOTIFICATION:10,SHARE_PHONE_NUMBER:11,MESSAGE_EDIT:14,PEER_DATA_OPERATION_REQUEST_MESSAGE:16,PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:17,REQUEST_WELCOME_MESSAGE:18,BOT_FEEDBACK_MESSAGE:19,MEDIA_NOTIFY_MESSAGE:20,CLOUD_API_THREAD_CONTROL_NOTIFICATION:21,LID_MIGRATION_MAPPING_SYNC:22,REMINDER_MESSAGE:23,BOT_MEMU_ONBOARDING_MESSAGE:24,STATUS_MENTION_MESSAGE:25,STOP_GENERATION_MESSAGE:26,LIMIT_SHARING:27,AI_PSI_METADATA:28,AI_QUERY_FANOUT:29,GROUP_MEMBER_LABEL_CHANGE:30}),Ha=a({UNKNOWN:0,CONTROL_PASSED:1,CONTROL_TAKEN:2}),Ia=a({USER_VIDEO:0,AI_GENERATED:1}),Ja=a({NONE:0,GIPHY:1,TENOR:2,KLIPY:3}),i=a({UNSET:0,E2EE_CHAT:1,STATUS:2,CAPI:3,BOT:4}),Ka=a({DEFAULT:0,PARENT:1,SUB:2,DEFAULT_SUB:3}),La=a({NONE:0,VIDEO:1,PLACEHOLDER:4,IMAGE:5,PAYMENT_LINKS:6,PROFILE:7}),Ma=a({SYSTEM:0,SYSTEM_TEXT:1,FB_SCRIPT:2,SYSTEM_BOLD:6,MORNINGBREEZE_REGULAR:7,CALISTOGA_REGULAR:8,EXO2_EXTRABOLD:9,COURIERPRIME_BOLD:10}),Na=a({NONE:0,REEL:1,LIVE_VIDEO:2,LONG_VIDEO:3,SINGLE_IMAGE:4,CAROUSEL:5}),Oa=a({LINK_PREVIEW:0,ORDER:1}),Pa=a({UNKNOWN:0,STATUS_ADD_YOURS:1,STATUS_RESHARE:2,STATUS_QUESTION_ANSWER_RESHARE:3}),Qa=a({IMAGE:0,PDF:1}),Ra=a({USER_IMAGE:0,AI_GENERATED:1,AI_MODIFIED:2,RASTERIZED_TEXT_STATUS:3}),Sa=a({EXPLICIT:0,AUTO:1}),Ta=a({UNKNOWN:0,CLOSE_FRIENDS:1}),Ua=a({UNKNOWN:0,CHAT:1,STATUS:2,CHANNELS:3,META_AI:4,UGC:5}),Va=a({IMAGE:0,VIDEO:1,GIF:2,AUDIO:3,TEXT:4,MUSIC_STANDALONE:5}),Wa=a({NOT_PAIRED_MEDIA:0,SD_VIDEO_PARENT:1,HD_VIDEO_CHILD:2,SD_IMAGE_PARENT:3,HD_IMAGE_CHILD:4,MOTION_PHOTO_PARENT:5,MOTION_PHOTO_CHILD:6,HEVC_VIDEO_PARENT:7,HEVC_VIDEO_CHILD:8}),Xa=a({NONE:0,RESHARED_FROM_MENTION:1,RESHARED_FROM_POST:2,RESHARED_FROM_POST_MANY_TIMES:3,FORWARDED_FROM_STATUS:4}),Ya=a({SHOW_MM_DISCLOSURE_ON_CLICK:1,SHOW_MM_DISCLOSURE_ON_READ:2}),Za=a({UPDATE:1,UPDATE_CARD:2,LINK_CARD:3}),$a=a({CTWA:0,CAWC:1}),ab=a({NONE:0,IMAGE:1,VIDEO:2}),bb=a({NONE:0,IMAGE:1,VIDEO:2}),cb=a({UNKNOWN:0,MEDIA_ALBUM:1,BOT_PLUGIN:2,EVENT_COVER_IMAGE:3,STATUS_POLL:4,HD_VIDEO_DUAL_UPLOAD:5,STATUS_EXTERNAL_RESHARE:6,MEDIA_POLL:7,STATUS_ADD_YOURS:8,STATUS_NOTIFICATION:9,HD_IMAGE_DUAL_UPLOAD:10,STICKER_ANNOTATION:11,MOTION_PHOTO:12,STATUS_LINK_ACTION:13,VIEW_ALL_REPLIES:14,STATUS_ADD_YOURS_AI_IMAGINE:15,STATUS_QUESTION:16,STATUS_ADD_YOURS_DIWALI:17,STATUS_REACTION:18,HEVC_VIDEO_DUAL_UPLOAD:19}),db=a({UNKNOWN:0,VIEW_REPLIES:1,AI_THREAD:2}),eb=a({STATIC:1,DEPENDENT_ON_PARENT:2}),fb=a({RASTERIZED_LINK_PREVIEW:1,RASTERIZED_LINK_TRUNCATED:2,RASTERIZED_LINK_FULL_URL:3}),gb=a({FULL:1,TALL:2,COMPACT:3}),hb=a({UNKNOWN:0,DEFAULT:1}),ib=a({UNKNOWN:0,CHAT_SETTING:1,ACCOUNT_SETTING:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4,UNKNOWN_GROUPS:5}),jb=a({CHANGED_IN_CHAT:0,INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3}),kb=a({UNKNOWN:0,KEEP_FOR_ALL:1,UNDO_KEEP_FOR_ALL:2});a=a({UNDEFINED:0,LOW:1,MID:2,HIGH:3});var j={},k={},l={},m={},n={},lb={},o={},mb={},nb={},ob={},pb={},qb={},rb={},sb={},tb={},ub={},vb={},wb={},xb={},yb={},zb={},Ab={},Bb={},Cb={},p={},Db={},Eb={},Fb={},Gb={},Hb={},q={},r={},Ib={},Jb={},Kb={},Lb={},Mb={},Nb={},Ob={},Pb={},s={},Qb={},Rb={},Sb={},Tb={},Ub={},Vb={},Wb={},t={},u={},v={},w={},x={},Xb={},y={},z={},Yb={},Zb={},$b={},ac={},bc={},cc={},dc={},ec={},fc={},gc={},hc={},ic={},A={},B={},jc={},kc={},lc={},mc={},C={},D={},nc={},E={},oc={},pc={},qc={},rc={},sc={},tc={},F={},uc={},vc={},wc={},xc={},yc={},zc={},Ac={},Bc={},Cc={},Dc={},Ec={},Fc={},Gc={},Hc={},Ic={},Jc={},Kc={},Lc={},Mc={},Nc={},Oc={},Pc={},Qc={},Rc={},Sc={},Tc={},Uc={},Vc={},G={},Wc={},Xc={},Yc={},Zc={},$c={},H={},ad={},bd={},cd={},dd={},ed={},fd={},gd={},hd={},I={},J={},K={},id={},jd={},kd={},ld={},L={},md={},nd={},od={},pd={},M={},qd={},N={},rd={},O={},P={},sd={},Q={},td={},R={},ud={},S={},vd={},T={},wd={},xd={},yd={},zd={},Ad={},Bd={},Cd={},U={},Dd={},V={},Ed={},Fd={},W={},Gd={},Hd={},Id={},Jd={},Kd={},Ld={},Md={},Nd={},Od={},Pd={},Qd={},X={},Rd={},Y={},Sd={},Td={},Ud={},Vd={},Wd={},Xd={},Z={},Yd={},$={},Zd={},$d={};j.name="Message";j.internalSpec={conversation:[1,(e=c("WAProtoConst")).TYPES.STRING],senderKeyDistributionMessage:[2,e.TYPES.MESSAGE,P],imageMessage:[3,e.TYPES.MESSAGE,O],contactMessage:[4,e.TYPES.MESSAGE,N],locationMessage:[5,e.TYPES.MESSAGE,M],extendedTextMessage:[6,e.TYPES.MESSAGE,id],documentMessage:[7,e.TYPES.MESSAGE,K],audioMessage:[8,e.TYPES.MESSAGE,J],videoMessage:[9,e.TYPES.MESSAGE,I],call:[10,e.TYPES.MESSAGE,hd],chat:[11,e.TYPES.MESSAGE,gd],protocolMessage:[12,e.TYPES.MESSAGE,dd],contactsArrayMessage:[13,e.TYPES.MESSAGE,zc],highlyStructuredMessage:[14,e.TYPES.MESSAGE,F],fastRatchetKeySenderKeyDistributionMessage:[15,e.TYPES.MESSAGE,P],sendPaymentMessage:[16,e.TYPES.MESSAGE,tc],liveLocationMessage:[18,e.TYPES.MESSAGE,oc],requestPaymentMessage:[22,e.TYPES.MESSAGE,sc],declinePaymentRequestMessage:[23,e.TYPES.MESSAGE,rc],cancelPaymentRequestMessage:[24,e.TYPES.MESSAGE,qc],templateMessage:[25,e.TYPES.MESSAGE,C],stickerMessage:[26,e.TYPES.MESSAGE,E],groupInviteMessage:[28,e.TYPES.MESSAGE,Vb],templateButtonReplyMessage:[29,e.TYPES.MESSAGE,mc],productMessage:[30,e.TYPES.MESSAGE,B],deviceSentMessage:[31,e.TYPES.MESSAGE,Qb],messageContextInfo:[35,e.TYPES.MESSAGE,Cd],listMessage:[36,e.TYPES.MESSAGE,cc],viewOnceMessage:[37,e.TYPES.MESSAGE,s],orderMessage:[38,e.TYPES.MESSAGE,A],listResponseMessage:[39,e.TYPES.MESSAGE,ac],ephemeralMessage:[40,e.TYPES.MESSAGE,s],invoiceMessage:[41,e.TYPES.MESSAGE,rd],buttonsMessage:[42,e.TYPES.MESSAGE,Lb],buttonsResponseMessage:[43,e.TYPES.MESSAGE,Kb],paymentInviteMessage:[44,e.TYPES.MESSAGE,pc],interactiveMessage:[45,e.TYPES.MESSAGE,v],reactionMessage:[46,e.TYPES.MESSAGE,Jb],stickerSyncRmrMessage:[47,e.TYPES.MESSAGE,Ib],interactiveResponseMessage:[48,e.TYPES.MESSAGE,Wb],pollCreationMessage:[49,e.TYPES.MESSAGE,q],pollUpdateMessage:[50,e.TYPES.MESSAGE,Hb],keepInChatMessage:[51,e.TYPES.MESSAGE,zb],documentWithCaptionMessage:[53,e.TYPES.MESSAGE,s],requestPhoneNumberMessage:[54,e.TYPES.MESSAGE,Sb],viewOnceMessageV2:[55,e.TYPES.MESSAGE,s],encReactionMessage:[56,e.TYPES.MESSAGE,xb],editedMessage:[58,e.TYPES.MESSAGE,s],viewOnceMessageV2Extension:[59,e.TYPES.MESSAGE,s],pollCreationMessageV2:[60,e.TYPES.MESSAGE,q],scheduledCallCreationMessage:[61,e.TYPES.MESSAGE,rb],groupMentionedMessage:[62,e.TYPES.MESSAGE,s],pinInChatMessage:[63,e.TYPES.MESSAGE,yb],pollCreationMessageV3:[64,e.TYPES.MESSAGE,q],scheduledCallEditMessage:[65,e.TYPES.MESSAGE,qb],ptvMessage:[66,e.TYPES.MESSAGE,I],botInvokeMessage:[67,e.TYPES.MESSAGE,s],callLogMesssage:[69,e.TYPES.MESSAGE,ob],messageHistoryBundle:[70,e.TYPES.MESSAGE,nb],encCommentMessage:[71,e.TYPES.MESSAGE,wb],bcallMessage:[72,e.TYPES.MESSAGE,lb],lottieStickerMessage:[74,e.TYPES.MESSAGE,s],eventMessage:[75,e.TYPES.MESSAGE,ub],encEventResponseMessage:[76,e.TYPES.MESSAGE,tb],commentMessage:[77,e.TYPES.MESSAGE,vb],newsletterAdminInviteMessage:[78,e.TYPES.MESSAGE,Ub],placeholderMessage:[80,e.TYPES.MESSAGE,n],secretEncryptedMessage:[82,e.TYPES.MESSAGE,Pb],albumMessage:[83,e.TYPES.MESSAGE,m],eventCoverImage:[85,e.TYPES.MESSAGE,s],stickerPackMessage:[86,e.TYPES.MESSAGE,k],statusMentionMessage:[87,e.TYPES.MESSAGE,s],pollResultSnapshotMessage:[88,e.TYPES.MESSAGE,p],pollCreationOptionImageMessage:[90,e.TYPES.MESSAGE,s],associatedChildMessage:[91,e.TYPES.MESSAGE,s],groupStatusMentionMessage:[92,e.TYPES.MESSAGE,s],pollCreationMessageV4:[93,e.TYPES.MESSAGE,s],statusAddYours:[95,e.TYPES.MESSAGE,s],groupStatusMessage:[96,e.TYPES.MESSAGE,s],richResponseMessage:[97,e.TYPES.MESSAGE,Zd],statusNotificationMessage:[98,e.TYPES.MESSAGE,qd],limitSharingMessage:[99,e.TYPES.MESSAGE,s],botTaskMessage:[100,e.TYPES.MESSAGE,s],questionMessage:[101,e.TYPES.MESSAGE,s],messageHistoryNotice:[102,e.TYPES.MESSAGE,mb],groupStatusMessageV2:[103,e.TYPES.MESSAGE,s],botForwardedMessage:[104,e.TYPES.MESSAGE,s],statusQuestionAnswerMessage:[105,e.TYPES.MESSAGE,Cb],questionReplyMessage:[106,e.TYPES.MESSAGE,s],questionResponseMessage:[107,e.TYPES.MESSAGE,Ab],statusQuotedMessage:[109,e.TYPES.MESSAGE,lc],statusStickerInteractionMessage:[110,e.TYPES.MESSAGE,Bb],pollCreationMessageV5:[111,e.TYPES.MESSAGE,q],pollResultSnapshotMessageV2:[112,e.TYPES.MESSAGE,p],newsletterFollowerInviteMessageV2:[113,e.TYPES.MESSAGE,Tb],requestContactInfoMessage:[114,e.TYPES.MESSAGE,Rb]};k.name="Message$StickerPackMessage";k.internalSpec={stickerPackId:[1,e.TYPES.STRING],name:[2,e.TYPES.STRING],publisher:[3,e.TYPES.STRING],stickers:[4,e.FLAGS.REPEATED|e.TYPES.MESSAGE,l],fileLength:[5,e.TYPES.UINT64],fileSha256:[6,e.TYPES.BYTES],fileEncSha256:[7,e.TYPES.BYTES],mediaKey:[8,e.TYPES.BYTES],directPath:[9,e.TYPES.STRING],caption:[10,e.TYPES.STRING],contextInfo:[11,e.TYPES.MESSAGE,Q],packDescription:[12,e.TYPES.STRING],mediaKeyTimestamp:[13,e.TYPES.INT64],trayIconFileName:[14,e.TYPES.STRING],thumbnailDirectPath:[15,e.TYPES.STRING],thumbnailSha256:[16,e.TYPES.BYTES],thumbnailEncSha256:[17,e.TYPES.BYTES],thumbnailHeight:[18,e.TYPES.UINT32],thumbnailWidth:[19,e.TYPES.UINT32],imageDataHash:[20,e.TYPES.STRING],stickerPackSize:[21,e.TYPES.UINT64],stickerPackOrigin:[22,e.TYPES.ENUM,aa]};l.name="Message$StickerPackMessage$Sticker";l.internalSpec={fileName:[1,e.TYPES.STRING],isAnimated:[2,e.TYPES.BOOL],emojis:[3,e.FLAGS.REPEATED|e.TYPES.STRING],accessibilityLabel:[4,e.TYPES.STRING],isLottie:[5,e.TYPES.BOOL],mimetype:[6,e.TYPES.STRING]};m.name="Message$AlbumMessage";m.internalSpec={expectedImageCount:[2,e.TYPES.UINT32],expectedVideoCount:[3,e.TYPES.UINT32],contextInfo:[17,e.TYPES.MESSAGE,Q]};n.name="Message$PlaceholderMessage";n.internalSpec={type:[1,e.TYPES.ENUM,ba]};lb.name="Message$BCallMessage";lb.internalSpec={sessionId:[1,e.TYPES.STRING],mediaType:[2,e.TYPES.ENUM,ca],masterKey:[3,e.TYPES.BYTES],caption:[4,e.TYPES.STRING]};o.name="Message$MessageHistoryMetadata";o.internalSpec={historyReceivers:[1,e.FLAGS.REPEATED|e.TYPES.STRING],oldestMessageTimestamp:[2,e.TYPES.INT64],messageCount:[3,e.TYPES.INT64]};mb.name="Message$MessageHistoryNotice";mb.internalSpec={contextInfo:[1,e.TYPES.MESSAGE,Q],messageHistoryMetadata:[2,e.TYPES.MESSAGE,o]};nb.name="Message$MessageHistoryBundle";nb.internalSpec={mimetype:[1,e.TYPES.STRING],fileSha256:[2,e.TYPES.BYTES],mediaKey:[3,e.TYPES.BYTES],fileEncSha256:[4,e.TYPES.BYTES],directPath:[5,e.TYPES.STRING],mediaKeyTimestamp:[6,e.TYPES.INT64],contextInfo:[7,e.TYPES.MESSAGE,Q],messageHistoryMetadata:[8,e.TYPES.MESSAGE,o]};ob.name="Message$CallLogMessage";ob.internalSpec={isVideo:[1,e.TYPES.BOOL],callOutcome:[2,e.TYPES.ENUM,b],durationSecs:[3,e.TYPES.INT64],callType:[4,e.TYPES.ENUM,da],participants:[5,e.FLAGS.REPEATED|e.TYPES.MESSAGE,pb]};pb.name="Message$CallLogMessage$CallParticipant";pb.internalSpec={jid:[1,e.TYPES.STRING],callOutcome:[2,e.TYPES.ENUM,b]};qb.name="Message$ScheduledCallEditMessage";qb.internalSpec={key:[1,e.TYPES.MESSAGE,(f=c("WAWebProtobufsProtocol.pb")).MessageKeySpec],editType:[2,e.TYPES.ENUM,ea]};rb.name="Message$ScheduledCallCreationMessage";rb.internalSpec={scheduledTimestampMs:[1,e.TYPES.INT64],callType:[2,e.TYPES.ENUM,fa],title:[3,e.TYPES.STRING]};sb.name="Message$EventResponseMessage";sb.internalSpec={response:[1,e.TYPES.ENUM,ga],timestampMs:[2,e.TYPES.INT64],extraGuestCount:[3,e.TYPES.INT32]};tb.name="Message$EncEventResponseMessage";tb.internalSpec={eventCreationMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],encPayload:[2,e.TYPES.BYTES],encIv:[3,e.TYPES.BYTES]};ub.name="Message$EventMessage";ub.internalSpec={contextInfo:[1,e.TYPES.MESSAGE,Q],isCanceled:[2,e.TYPES.BOOL],name:[3,e.TYPES.STRING],description:[4,e.TYPES.STRING],location:[5,e.TYPES.MESSAGE,M],joinLink:[6,e.TYPES.STRING],startTime:[7,e.TYPES.INT64],endTime:[8,e.TYPES.INT64],extraGuestsAllowed:[9,e.TYPES.BOOL],isScheduleCall:[10,e.TYPES.BOOL]};vb.name="Message$CommentMessage";vb.internalSpec={message:[1,e.TYPES.MESSAGE,j],targetMessageKey:[2,e.TYPES.MESSAGE,f.MessageKeySpec]};wb.name="Message$EncCommentMessage";wb.internalSpec={targetMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],encPayload:[2,e.TYPES.BYTES],encIv:[3,e.TYPES.BYTES]};xb.name="Message$EncReactionMessage";xb.internalSpec={targetMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],encPayload:[2,e.TYPES.BYTES],encIv:[3,e.TYPES.BYTES]};yb.name="Message$PinInChatMessage";yb.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],type:[2,e.TYPES.ENUM,ha],senderTimestampMs:[3,e.TYPES.INT64]};zb.name="Message$KeepInChatMessage";zb.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],keepType:[2,e.TYPES.ENUM,kb],timestampMs:[3,e.TYPES.INT64]};Ab.name="Message$QuestionResponseMessage";Ab.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],text:[2,e.TYPES.STRING]};Bb.name="Message$StatusStickerInteractionMessage";Bb.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],stickerKey:[2,e.TYPES.STRING],type:[3,e.TYPES.ENUM,ia]};Cb.name="Message$StatusQuestionAnswerMessage";Cb.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],text:[2,e.TYPES.STRING]};p.name="Message$PollResultSnapshotMessage";p.internalSpec={name:[1,e.TYPES.STRING],pollVotes:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Db],contextInfo:[3,e.TYPES.MESSAGE,Q],pollType:[4,e.TYPES.ENUM,ja]};Db.name="Message$PollResultSnapshotMessage$PollVote";Db.internalSpec={optionName:[1,e.TYPES.STRING],optionVoteCount:[2,e.TYPES.INT64]};Eb.name="Message$PollVoteMessage";Eb.internalSpec={selectedOptions:[1,e.FLAGS.REPEATED|e.TYPES.BYTES]};Fb.name="Message$PollEncValue";Fb.internalSpec={encPayload:[1,e.TYPES.BYTES],encIv:[2,e.TYPES.BYTES]};Gb.name="Message$PollUpdateMessageMetadata";Gb.internalSpec={};Hb.name="Message$PollUpdateMessage";Hb.internalSpec={pollCreationMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],vote:[2,e.TYPES.MESSAGE,Fb],metadata:[3,e.TYPES.MESSAGE,Gb],senderTimestampMs:[4,e.TYPES.INT64]};q.name="Message$PollCreationMessage";q.internalSpec={encKey:[1,e.TYPES.BYTES],name:[2,e.TYPES.STRING],options:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,r],selectableOptionsCount:[4,e.TYPES.UINT32],contextInfo:[5,e.TYPES.MESSAGE,Q],pollContentType:[6,e.TYPES.ENUM,ka],pollType:[7,e.TYPES.ENUM,ja],correctAnswer:[8,e.TYPES.MESSAGE,r]};r.name="Message$PollCreationMessage$Option";r.internalSpec={optionName:[1,e.TYPES.STRING],optionHash:[2,e.TYPES.STRING]};Ib.name="Message$StickerSyncRMRMessage";Ib.internalSpec={filehash:[1,e.FLAGS.REPEATED|e.TYPES.STRING],rmrSource:[2,e.TYPES.STRING],requestTimestamp:[3,e.TYPES.INT64]};Jb.name="Message$ReactionMessage";Jb.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],text:[2,e.TYPES.STRING],groupingKey:[3,e.TYPES.STRING],senderTimestampMs:[4,e.TYPES.INT64]};Kb.name="Message$ButtonsResponseMessage";Kb.internalSpec={selectedButtonId:[1,e.TYPES.STRING],contextInfo:[3,e.TYPES.MESSAGE,Q],type:[4,e.TYPES.ENUM,la],selectedDisplayText:[2,e.TYPES.STRING],__oneofs__:{response:["selectedDisplayText"]}};Lb.name="Message$ButtonsMessage";Lb.internalSpec={contentText:[6,e.TYPES.STRING],footerText:[7,e.TYPES.STRING],contextInfo:[8,e.TYPES.MESSAGE,Q],buttons:[9,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Mb],headerType:[10,e.TYPES.ENUM,na],text:[1,e.TYPES.STRING],documentMessage:[2,e.TYPES.MESSAGE,K],imageMessage:[3,e.TYPES.MESSAGE,O],videoMessage:[4,e.TYPES.MESSAGE,I],locationMessage:[5,e.TYPES.MESSAGE,M],__oneofs__:{header:["text","documentMessage","imageMessage","videoMessage","locationMessage"]}};Mb.name="Message$ButtonsMessage$Button";Mb.internalSpec={buttonId:[1,e.TYPES.STRING],buttonText:[2,e.TYPES.MESSAGE,Ob],type:[3,e.TYPES.ENUM,ma],nativeFlowInfo:[4,e.TYPES.MESSAGE,Nb]};Nb.name="Message$ButtonsMessage$Button$NativeFlowInfo";Nb.internalSpec={name:[1,e.TYPES.STRING],paramsJson:[2,e.TYPES.STRING]};Ob.name="Message$ButtonsMessage$Button$ButtonText";Ob.internalSpec={displayText:[1,e.TYPES.STRING]};Pb.name="Message$SecretEncryptedMessage";Pb.internalSpec={targetMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],encPayload:[2,e.TYPES.BYTES],encIv:[3,e.TYPES.BYTES],secretEncType:[4,e.TYPES.ENUM,oa]};s.name="Message$FutureProofMessage";s.internalSpec={message:[1,e.TYPES.MESSAGE,j]};Qb.name="Message$DeviceSentMessage";Qb.internalSpec={destinationJid:[1,e.TYPES.STRING],message:[2,e.TYPES.MESSAGE,j],phash:[3,e.TYPES.STRING]};Rb.name="Message$RequestContactInfoMessage";Rb.internalSpec={text:[1,e.TYPES.STRING],ctaButtonText:[2,e.TYPES.STRING],contextInfo:[3,e.TYPES.MESSAGE,Q]};Sb.name="Message$RequestPhoneNumberMessage";Sb.internalSpec={contextInfo:[1,e.TYPES.MESSAGE,Q]};Tb.name="Message$NewsletterFollowerInviteMessage";Tb.internalSpec={newsletterJid:[1,e.TYPES.STRING],newsletterName:[2,e.TYPES.STRING],jpegThumbnail:[3,e.TYPES.BYTES],caption:[4,e.TYPES.STRING],contextInfo:[5,e.TYPES.MESSAGE,Q]};Ub.name="Message$NewsletterAdminInviteMessage";Ub.internalSpec={newsletterJid:[1,e.TYPES.STRING],newsletterName:[2,e.TYPES.STRING],jpegThumbnail:[3,e.TYPES.BYTES],caption:[4,e.TYPES.STRING],inviteExpiration:[5,e.TYPES.INT64],contextInfo:[6,e.TYPES.MESSAGE,Q]};Vb.name="Message$GroupInviteMessage";Vb.internalSpec={groupJid:[1,e.TYPES.STRING],inviteCode:[2,e.TYPES.STRING],inviteExpiration:[3,e.TYPES.INT64],groupName:[4,e.TYPES.STRING],jpegThumbnail:[5,e.TYPES.BYTES],caption:[6,e.TYPES.STRING],contextInfo:[7,e.TYPES.MESSAGE,Q],groupType:[8,e.TYPES.ENUM,pa]};Wb.name="Message$InteractiveResponseMessage";Wb.internalSpec={body:[1,e.TYPES.MESSAGE,u],contextInfo:[15,e.TYPES.MESSAGE,Q],nativeFlowResponseMessage:[2,e.TYPES.MESSAGE,t],__oneofs__:{interactiveResponseMessage:["nativeFlowResponseMessage"]}};t.internalDefaults={version:1};t.name="Message$InteractiveResponseMessage$NativeFlowResponseMessage";t.internalSpec={name:[1,e.TYPES.STRING],paramsJson:[2,e.TYPES.STRING],version:[3,e.TYPES.INT32]};u.internalDefaults={format:qa.DEFAULT};u.name="Message$InteractiveResponseMessage$Body";u.internalSpec={text:[1,e.TYPES.STRING],format:[2,e.TYPES.ENUM,qa]};v.name="Message$InteractiveMessage";v.internalSpec={header:[1,e.TYPES.MESSAGE,$b],body:[2,e.TYPES.MESSAGE,Zb],footer:[3,e.TYPES.MESSAGE,Yb],contextInfo:[15,e.TYPES.MESSAGE,Q],urlTrackingMap:[16,e.TYPES.MESSAGE,Z],shopStorefrontMessage:[4,e.TYPES.MESSAGE,z],collectionMessage:[5,e.TYPES.MESSAGE,y],nativeFlowMessage:[6,e.TYPES.MESSAGE,x],carouselMessage:[7,e.TYPES.MESSAGE,w],__oneofs__:{interactiveMessage:["shopStorefrontMessage","collectionMessage","nativeFlowMessage","carouselMessage"]}};w.internalDefaults={messageVersion:1,carouselCardType:ra.HSCROLL_CARDS};w.name="Message$InteractiveMessage$CarouselMessage";w.internalSpec={cards:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,v],messageVersion:[2,e.TYPES.INT32],carouselCardType:[3,e.TYPES.ENUM,ra]};x.internalDefaults={messageVersion:1};x.name="Message$InteractiveMessage$NativeFlowMessage";x.internalSpec={buttons:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Xb],messageParamsJson:[2,e.TYPES.STRING],messageVersion:[3,e.TYPES.INT32]};Xb.name="Message$InteractiveMessage$NativeFlowMessage$NativeFlowButton";Xb.internalSpec={name:[1,e.TYPES.STRING],buttonParamsJson:[2,e.TYPES.STRING]};y.internalDefaults={messageVersion:1};y.name="Message$InteractiveMessage$CollectionMessage";y.internalSpec={bizJid:[1,e.TYPES.STRING],id:[2,e.TYPES.STRING],messageVersion:[3,e.TYPES.INT32]};z.internalDefaults={messageVersion:1};z.name="Message$InteractiveMessage$ShopMessage";z.internalSpec={id:[1,e.TYPES.STRING],surface:[2,e.TYPES.ENUM,sa],messageVersion:[3,e.TYPES.INT32]};Yb.name="Message$InteractiveMessage$Footer";Yb.internalSpec={text:[1,e.TYPES.STRING],hasMediaAttachment:[3,e.TYPES.BOOL],audioMessage:[2,e.TYPES.MESSAGE,J],__oneofs__:{media:["audioMessage"]}};Zb.name="Message$InteractiveMessage$Body";Zb.internalSpec={text:[1,e.TYPES.STRING]};$b.name="Message$InteractiveMessage$Header";$b.internalSpec={title:[1,e.TYPES.STRING],subtitle:[2,e.TYPES.STRING],hasMediaAttachment:[5,e.TYPES.BOOL],documentMessage:[3,e.TYPES.MESSAGE,K],imageMessage:[4,e.TYPES.MESSAGE,O],jpegThumbnail:[6,e.TYPES.BYTES],videoMessage:[7,e.TYPES.MESSAGE,I],locationMessage:[8,e.TYPES.MESSAGE,M],productMessage:[9,e.TYPES.MESSAGE,B],__oneofs__:{media:["documentMessage","imageMessage","jpegThumbnail","videoMessage","locationMessage","productMessage"]}};ac.name="Message$ListResponseMessage";ac.internalSpec={title:[1,e.TYPES.STRING],listType:[2,e.TYPES.ENUM,ta],singleSelectReply:[3,e.TYPES.MESSAGE,bc],contextInfo:[4,e.TYPES.MESSAGE,Q],description:[5,e.TYPES.STRING]};bc.name="Message$ListResponseMessage$SingleSelectReply";bc.internalSpec={selectedRowId:[1,e.TYPES.STRING]};cc.name="Message$ListMessage";cc.internalSpec={title:[1,e.TYPES.STRING],description:[2,e.TYPES.STRING],buttonText:[3,e.TYPES.STRING],listType:[4,e.TYPES.ENUM,ua],sections:[5,e.FLAGS.REPEATED|e.TYPES.MESSAGE,hc],productListInfo:[6,e.TYPES.MESSAGE,dc],footerText:[7,e.TYPES.STRING],contextInfo:[8,e.TYPES.MESSAGE,Q]};dc.name="Message$ListMessage$ProductListInfo";dc.internalSpec={productSections:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,fc],headerImage:[2,e.TYPES.MESSAGE,ec],businessOwnerJid:[3,e.TYPES.STRING]};ec.name="Message$ListMessage$ProductListHeaderImage";ec.internalSpec={productId:[1,e.TYPES.STRING],jpegThumbnail:[2,e.TYPES.BYTES]};fc.name="Message$ListMessage$ProductSection";fc.internalSpec={title:[1,e.TYPES.STRING],products:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,gc]};gc.name="Message$ListMessage$Product";gc.internalSpec={productId:[1,e.TYPES.STRING]};hc.name="Message$ListMessage$Section";hc.internalSpec={title:[1,e.TYPES.STRING],rows:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,ic]};ic.name="Message$ListMessage$Row";ic.internalSpec={title:[1,e.TYPES.STRING],description:[2,e.TYPES.STRING],rowId:[3,e.TYPES.STRING]};A.internalDefaults={messageVersion:1};A.name="Message$OrderMessage";A.internalSpec={orderId:[1,e.TYPES.STRING],thumbnail:[2,e.TYPES.BYTES],itemCount:[3,e.TYPES.INT32],status:[4,e.TYPES.ENUM,wa],surface:[5,e.TYPES.ENUM,va],message:[6,e.TYPES.STRING],orderTitle:[7,e.TYPES.STRING],sellerJid:[8,e.TYPES.STRING],token:[9,e.TYPES.STRING],totalAmount1000:[10,e.TYPES.INT64],totalCurrencyCode:[11,e.TYPES.STRING],contextInfo:[17,e.TYPES.MESSAGE,Q],messageVersion:[12,e.TYPES.INT32],orderRequestMessageId:[13,e.TYPES.MESSAGE,f.MessageKeySpec],catalogType:[15,e.TYPES.STRING]};B.name="Message$ProductMessage";B.internalSpec={product:[1,e.TYPES.MESSAGE,jc],businessOwnerJid:[2,e.TYPES.STRING],catalog:[4,e.TYPES.MESSAGE,kc],body:[5,e.TYPES.STRING],footer:[6,e.TYPES.STRING],contextInfo:[17,e.TYPES.MESSAGE,Q]};jc.name="Message$ProductMessage$ProductSnapshot";jc.internalSpec={productImage:[1,e.TYPES.MESSAGE,O],productId:[2,e.TYPES.STRING],title:[3,e.TYPES.STRING],description:[4,e.TYPES.STRING],currencyCode:[5,e.TYPES.STRING],priceAmount1000:[6,e.TYPES.INT64],retailerId:[7,e.TYPES.STRING],url:[8,e.TYPES.STRING],productImageCount:[9,e.TYPES.UINT32],firstImageId:[11,e.TYPES.STRING],salePriceAmount1000:[12,e.TYPES.INT64],signedUrl:[13,e.TYPES.STRING]};kc.name="Message$ProductMessage$CatalogSnapshot";kc.internalSpec={catalogImage:[1,e.TYPES.MESSAGE,O],title:[2,e.TYPES.STRING],description:[3,e.TYPES.STRING]};lc.name="Message$StatusQuotedMessage";lc.internalSpec={type:[1,e.TYPES.ENUM,xa],text:[2,e.TYPES.STRING],thumbnail:[3,e.TYPES.BYTES],originalStatusId:[4,e.TYPES.MESSAGE,f.MessageKeySpec]};mc.name="Message$TemplateButtonReplyMessage";mc.internalSpec={selectedId:[1,e.TYPES.STRING],selectedDisplayText:[2,e.TYPES.STRING],contextInfo:[3,e.TYPES.MESSAGE,Q],selectedIndex:[4,e.TYPES.UINT32],selectedCarouselCardIndex:[5,e.TYPES.UINT32]};C.name="Message$TemplateMessage";C.internalSpec={contextInfo:[3,e.TYPES.MESSAGE,Q],hydratedTemplate:[4,e.TYPES.MESSAGE,D],templateId:[9,e.TYPES.STRING],fourRowTemplate:[1,e.TYPES.MESSAGE,nc],hydratedFourRowTemplate:[2,e.TYPES.MESSAGE,D],interactiveMessageTemplate:[5,e.TYPES.MESSAGE,v],__oneofs__:{format:["fourRowTemplate","hydratedFourRowTemplate","interactiveMessageTemplate"]}};D.name="Message$TemplateMessage$HydratedFourRowTemplate";D.internalSpec={hydratedContentText:[6,e.TYPES.STRING],hydratedFooterText:[7,e.TYPES.STRING],hydratedButtons:[8,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Md],templateId:[9,e.TYPES.STRING],maskLinkedDevices:[10,e.TYPES.BOOL],documentMessage:[1,e.TYPES.MESSAGE,K],hydratedTitleText:[2,e.TYPES.STRING],imageMessage:[3,e.TYPES.MESSAGE,O],videoMessage:[4,e.TYPES.MESSAGE,I],locationMessage:[5,e.TYPES.MESSAGE,M],__oneofs__:{title:["documentMessage","hydratedTitleText","imageMessage","videoMessage","locationMessage"]}};nc.name="Message$TemplateMessage$FourRowTemplate";nc.internalSpec={content:[6,e.TYPES.MESSAGE,F],footer:[7,e.TYPES.MESSAGE,F],buttons:[8,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Id],documentMessage:[1,e.TYPES.MESSAGE,K],highlyStructuredMessage:[2,e.TYPES.MESSAGE,F],imageMessage:[3,e.TYPES.MESSAGE,O],videoMessage:[4,e.TYPES.MESSAGE,I],locationMessage:[5,e.TYPES.MESSAGE,M],__oneofs__:{title:["documentMessage","highlyStructuredMessage","imageMessage","videoMessage","locationMessage"]}};E.name="Message$StickerMessage";E.internalSpec={url:[1,e.TYPES.STRING],fileSha256:[2,e.TYPES.BYTES],fileEncSha256:[3,e.TYPES.BYTES],mediaKey:[4,e.TYPES.BYTES],mimetype:[5,e.TYPES.STRING],height:[6,e.TYPES.UINT32],width:[7,e.TYPES.UINT32],directPath:[8,e.TYPES.STRING],fileLength:[9,e.TYPES.UINT64],mediaKeyTimestamp:[10,e.TYPES.INT64],firstFrameLength:[11,e.TYPES.UINT32],firstFrameSidecar:[12,e.TYPES.BYTES],isAnimated:[13,e.TYPES.BOOL],pngThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q],stickerSentTs:[18,e.TYPES.INT64],isAvatar:[19,e.TYPES.BOOL],isAiSticker:[20,e.TYPES.BOOL],isLottie:[21,e.TYPES.BOOL],accessibilityLabel:[22,e.TYPES.STRING],mediaKeyDomain:[23,e.TYPES.ENUM,i]};oc.name="Message$LiveLocationMessage";oc.internalSpec={degreesLatitude:[1,e.TYPES.DOUBLE],degreesLongitude:[2,e.TYPES.DOUBLE],accuracyInMeters:[3,e.TYPES.UINT32],speedInMps:[4,e.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[5,e.TYPES.UINT32],caption:[6,e.TYPES.STRING],sequenceNumber:[7,e.TYPES.INT64],timeOffset:[8,e.TYPES.UINT32],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q]};pc.name="Message$PaymentInviteMessage";pc.internalSpec={serviceType:[1,e.TYPES.ENUM,ya],expiryTimestamp:[2,e.TYPES.INT64]};qc.name="Message$CancelPaymentRequestMessage";qc.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec]};rc.name="Message$DeclinePaymentRequestMessage";rc.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec]};sc.name="Message$RequestPaymentMessage";sc.internalSpec={noteMessage:[4,e.TYPES.MESSAGE,j],currencyCodeIso4217:[1,e.TYPES.STRING],amount1000:[2,e.TYPES.UINT64],requestFrom:[3,e.TYPES.STRING],expiryTimestamp:[5,e.TYPES.INT64],amount:[6,e.TYPES.MESSAGE,Qd],background:[7,e.TYPES.MESSAGE,X]};tc.name="Message$SendPaymentMessage";tc.internalSpec={noteMessage:[2,e.TYPES.MESSAGE,j],requestMessageKey:[3,e.TYPES.MESSAGE,f.MessageKeySpec],background:[4,e.TYPES.MESSAGE,X],transactionData:[5,e.TYPES.STRING]};F.name="Message$HighlyStructuredMessage";F.internalSpec={namespace:[1,e.TYPES.STRING],elementName:[2,e.TYPES.STRING],params:[3,e.FLAGS.REPEATED|e.TYPES.STRING],fallbackLg:[4,e.TYPES.STRING],fallbackLc:[5,e.TYPES.STRING],localizableParams:[6,e.FLAGS.REPEATED|e.TYPES.MESSAGE,uc],deterministicLg:[7,e.TYPES.STRING],deterministicLc:[8,e.TYPES.STRING],hydratedHsm:[9,e.TYPES.MESSAGE,C]};uc.name="Message$HighlyStructuredMessage$HSMLocalizableParameter";uc.internalSpec={"default":[1,e.TYPES.STRING],currency:[2,e.TYPES.MESSAGE,yc],dateTime:[3,e.TYPES.MESSAGE,vc],__oneofs__:{paramOneof:["currency","dateTime"]}};vc.name="Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime";vc.internalSpec={component:[1,e.TYPES.MESSAGE,xc],unixEpoch:[2,e.TYPES.MESSAGE,wc],__oneofs__:{datetimeOneof:["component","unixEpoch"]}};wc.name="Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpoch";wc.internalSpec={timestamp:[1,e.TYPES.INT64]};xc.name="Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent";xc.internalSpec={dayOfWeek:[1,e.TYPES.ENUM,Aa],year:[2,e.TYPES.UINT32],month:[3,e.TYPES.UINT32],dayOfMonth:[4,e.TYPES.UINT32],hour:[5,e.TYPES.UINT32],minute:[6,e.TYPES.UINT32],calendar:[7,e.TYPES.ENUM,za]};yc.name="Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrency";yc.internalSpec={currencyCode:[1,e.TYPES.STRING],amount1000:[2,e.TYPES.INT64]};zc.name="Message$ContactsArrayMessage";zc.internalSpec={displayName:[1,e.TYPES.STRING],contacts:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,N],contextInfo:[17,e.TYPES.MESSAGE,Q]};Ac.name="Message$InitialSecurityNotificationSettingSync";Ac.internalSpec={securityNotificationEnabled:[1,e.TYPES.BOOL]};Bc.name="Message$PeerDataOperationRequestResponseMessage";Bc.internalSpec={peerDataOperationRequestType:[1,e.TYPES.ENUM,Ea],stanzaId:[2,e.TYPES.STRING],peerDataOperationResult:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Cc]};Cc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult";Cc.internalSpec={mediaUploadResult:[1,e.TYPES.ENUM,c("WAWebProtobufsMmsRetry.pb").MediaRetryNotification$ResultType],stickerMessage:[2,e.TYPES.MESSAGE,E],linkPreviewResponse:[3,e.TYPES.MESSAGE,Kc],placeholderMessageResendResponse:[4,e.TYPES.MESSAGE,Jc],waffleNonceFetchRequestResponse:[5,e.TYPES.MESSAGE,Hc],fullHistorySyncOnDemandRequestResponse:[6,e.TYPES.MESSAGE,Ic],companionMetaNonceFetchRequestResponse:[7,e.TYPES.MESSAGE,Gc],syncdSnapshotFatalRecoveryResponse:[8,e.TYPES.MESSAGE,Ec],companionCanonicalUserNonceFetchRequestResponse:[9,e.TYPES.MESSAGE,Fc],historySyncChunkRetryResponse:[10,e.TYPES.MESSAGE,Dc]};Dc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$HistorySyncChunkRetryResponse";Dc.internalSpec={syncType:[1,e.TYPES.ENUM,h],chunkOrder:[2,e.TYPES.UINT32],requestId:[3,e.TYPES.STRING],responseCode:[4,e.TYPES.ENUM,Ba],canRecover:[5,e.TYPES.BOOL]};Ec.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$SyncDSnapshotFatalRecoveryResponse";Ec.internalSpec={collectionSnapshot:[1,e.TYPES.BYTES],isCompressed:[2,e.TYPES.BOOL]};Fc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$CompanionCanonicalUserNonceFetchResponse";Fc.internalSpec={nonce:[1,e.TYPES.STRING],waFbid:[2,e.TYPES.STRING],forceRefresh:[3,e.TYPES.BOOL]};Gc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$CompanionMetaNonceFetchResponse";Gc.internalSpec={nonce:[1,e.TYPES.STRING]};Hc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$WaffleNonceFetchResponse";Hc.internalSpec={nonce:[1,e.TYPES.STRING],waEntFbid:[2,e.TYPES.STRING]};Ic.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$FullHistorySyncOnDemandRequestResponse";Ic.internalSpec={requestMetadata:[1,e.TYPES.MESSAGE,G],responseCode:[2,e.TYPES.ENUM,Ca]};Jc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponse";Jc.internalSpec={webMessageInfoBytes:[1,e.TYPES.BYTES]};Kc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse";Kc.internalSpec={url:[1,e.TYPES.STRING],title:[2,e.TYPES.STRING],description:[3,e.TYPES.STRING],thumbData:[4,e.TYPES.BYTES],matchText:[6,e.TYPES.STRING],previewType:[7,e.TYPES.STRING],hqThumbnail:[8,e.TYPES.MESSAGE,Mc],previewMetadata:[9,e.TYPES.MESSAGE,Lc]};Lc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$PaymentLinkPreviewMetadata";Lc.internalSpec={isBusinessVerified:[1,e.TYPES.BOOL],providerName:[2,e.TYPES.STRING]};Mc.name="Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnail";Mc.internalSpec={directPath:[1,e.TYPES.STRING],thumbHash:[2,e.TYPES.STRING],encThumbHash:[3,e.TYPES.STRING],mediaKey:[4,e.TYPES.BYTES],mediaKeyTimestampMs:[5,e.TYPES.INT64],thumbWidth:[6,e.TYPES.INT32],thumbHeight:[7,e.TYPES.INT32]};Nc.name="Message$PeerDataOperationRequestMessage";Nc.internalSpec={peerDataOperationRequestType:[1,e.TYPES.ENUM,Ea],requestStickerReupload:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Vc],requestUrlPreview:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Uc],historySyncOnDemandRequest:[4,e.TYPES.MESSAGE,Tc],placeholderMessageResendRequest:[5,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Rc],fullHistorySyncOnDemandRequest:[6,e.TYPES.MESSAGE,Sc],syncdCollectionFatalRecoveryRequest:[7,e.TYPES.MESSAGE,Qc],historySyncChunkRetryRequest:[8,e.TYPES.MESSAGE,Pc],galaxyFlowAction:[9,e.TYPES.MESSAGE,Oc]};Oc.name="Message$PeerDataOperationRequestMessage$GalaxyFlowAction";Oc.internalSpec={type:[1,e.TYPES.ENUM,Da],flowId:[2,e.TYPES.STRING],stanzaId:[3,e.TYPES.STRING]};Pc.name="Message$PeerDataOperationRequestMessage$HistorySyncChunkRetryRequest";Pc.internalSpec={syncType:[1,e.TYPES.ENUM,h],chunkOrder:[2,e.TYPES.UINT32],chunkNotificationId:[3,e.TYPES.STRING],regenerateChunk:[4,e.TYPES.BOOL]};Qc.name="Message$PeerDataOperationRequestMessage$SyncDCollectionFatalRecoveryRequest";Qc.internalSpec={collectionName:[1,e.TYPES.STRING],timestamp:[2,e.TYPES.INT64]};Rc.name="Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequest";Rc.internalSpec={messageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec]};Sc.name="Message$PeerDataOperationRequestMessage$FullHistorySyncOnDemandRequest";Sc.internalSpec={requestMetadata:[1,e.TYPES.MESSAGE,G],historySyncConfig:[2,e.TYPES.MESSAGE,c("WAWebProtobufsCompanionReg.pb").DeviceProps$HistorySyncConfigSpec]};Tc.name="Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequest";Tc.internalSpec={chatJid:[1,e.TYPES.STRING],oldestMsgId:[2,e.TYPES.STRING],oldestMsgFromMe:[3,e.TYPES.BOOL],onDemandMsgCount:[4,e.TYPES.INT32],oldestMsgTimestampMs:[5,e.TYPES.INT64],accountLid:[6,e.TYPES.STRING]};Uc.name="Message$PeerDataOperationRequestMessage$RequestUrlPreview";Uc.internalSpec={url:[1,e.TYPES.STRING],includeHqThumbnail:[2,e.TYPES.BOOL]};Vc.name="Message$PeerDataOperationRequestMessage$RequestStickerReupload";Vc.internalSpec={fileSha256:[1,e.TYPES.STRING]};G.name="Message$FullHistorySyncOnDemandRequestMetadata";G.internalSpec={requestId:[1,e.TYPES.STRING]};Wc.name="Message$AppStateFatalExceptionNotification";Wc.internalSpec={collectionNames:[1,e.FLAGS.REPEATED|e.TYPES.STRING],timestamp:[2,e.TYPES.INT64]};Xc.name="Message$AppStateSyncKeyRequest";Xc.internalSpec={keyIds:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,H]};Yc.name="Message$AppStateSyncKeyShare";Yc.internalSpec={keys:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,ad]};Zc.name="Message$AppStateSyncKeyData";Zc.internalSpec={keyData:[1,e.TYPES.BYTES],fingerprint:[2,e.TYPES.MESSAGE,$c],timestamp:[3,e.TYPES.INT64]};$c.name="Message$AppStateSyncKeyFingerprint";$c.internalSpec={rawId:[1,e.TYPES.UINT32],currentIndex:[2,e.TYPES.UINT32],deviceIndexes:[3,e.FLAGS.REPEATED|e.FLAGS.PACKED|e.TYPES.UINT32]};H.name="Message$AppStateSyncKeyId";H.internalSpec={keyId:[1,e.TYPES.BYTES]};ad.name="Message$AppStateSyncKey";ad.internalSpec={keyId:[1,e.TYPES.MESSAGE,H],keyData:[2,e.TYPES.MESSAGE,Zc]};bd.name="Message$HistorySyncNotification";bd.internalSpec={fileSha256:[1,e.TYPES.BYTES],fileLength:[2,e.TYPES.UINT64],mediaKey:[3,e.TYPES.BYTES],fileEncSha256:[4,e.TYPES.BYTES],directPath:[5,e.TYPES.STRING],syncType:[6,e.TYPES.ENUM,h],chunkOrder:[7,e.TYPES.UINT32],originalMessageId:[8,e.TYPES.STRING],progress:[9,e.TYPES.UINT32],oldestMsgInChunkTimestampSec:[10,e.TYPES.INT64],initialHistBootstrapInlinePayload:[11,e.TYPES.BYTES],peerDataRequestSessionId:[12,e.TYPES.STRING],fullHistorySyncOnDemandRequestMetadata:[13,e.TYPES.MESSAGE,G],encHandle:[14,e.TYPES.STRING]};cd.name="Message$RequestWelcomeMessageMetadata";cd.internalSpec={localChatState:[1,e.TYPES.ENUM,Fa]};dd.name="Message$ProtocolMessage";dd.internalSpec={key:[1,e.TYPES.MESSAGE,f.MessageKeySpec],type:[2,e.TYPES.ENUM,Ga],ephemeralExpiration:[4,e.TYPES.UINT32],ephemeralSettingTimestamp:[5,e.TYPES.INT64],historySyncNotification:[6,e.TYPES.MESSAGE,bd],appStateSyncKeyShare:[7,e.TYPES.MESSAGE,Yc],appStateSyncKeyRequest:[8,e.TYPES.MESSAGE,Xc],initialSecurityNotificationSettingSync:[9,e.TYPES.MESSAGE,Ac],appStateFatalExceptionNotification:[10,e.TYPES.MESSAGE,Wc],disappearingMode:[11,e.TYPES.MESSAGE,Y],editedMessage:[14,e.TYPES.MESSAGE,j],timestampMs:[15,e.TYPES.INT64],peerDataOperationRequestMessage:[16,e.TYPES.MESSAGE,Nc],peerDataOperationRequestResponseMessage:[17,e.TYPES.MESSAGE,Bc],botFeedbackMessage:[18,e.TYPES.MESSAGE,(g=c("WAWebProtobufsAICommon.pb")).BotFeedbackMessageSpec],invokerJid:[19,e.TYPES.STRING],requestWelcomeMessageMetadata:[20,e.TYPES.MESSAGE,cd],mediaNotifyMessage:[21,e.TYPES.MESSAGE,Vd],cloudApiThreadControlNotification:[22,e.TYPES.MESSAGE,ed],lidMigrationMappingSyncMessage:[23,e.TYPES.MESSAGE,Wd],limitSharing:[24,e.TYPES.MESSAGE,f.LimitSharingSpec],aiPsiMetadata:[25,e.TYPES.BYTES],aiQueryFanout:[26,e.TYPES.MESSAGE,$d],memberLabel:[27,e.TYPES.MESSAGE,$]};ed.name="Message$CloudAPIThreadControlNotification";ed.internalSpec={status:[1,e.TYPES.ENUM,Ha],senderNotificationTimestampMs:[2,e.TYPES.INT64],consumerLid:[3,e.TYPES.STRING],consumerPhoneNumber:[4,e.TYPES.STRING],notificationContent:[5,e.TYPES.MESSAGE,fd],shouldSuppressNotification:[6,e.TYPES.BOOL]};fd.name="Message$CloudAPIThreadControlNotification$CloudAPIThreadControlNotificationContent";fd.internalSpec={handoffNotificationText:[1,e.TYPES.STRING],extraJson:[2,e.TYPES.STRING]};gd.name="Message$Chat";gd.internalSpec={displayName:[1,e.TYPES.STRING],id:[2,e.TYPES.STRING]};hd.name="Message$Call";hd.internalSpec={callKey:[1,e.TYPES.BYTES],conversionSource:[2,e.TYPES.STRING],conversionData:[3,e.TYPES.BYTES],conversionDelaySeconds:[4,e.TYPES.UINT32],ctwaSignals:[5,e.TYPES.STRING],ctwaPayload:[6,e.TYPES.BYTES],contextInfo:[7,e.TYPES.MESSAGE,Q],nativeFlowCallButtonPayload:[8,e.TYPES.STRING],deeplinkPayload:[9,e.TYPES.STRING]};I.name="Message$VideoMessage";I.internalSpec={url:[1,e.TYPES.STRING],mimetype:[2,e.TYPES.STRING],fileSha256:[3,e.TYPES.BYTES],fileLength:[4,e.TYPES.UINT64],seconds:[5,e.TYPES.UINT32],mediaKey:[6,e.TYPES.BYTES],caption:[7,e.TYPES.STRING],gifPlayback:[8,e.TYPES.BOOL],height:[9,e.TYPES.UINT32],width:[10,e.TYPES.UINT32],fileEncSha256:[11,e.TYPES.BYTES],interactiveAnnotations:[12,e.FLAGS.REPEATED|e.TYPES.MESSAGE,W],directPath:[13,e.TYPES.STRING],mediaKeyTimestamp:[14,e.TYPES.INT64],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q],streamingSidecar:[18,e.TYPES.BYTES],gifAttribution:[19,e.TYPES.ENUM,Ja],viewOnce:[20,e.TYPES.BOOL],thumbnailDirectPath:[21,e.TYPES.STRING],thumbnailSha256:[22,e.TYPES.BYTES],thumbnailEncSha256:[23,e.TYPES.BYTES],staticUrl:[24,e.TYPES.STRING],annotations:[25,e.FLAGS.REPEATED|e.TYPES.MESSAGE,W],accessibilityLabel:[26,e.TYPES.STRING],processedVideos:[27,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Xd],externalShareFullVideoDurationInSeconds:[28,e.TYPES.UINT32],motionPhotoPresentationOffsetMs:[29,e.TYPES.UINT64],metadataUrl:[30,e.TYPES.STRING],videoSourceType:[31,e.TYPES.ENUM,Ia],mediaKeyDomain:[32,e.TYPES.ENUM,i]};J.name="Message$AudioMessage";J.internalSpec={url:[1,e.TYPES.STRING],mimetype:[2,e.TYPES.STRING],fileSha256:[3,e.TYPES.BYTES],fileLength:[4,e.TYPES.UINT64],seconds:[5,e.TYPES.UINT32],ptt:[6,e.TYPES.BOOL],mediaKey:[7,e.TYPES.BYTES],fileEncSha256:[8,e.TYPES.BYTES],directPath:[9,e.TYPES.STRING],mediaKeyTimestamp:[10,e.TYPES.INT64],contextInfo:[17,e.TYPES.MESSAGE,Q],streamingSidecar:[18,e.TYPES.BYTES],waveform:[19,e.TYPES.BYTES],backgroundArgb:[20,e.TYPES.FIXED32],viewOnce:[21,e.TYPES.BOOL],accessibilityLabel:[22,e.TYPES.STRING],mediaKeyDomain:[23,e.TYPES.ENUM,i]};K.name="Message$DocumentMessage";K.internalSpec={url:[1,e.TYPES.STRING],mimetype:[2,e.TYPES.STRING],title:[3,e.TYPES.STRING],fileSha256:[4,e.TYPES.BYTES],fileLength:[5,e.TYPES.UINT64],pageCount:[6,e.TYPES.UINT32],mediaKey:[7,e.TYPES.BYTES],fileName:[8,e.TYPES.STRING],fileEncSha256:[9,e.TYPES.BYTES],directPath:[10,e.TYPES.STRING],mediaKeyTimestamp:[11,e.TYPES.INT64],contactVcard:[12,e.TYPES.BOOL],thumbnailDirectPath:[13,e.TYPES.STRING],thumbnailSha256:[14,e.TYPES.BYTES],thumbnailEncSha256:[15,e.TYPES.BYTES],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q],thumbnailHeight:[18,e.TYPES.UINT32],thumbnailWidth:[19,e.TYPES.UINT32],caption:[20,e.TYPES.STRING],accessibilityLabel:[21,e.TYPES.STRING],mediaKeyDomain:[22,e.TYPES.ENUM,i]};id.name="Message$ExtendedTextMessage";id.internalSpec={text:[1,e.TYPES.STRING],matchedText:[2,e.TYPES.STRING],description:[5,e.TYPES.STRING],title:[6,e.TYPES.STRING],textArgb:[7,e.TYPES.FIXED32],backgroundArgb:[8,e.TYPES.FIXED32],font:[9,e.TYPES.ENUM,Ma],previewType:[10,e.TYPES.ENUM,La],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q],doNotPlayInline:[18,e.TYPES.BOOL],thumbnailDirectPath:[19,e.TYPES.STRING],thumbnailSha256:[20,e.TYPES.BYTES],thumbnailEncSha256:[21,e.TYPES.BYTES],mediaKey:[22,e.TYPES.BYTES],mediaKeyTimestamp:[23,e.TYPES.INT64],thumbnailHeight:[24,e.TYPES.UINT32],thumbnailWidth:[25,e.TYPES.UINT32],inviteLinkGroupType:[26,e.TYPES.ENUM,Ka],inviteLinkParentGroupSubjectV2:[27,e.TYPES.STRING],inviteLinkParentGroupThumbnailV2:[28,e.TYPES.BYTES],inviteLinkGroupTypeV2:[29,e.TYPES.ENUM,Ka],viewOnce:[30,e.TYPES.BOOL],videoHeight:[31,e.TYPES.UINT32],videoWidth:[32,e.TYPES.UINT32],faviconMMSMetadata:[33,e.TYPES.MESSAGE,pd],linkPreviewMetadata:[34,e.TYPES.MESSAGE,jd],paymentLinkMetadata:[35,e.TYPES.MESSAGE,L],endCardTiles:[36,e.FLAGS.REPEATED|e.TYPES.MESSAGE,sd],videoContentUrl:[37,e.TYPES.STRING],musicMetadata:[38,e.TYPES.MESSAGE,V],paymentExtendedMetadata:[39,e.TYPES.MESSAGE,ld]};jd.name="Message$LinkPreviewMetadata";jd.internalSpec={paymentLinkMetadata:[1,e.TYPES.MESSAGE,L],urlMetadata:[2,e.TYPES.MESSAGE,kd],fbExperimentId:[3,e.TYPES.UINT32],linkMediaDuration:[4,e.TYPES.UINT32],socialMediaPostType:[5,e.TYPES.ENUM,Na],linkInlineVideoMuted:[6,e.TYPES.BOOL],videoContentUrl:[7,e.TYPES.STRING],musicMetadata:[8,e.TYPES.MESSAGE,V],videoContentCaption:[9,e.TYPES.STRING]};kd.name="Message$URLMetadata";kd.internalSpec={fbExperimentId:[1,e.TYPES.UINT32]};ld.name="Message$PaymentExtendedMetadata";ld.internalSpec={type:[1,e.TYPES.UINT32],platform:[2,e.TYPES.STRING],messageParamsJson:[3,e.TYPES.STRING]};L.name="Message$PaymentLinkMetadata";L.internalSpec={button:[1,e.TYPES.MESSAGE,od],header:[2,e.TYPES.MESSAGE,nd],provider:[3,e.TYPES.MESSAGE,md]};md.name="Message$PaymentLinkMetadata$PaymentLinkProvider";md.internalSpec={paramsJson:[1,e.TYPES.STRING]};nd.name="Message$PaymentLinkMetadata$PaymentLinkHeader";nd.internalSpec={headerType:[1,e.TYPES.ENUM,Oa]};od.name="Message$PaymentLinkMetadata$PaymentLinkButton";od.internalSpec={displayText:[1,e.TYPES.STRING]};pd.name="Message$MMSThumbnailMetadata";pd.internalSpec={thumbnailDirectPath:[1,e.TYPES.STRING],thumbnailSha256:[2,e.TYPES.BYTES],thumbnailEncSha256:[3,e.TYPES.BYTES],mediaKey:[4,e.TYPES.BYTES],mediaKeyTimestamp:[5,e.TYPES.INT64],thumbnailHeight:[6,e.TYPES.UINT32],thumbnailWidth:[7,e.TYPES.UINT32],mediaKeyDomain:[8,e.TYPES.ENUM,i]};M.name="Message$LocationMessage";M.internalSpec={degreesLatitude:[1,e.TYPES.DOUBLE],degreesLongitude:[2,e.TYPES.DOUBLE],name:[3,e.TYPES.STRING],address:[4,e.TYPES.STRING],url:[5,e.TYPES.STRING],isLive:[6,e.TYPES.BOOL],accuracyInMeters:[7,e.TYPES.UINT32],speedInMps:[8,e.TYPES.FLOAT],degreesClockwiseFromMagneticNorth:[9,e.TYPES.UINT32],comment:[11,e.TYPES.STRING],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q]};qd.name="Message$StatusNotificationMessage";qd.internalSpec={responseMessageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],originalMessageKey:[2,e.TYPES.MESSAGE,f.MessageKeySpec],type:[3,e.TYPES.ENUM,Pa]};N.name="Message$ContactMessage";N.internalSpec={displayName:[1,e.TYPES.STRING],vcard:[16,e.TYPES.STRING],contextInfo:[17,e.TYPES.MESSAGE,Q]};rd.name="Message$InvoiceMessage";rd.internalSpec={note:[1,e.TYPES.STRING],token:[2,e.TYPES.STRING],attachmentType:[3,e.TYPES.ENUM,Qa],attachmentMimetype:[4,e.TYPES.STRING],attachmentMediaKey:[5,e.TYPES.BYTES],attachmentMediaKeyTimestamp:[6,e.TYPES.INT64],attachmentFileSha256:[7,e.TYPES.BYTES],attachmentFileEncSha256:[8,e.TYPES.BYTES],attachmentDirectPath:[9,e.TYPES.STRING],attachmentJpegThumbnail:[10,e.TYPES.BYTES]};O.name="Message$ImageMessage";O.internalSpec={url:[1,e.TYPES.STRING],mimetype:[2,e.TYPES.STRING],caption:[3,e.TYPES.STRING],fileSha256:[4,e.TYPES.BYTES],fileLength:[5,e.TYPES.UINT64],height:[6,e.TYPES.UINT32],width:[7,e.TYPES.UINT32],mediaKey:[8,e.TYPES.BYTES],fileEncSha256:[9,e.TYPES.BYTES],interactiveAnnotations:[10,e.FLAGS.REPEATED|e.TYPES.MESSAGE,W],directPath:[11,e.TYPES.STRING],mediaKeyTimestamp:[12,e.TYPES.INT64],jpegThumbnail:[16,e.TYPES.BYTES],contextInfo:[17,e.TYPES.MESSAGE,Q],firstScanSidecar:[18,e.TYPES.BYTES],firstScanLength:[19,e.TYPES.UINT32],experimentGroupId:[20,e.TYPES.UINT32],scansSidecar:[21,e.TYPES.BYTES],scanLengths:[22,e.FLAGS.REPEATED|e.TYPES.UINT32],midQualityFileSha256:[23,e.TYPES.BYTES],midQualityFileEncSha256:[24,e.TYPES.BYTES],viewOnce:[25,e.TYPES.BOOL],thumbnailDirectPath:[26,e.TYPES.STRING],thumbnailSha256:[27,e.TYPES.BYTES],thumbnailEncSha256:[28,e.TYPES.BYTES],staticUrl:[29,e.TYPES.STRING],annotations:[30,e.FLAGS.REPEATED|e.TYPES.MESSAGE,W],imageSourceType:[31,e.TYPES.ENUM,Ra],accessibilityLabel:[32,e.TYPES.STRING],mediaKeyDomain:[33,e.TYPES.ENUM,i],qrUrl:[34,e.TYPES.STRING]};P.name="Message$SenderKeyDistributionMessage";P.internalSpec={groupId:[1,e.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,e.TYPES.BYTES]};sd.name="Message$VideoEndCard";sd.internalSpec={username:[1,e.FLAGS.REQUIRED|e.TYPES.STRING],caption:[2,e.FLAGS.REQUIRED|e.TYPES.STRING],thumbnailImageUrl:[3,e.FLAGS.REQUIRED|e.TYPES.STRING],profilePictureUrl:[4,e.FLAGS.REQUIRED|e.TYPES.STRING]};Q.name="ContextInfo";Q.internalSpec={stanzaId:[1,e.TYPES.STRING],participant:[2,e.TYPES.STRING],quotedMessage:[3,e.TYPES.MESSAGE,j],remoteJid:[4,e.TYPES.STRING],mentionedJid:[15,e.FLAGS.REPEATED|e.TYPES.STRING],conversionSource:[18,e.TYPES.STRING],conversionData:[19,e.TYPES.BYTES],conversionDelaySeconds:[20,e.TYPES.UINT32],forwardingScore:[21,e.TYPES.UINT32],isForwarded:[22,e.TYPES.BOOL],quotedAd:[23,e.TYPES.MESSAGE,yd],placeholderKey:[24,e.TYPES.MESSAGE,f.MessageKeySpec],expiration:[25,e.TYPES.UINT32],ephemeralSettingTimestamp:[26,e.TYPES.INT64],ephemeralSharedSecret:[27,e.TYPES.BYTES],externalAdReply:[28,e.TYPES.MESSAGE,xd],entryPointConversionSource:[29,e.TYPES.STRING],entryPointConversionApp:[30,e.TYPES.STRING],entryPointConversionDelaySeconds:[31,e.TYPES.UINT32],disappearingMode:[32,e.TYPES.MESSAGE,Y],actionLink:[33,e.TYPES.MESSAGE,Sd],groupSubject:[34,e.TYPES.STRING],parentGroupJid:[35,e.TYPES.STRING],trustBannerType:[37,e.TYPES.STRING],trustBannerAction:[38,e.TYPES.UINT32],isSampled:[39,e.TYPES.BOOL],groupMentions:[40,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Td],utm:[41,e.TYPES.MESSAGE,wd],forwardedNewsletterMessageInfo:[43,e.TYPES.MESSAGE,T],businessMessageForwardInfo:[44,e.TYPES.MESSAGE,zd],smbClientCampaignId:[45,e.TYPES.STRING],smbServerCampaignId:[46,e.TYPES.STRING],dataSharingContext:[47,e.TYPES.MESSAGE,ud],alwaysShowAdAttribution:[48,e.TYPES.BOOL],featureEligibilities:[49,e.TYPES.MESSAGE,R],entryPointConversionExternalSource:[50,e.TYPES.STRING],entryPointConversionExternalMedium:[51,e.TYPES.STRING],ctwaSignals:[54,e.TYPES.STRING],ctwaPayload:[55,e.TYPES.BYTES],forwardedAiBotMessageInfo:[56,e.TYPES.MESSAGE,g.ForwardedAIBotMessageInfoSpec],statusAttributionType:[57,e.TYPES.ENUM,Xa],urlTrackingMap:[58,e.TYPES.MESSAGE,Z],pairedMediaType:[59,e.TYPES.ENUM,Wa],rankingVersion:[60,e.TYPES.UINT32],memberLabel:[62,e.TYPES.MESSAGE,$],isQuestion:[63,e.TYPES.BOOL],statusSourceType:[64,e.TYPES.ENUM,Va],statusAttributions:[65,e.FLAGS.REPEATED|e.TYPES.MESSAGE,c("WAWebProtobufsStatusAttributions.pb").StatusAttributionSpec],isGroupStatus:[66,e.TYPES.BOOL],forwardOrigin:[67,e.TYPES.ENUM,Ua],questionReplyQuotedMessage:[68,e.TYPES.MESSAGE,vd],statusAudienceMetadata:[69,e.TYPES.MESSAGE,td],nonJidMentions:[70,e.TYPES.UINT32],quotedType:[71,e.TYPES.ENUM,Sa],botMessageSharingInfo:[72,e.TYPES.MESSAGE,g.BotMessageSharingInfoSpec]};td.name="ContextInfo$StatusAudienceMetadata";td.internalSpec={audienceType:[1,e.TYPES.ENUM,Ta]};R.internalDefaults={cannotBeReactedTo:!1,cannotBeRanked:!1,canRequestFeedback:!1,canBeReshared:!1,canReceiveMultiReact:!1};R.name="ContextInfo$FeatureEligibilities";R.internalSpec={cannotBeReactedTo:[1,e.TYPES.BOOL],cannotBeRanked:[2,e.TYPES.BOOL],canRequestFeedback:[3,e.TYPES.BOOL],canBeReshared:[4,e.TYPES.BOOL],canReceiveMultiReact:[5,e.TYPES.BOOL]};ud.name="ContextInfo$DataSharingContext";ud.internalSpec={showMmDisclosure:[1,e.TYPES.BOOL],encryptedSignalTokenConsented:[2,e.TYPES.STRING],parameters:[3,e.FLAGS.REPEATED|e.TYPES.MESSAGE,S],dataSharingFlags:[4,e.TYPES.INT32]};S.name="ContextInfo$DataSharingContext$Parameters";S.internalSpec={key:[1,e.TYPES.STRING],stringData:[2,e.TYPES.STRING],intData:[3,e.TYPES.INT64],floatData:[4,e.TYPES.FLOAT],contents:[5,e.TYPES.MESSAGE,S]};vd.name="ContextInfo$QuestionReplyQuotedMessage";vd.internalSpec={serverQuestionId:[1,e.TYPES.INT32],quotedQuestion:[2,e.TYPES.MESSAGE,j],quotedResponse:[3,e.TYPES.MESSAGE,j]};T.name="ContextInfo$ForwardedNewsletterMessageInfo";T.internalSpec={newsletterJid:[1,e.TYPES.STRING],serverMessageId:[2,e.TYPES.INT32],newsletterName:[3,e.TYPES.STRING],contentType:[4,e.TYPES.ENUM,Za],accessibilityText:[5,e.TYPES.STRING]};wd.name="ContextInfo$UTMInfo";wd.internalSpec={utmSource:[1,e.TYPES.STRING],utmCampaign:[2,e.TYPES.STRING]};xd.name="ContextInfo$ExternalAdReplyInfo";xd.internalSpec={title:[1,e.TYPES.STRING],body:[2,e.TYPES.STRING],mediaType:[3,e.TYPES.ENUM,ab],thumbnailUrl:[4,e.TYPES.STRING],mediaUrl:[5,e.TYPES.STRING],thumbnail:[6,e.TYPES.BYTES],sourceType:[7,e.TYPES.STRING],sourceId:[8,e.TYPES.STRING],sourceUrl:[9,e.TYPES.STRING],containsAutoReply:[10,e.TYPES.BOOL],renderLargerThumbnail:[11,e.TYPES.BOOL],showAdAttribution:[12,e.TYPES.BOOL],ctwaClid:[13,e.TYPES.STRING],ref:[14,e.TYPES.STRING],clickToWhatsappCall:[15,e.TYPES.BOOL],adContextPreviewDismissed:[16,e.TYPES.BOOL],sourceApp:[17,e.TYPES.STRING],automatedGreetingMessageShown:[18,e.TYPES.BOOL],greetingMessageBody:[19,e.TYPES.STRING],ctaPayload:[20,e.TYPES.STRING],disableNudge:[21,e.TYPES.BOOL],originalImageUrl:[22,e.TYPES.STRING],automatedGreetingMessageCtaType:[23,e.TYPES.STRING],wtwaAdFormat:[24,e.TYPES.BOOL],adType:[25,e.TYPES.ENUM,$a],wtwaWebsiteUrl:[26,e.TYPES.STRING],adPreviewUrl:[27,e.TYPES.STRING]};yd.name="ContextInfo$AdReplyInfo";yd.internalSpec={advertiserName:[1,e.TYPES.STRING],mediaType:[2,e.TYPES.ENUM,bb],jpegThumbnail:[16,e.TYPES.BYTES],caption:[17,e.TYPES.STRING]};zd.name="ContextInfo$BusinessMessageForwardInfo";zd.internalSpec={businessOwnerJid:[1,e.TYPES.STRING]};Ad.name="MessageAssociation";Ad.internalSpec={associationType:[1,e.TYPES.ENUM,cb],parentMessageKey:[2,e.TYPES.MESSAGE,f.MessageKeySpec],messageIndex:[3,e.TYPES.INT32]};Bd.name="ThreadID";Bd.internalSpec={threadType:[1,e.TYPES.ENUM,db],threadKey:[2,e.TYPES.MESSAGE,f.MessageKeySpec]};Cd.name="MessageContextInfo";Cd.internalSpec={deviceListMetadata:[1,e.TYPES.MESSAGE,U],deviceListMetadataVersion:[2,e.TYPES.INT32],messageSecret:[3,e.TYPES.BYTES],paddingBytes:[4,e.TYPES.BYTES],messageAddOnDurationInSecs:[5,e.TYPES.UINT32],botMessageSecret:[6,e.TYPES.BYTES],botMetadata:[7,e.TYPES.MESSAGE,g.BotMetadataSpec],reportingTokenVersion:[8,e.TYPES.INT32],messageAddOnExpiryType:[9,e.TYPES.ENUM,eb],messageAssociation:[10,e.TYPES.MESSAGE,Ad],capiCreatedGroup:[11,e.TYPES.BOOL],supportPayload:[12,e.TYPES.STRING],limitSharing:[13,e.TYPES.MESSAGE,f.LimitSharingSpec],limitSharingV2:[14,e.TYPES.MESSAGE,f.LimitSharingSpec],threadId:[15,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Bd]};U.internalDefaults={senderAccountType:(c=c("WAWebProtobufsAdv.pb")).ADVEncryptionType.E2EE,receiverAccountType:c.ADVEncryptionType.E2EE};U.name="DeviceListMetadata";U.internalSpec={senderKeyHash:[1,e.TYPES.BYTES],senderTimestamp:[2,e.TYPES.UINT64],senderKeyIndexes:[3,e.FLAGS.REPEATED|e.FLAGS.PACKED|e.TYPES.UINT32],senderAccountType:[4,e.TYPES.ENUM,c.ADVEncryptionType],receiverAccountType:[5,e.TYPES.ENUM,c.ADVEncryptionType],recipientKeyHash:[8,e.TYPES.BYTES],recipientTimestamp:[9,e.TYPES.UINT64],recipientKeyIndexes:[10,e.FLAGS.REPEATED|e.FLAGS.PACKED|e.TYPES.UINT32]};Dd.name="EmbeddedMessage";Dd.internalSpec={stanzaId:[1,e.TYPES.STRING],message:[2,e.TYPES.MESSAGE,j]};V.name="EmbeddedMusic";V.internalSpec={musicContentMediaId:[1,e.TYPES.STRING],songId:[2,e.TYPES.STRING],author:[3,e.TYPES.STRING],title:[4,e.TYPES.STRING],artworkDirectPath:[5,e.TYPES.STRING],artworkSha256:[6,e.TYPES.BYTES],artworkEncSha256:[7,e.TYPES.BYTES],artistAttribution:[8,e.TYPES.STRING],countryBlocklist:[9,e.TYPES.BYTES],isExplicit:[10,e.TYPES.BOOL],artworkMediaKey:[11,e.TYPES.BYTES],musicSongStartTimeInMs:[12,e.TYPES.INT64],derivedContentStartTimeInMs:[13,e.TYPES.INT64],overlapDurationInMs:[14,e.TYPES.INT64]};Ed.name="EmbeddedContent";Ed.internalSpec={embeddedMessage:[1,e.TYPES.MESSAGE,Dd],embeddedMusic:[2,e.TYPES.MESSAGE,V],__oneofs__:{content:["embeddedMessage","embeddedMusic"]}};Fd.name="TapLinkAction";Fd.internalSpec={title:[1,e.TYPES.STRING],tapUrl:[2,e.TYPES.STRING]};W.name="InteractiveAnnotation";W.internalSpec={polygonVertices:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Gd],shouldSkipConfirmation:[4,e.TYPES.BOOL],embeddedContent:[5,e.TYPES.MESSAGE,Ed],statusLinkType:[8,e.TYPES.ENUM,fb],location:[2,e.TYPES.MESSAGE,Hd],newsletter:[3,e.TYPES.MESSAGE,T],embeddedAction:[6,e.TYPES.BOOL],tapAction:[7,e.TYPES.MESSAGE,Fd],__oneofs__:{action:["location","newsletter","embeddedAction","tapAction"]}};Gd.name="Point";Gd.internalSpec={xDeprecated:[1,e.TYPES.INT32],yDeprecated:[2,e.TYPES.INT32],x:[3,e.TYPES.DOUBLE],y:[4,e.TYPES.DOUBLE]};Hd.name="Location";Hd.internalSpec={degreesLatitude:[1,e.TYPES.DOUBLE],degreesLongitude:[2,e.TYPES.DOUBLE],name:[3,e.TYPES.STRING]};Id.name="TemplateButton";Id.internalSpec={index:[4,e.TYPES.UINT32],quickReplyButton:[1,e.TYPES.MESSAGE,Ld],urlButton:[2,e.TYPES.MESSAGE,Kd],callButton:[3,e.TYPES.MESSAGE,Jd],__oneofs__:{button:["quickReplyButton","urlButton","callButton"]}};Jd.name="TemplateButton$CallButton";Jd.internalSpec={displayText:[1,e.TYPES.MESSAGE,F],phoneNumber:[2,e.TYPES.MESSAGE,F]};Kd.name="TemplateButton$URLButton";Kd.internalSpec={displayText:[1,e.TYPES.MESSAGE,F],url:[2,e.TYPES.MESSAGE,F]};Ld.name="TemplateButton$QuickReplyButton";Ld.internalSpec={displayText:[1,e.TYPES.MESSAGE,F],id:[2,e.TYPES.STRING]};Md.name="HydratedTemplateButton";Md.internalSpec={index:[4,e.TYPES.UINT32],quickReplyButton:[1,e.TYPES.MESSAGE,Pd],urlButton:[2,e.TYPES.MESSAGE,Od],callButton:[3,e.TYPES.MESSAGE,Nd],__oneofs__:{hydratedButton:["quickReplyButton","urlButton","callButton"]}};Nd.name="HydratedTemplateButton$HydratedCallButton";Nd.internalSpec={displayText:[1,e.TYPES.STRING],phoneNumber:[2,e.TYPES.STRING]};Od.name="HydratedTemplateButton$HydratedURLButton";Od.internalSpec={displayText:[1,e.TYPES.STRING],url:[2,e.TYPES.STRING],consentedUsersUrl:[3,e.TYPES.STRING],webviewPresentation:[4,e.TYPES.ENUM,gb]};Pd.name="HydratedTemplateButton$HydratedQuickReplyButton";Pd.internalSpec={displayText:[1,e.TYPES.STRING],id:[2,e.TYPES.STRING]};Qd.name="Money";Qd.internalSpec={value:[1,e.TYPES.INT64],offset:[2,e.TYPES.UINT32],currencyCode:[3,e.TYPES.STRING]};X.name="PaymentBackground";X.internalSpec={id:[1,e.TYPES.STRING],fileLength:[2,e.TYPES.UINT64],width:[3,e.TYPES.UINT32],height:[4,e.TYPES.UINT32],mimetype:[5,e.TYPES.STRING],placeholderArgb:[6,e.TYPES.FIXED32],textArgb:[7,e.TYPES.FIXED32],subtextArgb:[8,e.TYPES.FIXED32],mediaData:[9,e.TYPES.MESSAGE,Rd],type:[10,e.TYPES.ENUM,hb]};Rd.name="PaymentBackground$MediaData";Rd.internalSpec={mediaKey:[1,e.TYPES.BYTES],mediaKeyTimestamp:[2,e.TYPES.INT64],fileSha256:[3,e.TYPES.BYTES],fileEncSha256:[4,e.TYPES.BYTES],directPath:[5,e.TYPES.STRING]};Y.name="DisappearingMode";Y.internalSpec={initiator:[1,e.TYPES.ENUM,jb],trigger:[2,e.TYPES.ENUM,ib],initiatorDeviceJid:[3,e.TYPES.STRING],initiatedByMe:[4,e.TYPES.BOOL]};Sd.name="ActionLink";Sd.internalSpec={url:[1,e.TYPES.STRING],buttonTitle:[2,e.TYPES.STRING]};Td.name="GroupMention";Td.internalSpec={groupJid:[1,e.TYPES.STRING],groupSubject:[2,e.TYPES.STRING]};Ud.name="MessageSecretMessage";Ud.internalSpec={version:[1,e.TYPES.SFIXED32],encIv:[2,e.TYPES.BYTES],encPayload:[3,e.TYPES.BYTES]};Vd.name="MediaNotifyMessage";Vd.internalSpec={expressPathUrl:[1,e.TYPES.STRING],fileEncSha256:[2,e.TYPES.BYTES],fileLength:[3,e.TYPES.UINT64]};Wd.name="LIDMigrationMappingSyncMessage";Wd.internalSpec={encodedMappingPayload:[1,e.TYPES.BYTES]};Xd.name="ProcessedVideo";Xd.internalSpec={directPath:[1,e.TYPES.STRING],fileSha256:[2,e.TYPES.BYTES],height:[3,e.TYPES.UINT32],width:[4,e.TYPES.UINT32],fileLength:[5,e.TYPES.UINT64],bitrate:[6,e.TYPES.UINT32],quality:[7,e.TYPES.ENUM,a],capabilities:[8,e.FLAGS.REPEATED|e.TYPES.STRING]};Z.name="UrlTrackingMap";Z.internalSpec={urlTrackingMapElements:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,Yd]};Yd.name="UrlTrackingMap$UrlTrackingMapElement";Yd.internalSpec={originalUrl:[1,e.TYPES.STRING],unconsentedUsersUrl:[2,e.TYPES.STRING],consentedUsersUrl:[3,e.TYPES.STRING],cardIndex:[4,e.TYPES.UINT32]};$.name="MemberLabel";$.internalSpec={label:[1,e.TYPES.STRING],labelTimestamp:[2,e.TYPES.INT64]};Zd.name="AIRichResponseMessage";Zd.internalSpec={messageType:[1,e.TYPES.ENUM,g.AIRichResponseMessageType],submessages:[2,e.FLAGS.REPEATED|e.TYPES.MESSAGE,g.AIRichResponseSubMessageSpec],unifiedResponse:[3,e.TYPES.MESSAGE,g.AIRichResponseUnifiedResponseSpec],contextInfo:[4,e.TYPES.MESSAGE,Q]};$d.name="AIQueryFanout";$d.internalSpec={messageKey:[1,e.TYPES.MESSAGE,f.MessageKeySpec],message:[2,e.TYPES.MESSAGE,j],timestamp:[3,e.TYPES.INT64]};d.Message$StickerPackMessage$StickerPackOrigin=aa;d.Message$PlaceholderMessage$PlaceholderType=ba;d.Message$BCallMessage$MediaType=ca;d.Message$CallLogMessage$CallOutcome=b;d.Message$CallLogMessage$CallType=da;d.Message$ScheduledCallEditMessage$EditType=ea;d.Message$ScheduledCallCreationMessage$CallType=fa;d.Message$EventResponseMessage$EventResponseType=ga;d.Message$PinInChatMessage$Type=ha;d.Message$StatusStickerInteractionMessage$StatusStickerType=ia;d.Message$PollType=ja;d.Message$PollContentType=ka;d.Message$ButtonsResponseMessage$Type=la;d.Message$ButtonsMessage$Button$Type=ma;d.Message$ButtonsMessage$HeaderType=na;d.Message$SecretEncryptedMessage$SecretEncType=oa;d.Message$GroupInviteMessage$GroupType=pa;d.Message$InteractiveResponseMessage$Body$Format=qa;d.Message$InteractiveMessage$CarouselMessage$CarouselCardType=ra;d.Message$InteractiveMessage$ShopMessage$Surface=sa;d.Message$ListResponseMessage$ListType=ta;d.Message$ListMessage$ListType=ua;d.Message$OrderMessage$OrderSurface=va;d.Message$OrderMessage$OrderStatus=wa;d.Message$StatusQuotedMessage$StatusQuotedMessageType=xa;d.Message$PaymentInviteMessage$ServiceType=ya;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$CalendarType=za;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponent$DayOfWeekType=Aa;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$HistorySyncChunkRetryResponseCode=Ba;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$FullHistorySyncOnDemandResponseCode=Ca;d.Message$PeerDataOperationRequestMessage$GalaxyFlowAction$GalaxyFlowActionType=Da;d.Message$PeerDataOperationRequestType=Ea;d.Message$HistorySyncType=h;d.Message$RequestWelcomeMessageMetadata$LocalChatState=Fa;d.Message$ProtocolMessage$Type=Ga;d.Message$CloudAPIThreadControlNotification$CloudAPIThreadControl=Ha;d.Message$VideoMessage$VideoSourceType=Ia;d.Message$VideoMessage$Attribution=Ja;d.Message$MediaKeyDomain=i;d.Message$ExtendedTextMessage$InviteLinkGroupType=Ka;d.Message$ExtendedTextMessage$PreviewType=La;d.Message$ExtendedTextMessage$FontType=Ma;d.Message$LinkPreviewMetadata$SocialMediaPostType=Na;d.Message$PaymentLinkMetadata$PaymentLinkHeader$PaymentLinkHeaderType=Oa;d.Message$StatusNotificationMessage$StatusNotificationType=Pa;d.Message$InvoiceMessage$AttachmentType=Qa;d.Message$ImageMessage$ImageSourceType=Ra;d.ContextInfo$QuotedType=Sa;d.ContextInfo$StatusAudienceMetadata$AudienceType=Ta;d.ContextInfo$ForwardOrigin=Ua;d.ContextInfo$StatusSourceType=Va;d.ContextInfo$PairedMediaType=Wa;d.ContextInfo$StatusAttributionType=Xa;d.ContextInfo$DataSharingContext$DataSharingFlags=Ya;d.ContextInfo$ForwardedNewsletterMessageInfo$ContentType=Za;d.ContextInfo$ExternalAdReplyInfo$AdType=$a;d.ContextInfo$ExternalAdReplyInfo$MediaType=ab;d.ContextInfo$AdReplyInfo$MediaType=bb;d.MessageAssociation$AssociationType=cb;d.ThreadID$ThreadType=db;d.MessageContextInfo$MessageAddonExpiryType=eb;d.InteractiveAnnotation$StatusLinkType=fb;d.HydratedTemplateButton$HydratedURLButton$WebviewPresentationType=gb;d.PaymentBackground$Type=hb;d.DisappearingMode$Trigger=ib;d.DisappearingMode$Initiator=jb;d.KeepType=kb;d.ProcessedVideo$VideoQuality=a;d.MessageSpec=j;d.Message$StickerPackMessageSpec=k;d.Message$StickerPackMessage$StickerSpec=l;d.Message$AlbumMessageSpec=m;d.Message$PlaceholderMessageSpec=n;d.Message$BCallMessageSpec=lb;d.Message$MessageHistoryMetadataSpec=o;d.Message$MessageHistoryNoticeSpec=mb;d.Message$MessageHistoryBundleSpec=nb;d.Message$CallLogMessageSpec=ob;d.Message$CallLogMessage$CallParticipantSpec=pb;d.Message$ScheduledCallEditMessageSpec=qb;d.Message$ScheduledCallCreationMessageSpec=rb;d.Message$EventResponseMessageSpec=sb;d.Message$EncEventResponseMessageSpec=tb;d.Message$EventMessageSpec=ub;d.Message$CommentMessageSpec=vb;d.Message$EncCommentMessageSpec=wb;d.Message$EncReactionMessageSpec=xb;d.Message$PinInChatMessageSpec=yb;d.Message$KeepInChatMessageSpec=zb;d.Message$QuestionResponseMessageSpec=Ab;d.Message$StatusStickerInteractionMessageSpec=Bb;d.Message$StatusQuestionAnswerMessageSpec=Cb;d.Message$PollResultSnapshotMessageSpec=p;d.Message$PollResultSnapshotMessage$PollVoteSpec=Db;d.Message$PollVoteMessageSpec=Eb;d.Message$PollEncValueSpec=Fb;d.Message$PollUpdateMessageMetadataSpec=Gb;d.Message$PollUpdateMessageSpec=Hb;d.Message$PollCreationMessageSpec=q;d.Message$PollCreationMessage$OptionSpec=r;d.Message$StickerSyncRMRMessageSpec=Ib;d.Message$ReactionMessageSpec=Jb;d.Message$ButtonsResponseMessageSpec=Kb;d.Message$ButtonsMessageSpec=Lb;d.Message$ButtonsMessage$ButtonSpec=Mb;d.Message$ButtonsMessage$Button$NativeFlowInfoSpec=Nb;d.Message$ButtonsMessage$Button$ButtonTextSpec=Ob;d.Message$SecretEncryptedMessageSpec=Pb;d.Message$FutureProofMessageSpec=s;d.Message$DeviceSentMessageSpec=Qb;d.Message$RequestContactInfoMessageSpec=Rb;d.Message$RequestPhoneNumberMessageSpec=Sb;d.Message$NewsletterFollowerInviteMessageSpec=Tb;d.Message$NewsletterAdminInviteMessageSpec=Ub;d.Message$GroupInviteMessageSpec=Vb;d.Message$InteractiveResponseMessageSpec=Wb;d.Message$InteractiveResponseMessage$NativeFlowResponseMessageSpec=t;d.Message$InteractiveResponseMessage$BodySpec=u;d.Message$InteractiveMessageSpec=v;d.Message$InteractiveMessage$CarouselMessageSpec=w;d.Message$InteractiveMessage$NativeFlowMessageSpec=x;d.Message$InteractiveMessage$NativeFlowMessage$NativeFlowButtonSpec=Xb;d.Message$InteractiveMessage$CollectionMessageSpec=y;d.Message$InteractiveMessage$ShopMessageSpec=z;d.Message$InteractiveMessage$FooterSpec=Yb;d.Message$InteractiveMessage$BodySpec=Zb;d.Message$InteractiveMessage$HeaderSpec=$b;d.Message$ListResponseMessageSpec=ac;d.Message$ListResponseMessage$SingleSelectReplySpec=bc;d.Message$ListMessageSpec=cc;d.Message$ListMessage$ProductListInfoSpec=dc;d.Message$ListMessage$ProductListHeaderImageSpec=ec;d.Message$ListMessage$ProductSectionSpec=fc;d.Message$ListMessage$ProductSpec=gc;d.Message$ListMessage$SectionSpec=hc;d.Message$ListMessage$RowSpec=ic;d.Message$OrderMessageSpec=A;d.Message$ProductMessageSpec=B;d.Message$ProductMessage$ProductSnapshotSpec=jc;d.Message$ProductMessage$CatalogSnapshotSpec=kc;d.Message$StatusQuotedMessageSpec=lc;d.Message$TemplateButtonReplyMessageSpec=mc;d.Message$TemplateMessageSpec=C;d.Message$TemplateMessage$HydratedFourRowTemplateSpec=D;d.Message$TemplateMessage$FourRowTemplateSpec=nc;d.Message$StickerMessageSpec=E;d.Message$LiveLocationMessageSpec=oc;d.Message$PaymentInviteMessageSpec=pc;d.Message$CancelPaymentRequestMessageSpec=qc;d.Message$DeclinePaymentRequestMessageSpec=rc;d.Message$RequestPaymentMessageSpec=sc;d.Message$SendPaymentMessageSpec=tc;d.Message$HighlyStructuredMessageSpec=F;d.Message$HighlyStructuredMessage$HSMLocalizableParameterSpec=uc;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTimeSpec=vc;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeUnixEpochSpec=wc;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMDateTime$HSMDateTimeComponentSpec=xc;d.Message$HighlyStructuredMessage$HSMLocalizableParameter$HSMCurrencySpec=yc;d.Message$ContactsArrayMessageSpec=zc;d.Message$InitialSecurityNotificationSettingSyncSpec=Ac;d.Message$PeerDataOperationRequestResponseMessageSpec=Bc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResultSpec=Cc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$HistorySyncChunkRetryResponseSpec=Dc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$SyncDSnapshotFatalRecoveryResponseSpec=Ec;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$CompanionCanonicalUserNonceFetchResponseSpec=Fc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$CompanionMetaNonceFetchResponseSpec=Gc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$WaffleNonceFetchResponseSpec=Hc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$FullHistorySyncOnDemandRequestResponseSpec=Ic;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$PlaceholderMessageResendResponseSpec=Jc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponseSpec=Kc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$PaymentLinkPreviewMetadataSpec=Lc;d.Message$PeerDataOperationRequestResponseMessage$PeerDataOperationResult$LinkPreviewResponse$LinkPreviewHighQualityThumbnailSpec=Mc;d.Message$PeerDataOperationRequestMessageSpec=Nc;d.Message$PeerDataOperationRequestMessage$GalaxyFlowActionSpec=Oc;d.Message$PeerDataOperationRequestMessage$HistorySyncChunkRetryRequestSpec=Pc;d.Message$PeerDataOperationRequestMessage$SyncDCollectionFatalRecoveryRequestSpec=Qc;d.Message$PeerDataOperationRequestMessage$PlaceholderMessageResendRequestSpec=Rc;d.Message$PeerDataOperationRequestMessage$FullHistorySyncOnDemandRequestSpec=Sc;d.Message$PeerDataOperationRequestMessage$HistorySyncOnDemandRequestSpec=Tc;d.Message$PeerDataOperationRequestMessage$RequestUrlPreviewSpec=Uc;d.Message$PeerDataOperationRequestMessage$RequestStickerReuploadSpec=Vc;d.Message$FullHistorySyncOnDemandRequestMetadataSpec=G;d.Message$AppStateFatalExceptionNotificationSpec=Wc;d.Message$AppStateSyncKeyRequestSpec=Xc;d.Message$AppStateSyncKeyShareSpec=Yc;d.Message$AppStateSyncKeyDataSpec=Zc;d.Message$AppStateSyncKeyFingerprintSpec=$c;d.Message$AppStateSyncKeyIdSpec=H;d.Message$AppStateSyncKeySpec=ad;d.Message$HistorySyncNotificationSpec=bd;d.Message$RequestWelcomeMessageMetadataSpec=cd;d.Message$ProtocolMessageSpec=dd;d.Message$CloudAPIThreadControlNotificationSpec=ed;d.Message$CloudAPIThreadControlNotification$CloudAPIThreadControlNotificationContentSpec=fd;d.Message$ChatSpec=gd;d.Message$CallSpec=hd;d.Message$VideoMessageSpec=I;d.Message$AudioMessageSpec=J;d.Message$DocumentMessageSpec=K;d.Message$ExtendedTextMessageSpec=id;d.Message$LinkPreviewMetadataSpec=jd;d.Message$URLMetadataSpec=kd;d.Message$PaymentExtendedMetadataSpec=ld;d.Message$PaymentLinkMetadataSpec=L;d.Message$PaymentLinkMetadata$PaymentLinkProviderSpec=md;d.Message$PaymentLinkMetadata$PaymentLinkHeaderSpec=nd;d.Message$PaymentLinkMetadata$PaymentLinkButtonSpec=od;d.Message$MMSThumbnailMetadataSpec=pd;d.Message$LocationMessageSpec=M;d.Message$StatusNotificationMessageSpec=qd;d.Message$ContactMessageSpec=N;d.Message$InvoiceMessageSpec=rd;d.Message$ImageMessageSpec=O;d.Message$SenderKeyDistributionMessageSpec=P;d.Message$VideoEndCardSpec=sd;d.ContextInfoSpec=Q;d.ContextInfo$StatusAudienceMetadataSpec=td;d.ContextInfo$FeatureEligibilitiesSpec=R;d.ContextInfo$DataSharingContextSpec=ud;d.ContextInfo$DataSharingContext$ParametersSpec=S;d.ContextInfo$QuestionReplyQuotedMessageSpec=vd;d.ContextInfo$ForwardedNewsletterMessageInfoSpec=T;d.ContextInfo$UTMInfoSpec=wd;d.ContextInfo$ExternalAdReplyInfoSpec=xd;d.ContextInfo$AdReplyInfoSpec=yd;d.ContextInfo$BusinessMessageForwardInfoSpec=zd;d.MessageAssociationSpec=Ad;d.ThreadIDSpec=Bd;d.MessageContextInfoSpec=Cd;d.DeviceListMetadataSpec=U;d.EmbeddedMessageSpec=Dd;d.EmbeddedMusicSpec=V;d.EmbeddedContentSpec=Ed;d.TapLinkActionSpec=Fd;d.InteractiveAnnotationSpec=W;d.PointSpec=Gd;d.LocationSpec=Hd;d.TemplateButtonSpec=Id;d.TemplateButton$CallButtonSpec=Jd;d.TemplateButton$URLButtonSpec=Kd;d.TemplateButton$QuickReplyButtonSpec=Ld;d.HydratedTemplateButtonSpec=Md;d.HydratedTemplateButton$HydratedCallButtonSpec=Nd;d.HydratedTemplateButton$HydratedURLButtonSpec=Od;d.HydratedTemplateButton$HydratedQuickReplyButtonSpec=Pd;d.MoneySpec=Qd;d.PaymentBackgroundSpec=X;d.PaymentBackground$MediaDataSpec=Rd;d.DisappearingModeSpec=Y;d.ActionLinkSpec=Sd;d.GroupMentionSpec=Td;d.MessageSecretMessageSpec=Ud;d.MediaNotifyMessageSpec=Vd;d.LIDMigrationMappingSyncMessageSpec=Wd;d.ProcessedVideoSpec=Xd;d.UrlTrackingMapSpec=Z;d.UrlTrackingMap$UrlTrackingMapElementSpec=Yd;d.MemberLabelSpec=$;d.AIRichResponseMessageSpec=Zd;d.AIQueryFanoutSpec=$d}),98);
__d("WAWebProtobufsReporting.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};a.internalDefaults={minVersion:1};a.name="Reportable";a.internalSpec={minVersion:[1,(e=d("WAProtoConst")).TYPES.UINT32],maxVersion:[2,e.TYPES.UINT32],notReportableMinVersion:[3,e.TYPES.UINT32],never:[4,e.TYPES.BOOL]};b.name="Config";b.internalSpec={field:[1,e.TYPES.MAP,[e.TYPES.UINT32,c]],version:[2,e.TYPES.UINT32]};c.internalDefaults={minVersion:1};c.name="Field";c.internalSpec={minVersion:[1,e.TYPES.UINT32],maxVersion:[2,e.TYPES.UINT32],notReportableMinVersion:[3,e.TYPES.UINT32],isMessage:[4,e.TYPES.BOOL],subfield:[5,e.TYPES.MAP,[e.TYPES.UINT32,c]]};g.ReportableSpec=a;g.ConfigSpec=b;g.FieldSpec=c}),98);
__d("WAWebReportingTokenConfig",["WAWebProtobufsReporting.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a){a=atob(a);var b=a.length,c=new Uint8Array(new ArrayBuffer(b));for(var d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}var i="CgQIARIACjQIAxIwKgQIAhIAKgQIAxIAKgQICBIAKgQICxIAKhAIERIMKgQIFRIAKgQIFhIAKgQIGRIACioIBBImCAIqBggBEgIIAioGCBASAggCKhIIERIOCAIqBAgVEgAqBAgWEgAKOggFEjYIAioGCAMSAggCKgYIBBICCAIqBggFEgIIAioGCBASAggCKhIIERIOCAIqBAgVEgAqBAgWEgAKIggGEh4qBAgBEgAqEAgREgwqBAgVEgAqBAgWEgAqBAgeEgAKLggHEioqBAgCEgAqBAgHEgAqBAgKEgAqEAgREgwqBAgVEgAqBAgWEgAqBAgUEgAKLggIEioqBAgCEgAqBAgHEgAqBAgJEgAqEAgREgwqBAgVEgAqBAgWEgAqBAgVEgAKNAgJEjAqBAgCEgAqBAgGEgAqBAgHEgAqBAgNEgAqEAgREgwqBAgVEgAqBAgWEgAqBAgUEgAKKAgMEiQIAioGCAESAggCKgYIAhICCAIqCAgOEgQIAiABKgYIDxICCAIKKggSEiYIAioGCAYSAggCKgYIEBICCAIqEggREg4IAioECBUSACoECBYSAAouCBoSKioECAQSACoECAUSACoECAgSACoECA0SACoQCBESDCoECBUSACoECBYSAApCCBwSPggCKgYIARICCAIqBggCEgIIAioGCAQSAggCKgYIBRICCAIqBggGEgIIAioSCAcSDggCKgQIFRIAKgQIFhIACgwIJRIIKgYIARICIAEKUggxEk4IAioGCAISAggCKhYIAxISCAIqBggBEgIIAioGCAISAggCKhIIBRIOCAIqBAgVEgAqBAgWEgAqFggIEhIIAioGCAESAggCKgYIAhICCAIKDAg1EggqBggBEgIgAQoOCDcSCggCKgYIARICIAEKDgg6EgoIAioGCAESAiABCg4IOxIKCAIqBggBEgIgAQpSCDwSTggCKgYIAhICCAIqFggDEhIIAioGCAESAggCKgYIAhICCAIqEggFEg4IAioECBUSACoECBYSACoWCAgSEggCKgYIARICCAIqBggCEgIIAgpSCEASTggCKgYIAhICCAIqFggDEhIIAioGCAESAggCKgYIAhICCAIqEggFEg4IAioECBUSACoECBYSACoWCAgSEggCKgYIARICCAIqBggCEgIIAgo2CEISMggCKgQIAhIAKgQIBhIAKgQIBxIAKgQIDRIAKhAIERIMKgQIFRIAKgQIFhIAKgQIFBIACg4IShIKCAIqBggBEgIgAQoOCFcSCggCKgYIARICIAEKMghYEi4IAioGCAESAggCKg4IAhIKCAIqBggBEgIIAioSCAMSDggCKgQIFRIAKgQIFhIACg4IXBIKCAIqBggBEgIgAQoOCF0SCggCKgYIARICIAEKDgheEgoIAioGCAESAiAB",j=function(){function a(a){var b=a.fieldNumber,c=a.isMessage;c=c===void 0?!1:c;a=a.subfields;this.fieldNumber=b;this.isMessage=c;this.subfields=a}var b=a.prototype;b.isExtractWholeField=function(){return this.subfields==null||this.subfields.fieldsToFrank.size===0};return a}(),k=function(){function a(a){var b=this;this.fieldsToFrank=new Map();a==null||a.forEach(function(a){b.fieldsToFrank.set(a.fieldNumber,a)})}var b=a.prototype;b.getConfigForField=function(a){return this.fieldsToFrank.get(a)||null};return a}();function l(a,b,c){var d=c.minVersion,e=c.maxVersion;e=e===void 0?Infinity:e;var f=c.subfield;c=c.isMessage;if(a<d||a>e)return null;if(f==null)return new j({fieldNumber:b,isMessage:c});var g=[];f.forEach(function(b,c){c=l(a,c,b);c!=null&&g.push(c)});return new j({fieldNumber:b,isMessage:c,subfields:new k(g)})}var m=new Map();function a(a){var b=m.get(a);if(b!=null)return b;b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsReporting.pb").ConfigSpec,h(i));var c=[];(b=b.field)==null||b.forEach(function(b,d){d=l(a,d,b);d!=null&&c.push(d)});b=new k(c);m.set(a,b);return b}g.getBytesFromBase64=h;g.REPORTING_TOKEN_CONFIG_BASE64=i;g.FieldToExtract=j;g.ReportingTokenConfig=k;g.getReportingTokenConfig=a}),98);
__d("WAWebReportingTokenProtobufUtils",["WABinary"],(function(a,b,c,d,e,f,g){function a(a){return a&7}function b(a){return a>>>3}function c(a){var b=new(d("WABinary").Binary)();b.writeVarInt(a);return b.readByteArrayView()}g.getWireTypeFromTag=a;g.getFieldNumberFromTag=b;g.convertToVarInt=c}),98);
__d("WAWebReportingTokenContent",["WABinary","WAProtoConst","WAWebReportingTokenProtobufUtils","err"],(function(a,b,c,d,e,f,g){var h=function(a){this.value=a;a=d("WAWebReportingTokenProtobufUtils").convertToVarInt(a);this.size=a.length},i=function(){function a(a,b){this.valLengthSize=0;a=new(d("WABinary").Binary)(a);a.advance(b);var e=a.readVarInt(d("WABinary").parseInt64OrThrow);if(e<0||e>=4294967296)throw c("err")("Invalid tag value, out of bound: "+e);var f=d("WAWebReportingTokenProtobufUtils").getWireTypeFromTag(e);this.tag=new h(e);var g=0,i=new(d("WABinary").Binary)();i.writeVarInt(e);switch(f){case d("WAProtoConst").ENC.VARINT:e=a.readVarInt(d("WABinary").parseUint64OrThrow);i.writeVarInt(e);break;case d("WAProtoConst").ENC.BINARY:e=a.readVarInt(d("WABinary").parseUint64OrThrow);var j=a.readByteArrayView(e);g+=d("WAWebReportingTokenProtobufUtils").convertToVarInt(e).length;i.writeVarInt(e);i.writeByteArray(j);this.valLengthSize=g;break;case d("WAProtoConst").ENC.BIT64:e=a.readByteArrayView(8);i.writeByteArray(e);break;case d("WAProtoConst").ENC.BIT32:j=a.readByteArrayView(4);i.writeByteArray(j);break;default:throw c("err")("Unsupported wire type "+f)}this.bytes=i.readByteArrayView();this.start=b;this.end=b+this.bytes.length}var b=a.prototype;b.getFieldNumber=function(){return d("WAWebReportingTokenProtobufUtils").getFieldNumberFromTag(this.tag.value)};b.getWireType=function(){return d("WAWebReportingTokenProtobufUtils").getWireTypeFromTag(this.tag.value)};b.getTotalSize=function(){return this.bytes.length};b.getValueStartIdx=function(){return this.start+this.tag.size+this.valLengthSize};b.getValueEndIdx=function(){return this.end};b.getBytes=function(){return this.bytes};return a}(),j=function(){function a(a,b,c){this.tag=a,this.partsLength=b,this.parts=c,this.partsLengthInBytes=d("WAWebReportingTokenProtobufUtils").convertToVarInt(this.partsLength)}var b=a.prototype;b.getFieldNumber=function(){return d("WAWebReportingTokenProtobufUtils").getFieldNumberFromTag(this.tag.value)};b.getTotalSize=function(){return this.tag.size+this.partsLengthInBytes.length+this.parts.getTotalSize()};b.getBytes=function(){var a=new(d("WABinary").Binary)();a.writeVarInt(this.tag.value);a.writeVarInt(this.partsLength);for(var b of this.parts.fields)a.writeByteArray(b.getBytes());return a.readByteArrayView()};return a}(),k=function(){function a(){this.fields=[],this.totalSize=0}var b=a.prototype;b.add=function(a){this.fields.push(a),this.totalSize+=a.getTotalSize()};b.getTotalSize=function(){return this.totalSize};return a}();a=function(){function a(a,b){this.protobufMessage=a,this.messageConfig=b}var b=a.prototype;b.extractProtobufParts=function(a,b,c,e){var f=new k();if(e==null)return f;b=b;while(b<c){var g=new i(a,b),h=e.getConfigForField(g.getFieldNumber());b+=g.getTotalSize();if(h==null)continue;if(h.isMessage===!0||!h.isExtractWholeField()){if(g.getWireType()===d("WAProtoConst").ENC.BINARY){h=this.extractProtobufParts(a,g.getValueStartIdx(),g.getValueEndIdx(),h.isMessage===!0?this.messageConfig:h.subfields);h.fields.length>0&&f.add(new j(g.tag,h.getTotalSize(),h))}}else f.add(g)}f.fields.sort(function(a,b){return a.getFieldNumber()-b.getFieldNumber()});return f};b.getReportingTokenContent=function(){var a=this.extractProtobufParts(this.protobufMessage,0,this.protobufMessage.length,this.messageConfig);a=a.fields;var b=new(d("WABinary").Binary)();for(a of a)b.writeByteArray(a.getBytes());return b.readByteArrayView()};return a}();g.ReportingTokenContentCalculator=a}),98);
__d("WAWebAddonEncryption",["WACryptoAesGcm","WALogger","WANullthrows","WAUseCaseSecret","WAWebABProps","WAWebAddonEncryptionError","WAWebApiContact","WAWebMessagingGatingUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReportingTokenConfig","WAWebReportingTokenContent","WAWebWidToJid","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a,b){switch(a){case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return b.stanzaId+"\0"+b.addOnSenderJid;case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return b.stanzaId+"\0"+b.addOnSenderJid;default:return}}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.messageSecret,f=b.iv,g=b.stanzaId,k=b.originalMessageSender,m=b.addOnSender;b=b.parentWid;try{var n=d("WAWebWidToJid").widToUserJid(k),p=d("WAWebWidToJid").widToUserJid(m);if(d("WAWebABProps").getABPropConfigValue("lid_one_to_one_migration_event_response_force_pn_jid")&&b!=null&&b.isRegularUser()&&(a.type===d("WAWebMsgType").MsgKind.EventResponseDecrypted||a.type===d("WAWebMsgType").MsgKind.EventEditDecrypted)){if(k.isLid()){b=d("WAWebApiContact").getPhoneNumber(k);b?n=d("WAWebWidToJid").widToUserJid(b):d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["LID to PN Mapping not found for message sender"]))).sendLogs("missing-lid-to-pn-mapping-for-message-sender")}if(m.isLid()){k=d("WAWebApiContact").getPhoneNumber(m);k?p=d("WAWebWidToJid").widToUserJid(k):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["LID to PN Mapping not found for addon sender"]))).sendLogs("missing-lid-to-pn-mapping-for-addon-sender")}}b=c("WANullthrows")(o(a.type));m=b.spec;k=b.usecase;b=(yield d("WAUseCaseSecret").createUseCaseSecret({messageSecret:e,stanzaId:g,parentMsgOriginalSender:n,modificationSender:p,modificationType:k}));e=d("encodeProtobuf").encodeProtobuf(m,a.encode).readBuffer();n=(yield d("WACryptoAesGcm").gcmEncrypt(b,f,e,l(a.type,{stanzaId:g,addOnSenderJid:p})));k=(a.type===d("WAWebMsgType").MsgKind.CommentDecrypted||a.type===d("WAWebMsgType").MsgKind.EventEditDecrypted)&&d("WAWebMessagingGatingUtils").isDualEncryptedReportingTokenSendingEnabled()?new(d("WAWebReportingTokenContent").ReportingTokenContentCalculator)(new Uint8Array(e),d("WAWebReportingTokenConfig").getReportingTokenConfig(d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion())).getReportingTokenContent():null;return babelHelpers["extends"]({encPayload:n},k!=null&&{reportingTokenContent:k})}catch(b){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed encrypting an addon "," "," ",""])),g,a.type,b);throw new(d("WAWebAddonEncryptionError").DualEncryptionValidationError)(a.type,d("WAWebAddonEncryptionError").DualEncryptionValidationErrorCode.ENCRYPTION_ERROR)}});return m.apply(this,arguments)}function e(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.messageSecret,f=b.iv,g=b.stanzaId,h=b.originalMessageSender;b=b.addOnSender;try{b=d("WAWebWidToJid").widToUserJid(b);var i=c("WANullthrows")(o(a.type));i=i.usecase;e=(yield d("WAUseCaseSecret").createUseCaseSecret({messageSecret:e,stanzaId:g,parentMsgOriginalSender:d("WAWebWidToJid").widToUserJid(h),modificationSender:b,modificationType:i}));h=(yield d("WACryptoAesGcm").gcmDecrypt(e,f,a.encryptedAddOn,l(a.type,{stanzaId:g,addOnSenderJid:b})));return h}catch(b){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Failed decrypting an addon "," "," ",""])),g,a.type,b);throw new(d("WAWebAddonEncryptionError").DualEncryptionValidationError)(a.type,d("WAWebAddonEncryptionError").DualEncryptionValidationErrorCode.DECRYPTION_ERROR)}});return n.apply(this,arguments)}function o(a){switch(a){case d("WAWebMsgType").MsgKind.ReactionEncrypted:case d("WAWebMsgType").MsgKind.ReactionDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$ReactionMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.ENC_REACTION};case d("WAWebMsgType").MsgKind.PollVoteEncrypted:case d("WAWebMsgType").MsgKind.PollVoteDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$PollVoteMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE};case d("WAWebMsgType").MsgKind.CommentEncrypted:case d("WAWebMsgType").MsgKind.CommentDecrypted:return{spec:d("WAWebProtobufsE2E.pb").MessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.ENC_COMMENT};case d("WAWebMsgType").MsgKind.EventResponseEncrypted:case d("WAWebMsgType").MsgKind.EventResponseDecrypted:return{spec:d("WAWebProtobufsE2E.pb").Message$EventResponseMessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.EVENT_RESPONSE};case d("WAWebMsgType").MsgKind.EventEditEncrypted:case d("WAWebMsgType").MsgKind.EventEditDecrypted:return{spec:d("WAWebProtobufsE2E.pb").MessageSpec,usecase:d("WAUseCaseSecret").UseCaseSecretModificationType.EVENT_EDIT_ENCRYPTED}}}g.encryptAddOn=a;g.decryptAddOn=e}),98);
__d("WAWebAddonConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Unified","Pin","Comment","PollVote","Reaction","EventResponse","None"]);c=b("$InternalEnum").Mirrored(["OnlineReceive","HistorySync","Send","SendRevoke","SendRetry","Revoke","DeleteForMe","DeleteWithParent","Hydration","MarkAsRead","SetAck"]);d=Object.freeze({Regular:"Regular",WithRevokes:"WithRevokes",DualEncrypted:"DualEncrypted",DualEncryptedWithMessageTraits:"DualEncryptedWithMessageTraits"});e=Object.freeze({PinInChat:1});f.AddonTableMode=a;f.AddonProcessMode=c;f.AddonProcessorType=d;f.AddonMinimizedType=e}),66);
__d("WAWebAddonMarkAsReadUtils",["WALogger","WAWebAddonConstants","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return a.read!=null?babelHelpers["extends"]({},a,{read:!0}):a});try{a=d("WAWebAddonSelectUtils").getAddonTableMode(a[0]);yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:d("WAWebAddonConstants").AddonProcessMode.MarkAsRead,tableMode:a},{add:b})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processMarkAsRead update failed ",""])),a).tags("addons","messaging").sendLogs("processMarkAsRead")}});return function(b){return a.apply(this,arguments)}}();g.processMarkAsRead=a}),98);
__d("WAWebAddonLogUtils",[],(function(a,b,c,d,e,f){function a(a){return a.some(function(a){return a.status==="rejected"})}f.hasSettledWithError=a}),66);
__d("WAWebAddonProcessMsgs",["AddonPlaceholderMsgsUtils","Promise","WALogger","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonEncryptAddonMsgData","WAWebAddonLogUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebAddonUpdateDataUtils","WAWebHandleMsgError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.addons,f=c.processor;c=c.processMode;var g=f.convert.toDualDecryptedMsgData;if(g==null)return e;if(c===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return e;if(c!==d("WAWebAddonConstants").AddonProcessMode.OnlineReceive)return e;f=[];e=(yield (p||(p=b("Promise"))).allSettled(e.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){return d("WAWebAddonCrossWindowUtils").isRealAddonType(b)?g(b,a.getForAddon(b)):b});return function(a){return c.apply(this,arguments)}}())));for(var h of e)h.status==="fulfilled"?f.push(h.value):d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt a message: ",""])),h.reason);d("WAWebAddonLogUtils").hasSettledWithError(e)&&d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra] Failed to decrypt a message"]))).tags("messagings","addons").sendLogs(String(c)+"-decription-failed",{sampling:.01});return f});return r.apply(this,arguments)}function s(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.addons,e=b.processor,f=b.processMode,g=b.tableMode,h=e.convert.toDualDecryptedMsgData;h=h==null?c:yield q(a,b);if(e.type===d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits){c=d("AddonPlaceholderMsgsUtils").getIncomingPlaceholderKeys(b);if(c!=null){var i=(yield d("AddonPlaceholderMsgsUtils").getPlaceholderMsgKeys(g,c));h=h.filter(function(a){return!i.has(a.id.toString())})}}b=(yield e.beforeUpsert(h,{processMode:f,parents:a}));return{processor:e,processMode:f,tableMode:g,addons:b}});return t.apply(this,arguments)}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.addons,e=b.processor,f=b.processMode;b=b.tableMode;if(e.type===d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits){b=(yield d("AddonPlaceholderMsgsUtils").getPlaceholderMsgKeys(b,c.map(function(a){return a.id})));yield e.afterUpsert(c,{processMode:f,parents:a,existingPlaceholderKeys:b})}else yield e.afterUpsert(c,{processMode:f,parents:a})});return v.apply(this,arguments)}function w(a,b,c,d,e){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){var h,i=(yield (p||(p=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(a.mode,c,e).map(function(a){return s(f,a)})));h=(h=[]).concat.apply(h,i.map(function(a){a=a.addons;return a}));h.length&&(yield d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:a.mode,tableMode:c},{add:h},{metricReporter:g}));yield p.all(i.map(function(a){return u(f,a)}));d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: processed "," addon(s) during ",", table mode ",""])),e.length,a.mode,d("WAWebAddonConstants").AddonTableMode.getName(c)).devConsole(e)});return x.apply(this,arguments)}function y(a,b,c,e){var f=e.metricReporter,g=e.failSilently;return Array.from(d("WAWebAddonSortUtils").groupAddonsByTableMode(b)).map(function(e){var h=e[0];e=e[1];return w(a,h,e,c,f)["catch"](function(c){if(c instanceof d("WAWebHandleMsgError").MessageValidationError){var e;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["failed incoming addons processing ",""])),c).tags("addons","messaging").sendLogs("processAddonMsgs: "+((e=b[0])==null?void 0:e.type)+" in "+String(h))}else{e="addon-"+String(a.mode)+"-error: "+((e=b[0])==null?void 0:e.type);d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[AddonInfraError] failed saving addons in "," with "," ",""])),h,c.message,c.stack).tags("addons","messaging").sendLogs(e)}if(!g)throw c})})}function a(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(a.length===0)return{orphans:[]};var e={mode:d("WAWebAddonConstants").AddonProcessMode.OnlineReceive};a=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(a,e.mode));var f=a[0];a=a[1];a=d("WAWebAddonSortUtils").collectValidAndOrphanAddons(a,f);var g=a.validAddons;a=a.orphans;e=y(e,g,d("WAWebAddonSelectUtils").createAddonParentSelector(f),{metricReporter:c,failSilently:!0});yield (p||(p=b("Promise"))).allSettled(e);return{orphans:a}});return z.apply(this,arguments)}function c(a,b,c,d){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){a={mode:a};a=y(a,[c],d("WAWebAddonSelectUtils").createAddonParentSelector(e),{metricReporter:f,failSilently:!1});yield (p||(p=b("Promise"))).all(a)});return A.apply(this,arguments)}function B(a,b,c,d){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){var g=e.getForAddon(c),h=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebAddonEncryptAddonMsgData").createDualEncryptionHelper(c,g);return a?a.encrypt():c});return function(){return a.apply(this,arguments)}}();h=(yield (p||(p=b("Promise"))).all([h(),w({mode:a},d("WAWebAddonSelectUtils").getAddonTableMode(c),[c],e,f)]));a=h[0];return{encryptedMsgData:a,decryptedMsgData:c,parent:g}});return C.apply(this,arguments)}function e(a,b,c){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{var e=d("WAWebAddonPluginProcessor").getAddonProcessor(b);void e.updateCollection({add:[b],remove:[]},a);e=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b);d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: optimistic update "," (",") addon, id: ",", parent: ",", isParentLid: ",""])),d("WAWebAddonCrossWindowUtils").getAddonProcessorType(b),b.type,b.id.id,e.id,(e=e.participant)==null?void 0:e.isLid());e=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([b],a));b=e[0];e=e[1];a=(yield B(a,e[0],d("WAWebAddonSelectUtils").createAddonParentSelector(b),c));return a}catch(a){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["process optimistic addon msg send: "," ",""])),a.message,a.stack).tags("addons","messaging").sendLogs("failed-optimistic-addon-send");throw a}});return D.apply(this,arguments)}function f(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var c={mode:d("WAWebAddonConstants").AddonProcessMode.HistorySync},e=d("WAWebAddonSelectUtils").createAddonParentSelector(new Map());c=y(c,a,e,{failSilently:!0});yield (p||(p=b("Promise"))).allSettled(c)});return E.apply(this,arguments)}g.processMsgsAndGetOrphans=a;g.processOutgoingMsg=c;g.processOutgoingMsgOptimisticUpdate=e;g.processHistoryMsgs=f}),98);
__d("WAWebMsgKeyNewId",["WABinary","WAHex","WARandomHex","WATimeUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(){var a=d("WATimeUtils").unixTime(),b=d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),c=d("WAHex").parseHex(d("WARandomHex").randomHex(16)),e=new(d("WABinary").Binary)();e.writeInt64(a);e.writeString(b);e.writeBuffer(c);return e.readByteArrayView()};a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=new Uint8Array(yield self.crypto.subtle.digest("SHA-256",h()),0,9);return"3EB0"+d("WAHex").toHex(a)});return function(){return a.apply(this,arguments)}}();g.genMsgKeyUint=h;g.getMsgKeyNewSHA256Id=a}),98);
__d("WAWebMsgKey",["WALogger","WARandomHex","WAWebMsgKeyNewId","WAWebParseMsgKeyString","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;a=function(){function a(b){b=b;if(!b)throw c("err")("MsgKey error: obj is null/undefined");b.id instanceof a&&(b=b.id,d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MsgKey error: id is already a MsgKey"]))));var e=!c("isStringNullOrEmpty")(b.id),f=b.from!=null&&b.to!=null&&e;e=b.fromMe!==void 0&&b.remote!=null&&e;var g,n,o,p,q,r,s,t=d("WAWebUserPrefsMeUser").getMaybeMePnUser();if(!t)throw c("err")("MsgKey error: me is undefined. Running tests? Call setupGlobalsForTests first.");else if(f&&e){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unclear constructor MsgKey"]))).devConsole(b);throw c("err")("MsgKey error: unclear which constructor to use")}else if(!f&&!e){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["No matching constructor MsgKey"]))).devConsole(b);throw c("err")("MsgKey error: don't have a matching constructor")}else if(f){f=b;g=f.from;n=f.to;o=f.id;p=f.participant;q=f.selfDir;if(!(g instanceof c("WAWebWid"))||!(n instanceof c("WAWebWid"))||p&&!(p instanceof c("WAWebWid"))){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Incorrect Wid MsgKey"]))).devConsole(g,n,p);throw c("err")("MsgKey error: something is not a wid")}f=c("WAWebWid").equals(g,n);q=f?q:void 0;f&&d("WAWebUserPrefsMeUser").isMePrimary(g)?(r=q==="out",s=n):d("WAWebUserPrefsMeUser").isMePrimary(g)?(r=!0,s=n):d("WAWebUserPrefsMeUser").isMePrimary(n)?(r=!1,s=g):f&&(c("WAWebWid").isGroup(g)||c("WAWebWid").isBroadcast(g))?(r=!0,s=g):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["MsgKey case error"]))).devConsole(g,n,o,t);r!==void 0&&(this.fromMe=r);s&&(this.remote=s);o&&(this.id=o)}else if(e){f=b;r=f.fromMe;s=f.remote;o=f.id;p=f.participant;if(!(s instanceof c("WAWebWid"))||p&&!(p instanceof c("WAWebWid"))){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Incorrect Wid MsgKey"]))).devConsole(s,p);throw c("err")("MsgKey error: something is not a wid")}d("WAWebUserPrefsMeUser").isMePrimary(s)&&(q=r===!0?"out":"in");r!==void 0&&(this.fromMe=r);s&&(this.remote=s);o&&(this.id=o)}g=[this.fromMe,this.remote,this.id];q!==void 0&&(this.self=q,g.push(this.self));p!==void 0&&(this.participant=p,g.push(this.participant));this._serialized=g.join("_")}var e=a.prototype;e.toString=function(){return this._serialized};e.clone=function(){return new a({fromMe:this.fromMe,remote:this.remote,id:this.id,participant:this.participant})};e.equals=function(b){return b instanceof a&&this.toString()===b.toString()};a.fromString=function(b){if(b==null)throw c("err")("MsgKey.fromString error: str is null or not a string");return a.from(b)};a.from=function(b){if(b instanceof a)return b;var e;typeof b==="string"?e=c("WAWebParseMsgKeyString")(b):e=b;return new a({fromMe:e.fromMe,remote:d("WAWebWidFactory").createWidFromWidLike(e.remote),id:e.id,participant:e.participant?d("WAWebWidFactory").createWidFromWidLike(e.participant):void 0})};a.newId=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var b=(yield d("WAWebMsgKeyNewId").getMsgKeyNewSHA256Id());d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[msg-key] generated ",""])),b);return b}catch(b){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["getMsgKeyNewId: ",", message: ",", stack: ",""])),b.name,b.message,b.stack).devConsole(b).sendLogs("msg_key: error generating sha256 message key");return a.newId_DEPRECATED()}});function e(){return c.apply(this,arguments)}return e}();a.newId_DEPRECATED=function(){return"3EB0"+d("WARandomHex").randomHex(8)};return a}();g["default"]=a}),98);
__d("WAWebIsCagGroupCache",[],(function(a,b,c,d,e,f){a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.add=function(a){this.$1.add(a.toString())};b.remove=function(a){this.$1["delete"](a.toString())};b.isCag=function(a){return this.$1.has(a.toString())};b.clear=function(){this.$1.clear()};return a}();b=new a();c=b;f["default"]=c}),66);
__d("WAWebMsgKeyUtils",["$InternalEnum","WALogger","WANullthrows","WAWebIsCagGroupCache","WAWebUserPrefsMeUser","WAWebWid"],(function(a,b,c,d,e,f,g){var h,i,j=b("$InternalEnum").Mirrored(["Addon","Message","EditMessage"]);function a(a){return a.fromMe&&d("WAWebUserPrefsMeUser").isMeAccount(a.remote)}function k(a,b){var e=a.remote;if(e.isGroup()){if(a.participant==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["missing participant in a group "," "," ",""])),a.id,a.remote,a.fromMe).sendLogs("group-missing-participant");return!1}var f=c("WAWebIsCagGroupCache").isCag(e);return f&&b===j.Addon?!0:Boolean((f=a.participant)==null?void 0:f.isLid())}return e.isLid()}function l(a,b){if(k(b,a))return d("WAWebUserPrefsMeUser").getMeLidUserOrThrow();switch(a){case j.Addon:return c("WAWebIsCagGroupCache").isCag(b.remote)?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow();case j.EditMessage:case j.Message:return d("WAWebUserPrefsMeUser").getMePnUserOrThrow()}}function e(a,b){var e=a.remote;b=l(b,a);if(e.isBroadcastList()){var f=c("WANullthrows")(a.participant,"missing participant in broadcast"),g=a.fromMe?b:f;f=a.fromMe?f:b;return{from:g,to:f,broadcastId:e}}g=a.fromMe?b:e;f=a.fromMe?e:b;b=e.isGroup()||e.isStatus();!b&&a.participant&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["unexpected participant "," in ",""])),a.participant,e).sendLogs("msgKey-unexpected-participant",{sampling:.01});b=b?a.participant:void 0;return e.isStatus()?{from:g,to:f,author:b,broadcastId:e}:{from:g,to:f,author:b}}function f(a,b){return a.fromMe===b.fromMe&&c("WAWebWid").equals(a.remote,b.remote)&&c("WAWebWid").equals(a.participant,b.participant)}g.TranslateMsgKeyType=j;g.isNoteToSelf=a;g.isLidMsgKey=k;g.msgKeyToTargetInfo=e;g.equalSendersAddressingSensitive=f}),98);
__d("WAWebParentMsgKeyValidation",["$InternalEnum","WACustomError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PARENT_MESSAGE_KEY:"missing_parent_message_key"});c=function(a){function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("ParentMsgKeyValidationError"));g.ParentMsgKeyValidationErrorCode=a;g.ParentMsgKeyValidationError=c}),98);
__d("WAWebAddonProcessMsgsUtils",["Promise","WALogger","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonGatingUtils","WAWebAddonPerfUtils","WAWebAddonPluginProcessor","WAWebAddonQueryUtils","WAWebLidMigrationUtils","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebParentMsgKeyValidation","WAWebWid","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){var h,i;function j(a){if(a.targetMessageKey!=null)return"targetMessageKey";else if(a.pinParentKey!=null)return"pinParentKey";else if(a.pollUpdateParentKey!=null)return"pollUpdateParentKey";else if(a.reactionParentKey!=null)return"reactionParentKey";else if(a.parentMsgKey!=null)return"parentMsgKey";throw new(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationError)(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationErrorCode.MISSING_PARENT_MESSAGE_KEY)}function k(a){var b;b=(b=(b=(b=(b=a.targetMessageKey)!=null?b:a.parentMsgKey)!=null?b:a.pinParentKey)!=null?b:a.pollUpdateParentKey)!=null?b:a.reactionParentKey;if(b instanceof c("WAWebMsgKey"))return b;throw new(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationError)(d("WAWebParentMsgKeyValidation").ParentMsgKeyValidationErrorCode.MISSING_PARENT_MESSAGE_KEY)}function l(a){a=k(a);if(a.remote.isBroadcastList()){var b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message);b=a.fromMe?b.to:b.from;return new(c("WAWebMsgKey"))({remote:b,fromMe:a.fromMe,id:a.id})}return a}function m(a){var b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);if(d("WAWebAddonPluginProcessor").getAddonProcessorsMap().has(b))return a}function n(a,b){var e=new Map();a=a.map(function(a){var f=l(a),g=d("WAWebLidMigrationUtils").getAlternateMsgKey(f),h=null;if(e.has(f.toString()))h=c("nullthrows")(e.get(f.toString()));else if(g!=null&&e.has(g.toString()))h=c("nullthrows")(e.get(g.toString()));else{var i=b.get(f.toString());i==null&&g&&(i=b.get(g.toString()));i!=null&&!f.equals(i.id)&&(h=i.id,e.set(f.toString(),h))}f=(i=b.get(f.toString()))!=null?i:g!=null?b.get(g.toString()):void 0;if(f==null)return a;if(h==null)return o(a,f);i=p(a,h);return o(i,f)});e.forEach(function(a,c){var d=b.get(c);d!=null&&(b.set(a.toString(),d),b["delete"](c))});return[b,a]}function o(a,b){b=b.broadcastId!=null&&c("WAWebWid").isWid(b.broadcastId)&&Boolean((b=b.broadcastId)==null?void 0:b.isBroadcastList());if(!b)return a;b=l(a);return p(a,new(c("WAWebMsgKey"))({id:b.id,fromMe:b.fromMe,remote:b.remote}))}function p(a,b){var d=j(a),e=a.id;a.id.remote.isUser()&&b.remote.isUser()&&(e=new(c("WAWebMsgKey"))({fromMe:a.id.fromMe,remote:b.remote,id:a.id.id}));return babelHelpers["extends"]({},a,(a={id:e},a[d]=b,a))}function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.map(l),e;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(e=(yield d("WAWebAddonPerfUtils").createMessagesQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.Incoming,{type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetParentMsgs,size:c.length})));try{b=(yield r(a));(c=e)==null||c.success();return b}catch(b){(a=e)==null||a.fail();throw b}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(l);b=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(b));return n(a,b)});return s.apply(this,arguments)}function e(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var c=[];for(var e of d("WAWebAddonPluginProcessor").getAddonProcessorsMap().entries()){var f=e[0],g=e[1];d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(f)&&c.push(g.convert.fromHistorySyncMsg(a))}f=(yield (i||(i=b("Promise"))).all(c).then(function(a){var b;return(b=[]).concat.apply(b,a)}));return f}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseHistorySyncMsg: error:",""])),a).tags("addons","messaging").sendLogs("parseHistorySyncMsg");return[]}});return t.apply(this,arguments)}function f(a){var b=[],c=[],e=[];for(a of a){var f=a.parsedMsgPayload;if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(f.type)){var g=m(f);g!=null?b.push(g):c.push(a)}else f.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted?e.push(f):c.push(a)}return{unifiedAddons:b,otherOrphans:c,legacyReactionAddons:e}}g.getParentMsgKeyName=j;g.getParentMsgKey=l;g.castToAddonMsgData=m;g.updateMsgParentKeyValue=p;g.queryAddonParentMsgs=a;g.queryParentMsgs=r;g.parseHistorySyncMsg=e;g.sortAddonOrphans=f}),98);
__d("WAWebAddonProcessRevoke",["Promise","WALogger","WANullthrows","WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonGatingUtils","WAWebAddonLogUtils","WAWebAddonProcessRevokeDataUtils","WAWebAddonRetryRequestUtils","WAWebAddonSelectUtils","WAWebAddonUpdateDataUtils","WAWebMsgGetters","WAWebNoop","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=new Map(),f=[];for(var g of d("WAWebAddonConstants").AddonTableMode.members())g!==d("WAWebAddonConstants").AddonTableMode.None&&f.push(d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByMsgKey(g,a,!1).then(function(a){for(a of a)a!=null&&e.set(a.id.toString(),a)})["catch"](c("WAWebNoop")));yield (m||(m=b("Promise"))).all(f);return d("WAWebAddonSelectUtils").createAddonSelector(e)});return o.apply(this,arguments)}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=function*(){var b=g[0],c=g[1];e.push(d("WAWebAddonUpdateDataUtils").updateAddonsInTableMode({processMode:a.mode,tableMode:b},c)["catch"](function(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["storeRevokesForTableMode for ",": ",""])),b,a);throw a}))};for(var g of c)yield* f();c=(yield (m||(m=b("Promise"))).allSettled(e));d("WAWebAddonLogUtils").hasSettledWithError(c)&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["revoking addons finished with errors"]))).tags("addons","messaging").sendLogs("revokeAddonMsgs")});return q.apply(this,arguments)}function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=[],g=new Map();for(b of b){var h=e.get(c("WANullthrows")(b.protocolMessageKey));if(!d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(h))continue;var i=d("WAWebAddonSelectUtils").getTableModeByMsgType(h.type);g.has(i)||g.set(i,{add:[],remove:[]});i=c("WANullthrows")(g.get(i));b.id.equals(h.id)||i.remove.push(h);i.add.push(b);d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getFrom(h))&&f.push([h,b])}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[addon-infra]: processRevokeMsgs "," addon(s)"])),g.size).devConsole(g);yield p(a,g);yield d("WAWebAddonRetryRequestUtils").replaceSelfMessageTypeRows(f)});return s.apply(this,arguments)}function a(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={mode:d("WAWebAddonConstants").AddonProcessMode.SendRevoke};try{yield r(c,[d("WAWebAddonProcessRevokeDataUtils").protocolRevokeToRevokeMsgData(a)],d("WAWebAddonSelectUtils").createAddonSelector(new Map([[b.id.toString(),b]])))}catch(c){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["process addon revoke ",", ",": ",""])),a.id,b.id,c).tags("addons","messaging").sendLogs("processSentRevokeMsg");throw c}});return t.apply(this,arguments)}function e(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={mode:d("WAWebAddonConstants").AddonProcessMode.Revoke},c=new Set();try{var e=a.map(function(a){return a.revokeMsgKey});e=(yield n(e));var f=[];for(a of a){var g=a.revokeMsgKey;if(!e.has(g)){c.add(g);continue}g=e.get(g);g=d("WAWebAddonProcessRevokeDataUtils").revokeMsgInfoToRevokeMsgData(a,g);f.push(g)}yield r(b,f,e);return c}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["process addon revokes: ",""])),a).tags("addons","messaging").sendLogs("processAddonRevokes");throw a}});return u.apply(this,arguments)}g.processSentRevokeMsg=a;g.processRevokeMsgs=e}),98);
__d("WAWebProcessBaseMsgInfo",[],(function(a,b,c,d,e,f){a=function(a){return{id:a.id,from:a.from,to:a.to,type:a.type,t:a.t,ack:a.ack,count:null,author:a.author,notifyName:a.notifyName,invis:a.invis,subtype:a.subtype,viewMode:a.viewMode}};b=function(a){return{id:a.id,from:a.from,to:a.to,type:a.type,t:a.t,ack:a.ack,count:null,author:a.author,notifyName:a.notifyName,invis:a.invis,subtype:a.subtype,viewMode:a.viewMode}};f.msgToBaseMsgInfo=a;f.msgDataToBaseMsgInfo=b}),66);
__d("WAWebViewMode.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a={VISIBLE:"VISIBLE",HIDDEN:"HIDDEN",MEDIA_ALBUM:"MEDIA_ALBUM",INVISIBLE_PLACEHOLDER:"INVISIBLE_PLACEHOLDER",NEWSLETTER_TOMBSTONE:"NEWSLETTER_TOMBSTONE",POLL_MEDIA:"POLL_MEDIA",HISTORY_SYNCED_CALL_LOG:"HISTORY_SYNCED_CALL_LOG",CALL_LOG_OFFLINE_RESUME:"CALL_LOG_OFFLINE_RESUME",CALL_LOG_AD_HOC_GROUP_CALL:"CALL_LOG_AD_HOC_GROUP_CALL"};c=b("$InternalEnum").Mirrored(["CHAT","SEARCH","CHAT_LIST","NOTIFICATION","CHAT_SPAM_REPORT"]);f.ViewModeType=a;f.ViewModeSurface=c}),66);
__d("WAWebAddonProcessRevokeDataUtils",["WAWebAddonCrossWindowUtils","WAWebAddonProcessMsgsUtils","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=function(a,b){var c=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(b);return babelHelpers["extends"]({id:a.newMsgKey,type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:a.subtype==="admin_revoke"?"admin":"sender",revokeTimestamp:(a=a.revokeTimestamp)!=null?a:void 0},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{revokeAddonType:c,protocolMessageKey:b.id,t:d("WAWebMsgGetters").getT(b),parentMsgKey:d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b)})};b=function(a){return babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,subtype:a.subtype==="admin_revoke"?"admin":"sender",revokeTimestamp:a.revokeTimestamp,revokeAddonType:a.revokeAddonType,protocolMessageKey:a.protocolMessageKey,parentMsgKey:a.targetMessageKey})};g.revokeMsgInfoToRevokeMsgData=a;g.protocolRevokeToRevokeMsgData=b}),98);
__d("WAWebMaybe",[],(function(a,b,c,d,e,f){function a(a,b){if(a!=null)return b(a)}f.ifSome=a}),66);
__d("WAWebAddonQueryUtils",["WALogger","WAWebDBMsgUtils","WAWebLidMigrationUtils","WAWebMaybe","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(a.map(String))),c=new Map(b.map(function(a){return[a.id.toString(),a]}));if(c.size===a.length){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getParentMsgsByMsgKey: found all parent messages (",")"])),c.size);return c}b=c.size;var e=a.filter(function(a){return!c.has(a.toString())}).map(d("WAWebLidMigrationUtils").getAlternateMsgKey).filter(Boolean);if(e.length>0){e=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(e.map(String)));e.forEach(function(a){d("WAWebMaybe").ifSome(d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id),function(b){c.set(b.toString(),a)})})}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getParentMsgsByMsgKey: found "," of "," parent messages, "," without alternating keys"])),c.size,a.length,b);return c});return j.apply(this,arguments)}g.getParentMsgsByMsgKey=a}),98);
__d("WAWebAck",[],(function(a,b,c,d,e,f){a={INACTIVE:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4,PEER:5};b={NONE:-1,MESSAGE_EDIT:1,PIN_IN_CHAT:2,NEWSLETTER_MSG_EDIT:3,SENDER_REVOKE:7,ADMIN_REVOKE:8};c={SENDER:"sender",DELIVERY:"delivery",READ:"read",PLAYED:"played",INACTIVE:"inactive",READ_SELF:"read-self",PLAYED_SELF:"played-self"};f.ACK=a;f.EDIT_ATTR=b;f.ACK_STRING=c}),66);
__d("WAWebAddonRetryRequestUtils",["WALogger","WANullthrows","WAWebAck","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonDBTable","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebModelStorageUtils","WAWebSchemaSelfAddonMessageTypeTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("WAWebSchemaSelfAddonMessageTypeTable").getSelfAddonMessageTypeTable().equals(["msgId"],a.id))[0]});return k.apply(this,arguments)}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if((yield j(a.id))==null){a={msgId:a.id.id,msgType:d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a)};yield d("WAWebSchemaSelfAddonMessageTypeTable").getSelfAddonMessageTypeTable().createOrReplace(a)}});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;return d("WAWebModelStorageUtils").getStorage().lock(["self-addon-message-type"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.anyOf(["msgId"],a.map(function(a){a=a[0];return a.id.id}))),d=a.map(function(a){var b=a[0];a=a[1];return{msgId:a.id.id,msgType:b.type}});yield b.bulkRemove(c.map(function(a){return a.rowId}).filter(Boolean));yield b.bulkCreateOrReplace(d)});return function(a){return c.apply(this,arguments)}}())});return m.apply(this,arguments)}function f(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j(a));if(b==null)return;var e=d("WAWebAddonSelectUtils").getTableModeByMsgType(b.msgType);e=(yield d("WAWebAddonDBTable").addonInternalDBTable.getByMsgKey(e,a));if(e==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["msg-retry: can not find addon ","."])),a.toString());return}if(!d("WAWebAddonCrossWindowUtils").isRealAddonType(e))return{msgData:e,selfMsgRow:b};var f=e.ack;if(f==null||f<d("WAWebAck").ACK.SENT){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["msg-retry: can not find addon ","."])),a.toString()).sendLogs("msg-retry");return}f=d("WAWebAddonPluginProcessor").getAddonProcessor(e).convert.toDualEncryptedMsgData;if(f!=null){a=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs([e],d("WAWebAddonConstants").AddonProcessMode.Send));var g=a[0];a=a[1];a=d("WAWebAddonSortUtils").collectValidAndOrphanAddons(a,g);a=a.validAddons;a=a[0];g=c("WANullthrows")(g.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a).toString()));return{msgData:yield f(a,g),selfMsgRow:b}}return{msgData:e,selfMsgRow:b}});return n.apply(this,arguments)}g.hasSentAddonMsg=j;g.storeSelfMessageTypeRow=a;g.replaceSelfMessageTypeRows=e;g.getSentAddonMsgRecord=f}),98);
__d("WAWebAddonCommentTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebCommentSchema","WAWebDBCommentMessageSerialization","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={mode:d("WAWebAddonConstants").AddonTableMode.Comment,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind===d("WAWebMsgType").MsgKind.CommentDecrypted)return d("WAWebDBCommentMessageSerialization").dbRowFromCommentMessage(a);if(a.kind===d("WAWebMsgType").MsgKind.RevokedAddon)return d("WAWebDBCommentMessageSerialization").dbRowFromRevokedMsgData(a);if(a.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon)return d("WAWebDBCommentMessageSerialization").dbRowFromPlaceholderAddon(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType)});yield d("WAWebCommentSchema").getTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebCommentSchema").getTable().bulkGet(a.map(function(a){return a.toString()}),b));return a.map(function(a){return a==null?a:d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow(a)})});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebCommentSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebCommentSchema").getTable().bulkRemove(a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebCommentSchema").getTable().get(a.toString()));return a==null?null:d("WAWebDBCommentMessageSerialization").commentMessageFromDbRow(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebCommentSchema").getTable().merge(a.id.toString(),{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebCommentSchema").getTable().merge(a.toString(),{read:!0})});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebCommentSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.commentTableMode=a}),98);
__d("WAWebAddonDBTable",["WAWebAddonCommentTableMode","WAWebAddonConstants","WAWebAddonEventResponseTableMode","WAWebAddonInfraError","WAWebAddonPinTableMode","WAWebAddonPollVoteTableMode","WAWebAddonReactionTableMode","WAWebAddonSelectUtils","WAWebAddonUnifiedAddonsTableMode","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){switch(a){case d("WAWebAddonConstants").AddonTableMode.Pin:return d("WAWebAddonPinTableMode").pinTableMode;case d("WAWebAddonConstants").AddonTableMode.PollVote:return d("WAWebAddonPollVoteTableMode").pollVoteTableMode;case d("WAWebAddonConstants").AddonTableMode.Comment:return d("WAWebAddonCommentTableMode").commentTableMode;case d("WAWebAddonConstants").AddonTableMode.Reaction:return d("WAWebAddonReactionTableMode").reactionTableMode;case d("WAWebAddonConstants").AddonTableMode.EventResponse:return d("WAWebAddonEventResponseTableMode").eventResponseTableMode;case d("WAWebAddonConstants").AddonTableMode.Unified:return d("WAWebAddonUnifiedAddonsTableMode").unifiedAddonsTableMode;case d("WAWebAddonConstants").AddonTableMode.None:throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)}},i={bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return;return h(a).bulkUpsert(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return b.length===0?[]:h(a).bulkGetByParentAndSender(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return h(a).bulkGetByMsgKey(b,c)});function c(b,c,d){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).bulkGetByParentMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).bulkGetByChatWid(b)});function c(b,c){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return;return h(a).bulkRemoveByMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return h(a).updateAck(b,c)});function c(b,c,d){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return h(a).getByMsgKey(b)});function c(b,c){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return h(a).getTableSize()});function c(b){return a.apply(this,arguments)}return c}()};a={bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return i.bulkGetByParentAndSender(d("WAWebAddonSelectUtils").getTableModeByMsgType(a),b)});function c(b,c){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return i.getByMsgKey(d("WAWebAddonSelectUtils").getTableModeByMsgType(a),b)});function c(b,c){return a.apply(this,arguments)}return c}()};g.addonInternalDBTable=i;g.addonDBTable=a}),98);
__d("WAWebAddonEventResponseTableMode",["WANullthrows","WAWebAddonConstants","WAWebAddonInfraError","WAWebEventResponseDBSerialization","WAWebEventResponsesSchema","WAWebMsgGetters","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.EventResponse,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventResponsesSchema").getTable().bulkCreateOrReplace(a.map(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.EventResponseDecrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);return d("WAWebEventResponseDBSerialization").dbRowFromEventResponseMessage(a)}))});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebEventResponsesSchema").getTable().anyOf(["parentMsgKey","sender"],a.map(function(a){return[a[0].toString(),a[1].toString()]})));return a.map(d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebEventResponsesSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebEventResponsesSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(a=(yield d("WAWebEventResponsesSchema").getTable().equals(["msgKey"],a.toString())))==null?void 0:a[0];return a==null?a:d("WAWebEventResponseDBSerialization").eventResponseMessageFromDBRow(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;if(a.kind===d("WAWebMsgType").MsgKind.EventResponseEncrypted)e=a.targetMessageKey;else if(a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted)e=a.parentMsgKey;else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);yield d("WAWebEventResponsesSchema").getTable().merge([e.toString(),c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebEventResponsesSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.eventResponseTableMode=h}),98);
__d("WAWebCastToPinInChatMsg",["invariant","WAWebMsgType"],(function(a,b,c,d,e,f,g,h){function i(a){return a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE?a:null}function a(a){a=i(a);a!=null||h(0,76405);return a}g.assertPinInChatMsgData=a}),98);
__d("WAWebAddonPinTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebCastToPinInChatMsg","WAWebDBCRUDOperationsPinInChat","WAWebPinInChatSchema","WAWebPinsDbSerialization","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.Pin,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return d("WAWebPinsDbSerialization").serializePinInChatMsgData(d("WAWebCastToPinInChatMsg").assertPinInChatMsgData(a))});yield d("WAWebDBCRUDOperationsPinInChat").createOrUpdatePinInChat(a[0].id.remote,b)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length!==1)return[];a=(yield d("WAWebPinInChatSchema").getTable().get(a[0].toString()));return a==null?[]:[d("WAWebPinsDbSerialization").deserializePinInChatMsgData(a)]});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().anyOf(["chatId"],a.map(function(a){return a.toString()})));return a.map(d("WAWebPinsDbSerialization").deserializePinInChatMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebPinInChatSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().equals(["msgKey"],a.toString()))[0];return a==null?a:d("WAWebPinsDbSerialization").deserializePinInChatMsgData(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WAWebPinsDbSerialization").serializePinInChatMsgData(d("WAWebCastToPinInChatMsg").assertPinInChatMsgData(a));yield d("WAWebPinInChatSchema").getTable().merge(a.parentMsgKey,{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebPinInChatSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.pinTableMode=h}),98);
__d("WAWebPollsDbSerialization",["WAWebMsgKey","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b={msgKey:a.msgKey.toString(),parentMsgKey:a.parentMsgKey.toString(),selectedOptionLocalIds:new Uint8Array(a.selectedOptionLocalIds).buffer,senderTimestampMs:a.senderTimestampMs,sender:a.sender.toString(),read:a.read};a.t!=null&&(b.t=a.t);a.ack!=null&&(b.ack=a.ack);return b}function b(a){return{msgKey:c("WAWebMsgKey").fromString(a.msgKey),parentMsgKey:c("WAWebMsgKey").fromString(a.parentMsgKey),selectedOptionLocalIds:Array.from(new Uint8Array(a.selectedOptionLocalIds)),senderTimestampMs:a.senderTimestampMs,t:a.t,sender:d("WAWebWidFactory").createUserWidOrThrow(a.sender),ack:a.ack,read:(a=a.read)!=null?a:!0}}g.dbRowFromVote=a;g.voteFromDbRow=b}),98);
__d("WAWebAddonPollVoteTableMode",["WANullthrows","WAWebAddonConstants","WAWebAddonInfraError","WAWebDBPollsUpsertVotes","WAWebMsgType","WAWebPollsDbSerialization","WAWebPollsVoteDataUtils","WAWebPollsVotesSchema","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){return d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData(d("WAWebPollsDbSerialization").voteFromDbRow(a))},i={mode:d("WAWebAddonConstants").AddonTableMode.PollVote,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.PollVoteDecrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);return d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData(a)});yield d("WAWebDBPollsUpsertVotes").upsertVotesDb(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().anyOf(["parentMsgKey","sender"],a.map(function(a){return[a[0].toString(),a[1].toString()]})));return a.map(h)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return a.map(h)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebPollsVotesSchema").getTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPollsVotesSchema").getTable().equals(["msgKey"],a.toString()))[0];return a==null?a:h(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.kind!==d("WAWebMsgType").MsgKind.PollVoteDecrypted&&a.kind!==d("WAWebMsgType").MsgKind.PollVoteEncrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType);yield d("WAWebPollsVotesSchema").getTable().merge([a.pollUpdateParentKey.toString(),c("WANullthrows")(a.from).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield i.getByMsgKey(a));if(a!=null)return i.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebPollsVotesSchema").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.pollVoteTableMode=i}),98);
__d("WAWebCastToReactionMsg",["invariant","WAWebMsgType"],(function(a,b,c,d,e,f,g,h){function i(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION?a:null}function a(a){a=i(a);a!=null||h(0,73785);return a}g.castToReactionMsgData=i;g.assertReactionMsgData=a}),98);
__d("WAWebAddonReactionTableMode",["WANullthrows","WAWebABProps","WAWebAddonConstants","WAWebAddonInfraError","WAWebCastToReactionMsg","WAWebMsgGetters","WAWebMsgType","WAWebReactionDataUtils","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h={mode:d("WAWebAddonConstants").AddonTableMode.Reaction,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebReactionDataUtils").reactionMsgDataToReactionRow(d("WAWebCastToReactionMsg").assertReactionMsgData(a))});yield d("WAWebSchemaReactions").getReactionsTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","senderUserJid"],a.map(function(a){var b=a[0];a=a[1];return[b.toString(),a.toString()]})));return a.map(d("WAWebReactionDataUtils").reactionRowToReactionMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WAWebABProps").getABPropConfigValue("web_anr_dedup_reactions_table_queries_enabled")?b=(yield j(a)):b=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey"],a.map(function(a){return a.toString()})));return b.map(d("WAWebReactionDataUtils").reactionRowToReactionMsgData)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaReactions").getReactionsTable().bulkRemoveByIndex(["msgKey"],a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().equals(["msgKey"],a.toString()))[0];return a==null?a:d("WAWebReactionDataUtils").reactionRowToReactionMsgData(a)});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e;if(a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted)e=a.targetMessageKey;else if(a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted)e=a.reactionParentKey;else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType);yield d("WAWebSchemaReactions").getReactionsTable().merge([e.toString(),c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString()],{ack:b})});function e(b,c){return a.apply(this,arguments)}return e}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h.getByMsgKey(a));if(a!=null)return h.bulkUpsert([babelHelpers["extends"]({},a,{read:!0})])});function c(b){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSchemaReactions").getReactionsTable().count()});function c(){return a.apply(this,arguments)}return c}()},i=new Map();function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return a.toString()});var b=a.join("|"),c=i.get(b);if(c!=null)return c;c=d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey"],a)["finally"](function(){i["delete"](b)});i.set(b,c);return c});return k.apply(this,arguments)}g.reactionTableMode=h}),98);
__d("WAWebAddonUnifiedAddonsTableMode",["WAWebAddonConstants","WAWebAddonInfraError","WAWebMsgType","WAWebPinsDbSerialization","WAWebSchemaUnifiedAddons","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){return a.map(function(a){if(a.rowType===d("WAWebAddonConstants").AddonMinimizedType.PinInChat)return d("WAWebPinsDbSerialization").unifiedAddonRowIntoPinInChatMsgData(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType)})};a={mode:d("WAWebAddonConstants").AddonTableMode.Unified,bulkUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){if(a.kind===d("WAWebMsgType").MsgKind.PinInChat)return d("WAWebPinsDbSerialization").pinInChatMsgDatIntoUnifiedAddonRow(a);throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});yield d("WAWebSchemaUnifiedAddons").getTable().bulkCreateOrReplace(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByParentAndSender:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),bulkGetByParentMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().anyOf(["targetMsgKey"],a.map(function(a){return a.toString()})));return h(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkGetByChatWid:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().anyOf(["arbitraryIndex"],a.map(function(a){return a.toString()})));return h(a)});function c(b){return a.apply(this,arguments)}return c}(),bulkRemoveByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaUnifiedAddons").getTable().bulkRemove(a.map(function(a){return a.toString()}))});function c(b){return a.apply(this,arguments)}return c}(),getByMsgKey:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaUnifiedAddons").getTable().get(a.toString()));return a==null?null:h([a])[0]});function c(b){return a.apply(this,arguments)}return c}(),updateAck:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebSchemaUnifiedAddons").getTable().merge(a.id.toString(),{ack:b})});function c(b,c){return a.apply(this,arguments)}return c}(),markAsRead:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});function c(){return a.apply(this,arguments)}return c}(),getTableSize:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebSchemaUnifiedAddons").getTable().count()});function c(){return a.apply(this,arguments)}return c}()};g.unifiedAddonsTableMode=a}),98);
__d("AddonPlaceholderMsgsUtils",["WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonInfraError","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var b=a.addons;a=a.processor;if(a.type!==d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedFeature);a=[];for(b of b)b.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon&&a.push(b.id);return a.length===0?null:a}function c(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByMsgKey(a,b));b=new Set();for(a of a)a!=null&&a.kind===d("WAWebMsgType").MsgKind.PlaceholderAddon&&b.add(a.id.toString());return b});return h.apply(this,arguments)}g.getIncomingPlaceholderKeys=a;g.getPlaceholderMsgKeys=c}),98);
__d("WAWebAddOnParseWebMsgInfo",["WALongInt","WANullthrows","WATimeUtils","WAWebE2EProtoUtils","WAWebMsgKey","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a,b,e){var f=!!a.fromMe,g=d("WAWebE2EProtoUtils").decodeJid(a.remoteJid);b=b===!0?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow();var h;f?g!=null&&typeof g!=="string"&&!g.isUser()&&(h=b):h=e!=null?d("WAWebE2EProtoUtils").decodeJid(e):d("WAWebE2EProtoUtils").decodeJid(a.participant);if(typeof g==="string"||g==null)return null;h!=null&&typeof h!=="string"?e=new(c("WAWebMsgKey"))({id:c("WANullthrows")(a.id),fromMe:f,remote:g,participant:h}):e=new(c("WAWebMsgKey"))({id:c("WANullthrows")(a.id),fromMe:f,remote:g});a=e.participant||e.remote;g=d("WAWebWidFactory").asUserWidOrThrow(f===!0?b:a);return{msgKey:e,sender:g}}function b(a){return a==null?null:Math.floor(d("WALongInt").numberOrThrowIfTooLarge(a)/1e3)}function e(a){var b=d("WATimeUtils").unixTimeMs();return a==null?b:Math.max(a+1,b)}g.buildAddonMsgKey=a;g.getAddonServerTimestamp=b;g.getIncreasingLatestSenderTimestampMs=e}),98);
__d("WAWebAddonGatingUtils",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebAddonPluginProcessor").hasAddonProcessor(a)?d("WAWebAddonPluginProcessor").getAddonProcessor(a).isEnabled():!1}function b(a){a=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(a);return a==null||!d("WAWebAddonCrossWindowUtils").isInfraSupportedAddon(a)?!1:d("WAWebAddonPluginProcessor").getAddonProcessor(a).isEnabled()}g.isUnifiedInfraEnabledForType=a;g.isUnifiedInfraEnabled=b}),98);
__d("WAWebAddonHydrationUtils",["WALogger","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonDBTable","WAWebAddonPerfUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsHistorySync","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i={};function a(a){var b,c=a;b=c.length&&((b=d("WAWebUserPrefsHistorySync").getHistorySyncStatus())==null?void 0:b.recentCompleted)===!0&&c[0].type!==d("WAWebMsgType").MSG_TYPE.REACTION;b&&(c=a.filter(function(a){var b;a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE?b=a.id.remote:b=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a);return k(b,d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a))}));return c}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.ids,e=a.hydrationType;a=function(a){i[e]||(i[e]=new Set());if(k(a,e))return;i[e].add(a.toString())};b=b.filter(function(a){return!k(a,e)});if(b.length===0)return;var f;try{var g=d("WAWebAddonSelectUtils").getTableModeByMsgType(e);if(e===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE){f=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.UI,{mode:g,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetByChatWid,size:1}));var j=b.map(function(a){return a instanceof c("WAWebWid")?a:null}).filter(Boolean);j=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByChatWid(g,j))}else{f=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(d("WAWebAddonPerfUtils").AddonQplMarkerType.UI,{mode:g,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkGetByParentMsgKeys,size:1}));var l=b.map(function(a){return a instanceof c("WAWebMsgKey")?a:null}).filter(Boolean);j=(yield d("WAWebAddonDBTable").addonInternalDBTable.bulkGetByParentMsgKey(g,l))}(g=f)==null||g.success();j.length&&(yield d("WAWebAddonPluginProcessor").getAddonProcessor(e).updateCollection({add:j,remove:[]},d("WAWebAddonConstants").AddonProcessMode.Hydration));l=d("WAWebUserPrefsHistorySync").getHistorySyncStatus();(l==null?void 0:l.recentCompleted)===!0&&b.forEach(a)}catch(a){(g=f)==null||g.fail();d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Addon][Hydration] Failed to hydrate "," for "," with error, ",""])),e,b.map(function(a){return a.toString()}),a).sendLogs("hydratingAddonMsgs",{sampling:.01})}});return j.apply(this,arguments)}function k(a,b){return Boolean((b=i[b])==null?void 0:b.has(a.toString()))}function f(){for(var a of Object.keys(i))delete i[a]}g.filterAddonsByHydratedStatus=a;g.hydrateAddons=e;g.clearHydrationCache=f}),98);
__d("WAWebAddonPerfUtils",["$InternalEnum","WANullthrows","WAQplTypes","WAWebABProps","WAWebAddonConstants","WAWebAddonDBTable","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({BulkUpsert:"bulk_upsert",BulkRemoveByParents:"bulk_remove_by_parents",BulkGetByParentMsgKeys:"bulk_get_by_parent_msg_keys",BulkGetByChatWid:"bulk_get_by_chat_wid",BulkGetParentMsgs:"bulk_get_parent_msgs"}),i=b("$InternalEnum").Mirrored(["Incoming","Outgoing","UI"]);function j(a){if(a<10001)return 1e4;else if(a<30001)return 3e4;else if(a<500001)return 5e4;else if(a<1000001)return 1e5;else if(a<3000001)return 3e5;else if(a<5000001)return 5e5;else if(a<8000001)return 8e5;return 1e6}var k={date:0,values:new Map()};function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=k,c=new Date().setHours(0,0,0,0);if(b.date===c){var e=b.values.get(a);if(e==null){var f=j(yield d("WAWebAddonDBTable").addonInternalDBTable.getTableSize(a));b.values.set(a,f);return f}return e}b.date=c;b.values.clear();f=j(yield d("WAWebAddonDBTable").addonInternalDBTable.getTableSize(a));b.values.set(a,f);return f});return m.apply(this,arguments)}function n(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a="messages",b=k,c=new Date().setHours(0,0,0,0);if(b.date===c){var e=b.values.get(a);if(e==null){var f=j(yield d("WAWebSchemaMessage").getMessageTable().count());b.values.set(a,f);return f}return e}b.date=c;b.values.clear();f=j(yield d("WAWebSchemaMessage").getMessageTable().count());b.values.set(a,f);return f});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{string:{request_type:h.getName(a.type),table_mode:d("WAWebAddonConstants").AddonTableMode.getName(a.mode)},"int":{request_size:a.size,table_size:yield l(a.mode)}}});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return{string:{request_type:h.getName(a.type),table_mode:"messages"},"int":{request_size:a.size,table_size:yield n()}}});return s.apply(this,arguments)}function t(){return d("WAWebABProps").getABPropConfigValue("addon_infra_enable_perf_logging")}function u(a){return{success:function(){return a==null?void 0:a.end(d("WAQplTypes").QuickLogActionType.SUCCESS)},fail:function(){return a==null?void 0:a.end(d("WAQplTypes").QuickLogActionType.FAIL)}}}function v(a){var b=Math.random();return b<=a/100?!0:!1}function w(a,b){switch(a){case i.Incoming:return b===d("WAWebAddonConstants").AddonTableMode.Reaction?v(3):v(10);case i.Outgoing:return v(25);case i.UI:return v(1)}}function x(a,b,c){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(!t())return;if(!w(a,b))return;var f;switch(a){case i.Incoming:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_PROCESS_INCOMING;break;case i.Outgoing:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_PROCESS_OUTGOING;break;case i.UI:f=d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ADDON_CHAT_REQUEST;break}b=d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(c("WANullthrows")(f),{annotations:yield e()});return u(b)});return y.apply(this,arguments)}function a(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return x(a,b.mode,function(){return p(b)})});return z.apply(this,arguments)}function e(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return x(a,d("WAWebAddonConstants").AddonTableMode.None,function(){return r(b)})});return A.apply(this,arguments)}g.AnnotationRequestType=h;g.AddonQplMarkerType=i;g.getCachedTableSize=l;g.createAddonQplMarker=a;g.createMessagesQplMarker=e}),98);
__d("WAWebAddonSelectUtils",["WAWebABProps","WAWebAddonConstants","WAWebAddonCrossWindowUtils","WAWebAddonInfraError","WAWebAddonProcessMsgsUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a){if(a===d("WAWebMsgType").MSG_TYPE.REVOKED)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType,"revoke is not expected to cross this path");if(a===d("WAWebMsgType").MSG_TYPE.PROTOCOL)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType,"protocol revoke is not expected to cross this path");switch(a){case d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE:return d("WAWebABProps").getABPropConfigValue("unified_pin_addon_table_enabled")?d("WAWebAddonConstants").AddonTableMode.Unified:d("WAWebAddonConstants").AddonTableMode.Pin;case d("WAWebMsgType").MSG_TYPE.COMMENT:return d("WAWebAddonConstants").AddonTableMode.Comment;case d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:return d("WAWebAddonConstants").AddonTableMode.PollVote;case d("WAWebMsgType").MSG_TYPE.REACTION_ENC:case d("WAWebMsgType").MSG_TYPE.REACTION:return d("WAWebAddonConstants").AddonTableMode.Reaction;case d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE:return d("WAWebAddonConstants").AddonTableMode.EventResponse;case d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED:return d("WAWebAddonConstants").AddonTableMode.None;default:throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.NotSupportedMsgType,"received "+a+" msgType")}}function a(a){return h(d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a))}function b(a){return{getByParentMsgKey:function(b){b=a.get(b);if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b},getForAddon:function(b){b=a.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(b).toString());if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b}}}function c(a){return{get:function(b){b=a.get(b.toString());if(b==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);return b},has:function(b){return Boolean(a.get(b.toString()))}}}g.getTableModeByMsgType=h;g.getAddonTableMode=a;g.createAddonParentSelector=b;g.createAddonSelector=c}),98);
__d("WAWebMessageAssociationConstants",["WAWebMsgType"],(function(a,b,c,d,e,f,g){a=new Set([d("WAWebMsgType").MSG_TYPE.ALBUM]);g.orphanIneligibleFutureproofTypes=a}),98);
__d("WAWebAddonSortUtils",["WAWebAddonCrossWindowUtils","WAWebAddonPluginProcessor","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebMessageAssociationConstants","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a,b){a=h(a,b);b=a.orphans;a=a.nonOrphans;return{orphans:b,validAddons:a}}function h(a,b){var e=[],f=[];for(a of a){var g=b.get(d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a).toString()),h=g==null||(g==null?void 0:g.type)===d("WAWebMsgType").MSG_TYPE.UNKNOWN;(g==null?void 0:g.futureproofType)!=null?h=!d("WAWebMessageAssociationConstants").orphanIneligibleFutureproofTypes.has(g.futureproofType):(g==null?void 0:g.type)===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&(h=!0);if(h)e.push(a);else if(g!=null){g=g.broadcastId!=null&&c("WAWebWid").isWid(g.broadcastId)&&Boolean((h=g.broadcastId)==null?void 0:h.isBroadcastList());g?f.push(babelHelpers["extends"]({},a,{author:void 0})):f.push(a)}}return{orphans:e,nonOrphans:f}}function b(a){var b=new Map();for(a of a){var c=d("WAWebAddonSelectUtils").getAddonTableMode(a);b.has(c)||b.set(c,[]);(c=b.get(c))==null||c.push(a)}return b}function e(a,b,c){var e=new Map();for(c of c){var f=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(c);if(!e.has(f)){var g=d("WAWebAddonPluginProcessor").getAddonProcessor(f);e.set(f,{processor:g,processMode:a,tableMode:b,addons:[]})}(g=e.get(f))==null||g.addons.push(c)}return Array.from(e.values())}g.collectValidAndOrphanAddons=a;g.collectValidAndOrphans=h;g.groupAddonsByTableMode=b;g.groupAddonsByProcessor=e}),98);
__d("WAWebAddonUpdateDataUtils",["Promise","WANullthrows","WAWebAddonConstants","WAWebAddonDBTable","WAWebAddonHydrationUtils","WAWebAddonInfraError","WAWebAddonPerfUtils","WAWebAddonProcessMsgsUtils","WAWebAddonSelectUtils","WAWebAddonSortUtils","WAWebCommentUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new Set([(e=d("WAWebAddonConstants")).AddonProcessMode.OnlineReceive,e.AddonProcessMode.Revoke,e.AddonProcessMode.DeleteForMe,e.AddonProcessMode.DeleteWithParent]);function j(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var i,j,k=[];i=(i=f.removeByMsgKey)!=null?i:[];j=(j=f.removeByMsgKey)!=null?j:[];f.remove!=null&&f.remove.length>0&&(i=i.concat(f.remove.map(function(a){return a.id})),j=j.concat(d("WAWebAddonHydrationUtils").filterAddonsByHydratedStatus(f.remove).map(function(a){return a.id})));if(e!==d("WAWebAddonConstants").AddonTableMode.None){if(f.add!=null&&f.add.length>0){var l=function(){var i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var i,j;g==null||(i=g.sendPerfReporter)==null||i.startSavedStage();var k=(yield d("WAWebAddonPerfUtils").createAddonQplMarker(a===d("WAWebAddonConstants").AddonProcessMode.Send?d("WAWebAddonPerfUtils").AddonQplMarkerType.Outgoing:d("WAWebAddonPerfUtils").AddonQplMarkerType.Incoming,{mode:e,type:d("WAWebAddonPerfUtils").AnnotationRequestType.BulkUpsert,size:f.add.length}));try{a===d("WAWebAddonConstants").AddonProcessMode.SetAck?yield (h||(h=b("Promise"))).all(f.add.map(function(a){return d("WAWebAddonDBTable").addonInternalDBTable.updateAck(e,a,c("WANullthrows")(a.ack,"ack is not defined"))})):yield d("WAWebAddonDBTable").addonInternalDBTable.bulkUpsert(e,f.add),k==null||k.success()}catch(a){k==null||k.fail();throw a}g==null||(j=g.sendPerfReporter)==null||j.postSavedStage()});return function(){return i.apply(this,arguments)}}();k.push(l())}i.length>0&&k.push(d("WAWebAddonDBTable").addonInternalDBTable.bulkRemoveByMsgKey(e,i))}k.length>0&&(yield (h||(h=b("Promise"))).all(k));return{removeFromUICollection:j}});return k.apply(this,arguments)}function a(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=a.processMode;a=a.tableMode;e=e==null?void 0:e.metricReporter;if(f===d("WAWebAddonConstants").AddonProcessMode.Hydration)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError);var g=(yield j(f,a,c,e)),k=g.removeFromUICollection;if(f===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;if(c.add!=null){var l,m;e==null||(l=e.sendPerfReporter)==null||l.startRenderedStage();yield (h||(h=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(f,a,c.add).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebAddonHydrationUtils").filterAddonsByHydratedStatus(a.addons),c=b.length!==0||k.length!==0||f===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive;c&&(yield a.processor.updateCollection({add:b,remove:k},f),i.has(f)&&(yield a.processor.manageNotifications({add:f===d("WAWebAddonConstants").AddonProcessMode.Revoke?[]:a.addons,remove:k},{processMode:f})))});return function(b){return a.apply(this,arguments)}}()));e==null||(m=e.sendPerfReporter)==null||m.postRenderedStage()}else if(c.remove!=null){yield (h||(h=b("Promise"))).all(d("WAWebAddonSortUtils").groupAddonsByProcessor(f,a,c.remove).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a.processor.updateCollection({add:[],remove:k},f),i.has(f)&&(yield a.processor.manageNotifications({add:[],remove:k},{processMode:f}))});return function(b){return a.apply(this,arguments)}}()));if(f===d("WAWebAddonConstants").AddonProcessMode.DeleteForMe&&a===d("WAWebAddonConstants").AddonTableMode.Comment){g=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(c.remove,d("WAWebAddonConstants").AddonProcessMode.DeleteForMe));e=g[0];a=[];for(g of c.remove)g.kind===d("WAWebMsgType").MsgKind.CommentDecrypted&&a.push(g);yield d("WAWebCommentUtils").updateReplyCount([],d("WAWebAddonSelectUtils").createAddonParentSelector(e),a)}}else throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedError)});return l.apply(this,arguments)}g.updateAddonsInTableMode=a}),98);
__d("WAWebBusinessProfileVersioningBridge",["WAWebBizGatingUtils"],(function(a,b,c,d,e,f,g){var h=3,i=4,j=16,k=32,l=64,m=128,n=256;function a(){return o(d("WAWebBizGatingUtils").webBizProfileOptions())}function o(a){var b=h|i|j|l|m|k;d("WAWebBizGatingUtils").bizLinkedAccountsEnabled()&&(b|=n);return a&b}g.DIRECT_CONNECTION_FLAG=m;g.getBusinessProfileQueryVersion=a;g.getBusinessProfileQueryVersionWithCustomBizProfileOptions=o}),98);
__d("WAWebMsgTunnelBridge",["WAWebMsgSyncTunnelConfig"],(function(a,b,c,d,e,f,g){a={setActiveChat:function(a){if(a==null)return;d("WAWebMsgSyncTunnelConfig").setMsgSyncTunnelConfig({openedChat:a})},resetActiveChat:function(a){if(a==null)return;d("WAWebMsgSyncTunnelConfig").resetMsgSyncTunnelOpenedChat(a)}};g.msgSyncTunnelBridge=a}),98);
__d("WAWeb-curve25519-donna",[],(function $module_WAWeb_curve25519_donna(global,require,requireDynamic,requireLazy,module,exports){var e={},aa={},l;for(l in e)e.hasOwnProperty(l)&&(aa[l]=e[l]);e.read=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return b.responseText};"undefined"!=typeof arguments&&(e.arguments=arguments);"undefined"!==typeof console?(e.print||(e.print=function(a){}),e.printErr||(e.printErr=function(a){})):e.print||(e.print=function(){});"undefined"===typeof e.setWindowTitle&&(e.setWindowTitle=function(a){document.title=a});function ba(a){eval.call(null,a)}!e.load&&e.read&&(e.load=function(a){ba(e.read(a))});e.print||(e.print=function(){});e.printErr||(e.printErr=e.print);e.arguments||(e.arguments=[]);e.thisProgram||(e.thisProgram="./this.program");e.print=e.print;e.S=e.printErr;e.preRun=[];e.postRun=[];for(l in aa)aa.hasOwnProperty(l)&&(e[l]=aa[l]);var n={cb:function(a){ca=a},Ua:function(){return ca},na:function(){return m},X:function(a){m=a},Aa:function(a){switch(a){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:return"*"===a[a.length-1]?n.H:"i"===a[0]?(a=parseInt(a.substr(1)),assert(0===a%8),a/8):0}},Ta:function(a){return Math.max(n.Aa(a),n.H)},dd:16,Bd:function(a,b){"double"===b||"i64"===b?a&7&&(assert(4===(a&7)),a+=4):assert(0===(a&3));return a},od:function(a,b,c){return c||"i64"!=a&&"double"!=a?a?Math.min(b||(a?n.Ta(a):0),n.H):Math.min(b,8):8},J:function(a,b,c){return c&&c.length?(c.splice||(c=Array.prototype.slice.call(c)),c.splice(0,0,b),e["dynCall_"+a].apply(null,c)):e["dynCall_"+a].call(null,b)},U:[],Ma:function(a){for(var b=0;b<n.U.length;b++)if(!n.U[b])return n.U[b]=a,2*(1+b);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},$a:function(a){n.U[(a-2)/2]=null},M:function(a){n.M.ma||(n.M.ma={}),n.M.ma[a]||(n.M.ma[a]=1,e.S(a))},ha:{},rd:function(a,b){assert(b);n.ha[b]||(n.ha[b]={});var c=n.ha[b];c[a]||(c[a]=function(){return n.J(b,a,arguments)});return c[a]},pd:function(){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},W:function(a){var b=m;m=m+a|0;m=m+15&-16;return b},Ia:function(a){var b=p;p=p+a|0;p=p+15&-16;return b},P:function(a){var b=v;v=v+a|0;v=v+15&-16;(a=v>=w)&&(z("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+w+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 "),a=!0);return a?(v=b,0):b},ea:function(a,b){return Math.ceil(a/(b?b:16))*(b?b:16)},xd:function(a,b,c){return c?+(a>>>0)+4294967296*+(b>>>0):+(a>>>0)+4294967296*+(b|0)},La:8,H:4,ed:0};e.Runtime=n;n.addFunction=n.Ma;n.removeFunction=n.$a;var A=!1,da,fa,ca;function assert(a,b){a||z("Assertion failed: "+b)}function ga(a){var b=e["_"+a];if(!b)try{b=eval("_"+a)}catch(c){}assert(b,"Cannot call unknown function "+a+" (perhaps LLVM optimizations or closure removed it?)");return b}var ha,ia;(function(){function a(a){a=a.toString().match(d).slice(1);return{arguments:a[0],body:a[1],returnValue:a[2]}}var b={stackSave:function(){n.na()},stackRestore:function(){n.X()},arrayToC:function(a){var b=n.W(a.length);ja(a,b);return b},stringToC:function(a){var b=0;null!==a&&void 0!==a&&0!==a&&(b=n.W((a.length<<2)+1),ka(a,b));return b}},c={string:b.stringToC,array:b.arrayToC};ia=function(a,b,d,f,h){a=ga(a);var q=[],y=0;if(f)for(var B=0;B<f.length;B++){var J=c[d[B]];J?(0===y&&(y=n.na()),q[B]=J(f[B])):q[B]=f[B]}d=a.apply(null,q);"string"===b&&(d=la(d));if(0!==y){if(h&&h.async){EmterpreterAsync.hd.push(function(){n.X(y)});return}n.X(y)}return d};var d=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/,f={},h;for(h in b)b.hasOwnProperty(h)&&(f[h]=a(b[h]));ha=function(b,c,d){d=d||[];var h=ga(b);b=d.every(function(a){return"number"===a});var u="string"!==c;if(u&&b)return h;var q=d.map(function(a,b){return"$"+b});c="(function("+q.join(",")+") {";var y=d.length;if(!b){c+="var stack = "+f.stackSave.body+";";for(var B=0;B<y;B++){var J=q[B],ea=d[B];"number"!==ea&&(ea=f[ea+"ToC"],c+="var "+ea.arguments+" = "+J+";",c+=ea.body+";",c+=J+"="+ea.returnValue+";")}}d=a(function(){return h}).returnValue;c+="var ret = "+d+"("+q.join(",")+");";u||(d=a(function(){return la}).returnValue,c+="ret = "+d+"(ret);");b||(c+=f.stackRestore.body.replace("()","(stack)")+";");return eval(c+"return ret})")}})();e.ccall=ia;e.cwrap=ha;function ma(a,b,c){c=c||"i8";"*"===c.charAt(c.length-1)&&(c="i32");switch(c){case"i1":D[a>>0]=b;break;case"i8":D[a>>0]=b;break;case"i16":E[a>>1]=b;break;case"i32":F[a>>2]=b;break;case"i64":fa=[b>>>0,(da=b,1<=+na(da)?0<da?(oa(+pa(da/4294967296),4294967295)|0)>>>0:~~+qa((da-+(~~da>>>0))/4294967296)>>>0:0)];F[a>>2]=fa[0];F[a+4>>2]=fa[1];break;case"float":ra[a>>2]=b;break;case"double":sa[a>>3]=b;break;default:z("invalid type for setValue: "+c)}}e.setValue=ma;function ta(a,b){b=b||"i8";"*"===b.charAt(b.length-1)&&(b="i32");switch(b){case"i1":return D[a>>0];case"i8":return D[a>>0];case"i16":return E[a>>1];case"i32":return F[a>>2];case"i64":return F[a>>2];case"float":return ra[a>>2];case"double":return sa[a>>3];default:z("invalid type for setValue: "+b)}return null}e.getValue=ta;e.ALLOC_NORMAL=0;e.ALLOC_STACK=1;e.ALLOC_STATIC=2;e.ALLOC_DYNAMIC=3;e.ALLOC_NONE=4;function G(a,b,c,d){var f,h;"number"===typeof a?(f=!0,h=a):(f=!1,h=a.length);var g="string"===typeof b?b:null;c=4==c?d:[ua,n.W,n.Ia,n.P][void 0===c?2:c](Math.max(h,g?1:b.length));if(f){d=c;assert(0==(c&3));for(a=c+(h&-4);d<a;d+=4)F[d>>2]=0;for(a=c+h;d<a;)D[d++>>0]=0;return c}if("i8"===g)return a.subarray||a.slice?H.set(a,c):H.set(new Uint8Array(a),c),c;d=0;for(var k,t;d<h;){var r=a[d];"function"===typeof r&&(r=n.sd(r));f=g||b[d];0===f?d++:("i64"==f&&(f="i32"),ma(c+d,r,f),t!==f&&(k=n.Aa(f),t=f),d+=k)}return c}e.allocate=G;e.getMemory=function(a){return va?"undefined"!==typeof wa&&!wa.C||!xa?n.P(a):ua(a):n.Ia(a)};function la(a,b){if(0===b||!a)return"";for(var c=0,d,f=0;;){d=H[a+f>>0];c|=d;if(0==d&&!b)break;f++;if(b&&f==b)break}b||(b=f);d="";if(128>c){for(;0<b;)c=String.fromCharCode.apply(String,H.subarray(a,a+Math.min(b,1024))),d=d?d+c:c,a+=1024,b-=1024;return d}return e.UTF8ToString(a)}e.Pointer_stringify=la;e.AsciiToString=function(a){for(var b="";;){var c=D[a++>>0];if(!c)return b;b+=String.fromCharCode(c)}};e.stringToAscii=function(a,b){return ya(a,b,!1)};function za(a,b){for(var c,d,f,h,g,k,t="";;){c=a[b++];if(!c)return t;c&128?(d=a[b++]&63,192==(c&224)?t+=String.fromCharCode((c&31)<<6|d):(f=a[b++]&63,224==(c&240)?c=(c&15)<<12|d<<6|f:(h=a[b++]&63,240==(c&248)?c=(c&7)<<18|d<<12|f<<6|h:(g=a[b++]&63,248==(c&252)?c=(c&3)<<24|d<<18|f<<12|h<<6|g:(k=a[b++]&63,c=(c&1)<<30|d<<24|f<<18|h<<12|g<<6|k))),65536>c?t+=String.fromCharCode(c):(c-=65536,t+=String.fromCharCode(55296|c>>10,56320|c&1023)))):t+=String.fromCharCode(c)}}e.UTF8ArrayToString=za;e.UTF8ToString=function(a){return za(H,a)};function Aa(a,b,c,d){if(!(0<d))return 0;var f=c;d=c+d-1;for(var h=0;h<a.length;++h){var g=a.charCodeAt(h);55296<=g&&57343>=g&&(g=65536+((g&1023)<<10)|a.charCodeAt(++h)&1023);if(127>=g){if(c>=d)break;b[c++]=g}else{if(2047>=g){if(c+1>=d)break;b[c++]=192|g>>6}else{if(65535>=g){if(c+2>=d)break;b[c++]=224|g>>12}else{if(2097151>=g){if(c+3>=d)break;b[c++]=240|g>>18}else{if(67108863>=g){if(c+4>=d)break;b[c++]=248|g>>24}else{if(c+5>=d)break;b[c++]=252|g>>30;b[c++]=128|g>>24&63}b[c++]=128|g>>18&63}b[c++]=128|g>>12&63}b[c++]=128|g>>6&63}b[c++]=128|g&63}}b[c]=0;return c-f}e.stringToUTF8Array=Aa;e.stringToUTF8=function(a,b,c){return Aa(a,H,b,c)};function Ba(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);55296<=d&&57343>=d&&(d=65536+((d&1023)<<10)|a.charCodeAt(++c)&1023);127>=d?++b:b=2047>=d?b+2:65535>=d?b+3:2097151>=d?b+4:67108863>=d?b+5:b+6}return b}e.lengthBytesUTF8=Ba;e.UTF16ToString=function(a){for(var b=0,c="";;){var d=E[a+2*b>>1];if(0==d)return c;++b;c+=String.fromCharCode(d)}};e.stringToUTF16=function(a,b,c){void 0===c&&(c=2147483647);if(2>c)return 0;c-=2;var d=b;c=c<2*a.length?c/2:a.length;for(var f=0;f<c;++f)E[b>>1]=a.charCodeAt(f),b+=2;E[b>>1]=0;return b-d};e.lengthBytesUTF16=function(a){return 2*a.length};e.UTF32ToString=function(a){for(var b=0,c="";;){var d=F[a+4*b>>2];if(0==d)return c;++b;65536<=d?(d=d-65536,c+=String.fromCharCode(55296|d>>10,56320|d&1023)):c+=String.fromCharCode(d)}};e.stringToUTF32=function(a,b,c){void 0===c&&(c=2147483647);if(4>c)return 0;var d=b;c=d+c-4;for(var f=0;f<a.length;++f){var h=a.charCodeAt(f);if(55296<=h&&57343>=h)var g=a.charCodeAt(++f),h=65536+((h&1023)<<10)|g&1023;F[b>>2]=h;b+=4;if(b+4>c)break}F[b>>2]=0;return b-d};e.lengthBytesUTF32=function(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);55296<=d&&57343>=d&&++c;b+=4}return b};function Ca(a){function b(c,d,f){d=d||Infinity;var h="",g=[],q;if("N"===a[k]){k++;"K"===a[k]&&k++;for(q=[];"E"!==a[k];)if("S"===a[k]){k++;var x=a.indexOf("_",k);q.push(r[a.substring(k,x)||0]||"?");k=x+1}else if("C"===a[k])q.push(q[q.length-1]),k+=2;else{var x=parseInt(a.substr(k)),Q=x.toString().length;if(!x||!Q){k--;break}var Bb=a.substr(k+Q,x);q.push(Bb);r.push(Bb);k+=Q+x}k++;q=q.join("::");d--;if(0===d)return c?[q]:q}else(("K"===a[k]||u&&"L"===a[k])&&k++,x=parseInt(a.substr(k)))&&(Q=x.toString().length,q=a.substr(k+Q,x),k+=Q+x);u=!1;"I"===a[k]?(k++,x=b(!0),Q=b(!0,1,!0),h+=Q[0]+" "+q+"<"+x.join(", ")+">"):h=q;a:for(;k<a.length&&0<d--;)if(q=a[k++],q in t)g.push(t[q]);else switch(q){case"P":g.push(b(!0,1,!0)[0]+"*");break;case"R":g.push(b(!0,1,!0)[0]+"&");break;case"L":k++;x=a.indexOf("E",k)-k;g.push(a.substr(k,x));k+=x+2;break;case"A":x=parseInt(a.substr(k));k+=x.toString().length;if("_"!==a[k])throw"?";k++;g.push(b(!0,1,!0)[0]+" ["+x+"]");break;case"E":break a;default:h+="?"+q;break a}f||1!==g.length||"void"!==g[0]||(g=[]);return c?(h&&g.push(h+"?"),g):h+("("+g.join(", ")+")")}var c=!!e.___cxa_demangle;if(c)try{var d=ua(a.length);ka(a.substr(1),d);var f=ua(4),h=e.___cxa_demangle(d,0,0,f);if(0===ta(f,"i32")&&h)return la(h)}catch(g){}finally{d&&Da(d),f&&Da(f),h&&Da(h)}var k=3,t={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},r=[],u=!0,d=a;try{if("Object._main"==a||"_main"==a)return"main()";"number"===typeof a&&(a=la(a));if("_"!==a[0]||"_"!==a[1]||"Z"!==a[2])return a;switch(a[3]){case"n":return"operator new()";case"d":return"operator delete()"}d=b()}catch(q){d+="?"}0<=d.indexOf("?")&&!c&&n.M("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling");return d}function Ea(){return Fa().replace(/__Z[\w\d_]+/g,function(a){var b=Ca(a);return a===b?a:a+" ["+b+"]"})}function Fa(){var a=Error();if(!a.stack){try{throw Error(0)}catch(b){a=b}if(!a.stack)return"(no stack trace available)"}return a.stack.toString()}e.stackTrace=function(){return Ea()};function Ga(){var a=v;0<a%4096&&(a+=4096-a%4096);return a}for(var D,H,E,Ha,F,Ia,ra,sa,Ja=0,p=0,va=!1,Ka=0,m=0,La=0,Ma=0,v=0,Na=e.TOTAL_STACK||524288,w=e.TOTAL_MEMORY||1048576,I=65536;I<w||I<2*Na;)I=16777216>I?2*I:I+16777216;I!==w&&(w=I);assert("undefined"!==typeof Int32Array&&"undefined"!==typeof Float64Array&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support");var buffer;buffer=new ArrayBuffer(w);D=new Int8Array(buffer);E=new Int16Array(buffer);F=new Int32Array(buffer);H=new Uint8Array(buffer);Ha=new Uint16Array(buffer);Ia=new Uint32Array(buffer);ra=new Float32Array(buffer);sa=new Float64Array(buffer);F[0]=255;assert(255===H[0]&&0===H[3],"Typed arrays 2 must be run on a little-endian system");e.HEAP=void 0;e.buffer=buffer;e.HEAP8=D;e.HEAP16=E;e.HEAP32=F;e.HEAPU8=H;e.HEAPU16=Ha;e.HEAPU32=Ia;e.HEAPF32=ra;e.HEAPF64=sa;function Oa(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b();else{var c=b.Qa;"number"===typeof c?void 0===b.T?n.J("v",c):n.J("vi",c,[b.T]):c(void 0===b.T?null:b.T)}}}var Pa=[],Qa=[],Ra=[],K=[],Sa=[],xa=!1;function Ta(a){Pa.unshift(a)}e.addOnPreRun=Ta;e.addOnInit=function(a){Qa.unshift(a)};e.addOnPreMain=function(a){Ra.unshift(a)};e.addOnExit=function(a){K.unshift(a)};function Ua(a){Sa.unshift(a)}e.addOnPostRun=Ua;function Va(a,b,c){c=Array(0<c?c:Ba(a)+1);a=Aa(a,c,0,c.length);b&&(c.length=a);return c}e.intArrayFromString=Va;e.intArrayToString=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];255<d&&(d&=255);b.push(String.fromCharCode(d))}return b.join("")};function ka(a,b,c){a=Va(a,c);for(c=0;c<a.length;)D[b+c>>0]=a[c],c+=1}e.writeStringToMemory=ka;function ja(a,b){for(var c=0;c<a.length;c++)D[b++>>0]=a[c]}e.writeArrayToMemory=ja;function ya(a,b,c){for(var d=0;d<a.length;++d)D[b++>>0]=a.charCodeAt(d);c||(D[b>>0]=0)}e.writeAsciiToMemory=ya;Math.imul&&-5===Math.imul(4294967295,5)||(Math.imul=function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16)*d+c*(b>>>16)<<16)|0});Math.td=Math.imul;Math.clz32||(Math.clz32=function(a){a=a>>>0;for(var b=0;32>b;b++)if(a&1<<31-b)return b;return 32});Math.kd=Math.clz32;var na=Math.abs,qa=Math.ceil,pa=Math.floor,oa=Math.min,L=0,Wa=null,Xa=null;function Ya(){L++,e.monitorRunDependencies&&e.monitorRunDependencies(L)}e.addRunDependency=Ya;function Za(){L--;e.monitorRunDependencies&&e.monitorRunDependencies(L);if(0==L&&(null!==Wa&&(clearInterval(Wa),Wa=null),Xa)){var a=Xa;Xa=null;a()}}e.removeRunDependency=Za;e.preloadedImages={};e.preloadedAudios={};Ja=8;p=Ja+1696;Qa.push();G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,164,2,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",4,n.La);var $a=n.ea(G(12,"i8",2),8);assert(0==$a%8);e._bitshift64Ashr=ab;e._i64Subtract=bb;e._i64Add=cb;e._memset=db;function eb(a,b){K.push(function(){n.J("vi",a,[b])}),eb.level=K.length}e._bitshift64Lshr=fb;e._bitshift64Shl=gb;var M={G:1,B:2,Qc:3,Nb:4,F:5,sa:6,gb:7,kc:8,Z:9,ub:10,oa:11,$c:11,Ka:12,Y:13,Gb:14,wc:15,$:16,pa:17,ad:18,ba:19,qa:20,N:21,u:22,fc:23,Ja:24,O:25,Xc:26,Hb:27,sc:28,da:29,Nc:30,Zb:31,Gc:32,Db:33,Kc:34,oc:42,Kb:43,vb:44,Qb:45,Rb:46,Sb:47,Yb:48,Yc:49,ic:50,Pb:51,Ab:35,lc:37,mb:52,pb:53,bd:54,gc:55,qb:56,rb:57,Bb:35,sb:59,uc:60,jc:61,Uc:62,tc:63,pc:64,qc:65,Mc:66,mc:67,jb:68,Rc:69,wb:70,Hc:71,ac:72,Eb:73,ob:74,Bc:76,nb:77,Lc:78,Tb:79,Ub:80,Xb:81,Wb:82,Vb:83,vc:38,ra:39,bc:36,aa:40,Cc:95,Fc:96,zb:104,hc:105,kb:97,Jc:91,zc:88,rc:92,Oc:108,yb:111,hb:98,xb:103,ec:101,cc:100,Vc:110,Ib:112,Jb:113,Mb:115,lb:114,Cb:89,$b:90,Ic:93,Pc:94,ib:99,dc:102,Ob:106,xc:107,Wc:109,Zc:87,Fb:122,Sc:116,Ac:95,nc:123,Lb:84,Dc:75,tb:125,yc:131,Ec:130,Tc:86},hb={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can't send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"};function ib(a){e.___errno_location&&(F[e.___errno_location()>>2]=a);return a}function jb(a,b){for(var c=0,d=a.length-1;0<=d;d--){var f=a[d];"."===f?a.splice(d,1):".."===f?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function N(a){var b="/"===a.charAt(0),c="/"===a.substr(-1);(a=jb(a.split("/").filter(function(a){return!!a}),!b).join("/"))||b||(a=".");a&&c&&(a+="/");return(b?"/":"")+a}function kb(a){var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(a).slice(1);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b}function lb(a){if("/"===a)return"/";var b=a.lastIndexOf("/");return-1===b?a:a.substr(b+1)}function mb(){for(var a="",b=!1,c=arguments.length-1;-1<=c&&!b;c--){b=0<=c?arguments[c]:"/";if("string"!==typeof b)throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";a=b+"/"+a;b="/"===b.charAt(0)}a=jb(a.split("/").filter(function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."}var nb=[];function ob(a,b){nb[a]={input:[],output:[],L:b},pb(a,qb)}var qb={open:function(a){var b=nb[a.g.rdev];if(!b)throw new O(M.ba);a.tty=b;a.seekable=!1},close:function(a){a.tty.L.flush(a.tty)},flush:function(a){a.tty.L.flush(a.tty)},read:function(a,b,c,d){if(!a.tty||!a.tty.L.Ba)throw new O(M.sa);for(var f=0,h=0;h<d;h++){var g;try{g=a.tty.L.Ba(a.tty)}catch(k){throw new O(M.F)}if(void 0===g&&0===f)throw new O(M.oa);if(null===g||void 0===g)break;f++;b[c+h]=g}f&&(a.g.timestamp=Date.now());return f},write:function(a,b,c,d){if(!a.tty||!a.tty.L.ja)throw new O(M.sa);for(var f=0;f<d;f++)try{a.tty.L.ja(a.tty,b[c+f])}catch(h){throw new O(M.F)}d&&(a.g.timestamp=Date.now());return f}},rb={Ba:function(a){if(!a.input.length){var b=null;"undefined"!=typeof window&&"function"==typeof window.prompt?(b=window.prompt("Input: "),null!==b&&(b+="\n")):"function"==typeof readline&&(b=readline(),null!==b&&(b+="\n"));if(!b)return null;a.input=Va(b,!0)}return a.input.shift()},ja:function(a,b){null===b||10===b?(e.print(za(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(e.print(za(a.output,0)),a.output=[])}},sb={ja:function(a,b){null===b||10===b?(e.printErr(za(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(e.printErr(za(a.output,0)),a.output=[])}},P={q:null,A:function(){return P.createNode(null,"/",16895,0)},createNode:function(a,b,c,d){if(24576===(c&61440)||4096===(c&61440))throw new O(M.G);P.q||(P.q={dir:{g:{D:P.k.D,p:P.k.p,lookup:P.k.lookup,V:P.k.V,rename:P.k.rename,unlink:P.k.unlink,rmdir:P.k.rmdir,readdir:P.k.readdir,symlink:P.k.symlink},stream:{I:P.n.I}},file:{g:{D:P.k.D,p:P.k.p},stream:{I:P.n.I,read:P.n.read,write:P.n.write,ta:P.n.ta,Ea:P.n.Ea,Ga:P.n.Ga}},link:{g:{D:P.k.D,p:P.k.p,readlink:P.k.readlink},stream:{}},va:{g:{D:P.k.D,p:P.k.p},stream:tb}});c=ub(a,b,c,d);16384===(c.mode&61440)?(c.k=P.q.dir.g,c.n=P.q.dir.stream,c.e={}):32768===(c.mode&61440)?(c.k=P.q.file.g,c.n=P.q.file.stream,c.o=0,c.e=null):40960===(c.mode&61440)?(c.k=P.q.link.g,c.n=P.q.link.stream):8192===(c.mode&61440)&&(c.k=P.q.va.g,c.n=P.q.va.stream);c.timestamp=Date.now();a&&(a.e[b]=c);return c},Sa:function(a){if(a.e&&a.e.subarray){for(var b=[],c=0;c<a.o;++c)b.push(a.e[c]);return b}return a.e},qd:function(a){return a.e?a.e.subarray?a.e.subarray(0,a.o):new Uint8Array(a.e):new Uint8Array},ya:function(a,b){a.e&&a.e.subarray&&b>a.e.length&&(a.e=P.Sa(a),a.o=a.e.length);if(!a.e||a.e.subarray){var c=a.e?a.e.buffer.byteLength:0;c>=b||(b=Math.max(b,c*(1048576>c?2:1.125)|0),0!=c&&(b=Math.max(b,256)),c=a.e,a.e=new Uint8Array(b),0<a.o&&a.e.set(c.subarray(0,a.o),0))}else for(!a.e&&0<b&&(a.e=[]);a.e.length<b;)a.e.push(0)},ab:function(a,b){if(a.o!=b)if(0==b)a.e=null,a.o=0;else{if(!a.e||a.e.subarray){var c=a.e;a.e=new Uint8Array(new ArrayBuffer(b));c&&a.e.set(c.subarray(0,Math.min(b,a.o)))}else if(a.e||(a.e=[]),a.e.length>b)a.e.length=b;else for(;a.e.length<b;)a.e.push(0);a.o=b}},k:{D:function(a){var b={};b.dev=8192===(a.mode&61440)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;16384===(a.mode&61440)?b.size=4096:32768===(a.mode&61440)?b.size=a.o:40960===(a.mode&61440)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.Pa=4096;b.blocks=Math.ceil(b.size/b.Pa);return b},p:function(a,b){void 0!==b.mode&&(a.mode=b.mode),void 0!==b.timestamp&&(a.timestamp=b.timestamp),void 0!==b.size&&P.ab(a,b.size)},lookup:function(){throw vb[M.B]},V:function(a,b,c,d){return P.createNode(a,b,c,d)},rename:function(a,b,c){if(16384===(a.mode&61440)){var d;try{d=wb(b,c)}catch(f){}if(d)for(var h in d.e)throw new O(M.ra)}delete a.parent.e[a.name];a.name=c;b.e[c]=a;a.parent=b},unlink:function(a,b){delete a.e[b]},rmdir:function(a,b){var c=wb(a,b),d;for(d in c.e)throw new O(M.ra);delete a.e[b]},readdir:function(a){var b=[".",".."],c;for(c in a.e)a.e.hasOwnProperty(c)&&b.push(c);return b},symlink:function(a,b,c){a=P.createNode(a,b,41471,0);a.link=c;return a},readlink:function(a){if(40960!==(a.mode&61440))throw new O(M.u);return a.link}},n:{read:function(a,b,c,d,f){var h=a.g.e;if(f>=a.g.o)return 0;a=Math.min(a.g.o-f,d);assert(0<=a);if(8<a&&h.subarray)b.set(h.subarray(f,f+a),c);else for(d=0;d<a;d++)b[c+d]=h[f+d];return a},write:function(a,b,c,d,f,h){if(!d)return 0;a=a.g;a.timestamp=Date.now();if(b.subarray&&(!a.e||a.e.subarray)){if(h)return a.e=b.subarray(c,c+d),a.o=d;if(0===a.o&&0===f)return a.e=new Uint8Array(b.subarray(c,c+d)),a.o=d;if(f+d<=a.o)return a.e.set(b.subarray(c,c+d),f),d}P.ya(a,f+d);if(a.e.subarray&&b.subarray)a.e.set(b.subarray(c,c+d),f);else for(h=0;h<d;h++)a.e[f+h]=b[c+h];a.o=Math.max(a.o,f+d);return d},I:function(a,b,c){1===c?b+=a.position:2===c&&32768===(a.g.mode&61440)&&(b+=a.g.o);if(0>b)throw new O(M.u);return b},ta:function(a,b,c){P.ya(a.g,b+c),a.g.o=Math.max(a.g.o,b+c)},Ea:function(a,b,c,d,f,h,g){if(32768!==(a.g.mode&61440))throw new O(M.ba);c=a.g.e;if(g&2||c.buffer!==b&&c.buffer!==b.buffer){(0<f||f+d<a.g.o)&&(c.subarray?c=c.subarray(f,f+d):c=Array.prototype.slice.call(c,f,f+d));a=!0;d=ua(d);if(!d)throw new O(M.Ka);b.set(c,d)}else a=!1,d=c.byteOffset;return{Cd:d,gd:a}},Ga:function(a,b,c,d,f){if(32768!==(a.g.mode&61440))throw new O(M.ba);if(f&2)return 0;P.n.write(a,b,0,d,c,!1);return 0}}};G(1,"i32*",2);G(1,"i32*",2);G(1,"i32*",2);var xb=null,yb=[null],zb=[],Ab=1,R=null,Cb=!0,S={},O=null,vb={};function T(a,b){a=mb("/",a);b=b||{};if(!a)return{path:"",g:null};var c={za:!0,ka:0},d;for(d in c)void 0===b[d]&&(b[d]=c[d]);if(8<b.ka)throw new O(M.aa);var c=jb(a.split("/").filter(function(a){return!!a}),!1),f=xb;d="/";for(var h=0;h<c.length;h++){var g=h===c.length-1;if(g&&b.parent)break;f=wb(f,c[h]);d=N(d+"/"+c[h]);f.R&&(!g||g&&b.za)&&(f=f.R.root);if(!g||b.ga)for(g=0;40960===(f.mode&61440);)if(f=Db(d),d=mb(kb(d),f),f=T(d,{ka:b.ka}).g,40<g++)throw new O(M.aa)}return{path:d,g:f}}function U(a){for(var b;;){if(a===a.parent)return a=a.A.Fa,b?"/"!==a[a.length-1]?a+"/"+b:a+b:a;b=b?a.name+"/"+b:a.name;a=a.parent}}function Eb(a,b){for(var c=0,d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%R.length}function Fb(a){var b=Eb(a.parent.id,a.name);a.K=R[b];R[b]=a}function wb(a,b){var c;if(c=(c=Gb(a,"x"))?c:a.k.lookup?0:M.Y)throw new O(c,a);for(c=R[Eb(a.id,b)];c;c=c.K){var d=c.name;if(c.parent.id===a.id&&d===b)return c}return a.k.lookup(a,b)}function ub(a,b,c,d){Hb||(Hb=function(a,b,c,d){a||(a=this),this.parent=a,this.A=a.A,this.R=null,this.id=Ab++,this.name=b,this.mode=c,this.k={},this.n={},this.rdev=d},Hb.prototype={},Object.defineProperties(Hb.prototype,{read:{get:function(){return 365===(this.mode&365)},set:function(a){a?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(this.mode&146)},set:function(a){a?this.mode|=146:this.mode&=-147}},Xa:{get:function(){return 16384===(this.mode&61440)}},Ca:{get:function(){return 8192===(this.mode&61440)}}}));a=new Hb(a,b,c,d);Fb(a);return a}var Ib={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function Gb(a,b){if(Cb)return 0;if(-1===b.indexOf("r")||a.mode&292){if(-1!==b.indexOf("w")&&!(a.mode&146)||-1!==b.indexOf("x")&&!(a.mode&73))return M.Y}else return M.Y;return 0}function Jb(a,b){try{return wb(a,b),M.pa}catch(c){}return Gb(a,"wx")}function Kb(){var a;a=4096;for(var b=0;b<=a;b++)if(!zb[b])return b;throw new O(M.Ja)}function Lb(a){Mb||(Mb=function(){},Mb.prototype={},Object.defineProperties(Mb.prototype,{object:{get:function(){return this.g},set:function(a){this.g=a}},vd:{get:function(){return 1!==(this.flags&2097155)}},wd:{get:function(){return 0!==(this.flags&2097155)}},ud:{get:function(){return this.flags&1024}}}));var b=new Mb,c;for(c in a)b[c]=a[c];a=b;b=Kb();a.fd=b;return zb[b]=a}var tb={open:function(a){a.n=yb[a.g.rdev].n,a.n.open&&a.n.open(a)},I:function(){throw new O(M.da)}};function pb(a,b){yb[a]={n:b}}function Nb(a,b){var c="/"===b,d=!b,f;if(c&&xb)throw new O(M.$);if(!c&&!d){f=T(b,{za:!1});b=f.path;f=f.g;if(f.R)throw new O(M.$);if(16384!==(f.mode&61440))throw new O(M.qa)}var d={type:a,Ad:{},Fa:b,Ya:[]},h=a.A(d);h.A=d;d.root=h;c?xb=h:f&&(f.R=d,f.A&&f.A.Ya.push(d))}function Ob(a,b,c){var d=T(a,{parent:!0}).g;a=lb(a);if(!a||"."===a||".."===a)throw new O(M.u);var f=Jb(d,a);if(f)throw new O(f);if(!d.k.V)throw new O(M.G);return d.k.V(d,a,b,c)}function Pb(a,b){b=(void 0!==b?b:438)&4095;b|=32768;return Ob(a,b,0)}function V(a,b){b=(void 0!==b?b:511)&1023;b|=16384;return Ob(a,b,0)}function Qb(a,b,c){"undefined"===typeof c&&(c=b,b=438);return Ob(a,b|8192,c)}function Rb(a,b){if(!mb(a))throw new O(M.B);var c=T(b,{parent:!0}).g;if(!c)throw new O(M.B);var d=lb(b),f=Jb(c,d);if(f)throw new O(f);if(!c.k.symlink)throw new O(M.G);return c.k.symlink(c,d,a)}function Db(a){a=T(a).g;if(!a)throw new O(M.B);if(!a.k.readlink)throw new O(M.u);return mb(U(a.parent),a.k.readlink(a))}function Sb(a,b){var c;"string"===typeof a?c=T(a,{ga:!0}).g:c=a;if(!c.k.p)throw new O(M.G);c.k.p(c,{mode:b&4095|c.mode&-4096,timestamp:Date.now()})}function Tb(a,b){var c;if(""===a)throw new O(M.B);var d;if("string"===typeof b){if(d=Ib[b],"undefined"===typeof d)throw Error("Unknown file open mode: "+b)}else d=b;b=d;c=b&64?("undefined"===typeof c?438:c)&4095|32768:0;var f;if("object"===typeof a)f=a;else{a=N(a);try{f=T(a,{ga:!(b&131072)}).g}catch(h){}}d=!1;if(b&64)if(f){if(b&128)throw new O(M.pa)}else f=Ob(a,c,0),d=!0;if(!f)throw new O(M.B);8192===(f.mode&61440)&&(b&=-513);if(b&65536&&16384!==(f.mode&61440))throw new O(M.qa);if(!d&&(f?40960===(f.mode&61440)?c=M.aa:16384===(f.mode&61440)&&(0!==(b&2097155)||b&512)?c=M.N:(c=["r","w","rw"][b&3],b&512&&(c+="w"),c=Gb(f,c)):c=M.B,c))throw new O(c);if(b&512){c=f;var g;"string"===typeof c?g=T(c,{ga:!0}).g:g=c;if(!g.k.p)throw new O(M.G);if(16384===(g.mode&61440))throw new O(M.N);if(32768!==(g.mode&61440))throw new O(M.u);if(c=Gb(g,"w"))throw new O(c);g.k.p(g,{size:0,timestamp:Date.now()})}b&=-641;f=Lb({g:f,path:U(f),flags:b,seekable:!0,position:0,n:f.n,eb:[],error:!1});f.n.open&&f.n.open(f);!e.logReadFiles||b&1||(Ub||(Ub={}),a in Ub||(Ub[a]=1,e.printErr("read file: "+a)));try{S.onOpenFile&&(g=0,1!==(b&2097155)&&(g|=1),0!==(b&2097155)&&(g|=2),S.onOpenFile(a,g))}catch(k){}return f}function Vb(a){a.ia&&(a.ia=null);try{a.n.close&&a.n.close(a)}catch(b){throw b}finally{zb[a.fd]=null}}function Wb(a,b,c){if(!a.seekable||!a.n.I)throw new O(M.da);a.position=a.n.I(a,b,c);a.eb=[]}function Xb(a,b,c,d,f,h){if(0>d||0>f)throw new O(M.u);if(0===(a.flags&2097155))throw new O(M.Z);if(16384===(a.g.mode&61440))throw new O(M.N);if(!a.n.write)throw new O(M.u);a.flags&1024&&Wb(a,0,2);var g=!0;if("undefined"===typeof f)f=a.position,g=!1;else if(!a.seekable)throw new O(M.da);b=a.n.write(a,b,c,d,f,h);g||(a.position+=b);try{a.path&&S.onWriteToFile&&S.onWriteToFile(a.path)}catch(k){}return b}function Yb(){O||(O=function(a,b){this.g=b,this.bb=function(a){this.Q=a;for(var b in M)if(M[b]===a){this.code=b;break}},this.bb(a),this.message=hb[a]},O.prototype=Error(),O.prototype.constructor=O,[M.B].forEach(function(a){vb[a]=new O(a),vb[a].stack="<generic error, no stack>"}))}var Zb;function $b(a,b){var c=0;a&&(c|=365);b&&(c|=146);return c}function ac(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);return Pb(a,$b(c,d))}function bc(a,b,c,d,f,h){a=b?N(("string"===typeof a?a:U(a))+"/"+b):a;d=$b(d,f);f=Pb(a,d);if(c){if("string"===typeof c){a=Array(c.length);b=0;for(var g=c.length;b<g;++b)a[b]=c.charCodeAt(b);c=a}Sb(f,d|146);a=Tb(f,"w");Xb(a,c,0,c.length,0,h);Vb(a);Sb(f,d)}return f}function W(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);b=$b(!!c,!!d);W.Da||(W.Da=64);var f=W.Da++<<8|0;pb(f,{open:function(a){a.seekable=!1},close:function(){d&&d.buffer&&d.buffer.length&&d(10)},read:function(a,b,d,f){for(var r=0,u=0;u<f;u++){var q;try{q=c()}catch(y){throw new O(M.F)}if(void 0===q&&0===r)throw new O(M.oa);if(null===q||void 0===q)break;r++;b[d+u]=q}r&&(a.g.timestamp=Date.now());return r},write:function(a,b,c,f){for(var r=0;r<f;r++)try{d(b[c+r])}catch(u){throw new O(M.F)}f&&(a.g.timestamp=Date.now());return r}});return Qb(a,b,f)}function cc(a){if(a.Ca||a.Xa||a.link||a.e)return!0;var b=!0;if("undefined"!==typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(e.read)try{a.e=Va(e.read(a.url),!0),a.o=a.e.length}catch(c){b=!1}else throw Error("Cannot load without read() or XMLHttpRequest.");b||ib(M.F);return b}var dc={},Hb,Mb,Ub,ec=0;function X(){ec+=4;return F[ec-4>>2]}function fc(){var a;a=X();a=zb[a];if(!a)throw new O(M.Z);return a}function wa(a){wa.C||(v=Ga(),wa.C=!0,assert(n.P),wa.Ra=n.P,n.P=function(){z("cannot dynamically allocate, sbrk now has control")});var b=v;return 0==a||wa.Ra(a)?b:4294967295}e._memcpy=gc;function hc(a,b){ic=a;jc=b;if(!kc)return 1;if(0==a)Y=function(){setTimeout(lc,b)},mc="timeout";else if(1==a)Y=function(){nc(lc)},mc="rAF";else if(2==a){if(!window.setImmediate){var c=[];window.addEventListener("message",function(a){a.source===window&&"__emcc"===a.data&&(a.stopPropagation(),c.shift()())},!0);window.setImmediate=function(a){c.push(a),window.postMessage("__emcc","*")}}Y=function(){window.setImmediate(lc)};mc="immediate"}return 0}function oc(a,b,c,d,f){e.noExitRuntime=!0;assert(!kc,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters.");kc=a;pc=d;var h=qc;lc=function(){if(!A)if(0<rc.length){var b=Date.now(),c=rc.shift();c.Qa(c.T);if(sc){var f=sc,r=0==f%1?f-1:Math.floor(f);sc=c.ld?r:(8*f+(r+.5))/9}tc();setTimeout(lc,0)}else h<qc||(uc=uc+1|0,1==ic&&1<jc&&0!=uc%jc?Y():("timeout"===mc&&e.fa&&(e.S("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),mc=""),vc(function(){"undefined"!==typeof d?n.J("vi",a,[d]):n.J("v",a)}),h<qc||("object"===typeof SDL&&SDL.audio&&SDL.audio.Za&&SDL.audio.Za(),Y())))};f||(b&&0<b?hc(0,1e3/b):hc(1,1),Y());if(c)throw"SimulateInfiniteLoop"}var Y=null,mc="",qc=0,kc=null,pc=0,ic=0,jc=0,uc=0,rc=[];function tc(){if(e.setStatus){var a=e.statusMessage||"Please wait...",b=sc,c=wc.nd;b?b<c?e.setStatus(a+" ("+(c-b)+"/"+c+")"):e.setStatus(a):e.setStatus("")}}function vc(a){if(!(A||e.preMainLoop&&!1===e.preMainLoop())){try{a()}catch(b){if(b instanceof xc)return;b&&"object"===typeof b&&b.stack&&e.S("exception thrown: "+[b,b.stack]);throw b}e.postMainLoop&&e.postMainLoop()}}var wc={},lc,sc,yc=!1,zc=!1,Ac=[];function Bc(){function a(){zc=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c||document.msPointerLockElement===c}e.preloadPlugins||(e.preloadPlugins=[]);if(!Cc){Cc=!0;try{Dc=!0}catch(b){Dc=!1,!1}Ec="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:Dc?null:!1;Fc="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0;e.Ha||"undefined"!==typeof Fc||(!1,e.Ha=!0);e.preloadPlugins.push({canHandle:function(a){return!e.Ha&&/\.(jpg|jpeg|png|bmp)$/i.test(a)},handle:function(a,b,c,g){var k=null;if(Dc)try{k=new Blob([a],{type:Gc(b)}),k.size!==a.length&&(k=new Blob([new Uint8Array(a).buffer],{type:Gc(b)}))}catch(t){n.M("Blob constructor present but fails: "+t+"; falling back to blob builder")}k||(k=new Ec,k.append(new Uint8Array(a).buffer),k=k.getBlob());var r=Fc.createObjectURL(k),u=new Image;u.onload=function(){assert(u.complete,"Image "+b+" could not be decoded");var g=document.createElement("canvas");g.width=u.width;g.height=u.height;g.getContext("2d").drawImage(u,0,0);e.preloadedImages[b]=g;Fc.revokeObjectURL(r);c&&c(a)};u.onerror=function(){g&&g()};u.src=r}});e.preloadPlugins.push({canHandle:function(a){return!e.zd&&a.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(a,b,c,g){function k(g){r||(r=!0,e.preloadedAudios[b]=g,c&&c(a))}function t(){r||(r=!0,e.preloadedAudios[b]=new Audio,g&&g())}var r=!1;if(Dc){try{var u=new Blob([a],{type:Gc(b)})}catch(q){return t()}var u=Fc.createObjectURL(u),y=new Audio;y.addEventListener("canplaythrough",function(){k(y)},!1);y.onerror=function(){if(!r){for(var c="",h=0,g=0,q=0;q<a.length;q++)for(h=h<<8|a[q],g+=8;6<=g;)var t=h>>g-6&63,g=g-6,c=c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t];2==g?(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(h&3)<<4],c+="=="):4==g&&(c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(h&15)<<2],c+="=");y.src="data:audio/x-"+b.substr(-3)+";base64,"+c;k(y)}};y.src=u;Hc(function(){k(y)})}else return t()}});var c=e.canvas;c&&(c.la=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock||c.msRequestPointerLock||function(){},c.wa=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||function(){},c.wa=c.wa.bind(document),document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),document.addEventListener("webkitpointerlockchange",a,!1),document.addEventListener("mspointerlockchange",a,!1),e.elementPointerLock&&c.addEventListener("click",function(a){!zc&&c.la&&(c.la(),a.preventDefault())},!1))}}function Ic(a,b,c,d){if(b&&e.fa&&a==e.canvas)return e.fa;var f,h;if(b){h={antialias:!1,alpha:!1};if(d)for(var g in d)h[g]=d[g];(h=GL.createContext(a,h))&&(f=GL.getContext(h).cd);a.style.backgroundColor="black"}else f=a.getContext("2d");if(!f)return null;c&&(b||assert("undefined"===typeof GLctx,"cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),e.fa=f,b&&GL.yd(h),e.Dd=b,Ac.forEach(function(a){a()}),Bc());return f}var Jc=!1,Kc=void 0,Lc=void 0;function Mc(a,b,c){function d(){yc=!1;var a=f.parentNode;(document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===a?(f.ua=document.cancelFullScreen||document.mozCancelFullScreen||document.webkitCancelFullScreen||document.msExitFullscreen||document.exitFullscreen||function(){},f.ua=f.ua.bind(document),Kc&&f.la(),yc=!0,Lc&&Nc()):(a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),Lc&&Oc());e.onFullScreen&&e.onFullScreen(yc);Pc(f)}Kc=a;Lc=b;Qc=c;"undefined"===typeof Kc&&(Kc=!0);"undefined"===typeof Lc&&(Lc=!1);"undefined"===typeof Qc&&(Qc=null);var f=e.canvas;Jc||(Jc=!0,document.addEventListener("fullscreenchange",d,!1),document.addEventListener("mozfullscreenchange",d,!1),document.addEventListener("webkitfullscreenchange",d,!1),document.addEventListener("MSFullscreenChange",d,!1));var h=document.createElement("div");f.parentNode.insertBefore(h,f);h.appendChild(f);h.C=h.requestFullScreen||h.mozRequestFullScreen||h.msRequestFullscreen||(h.webkitRequestFullScreen?function(){h.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null);c?h.C({Ed:c}):h.C()}var Rc=0;function Sc(a){var b=Date.now();if(0===Rc)Rc=b+1e3/60;else for(;b+2>=Rc;)Rc+=1e3/60;b=Math.max(Rc-b,0);setTimeout(a,b)}function nc(a){"undefined"===typeof window?Sc(a):(window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||Sc),window.requestAnimationFrame(a))}function Hc(a){e.noExitRuntime=!0,setTimeout(function(){A||a()},1e4)}function Gc(a){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[a.substr(a.lastIndexOf(".")+1)]}function Tc(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){200==d.status||0==d.status&&d.response?b(d.response):c()};d.onerror=c;d.send(null)}function Uc(a,b,c){Tc(a,function(c){assert(c,'Loading data file "'+a+'" failed (no arrayBuffer).'),b(new Uint8Array(c)),Za()},function(){if(c)c();else throw'Loading data file "'+a+'" failed.'}),Ya()}var Vc=[];function Wc(){var a=e.canvas;Vc.forEach(function(b){b(a.width,a.height)})}function Nc(){if("undefined"!=typeof SDL){var a=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=a|8388608}Wc()}function Oc(){if("undefined"!=typeof SDL){var a=Ia[SDL.screen+0*n.H>>2];F[SDL.screen+0*n.H>>2]=a&-8388609}Wc()}function Pc(a,b,c){b&&c?(a.fb=b,a.Va=c):(b=a.fb,c=a.Va);var d=b,f=c;e.forcedAspectRatio&&0<e.forcedAspectRatio&&(d/f<e.forcedAspectRatio?d=Math.round(f*e.forcedAspectRatio):f=Math.round(d/e.forcedAspectRatio));if((document.webkitFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.mozFullscreenElement||document.fullScreenElement||document.fullscreenElement||document.msFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement)===a.parentNode&&"undefined"!=typeof screen)var h=Math.min(screen.width/d,screen.height/f),d=Math.round(d*h),f=Math.round(f*h);Lc?(a.width!=d&&(a.width=d),a.height!=f&&(a.height=f),"undefined"!=typeof a.style&&(a.style.removeProperty("width"),a.style.removeProperty("height"))):(a.width!=b&&(a.width=b),a.height!=c&&(a.height=c),"undefined"!=typeof a.style&&(d!=b||f!=c?(a.style.setProperty("width",d+"px","important"),a.style.setProperty("height",f+"px","important")):(a.style.removeProperty("width"),a.style.removeProperty("height"))))}var Cc,Dc,Ec,Fc,Qc;Yb();R=Array(4096);Nb(P,"/");V("/tmp");V("/home");V("/home/web_user");(function(){V("/dev");pb(259,{read:function(){return 0},write:function(a,b,f,h){return h}});Qb("/dev/null",259);ob(1280,rb);ob(1536,sb);Qb("/dev/tty",1280);Qb("/dev/tty1",1536);var a;if("undefined"!==typeof crypto){var b=new Uint8Array(1);a=function(){crypto.getRandomValues(b);return b[0]}}else a=function(){return 256*Math.random()|0};W("/dev","random",a);W("/dev","urandom",a);V("/dev/shm");V("/dev/shm/tmp")})();V("/proc");V("/proc/self");V("/proc/self/fd");Nb({A:function(){var a=ub("/proc/self","fd",16895,73);a.k={lookup:function(a,c){var d=zb[+c];if(!d)throw new O(M.Z);var f={parent:null,A:{Fa:"fake"},k:{readlink:function(){return d.path}}};return f.parent=f}};return a}},"/proc/self/fd");Qa.unshift(function(){if(!e.noFSInit&&!Zb){assert(!Zb,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)");Zb=!0;Yb();e.stdin=e.stdin;e.stdout=e.stdout;e.stderr=e.stderr;e.stdin?W("/dev","stdin",e.stdin):Rb("/dev/tty","/dev/stdin");e.stdout?W("/dev","stdout",null,e.stdout):Rb("/dev/tty","/dev/stdout");e.stderr?W("/dev","stderr",null,e.stderr):Rb("/dev/tty1","/dev/stderr");var a=Tb("/dev/stdin","r");assert(0===a.fd,"invalid handle for stdin ("+a.fd+")");a=Tb("/dev/stdout","w");assert(1===a.fd,"invalid handle for stdout ("+a.fd+")");a=Tb("/dev/stderr","w");assert(2===a.fd,"invalid handle for stderr ("+a.fd+")")}});Ra.push(function(){Cb=!1});K.push(function(){Zb=!1;var a=e._fflush;a&&a(0);for(a=0;a<zb.length;a++){var b=zb[a];b&&Vb(b)}});e.FS_createFolder=function(a,b,c,d){a=N(("string"===typeof a?a:U(a))+"/"+b);return V(a,$b(c,d))};e.FS_createPath=function(a,b){a="string"===typeof a?a:U(a);for(var c=b.split("/").reverse();c.length;){var d=c.pop();if(d){var f=N(a+"/"+d);try{V(f)}catch(h){}a=f}}return f};e.FS_createDataFile=bc;e.FS_createPreloadedFile=function(a,b,c,d,f,h,g,k,t,r){function u(c){function u(c){r&&r(),k||bc(a,b,c,d,f,t),h&&h(),Za()}var J=!1;e.preloadPlugins.forEach(function(a){!J&&a.canHandle(q)&&(a.handle(c,q,u,function(){g&&g(),Za()}),J=!0)});J||u(c)}Bc();var q=b?mb(N(a+"/"+b)):a;Ya();"string"==typeof c?Uc(c,function(a){u(a)},g):u(c)};e.FS_createLazyFile=function(a,b,c,d,f){if("undefined"!==typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";c={Ca:!1,url:c};var h=ac(a,b,d,f);c.e?h.e=c.e:c.url&&(h.e=null,h.url=c.url);Object.defineProperty(h,"usedBytes",{get:function(){return this.e.length}});var g={};Object.keys(h.n).forEach(function(a){var b=h.n[a];g[a]=function(){if(!cc(h))throw new O(M.F);return b.apply(null,arguments)}});g.read=function(a,b,c,d,f){if(!cc(h))throw new O(M.F);a=a.g.e;if(f>=a.length)return 0;d=Math.min(a.length-f,d);assert(0<=d);if(a.slice)for(var g=0;g<d;g++)b[c+g]=a[f+g];else for(g=0;g<d;g++)b[c+g]=a.get(f+g);return d};h.n=g;return h};e.FS_createLink=function(a,b,c){a=N(("string"===typeof a?a:U(a))+"/"+b);return Rb(c,a)};e.FS_createDevice=W;e.FS_unlink=function(a){var b=T(a,{parent:!0}).g,c=lb(a),d=wb(b,c),f;a:{try{f=wb(b,c)}catch(h){f=h.Q;break a}var g=Gb(b,"wx");f=g?g:16384===(f.mode&61440)?M.N:0}if(f)throw f===M.N&&(f=M.G),new O(f);if(!b.k.unlink)throw new O(M.G);if(d.R)throw new O(M.$);try{S.willDeletePath&&S.willDeletePath(a)}catch(k){}b.k.unlink(b,c);b=Eb(d.parent.id,d.name);if(R[b]===d)R[b]=d.K;else for(b=R[b];b;){if(b.K===d){b.K=d.K;break}b=b.K}try{S.onDeletePath&&S.onDeletePath(a)}catch(t){}};Qa.unshift(function(){});K.push(function(){});e.requestFullScreen=function(a,b,c){Mc(a,b,c)};e.requestAnimationFrame=function(a){nc(a)};e.setCanvasSize=function(a,b,c){Pc(e.canvas,a,b),c||Wc()};e.pauseMainLoop=function(){Y=null,qc++};e.resumeMainLoop=function(){qc++;var a=ic,b=jc,c=kc;kc=null;oc(c,0,!1,pc,!0);hc(a,b);Y()};e.getUserMedia=function(){window.C||(window.C=navigator.getUserMedia||navigator.mozGetUserMedia),window.C(void 0)};e.createContext=function(a,b,c,d){return Ic(a,b,c,d)};Ka=m=n.ea(p);va=!0;La=Ka+Na;Ma=v=n.ea(La);assert(Ma<w,"TOTAL_MEMORY not big enough for stack");var Xc=G([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",3);e.Na={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:Infinity};e.Oa={abort:z,assert:assert,invoke_ii:function(a,b){try{return e.dynCall_ii(a,b)}catch(c){if("number"!==typeof c&&"longjmp"!==c)throw c;Z.setThrew(1,0)}},invoke_iiii:function(a,b,c,d){try{return e.dynCall_iiii(a,b,c,d)}catch(f){if("number"!==typeof f&&"longjmp"!==f)throw f;Z.setThrew(1,0)}},invoke_vi:function(a,b){try{e.dynCall_vi(a,b)}catch(c){if("number"!==typeof c&&"longjmp"!==c)throw c;Z.setThrew(1,0)}},_pthread_cleanup_pop:function(){assert(eb.level==K.length,"cannot pop if something else added meanwhile!"),K.pop(),eb.level=K.length},___lock:function(){},_emscripten_set_main_loop:oc,_pthread_self:function(){return 0},___syscall6:function(a,b){ec=b;try{var c=fc();Vb(c);return 0}catch(d){return"undefined"!==typeof dc&&d instanceof O||z(d),-d.Q}},_emscripten_set_main_loop_timing:hc,_abort:function(){e.abort()},_sbrk:wa,_time:function(a){var b=Date.now()/1e3|0;a&&(F[a>>2]=b);return b},___setErrNo:ib,_emscripten_memcpy_big:function(a,b,c){H.set(H.subarray(b,b+c),a);return a},___syscall54:function(a,b){ec=b;try{var c=fc(),d=X();switch(d){case 21505:return c.tty?0:-M.O;case 21506:return c.tty?0:-M.O;case 21519:if(!c.tty)return-M.O;var f=X();return F[f>>2]=0;case 21520:return c.tty?-M.u:-M.O;case 21531:f=X();if(!c.n.Wa)throw new O(M.O);return c.n.Wa(c,d,f);default:z("bad ioctl syscall "+d)}}catch(h){return"undefined"!==typeof dc&&h instanceof O||z(h),-h.Q}},___unlock:function(){},___syscall140:function(a,b){ec=b;try{var c=fc(),d=X(),f=X(),h=X(),g=X();assert(0===d);Wb(c,f,g);F[h>>2]=c.position;c.ia&&0===f&&0===g&&(c.ia=null);return 0}catch(k){return"undefined"!==typeof dc&&k instanceof O||z(k),-k.Q}},_pthread_cleanup_push:eb,_sysconf:function(a){switch(a){case 30:return 4096;case 85:return I/4096;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"===typeof navigator?navigator.hardwareConcurrency||1:1}ib(M.u);return-1},___syscall146:function(a,b){ec=b;try{var c=fc(),d=X(),f;a:{for(var h=X(),g=0,k=0;k<h;k++){var t=Xb(c,D,F[d+8*k>>2],F[d+(8*k+4)>>2],void 0);if(0>t){f=-1;break a}g+=t}f=g}return f}catch(r){return"undefined"!==typeof dc&&r instanceof O||z(r),-r.Q}},STACKTOP:m,STACK_MAX:La,tempDoublePtr:$a,ABORT:A,cttz_i8:Xc};var Z=function(global,env,buffer){var a=new global.Int8Array(buffer),b=new global.Int16Array(buffer),c=new global.Int32Array(buffer),d=new global.Uint8Array(buffer),e=new global.Uint16Array(buffer),f=new global.Uint32Array(buffer),g=new global.Float32Array(buffer),h=new global.Float64Array(buffer),i=env.STACKTOP|0,j=env.STACK_MAX|0,k=env.tempDoublePtr|0,l=env.ABORT|0,m=env.cttz_i8|0,n=0,o=0,p=0,q=0,r=global.NaN,s=global.Infinity,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=global.Math.floor,N=global.Math.abs,O=global.Math.sqrt,P=global.Math.pow,Q=global.Math.cos,R=global.Math.sin,S=global.Math.tan,T=global.Math.acos,U=global.Math.asin,V=global.Math.atan,W=global.Math.atan2,X=global.Math.exp,Y=global.Math.log,Z=global.Math.ceil,_=global.Math.imul,$=global.Math.min,aa=global.Math.clz32,ba=env.abort,ca=env.assert,da=env.invoke_ii,ea=env.invoke_iiii,fa=env.invoke_vi,ga=env._pthread_cleanup_pop,ha=env.___lock,ia=env._emscripten_set_main_loop,ja=env._pthread_self,ka=env.___syscall6,la=env._emscripten_set_main_loop_timing,ma=env._abort,na=env._sbrk,oa=env._time,pa=env.___setErrNo,qa=env._emscripten_memcpy_big,ra=env.___syscall54,sa=env.___unlock,ta=env.___syscall140,ua=env._pthread_cleanup_push,va=env._sysconf,wa=env.___syscall146,xa=0;function Ba(a){a=a|0;var b=0;b=i;i=i+a|0;i=i+15&-16;return b|0}function Ca(){return i|0}function Da(a){a=a|0,i=a}function Ea(a,b){a=a|0,b=b|0,i=a,j=b}function Fa(a,b){a=a|0,b=b|0,n||(n=a,o=b)}function Ga(b){b=b|0,a[k>>0]=a[b>>0],a[k+1>>0]=a[b+1>>0],a[k+2>>0]=a[b+2>>0],a[k+3>>0]=a[b+3>>0]}function Ha(b){b=b|0,a[k>>0]=a[b>>0],a[k+1>>0]=a[b+1>>0],a[k+2>>0]=a[b+2>>0],a[k+3>>0]=a[b+3>>0],a[k+4>>0]=a[b+4>>0],a[k+5>>0]=a[b+5>>0],a[k+6>>0]=a[b+6>>0],a[k+7>>0]=a[b+7>>0]}function Ia(a){a=a|0,C=a}function Ja(){return C|0}function Ka(b,e,f){b=b|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,$=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=0,na=0,oa=0,pa=0,qa=0,ra=0,sa=0,ta=0,ua=0,va=0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0,Da=0,Ea=0,Fa=0,Ga=0,Ha=0,Ia=0,Ja=0,Ka=0,Oa=0,Pa=0,Qa=0,Ra=0,Sa=0,Ta=0,Ua=0,Va=0,Wa=0,Xa=0,Ya=0,Za=0,_a=0,$a=0,gb=0,hb=0,ib=0,jb=0,kb=0,mb=0,nb=0,ob=0,pb=0,qb=0,rb=0,sb=0,tb=0,ub=0,vb=0,wb=0,xb=0,yb=0,zb=0,Ab=0,Bb=0,Cb=0,Db=0,Eb=0,Fb=0,Gb=0,Hb=0,Ib=0,Jb=0,Kb=0,Lb=0,Mb=0,Nb=0,Ob=0,Pb=0,Qb=0,Rb=0,Sb=0,Tb=0,Ub=0,Vb=0,Wb=0,Xb=0,Yb=0,Zb=0,_b=0,$b=0,ac=0,bc=0,cc=0,dc=0,ec=0,fc=0,gc=0,hc=0,ic=0,jc=0,kc=0,lc=0,mc=0,nc=0,oc=0,pc=0,qc=0,rc=0,sc=0,tc=0,uc=0,vc=0,wc=0,xc=0,yc=0,zc=0,Ac=0,Bc=0,Cc=0,Dc=0,Ec=0,Fc=0,Gc=0,Hc=0;g=i;i=i+2640|0;h=g+2456|0;j=g+2304|0;k=g+2152|0;l=g+2e3|0;m=g+1848|0;n=g+1696|0;o=g+1544|0;p=g+1392|0;q=g+1240|0;r=g+1088|0;s=g+936|0;t=g+784|0;u=g+632|0;v=g+480|0;w=g+328|0;x=g+248|0;y=g+168|0;z=g+80|0;A=g;B=g+2608|0;D=B;E=e;e=D+32|0;do a[D>>0]=a[E>>0]|0,D=D+1|0,E=E+1|0;while((D|0)<(e|0));a[B>>0]=(d[B>>0]|0)&248;F=B+31|0;a[F>>0]=(d[F>>0]|0)&63|64;F=d[f>>0]|0;G=fb(d[f+1>>0]|0|0,0,8)|0;H=C;I=fb(d[f+2>>0]|0|0,0,16)|0;J=H|C;H=d[f+3>>0]|0;K=fb(H|0,0,24)|0;L=x;c[L>>2]=G|F|I|K&50331648;c[L+4>>2]=J;J=fb(d[f+4>>0]|0|0,0,8)|0;L=C;K=fb(d[f+5>>0]|0|0,0,16)|0;I=L|C;L=d[f+6>>0]|0;F=fb(L|0,0,24)|0;G=eb(J|H|K|F|0,I|C|0,2)|0;I=x+8|0;c[I>>2]=G&33554431;c[I+4>>2]=0;I=fb(d[f+7>>0]|0|0,0,8)|0;G=C;F=fb(d[f+8>>0]|0|0,0,16)|0;K=G|C;G=d[f+9>>0]|0;H=fb(G|0,0,24)|0;J=eb(I|L|F|H|0,K|C|0,3)|0;K=x+16|0;c[K>>2]=J&67108863;c[K+4>>2]=0;K=fb(d[f+10>>0]|0|0,0,8)|0;J=C;H=fb(d[f+11>>0]|0|0,0,16)|0;F=J|C;J=d[f+12>>0]|0;L=fb(J|0,0,24)|0;I=eb(K|G|H|L|0,F|C|0,5)|0;F=x+24|0;c[F>>2]=I&33554431;c[F+4>>2]=0;F=fb(d[f+13>>0]|0|0,0,8)|0;I=C;L=fb(d[f+14>>0]|0|0,0,16)|0;H=I|C;I=fb(d[f+15>>0]|0|0,0,24)|0;G=eb(F|J|L|I|0,H|C|0,6)|0;H=x+32|0;c[H>>2]=G&67108863;c[H+4>>2]=0;H=d[f+16>>0]|0;G=fb(d[f+17>>0]|0|0,0,8)|0;I=C;L=fb(d[f+18>>0]|0|0,0,16)|0;J=I|C;I=d[f+19>>0]|0;F=fb(I|0,0,24)|0;K=x+40|0;c[K>>2]=G|H|L|F&16777216;c[K+4>>2]=J;J=fb(d[f+20>>0]|0|0,0,8)|0;K=C;F=fb(d[f+21>>0]|0|0,0,16)|0;L=K|C;K=d[f+22>>0]|0;H=fb(K|0,0,24)|0;G=eb(J|I|F|H|0,L|C|0,1)|0;L=x+48|0;c[L>>2]=G&67108863;c[L+4>>2]=0;L=fb(d[f+23>>0]|0|0,0,8)|0;G=C;H=fb(d[f+24>>0]|0|0,0,16)|0;F=G|C;G=d[f+25>>0]|0;I=fb(G|0,0,24)|0;J=eb(L|K|H|I|0,F|C|0,3)|0;F=x+56|0;c[F>>2]=J&33554431;c[F+4>>2]=0;F=fb(d[f+26>>0]|0|0,0,8)|0;J=C;I=fb(d[f+27>>0]|0|0,0,16)|0;H=J|C;J=d[f+28>>0]|0;K=fb(J|0,0,24)|0;L=eb(F|G|I|K|0,H|C|0,4)|0;H=x+64|0;c[H>>2]=L&67108863;c[H+4>>2]=0;H=fb(d[f+29>>0]|0|0,0,8)|0;L=C;K=fb(d[f+30>>0]|0|0,0,16)|0;I=L|C;L=fb(d[f+31>>0]|0|0,0,24)|0;f=eb(H|J|K|L|0,I|C|0,6)|0;I=x+72|0;c[I>>2]=f&33554431;c[I+4>>2]=0;db(q|0,0,152)|0;I=q;c[I>>2]=1;c[I+4>>2]=0;db(r|0,0,152)|0;I=r;c[I>>2]=1;c[I+4>>2]=0;db(s|0,0,152)|0;db(t|0,0,152)|0;db(u|0,0,152)|0;I=u;c[I>>2]=1;c[I+4>>2]=0;db(v|0,0,152)|0;db(w|0,0,152)|0;I=w;c[I>>2]=1;c[I+4>>2]=0;D=p+80|0;e=D+72|0;do c[D>>2]=0,D=D+4|0;while((D|0)<(e|0));D=p;E=x;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));I=l+144|0;f=l+64|0;L=l+136|0;K=l+56|0;J=l+128|0;H=l+48|0;G=l+120|0;F=l+40|0;M=l+112|0;N=l+32|0;O=l+104|0;P=l+24|0;Q=l+96|0;R=l+16|0;S=l+88|0;T=l+8|0;U=l+80|0;V=m+144|0;W=m+64|0;X=m+136|0;Y=m+56|0;Z=m+128|0;$=m+48|0;aa=m+120|0;ba=m+40|0;ca=m+112|0;da=m+32|0;ea=m+104|0;fa=m+24|0;ga=m+96|0;ha=m+16|0;ia=m+88|0;ja=m+8|0;ka=m+80|0;la=l+72|0;ma=m+72|0;na=j+8|0;oa=k+8|0;pa=j+16|0;qa=k+16|0;ra=j+24|0;sa=k+24|0;ta=j+32|0;ua=k+32|0;va=j+40|0;wa=k+40|0;xa=j+48|0;ya=k+48|0;za=j+56|0;Aa=k+56|0;Ba=j+64|0;Ca=k+64|0;Da=j+72|0;Ea=k+72|0;Fa=h+80|0;Ga=h+8|0;Ha=h+16|0;Ia=h+24|0;Ja=h+32|0;Ka=h+40|0;Oa=h+48|0;Pa=h+56|0;Qa=h+64|0;Ra=h+72|0;Sa=0;Ta=p;Ua=t;t=q;Va=u;u=r;Wa=v;v=s;s=w;while(1){w=a[B+(31-Sa)>>0]|0;Xa=0;Ya=Ta;Za=Ua;_a=t;$a=Va;gb=u;hb=Wa;ib=v;jb=s;while(1){kb=w&255;mb=bb(0,0,kb>>>7|0,0)|0;nb=C;ob=0;do pb=gb+(ob<<3)|0,qb=pb,rb=c[qb>>2]|0,sb=c[qb+4>>2]|0,qb=Ya+(ob<<3)|0,tb=qb,ub=c[tb>>2]|0,vb=c[tb+4>>2]|0,tb=(ub^rb)&mb,wb=(vb^sb)&nb,sb=ab(0,tb^rb|0,32)|0,rb=pb,c[rb>>2]=sb,c[rb+4>>2]=C,rb=ab(0,tb^ub|0,32)|0,ub=qb,c[ub>>2]=rb,c[ub+4>>2]=C,ob=ob+1|0;while((ob|0)!=10);xb=0;do ob=ib+(xb<<3)|0,ub=ob,rb=c[ub>>2]|0,qb=c[ub+4>>2]|0,ub=_a+(xb<<3)|0,tb=ub,sb=c[tb>>2]|0,pb=c[tb+4>>2]|0,tb=(sb^rb)&mb,vb=(pb^qb)&nb,qb=ab(0,tb^rb|0,32)|0,rb=ob,c[rb>>2]=qb,c[rb+4>>2]=C,rb=ab(0,tb^sb|0,32)|0,sb=ub,c[sb>>2]=rb,c[sb+4>>2]=C,xb=xb+1|0;while((xb|0)!=10);sb=gb;rb=c[sb>>2]|0;ub=c[sb+4>>2]|0;sb=gb+8|0;tb=sb;qb=c[tb>>2]|0;ob=c[tb+4>>2]|0;tb=gb+16|0;pb=tb;vb=c[pb>>2]|0;wb=c[pb+4>>2]|0;pb=gb+24|0;yb=pb;zb=c[yb>>2]|0;Ab=c[yb+4>>2]|0;yb=gb+32|0;Bb=yb;Cb=c[Bb>>2]|0;Db=c[Bb+4>>2]|0;Bb=gb+40|0;Eb=Bb;Fb=c[Eb>>2]|0;Gb=c[Eb+4>>2]|0;Eb=gb+48|0;Hb=Eb;Ib=c[Hb>>2]|0;Jb=c[Hb+4>>2]|0;Hb=gb+56|0;Kb=Hb;Lb=c[Kb>>2]|0;Mb=c[Kb+4>>2]|0;Kb=gb+64|0;Nb=Kb;Ob=c[Nb>>2]|0;Pb=c[Nb+4>>2]|0;Nb=gb+72|0;Qb=Nb;Rb=c[Qb>>2]|0;Sb=c[Qb+4>>2]|0;Qb=ib;Tb=c[Qb>>2]|0;Ub=c[Qb+4>>2]|0;Qb=cb(Tb|0,Ub|0,rb|0,ub|0)|0;Vb=gb;c[Vb>>2]=Qb;c[Vb+4>>2]=C;Vb=ib+8|0;Qb=Vb;Wb=c[Qb>>2]|0;Xb=c[Qb+4>>2]|0;Qb=cb(Wb|0,Xb|0,qb|0,ob|0)|0;Yb=sb;c[Yb>>2]=Qb;c[Yb+4>>2]=C;Yb=ib+16|0;Qb=Yb;sb=c[Qb>>2]|0;Zb=c[Qb+4>>2]|0;Qb=cb(sb|0,Zb|0,vb|0,wb|0)|0;_b=tb;c[_b>>2]=Qb;c[_b+4>>2]=C;_b=ib+24|0;Qb=_b;tb=c[Qb>>2]|0;$b=c[Qb+4>>2]|0;Qb=cb(tb|0,$b|0,zb|0,Ab|0)|0;ac=pb;c[ac>>2]=Qb;c[ac+4>>2]=C;ac=ib+32|0;Qb=ac;pb=c[Qb>>2]|0;bc=c[Qb+4>>2]|0;Qb=cb(pb|0,bc|0,Cb|0,Db|0)|0;cc=yb;c[cc>>2]=Qb;c[cc+4>>2]=C;cc=ib+40|0;Qb=cc;yb=c[Qb>>2]|0;dc=c[Qb+4>>2]|0;Qb=cb(yb|0,dc|0,Fb|0,Gb|0)|0;ec=Bb;c[ec>>2]=Qb;c[ec+4>>2]=C;ec=ib+48|0;Qb=ec;Bb=c[Qb>>2]|0;fc=c[Qb+4>>2]|0;Qb=cb(Bb|0,fc|0,Ib|0,Jb|0)|0;gc=Eb;c[gc>>2]=Qb;c[gc+4>>2]=C;gc=ib+56|0;Qb=gc;Eb=c[Qb>>2]|0;hc=c[Qb+4>>2]|0;Qb=cb(Eb|0,hc|0,Lb|0,Mb|0)|0;ic=Hb;c[ic>>2]=Qb;c[ic+4>>2]=C;ic=ib+64|0;Qb=ic;Hb=c[Qb>>2]|0;jc=c[Qb+4>>2]|0;Qb=cb(Hb|0,jc|0,Ob|0,Pb|0)|0;kc=Kb;c[kc>>2]=Qb;c[kc+4>>2]=C;kc=ib+72|0;Qb=kc;Kb=c[Qb>>2]|0;lc=c[Qb+4>>2]|0;Qb=cb(Kb|0,lc|0,Rb|0,Sb|0)|0;mc=Nb;c[mc>>2]=Qb;c[mc+4>>2]=C;mc=bb(rb|0,ub|0,Tb|0,Ub|0)|0;Ub=ib;c[Ub>>2]=mc;c[Ub+4>>2]=C;Ub=bb(qb|0,ob|0,Wb|0,Xb|0)|0;Xb=Vb;c[Xb>>2]=Ub;c[Xb+4>>2]=C;Xb=bb(vb|0,wb|0,sb|0,Zb|0)|0;Zb=Yb;c[Zb>>2]=Xb;c[Zb+4>>2]=C;Zb=bb(zb|0,Ab|0,tb|0,$b|0)|0;$b=_b;c[$b>>2]=Zb;c[$b+4>>2]=C;$b=bb(Cb|0,Db|0,pb|0,bc|0)|0;bc=ac;c[bc>>2]=$b;c[bc+4>>2]=C;bc=bb(Fb|0,Gb|0,yb|0,dc|0)|0;dc=cc;c[dc>>2]=bc;c[dc+4>>2]=C;dc=bb(Ib|0,Jb|0,Bb|0,fc|0)|0;fc=ec;c[fc>>2]=dc;c[fc+4>>2]=C;fc=bb(Lb|0,Mb|0,Eb|0,hc|0)|0;hc=gc;c[hc>>2]=fc;c[hc+4>>2]=C;hc=bb(Ob|0,Pb|0,Hb|0,jc|0)|0;jc=ic;c[jc>>2]=hc;c[jc+4>>2]=C;jc=bb(Rb|0,Sb|0,Kb|0,lc|0)|0;lc=kc;c[lc>>2]=jc;c[lc+4>>2]=C;lc=Ya;jc=c[lc>>2]|0;kc=c[lc+4>>2]|0;lc=Ya+8|0;Kb=lc;Sb=c[Kb>>2]|0;Rb=c[Kb+4>>2]|0;Kb=Ya+16|0;hc=Kb;ic=c[hc>>2]|0;Hb=c[hc+4>>2]|0;hc=Ya+24|0;Pb=hc;Ob=c[Pb>>2]|0;fc=c[Pb+4>>2]|0;Pb=Ya+32|0;gc=Pb;Eb=c[gc>>2]|0;Mb=c[gc+4>>2]|0;gc=Ya+40|0;Lb=gc;dc=c[Lb>>2]|0;ec=c[Lb+4>>2]|0;Lb=Ya+48|0;Bb=Lb;Jb=c[Bb>>2]|0;Ib=c[Bb+4>>2]|0;Bb=Ya+56|0;bc=Bb;cc=c[bc>>2]|0;yb=c[bc+4>>2]|0;bc=Ya+64|0;Gb=bc;Fb=c[Gb>>2]|0;$b=c[Gb+4>>2]|0;Gb=Ya+72|0;ac=Gb;pb=c[ac>>2]|0;Db=c[ac+4>>2]|0;ac=_a;Cb=c[ac>>2]|0;Zb=c[ac+4>>2]|0;ac=cb(Cb|0,Zb|0,jc|0,kc|0)|0;_b=Ya;c[_b>>2]=ac;c[_b+4>>2]=C;_b=_a+8|0;ac=_b;tb=c[ac>>2]|0;Ab=c[ac+4>>2]|0;ac=cb(tb|0,Ab|0,Sb|0,Rb|0)|0;zb=lc;c[zb>>2]=ac;c[zb+4>>2]=C;zb=_a+16|0;ac=zb;lc=c[ac>>2]|0;Xb=c[ac+4>>2]|0;ac=cb(lc|0,Xb|0,ic|0,Hb|0)|0;Yb=Kb;c[Yb>>2]=ac;c[Yb+4>>2]=C;Yb=_a+24|0;ac=Yb;Kb=c[ac>>2]|0;sb=c[ac+4>>2]|0;ac=cb(Kb|0,sb|0,Ob|0,fc|0)|0;wb=hc;c[wb>>2]=ac;c[wb+4>>2]=C;wb=_a+32|0;ac=wb;hc=c[ac>>2]|0;vb=c[ac+4>>2]|0;ac=cb(hc|0,vb|0,Eb|0,Mb|0)|0;Ub=Pb;c[Ub>>2]=ac;c[Ub+4>>2]=C;Ub=_a+40|0;ac=Ub;Pb=c[ac>>2]|0;Vb=c[ac+4>>2]|0;ac=cb(Pb|0,Vb|0,dc|0,ec|0)|0;Wb=gc;c[Wb>>2]=ac;c[Wb+4>>2]=C;Wb=_a+48|0;ac=Wb;gc=c[ac>>2]|0;ob=c[ac+4>>2]|0;ac=cb(gc|0,ob|0,Jb|0,Ib|0)|0;qb=Lb;c[qb>>2]=ac;c[qb+4>>2]=C;qb=_a+56|0;ac=qb;Lb=c[ac>>2]|0;mc=c[ac+4>>2]|0;ac=cb(Lb|0,mc|0,cc|0,yb|0)|0;Tb=Bb;c[Tb>>2]=ac;c[Tb+4>>2]=C;Tb=_a+64|0;ac=Tb;Bb=c[ac>>2]|0;ub=c[ac+4>>2]|0;ac=cb(Bb|0,ub|0,Fb|0,$b|0)|0;rb=bc;c[rb>>2]=ac;c[rb+4>>2]=C;rb=_a+72|0;ac=rb;bc=c[ac>>2]|0;Qb=c[ac+4>>2]|0;ac=cb(bc|0,Qb|0,pb|0,Db|0)|0;Nb=Gb;c[Nb>>2]=ac;c[Nb+4>>2]=C;Nb=bb(jc|0,kc|0,Cb|0,Zb|0)|0;Zb=_a;c[Zb>>2]=Nb;c[Zb+4>>2]=C;Zb=bb(Sb|0,Rb|0,tb|0,Ab|0)|0;Ab=_b;c[Ab>>2]=Zb;c[Ab+4>>2]=C;Ab=bb(ic|0,Hb|0,lc|0,Xb|0)|0;Xb=zb;c[Xb>>2]=Ab;c[Xb+4>>2]=C;Xb=bb(Ob|0,fc|0,Kb|0,sb|0)|0;sb=Yb;c[sb>>2]=Xb;c[sb+4>>2]=C;sb=bb(Eb|0,Mb|0,hc|0,vb|0)|0;vb=wb;c[vb>>2]=sb;c[vb+4>>2]=C;vb=bb(dc|0,ec|0,Pb|0,Vb|0)|0;Vb=Ub;c[Vb>>2]=vb;c[Vb+4>>2]=C;Vb=bb(Jb|0,Ib|0,gc|0,ob|0)|0;ob=Wb;c[ob>>2]=Vb;c[ob+4>>2]=C;ob=bb(cc|0,yb|0,Lb|0,mc|0)|0;mc=qb;c[mc>>2]=ob;c[mc+4>>2]=C;mc=bb(Fb|0,$b|0,Bb|0,ub|0)|0;ub=Tb;c[ub>>2]=mc;c[ub+4>>2]=C;ub=bb(pb|0,Db|0,bc|0,Qb|0)|0;Qb=rb;c[Qb>>2]=ub;c[Qb+4>>2]=C;Ma(l,Ya,ib);Ma(m,gb,_a);Qb=I;ub=c[Qb>>2]|0;rb=c[Qb+4>>2]|0;Qb=f;bc=c[Qb>>2]|0;Db=c[Qb+4>>2]|0;Qb=lb(ub|0,rb|0,18,0)|0;pb=C;mc=cb(bc|0,Db|0,ub|0,rb|0)|0;rb=cb(mc|0,C|0,Qb|0,pb|0)|0;pb=f;c[pb>>2]=rb;c[pb+4>>2]=C;pb=L;rb=c[pb>>2]|0;Qb=c[pb+4>>2]|0;pb=K;mc=c[pb>>2]|0;ub=c[pb+4>>2]|0;pb=lb(rb|0,Qb|0,18,0)|0;Db=C;bc=cb(mc|0,ub|0,rb|0,Qb|0)|0;Qb=cb(bc|0,C|0,pb|0,Db|0)|0;Db=K;c[Db>>2]=Qb;c[Db+4>>2]=C;Db=J;Qb=c[Db>>2]|0;pb=c[Db+4>>2]|0;Db=H;bc=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=lb(Qb|0,pb|0,18,0)|0;ub=C;mc=cb(bc|0,rb|0,Qb|0,pb|0)|0;pb=cb(mc|0,C|0,Db|0,ub|0)|0;ub=H;c[ub>>2]=pb;c[ub+4>>2]=C;ub=G;pb=c[ub>>2]|0;Db=c[ub+4>>2]|0;ub=F;mc=c[ub>>2]|0;Qb=c[ub+4>>2]|0;ub=lb(pb|0,Db|0,18,0)|0;rb=C;bc=cb(mc|0,Qb|0,pb|0,Db|0)|0;Db=cb(bc|0,C|0,ub|0,rb|0)|0;rb=F;c[rb>>2]=Db;c[rb+4>>2]=C;rb=M;Db=c[rb>>2]|0;ub=c[rb+4>>2]|0;rb=N;bc=c[rb>>2]|0;pb=c[rb+4>>2]|0;rb=lb(Db|0,ub|0,18,0)|0;Qb=C;mc=cb(bc|0,pb|0,Db|0,ub|0)|0;ub=cb(mc|0,C|0,rb|0,Qb|0)|0;Qb=N;c[Qb>>2]=ub;c[Qb+4>>2]=C;Qb=O;ub=c[Qb>>2]|0;rb=c[Qb+4>>2]|0;Qb=P;mc=c[Qb>>2]|0;Db=c[Qb+4>>2]|0;Qb=lb(ub|0,rb|0,18,0)|0;pb=C;bc=cb(mc|0,Db|0,ub|0,rb|0)|0;rb=cb(bc|0,C|0,Qb|0,pb|0)|0;pb=P;c[pb>>2]=rb;c[pb+4>>2]=C;pb=Q;rb=c[pb>>2]|0;Qb=c[pb+4>>2]|0;pb=R;bc=c[pb>>2]|0;ub=c[pb+4>>2]|0;pb=lb(rb|0,Qb|0,18,0)|0;Db=C;mc=cb(bc|0,ub|0,rb|0,Qb|0)|0;Qb=cb(mc|0,C|0,pb|0,Db|0)|0;Db=R;c[Db>>2]=Qb;c[Db+4>>2]=C;Db=S;Qb=c[Db>>2]|0;pb=c[Db+4>>2]|0;Db=T;mc=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=lb(Qb|0,pb|0,18,0)|0;ub=C;bc=cb(mc|0,rb|0,Qb|0,pb|0)|0;pb=cb(bc|0,C|0,Db|0,ub|0)|0;ub=T;c[ub>>2]=pb;c[ub+4>>2]=C;ub=U;pb=c[ub>>2]|0;Db=c[ub+4>>2]|0;ub=l;bc=c[ub>>2]|0;Qb=c[ub+4>>2]|0;ub=lb(pb|0,Db|0,18,0)|0;rb=C;mc=cb(bc|0,Qb|0,pb|0,Db|0)|0;Db=cb(mc|0,C|0,ub|0,rb|0)|0;rb=C;ub=l;c[ub>>2]=Db;c[ub+4>>2]=rb;ub=U;c[ub>>2]=0;c[ub+4>>2]=0;ub=rb;rb=Db;Db=0;do mc=cb(ub>>31>>>6|0,0,rb|0,ub|0)|0,pb=ab(mc|0,C|0,26)|0,mc=C,Qb=fb(pb|0,mc|0,26)|0,bc=bb(rb|0,ub|0,Qb|0,C|0)|0,Qb=l+(Db<<3)|0,c[Qb>>2]=bc,c[Qb+4>>2]=C,Qb=l+((Db|1)<<3)|0,bc=Qb,Tb=cb(pb|0,mc|0,c[bc>>2]|0,c[bc+4>>2]|0)|0,bc=C,mc=cb(bc>>31>>>7|0,0,Tb|0,bc|0)|0,pb=ab(mc|0,C|0,25)|0,mc=C,Bb=fb(pb|0,mc|0,25)|0,$b=bb(Tb|0,bc|0,Bb|0,C|0)|0,Bb=Qb,c[Bb>>2]=$b,c[Bb+4>>2]=C,Db=Db+2|0,Bb=l+(Db<<3)|0,$b=Bb,rb=cb(pb|0,mc|0,c[$b>>2]|0,c[$b+4>>2]|0)|0,ub=C,$b=Bb,c[$b>>2]=rb,c[$b+4>>2]=ub;while(Db>>>0<10);Db=U;ub=c[Db>>2]|0;rb=c[Db+4>>2]|0;Db=l;$b=c[Db>>2]|0;Bb=c[Db+4>>2]|0;Db=lb(ub|0,rb|0,18,0)|0;mc=C;pb=cb($b|0,Bb|0,ub|0,rb|0)|0;rb=cb(pb|0,C|0,Db|0,mc|0)|0;mc=C;Db=U;c[Db>>2]=0;c[Db+4>>2]=0;Db=cb(mc>>31>>>6|0,0,rb|0,mc|0)|0;pb=ab(Db|0,C|0,26)|0;Db=C;ub=fb(pb|0,Db|0,26)|0;Bb=bb(rb|0,mc|0,ub|0,C|0)|0;ub=C;mc=l;c[mc>>2]=Bb;c[mc+4>>2]=ub;mc=T;rb=cb(pb|0,Db|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=C;Db=T;c[Db>>2]=rb;c[Db+4>>2]=mc;Db=V;pb=c[Db>>2]|0;$b=c[Db+4>>2]|0;Db=W;Qb=c[Db>>2]|0;bc=c[Db+4>>2]|0;Db=lb(pb|0,$b|0,18,0)|0;Tb=C;Fb=cb(Qb|0,bc|0,pb|0,$b|0)|0;$b=cb(Fb|0,C|0,Db|0,Tb|0)|0;Tb=W;c[Tb>>2]=$b;c[Tb+4>>2]=C;Tb=X;$b=c[Tb>>2]|0;Db=c[Tb+4>>2]|0;Tb=Y;Fb=c[Tb>>2]|0;pb=c[Tb+4>>2]|0;Tb=lb($b|0,Db|0,18,0)|0;bc=C;Qb=cb(Fb|0,pb|0,$b|0,Db|0)|0;Db=cb(Qb|0,C|0,Tb|0,bc|0)|0;bc=Y;c[bc>>2]=Db;c[bc+4>>2]=C;bc=Z;Db=c[bc>>2]|0;Tb=c[bc+4>>2]|0;bc=$;Qb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=lb(Db|0,Tb|0,18,0)|0;pb=C;Fb=cb(Qb|0,$b|0,Db|0,Tb|0)|0;Tb=cb(Fb|0,C|0,bc|0,pb|0)|0;pb=$;c[pb>>2]=Tb;c[pb+4>>2]=C;pb=aa;Tb=c[pb>>2]|0;bc=c[pb+4>>2]|0;pb=ba;Fb=c[pb>>2]|0;Db=c[pb+4>>2]|0;pb=lb(Tb|0,bc|0,18,0)|0;$b=C;Qb=cb(Fb|0,Db|0,Tb|0,bc|0)|0;bc=cb(Qb|0,C|0,pb|0,$b|0)|0;$b=ba;c[$b>>2]=bc;c[$b+4>>2]=C;$b=ca;bc=c[$b>>2]|0;pb=c[$b+4>>2]|0;$b=da;Qb=c[$b>>2]|0;Tb=c[$b+4>>2]|0;$b=lb(bc|0,pb|0,18,0)|0;Db=C;Fb=cb(Qb|0,Tb|0,bc|0,pb|0)|0;pb=cb(Fb|0,C|0,$b|0,Db|0)|0;Db=da;c[Db>>2]=pb;c[Db+4>>2]=C;Db=ea;pb=c[Db>>2]|0;$b=c[Db+4>>2]|0;Db=fa;Fb=c[Db>>2]|0;bc=c[Db+4>>2]|0;Db=lb(pb|0,$b|0,18,0)|0;Tb=C;Qb=cb(Fb|0,bc|0,pb|0,$b|0)|0;$b=cb(Qb|0,C|0,Db|0,Tb|0)|0;Tb=fa;c[Tb>>2]=$b;c[Tb+4>>2]=C;Tb=ga;$b=c[Tb>>2]|0;Db=c[Tb+4>>2]|0;Tb=ha;Qb=c[Tb>>2]|0;pb=c[Tb+4>>2]|0;Tb=lb($b|0,Db|0,18,0)|0;bc=C;Fb=cb(Qb|0,pb|0,$b|0,Db|0)|0;Db=cb(Fb|0,C|0,Tb|0,bc|0)|0;bc=ha;c[bc>>2]=Db;c[bc+4>>2]=C;bc=ia;Db=c[bc>>2]|0;Tb=c[bc+4>>2]|0;bc=ja;Fb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=lb(Db|0,Tb|0,18,0)|0;pb=C;Qb=cb(Fb|0,$b|0,Db|0,Tb|0)|0;Tb=cb(Qb|0,C|0,bc|0,pb|0)|0;pb=ja;c[pb>>2]=Tb;c[pb+4>>2]=C;pb=ka;Tb=c[pb>>2]|0;bc=c[pb+4>>2]|0;pb=m;Qb=c[pb>>2]|0;Db=c[pb+4>>2]|0;pb=lb(Tb|0,bc|0,18,0)|0;$b=C;Fb=cb(Qb|0,Db|0,Tb|0,bc|0)|0;bc=cb(Fb|0,C|0,pb|0,$b|0)|0;$b=C;pb=m;c[pb>>2]=bc;c[pb+4>>2]=$b;pb=ka;c[pb>>2]=0;c[pb+4>>2]=0;pb=$b;$b=bc;bc=0;do Fb=cb(pb>>31>>>6|0,0,$b|0,pb|0)|0,Tb=ab(Fb|0,C|0,26)|0,Fb=C,Db=fb(Tb|0,Fb|0,26)|0,Qb=bb($b|0,pb|0,Db|0,C|0)|0,Db=m+(bc<<3)|0,c[Db>>2]=Qb,c[Db+4>>2]=C,Db=m+((bc|1)<<3)|0,Qb=Db,ob=cb(Tb|0,Fb|0,c[Qb>>2]|0,c[Qb+4>>2]|0)|0,Qb=C,Fb=cb(Qb>>31>>>7|0,0,ob|0,Qb|0)|0,Tb=ab(Fb|0,C|0,25)|0,Fb=C,qb=fb(Tb|0,Fb|0,25)|0,Lb=bb(ob|0,Qb|0,qb|0,C|0)|0,qb=Db,c[qb>>2]=Lb,c[qb+4>>2]=C,bc=bc+2|0,qb=m+(bc<<3)|0,Lb=qb,$b=cb(Tb|0,Fb|0,c[Lb>>2]|0,c[Lb+4>>2]|0)|0,pb=C,Lb=qb,c[Lb>>2]=$b,c[Lb+4>>2]=pb;while(bc>>>0<10);bc=ka;pb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=m;Lb=c[bc>>2]|0;qb=c[bc+4>>2]|0;bc=lb(pb|0,$b|0,18,0)|0;Fb=C;Tb=cb(Lb|0,qb|0,pb|0,$b|0)|0;$b=cb(Tb|0,C|0,bc|0,Fb|0)|0;Fb=C;bc=ka;c[bc>>2]=0;c[bc+4>>2]=0;bc=cb(Fb>>31>>>6|0,0,$b|0,Fb|0)|0;Tb=ab(bc|0,C|0,26)|0;bc=C;pb=fb(Tb|0,bc|0,26)|0;qb=bb($b|0,Fb|0,pb|0,C|0)|0;pb=C;Fb=ja;$b=cb(Tb|0,bc|0,c[Fb>>2]|0,c[Fb+4>>2]|0)|0;Fb=C;bc=R;Tb=c[bc>>2]|0;Lb=c[bc+4>>2]|0;bc=P;Db=c[bc>>2]|0;Qb=c[bc+4>>2]|0;bc=N;ob=c[bc>>2]|0;yb=c[bc+4>>2]|0;bc=F;cc=c[bc>>2]|0;Vb=c[bc+4>>2]|0;bc=H;Wb=c[bc>>2]|0;gc=c[bc+4>>2]|0;bc=K;Ib=c[bc>>2]|0;Jb=c[bc+4>>2]|0;bc=f;vb=c[bc>>2]|0;Ub=c[bc+4>>2]|0;bc=la;Pb=c[bc>>2]|0;ec=c[bc+4>>2]|0;bc=cb(qb|0,pb|0,Bb|0,ub|0)|0;dc=l;c[dc>>2]=bc;c[dc+4>>2]=C;dc=cb($b|0,Fb|0,rb|0,mc|0)|0;bc=T;c[bc>>2]=dc;c[bc+4>>2]=C;bc=ha;dc=c[bc>>2]|0;sb=c[bc+4>>2]|0;bc=cb(dc|0,sb|0,Tb|0,Lb|0)|0;wb=R;c[wb>>2]=bc;c[wb+4>>2]=C;wb=fa;bc=c[wb>>2]|0;hc=c[wb+4>>2]|0;wb=cb(bc|0,hc|0,Db|0,Qb|0)|0;Mb=P;c[Mb>>2]=wb;c[Mb+4>>2]=C;Mb=da;wb=c[Mb>>2]|0;Eb=c[Mb+4>>2]|0;Mb=cb(wb|0,Eb|0,ob|0,yb|0)|0;Xb=N;c[Xb>>2]=Mb;c[Xb+4>>2]=C;Xb=ba;Mb=c[Xb>>2]|0;Yb=c[Xb+4>>2]|0;Xb=cb(Mb|0,Yb|0,cc|0,Vb|0)|0;Kb=F;c[Kb>>2]=Xb;c[Kb+4>>2]=C;Kb=$;Xb=c[Kb>>2]|0;fc=c[Kb+4>>2]|0;Kb=cb(Xb|0,fc|0,Wb|0,gc|0)|0;Ob=H;c[Ob>>2]=Kb;c[Ob+4>>2]=C;Ob=Y;Kb=c[Ob>>2]|0;Ab=c[Ob+4>>2]|0;Ob=cb(Kb|0,Ab|0,Ib|0,Jb|0)|0;zb=K;c[zb>>2]=Ob;c[zb+4>>2]=C;zb=W;Ob=c[zb>>2]|0;lc=c[zb+4>>2]|0;zb=cb(Ob|0,lc|0,vb|0,Ub|0)|0;Hb=f;c[Hb>>2]=zb;c[Hb+4>>2]=C;Hb=ma;zb=c[Hb>>2]|0;ic=c[Hb+4>>2]|0;Hb=cb(zb|0,ic|0,Pb|0,ec|0)|0;Zb=la;c[Zb>>2]=Hb;c[Zb+4>>2]=C;Zb=bb(Bb|0,ub|0,qb|0,pb|0)|0;pb=m;c[pb>>2]=Zb;c[pb+4>>2]=C;pb=bb(rb|0,mc|0,$b|0,Fb|0)|0;Fb=ja;c[Fb>>2]=pb;c[Fb+4>>2]=C;Fb=bb(Tb|0,Lb|0,dc|0,sb|0)|0;sb=ha;c[sb>>2]=Fb;c[sb+4>>2]=C;sb=bb(Db|0,Qb|0,bc|0,hc|0)|0;hc=fa;c[hc>>2]=sb;c[hc+4>>2]=C;hc=bb(ob|0,yb|0,wb|0,Eb|0)|0;Eb=da;c[Eb>>2]=hc;c[Eb+4>>2]=C;Eb=bb(cc|0,Vb|0,Mb|0,Yb|0)|0;Yb=ba;c[Yb>>2]=Eb;c[Yb+4>>2]=C;Yb=bb(Wb|0,gc|0,Xb|0,fc|0)|0;fc=$;c[fc>>2]=Yb;c[fc+4>>2]=C;fc=bb(Ib|0,Jb|0,Kb|0,Ab|0)|0;Ab=Y;c[Ab>>2]=fc;c[Ab+4>>2]=C;Ab=bb(vb|0,Ub|0,Ob|0,lc|0)|0;lc=W;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=bb(Pb|0,ec|0,zb|0,ic|0)|0;ic=ma;c[ic>>2]=lc;c[ic+4>>2]=C;Na(o,l);Na(n,m);Ma(m,n,x);ic=V;lc=c[ic>>2]|0;zb=c[ic+4>>2]|0;ic=W;ec=c[ic>>2]|0;Pb=c[ic+4>>2]|0;ic=lb(lc|0,zb|0,18,0)|0;Ab=C;Ob=cb(ec|0,Pb|0,lc|0,zb|0)|0;zb=cb(Ob|0,C|0,ic|0,Ab|0)|0;Ab=W;c[Ab>>2]=zb;c[Ab+4>>2]=C;Ab=X;zb=c[Ab>>2]|0;ic=c[Ab+4>>2]|0;Ab=Y;Ob=c[Ab>>2]|0;lc=c[Ab+4>>2]|0;Ab=lb(zb|0,ic|0,18,0)|0;Pb=C;ec=cb(Ob|0,lc|0,zb|0,ic|0)|0;ic=cb(ec|0,C|0,Ab|0,Pb|0)|0;Pb=Y;c[Pb>>2]=ic;c[Pb+4>>2]=C;Pb=Z;ic=c[Pb>>2]|0;Ab=c[Pb+4>>2]|0;Pb=$;ec=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=lb(ic|0,Ab|0,18,0)|0;lc=C;Ob=cb(ec|0,zb|0,ic|0,Ab|0)|0;Ab=cb(Ob|0,C|0,Pb|0,lc|0)|0;lc=$;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=aa;Ab=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=ba;Ob=c[lc>>2]|0;ic=c[lc+4>>2]|0;lc=lb(Ab|0,Pb|0,18,0)|0;zb=C;ec=cb(Ob|0,ic|0,Ab|0,Pb|0)|0;Pb=cb(ec|0,C|0,lc|0,zb|0)|0;zb=ba;c[zb>>2]=Pb;c[zb+4>>2]=C;zb=ca;Pb=c[zb>>2]|0;lc=c[zb+4>>2]|0;zb=da;ec=c[zb>>2]|0;Ab=c[zb+4>>2]|0;zb=lb(Pb|0,lc|0,18,0)|0;ic=C;Ob=cb(ec|0,Ab|0,Pb|0,lc|0)|0;lc=cb(Ob|0,C|0,zb|0,ic|0)|0;ic=da;c[ic>>2]=lc;c[ic+4>>2]=C;ic=ea;lc=c[ic>>2]|0;zb=c[ic+4>>2]|0;ic=fa;Ob=c[ic>>2]|0;Pb=c[ic+4>>2]|0;ic=lb(lc|0,zb|0,18,0)|0;Ab=C;ec=cb(Ob|0,Pb|0,lc|0,zb|0)|0;zb=cb(ec|0,C|0,ic|0,Ab|0)|0;Ab=fa;c[Ab>>2]=zb;c[Ab+4>>2]=C;Ab=ga;zb=c[Ab>>2]|0;ic=c[Ab+4>>2]|0;Ab=ha;ec=c[Ab>>2]|0;lc=c[Ab+4>>2]|0;Ab=lb(zb|0,ic|0,18,0)|0;Pb=C;Ob=cb(ec|0,lc|0,zb|0,ic|0)|0;ic=cb(Ob|0,C|0,Ab|0,Pb|0)|0;Pb=ha;c[Pb>>2]=ic;c[Pb+4>>2]=C;Pb=ia;ic=c[Pb>>2]|0;Ab=c[Pb+4>>2]|0;Pb=ja;Ob=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=lb(ic|0,Ab|0,18,0)|0;lc=C;ec=cb(Ob|0,zb|0,ic|0,Ab|0)|0;Ab=cb(ec|0,C|0,Pb|0,lc|0)|0;lc=ja;c[lc>>2]=Ab;c[lc+4>>2]=C;lc=ka;Ab=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=m;ec=c[lc>>2]|0;ic=c[lc+4>>2]|0;lc=lb(Ab|0,Pb|0,18,0)|0;zb=C;Ob=cb(ec|0,ic|0,Ab|0,Pb|0)|0;Pb=cb(Ob|0,C|0,lc|0,zb|0)|0;zb=C;lc=m;c[lc>>2]=Pb;c[lc+4>>2]=zb;lc=ka;c[lc>>2]=0;c[lc+4>>2]=0;lc=zb;zb=Pb;Pb=0;do Ob=cb(lc>>31>>>6|0,0,zb|0,lc|0)|0,Ab=ab(Ob|0,C|0,26)|0,Ob=C,ic=fb(Ab|0,Ob|0,26)|0,ec=bb(zb|0,lc|0,ic|0,C|0)|0,ic=m+(Pb<<3)|0,c[ic>>2]=ec,c[ic+4>>2]=C,ic=m+((Pb|1)<<3)|0,ec=ic,Ub=cb(Ab|0,Ob|0,c[ec>>2]|0,c[ec+4>>2]|0)|0,ec=C,Ob=cb(ec>>31>>>7|0,0,Ub|0,ec|0)|0,Ab=ab(Ob|0,C|0,25)|0,Ob=C,vb=fb(Ab|0,Ob|0,25)|0,fc=bb(Ub|0,ec|0,vb|0,C|0)|0,vb=ic,c[vb>>2]=fc,c[vb+4>>2]=C,Pb=Pb+2|0,vb=m+(Pb<<3)|0,fc=vb,zb=cb(Ab|0,Ob|0,c[fc>>2]|0,c[fc+4>>2]|0)|0,lc=C,fc=vb,c[fc>>2]=zb,c[fc+4>>2]=lc;while(Pb>>>0<10);Pb=ka;lc=c[Pb>>2]|0;zb=c[Pb+4>>2]|0;Pb=m;mc=c[Pb>>2]|0;rb=c[Pb+4>>2]|0;Pb=lb(lc|0,zb|0,18,0)|0;ub=C;Bb=cb(mc|0,rb|0,lc|0,zb|0)|0;zb=cb(Bb|0,C|0,Pb|0,ub|0)|0;ub=C;Pb=ka;c[Pb>>2]=0;c[Pb+4>>2]=0;Pb=cb(ub>>31>>>6|0,0,zb|0,ub|0)|0;Bb=ab(Pb|0,C|0,26)|0;Pb=C;lc=fb(Bb|0,Pb|0,26)|0;rb=bb(zb|0,ub|0,lc|0,C|0)|0;lc=m;c[lc>>2]=rb;c[lc+4>>2]=C;lc=ja;rb=cb(Bb|0,Pb|0,c[lc>>2]|0,c[lc+4>>2]|0)|0;lc=ja;c[lc>>2]=rb;c[lc+4>>2]=C;D=Za;E=o;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));D=$a;E=m;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));Na(j,gb);Na(k,ib);Ma(hb,j,k);lc=hb+144|0;rb=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=hb+64|0;Bb=lc;ub=c[Bb>>2]|0;zb=c[Bb+4>>2]|0;Bb=lb(rb|0,Pb|0,18,0)|0;mc=C;fc=cb(ub|0,zb|0,rb|0,Pb|0)|0;Pb=cb(fc|0,C|0,Bb|0,mc|0)|0;mc=lc;c[mc>>2]=Pb;c[mc+4>>2]=C;mc=hb+136|0;Pb=c[mc>>2]|0;lc=c[mc+4>>2]|0;mc=hb+56|0;Bb=mc;fc=c[Bb>>2]|0;rb=c[Bb+4>>2]|0;Bb=lb(Pb|0,lc|0,18,0)|0;zb=C;ub=cb(fc|0,rb|0,Pb|0,lc|0)|0;lc=cb(ub|0,C|0,Bb|0,zb|0)|0;zb=mc;c[zb>>2]=lc;c[zb+4>>2]=C;zb=hb+128|0;lc=c[zb>>2]|0;mc=c[zb+4>>2]|0;zb=hb+48|0;Bb=zb;ub=c[Bb>>2]|0;Pb=c[Bb+4>>2]|0;Bb=lb(lc|0,mc|0,18,0)|0;rb=C;fc=cb(ub|0,Pb|0,lc|0,mc|0)|0;mc=cb(fc|0,C|0,Bb|0,rb|0)|0;rb=zb;c[rb>>2]=mc;c[rb+4>>2]=C;rb=hb+120|0;mc=c[rb>>2]|0;zb=c[rb+4>>2]|0;rb=hb+40|0;Bb=rb;fc=c[Bb>>2]|0;lc=c[Bb+4>>2]|0;Bb=lb(mc|0,zb|0,18,0)|0;Pb=C;ub=cb(fc|0,lc|0,mc|0,zb|0)|0;zb=cb(ub|0,C|0,Bb|0,Pb|0)|0;Pb=rb;c[Pb>>2]=zb;c[Pb+4>>2]=C;Pb=hb+112|0;zb=c[Pb>>2]|0;rb=c[Pb+4>>2]|0;Pb=hb+32|0;Bb=Pb;ub=c[Bb>>2]|0;mc=c[Bb+4>>2]|0;Bb=lb(zb|0,rb|0,18,0)|0;lc=C;fc=cb(ub|0,mc|0,zb|0,rb|0)|0;rb=cb(fc|0,C|0,Bb|0,lc|0)|0;lc=Pb;c[lc>>2]=rb;c[lc+4>>2]=C;lc=hb+104|0;rb=c[lc>>2]|0;Pb=c[lc+4>>2]|0;lc=hb+24|0;Bb=lc;fc=c[Bb>>2]|0;zb=c[Bb+4>>2]|0;Bb=lb(rb|0,Pb|0,18,0)|0;mc=C;ub=cb(fc|0,zb|0,rb|0,Pb|0)|0;Pb=cb(ub|0,C|0,Bb|0,mc|0)|0;mc=lc;c[mc>>2]=Pb;c[mc+4>>2]=C;mc=hb+96|0;Pb=c[mc>>2]|0;lc=c[mc+4>>2]|0;mc=hb+16|0;Bb=mc;ub=c[Bb>>2]|0;rb=c[Bb+4>>2]|0;Bb=lb(Pb|0,lc|0,18,0)|0;zb=C;fc=cb(ub|0,rb|0,Pb|0,lc|0)|0;lc=cb(fc|0,C|0,Bb|0,zb|0)|0;zb=mc;c[zb>>2]=lc;c[zb+4>>2]=C;zb=hb+88|0;lc=c[zb>>2]|0;mc=c[zb+4>>2]|0;zb=hb+8|0;Bb=zb;fc=c[Bb>>2]|0;Pb=c[Bb+4>>2]|0;Bb=lb(lc|0,mc|0,18,0)|0;rb=C;ub=cb(fc|0,Pb|0,lc|0,mc|0)|0;mc=cb(ub|0,C|0,Bb|0,rb|0)|0;rb=zb;c[rb>>2]=mc;c[rb+4>>2]=C;rb=hb+80|0;mc=rb;Bb=c[mc>>2]|0;ub=c[mc+4>>2]|0;mc=hb;lc=c[mc>>2]|0;Pb=c[mc+4>>2]|0;mc=lb(Bb|0,ub|0,18,0)|0;fc=C;vb=cb(lc|0,Pb|0,Bb|0,ub|0)|0;ub=cb(vb|0,C|0,mc|0,fc|0)|0;fc=C;mc=hb;c[mc>>2]=ub;c[mc+4>>2]=fc;mc=rb;c[mc>>2]=0;c[mc+4>>2]=0;mc=fc;fc=ub;ub=0;do vb=cb(mc>>31>>>6|0,0,fc|0,mc|0)|0,Bb=ab(vb|0,C|0,26)|0,vb=C,Pb=fb(Bb|0,vb|0,26)|0,lc=bb(fc|0,mc|0,Pb|0,C|0)|0,Pb=hb+(ub<<3)|0,c[Pb>>2]=lc,c[Pb+4>>2]=C,Pb=hb+((ub|1)<<3)|0,lc=Pb,Ob=cb(Bb|0,vb|0,c[lc>>2]|0,c[lc+4>>2]|0)|0,lc=C,vb=cb(lc>>31>>>7|0,0,Ob|0,lc|0)|0,Bb=ab(vb|0,C|0,25)|0,vb=C,Ab=fb(Bb|0,vb|0,25)|0,ic=bb(Ob|0,lc|0,Ab|0,C|0)|0,Ab=Pb,c[Ab>>2]=ic,c[Ab+4>>2]=C,ub=ub+2|0,Ab=hb+(ub<<3)|0,ic=Ab,fc=cb(Bb|0,vb|0,c[ic>>2]|0,c[ic+4>>2]|0)|0,mc=C,ic=Ab,c[ic>>2]=fc,c[ic+4>>2]=mc;while(ub>>>0<10);ub=rb;mc=c[ub>>2]|0;fc=c[ub+4>>2]|0;ub=hb;ic=c[ub>>2]|0;Ab=c[ub+4>>2]|0;ub=lb(mc|0,fc|0,18,0)|0;vb=C;Bb=cb(ic|0,Ab|0,mc|0,fc|0)|0;fc=cb(Bb|0,C|0,ub|0,vb|0)|0;vb=C;ub=rb;c[ub>>2]=0;c[ub+4>>2]=0;ub=cb(vb>>31>>>6|0,0,fc|0,vb|0)|0;Bb=ab(ub|0,C|0,26)|0;ub=C;mc=fb(Bb|0,ub|0,26)|0;Ab=bb(fc|0,vb|0,mc|0,C|0)|0;mc=hb;c[mc>>2]=Ab;c[mc+4>>2]=C;mc=zb;Ab=cb(Bb|0,ub|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=zb;c[mc>>2]=Ab;c[mc+4>>2]=C;mc=j;Ab=c[mc>>2]|0;ub=c[mc+4>>2]|0;mc=k;Bb=bb(Ab|0,ub|0,c[mc>>2]|0,c[mc+4>>2]|0)|0;mc=C;vb=k;c[vb>>2]=Bb;c[vb+4>>2]=mc;vb=na;fc=c[vb>>2]|0;ic=c[vb+4>>2]|0;vb=oa;Pb=bb(fc|0,ic|0,c[vb>>2]|0,c[vb+4>>2]|0)|0;vb=C;lc=oa;c[lc>>2]=Pb;c[lc+4>>2]=vb;lc=pa;Ob=c[lc>>2]|0;ec=c[lc+4>>2]|0;lc=qa;Ub=bb(Ob|0,ec|0,c[lc>>2]|0,c[lc+4>>2]|0)|0;lc=C;Kb=qa;c[Kb>>2]=Ub;c[Kb+4>>2]=lc;Kb=ra;Jb=c[Kb>>2]|0;Ib=c[Kb+4>>2]|0;Kb=sa;Yb=bb(Jb|0,Ib|0,c[Kb>>2]|0,c[Kb+4>>2]|0)|0;Kb=C;Xb=sa;c[Xb>>2]=Yb;c[Xb+4>>2]=Kb;Xb=ta;gc=c[Xb>>2]|0;Wb=c[Xb+4>>2]|0;Xb=ua;Eb=bb(gc|0,Wb|0,c[Xb>>2]|0,c[Xb+4>>2]|0)|0;Xb=C;Mb=ua;c[Mb>>2]=Eb;c[Mb+4>>2]=Xb;Mb=va;Vb=c[Mb>>2]|0;cc=c[Mb+4>>2]|0;Mb=wa;hc=bb(Vb|0,cc|0,c[Mb>>2]|0,c[Mb+4>>2]|0)|0;Mb=C;wb=wa;c[wb>>2]=hc;c[wb+4>>2]=Mb;wb=xa;yb=c[wb>>2]|0;ob=c[wb+4>>2]|0;wb=ya;sb=bb(yb|0,ob|0,c[wb>>2]|0,c[wb+4>>2]|0)|0;wb=C;bc=ya;c[bc>>2]=sb;c[bc+4>>2]=wb;bc=za;Qb=c[bc>>2]|0;Db=c[bc+4>>2]|0;bc=Aa;Fb=bb(Qb|0,Db|0,c[bc>>2]|0,c[bc+4>>2]|0)|0;bc=C;dc=Aa;c[dc>>2]=Fb;c[dc+4>>2]=bc;dc=Ba;Lb=c[dc>>2]|0;Tb=c[dc+4>>2]|0;dc=Ca;pb=bb(Lb|0,Tb|0,c[dc>>2]|0,c[dc+4>>2]|0)|0;dc=C;$b=Ca;c[$b>>2]=pb;c[$b+4>>2]=dc;$b=Da;Zb=c[$b>>2]|0;qb=c[$b+4>>2]|0;$b=Ea;Hb=bb(Zb|0,qb|0,c[$b>>2]|0,c[$b+4>>2]|0)|0;$b=C;_b=Ea;c[_b>>2]=Hb;c[_b+4>>2]=$b;D=Fa;e=D+72|0;do c[D>>2]=0,D=D+4|0;while((D|0)<(e|0));zb=lb(Bb|0,mc|0,121665,0)|0;rb=C;_b=h;c[_b>>2]=zb;c[_b+4>>2]=rb;_b=lb(Pb|0,vb|0,121665,0)|0;tb=Ga;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(Ub|0,lc|0,121665,0)|0;_b=Ha;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Yb|0,Kb|0,121665,0)|0;tb=Ia;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(Eb|0,Xb|0,121665,0)|0;_b=Ja;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(hc|0,Mb|0,121665,0)|0;tb=Ka;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(sb|0,wb|0,121665,0)|0;_b=Oa;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Fb|0,bc|0,121665,0)|0;tb=Pa;c[tb>>2]=_b;c[tb+4>>2]=C;tb=lb(pb|0,dc|0,121665,0)|0;_b=Qa;c[_b>>2]=tb;c[_b+4>>2]=C;_b=lb(Hb|0,$b|0,121665,0)|0;tb=Ra;c[tb>>2]=_b;c[tb+4>>2]=C;tb=Fa;c[tb>>2]=0;c[tb+4>>2]=0;tb=rb;rb=zb;zb=0;do _b=cb(tb>>31>>>6|0,0,rb|0,tb|0)|0,Rb=ab(_b|0,C|0,26)|0,_b=C,Sb=fb(Rb|0,_b|0,26)|0,Nb=bb(rb|0,tb|0,Sb|0,C|0)|0,Sb=h+(zb<<3)|0,c[Sb>>2]=Nb,c[Sb+4>>2]=C,Sb=h+((zb|1)<<3)|0,Nb=Sb,Cb=cb(Rb|0,_b|0,c[Nb>>2]|0,c[Nb+4>>2]|0)|0,Nb=C,_b=cb(Nb>>31>>>7|0,0,Cb|0,Nb|0)|0,Rb=ab(_b|0,C|0,25)|0,_b=C,kc=fb(Rb|0,_b|0,25)|0,jc=bb(Cb|0,Nb|0,kc|0,C|0)|0,kc=Sb,c[kc>>2]=jc,c[kc+4>>2]=C,zb=zb+2|0,kc=h+(zb<<3)|0,jc=kc,rb=cb(Rb|0,_b|0,c[jc>>2]|0,c[jc+4>>2]|0)|0,tb=C,jc=kc,c[jc>>2]=rb,c[jc+4>>2]=tb;while(zb>>>0<10);zb=Fa;tb=c[zb>>2]|0;rb=c[zb+4>>2]|0;zb=h;$b=c[zb>>2]|0;Hb=c[zb+4>>2]|0;zb=lb(tb|0,rb|0,18,0)|0;dc=C;pb=cb($b|0,Hb|0,tb|0,rb|0)|0;rb=cb(pb|0,C|0,zb|0,dc|0)|0;dc=C;zb=Fa;c[zb>>2]=0;c[zb+4>>2]=0;zb=cb(dc>>31>>>6|0,0,rb|0,dc|0)|0;pb=ab(zb|0,C|0,26)|0;zb=C;tb=fb(pb|0,zb|0,26)|0;Hb=C;$b=Ga;bc=c[$b>>2]|0;Fb=c[$b+4>>2]|0;$b=cb(rb|0,dc|0,Ab|0,ub|0)|0;dc=bb($b|0,C|0,tb|0,Hb|0)|0;Hb=h;c[Hb>>2]=dc;c[Hb+4>>2]=C;Hb=cb(bc|0,Fb|0,fc|0,ic|0)|0;Fb=cb(Hb|0,C|0,pb|0,zb|0)|0;zb=Ga;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ha;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Ob|0,ec|0)|0;zb=Ha;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ia;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Jb|0,Ib|0)|0;zb=Ia;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ja;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,gc|0,Wb|0)|0;zb=Ja;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ka;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Vb|0,cc|0)|0;zb=Ka;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Oa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,yb|0,ob|0)|0;zb=Oa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Pa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Qb|0,Db|0)|0;zb=Pa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Qa;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Lb|0,Tb|0)|0;zb=Qa;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=Ra;Fb=cb(c[zb>>2]|0,c[zb+4>>2]|0,Zb|0,qb|0)|0;zb=Ra;c[zb>>2]=Fb;c[zb+4>>2]=C;Ma(jb,k,h);zb=jb+144|0;Fb=c[zb>>2]|0;pb=c[zb+4>>2]|0;zb=jb+64|0;Hb=zb;bc=c[Hb>>2]|0;dc=c[Hb+4>>2]|0;Hb=lb(Fb|0,pb|0,18,0)|0;tb=C;$b=cb(bc|0,dc|0,Fb|0,pb|0)|0;pb=cb($b|0,C|0,Hb|0,tb|0)|0;tb=zb;c[tb>>2]=pb;c[tb+4>>2]=C;tb=jb+136|0;pb=c[tb>>2]|0;zb=c[tb+4>>2]|0;tb=jb+56|0;Hb=tb;$b=c[Hb>>2]|0;Fb=c[Hb+4>>2]|0;Hb=lb(pb|0,zb|0,18,0)|0;dc=C;bc=cb($b|0,Fb|0,pb|0,zb|0)|0;zb=cb(bc|0,C|0,Hb|0,dc|0)|0;dc=tb;c[dc>>2]=zb;c[dc+4>>2]=C;dc=jb+128|0;zb=c[dc>>2]|0;tb=c[dc+4>>2]|0;dc=jb+48|0;Hb=dc;bc=c[Hb>>2]|0;pb=c[Hb+4>>2]|0;Hb=lb(zb|0,tb|0,18,0)|0;Fb=C;$b=cb(bc|0,pb|0,zb|0,tb|0)|0;tb=cb($b|0,C|0,Hb|0,Fb|0)|0;Fb=dc;c[Fb>>2]=tb;c[Fb+4>>2]=C;Fb=jb+120|0;tb=c[Fb>>2]|0;dc=c[Fb+4>>2]|0;Fb=jb+40|0;Hb=Fb;$b=c[Hb>>2]|0;zb=c[Hb+4>>2]|0;Hb=lb(tb|0,dc|0,18,0)|0;pb=C;bc=cb($b|0,zb|0,tb|0,dc|0)|0;dc=cb(bc|0,C|0,Hb|0,pb|0)|0;pb=Fb;c[pb>>2]=dc;c[pb+4>>2]=C;pb=jb+112|0;dc=c[pb>>2]|0;Fb=c[pb+4>>2]|0;pb=jb+32|0;Hb=pb;bc=c[Hb>>2]|0;tb=c[Hb+4>>2]|0;Hb=lb(dc|0,Fb|0,18,0)|0;zb=C;$b=cb(bc|0,tb|0,dc|0,Fb|0)|0;Fb=cb($b|0,C|0,Hb|0,zb|0)|0;zb=pb;c[zb>>2]=Fb;c[zb+4>>2]=C;zb=jb+104|0;Fb=c[zb>>2]|0;pb=c[zb+4>>2]|0;zb=jb+24|0;Hb=zb;$b=c[Hb>>2]|0;dc=c[Hb+4>>2]|0;Hb=lb(Fb|0,pb|0,18,0)|0;tb=C;bc=cb($b|0,dc|0,Fb|0,pb|0)|0;pb=cb(bc|0,C|0,Hb|0,tb|0)|0;tb=zb;c[tb>>2]=pb;c[tb+4>>2]=C;tb=jb+96|0;pb=c[tb>>2]|0;zb=c[tb+4>>2]|0;tb=jb+16|0;Hb=tb;bc=c[Hb>>2]|0;Fb=c[Hb+4>>2]|0;Hb=lb(pb|0,zb|0,18,0)|0;dc=C;$b=cb(bc|0,Fb|0,pb|0,zb|0)|0;zb=cb($b|0,C|0,Hb|0,dc|0)|0;dc=tb;c[dc>>2]=zb;c[dc+4>>2]=C;dc=jb+88|0;zb=c[dc>>2]|0;tb=c[dc+4>>2]|0;dc=jb+8|0;Hb=dc;$b=c[Hb>>2]|0;pb=c[Hb+4>>2]|0;Hb=lb(zb|0,tb|0,18,0)|0;Fb=C;bc=cb($b|0,pb|0,zb|0,tb|0)|0;tb=cb(bc|0,C|0,Hb|0,Fb|0)|0;Fb=dc;c[Fb>>2]=tb;c[Fb+4>>2]=C;Fb=jb+80|0;tb=Fb;Hb=c[tb>>2]|0;bc=c[tb+4>>2]|0;tb=jb;zb=c[tb>>2]|0;pb=c[tb+4>>2]|0;tb=lb(Hb|0,bc|0,18,0)|0;$b=C;rb=cb(zb|0,pb|0,Hb|0,bc|0)|0;bc=cb(rb|0,C|0,tb|0,$b|0)|0;$b=C;tb=jb;c[tb>>2]=bc;c[tb+4>>2]=$b;tb=Fb;c[tb>>2]=0;c[tb+4>>2]=0;tb=$b;$b=bc;bc=0;do rb=cb(tb>>31>>>6|0,0,$b|0,tb|0)|0,Hb=ab(rb|0,C|0,26)|0,rb=C,pb=fb(Hb|0,rb|0,26)|0,zb=bb($b|0,tb|0,pb|0,C|0)|0,pb=jb+(bc<<3)|0,c[pb>>2]=zb,c[pb+4>>2]=C,pb=jb+((bc|1)<<3)|0,zb=pb,wb=cb(Hb|0,rb|0,c[zb>>2]|0,c[zb+4>>2]|0)|0,zb=C,rb=cb(zb>>31>>>7|0,0,wb|0,zb|0)|0,Hb=ab(rb|0,C|0,25)|0,rb=C,sb=fb(Hb|0,rb|0,25)|0,Mb=bb(wb|0,zb|0,sb|0,C|0)|0,sb=pb,c[sb>>2]=Mb,c[sb+4>>2]=C,bc=bc+2|0,sb=jb+(bc<<3)|0,Mb=sb,$b=cb(Hb|0,rb|0,c[Mb>>2]|0,c[Mb+4>>2]|0)|0,tb=C,Mb=sb,c[Mb>>2]=$b,c[Mb+4>>2]=tb;while(bc>>>0<10);bc=Fb;tb=c[bc>>2]|0;$b=c[bc+4>>2]|0;bc=jb;qb=c[bc>>2]|0;Zb=c[bc+4>>2]|0;bc=lb(tb|0,$b|0,18,0)|0;Tb=C;Lb=cb(qb|0,Zb|0,tb|0,$b|0)|0;$b=cb(Lb|0,C|0,bc|0,Tb|0)|0;Tb=C;bc=Fb;c[bc>>2]=0;c[bc+4>>2]=0;bc=cb(Tb>>31>>>6|0,0,$b|0,Tb|0)|0;Lb=ab(bc|0,C|0,26)|0;bc=C;tb=fb(Lb|0,bc|0,26)|0;Zb=bb($b|0,Tb|0,tb|0,C|0)|0;tb=jb;c[tb>>2]=Zb;c[tb+4>>2]=C;tb=dc;Zb=cb(Lb|0,bc|0,c[tb>>2]|0,c[tb+4>>2]|0)|0;tb=dc;c[tb>>2]=Zb;c[tb+4>>2]=C;tb=0;do Zb=hb+(tb<<3)|0,bc=Zb,Lb=c[bc>>2]|0,Tb=c[bc+4>>2]|0,bc=Za+(tb<<3)|0,$b=bc,qb=c[$b>>2]|0,Db=c[$b+4>>2]|0,$b=(qb^Lb)&mb,Qb=(Db^Tb)&nb,Tb=ab(0,$b^Lb|0,32)|0,Lb=Zb,c[Lb>>2]=Tb,c[Lb+4>>2]=C,Lb=ab(0,$b^qb|0,32)|0,qb=bc,c[qb>>2]=Lb,c[qb+4>>2]=C,tb=tb+1|0;while((tb|0)!=10);nc=0;do tb=jb+(nc<<3)|0,dc=tb,Fb=c[dc>>2]|0,qb=c[dc+4>>2]|0,dc=$a+(nc<<3)|0,Lb=dc,bc=c[Lb>>2]|0,$b=c[Lb+4>>2]|0,Lb=(bc^Fb)&mb,Tb=($b^qb)&nb,qb=ab(0,Lb^Fb|0,32)|0,Fb=tb,c[Fb>>2]=qb,c[Fb+4>>2]=C,Fb=ab(0,Lb^bc|0,32)|0,bc=dc,c[bc>>2]=Fb,c[bc+4>>2]=C,nc=nc+1|0;while((nc|0)!=10);Xa=Xa+1|0;if((Xa|0)==8){oc=Ya;pc=Za;qc=_a;rc=$a;sc=gb;tc=hb;uc=ib;vc=jb;break}else nb=jb,mb=hb,bc=$a,Fb=Za,w=kb<<1&255,jb=ib,ib=nb,hb=gb,gb=mb,$a=_a,_a=bc,Za=Ya,Ya=Fb}Ya=Sa+1|0;if((Ya|0)==32){wc=tc;xc=vc;break}else Sa=Ya,Ta=pc,Ua=oc,t=rc,Va=qc,u=tc,Wa=sc,v=vc,s=uc}D=y;E=wc;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));D=z;E=xc;e=D+80|0;do c[D>>2]=c[E>>2],D=D+4|0,E=E+4|0;while((D|0)<(e|0));Na(h,z);Na(r,h);Na(q,r);La(j,q,z);La(k,j,h);Na(q,k);La(l,q,j);Na(q,l);Na(r,q);Na(q,r);Na(r,q);Na(q,r);La(m,q,l);Na(q,m);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(n,r,m);Na(q,n);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(q,r,n);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);Na(q,r);La(o,q,m);Na(q,o);Na(r,q);m=2;do Na(q,r),Na(r,q),m=m+2|0;while((m|0)<50);La(p,r,o);Na(r,p);Na(q,r);m=2;do Na(r,q),Na(q,r),m=m+2|0;while((m|0)<100);La(r,q,p);Na(q,r);Na(r,q);p=2;do Na(q,r),Na(r,q),p=p+2|0;while((p|0)<50);La(q,r,o);Na(r,q);Na(q,r);Na(r,q);Na(q,r);Na(r,q);La(A,r,k);La(z,y,A);A=c[z>>2]|0;c[h>>2]=A;y=h+4|0;c[y>>2]=c[z+8>>2];k=h+8|0;c[k>>2]=c[z+16>>2];r=h+12|0;c[r>>2]=c[z+24>>2];q=h+16|0;c[q>>2]=c[z+32>>2];o=h+20|0;c[o>>2]=c[z+40>>2];p=h+24|0;c[p>>2]=c[z+48>>2];m=h+28|0;c[m>>2]=c[z+56>>2];n=h+32|0;c[n>>2]=c[z+64>>2];l=h+36|0;c[l>>2]=c[z+72>>2];z=A;A=0;while(1){j=h+(A<<2)|0;E=z>>31&z;!(A&1)?(D=E>>26,c[j>>2]=(_(D,-67108864)|0)+z,e=A+1|0,xc=h+(e<<2)|0,wc=(c[xc>>2]|0)+D|0,c[xc>>2]=wc,yc=wc,zc=e):(e=E>>25,c[j>>2]=(_(e,-33554432)|0)+z,j=A+1|0,E=h+(j<<2)|0,wc=(c[E>>2]|0)+e|0,c[E>>2]=wc,yc=wc,zc=j);if((zc|0)==9)break;else z=yc,A=zc}zc=c[l>>2]|0;A=(zc>>31&zc)>>25;c[l>>2]=(_(A,-33554432)|0)+zc;zc=(A*19|0)+(c[h>>2]|0)|0;c[h>>2]=zc;A=zc;zc=0;while(1){yc=h+(zc<<2)|0;z=A>>31&A;!(zc&1)?(j=z>>26,c[yc>>2]=(_(j,-67108864)|0)+A,wc=zc+1|0,E=h+(wc<<2)|0,e=(c[E>>2]|0)+j|0,c[E>>2]=e,Ac=wc,Bc=e):(e=z>>25,c[yc>>2]=(_(e,-33554432)|0)+A,yc=zc+1|0,z=h+(yc<<2)|0,wc=(c[z>>2]|0)+e|0,c[z>>2]=wc,Ac=yc,Bc=wc);if((Ac|0)==9)break;else A=Bc,zc=Ac}Ac=c[l>>2]|0;zc=(Ac>>31&Ac)>>25;c[l>>2]=(_(zc,-33554432)|0)+Ac;Ac=(zc*19|0)+(c[h>>2]|0)|0;zc=(Ac>>31&Ac)>>26;Bc=(_(zc,-67108864)|0)+Ac|0;c[h>>2]=Bc;c[y>>2]=zc+(c[y>>2]|0);zc=Bc;Bc=0;while(1){Ac=h+(Bc<<2)|0;!(Bc&1)?(c[Ac>>2]=zc&67108863,A=Bc+1|0,wc=h+(A<<2)|0,yc=(c[wc>>2]|0)+(zc>>26)|0,c[wc>>2]=yc,Cc=A,Dc=yc):(c[Ac>>2]=zc&33554431,Ac=Bc+1|0,yc=h+(Ac<<2)|0,A=(c[yc>>2]|0)+(zc>>25)|0,c[yc>>2]=A,Cc=Ac,Dc=A);if((Cc|0)==9)break;else zc=Dc,Bc=Cc}Cc=c[l>>2]|0;c[l>>2]=Cc&33554431;Bc=((Cc>>25)*19|0)+(c[h>>2]|0)|0;c[h>>2]=Bc;Cc=Bc;Bc=0;while(1){Dc=h+(Bc<<2)|0;!(Bc&1)?(c[Dc>>2]=Cc&67108863,zc=Bc+1|0,A=h+(zc<<2)|0,Ac=(c[A>>2]|0)+(Cc>>26)|0,c[A>>2]=Ac,Ec=zc,Fc=Ac):(c[Dc>>2]=Cc&33554431,Dc=Bc+1|0,Ac=h+(Dc<<2)|0,zc=(c[Ac>>2]|0)+(Cc>>25)|0,c[Ac>>2]=zc,Ec=Dc,Fc=zc);if((Ec|0)==9)break;else Cc=Fc,Bc=Ec}Ec=c[l>>2]|0;Bc=Ec&33554431;c[l>>2]=Bc;Fc=((Ec>>25)*19|0)+(c[h>>2]|0)|0;c[h>>2]=Fc;Ec=1;Cc=~(Fc+-67108845>>31);while(1){zc=c[h+(Ec<<2)>>2]|0;!(Ec&1)?(Dc=zc<<16&(zc^-67108864),Ac=Dc<<8&Dc,Dc=Ac<<4&Ac,Ac=Dc<<2&Dc,Gc=Ac<<1&Ac):(Ac=zc<<16&(zc^-33554432),zc=Ac<<8&Ac,Ac=zc<<4&zc,zc=Ac<<2&Ac,Gc=zc<<1&zc);zc=Gc>>31&Cc;Ec=Ec+1|0;if((Ec|0)==10){Hc=zc;break}else Cc=zc}Cc=Fc-(Hc&67108845)|0;c[h>>2]=Cc;h=Hc&67108863;Fc=Hc&33554431;Ec=(c[y>>2]|0)-Fc|0;Gc=Ec<<2;zc=(c[k>>2]|0)-h|0;Ac=zc<<3;Dc=(c[r>>2]|0)-Fc|0;A=Dc<<5;yc=(c[q>>2]|0)-Hc|0;Hc=yc<<6;wc=(c[o>>2]|0)-Fc|0;c[o>>2]=wc;o=(c[p>>2]|0)-h|0;z=o<<1;e=(c[m>>2]|0)-Fc|0;E=e<<3;j=(c[n>>2]|0)-h<<4;c[y>>2]=Gc;c[k>>2]=Ac;c[r>>2]=A;c[q>>2]=Hc;c[p>>2]=z;c[m>>2]=E;c[n>>2]=j;c[l>>2]=Bc-Fc<<6;a[b>>0]=Cc;a[b+1>>0]=Cc>>>8;a[b+2>>0]=Cc>>>16;a[b+3>>0]=Gc|Cc>>>24;a[b+4>>0]=Ec>>>6;a[b+5>>0]=Ec>>>14;a[b+6>>0]=Ac|Ec>>>22;a[b+7>>0]=zc>>>5;a[b+8>>0]=zc>>>13;a[b+9>>0]=A|zc>>>21;a[b+10>>0]=Dc>>>3;a[b+11>>0]=Dc>>>11;a[b+12>>0]=Hc|Dc>>>19;a[b+13>>0]=yc>>>2;a[b+14>>0]=yc>>>10;a[b+15>>0]=yc>>>18;a[b+16>>0]=wc;a[b+17>>0]=wc>>>8;a[b+18>>0]=wc>>>16;a[b+19>>0]=wc>>>24|z;a[b+20>>0]=o>>>7;a[b+21>>0]=o>>>15;a[b+22>>0]=o>>>23|E;a[b+23>>0]=e>>>5;a[b+24>>0]=e>>>13;E=c[n>>2]|0;a[b+25>>0]=e>>>21|E;a[b+26>>0]=E>>>8;a[b+27>>0]=E>>>16;e=c[l>>2]|0;a[b+28>>0]=E>>>24|e;a[b+29>>0]=e>>>8;a[b+30>>0]=e>>>16;a[b+31>>0]=e>>>24;i=g;return 0}function La(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;e=i;i=i+160|0;f=e;Ma(f,b,d);d=f+144|0;b=c[d>>2]|0;g=c[d+4>>2]|0;d=f+64|0;h=d;j=c[h>>2]|0;k=c[h+4>>2]|0;h=lb(b|0,g|0,18,0)|0;l=C;m=cb(j|0,k|0,b|0,g|0)|0;g=cb(m|0,C|0,h|0,l|0)|0;l=d;c[l>>2]=g;c[l+4>>2]=C;l=f+136|0;g=c[l>>2]|0;d=c[l+4>>2]|0;l=f+56|0;h=l;m=c[h>>2]|0;b=c[h+4>>2]|0;h=lb(g|0,d|0,18,0)|0;k=C;j=cb(m|0,b|0,g|0,d|0)|0;d=cb(j|0,C|0,h|0,k|0)|0;k=l;c[k>>2]=d;c[k+4>>2]=C;k=f+128|0;d=c[k>>2]|0;l=c[k+4>>2]|0;k=f+48|0;h=k;j=c[h>>2]|0;g=c[h+4>>2]|0;h=lb(d|0,l|0,18,0)|0;b=C;m=cb(j|0,g|0,d|0,l|0)|0;l=cb(m|0,C|0,h|0,b|0)|0;b=k;c[b>>2]=l;c[b+4>>2]=C;b=f+120|0;l=c[b>>2]|0;k=c[b+4>>2]|0;b=f+40|0;h=b;m=c[h>>2]|0;d=c[h+4>>2]|0;h=lb(l|0,k|0,18,0)|0;g=C;j=cb(m|0,d|0,l|0,k|0)|0;k=cb(j|0,C|0,h|0,g|0)|0;g=b;c[g>>2]=k;c[g+4>>2]=C;g=f+112|0;k=c[g>>2]|0;b=c[g+4>>2]|0;g=f+32|0;h=g;j=c[h>>2]|0;l=c[h+4>>2]|0;h=lb(k|0,b|0,18,0)|0;d=C;m=cb(j|0,l|0,k|0,b|0)|0;b=cb(m|0,C|0,h|0,d|0)|0;d=g;c[d>>2]=b;c[d+4>>2]=C;d=f+104|0;b=c[d>>2]|0;g=c[d+4>>2]|0;d=f+24|0;h=d;m=c[h>>2]|0;k=c[h+4>>2]|0;h=lb(b|0,g|0,18,0)|0;l=C;j=cb(m|0,k|0,b|0,g|0)|0;g=cb(j|0,C|0,h|0,l|0)|0;l=d;c[l>>2]=g;c[l+4>>2]=C;l=f+96|0;g=c[l>>2]|0;d=c[l+4>>2]|0;l=f+16|0;h=l;j=c[h>>2]|0;b=c[h+4>>2]|0;h=lb(g|0,d|0,18,0)|0;k=C;m=cb(j|0,b|0,g|0,d|0)|0;d=cb(m|0,C|0,h|0,k|0)|0;k=l;c[k>>2]=d;c[k+4>>2]=C;k=f+88|0;d=c[k>>2]|0;l=c[k+4>>2]|0;k=f+8|0;h=k;m=c[h>>2]|0;g=c[h+4>>2]|0;h=lb(d|0,l|0,18,0)|0;b=C;j=cb(m|0,g|0,d|0,l|0)|0;l=cb(j|0,C|0,h|0,b|0)|0;b=k;c[b>>2]=l;c[b+4>>2]=C;b=f+80|0;l=b;h=c[l>>2]|0;j=c[l+4>>2]|0;l=f;d=c[l>>2]|0;g=c[l+4>>2]|0;l=lb(h|0,j|0,18,0)|0;m=C;n=cb(d|0,g|0,h|0,j|0)|0;j=cb(n|0,C|0,l|0,m|0)|0;m=C;l=f;c[l>>2]=j;c[l+4>>2]=m;l=b;c[l>>2]=0;c[l+4>>2]=0;l=m;m=j;j=0;do n=cb(l>>31>>>6|0,0,m|0,l|0)|0,h=ab(n|0,C|0,26)|0,n=C,g=fb(h|0,n|0,26)|0,d=bb(m|0,l|0,g|0,C|0)|0,g=f+(j<<3)|0,c[g>>2]=d,c[g+4>>2]=C,g=f+((j|1)<<3)|0,d=g,o=cb(h|0,n|0,c[d>>2]|0,c[d+4>>2]|0)|0,d=C,n=cb(d>>31>>>7|0,0,o|0,d|0)|0,h=ab(n|0,C|0,25)|0,n=C,p=fb(h|0,n|0,25)|0,q=bb(o|0,d|0,p|0,C|0)|0,p=g,c[p>>2]=q,c[p+4>>2]=C,j=j+2|0,p=f+(j<<3)|0,q=p,m=cb(h|0,n|0,c[q>>2]|0,c[q+4>>2]|0)|0,l=C,q=p,c[q>>2]=m,c[q+4>>2]=l;while(j>>>0<10);j=b;l=c[j>>2]|0;m=c[j+4>>2]|0;j=f;q=c[j>>2]|0;p=c[j+4>>2]|0;j=lb(l|0,m|0,18,0)|0;n=C;h=cb(q|0,p|0,l|0,m|0)|0;m=cb(h|0,C|0,j|0,n|0)|0;n=C;j=b;c[j>>2]=0;c[j+4>>2]=0;j=cb(n>>31>>>6|0,0,m|0,n|0)|0;b=ab(j|0,C|0,26)|0;j=C;h=fb(b|0,j|0,26)|0;l=bb(m|0,n|0,h|0,C|0)|0;h=f;c[h>>2]=l;c[h+4>>2]=C;h=k;l=cb(b|0,j|0,c[h>>2]|0,c[h+4>>2]|0)|0;h=k;c[h>>2]=l;c[h+4>>2]=C;h=a;a=f;f=h+80|0;do c[h>>2]=c[a>>2],h=h+4|0,a=a+4|0;while((h|0)<(f|0));i=e;return}function Ma(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0;e=ab(0,c[b>>2]|0,32)|0;f=C;g=ab(0,c[d>>2]|0,32)|0;h=lb(g|0,C|0,e|0,f|0)|0;f=a;c[f>>2]=h;c[f+4>>2]=C;f=ab(0,c[b>>2]|0,32)|0;h=C;e=d+8|0;g=ab(0,c[e>>2]|0,32)|0;i=lb(g|0,C|0,f|0,h|0)|0;h=C;f=b+8|0;g=ab(0,c[f>>2]|0,32)|0;j=C;k=ab(0,c[d>>2]|0,32)|0;l=lb(k|0,C|0,g|0,j|0)|0;j=cb(l|0,C|0,i|0,h|0)|0;h=a+8|0;c[h>>2]=j;c[h+4>>2]=C;h=ab(0,c[f>>2]|0,31)|0;j=C;i=ab(0,c[e>>2]|0,32)|0;l=lb(i|0,C|0,h|0,j|0)|0;j=C;h=ab(0,c[b>>2]|0,32)|0;i=C;g=d+16|0;k=ab(0,c[g>>2]|0,32)|0;m=lb(k|0,C|0,h|0,i|0)|0;i=cb(m|0,C|0,l|0,j|0)|0;j=C;l=b+16|0;m=ab(0,c[l>>2]|0,32)|0;h=C;k=ab(0,c[d>>2]|0,32)|0;n=lb(k|0,C|0,m|0,h|0)|0;h=cb(i|0,j|0,n|0,C|0)|0;n=a+16|0;c[n>>2]=h;c[n+4>>2]=C;n=ab(0,c[f>>2]|0,32)|0;h=C;j=ab(0,c[g>>2]|0,32)|0;i=lb(j|0,C|0,n|0,h|0)|0;h=C;n=ab(0,c[l>>2]|0,32)|0;j=C;m=ab(0,c[e>>2]|0,32)|0;k=lb(m|0,C|0,n|0,j|0)|0;j=cb(k|0,C|0,i|0,h|0)|0;h=C;i=ab(0,c[b>>2]|0,32)|0;k=C;n=d+24|0;m=ab(0,c[n>>2]|0,32)|0;o=lb(m|0,C|0,i|0,k|0)|0;k=cb(j|0,h|0,o|0,C|0)|0;o=C;h=b+24|0;j=ab(0,c[h>>2]|0,32)|0;i=C;m=ab(0,c[d>>2]|0,32)|0;p=lb(m|0,C|0,j|0,i|0)|0;i=cb(k|0,o|0,p|0,C|0)|0;p=a+24|0;c[p>>2]=i;c[p+4>>2]=C;p=ab(0,c[l>>2]|0,32)|0;i=C;o=ab(0,c[g>>2]|0,32)|0;k=lb(o|0,C|0,p|0,i|0)|0;i=C;p=ab(0,c[f>>2]|0,32)|0;o=C;j=ab(0,c[n>>2]|0,32)|0;m=lb(j|0,C|0,p|0,o|0)|0;o=C;p=ab(0,c[h>>2]|0,32)|0;j=C;q=ab(0,c[e>>2]|0,32)|0;r=lb(q|0,C|0,p|0,j|0)|0;j=cb(r|0,C|0,m|0,o|0)|0;o=fb(j|0,C|0,1)|0;j=cb(o|0,C|0,k|0,i|0)|0;i=C;k=ab(0,c[b>>2]|0,32)|0;o=C;m=d+32|0;r=ab(0,c[m>>2]|0,32)|0;p=lb(r|0,C|0,k|0,o|0)|0;o=cb(j|0,i|0,p|0,C|0)|0;p=C;i=b+32|0;j=ab(0,c[i>>2]|0,32)|0;k=C;r=ab(0,c[d>>2]|0,32)|0;q=lb(r|0,C|0,j|0,k|0)|0;k=cb(o|0,p|0,q|0,C|0)|0;q=a+32|0;c[q>>2]=k;c[q+4>>2]=C;q=ab(0,c[l>>2]|0,32)|0;k=C;p=ab(0,c[n>>2]|0,32)|0;o=lb(p|0,C|0,q|0,k|0)|0;k=C;q=ab(0,c[h>>2]|0,32)|0;p=C;j=ab(0,c[g>>2]|0,32)|0;r=lb(j|0,C|0,q|0,p|0)|0;p=cb(r|0,C|0,o|0,k|0)|0;k=C;o=ab(0,c[f>>2]|0,32)|0;r=C;q=ab(0,c[m>>2]|0,32)|0;j=lb(q|0,C|0,o|0,r|0)|0;r=cb(p|0,k|0,j|0,C|0)|0;j=C;k=ab(0,c[i>>2]|0,32)|0;p=C;o=ab(0,c[e>>2]|0,32)|0;q=lb(o|0,C|0,k|0,p|0)|0;p=cb(r|0,j|0,q|0,C|0)|0;q=C;j=ab(0,c[b>>2]|0,32)|0;r=C;k=d+40|0;o=ab(0,c[k>>2]|0,32)|0;s=lb(o|0,C|0,j|0,r|0)|0;r=cb(p|0,q|0,s|0,C|0)|0;s=C;q=b+40|0;p=ab(0,c[q>>2]|0,32)|0;j=C;o=ab(0,c[d>>2]|0,32)|0;t=lb(o|0,C|0,p|0,j|0)|0;j=cb(r|0,s|0,t|0,C|0)|0;t=a+40|0;c[t>>2]=j;c[t+4>>2]=C;t=ab(0,c[h>>2]|0,32)|0;j=C;s=ab(0,c[n>>2]|0,32)|0;r=lb(s|0,C|0,t|0,j|0)|0;j=C;t=ab(0,c[f>>2]|0,32)|0;s=C;p=ab(0,c[k>>2]|0,32)|0;o=lb(p|0,C|0,t|0,s|0)|0;s=cb(o|0,C|0,r|0,j|0)|0;j=C;r=ab(0,c[q>>2]|0,32)|0;o=C;t=ab(0,c[e>>2]|0,32)|0;p=lb(t|0,C|0,r|0,o|0)|0;o=cb(s|0,j|0,p|0,C|0)|0;p=fb(o|0,C|0,1)|0;o=C;j=ab(0,c[l>>2]|0,32)|0;s=C;r=ab(0,c[m>>2]|0,32)|0;t=lb(r|0,C|0,j|0,s|0)|0;s=cb(p|0,o|0,t|0,C|0)|0;t=C;o=ab(0,c[i>>2]|0,32)|0;p=C;j=ab(0,c[g>>2]|0,32)|0;r=lb(j|0,C|0,o|0,p|0)|0;p=cb(s|0,t|0,r|0,C|0)|0;r=C;t=ab(0,c[b>>2]|0,32)|0;s=C;o=d+48|0;j=ab(0,c[o>>2]|0,32)|0;u=lb(j|0,C|0,t|0,s|0)|0;s=cb(p|0,r|0,u|0,C|0)|0;u=C;r=b+48|0;p=ab(0,c[r>>2]|0,32)|0;t=C;j=ab(0,c[d>>2]|0,32)|0;v=lb(j|0,C|0,p|0,t|0)|0;t=cb(s|0,u|0,v|0,C|0)|0;v=a+48|0;c[v>>2]=t;c[v+4>>2]=C;v=ab(0,c[h>>2]|0,32)|0;t=C;u=ab(0,c[m>>2]|0,32)|0;s=lb(u|0,C|0,v|0,t|0)|0;t=C;v=ab(0,c[i>>2]|0,32)|0;u=C;p=ab(0,c[n>>2]|0,32)|0;j=lb(p|0,C|0,v|0,u|0)|0;u=cb(j|0,C|0,s|0,t|0)|0;t=C;s=ab(0,c[l>>2]|0,32)|0;j=C;v=ab(0,c[k>>2]|0,32)|0;p=lb(v|0,C|0,s|0,j|0)|0;j=cb(u|0,t|0,p|0,C|0)|0;p=C;t=ab(0,c[q>>2]|0,32)|0;u=C;s=ab(0,c[g>>2]|0,32)|0;v=lb(s|0,C|0,t|0,u|0)|0;u=cb(j|0,p|0,v|0,C|0)|0;v=C;p=ab(0,c[f>>2]|0,32)|0;j=C;t=ab(0,c[o>>2]|0,32)|0;s=lb(t|0,C|0,p|0,j|0)|0;j=cb(u|0,v|0,s|0,C|0)|0;s=C;v=ab(0,c[r>>2]|0,32)|0;u=C;p=ab(0,c[e>>2]|0,32)|0;t=lb(p|0,C|0,v|0,u|0)|0;u=cb(j|0,s|0,t|0,C|0)|0;t=C;s=ab(0,c[b>>2]|0,32)|0;j=C;v=d+56|0;p=ab(0,c[v>>2]|0,32)|0;w=lb(p|0,C|0,s|0,j|0)|0;j=cb(u|0,t|0,w|0,C|0)|0;w=C;t=b+56|0;u=ab(0,c[t>>2]|0,32)|0;s=C;p=ab(0,c[d>>2]|0,32)|0;x=lb(p|0,C|0,u|0,s|0)|0;s=cb(j|0,w|0,x|0,C|0)|0;x=a+56|0;c[x>>2]=s;c[x+4>>2]=C;x=ab(0,c[i>>2]|0,32)|0;s=C;w=ab(0,c[m>>2]|0,32)|0;j=lb(w|0,C|0,x|0,s|0)|0;s=C;x=ab(0,c[h>>2]|0,32)|0;w=C;u=ab(0,c[k>>2]|0,32)|0;p=lb(u|0,C|0,x|0,w|0)|0;w=C;x=ab(0,c[q>>2]|0,32)|0;u=C;y=ab(0,c[n>>2]|0,32)|0;z=lb(y|0,C|0,x|0,u|0)|0;u=cb(z|0,C|0,p|0,w|0)|0;w=C;p=ab(0,c[f>>2]|0,32)|0;z=C;x=ab(0,c[v>>2]|0,32)|0;y=lb(x|0,C|0,p|0,z|0)|0;z=cb(u|0,w|0,y|0,C|0)|0;y=C;w=ab(0,c[t>>2]|0,32)|0;u=C;p=ab(0,c[e>>2]|0,32)|0;x=lb(p|0,C|0,w|0,u|0)|0;u=cb(z|0,y|0,x|0,C|0)|0;x=fb(u|0,C|0,1)|0;u=cb(x|0,C|0,j|0,s|0)|0;s=C;j=ab(0,c[l>>2]|0,32)|0;x=C;y=ab(0,c[o>>2]|0,32)|0;z=lb(y|0,C|0,j|0,x|0)|0;x=cb(u|0,s|0,z|0,C|0)|0;z=C;s=ab(0,c[r>>2]|0,32)|0;u=C;j=ab(0,c[g>>2]|0,32)|0;y=lb(j|0,C|0,s|0,u|0)|0;u=cb(x|0,z|0,y|0,C|0)|0;y=C;z=ab(0,c[b>>2]|0,32)|0;x=C;s=d+64|0;j=ab(0,c[s>>2]|0,32)|0;w=lb(j|0,C|0,z|0,x|0)|0;x=cb(u|0,y|0,w|0,C|0)|0;w=C;y=b+64|0;u=ab(0,c[y>>2]|0,32)|0;z=C;j=ab(0,c[d>>2]|0,32)|0;p=lb(j|0,C|0,u|0,z|0)|0;z=cb(x|0,w|0,p|0,C|0)|0;p=a+64|0;c[p>>2]=z;c[p+4>>2]=C;p=ab(0,c[i>>2]|0,32)|0;z=C;w=ab(0,c[k>>2]|0,32)|0;x=lb(w|0,C|0,p|0,z|0)|0;z=C;p=ab(0,c[q>>2]|0,32)|0;w=C;u=ab(0,c[m>>2]|0,32)|0;j=lb(u|0,C|0,p|0,w|0)|0;w=cb(j|0,C|0,x|0,z|0)|0;z=C;x=ab(0,c[h>>2]|0,32)|0;j=C;p=ab(0,c[o>>2]|0,32)|0;u=lb(p|0,C|0,x|0,j|0)|0;j=cb(w|0,z|0,u|0,C|0)|0;u=C;z=ab(0,c[r>>2]|0,32)|0;w=C;x=ab(0,c[n>>2]|0,32)|0;p=lb(x|0,C|0,z|0,w|0)|0;w=cb(j|0,u|0,p|0,C|0)|0;p=C;u=ab(0,c[l>>2]|0,32)|0;j=C;z=ab(0,c[v>>2]|0,32)|0;x=lb(z|0,C|0,u|0,j|0)|0;j=cb(w|0,p|0,x|0,C|0)|0;x=C;p=ab(0,c[t>>2]|0,32)|0;w=C;u=ab(0,c[g>>2]|0,32)|0;z=lb(u|0,C|0,p|0,w|0)|0;w=cb(j|0,x|0,z|0,C|0)|0;z=C;x=ab(0,c[f>>2]|0,32)|0;j=C;p=ab(0,c[s>>2]|0,32)|0;u=lb(p|0,C|0,x|0,j|0)|0;j=cb(w|0,z|0,u|0,C|0)|0;u=C;z=ab(0,c[y>>2]|0,32)|0;w=C;x=ab(0,c[e>>2]|0,32)|0;p=lb(x|0,C|0,z|0,w|0)|0;w=cb(j|0,u|0,p|0,C|0)|0;p=C;u=ab(0,c[b>>2]|0,32)|0;j=C;z=d+72|0;x=ab(0,c[z>>2]|0,32)|0;A=lb(x|0,C|0,u|0,j|0)|0;j=cb(w|0,p|0,A|0,C|0)|0;A=C;p=b+72|0;b=ab(0,c[p>>2]|0,32)|0;w=C;u=ab(0,c[d>>2]|0,32)|0;d=lb(u|0,C|0,b|0,w|0)|0;w=cb(j|0,A|0,d|0,C|0)|0;d=a+72|0;c[d>>2]=w;c[d+4>>2]=C;d=ab(0,c[q>>2]|0,32)|0;w=C;A=ab(0,c[k>>2]|0,32)|0;j=lb(A|0,C|0,d|0,w|0)|0;w=C;d=ab(0,c[h>>2]|0,32)|0;A=C;b=ab(0,c[v>>2]|0,32)|0;u=lb(b|0,C|0,d|0,A|0)|0;A=cb(u|0,C|0,j|0,w|0)|0;w=C;j=ab(0,c[t>>2]|0,32)|0;u=C;d=ab(0,c[n>>2]|0,32)|0;b=lb(d|0,C|0,j|0,u|0)|0;u=cb(A|0,w|0,b|0,C|0)|0;b=C;w=ab(0,c[f>>2]|0,32)|0;f=C;A=ab(0,c[z>>2]|0,32)|0;j=lb(A|0,C|0,w|0,f|0)|0;f=cb(u|0,b|0,j|0,C|0)|0;j=C;b=ab(0,c[p>>2]|0,32)|0;u=C;w=ab(0,c[e>>2]|0,32)|0;e=lb(w|0,C|0,b|0,u|0)|0;u=cb(f|0,j|0,e|0,C|0)|0;e=fb(u|0,C|0,1)|0;u=C;j=ab(0,c[i>>2]|0,32)|0;f=C;b=ab(0,c[o>>2]|0,32)|0;w=lb(b|0,C|0,j|0,f|0)|0;f=cb(e|0,u|0,w|0,C|0)|0;w=C;u=ab(0,c[r>>2]|0,32)|0;e=C;j=ab(0,c[m>>2]|0,32)|0;b=lb(j|0,C|0,u|0,e|0)|0;e=cb(f|0,w|0,b|0,C|0)|0;b=C;w=ab(0,c[l>>2]|0,32)|0;f=C;u=ab(0,c[s>>2]|0,32)|0;j=lb(u|0,C|0,w|0,f|0)|0;f=cb(e|0,b|0,j|0,C|0)|0;j=C;b=ab(0,c[y>>2]|0,32)|0;e=C;w=ab(0,c[g>>2]|0,32)|0;u=lb(w|0,C|0,b|0,e|0)|0;e=cb(f|0,j|0,u|0,C|0)|0;u=a+80|0;c[u>>2]=e;c[u+4>>2]=C;u=ab(0,c[q>>2]|0,32)|0;e=C;j=ab(0,c[o>>2]|0,32)|0;f=lb(j|0,C|0,u|0,e|0)|0;e=C;u=ab(0,c[r>>2]|0,32)|0;j=C;b=ab(0,c[k>>2]|0,32)|0;w=lb(b|0,C|0,u|0,j|0)|0;j=cb(w|0,C|0,f|0,e|0)|0;e=C;f=ab(0,c[i>>2]|0,32)|0;w=C;u=ab(0,c[v>>2]|0,32)|0;b=lb(u|0,C|0,f|0,w|0)|0;w=cb(j|0,e|0,b|0,C|0)|0;b=C;e=ab(0,c[t>>2]|0,32)|0;j=C;f=ab(0,c[m>>2]|0,32)|0;u=lb(f|0,C|0,e|0,j|0)|0;j=cb(w|0,b|0,u|0,C|0)|0;u=C;b=ab(0,c[h>>2]|0,32)|0;w=C;e=ab(0,c[s>>2]|0,32)|0;f=lb(e|0,C|0,b|0,w|0)|0;w=cb(j|0,u|0,f|0,C|0)|0;f=C;u=ab(0,c[y>>2]|0,32)|0;j=C;b=ab(0,c[n>>2]|0,32)|0;e=lb(b|0,C|0,u|0,j|0)|0;j=cb(w|0,f|0,e|0,C|0)|0;e=C;f=ab(0,c[l>>2]|0,32)|0;l=C;w=ab(0,c[z>>2]|0,32)|0;u=lb(w|0,C|0,f|0,l|0)|0;l=cb(j|0,e|0,u|0,C|0)|0;u=C;e=ab(0,c[p>>2]|0,32)|0;j=C;f=ab(0,c[g>>2]|0,32)|0;g=lb(f|0,C|0,e|0,j|0)|0;j=cb(l|0,u|0,g|0,C|0)|0;g=a+88|0;c[g>>2]=j;c[g+4>>2]=C;g=ab(0,c[r>>2]|0,32)|0;j=C;u=ab(0,c[o>>2]|0,32)|0;l=lb(u|0,C|0,g|0,j|0)|0;j=C;g=ab(0,c[q>>2]|0,32)|0;u=C;e=ab(0,c[v>>2]|0,32)|0;f=lb(e|0,C|0,g|0,u|0)|0;u=C;g=ab(0,c[t>>2]|0,32)|0;e=C;w=ab(0,c[k>>2]|0,32)|0;b=lb(w|0,C|0,g|0,e|0)|0;e=cb(b|0,C|0,f|0,u|0)|0;u=C;f=ab(0,c[h>>2]|0,32)|0;h=C;b=ab(0,c[z>>2]|0,32)|0;g=lb(b|0,C|0,f|0,h|0)|0;h=cb(e|0,u|0,g|0,C|0)|0;g=C;u=ab(0,c[p>>2]|0,32)|0;e=C;f=ab(0,c[n>>2]|0,32)|0;n=lb(f|0,C|0,u|0,e|0)|0;e=cb(h|0,g|0,n|0,C|0)|0;n=fb(e|0,C|0,1)|0;e=cb(n|0,C|0,l|0,j|0)|0;j=C;l=ab(0,c[i>>2]|0,32)|0;n=C;g=ab(0,c[s>>2]|0,32)|0;h=lb(g|0,C|0,l|0,n|0)|0;n=cb(e|0,j|0,h|0,C|0)|0;h=C;j=ab(0,c[y>>2]|0,32)|0;e=C;l=ab(0,c[m>>2]|0,32)|0;g=lb(l|0,C|0,j|0,e|0)|0;e=cb(n|0,h|0,g|0,C|0)|0;g=a+96|0;c[g>>2]=e;c[g+4>>2]=C;g=ab(0,c[r>>2]|0,32)|0;e=C;h=ab(0,c[v>>2]|0,32)|0;n=lb(h|0,C|0,g|0,e|0)|0;e=C;g=ab(0,c[t>>2]|0,32)|0;h=C;j=ab(0,c[o>>2]|0,32)|0;l=lb(j|0,C|0,g|0,h|0)|0;h=cb(l|0,C|0,n|0,e|0)|0;e=C;n=ab(0,c[q>>2]|0,32)|0;l=C;g=ab(0,c[s>>2]|0,32)|0;j=lb(g|0,C|0,n|0,l|0)|0;l=cb(h|0,e|0,j|0,C|0)|0;j=C;e=ab(0,c[y>>2]|0,32)|0;h=C;n=ab(0,c[k>>2]|0,32)|0;g=lb(n|0,C|0,e|0,h|0)|0;h=cb(l|0,j|0,g|0,C|0)|0;g=C;j=ab(0,c[i>>2]|0,32)|0;i=C;l=ab(0,c[z>>2]|0,32)|0;e=lb(l|0,C|0,j|0,i|0)|0;i=cb(h|0,g|0,e|0,C|0)|0;e=C;g=ab(0,c[p>>2]|0,32)|0;h=C;j=ab(0,c[m>>2]|0,32)|0;m=lb(j|0,C|0,g|0,h|0)|0;h=cb(i|0,e|0,m|0,C|0)|0;m=a+104|0;c[m>>2]=h;c[m+4>>2]=C;m=ab(0,c[t>>2]|0,32)|0;h=C;e=ab(0,c[v>>2]|0,32)|0;i=lb(e|0,C|0,m|0,h|0)|0;h=C;m=ab(0,c[q>>2]|0,32)|0;q=C;e=ab(0,c[z>>2]|0,32)|0;g=lb(e|0,C|0,m|0,q|0)|0;q=cb(g|0,C|0,i|0,h|0)|0;h=C;i=ab(0,c[p>>2]|0,32)|0;g=C;m=ab(0,c[k>>2]|0,32)|0;k=lb(m|0,C|0,i|0,g|0)|0;g=cb(q|0,h|0,k|0,C|0)|0;k=fb(g|0,C|0,1)|0;g=C;h=ab(0,c[r>>2]|0,32)|0;q=C;i=ab(0,c[s>>2]|0,32)|0;m=lb(i|0,C|0,h|0,q|0)|0;q=cb(k|0,g|0,m|0,C|0)|0;m=C;g=ab(0,c[y>>2]|0,32)|0;k=C;h=ab(0,c[o>>2]|0,32)|0;i=lb(h|0,C|0,g|0,k|0)|0;k=cb(q|0,m|0,i|0,C|0)|0;i=a+112|0;c[i>>2]=k;c[i+4>>2]=C;i=ab(0,c[t>>2]|0,32)|0;k=C;m=ab(0,c[s>>2]|0,32)|0;q=lb(m|0,C|0,i|0,k|0)|0;k=C;i=ab(0,c[y>>2]|0,32)|0;m=C;g=ab(0,c[v>>2]|0,32)|0;h=lb(g|0,C|0,i|0,m|0)|0;m=cb(h|0,C|0,q|0,k|0)|0;k=C;q=ab(0,c[r>>2]|0,32)|0;r=C;h=ab(0,c[z>>2]|0,32)|0;i=lb(h|0,C|0,q|0,r|0)|0;r=cb(m|0,k|0,i|0,C|0)|0;i=C;k=ab(0,c[p>>2]|0,32)|0;m=C;q=ab(0,c[o>>2]|0,32)|0;o=lb(q|0,C|0,k|0,m|0)|0;m=cb(r|0,i|0,o|0,C|0)|0;o=a+120|0;c[o>>2]=m;c[o+4>>2]=C;o=ab(0,c[y>>2]|0,32)|0;m=C;i=ab(0,c[s>>2]|0,32)|0;r=lb(i|0,C|0,o|0,m|0)|0;m=C;o=ab(0,c[t>>2]|0,32)|0;t=C;i=ab(0,c[z>>2]|0,32)|0;k=lb(i|0,C|0,o|0,t|0)|0;t=C;o=ab(0,c[p>>2]|0,32)|0;i=C;q=ab(0,c[v>>2]|0,32)|0;v=lb(q|0,C|0,o|0,i|0)|0;i=cb(v|0,C|0,k|0,t|0)|0;t=fb(i|0,C|0,1)|0;i=cb(t|0,C|0,r|0,m|0)|0;m=a+128|0;c[m>>2]=i;c[m+4>>2]=C;m=ab(0,c[y>>2]|0,32)|0;y=C;i=ab(0,c[z>>2]|0,32)|0;r=lb(i|0,C|0,m|0,y|0)|0;y=C;m=ab(0,c[p>>2]|0,32)|0;i=C;t=ab(0,c[s>>2]|0,32)|0;s=lb(t|0,C|0,m|0,i|0)|0;i=cb(s|0,C|0,r|0,y|0)|0;y=a+136|0;c[y>>2]=i;c[y+4>>2]=C;y=ab(0,c[p>>2]|0,31)|0;p=C;i=ab(0,c[z>>2]|0,32)|0;z=lb(i|0,C|0,y|0,p|0)|0;p=a+144|0;c[p>>2]=z;c[p+4>>2]=C;return}function Na(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0;d=i;i=i+160|0;e=d;f=c[b>>2]|0;g=ab(0,f|0,32)|0;h=C;j=lb(g|0,h|0,g|0,h|0)|0;k=e;c[k>>2]=j;c[k+4>>2]=C;k=ab(0,f|0,31)|0;f=C;j=b+8|0;l=c[j>>2]|0;m=ab(0,l|0,32)|0;n=C;o=lb(m|0,n|0,k|0,f|0)|0;p=e+8|0;q=p;c[q>>2]=o;c[q+4>>2]=C;q=lb(m|0,n|0,m|0,n|0)|0;o=C;r=b+16|0;s=ab(0,c[r>>2]|0,32)|0;t=C;u=lb(s|0,t|0,g|0,h|0)|0;v=cb(u|0,C|0,q|0,o|0)|0;o=fb(v|0,C|0,1)|0;v=e+16|0;q=v;c[q>>2]=o;c[q+4>>2]=C;q=lb(s|0,t|0,m|0,n|0)|0;o=C;u=b+24|0;w=ab(0,c[u>>2]|0,32)|0;x=C;y=lb(w|0,x|0,g|0,h|0)|0;z=cb(y|0,C|0,q|0,o|0)|0;o=fb(z|0,C|0,1)|0;z=e+24|0;q=z;c[q>>2]=o;c[q+4>>2]=C;q=lb(s|0,t|0,s|0,t|0)|0;o=C;y=ab(0,l|0,30)|0;A=lb(w|0,x|0,y|0,C|0)|0;y=cb(A|0,C|0,q|0,o|0)|0;o=C;q=b+32|0;A=ab(0,c[q>>2]|0,32)|0;B=C;D=lb(A|0,B|0,k|0,f|0)|0;f=cb(y|0,o|0,D|0,C|0)|0;D=e+32|0;o=D;c[o>>2]=f;c[o+4>>2]=C;o=lb(w|0,x|0,s|0,t|0)|0;f=C;y=lb(A|0,B|0,m|0,n|0)|0;k=cb(y|0,C|0,o|0,f|0)|0;f=C;o=b+40|0;y=ab(0,c[o>>2]|0,32)|0;E=C;F=lb(y|0,E|0,g|0,h|0)|0;G=cb(k|0,f|0,F|0,C|0)|0;F=fb(G|0,C|0,1)|0;G=e+40|0;f=G;c[f>>2]=F;c[f+4>>2]=C;f=lb(w|0,x|0,w|0,x|0)|0;F=C;k=lb(A|0,B|0,s|0,t|0)|0;H=cb(k|0,C|0,f|0,F|0)|0;F=C;f=b+48|0;k=ab(0,c[f>>2]|0,32)|0;I=C;J=lb(k|0,I|0,g|0,h|0)|0;K=cb(H|0,F|0,J|0,C|0)|0;J=C;F=ab(0,l|0,31)|0;l=lb(y|0,E|0,F|0,C|0)|0;F=cb(K|0,J|0,l|0,C|0)|0;l=fb(F|0,C|0,1)|0;F=e+48|0;J=F;c[J>>2]=l;c[J+4>>2]=C;J=lb(A|0,B|0,w|0,x|0)|0;l=C;K=lb(y|0,E|0,s|0,t|0)|0;H=cb(K|0,C|0,J|0,l|0)|0;l=C;J=lb(k|0,I|0,m|0,n|0)|0;K=cb(H|0,l|0,J|0,C|0)|0;J=C;l=b+56|0;H=ab(0,c[l>>2]|0,32)|0;L=C;M=lb(H|0,L|0,g|0,h|0)|0;N=cb(K|0,J|0,M|0,C|0)|0;M=fb(N|0,C|0,1)|0;N=e+56|0;J=N;c[J>>2]=M;c[J+4>>2]=C;J=lb(A|0,B|0,A|0,B|0)|0;M=C;K=lb(k|0,I|0,s|0,t|0)|0;O=C;P=b+64|0;Q=ab(0,c[P>>2]|0,32)|0;R=C;S=lb(Q|0,R|0,g|0,h|0)|0;h=cb(S|0,C|0,K|0,O|0)|0;O=C;K=lb(H|0,L|0,m|0,n|0)|0;n=C;m=lb(y|0,E|0,w|0,x|0)|0;S=cb(m|0,C|0,K|0,n|0)|0;n=fb(S|0,C|0,1)|0;S=cb(h|0,O|0,n|0,C|0)|0;n=fb(S|0,C|0,1)|0;S=cb(n|0,C|0,J|0,M|0)|0;M=e+64|0;J=M;c[J>>2]=S;c[J+4>>2]=C;J=lb(y|0,E|0,A|0,B|0)|0;S=C;n=lb(k|0,I|0,w|0,x|0)|0;x=cb(n|0,C|0,J|0,S|0)|0;S=C;J=lb(H|0,L|0,s|0,t|0)|0;t=cb(x|0,S|0,J|0,C|0)|0;J=C;S=ab(0,c[j>>2]|0,32)|0;j=C;x=lb(Q|0,R|0,S|0,j|0)|0;s=cb(t|0,J|0,x|0,C|0)|0;x=C;J=ab(0,c[b>>2]|0,32)|0;t=C;n=c[b+72>>2]|0;b=ab(0,n|0,32)|0;w=C;O=lb(b|0,w|0,J|0,t|0)|0;t=cb(s|0,x|0,O|0,C|0)|0;O=fb(t|0,C|0,1)|0;t=e+72|0;c[t>>2]=O;c[t+4>>2]=C;t=lb(y|0,E|0,y|0,E|0)|0;O=C;x=lb(k|0,I|0,A|0,B|0)|0;B=cb(x|0,C|0,t|0,O|0)|0;O=C;t=ab(0,c[r>>2]|0,32)|0;r=C;x=lb(Q|0,R|0,t|0,r|0)|0;A=cb(B|0,O|0,x|0,C|0)|0;x=C;O=ab(0,c[u>>2]|0,32)|0;u=C;B=lb(H|0,L|0,O|0,u|0)|0;s=C;J=lb(b|0,w|0,S|0,j|0)|0;j=cb(J|0,C|0,B|0,s|0)|0;s=fb(j|0,C|0,1)|0;j=cb(A|0,x|0,s|0,C|0)|0;s=fb(j|0,C|0,1)|0;j=e+80|0;x=j;c[x>>2]=s;c[x+4>>2]=C;x=lb(k|0,I|0,y|0,E|0)|0;E=C;y=ab(0,c[q>>2]|0,32)|0;q=C;s=lb(H|0,L|0,y|0,q|0)|0;A=cb(s|0,C|0,x|0,E|0)|0;E=C;x=lb(Q|0,R|0,O|0,u|0)|0;s=cb(A|0,E|0,x|0,C|0)|0;x=C;E=lb(b|0,w|0,t|0,r|0)|0;r=cb(s|0,x|0,E|0,C|0)|0;E=C;x=fb(r|0,E|0,1)|0;s=C;t=e+88|0;c[t>>2]=x;c[t+4>>2]=s;t=lb(k|0,I|0,k|0,I|0)|0;I=C;k=lb(Q|0,R|0,y|0,q|0)|0;A=C;B=c[o>>2]|0;o=ab(0,B|0,32)|0;J=C;S=lb(H|0,L|0,o|0,J|0)|0;h=C;K=lb(b|0,w|0,O|0,u|0)|0;u=cb(K|0,C|0,S|0,h|0)|0;h=fb(u|0,C|0,1)|0;u=cb(h|0,C|0,k|0,A|0)|0;A=fb(u|0,C|0,1)|0;u=cb(A|0,C|0,t|0,I|0)|0;I=C;t=e+96|0;c[t>>2]=u;c[t+4>>2]=I;t=ab(0,c[f>>2]|0,32)|0;f=C;A=lb(H|0,L|0,t|0,f|0)|0;L=C;H=lb(Q|0,R|0,o|0,J|0)|0;J=cb(H|0,C|0,A|0,L|0)|0;L=C;A=lb(b|0,w|0,y|0,q|0)|0;q=cb(J|0,L|0,A|0,C|0)|0;A=C;L=fb(q|0,A|0,1)|0;J=C;y=e+104|0;c[y>>2]=L;c[y+4>>2]=J;y=c[l>>2]|0;l=ab(0,y|0,32)|0;H=C;o=lb(l|0,H|0,l|0,H|0)|0;k=C;h=lb(Q|0,R|0,t|0,f|0)|0;R=cb(h|0,C|0,o|0,k|0)|0;k=C;o=ab(0,B|0,31)|0;B=lb(b|0,w|0,o|0,C|0)|0;o=cb(R|0,k|0,B|0,C|0)|0;B=C;k=fb(o|0,B|0,1)|0;R=C;h=e+112|0;c[h>>2]=k;c[h+4>>2]=R;h=c[P>>2]|0;P=ab(0,h|0,32)|0;Q=C;S=lb(P|0,Q|0,l|0,H|0)|0;H=C;l=lb(b|0,w|0,t|0,f|0)|0;f=cb(l|0,C|0,S|0,H|0)|0;H=C;S=fb(f|0,H|0,1)|0;l=C;t=e+120|0;c[t>>2]=S;c[t+4>>2]=l;t=lb(P|0,Q|0,P|0,Q|0)|0;Q=C;P=ab(0,y|0,30)|0;y=lb(b|0,w|0,P|0,C|0)|0;P=cb(y|0,C|0,t|0,Q|0)|0;Q=C;t=e+128|0;c[t>>2]=P;c[t+4>>2]=Q;t=ab(0,h|0,31)|0;h=lb(b|0,w|0,t|0,C|0)|0;t=C;y=e+136|0;c[y>>2]=h;c[y+4>>2]=t;y=ab(0,n|0,31)|0;n=lb(y|0,C|0,b|0,w|0)|0;w=C;b=e+144|0;c[b>>2]=n;c[b+4>>2]=w;b=M;y=c[b>>2]|0;K=c[b+4>>2]|0;b=lb(n|0,w|0,18,0)|0;O=C;m=cb(n|0,w|0,y|0,K|0)|0;K=cb(m|0,C|0,b|0,O|0)|0;O=M;c[O>>2]=K;c[O+4>>2]=C;O=N;K=c[O>>2]|0;M=c[O+4>>2]|0;O=lb(h|0,t|0,18,0)|0;b=C;m=cb(K|0,M|0,h|0,t|0)|0;t=cb(m|0,C|0,O|0,b|0)|0;b=N;c[b>>2]=t;c[b+4>>2]=C;b=F;t=c[b>>2]|0;N=c[b+4>>2]|0;b=lb(P|0,Q|0,18,0)|0;O=C;m=cb(t|0,N|0,P|0,Q|0)|0;Q=cb(m|0,C|0,b|0,O|0)|0;O=F;c[O>>2]=Q;c[O+4>>2]=C;O=G;Q=c[O>>2]|0;F=c[O+4>>2]|0;O=lb(f|0,H|0,36,0)|0;H=C;f=cb(Q|0,F|0,S|0,l|0)|0;l=cb(f|0,C|0,O|0,H|0)|0;H=G;c[H>>2]=l;c[H+4>>2]=C;H=D;l=c[H>>2]|0;G=c[H+4>>2]|0;H=lb(o|0,B|0,36,0)|0;B=C;o=cb(l|0,G|0,k|0,R|0)|0;R=cb(o|0,C|0,H|0,B|0)|0;B=D;c[B>>2]=R;c[B+4>>2]=C;B=z;R=c[B>>2]|0;D=c[B+4>>2]|0;B=lb(q|0,A|0,36,0)|0;A=C;q=cb(R|0,D|0,L|0,J|0)|0;J=cb(q|0,C|0,B|0,A|0)|0;A=z;c[A>>2]=J;c[A+4>>2]=C;A=v;J=c[A>>2]|0;z=c[A+4>>2]|0;A=lb(u|0,I|0,18,0)|0;B=C;q=cb(J|0,z|0,u|0,I|0)|0;I=cb(q|0,C|0,A|0,B|0)|0;B=v;c[B>>2]=I;c[B+4>>2]=C;B=p;I=c[B>>2]|0;v=c[B+4>>2]|0;B=lb(r|0,E|0,36,0)|0;E=C;r=cb(I|0,v|0,x|0,s|0)|0;s=cb(r|0,C|0,B|0,E|0)|0;E=p;c[E>>2]=s;c[E+4>>2]=C;E=j;s=c[E>>2]|0;B=c[E+4>>2]|0;E=e;r=c[E>>2]|0;x=c[E+4>>2]|0;E=lb(s|0,B|0,18,0)|0;v=C;I=cb(r|0,x|0,s|0,B|0)|0;B=cb(I|0,C|0,E|0,v|0)|0;v=C;E=e;c[E>>2]=B;c[E+4>>2]=v;E=j;c[E>>2]=0;c[E+4>>2]=0;E=v;v=B;B=0;do I=cb(E>>31>>>6|0,0,v|0,E|0)|0,s=ab(I|0,C|0,26)|0,I=C,x=fb(s|0,I|0,26)|0,r=bb(v|0,E|0,x|0,C|0)|0,x=e+(B<<3)|0,c[x>>2]=r,c[x+4>>2]=C,x=e+((B|1)<<3)|0,r=x,A=cb(s|0,I|0,c[r>>2]|0,c[r+4>>2]|0)|0,r=C,I=cb(r>>31>>>7|0,0,A|0,r|0)|0,s=ab(I|0,C|0,25)|0,I=C,q=fb(s|0,I|0,25)|0,u=bb(A|0,r|0,q|0,C|0)|0,q=x,c[q>>2]=u,c[q+4>>2]=C,B=B+2|0,q=e+(B<<3)|0,u=q,v=cb(s|0,I|0,c[u>>2]|0,c[u+4>>2]|0)|0,E=C,u=q,c[u>>2]=v,c[u+4>>2]=E;while(B>>>0<10);B=j;E=c[B>>2]|0;v=c[B+4>>2]|0;B=e;u=c[B>>2]|0;q=c[B+4>>2]|0;B=lb(E|0,v|0,18,0)|0;I=C;s=cb(u|0,q|0,E|0,v|0)|0;v=cb(s|0,C|0,B|0,I|0)|0;I=C;B=j;c[B>>2]=0;c[B+4>>2]=0;B=cb(I>>31>>>6|0,0,v|0,I|0)|0;j=ab(B|0,C|0,26)|0;B=C;s=fb(j|0,B|0,26)|0;E=bb(v|0,I|0,s|0,C|0)|0;s=e;c[s>>2]=E;c[s+4>>2]=C;s=p;E=cb(j|0,B|0,c[s>>2]|0,c[s+4>>2]|0)|0;s=p;c[s>>2]=E;c[s+4>>2]=C;s=a;a=e;e=s+80|0;do c[s>>2]=c[a>>2],s=s+4|0,a=a+4|0;while((s|0)<(e|0));i=d;return}function Oa(){var a=0;!(c[2]|0)?a=56:a=c[(ja()|0)+60>>2]|0;return a|0}function Pa(a){a=a|0;var b=0;a>>>0>4294963200?(c[(Oa()|0)>>2]=0-a,b=-1):b=a;return b|0}function Qa(a){a=a|0;return 0}function Ra(a){a=a|0;return}function Sa(a){a=a|0;var b=0,d=0;b=i;i=i+16|0;d=b;c[d>>2]=c[a+60>>2];a=Pa(ka(6,d|0)|0)|0;i=b;return a|0}function Ta(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0;e=i;i=i+32|0;f=e;g=e+20|0;c[f>>2]=c[a+60>>2];c[f+4>>2]=0;c[f+8>>2]=b;c[f+12>>2]=g;c[f+16>>2]=d;(Pa(ta(140,f|0)|0)|0)<0?(c[g>>2]=-1,h=-1):h=c[g>>2]|0;i=e;return h|0}function Ua(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0;e=i;i=i+48|0;f=e+16|0;g=e;h=e+32|0;j=a+28|0;k=c[j>>2]|0;c[h>>2]=k;l=a+20|0;m=(c[l>>2]|0)-k|0;c[h+4>>2]=m;c[h+8>>2]=b;c[h+12>>2]=d;b=a+60|0;k=a+44|0;n=h;h=2;o=m+d|0;while(1){!(c[2]|0)?(c[f>>2]=c[b>>2],c[f+4>>2]=n,c[f+8>>2]=h,p=Pa(wa(146,f|0)|0)|0):(ua(1,a|0),c[g>>2]=c[b>>2],c[g+4>>2]=n,c[g+8>>2]=h,m=Pa(wa(146,g|0)|0)|0,ga(0),p=m);if((o|0)==(p|0)){q=6;break}if((p|0)<0){r=n;s=h;q=8;break}m=o-p|0;t=c[n+4>>2]|0;p>>>0<=t>>>0?(h|0)==2?(c[j>>2]=(c[j>>2]|0)+p,u=t,v=p,w=n,x=2):(u=t,v=p,w=n,x=h):(y=c[k>>2]|0,c[j>>2]=y,c[l>>2]=y,u=c[n+12>>2]|0,v=p-t|0,w=n+8|0,x=h+-1|0);c[w>>2]=(c[w>>2]|0)+v;c[w+4>>2]=u-v;n=w;h=x;o=m}(q|0)==6?(o=c[k>>2]|0,c[a+16>>2]=o+(c[a+48>>2]|0),k=o,c[j>>2]=k,c[l>>2]=k,z=d):(q|0)==8&&(c[a+16>>2]=0,c[j>>2]=0,c[l>>2]=0,c[a>>2]=c[a>>2]|32,(s|0)==2?z=0:z=d-(c[r+4>>2]|0)|0);i=e;return z|0}function Va(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;i=i+80|0;g=f;c[b+36>>2]=3;((c[b>>2]&64|0)==0?(c[g>>2]=c[b+60>>2],c[g+4>>2]=21505,c[g+8>>2]=f+12,(ra(54,g|0)|0)!=0):0)&&(a[b+75>>0]=-1);g=Ua(b,d,e)|0;i=f;return g|0}function Wa(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0;do if(a){if((c[a+76>>2]|0)<=-1){b=Ya(a)|0;break}d=(Qa(a)|0)==0;e=Ya(a)|0;d?b=e:(Ra(a),b=e)}else{!(c[13]|0)?f=0:f=Wa(c[13]|0)|0;ha(36);e=c[8]|0;if(!e)g=f;else{d=e;e=f;while(1){(c[d+76>>2]|0)>-1?h=Qa(d)|0:h=0;(c[d+20>>2]|0)>>>0>(c[d+28>>2]|0)>>>0?i=Ya(d)|0|e:i=e;h&&Ra(d);d=c[d+56>>2]|0;if(!d){g=i;break}else e=i}}sa(36);b=g}while(0);return b|0}function Xa(a){a=a|0;c[a+68>>2]|0||Ra(a);return}function Ya(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0;b=a+20|0;d=a+28|0;((c[b>>2]|0)>>>0>(c[d>>2]|0)>>>0?(za[c[a+36>>2]&3](a,0,0)|0,(c[b>>2]|0)==0):0)?e=-1:(f=a+4|0,g=c[f>>2]|0,h=a+8|0,i=c[h>>2]|0,g>>>0<i>>>0&&za[c[a+40>>2]&3](a,g-i|0,1)|0,c[a+16>>2]=0,c[d>>2]=0,c[b>>2]=0,c[h>>2]=0,c[f>>2]=0,e=0);return e|0}function Za(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0,_=0,$=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,pa=0,qa=0,ra=0,sa=0,ta=0,ua=0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0,Da=0,Ea=0,Fa=0,Ga=0,Ha=0,Ia=0,Ja=0,Ka=0,La=0,Ma=0,Na=0,Pa=0,Qa=0,Ra=0;do if(a>>>0<245){b=a>>>0<11?16:a+11&-8;d=b>>>3;e=c[43]|0;f=e>>>d;if(f&3){g=(f&1^1)+d|0;h=212+(g<<1<<2)|0;i=h+8|0;j=c[i>>2]|0;k=j+8|0;l=c[k>>2]|0;do if((h|0)!=(l|0)){l>>>0<(c[47]|0)>>>0&&ma();m=l+12|0;if((c[m>>2]|0)==(j|0)){c[m>>2]=h;c[i>>2]=l;break}else ma()}else c[43]=e&~(1<<g);while(0);l=g<<3;c[j+4>>2]=l|3;i=j+l+4|0;c[i>>2]=c[i>>2]|1;n=k;return n|0}i=c[45]|0;if(b>>>0>i>>>0){if(f){l=2<<d;h=f<<d&(l|0-l);l=(h&0-h)+-1|0;h=l>>>12&16;m=l>>>h;l=m>>>5&8;o=m>>>l;m=o>>>2&4;p=o>>>m;o=p>>>1&2;q=p>>>o;p=q>>>1&1;r=(l|h|m|o|p)+(q>>>p)|0;p=212+(r<<1<<2)|0;q=p+8|0;o=c[q>>2]|0;m=o+8|0;h=c[m>>2]|0;do if((p|0)!=(h|0)){h>>>0<(c[47]|0)>>>0&&ma();l=h+12|0;if((c[l>>2]|0)==(o|0)){c[l>>2]=p;c[q>>2]=h;s=c[45]|0;break}else ma()}else c[43]=e&~(1<<r),s=i;while(0);i=(r<<3)-b|0;c[o+4>>2]=b|3;e=o+b|0;c[e+4>>2]=i|1;c[e+i>>2]=i;s&&(h=c[48]|0,q=s>>>3,p=212+(q<<1<<2)|0,d=c[43]|0,f=1<<q,d&f?(q=p+8|0,k=c[q>>2]|0,k>>>0<(c[47]|0)>>>0?ma():(t=q,u=k)):(c[43]=d|f,t=p+8|0,u=p),c[t>>2]=h,c[u+12>>2]=h,c[h+8>>2]=u,c[h+12>>2]=p);c[45]=i;c[48]=e;n=m;return n|0}e=c[44]|0;if(e){i=(e&0-e)+-1|0;e=i>>>12&16;p=i>>>e;i=p>>>5&8;h=p>>>i;p=h>>>2&4;f=h>>>p;h=f>>>1&2;d=f>>>h;f=d>>>1&1;k=c[476+((i|e|p|h|f)+(d>>>f)<<2)>>2]|0;f=(c[k+4>>2]&-8)-b|0;d=k;h=k;while(1){k=c[d+16>>2]|0;if(!k){p=c[d+20>>2]|0;if(!p){v=f;w=h;break}else x=p}else x=k;k=(c[x+4>>2]&-8)-b|0;p=k>>>0<f>>>0;f=p?k:f;d=x;h=p?x:h}h=c[47]|0;w>>>0<h>>>0&&ma();d=w+b|0;w>>>0>=d>>>0&&ma();f=c[w+24>>2]|0;m=c[w+12>>2]|0;do if((m|0)==(w|0)){o=w+20|0;r=c[o>>2]|0;if(!r){p=w+16|0;k=c[p>>2]|0;if(!k){y=0;break}else z=k,A=p}else z=r,A=o;while(1){o=z+20|0;r=c[o>>2]|0;if(r){z=r;A=o;continue}o=z+16|0;r=c[o>>2]|0;if(!r){B=z;C=A;break}else z=r,A=o}if(C>>>0<h>>>0)ma();else{c[C>>2]=0;y=B;break}}else{o=c[w+8>>2]|0;o>>>0<h>>>0&&ma();r=o+12|0;(c[r>>2]|0)!=(w|0)&&ma();p=m+8|0;if((c[p>>2]|0)==(w|0)){c[r>>2]=m;c[p>>2]=o;y=m;break}else ma()}while(0);do if(f){m=c[w+28>>2]|0;h=476+(m<<2)|0;if((w|0)==(c[h>>2]|0)){c[h>>2]=y;if(!y){c[44]=c[44]&~(1<<m);break}}else{f>>>0<(c[47]|0)>>>0&&ma();m=f+16|0;(c[m>>2]|0)==(w|0)?c[m>>2]=y:c[f+20>>2]=y;if(!y)break}m=c[47]|0;y>>>0<m>>>0&&ma();c[y+24>>2]=f;h=c[w+16>>2]|0;do if(h)if(h>>>0<m>>>0)ma();else{c[y+16>>2]=h;c[h+24>>2]=y;break}while(0);h=c[w+20>>2]|0;if(h)if(h>>>0<(c[47]|0)>>>0)ma();else{c[y+20>>2]=h;c[h+24>>2]=y;break}}while(0);v>>>0<16?(f=v+b|0,c[w+4>>2]=f|3,h=w+f+4|0,c[h>>2]=c[h>>2]|1):(c[w+4>>2]=b|3,c[d+4>>2]=v|1,c[d+v>>2]=v,h=c[45]|0,h&&(f=c[48]|0,m=h>>>3,h=212+(m<<1<<2)|0,o=c[43]|0,p=1<<m,o&p?(m=h+8|0,r=c[m>>2]|0,r>>>0<(c[47]|0)>>>0?ma():(D=m,E=r)):(c[43]=o|p,D=h+8|0,E=h),c[D>>2]=f,c[E+12>>2]=f,c[f+8>>2]=E,c[f+12>>2]=h),c[45]=v,c[48]=d);n=w+8|0;return n|0}else F=b}else F=b}else if(a>>>0<=4294967231){h=a+11|0;f=h&-8;p=c[44]|0;if(p){o=0-f|0;r=h>>>8;r?f>>>0>16777215?G=31:(h=(r+1048320|0)>>>16&8,m=r<<h,r=(m+520192|0)>>>16&4,k=m<<r,m=(k+245760|0)>>>16&2,e=14-(r|h|m)+(k<<m>>>15)|0,G=f>>>(e+7|0)&1|e<<1):G=0;e=c[476+(G<<2)>>2]|0;a:do if(!e)H=o,I=0,J=0,K=86;else{m=o;k=0;h=f<<((G|0)==31?0:25-(G>>>1)|0);r=e;i=0;while(1){q=c[r+4>>2]&-8;j=q-f|0;if(j>>>0<m>>>0)if((q|0)==(f|0)){L=j;M=r;N=r;K=90;break a}else O=j,P=r;else O=m,P=i;j=c[r+20>>2]|0;r=c[r+16+(h>>>31<<2)>>2]|0;q=(j|0)==0|(j|0)==(r|0)?k:j;j=(r|0)==0;if(j){H=O;I=q;J=P;K=86;break}else m=O,k=q,h=h<<(j&1^1),i=P}}while(0);if((K|0)==86){if((I|0)==0&(J|0)==0){e=2<<G;o=p&(e|0-e);if(!o){F=f;break}e=(o&0-o)+-1|0;o=e>>>12&16;b=e>>>o;e=b>>>5&8;d=b>>>e;b=d>>>2&4;i=d>>>b;d=i>>>1&2;h=i>>>d;i=h>>>1&1;Q=c[476+((e|o|b|d|i)+(h>>>i)<<2)>>2]|0}else Q=I;!Q?(R=H,S=J):(L=H,M=Q,N=J,K=90)}if((K|0)==90)while(1){K=0;i=(c[M+4>>2]&-8)-f|0;h=i>>>0<L>>>0;d=h?i:L;i=h?M:N;h=c[M+16>>2]|0;if(h){L=d;M=h;N=i;K=90;continue}M=c[M+20>>2]|0;if(!M){R=d;S=i;break}else L=d,N=i,K=90}if((S|0)!=0?R>>>0<((c[45]|0)-f|0)>>>0:0){p=c[47]|0;S>>>0<p>>>0&&ma();i=S+f|0;S>>>0>=i>>>0&&ma();d=c[S+24>>2]|0;h=c[S+12>>2]|0;do if((h|0)==(S|0)){b=S+20|0;o=c[b>>2]|0;if(!o){e=S+16|0;k=c[e>>2]|0;if(!k){T=0;break}else U=k,V=e}else U=o,V=b;while(1){b=U+20|0;o=c[b>>2]|0;if(o){U=o;V=b;continue}b=U+16|0;o=c[b>>2]|0;if(!o){W=U;X=V;break}else U=o,V=b}if(X>>>0<p>>>0)ma();else{c[X>>2]=0;T=W;break}}else{b=c[S+8>>2]|0;b>>>0<p>>>0&&ma();o=b+12|0;(c[o>>2]|0)!=(S|0)&&ma();e=h+8|0;if((c[e>>2]|0)==(S|0)){c[o>>2]=h;c[e>>2]=b;T=h;break}else ma()}while(0);do if(d){h=c[S+28>>2]|0;p=476+(h<<2)|0;if((S|0)==(c[p>>2]|0)){c[p>>2]=T;if(!T){c[44]=c[44]&~(1<<h);break}}else{d>>>0<(c[47]|0)>>>0&&ma();h=d+16|0;(c[h>>2]|0)==(S|0)?c[h>>2]=T:c[d+20>>2]=T;if(!T)break}h=c[47]|0;T>>>0<h>>>0&&ma();c[T+24>>2]=d;p=c[S+16>>2]|0;do if(p)if(p>>>0<h>>>0)ma();else{c[T+16>>2]=p;c[p+24>>2]=T;break}while(0);p=c[S+20>>2]|0;if(p)if(p>>>0<(c[47]|0)>>>0)ma();else{c[T+20>>2]=p;c[p+24>>2]=T;break}}while(0);do if(R>>>0>=16){c[S+4>>2]=f|3;c[i+4>>2]=R|1;c[i+R>>2]=R;d=R>>>3;if(R>>>0<256){p=212+(d<<1<<2)|0;h=c[43]|0;b=1<<d;h&b?(d=p+8|0,e=c[d>>2]|0,e>>>0<(c[47]|0)>>>0?ma():(Y=d,Z=e)):(c[43]=h|b,Y=p+8|0,Z=p);c[Y>>2]=i;c[Z+12>>2]=i;c[i+8>>2]=Z;c[i+12>>2]=p;break}p=R>>>8;p?R>>>0>16777215?_=31:(b=(p+1048320|0)>>>16&8,h=p<<b,p=(h+520192|0)>>>16&4,e=h<<p,h=(e+245760|0)>>>16&2,d=14-(p|b|h)+(e<<h>>>15)|0,_=R>>>(d+7|0)&1|d<<1):_=0;d=476+(_<<2)|0;c[i+28>>2]=_;h=i+16|0;c[h+4>>2]=0;c[h>>2]=0;h=c[44]|0;e=1<<_;if(!(h&e)){c[44]=h|e;c[d>>2]=i;c[i+24>>2]=d;c[i+12>>2]=i;c[i+8>>2]=i;break}e=R<<((_|0)==31?0:25-(_>>>1)|0);h=c[d>>2]|0;while(1){if((c[h+4>>2]&-8|0)==(R|0)){$=h;K=148;break}d=h+16+(e>>>31<<2)|0;b=c[d>>2]|0;if(!b){aa=d;ba=h;K=145;break}else e=e<<1,h=b}if((K|0)==145)if(aa>>>0<(c[47]|0)>>>0)ma();else{c[aa>>2]=i;c[i+24>>2]=ba;c[i+12>>2]=i;c[i+8>>2]=i;break}else if((K|0)==148){h=$+8|0;e=c[h>>2]|0;b=c[47]|0;if(e>>>0>=b>>>0&$>>>0>=b>>>0){c[e+12>>2]=i;c[h>>2]=i;c[i+8>>2]=e;c[i+12>>2]=$;c[i+24>>2]=0;break}else ma()}}else e=R+f|0,c[S+4>>2]=e|3,h=S+e+4|0,c[h>>2]=c[h>>2]|1;while(0);n=S+8|0;return n|0}else F=f}else F=f}else F=-1;while(0);S=c[45]|0;if(S>>>0>=F>>>0){R=S-F|0;$=c[48]|0;R>>>0>15?(ba=$+F|0,c[48]=ba,c[45]=R,c[ba+4>>2]=R|1,c[ba+R>>2]=R,c[$+4>>2]=F|3):(c[45]=0,c[48]=0,c[$+4>>2]=S|3,R=$+S+4|0,c[R>>2]=c[R>>2]|1);n=$+8|0;return n|0}$=c[46]|0;if($>>>0>F>>>0){R=$-F|0;c[46]=R;$=c[49]|0;S=$+F|0;c[49]=S;c[S+4>>2]=R|1;c[$+4>>2]=F|3;n=$+8|0;return n|0}do if(!(c[161]|0)){$=va(30)|0;if(!($+-1&$)){c[163]=$;c[162]=$;c[164]=-1;c[165]=-1;c[166]=0;c[154]=0;c[161]=(oa(0)|0)&-16^1431655768;break}else ma()}while(0);$=F+48|0;R=c[163]|0;S=F+47|0;ba=R+S|0;aa=0-R|0;R=ba&aa;if(R>>>0<=F>>>0){n=0;return n|0}_=c[153]|0;if((_|0)!=0?(Z=c[151]|0,Y=Z+R|0,Y>>>0<=Z>>>0|Y>>>0>_>>>0):0){n=0;return n|0}b:do if(!(c[154]&4)){_=c[49]|0;c:do if(_){Y=620;while(1){Z=c[Y>>2]|0;if(Z>>>0<=_>>>0?(T=Y+4|0,(Z+(c[T>>2]|0)|0)>>>0>_>>>0):0){ca=Y;da=T;break}Y=c[Y+8>>2]|0;if(!Y){K=173;break c}}Y=ba-(c[46]|0)&aa;if(Y>>>0<2147483647){T=na(Y|0)|0;if((T|0)==((c[ca>>2]|0)+(c[da>>2]|0)|0)){if((T|0)!=(-1|0)){ea=T;fa=Y;K=193;break b}}else ga=T,ha=Y,K=183}}else K=173;while(0);do if((K|0)==173?(_=na(0)|0,(_|0)!=(-1|0)):0){f=_;Y=c[162]|0;T=Y+-1|0;!(T&f)?ia=R:ia=R-f+(T+f&0-Y)|0;Y=c[151]|0;f=Y+ia|0;if(ia>>>0>F>>>0&ia>>>0<2147483647){T=c[153]|0;if((T|0)!=0?f>>>0<=Y>>>0|f>>>0>T>>>0:0)break;T=na(ia|0)|0;if((T|0)==(_|0)){ea=_;fa=ia;K=193;break b}else ga=T,ha=ia,K=183}}while(0);d:do if((K|0)==183){T=0-ha|0;do if($>>>0>ha>>>0&(ha>>>0<2147483647&(ga|0)!=(-1|0))?(_=c[163]|0,f=S-ha+_&0-_,f>>>0<2147483647):0)if((na(f|0)|0)==(-1|0)){na(T|0)|0;break d}else{ja=f+ha|0;break}else ja=ha;while(0);if((ga|0)!=(-1|0)){ea=ga;fa=ja;K=193;break b}}while(0);c[154]=c[154]|4;K=190}else K=190;while(0);((((K|0)==190?R>>>0<2147483647:0)?(ja=na(R|0)|0,R=na(0)|0,ja>>>0<R>>>0&((ja|0)!=(-1|0)&(R|0)!=(-1|0))):0)?(ga=R-ja|0,ga>>>0>(F+40|0)>>>0):0)&&(ea=ja,fa=ga,K=193);if((K|0)==193){ga=(c[151]|0)+fa|0;c[151]=ga;ga>>>0>(c[152]|0)>>>0&&(c[152]=ga);ga=c[49]|0;do if(ga){ja=620;do{R=c[ja>>2]|0;ha=ja+4|0;S=c[ha>>2]|0;if((ea|0)==(R+S|0)){ka=R;la=ha;pa=S;qa=ja;K=203;break}ja=c[ja+8>>2]|0}while((ja|0)!=0);if(((K|0)==203?(c[qa+12>>2]&8|0)==0:0)?ga>>>0<ea>>>0&ga>>>0>=ka>>>0:0){c[la>>2]=pa+fa;ja=ga+8|0;S=(ja&7|0)==0?0:0-ja&7;ja=ga+S|0;ha=fa-S+(c[46]|0)|0;c[49]=ja;c[46]=ha;c[ja+4>>2]=ha|1;c[ja+ha+4>>2]=40;c[50]=c[165];break}ha=c[47]|0;ea>>>0<ha>>>0?(c[47]=ea,ra=ea):ra=ha;ha=ea+fa|0;ja=620;while(1){if((c[ja>>2]|0)==(ha|0)){sa=ja;ta=ja;K=211;break}ja=c[ja+8>>2]|0;if(!ja){ua=620;break}}if((K|0)==211)if(!(c[ta+12>>2]&8)){c[sa>>2]=ea;ja=ta+4|0;c[ja>>2]=(c[ja>>2]|0)+fa;ja=ea+8|0;S=ea+((ja&7|0)==0?0:0-ja&7)|0;ja=ha+8|0;R=ha+((ja&7|0)==0?0:0-ja&7)|0;ja=S+F|0;$=R-S-F|0;c[S+4>>2]=F|3;do if((R|0)!=(ga|0)){if((R|0)==(c[48]|0)){ia=(c[45]|0)+$|0;c[45]=ia;c[48]=ja;c[ja+4>>2]=ia|1;c[ja+ia>>2]=ia;break}ia=c[R+4>>2]|0;if((ia&3|0)==1){da=ia&-8;ca=ia>>>3;e:do if(ia>>>0>=256){aa=c[R+24>>2]|0;ba=c[R+12>>2]|0;do if((ba|0)==(R|0)){T=R+16|0;f=T+4|0;_=c[f>>2]|0;if(!_){Y=c[T>>2]|0;if(!Y){wa=0;break}else xa=Y,ya=T}else xa=_,ya=f;while(1){f=xa+20|0;_=c[f>>2]|0;if(_){xa=_;ya=f;continue}f=xa+16|0;_=c[f>>2]|0;if(!_){za=xa;Aa=ya;break}else xa=_,ya=f}if(Aa>>>0<ra>>>0)ma();else{c[Aa>>2]=0;wa=za;break}}else{f=c[R+8>>2]|0;f>>>0<ra>>>0&&ma();_=f+12|0;(c[_>>2]|0)!=(R|0)&&ma();T=ba+8|0;if((c[T>>2]|0)==(R|0)){c[_>>2]=ba;c[T>>2]=f;wa=ba;break}else ma()}while(0);if(!aa)break;ba=c[R+28>>2]|0;f=476+(ba<<2)|0;do if((R|0)!=(c[f>>2]|0)){aa>>>0<(c[47]|0)>>>0&&ma();T=aa+16|0;(c[T>>2]|0)==(R|0)?c[T>>2]=wa:c[aa+20>>2]=wa;if(!wa)break e}else{c[f>>2]=wa;if(wa)break;c[44]=c[44]&~(1<<ba);break e}while(0);ba=c[47]|0;wa>>>0<ba>>>0&&ma();c[wa+24>>2]=aa;f=R+16|0;T=c[f>>2]|0;do if(T)if(T>>>0<ba>>>0)ma();else{c[wa+16>>2]=T;c[T+24>>2]=wa;break}while(0);T=c[f+4>>2]|0;if(!T)break;if(T>>>0<(c[47]|0)>>>0)ma();else{c[wa+20>>2]=T;c[T+24>>2]=wa;break}}else{T=c[R+8>>2]|0;ba=c[R+12>>2]|0;aa=212+(ca<<1<<2)|0;do if((T|0)!=(aa|0)){T>>>0<ra>>>0&&ma();if((c[T+12>>2]|0)==(R|0))break;ma()}while(0);if((ba|0)==(T|0)){c[43]=c[43]&~(1<<ca);break}do if((ba|0)==(aa|0))Ba=ba+8|0;else{ba>>>0<ra>>>0&&ma();f=ba+8|0;if((c[f>>2]|0)==(R|0)){Ba=f;break}ma()}while(0);c[T+12>>2]=ba;c[Ba>>2]=T}while(0);Ca=R+da|0;Da=da+$|0}else Ca=R,Da=$;ca=Ca+4|0;c[ca>>2]=c[ca>>2]&-2;c[ja+4>>2]=Da|1;c[ja+Da>>2]=Da;ca=Da>>>3;if(Da>>>0<256){ia=212+(ca<<1<<2)|0;aa=c[43]|0;f=1<<ca;do if(!(aa&f))c[43]=aa|f,Ea=ia+8|0,Fa=ia;else{ca=ia+8|0;_=c[ca>>2]|0;if(_>>>0>=(c[47]|0)>>>0){Ea=ca;Fa=_;break}ma()}while(0);c[Ea>>2]=ja;c[Fa+12>>2]=ja;c[ja+8>>2]=Fa;c[ja+12>>2]=ia;break}f=Da>>>8;do if(!f)Ga=0;else{if(Da>>>0>16777215){Ga=31;break}aa=(f+1048320|0)>>>16&8;da=f<<aa;_=(da+520192|0)>>>16&4;ca=da<<_;da=(ca+245760|0)>>>16&2;Y=14-(_|aa|da)+(ca<<da>>>15)|0;Ga=Da>>>(Y+7|0)&1|Y<<1}while(0);f=476+(Ga<<2)|0;c[ja+28>>2]=Ga;ia=ja+16|0;c[ia+4>>2]=0;c[ia>>2]=0;ia=c[44]|0;Y=1<<Ga;if(!(ia&Y)){c[44]=ia|Y;c[f>>2]=ja;c[ja+24>>2]=f;c[ja+12>>2]=ja;c[ja+8>>2]=ja;break}Y=Da<<((Ga|0)==31?0:25-(Ga>>>1)|0);ia=c[f>>2]|0;while(1){if((c[ia+4>>2]&-8|0)==(Da|0)){Ha=ia;K=281;break}f=ia+16+(Y>>>31<<2)|0;da=c[f>>2]|0;if(!da){Ia=f;Ja=ia;K=278;break}else Y=Y<<1,ia=da}if((K|0)==278)if(Ia>>>0<(c[47]|0)>>>0)ma();else{c[Ia>>2]=ja;c[ja+24>>2]=Ja;c[ja+12>>2]=ja;c[ja+8>>2]=ja;break}else if((K|0)==281){ia=Ha+8|0;Y=c[ia>>2]|0;da=c[47]|0;if(Y>>>0>=da>>>0&Ha>>>0>=da>>>0){c[Y+12>>2]=ja;c[ia>>2]=ja;c[ja+8>>2]=Y;c[ja+12>>2]=Ha;c[ja+24>>2]=0;break}else ma()}}else Y=(c[46]|0)+$|0,c[46]=Y,c[49]=ja,c[ja+4>>2]=Y|1;while(0);n=S+8|0;return n|0}else ua=620;while(1){ja=c[ua>>2]|0;if(ja>>>0<=ga>>>0?($=ja+(c[ua+4>>2]|0)|0,$>>>0>ga>>>0):0){Ka=$;break}ua=c[ua+8>>2]|0}S=Ka+-47|0;$=S+8|0;ja=S+(($&7|0)==0?0:0-$&7)|0;$=ga+16|0;S=ja>>>0<$>>>0?ga:ja;ja=S+8|0;R=ea+8|0;ha=(R&7|0)==0?0:0-R&7;R=ea+ha|0;Y=fa+-40-ha|0;c[49]=R;c[46]=Y;c[R+4>>2]=Y|1;c[R+Y+4>>2]=40;c[50]=c[165];Y=S+4|0;c[Y>>2]=27;c[ja>>2]=c[155];c[ja+4>>2]=c[156];c[ja+8>>2]=c[157];c[ja+12>>2]=c[158];c[155]=ea;c[156]=fa;c[158]=0;c[157]=ja;ja=S+24|0;do ja=ja+4|0,c[ja>>2]=7;while((ja+4|0)>>>0<Ka>>>0);if((S|0)!=(ga|0)){ja=S-ga|0;c[Y>>2]=c[Y>>2]&-2;c[ga+4>>2]=ja|1;c[S>>2]=ja;R=ja>>>3;if(ja>>>0<256){ha=212+(R<<1<<2)|0;ia=c[43]|0;da=1<<R;ia&da?(R=ha+8|0,f=c[R>>2]|0,f>>>0<(c[47]|0)>>>0?ma():(La=R,Ma=f)):(c[43]=ia|da,La=ha+8|0,Ma=ha);c[La>>2]=ga;c[Ma+12>>2]=ga;c[ga+8>>2]=Ma;c[ga+12>>2]=ha;break}ha=ja>>>8;ha?ja>>>0>16777215?Na=31:(da=(ha+1048320|0)>>>16&8,ia=ha<<da,ha=(ia+520192|0)>>>16&4,f=ia<<ha,ia=(f+245760|0)>>>16&2,R=14-(ha|da|ia)+(f<<ia>>>15)|0,Na=ja>>>(R+7|0)&1|R<<1):Na=0;R=476+(Na<<2)|0;c[ga+28>>2]=Na;c[ga+20>>2]=0;c[$>>2]=0;ia=c[44]|0;f=1<<Na;if(!(ia&f)){c[44]=ia|f;c[R>>2]=ga;c[ga+24>>2]=R;c[ga+12>>2]=ga;c[ga+8>>2]=ga;break}f=ja<<((Na|0)==31?0:25-(Na>>>1)|0);ia=c[R>>2]|0;while(1){if((c[ia+4>>2]&-8|0)==(ja|0)){Pa=ia;K=307;break}R=ia+16+(f>>>31<<2)|0;da=c[R>>2]|0;if(!da){Qa=R;Ra=ia;K=304;break}else f=f<<1,ia=da}if((K|0)==304)if(Qa>>>0<(c[47]|0)>>>0)ma();else{c[Qa>>2]=ga;c[ga+24>>2]=Ra;c[ga+12>>2]=ga;c[ga+8>>2]=ga;break}else if((K|0)==307){ia=Pa+8|0;f=c[ia>>2]|0;ja=c[47]|0;if(f>>>0>=ja>>>0&Pa>>>0>=ja>>>0){c[f+12>>2]=ga;c[ia>>2]=ga;c[ga+8>>2]=f;c[ga+12>>2]=Pa;c[ga+24>>2]=0;break}else ma()}}}else{f=c[47]|0;(f|0)==0|ea>>>0<f>>>0&&(c[47]=ea);c[155]=ea;c[156]=fa;c[158]=0;c[52]=c[161];c[51]=-1;f=0;do ia=212+(f<<1<<2)|0,c[ia+12>>2]=ia,c[ia+8>>2]=ia,f=f+1|0;while((f|0)!=32);f=ea+8|0;ia=(f&7|0)==0?0:0-f&7;f=ea+ia|0;ja=fa+-40-ia|0;c[49]=f;c[46]=ja;c[f+4>>2]=ja|1;c[f+ja+4>>2]=40;c[50]=c[165]}while(0);fa=c[46]|0;if(fa>>>0>F>>>0){ea=fa-F|0;c[46]=ea;fa=c[49]|0;ga=fa+F|0;c[49]=ga;c[ga+4>>2]=ea|1;c[fa+4>>2]=F|3;n=fa+8|0;return n|0}}c[(Oa()|0)>>2]=12;n=0;return n|0}function _a(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0;if(!a)return;b=a+-8|0;d=c[47]|0;b>>>0<d>>>0&&ma();e=c[a+-4>>2]|0;a=e&3;(a|0)==1&&ma();f=e&-8;g=b+f|0;do if(!(e&1)){h=c[b>>2]|0;if(!a)return;i=b+(0-h)|0;j=h+f|0;i>>>0<d>>>0&&ma();if((i|0)==(c[48]|0)){k=g+4|0;l=c[k>>2]|0;if((l&3|0)!=3){m=i;n=j;break}c[45]=j;c[k>>2]=l&-2;c[i+4>>2]=j|1;c[i+j>>2]=j;return}l=h>>>3;if(h>>>0<256){h=c[i+8>>2]|0;k=c[i+12>>2]|0;o=212+(l<<1<<2)|0;(h|0)!=(o|0)&&(h>>>0<d>>>0&&ma(),(c[h+12>>2]|0)!=(i|0)&&ma());if((k|0)==(h|0)){c[43]=c[43]&~(1<<l);m=i;n=j;break}(k|0)!=(o|0)?(k>>>0<d>>>0&&ma(),o=k+8|0,(c[o>>2]|0)==(i|0)?p=o:ma()):p=k+8|0;c[h+12>>2]=k;c[p>>2]=h;m=i;n=j;break}h=c[i+24>>2]|0;k=c[i+12>>2]|0;do if((k|0)==(i|0)){o=i+16|0;l=o+4|0;q=c[l>>2]|0;if(!q){r=c[o>>2]|0;if(!r){s=0;break}else t=r,u=o}else t=q,u=l;while(1){l=t+20|0;q=c[l>>2]|0;if(q){t=q;u=l;continue}l=t+16|0;q=c[l>>2]|0;if(!q){v=t;w=u;break}else t=q,u=l}if(w>>>0<d>>>0)ma();else{c[w>>2]=0;s=v;break}}else{l=c[i+8>>2]|0;l>>>0<d>>>0&&ma();q=l+12|0;(c[q>>2]|0)!=(i|0)&&ma();o=k+8|0;if((c[o>>2]|0)==(i|0)){c[q>>2]=k;c[o>>2]=l;s=k;break}else ma()}while(0);if(h){k=c[i+28>>2]|0;l=476+(k<<2)|0;if((i|0)==(c[l>>2]|0)){c[l>>2]=s;if(!s){c[44]=c[44]&~(1<<k);m=i;n=j;break}}else{h>>>0<(c[47]|0)>>>0&&ma();k=h+16|0;(c[k>>2]|0)==(i|0)?c[k>>2]=s:c[h+20>>2]=s;if(!s){m=i;n=j;break}}k=c[47]|0;s>>>0<k>>>0&&ma();c[s+24>>2]=h;l=i+16|0;o=c[l>>2]|0;do if(o)if(o>>>0<k>>>0)ma();else{c[s+16>>2]=o;c[o+24>>2]=s;break}while(0);o=c[l+4>>2]|0;if(o)if(o>>>0<(c[47]|0)>>>0)ma();else{c[s+20>>2]=o;c[o+24>>2]=s;m=i;n=j;break}else m=i,n=j}else m=i,n=j}else m=b,n=f;while(0);m>>>0>=g>>>0&&ma();f=g+4|0;b=c[f>>2]|0;b&1||ma();if(!(b&2)){if((g|0)==(c[49]|0)){s=(c[46]|0)+n|0;c[46]=s;c[49]=m;c[m+4>>2]=s|1;if((m|0)!=(c[48]|0))return;c[48]=0;c[45]=0;return}if((g|0)==(c[48]|0)){s=(c[45]|0)+n|0;c[45]=s;c[48]=m;c[m+4>>2]=s|1;c[m+s>>2]=s;return}s=(b&-8)+n|0;d=b>>>3;do if(b>>>0>=256){v=c[g+24>>2]|0;w=c[g+12>>2]|0;do if((w|0)==(g|0)){u=g+16|0;t=u+4|0;p=c[t>>2]|0;if(!p){a=c[u>>2]|0;if(!a){x=0;break}else y=a,z=u}else y=p,z=t;while(1){t=y+20|0;p=c[t>>2]|0;if(p){y=p;z=t;continue}t=y+16|0;p=c[t>>2]|0;if(!p){A=y;B=z;break}else y=p,z=t}if(B>>>0<(c[47]|0)>>>0)ma();else{c[B>>2]=0;x=A;break}}else{t=c[g+8>>2]|0;t>>>0<(c[47]|0)>>>0&&ma();p=t+12|0;(c[p>>2]|0)!=(g|0)&&ma();u=w+8|0;if((c[u>>2]|0)==(g|0)){c[p>>2]=w;c[u>>2]=t;x=w;break}else ma()}while(0);if(v){w=c[g+28>>2]|0;j=476+(w<<2)|0;if((g|0)==(c[j>>2]|0)){c[j>>2]=x;if(!x){c[44]=c[44]&~(1<<w);break}}else{v>>>0<(c[47]|0)>>>0&&ma();w=v+16|0;(c[w>>2]|0)==(g|0)?c[w>>2]=x:c[v+20>>2]=x;if(!x)break}w=c[47]|0;x>>>0<w>>>0&&ma();c[x+24>>2]=v;j=g+16|0;i=c[j>>2]|0;do if(i)if(i>>>0<w>>>0)ma();else{c[x+16>>2]=i;c[i+24>>2]=x;break}while(0);i=c[j+4>>2]|0;if(i)if(i>>>0<(c[47]|0)>>>0)ma();else{c[x+20>>2]=i;c[i+24>>2]=x;break}}}else{i=c[g+8>>2]|0;w=c[g+12>>2]|0;v=212+(d<<1<<2)|0;(i|0)!=(v|0)&&(i>>>0<(c[47]|0)>>>0&&ma(),(c[i+12>>2]|0)!=(g|0)&&ma());if((w|0)==(i|0)){c[43]=c[43]&~(1<<d);break}(w|0)!=(v|0)?(w>>>0<(c[47]|0)>>>0&&ma(),v=w+8|0,(c[v>>2]|0)==(g|0)?C=v:ma()):C=w+8|0;c[i+12>>2]=w;c[C>>2]=i}while(0);c[m+4>>2]=s|1;c[m+s>>2]=s;if((m|0)==(c[48]|0)){c[45]=s;return}else D=s}else c[f>>2]=b&-2,c[m+4>>2]=n|1,c[m+n>>2]=n,D=n;n=D>>>3;if(D>>>0<256){b=212+(n<<1<<2)|0;f=c[43]|0;s=1<<n;f&s?(n=b+8|0,C=c[n>>2]|0,C>>>0<(c[47]|0)>>>0?ma():(E=n,F=C)):(c[43]=f|s,E=b+8|0,F=b);c[E>>2]=m;c[F+12>>2]=m;c[m+8>>2]=F;c[m+12>>2]=b;return}b=D>>>8;b?D>>>0>16777215?G=31:(F=(b+1048320|0)>>>16&8,E=b<<F,b=(E+520192|0)>>>16&4,s=E<<b,E=(s+245760|0)>>>16&2,f=14-(b|F|E)+(s<<E>>>15)|0,G=D>>>(f+7|0)&1|f<<1):G=0;f=476+(G<<2)|0;c[m+28>>2]=G;c[m+20>>2]=0;c[m+16>>2]=0;E=c[44]|0;s=1<<G;do if(E&s){F=D<<((G|0)==31?0:25-(G>>>1)|0);b=c[f>>2]|0;while(1){if((c[b+4>>2]&-8|0)==(D|0)){H=b;I=130;break}C=b+16+(F>>>31<<2)|0;n=c[C>>2]|0;if(!n){J=C;K=b;I=127;break}else F=F<<1,b=n}if((I|0)==127)if(J>>>0<(c[47]|0)>>>0)ma();else{c[J>>2]=m;c[m+24>>2]=K;c[m+12>>2]=m;c[m+8>>2]=m;break}else if((I|0)==130){b=H+8|0;F=c[b>>2]|0;j=c[47]|0;if(F>>>0>=j>>>0&H>>>0>=j>>>0){c[F+12>>2]=m;c[b>>2]=m;c[m+8>>2]=F;c[m+12>>2]=H;c[m+24>>2]=0;break}else ma()}}else c[44]=E|s,c[f>>2]=m,c[m+24>>2]=f,c[m+12>>2]=m,c[m+8>>2]=m;while(0);m=(c[51]|0)+-1|0;c[51]=m;if(!m)L=628;else return;while(1){m=c[L>>2]|0;if(!m)break;else L=m+8|0}c[51]=-1;return}function $a(){}function ab(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b>>c;return a>>>c|(b&(1<<c)-1)<<32-c}C=(b|0)<0?-1:0;return b>>c-32|0}function bb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=b-d>>>0;e=b-d-(c>>>0>a>>>0|0)>>>0;return(C=e,a-c>>>0|0)|0}function cb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=a+c>>>0;return(C=b+d+(e>>>0<a>>>0|0)>>>0,e|0)|0}function db(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,i=0;f=b+e|0;if((e|0)>=20){d=d&255;g=b&3;h=d|d<<8|d<<16|d<<24;i=f&-4;if(g){g=b+4-g|0;while((b|0)<(g|0))a[b>>0]=d,b=b+1|0}while((b|0)<(i|0))c[b>>2]=h,b=b+4|0}while((b|0)<(f|0))a[b>>0]=d,b=b+1|0;return b-e|0}function eb(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b>>>c;return a>>>c|(b&(1<<c)-1)<<32-c}C=0;return b>>>c-32|0}function fb(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){C=b<<c|(a&(1<<c)-1<<32-c)>>>32-c;return a<<c}C=a<<c-32;return 0}function gb(b,d,e){b=b|0;d=d|0;e=e|0;var f=0;if((e|0)>=4096)return qa(b|0,d|0,e|0)|0;f=b|0;if((b&3)==(d&3)){while(b&3){if(!e)return f|0;a[b>>0]=a[d>>0]|0;b=b+1|0;d=d+1|0;e=e-1|0}while((e|0)>=4)c[b>>2]=c[d>>2],b=b+4|0,d=d+4|0,e=e-4|0}while((e|0)>0)a[b>>0]=a[d>>0]|0,b=b+1|0,d=d+1|0,e=e-1|0;return f|0}function hb(b){b=b|0;var c=0;c=a[m+(b&255)>>0]|0;if((c|0)<8)return c|0;c=a[m+(b>>8&255)>>0]|0;if((c|0)<8)return c+8|0;c=a[m+(b>>16&255)>>0]|0;return(c|0)<8?c+16|0:(a[m+(b>>>24)>>0]|0)+24|0}function ib(a,b){a=a|0;b=b|0;var c=0,d=0,e=0,f=0;c=a&65535;d=b&65535;e=_(d,c)|0;f=a>>>16;a=(e>>>16)+(_(d,f)|0)|0;d=b>>>16;b=_(d,c)|0;return(C=(a>>>16)+(_(d,f)|0)+(((a&65535)+b|0)>>>16)|0,a+b<<16|e&65535|0)|0}function jb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,g=0,h=0,i=0;e=b>>31|((b|0)<0?-1:0)<<1;f=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;g=d>>31|((d|0)<0?-1:0)<<1;h=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1;i=bb(e^a,f^b,e,f)|0;b=C;a=g^e;e=h^f;return bb((ob(i,b,bb(g^c,h^d,g,h)|0,C,0)|0)^a,C^e,a,e)|0}function kb(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;i=i+16|0;g=f|0;h=b>>31|((b|0)<0?-1:0)<<1;j=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;k=e>>31|((e|0)<0?-1:0)<<1;l=((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;m=bb(h^a,j^b,h,j)|0;b=C;ob(m,b,bb(k^d,l^e,k,l)|0,C,g)|0;l=bb(c[g>>2]^h,c[g+4>>2]^j,h,j)|0;j=C;i=f;return(C=j,l)|0}function lb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0;e=a;a=c;c=ib(e,a)|0;f=C;return(C=(_(b,a)|0)+(_(d,e)|0)+f|f&0,c|0|0)|0}function mb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return ob(a,b,c,d,0)|0}function nb(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;i=i+16|0;g=f|0;ob(a,b,d,e,g)|0;i=f;return(C=c[g+4>>2]|0,c[g>>2]|0)|0}function ob(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,D=0,E=0,F=0,G=0,H=0;g=a;h=b;i=h;j=d;k=e;l=k;if(!i){m=(f|0)!=0;if(!l){m&&(c[f>>2]=(g>>>0)%(j>>>0),c[f+4>>2]=0);n=0;o=(g>>>0)/(j>>>0)>>>0;return(C=n,o)|0}else{if(!m){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=b&0;n=0;o=0;return(C=n,o)|0}}m=(l|0)==0;do if(j){if(!m){p=(aa(l|0)|0)-(aa(i|0)|0)|0;if(p>>>0<=31){q=p+1|0;r=31-p|0;s=p-31>>31;t=q;u=g>>>(q>>>0)&s|i<<r;v=i>>>(q>>>0)&s;w=0;x=g<<r;break}if(!f){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=h|b&0;n=0;o=0;return(C=n,o)|0}r=j-1|0;if(r&j){s=(aa(j|0)|0)+33-(aa(i|0)|0)|0;q=64-s|0;p=32-s|0;y=p>>31;z=s-32|0;A=z>>31;t=s;u=p-1>>31&i>>>(z>>>0)|(i<<p|g>>>(s>>>0))&A;v=A&i>>>(s>>>0);w=g<<q&y;x=(i<<q|g>>>(z>>>0))&y|g<<p&s-33>>31;break}f&&(c[f>>2]=r&g,c[f+4>>2]=0);if((j|0)==1){n=h|b&0;o=a|0|0;return(C=n,o)|0}else{r=hb(j|0)|0;n=i>>>(r>>>0)|0;o=i<<32-r|g>>>(r>>>0)|0;return(C=n,o)|0}}else{if(m){f&&(c[f>>2]=(i>>>0)%(j>>>0),c[f+4>>2]=0);n=0;o=(i>>>0)/(j>>>0)>>>0;return(C=n,o)|0}if(!g){f&&(c[f>>2]=0,c[f+4>>2]=(i>>>0)%(l>>>0));n=0;o=(i>>>0)/(l>>>0)>>>0;return(C=n,o)|0}r=l-1|0;if(!(r&l)){f&&(c[f>>2]=a|0,c[f+4>>2]=r&i|b&0);n=0;o=i>>>((hb(l|0)|0)>>>0);return(C=n,o)|0}r=(aa(l|0)|0)-(aa(i|0)|0)|0;if(r>>>0<=30){s=r+1|0;p=31-r|0;t=s;u=i<<p|g>>>(s>>>0);v=i>>>(s>>>0);w=0;x=g<<p;break}if(!f){n=0;o=0;return(C=n,o)|0}c[f>>2]=a|0;c[f+4>>2]=h|b&0;n=0;o=0;return(C=n,o)|0}while(0);if(!t)B=x,D=w,E=v,F=u,G=0,H=0;else{b=d|0|0;d=k|e&0;e=cb(b|0,d|0,-1,-1)|0;k=C;h=x;x=w;w=v;v=u;u=t;t=0;do a=h,h=x>>>31|h<<1,x=t|x<<1,g=v<<1|a>>>31|0,a=v>>>31|w<<1|0,bb(e,k,g,a)|0,i=C,l=i>>31|((i|0)<0?-1:0)<<1,t=l&1,v=bb(g,a,l&b,(((i|0)<0?-1:0)>>31|((i|0)<0?-1:0)<<1)&d)|0,w=C,u=u-1|0;while((u|0)!=0);B=h;D=x;E=w;F=v;G=0;H=t}t=D;D=0;f&&(c[f>>2]=F,c[f+4>>2]=E);n=(t|0)>>>31|(B|D)<<1|(D<<1|t>>>31)&0|G;o=(t<<1|0>>>31)&-2|H;return(C=n,o)|0}function pb(a,b){a=a|0;b=b|0;return ya[a&1](b|0)|0}function qb(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return za[a&3](b|0,c|0,d|0)|0}function rb(a,b){a=a|0,b=b|0,Aa[a&1](b|0)}function sb(a){a=a|0;ba(0);return 0}function tb(a,b,c){a=a|0;b=b|0;c=c|0;ba(1);return 0}function ub(a){a=a|0,ba(2)}var ya=[sb,Sa],za=[tb,Va,Ta,Ua],Aa=[ub,Xa];return{_curve25519_donna:Ka,_free:_a,_i64Add:cb,_bitshift64Ashr:ab,_i64Subtract:bb,_memset:db,_malloc:Za,_memcpy:gb,_bitshift64Lshr:eb,_fflush:Wa,___errno_location:Oa,_bitshift64Shl:fb,runPostSets:$a,stackAlloc:Ba,stackSave:Ca,stackRestore:Da,establishStackSpace:Ea,setThrew:Fa,setTempRet0:Ia,getTempRet0:Ja,dynCall_ii:pb,dynCall_iiii:qb,dynCall_vi:rb}}(e.Na,e.Oa,buffer);e._curve25519_donna=Z._curve25519_donna;var Da=e._free=Z._free;e.runPostSets=Z.runPostSets;var cb=e._i64Add=Z._i64Add,ab=e._bitshift64Ashr=Z._bitshift64Ashr,bb=e._i64Subtract=Z._i64Subtract,db=e._memset=Z._memset,ua=e._malloc=Z._malloc,gc=e._memcpy=Z._memcpy,fb=e._bitshift64Lshr=Z._bitshift64Lshr;e._fflush=Z._fflush;e.___errno_location=Z.___errno_location;var gb=e._bitshift64Shl=Z._bitshift64Shl;e.dynCall_ii=Z.dynCall_ii;e.dynCall_iiii=Z.dynCall_iiii;e.dynCall_vi=Z.dynCall_vi;n.W=Z.stackAlloc;n.na=Z.stackSave;n.X=Z.stackRestore;n.md=Z.establishStackSpace;n.cb=Z.setTempRet0;n.Ua=Z.getTempRet0;function xc(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}xc.prototype=Error();xc.prototype.constructor=xc;var Yc=null,Xa=function Zc(){e.calledRun||$c(),e.calledRun||(Xa=Zc)};e.callMain=e.jd=function(a){function b(){for(var a=0;3>a;a++)d.push(0)}assert(0==L,"cannot call main when async dependencies remain! (listen on __ATMAIN__)");assert(0==Pa.length,"cannot call main when preRun functions remain to be called");a=a||[];xa||(xa=!0,Oa(Qa));var c=a.length+1,d=[G(Va(e.thisProgram),"i8",0)];b();for(var f=0;f<c-1;f+=1)d.push(G(Va(a[f]),"i8",0)),b();d.push(0);d=G(d,"i32",0);try{var h=e._main(c,d,0);ad(h,!0)}catch(g){if(!(g instanceof xc))if("SimulateInfiniteLoop"==g)e.noExitRuntime=!0;else throw g&&"object"===typeof g&&g.stack&&e.S("exception thrown: "+[g,g.stack]),g}finally{}};function $c(a){function b(){if(!e.calledRun&&(e.calledRun=!0,!A)){xa||(xa=!0,Oa(Qa));Oa(Ra);e.onRuntimeInitialized&&e.onRuntimeInitialized();e._main&&bd&&e.callMain(a);if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)Ua(e.postRun.shift());Oa(Sa)}}a=a||e.arguments;null===Yc&&(Yc=Date.now());if(!(0<L)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)Ta(e.preRun.shift());Oa(Pa);0<L||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),b()},1)):b())}}e.run=e.run=$c;function ad(a,b){if(!b||!e.noExitRuntime){!e.noExitRuntime&&(A=!0,m=void 0,Oa(K),e.onExit)&&e.onExit(a);throw new xc(a)}}e.exit=e.exit=ad;var cd=[];function z(a){void 0!==a?(e.print(a),e.S(a),a=JSON.stringify(a)):a="";A=!0;var b="abort("+a+") at "+Ea()+"\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";cd&&cd.forEach(function(c){b=c(b,a)});throw b}e.abort=e.abort=z;if(e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();var bd=!0;e.noInitialRun&&(bd=!1);$c();module.exports=e}),null);
__d("WAWebCryptoCurve25519",["Promise","WAWeb-curve25519-donna","WAWebCryptoLibraryUtilsApi","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function j(){i||(i=b("WAWeb-curve25519-donna"))}var k=new Uint8Array(32);k[0]=9;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a===void 0?(b=new Uint8Array(32),self.crypto.getRandomValues(b)):b=new Uint8Array(a);b[0]&=248;b[31]&=127;b[31]|=64;return t({pubKey:32,privKey:b,basepoint:k},function(a){var d=i._curve25519_donna(a.pubKey,a.privKey,a.basepoint);if(d)throw c("err")("Curve25519:keyPair Error Code "+d);return{pubKey:s(a.pubKey,32),privKey:b.buffer}})});return l.apply(this,arguments)}function d(a,d){return(h||(h=b("Promise"))).resolve().then(function(){return t({sharedKey:32,pubKey:a,privKey:d},function(a){var b=i._curve25519_donna(a.sharedKey,a.privKey,a.pubKey);if(b)throw c("err")("Curve25519:sharedSecret Error Code "+b);return s(a.sharedKey,32)})})}var m=5;function n(a){return a.pubKey.byteLength===33&&a.privKey.byteLength===32}function e(a){if(n(a))return a;if(a.pubKey.byteLength!==32||a.privKey.byteLength!==32)throw c("err")("Invalid key pair type");var b=o(a.pubKey),d=new Uint8Array(32);d.set(new Uint8Array(a.privKey));return{pubKey:b,privKey:d.buffer}}function o(a){if(a.byteLength!==32)throw c("err")("Invalid key type");var b=new Uint8Array(33);b[0]=m;b.set(new Uint8Array(a),1);return b.buffer}function p(a){return a.privKey.byteLength===32&&a.pubKey.byteLength===32}function f(a){if(p(a))return a;if(a.pubKey.byteLength!==33||a.privKey.byteLength!==32)throw c("err")("Invalid key pair type");var b=new Uint8Array(32),d=new Uint8Array(32);b.set(new Uint8Array(a.pubKey).subarray(1));d.set(new Uint8Array(a.privKey));return{pubKey:b.buffer,privKey:d.buffer}}function q(a){if(a.byteLength!==33)throw c("err")("Invalid key type");var b=new Uint8Array(32);b.set(new Uint8Array(a).subarray(1));return b.buffer}function r(a){if(typeof a==="number")return i._malloc(a);a=new Uint8Array(a.buffer||a);var b=i._malloc(a.length);i.HEAPU8.set(a,b);return b}function s(a,b){var c=new Uint8Array(b);c.set(i.HEAPU8.subarray(a,a+b));return c.buffer}function t(a,b){j();var c={};try{for(var d in a)c[d]=r(a[d]);return b(c)}finally{for(d in c)i._free(c[d])}}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield c("WAWebCryptoLibraryUtilsApi").signMsg(a.pubKey,a.privKey,b));return a});return v.apply(this,arguments)}function w(a,b,d){if(a.byteLength!==32)throw c("err")("Invalid public key length: "+a.byteLength);var e=new Uint8Array(33);e[0]=m;e.set(a,1);return c("WAWebCryptoLibraryUtilsApi").verifySignature(e,b,d)}g.keyPair=a;g.sharedSecret=d;g.toSignalCurveKeyPair=e;g.toSignalCurvePubKey=o;g.toCurveKeyPair=f;g.toCurveKeyPubKey=q;g.calculateSignature=u;g.verifySignature=w}),98);
__d("WAWebChatThreadLoggingLocalstorageMetadataHandler",["Promise","WABase64","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var c=a.prototype;c.setOffset=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingOffset(a);return!0});function c(b){return a.apply(this,arguments)}return c}();c.getOffset=function(){return(h||(h=b("Promise"))).resolve(d("WAWebUserPrefsMultiDevice").getChatThreadLoggingOffset())};c.setSecret=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingSecretB64(d("WABase64").encodeB64(a));return!0});function c(b){return a.apply(this,arguments)}return c}();c.getSecret=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingSecretB64());return a==null?null:d("WABase64").decodeB64(a)});function c(){return a.apply(this,arguments)}return c}();c.setLastUploadedStartTs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingLastUploadedStartTs(a);return!0});function c(b){return a.apply(this,arguments)}return c}();c.getLastUploadedStartTs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingLastUploadedStartTs());return a!=null?a:0});function c(){return a.apply(this,arguments)}return c}();return a}();g.ChatThreadLoggingMetadataLocalStorage=a}),98);
__d("WAWebChatThreadLogging",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebChatThreadLoggingEventStore","WAWebChatThreadLoggingEventUploader","WAWebChatThreadLoggingLocalstorageMetadataHandler","WAWebChatThreadLoggingUtils","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=null;function y(){x==null&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getChatThreadLoggingState: init incomplete!"])));return x}function a(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!0);a=a&&d("WAWebABProps").getABPropConfigValue("message_count_logging_md_enabled");(yield d("WAWebUserPrefsMultiDevice").getChatThreadLoggingLastUploadedStartTs())==null&&(yield d("WAWebUserPrefsMultiDevice").setChatThreadLoggingLastUploadedStartTs(0));var c=new(d("WAWebChatThreadLoggingLocalstorageMetadataHandler").ChatThreadLoggingMetadataLocalStorage)(),e=a?new(d("WAWebChatThreadLoggingEventStore").ChatThreadLoggingEventStoreImpl)(c):{handleMessages:function(){return(w||(w=b("Promise"))).resolve()},getEvent:function(){return(w||(w=b("Promise"))).resolve()},getBeforeInclusive:function(){return(w||(w=b("Promise"))).resolve([])},deleteBeforeInclusive:function(){return(w||(w=b("Promise"))).resolve(0)}};a=a?new(d("WAWebChatThreadLoggingEventUploader").ChatThreadLoggingEventUploaderImpl)(c,e):{uploadEvents:function(){return(w||(w=b("Promise"))).resolve(0)}};var f=(yield c.getOffset());f!=null&&E(f);x={metadataStore:c,eventStore:e,eventUploader:a};d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["chat thread logging initialized"])))});return z.apply(this,arguments)}function e(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: setting offset"])));b=(b=(yield (b=y())==null?void 0:b.metadataStore.setOffset(a)))!=null?b:!1;b&&E(a);return b});return A.apply(this,arguments)}function f(a){var c;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: setting thread_id_user_secret"])));return(c=(c=y())==null?void 0:c.metadataStore.setSecret(a))!=null?c:(w||(w=b("Promise"))).resolve(!1)}function B(a){var b;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: handling "," message(s)"])),a.length).devConsole({activities:a});(b=y())==null||b.eventStore.handleMessages(a)["catch"](function(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: error handling activities"])))})}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: uploading events"])));b=(yield (b=y())==null?void 0:b.metadataStore.getOffset());if(b==null){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: attempting to upload but offset is unset."])));return}b=(yield (b=y())==null?void 0:b.metadataStore.getSecret());if(b==null){d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: attempting to upload but secret is unset."])));return}b=(yield (b=y())==null?void 0:b.eventUploader.uploadEvents(a));d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: uploaded "," events"])),b)});return D.apply(this,arguments)}function E(a){var c=d("WATimeUtils").unixTime(),e=c-c%86400;e=e+a;e=e-c;e<0&&(e+=d("WATimeUtils").DAY_SECONDS);d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: will upload in "," seconds."])),e);self.setTimeout(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b;yield (b=y())==null?void 0:b.eventUploader.uploadEvents();E(a)}),e*1e3)}function F(){if(!c("gkx")("26258"))return y()}function G(){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield y());a=(yield a==null?void 0:a.metadataStore.getSecret());if(a==null){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: cannot get user secret from the thread logging metadata store"]))).sendLogs("ctl-secret-unset");return null}return a});return H.apply(this,arguments)}function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield G());if(c==null){d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: cannot generate getChatThreadID because secret is unset."])));return void 0}b=d("WAWebChatThreadLoggingUtils").getThreadDs(b!=null?b:d("WATimeUtils").unixTime());return d("WAWebChatThreadLoggingUtils").generateThreadID(c,a,b)});return J.apply(this,arguments)}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield G());if(b==null){d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[ctwa] labels: cannot generate getChatThreadIDHMAC because secret is unset"]))).sendLogs("ctwa-labels-thread-id-hmac-error");return null}return d("WAWebChatThreadLoggingUtils").generateThreadIDHMAC(b,a)});return L.apply(this,arguments)}function M(a){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield G());if(b==null){d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: cannot generate getMessageIDHMAC because secret is unset."])));return null}return d("WAWebChatThreadLoggingUtils").generateMessageIDHMAC(b,a)});return N.apply(this,arguments)}g.initChatThreadLogging=a;g.setThreadDsTimeframeOffset=e;g.setThreadIdUserSecret=f;g.handleActivitiesForChatThreadLogging=B;g.uploadChatThreadLoggingEvents=C;g.getChatThreadLoggingStateDebug=F;g.getChatThreadID=I;g.getChatThreadIDHMAC=K;g.getMessageIDHMAC=M}),98);
__d("WAWebPromiseQueue",["Promise","WALogger","WAPromiseQueue","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;a=function(a){function c(b){return a.call(this,b)||this}babelHelpers.inheritsLoose(c,a);var e=c.prototype;e.wait=function(){return a.prototype.wait.call(this)};e.waitUntilResolved=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var e=this;c===void 0&&(c=0);if(c>9){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["PromiseQueue: wait called more than 10 times"]))).sendLogs("promise_queue_long_wait_time");return}var f=a.prototype.wait.call(this);return new(i||(i=b("Promise")))(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,d){try{yield f,f!==a.prototype.wait.call(e)&&(yield e.waitUntilResolved(c+1)),b()}catch(a){d(a)}});return function(a,b){return d.apply(this,arguments)}}())});function e(a){return c.apply(this,arguments)}return e}();return c}(d("WAPromiseQueue").PromiseQueue);g.PromiseQueue=a}),98);
__d("WAWebApiChatThreadLoggingPendingEvents",["WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebPromiseQueue","WAWebSchemaChatThreadLoggingPendingEvents","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=Object.freeze({msgsSent:0,msgsReceived:0,msgsRead:0,viewOnceMsgsSent:0,viewOnceMsgsReceived:0,viewOnceMessagesOpened:0,callOffersSent:0,callOffersReceived:0,totalCallDuration:0,commerceMsgsSent:0,commerceMsgsReceived:0,pdpInquiriesSent:0,reactionsSent:0,reactionsReceived:0,forwardMessagesSent:0,forwardMessagesReceived:0,editedMsgsSent:0,botMessagesSent:0,botMessagesReceived:0,botMessagesEdited:0,eventCreationMessagesSent:0,eventCreationMessagesReceived:0,eventResponseMessagesSent:0,eventResponseMessagesReceived:0,eventGroupStatusReplyOthersToOwn:0,eventGroupStatusReplyOthersToOthers:0,eventGroupStatusReplyOwnToOthers:0,eventGroupStatusReplyOwnToOwn:0,eventGroupStatusLikeOthersToOthers:0,eventGroupStatusLikeOthersToOwn:0}),i=Object.freeze(babelHelpers["extends"]({},d("WAWebChatThreadLoggingCountFields").COUNT_FIELDS,d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELDS,h)),j=new(d("WAWebPromiseQueue").PromiseQueue)();function a(a){return j.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkGet(a.map(function(a){var b=a.chatId;a=a.startTs;return[b,a]})));b=b.map(function(b,c){var e=a[c],f=k(e.chatId,e.startTs,b);d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(a){f[a]+=e[a]});d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(a){f[a]=e[a]});f.msgsSent+=e.addMsgsSent;f.msgsReceived+=e.addMsgsReceived;f.msgsRead+=e.addMsgsRead;f.viewOnceMsgsSent+=e.addViewOnceMsgsSent;f.viewOnceMsgsReceived+=e.addViewOnceMsgsReceived;f.viewOnceMessagesOpened+=e.addViewOnceMsgsOpened;f.callOffersSent+=e.addCallOffersSent;f.callOffersReceived+=e.addCallOffersReceived;f.totalCallDuration+=e.addTotalCallDuration;f.commerceMsgsSent+=e.addCommerceMsgsSent;f.commerceMsgsReceived+=e.addCommerceMsgsReceived;f.pdpInquiriesSent+=e.addPdpInquiriesSent;f.reactionsSent+=e.addReactionsSent;f.reactionsReceived+=e.addReactionsReceived;f.forwardMessagesSent+=e.addForwardMessagesSent;f.forwardMessagesReceived+=e.addForwardMessagesReceived;f.editedMsgsSent+=e.addEditedMsgsSent;f.botMessagesSent+=e.addBotMessagesSent;f.botMessagesReceived+=e.addBotMessagesReceived;f.botMessagesEdited+=e.addBotMessagesEdited;f.eventCreationMessagesSent+=e.addEventCreationMessagesSent;f.eventCreationMessagesReceived+=e.addEventCreationMessagesReceived;f.eventResponseMessagesSent+=e.addEventResponseMessagesSent;f.eventResponseMessagesReceived+=e.addEventResponseMessagesReceived;f.eventGroupStatusReplyOthersToOwn+=e.addEventGroupStatusReplyOthersToOwn;f.eventGroupStatusReplyOthersToOthers+=e.addEventGroupStatusReplyOthersToOthers;f.eventGroupStatusReplyOwnToOthers+=e.addEventGroupStatusReplyOwnToOthers;f.eventGroupStatusReplyOwnToOwn+=e.addEventGroupStatusReplyOwnToOwn;f.eventGroupStatusLikeOthersToOthers+=e.addEventGroupStatusLikeOthersToOthers;f.eventGroupStatusLikeOthersToOwn+=e.addEventGroupStatusLikeOthersToOwn;return f});return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkCreateOrReplace(b)}))}function k(a,b,c){if(c==null)return babelHelpers["extends"]({chatId:a,startTs:b},i);d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(a){c[a]==null&&(c[a]=i[a])});d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(a){c[a]==null&&(c[a]=i[a])});Object.keys(h).forEach(function(a){c[a]==null&&(c[a]=i[a])});return c}function c(a,b){return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().get([a,b])}function e(a){return d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().lessThan(["startTs"],a,{inclusive:!0})}function f(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaChatThreadLoggingPendingEvents").getChatThreadLoggingPendingEventsTable().bulkDeleteRange(["startTs"],0,a+1));return a});return l.apply(this,arguments)}g.createOrUpdateChatEvents=a;g.getChatEvent=c;g.getBeforeInclusive=e;g.deleteBeforeInclusive=f}),98);
__d("WAWebBotTypes",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({FIRST:"first",INNER:"inner",LAST:"last",FULL:"full"});d=a({BIZ_1P:"biz_1p",BIZ_3P:"biz_3p"});e=a.Mirrored(["POSITIVE","NEGATIVE_GENERIC","NEGATIVE_HELPFUL","NEGATIVE_INTERESTING","NEGATIVE_ACCURATE","NEGATIVE_SAFE","NEGATIVE_OTHER","NEGATIVE_REFUSED","NEGATIVE_NOT_VISUALLY_APPEALING","NEGATIVE_NOT_RELEVANT_TO_TEXT","NEGATIVE_NOT_ENTERTAINING","NEGATIVE_NOT_CUSTOMIZABLE","NEGATIVE_NOT_INTERESTING"]);b=a({UNKNOWN:"unknown",PARTIAL_1P:"1p_partial",FULL_3P:"3p_full"});var g=a({NONE:"none",BASIC:"basic"}),h=a({PROMPT:"prompt",COMMAND:"command",VOICE:"voice"}),i=a({DEFAULT:"default",UGC:"ugc",FIRST_PARTY_CHARACTER:"1p"});a=a({UNKNOWN:"unknown",YES:"yes",NO:"no"});f.BotMsgEditType=c;f.BizBotType=d;f.BotFeedbackKind=e;f.BizBotAutomatedType=b;f.BotWelcomeMsgProtocolModeType=g;f.BotMsgBodyType=h;f.BotPersonaType=i;f.BotPosingAsProfessionalType=a}),66);
__d("WAWebDBBulkGetIsContactABusiness",["WAWebSchemaVerifiedBusinessName"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().bulkGet(a.map(function(a){return(a=a==null?void 0:a.user)!=null?a:""})).then(function(a){return a.map(function(a){return a!=null})})}g.bulkGetIsContactABusiness=a}),98);
__d("WAWebApiHydrateWidsUtil",["WAWebWidFactory","WAWebWidJsonReviver"],(function(a,b,c,d,e,f,g){function h(a){if(Array.isArray(a))return a.map(function(b,a){return h(d("WAWebWidJsonReviver").widReviver(a,b,d("WAWebWidFactory").isWidlike,d("WAWebWidFactory").createWidFromWidLike))});else if(a&&typeof a==="object"){var b=Object.keys(a);for(var c=0;c<b.length;c++){var e=b[c];a[e]=h(d("WAWebWidJsonReviver").widReviver(e,a[e],d("WAWebWidFactory").isWidlike,d("WAWebWidFactory").createWidFromWidLike))}return a}return a}g.hydrateWids=h}),98);
__d("WAWebPrimaryFeatures",["WALogger","WAWebBackendApi","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","gkx","snakeCase"],(function(a,b,c,d,e,f,g){var h,i,j,k=null;function a(a){if(k==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["primaryFeatureEnabled: primary features have not been initialized!"])));return!1}return k.has(a)}function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES,a);yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES,a);var b=k;a=new Set(n(a));k=a;d("WAWebBackendApi").frontendFireAndForget("setPrimaryFeatures",{primaryFeatures:Array.from(k)});b=(b==null?void 0:b.has("favorite_sticker"))===!0;a=a.has("favorite_sticker");!b&&a&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["primary features: favorite stickers feature was enabled, checking orphan stickers"]))),yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("checkOrphanFavoriteStickers"))});return l.apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").KEYS.PRIMARY_FEATURES))!=null?a:[];a=n(a);k=new Set(a);d("WAWebBackendApi").frontendFireAndForget("setPrimaryFeatures",{primaryFeatures:a});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["primary features loaded"])))});return m.apply(this,arguments)}function n(a){var b,d;a=a;if(c("gkx")("26258"))return a;b=new URLSearchParams((b=window.location.search)!=null?b:"");d=((d=b.get("primary_features_enabled"))!=null?d:"").split(",").map(function(a){return c("snakeCase")(a)});a=Array.from(new Set([].concat(a,d)));var e=new Set(((d=b.get("primary_features_disabled"))!=null?d:"").split(",").map(function(a){return c("snakeCase")(a)}));a=a.filter(function(a){return!e.has(a)});return a}g.primaryFeatureEnabled=a;g.setPrimaryFeatures=e;g.loadPrimaryFeatures=f}),98);
__d("WAWebUsernameGatingUtils",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function a(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_change"))}function h(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_display"))}function i(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_usync"))}function j(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_1on1_chat"))}function k(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_creation"))}function b(){return h()&&j()&&i()}function c(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("username_supported")&&k()}function e(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_security_code_verification"))}function f(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_security_code_generation"))}function l(){return d("WAWebABProps").getABPropConfigValue("username_numeric_code_v4")}function m(){var a=l();return a===1||a===2||a===3}function n(){var a=l();return a===2||a===3}function o(){return!1}function p(){return Boolean(d("WAWebABProps").getABPropConfigValue("mex_usync_username_query"))}function q(){return Boolean(d("WAWebABProps").getABPropConfigValue("pushname_blocklist_starting_with_at"))}function r(){return Boolean(d("WAWebABProps").getABPropConfigValue("phone_number_sharing_flow"))}function s(){return Boolean(d("WAWebABProps").getABPropConfigValue("lid_group_migration_non_member_iq"))}function t(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_group_mutation_enabled"))}function u(){return d("WAWebABProps").getABPropConfigValue("username_check_debounce_in_ms")}function v(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_usync_lid_based"))}function w(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_syncd_support_enable"))}function x(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_lid_contact_change_enabled")&&w()}function y(){return i()&&Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_ui"))}function z(){return Boolean(d("WAWebABProps").getABPropConfigValue("username_contact_ui_vcard"))}g.usernameChangeEnabled=a;g.usernameDisplayedEnabled=h;g.usernameUsyncEnabled=i;g.username1on1ChatCreationEnabled=j;g.usernameCreationEnabled=k;g.usernameContactlessChatEnabled=b;g.usernameSupported=c;g.usernameSecurityCodeVerificationEnabled=e;g.usernameSecurityCodeGenerationEnabled=f;g.shouldShowV4NumericCode=m;g.shouldDefaultToV4NumericCode=n;g.shouldLogUnknownNumberError=o;g.mexUsyncUsernameQueryEnabled=p;g.pushnameValidationForUsernamesEnabled=q;g.phoneNumberSharingFlowEnabled=r;g.lidGroupMigrationNonMemberIQEnabled=s;g.usernameGroupMutationEnabled=t;g.usernameEligibilityDebounceMs=u;g.usernameContactUsyncLidBased=v;g.usernameContactSyncdEnabled=w;g.usernameLidContactChangeEnabled=x;g.usernameContactUIEnabled=y;g.usernameContactUiVcardEnabled=z}),98);
__d("WAWebVcardParsingUtils",["WALogger","WATypeUtils","WAWeb-moment","WAWebURLUtils","WAWebUsernameGatingUtils","WAWebWidFactory","lodash"],(function(a,b,c,d,e,f,g){var h,i="wa-biz-name",j=/X-([^;:]+)(?:;[^:]+)*:(.+)/,k={"X-ABLabel":[/X-ABLabel(?:;([^:]+))*:(.+)/,1],ADR:[/ADR(?:;([^:]+))*:;;(.*);(.*);(.*);(.*);(.*)/,5],"X-ABADR":[/X-ABADR(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.*)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1],TEL:[/TEL(?:;([^:]+))*:(.+)/,1]},l={N:[/N(?:;([^:]+))*:([^;]*);([^;]*);([^;]*);([^;]*);(.*)/,5],FN:[/FN(?:;([^:]+))*:(.*)/,1],NICKNAME:[/NICKNAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-FIRST-NAME":[/X-PHONETIC-FIRST-NAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-LAST-NAME":[/X-PHONETIC-LAST-NAME(?:;([^:]+))*:(.*)/,1],ORG:[/ORG(?:;([^:]+))*:([^;]*)(?:;(.*))*/,2],TITLE:[/TITLE(?:;([^:]+))*:(.*)/,1],TEL:[/TEL(?:;([^:]+))*:(.*)/,1],PHOTO:[/PHOTO(?:;([^:]+))*:(.*)/,1],BDAY:[/BDAY(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.+)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1]},m=function(a,b,c,d){this.type=a,this.index=b,this.properties=c||{},this.value=d};function n(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function o(a){var b={};if(!a)return b;a.split(";").forEach(function(a){a=a.split(/=/);if(a.length===1){var c=a[0];n(b,c.toLowerCase(),!0)}else if(a.length===2){c=a[0];a=a[1];n(b,c.toLowerCase(),a.toLowerCase())}});return b}function a(a){if(!a)return;return a.replace(/^_\$!<([^>]*)>!\$_$/,"$1").replace(/\\,/,",").replace(/\\;/,";").replace(/\\\\/,"\\")}function p(a){var b={};c("lodash").forOwn(a,function(a,d){b[d]=c("lodash").sortBy(a,function(a){return a.index})});return b}function b(a){var b=[/-([^-]*)-([^-]*)-([^-]*)/,/([^-]*)-([^-]*)-([^-]*)/],d=a;c("lodash").forEach(b,function(b){b=a.match(b);if(b){var e=!b[1].length||b[1]==="1604",f=e?"0000":b[1];d=c("WAWeb-moment")(f+"-"+b[2]+"-"+b[3]).format("l");e&&(d=d.replace(/[.,-\/\s]*0000[.,-\/\s]*/,""));return!1}});return d}function q(a){var b=[];a!=null&&a.TEL&&a.TEL.forEach(function(a){var c;((c=(c=a.properties)==null||(c=c.waid)==null?void 0:c.length)!=null?c:0)>0&&(b=b.concat(a.properties.waid.map(function(a){return d("WAWebWidFactory").createUserWidOrThrow(a)})))});return b}function r(a){if(d("WAWebUsernameGatingUtils").usernameContactUiVcardEnabled()){a=((a==null?void 0:a.SERVICE)||[]).find(function(a){return a.type.toLowerCase()==="wa-lid"});if(a!=null&&a.value)return d("WAWebWidFactory").createUserLidOrThrow(a.value,"lid")}return null}function e(a){var b=q(a);a=r(a);a!=null&&(b=b.concat(a));return b}function s(a){a=a==null?void 0:a.replace(/\r?\n|\r/g,"\n").replace(/\n^[ \t]/gm,"").split("\n").filter(function(a){return a.trim().length!==0});var b={},c={};if(a==null||a.length<3)return void 0;var e=a[0].trim().toUpperCase(),f=a[1].trim().toUpperCase(),g=a[a.length-1].trim().toUpperCase();f=f==="VERSION:2.1"||f==="VERSION:3.0"||f==="VERSION:4.0";if(e!=="BEGIN:VCARD"||!f||g!=="END:VCARD"){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["vcard:parse failed because the vCard is not formatted as expected:\n                Header as expected? ","\n                Version as expected? ","\n                Footer as expected? ","\n                Lines: ",""])),String(e==="BEGIN:VCARD"),String(f),String(g==="END:VCARD"),a.length).sendLogs("vcard-fault");return void 0}for(e=2;e<a.length-1;e++){var i;f=a[e];g=f.match(/item(\d+)\.(.*)/);f=g?g[2]:f;i=(i=f.match(/([^:;]*)[:;].*/))==null?void 0:i[1];if(i==null)continue;var q=g?k:l,r=i;i=i;var s=void 0,t=void 0;if(q[r]){q=q[r];var u=q[0];q=q[1];u=f.match(u);u&&(s=o(u[1]),t=q===1?t=u[2]:u.slice(2,2+q))}else{u=f.match(j);u&&(i="SERVICE",r=u[1],t=u[2],s={})}q=Array.isArray(t)?t:[t];if(q.some(function(a){return d("WATypeUtils").isString(a)&&a.trim()}))if(g){f=g[1];c[f]?c[f].fields.push(new m(r,null,s,t)):c[f]={type:r,index:e,key:i,properties:s,value:t,fields:[]}}else n(b,i,new m(r,e,s,t))}Object.keys(c).forEach(function(f){f=c[f];var g=f.key,h=f.index,a=f.type,e=f.value,d=f.properties;f=f.fields;f.forEach(function(a){d[a.type]=a.value});n(b,g,new m(a,h,d,e))});return p(b)}function f(a){if(!a)return void 0;a=a.PHOTO;if(a!=null&&a[0]&&c("WAWebURLUtils").isData(a[0].value))return a[0].value}function t(a){a=a.match(/BEGIN:VCARD([^]*?)END:VCARD/g);return a?a.map(function(a){return s(a)}).filter(Boolean):[]}function u(a){return(a.SERVICE||[]).some(function(a){return a.type.toLowerCase()===i&&a.value})}g.WA_BIZ_NAME=i;g.Field=m;g.clean=a;g.vcardGetDate=b;g.vcardPhoneNumberWids=q;g.vcardLidWid=r;g.vcardAllWids=e;g.parseVcard=s;g.vcardThumbnail=f;g.parseMultiVcard=t;g.vcardIsBiz=u}),98);
__d("WAWebDBMessageUtils",["$InternalEnum","WAWebVcardParsingUtils"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({IncomingChatMessage:"1",Outgoing:"2",SystemMessage:"3"}),i=b("$InternalEnum")({Default:"",GroupStatus:"gs"});function j(a){a=a.toString(16);return(a.length-1).toString(16)+a}function k(a){return parseInt(a.substring(1),16)}function a(a){return a.toString()+"_/"}function c(a){return a.toString()+"_g"}function e(a,b,c){c===void 0&&(c=i.Default);b=j(b);return""+c+a+"_"+b+"_m"}function f(a){a=a.split("_")[1];return k(a)}function l(a,b){a=j(a);return b.toString()+"_"+a}function m(a,b,c,d){c?c=h.SystemMessage:!b?c=h.Outgoing:c=h.IncomingChatMessage;return a+"_"+c+"_"+(d!=null?j(d):"")}function n(a){var b;if(a.type==="vcard")b=[a.body];else if(a.kind==="multiVcard")b=a.vcardList.map(function(a){return a.vcard});else return;return b.filter(Boolean).reduce(function(a,b){b=d("WAWebVcardParsingUtils").vcardAllWids(d("WAWebVcardParsingUtils").parseVcard(b));return a.concat(b.map(function(a){return a.toString()}))},[])}function o(a){a=a.isGroupStatus;var b=i.Default;a===!0&&(b=i.GroupStatus);return b}g.MessagePropertyType=h;g.InternalIdPrefix=i;g.undoOrderPreservingHex=k;g.beginningOfChat=a;g.endOfChat=c;g.craftInternalId=e;g.getInChatMsgId=f;g.craftInternalThreadId=l;g.craftMessageRangeIndex=m;g.getVcardWids=n;g.getPrefixForInternalId=o}),98);
__d("WAWebDBMsgOpaqueDataKeys",[],(function(a,b,c,d,e,f){b=["body","caption","paymentAmount1000","futureproofBuffer","messageSecret","clientUrl","loc","lng","lat","isLive","matchedText","title","description","pollName","pollSelectableOptionsCount","isSentCagPollCreation","pollUpdateParentKey","encPollVote","senderTimestampMs","targetMessageKey","encIv","encPayload","eventName","isEventCanceled","eventDescription","eventJoinLink","eventStartTime","eventLocation","eventEndTime","eventIsScheduledCall","eventExtraGuestsAllowed"];c=["targetMessageKey","pollUpdateParentKey"];var g={targetMessageKey:"encReactionTargetMessageKey",encIv:"encReactionEncIv",encPayload:"encReactionEncPayload",encReactionTargetMessageKey:"targetMessageKey",encReactionEncIv:"encIv",encReactionEncPayload:"encPayload"};function a(a,b){return a==="reaction_enc"?g[b]:b}f.MSG_OPAQUE_DATA_KEYS=b;f.MsgKeyFieldsInOpaqueData=c;f.getKey=a}),66);
__d("WAWebPollCreationUtils",["WAWebProtobufsE2E.pb","WAWebProtobufsMdStorageMsgRowOpaqueData.pb"],(function(a,b,c,d,e,f,g){"use strict";var h={TEXT:"TEXT",IMAGE:"IMAGE"},i={POLL:"POLL",QUIZ:"QUIZ"};function a(a){if(a==null)return h.TEXT;switch(a){case d("WAWebProtobufsE2E.pb").Message$PollContentType.IMAGE:return h.IMAGE;case d("WAWebProtobufsE2E.pb").Message$PollContentType.TEXT:case d("WAWebProtobufsE2E.pb").Message$PollContentType.UNKNOWN:return h.TEXT}}function b(a){switch(a){case h.TEXT:return d("WAWebProtobufsE2E.pb").Message$PollContentType.TEXT;case h.IMAGE:return d("WAWebProtobufsE2E.pb").Message$PollContentType.IMAGE}}function c(a){if(a==null)return h.TEXT;switch(a){case d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollContentType.IMAGE:return h.IMAGE;case d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollContentType.TEXT:case d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollContentType.UNKNOWN:return h.TEXT}}function e(a){switch(a){case h.TEXT:return d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollContentType.TEXT;case h.IMAGE:return d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollContentType.IMAGE}}function f(a){if(a==null)return i.POLL;switch(a){case d("WAWebProtobufsE2E.pb").Message$PollType.POLL:return i.POLL;case d("WAWebProtobufsE2E.pb").Message$PollType.QUIZ:return i.QUIZ}}function j(a){switch(a){case i.POLL:return d("WAWebProtobufsE2E.pb").Message$PollType.POLL;case i.QUIZ:return d("WAWebProtobufsE2E.pb").Message$PollType.QUIZ}}function k(a){if(a==null)return i.POLL;switch(a){case d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollType.POLL:return i.POLL;case d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollType.QUIZ:return i.QUIZ}}function l(a){switch(a){case i.POLL:return d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollType.POLL;case i.QUIZ:return d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgOpaqueData$PollType.QUIZ}}g.PollContentType=h;g.PollType=i;g.getPollContentTypeFromE2EValue=a;g.getPollContentTypeAsE2EValue=b;g.getPollContentTypeFromDBValue=c;g.getPollContentTypeAsDBValue=e;g.getPollTypeFromE2EValue=f;g.getPollTypeAsE2EValue=j;g.getPollTypeFromDBValue=k;g.getPollTypeAsDBValue=l}),98);
__d("WAWebPollOptionHashUtils",["WABase64","WAHex","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function h(a){return self.crypto.subtle.digest("SHA-256",new TextEncoder().encode(a))}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h(a));return d("WAHex").toLowerCaseHex(new Uint8Array(a))});return j.apply(this,arguments)}function c(a){return d("WAHex").toHex(a)}function e(a){return d("WAHex").toHex(new Uint8Array(d("WABase64").decodeB64(a))).toUpperCase()}function f(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield i(a));a=a.concat(b);return i(a)});return k.apply(this,arguments)}g.createOptionHashHexFromString=a;g.getHashBufferForString=h;g.getHashHexForString=i;g.bufferToHex=c;g.base64ToHex=e;g.generatePollOptionHash=f}),98);
__d("WAWebPollsDbUtils",["invariant","WANullthrows","WAWebPollOptionHashUtils"],(function(a,b,c,d,e,f,g,h){function a(a){return a==null?void 0:a.slice().sort(function(a,b){return a.localId-b.localId}).map(function(a,b){var c=a.localId,d=a.name;a=a.hash;c===b||h(0,59784);return a!=null?{name:d,hash:a}:{name:d}})}function b(a){a=(a=a==null?void 0:a.pollVotes)!=null?a:[];a=a==null?void 0:a.slice().sort(function(a,b){return a.option.localId-b.option.localId}).map(function(a,b){var c=a.option;a=a.optionVoteCount;c.localId===b||h(0,59784);return{option:{name:c.name},optionVoteCount:a}});return{pollVotes:a}}function e(a){return a==null?void 0:a.map(function(a,b){var e=a.name;a=a.hash;return a==null?{name:c("WANullthrows")(e),localId:b}:{name:c("WANullthrows")(e),localId:b,hash:d("WAWebPollOptionHashUtils").createOptionHashHexFromString(a)}})}function f(a){a=(a=a==null?void 0:a.pollVotes)!=null?a:[];a=a==null?void 0:a.map(function(a,b){var d=a.option;a=a.optionVoteCount;return{option:{name:c("WANullthrows")(d==null?void 0:d.name),localId:b},optionVoteCount:c("WANullthrows")(a)}});return{pollVotes:a}}g.compressPollOptions=a;g.compressPollVotesSnapshot=b;g.expandPollOptions=e;g.expandPollVotesSnapshot=f}),98);
__d("WAWebDBMessageSerialization",["invariant","WAJids","WAWebApiHydrateWidsUtil","WAWebDBMessageUtils","WAWebDBMsgOpaqueDataKeys","WAWebMsgKey","WAWebMsgType","WAWebPollCreationUtils","WAWebPollsDbUtils","WAWebProtobufsMdStorageMsgRowOpaqueData.pb","WAWebViewMode.flow","WAWebWid","WAWebWidFactory","WAWebWidToJid","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g,h){var i=1e9,j=new Set(Object.values(d("WAWebMsgType").MSG_TYPE)),k=["id","parentMsgId","protocolMessageKey","paymentRequestMessageKey","keptMessageKey","pollUpdateParentKey","kicKey","latestEditMsgKey","targetMessageKey","pinParentKey","reactionParentKey","parentMsgKey"];function a(a,b){var e,f=babelHelpers["extends"]({},a);a.quotedMsg&&(f.quotedMsg=babelHelpers["extends"]({},a.quotedMsg));(e=a.quotedMsg)!=null&&e.paymentNoteMsg&&(f.quotedMsg.paymentNoteMsg=babelHelpers["extends"]({},a.quotedMsg.paymentNoteMsg));a.paymentNoteMsg&&(f.paymentNoteMsg=babelHelpers["extends"]({},a.paymentNoteMsg));a.groupMentions&&(f.groupMentions=a.groupMentions.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebWidFactory").createWidFromWidLike(a.groupJid)}}));f.star=f.isStarred!==void 0;f.isMdHistoryMsg=f.rowId<i;f.internalId!=null&&(((e=f.to)==null?void 0:e.server)==="newsletter"||(a=f.from)!=null&&a.endsWith("@newsletter"))&&(f.serverId=d("WAWebDBMessageUtils").getInChatMsgId(f.internalId));delete f.internalId;delete f.isStarred;delete f.count;delete f.hasLink;delete f.isMediaMsg;delete f.isDocMsg;delete f.isCallLogMsg;delete f.isCarouselMsg;delete f.isEventMsg;delete f.typeFlag;delete f.expiredTimestamp;delete f.pendingReadReceipt;m(f);d("WAWebApiHydrateWidsUtil").hydrateWids(f);k.forEach(function(a){f[a]!=null&&(f[a]=c("WAWebMsgKey").from(f[a]))});((e=f.quotedMsg)==null?void 0:e.id)!=null&&(f.quotedMsg.id=c("WAWebMsgKey").from(f.quotedMsg.id));f.messageSecret!=null&&(f.messageSecret=new Uint8Array(f.messageSecret));f.botMessageSecret!=null&&(f.botMessageSecret=new Uint8Array(f.botMessageSecret));a=l(f);e=a[0];var g=a[1];a=a[2];f.futureproofType=e;f.futureproofSubtype=g;f.subtype=a!=null?a:void 0;f.viewMode=(e=f.viewMode)!=null?e:d("WAWebViewMode.flow").ViewModeType.VISIBLE;f.carouselCardsParsed!=null&&(f.carouselCardsParsed=f.carouselCardsParsed.map(function(a){return babelHelpers["extends"]({},a,{id:a.id instanceof c("WAWebMsgKey")?a.id:new(c("WAWebMsgKey"))(a.id),parentMsgId:a.parentMsgId instanceof c("WAWebMsgKey")?a.parentMsgId:new(c("WAWebMsgKey"))(a.parentMsgId)})}));b==null||b(f);return f}function l(a){var b=a.futureproofType,c=a.futureproofSubtype,e=a.subtype;if(a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType==null&&a.subtype!=null){switch(a.subtype){case"poll_update":b=d("WAWebMsgType").MSG_TYPE.POLL_UPDATE;c="poll_vote";break;case"message_edit":b=d("WAWebMsgType").MSG_TYPE.PROTOCOL;c="message_edit";break;case"phone":case"phone_only_feature":break;default:j.has(a.subtype)||h(0,67194),b=a.subtype}a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&b!=null&&(e=void 0)}a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&e==null&&(e="poll_vote");return[b,c,e]}function m(a){var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,a.msgRowOpaqueData),e=b.currentMsg,f=b.quotedMsg;if(e){e.paymentNoteMsgBody!=null&&a.paymentNoteMsg&&(a.paymentNoteMsg.body=e.paymentNoteMsgBody);d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){a[b]=e[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,b)]});a.pollOptions=d("WAWebPollsDbUtils").expandPollOptions(e.pollOptions);a.pollVotesSnapshot=d("WAWebPollsDbUtils").expandPollVotesSnapshot(e.pollVotesSnapshot);e.correctOptionIndex!=null&&(a.correctOptionIndex=e.correctOptionIndex);a.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&(a.pollContentType=d("WAWebPollCreationUtils").getPollContentTypeFromDBValue(e.pollContentType),a.pollType=d("WAWebPollCreationUtils").getPollTypeFromDBValue(e.pollType));b=e.originalSelfAuthor;b!=null&&c("WAWebWid").isWid(b)&&(a.originalSelfAuthor=d("WAWebWidFactory").createWid(b));e.plainProtobufBytes!=null&&(a.plainProtobufBytes=new Uint8Array(e.plainProtobufBytes))}a.quotedMsg&&f&&(f.paymentNoteMsgBody!=null&&(a.quotedMsg.paymentNoteMsg.body=f.paymentNoteMsgBody),d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){a.quotedMsg[b]=f[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,b)]}),a.quotedMsg.pollOptions=d("WAWebPollsDbUtils").expandPollOptions(f.pollOptions))}function b(a,b){var c,d=babelHelpers["extends"]({},a);a.quotedMsg&&(d.quotedMsg=babelHelpers["extends"]({},a.quotedMsg));(c=a.quotedMsg)!=null&&c.paymentNoteMsg&&(d.quotedMsg.paymentNoteMsg=babelHelpers["extends"]({},a.quotedMsg.paymentNoteMsg));a.paymentNoteMsg&&(d.paymentNoteMsg=babelHelpers["extends"]({},a.paymentNoteMsg));a.from&&(d.from=a.from.toString());(b==null?void 0:b.storeReportingInfo)===!0&&(d.preMatChat=a.preMatChat,d.senderWithDevice=a.senderWithDevice);k.forEach(function(a){d[a]!=null&&(d[a]=d[a].toString())});delete d.notifyName;delete d.isNewMsg;delete d.clearMedia;delete d.multicast;delete d.urlNumber;delete d.urlText;delete d.linkPreview;delete d.star;delete d.forwardedFromWeb;n(d,b);return d}function n(a,b){var c,e={currentMsg:{},quotedMsg:{}};if((c=a.paymentNoteMsg)!=null&&c.body){e.currentMsg.paymentNoteMsgBody=a.paymentNoteMsg.body;(c=a.paymentNoteMsg)==null||delete c.body}(c=a.quotedMsg)!=null&&(c=c.paymentNoteMsg)!=null&&c.body&&(e.quotedMsg.paymentNoteMsgBody=a.quotedMsg.paymentNoteMsg.body,delete a.quotedMsg.paymentNoteMsg.body);a.correctOptionIndex!=null&&(e.currentMsg.correctOptionIndex=a.correctOptionIndex,delete a.correctOptionIndex);d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){e.currentMsg[d("WAWebDBMsgOpaqueDataKeys").getKey(a.type,b)]=a[b],delete a[b]});a.originalSelfAuthor&&(e.currentMsg.originalSelfAuthor=d("WAJids").extractUserJid(d("WAWebWidToJid").widToDeviceJid(a.originalSelfAuthor)),delete a.originalSelfAuthor);e.currentMsg.pollContentType=d("WAWebPollCreationUtils").getPollContentTypeAsDBValue(a.pollContentType);delete a.pollContentType;e.currentMsg.pollType=d("WAWebPollCreationUtils").getPollTypeAsDBValue(a.pollType);delete a.pollType;e.currentMsg.pollOptions=d("WAWebPollsDbUtils").compressPollOptions(a.pollOptions);delete a.pollOptions;e.currentMsg.pollVotesSnapshot=d("WAWebPollsDbUtils").compressPollVotesSnapshot(a.pollVotesSnapshot);delete a.pollVotesSnapshot;a.quotedMsg&&(d("WAWebDBMsgOpaqueDataKeys").MSG_OPAQUE_DATA_KEYS.forEach(function(b){e.quotedMsg[b]=a.quotedMsg[b],delete a.quotedMsg[b]}),e.quotedMsg.pollOptions=d("WAWebPollsDbUtils").compressPollOptions(a.quotedMsg.pollOptions),delete a.quotedMsg.pollOptions);(b==null?void 0:b.storeReportingInfo)===!0&&a.plainProtobufBytes!=null&&(e.currentMsg.plainProtobufBytes=a.plainProtobufBytes);delete a.plainProtobufBytes;c=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMdStorageMsgRowOpaqueData.pb").MsgRowOpaqueDataSpec,e);a.msgRowOpaqueData=c.readBuffer()}g.messageFromDbRow=a;g.movFieldFromOpaqueDataBackToMsg=m;g.dbRowFromMessage=b;g.movEncFieldToOpaqueData=n}),98);
__d("WAWebDBGetStarredMessagesForChat",["Promise","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebSchemaMessage"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e){return(h||(h=b("Promise"))).resolve().then(function(){if(e!=null)return d("WAWebSchemaMessage").getMessageTable().get(e.toString())}).then(function(b){b=b==null?[d("WAWebDBMessageUtils").endOfChat(a),Infinity]:[b.internalId,b.isStarred];var e=[d("WAWebDBMessageUtils").beginningOfChat(a),0];return d("WAWebSchemaMessage").getMessageTable().between(["internalId","isStarred"],e,b,{lowerInclusive:!1,upperInclusive:!1,reverse:!0,limit:c}).then(function(a){return a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)})})})}g.getStarredMessagesForChat=a}),98);
__d("WAWebDBGroupsGroupMetadata",["Promise","WABatcher","WALogger","WAWebABProps","WAWebModelStorageUtils","WAWebSchemaGroupMetadata","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.groupInfos;yield d("WAWebModelStorageUtils").getStorage().lock(["group-metadata"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.bulkGet(c.map(function(a){return a.id.toString()})));a=c.map(function(a,b){var c;b=e[b];var f={subject:a.subject,subjectTime:a.subjectTime||0},g={announce:a.announce,a_v_id:a.a_v_id||0};c={desc:a.desc,descId:a.descId,descOwner:(c=a.descOwner)==null?void 0:c.toString(),descTime:a.descTime||0};if(b){var h=b.subjectTime||0,i=b.a_v_id||0,j=b.descTime||0;h>f.subjectTime&&(f={subject:b.subject,subjectTime:h});i>g.a_v_id&&(g={announce:b.announce,a_v_id:i});j>c.descTime&&(c={desc:b.desc,descId:b.descId,descOwner:b.descOwner,descTime:j})}d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")?h={ephemeralDuration:a.ephemeralDuration||0,disappearingModeTrigger:a.disappearingModeTrigger,disappearingModeInitiatedByMe:a.disappearingModeInitiatedByMe}:h={ephemeralDuration:a.ephemeralDuration||0};i=babelHelpers["extends"]({id:a.id.toString(),creation:a.creation,owner:(i=a.owner)==null?void 0:i.toString(),restrict:a.restrict,noFrequentlyForwarded:a.noFrequentlyForwarded,membershipApprovalMode:a.membershipApprovalMode,memberAddMode:a.memberAddMode,memberLinkMode:a.memberLinkMode,growthLockExpiration:a.growthLockExpiration,growthLockType:a.growthLockType,size:a.size||0,support:(j=a.support)!=null?j:!1,suspended:(i=a.suspended)!=null?i:!1,terminated:(j=a.terminated)!=null?j:!1,parentGroup:(i=a.parentGroup)==null?void 0:i.toString(),isParentGroup:a.isParentGroup,isParentGroupClosed:a.isParentGroupClosed,defaultSubgroup:a.defaultSubgroup,generalSubgroup:a.generalSubgroup,lastActivityTimestamp:(j=b==null?void 0:b.lastActivityTimestamp)!=null?j:0,lastSeenActivityTimestamp:(i=b==null?void 0:b.lastSeenActivityTimestamp)!=null?i:0,incognito:a.incognito,isLidAddressingMode:a.isLidAddressingMode,reportToAdminMode:(j=a.reportToAdminMode)!=null?j:!1,lastReportToAdminTimestamp:b==null?void 0:b.lastReportToAdminTimestamp,allowNonAdminSubGroupCreation:a.allowNonAdminSubGroupCreation,generalChatAutoAddDisabled:a.generalChatAutoAddDisabled,hasCapi:a.hasCapi===!0,hiddenSubgroup:a.hiddenSubgroup,groupSafetyCheck:a.groupSafetyCheck,lastCommunityPollTimestamp:b==null?void 0:b.lastCommunityPollTimestamp},f,c,g,h);a.hasIncompleteParticipantInformation!=null&&d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(i.hasIncompleteParticipantInformation=a.hasIncompleteParticipantInformation);return a.groupAdder!=null?babelHelpers["extends"]({},i,{groupAdder:(j=a.groupAdder)==null?void 0:j.toString()}):i});return b.bulkCreateOrMerge(a)});return function(a){return e.apply(this,arguments)}}())});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groupWid;var b=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(String(a)));return!b?null:{id:a,owner:b.owner==null?null:d("WAWebWidFactory").createWid(b.owner),creation:b.creation,desc:(a=b.desc)!=null?a:void 0,descId:(a=b.descId)!=null?a:void 0,descOwner:b.descOwner==null?null:d("WAWebWidFactory").createWid(b.descOwner),descTime:(a=b.descTime)!=null?a:void 0,restrict:b.restrict||!1,announce:b.announce||!1,noFrequentlyForwarded:b.noFrequentlyForwarded||!1,ephemeralDuration:b.ephemeralDuration||0,membershipApprovalMode:(a=b.membershipApprovalMode)!=null?a:!1,memberAddMode:b.memberAddMode,memberLinkMode:b.memberLinkMode,subject:b.subject,support:b.support===!0,lastActivityTimestamp:(a=b.lastActivityTimestamp)!=null?a:0,lastSeenActivityTimestamp:(a=b.lastSeenActivityTimestamp)!=null?a:0,lastReportToAdminTimestamp:(a=b.lastReportToAdminTimestamp)!=null?a:null,incognito:b.incognito,isLidAddressingMode:b.isLidAddressingMode,allowNonAdminSubGroupCreation:(a=b.allowNonAdminSubGroupCreation)!=null?a:!1,generalChatAutoAddDisabled:(a=b.generalChatAutoAddDisabled)!=null?a:!1,hasCapi:b.hasCapi===!0,lastCommunityPollTimestamp:(a=b.lastCommunityPollTimestamp)!=null?a:0}});return l.apply(this,arguments)}var m=function(){var a=3e3;return d("WABatcher").batch({delayMs:a},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["persistGroupMetadataBatched: aggregating "," changes"])),a.length);b=b();d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["persistGroupMetadataBatched: persisting "," records"])),b.length);yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkCreateOrMerge(b);return a.map(function(a){return void 0});function b(){return Array.from(a.reduce(function(a,b){var c;a.set(b.id,babelHelpers["extends"]({},(c=a.get(b.id))!=null?c:{},b));return a},new Map()).values())}});return function(b){return a.apply(this,arguments)}}())}();function e(a,b,c){c===void 0&&(c=!1);return c?m(babelHelpers["extends"]({id:a.toString()},b)):d("WAWebSchemaGroupMetadata").getGroupMetadataTable().createOrMerge(a.toString(),babelHelpers["extends"]({id:a.toString()},b))}function f(a){return d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(a.toString())}function n(a){return a.length===0?(j||(j=b("Promise"))).resolve([]):d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkGet(a.map(function(a){return a==null?"":a.toString()}))}g.updateGroupMetadataTable=a;g.getGroupMetadataUNSAFE=c;g.persistGroupMetadata=e;g.getGroupMetadata=f;g.bulkGetGroupMetadata=n}),98);
__d("WAWebWamEnumTypeOfGroupEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP:1,SUBGROUP:2,DEFAULT_SUBGROUP:3});f.TYPE_OF_GROUP_ENUM=a}),66);
__d("WAWebGroupType",["$InternalEnum","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){f=(e=b("$InternalEnum"))({On:"on",Off:"off"});b=e({Admin:"admin",Regular:"regular"});var h=e({Server:"server",Full:"full"}),i=Object.freeze({SUBJECT:"subject",ADD:"add",PROMOTE:"promote",DEMOTE:"demote",DELETE:"delete",REMOVE:"remove",MODIFY:"modify",INVITE_CODE:"invite",DESC_ADD:"desc_add",DESC_REMOVE:"desc_remove",RESTRICT:"restrict",ANNOUNCE:"announce",NO_FORWARD:"no_frequently_forwarded",EPHEMERAL:"ephemeral",REVOKE_INVITE:"revoke_invite",SUSPEND:"suspend",GROWTH_LOCKED:"growth_locked",GROWTH_UNLOCKED:"growth_unlocked",SUB_GROUP_LINK:"sub_group_link",PARENT_GROUP_LINK:"parent_group_link",SIBLING_GROUP_LINK:"sibling_group_link",SUB_GROUP_UNLINK:"sub_group_unlink",PARENT_GROUP_UNLINK:"parent_group_unlink",SIBLING_GROUP_UNLINK:"sibling_group_unlink",DELETE_PARENT_GROUP:"delete_parent_group",DELETE_PARENT_GROUP_UNLINK:"delete_parent_group_unlink",DELETE_PARENT_SUB_GROUP_UNLINK:"delete_parent_sub_group_unlink",INTEGRITY_PARENT_GROUP_UNLINK:"integrity_parent_group_unlink",INTEGRITY_SUB_GROUP_UNLINK:"integrity_sub_group_unlink",LINKED_GROUP_PROMOTE:"linked_group_promote",LINKED_GROUP_DEMOTE:"linked_group_demote",MEMBERSHIP_APPROVAL_MODE:"membership_approval_mode",MEMBERSHIP_APPROVAL_REQUEST:"membership_approval_request",CREATED_MEMBERSHIP_REQUESTS:"created_membership_requests",REVOKED_MEMBERSHIP_REQUESTS:"revoked_membership_requests",ALLOW_NON_ADMIN_SUB_GROUP_CREATION:"allow_non_admin_sub_group_creation",ALLOW_ADMIN_REPORTS:"allow_admin_reports",ADMIN_REPORT_RECIEVED:"admin_report_received",CREATED_SUBGROUP_SUGGESTION:"created_subgroup_suggestion",REVOKED_SUB_GROUP_SUGGESTIONS:"revoked_sub_group_suggestions",SUBGROUP_SUGGESTIONS_CHANGE_NUMBER:"subgroup_suggestions_change_number",MEMBER_ADD_MODE:"member_add_mode",MEMBER_LINK_MODE:"member_link_mode",GENERAL_CHAT_AUTO_ADD_DISABLED:"general_chat_auto_add_disabled",COMMUNITY_OWNER_UPDATE:"community_owner_update",HIDDEN_GROUP:"hidden_group",GROUP_SAFETY_CHECK:"group_safety_check"}),j=Object.freeze({INTEGRITY_DELETE_PARENT:"integrity_delete_parent",DELETE_PARENT:"delete_parent"}),k=Object.freeze({INVITE:"invite",LINKED_GROUP_JOIN:"linked_group_join",AUTO_ADD:"auto_add",DEFAULT_SUBGROUP_ADMIN_ADD:"default_subgroup_admin_add",DEFAULT_SUBGROUP_PROMOTE:"default_sub_group_promote",INVITE_AUTO_ADD:"invite_auto_add",GENERAL_CHAT_AUTO_ADD:"general_chat_auto_add"}),l=Object.freeze({DEFAULT_SUBGROUP_DEMOTE:"default_sub_group_demote"}),m=e({APPROVED:"approved",REJECTED:"rejected",CANCELLED:"cancelled"}),n=e.Mirrored(["DEFAULT","COMMUNITY","LINKED_SUBGROUP","LINKED_ANNOUNCEMENT_GROUP","LINKED_GENERAL_GROUP"]);function a(a){if(a.defaultSubgroup===!0)return n.LINKED_ANNOUNCEMENT_GROUP;if(a.generalSubgroup===!0)return n.LINKED_GENERAL_GROUP;if(a.parentGroup!=null)return n.LINKED_SUBGROUP;return a.isParentGroup===!0?n.COMMUNITY:n.DEFAULT}function c(a){switch(a){case n.LINKED_ANNOUNCEMENT_GROUP:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.DEFAULT_SUBGROUP;case n.LINKED_SUBGROUP:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.SUBGROUP;default:return d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM.GROUP}}g.GroupSettingChangeSystemMessageToggleEnabled=f;g.GroupSettingChangeSystemMessageIsAdmin=b;g.GeneralChatAutoAddDisabledReasonEnum=h;g.GROUP_ACTIONS=i;g.DELETE_REASON=j;g.ADD_REASON=k;g.REMOVE_REASON=l;g.RevokedSubGroupSuggestionReason=m;g.GroupType=n;g.getGroupTypeFromGroupMetadata=a;g.groupTypeToWamEnum=c}),98);
__d("WAWebUsernameTypes",["$InternalEnum","err"],(function(a,b,c,d,e,f,g){d=b("$InternalEnum")({PNH_CTWA:"ctwa",GENERAL:"general"});e=b("$InternalEnum").Mirrored(["INVALID_CHARACTER","INVALID_LENGTH","INVALID_NO_LETTERS","INVALID_PERIODS","INVALID_DOMAIN_SUFFIX","INVALID_WWW_PREFIX"]);f=3;b=35;var h=4,i=/^[0-9]{4}$/;function j(a){return a.length===h&&i.test(a)}function a(a){if(!j(a))throw c("err")("[username][key] Cannot convert key string to UsernameKey");return a}g.LidOriginType=d;g.UsernameValidationErrorType=e;g.USERNAME_MIN_LENGTH=f;g.USERNAME_MAX_LENGTH=b;g.isUsernameKey=j;g.asUsernameKey=a}),98);
__d("WAWebWamEnumChatOriginsType",[],(function(a,b,c,d,e,f){a=Object.freeze({LID_USERNAME:1,LID_CTWA:2,OTHERS:3});f.CHAT_ORIGINS_TYPE=a}),66);
__d("WAWebChatThreadLoggingEventStore",["Promise","WALogger","WAShiftTimer","WAWebABProps","WAWebApiChat","WAWebApiChatThreadLoggingPendingEvents","WAWebApiContact","WAWebBotTypes","WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebChatThreadLoggingUtils","WAWebDBBulkGetIsContactABusiness","WAWebDBGetStarredMessagesForChat","WAWebDBGroupsGroupMetadata","WAWebGroupType","WAWebLidAwareContactsDB","WAWebLidMigrationUtils","WAWebSchemaBusinessProfile","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebUsernameTypes","WAWebWamEnumChatOriginsType","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=5;a=function(){function a(a,b){var c=this;this.metadataStore=a;this.$1=new Map();this.$2=b!=null?b:o;this.$3=new(d("WAShiftTimer").ShiftTimer)(function(){c.$4()["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: flush error"]))).devConsole(a)})})}var e=a.prototype;e.handleMessages=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=(yield this.metadataStore.getOffset());if(c==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: handleMessages: offset unset."])));return}var e=(yield this.metadataStore.getLastUploadedStartTs());d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: lastUploadedStartTs=",""])),e);a.forEach(function(a){if(!d("WAWebChatThreadLoggingUtils").shouldUpdateChatEvent(c,a.ts,e))return;var f=d("WAWebChatThreadLoggingUtils").computeStartTs(c,a.ts),g=a.chatId.toString({legacy:!0}),h=g+"_"+String(f),i=b.$1.get(h);f=i!=null?i:babelHelpers["extends"]({},d("WAWebChatThreadLoggingCountFields").COUNT_FIELDS,d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELDS,{startTs:f,chatId:g,addMsgsSent:0,addMsgsReceived:0,addMsgsRead:0,addViewOnceMsgsSent:0,addViewOnceMsgsReceived:0,addViewOnceMsgsOpened:0,addCallOffersSent:0,addCallOffersReceived:0,addTotalCallDuration:0,addCommerceMsgsSent:0,addCommerceMsgsReceived:0,addPdpInquiriesSent:0,addReactionsSent:0,addReactionsReceived:0,addForwardMessagesSent:0,addForwardMessagesReceived:0,addEditedMsgsSent:0,addBotMessagesSent:0,addBotMessagesReceived:0,addBotMessagesEdited:0,addEventCreationMessagesSent:0,addEventCreationMessagesReceived:0,addEventResponseMessagesSent:0,addEventResponseMessagesReceived:0,addEventGroupStatusReplyOthersToOwn:0,addEventGroupStatusReplyOthersToOthers:0,addEventGroupStatusReplyOwnToOwn:0,addEventGroupStatusReplyOwnToOthers:0,addEventGroupStatusLikeOthersToOthers:0,addEventGroupStatusLikeOthersToOwn:0});i==null&&b.$1.set(h,f);g=d("WAWebChatThreadLoggingCountFields").toMaybeCountActionType(a.activityType);i=d("WAWebChatThreadLoggingBoolFlagFields").toMaybeBoolFlagActionType(a.activityType);if(g!=null)f[g]+=1;else if(i!=null)f[i]=a.boolValue===void 0?!0:a.boolValue;else switch(a.activityType){case"msgSend":f.addMsgsSent+=1;a.isViewOnce&&(f.addViewOnceMsgsSent+=1);a.isCommerceMessage===!0&&(f.addCommerceMsgsSent+=1);a.isPdpInquiry===!0&&(f.addPdpInquiriesSent+=1);a.isReply&&(f.repliesSent+=1);a.isReaction&&(f.addReactionsSent+=1);a.isForwarded&&(f.addForwardMessagesSent+=1);a.isEdit&&(f.addEditedMsgsSent+=1);a.isBot&&(f.addBotMessagesSent+=1);a.isEventCreation&&(f.addEventCreationMessagesSent+=1);a.isEventResponse&&(f.addEventResponseMessagesSent+=1);break;case"msgReceive":f.addMsgsReceived+=1;a.isViewOnce&&(f.addViewOnceMsgsReceived+=1);a.isCommerceMessage===!0&&(f.addCommerceMsgsReceived+=1);a.isReaction&&(f.addReactionsReceived+=1);a.isForwarded&&(f.addForwardMessagesReceived+=1);a.isBot&&(a.isEdit?f.addBotMessagesEdited+=1:f.addBotMessagesReceived+=1);a.isEventCreation&&(f.addEventCreationMessagesReceived+=1);a.isEventResponse&&(f.addEventResponseMessagesReceived+=1);break;case"msgRead":f.addMsgsRead+=a.readCount;break;case"groupStatusMsgReceive":f.addMsgsReceived+=1;a.isGroupStatusReplyOthersToOwn&&(f.addEventGroupStatusReplyOthersToOwn+=1);a.isGroupStatusReplyOthersToOthers&&(f.addEventGroupStatusReplyOthersToOthers+=1);a.isGroupStatusLikeOthersToOthers&&(f.addEventGroupStatusLikeOthersToOthers+=1);a.isGroupStatusLikeOthersToOwn&&(f.addEventGroupStatusLikeOthersToOwn+=1);break;case"groupStatusMsgSend":f.addMsgsSent+=1;a.isGroupStatusReplyOwnToOwn&&(f.addEventGroupStatusReplyOwnToOwn+=1);a.isGroupStatusReplyOwnToOthers&&(f.addEventGroupStatusReplyOwnToOthers+=1);break;case"viewOnceOpen":f.addViewOnceMsgsOpened+=1;break;case"voipCall":a.outgoing?f.addCallOffersSent+=1:f.addCallOffersReceived+=1;f.addTotalCallDuration+=a.durationInSeconds;break;default:d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Passed event store info type not valid: ",""])),a.activityType)}});yield this.$5()});function c(b){return a.apply(this,arguments)}return c}();e.$5=function(){this.$3.onOrBefore(this.$2*1e3)};e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=Array.from(this.$1.values());d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStoreImpl: flushing cache with "," updates"])),a.length).devConsole({updates:a});this.$1.clear();yield d("WAWebApiChatThreadLoggingPendingEvents").createOrUpdateChatEvents(a)});function c(){return a.apply(this,arguments)}return c}();e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebApiChat").bulkGetChats(a.map(function(a){return d("WAWebWidFactory").createWid(a.chatId)})),f=e.then(function(a){return v(a)}),g=e.then(function(a){return w(a)}),h=e.then(function(a){return x(a)}),i=e.then(function(a){return z(a)}),j=e.then(function(a){return A(a)});y=e.then(y);e=(yield (n||(n=b("Promise"))).all([e,f,g,h,y,i,j]));var k=e[0],l=e[1],o=e[2],p=e[3],q=e[4],r=e[5],s=e[6];f=(yield n.all([d("WAWebChatThreadLoggingUtils").getMeHasUsername(),d("WAWebChatThreadLoggingUtils").getMeHasUsernamePin()]));var t=f[0],u=f[1];g=a.length;h={chatRows:k.length,starredCounts:l.length,isABusiness:o.length,groupMetadataRows:p.length,groupParticipantsRows:q.length,businessProfileRows:r.length,contactFromChatRows:s.length};for(y of Object.entries(h)){i=y[0];j=y[1];j!==g&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingEventStore: Array length mismatch in "," (expected ",", got ",")"])),i,g,j).sendLogs("chatThreadLoggingEventStore-array-length-mismatch-"+i)}return n.all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f,g,h,i,j=k[b],m=c("WAWebWid").isGroup(a.chatId),n=p[b];e=d("WAWebBotTypes").BizBotAutomatedType.cast((e=r[b])==null?void 0:e.automatedType);f=m?{isAGroup:m,groupSize:(f=(f=q[b])==null||(f=f.participants)==null?void 0:f.length)!=null?f:1,groupType:n==null?d("WAWebGroupType").GroupType.DEFAULT:d("WAWebGroupType").getGroupTypeFromGroupMetadata(n)}:{isAGroup:m,isAContact:yield d("WAWebApiContact").isAddressBookContact(a.chatId),automatedType:e};m=d("WAWebWidFactory").createWid(a.chatId);e=((e=j==null?void 0:j.pin)!=null?e:0)>0;g=(g=j==null?void 0:j.archive)!=null?g:!1;var v=l[b];h=(h=j==null?void 0:j.unreadCount)!=null?h:0;i=((i=j==null?void 0:j.muteExpiration)!=null?i:0)!==0;var w=o[b]?yield d("WAWebChatThreadLoggingUtils").getBizCatalogType(m):null,x=c("WAWebWid").isStringLid(a.chatId)||(n==null?void 0:n.defaultSubgroup)===!0,y=d("WAWebUserPrefsMeUser").isMeAccount(m),z=m.isBot(),A=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeInitiatedByMe(j==null?void 0:j.disappearingModeInitiatedByMe),B=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeTrigger(j==null?void 0:j.disappearingModeTrigger);d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")&&c("WAWebWid").isGroup(j==null?void 0:j.id)&&(A=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeInitiatedByMe(n==null?void 0:n.disappearingModeInitiatedByMe),B=d("WAWebChatThreadLoggingUtils").getWamDisappearingModeTriggerGroups(n==null?void 0:n.disappearingModeTrigger));n=t;var C=u,D=null,E=!1;b=s[b];if(b!=null){var F=d("WAWebWidFactory").createWid(b.id);D=d("WAWebChatThreadLoggingUtils").getOppositeVisibleIdentificationType(b,F.isLid()?"lid":"pn");F=d("WAWebLidMigrationUtils").toPn(F)!=null;b=c("isStringNullOrEmpty")(b==null?void 0:b.username);E=!F&&b}F=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;m.isLid()&&(F=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA);if(j!=null&&j.lidOriginType)switch(j==null?void 0:j.lidOriginType){case d("WAWebUsernameTypes").LidOriginType.PNH_CTWA:F=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;break;case d("WAWebUsernameTypes").LidOriginType.GENERAL:F=d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;break}return babelHelpers["extends"]({},a,{isPinned:e,isArchived:g,contactInfo:f,messagesStarred:v,messagesUnread:h,isMuted:i,bizCatalogType:w,isPnhEnabledChat:x,isMessageYourself:y,isUserAgent:z,ephemeralityInitiator:A,ephemeralityTriggerAction:B,hasUsername:n,hasUsernamePin:C,oppositeVisibleIdentification:D,isUsernameThread:E,chatOrigins:F})});return function(b,c){return a.apply(this,arguments)}}()));function v(a){return(n||(n=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return a==null?0:(yield d("WAWebDBGetStarredMessagesForChat").getStarredMessagesForChat(d("WAWebWidFactory").createWid(a.id),Number.MAX_SAFE_INTEGER)).length});return function(b){return a.apply(this,arguments)}}()))}function w(a){return d("WAWebDBBulkGetIsContactABusiness").bulkGetIsContactABusiness(a.map(function(a){return a==null?null:d("WAWebWidFactory").createWid(a.id)}))}function x(a){return d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(a.map(function(a){return a==null?null:d("WAWebWidFactory").createWid(a.id)}))}function y(a){return d("WAWebSchemaParticipant").getParticipantTable().bulkGet(a.map(function(a){return a==null?"":d("WAWebWidFactory").createWid(a.id).toString()}))}function z(a){return d("WAWebSchemaBusinessProfile").getBusinessProfileTable().bulkGet(a.map(function(a){return a==null?"":d("WAWebWidFactory").createWid(a.id).toString()}))}function A(a){return c("WAWebLidAwareContactsDB").bulkGet(a.map(function(a){if(a==null)return"";a=d("WAWebWidFactory").createWid(a.id);if(!a.isRegularUser())return"";if(!a.isLid())return a.toJid();var b=d("WAWebApiContact").getPhoneNumber(a);return b==null?a.toJid():""}))}});function e(b){return a.apply(this,arguments)}return e}();e.getEvent=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){this.$1.size>0&&(yield this.$4());a=(yield d("WAWebApiChatThreadLoggingPendingEvents").getChatEvent(a,b));return a==null?null:(yield this.$6([a]))[0]});function c(b,c){return a.apply(this,arguments)}return c}();e.getBeforeInclusive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){this.$1.size>0&&(yield this.$4());return this.$6(yield d("WAWebApiChatThreadLoggingPendingEvents").getBeforeInclusive(a))});function c(b){return a.apply(this,arguments)}return c}();e.deleteBeforeInclusive=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){this.$1.size>0&&(yield this.$4());return d("WAWebApiChatThreadLoggingPendingEvents").deleteBeforeInclusive(a)});function c(b){return a.apply(this,arguments)}return c}();return a}();g.ChatThreadLoggingEventStoreImpl=a}),98);
__d("WAWebWamEnumAiChatOriginsType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,AI_HOME:1,AI_TAB_TEXT:2,AI_TAB_VOICE:3});f.AI_CHAT_ORIGINS_TYPE=a}),66);
__d("WAWebWamEnumBizCatalogType",[],(function(a,b,c,d,e,f){a=Object.freeze({SHOPS:0,NATIVE:1});f.BIZ_CATALOG_TYPE=a}),66);
__d("WAWebWamEnumBlockReason",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,NO_LONGER_NEEDED:1,NO_SIGN_UP:2,SPAM:3,OFFENSIVE_MESSAGES:4,OTP_DID_NOT_REQUEST:5});f.BLOCK_REASON=a}),66);
__d("WAWebWamEnumChatMutedType",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_MUTED:1,MUTED_NO_NOTIFICATIONS:2,MUTED_SILENT_NOTIFICATIONS:3});f.CHAT_MUTED_TYPE=a}),66);
__d("WAWebWamEnumChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:1,SMB:2,ENT:3,INTEROP:4,UNKNOWN:5,BUSINESS:6});f.CHAT_TYPE=a}),66);
__d("WAWebWamEnumDisappearingChatInitiatorType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT:1,INITIATED_BY_ME:2,INITIATED_BY_OTHER:3,CHAT_PICKER:4,BIZ_UPGRADE_FB_HOSTING:5});f.DISAPPEARING_CHAT_INITIATOR_TYPE=a}),66);
__d("WAWebWamEnumEphemeralityInitiatorType",[],(function(a,b,c,d,e,f){a=Object.freeze({INITIATED_BY_ME:1,INITIATED_BY_OTHER:2,BIZ_UPGRADE_FB_HOSTING:3});f.EPHEMERALITY_INITIATOR_TYPE=a}),66);
__d("WAWebWamEnumEphemeralityTriggerActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,CHAT_SETTINGS:1,ACCOUNT_SETTINGS:2,BULK_CHANGE:3,BIZ_SUPPORTS_FB_HOSTING:4,UNKNOWN_GROUP:5});f.EPHEMERALITY_TRIGGER_ACTION_TYPE=a}),66);
__d("WAWebWamEnumGaStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NEW:0,RETAINED:1,RESURRECTED:2});f.GA_STATUS=a}),66);
__d("WAWebWamEnumGroupInfoSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({ADMINS_ONLY:1,ALL_PARTICIPANTS:2});f.GROUP_INFO_SETTING_TYPE=a}),66);
__d("WAWebWamEnumOppositeVisibleIdentificationType",[],(function(a,b,c,d,e,f){a=Object.freeze({PHONE_NUMBER:1,SAVED_CONTACT_NAME:2,USERNAME:3,MASKED_PHONE_NUMBER:4,VERIFIED_BUSINESS_NAME:5,PLACEHOLDER:6,PUSHNAME:7});f.OPPOSITE_VISIBLE_IDENTIFICATION_TYPE=a}),66);
__d("WAWebChatMessageCountsWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAiChatOriginsType","WAWebWamEnumBizCatalogType","WAWebWamEnumBlockReason","WAWebWamEnumChatMutedType","WAWebWamEnumChatOriginsType","WAWebWamEnumChatType","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumGaStatus","WAWebWamEnumGroupInfoSettingType","WAWebWamEnumOppositeVisibleIdentificationType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ChatMessageCounts:[1644,{aiChatOrigins:[224,d("WAWebWamEnumAiChatOriginsType").AI_CHAT_ORIGINS_TYPE],aiDiscoveryTab:[195,a.TYPES.STRING],aptTestId:[212,a.TYPES.STRING],audioMessagesReceived:[149,a.TYPES.INTEGER],audioMessagesSent:[150,a.TYPES.INTEGER],autoReplyFromIcebreakerSent:[190,a.TYPES.INTEGER],awayMsgsSent:[56,a.TYPES.INTEGER],bizCatalogType:[60,d("WAWebWamEnumBizCatalogType").BIZ_CATALOG_TYPE],bizConversationDepth:[65,a.TYPES.INTEGER],blockReason:[33,d("WAWebWamEnumBlockReason").BLOCK_REASON],bottomSheetAnimatedSent:[206,a.TYPES.INTEGER],bottomSheetEditedAnimatedSent:[207,a.TYPES.INTEGER],bottomSheetEditedSent:[208,a.TYPES.INTEGER],bottomSheetForwardMessagesSent:[196,a.TYPES.INTEGER],bottomSheetImagesEdited:[209,a.TYPES.INTEGER],bottomSheetImagesGenerated:[197,a.TYPES.INTEGER],bottomSheetMemuImagesGenerated:[220,a.TYPES.INTEGER],bottomSheetMemuInitiated:[221,a.TYPES.INTEGER],bottomSheetMemuMessagesSent:[222,a.TYPES.INTEGER],bottomSheetMessagesDownloaded:[198,a.TYPES.INTEGER],bottomSheetMessagesReceived:[199,a.TYPES.INTEGER],bottomSheetMessagesSent:[200,a.TYPES.INTEGER],bottomSheetPromptsInitiated:[201,a.TYPES.INTEGER],bottomSheetRegeneratedSent:[210,a.TYPES.INTEGER],broadcastMsgsReceived:[30,a.TYPES.INTEGER],broadcastMsgsSent:[29,a.TYPES.INTEGER],callOffersReceived:[27,a.TYPES.INTEGER],callOffersSent:[26,a.TYPES.INTEGER],callsResultBusy:[70,a.TYPES.INTEGER],callsResultCancelled:[71,a.TYPES.INTEGER],callsResultConnected:[72,a.TYPES.INTEGER],callsResultError:[78,a.TYPES.INTEGER],callsResultMissed:[73,a.TYPES.INTEGER],callsResultRejected:[74,a.TYPES.INTEGER],canEditDmSettings:[88,a.TYPES.BOOLEAN],cartViews:[86,a.TYPES.INTEGER],chatEphemeralityDuration:[15,a.TYPES.INTEGER],chatMuted:[8,d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE],chatOrigins:[179,d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE],chatOverflowClicks:[79,a.TYPES.INTEGER],chatTypeInd:[2,d("WAWebWamEnumChatType").CHAT_TYPE],collectionInquiriesSent:[44,a.TYPES.INTEGER],commandSheetShow:[174,a.TYPES.INTEGER],commentsReceived:[126,a.TYPES.INTEGER],commerceMsgsReceived:[41,a.TYPES.INTEGER],commerceMsgsSent:[40,a.TYPES.INTEGER],deviceLanguage:[219,a.TYPES.STRING],disappearingChatInitiator:[59,d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],documentMessagesReceived:[151,a.TYPES.INTEGER],documentMessagesSent:[152,a.TYPES.INTEGER],editedMsgsSent:[100,a.TYPES.INTEGER],emuFlashPlaybacks:[184,a.TYPES.INTEGER],emuFlashPreviewShow:[182,a.TYPES.INTEGER],emuFlashSent:[183,a.TYPES.INTEGER],entryPointConversionApp:[47,a.TYPES.STRING],entryPointConversionSource:[46,a.TYPES.STRING],ephemeralMessagesExpired:[248,a.TYPES.INTEGER],ephemeralMessagesReceived:[14,a.TYPES.INTEGER],ephemeralMessagesSent:[13,a.TYPES.INTEGER],ephemeralMessagesUnreadExpired:[69,a.TYPES.INTEGER],ephemeralityInitiator:[109,d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[110,d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],eventCreationMessagesReceived:[142,a.TYPES.INTEGER],eventCreationMessagesSent:[143,a.TYPES.INTEGER],eventResponseMessagesReceived:[144,a.TYPES.INTEGER],eventResponseMessagesSent:[145,a.TYPES.INTEGER],fbCtaInquiriesSent:[45,a.TYPES.INTEGER],firstResponseTime:[25,a.TYPES.INTEGER],fmxNotMvBottomSheetDismissedCount:[234,a.TYPES.INTEGER],fmxNotMvBottomSheetGetMvButtonClicks:[235,a.TYPES.INTEGER],fmxNotMvBottomSheetGetMvButtonImpressions:[236,a.TYPES.INTEGER],fmxNotMvBottomSheetImpressions:[237,a.TYPES.INTEGER],fmxNotMvBottomSheetLearnMoreButtonClicks:[238,a.TYPES.INTEGER],fmxNotMvClicks:[229,a.TYPES.INTEGER],forwardAudioMessagesReceived:[153,a.TYPES.INTEGER],forwardAudioMessagesSent:[154,a.TYPES.INTEGER],forwardDocumentMessagesReceived:[155,a.TYPES.INTEGER],forwardDocumentMessagesSent:[156,a.TYPES.INTEGER],forwardGifMessagesReceived:[157,a.TYPES.INTEGER],forwardGifMessagesSent:[158,a.TYPES.INTEGER],forwardMessagesReceived:[89,a.TYPES.INTEGER],forwardMessagesSent:[90,a.TYPES.INTEGER],forwardPhotoMessagesReceived:[128,a.TYPES.INTEGER],forwardPhotoMessagesSent:[129,a.TYPES.INTEGER],forwardPtvMessagesReceived:[159,a.TYPES.INTEGER],forwardPtvMessagesSent:[160,a.TYPES.INTEGER],forwardStatusReplyMessagesReceived:[161,a.TYPES.INTEGER],forwardStatusReplyMessagesSent:[162,a.TYPES.INTEGER],forwardStickerMessagesReceived:[163,a.TYPES.INTEGER],forwardStickerMessagesSent:[164,a.TYPES.INTEGER],forwardTextMessagesReceived:[130,a.TYPES.INTEGER],forwardTextMessagesSent:[131,a.TYPES.INTEGER],forwardUrlMessagesReceived:[132,a.TYPES.INTEGER],forwardUrlMessagesSent:[133,a.TYPES.INTEGER],forwardVideoMessagesReceived:[165,a.TYPES.INTEGER],forwardVideoMessagesSent:[166,a.TYPES.INTEGER],gaStatus:[22,d("WAWebWamEnumGaStatus").GA_STATUS],gifMessagesReceived:[167,a.TYPES.INTEGER],gifMessagesSent:[168,a.TYPES.INTEGER],googleSearchClick:[214,a.TYPES.INTEGER],googleSearchShow:[215,a.TYPES.INTEGER],greetingMsgsSent:[57,a.TYPES.INTEGER],groupContainsBiz:[75,a.TYPES.BOOLEAN],groupInfoSetting:[87,d("WAWebWamEnumGroupInfoSettingType").GROUP_INFO_SETTING_TYPE],groupLimitSharingOnCnt:[225,a.TYPES.INTEGER],groupMembershipReplies:[51,a.TYPES.INTEGER],groupPrivateReplies:[52,a.TYPES.INTEGER],groupSize:[19,a.TYPES.INTEGER],groupStatusLikesOthersToOthers:[249,a.TYPES.INTEGER],groupStatusLikesOthersToOwn:[250,a.TYPES.INTEGER],groupStatusLikesOwnToOthers:[251,a.TYPES.INTEGER],groupStatusLikesOwnToOwn:[252,a.TYPES.INTEGER],groupStatusRepliesOthersToOthers:[253,a.TYPES.INTEGER],groupStatusRepliesOthersToOwn:[254,a.TYPES.INTEGER],groupStatusRepliesOwnToOthers:[255,a.TYPES.INTEGER],groupStatusRepliesOwnToOwn:[256,a.TYPES.INTEGER],hasReplied1On1:[216,a.TYPES.BOOLEAN],hasUsername:[180,a.TYPES.BOOLEAN],hasUsernamePin:[228,a.TYPES.BOOLEAN],imagineCommandClick:[175,a.TYPES.INTEGER],imagineMeMessagesSent:[202,a.TYPES.INTEGER],imagineMePromptsInitiatedCount:[203,a.TYPES.INTEGER],imagineMentionClick:[146,a.TYPES.INTEGER],imagineMentionShow:[176,a.TYPES.INTEGER],isAContact:[6,a.TYPES.BOOLEAN],isAContactAtThreadCreation:[213,a.TYPES.BOOLEAN],isAGroup:[5,a.TYPES.BOOLEAN],isArchived:[10,a.TYPES.BOOLEAN],isAutoMuted:[108,a.TYPES.BOOLEAN],isBizMvFrictionEligible:[230,a.TYPES.BOOLEAN],isBlocked:[32,a.TYPES.BOOLEAN],isCartAddClicked:[36,a.TYPES.BOOLEAN],isCommerceViewed:[35,a.TYPES.BOOLEAN],isCtaOnPdpClicked:[37,a.TYPES.BOOLEAN],isDeleted:[185,a.TYPES.BOOLEAN],isGuestThread:[257,a.TYPES.BOOLEAN],isInviteCreatedThread:[106,a.TYPES.BOOLEAN],isLabelled:[54,a.TYPES.BOOLEAN],isMessageYourself:[91,a.TYPES.BOOLEAN],isMetaAiAssistant:[211,a.TYPES.BOOLEAN],isOppositePartyInitiated:[62,a.TYPES.BOOLEAN],isPinned:[9,a.TYPES.BOOLEAN],isPnhEnabledChat:[92,a.TYPES.BOOLEAN],isReported:[186,a.TYPES.BOOLEAN],isUser1pBizBotChat:[141,a.TYPES.BOOLEAN],isUser3pBotChat:[140,a.TYPES.BOOLEAN],isUserAgent:[111,a.TYPES.BOOLEAN],isUserCreatedAgent:[123,a.TYPES.BOOLEAN],isUsernameThread:[258,a.TYPES.BOOLEAN],isUsernameThreadAtCreation:[259,a.TYPES.BOOLEAN],isWaPayRegistered:[81,a.TYPES.BOOLEAN],labelledMsgs:[55,a.TYPES.INTEGER],limitSharingOption:[226,a.TYPES.BOOLEAN],locationsSent:[96,a.TYPES.INTEGER],markedReadCnt:[193,a.TYPES.INTEGER],markedReadMessageCnt:[194,a.TYPES.INTEGER],matchedMessagesMarkedAsReadWithDeltaTime:[246,a.TYPES.STRING],matchedMessagesReadWithDeltaTime:[247,a.TYPES.STRING],messagesRead:[127,a.TYPES.INTEGER],messagesReceived:[4,a.TYPES.INTEGER],messagesReceivedWithEnabledReadReceipt:[245,a.TYPES.INTEGER],messagesSent:[3,a.TYPES.INTEGER],messagesStarred:[12,a.TYPES.INTEGER],messagesUnread:[11,a.TYPES.INTEGER],metaAiMentionClick:[147,a.TYPES.INTEGER],metaAiMentionShow:[148,a.TYPES.INTEGER],newThread:[68,a.TYPES.BOOLEAN],notMvImpressions:[231,a.TYPES.INTEGER],odReceived:[82,a.TYPES.INTEGER],oppositePartyHasBadge:[240,a.TYPES.BOOLEAN],oppositePartyHasBusinessIntent:[204,a.TYPES.BOOLEAN],oppositePartyHasProfilePhoto:[217,a.TYPES.BOOLEAN],oppositePartyLimitSharingOption:[227,a.TYPES.BOOLEAN],oppositeVisibleIdentification:[181,d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE],ordersSent:[38,a.TYPES.INTEGER],p2mOdNnpTransactionsSent:[83,a.TYPES.INTEGER],p2mOdNpTransactionsSent:[84,a.TYPES.INTEGER],paymentsSent:[39,a.TYPES.INTEGER],pdpInquiriesSent:[42,a.TYPES.INTEGER],pdpViews:[61,a.TYPES.INTEGER],photoMessagesReceived:[134,a.TYPES.INTEGER],photoMessagesSent:[135,a.TYPES.INTEGER],pollCreationMessagesReceived:[115,a.TYPES.INTEGER],pollCreationMessagesSent:[116,a.TYPES.INTEGER],pollUpdateMessagesReceived:[117,a.TYPES.INTEGER],pollUpdateMessagesSent:[118,a.TYPES.INTEGER],profileReplies:[64,a.TYPES.INTEGER],profileViews:[63,a.TYPES.INTEGER],pttMessagesReceived:[119,a.TYPES.INTEGER],pttMessagesSent:[120,a.TYPES.INTEGER],ptvMessagesReceived:[121,a.TYPES.INTEGER],ptvMessagesSent:[122,a.TYPES.INTEGER],quickRepliesSent:[58,a.TYPES.INTEGER],reactionsReceived:[97,a.TYPES.INTEGER],reactionsSent:[98,a.TYPES.INTEGER],receiverDefaultDisappearingDuration:[21,a.TYPES.INTEGER],repliesSent:[80,a.TYPES.INTEGER],requestedPhoneNumber:[93,a.TYPES.BOOLEAN],seenMaskedPhoneNumber:[94,a.TYPES.BOOLEAN],senderDefaultDisappearingDuration:[20,a.TYPES.INTEGER],sharedPhoneNumber:[99,a.TYPES.BOOLEAN],sharesCommonGroup:[218,a.TYPES.BOOLEAN],smbMarketingMessagesReactionsSent:[101,a.TYPES.INTEGER],smbMarketingMessagesRepliesSent:[102,a.TYPES.INTEGER],smbMarketingMessagesSpamReports:[103,a.TYPES.INTEGER],smbMarketingMsgsReceived:[104,a.TYPES.INTEGER],smbMarketingMsgsSent:[105,a.TYPES.INTEGER],spamReports:[31,a.TYPES.INTEGER],startTime:[7,a.TYPES.INTEGER],statusReactionsReceived:[191,a.TYPES.INTEGER],statusReactionsSent:[192,a.TYPES.INTEGER],statusReplies:[50,a.TYPES.INTEGER],statusReplyMessagesReceived:[169,a.TYPES.INTEGER],statusViews:[49,a.TYPES.INTEGER],stickerMessagesReceived:[170,a.TYPES.INTEGER],stickerMessagesSent:[171,a.TYPES.INTEGER],storefrontInquiriesSent:[43,a.TYPES.INTEGER],suggestionPromptsClick:[177,a.TYPES.INTEGER],suggestionPromptsShow:[178,a.TYPES.INTEGER],textMessagesReceived:[136,a.TYPES.INTEGER],textMessagesSent:[137,a.TYPES.INTEGER],textMessagesToUserCreatedAgentCnt:[124,a.TYPES.INTEGER],threadCreationDate:[189,a.TYPES.STRING],threadDs:[66,a.TYPES.STRING],threadId:[67,a.TYPES.STRING],threadIdMonthly:[223,a.TYPES.STRING],totalCallDuration:[28,a.TYPES.INTEGER],totalMessageEditsFromAgentCnt:[112,a.TYPES.INTEGER],totalMessageFromAgentCnt:[113,a.TYPES.INTEGER],totalMessageToAgentCnt:[114,a.TYPES.INTEGER],totalMessagesToUserCreatedAgentCnt:[125,a.TYPES.INTEGER],typeOfGroup:[85,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],urlMessagesReceived:[138,a.TYPES.INTEGER],urlMessagesSent:[139,a.TYPES.INTEGER],userHasBusinessIntent:[205,a.TYPES.BOOLEAN],viaContactlessChats:[107,a.TYPES.BOOLEAN],videoCallsOffered:[76,a.TYPES.INTEGER],videoMessagesReceived:[172,a.TYPES.INTEGER],videoMessagesSent:[173,a.TYPES.INTEGER],viewOnceMessagesOpened:[18,a.TYPES.INTEGER],viewOnceMessagesReceived:[17,a.TYPES.INTEGER],viewOnceMessagesSent:[16,a.TYPES.INTEGER],voiceCallsOffered:[77,a.TYPES.INTEGER]},[1,1,1],"regular"]},{ChatMessageCounts:[]});g.ChatMessageCountsWamEvent=b}),98);
__d("WAWebChatThreadLoggingEventUploader",["Promise","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebBotGating","WAWebBotTypes","WAWebChatMessageCountsWamEvent","WAWebChatThreadLoggingBoolFlagFields","WAWebChatThreadLoggingCountFields","WAWebChatThreadLoggingUtils","WAWebGroupType","WAWebWamEnumChatMutedType","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;a=function(){function a(a,b){this.eventStore=b,this.metadataStore=a}var e=a.prototype;e.uploadEvents=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e,f=this;e=(e=a==null?void 0:a.purgeAfter)!=null?e:!0;var g=(yield this.metadataStore.getOffset());if(g==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingBatchEventUploader: offset not in store!"])));return-1}a=(a=a==null?void 0:a.lastStartTs)!=null?a:d("WAWebChatThreadLoggingUtils").computeStartTs(g,d("WATimeUtils").unixTime()-d("WATimeUtils").DAY_SECONDS);if(this.secret==null){g=(yield this.metadataStore.getSecret());if(g==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ChatThreadLoggingBatchEventUploader: secret not in store!"])));return-1}this.secret=g}g=(yield this.eventStore.getBeforeInclusive(a));try{yield (l||(l=b("Promise"))).all(g.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebChatThreadLoggingUtils").getThreadDs(a.startTs),e=a.contactInfo,g=new(d("WAWebChatMessageCountsWamEvent").ChatMessageCountsWamEvent)({messagesSent:a.msgsSent,messagesReceived:a.msgsReceived,commentsReceived:a.commentsReceived,viewOnceMessagesSent:a.viewOnceMsgsSent,viewOnceMessagesReceived:a.viewOnceMsgsReceived,viewOnceMessagesOpened:a.viewOnceMessagesOpened,threadDs:b,threadId:yield d("WAWebChatThreadLoggingUtils").generateThreadID(c("WANullthrows")(f.secret),a.chatId,b),isAGroup:a.contactInfo.isAGroup,groupSize:e.isAGroup?e.groupSize:void 0,isAContact:e.isAGroup?void 0:e.isAContact,isArchived:a.isArchived,isPinned:a.isPinned,messagesStarred:a.messagesStarred,messagesRead:a.msgsRead,messagesUnread:a.messagesUnread,chatMuted:a.isMuted?d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE.MUTED_NO_NOTIFICATIONS:d("WAWebWamEnumChatMutedType").CHAT_MUTED_TYPE.NOT_MUTED,callOffersSent:a.callOffersSent,callOffersReceived:a.callOffersReceived,totalCallDuration:a.totalCallDuration,typeOfGroup:a.contactInfo.groupType!=null?d("WAWebGroupType").groupTypeToWamEnum(a.contactInfo.groupType):void 0,isPnhEnabledChat:a.isPnhEnabledChat,reactionsSent:a.reactionsSent,reactionsReceived:a.reactionsReceived,isMessageYourself:a.isMessageYourself,forwardMessagesSent:a.forwardMessagesSent,forwardMessagesReceived:a.forwardMessagesReceived,editedMsgsSent:a.editedMsgsSent,totalMessageToAgentCnt:a.botMessagesSent,totalMessageFromAgentCnt:a.botMessagesReceived,totalMessageEditsFromAgentCnt:a.botMessagesEdited,isUserAgent:a.isUserAgent,hasUsername:a.hasUsername,hasUsernamePin:a.hasUsernamePin,oppositeVisibleIdentification:a.oppositeVisibleIdentification!=null?a.oppositeVisibleIdentification:void 0,isUsernameThread:a.isUsernameThread,chatOrigins:a.chatOrigins!=null?a.chatOrigins:void 0,eventCreationMessagesReceived:a.eventCreationMessagesReceived,eventCreationMessagesSent:a.eventCreationMessagesSent,eventResponseMessagesReceived:a.eventResponseMessagesReceived,eventResponseMessagesSent:a.eventResponseMessagesSent});c("justknobx")._("2641")&&d("WAWebABProps").getABPropConfigValue("group_status_receiver_enabled")&&(g.groupStatusLikesOthersToOthers=a.eventGroupStatusLikeOthersToOthers,g.groupStatusLikesOthersToOwn=a.eventGroupStatusLikeOthersToOwn,g.groupStatusRepliesOthersToOthers=a.eventGroupStatusReplyOthersToOthers,g.groupStatusRepliesOthersToOwn=a.eventGroupStatusReplyOthersToOwn,g.groupStatusRepliesOwnToOthers=a.eventGroupStatusReplyOwnToOthers,g.groupStatusRepliesOwnToOwn=a.eventGroupStatusReplyOwnToOwn);d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")&&(a.ephemeralityTriggerAction!=null&&(g.ephemeralityTriggerAction=a.ephemeralityTriggerAction),a.ephemeralityInitiator!=null&&(g.ephemeralityInitiator=a.ephemeralityInitiator));d("WAWebChatThreadLoggingCountFields").COUNT_FIELD_NAMES.forEach(function(b){g[b]=a[b]});d("WAWebChatThreadLoggingBoolFlagFields").FLAG_FIELD_NAMES.forEach(function(b){g[b]=a[b]});e.isAGroup||(d("WAWebBotGating").isBizBot3pEnabled()&&(g.isUser3pBotChat=e.automatedType===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P),d("WAWebBotGating").isBizBot1pEnabled()&&(g.isUser1pBizBotChat=e.automatedType===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P));g.commit()});return function(b){return a.apply(this,arguments)}}()))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["chat_thread_logging: error uploading events: ",""])),a.toString()).sendLogs("thread-logging-upload-failure")}if(e){e=(yield this.eventStore.deleteBeforeInclusive(a));e!==g.length&&d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["uploadEvents: uploaded "," events but only deleted "," (they should be the same!)"])),g.length,e)}yield this.metadataStore.setLastUploadedStartTs(a);return g.length});function e(b){return a.apply(this,arguments)}return e}();return a}();g.ChatThreadLoggingEventUploaderImpl=a}),98);
__d("WAWebBusinessProfileTypes",["$InternalEnum"],(function(a,b,c,d,e,f){var g={UNKNOWN:0,LOW:1,HIGH:2};function a(a){if(a==null)return;switch(a){case"unknown":return g.UNKNOWN;case"low":return g.LOW;case"high":return g.HIGH;default:return g.UNKNOWN}}d=["sun","mon","tue","wed","thu","fri","sat"];e={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"};b=b("$InternalEnum")({CATALOG:"catalog",NONE:"none",SHOP:"shop",META_CATALOG:"smb_meta_catalog"});function c(a){return a==="sun"||a==="mon"||a==="tue"||a==="wed"||a==="thu"||a==="fri"||a==="sat"}var h={limitedLiabilityPartnership:"Limited liability partnership",soleProprietorship:"Sole proprietorship",partnership:"Partnership",publicCompany:"Public Company",privateCompany:"Private Company",other:"Other"},i={WEBSITE:256,DESCRIPTION:512,EMAIL:128,ADDRESS:256};f.VERIFIED_LEVEL=g;f.convertLevel=a;f.DAYS_OF_WEEK=d;f.BUSINESS_HOUR_MODES=e;f.CommerceExperienceTypes=b;f.isBusinessHoursDayName=c;f.businessTypeOptions=h;f.BUSINESS_PROFILE_FIELDS_LENGTH=i}),66);
__d("WAWebEphemeralityTypes",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ChangedInChat:"chat",InitiatedByMe:"me",InitiatedByOther:"other",BizUpgradeFbHosting:"biz_upgrade_fb_hosting"});c=b("$InternalEnum")({Unknown:"unknown",ChatSettings:"chat_settings",AccountSettings:"account_settings",BulkChange:"bulk_change",BizSupportFbHosting:"biz_supports_fb_hosting",UnknownGroups:"unknown_groups"});f.DisappearingModeInitiator=a;f.DisappearingModeTrigger=c}),66);
__d("WAWebChatThreadLoggingUtils",["WABase64","WACryptoHmac","WAJids","WALogger","WATimeUtils","WAWebApiContact","WAWebApiParse","WAWebBusinessProfileTypes","WAWebEphemeralityTypes","WAWebInteractiveMessagesNativeFlowName","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebMsgType","WAWebQueryBusinessProfile","WAWebUserPrefsMeUser","WAWebWamEnumChatOriginsType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumOppositeVisibleIdentificationType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k=new TextEncoder(),l=function(a){return k.encode(a).buffer};function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WACryptoHmac").hmacSha256(a,b));return d("WABase64").encodeB64(a)});return n.apply(this,arguments)}function a(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=l(b+c);return m(a,b)});return o.apply(this,arguments)}function e(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=l(b);return m(a,b)});return p.apply(this,arguments)}function f(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=l(b);return m(a,b)});return q.apply(this,arguments)}function r(a){return d("WATimeUtils").toDate(d("WATimeUtils").castToUnixTime(a-8*d("WATimeUtils").HOUR_SECONDS)).toISOString().split("T")[0].replace(/-/g,"/")}function s(a,b){var c=b%d("WATimeUtils").DAY_SECONDS;b=b-c;return c>=a?b+a:b-d("WATimeUtils").DAY_SECONDS+a}function t(a,b,c){return s(a,b)>c}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;try{b=(yield d("WAWebQueryBusinessProfile").queryBusinessProfile([{wid:a}]))}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(['Thread Logging: Failed to query business profile to set "biz_catalog_type"']))).verbose().devConsole(a).sendLogs("query-business-profile-fail");return null}a=b[0];if(!a)return null;a=(a=a.profile)==null||(a=a.profile_options)==null?void 0:a.commerce_experience;if(a===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.CATALOG)return"native";else if(a===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.SHOP)return"shop";return null});return v.apply(this,arguments)}function w(a){return a.type!==d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT}function x(a){var b=new Set([d("WAWebMsgType").MSG_TYPE.PRODUCT,d("WAWebMsgType").MSG_TYPE.ORDER,d("WAWebMsgType").MSG_TYPE.LIST]);return b.has(a.type)||b.has((b=a.quotedMsg)==null?void 0:b.type)||!!(a.matchedText!=null&&a.matchedText!==""&&y(a.matchedText))||a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW&&(a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||a.nativeFlowName===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS)}function y(a){return d("WAWebApiParse").matchCatalogUrl(a)||d("WAWebApiParse").matchProductUrl(a)}function z(a){if(a==null)return null;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;default:return null}}function A(a){if(a==null)return null;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;default:return null}}function B(a){if(a==null)return null;return a?d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_ME:d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_OTHER}function C(){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();a=(yield c("WAWebLidAwareContactsDB").get(a.toJid()));return(a==null?void 0:a.username)!=null&&a.username!==""});return D.apply(this,arguments)}function E(){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();a=(yield c("WAWebLidAwareContactsDB").get(a.toJid()));return(a==null?void 0:a.usernameKey)!=null});return F.apply(this,arguments)}function G(a){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return L(a)?null:d("WAWebModelStorageUtils").getStorage().lock(["contact"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b,e;if(a.isLid()){var f=d("WAWebApiContact").getPhoneNumber(a);f==null?(b=a.toString(),e="lid"):(b=d("WAJids").toPhoneUserJid(f.user),e="pn")}else b=d("WAJids").toPhoneUserJid(a.user),e="pn";f=(yield c("WAWebLidAwareContactsDB").get(b));if(f==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getOppositeVisibleIdentificationType: could not find contact with id ",""])),a);return null}return I(f,e)}))});return H.apply(this,arguments)}function I(a,b){if(a==null)return d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PLACEHOLDER;var c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.MASKED_PHONE_NUMBER;a==null?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PLACEHOLDER:a.isAddressBookContact?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.SAVED_CONTACT_NAME:a.verifiedName?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.VERIFIED_BUSINESS_NAME:b==="pn"?c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.PHONE_NUMBER:a.username!=null&&a.username!==""&&(c=d("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE.USERNAME);return c}function J(a){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return L(a)?null:d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=a.toString();b=(yield b.get(c));if(b==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getChatOriginType: could not find chat with id ",""])),c);return}switch(b.lidOriginType){case"ctwa":return d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;default:return d("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS}});return function(a){return c.apply(this,arguments)}}())});return K.apply(this,arguments)}function L(a){return!a.isUser()||a.isPSA()||a.isBot()}g.generateThreadID=a;g.generateThreadIDHMAC=e;g.generateMessageIDHMAC=f;g.getThreadDs=r;g.computeStartTs=s;g.shouldUpdateChatEvent=t;g.getBizCatalogType=u;g.shouldIncrementMsgSendAndReceive=w;g.isCommerceMessage=x;g.getWamDisappearingModeTrigger=z;g.getWamDisappearingModeTriggerGroups=A;g.getWamDisappearingModeInitiatedByMe=B;g.getMeHasUsername=C;g.getMeHasUsernamePin=E;g.getOppositeVisibleIdentification=G;g.getOppositeVisibleIdentificationType=I;g.getChatOriginType=J}),98);
__d("WAWebDBMarkAsReadForTable",["WAWebModelStorageUtils","WAWebMsgKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,e){return d("WAWebModelStorageUtils").getStorage().lock([a],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.anyOf(["msgKey"],e));b.length!==0&&(yield a.bulkCreateOrReplace(b.map(function(a){return babelHelpers["extends"]({},a,{read:!0})})));return b.map(function(a){a=a.msgKey;return c("WAWebMsgKey").from(a)})});return function(b){return a.apply(this,arguments)}}())}g.markAsReadForTable=a}),98);
__d("WAWebDBUpdateAddOnAcksForTable",["WANullthrows","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,e,f){return d("WAWebModelStorageUtils").getStorage().lock([a],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=[],d=new Map();for(var g of e){var h=g.msgKey.toString();b.push(h);d.set(g.msgKey.toString(),g)}h=(yield a.anyOf(["msgKey"],b,{shouldDecrypt:!1}));g=[];b=[];for(h of h){var i=c("WANullthrows")(d.get(h.msgKey));if(!f(h,i))continue;var j=babelHelpers["extends"]({},h,{ack:i.ack});g.push(j);b.push(i)}yield a.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(g);return b});return function(b){return a.apply(this,arguments)}}())}g.updateAddOnAcksForTable=a}),98);
__d("WAWebMessageAddOnType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Reaction:"reaction",ReactionEnc:"reaction_enc",PollVote:"poll_vote",KeepInChat:"keep_in_chat",MessageEdit:"message_edit",PinMessage:"pin_message",Comment:"comment",Unknown:"unknown"});f.MessageAddOnType=a}),66);
__d("WAWebDBCommentAddOnProvider",["Promise","WAWebDBMarkAsReadForTable","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a={type:d("WAWebMessageAddOnType").MessageAddOnType.Comment,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.COMMENT},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.COMMENT},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){return(h||(h=b("Promise"))).resolve()});function c(b,c){return a.apply(this,arguments)}return c}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("comments",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("comments",a.map(String))}};g.commentsAddOnProvider=a}),98);
__d("WAWebDBReactionsAddOnProvider",["WAWebDBMarkAsReadForTable","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.Reaction,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.REACTION},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw c("err")("Reactions not yet integrated into orphan framework")});function d(){return a.apply(this,arguments)}return d}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("reactions",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("reactions",a.map(String))}};g.reactionsAddOnProvider=a}),98);
__d("WAWebDBReactionsEncAddOnProvider",["WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.ReactionEnc,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){throw c("err")("Reactions provider is deprecated")});function d(){return a.apply(this,arguments)}return d}()};g.reactionsEncAddOnProvider=a}),98);
__d("WAWebDBAddOnProviders",["WAWebDBCommentAddOnProvider","WAWebDBKeepInChatAddOnProvider","WAWebDBMessageEditAddOnProvider","WAWebDBPinInChatAddOnProvider","WAWebDBPollVotesAddOnProvider","WAWebDBReactionsAddOnProvider","WAWebDBReactionsEncAddOnProvider"],(function(a,b,c,d,e,f,g){var h=[d("WAWebDBPollVotesAddOnProvider").pollVotesAddOnProvider,d("WAWebDBKeepInChatAddOnProvider").keepInChatAddOnProvider,d("WAWebDBReactionsAddOnProvider").reactionsAddOnProvider,d("WAWebDBReactionsEncAddOnProvider").reactionsEncAddOnProvider,d("WAWebDBMessageEditAddOnProvider").messageEditAddOnProvider,d("WAWebDBPinInChatAddOnProvider").pinInChatAddOnProvider,d("WAWebDBCommentAddOnProvider").commentsAddOnProvider];function a(a){var b;return(b=h.find(function(b){return b.type===a}))!=null?b:null}function b(a){return h.find(function(b){return b.matches(a)})}function c(a){return h.find(function(b){return b.matchesFutureproof(a)})}g.addOnProviders=h;g.getProviderForAddOnType=a;g.getAddOnProviderForMsg=b;g.getAddOnProviderForFutureproofMsg=c}),98);
__d("WAWebMsgDataFromModel",[],(function(a,b,c,d,e,f){function g(a){a=a.toJSON();return babelHelpers["extends"]({},a,{paymentNoteMsg:a.paymentNoteMsg?g(a.paymentNoteMsg):void 0})}f.msgDataFromMsgModel=g}),66);
__d("WAWebDBKeepInChatAddOnProvider",["WALogger","WAWebBackendApi","WAWebEphemeralKeepInChatUtils","WAWebMessageAddOnType","WAWebMsgDataFromModel","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a={type:d("WAWebMessageAddOnType").MessageAddOnType.KeepInChat,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=b.map(function(a){return a.parsedMsgPayload});b=d("WAWebEphemeralKeepInChatUtils").runKeepInChatTieBreaker(a);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["keepInChatAddOnProvider: found orphan"]))).devConsole({winningOrphanMsg:b});if(b!=null){a=d("WAWebMsgDataFromModel").msgDataFromMsgModel(b);yield d("WAWebBackendApi").frontendSendAndReceive("processKeepInChatMessage",{keepInChatMessage:a,allowNotification:!1})}});function c(b,c){return a.apply(this,arguments)}return c}()};g.keepInChatAddOnProvider=a}),98);
__d("WAWebMessageEditGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("message_edit_receive")||h()}function h(){return d("WAWebABProps").getABPropConfigValue("message_edit_send")}function b(){return d("WAWebABProps").getABPropConfigValue("caption_edit_receive")||i()}function i(){return d("WAWebABProps").getABPropConfigValue("caption_edit_send")}function c(){return d("WAWebABProps").getABPropConfigValue("web_message_edit_processing_reply_messages")}function e(){return d("WAWebABProps").getABPropConfigValue("cag_message_edit_send")}function f(){return d("WAWebABProps").getABPropConfigValue("cag_message_edit_receive")}g.receiveTextEditEnabled=a;g.sendTextEditEnabled=h;g.receiveCaptionEditEnabled=b;g.sendCaptionEditEnabled=i;g.processReplyMessagesEnabled=c;g.sendCagMsgEditEnabled=e;g.receiveCagMsgEditEnabled=f}),98);
__d("WAWebMessageEditUtils",["$InternalEnum","WATimeUtils","WAWebABProps","WAWebMsgType","WAWebWid"],(function(a,b,c,d,e,f,g){var h=30*24*60*60;function i(a){if(a)return h;a=d("WAWebABProps").getABPropConfigValue("message_edit_window_duration_seconds");return a==null||a<=0?20*60:a}function j(a){if(a)return h;a=d("WAWebABProps").getABPropConfigValue("message_edit_client_entry_point_limit_seconds");return a==null||a<=0?15*60:a}var k=b("$InternalEnum").Mirrored(["TextEdit","CaptionEdit","EventEdit","RichResponseEdit"]);function a(a){switch(a){case d("WAWebMsgType").MSG_TYPE.CHAT:return k.TextEdit;case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.VIDEO:case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return k.CaptionEdit;case d("WAWebMsgType").MSG_TYPE.EVENT_CREATION:return k.EventEdit;case d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE:return k.RichResponseEdit;default:return null}}var l=[(b=d("WAWebMsgType")).MSG_TYPE.CHAT,b.MSG_TYPE.IMAGE,b.MSG_TYPE.VIDEO,b.MSG_TYPE.DOCUMENT,b.MSG_TYPE.EVENT_CREATION,b.MSG_TYPE.RICH_RESPONSE];function e(a){return l.includes(a)?!0:!1}function f(a){var b=a.parentTsInSeconds,e=a.editTsInSeconds;a=a.msgKey;a=c("WAWebWid").isNewsletter(a.remote);return e!=null?e<b+i(a):d("WATimeUtils").unixTime()<b+i(a)}function m(a){var b=a.parentTsInSeconds;a=a.msgKey;return d("WATimeUtils").unixTime()<b+j(c("WAWebWid").isNewsletter(a.remote))}g.getMessageEditProcessingWindowDurationSeconds=i;g.MsgEditType=k;g.getMsgEditType=a;g.msgTypeSupportsEditing=e;g.isParentWithinEditProcessingWindow=f;g.isParentWithinEditUIWindow=m}),98);
__d("WAWebDBMessageEditAddOnProvider",["WAWebDBProcessEditProtocolMsgs","WAWebMessageAddOnType","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.MessageEdit,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype==="message_edit"},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.futureproofSubtype==="message_edit"},canRenderInUi:function(a){a=a.editMsgType?d("WAWebMessageEditUtils").getMsgEditType(a.editMsgType):d("WAWebMessageEditUtils").MsgEditType.TextEdit;if(!a)return!1;switch(a){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:return d("WAWebMessageEditGatingUtils").receiveTextEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:return d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.EventEdit:return!1;case d("WAWebMessageEditUtils").MsgEditType.RichResponseEdit:return!0}},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(b.map(function(a){return a.parsedMsgPayload})));b=(b=b.find(function(b){return b.parentMsg.id.equals(a.id)}))==null?void 0:b.editedMsgData;b&&Object.assign(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()};g.messageEditAddOnProvider=a}),98);
__d("WAWebPinMsgGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m1_receiver")}function b(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m1_sender")}function h(){return d("WAWebABProps").getABPropConfigValue("pinned_messages_m2")}function c(){return h()?d("WAWebABProps").getABPropConfigValue("pinned_messages_m2_pin_max"):1}g.isPinnedMessagesM1ReceiverEnabled=a;g.isPinnedMessagesM1SenderEnabled=b;g.isPinnedMessagesM2Enabled=h;g.getMaxPins=c}),98);
__d("WAWebDBPinInChatAddOnProvider",["WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","WAWebPinMessageProcessor","WAWebPinMsgGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.PinMessage,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE},canRenderInUi:function(){return d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled()},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.map(function(a){return a.parsedMsgPayload});yield d("WAWebPinMessageProcessor").processPinMessages(a.id.remote,b)});function c(b,c){return a.apply(this,arguments)}return c}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("pinned-messages",a,b)}};g.pinInChatAddOnProvider=a}),98);
__d("WAWebDBPollVotesAddOnProvider",["WAWebDBMarkAsReadForTable","WAWebDBProcessPollUpdateMsgs","WAWebDBUpdateAddOnAcksForTable","WAWebMessageAddOnType","WAWebMsgType","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAddOnType").MessageAddOnType.PollVote,matches:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.subtype==="poll_vote"},matchesFutureproof:function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE},canRenderInUi:function(){return!0},processOrphansForNewMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=new Map();for(a of b)e.set(a.msgKey,a);a=(yield d("WAWebDBProcessPollUpdateMsgs").processPollUpdateMsgs(b.map(function(a){a=a.parsedMsgPayload;if(a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.addonEncrypted)return a;throw c("err")("Invalid poll vote orphan type")})));return a.map(function(a){var b;b=a.read||((b=(b=e.get(a.msgKey.toString()))==null?void 0:b.read)!=null?b:!1);return a.read===b?a:babelHelpers["extends"]({},a,{read:b})})});function e(b,c){return a.apply(this,arguments)}return e}(),updateAcks:function(a,b){return d("WAWebDBUpdateAddOnAcksForTable").updateAddOnAcksForTable("poll-votes",a,b)},markAsRead:function(a){return d("WAWebDBMarkAsReadForTable").markAsReadForTable("poll-votes",a.map(String))}};g.pollVotesAddOnProvider=a}),98);
__d("WAWebDBUpdateLastAddOnPreviewChat",["WAWebApiChat"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebApiChat").bulkUpdateChatLastAddOnPreview(a)}g.updateDatabaseForLastAddOnPreview=a}),98);
__d("WAWebApiContactUsernameFields",["WAWebApiContact","WAWebCountryCodeUtils","WAWebLidAwareContactsDB","WAWebModelStorageUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebApiContact").getContactRecord(a));return a==null?void 0:a.username});return h.apply(this,arguments)}function e(a){return d("WAWebModelStorageUtils").getStorage().lock(["contact"],function(){var b=a.map(function(a){var b=a.id,c=a.username,d=a.displayNameLID,e=a.usernameCountryCode;a=a.usernameSoftDeleted;b={id:b};d!=null&&(b.displayNameLID=d);e!=null&&(b.usernameCountryCode=e);a===!0?b.usernameSoftDeleted=!0:(b.username=c,b.usernameSoftDeleted=void 0);return b});return c("WAWebLidAwareContactsDB").bulkCreateOrMerge(b,"ApiContactUsernameFields.bulkUpdateUsernamesInDb")})}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebApiContact").getContactRecord(a));b=b==null?void 0:b.usernameCountryCode;return b!=null?b:d("WAWebCountryCodeUtils").getCountryCodeFromPn(d("WAWebWidFactory").asUserWidOrThrow(a))});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield i(a));return b!=null?b:d("WAWebCountryCodeUtils").getUsernameCountryCodeFromPnOrServer(d("WAWebWidFactory").asUserWidOrThrow(a))});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebApiContact").bulkGetContactRecord(a));return a.reduce(function(a,b){b!=null&&a.set(b.id,{username:b.username,usernameCountryCode:b.usernameCountryCode,usernameSoftDeleted:b.usernameSoftDeleted});return a},new Map())});return m.apply(this,arguments)}g.getContactUsername=a;g.bulkUpdateUsernamesInDb=e;g.getContactUsernameCountryCode=i;g.getOrFetchContactUsernameCountryCode=f;g.bulkGetContactToUsernameInfoMap=l}),98);
__d("WAWebDBContactRemoveSoftDeletedUsernames",["WALogger","WAWebLidAwareContactsDB","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return a.toJid()});a=(yield c("WAWebLidAwareContactsDB").bulkGet(a));var b=0;a=a.reduce(function(a,c){if(c==null){b++;return a}c.username!=null&&c.usernameSoftDeleted===!0&&a.push(c.id);return a},[]);b>0&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["removeSoftDeletedUsernames: "," missing contacts"])),b);a.length>0&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["removeSoftDeletedUsernames: removing soft deleted usernames for "," LIDs"])),a.length),yield c("WAWebLidAwareContactsDB").bulkCreateOrMerge(a.map(function(a){return{id:a,username:void 0,usernameSoftDeleted:void 0}}),"DBContactRemoveSoftDeletedUsernames.removeSoftDeletedUsernames"))});return j.apply(this,arguments)}g.removeSoftDeletedUsernames=a}),98);
__d("WAWebDynamicThrottlingManager",[],(function(a,b,c,d,e,f){var g=function(){function a(a,b){b===void 0&&(b=.2);if(b<=1e-5||b>=.8){var c=new Error("newValueRatio should be between 0.00001 and 0.8");void c.stack;throw c}this.average=a;this.lastValue=a;this.newValueRatio=b}var b=a.prototype;b.addObservation=function(a){this.average=this.average*(1-this.newValueRatio)+a*this.newValueRatio,this.lastValue=a};return a}();a=function(){function a(b){var c;this.targetTimeMs=(c=b==null?void 0:b.targetTimeMs)!=null?c:a.DEFAULT_TARGET_TIME_MS;this.maxDelayTimeMs=(c=b==null?void 0:b.maxDelayTimeMs)!=null?c:a.DEFAULT_MAX_DELAY_TIME_MS;this.minBatchSize=(c=b==null?void 0:b.minBatchSize)!=null?c:a.DEFAULT_MIN_BATCH_SIZE;this.maxBatchSize=(c=b==null?void 0:b.maxBatchSize)!=null?c:a.DEFAULT_MAX_BATCH_SIZE;this.defaultBatchSize=(c=b==null?void 0:b.defaultBatchSize)!=null?c:a.DEFAULT_BATCH_SIZE;this.batchSize=this.defaultBatchSize;this.averageTotalTime=new g(this.targetTimeMs/1e3,.2)}var b=a.prototype;b.getThrottleRate=function(){var a=this.getTotalTimeSeconds()*.5;a=Math.min(a,this.maxDelayTimeMs/1e3);return{batchSize:this.batchSize,delayMs:a*1e3}};b.setLastProcessTime=function(a,b){b=a/1e3;this.averageTotalTime.addObservation(b);a=this.targetTimeMs/1e3;b=this.getTotalTimeSeconds();b<a?b<a*.5?this.batchSize=this.batchSize>20?Math.floor(this.batchSize*1.2):this.batchSize+2:this.batchSize=this.batchSize>20?Math.floor(this.batchSize*1.1):this.batchSize+1:b>a*2?this.batchSize=this.batchSize>20?Math.floor(this.batchSize*.8):this.batchSize-2:this.batchSize=this.batchSize>20?Math.floor(this.batchSize*.9):this.batchSize-1;this.batchSize=Math.max(this.minBatchSize,Math.min(this.batchSize,this.maxBatchSize))};b.getTotalTimeSeconds=function(){return Math.max(this.averageTotalTime.average,this.averageTotalTime.lastValue)};b.reset=function(){this.batchSize=this.defaultBatchSize,this.averageTotalTime=new g(this.targetTimeMs/1e3,.2)};b.getMetrics=function(){return{batchSize:this.batchSize,avgTotalTimeMs:this.averageTotalTime.average*1e3,lastTotalTimeMs:this.averageTotalTime.lastValue*1e3}};return a}();a.DEFAULT_TARGET_TIME_MS=400;a.DEFAULT_MAX_DELAY_TIME_MS=3e3;a.DEFAULT_MIN_BATCH_SIZE=1;a.DEFAULT_MAX_BATCH_SIZE=500;a.DEFAULT_BATCH_SIZE=50;f.DynamicThrottlingManager=a}),66);
__d("WAWebRunInBatches",["Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){var g;function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){var e,f;e=(e=d==null?void 0:d.batchSize)!=null?e:1e3;var h=(f=d==null?void 0:d.delayMs)!=null?f:0;for(f=0;f<a.length;f+=e){var i;if(d!=null&&(i=d.abortController)!=null&&i.signal.aborted)return;var j=a.slice(f,f+e);yield c(j);yield new(g||(g=b("Promise")))(function(a){return self.setTimeout(a,h)})}});return h.apply(this,arguments)}f.runInBatches=a}),66);
__d("WAWebDBCreateLidPnMappings",["Promise","WAAsyncSleep","WALogger","WATimeUtils","WAWebABProps","WAWebApiContact","WAWebBackendApi","WAWebContactsDbLidMigrationUtils","WAWebDBContactRemoveSoftDeletedUsernames","WAWebDynamicThrottlingManager","WAWebEnvironment","WAWebIdentityChangeApi","WAWebRunInBatches","WAWebSchemaContact_DO_NOT_USE_DIRECTLY","WAWebUsernameGatingUtils","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=new(d("WAWebDynamicThrottlingManager").DynamicThrottlingManager)({targetTimeMs:100,maxDelayTimeMs:1e3,minBatchSize:5,maxBatchSize:300,defaultBatchSize:30});function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mappings,e=a.flushImmediately,f=a.identityChangeHandlingEnabled,g=a.learningSource;d("WAWebABProps").getABPropConfigValue("wa_web_history_sync_dynamic_throttling")?yield r({mappings:b,flushImmediately:e,identityChangeHandlingEnabled:f,learningSource:g}):c("WAWebEnvironment").isWindows?yield d("WAWebRunInBatches").runInBatches(b,function(a){return t({mappings:a,flushImmediately:e,identityChangeHandlingEnabled:f,learningSource:g})}):yield t({mappings:b,flushImmediately:e,identityChangeHandlingEnabled:f,learningSource:g})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.mappings,c=a.flushImmediately,e=a.identityChangeHandlingEnabled;a=a.learningSource;if(b.length===0)return;for(var f=0;f<b.length;){var g=p.getThrottleRate(),h=Math.min(g.batchSize,b.length-f),i=b.slice(f,f+h),j=self.performance.now();yield t({mappings:i,flushImmediately:c,identityChangeHandlingEnabled:e,learningSource:a});j=self.performance.now()-j;p.setLastProcessTime(j,i.length);g.delayMs>0&&(yield d("WAAsyncSleep").asyncSleep(g.delayMs));f+=h}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.mappings,e=a.flushImmediately,f=a.identityChangeHandlingEnabled,g=a.learningSource,h=f!=null?f:!0,i=[],l=[],m=new Map(c.map(function(a){return[a.pn,a.lid]})),n=d("WATimeUtils").unixTime(),p=d("WATimeUtils").castToUnixTime(0),q=[],r=new Set();c.forEach(function(a){var b=a.lid;a=a.pn;var c=d("WAWebApiContact").lidPnCache.getCurrentLid(a),f=d("WAWebApiContact").lidPnCache.getPhoneNumber(b);f=f==null;var j=!f,k=(c==null?void 0:c.equals(b))===!0;j=j&&!k;var o,s;switch(g){case"usync":o=!1;s=f||j;break;case"peer-pn-message":case"recipient-latest-lid":case"peer-lid-message":case"migration-sync-latest":case"migration-sync-old":case"blocklist-active":case"blocklist-inactive":o=!1;s=!k;break;default:g,o=j,s=f}if(s){c!=null&&h&&q.push(d("WAWebIdentityChangeApi").handleNewIdentity(a,!e));g==="migration-sync-old"||g==="blocklist-inactive"?k=!0:(g,k=m.get(a)!==b);j=k?p:n;d("WAWebApiContact").warmUpLidPnMapping(b,a,j);i.push({lid:b.toString(),phoneNumber:a.toString()});e?l.push({lid:b,pn:a,phoneNumberCreatedAt:j}):d("WAWebApiContact").lidPnCacheDirtySet.add(b.toString())}o&&r.add(a)});e&&d("WAWebApiContact").lidPnCacheDirtySet.size>0&&y(l);a=q.length>0?(o||(o=b("Promise"))).all(q).then(function(a){var b=0;for(a of a){var c,e;b+=(c=a==null||(e=a.notifications)==null?void 0:e.length)!=null?c:0}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["createLidPnMappings: "," identity change notifications generated, source ",""])),b,g)}):(o||(o=b("Promise"))).resolve();r.size!==0&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["createLidPnMappings: "," contacts requiring usync, source ",""])),r.size,g),d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:Array.from(r),shouldSyncDevice:!1,mode:"query"}));f=[a];l.length>0&&f.push(z(l));yield (o||(o=b("Promise"))).all(f);i.length>0&&(yield d("WAWebBackendApi").frontendSendAndReceive("bulkUpdatePhoneNumberJids",{lidPhoneNumberMappings:i}))});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAWebSchemaContact_DO_NOT_USE_DIRECTLY").getContactTable().bulkGet(a));return new Map(a.filter(Boolean).map(function(a){return[a.id,a]}))}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["getPnRowData failed! ",""])),a.stack)}return new Map()});return w.apply(this,arguments)}function e(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=[];y(a);yield z(a)}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["flushLidPnMappingsToDb failed!"]))).devConsole(a).sendLogs("Failed to flushLidPnMappingsToDb")}});return x.apply(this,arguments)}function y(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["flush lidPnCacheDirtySet: get dirty updates for ",""])),Array.from(d("WAWebApiContact").lidPnCacheDirtySet).join(",")),d("WAWebApiContact").lidPnCacheDirtySet.forEach(function(b){b=d("WAWebWidFactory").createUserLidOrThrow(b);var c=d("WAWebApiContact").lidPnCache.getLidEntry(b);c!=null&&a.push({lid:b,pn:c.phoneNumber,phoneNumberCreatedAt:d("WATimeUtils").castToUnixTime(c.phoneNumberCreatedAt)})}),d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["lidPnCacheDirtySet: "," flushed"])),d("WAWebApiContact").lidPnCacheDirtySet.size),d("WAWebApiContact").lidPnCacheDirtySet.clear()}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var b=(yield v(a.map(function(a){a=a.pn;return a.toJid()}))),c=a.map(function(a){var c=a.lid,e=a.pn;a=a.phoneNumberCreatedAt;var f=b.get(e.toJid());return babelHelpers["extends"]({id:c.toString(),phoneNumber:e.toString(),phoneNumberCreatedAt:a},f?d("WAWebContactsDbLidMigrationUtils").createContactLidRowFromPnRow(c,f):null)});d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["flushLidPnMappingsToDbImpl: "," records to update"])),c.length);yield d("WAWebSchemaContact_DO_NOT_USE_DIRECTLY").getContactTable().bulkCreateOrMerge(c);d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&(yield d("WAWebDBContactRemoveSoftDeletedUsernames").removeSoftDeletedUsernames(a.map(function(a){a=a.lid;return a})))});return A.apply(this,arguments)}g.createLidPnMappingsInBatches=a;g.createLidPnMappings=t;g.flushLidPnMappingsToDb=e}),98);
__d("WAWebDBParticipantTypes",[],(function(a,b,c,d,e,f,g){a=Object.freeze({ADD:"add",REMOVE:"remove",DEMOTE:"demote",PROMOTE:"promote",LINKED_GROUP_PROMOTE:"linked_group_promote",LINKED_GROUP_DEMOTE:"linked_group_demote"});b=Object.freeze({DEVICE:"device",PARTICIPANT:"participant"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="GroupUnSyncedError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));g.PARTICIPANT_OPERATION=a;g.STALE_TYPES=b;g.GroupUnSyncedError=c}),98);
__d("WAWebGroupUtils",["WATypeUtils","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(a){return a.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WATypeUtils").isString(a)?d("WAWebWidFactory").createWid(a):a)})}function a(a){a=a.filter(function(a){a=a.isAdmin;return a}).map(function(a){a=a.id;return a});return h(a)}b=new Set(["add","remove","demote","linked_group_demote"]);g.amIGroupAdmin=h;g.amIGroupAdminGivenParticipants=a;g.INVALID_CAG_NON_ADMIN_SYSTEM_MSG_SUBTYPES=b}),98);
__d("WAWebLeaveReasonType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["Left","Removed"]);f.LeaveReason=a}),66);
__d("WAWebPhashUtils",["WABase64","WACryptoSha256","WALogger","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("gkx")("26258")||d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[phashV1] calculating phash for ",""])),a.join(","));a=a.map(function(a){return d("WAWebWidFactory").asUserWidOrThrow(a).toString({legacy:!0})}).sort().join("");var b=[];for(var e=0;e<a.length;e++)b.push(a.charCodeAt(e));e=new Uint8Array(b);a=(yield self.crypto.subtle.digest({name:"SHA-1"},e));return"1:"+d("WABase64").encodeB64(a.slice(0,6))});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){c("gkx")("26258")||d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[phashV2] calculating phash for ",""])),a.join(","));a=a.map(function(a){return a.toString({legacy:!0,formatFull:!0})}).sort().join("");var b=[];for(var e=0;e<a.length;e++)b.push(a.charCodeAt(e));e=new Uint8Array(b);a=(yield d("WACryptoSha256").sha256(e));return"2:"+d("WABase64").encodeB64(a.slice(0,6))});return k.apply(this,arguments)}g.phashV1=a;g.phashV2=e}),98);
__d("WAWebWamEnumMessageChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4,CHANNEL:5});f.MESSAGE_CHAT_TYPE=a}),66);
__d("WAWebGetMessageChatTypeFromWid",["WAWebWamEnumMessageChatType"],(function(a,b,c,d,e,f,g){function a(a){if(a.isUser())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.INDIVIDUAL;if(a.isGroup())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.GROUP;if(a.isBroadcast())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.BROADCAST;if(a.isStatus())return d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.STATUS;return a.isNewsletter()?d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.CHANNEL:d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE.OTHER}g.getMessageChatTypeFromWid=a}),98);
__d("WAWebWamEnumExpiryReason",[],(function(a,b,c,d,e,f){a=Object.freeze({USER_LEAVE:1,DEVICE_UNPAIR:2,IDENTITY_CHANGE:3,AUDIENCE_CHANGE:4,PERIODIC_ROTATION:5,KEY_CORRUPTION:6,PEER_COMPANION_UNPAIR:7,OTHER_DEVICE_UNPAIR:8});f.EXPIRY_REASON=a}),66);
__d("WAWebWamEnumSizeBucket",[],(function(a,b,c,d,e,f){a=Object.freeze({LT32:1,LT64:2,LT128:3,LT256:4,LT512:5,LT1000:6,LT1024:16,LT1500:7,LT2000:8,LT2500:9,LT3000:10,LT3500:11,LT4000:12,LT4500:13,LT5000:14,LARGEST_BUCKET:15});f.SIZE_BUCKET=a}),66);
__d("WAWebSenderKeyExpiredWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumExpiryReason","WAWebWamEnumMessageChatType","WAWebWamEnumSizeBucket"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({SenderKeyExpired:[3130,{chatType:[1,d("WAWebWamEnumMessageChatType").MESSAGE_CHAT_TYPE],deviceSizeBucket:[2,d("WAWebWamEnumSizeBucket").SIZE_BUCKET],expiryReason:[3,d("WAWebWamEnumExpiryReason").EXPIRY_REASON]},[1,1,1],"regular"]},{SenderKeyExpired:[]});g.SenderKeyExpiredWamEvent=a}),98);
__d("WAWebWamNumberToSizeBucket",["WAWebWamEnumSizeBucket"],(function(a,b,c,d,e,f,g){function a(a){if(a<32)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT32;if(a<64)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT64;if(a<128)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT128;if(a<256)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT256;if(a<512)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT512;if(a<1024)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT1024;if(a<1500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT1500;if(a<2e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT2000;if(a<2500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT2500;if(a<3e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT3000;if(a<3500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT3500;if(a<4e3)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT4000;if(a<4500)return d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT4500;return a<5e3?d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT5000:d("WAWebWamEnumSizeBucket").SIZE_BUCKET.LARGEST_BUCKET}g["default"]=a}),98);
__d("WAWebPostSenderKeyExpiredMetric",["WAWebGetMessageChatTypeFromWid","WAWebSenderKeyExpiredWamEvent","WAWebWamNumberToSizeBucket","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.chatId,e=a.expiryReason;a=a.deviceCount;var f=new(d("WAWebSenderKeyExpiredWamEvent").SenderKeyExpiredWamEvent)();e!=null&&(f.expiryReason=e);if(b!=null){e=d("WAWebWidFactory").createWidFromWidLike(b);f.chatType=d("WAWebGetMessageChatTypeFromWid").getMessageChatTypeFromWid(e)}a!=null&&a>0&&(f.deviceSizeBucket=c("WAWebWamNumberToSizeBucket")(a));f.commit()}g.postSenderKeyExpiredMetric=a}),98);
__d("WAWebWamGroupMetricUtils",["WAWebWamNumberToSizeBucket"],(function(a,b,c,d,e,f,g){function h(a){return Math.max(a,32)}function a(a){var b={},c=a.participants.length;c!=null&&(b.participantCount=h(c));c=a.cachedDeviceCount;c!=null&&(b.deviceCount=h(c));return b}function b(a){return{participantCount:h(a.participants.length),deviceCount:h(a.senderKey.size),deviceSizeBucket:c("WAWebWamNumberToSizeBucket")(a.senderKey.size)}}g.capCount=h;g.getGroupCountMetricsFromGroupMetadata=a;g.getGroupMetricsFromDbRecord=b}),98);
__d("WAWebWamGroupMetricCache",["Promise","WALogger","WAWebSchemaParticipant","WAWebWamGroupMetricUtils"],(function(a,b,c,d,e,f,g){var h,i,j=new Map();function a(a){if(!a.isGroup())return(i||(i=b("Promise"))).resolve(null);a=a.toString();j.has(a)||j.set(a,k(a));return j.get(a)||(i||(i=b("Promise"))).resolve(null)}function k(a){return d("WAWebSchemaParticipant").getParticipantTable().get(a).then(function(a){return a&&d("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(a)})["catch"](function(b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_getGroupMetricsFromDb: failed to get for ",": ",""])),a,b)})}function c(a){if(a.participants==null||a.senderKey==null)return;j.set(a.groupId,(i||(i=b("Promise"))).resolve(d("WAWebWamGroupMetricUtils").getGroupMetricsFromDbRecord(a)))}g.getGroupMetrics=a;g.cacheGroupMetrics=c}),98);
__d("WAWebDBGroupParticipant",["$InternalEnum","Promise","WABatcher","WAJids","WALogger","WANullthrows","WAWebApiContact","WAWebDBParticipantTypes","WAWebGroupType","WAWebGroupUtils","WAWebLeaveReasonType","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebPhashUtils","WAWebPnhCagIncognito","WAWebPostSenderKeyExpiredMetric","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWamEnumExpiryReason","WAWebWamGroupMetricCache","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r=3e3;function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groupInfos;var b=(yield d("WAWebSchemaParticipant").getParticipantTable().bulkGet(a.map(function(a){return a.id.toString()}))),c=new Map();b.forEach(function(a){return a&&c.set(a.groupId,a.senderKey)});b=a.map(function(a){var b,e=[],f=[],g=[],h=a.id.toString(),i=c.get(h)||new Map();(b=a.participants)==null||b.forEach(function(a){a.isAdmin&&f.push(a.id),a.isSuperAdmin&&g.push(a.id),e.push(a.id)});b=(b=(b=a.pastParticipants)==null?void 0:b.map(function(a){var b=a.id,c=a.leaveTs;a=a.leaveReason;return{jid:b.toString(),leaveTs:c,leaveReason:a}}))!=null?b:[];var j=Boolean(a.incognito)&&Boolean(a.defaultSubgroup);if(j){j=d("WAWebGroupUtils").amIGroupAdmin(f);j=d("WAWebPnhCagIncognito").augmentedCagGroupParticipantList(j,a.participants);j.forEach(function(a){a=String(a);i.has(a)||i.set(a,!1)})}else{(j=a.participants)==null||j.forEach(function(a){i.set(String(a.id),!1)})}return{groupId:h,participants:e.map(String),pastParticipants:b,admins:f.map(String),superAdmins:g.map(String),senderKey:i,rotateKey:!1,staleType:d("WAWebDBParticipantTypes").STALE_TYPES.DEVICE}});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(b)});return s.apply(this,arguments)}function e(a){var c=a.group,e=a.participants,f=a.admins,g=a.superAdmins,h=a.deviceIds;a=a.groupInfo;var i=!1;a!=null&&(i=Boolean(a.incognito)&&Boolean(a.defaultSubgroup));var j=c.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(j));if(!b)return a.create(I(j,{participants:e,admins:f,superAdmins:g,deviceIds:h}));yield a.createOrReplace(i?O(b,{participants:e,admins:f,superAdmins:g,deviceIds:h}):J(b,{participants:e,admins:f,superAdmins:g,deviceIds:h}))});return function(b){return a.apply(this,arguments)}}())}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.bulkGet(a.map(function(a){return a.groupId}))),d=a.map(function(a,b){var d=a.groupId;a=a.pastParticipants;b=c[b];return!b?I(d,{pastParticipants:a}):B(b,a)});return b.bulkCreateOrReplace(d)});return function(a){return c.apply(this,arguments)}}())}var t=function(){return d("WABatcher").batch({delayMs:r},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsBatched: aggregating "," changes"])),a.length).devConsole(a);var c=Array.from(new Set(a.map(function(a){return a.id})));yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Map((yield b.bulkGet(c)).filter(Boolean).map(function(a){return[a.groupId,a]}));a.forEach(function(a){var b=a.id,c=a.data;a=a.groupMetadata;a=Boolean(a==null?void 0:a.defaultSubgroup);var f=e.get(b);if(!f){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["updateParticipantsBatched: no local record found for group ",""])),b);return}b=c.participants;var g=null;switch(c.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.ADD:g=a?z(f,b,c.deviceIds):y(f,b,c.deviceIds);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.REMOVE:g=a?D(f,b,c.timestamp,c.author,c.reason):C(f,b,c.timestamp,c.author,c.reason);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE:g=a?G(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE):F(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE:g=a?G(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE):F(f,b,c.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE);break;default:d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["updateParticipants: failed with unknown action ",""])),c.action)}g!=null&&e.set(g.groupId,g)});return b.bulkCreateOrReplace(Array.from(e.values()))});return function(a){return e.apply(this,arguments)}}());return a.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}())}(),u=function(){return d("WABatcher").batch({delayMs:r},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: aggregating "," changes"])),a.length).devConsole(a);var c=Array.from(new Set(a.map(function(a){return a.id})));yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Map((yield b.bulkGet(c)).filter(Boolean).map(function(a){return[a.groupId,a]}));a.forEach(function(a){var b=a.id;a=a.data;var c=e.get(b);if(!c){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: no local record found for group ",""])),b);return}b=a.participants;var f=null;switch(a.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE:f=H(c,b,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE);break;case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE:f=H(c,b,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE);break;default:d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["updateCommunityParticipantsBatched: failed with unknown action ",""])),a.action)}f!=null&&e.set(f.groupId,f)});return b.bulkCreateOrReplace(Array.from(e.values()))});return function(a){return e.apply(this,arguments)}}());return a.map(function(a){return void 0})});return function(b){return a.apply(this,arguments)}}())}();function v(a,e,f){f===void 0&&(f=!1);if(f)return u({id:String(a),data:e});var g=e.participants,h=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(h));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateCommunityParticipants: group participant info missing for action "+e.action);switch(e.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE:return a.createOrReplace(H(b,g,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE:return a.createOrReplace(H(b,g,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE));default:throw c("err")("updateCommunityParticipants: failed with unknown action "+e.action)}});return function(b){return a.apply(this,arguments)}}())}function w(a,c){return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.get(a.toString()));if(!e)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateParticipants: group participant info missing when trying to update super admin");return b.createOrReplace(babelHelpers["extends"]({},e,{superAdmins:[c.toString()]}))});return function(a){return e.apply(this,arguments)}}())}function x(a,e,f,g){g===void 0&&(g=!1);var h=Boolean(f==null?void 0:f.defaultSubgroup);if(g)return t({id:String(a),data:e,groupMetadata:f});var i=e.participants,j=a.toString();return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(j));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("updateParticipants: group participant info missing for action "+e.action);switch(e.action){case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.ADD:return a.createOrReplace(h?z(b,i,e.deviceIds):y(b,i,e.deviceIds));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.REMOVE:return a.createOrReplace(h?D(b,i,e.timestamp,e.author,e.reason):C(b,i,e.timestamp,e.author,e.reason));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE:return a.createOrReplace(h?G(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE):F(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE));case d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE:return a.createOrReplace(h?G(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE):F(b,i,e.deviceIds,d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE));default:throw c("err")("updateParticipants: failed with unknown action "+e.action)}});return function(b){return a.apply(this,arguments)}}())}function y(a,b,c){var e=new Map(a.senderKey);c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a)||a.isHosted())return;e.set(a.toString(),!1)});c=new Set(b.map(function(a){a=a.id;return a.toString()}));b=A(a.pastParticipants,c);c=[].concat(a.participants,c.values().toArray().map(function(a){return a.toString()}));return{groupId:a.groupId,senderKey:e,participants:c,pastParticipants:b,admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function z(a,b,c){var e=new Map(a.senderKey);c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a)||a.isHosted())return;e.set(a.toString(),!1)});var f=new Set(),g=new Set();b.forEach(function(a){var b=a.id;a=a.lid;g.add(b.toString());a!=null&&!b.isLid()&&f.add(a.toString())});c=A(a.pastParticipants,g);b=[].concat(a.participants.filter(function(a){return!f.has(a)&&!g.has(a)}),g.values().toArray().map(function(a){return a}));return{groupId:a.groupId,senderKey:e,participants:b,pastParticipants:c,admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function A(a,b){return(a=a==null?void 0:a.filter(function(a){var c=d("WAWebWidFactory").createUserWidOrThrow(a.jid);c=d("WAWebApiContact").getAlternateUserWid(c);a=b.has(a.jid);c=c?b.has(c.toString()):!1;return!a&&!c}))!=null?a:[]}function B(a,b){return{groupId:a.groupId,senderKey:a.senderKey,participants:a.participants,pastParticipants:b.map(function(a){var b=a.id,c=a.leaveReason;a=a.leaveTs;return{jid:b.toString(),leaveTs:a,leaveReason:c}}),admins:a.admins,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function C(a,b,c,e,f){var g=new Map(a.senderKey),h=a.rotateKey;g.forEach(function(a,c){var e=d("WAWebWidFactory").createWid(c),f=b.some(function(a){a=d("WAWebLidMigrationUtils").toCommonAddressingMode(a.id,e);var b=a[0];a=a[1];if(b!=null&&a!=null)return b.isSameAccountAndAddressingMode(a)});f&&(h=h||a,g["delete"](c))});h&&g.forEach(function(a,b){g.set(b,!1)});f=E(b,a.pastParticipants,c,e);!a.rotateKey&&h&&d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:a.groupId,deviceCount:a.senderKey.size,expiryReason:d("WAWebWamEnumExpiryReason").EXPIRY_REASON.USER_LEAVE});var i=new Set(b.map(function(a){a=a.id;return String(a)}));c=a.admins.filter(function(a){return!i.has(a)});e=(e=a.superAdmins)==null?void 0:e.filter(function(a){return!i.has(a)});var j=a.participants.filter(function(a){return!i.has(a)});return{groupId:a.groupId,senderKey:g,participants:j,pastParticipants:f,admins:c,superAdmins:e,rotateKey:h,staleType:a.staleType}}function D(a,b,c,e,f){var g,h=new Map(a.senderKey),i=a.rotateKey,j=b.map(function(a){return a.id.isLid()?a.id:a.lid}).filter(Boolean);h.forEach(function(a,c){var e=d("WAWebWidFactory").createWid(c);if(e.isLid()&&f!==d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){var g=j.some(function(a){return a.isSameAccountAndAddressingMode(e)});g&&h["delete"](c);return}if(!e.isLid()&&f===d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){h["delete"](c);return}g=b.some(function(a){return a.id.user===e.user&&a.id.server===e.server});g&&(i=i||a,h["delete"](c))});i&&h.forEach(function(a,b){a=d("WAWebWidFactory").createWid(b);a.isLid()||h.set(b,!1)});c=E(b,a.pastParticipants,c,e);!a.rotateKey&&i&&d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:a.groupId,deviceCount:a.senderKey.size,expiryReason:d("WAWebWamEnumExpiryReason").EXPIRY_REASON.USER_LEAVE});var k=new Set(b.map(function(a){a=a.id;return String(a)}));e=a.admins.filter(function(a){return!k.has(a)});g=(g=a.superAdmins)==null?void 0:g.filter(function(a){return!k.has(a)});var l=a.participants;if(f===d("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE){var m=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(b.toString(),c.toString())},new Map());l=l.map(function(a){var b;return(b=m.get(a))!=null?b:a})}else l=l.filter(function(a){return!k.has(a)});return{groupId:a.groupId,senderKey:h,participants:l,pastParticipants:c,admins:e,superAdmins:g,rotateKey:i,staleType:a.staleType}}function E(a,b,c,e){var f=new Set(a.map(function(a){a=a.id;return String(a)})),g=a.map(function(a){return{jid:a.id.toString(),leaveTs:c,leaveReason:a.id.equals(e)?d("WAWebLeaveReasonType").LeaveReason.Left:d("WAWebLeaveReasonType").LeaveReason.Removed}});b.forEach(function(a){var b=d("WAWebWidFactory").createUserWidOrThrow(a.jid);b=d("WAWebApiContact").getAlternateUserWid(b);var c=f.has(a.jid),e=b?f.has(b==null?void 0:b.toString()):!1;!c&&!e&&g.push(a);c||f.add(a.jid);b&&!e&&f.add(b.toString())});return g}function F(a,b,c,e){c=a.admins;var f=b.map(function(a){a=a.id;return String(a)});if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE)c=a.admins.filter(function(a){return!f.includes(a)});else if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE){var g=new Set(a.admins);f.forEach(function(a){return g.add(a)});c=Array.from(g)}return{groupId:a.groupId,senderKey:a.senderKey,participants:a.participants,pastParticipants:a.pastParticipants,admins:c,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function G(a,b,c,e){var f=a.admins,g=b.map(function(a){a=a.id;return String(a)}),h=new Map(a.senderKey);c!=null&&c.length>0&&c.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);h.set(a,!1)});c=a.participants;if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.DEMOTE){f=a.admins.filter(function(a){return!g.includes(a)});var i=d("WAWebGroupUtils").amIGroupAdmin(f);if(!i){var j=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(b.toString(),c.toString())},new Map());c=c.map(function(a){var b;return(b=j.get(a))!=null?b:a})}}else if(e===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.PROMOTE){var k=b.reduce(function(a,b){var c=b.lid;b=b.id;return c==null||b.isLid()?a:a.set(c.toString(),b.toString())},new Map());f=a.admins.concat(g);c=c.map(function(a){var b;return(b=k.get(a))!=null?b:a})}return{groupId:a.groupId,senderKey:h,participants:c,pastParticipants:a.pastParticipants,admins:f,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function H(a,b,c){var e=a.admins,f=a.participants,g=b.map(function(a){a=a.id;return String(a)});if(c===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_DEMOTE)e=a.admins.filter(function(a){return!g.includes(a)}),f=e;else if(c===d("WAWebDBParticipantTypes").PARTICIPANT_OPERATION.LINKED_GROUP_PROMOTE){b=g.filter(function(b){return!a.admins.includes(b)});e=a.admins.concat(b);f=e}return{groupId:a.groupId,senderKey:a.senderKey,participants:f,pastParticipants:a.pastParticipants,admins:e,superAdmins:a.superAdmins,rotateKey:a.rotateKey,staleType:a.staleType}}function I(a,b){var c=b.participants;c=c===void 0?[]:c;var e=b.pastParticipants;e=e===void 0?[]:e;var f=b.admins;f=f===void 0?[]:f;var g=b.deviceIds;g=g===void 0?[]:g;var h=new Map();g.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);h.has(a)||h.set(a,!1)});return{groupId:a,senderKey:h,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:e.map(function(a){var b=a.id,c=a.leaveReason;a=a.leaveTs;return{jid:b.toString(),leaveTs:a,leaveReason:c}}),admins:f.map(String),superAdmins:(g=b.superAdmins)==null?void 0:g.map(String),rotateKey:!1,staleType:c.length===0?d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT:void 0}}function J(a,b){var c=b.participants,e=b.admins,f=b.superAdmins;b=b.deviceIds;var g=a.rotateKey,h=a.senderKey,i=new Map();b.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);var b=h==null?void 0:h.get(a);b==null?i.set(a,!1):(i.set(a,b),h==null||h["delete"](a))});if(h!=null)for(b of h.values())g=g||b;return{groupId:a.groupId,senderKey:i,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:a.pastParticipants,admins:e.map(String),superAdmins:f==null?void 0:f.map(String),rotateKey:g}}var K=b("$InternalEnum").Mirrored(["Success","Error"]);function L(a,b){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=K.Error;yield d("WAWebModelStorageUtils").getStorage().lock(["participant","group-metadata"],function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(g){var h=g[0];g=g[1];var i=d("WAWebLidMigrationUtils").toAddressingModeFactory(e);try{var j=c("WANullthrows")(yield h.get(a.toString()),"missing participant record to migrate"),k=Array.from(j.senderKey.entries()),l=d("WAWebGroupUtils").amIGroupAdmin(j.admins);j={admins:j.admins.map(function(a){return c("WANullthrows")(i(d("WAWebWidFactory").createWid(a)),"admin missing a LID-PN mapping").toString()}),participants:j.participants.map(function(a){if(!l&&!e){var b=d("WAWebWidFactory").createUserWidOrThrow(a);return c("WANullthrows")(d("WAWebLidMigrationUtils").toLid(b),"participant missing a LID mapping").toString()}return c("WANullthrows")(i(d("WAWebWidFactory").createWid(a)),"participant missing a LID-PN mapping").toString()}),senderKey:new Map(k.map(function(a){var b=a[0];a[1];return[N(b,i).toString(),!1]}))};k={isLidAddressingMode:e};yield (q||(q=b("Promise"))).all([h.merge(a.toString(),j),g.merge(a.toString(),k)]);f=K.Success}catch(b){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["addressing mode migration failed for ",": ",""])),a,b.message)}});return function(a){return g.apply(this,arguments)}}());return f});return M.apply(this,arguments)}function N(a,b){a=d("WAWebWidFactory").createDeviceWidOrThrow(a);b=c("WANullthrows")(b(d("WAWebWidFactory").asUserWidOrThrow(a)),"senderkey device missing a LID-PN mapping");return d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,(b=a.device)!=null?b:d("WAJids").DEFAULT_DEVICE_ID).toString()}function O(a,b){var c=b.participants,e=b.admins,f=b.superAdmins;b=b.deviceIds;var g=a.rotateKey,h=a.senderKey,i=new Map();b.forEach(function(a){if(d("WAWebUserPrefsMeUser").isMeDevice(a))return;if(a.isHosted())return;a=String(a);var b=h==null?void 0:h.get(a);b==null?i.set(a,!1):(i.set(a,b),h==null||h["delete"](a))});if(h!=null)for(b of h.entries()){var j=b[0],k=b[1];if(k&&!d("WAWebWidFactory").createWid(j).isLid()){g=!0;break}}return{groupId:a.groupId,senderKey:i,participants:c.map(function(a){a=a.id;return String(a)}),pastParticipants:a.pastParticipants,admins:e.map(String),superAdmins:f==null?void 0:f.map(String),rotateKey:g}}function P(a){var b=a.group;return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(a){a=a[0];return a.merge(String(b),{staleType:d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT})})}function Q(a){var b=a.groupIds;return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(a){a=a[0];return a.bulkCreateOrMerge(b.map(function(a){return{groupId:String(a),staleType:d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT}}))})}function R(a){var c=a.group,e=a.oldId,f=a.newId,g=String(c);return d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(g));if(!b)throw new(d("WAWebDBParticipantTypes").GroupUnSyncedError)("modifyGroupParticipant: group participant info missing");return a.createOrReplace(S(b,e,f))});return function(b){return a.apply(this,arguments)}}())}function S(a,b,c){var e,f=String(b),g=String(c),h=new Map(a.senderKey);c=a.participants.filter(function(a){return a!==f}).concat(g);Array.from(h.keys()).forEach(function(a){var c=d("WAWebWidFactory").createWid(a).user;b.user===c?h["delete"](a):h.set(a,!1)});h.set(g,!1);var i=a.admins.map(function(a){return a===f?g:a});e=(e=a.superAdmins)==null?void 0:e.map(function(a){return a===f?g:a});return babelHelpers["extends"]({},a,{participants:c,senderKey:h,admins:i,superAdmins:e,rotateKey:!0})}function T(a){return U.apply(this,arguments)}function U(){U=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.groupWid;var b=(yield d("WAWebSchemaParticipant").getParticipantTable().get(String(a)));if(!b)return null;if(b.senderKey==null){var c,e,f,g;c=(c=b.admins)==null?void 0:c.length;e=(e=b.superAdmins)==null?void 0:e.length;f=(f=b.participants)==null?void 0:f.length;g=(g=b.pastParticipants)==null?void 0:g.length;d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["getGroupParticipant: group participant info missing sender key in ",": admins ",", superAdmins ",", participants ",", pastParticipants ",", rotateKey ",", version ",", staleType ",""])),a.toString(),c,e,f,g,b.rotateKey,b.version,b.staleType).sendLogs("get-group-participant-missing-sender-key");return null}var h=new Set(b.admins),i=new Set(b.superAdmins);e=(c=(a=b.participants)==null?void 0:a.map(function(a){return{id:d("WAWebWidFactory").createWid(a),isAdmin:h.has(a),isSuperAdmin:i.has(a)}}))!=null?c:[];a=(g=(f=b.pastParticipants)==null?void 0:f.map(function(a){var b=a.jid,c=a.leaveTs;a=a.leaveReason;return{id:d("WAWebWidFactory").createWid(b),leaveTs:c,leaveReason:a}}))!=null?g:[];d("WAWebWamGroupMetricCache").cacheGroupMetrics(b);c=b.deviceSyncComplete!=null&&!b.deviceSyncComplete?d("WAWebDBParticipantTypes").STALE_TYPES.PARTICIPANT:void 0;return{participants:e,pastParticipants:a,staleType:(f=b.staleType)!=null?f:c,deviceCount:b.senderKey.size}});return U.apply(this,arguments)}function V(a){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAWebSchemaParticipant").getParticipantTable().get(String(a)));if(!(a!=null&&a.participants))return null;a=a.participants.map(function(a){return d("WAWebWidFactory").createWid(a)});return d("WAWebPhashUtils").phashV2(a)}catch(a){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["computeGroupParticipantsHash: ",""])),a).sendLogs("compute-group-participants-hash-error");return null}});return W.apply(this,arguments)}g.updateGroupParticipantTableWithoutDeviceSync=a;g.replaceParticipants=e;g.addPastParticipants=f;g.updateCommunityParticipants=v;g.setDBGroupSuperAdmin=w;g.updateDBParticipants=x;g.addParticipantInfo=y;g.addParticipantInfoIncognitoCag=z;g.removeParticipantInfo=C;g.removeParticipantInfoIncognitoCag=D;g.createParticipantInfo=I;g.replaceParticipantInfo=J;g.AddressingModeMigrationResult=K;g.migrateParticipantInfoAddressingMode=L;g.replaceParticipantInfoIncognitoCag=O;g.markGroupParticipantStale=P;g.bulkMarkGroupParticipantStale=Q;g.modifyGroupParticipant=R;g.getGroupParticipant=T;g.computeGroupParticipantsHash=V}),98);
__d("WAWebDBStoreMessageOrphans",["WALogger","WAWebDBAddOnProviders","WAWebDBMessageSerialization","WAWebMessageAddOnType","WAWebMsgGetters","WAWebSchemaMessageOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["storeMessageOrphans:"]))).devConsole({msgs:a});a=a.map(function(a){var e;return babelHelpers["extends"]({msgKey:a.id.toString(),parentMsgKey:b(a).toString(),sender:d("WAWebMsgGetters").getSender(a).toString(),parsedMsgPayload:d("WAWebDBMessageSerialization").dbRowFromMessage(babelHelpers["extends"]({},a),c),type:(e=(e=d("WAWebDBAddOnProviders").addOnProviders.find(function(b){return b.matches(a)}))==null?void 0:e.type)!=null?e:d("WAWebMessageAddOnType").MessageAddOnType.Unknown,senderTimestampMs:a.senderTimestampMs,t:a.t},(c==null?void 0:c.storeReportingInfo)===!0&&a.reportingTokenInfo!=null&&{reportingTokenInfo:a.reportingTokenInfo})});yield d("WAWebSchemaMessageOrphans").getMessageOrphanTable().bulkCreateOrReplace(a)});return i.apply(this,arguments)}g.storeMessageOrphans=a}),98);
__d("WAWebLid1X1MigrationGating",["Promise","WALogger","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;a=function(){function a(){}var c=a.prototype;c.isLidMigrated=function(a){a===void 0&&(a=!1);if(a){a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated");d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[lid] isLidMigrated value=",", type=",", result: ",""])),a,typeof a,d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated")===!0)}return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsAccountLidFieldMigrated")===!0};c.setIsLidMigrated=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){c===void 0&&(c=d("WAWebUserPrefsTypes").LidMigrationSource.PEER),d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["lid: setIsLidMigrated: ",", source: ",", isPureLidSyncDSession: ",""])),a,c,e),yield (j||(j=b("Promise"))).all([d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAIsAccountLidFieldMigrated",a),d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidOneOnOneMigrationSource",c),e==null?(j||(j=b("Promise"))).resolve():d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAIsPureLidSyncDSession",e)])});function c(b,c,d){return a.apply(this,arguments)}return c}();c.isSyncdSessionMigrated=function(){return!1};c.lidMigrationSource=function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidOneOnOneMigrationSource")};c.isPureLidSyncDSession=function(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAIsPureLidSyncDSession")};c.shouldCreatePnChat=function(){return!1};return a}();c=new a();g.Lid1X1MigrationUtils=c}),98);
__d("WAWebLidStatusMigrationGating",["WAWebABProps"],(function(a,b,c,d,e,f,g){var h;function i(){if(h!=null)return h;d("WAWebABProps").getABPropConfigValue("lid_status_send_enabled")?h="mat":h="pre_mat";return h}function a(){return i()==="mat"}function b(a){h=a}g.getLidStatusMigrationStage=i;g.getLidStatusSendEnabled=a;g.setLidStatusMigrationStage=b}),98);
__d("WAWebDBBulkGetRootMsgs",["WALogger","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationKeyUtils","WAWebMsgKey","WAWebSchemaChat","WAWebSchemaMessage","WAWebWidFactory","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a;d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?e=(yield q(a)):d("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()&&(e=a.map(function(a){return d("WAWebLidStatusMigrationKeyUtils").matKeyConvert(c("WAWebMsgKey").fromString(a)).toString()}));a=(yield o(e,b));a.some(function(a){return a==null})&&!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&(yield m(e,a,b));return a});return l.apply(this,arguments)}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=a.map(function(a){return c("WAWebMsgKey").fromString(a)}),g=[];for(var h=0;h<b.length;h++)b[h]==null&&f[h].remote.isLid()&&g.push({key:f[h],idxInOriginalMsgKeys:h});if(g.length===0)return;h=s(g.map(function(a){return a.key}));f=(yield o(h.map(String),e)).filter(Boolean);f.forEach(function(h,f){if(h==null)return;var i=h.id;f=c("nullthrows")(g[f]).idxInOriginalMsgKeys;if(f==null){i=i==null?"null":i;var j=a.length;d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fillMissingLidMessages: no original idx found for pn msgkey. shouldDecrypt ",", record id: ",", keys ",""])),e,i,j).sendLogs("fillMissingLidMessages-no-original-idx");return}b[f]=h})});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a,b));var c=new Map();for(var e=0;e<a.length;e++){var f;((f=b[e])==null?void 0:f.subtype)==="message_edit"&&(c.set(a[e],e),b[e]=null)}if(c.size===0)return b;f=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["latestEditMsgKey"],Array.from(c.keys())));for(e of f){if(e.latestEditMsgKey==null||e.subtype==="message_edit")continue;a=c.get(e.latestEditMsgKey);if(a==null)continue;b[a]=e}return b});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return a;a=a.map(function(a){return c("WAWebMsgKey").fromString(a)});var b=t(a.map(function(a){return a.remote}));b=(yield d("WAWebSchemaChat").getChatTable().anyOf(["accountLid"],Array.from(b,function(a){return a.toString()})));b=new Map(b.map(function(a){return[d("WAWebWidFactory").createWid(c("nullthrows")(a.accountLid)),d("WAWebWidFactory").createWid(a.id)]}));return u(a,b).map(String)});return r.apply(this,arguments)}function s(a){var b=a.reduce(function(a,b){var c=d("WAWebLidMigrationUtils").toPn(b.remote);return c==null?a:a.set(b.remote,c)},new Map());return u(a,b)}function t(a){a=a.filter(function(a){return a.isRegularUser()}).map(function(a){return d("WAWebLidMigrationUtils").toLid(a)});a.some(function(a){return a==null})&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: missing mapping for PN remote"])));return new Set(a.filter(Boolean))}function u(a,b){return a.map(function(a){var e=a.remote;if(e.isStatus())return d("WAWebLidStatusMigrationKeyUtils").matKeyConvert(a);if(!e.isRegularUser())return a;e=d("WAWebLidMigrationUtils").toUserLid(e);if(e==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: couldn't find lid for PN (might be orphan)"])));return a}e=b.get(e);if(e==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["_bulkGetRootMsgsByAccountLid: no chat record found for accountLid (might be orphan)"])));return a}return c("WAWebMsgKey").from({fromMe:a.fromMe,remote:e,id:a.id})})}g.bulkGetRootMsgs=a;g.fixMsgKeysWithChatId=q;g.fixMsgKeysWithPnMapping=s}),98);
__d("WAWebDBEphemeralMessage",["WALogger","WATimeUtils","WAWebAppTracker","WAWebDBMessageDelete","WAWebEphemeralKeepInChatUtils","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredMessages started"]))).tags("ephemeral-messages");var a=(yield d("WAWebSchemaMessage").getMessageTable().lessThan(["expiredTimestamp"],d("WATimeUtils").unixTime(),{shouldDecrypt:!1}));a=a.filter(function(a){return!d("WAWebEphemeralKeepInChatUtils").isKept(a.kicState)});if(a.length===0)return[];d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.PurgeEphemeral);yield d("WAWebDBMessageDelete").removeMessagesFromHistory(a.map(function(a){return a.id.toString()}))["finally"](function(){return d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.PurgeEphemeral)});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredMessages completed"]))).tags("ephemeral-messages");return a});return j.apply(this,arguments)}function c(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.PurgeEphemeral);return d("WAWebDBMessageDelete").removeMessagesFromHistory(a.map(function(a){return a.id.toString()}))["finally"](function(){return d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.PurgeEphemeral)})});return k.apply(this,arguments)}g.pruneExpiredMessages=a;g.removeExpiredMessagesFromHistory=c}),98);
__d("WATopLevelDomains",[],(function(a,b,c,d,e,f){a=new Set(["aaa","abb","abbott","abogado","abudhabi","ac","academy","accountant","accountants","ad","adult","ae","aero","af","afl","africa","ag","agency","ai","aig","airforce","al","alsace","am","amazon","amex","amsterdam","android","ao","apartments","app","apple","ar","arab","archi","army","arpa","art","as","asia","associates","at","au","auction","audi","audio","auspost","auto","autos","aw","aws","ax","az","ba","baby","band","bank","bar","barcelona","barclaycard","barclays","bargains","basketball","bauhaus","bayern","bb","bbva","bd","be","beauty","beer","berlin","best","bet","bf","bg","bh","bi","bible","bid","bike","bingo","bio","biz","bj","black","blackfriday","blog","blue","bm","bmw","bn","bnpparibas","bo","boats","bond","boo","boston","bot","boutique","box","br","bradesco","broker","brother","brussels","bs","bt","build","builders","business","buzz","bw","by","bz","bzh","ca","cab","cafe","cam","camera","camp","canon","capetown","capital","car","cards","care","career","careers","cars","casa","cash","casino","cat","catering","cba","cc","cd","center","ceo","cern","cf","cfd","cg","ch","charity","chase","chat","cheap","christmas","chrome","church","ci","citic","city","ck","cl","claims","cleaning","click","clinic","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","community","company","computer","condos","construction","consulting","contact","contractors","cooking","cool","coop","corsica","country","coupons","courses","cpa","cr","credit","cricket","crs","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dad","dance","date","dating","day","de","dealer","deals","delivery","deloitte","democrat","dental","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","diy","dj","dk","dm","do","doctor","dog","domains","download","durban","dvag","dz","earth","ec","eco","edeka","edu","education","ee","eg","email","energy","engineer","engineering","enterprises","epson","equipment","es","esq","estate","et","eu","eus","events","exchange","expert","exposed","express","extraspace","fail","faith","family","fan","fans","farm","fashion","feedback","fi","film","finance","financial","fish","fishing","fit","fitness","fj","fk","flights","flir","florist","flowers","fm","fo","foo","food","football","forex","forsale","forum","foundation","fox","fr","frl","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","game","games","garden","gay","gd","gdn","ge","gent","gf","gg","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmbh","gn","godaddy","gold","golf","goog","google","gop","gov","gp","gq","gr","graphics","gratis","green","group","gs","gt","guide","guru","gw","gy","hair","hamburg","haus","health","healthcare","help","hermes","hiphop","hk","hm","hn","hockey","holdings","holiday","homes","honda","horse","host","hosting","house","how","hr","ht","hu","ice","icu","id","ie","ikano","il","im","immo","immobilien","in","inc","industries","info","ing","ink","institute","insurance","insure","int","international","investments","io","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","java","jcb","je","jetzt","jewelry","jio","jm","jnj","jo","jobs","joburg","jp","kaufen","ke","kg","kh","ki","kids","kim","kitchen","kiwi","kn","koeln","komatsu","kp","kpmg","kr","krd","kred","kw","ky","kyoto","kz","la","land","landrover","lat","law","lawyer","lb","lc","leclerc","legal","lgbt","li","lidl","life","lighting","lilly","limited","limo","link","live","lk","llc","loan","loans","local","lol","london","love","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","makeup","man","management","mango","market","marketing","markets","mba","mc","md","me","media","meet","melbourne","meme","memorial","men","menu","mg","mh","miami","microsoft","mil","mk","ml","mm","mn","mo","mobi","moda","moe","mom","monash","money","monster","mortgage","moscow","motorcycles","mov","movie","mp","mq","mr","ms","mt","mu","museum","music","mv","mw","mx","my","mz","na","nab","nagoya","name","navy","nc","ne","net","network","neustar","new","news","next","nexus","nf","ng","ngo","ni","nico","nike","ninja","nl","no","np","nr","nrw","ntt","nu","nyc","nz","observer","okinawa","om","one","ong","onion","onl","online","ooo","orange","org","organic","ovh","pa","page","panasonic","paris","partners","parts","party","pe","pet","pf","pg","ph","pharmacy","phd","photo","photography","photos","pics","pictet","pictures","pink","pioneer","pizza","pk","pl","place","plumbing","plus","pm","pn","poker","politie","porn","post","pr","press","pro","productions","prof","promo","properties","property","ps","pt","pub","pw","py","qa","qpon","quebec","quest","racing","radio","re","realestate","realtor","recipes","red","rehab","reisen","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rio","rip","ro","rocks","rodeo","rs","rsvp","ru","rugby","ruhr","run","rw","ryukyu","sa","saarland","sale","salon","sandvik","sanofi","sap","sarl","saxo","sb","sbi","sbs","sc","scb","schmidt","school","schule","schwarz","science","scot","sd","se","seat","security","select","sener","services","sex","sexy","sg","sh","sharp","shell","shiksha","shoes","shop","shopping","show","si","singles","site","sk","ski","skin","sky","sl","sm","sn","sncf","so","soccer","social","software","solar","solutions","sony","soy","space","sport","sr","srl","ss","st","statebank","statefarm","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swiss","sx","sy","sydney","systems","sz","taipei","tatamotors","tatar","tattoo","tax","taxi","tc","td","team","tech","technology","tel","tennis","teva","tf","tg","th","theater","tickets","tienda","tips","tirol","tj","tk","tl","tm","tn","to","today","tokyo","tools","top","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","tt","tube","tui","tv","tw","tz","ua","ug","uk","university","uno","uol","us","uy","uz","va","vacations","vanguard","vc","ve","vegas","ventures","vet","vg","vi","video","vin","vip","vision","vivo","vlaanderen","vn","vodka","vote","voto","voyage","vu","wales","wang","watch","webcam","weber","website","wedding","weir","wf","wien","wiki","williamhill","win","wine","woodside","work","works","world","ws","wtf","xin","xyz","yachts","yandex","ye","yoga","yokohama","youtube","yt","za","zappos","zara","zip","zm","zone","zw","\u0431\u0435\u043b","\u0434\u0435\u0442\u0438","\u043c\u043e\u0441\u043a\u0432\u0430","\u043e\u043d\u043b\u0430\u0439\u043d","\u0440\u0443\u0441","\u0440\u0444","\u0443\u043a\u0440","\u092d\u093e\u0930\u0924","\u09ad\u09be\u09f0\u09a4","\u0aad\u0abe\u0ab0\u0aa4","\u0b2d\u0b3e\u0b30\u0b24","\u30bb\u30fc\u30eb","\u4e2d\u56fd","\u516c\u53f8","\u6211\u7231\u4f60","\u79fb\u52a8","\u7f51\u5740","\u7f51\u7ad9","\u7f51\u7edc","\ub2f7\ub137","\ub2f7\ucef4","\ud55c\uad6d"]);f.TLD=a}),66);
/**
 * License: https://www.facebook.com/legal/license/NKF0mBOyBt2/
 */
__d("punycode-2.1.1",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a=2147483647,b=36,c=1,d=26,e=38,f=700,h=72,i=128,j="-",k=/^xn--/,l=/[^\0-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,n={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},o=b-c,p=Math.floor,q=String.fromCharCode;function r(a){throw new RangeError(n[a])}function s(a,b){var c=[],d=a.length;while(d--)c[d]=b(a[d]);return c}function t(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]);a=a.replace(m,".");c=a.split(".");a=s(c,b).join(".");return d+a}function u(a){var b=[],c=0,d=a.length;while(c<d){var e=a.charCodeAt(c++);if(e>=55296&&e<=56319&&c<d){var f=a.charCodeAt(c++);(f&64512)==56320?b.push(((e&1023)<<10)+(f&1023)+65536):(b.push(e),c--)}else b.push(e)}return b}var v=function(a){return String.fromCodePoint.apply(String,a)},w=function(a){if(a-48<10)return a-22;if(a-65<26)return a-65;return a-97<26?a-97:b},x=function(a,b){return a+22+75*(a<26)-((b!=0)<<5)},y=function(a,c,g){var h=0;a=g?p(a/f):a>>1;a+=p(a/c);for(;a>o*d>>1;h+=b)a=p(a/o);return p(h+(o+1)*a/(a+e))},z=function(e){var f=[],g=e.length,k=0,l=i,m=h,n=e.lastIndexOf(j);n<0&&(n=0);for(var o=0;o<n;++o)e.charCodeAt(o)>=128&&r("not-basic"),f.push(e.charCodeAt(o));for(o=n>0?n+1:0;o<g;){n=k;for(var q=1,s=b;;s+=b){o>=g&&r("invalid-input");var t=w(e.charCodeAt(o++));(t>=b||t>p((a-k)/q))&&r("overflow");k+=t*q;var u=s<=m?c:s>=m+d?d:s-m;if(t<u)break;t=b-u;q>p(a/t)&&r("overflow");q*=t}u=f.length+1;m=y(k-n,u,n==0);p(k/u)>a-l&&r("overflow");l+=p(k/u);k%=u;f.splice(k++,0,l)}return String.fromCodePoint.apply(String,f)},A=function(e){var f=[];e=u(e);var g=e.length,k=i,l=0,m=h;for(var n of e)n<128&&f.push(q(n));n=f.length;var o=n;n&&f.push(j);while(o<g){var s=a;for(var t of e)t>=k&&t<s&&(s=t);t=o+1;s-k>p((a-l)/t)&&r("overflow");l+=(s-k)*t;k=s;for(s of e){s<k&&++l>a&&r("overflow");if(s==k){var v=l;for(var w=b;;w+=b){var z=w<=m?c:w>=m+d?d:w-m;if(v<z)break;var A=v-z,B=b-z;f.push(q(x(z+A%B,0)));v=p(A/B)}f.push(q(x(v,0)));m=y(l,t,o==n);l=0;++o}}++l;++k}return f.join("")},B=function(a){return t(a,function(a){return k.test(a)?z(a.slice(4).toLowerCase()):a})},C=function(a){return t(a,function(a){return l.test(a)?"xn--"+A(a):a})};v={version:"2.1.0",ucs2:{decode:u,encode:v},decode:z,encode:A,toASCII:C,toUnicode:B};g.exports=v}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("punycode",["punycode-2.1.1"],(function(a,b,c,d,e,f){e.exports=b("punycode-2.1.1")()}),null);
__d("WALinkify",["WALogger","WATopLevelDomains","punycode"],(function(a,b,c,d,e,f,g){"use strict";var h;e=Array.from(d("WATopLevelDomains").TLD).join("|");f="(?:http|https)://|mailto:";var i=/^https?:\/\/$/gi,j="\\w|[^\\s\0-\x7f\xab\xbb\u2018\u2019\u201c\u201d]|%[0-9a-f][0-9a-f]";e=e+"|xn--(?:"+j+")+";var k="(?:"+j+")|(?:"+j+")(?:"+j+"|-)*(?:"+j+")",l="(?!_)(?:(?:"+k+")\\.)+("+e+")(?!\\."+k+")",m=":\\d{1,5}",n="@!.?,(\\[{<\xab\u2018\u201c:";j="(?:"+j+"|[^\\s%])";var o="/"+j+"*?";n="["+n+"]*(?!"+j+"|#)";var p="\\?(?!"+n+")"+j+"*?";j="#"+j+"*?";var q="0-9a-z!#$%&'*+/=?^_`{|}~\\-";q="\\b\\w["+q+"]*(?:\\.["+q+"]+)*";var r="^|\\W\\.|[^/\\w.]|_";r="("+r+")("+f+")?("+q+"@)?("+l+")(?:(?!"+k+")|(?=_))(?:(?=[^:/?#])|("+m+")?("+o+")?("+p+")?("+j+")?(?="+n+"))";var s=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8,A=9,B=new Map([[34,34],[41,40],[62,60],[93,91],[125,123],[187,171],[8217,8216],[8221,8220]]),C=new Map([[34,34],[40,41],[60,62],[91,93],[123,125],[171,187],[8216,8217],[8220,8221]]),D=new RegExp(""+r,"ig"),E=new RegExp("\\.(?:"+e+")","i");function F(a){try{return D.exec(a)}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["text size: ",", error: ",""])),a.length,String(b)).devConsole(b).sendLogs("linkify-regex-error");return null}}function a(a,b){b===void 0&&(b=!1);if(!E.test(a))return[];D.lastIndex=0;var c=[],d;while(d=F(a)){d=H(d,b);d&&c.push(d)}return c}function G(a,b){b===void 0&&(b=!1);if(!E.test(a))return null;D.lastIndex=0;return H(F(a),b)}function H(a,b){b===void 0&&(b=!1);if(!a)return null;var e=a[s].length,f=a[0],g=a.index+e,h=a.index,j=a[s]==="_";if(j&&h-1&&/\S/.test(a.input[h-1]))return null;j=a[w];if(j&&j.startsWith("xn--")&&!d("WATopLevelDomains").TLD.has(c("punycode").toUnicode(j)))return null;if(a[x]){h=parseInt(a[x].slice(1),10);if(a[x][1]==="0"||!(0<h&&h<1<<16))return null}j=[A,z,y].find(function(b){return a&&a[b]})||0;if(j){h=[];var k=a[j];k.slice(-1)==="_"&&f[g-1]==="_"&&(f=f.slice(0,-1),a[j]=k=k.slice(0,-1));var l=0,m=0;for(var n=0;n<k.length;n++){var o=k.charCodeAt(n);o===m?(m=h.pop()||0,m===0&&(l=n)):C.has(o)?(m!==0&&h.push(m),m=C.get(o)):B.has(o)||m===0&&(l=n)}if(l!==k.length-1){o=a.slice(t,j);o.splice(w-t,1);f=o.filter(function(a){return a}).join("")+k.slice(0,l+1);D.lastIndex=g+f.length}else f=f.slice(e)}else f=f.slice(e);n=f;h=a[t];m=Boolean(h&&h.match(i));if(b&&!m)return null;h?h=h.toLowerCase():(n.toLowerCase().indexOf("irc.")===0?h="irc://":n.toLowerCase().indexOf("ftp.")===0?h="ftp://":a[u]?h="mailto:":h="http://",n=h+n);j=a[v];return{href:n,url:f,index:g,input:a.input,scheme:h,username:a[u],domain:j,port:a[x],path:a[y],params:a[z],anchor:a[A],isHttp:m}}function b(a){var b=G(a);return b&&b.url===a&&b.scheme==="mailto:"&&b.username!=null&&b.username!==""&&(b.params==null||b.params==="")&&(b.anchor==null||b.anchor==="")?b:null}g.findLinks=a;g.findLink=G;g.validateEmail=b}),98);
__d("WALanguagesAndRegions",[],(function(a,b,c,d,e,f){"use strict";a={fub:["237","235","234"],af:["237","27"],agq:["237"],yay:["234"],bss:["237"],agg:["675"],ast:["34"],avu:["243","211"],az:["994"],bkc:["237","241"],ksf:["237"],bfd:["237"],bjt:["221"],bcn:["234"],bas:["237"],bsq:["231"],bkv:["234"],bom:["234"],btt:["234"],bin:["234"],bmq:["226","223"],bs:["387","385","383","382","381"],fue:["229","228"],br:["33"],bys:["234"],bwr:["234"],cky:["234"],ca:["376","33","39","34"],tzm:["212"],fuq:["234"],ckl:["234"],asg:["234"],co:["33","39"],crh:["7"],hr:["387","385","383","382","381"],mfn:["234"],cs:["420","421"],dbq:["237","234"],dnj:["225","231"],dzg:["235","227"],ddn:["229"],dgh:["234"],dow:["237"],dua:["229"],nl:["297","32","599","31","1","597"],igb:["234"],etr:["675"],enn:["234"],kgy:["675"],et:["372"],ich:["234"],ee:["229","233","228"],ewo:["237"],fo:["298"],fmp:["237"],fi:["358","46"],fr:["32","229","226","257","237","1","236","242","243","235","269","253","240","33","241","509","225","352","261","223","377","227","250","221","248","41","228","678"],fur:["39"],ff:["237","224","222","221"],gaj:["675"],gl:["34"],gby:["234"],gba:["236"],gmm:["237"],de:["43","32","49","423","352","41"],tof:["675"],god:["225"],ank:["234"],gkn:["234"],gux:["229","226","227","228"],gde:["237","234"],gkp:["224"],kl:["299"],jgk:["234"],ha:["229","237","235","233","225","227","234","249","228"],haw:["1"],hbb:["234"],hu:["36"],dud:["234"],jab:["234"],iby:["234"],is:["354"],idu:["234"],ig:["240"],ige:["234"],ikx:["256"],ikk:["234"],ikq:["234"],smn:["358"],ga:["353","44"],atg:["234"],izi:["234"],dyo:["220","221"],jbu:["237","234"],kab:["213"],kea:["238"],tbd:["675"],hig:["234"],kai:["234"],kkj:["237","236","242"],kzr:["237","235"],naq:["264"],geb:["675"],okr:["234"],ksh:["49"],ses:["223"],khq:["223"],kun:["291","251"],kup:["675"],kub:["237","234"],kpe:["224","231"],nmg:["237","240"],ku:["963","90"],lkt:["1"],hia:["234"],lag:["255"],lv:["371"],lmp:["237"],ln:["242","243"],liv:[],lt:["370"],yaz:["234"],nds:["55","49","31"],dsb:["49"],lu:["243"],lb:["32","33","49","352"],mda:["234"],mb:["261"],mt:["356"],mi:["64"],arn:["56"],mas:["254","255"],ffm:["223"],mql:["229","228"],mbo:["237"],mbu:["234"],mif:["237"],mzm:["234"],mua:["237","235"],sur:["234"],nv:["1"],anc:["234"],nnh:["237"],jgo:["237"],fuv:["237","234"],nin:["234"],dgi:["226"],se:["358","46","47"],nso:["27"],ann:["234"],oc:["33","39","377","34"],pbi:["237"],pip:["234"],pl:["48"],pt:["244","55","238","240","245","853","258","351","239","670"],prg:[],fuf:["224","223","221","232"],qu:["54","591","57","593","51"],ro:["373","40"],cla:["234"],sav:["221"],sg:["236","235","243"],gd:["44"],seh:["258"],sr:["387","385","383","382","381"],sh:["387","385","383","382","381"],srr:["220","221"],sch:["39"],sld:["226"],sms:["358"],sk:["420","421"],sl:["386"],sok:["235"],es:["54","501","591","56","57","506","53","593","503","240","502","504","52","505","507","595","51","34","1","598","58"],srn:["597"],gsw:["43","33","49","423","41"],shi:["212"],tal:["234"],tmh:["223"],taq:["226","223"],tan:["234"],twq:["227"],blt:["856","84"],yer:["234"],tuq:["235","218","227","234"],ttr:["234"],tik:["237"],to:["676"],dts:["223"],kdl:["234"],tsw:["234"],tr:["90"],tk:["993"],hsb:["49"],vai:["231","232"],vi:["855","84"],vo:[],vut:["237","234"],wja:["234"],wa:["32"],wae:["43","39","423","41"],wji:["234"],cy:["44"],fy:["31"],fuh:["229","226","227"],yba:["234"],yav:["237"],yle:["675"],yll:["675"],yo:["229","234"],dje:["227"],gnd:["237"]};f.LANGUAGE_TO_REGIONS=a}),66);
__d("WAIdn",["WALanguagesAndRegions","WAStringz"],(function(a,b,c,d,e,f,g){"use strict";var h={:["ast","ksf","bas","ca","cs","dua","nl","ee","ewo","fo","fr","gl","kl","hu","is","ga","dyo","kea","kkj","nmg","lkt","lag","ln","lu","mas","nnh","jgo","pt","qu","seh","sk","es","to","vai","vi","wae","cy","fy","yav","yo"],:["af","agq","bss","bfd","bas","bkv","btt","nl","igb","ewo","fr","fur","gaj","gby","kl","jab","atg","jbu","kkj","naq","ksh","ku","nmb","lmp","ln","mda","mg","mas","mzm","jgo","nin","ann","ro","sg","scn","srn","yer","tr","wa","cy","yav","yle"],:["agg","ast","az","br","ca","co","cs","nl","etr","et","fr","gl","de","tof","god","hu","tbd","geb","ksh","kup","nds","lb","arn","oc","sg","sk","es","gsw","dts","tr","tk","vo","wa","wae","fy","yll"],:["mt"],:["agq","bss","bfd","bas","bkv","btt","ddn","igb","kjy","ich","gux","haw","jab","iby","idu","jbu","kub","nmg","lv","mda","mi","mas","mql","nin","prg","gd","to","yba","yav"],:["az","crh","tr"],:["lv"],:["dsb","nv","pl","hsb"],:["bs","hr","cs","dzg","et","fi","smn","geb","khq","ses","kun","lkt","lv","lt","dsb","se","nso","prg","sr","sh","sms","sk","sl","taq","twq","tuq","hsb","wqe","dje"],:["ckl","ank","ha","ikx","kai","hia","mbu","anc","nin","pip","tal","tan","wja","wji"],:["naq"],:["naq"],:["liv"],:["fmp","dud","tmh"],:["fub","yay","bkc","bjt","bcn","bas","bsq","bmq","fue","bys","bwr","cky","fuq","ckl","asg","dbq","dnj","dgh","dow","dua","enn","ff","gby","gba","gmm","ank","gde","gkp","jgk","ha","hbb","ikx","kkj","hig","kzr","kai","kpe","nmg","hia","ffm","mbo","mbu","mif","mzm","mua","sur","anc","fuv","nin","dgi","pbi","pip","fuf","cla","sav","srr","sld","sok","tal","tan","yer","ttr","tik","kdl","tsw","vai","vut","wja","wji","fuh","gnd"],:["tzm","kab","okr","shi","tmh","taq"],:["tzm","kab","shi"],:["tzm","kab","shi","tmh","taq"],:[],:["izi","yaz","blt","vi"],:["yay","bom","bin","mfn","dzg","igb","enn","gkn","iby","ikk","ikw","izi","okr","yaz","blt","tan","tuq","vi","yo"],:["avu","mfn","igb","enn","iby","ig","ige","ikk","ikw","izi","okr","blt","tan","vi"]},i=new Set(["abq","ab","ady","av","az","ba","be","bs","bg","bua","ce","ckt","cu","cv","crh","dar","dng","myv","evn","gag","inh","kbd","xal","krc","kaa","kk","kjh","kca","ky","kv","koi","kpy","kum","lbe","lez","mk","mns","chm","mdf","mn","ttt","gld","yrk","nog","os","ru","rue","sr","sh","cjs","alt","tab","tg","tt","tkr","tk","tyv","ude","udm","uk","uz","mrj","sah"]),j=new Set(["374","994","375","387","359","995","7","383","996","389","373","976","382","381","992","993","380","998"]),k="\u0430\u0432\u0433\u0435\u043a\u043c\u043d\u043e\u0440\u0441\u0442\u0443\u0445\u0448\u0449\u044c\u0455\u0456\u0458\u0461\u0475\u04af\u04bb\u04cf\u0501\u051b\u051d\u0527\ua699";function l(a){return i.has(a)}function m(a){return j.has(a)}function n(a){return k.includes(a)}var o=new RegExp("^[a-z0-9-]+$"),p=2;function a(a,b,c,e){a=a.split(".");var f,g=!1;a.forEach(function(a){g=!a.match(o);if(g)if(!f)f=a;else return null});if(f==null||g)return null;a=[];var i=!0,j=d("WAStringz").toArray(f);for(var k=0;k<j.length;k++){var q=j[k];i=i&&n(q);if(i)continue;if(h[q])if(a.length>=p)return null;else a.push(q)}if(i){if(m(c)||m(b))return null;return e.some(function(a){return l(a)})?null:new Set(j)}if(!a.length)return null;q=a.filter(function(a){var f=h[a];if(f==null)return!1;if(e.some(function(a){return f.includes(a)}))return!1;a=new Set();for(var g=0;g<f.length;g++){var i=d("WALanguagesAndRegions").LANGUAGE_TO_REGIONS[f[g]];if(i==null)continue;for(var j=0;j<i.length;j++)a.add(i[j])}return a.has(c)||a.has(b)?!1:!0});return q.length?new Set(q):null}g.findSuspiciousCharacters=a}),98);
__d("WAPhoneFindCC",[],(function(a,b,c,d,e,f){"use strict";var g=/^(1|2[07]|3[0-469]|4[013-9]|5[1-8]|6[0-6]|7|8[1246]|9[0-58])/;function a(a){return h(a)}function h(a){var b=a.match(g);if(b)return b[0];else return a.length>=3?a.substring(0,3):a}function b(a){a=a.match(/\d+/g);return a!=null?a.join(""):""}f.phoneCC=a;f.findCC=h;f.extractDigits=b}),66);
__d("WASuspiciousLinks",["WAIdn","WAJids","WAPhoneFindCC"],(function(a,b,c,d,e,f,g){"use strict";var h=/^(?:https?:\/\/)?([^/?#]+)(?:[/?#]|$)/i,i="ZZ";function a(a,b,c,e){a=a.match(h);a=a&&a[1];if(a==null)return null;c=d("WAPhoneFindCC").phoneCC(c);var f;if(b==="whatsapp")f="";else{var g=d("WAJids").interpretAndValidateJid(b.toString());f=g.jidType!=="lidUser"?d("WAPhoneFindCC").phoneCC(d("WAJids").toPhoneUserJid(b)):i}g=e.map(function(a){return a.toLowerCase()});return d("WAIdn").findSuspiciousCharacters(a,f,c,g)}g.findSuspiciousCharacters=a}),98);
__d("WAWebLinkify",["WAJids","WALinkify","WASuspiciousLinks","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){function a(a,b,c){b===void 0&&(b=!1);a=d("WALinkify").findLinks(a,b);return a.map(function(a){return i(a,c)})}function h(a,b,c){b===void 0&&(b=!1);a=d("WALinkify").findLink(a,b);if(a==null)return;return i(a,c)}function b(a){return a.body!=null&&h(a.body,!0)!=null}function i(a,b){var c=d("WAWebUserPrefsMeUser").getMaybeMePnUser(),e=null;if(b&&c){b=b.isLid()?d("WAJids").toLidUserJid(b.user):d("WAJids").toPhoneUserJid(b.user);e=d("WASuspiciousLinks").findSuspiciousCharacters(a.domain,b,d("WAJids").toPhoneUserJid(c.user),[])}return babelHelpers["extends"]({},a,{suspiciousCharacters:e!=null?e:void 0})}g.findLinks=a;g.findLink=h;g.hasHttpLink=b}),98);
__d("WAWebDBEncryptMultipleMsgs",["Promise","WAAsyncSleep","WALogger","WAWebBrokerGlobalAppState","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDbEncryptionKey","WAWebLinkify","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="DroppingMsgRowDueToLogout",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c===void 0&&(c=!1);yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();yield new(l||(l=b("Promise")))(function(a){return self.setTimeout(a,0)});if(c){c=[];for(var e=0;e<a.length;e++)try{var f=a[e];f=(yield o(f,e));c.push(f)}catch(b){if(b instanceof m)throw b;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow failed for msg: ",""])),a[e].id.remote).tags("message-store");d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow with throttle failed with error: ",", message: ",", stack: ",""])),b.name,b.message,b.stack).tags("message-store").devConsole(b)}}else{f=(yield (l||(l=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield o(a)["catch"](function(b){if(b instanceof m)throw b;d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow failed for msg: ",""])),a.id.remote).tags("message-store");d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["processAndEncryptSingleMsgRow without throttle failed with error: ",", message: ",", stack: ",""])),b.name,b.message,b.stack).tags("message-store").devConsole(b)})["finally"](function(){return void 0}));return b});return function(b){return a.apply(this,arguments)}}())));c=f.filter(Boolean)}return c});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(c("WAWebBrokerGlobalAppState").isLogoutInProgress)return(l||(l=b("Promise"))).reject(new m());e!=null&&(yield d("WAAsyncSleep").asyncSleepAfterGivenLoopIteration(e,35,100));e=d("WAWebSchemaMessage").getMessageTable();var f=d("WAWebDBMessageUtils").getVcardWids(a),g=d("WAWebDBMessageSerialization").dbRowFromMessage(a);e=(yield e.preflightEncryptSingleRecord(babelHelpers["extends"]({},g)));g=babelHelpers["extends"]({},g,e);f!=null&&(g.vcardWAids=f);return[g,d("WAWebLinkify").hasHttpLink(a)]});return p.apply(this,arguments)}g.DroppingMsgRowDueToLogout=m;g.encryptMultipleDBMsgs=a;g.processAndEncryptSingleMsgRow=o}),98);
__d("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").UserPrefs.PhoneNumberHidingThreadPromotionMigrationComplete,!0)}function b(){return c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").UserPrefs.PhoneNumberHidingThreadPromotionMigrationComplete)===!0}g.setPhoneNumberHidingThreadPromotionMigrationAsComplete=a;g.isPhoneNumberHidingThreadPromotionMigrationComplete=b}),98);
__d("WAWebWamEnumWebcChatCreateCreationMethod",[],(function(a,b,c,d,e,f){a=Object.freeze({MISSING_WHEN_SAVING_MESSAGE:0});f.WEBC_CHAT_CREATE_CREATION_METHOD=a}),66);
__d("WAWebWebcChatCreateWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcChatCreateCreationMethod"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcChatCreate:[6132,{creationMethod:[1,d("WAWebWamEnumWebcChatCreateCreationMethod").WEBC_CHAT_CREATE_CREATION_METHOD],noCreated:[2,d("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1,1],"regular"]},{WebcChatCreate:[]});g.WebcChatCreateWamEvent=a}),98);
__d("WAWebDBMessageBulkHelper",["Promise","WALogger","WALoggerUtils","WAWebApiContact","WAWebCurrentUser","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebDBStoreNewsletterEncryptedMsgs","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebUserPrefsMeUser","WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration","WAWebUsernameGatingUtils","WAWebUsernameTypes","WAWebWamEnumWebcChatCreateCreationMethod","WAWebWebcChatCreateWamEvent","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u;function a(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield y(a,b)}catch(c){if(d("WAWebDBStoreEncryptedMsgs").isEligibleForFallback(a.length,c))yield y(a,b,!0);else throw c}});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{a=a.filter(function(a){var b=a.id.participant;return b&&b.isLid()&&d("WAWebLidMigrationUtils").toPn(b)==null&&a.id.remote.isGroup()&&!d("WAWebUserPrefsMeUser").isMeAccount(b)});if(d("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var c=a.map(function(a){return a.id.participant}).filter(Boolean);if(c.length>0){c=(yield d("WAWebApiContact").bulkGetContactRecord(c));var e=c.reduce(function(a,b){(b==null?void 0:b.id)!=null&&(b==null?void 0:b.username)!=null&&a.add(b.id);return a},new Set());a=a.filter(function(a){a=a.id.participant;return a&&!e.has(a.toString())})}}if(a.length===0)return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: has some participants with missing Lids"])));a.forEach(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: Missing PN mappings while saving Lid group messages. type: ",", subtype: ",""])),a.type,a.subtype)});c=new Set(a.map(function(a){return a.id.remote.toString()}));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: number affected groups: ",""])),c.size);a=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().anyOf(["id"],Array.from(c)));a.forEach(function(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: Missing PN mappings while saving Lid group messages. is announce: ",", is parent: ",""])),a.announce,a.isParentGroup)});c=a.filter(function(a){return(a==null?void 0:a.announce)===!1});if(c.length===0)return;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: number non Cag Groups: ",""])),c.length);a=c.filter(function(a){return a==null?void 0:a.isLidAddressingMode}).length;c=c.length-a;d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["logMissingGroupParticipantLids: Missing PN mappings while saving Lid group messages. lid groups count: ",", pn groups count: ",",\n          is history: ",""])),a,c,(a=b==null?void 0:b.toString())!=null?a:"na").sendLogs("no-pn-mapping-for-group-lid-message")}catch(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Could not log missing Lids ",""])),a).sendLogs("could-not-log-missing-lids")}});return x.apply(this,arguments)}function y(a,b,c){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!1);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["persistNewMessagesInBulk: ",""])),a.map(function(a){var b;return a==null||(b=a.id)==null?void 0:b.id}));void w(a);a=(yield (u||(u=b("Promise"))).all([B(a),d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(a,!1)]));var f=a[0],g=a[1];yield d("WAWebModelStorageUtils").getStorage().lock(["chat","fts-indexing-queue","message","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a[1];a[2];a[3];d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["persistNewMessagesInBulk: bulkCreateOrMerge"]))).tags("missing-lid");yield b.bulkCreateOrMerge(f);yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(g,c,!1,e)});return function(b){return a.apply(this,arguments)}}())});return z.apply(this,arguments)}function e(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (u||(u=b("Promise"))).all([B(a),d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(a,!1)]));var c=a[0],e=a[1];return d("WAWebModelStorageUtils").getStorage().lock(["chat","message","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["persistNewNewsletterMessagesInBulk: bulkCreateOrMerge"]))).tags("missing-lid");yield a.bulkCreateOrMerge(c);yield d("WAWebDBStoreNewsletterEncryptedMsgs").storeEncryptedNewsletterMessages(e)});return function(b){return a.apply(this,arguments)}}())});return A.apply(this,arguments)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a.forEach(function(a){var c=a.id,e=c.remote.toString();if(!d("WAWebMsgGetters").getIsStatus(a)&&d("WAWebMsgGetters").getIsUnreadType(a)){var f=b.get(e)||{unread:0,t:0,unreadMentionsOfMe:[]};if(!c.fromMe){f.unread+=1;if(d("WAWebMsgGetters").getIsImportantMessage(a)){c={id:a.id.toString(),timestamp:a.t};f.unreadMentionsOfMe?f.unreadMentionsOfMe.push(c):f.unreadMentionsOfMe=[c]}}a.t!=null&&a.t>f.t&&(f.t=Math.max(a.t,f.t));b.set(e,f)}});var e=Array.from(b.keys());a=(yield d("WAWebSchemaChat").getChatTable().bulkGet(e));var f=a.map(function(a,c){var f,g;c=e[c];var h=b.get(c),i=(h==null?void 0:h.unread)||0,j=Math.max(0,a?a.unreadCount:0),k=(h==null?void 0:h.t)||void 0;a&&a.t!=null&&((k==null||a.t>k)&&(k=a.t));f=(f=a==null?void 0:a.archiveAtMentionViewedInDrawer)!=null?f:!1;h=(h=h==null?void 0:h.unreadMentionsOfMe)!=null?h:[];g=(g=a==null?void 0:a.unreadMentionsOfMe)!=null?g:[];h.length>0&&(f=!1);h=h.concat(g);g={id:c,unreadCount:j+i,t:k,unreadMentionsOfMe:h,archiveAtMentionViewedInDrawer:f};j=d("WAWebWidFactory").createWid(c);d("WAWebLidMigrationUtils").shouldHaveAccountLid(j)&&(a==null?(g.accountLid=d("WAWebLidMigrationUtils").toUserLidOrThrow(j).toString(),j.isLid()&&(d("WAWebApiContact").getPhoneNumber(j)!=null||d("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").isPhoneNumberHidingThreadPromotionMigrationComplete()?g.lidOriginType=d("WAWebUsernameTypes").LidOriginType.GENERAL:g.lidOriginType=d("WAWebUsernameTypes").LidOriginType.PNH_CTWA)):a.accountLid==null&&(d("WAWebLidMigrationUtils").logLidMetadata(),d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["getUpdatedChatMetadata: chat "," from DB has no account_lid"])),j.toLogString()).sendLogs("chat-in-db-has-no-account-lid").tags("missing-lid")));return g});d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][msg-cache]: storing chat updates for "," chats"])),f.length);var g=a.some(function(a){return a==null});if(g){var h=new Set(a.map(function(a){return a==null?void 0:a.id}));g=e.filter(function(a){return c("WAWebWid").isRegularUserNoImply(a)&&!h.has(a)}).length;g>0&&(new(d("WAWebWebcChatCreateWamEvent").WebcChatCreateWamEvent)({creationMethod:d("WAWebWamEnumWebcChatCreateCreationMethod").WEBC_CHAT_CREATE_CREATION_METHOD.MISSING_WHEN_SAVING_MESSAGE,noCreated:g}).commit(),d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][msg-cache]: missing chats when saving message: ",""])),g).sendLogs("missing-chats-when-saving-message",{sampling:c("gkx")("26258")?d("WALoggerUtils").dynamicLoggingSampling(1e-4):1}))}return f});return C.apply(this,arguments)}g.persistNewMessagesInBulk=a;g.logMissingGroupParticipantLids=w;g.persistNewNewsletterMessagesInBulk=e}),98);
__d("WAWebDBDeleteAssociatedMsgsByMsgKey",["WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(a)}function b(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemoveByIndex(["msgKey"],a)}g.bulkDeleteMessagesByMsgKeyAndAssociationType=a;g.bulkDeleteMessagesByMsgKeys=b}),98);
__d("WAWebDBGetAssociatedMsgsByParentMsgKey",["WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().anyOf(["parentMsgKey"],a.map(String))}g.bulkGetMessagesByParentMsgKey=a}),98);
__d("WAWebMessageAssociationGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("message_association_infra_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("futureproof_associated_child_enabled")}g.isMessageAssociationInfraEnabled=a;g.isFutureproofAssociatedChildEnabled=b}),98);
__d("WAWebDBMessageDelete",["Promise","WALogger","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBGetAssociatedMsgsByParentMsgKey","WAWebDBQueryAndRemoveLocalLabelAssociation","WAWebDBReportingTokenUtils","WAWebDBStoreRevokeMsgs","WAWebMessageAssociationGatingUtils","WAWebModelStorageInitialize","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebSchemaLabelAssociation","WAWebSchemaMessage","asyncToGeneratorRuntime","cr:375"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;f=(f=b("cr:375"))!=null?f:{};var n=f.ftsLightClient;function a(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e===void 0&&(e={deleteAssociatedMsgs:!0});e=e;var f=e.deleteAssociatedMsgs;if(a.length===0)return;var g=[];return d("WAWebModelStorageInitialize").initializeWithoutGKs().then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new Set(a),e=[],h=[];if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var i=(yield d("WAWebDBGetAssociatedMsgsByParentMsgKey").bulkGetMessagesByParentMsgKey(Array.from(a).map(function(a){return c("WAWebMsgKey").fromString(a)})));i.forEach(function(a){h.push([a.msgKey,a.associationType]),b.add(a.msgKey)})}i=Array.from(b);yield d("WAWebSchemaMessage").getMessageTable().bulkGet(i,!1).then(function(a){a.forEach(function(a){(a==null?void 0:a.rowId)!=null&&e.push(String(a.rowId));var b=a==null?void 0:a.associationType;b!=null&&a!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&h.push([a.id.toString(),b]);b=a==null?void 0:a.botResponseTargetId;var c=a==null?void 0:a.internalId;(a==null?void 0:a.botPluginSearchProvider)!=null&&(a==null?void 0:a.botPluginSearchUrl)!=null&&b!=null&&c!=null&&g.push({internalId:c,targetId:b})})});return{deleteMsgIdsSet:b,msgRowIds:e,deleteAssociationMappings:h}})).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.deleteMsgIdsSet,e=a.deleteAssociationMappings;yield d("WAWebModelStorageUtils").getStorage().lock(["message","label-association","chat","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=Array.from(c);var f=[d("WAWebSchemaMessage").getMessageTable().bulkRemove(a)];a=d("WAWebDBQueryAndRemoveLocalLabelAssociation").queryAndRemoveLocalLabelAssociation(a.map(function(a){return{associationId:a,type:d("WAWebSchemaLabelAssociation").LabelAssociationType.Message}}));f.push(a);if(e.length>0&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[association-infra] Removing associations after delete for self"])));a=d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeyAndAssociationType(e);f.push(a)}try{g.length>0&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[bot] Removing bot plugin msgs after delete for self"]))),yield d("WAWebDBStoreRevokeMsgs").findAndDeleteAssociatedPluginMsg(g))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[bot] findAndDeleteAssociatedPluginMsg failed with error: ",", stack: ",""])),a.name,a.stack).devConsole(a).sendLogs("Plugin carousel delete failed")}return(m||(m=b("Promise"))).all(f)});return function(b){return a.apply(this,arguments)}}());return{deleteMsgIdsSet:c,msgRowIds:a.msgRowIds}});return function(b){return a.apply(this,arguments)}}()).then(function(a){var b=a.deleteMsgIdsSet;a=a.msgRowIds;a.length>0&&(n==null||n.purge(a)["catch"](c("WAWebNoop")));return b}).then(function(a){a=Array.from(a);d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["removeMessagesFromHistory: delete "," messages"])),String(a.length));void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(a,{removeWholeRow:!0})})["catch"](function(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["removeMessagesFromHistory: error ",""])),a);throw a})});return o.apply(this,arguments)}function e(a){a=a.filter(function(a){return a.includes("status@broadcast")});return a.length>0?d("WAWebSchemaMessage").getMessageTable().bulkRemove(a):(m||(m=b("Promise"))).resolve()}g.removeMessagesFromHistory=a;g.removeStatusMessage=e}),98);
__d("WAWebDBMsgUtils",["$InternalEnum","WANullthrows","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebE2EProtoUtils","WAWebLid1X1MigrationGating","WAWebMsgKey","WAWebSchemaMessage","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Message:1,MessageEdit:2});function a(a,b){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a).then(function(a){return a.filter(Boolean).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a,b)})})}function e(a,b){var e=[];a.forEach(function(a){var d=new(c("WAWebMsgKey"))({fromMe:!0,remote:b,id:a});e.push(d.toString());d=new(c("WAWebMsgKey"))({fromMe:!1,remote:b,id:a});e.push(d.toString())});return d("WAWebSchemaMessage").getMessageTable().startsWithAnyOf(["id"],e)}function f(a,b){var e;a instanceof c("WAWebMsgKey")?e=a.toString():e=a;return d("WAWebSchemaMessage").getMessageTable().get(e).then(function(a){return!a?null:d("WAWebDBMessageSerialization").messageFromDbRow(a,b)})}function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.length===0)return b;var e=b;d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&c("WAWebWid").isUser(a)&&!c("WAWebWid").isStringLid(a)&&(e=b.map(function(b){var c=b.timestamp;b=b.key;var d={};c!=null&&(d.timestamp=c);b!=null&&(d.key=babelHelpers["extends"]({},b,{remoteJid:a}));return d}));e=e.map(function(a){return d("WAWebE2EProtoUtils").protobufToMsgKey(c("WANullthrows")(a.key)).toString()});var f=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(e,!1));return b.filter(function(a,b){return f[b]!=null})});return j.apply(this,arguments)}function k(a){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a,!1).then(function(a){return a.map(Boolean)})}function l(a){return d("WAWebSchemaMessage").getMessageTable().between(["internalId"],d("WAWebDBMessageUtils").beginningOfChat(a),d("WAWebDBMessageUtils").endOfChat(a))}g.PendingReadReceiptType=h;g.getMsgsByMsgKey=a;g.getMsgsByMsgIdsAndChatId=e;g.getMsgByMsgKey=f;g.filterReceivedMessagesInRange=i;g.getMsgsExistByMsgKey=k;g.getMsgsByChatId=l}),98);
__d("WAWebDBMarkFutureproofMessagesReparsed",["WALogger","WAWebMsgType","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a.length===0)return;a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a));a=a.filter(Boolean).filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN});if(a.length===0)return;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["markFutureproofMessagesReparsed: update "," messages"])),String(a.length));a=a.map(function(a){return{id:a.id.toString(),futureproofReparsed:!0}});yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["markFutureproofMessagesReparsed: error ",""])),a);throw a}});return j.apply(this,arguments)}g.markFutureproofMessagesReparsed=a}),98);
__d("WAWebDBProcessEditProtocolMsgs",["$InternalEnum","Promise","WAAckLevel","WALogger","WANullthrows","WATimeUtils","WAWeb-dexie","WAWebAddonQueryUtils","WAWebApiChat","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBMessageSerialization","WAWebDBMsgUtils","WAWebDBReportingTokenUtils","WAWebDBStoreMessageOrphans","WAWebHandleMsgValidate","WAWebLidMigrationUtils","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebMessagingGatingUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebNoop","WAWebOfflineResumeMsgProcessReporter","WAWebUserPrefsMeUser","WAWebWid","asyncToGeneratorRuntime","cr:375"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;f=(e=b("cr:375"))!=null?e:{};var w=f.ftsLightClient,x=b("$InternalEnum").Mirrored(["Added","Removed"]);function a(a,b){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b===void 0&&(b=!1);if(a.length===0)return[];d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] processing edit protocol messages"]))).devConsole({protocolMsgs:a});var e=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(a.map(function(a){return a.protocolMessageKey}).filter(Boolean))),f=B(a,e),g=[],h=[];f.sort(function(a,b){return c("WANullthrows")(b.latestEditSenderTimestampMs)-c("WANullthrows")(a.latestEditSenderTimestampMs)});for(f of f){var i=f.protocolMessageKey&&e.get(f.protocolMessageKey.toString());if(!i||i.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT)g.push(f);else{if(d("WAWebMessagingGatingUtils").isWebReportingTokenDelayProcessingEnabled()){var j=d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.ProcessReportingTokenInfo);yield d("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:[f]});j==null||j()}h.push(K(i,f))}}yield C(g);j=h.filter(function(a){return a.isLatest});yield z(h,j);b&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})));return j});return y.apply(this,arguments)}function z(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a.length&&(yield E(a),G(a.filter(function(a){return a.isLatest&&!d("WAWebMsgGetters").getIsNewsletterMsg(a.parentMsg)}).map(function(a){return a.parentMsg})),yield N(a)),b.length&&d("WAWebBackendApi").frontendFireAndForget("updateEditedMessagesAction",{messageEdits:b})});return A.apply(this,arguments)}function B(a,b){return a.filter(function(a){var e=a.protocolMessageKey;if(!e){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg is missing original msg key"]))).devConsole(a).sendLogs("message-edit-missing-original-msg-key");return!1}e=b.get(e.toString());if(e){var f=d("WAWebMessageEditUtils").msgTypeSupportsEditing(e.type)||e.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT;if(!f){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] original message msgId::"," type is "," which cannot be edited"])),e.id,e.type).devConsole({parentMsg:e,protocolMsg:a}).sendLogs("message-edit-unsupported-msg-type");return!1}if(e.isForwarded===!0){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] original message cannot be a forwarded message"]))).devConsole({parentMsg:e,protocolMsg:a}).sendLogs("message-edit-forwarded-message");return!1}f=c("WANullthrows")(e.t);var g=c("WANullthrows")(a.t);if(!d("WAWebMessageEditUtils").isParentWithinEditProcessingWindow({parentTsInSeconds:f,editTsInSeconds:g,msgKey:e.id})){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg exceeds edit window, will be dropped"]))).devConsole({protocolMsg:a,parentTsInSeconds:f,editTsInSeconds:g});return!1}f=d("WAWebMsgGetters").getSender(e);g=d("WAWebMsgGetters").getSender(a);if(!d("WAWebMsgGetters").getIsNewsletterMsg(e)&&(!f||!g||!c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(f,g)))){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] sender is not the parent msg sender"]))).devConsole({protocolMsg:a,parentMsgSender:f,protocolMsgSender:g}).sendLogs("message-edit-sender-mismatch");return!1}}if(a.latestEditSenderTimestampMs==null){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] protocol msg does not have a valid sender timestamp"]))).devConsole({protocolMsg:a}).sendLogs("message-edit-missing-timestamp");return!1}return!0})}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.length)return;d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] storing orphan edit protocol messages"]))).devConsole({protocolMsgs:a});yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return a.protocolMessageKey},{storeReportingInfo:!0})});return D.apply(this,arguments)}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.length)return;var c=[],e=[];yield d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){var g=f[0];f=f[1];var h=[],i=new Set();a.forEach(function(a){var b=a.parentMsg,f=a.editedMsgData,g=a.isLatest,j=a.protocolMsg;if(!g){d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] message has been updated by a newer edit. Will skip updating the message row."]))).devConsole({messageEdit:a});return}h.push(babelHelpers["extends"]({},b,f));if(!d("WAWebMsgGetters").getIsSentByMe(j)){g=b.id.remote.toString();i.add(g)}c.push(b.id.toString());e.push([b.id,(j=(a=f.latestEditMsgKey)==null?void 0:a.id.toString())!=null?j:""])});var j=[];h.length&&(d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] updating message rows"]))).devConsole({editedMsgs:h}),j.push(g.bulkCreateOrMerge(h.map(function(a){return d("WAWebDBMessageSerialization").dbRowFromMessage(a)}))));if(i.size){g=Array.from(i).map(function(a){return{id:a,unreadEditTimestampMs:d("WATimeUtils").unixTimeMs()}});d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] updating unread chats"]))).devConsole({unreadChatUpdates:g});d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["storeMessageEdits: bulkCreateOrMerge"]))).tags("missing-lid");j.push(f.bulkCreateOrMerge(g))}yield (v||(v=b("Promise"))).all(j)});return function(a){return f.apply(this,arguments)}}());void d("WAWebDBReportingTokenUtils").handleReportingInfosUpdateOnMessageEdit(e)});return F.apply(this,arguments)}function G(a){if(!a.length)return;var d=Array.from(new Set(a.map(function(a){return String(c("WANullthrows")(a.rowId))})));w==null||w.purge(d)["catch"](c("WAWebNoop"));c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield w==null?void 0:w.addToIndexingTable(d),w==null||w.index()["catch"](c("WAWebNoop"))}))}function H(a,b){return d("WAWebMsgGetters").getIsNewsletterMsg(a)&&!d("WAWebUserPrefsMeUser").isMeAccount(b.from)||a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION}function I(a,b){if(d("WAWebMsgGetters").getIsSentByMe(a)){if(a.local===!0)return H(a,b)?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.CLOCK;return d("WAWebMsgKeyUtils").isNoteToSelf(a.id)?d("WAAckLevel").ACK.READ:d("WAAckLevel").ACK.SENT}return void 0}var J=new Map();function K(a,b){var e,f=c("WANullthrows")(d("WAWebMessageEditUtils").getMsgEditType(a.type),"Unsupported message type for edits"),g=M(a,b,f);d("WAWebMsgGetters").getIsSentByMe(a)&&(b.count!=null&&(g.count=b.count));e=(e=(e=J.get(a.id.toString()))!=null?e:a.latestEditSenderTimestampMs)!=null?e:0;var h=c("WANullthrows")(b.latestEditSenderTimestampMs);e=h>=e;if(f===d("WAWebMessageEditUtils").MsgEditType.EventEdit){var i=Boolean(a.isEventCanceled),j=Boolean(b.isEventCanceled);!i&&j?e=!0:i&&!j&&(e=!1)}e&&J.set(a.id.toString(),h);var k;if(f!==d("WAWebMessageEditUtils").MsgEditType.EventEdit&&!d("WAWebMsgGetters").getIsSentByMe(a)){i=d("WAWebMsgGetters").getHasMentionOfMe(a);j=d("WAWebMsgGetters").getHasMentionOfMe(babelHelpers["extends"]({},a,g));i&&!j?k=x.Removed:!i&&j&&(k=x.Added)}(d("WAWebMsgGetters").getIsMetaBotResponse(a)||a.botEditType!=null)&&(g.botEditType=b.botEditType,g.botEditTargetId=b.botEditTargetId);return{parentMsg:a,protocolMsg:b,editedMsgData:g,isLatest:e,mentionOfMe:k}}function L(a){return{botPluginSearchUrl:a.botPluginSearchUrl,botPluginSearchProvider:a.botPluginSearchProvider,botPluginReferenceIndex:a.botPluginReferenceIndex,botPluginType:a.botPluginType,botPluginMaybeParent:a.botPluginMaybeParent,botReelPluginThumbnailCdnUrl:a.botReelPluginThumbnailCdnUrl,botPluginSearchQuery:a.botPluginSearchQuery,botMessageDisclaimerText:a.botMessageDisclaimerText}}function M(a,b,c){a={latestEditMsgKey:b.latestEditMsgKey,latestEditSenderTimestampMs:b.latestEditSenderTimestampMs,errorCode:b.errorCode,ack:I(a,b),pendingReadReceipt:d("WAWebMsgGetters").getIsSentByMe(a)?void 0:d("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit};switch(c){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:c=Boolean(b.matchedText)||Boolean(b.description)||Boolean(b.title);return babelHelpers["extends"]({},a,L(b),{subtype:c?"url":void 0,body:b.body,mentionedJidList:b.mentionedJidList,groupMentions:b.groupMentions,title:b.title,description:b.description,matchedText:b.matchedText,inviteGrpType:b.inviteGrpType,thumbnail:b.thumbnail,richPreviewType:b.richPreviewType,doNotPlayInline:b.doNotPlayInline,paymentLinkMetadata:b.paymentLinkMetadata,thumbnailDirectPath:(c=b.thumbnailDirectPath)!=null?c:void 0,thumbnailSha256:(c=b.thumbnailSha256)!=null?c:void 0,thumbnailEncSha256:(c=b.thumbnailEncSha256)!=null?c:void 0,thumbnailHeight:(c=b.thumbnailHeight)!=null?c:void 0,thumbnailWidth:(c=b.thumbnailWidth)!=null?c:void 0,mediaKey:b.mediaKey,mediaKeyTimestamp:b.mediaKeyTimestamp});case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:return babelHelpers["extends"]({},a,{caption:b.caption,mentionedJidList:b.mentionedJidList,groupMentions:b.groupMentions,isCaptionByUser:!0});case d("WAWebMessageEditUtils").MsgEditType.EventEdit:return babelHelpers["extends"]({},a,{eventName:b.eventName,eventDescription:b.eventDescription,eventLocation:b.eventLocation,eventStartTime:b.eventStartTime,eventEndTime:b.eventEndTime,eventJoinLink:b.eventJoinLink,isEventCanceled:b.isEventCanceled});case d("WAWebMessageEditUtils").MsgEditType.RichResponseEdit:return babelHelpers["extends"]({},a,L(b),{richResponse:b.richResponse})}}function N(a){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled())return;var b=new Map(),c=new Map();for(a of a){var e=a.parentMsg,f=a.mentionOfMe,g=e.id.remote.toString();if(!f)continue;switch(f){case x.Removed:f=e.id.toString();var h=b.get(g);h||(h=[],b.set(g,h));h.push(f);break;case x.Added:h=c.get(g);h||(h=[],c.set(g,h));f={id:e.id.toString(),timestamp:e.t};h.push(f)}}b.size&&(d("WALogger").DEV(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] remove unread mention."]))).devConsole(b),yield d("WAWebApiChat").removeUnreadMentionChat(b));c.size&&(d("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] add unread mention."]))).devConsole(c),yield d("WAWebApiChat").addUnreadMentionChat(c))});return O.apply(this,arguments)}g.EditedMentionOfMe=x;g.processEditProtocolMsgs=a;g.updateMessageEditsLocally=z;g.generateMessageEdit=K}),98);
__d("WAWebApiGroupInviteV4Store",["WATimeUtils","WAWebSchemaGroupInviteV4","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().createOrMerge(a,b)}function c(a){return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().bulkCreateOrMerge(a)}function e(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().equals(["from","to","groupId"],[a,b,c]).then(function(a){return a.filter(function(a){return!a.expired&&a.expiration<=e})}));yield d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().bulkCreateOrReplace(a.map(function(a){return babelHelpers["extends"]({},a,{expired:!0})}));return a});return h.apply(this,arguments)}function f(a,b){var c=d("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),e=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow().toString();b=b?e:c;return d("WAWebSchemaGroupInviteV4").getGroupInviteV4Table().equals(["from","groupId"],[b,a.toString()]).then(function(a){return a.filter(function(a){return!a.expired&&d("WATimeUtils").unixTime()<=a.expiration})}).then(function(a){return a.map(function(a){return a.to})})}g.persistGroupInviteV4Msg=a;g.persistGroupInviteV4Msgs=c;g.revokeGroupInvites=e;g.getPendingParticipants=f}),98);
__d("WAWebDBProcessGroupInviteMsgs",["WALogger","WATimeUtils","WAWebApiGroupInviteV4Store","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return m(a)});yield d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msgs(a)});return l.apply(this,arguments)}function m(a){var b=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),c=b?d("WAWebLidMigrationUtils").toLid(a.from):a.from,e=b?d("WAWebLidMigrationUtils").toLid(a.to):a.to;if(!c||!e){var f=d("WAWebUserPrefsMeUser").isMeAccount(a.author);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[group-invites] isLidMigrated: ",", validMsgAuthor: ",", isPeerMsg: ",""])),b,a.author!=null,f);d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[group-invites] failed to get lid mapping for "," ",""])),c?"":"msg.from &",e?"":"msg.to");b="[group-invites] failed to get lid mapping for *incoming* group invite";d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["",""])),b).sendLogs(b)}f=d("WAWebLidMigrationUtils").getAddressingModeString(c==null?void 0:c.isLid());b=d("WAWebLidMigrationUtils").getAddressingModeString(e==null?void 0:e.isLid());d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[group-invites] incoming invite has fields with the following addressing mode: from = ",", to = ",""])),f,b);return{id:a.id.toString(),from:c==null?void 0:c.toString(),to:e==null?void 0:e.toString(),groupId:a.inviteGrp,expiration:parseInt(a.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(a.inviteCodeExp,10)}}g.processGroupInviteMessages=a}),98);
__d("WAWebAssociationProcessorConstants",[],(function(a,b,c,d,e,f){a=Object.freeze({Regular:"Regular",WithDetachedMessages:"WithDetachedMessages"});f.AssociationProcessorType=a}),66);
__d("WAWebCreateAssociationProcessor",["WAWebAssociationProcessorConstants"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{processorType:d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages})}g.createAssociationMsgProcessorWithDetachedMessages=a}),98);
__d("WAWebMessageAssociation.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=b("$InternalEnum").Mirrored(["UNKNOWN","MEDIA_ALBUM","BOT_PLUGIN","MEDIA_POLL"]);function a(a){return a.associationType!=null}f.MessageAssociationType=c;f.isAssociatedMsg=a}),66);
__d("WAWebAlbumAssociationProcessor",["WAWebCreateAssociationProcessor","WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateAssociationProcessor").createAssociationMsgProcessorWithDetachedMessages({type:d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM,viewMode:d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM});b=a;g["default"]=b}),98);
__d("WAWebBotPluginAssociationProcessor",["WAWebAssociationProcessorConstants","WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a={processorType:d("WAWebAssociationProcessorConstants").AssociationProcessorType.Regular,type:d("WAWebMessageAssociation.flow").MessageAssociationType.BOT_PLUGIN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE};b=a;g["default"]=b}),98);
__d("WAWebMediaPollAssociationProcessor",["WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a={processorType:"Regular",type:d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL,viewMode:d("WAWebViewMode.flow").ViewModeType.POLL_MEDIA};b=a;g["default"]=b}),98);
__d("WAWebUnknownAssociationProcessor",["WAWebAssociationProcessorConstants","WAWebMessageAssociation.flow","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a={type:d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.HIDDEN,processorType:d("WAWebAssociationProcessorConstants").AssociationProcessorType.Regular};b=a;g["default"]=b}),98);
__d("WAWebAssociationProcessor",["WAWebAlbumAssociationProcessor","WAWebBotPluginAssociationProcessor","WAWebMediaPollAssociationProcessor","WAWebUnknownAssociationProcessor"],(function(a,b,c,d,e,f,g){var h=[c("WAWebAlbumAssociationProcessor"),c("WAWebUnknownAssociationProcessor"),c("WAWebBotPluginAssociationProcessor"),c("WAWebMediaPollAssociationProcessor")];function a(a){var b=a.associationType;return(a=h.find(function(a){return a.type===b}))!=null?a:null}function b(a){var b;return(b=h.find(function(b){return b.type===a}))!=null?b:null}g.getAssociationProcessor=a;g.getAssociationProcessorByAssociationType=b}),98);
__d("WAWebRichResponse.flow",[],(function(a,b,c,d,e,f){"use strict";a={Standard:"Standard"};b={Parsed:"Parsed",Partial:"Partial",Unparsed:"Unparsed"};c={Unknown:"Unknown",Text:"Text",Table:"Table",ContentItems:"ContentItems"};d={Carousel:"Carousel",Default:"Default"};f.ParsedRichResponseType=a;f.RichResponseParseState=b;f.RichResponseFragmentType=c;f.RichResponseContentItemsType=d}),66);
__d("WAWebCommonMsgUtils",["$InternalEnum","WALogger","WAWebMsgType","WAWebRichResponse.flow"],(function(a,b,c,d,e,f,g){var h;b=b("$InternalEnum")({DEFAULT:"d",SIGNIFICANT:"s",AMBIENT:"a",NOTEWORTHY:"n",IGNORE:"i"});function a(a,b){switch(a){case d("WAWebMsgType").MSG_TYPE.GP2:case d("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE:case d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.PINNED_MESSAGE:case d("WAWebMsgType").MSG_TYPE.NEWSLETTER_NOTIFICATION:case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_NOTICE:return!0;case d("WAWebMsgType").MSG_TYPE.PROTOCOL:return b==="ephemeral_setting"||b==="share_phone_number"||b==="event_edit_decrypted"||b==="limit_sharing_system_message";default:return!1}}function c(a){return a===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||a===d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER}function e(a){return a===d("WAWebMsgType").MSG_TYPE.UNKNOWN}function i(a){return a===d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE}function f(a){if(!i(a.type))return!1;a=(a=a.richResponse)==null?void 0:a.parseState;return a===d("WAWebRichResponse.flow").RichResponseParseState.Partial||a===d("WAWebRichResponse.flow").RichResponseParseState.Parsed}function j(a){return a===d("WAWebMsgType").MSG_TYPE.CALL_LOG}function k(a){a.forEach(function(a){a.type===void 0&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["undefined message type msgId::",""])),a.id).sendLogs("undefined-msg-type",{sampling:.01})})}g.EventType=b;g.isNotificationType=a;g.isPlaceholderMsg=c;g.isFutureproofMsg=e;g.isRichResponseMsg=i;g.isSomewhatParsedRichResponseMsg=f;g.isCallLogMsg=j;g.logUndefinedMessage=k}),98);
__d("WAWebDBProcessMessage",["Promise","WALogger","WAWeb-dexie","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebCommonMsgUtils","WAWebDBDeleteAssociatedMsgsByMsgKey","WAWebDBMessageBulkHelper","WAWebDBMessageSerialization","WAWebDBStoreMessage","WAWebDbEncryptionKey","WAWebHandlePlaceholderWam","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebNoop","WAWebSchemaMessage","WAWebSyncGatingUtils","WAWebViewMode.flow","asyncToGeneratorRuntime","cr:375","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o;h=(h=b("cr:375"))!=null?h:{};var p=h.ftsLightClient,q=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="NoMessageToUpdateError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error)),r=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="DuplicateMessageError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error)),s=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="PreviousMsgNotUpdatableError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));function a(a,b,c){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){f===void 0&&(f=!1);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["storeMessages: store ",", for chat ",", isHistorySync: ",""])),a.length,e.toLogString(),f);void d("WAWebDBMessageBulkHelper").logMissingGroupParticipantLids(a,f);d("WAWebCommonMsgUtils").logUndefinedMessage(a);yield d("WAWebDbEncryptionKey").DbEncKeyStore.waitForFinalDbMsgEncKey();return(o||(o=b("Promise"))).resolve(d("WAWebDBStoreMessage").storeMessageInTransaction(a,e,f)).then(function(){p==null||p.index()["catch"](c("WAWebNoop"))})["catch"](function(b){if(b instanceof c("WAWeb-dexie").BulkError||b instanceof c("WAWeb-dexie").ConstraintError)throw new r();else{d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Error storing messages"]))).devConsole(b);d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["additional information ",""])),a.map(function(a){return a.id.toString()})).devConsole(b);throw b}})});return t.apply(this,arguments)}function e(a,e){var f,g=e==null?(f=a[0])==null?void 0:f.id.remote:e;if(g){f=a.map(function(a){var b=d("WAWebDBMessageSerialization").dbRowFromMessage(a);return d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:b,chatId:g.toString(),hasLink:d("WAWebLinkify").hasHttpLink(a),pendingReadReceipt:!1})});return(o||(o=b("Promise"))).resolve(d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(f)).then(function(){p==null||p.index()["catch"](c("WAWebNoop"))})["catch"](function(b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Error storing messages"]))).devConsole(b);d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["additional information ",""])),a.map(function(a){return a.id.toString()})).devConsole(b);throw b})}return(o||(o=b("Promise"))).resolve()}function f(a){return d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)?(o||(o=b("Promise"))).resolve(a):d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=(yield b.get(a.id.toString()));if(!e)throw new q("[messaging] updateMessage: msgId::"+a.id.toString()+", Failed to find previous message row in message table");if(!d("WAWebCommonMsgUtils").isPlaceholderMsg(e.type)&&!d("WAWebCommonMsgUtils").isFutureproofMsg(e.type)&&!d("WAWebCommonMsgUtils").isCallLogMsg(e.type)){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["updateMessage: msgId::",", Previous row in message table is not a placeholder or futureproof"])),a.id.toString()).tags("messaging");throw new s()}var f=a.from,g=babelHelpers["extends"]({},a);e.t!=null&&(g.t=e.t);e.ack>a.ack&&(g.ack=e.ack);f=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:d("WAWebDBMessageSerialization").dbRowFromMessage(g),chatId:f.toString(),hasLink:d("WAWebLinkify").hasHttpLink(g),rowId:void 0,inChatMsgId:void 0,pendingReadReceipt:e.pendingReadReceipt});f.rowId=e.rowId;f.internalId=e.internalId;if(f.rowId==null||f.internalId==null)throw c("err")("[messaging] updateMessage: msgId::"+a.id.toString()+", missing rowId or internalId");yield b.createOrReplace(f);d("WAWebCommonMsgUtils").isPlaceholderMsg(e.type)&&void d("WAWebHandlePlaceholderWam").postPlaceholderActivityPopulateEvent([d("WAWebDBMessageSerialization").messageFromDbRow(e)]);p==null||p.index()["catch"](c("WAWebNoop"));return g});return function(a){return e.apply(this,arguments)}}())}function u(a){return d("WAWebSchemaMessage").getMessageTable().bulkGet(a).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a=a.filter(Boolean).map(function(a){var b={id:a.id,isStarred:d("WAWebSyncGatingUtils").shouldPopulateStarMessageWithTimestamp()?a.t:a.rowId},e=a.associationType;if(e!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var f=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(e);f&&f.processorType===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages&&(c.push([a.id,e]),b=babelHelpers["extends"]({},b,{associationType:null,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,parentMsgKey:null}))}return b});a=[d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)];c.length&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&a.push(d("WAWebDBDeleteAssociatedMsgsByMsgKey").bulkDeleteMessagesByMsgKeyAndAssociationType(c));yield (o||(o=b("Promise"))).all(a);return});return function(b){return a.apply(this,arguments)}}())}function v(a){return d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a.map(function(a){return{id:a,isStarred:void 0}}))}g.NoMessageToUpdateError=q;g.DuplicateMessageError=r;g.PreviousMsgNotUpdatableError=s;g.storeMessages=a;g.updateExistingMessages=e;g.updateMessage=f;g.starMessages=u;g.unstarMessages=v}),98);
__d("WAWebLastAddOnDBSerialization",["WANullthrows"],(function(a,b,c,d,e,f,g){function a(a){switch(a.type){case"reaction":return{type:"reaction",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,reactionText:a.reactionText,sender:a.sender,timestamp:a.timestamp};case"poll_vote":return{type:"poll_vote",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp};case"comment":return{type:"comment",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp};case"event_response":return{type:"event_response",msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.timestamp,eventResponse:a.eventResponse}}}function b(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.senderUserJid,reactionText:a.reactionText,timestamp:a.timestamp,isOrphan:a.orphan===1,type:"reaction"}}function d(a,b){return{msgKey:a.msgKey.toString(),isOrphan:b,selectedOptionsCount:a.selectedOptionLocalIds.length,parentMsgKey:a.parentMsgKey.toString(),sender:a.sender.toString(),timestamp:a.senderTimestampMs,type:"poll_vote"}}function e(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.sender,timestamp:a.t*1e3,isOrphan:!1,type:"comment"}}function f(a){return{msgKey:a.msgKey,parentMsgKey:a.parentMsgKey,sender:a.senderUserJid,timestamp:a.timestamp,reactionText:c("WANullthrows")(a.reactionText),type:"reaction"}}g.lastAddOnPreviewFromCandidate=a;g.lastAddOnPreviewCandidateFromReactionRowType=b;g.lastAddOnPreviewCandidateFromVoteData=d;g.lastAddOnPreviewCandidateFromCommentRowType=e;g.lastAddOnPreviewFromDeprecatedLastReactionPreview=f}),98);
__d("WAWebDBProcessPollUpdateMsgs",["Promise","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBPollsGetParentMessages","WAWebDBPollsUpsertVotes","WAWebDBStoreMessageOrphans","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebPollsExtractVotes","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return[];a=(yield d("WAWebDBPollsGetParentMessages").getParentMessages(a));var c=a.pollUpdateMsgsToParentMsgs,e=a.orphans;for(a of c.entries()){var f=a[0],g=a[1];g.pollInvalidated===!0&&c["delete"](f)}g=(yield (h||(h=b("Promise"))).all([b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(e.length===0)return;yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(e,function(a){return a.pollUpdateParentKey});var a=e.map(function(a){return a.id.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a)})(),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(c.size===0)return;var a=(yield d("WAWebDBPollsUpsertVotes").upsertVotesDb(yield d("WAWebPollsExtractVotes").extractVotes(c)));yield d("WAWebBackendApi").frontendSendAndReceive("upsertVotesModelCollection",{votes:a,votesToRemove:null,restoredFromDb:!1});var b=a.map(function(a){return a.msgKey.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(b);b=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(a,!1)})));b.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(b),d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:b}));return a})()]));f=g[1];return f!=null?f:[]});return i.apply(this,arguments)}g.processPollUpdateMsgs=a}),98);
__d("WAWebDBProcessReplyMsgs",["WALogger","WANullthrows","WAWebDBMessageSerialization","WAWebDBMsgUtils","WAWebGroupType","WAWebMessageEditGatingUtils","WAWebMessageEditUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","isStringNullOrEmpty","lodash"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageEditGatingUtils").processReplyMessagesEnabled()||!a.length)return;var e=(yield d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var e=new Set();a.forEach(function(a){a=l(a);if(a==="missing-stanza-id")return;a;e.add(a.toString())});var f=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(Array.from(e.values()))).filter(function(a){a=d("WAWebMessageEditUtils").getMsgEditType(a.type);if(!a)return!1;switch(a){case d("WAWebMessageEditUtils").MsgEditType.TextEdit:return d("WAWebMessageEditGatingUtils").receiveTextEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.CaptionEdit:return d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled();case d("WAWebMessageEditUtils").MsgEditType.EventEdit:case d("WAWebMessageEditUtils").MsgEditType.RichResponseEdit:return!0}}),g=new Map(f.map(function(a){return[a.id.toString(),a]}));f=a.filter(function(a){a=l(a);if(a==="missing-stanza-id")return!1;a;return g.has(a.toString())});if(!f.length)return;d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] validating reply messages with editable quoted messages"]))).devConsole({replyMsgIds:f.map(function(a){return a.id.id}),quotedMsgIds:f.map(function(a){return a.quotedStanzaID})});var h=[];f.forEach(function(a){var b=l(a);if(b==="missing-stanza-id")return;b;b=c("WANullthrows")(g.get(b.toString()));a.quotedMsg==null?h.push(babelHelpers["extends"]({},a,{quotedMsg:b})):n(c("WANullthrows")(a.quotedMsg),b)&&h.push(babelHelpers["extends"]({},a,{quotedMsg:b}))});if(!h.length)return;d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] updating reply messages with inconsistent quoted content"]))).devConsole({replyMsgIds:h.map(function(a){return a.id.id})});yield b.bulkCreateOrMerge(h.map(function(a){return d("WAWebDBMessageSerialization").dbRowFromMessage(a)}));return h});return function(a){return e.apply(this,arguments)}}()));e!=null&&e.length&&e.forEach(function(b){var d=c("WANullthrows")(a.find(function(a){return a.id.equals(b.id)}));d.quotedMsg=b.quotedMsg})});return k.apply(this,arguments)}function l(a){var b,e;if(c("isStringNullOrEmpty")(a.quotedStanzaID))return"missing-stanza-id";b=(b=a.quotedParticipant)!=null?b:void 0;e=(e=a.quotedRemoteJid)!=null?e:a.id.remote;return new(c("WAWebMsgKey"))({id:a.quotedStanzaID,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:e,participant:d("WAWebMsgGetters").getIsGroupMsg(a)||b!=null&&b.isBot()?b:void 0})}var m={inviteGrpType:d("WAWebGroupType").GroupType.DEFAULT,thumbnail:"",body:"",caption:"",interactiveAnnotations:[],scanLengths:[],staticUrl:"",pageCount:0};function n(a,b){var e,f=(e=c("lodash")).pickBy(a,function(a,b){return a!=null&&b!=="kind"}),g=e.pickBy(b,function(a,b){return Object.prototype.hasOwnProperty.call(f,b)&&b!=="kind"});e.defaults(f,m);e.defaults(g,m);if(c("lodash").isEqual(f,g))return!1;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[reply-messages] found inconsistent quoted content"]))).devConsole({expected:g,received:f,quotedMsgContent:a,originalQuotedMsg:b});return!0}g.processReplyMsgs=a;g.createQuotedMsgKey=l}),98);
__d("WAWebHandleMessageTypes.flow",[],(function(a,b,c,d,e,f){a=Object.freeze({ReportingInfo:"reporting_info"});f.MsgAdditionalInfoType=a}),66);
__d("WAWebDBReportingTokenUtils",["Promise","WALogger","WAStanzaUtils","WATimeUtils","WAWebGetMessageCache","WAWebHandleMessageTypes.flow","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebReportingTokenUtils","WAWebSchemaReportingInfo","WAWebSchemaReportingToken","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=["reportingTag"],j,k=-1;function l(a){var b,e=a.reportingTokenInfo;if(e==null)return null;var f=e.reportingTag;e=e.version;var g=a.t;if(f==null||g==null)return null;b=(b=(b=a.protocolMessageKey)==null?void 0:b.toString())!=null?b:a.id.toString();a={msgKey:b,stanzaId:c("WAWebMsgKey").from(b).id,msgTs:g,receivedTs:d("WATimeUtils").unixTimeMs(),reportingTag:f};e!=null&&(a.version=e);return a}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessagingGatingUtils").isReportingTagSyncingEnabled()||a.length===0)return;a=a.map(function(a){return l(a)}).filter(Boolean);return d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreate(a)});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebSchemaReportingInfo").getReportingInfoTable().anyOf(["msgKey"],a)});return o.apply(this,arguments)}function e(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null||a<=k)return;if(a===0){yield (j||(j=b("Promise"))).all([d("WAWebSchemaReportingToken").getReportingTokenTable().clear(),d("WAWebSchemaReportingInfo").getReportingInfoTable().clear()]);return}a=d("WATimeUtils").unixTimeMs()-a*d("WATimeUtils").DAY_MILLISECONDS;var c=(yield d("WAWebSchemaReportingToken").getReportingTokenTable().lessThan(["ts"],a));a=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().lessThan(["receivedTs"],a));yield (j||(j=b("Promise"))).all([d("WAWebSchemaReportingToken").getReportingTokenTable().bulkRemove(c.map(function(a){return a.id})),d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkRemove(a.map(function(a){return a.id}))])});return p.apply(this,arguments)}function f(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a<=k)return;a=d("WATimeUtils").unixTimeMs()-a*d("WATimeUtils").DAY_MILLISECONDS;a=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().lessThan(["receivedTs"],a));a=a.map(function(a){return babelHelpers["extends"]({},a,{reportingToken:null,reportingTokenContentOpaqueData:null,version:null})});yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreateOrReplace(a)});return q.apply(this,arguments)}function r(a){var b=a.msgKey,c=a.stanzaId,e=a.msgTs;a=a.incomingMsgReportingTokenInfo;if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return;if(a==null)return;a=a.reportingTag;if(a==null)return;d("WAWebGetMessageCache").getMessageCache().addAdditionalInfo({type:d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo,data:{msgKey:b.toString(),stanzaId:c,reportingTag:a,msgTs:e,receivedTs:d("WATimeUtils").unixTimeMs()}},!0)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.sort(function(a,b){return((a=a.ts)!=null?a:0)-((a=b.ts)!=null?a:0)});var b=a.map(function(a){return a.id}),c=(yield d("WAWebSchemaReportingToken").getReportingTokenTable().bulkGet(b)),e=new Map(),f=new Set();a.forEach(function(a,b){b=c[b];if((b==null||b.reportingTag==null)&&!f.has(a.id))e.set(a.id,a);else{a.reportingTag;b=babelHelpers.objectWithoutPropertiesLoose(a,i);e.set(a.id,babelHelpers["extends"]({},e.get(a.id),b))}f.add(a.id)});yield d("WAWebSchemaReportingToken").getReportingTokenTable().bulkCreateOrMerge(Array.from(e.values()))});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreate(a)});return v.apply(this,arguments)}function w(a,b){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{if(a.length===0)return;if(b.removeWholeRow)return d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkRemoveByIndex(["msgKey"],a);b=(yield d("WAWebSchemaReportingInfo").getReportingInfoTable().equals(["msgKey"],a));if(b.length===0)return;a=b.map(function(a){return babelHelpers["extends"]({},a,{reportingToken:null,reportingTokenContentOpaqueData:null,version:null})});yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreateOrReplace(a)}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Error deleting reporting infos"]))).devConsole(a)}});return x.apply(this,arguments)}function y(a,b,c,d){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=a.version;f=f===void 0?-1:f;var g=a.reportingTokenContentOpaqueData,h=a.reportingToken,i=a.reportingTokenKey;g=g!=null?{reportingContentElementValue:g}:null;var j;i!=null?j=i:c!=null&&e!=null&&b!=null&&(j=(yield d("WAWebReportingTokenUtils").genReportingTokenKeyFromMessageSecret({messageSecret:c,stanzaId:a.stanzaId,senderJid:d("WAWebWidToJid").widToUserJid(e),remoteJid:b})));i=j!=null?new Uint8Array(j):new Uint8Array(d("WAWebReportingTokenUtils").REPORTING_TOKEN_KEY_SIZE);c=f!=null&&h!=null?{reportingTokenV:f,reportingTokenElementValue:h,reportingTokenKeyElementValue:i}:null;return{reportingTagElementValue:a.reportingTag,reportingTagTsS:a.msgTs,reportingTagId:d("WAStanzaUtils").toStanzaId(a.stanzaId),reportingContentArgs:g,contentValidationArgs:c}});return z.apply(this,arguments)}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var b=new Map();for(a of a){var c=a[0],e=a[1];b.set(c.toString(),e)}c=Array.from(b.keys());e=(yield n(c));if(e.length===0)return;var f=[];e.forEach(function(a){var c=b.get(a.msgKey);if(a.stanzaId===c)return;f.push(babelHelpers["extends"]({},a,{reportingToken:null,reportingTokenContentOpaqueData:null,version:null}))});yield d("WAWebSchemaReportingInfo").getReportingInfoTable().bulkCreateOrReplace(f)});return B.apply(this,arguments)}g.DEFAULT_RT_CLEANUP_OLDER_THAN_DAYS=k;g.msgToReportingInfoRow=l;g.handleHistorySyncedReportingInfo=a;g.getReportingInfosFromMsgKeys=n;g.cleanupReportingTable=e;g.cleanupReportingTokenAndContent=f;g.maybeStoreReportingTag=r;g.handleAddReportingTokenInfos=s;g.handleAddReportingInfos=u;g.handleDeleteReportingInfos=w;g.createReportingValidationArgs=y;g.handleReportingInfosUpdateOnMessageEdit=A}),98);
__d("WAWebDBStoreMessageAssociations",["Promise","WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){var h;function i(a){return d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreate(a)}function a(a){a=a.map(function(a){var b=a.parentMsgKey,c=a.associationType,d=a.internalId;return b!=null&&c!=null&&d!=null?{msgKey:a.id.toString(),parentMsgKey:b,associationType:c,msgKeyInternalId:d}:null}).filter(Boolean);return a.length?i(a):(h||(h=b("Promise"))).resolve()}g.bulkStoreMessageAssociations=a}),98);
__d("WAWebDBStoreMsgsUtils",[],(function(a,b,c,d,e,f){var g=1e9;function a(a,b){b===void 0&&(b=!1);return a.all({reverse:!b,limit:1,index:["rowId"],returnKeyType:"keys"}).then(function(a){return a.length===0?g:a[0]})}f.INLINE_MESSAGE_STARTING_INDEX=g;f.getLastRowId=a}),66);
__d("WAWebDBStoreEncryptedMsgs",["Promise","WALogger","WAPromiseMap","WAWeb-dexie","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebDBStoreMessage","WAWebDBStoreMessageAssociations","WAWebDBStoreMsgsUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebPostIncomingMessageDropMetric","WAWebWidFactory","asyncToGeneratorRuntime","cr:375","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;f=(e=b("cr:375"))!=null?e:{};var A=f.ftsLightClient;function a(a,e,f,g){f===void 0&&(f=!1);g===void 0&&(g=!1);return d("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],function(){var s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(s){f&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: lock acquired"])),a.length);var t=s[0];s[1];s=a;if(g){var u=(yield d("WAWebDBMsgUtils").getMsgsExistByMsgKey(a.map(function(a){a=a[0];return a.id.toString()})));s=a.filter(function(a,b){return!u[b]});d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: perform fallback for "," out of original "," messages"])),s.length,a.length);if(s.length===0)return}var v=(yield d("WAWebDBStoreMsgsUtils").getLastRowId(t,f));f&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: got last row id ",""])),a.length,v);var w=e.map(function(a){return d("WAWebWidFactory").createWid(a)}),x=new Map();yield E(w,f,t,x);f&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: chat map built"])),a.length);s.some(function(a){var b=a[0];a[1];return b.isGroupStatus===!0})&&(d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[storeEncryptedMessage] building lastInChatMsgIdMap for group status"]))),yield E(w.filter(function(a){return a.isGroup()}),f,t,x,d("WAWebDBMessageUtils").InternalIdPrefix.GroupStatus),f&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: group status map built"])),a.length));var y=f?-1:1;w=(yield d("WAPromiseMap").promiseMap(s,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a[0];a=a[1];f&&(e.isMdHistoryMsg=!0);var g=c("WAWebMsgKey").fromString(e.id),h=g.remote.toString();b=v+y*(b+1);var i=G(h,d("WAWebDBMessageUtils").getPrefixForInternalId(e)),j=x.get(i);if(j==null||Number.isNaN(j)){var k=f?"history-sync-":"",l=j==null?"null":"nan";d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[storeEncryptedMessage][lastChatMsgId] lastInChatMsgIdMap is "," before calculation with message type ",", sub type ",""])),l,e.type,e.subtype).sendLogs(""+k+l+"-error-check-lastinchatmsgidmap-lastChatMsgId").devConsole(i,e.type);return}k=j+y*1;x.set(i,k);l=!f&&d("WAWebDBStoreMessage").isPendingUnreadReceipt(g,e);j=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:e,chatId:h,hasLink:a,rowId:b,inChatMsgId:k,pendingReadReceipt:l});return j});return function(b,c){return a.apply(this,arguments)}}())).filter(Boolean);f&&d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: got "," hydrated messages"])),a.length,w.length);try{d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&(yield d("WAWebDBStoreMessageAssociations").bulkStoreMessageAssociations(w),f&&d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: associations stored"])),a.length)),yield t.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(w,!!f),f&&d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: stored"])),a.length)}catch(b){if(f&&b instanceof c("WAWeb-dexie").BulkError)d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: BulkError in bulkCreate for history sync msgs, retrying with bulk create or replace"]))),yield t.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(w);else{(g||!B(a.length,b))&&(C(w,b),D(w));throw b}}return w});return function(a){return s.apply(this,arguments)}}()).then(function(e){e&&e.length>0&&c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){f&&d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: adding "," to indexing table"])),a.length,e.length),yield A==null?void 0:A.addToIndexingTable(e.map(function(a){return a.rowId!=null?String(a.rowId):null}).filter(Boolean)),f&&d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: storing "," messages: schedule fts indexing for "," messages"])),a.length,e.length),A==null||A.index()["catch"](c("WAWebNoop"))}))})}function B(a,b){return a>1&&b instanceof c("WAWeb-dexie").BulkError}function C(a,e){c("WAWeb-dexie").ignoreTransaction(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a;if(e instanceof c("WAWeb-dexie").BulkError){var f=a.map(function(a){a=a.id;return a.toString()}),g=(yield d("WAWebDBMsgUtils").getMsgsExistByMsgKey(f));b=a.filter(function(a,b){return!g[b]})}b.length>0?(d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: dropping "," out of "," message(s): ",", due to DB error: ",""])),b.length,a.length,b.map(function(a){a=a.id;return a}),e),d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropDBOperationFailedForMsgRows(b)):d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: all "," message(s) are already in the DB"])),a.length)}))["catch"](function(a){d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to post db error metrics: ",""])),a).sendLogs("failed-to-post-db-error-metrics")})}function D(a){if(c("gkx")("26258"))return;var b=function(a){var b=new Set(),c=function(a,e){Object.entries(a).forEach(function(a){var f=a[0];a=a[1];if(typeof a==="function"){var g=[].concat(e,[f]).join(".");d("WALogger").WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: message prop '","' is a function and cannot be cloned: ",""])),g,a)}else if(a!=null&&typeof a==="object"){if(b.has(a))return;b.add(a);c(a,[].concat(e,[f]))}})};c(a,[])};try{a.forEach(b)}catch(a){d("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["storeEncryptedDBMessages: failed to log bad message properties: ",""])),a)}}function E(a,b,c,d,e){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){g===void 0&&(g=d("WAWebDBMessageUtils").InternalIdPrefix.Default);if(a.length===0)return(z||(z=b("Promise"))).resolve();var h=g;yield (z||(z=b("Promise"))).all(a.map(function(a){if(g===d("WAWebDBMessageUtils").InternalIdPrefix.GroupStatus&&!a.isGroup())return;var b=h+d("WAWebDBMessageUtils").beginningOfChat(a),i=h+d("WAWebDBMessageUtils").endOfChat(a);return e.between(["internalId"],b,i,{limit:1,reverse:!c,returnKeyType:"keys"}).then(function(b){var c=d("WAWebDBStoreMsgsUtils").INLINE_MESSAGE_STARTING_INDEX;b.length>0&&b[0]!=null&&(c=d("WAWebDBMessageUtils").getInChatMsgId(b[0]));f.set(G(a.toString(),h),c)})}))});return F.apply(this,arguments)}function G(a,b){b===void 0&&(b="");return b+a}g.storeEncryptedDBMessages=a;g.isEligibleForFallback=B;g.buildLastInChatMsgIdMap=E}),98);
__d("WAWebMediaHubGating",["WAWebABProps","WAWebUserPrefsLocalStorage","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function h(){return d("WAWebABProps").getABPropConfigValue("files_media_hub_web_variant")}function i(){return d("WAWebABProps").getABPropConfigValue("files_media_hub_web")}function a(){return!j()?!1:h()===1||h()===2||i()}function b(){var a=c("justknobx")._("4159");return!a?!1:h()!==0||i()}function e(){return!j()?!1:h()!==0||i()}function j(){var a=c("gkx")("26258"),b=c("justknobx")._("4159");if(!a)return b;a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage("WAMediaHubOnInitialize");return b&&a===!0}function f(){return d("WAWebABProps").getABPropConfigValue("files_media_hub_web_max_length")}function k(){return c("justknobx")._("4599")}g.isFilesMediaHubSidebarEnabled=a;g.isFilesMediaHubDBEnabled=b;g.isFilesMediaHubComponentEnabled=e;g.isMediaHubM0Enabled=j;g.getMediaHubMsgsLimit=f;g.isMediaHubLoggingEnabled=k}),98);
__d("WAWebDBStoreMessage",["Promise","WAJids","WALogger","WAPromiseMap","WAWeb-dexie","WAWebCommonMsgUtils","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebLinkify","WAWebMediaHubGating","WAWebModelStorageUtils","WAWebMsgDataUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebNewsletterDBUtils","WAWebSchemaFtsIndexingQueue","WAWebSyncGatingUtils","WAWebWid","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=1e9;function p(a){return a.some(function(a){return a.type!==d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE})}function a(a,e,f){f===void 0&&(f=!1);var g=e==null?a[0].id.remote:e,i=d("WAWebDBMessageUtils").beginningOfChat(g),j=d("WAWebDBMessageUtils").endOfChat(g),k=u("storeMessageInTransaction: "+a.length+" message(s), chat "+((g==null?void 0:g.toString())||"-"));return d("WAWebModelStorageUtils").getStorage().lock(["chat","message"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){var e=c[0];c=c[1];k.addStage("got table lock");var l=(yield e.get(g.toString()));k.addStage("got chat");if(!g.isStatus()&&(l!=null||p(a))){var m=r(l,a,g);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["storeMessageInTransaction: createOrMerge ",". chat exists: ",""])),g.toLogString(),l!=null);yield e.createOrMerge(g.toString(),m)}k.addStage("got messages meta");l=c.all({reverse:!f,limit:1,index:["rowId"],returnKeyType:"keys"}).then(function(a){k.addStage("got boundary row id");return a.length===0?o:a[0]});e=c.between(["internalId"],i,j,{limit:1,reverse:!f,returnKeyType:"keys"}).then(function(a){k.addStage("got chat msg boundary id");return a.length===0?o:d("WAWebDBMessageUtils").getInChatMsgId(a[0])});m=(yield (n||(n=b("Promise"))).all([l,e]));l=m[0];e=m[1];k.addStage("got boundaries");var s=f?l-a.length:l+1,u=f?e-a.length:e+1,v=(yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=d("WAWebDBMessageSerialization").dbRowFromMessage(a),e=!f&&q(a.id,a);return t({msg:c,chatId:g.toString(),hasLink:d("WAWebLinkify").hasHttpLink(a),rowId:s+b,inChatMsgId:d("WAWebMsgGetters").getIsNewsletterMsg(a)?(c=a.serverId)!=null?c:yield d("WAWebNewsletterDBUtils").getTemporaryServerId(g):u+b,pendingReadReceipt:e})});return function(b,c){return a.apply(this,arguments)}}()));k.addStage("messages ready for storing in db");return c.bulkCreate(v).then(function(){return v})});return function(a){return c.apply(this,arguments)}}()).then(function(a){k.done(),c("WAWeb-dexie").ignoreTransaction(function(){d("WAWebSchemaFtsIndexingQueue").getFtsIndexingQueueTable().bulkCreateOrReplace(a.map(function(a){return{id:String(a.rowId)}}))})})}function q(a,b){if(a.fromMe||a.remote.isStatus())return!1;a=d("WAWebMsgDataUtils").eventTypeFromMsgType(b);return a===d("WAWebCommonMsgUtils").EventType.AMBIENT||a===d("WAWebCommonMsgUtils").EventType.DEFAULT}function r(a,b,c){var e,f=void 0,g=Math.max(0,(e=a==null?void 0:a.unreadCount)!=null?e:0),h=(e=a==null?void 0:a.unreadMentionsOfMe)!=null?e:[];b.forEach(function(a){var b=d("WAWebMsgDataUtils").eventTypeFromMsgType(a);if(b===d("WAWebCommonMsgUtils").EventType.IGNORE)return;a&&a.t!=null&&((f==null||a.t>f)&&(f=a.t));(b===d("WAWebCommonMsgUtils").EventType.AMBIENT||b===d("WAWebCommonMsgUtils").EventType.DEFAULT)&&!a.id.fromMe&&(g+=1);b=q(a.id,a);if(b&&d("WAWebMsgGetters").getIsImportantMessage(a)){b={id:a.id.toString(),timestamp:a.t};h.push(b)}});a&&a.t!=null&&((f==null||a.t>f)&&(f=a.t));return{id:c.toString(),unreadCount:g,t:f,unreadMentionsOfMe:h}}function s(a,b){var c=0;switch(a){case d("WAWebMsgType").MSG_TYPE.DOCUMENT:c|=d("WAWebMsgType").MESSAGE_TYPE_FLAGS.DOC_MSG;break;case d("WAWebMsgType").MSG_TYPE.IMAGE:case d("WAWebMsgType").MSG_TYPE.VIDEO:c|=d("WAWebMsgType").MESSAGE_TYPE_FLAGS.MEDIA_MSG;break;default:break}b&&(c|=d("WAWebMsgType").MESSAGE_TYPE_FLAGS.HAS_LINK);return c===0?void 0:c}function t(a){var b=a.msg,e=a.chatId,f=a.hasLink,g=a.rowId,h=a.inChatMsgId;a=a.pendingReadReceipt;var j=[d("WAWebMsgType").MSG_TYPE.IMAGE,d("WAWebMsgType").MSG_TYPE.VIDEO,d("WAWebMsgType").MSG_TYPE.AUDIO].includes(b.type),k=d("WAWebSyncGatingUtils").shouldPopulateStarMessageWithTimestamp()?b.t:g;f=b.type==="chat"&&f;j=babelHelpers["extends"]({},b,{vcardWAids:b.vcardWAids||d("WAWebDBMessageUtils").getVcardWids(b),id:b.id.toString(),isStarred:b.star?k:void 0,hasLink:f?g:void 0,isMediaMsg:j?g:void 0,isDocMsg:b.type===d("WAWebMsgType").MSG_TYPE.DOCUMENT?g:void 0,isCallLogMsg:b.type===d("WAWebMsgType").MSG_TYPE.CALL_LOG?b.t:void 0,isCarouselMsg:b.carouselCardsParsed!=null?g:void 0,isEventMsg:b.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION?g:void 0,expiredTimestamp:(k=d("WAWebMsgGetters").getEphemeralExpirationTimestamp(b))!=null?k:void 0});k=d("WAWebModelStorageUtils").getStorage();k=k.doesLocalSchemaIncludeVersion((k=k.versions)==null?void 0:k.version(167));var l=c("justknobx")._("2155"),m=d("WAWebMediaHubGating").isFilesMediaHubComponentEnabled();k=e!=null&&!c("WAWebWid").isStatus(e)&&!c("WAWebWid").isNewsletter(e)&&k&&l&&m;if(k){l=s(b.type,f);l!=null&&(j.typeFlag=l)}g!=null&&(j.rowId=g);if(h!=null){m=d("WAWebDBMessageUtils").getPrefixForInternalId(b);j.internalId=d("WAWebDBMessageUtils").craftInternalId(e,h,m)}h!=null&&b.threadIds!=null&&(j.internalThreadIDs=b.threadIds.map(function(a){return d("WAWebDBMessageUtils").craftInternalThreadId(h,a)}));a&&e!==d("WAJids").STATUS_JID&&(j.pendingReadReceipt=d("WAWebDBMsgUtils").PendingReadReceiptType.Message);k=b.c2sTimestamp;if(b.id.fromMe){k=(f=b.c2sTimestamp)!=null?f:b.t}else k=b.t;try{b.type!==d("WAWebMsgType").MSG_TYPE.REACTION&&(j.messageRangeIndex=d("WAWebDBMessageUtils").craftMessageRangeIndex(e,!c("WAWebMsgKey").fromString(b.id).fromMe,d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(b.type),k))}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[process-msg] craftMessageRangeIndex failed with error ",""])),a)}return j}function u(a){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["",": start"])),a);var b=5e3,c=Date.now(),e=[];return{addStage:function(a){e.push([a,Date.now()-c])},done:function(){if(Date.now()-c>b){for(var f of e){var g=f[0],h=f[1];d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["",": "," in ","ms"])),a,g,h)}d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["",": completed in ","ms"])),a,Date.now()-c)}else d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["",": completed in ","ms"])),a,Date.now()-c)}}}g.storeMessageInTransaction=a;g.isPendingUnreadReceipt=q;g.getMsgFlagType=s;g.addMsgMetadataToMsgRow=t}),98);
__d("WAWebDBAssociatedMsgsAttachDetachAPI",["$InternalEnum","WALogger","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebBackendApi","WAWebDBGetAssociatedMsgsByParentMsgKey","WAWebMessageAssociationGatingUtils","WAWebSchemaMessage","WAWebViewMode.flow","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["Attach","Detach"]);function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a.map(function(a){return a.id})));a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return a.msgKey.toString()}),!1));a=m(a.filter(Boolean),i.Attach).filter(Boolean);yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY(a);var b=new Map();a.forEach(function(a){var d=c("nullthrows")(a.viewMode);b.set(a.id,d)});d("WAWebBackendApi").frontendFireAndForget("updateViewModeForMsgs",{msgIdsViewModeMap:b})});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return[];a=(yield d("WAWebDBGetAssociatedMsgsByParentMsgKey").bulkGetMessagesByParentMsgKey(a));a.length&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateViewModeOfAssociatedMsgsByParentMsgKeys: Found associated messages"]))).devConsole({associatedMsgs:a});return a});return l.apply(this,arguments)}function e(a,b){var c=[];a.map(function(a){var e=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a.associationType);if(e){var f=!0;b===i.Detach&&(f=(e==null?void 0:e.processorType)===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages);e&&f&&c.push(a)}});return c}function m(a,b){return!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()?[]:a.map(function(a){if(!a.associationType)return null;var c=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a.associationType);return c==null?null:babelHelpers["extends"]({},a,{viewMode:b===i.Detach?d("WAWebViewMode.flow").ViewModeType.VISIBLE:c.viewMode})})}function f(a){return!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()?[]:a.map(function(a){if(!a.associationType)return null;var b=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(a.associationType);return b==null?null:babelHelpers["extends"]({},a,{viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,parentMsgKey:void 0,associationType:void 0})})}g.ViewModeUpdateType=i;g.processOrphansFromAssociationsTableForNewMsg=a;g.getAssociatedMsgsByParentMsgKeyFromAssociationTable=k;g.getValidAssociatedMsgs=e;g.getDetachedForeverAssociatedMsgs=f}),98);
__d("WAWebDBStoreRevokeMsgs",["Promise","WALogger","WAWebAddonProcessRevoke","WAWebApiChat","WAWebApiOrphanRevoke","WAWebBackendApi","WAWebDBAssociatedMsgsAttachDetachAPI","WAWebDBReportingTokenUtils","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebNoop","WAWebSchemaMessage","WAWebSchemaMessageAssociation","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","cr:375"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;f=(e=b("cr:375"))!=null?e:{};var r=f.ftsLightClient,s=20;function a(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=new Set(),f=[],g=[],s=new Map(),t=new Map(),v=[],w=[],x=a.filter(function(a){var b=a.revokeMsgKey,e=a.newMsgKey,f=a.subtype,g=!0;f==="admin_revoke"?!c("WAWebWid").isGroup(b.remote)&&!c("WAWebWid").isNewsletter(b.remote)?(g=!1,d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: "," has not been revoked"])),String(b)),d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: admin revoke has to be sent to a group or newsletter chat"]))).sendLogs("process-admin-revoke-message")):c("WAWebWid").equals(b.remote,e.remote)||(g=!1,d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: "," has not been revoked"])),String(b)),d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: admin revoke came for the different group than the original message was in"]))).sendLogs("process-admin-revoke-message")):(g=c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(b.remote,e.remote))&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(b.participant,e.participant))&&b.fromMe===e.fromMe,g||(d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: invalid revoke request ",", ",""])),String(b),String(e)),d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsgs: sending invalid revoke for secondary validation as bot invoker revoke"]))),t.set(a.revokeMsgKey.id,a)));return g});if(t.size>0)try{a=Array.from(t.entries());var y=a.map(function(a){return a[1].revokeMsgKey.toString()});a=a.map(function(a){return(a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a[1].revokeMsgKey))==null?void 0:a.toString()});y=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet([].concat(y,a),!1));y.forEach(function(a){var b=!1;if(a==null)return;var e=c("WAWebMsgKey").from(a.id),f=t.get(e.id);if(f==null)return;var g=f.newMsgKey,h=f.subtype,i=f.sender;if(h==="admin_revoke")return;h=e.remote;e=a.botTargetSenderJid?d("WAWebWidFactory").createWidFromWidLike(a.botTargetSenderJid):null;if(e==null||h==null)return;var j=a.botPluginSearchUrl!=null&&a.botResponseTargetId!=null,k=!j&&a.botPluginMaybeParent===!0;h.isGroup()?c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(e,g.participant))&&(b=!0):h.isBot()||c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(e,i))&&(b=!0);if(b){v.push(f);g=a.internalId;h=a.botResponseTargetId;(j||k)&&g!=null&&h!=null&&w.push({internalId:g,targetId:h})}});x.push.apply(x,v)}catch(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Store Revoked Msg: re-validate bot revoke failed with error: ",", stack: ",""])),a.name,a.stack).devConsole(a).sendLogs("Re-validate revoke failed")}if(w.length>0)try{yield u(w)}catch(a){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Store Revoked Msg: delete associated carousel revoke failed with error: ",", stack: ",""])),a.name,a.stack).devConsole(a).sendLogs("Plugin carousel delete revoke failed")}var z=[],A=[];a=(yield (q||(q=b("Promise"))).all([d("WAWebModelStorageUtils").getStorage().lock(["message","message-association"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var h=[].concat(x.map(function(a){return a.revokeMsgKey}),x.map(function(a){return d("WAWebLidMigrationUtils").getAlternateMsgKey(a.revokeMsgKey)}),x.map(function(a){return a.newMsgKey})),i=[];if(d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var j=(yield d("WAWebDBAssociatedMsgsAttachDetachAPI").getAssociatedMsgsByParentMsgKeyFromAssociationTable(h.filter(Boolean)));j=d("WAWebDBAssociatedMsgsAttachDetachAPI").getValidAssociatedMsgs(j,d("WAWebDBAssociatedMsgsAttachDetachAPI").ViewModeUpdateType.Detach);i=j.map(function(a){return a.msgKey})}j=[].concat(h.map(function(a){return a?a.toString():""}),i);h=(yield a.bulkGet(j,!1));var k=[];i=x.length;var l=h.slice(0,i),m=h.slice(i,i*2),n=h.slice(i*2,i*3);j=h.slice(i*3);var o=[];x.forEach(function(a,b){var h;h=(h=l[b])!=null?h:m[b];b=n[b];if(h==null){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["processRevokeMsg: revoke is orphan or an addon ",""])),a.revokeMsgKey);k.push(a);return}e.add(h.id);g.push(String(h.rowId));h.associationType!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&A.push([h.id,h.associationType]);f.push({id:a.newMsgKey.toString(),to:h.to,author:h.author,type:d("WAWebMsgType").MSG_TYPE.REVOKED,subtype:a.subtype==="admin_revoke"?"admin":"sender",revokeSender:a.sender,protocolMessageKey:h.id,protocolMessageRowId:b==null?void 0:b.rowId,from:h.from,t:h.t,rowId:h.rowId,internalId:h.internalId,messageRangeIndex:h.messageRangeIndex,revokeTimestamp:a.revokeTimestamp,disappearingModeInitiator:a.disappearingModeInitiator,ephemeralDuration:a.ephemeralDuration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,viewMode:(b=a.viewMode)!=null?b:h.viewMode});if(d("WAWebMsgGetters").getIsImportantMessage(h)){a=c("WAWebMsgKey").fromString(h.id);b=a.remote.toString();if(s.has(b)){a=(a=s.get(b))!=null?a:[];s.set(b,[].concat(a,[h.id]))}else s.set(b,[h.id])}});if(j!=null&&j.length){h=d("WAWebDBAssociatedMsgsAttachDetachAPI").getDetachedForeverAssociatedMsgs(j.filter(Boolean)).filter(Boolean);h.forEach(function(a){a!=null&&!e.has(a.id)&&o.push(a)});j.filter(Boolean).forEach(function(a){A.push([a.id,a.associationType])});d("WAWebBackendApi").frontendFireAndForget("detachAssociatedMsgsForever",{msgIds:h.map(function(a){return a.id})})}i=[];j=[];e.size>0&&i.push(a.bulkRemove(Array.from(e)));A.length>0&&i.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(A));yield (q||(q=b("Promise"))).all(i);z.length>0&&j.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreateOrReplace(z));(f.length>0||o.length>0)&&j.push(a.bulkCreateOrReplace_ALREADY_ENCRYPTED_RECORDS_ONLY([].concat(f,o)));yield q.all(j);return k});return function(b){return a.apply(this,arguments)}}()),d("WAWebAddonProcessRevoke").processRevokeMsgs(x)]));y=a[0];var B=a[1];if(y.length>0){a=y.filter(function(a){return B.has(a.revokeMsgKey)}).map(function(a){return{msgKey:a.revokeMsgKey.toString(),sender:a.sender,timestamp:a.timestamp,subtype:(a=a.subtype)!=null?a:"sender_revoke"}});a.length>0&&(yield d("WAWebApiOrphanRevoke").addOrphanRevokes(a))}r==null||r.purge(g)["catch"](c("WAWebNoop"));void d("WAWebDBReportingTokenUtils").handleDeleteReportingInfos(e?Array.from(e):[],{removeWholeRow:!1});s.size>0&&d("WAWebApiChat").removeUnreadMentionChat(s)});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=[],f=[];a=a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield w(a));var b=a.pluginLinkMsgIds;a=a.pluginLinkMsgIdsRowIds;e=[].concat(e,b);f=[].concat(f,a);yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(e)});return function(b){return a.apply(this,arguments)}}());yield (q||(q=b("Promise"))).all(a);r==null||r.purge(f)["catch"](c("WAWebNoop"));d("WAWebBackendApi").frontendFireAndForget("deleteAssociatedBotCarouselMsgs",{msgKeys:e})});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=[],e=a.internalId,f=a.targetId;a=e.split("_")[0];yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],e,a+"_g",{reverse:!1,limit:s,shouldDecrypt:!1},function(a){if(a.botResponseTargetId===f)b.push(a.id),c.push(String(a.rowId));else return!0;return!1});return{pluginLinkMsgIds:b,pluginLinkMsgIdsRowIds:c}});return x.apply(this,arguments)}g.processRevokeMsgs=a;g.findAndDeleteAssociatedPluginMsg=u;g.findAssociatedPluginMsgs=w}),98);
__d("WAWebGraphQLServerError",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({INVALID_ACCESS_TOKEN:190});c=function(a){function b(b){var c;c=a.call(this)||this;c.name="GraphQLServerError";c.source=b;return c}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));f.GraphQLErrorCode=a;f.GraphQLServerError=c}),66);
__d("WAWebRelayClient",["Promise","WAWebGraphQLServerError","WAWebRelayEnvironment","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=["eventLogger","environmentType","accessToken","getInlineDataReader"],i=["eventLogger","environmentType","accessToken","getInlineDataReader"],j;function a(a){throw c("err")("Invariant Violation")}function e(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=c===void 0?{}:c;var e=c.eventLogger,f=c.environmentType,g=c.accessToken,i=c.getInlineDataReader;c=babelHelpers.objectWithoutPropertiesLoose(c,h);var j=(yield d("WAWebRelayEnvironment").requireRelayRuntime()),k=j.fetchQuery;j=j.readInlineData;var l=typeof g==="object"?g.token:g;g=typeof g==="object"?g.bp_id:null;try{f=(yield d("WAWebRelayEnvironment").getEnvironment({environmentType:f,accessToken:l,actorID:g}));l=(yield k)(f,a,b,c).toPromise();e==null||e.success();i==null||i(j);return l}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&(e==null||e.failure(a.source.errors));throw a}});return k.apply(this,arguments)}function f(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e=e===void 0?{}:e;var f=e.eventLogger,g=e.environmentType,h=e.accessToken,k=e.getInlineDataReader,l=babelHelpers.objectWithoutPropertiesLoose(e,i);e=(yield d("WAWebRelayEnvironment").requireRelayRuntime());var m=e.commitMutation,n=e.readInlineData;e=typeof h==="object"?h.token:h;h=typeof h==="object"?h.bp_id:null;try{var o=(yield d("WAWebRelayEnvironment").getEnvironment({environmentType:g,accessToken:e,actorID:h}));return new(j||(j=b("Promise")))(function(b,d){m(o,babelHelpers["extends"]({mutation:a,variables:c},l,{onCompleted:function(a){f==null||f.success(),k==null||k(n),b(a)},onError:function(a){d(a)}}))})}catch(a){a instanceof d("WAWebGraphQLServerError").GraphQLServerError&&(f==null||f.failure(a.source.errors));throw a}});return l.apply(this,arguments)}g.graphql=a;g.fetchQuery=e;g.commitMutation=f}),98);
__d("WAWebGraphQLConstants",["WALogger","WAWebUserPrefsGeneral"],(function(a,b,c,d,e,f,g){var h,i="https://graph.whatsapp.com/graphql/";function a(){return j("")}function b(){return j("catalog")}function j(a){return""+i+a}var k="https://graph.facebook.com/graphql";function c(){return k}d="WA|787118555984857|7bb1544a3599aa180ac9a3f7688ba243";e="WA|368348580915920|f740dc6ab59f4466ba09052010768cc1";g.whatsappGraphqlEndpointWWW=a;g.whatsappGraphqlEndpointCatalog=b;g.generateFacebookGraphqlEndpoint=c;g.WHATSAPP_GRAPHQL_CATALOG_ACCESS_TOKEN=d;g.WHATSAPP_GRAPHQL_WWW_ACCESS_TOKEN=e}),98);
__d("WAWebGraphQLPersistedQueries",[],(function(a,b,c,d,e,f){a={queryProductListCatalogQuery:"5127568407281377",WAWebAiAgentAutoReplyControlMutation:"9175037952515083",WAWebBizGetCustomUrlUserGraphqlQuery:"7942225995860428",WAWebBizGetProfileShimlinksQuery:"24491258413796282",WAWebBizGraphQLRefreshCartJobQuery:"8172715152844790",WAWebGraphQLProductCatalogGetPublicKeyJobQuery:"24765734146405491",WAWebGraphQLVerifyPostcodeJobQuery:"7573183149457062",WAWebReportProductJobMutation:"8473660082655001",WAWebGalaxyFlowsDrawerGetFlowDataQuery:"9885061481575290",WAWebFetchMetaAISearchNullStateSuggestionsQuery:"9962874563796224",WAWebFetchMetaAISearchTypeAheadSuggestionsQuery:"10099941310063078"};f.PersistedQueries=a}),66);
__d("WAWebGraphQLRemapLocale",["WALogger","isPlainObject"],(function(a,b,c,d,e,f,g){var h,i,j;a=function(a,b){try{var e=JSON.parse(b);if(!c("isPlainObject")(e)){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Invalid json locale mapping"])));return a}return Object.keys(e).find(function(b){b=e[b];return Array.isArray(b)?b.includes(a):!1})||a}catch(b){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Invalid json locale mapping"])));return a}};g.graphQLRemapLocale=a}),98);
__d("WAWebMiscGatingUtils",["WAWebABProps","WAWebGroupType","WAWebMobilePlatforms","WAWebModernizr","WAWebPrimaryFeatures","WAWebUA"],(function(a,b,c,d,e,f,g){function a(){return!d("WAWebABProps").getABPropConfigValue("disable_auto_download")}function b(a){if(a>=d("WAWebABProps").getABPropConfigValue("pnh_cag_disable_reactions_group_size"))return!1;return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("parent_group_view_enabled_for_smb_on_web"):!0}function c(a){a===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?a=d("WAWebABProps").getABPropConfigValue("community_announcement_group_size_limit"):a=d("WAWebABProps").getABPropConfigValue("group_size_limit");return a}function e(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("recent_sticker")}function f(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("favorite_sticker")}function h(){return d("WAWebABProps").getABPropConfigValue("favorite_sticker_sync_after_pairing_enabled_web")}function i(){var a=d("WAWebModernizr").getModernizr();return d("WAWebUA").UA.isGecko&&!(a!=null&&a.exiforientation)?!1:!0}function j(){return d("WAWebABProps").getABPropConfigValue("web_group_profile_editor")}function k(){return d("WAWebABProps").getABPropConfigValue("web_multi_skin_toned_emoji_picker")}function l(){return d("WAWebABProps").getABPropConfigValue("web_message_list_a11y_redesign")}function m(){return d("WAWebABProps").getABPropConfigValue("web_abprop_media_links_docs_search")}function n(){return d("WAWebABProps").getABPropConfigValue("graphql_locale_remapping")}function o(){return d("WAWebABProps").getABPropConfigValue("web_message_custom_aria_label")}function p(){return d("WAWebABProps").getABPropConfigValue("four_reactions_in_bubble_enabled")}function q(){return d("WAWebABProps").getABPropConfigValue("web_message_plugin_frontend_registration_enabled")}function r(){return!d("WAWebMobilePlatforms").isSMB()}function s(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("ddm_settings")}function t(){var a;return(a=d("WAWebABProps").getABPropConfigValue("drop_last_name"))!=null?a:!1}function u(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_rambutan_enabled")}function v(){return d("WAWebABProps").getABPropConfigValue("group_suspend_v2_enabled")}function w(){return d("WAWebABProps").getABPropConfigValue("query_verified_name_when_msg_differs")}function x(){return d("WAWebABProps").getABPropConfigValue("blue_enabled")}function y(){return d("WAWebABProps").getABPropConfigValue("blue_education_enabled")}function z(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("blue_profile_locked_ui_enabled")}function A(){return d("WAWebABProps").getABPropConfigValue("blue_strings_enabled")}function B(){return d("WAWebABProps").getABPropConfigValue("blue_client_p0_logging_enabled")}g.webMediaAutoDownloadEnabled=a;g.cagReactionsSend=b;g.getGroupSizeLimit=c;g.isRecentStickersMDEnabled=e;g.isFavoriteStickersEnabled=f;g.isFavoriteStickerSyncAfterPairingEnabled=h;g.isHighQualityVideoThumbnailsEnabled=i;g.groupProfileEditorEnabled=j;g.multiSkinToneEmojiPickerEnabled=k;g.messageListA11yRedesignEnabled=l;g.mediaLinksDocsFilteringEnabled=m;g.getGraphqlLocaleRemapping=n;g.messageCustomAriaLabelEnabled=o;g.fourReactionsInBubbleEnabled=p;g.messagePluginFrontendRegistrationEnabled=q;g.isPrivacyNarrativeV1Enabled=r;g.isDefaultDisappearingMessagesEnabled=s;g.isDropLastNameEnabled=t;g.isRambutanEnabled=u;g.isGroupSuspendV2Enabled=v;g.queryVerifiedNameWhenMsgDiffers=w;g.isBlueEnabled=x;g.isBlueEducationEnabled=y;g.isBlueLockingEnabled=z;g.isBlueStringsEnabled=A;g.isBlueP0LoggingEnabled=B}),98);
__d("WAWebRelayEnvironment",["JSResourceForInteraction","WAWebGraphQLConstants","WAWebGraphQLPersistedQueries","WAWebGraphQLRemapLocale","WAWebGraphQLServerError","WAWebL10N","WAWebMiscGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("JSResourceForInteraction")("relay-runtime").__setRef("WAWebRelayEnvironment").load());return{Environment:a.Environment,RecordSource:a.RecordSource,Store:a.Store,Network:a.Network,fetchQuery:a.fetchQuery,readInlineData:a.readInlineData,commitMutation:a.commitMutation}});return i.apply(this,arguments)}function j(a){switch(a){case"facebook":return d("WAWebGraphQLConstants").generateFacebookGraphqlEndpoint();case"whatsapp_www":return d("WAWebGraphQLConstants").whatsappGraphqlEndpointWWW();default:a;return d("WAWebGraphQLConstants").whatsappGraphqlEndpointCatalog()}}function k(a){switch(a){case"facebook":return"locale";case"whatsapp_www":return"locale";default:a;return"lang"}}function l(a){var b=a.status;a=a.statusText;throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:[{code:b,message:a}]})}var m=new Map();function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e;e=(e=a.environmentType)!=null?e:"whatsapp_catalog";var f=m.get(e);if(f!=null){var g=!1;a.accessToken!=null&&a.accessToken!==f.accessToken&&(g=!0);a.actorID!=null&&a.actorID!==f.actorID&&(g=!0);if(!g)return f.environment}g=(yield h());f=g.Environment;var i=g.Network,n=g.RecordSource;g=g.Store;var o={Accept:"application/json","Content-Type":"application/json"},p=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){var f,g,h;f=(f=a.environmentType)!=null?f:"whatsapp_catalog";g=(g=d("WAWebGraphQLPersistedQueries").PersistedQueries[b.name])!=null?g:b.id;b=k(f);g=(h={access_token:(h=a==null?void 0:a.accessToken)!=null?h:d("WAWebGraphQLConstants").WHATSAPP_GRAPHQL_CATALOG_ACCESS_TOKEN,doc_id:g,variables:e},h[b]=d("WAWebGraphQLRemapLocale").graphQLRemapLocale(c("WAWebL10N").getFullLocale().replace("-","_"),d("WAWebMiscGatingUtils").getGraphqlLocaleRemapping()),h);e=(yield self.fetch(j(f),{method:"POST",headers:o,body:JSON.stringify(g)}));if(!e.ok){var i;try{i=(yield e.json())}catch(a){l(e)}if(((b=i)==null?void 0:b.error)!=null)throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:[i.error]});else l(e)}h=(yield e.json());if((h==null?void 0:h.errors)!=null)throw new(d("WAWebGraphQLServerError").GraphQLServerError)({errors:h.errors});return h});return function(a,b){return e.apply(this,arguments)}}();f=new f({network:i.create(p),store:new g(new n()),options:{actorID:a==null?void 0:a.actorID}});m.set(e,{environment:f,accessToken:a==null?void 0:a.accessToken,actorID:a==null?void 0:a.actorID});return f});return n.apply(this,arguments)}g.requireRelayRuntime=h;g.getEnvironment=a}),98);
__d("WAWebBackendErrors",["WACustomError","WALogger"],(function(a,b,c,d,e,f,g){var h;c=function(a){function b(b,c){c=a.call(this,c)||this;c.status=b;c.statusCode=b;return c}babelHelpers.inheritsLoose(b,a);return b}((b=d("WACustomError")).customError("ServerStatusCodeError"));e=function(a){function b(b,c,d){d=a.call(this,d)||this;d.errors=c;d.status=b;d.statusCode=b;return d}babelHelpers.inheritsLoose(b,a);return b}(b.customError("ServerStatusCodeError"));f=function(a){function b(){return a.call(this,"CatalogUnknownError")||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("CatalogUnknownError"));var i=function(a){function b(){return a.call(this,"CollectionReorderError")||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("CollectionReorderError",!0,Error)),j=function(a){function b(){return a.call(this,451,"commerce features disabled")||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("E451",!0,c)),k=function(a){function b(b){return a.call(this,404,b)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("E404",!0,c)),l=function(a){function b(b,c){b=a.call(this,507,b)||this;b.backoff=Number.isNaN(c)?null:c;return b}babelHelpers.inheritsLoose(b,a);return b}(b.customError("E507",!0,c)),m=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("Drop")),n=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("LogoutDrop",!0,m));m=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("EphemeralDrop",!0,m));function a(a,b){return a["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",", error"])),b).verbose().devConsole(a).sendLogs(b);throw a})}var o=function(a){function b(b,c,d){d=a.call(this,d)||this;d.gid=b;d.membershipApprovalMode=c;return d}babelHelpers.inheritsLoose(b,a);return b}(b.customError("UnexpectedJoinGroupViaInviteResponse")),p=function(a){function b(b,c){c=a.call(this,c)||this;c.membershipApprovalMode=b;return c}babelHelpers.inheritsLoose(b,a);return b}(b.customError("UnexpectedJoinSubgroupResponse")),q=function(a){function b(b,c,d){d=a.call(this,d)||this;d.status=b;d.participantLimit=c;return d}babelHelpers.inheritsLoose(b,a);return b}(b.customError("GroupAddParticipantCountRateLimitServerError")),r=function(a){function b(b,c,d,e){e=a.call(this,e)||this;e.status=b;e.backoff=c;e.limitType=d;return e}babelHelpers.inheritsLoose(b,a);return b}(b.customError("GroupAddParticipantTimeRateLimitServerError")),s=function(a){function b(b){var c;c=a.call(this,"Ad Account Recovery Required")||this;c.emailMask=b;return c}babelHelpers.inheritsLoose(b,a);return b}(b.customError("AdAccountRecoveryRequiredError")),t=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("AdAccountRecoveryRequiredEmailMaskEmptyError"));b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(b.customError("CatalogIncorrectNonceError"));g.ServerStatusCodeError=c;g.CatalogEditServerError=e;g.CatalogUnknownError=f;g.CollectionReorderError=i;g.E451=j;g.E404=k;g.E507=l;g.LogoutDrop=n;g.EphemeralDrop=m;g.attachErrorLogger=a;g.UnexpectedJoinGroupViaInviteResponse=o;g.UnexpectedJoinSubgroupResponse=p;g.GroupAddParticipantCountRateLimitServerError=q;g.GroupAddParticipantTimeRateLimitServerError=r;g.AdAccountRecoveryRequiredError=s;g.AdAccountRecoveryRequiredEmailMaskEmptyError=t;g.CatalogIncorrectNonceError=b}),98);
__d("WAWebMexNativeClient",["WACustomError","WALogger","WAWebBackendErrors","WAWebMexLogging","WAWebMexRelayEnvironment","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] Mex native client request:"]))).tags("mex","native-client").devConsole({operation:a,variables:b});var c=new(d("WAWebMexLogging").MexPerfTracker)(!0);c.start();try{var e=o(a),f=e.params;c.setQueryId(f.id);c.setOperationName(f.name);f={metadata:{mexPerfTracker:c}};e=(yield d("WAWebMexRelayEnvironment").fetchFunc(e.params,b,f));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] result:"]))).tags("mex","native-client").devConsole({result:e});b=n(e,c);c.setHasData(!0);c.stop();c.logEvent();return b.data}catch(b){b instanceof d("WAWebMexRelayEnvironment").MexIqError||b instanceof d("WAWebMexRelayEnvironment").MexPayloadParsingError||b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError?b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError||d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] infra error: ",""])),b.message).tags("mex","native-client").devConsole({error:b}).sendLogs("mex-native-client-infra-error"):(d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[mex][native-client] unexpected error: ",""])),b.message).tags("mex","native-client").devConsole({error:b}).sendLogs("mex-native-client-unexpected-error"),c.setHasData(!1),c.setErrors([d("WAWebMexLogging").createLoggingClientError(417,b.message)]));c.stop();c.logEvent();b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError||d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[MEX][","] fetch query error"])),a.params.name).tags("GQL","MEX").devConsole({e:b});if(b instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError){f=b.error.extensions.error_code;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(f),"MexFatalExtensionError: "+b.error.message)}if(b instanceof d("WAWebMexRelayEnvironment").MexIqError)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.code,"MexIqError: "+b.message);throw b}});return m.apply(this,arguments)}function n(a,b){if(a.data!=null)return{data:a.data};if(Array.isArray(a)){a="mex response is an array";b.setErrors([d("WAWebMexLogging").createLoggingClientError(472,a)]);throw new(d("WAWebMexRelayEnvironment").MexPayloadParsingError)(c("err")(a))}a="data is missing in mex response";b.setErrors([d("WAWebMexLogging").createLoggingClientError(472,a)]);throw new(d("WAWebMexRelayEnvironment").MexPayloadParsingError)(c("err")(a))}function o(a){if(a.kind==="Request")return a;throw d("WACustomError").customError("operation kind "+((a=JSON.stringify(a.kind))!=null?a:"")+" is not 'Request'",!0,Error)}g.fetchQuery=a}),98);
__d("WAWebMexClient",["WAWebMexNativeClient","WAWebRelayClient","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebMexNativeClient").fetchQuery(a,b)});return h.apply(this,arguments)}g.graphql=d("WAWebRelayClient").graphql;g.fetchQuery=a}),98);
__d("WAWebDeviceListPk",["err"],(function(a,b,c,d,e,f,g){function a(a){switch(a.server){case"lid":return a.user+"@lid";case"c.us":return a.user;case"hosted":return a.user;case"hosted.lid":return a.user+"@lid";case"bot":return a.user+"@bot"}throw c("err")("Jid "+a.toString({legacy:!0})+' is not fully qualified to create a device list pk, jid.server should be "c.us" or "lid"')}g.createDeviceListPK=a}),98);
__d("WAWebApiDeviceList",["Promise","WAJids","WALogger","WALruCache","WAWebApiContact","WAWebDeviceListPk","WAWebSchemaDeviceList","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k=new(d("WALruCache").LruCache)({sizeLimit:5e3,getSize:function(){return 1}});function l(a){var c=d("WAWebDeviceListPk").createDeviceListPK(a);if(!k.has(c)){var e=d("WAWebSchemaDeviceList").getDeviceListTable().get(c);k.put(c,e)}k.get(c)!=null&&d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_GET_DEVICE_RECORD);return(e=k.get(c))!=null?e:(j||(j=b("Promise"))).resolve(null)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[];a.forEach(function(a){k.has(d("WAWebDeviceListPk").createDeviceListPK(a))||c.push(d("WAWebDeviceListPk").createDeviceListPK(a))});if(c.length>0){var e=(yield d("WAWebSchemaDeviceList").getDeviceListTable().bulkGet(c));e.forEach(function(a,d){k.put(c[d],(j||(j=b("Promise"))).resolve(a))})}e=a.filter(function(a){return k.get(d("WAWebDeviceListPk").createDeviceListPK(a))!=null});e.length>0&&d("WAWebApiContact").checkPnToLidMapping(e,d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_BULK_GET_DEVICE_RECORD);return(j||(j=b("Promise"))).all(a.map(function(a){return k.get(d("WAWebDeviceListPk").createDeviceListPK(a))}))});return n.apply(this,arguments)}function o(a){if(a.deleted){a=d("WAWebWidFactory").createUserWidFromDeviceListPk(a.id);d("WAWebUserPrefsMeUser").isMeAccount(a)&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: trying to delete own device list"])))}}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping([d("WAWebWidFactory").createUserWidFromDeviceListPk(a.id)],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_CREATE_OR_REPLACE_DEVICE_RECORD),yield d("WAWebSchemaDeviceList").getDeviceListTable().createOrReplace(a),k.put(a.id,(j||(j=b("Promise"))).resolve(a)),o(a)});return p.apply(this,arguments)}function e(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping(a.map(function(a){return d("WAWebWidFactory").createUserWidFromDeviceListPk(a.id)}),d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_API_DEVICE_LIST_BULK_CREATE_OR_REPLACE_DEVICE_RECORD),yield d("WAWebSchemaDeviceList").getDeviceListTable().bulkCreateOrReplace(a),a.forEach(function(a){k.put(a.id,(j||(j=b("Promise"))).resolve(a)),o(a)})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield m(a));return a.map(function(a){if(a&&!a.deleted){var b=a.devices.map(function(a){return{id:a.id,isHosted:a.isHosted}});return{id:a.id,devices:b}}return null})});return s.apply(this,arguments)}function f(a,b){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b===d("WAJids").DEFAULT_DEVICE_ID)return!0;a=(yield r([a]));a=a[0];if(!a)return!1;return!a.devices.some(function(a){return a.id===b})?!1:!0});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield m(a));return a.map(function(a){if(a&&!a.deleted){var b=a.devices.map(function(a){return{id:a.id,isHosted:a.isHosted}});return{id:a.id,devices:b,timestamp:a.timestamp,expectedTs:a.expectedTs}}return null})});return v.apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow();a=(yield l(a));if(!a||a.deleted){var b=d("WAWebUserPrefsMeUser").getMeDeviceLidOrThrow();b=(yield l(b));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: cannot find my device list: PN record exists: "," deleted: ",". LID record exists: "," deleted: ",""])),a!=null,(a==null?void 0:a.deleted)===!0,b!=null,(b==null?void 0:b.deleted)===!0);throw c("err")("syncd: cannot find my device list")}return a});return x.apply(this,arguments)}function y(){return d("WAWebSchemaDeviceList").getDeviceListTable().all()}g.getDeviceRecord=l;g.bulkGetDeviceRecord=m;g.createOrReplaceDeviceRecord=a;g.bulkCreateOrReplaceDeviceRecord=e;g.getDeviceIds=r;g.hasDevice=f;g.getDeviceInfoForSync=u;g.getMyDeviceList=w;g.getAllDeviceLists=y}),98);
__d("WAWebHandleMsgCommon",["WACustomError"],(function(a,b,c,d,e,f,g){a={text:"text",media:"media",medianotify:"medianotify",pay:"pay",poll:"poll",reaction:"reaction",event:"event"};b={ctwa:"ctwa"};c={pn:"pn",lid:"lid"};e={creation:"creation",quiz_creation:"quiz_creation",vote:"vote",result_snapshot:"result_snapshot"};f={creation:"creation",response:"response",edit:"edit"};var h={high:"high",low:"low",unknown:"unknown"},i="peer";d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("HSMMismatchError"));var j={send:"send",request:"request",futureproof:"futureproof","request-decline":"request-decline","request-cancel":"request-cancel",invite:"invite"},k="biz_source",l={"default":"default",member_tag:"member_tag",group_history:"group_history"};g.STANZA_MSG_TYPES=a;g.STANZA_MSG_ORIGIN=b;g.STANZA_MSG_ADDRESSING_MODE=c;g.POLL_TYPES=e;g.EVENT_TYPES=f;g.MSG_VERIFIED_LEVEL=h;g.CATEGORY_PEER=i;g.HsmMismatchError=d;g.PAY_NODE_TYPES=j;g.BIZ_SOURCE_ATTR=k;g.APPDATA=l}),98);
__d("WAWebHandleMsgMetaUtils",["WAWebHandleMsgCommon","WAWebMsgType"],(function(a,b,c,d,e,f,g){b=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction};c=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll&&(a==null?void 0:a.pollType)===d("WAWebHandleMsgCommon").POLL_TYPES.vote};var h=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text&&(a==null?void 0:a.threadMsgId)!=null&&(a==null?void 0:a.threadMsgSenderJid)!=null};e=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event&&(a==null?void 0:a.eventType)===d("WAWebHandleMsgCommon").EVENT_TYPES.response};f=function(a){return(a==null?void 0:a.type)===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event&&(a==null?void 0:a.eventType)===d("WAWebHandleMsgCommon").EVENT_TYPES.edit};function a(a){if(a==null)return;if(h(a))return d("WAWebMsgType").MSG_TYPE.COMMENT}g.isReactionMsgMeta=b;g.isPollVoteMsgMeta=c;g.isCommentMsgMeta=h;g.isEventResponseMsgMeta=e;g.isEventEditMsgMeta=f;g.getMsgTypeFromMsgMeta=a}),98);
__d("WAWebHandleMsgTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({Self:1,Bsp:2,Capi:3});d=a({OnPremise:1,Facebook:2});e=a.Mirrored(["SUCCESS","RETRY","HSM_MISMATCH","BACKFILL","PARSE_ERROR","PARSE_VALIDATION_ERROR","SIGNAL_OLD_COUNTER_ERROR"]);b=a.Mirrored(["E2E","FANOUT","BOT_UNAVAILABLE_FANOUT","HOSTED_UNAVAILABLE_FANOUT","VIEW_ONCE_UNAVAILABLE_FANOUT"]);a=a({NO_OVERWRITE:0,RETRY:1,FUTURE_PROOF:2,PEER_RETRY:3,VOIP_CALL_LOG:4});var g=Object.freeze({CHAT:"chat",GROUP:"group",PEER_BROADCAST:"peer_broadcast",OTHER_BROADCAST:"other_broadcast",DIRECT_PEER_STATUS:"direct_peer_status",OTHER_STATUS:"other_status"});f.ActualActorsEnumType=c;f.HostStorageEnumType=d;f.E2EProcessResult=e;f.PlaceholderType=b;f.MessageOverwriteOption=a;f.MESSAGE_TYPE=g}),66);
__d("WAWebSimpleSignalPNToFBIDMigration",["WAWebABProps","WAWebBotTypes","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h="867051314767696",i=new Map([["867051314767696","13135550002"],["1061492271844689","13135550005"],["245886058483988","13135550009"],["3509905702656130","13135550012"],["1059680132034576","13135550013"],["715681030623646","13135550014"],["1644971366323052","13135550015"],["582497970646566","13135550019"],["645459357769306","13135550022"],["294997126699143","13135550023"],["1522631578502677","13135550027"],["719421926276396","13135550030"],["1788488635002167","13135550031"],["24232338603080193","13135550033"],["689289903143209","13135550035"],["871626054177096","13135550039"],["362351902849370","13135550042"],["1744617646041527","13135550043"],["893887762270570","13135550046"],["1155032702135830","13135550047"],["333931965993883","13135550048"],["853748013058752","13135550049"],["1559068611564819","13135550053"],["890487432705716","13135550054"],["240254602395494","13135550055"],["1578420349663261","13135550062"],["322908887140421","13135550065"],["3713961535514771","13135550067"],["997884654811738","13135550070"],["403157239387035","13135550081"],["535242369074963","13135550082"],["946293427247659","13135550083"],["3664707673802291","13135550084"],["1821827464894892","13135550085"],["1760312477828757","13135550086"],["439480398712216","13135550087"],["1876735582800984","13135550088"],["984025089825661","13135550089"],["1001336351558186","13135550090"],["3739346336347061","13135550091"],["3632749426974980","13135550092"],["427864203481615","13135550093"],["1434734570493055","13135550094"],["992873449225921","13135550095"],["813087747426445","13135550096"],["806369104931434","13135550098"],["1220982902403148","13135550099"],["1365893374104393","13135550100"],["686482033622048","13135550200"],["1454999838411253","13135550201"],["718584497008509","13135550202"],["743520384213443","13135550301"],["1147715789823789","13135550302"],["1173034540372201","13135550303"],["974785541030953","13135550304"],["1122200255531507","13135550305"],["899669714813162","13135550306"],["631880108970650","13135550307"],["435816149330026","13135550308"],["1368717161184556","13135550309"],["7849963461784891","13135550310"],["3609617065968984","13135550312"],["356273980574602","13135550313"],["1043447920539760","13135550314"],["1052764336525346","13135550315"],["2631118843732685","13135550316"],["510505411332176","13135550317"],["1945664239227513","13135550318"],["1518594378764656","13135550319"],["1378821579456138","13135550320"],["490214716896013","13135550321"],["1028577858870699","13135550322"],["308915665545959","13135550323"],["845884253678900","13135550324"],["995031308616442","13135550325"],["2787365464763437","13135550326"],["1532790990671645","13135550327"],["302617036180485","13135550328"],["723376723197227","13135550329"],["8393570407377966","13135550330"],["1931159970680725","13135550331"],["401073885688605","13135550332"],["2234478453565422","13135550334"],["814748673882312","13135550335"],["26133635056281592","13135550336"],["1439804456676119","13135550337"],["889851503172161","13135550338"],["1018283232836879","13135550339"],["1012781386779537","13135559000"],["823280953239532","13135559001"],["1597090934573334","13135559002"],["485965054020343","13135559003"],["1033381648363446","13135559004"],["491802010206446","13135559005"],["1017139033184870","13135559006"],["499638325922174","13135559008"],["468946335863664","13135559009"],["1570389776875816","13135559010"],["1004342694328995","13135559011"],["1012240323971229","13135559012"],["392171787222419","13135559013"],["952081212945019","13135559016"],["444507875070178","13135559017"],["1274819440594668","13135559018"],["1397041101147050","13135559019"],["425657699872640","13135559020"],["532292852562549","13135559021"],["705863241720292","13135559022"],["476449815183959","13135559023"],["488071553854222","13135559024"],["468693832665397","13135559025"],["517422564037340","13135559026"],["819805466613825","13135559027"],["1847708235641382","13135559028"],["716282970644228","13135559029"],["521655380527741","13135559030"],["476193631941905","13135559031"],["485600497445562","13135559032"],["440217235683910","13135559033"],["523342446758478","13135559034"],["514784864360240","13135559035"],["505790121814530","13135559036"],["420008964419580","13135559037"],["492141680204555","13135559038"],["388462787271952","13135559039"],["423473920752072","13135559040"],["489574180468229","13135559041"],["432360635854105","13135559042"],["477878201669248","13135559043"],["351656951234045","13135559044"],["430178036732582","13135559045"],["434537312944552","13135559046"],["1240614300631808","13135559047"],["473135945605128","13135559048"],["423669800729310","13135559049"],["3685666705015792","13135559050"],["504196509016638","13135559051"],["346844785189449","13135559052"],["504823088911074","13135559053"],["402669415797083","13135559054"],["490939640234431","13135559055"],["875124128063715","13135559056"],["468788962654605","13135559057"],["562386196354570","13135559058"],["372159285928791","13135559059"],["531017479591050","13135559060"],["1328873881401826","13135559061"],["1608363646390484","13135559062"],["1229628561554232","13135559063"],["348802211530364","13135559064"],["3708535859420184","13135559065"],["415517767742187","13135559066"],["479330341612638","13135559067"],["480785414723083","13135559068"],["387299107507991","13135559069"],["333389813188944","13135559070"],["391794130316996","13135559071"],["457893470576314","13135559072"],["435550496166469","13135559073"],["1620162702100689","13135559074"],["867491058616043","13135559075"],["816224117357759","13135559076"],["334065176362830","13135559077"],["489973170554709","13135559078"],["473060669049665","13135559079"],["1221505815643060","13135559080"],["889000703096359","13135559081"],["475235961979883","13135559082"],["3434445653519934","13135559084"],["524503026827421","13135559085"],["1179639046403856","13135559086"],["471563305859144","13135559087"],["533896609192881","13135559088"],["365443583168041","13135559089"],["836082305329393","13135559090"],["1056787705969916","13135559091"],["503312598958357","13135559092"],["3718606738453460","13135559093"],["826066052850902","13135559094"],["1033611345091888","13135559095"],["3868390816783240","13135559096"],["7462677740498860","13135559097"],["436288576108573","13135559098"],["1047559746718900","13135559099"],["1099299455255491","13135559100"],["1202037301040633","13135559101"],["1720619402074074","13135559102"],["1030422235101467","13135559103"],["827238979523502","13135559104"],["1516443722284921","13135559105"],["1174442747196709","13135559106"],["1653165225503842","13135559107"],["1037648777635013","13135559108"],["551617757299900","13135559109"],["1158813558718726","13135559110"],["2463236450542262","13135559111"],["1550393252501466","13135559112"],["2057065188042796","13135559113"],["506163028760735","13135559114"],["2065249100538481","13135559115"],["1041382867195858","13135559116"],["886500209499603","13135559117"],["1491615624892655","13135559118"],["486563697299617","13135559119"],["1175736513679463","13135559120"],["491811473512352","13165550064"]]),j=new Map(Array.from(i.entries()).map(function(a){var b=a[0];a=a[1];return[a,b]}));function k(a){return l(d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_receive_enabled"),a)}function a(a){return l(d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_invoke_receive_enabled"),a)}function l(a,b){if(a===!0&&b.isFbidBot()){a=i.get(b.user);if(a!=null)return d("WAWebWidFactory").createWid(a+"@s.whatsapp.net")}}function m(a){return o(d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_sending"),a)}function n(a){return o(d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_invoke_send_enabled"),a)}function o(a,b){if(a===!0&&b.isPnBot()){a=j.get(b.user);if(a!=null)return d("WAWebWidFactory").createWid(a+"@bot")}}function p(a){return j.has(a.user)}function b(a){if(a.isPnBot()&&p(a)&&d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_sending")){var b=m(a);if(b!=null)return b}return a}function c(a){if(a.isFbidBot()&&d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_sending")){var b=k(a);if(b!=null)return b}return a}function e(a){if(a.isFbidBot()&&d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_sending")){if(h===a.user)return d("WAWebBotTypes").BotPersonaType.DEFAULT;else if(i.has(a.user))return d("WAWebBotTypes").BotPersonaType.FIRST_PARTY_CHARACTER;return d("WAWebBotTypes").BotPersonaType.UGC}return null}function f(a,b){if(a.type==="addon")return;a=a.data;var c=a.get(b);if(c!=null&&p(c)&&d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_invoke_send_enabled")){c=n(c);c!=null&&a.set(b,c)}}function q(a){var b=a.data.to;if(p(b)&&d("WAWebABProps").getABPropConfigValue("ai_fbid_migration_sending")){b=m(b);b!=null&&(a.type==="message"?a.data.to=b:a.type==="addon"&&(a.data=babelHelpers["extends"]({},a.data,{to:b})))}}g.getDeprecatedPnChatForFbidThread=k;g.getDeprecatedPnChatForFbidInvoke=a;g.maybeReplaceDeprecatedBotPnWithFbid=b;g.maybeReplaceFbidWithDeprecatedBotPn=c;g.getFbidBotPersonaType=e;g.maybeReplaceWidWithFbIdForInvoke=f;g.maybeReplaceWidWithFbIdForBotSend=q}),98);
__d("WAWebHandleMsgValidate",["WAJids","WALogger","WATimeUtils","WAWebABProps","WAWebAck","WAWebApiContact","WAWebApiDeviceList","WAWebE2EProtoUtils","WAWebGetMessageCache","WAWebHandleMessageTypes.flow","WAWebHandleMsgError","WAWebHandleMsgMetaUtils","WAWebHandleMsgTypes.flow","WAWebMessagingGatingUtils","WAWebMobilePlatforms","WAWebMsgGetters","WAWebMsgType","WAWebPhashUtils","WAWebReportingTokenUtils","WAWebSimpleSignalPNToFBIDMigration","WAWebUserPrefsMeUser","WAWebWamEnumE2eFailureReason","WAWebWid","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t="message_edit";function a(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=(c=b.preMatChat)!=null?c:b.chat;if(!v({encDestination:a,envelopeDestination:c})){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["encDestination: ",", destination: ",", type: ",""])),a.toString(),c.toString(),b.type).sendLogs("validateMsgDestination: drop due to the deviceSentMessage meta mismatch.");return!1}a=b.author;if(!d("WAWebUserPrefsMeUser").isMeAccount(a)){d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["sender: ",""])),a.toString()).sendLogs("validateMsgDestination: drop due to msg is not sent from your own device.");return!1}b=(yield d("WAWebApiDeviceList").hasDevice(a,(c=a.device)!=null?c:0));b||d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["no record found for sender: ",""])),a.toString()).sendLogs("validateMsgDestination:drop due to invalid device");return b});return u.apply(this,arguments)}function v(a){var b=a.envelopeDestination;a=a.encDestination;if(a.equals(b))return!0;var e=d("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidThread(a);if(c("WAWebWid").equals(e,b))return!0;if(a.isUser()&&c("WAWebWid").equals(d("WAWebApiContact").getAlternateUserWid(a),b)){e=b.toLogString();b=a.toLogString();d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["validateMsgDestination: match but addressing mode mismatch: envelope: ",", enc: ",""])),e,b).sendLogs("validateMsgDestination-addressing-mode-mismatch");return!0}return!1}function e(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=b.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?b.bclParticipants.map(function(a){var b;return(b=a.preMatWid)!=null?b:a.wid}):(c=b.directPeerStatusBclParticipants)!=null?c:[];c=(yield d("WAWebPhashUtils").phashV2(c));if(c!==a){d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["received: "," from peer, computed: ",""])),a,c).sendLogs("validateBclHash: drop due to invalid hash.");return!1}b.bclHashValidated=!0;return!0});return w.apply(this,arguments)}function f(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.device==null?d("WAJids").DEFAULT_DEVICE_ID:a.device;if(b===d("WAJids").DEFAULT_DEVICE_ID)return!0;a=(yield d("WAWebApiDeviceList").getDeviceIds([a]));a=a[0];return a!=null&&a.devices.some(function(a){return a.id===b})});return x.apply(this,arguments)}function y(a,b){var c=a.listMessage,e=a.buttonsMessage,f=a.highlyStructuredMessage;a=a.templateMessage;if(c&&(b==null?void 0:b.verifiedListEnvelope)!==!0){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["no biz node found in list message"]))).sendLogs("validateBizNode:drop due to missing biz node in invalid SMAX in list message",{sampling:.01});return!1}if(e){var g;c=(b==null?void 0:b.verifiedButtonsEnvelope)===!0||(b==null?void 0:b.nativeFlowName)!=null||((c=e.contextInfo)==null?void 0:c.isForwarded)===!0&&(e==null||(g=e.buttons)==null?void 0:g.length)===0;c||d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["button message is invalid"]))).sendLogs("validateBizNode:drop due to invalid SMAX for buttons message");return c}if((f||a)&&(b==null?void 0:b.verifiedHsmEnvelope)!==!0){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["no biz node found in HSM"]))).sendLogs("validateBizNode:drop due to missing biz node in invalid SMAX in HSM");return!1}return!0}function z(a){var b;b=(b=a.ctwaContext)==null?void 0:b.alwaysShowAdAttribution;if(!d("WAWebMobilePlatforms").isSMB()&&!d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebMsgGetters").getSender(a))&&b===!0&&d("WAWebABProps").getABPropConfigValue("ctwa_suppress_message_via_ad_spam_web"))throw new(d("WAWebHandleMsgError").MessageValidationError)("This is a spam message sent to consumer number with 'Message Via Ad' header",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}function A(a){var b=a.renderableMsgs,e=a.msgMeta,f=a.info,g=a.proto;a=a.bizInfo;if(b.length>0&&!y(g,a))throw new(d("WAWebHandleMsgError").BizNodeValidationError)("[messaging] Biz node validation failed due to absence of biz node in SMAX");a=b[0];if(a==null)return;if(d("WAWebHandleMsgMetaUtils").isReactionMsgMeta(e)&&(a.type!==d("WAWebMsgType").MSG_TYPE.REACTION&&a.type!==d("WAWebMsgType").MSG_TYPE.REACTION_ENC))throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_REACTION_STANZA);if(d("WAWebHandleMsgMetaUtils").isPollVoteMsgMeta(e)){b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE;var h=a.type===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a.subtype==="poll_vote";if(!b&&!h)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_POLL_UPDATE_STANZA)}if(d("WAWebHandleMsgMetaUtils").isCommentMsgMeta(e)){b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.COMMENT;h=new Set([d("WAWebMsgType").MsgKind.CommentEncrypted,d("WAWebMsgType").MsgKind.CommentDecrypted,d("WAWebMsgType").MsgKind.RevokedAddon,d("WAWebMsgType").MsgKind.ProtocolRevoke,d("WAWebMsgType").MsgKind.NewsletterQuestionResponse]);if(!b&&!h.has(a.kind))throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_COMMENT_STANZA)}if(f.edit!==d("WAWebAck").EDIT_ATTR.NONE)if(f.edit===d("WAWebAck").EDIT_ATTR.PIN_IN_CHAT){b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE;if(a.type!==d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE&&!b)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_PIN_IN_CHAT_STANZA)}else if(f.edit===d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT&&!d("WAWebHandleMsgMetaUtils").isEventEditMsgMeta(e)){h=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofSubtype===t;if(a.subtype!==t&&!h)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_EDIT_STANZA)}else if(f.edit===d("WAWebAck").EDIT_ATTR.NEWSLETTER_MSG_EDIT)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_NEWSLETTER_EDIT_STANZA);else if(d("WAWebABProps").getABPropConfigValue("revoke_edit_attribute_validation_enabled"))if(f.edit===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE){if(a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL){c("gkx")("26259")&&d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["RenderableMessagesValidation: msg.type: ",""])),a.type).sendLogs("invalid-edit-attribute-admin-revoke");throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_EDIT_STANZA)}}else if(f.edit===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE){h=[(b=d("WAWebMsgType")).MSG_TYPE.REACTION,b.MSG_TYPE.REACTION_ENC,b.MSG_TYPE.PROTOCOL,b.MSG_TYPE.KEEP_IN_CHAT];if(!h.includes(a.type)){c("gkx")("26259")&&d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["RenderableMessagesValidation: msg.type: ",""])),a.type).sendLogs("invalid-edit-attribute-sender-revoke");throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_EDIT_STANZA)}}else d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["RenderableMessagesValidation: Unvalidated edit attribute ",""])),f.edit).sendLogs("unvalidated-edit-attribute");if(d("WAWebHandleMsgMetaUtils").isEventResponseMsgMeta(e)){b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE;h=a.type===d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE;if(!b&&!h)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_EVENT_RESPONSE_STANZA)}if(d("WAWebHandleMsgMetaUtils").isEventEditMsgMeta(e)){f=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.futureproofType===d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED;b=a.type===d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED;if(!f&&!b)throw new(d("WAWebHandleMsgError").MessageProtobufMismatchError)(d("WAWebHandleMsgError").MessageProtobufMismatchErrorCode.INVALID_EVENT_EDIT_STANZA)}if(c("gkx")("26259")){h=d("WAWebE2EProtoUtils").typeAttributeFromProtobuf(g);h!==(e==null?void 0:e.type)&&d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Type in stanza [","] is different from the one derived from protobuf [","]. Message type: ",""])),e==null?void 0:e.type,h,a.type).tags("messaging").sendLogs("report-token-stanza-protobuf-type-mismatched",{sampling:.01}).devConsole({msgMeta:e,proto:g})}z(a)}function B(a){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=a.renderableMsgs;a=a.forceDualEncryptedValidation;a=a===void 0?!1:a;if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return;c=c[0];if(c==null||c.plainProtobufBytes==null||c.reportingTokenInfo==null)return;var e=c.reportingTokenInfo,f=c.plainProtobufBytes,g=e.reportingTag,h=e.reportingToken;e=e.version;e=e===void 0?d("WAWebReportingTokenUtils").REPORTING_TOKEN_VERSION.DEFAULT:e;if(g==null)return;b=(b=c.protocolMessageKey)==null?void 0:b.toString();g={msgKey:b!=null?b:c.id.toString(),stanzaId:c.id.id,reportingTag:g,receivedTs:d("WATimeUtils").unixTimeMs(),msgTs:(g=c.t)!=null?g:0};if(c.kind===d("WAWebMsgType").MsgKind.Unknown){d("WAWebGetMessageCache").getMessageCache().addAdditionalInfo({type:d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo,data:babelHelpers["extends"]({},g)},b!=null);return}if((c.kind===d("WAWebMsgType").MsgKind.CommentEncrypted||c.kind===d("WAWebMsgType").MsgKind.EventEditEncrypted)&&a===!1)return;f=(yield d("WAWebReportingTokenUtils").validateReportingTokenInfo(c,f));var i=f.res,j=f.reportingTokenContent;f=f.reportingTokenKey;c=D(c,h)?babelHelpers["extends"]({reportingToken:h==null?void 0:h.slice(0,i?d("WAWebReportingTokenUtils").REPORTING_TOKEN_STORAGE_SIZE:d("WAWebReportingTokenUtils").REPORTING_TOKEN_INVALID_STORAGE_SIZE),reportingTokenContentOpaqueData:j,version:e},f!=null&&{reportingTokenKey:f}):null;d("WAWebGetMessageCache").getMessageCache().addAdditionalInfo({type:d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo,data:babelHelpers["extends"]({},g,c)},b!=null||a===!0)});return C.apply(this,arguments)}function D(a,b){if(b==null)return!1;return d("WAWebReportingTokenUtils").shouldSkipProcessingEditedMsg(a)||d("WAWebReportingTokenUtils").shouldSkipProcessingDualEncryptedMsg(a)?!1:!0}g.validateMsgDestination=a;g.validateBclHash=e;g.isFromKnownDevice=f;g.validateBizNode=y;g.renderableMessagesValidation=A;g.validateAndProcessReportingTokenInfo=B}),98);
__d("WAWebHandlePlaceholderMsgKeyHashUtils",["WABase64","WACryptoHmac","WAWebABProps","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=null,i=new TextEncoder(),j=function(a){return i.encode(a).buffer};function k(){h||(h=d("WAWebUserPrefsMultiDevice").getChatThreadLoggingSecretB64().then(function(a){return a==null?null:d("WABase64").decodeB64(a)}));return h}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=(yield k());if(!c)return null;b=j(String(a.id.id+(a.id.fromMe?"1":"0")+((b=(b=a.id.remote)==null?void 0:b.toString({legacy:!0}))!=null?b:"")+((a=(b=a.id.participant)==null?void 0:b.toString({legacy:!0}))!=null?a:"")));a=(yield d("WACryptoHmac").hmacSha256(c,b));return d("WABase64").encodeB64(a)});return l.apply(this,arguments)}function c(){return d("WAWebABProps").getABPropConfigValue("placeholder_message_key_hash_logging")}g.getMessageKeyHash=a;g.messageKeyHashEnabled=c}),98);
__d("WAWebWamEnumAddressingMode",[],(function(a,b,c,d,e,f){a=Object.freeze({PN:1,LID:2});f.ADDRESSING_MODE=a}),66);
__d("WAWebWamEnumE2eDeviceType",[],(function(a,b,c,d,e,f){a=Object.freeze({MY_PRIMARY:1,OTHER_PRIMARY:2,MY_COMPANION:3,OTHER_COMPANION:4,MY_HOSTED_COMPANION:5,OTHER_HOSTED_COMPANION:6});f.E2E_DEVICE_TYPE=a}),66);
__d("WAWebWamEnumEncryptionTypeCode",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE:1,COEX:2,SELF_COEX:3,CAPI:4,BSP:5,GUEST:6});f.ENCRYPTION_TYPE_CODE=a}),66);
__d("WAWebWamEnumPlaceholderAction",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,ADD:1,VIEW:2,POPULATE:3});f.PLACEHOLDER_ACTION=a}),66);
__d("WAWebWamEnumPlaceholderChatType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,INDIVIDUAL:1,GROUP:2,STATUS:3,BROADCAST:4,CHANNEL:5,INTEROP:6});f.PLACEHOLDER_CHAT_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderPopulationType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,RETRY:1,PEER_MESSAGE:2,RESEND:3});f.PLACEHOLDER_POPULATION_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderReasonType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,SIGNAL_NO_SESSION:1,DEVICE_VERIFICATION_FAILURE:2,UNKNOWN_SELF_DEVICE:3,SIGNAL_INVALID_KEY:4,SIGNAL_INVALID_KEY_ID:5,SIGNAL_INVALID_MESSAGE:6,DEVICE_VERIFICATION_FAILURE_SELF_PEER:7,UNKNOWN_COMPANION_NO_PREKEY:8,BAD_EPHEMERAL_SETTING:9,SIGNAL_FUTURE_MESSAGE:10,SIGNAL_INVALID_SIGNATURE:11,SIGNAL_BAD_MAC:12,SIGNAL_INVALID_SESSION:13});f.PLACEHOLDER_REASON_TYPE=a}),66);
__d("WAWebWamEnumPlaceholderType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,CIPHERTEXT:1,FANOUT:2,DOWNGRADE:3,FIXED_CONTENT:4,TEMPORARY:5,DROP:6});f.PLACEHOLDER_TYPE=a}),66);
__d("WAWebPlaceholderActivityWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumE2eDeviceType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumPlaceholderAction","WAWebWamEnumPlaceholderChatType","WAWebWamEnumPlaceholderPopulationType","WAWebWamEnumPlaceholderReasonType","WAWebWamEnumPlaceholderType","WAWebWamEnumSizeBucket","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({PlaceholderActivity:[1980,{deviceCount:[9,a.TYPES.INTEGER],deviceSizeBucket:[8,d("WAWebWamEnumSizeBucket").SIZE_BUCKET],e2eSenderType:[16,d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],encryptionType:[22,d("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],isHostedChat:[19,a.TYPES.BOOLEAN],isLid:[12,a.TYPES.BOOLEAN],isSimpleSignal:[23,a.TYPES.BOOLEAN],localAddressingMode:[20,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageBeforeReg:[15,a.TYPES.BOOLEAN],messageIsRevoke:[7,a.TYPES.BOOLEAN],messageKeyHash:[14,a.TYPES.STRING],messageMediaType:[6,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[5,d("WAWebWamEnumMessageType").MESSAGE_TYPE],participantCount:[10,a.TYPES.INTEGER],placeholderActionInd:[2,d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION],placeholderAddReason:[11,d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE],placeholderChatTypeInd:[3,d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE],placeholderPopulationType:[17,d("WAWebWamEnumPlaceholderPopulationType").PLACEHOLDER_POPULATION_TYPE],placeholderTimePeriod:[4,a.TYPES.INTEGER],placeholderTypeInd:[1,d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE],typeOfGroup:[13,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{PlaceholderActivity:[]});g.PlaceholderActivityWamEvent=b}),98);
__d("WAWebWamGroupMetadataMetricUtils",["WAWebDBGroupsGroupMetadata","WAWebGroupType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a!=null&&a.isGroup()){a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(a!=null)return d("WAWebGroupType").groupTypeToWamEnum(d("WAWebGroupType").getGroupTypeFromGroupMetadata(a))}});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));return a==null?null:j(a)});return i.apply(this,arguments)}function j(a){return d("WAWebGroupType").getGroupTypeFromGroupMetadata(a)===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP}g.getGroupTypeFromChatWid=a;g.isCagFromChatWid=c;g.isCagFromGroupMetadata=j}),98);
__d("WAWebHandlePlaceholderWam",["Promise","WATimeUtils","WAWebDBGroupsGroupMetadata","WAWebDBMessageSerialization","WAWebGroupType","WAWebHandlePlaceholderMsgKeyHashUtils","WAWebMsgGetters","WAWebPlaceholderActivityWamEvent","WAWebWamEnumPlaceholderAction","WAWebWamEnumPlaceholderChatType","WAWebWamEnumPlaceholderType","WAWebWamGroupMetadataMetricUtils","WAWebWamGroupMetricCache","WAWebWamMsgUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a,d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.ADD));a.forEach(function(a){return a.commit()})});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)});a=(yield n(a,d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.VIEW));a.forEach(function(a){return a.commit()})});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield n(a,d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.POPULATE));a.forEach(function(a){return a.commit()})});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f,g=a.id.remote,h=Boolean(b==null?void 0:b.isLidAddressingMode);h=d("WAWebWamMsgUtils").msgIsLid(a,g,h);f=new(d("WAWebPlaceholderActivityWamEvent").PlaceholderActivityWamEvent)({placeholderChatTypeInd:t(g),placeholderTimePeriod:Math.max(d("WATimeUtils").unixTime()-((f=a.t)!=null?f:0),0),placeholderActionInd:e,placeholderTypeInd:a.subtype==="fanout"?d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE.FANOUT:d("WAWebWamEnumPlaceholderType").PLACEHOLDER_TYPE.CIPHERTEXT,messageIsRevoke:d("WAWebMsgGetters").getIsRevoke(a),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(a),messageType:d("WAWebWamMsgUtils").getWamMessageType(a),isLid:h});a.placeholderAddReason!=null&&(f.placeholderAddReason=a.placeholderAddReason);e===d("WAWebWamEnumPlaceholderAction").PLACEHOLDER_ACTION.POPULATE&&a.placeholderPopulationType!=null&&(f.placeholderPopulationType=a.placeholderPopulationType);a.e2eSenderType!=null&&(f.e2eSenderType=a.e2eSenderType);c("WAWebWid").isGroup(g)?yield p(f,a,b):c("WAWebWid").isUser(g)&&(f.isLid=g.isLid());yield r(f,a);return f});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=[];for(a of a){if(!u(a))continue;d("WAWebMsgGetters").getIsGroupMsg(a)?f.push(a):e.push(a)}a=(yield d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(f.map(function(a){return a.id.remote}))).map(function(a,b){return[f[b],a]});return(h||(h=b("Promise"))).all([].concat(e.map(function(a){return l(a,null,c)}),a.map(function(a){var b=a[0];a=a[1];return l(b,a,c)})))});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=(yield d("WAWebWamGroupMetricCache").getGroupMetrics(b.id.remote));e!=null&&(e.participantCount!=null&&(a.participantCount=e.participantCount),e.deviceCount!=null&&(a.deviceCount=e.deviceCount),e.deviceSizeBucket!=null&&(a.deviceSizeBucket=e.deviceSizeBucket));if(c){e=d("WAWebWamGroupMetadataMetricUtils").isCagFromGroupMetadata(c);a.isLid=e&&d("WAWebMsgGetters").getIsReaction(b);a.typeOfGroup=d("WAWebGroupType").groupTypeToWamEnum(d("WAWebGroupType").getGroupTypeFromGroupMetadata(c))}});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAWebHandlePlaceholderMsgKeyHashUtils").messageKeyHashEnabled()){b=(yield d("WAWebHandlePlaceholderMsgKeyHashUtils").getMessageKeyHash(b));b!=null&&(a.messageKeyHash=b)}});return s.apply(this,arguments)}function t(a){if(c("WAWebWid").isGroup(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.GROUP;else if(c("WAWebWid").isStatus(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.STATUS;else if(c("WAWebWid").isBroadcast(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.BROADCAST;else if(c("WAWebWid").isUser(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.INDIVIDUAL;else if(c("WAWebWid").isNewsletter(a))return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.CHANNEL;return d("WAWebWamEnumPlaceholderChatType").PLACEHOLDER_CHAT_TYPE.OTHER}function u(a){return a.subtype==="view_once_unavailable_fanout"?!1:!0}g.postPlaceholderActivityAddEvent=a;g.postPlaceholderActivityViewEvent=e;g.postPlaceholderActivityPopulateEvent=f}),98);
__d("WABackoffUtils",["WAPromiseDelays"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d){d===void 0&&(d=.1);var e;a===0?e=c||0:e=Math.pow(2,a);Number.isFinite(b)&&e>b&&(e=b);typeof c==="number"&&Number.isFinite(c)&&e<c&&(e=c);d&&(e*=1+d*Math.random());return e}function a(a,b,c,e){e===void 0&&(e=.1);return d("WAPromiseDelays").delayMs(Math.floor(1e3*h(a,b,c,e)))}g.expBackoff=h;g.expDelaySec=a}),98);
__d("WAPromiseLoop",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";function a(a,b){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=!1,d,e=function(a){c=!0,d=a},f=0;b=b;while(!c)b=(yield a(e,b,f)),f++;return d});return g.apply(this,arguments)}f.promiseLoop=a}),66);
__d("WAWebHandleForMessageRangeEnums",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["DropMessage","SkipUI"]);c=b("$InternalEnum").Mirrored(["DOES_NOT_CONTAIN","CONTAINS_BY_TIMESTAMP","CONTAINS_BY_ADDITIONAL"]);f.ActiveRangeHandlerAction=a;f.RangeContain=c}),66);
__d("WAWebJobsStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="jobs-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56369);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[jobs-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebJobsStorageVersions",["WAWebJobsStorageUtils"],(function(a,b,c,d,e,f,g){c=1;function a(){return d("WAWebJobsStorageUtils").getStorage().versions.version(0)}function b(){return d("WAWebJobsStorageUtils").getStorage().versions.version(1)}g.versionToRollout=c;g.jobsCreateV1Table=a;g.jobsCreateV2Table=b}),98);
__d("WAWebSchemaJobs",["WAWebJobsStorageUtils","WAWebJobsStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey,j=c.addIndex,k=c.removeColumn;function a(){d("WAWebJobsStorageUtils").getStorage().add("jobs-store").version(d("WAWebJobsStorageVersions").jobsCreateV1Table(),[i("jobId"),h("type"),h("uniqKey"),j("uniqKey"),h("original"),h("current"),h("step"),h("startTime"),h("endTime"),h("stepHardStartCountAfterTimeout"),h("stepFirstStartTime"),h("waitUntil"),h("backedOffCount"),h("version")]).version(d("WAWebJobsStorageVersions").jobsCreateV2Table(),[h("stepUnexpectedErrorCount"),k("endTime")]).view(function(a){return{jobId:a.jobId,type:a.type,uniqKey:a.uniqKey,original:a.original,current:a.current,step:a.step,startTime:a.startTime,stepHardStartCountAfterTimeout:a.stepHardStartCountAfterTimeout,stepFirstStartTime:a.stepFirstStartTime,waitUntil:a.waitUntil,backedOffCount:a.backedOffCount,version:a.version,stepUnexpectedErrorCount:a.stepUnexpectedErrorCount}})}function b(){return d("WAWebJobsStorageUtils").getStorage().table("jobs-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebJobsStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebJobsStorageUtils","WAWebSchemaJobs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebJobsStorageUtils").createStorage(),d("WAWebSchemaJobs").addTable(),i=d("WAWebJobsStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).verbose().devConsole(a).sendLogs("Failed to initialize jobs storage",{sendLogsType:d("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD});throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebJobsStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebJobsStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.initialize=a;g.destroy=e}),98);
__d("WAWebPersistedJob",["cr:13545"],(function(a,b,c,d,e,f,g){function a(a){h(a,b("cr:13545"))}function h(a,b){Object.keys(b).forEach(function(c){Object.prototype.hasOwnProperty.call(b,c)&&a.addPersistedJobImplementation(c,b[c])})}g["default"]=a}),98);
__d("WAWebPersistedJobManager",["Promise","WAPersistedJobManager","WARandomHex","WATimeUtils","WAWebJobsStorage","WAWebNoop","WAWebPersistedJob","WAWebSchemaJobs","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=null;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebJobsStorage").initialize();var a=d("WAWebSchemaJobs").getTable();i=new(d("WAPersistedJobManager").PersistedJobManager)({accessors:k(),unfinishedJobEntries:a.all(),isRestartAfterCrash:!1,listeners:{onJobStarted:c("WAWebNoop"),onJobFinished:function(){return null}},deprecatedJobs:{}});c("WAWebPersistedJob")(i)});return j.apply(this,arguments)}function k(){return{deletePersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.remove(a)},updatePersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.createOrReplace(a)},readPersistedJob:function(a){var b=d("WAWebSchemaJobs").getTable();return b.get(a)},loadAllJobs:function(){var a=d("WAWebSchemaJobs").getTable();return a.all()},maybeCreateJob:l}}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c,e=d("WAWebSchemaJobs").getTable();c=JSON.stringify([a.type,(c=a.uniqKey)!=null?c:d("WARandomHex").randomHex(32)]);c={type:a.type,uniqKey:c,startTime:d("WATimeUtils").unixTime(),version:(c=a.version)!=null?c:1,original:a.args,current:a.args,step:d("WAPersistedJobManager").UNSTARTED_JOB,waitUntil:null,stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,backedOffCount:0};if(a.uniqKey==null)return e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}});a=(yield e.equals(["uniqKey"],[a.uniqKey]));if(a.length===0)return e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}});var f=[],g=null;for(a of a)a.step!==d("WAPersistedJobManager").FINISHED_JOB?g=a:f.push(e.remove(a.jobId));yield (h||(h=b("Promise"))).all(f);return g!=null?{id:g.jobId,newlyCreated:!1}:e.createOrReplace(c).then(function(a){return{id:a,newlyCreated:!0}})});return m.apply(this,arguments)}function e(){if(i==null)throw c("err")("jobs manager has not been initialized");return i}g.startWebPersistedJobManager=a;g.maybeCreateJob=l;g.getJobManager=e}),98);
__d("WAWebHandleSingleMsg",["Promise","WABackoffUtils","WALogger","WAPromiseDelays","WAPromiseLoop","WATimeUtils","WAWebApiChat","WAWebApiFilterAndReplaceMessages","WAWebApiGroupInviteV4Store","WAWebBackendApi","WAWebBackendErrors","WAWebCheckUpdateOrphanReactions","WAWebDBProcessMessage","WAWebDBStoreRevokeMsgs","WAWebHandleForMessageRange","WAWebHandleForMessageRangeEnums","WAWebHandleMsgTypes.flow","WAWebHandlePlaceholderWam","WAWebMsgGetters","WAWebMsgType","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;function a(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.chatId,f=a.newMsg,g=a.handleSingleMsgOrigin,x=a.messageOverwriteOption;x=x===void 0?d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE:x;a=a.preserveOrder;a=a===void 0?!0:a;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: called with msgId::",", chat id::"," type::",",",""])),f.id.id,e.toLogString(),f.type,f.subtype).tags("messaging");var y=x!==d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,z=x===d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.VOIP_CALL_LOG,A={add:"after",update:y,isHistory:!1},B=f.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&["sender_revoke","admin_revoke"].includes(f.subtype),C=f;if(!B){x=(yield d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages([C]));x=x.newMsgs;if(x.length===0)return;C=x[0]}x=(yield d("WAWebHandleForMessageRange").handleForActiveMessageRange(e,C));if(x.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage))return;x=x.has(d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.SkipUI);try{d("WAWebMsgGetters").getIsStatus(f)&&(yield d("WAWebBackendApi").frontendSendAndReceive("handleStatusUpdate",{rawMsg:C,checksum:null,isMsgUpdate:!1}));yield d("WAPromiseLoop").promiseLoop(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,f){c=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(f,12e4,1e3,.1));try{var g;if(y)try{C=(yield d("WAWebDBProcessMessage").updateMessage(C)),g=!1,d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["placeholder populate successful"]))).tags("handleSingleMsg")}catch(a){if(a instanceof d("WAWebDBProcessMessage").NoMessageToUpdateError&&z)g=!0,d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Msg overwrite failed, will fall back to creation"])));else throw a}if(!y||g===!0)if(B)yield d("WAWebDBStoreRevokeMsgs").processRevokeMsgs([{revokeMsgKey:C.protocolMessageKey,newMsgKey:C.id,timestamp:C.t,subtype:C.subtype,sender:C.author,revokeTimestamp:C.t}]),d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:[C.protocolMessageKey.toString()]}),yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(e.toString(),[C.protocolMessageKey.toString()]));else try{yield d("WAWebDBProcessMessage").storeMessages([C],e),C.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT&&void d("WAWebHandlePlaceholderWam").postPlaceholderActivityAddEvent([C])}catch(a){if(a instanceof d("WAWebDBProcessMessage").DuplicateMessageError)C.type===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT?d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["processPlaceholderMsg: skip creating duplicate placeholder"]))):(d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: detect resend message"]))),C=(yield d("WAWebDBProcessMessage").updateMessage(C)),A.update=!0);else throw a}if(C.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE){var h=C.id.toString();yield d("WAWebApiGroupInviteV4Store").persistGroupInviteV4Msg(h,{id:h,from:C.from.toString(),to:C.to.toString(),groupId:C.inviteGrp,expiration:parseInt(C.inviteCodeExp,10),expired:d("WATimeUtils").unixTime()>=parseInt(C.inviteCodeExp,10)})}d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop"]))).tags("handleSingleMsg");a()}catch(a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: failed with error ","."])),a).tags("handleSingleMsg");if(f>3){d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["storeMessages loop: Gave up after "," tries"])),f);return(w||(w=b("Promise"))).reject(a)}return c}});return function(b,c,d){return a.apply(this,arguments)}}());d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: msgId::",", chat id::"," type: "," "," write message to db done, overwrite: ",", skipUI: ",""])),C.id.id,e.toLogString(),C.type,C.subtype,y,x).tags("messaging");try{yield d("WAWebBackendApi").frontendSendAndReceive("checkOrphanMutations",{msgIds:[C.id.toString()],chatIds:[e.toString()]}),d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: msgId::",", checkOrphanMutations done"])),C.id.id).tags("messaging"),yield d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions([C.id.toString()])}catch(a){d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: checkOrphanMutations failed during handleSingleMsg for: "," chat: "," Error: ",", message: ",", stack: ",""])),String(C.id),String(e),a.name,a.message,a.stack).devConsole(a)}f=!1;if(g==="createChat"&&C.type!==d("WAWebMsgType").MSG_TYPE.CHAT&&e.isRegularUser()){var D=(yield d("WAWebApiChat").getChatRecord(e));D==null&&(f=!0,d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleSingleMsg: non existing chat while adding a system message to a new chat. chatId: ",""])),e.toLogString()))}!x&&!f&&(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:e,msgObjs:[babelHelpers["extends"]({},C,{recvFresh:!0,isNewMsg:!0})],meta:A,processMessagesOrigin:g,chatMsgsCollection:null,preserveOrder:a}))}catch(a){if(a instanceof d("WAWebBackendErrors").LogoutDrop)return;if(a instanceof d("WAWebDBProcessMessage").PreviousMsgNotUpdatableError){d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: PreviousMsgNotUpdatableError"])),String(C.id),String(e));return}!c("gkx")("26258")?d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(C.id),String(e),a.name,a.message,a.stack).tags("messaging").devConsole(a).sendLogs("msg_handler: error storing/processing single message"):d("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Msg: "," chat: "," Error: ",", message: ",", stack: ",""])),String(C.id),String(e),a.name,a.message,a.stack).tags("messaging").devConsole(a)}});return x.apply(this,arguments)}g.handleSingleMsg=a}),98);
__d("WAWebShouldUpdateLastAddOnPreview",["WAWebBackendApi","WAWebDBUpdateLastAddOnPreviewChat","WAWebLastAddOnDBSerialization","WAWebMsgKey","WAWebReactionsBEUtils","WAWebSchemaChat","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){var b=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.type==="comment"?!0:(d("WAWebUserPrefsMeUser").isSerializedWidMe(a.sender)||b.fromMe)&&!a.isOrphan}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a));a.forEach(function(a){var c;a!=null&&b.set(a.id.toString(),(c=a.chatlistPreview)!=null?c:a.lastReactionPreview)});return b});return j.apply(this,arguments)}function k(a){a=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.remote.toString()}function l(a,b){return!p(a)?!1:a.sender===b.sender&&a.parentMsgKey===b.parentMsgKey&&a.timestamp>=b.timestamp}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.filter(function(a){return h(a)});var b=new Map();if(!a.length)return b;var e=new Set(a.map(function(a){a=c("WAWebMsgKey").fromString(a.parentMsgKey);return a.remote.toString()})),f=(yield i(Array.from(e)));a.forEach(function(a){var c=k(a),e=f.get(c),g=b.get(c);g=g!=null?g:e;p(a)?g&&l(a,g)&&a.timestamp>=g.timestamp&&b.set(c,void 0):g?a.timestamp>=g.timestamp&&b.set(c,d("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromCandidate(a)):b.set(c,d("WAWebLastAddOnDBSerialization").lastAddOnPreviewFromCandidate(a))});return b});return n.apply(this,arguments)}function a(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield m(a));a.size>0&&(yield d("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(a),d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:a}))});return o.apply(this,arguments)}function p(a){switch(a.type){case"poll_vote":return a.selectedOptionsCount===0;case"reaction":default:return a.reactionText===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT}}g.isAddOnPreviewUpdateCandidate=h;g.bulkGetChatLastAddOnPreviewMap=i;g.filterChatsWithAddOnPreviewUpdates=m;g.filterAndUpdateChatPreviews=a}),98);
__d("WAWebHandleMsgReceiptCommon",["WALogger","WATimeUtils","WAWebAck","WAWebActiveMessageRanges","WAWebApiActiveMessageRanges","WAWebApiChat","WAWebApiOrphanReceipt","WAWebBackendApi","WAWebChatThreadLogging","WAWebDBBulkGetRootMsgs","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebMarkAddOnsAsReadJob","WAWebMsgKey","WAWebNewsletterDBUtils","WAWebNewsletterGatingUtils","WAWebPromiseQueue","WAWebSchemaMessage","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=new(d("WAWebPromiseQueue").PromiseQueue)();function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a));a=a.filter(function(a){return a.action==="markChatAsRead"&&a.actionValue.read===!1&&a.actionValue.messageRange!=null});if(a.length===0)return!0;d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["shouldMarkChatRead: found an active mark as unread range"])));var e=a[0];a=b.some(function(a){return!d("WAWebActiveMessageRanges").rangeContainsMessage(e.actionValue.messageRange,{id:c("WAWebMsgKey").fromString(a.id),t:a.t})});d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["shouldMarkChatRead: messageExistsOutsideRange=",""])),a);return a});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["updateChatPeerRead"])));var e=b.map(String),f=null;b=(yield d("WAWebDBBulkGetRootMsgs").bulkGetRootMsgs(b.map(String),!1));var g=b.find(Boolean);g=g?c("WAWebMsgKey").fromString(g.id).remote:a;var h=[];b.forEach(function(a,b){if(!a)h.push(e[b]);else if(a.pendingReadReceipt==null)return;else a.rowId!=null&&(f==null||a.rowId>f)&&(f=a.rowId)});h.length>0&&d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["updateChatPeerRead: maybeOrphans ",""])),h.length);var i;if(h.length===0)i=new Set();else{a=(yield d("WAWebMarkAddOnsAsReadJob").markUnclassifiedAddOnsAsReadJob(h.map(function(a){return c("WAWebMsgKey").from(a)})));var j=a.updatedAddOns;a=a.updatedOrphans;i=new Set([].concat(a,c("lodash").flatten(Array.from(j.values()))).map(String))}var k=h.filter(function(a){return!i.has(a)});q.enqueue(function(){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["updateChatPeerRead: storing "," orphan acks"])),k.length);return d("WAWebApiOrphanReceipt").createOrUpdateOrphanReceipt(d("WAWebAck").ACK_STRING.READ,0,k)});yield d("WAWebApiChat").markMessageAndChatAsRead(f,String(g),!(yield r(g.toString(),b.filter(Boolean))));if(g.isNewsletter()){d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&(yield d("WAWebBackendApi").frontendSendAndReceive("updateNewsletterUnreadMsgCount",{id:g}));return}yield d("WAWebBackendApi").frontendSendAndReceive("updateChatUnreadMsgCountAndClearMentions",{remote:g})});return u.apply(this,arguments)}function a(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=a.map(function(a){return d("WAWebDBMessageUtils").craftInternalId(b.toJid(),a)});a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],a));a=a.map(function(a){return c("WAWebMsgKey").fromString(a.id)});yield d("WAWebNewsletterDBUtils").updateMsgViewReceipt(a);return d("WAWebBackendApi").frontendFireAndForget("updateMsgsViewed",{ids:a})});return v.apply(this,arguments)}function e(a,b,c){q.enqueue(function(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateMsgAcks: store "," orphan acks"])),a.length);var e=null;b===d("WAWebAck").ACK.PLAYED?e=d("WAWebAck").ACK_STRING.PLAYED:b===d("WAWebAck").ACK.READ&&(e=d("WAWebAck").ACK_STRING.READ);if(e)return d("WAWebApiOrphanReceipt").createOrUpdateOrphanReceipt(e,c,a.map(String))})}function f(a){return q.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebApiOrphanReceipt").getOrphanReceipt(a));if(b==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: no orphan ack found for incoming ",""])),a);return}b[d("WAWebAck").ACK_STRING.PLAYED]!=null&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: orphan played ack found for incoming ",""])),a),yield d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:[a],ack:d("WAWebAck").ACK.PLAYED,t:b[d("WAWebAck").ACK_STRING.PLAYED]}));b[d("WAWebAck").ACK_STRING.READ]!=null&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["processOrphanPeerReceipt: orphan read ack found for incoming ",""])),a),t(a.remote,[a]));yield d("WAWebApiOrphanReceipt").removeOrphanReceipt(b.msgKey)}))}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(String);a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a,!1));d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging(a.filter(Boolean).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)}).filter(function(a){return a.isViewOnce}).map(function(a){var b;return{activityType:"viewOnceOpen",ts:(b=a.t)!=null?b:d("WATimeUtils").unixTime(),chatId:a.id.remote}}))});return x.apply(this,arguments)}g.updateChatPeerRead=t;g.updateMsgViewed=a;g.updateOrphanPeerReceipt=e;g.processOrphanPeerReceipt=f;g.handleViewOnceOpenedIfNecessary=w}),98);
__d("WAWebCommsSendPing",["WAComms","WACustomError","WALogger","WAPromiseTimeout","WATimeUtils","WAWebABProps","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=null;function a(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebABProps").getABPropConfigValue("web_offline_resume_wait_for_ping_response_enabled")){var a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["blockSendPing: sending ping..."])));var a=(yield d("WAPromiseTimeout").promiseTimeout(d("WAComms").sendPing(),c*1e3));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["blockSendPing: is connected: ",""])),a);return a}catch(a){if(a instanceof d("WACustomError").TimeoutError){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["blockSendPing: no response in ","s"])),c);return!1}d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["blockSendPing: failed to send ping: ",""])),a);throw a}finally{l=null}});return function(){return a.apply(this,arguments)}}();if(l!=null)return l;var c=d("WAWebABProps").getABPropConfigValue("web_offline_resume_wait_for_ping_timeout_seconds");l=a();return l}return d("WAComms").sendPing()});return m.apply(this,arguments)}function c(a){d("WATimeUtils").setClockSkew(a)}g.blockSendPing=a;g.updateClockSkew=c}),98);
__d("WAWebCommsWapMd",["WALogger","WAWapJid","WAWebBizCoexGatingUtils","WAWebWid","WAWebWidValidator","err"],(function(a,b,c,d,e,f,g){var h,i;function j(a){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())if(a.server==="hosted")return d("WAWapJid").DomainType.HOSTED;else if(a.server==="hosted.lid")return d("WAWapJid").DomainType.HOSTED_LID;return a.server==="lid"?d("WAWapJid").DomainType.LID:d("WAWapJid").DomainType.WHATSAPP}function a(a){if(!(a instanceof c("WAWebWid"))||!a.isUser())throw c("err")("DEVICE_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));if(a.isPSA()){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["DEVICE_JID: invalid PSA jid"]))).sendLogs("invalid-psa-user-jid");throw c("err")("USER_JID: invalid PSA jid")}return a.isFbidBot()?d("WAWapJid").WapJid.create(a.user,a.getJidServer()):d("WAWapJid").WapJid.createJidU(a.user,j(a),a.device)}function b(a){if(!(a instanceof c("WAWebWid"))||!a.isUser())throw c("err")("USER_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));if(a.isPSA()){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["USER_JID: invalid PSA jid"]))).sendLogs("invalid-psa-user-jid");throw c("err")("USER_JID: invalid PSA jid")}return d("WAWapJid").WapJid.create(a.user,a.getJidServer())}function e(a){if(!(a instanceof c("WAWebWid"))||!a.isUser()&&!a.isGroup()&&!a.isBroadcast()&&!a.isNewsletter())throw c("err")("CHAT_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,a.getJidServer())}function f(a){if(!(a instanceof c("WAWebWid"))||!a.isGroup())throw c("err")("GROUP_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,d("WAWebWidValidator").Domains.G_US)}function k(a){if(!(a instanceof c("WAWebWid"))||!a.isGroupCall())throw c("err")("GROUP_CALL_JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));return d("WAWapJid").WapJid.create(a.user,d("WAWebWidValidator").Domains.CALL)}function l(a){if(!(a instanceof c("WAWebWid")))throw c("err")("JID: invalid jid type: "+(a instanceof c("WAWebWid")?a.toString():"Not an instance of WID"));var b=a.device==null||a.device===0;return!b?d("WAWapJid").WapJid.createJidU(a.user,j(a),a.device):d("WAWapJid").WapJid.create(a.user,a.getJidServer())}g.DEVICE_JID=a;g.USER_JID=b;g.CHAT_JID=e;g.GROUP_JID=f;g.GROUP_CALL_JID=k;g.JID=l}),98);
__d("WAWebOffdStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="offd-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56317);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[offd-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebSchemaDanglingReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("dangling-receipt").version(d("WAWebOffdStorageUtils").getStorage().versions.version(1),[i("id"),h("receipts"),h("acks")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("dangling-receipt")}g.addTable=a;g.getTable=b}),98);
__d("WAWebOfflineResumePreAckHandler",["WABatcher","WADeprecatedSendIq","WALogger","WAWap","WAWebCommsWapMd","WAWebSchemaDanglingReceipt","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=d("WAWap").S_WHATSAPP_NET.toString(),j=d("WAWap").G_US.toString();function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c,d,e=a.attrs["class"].toString();if(e!=="notification"&&e!=="receipt")return;var f=a.attrs.id.toString(),g=a.tag,h=a.attrs.to.toString();b=(b=a.attrs.participant)==null?void 0:b.toString();c=(c=a.attrs.type)==null?void 0:c.toString();a=(d=a.attrs)!=null&&d.error?parseInt((d=a.attrs)==null?void 0:d.error.toString(),10):void 0;void n({ackClass:e,ackId:f,to:h,tag:g,participant:b,type:c,error:a})});return k.apply(this,arguments)}function l(a){switch(a){case j:return d("WAWap").G_US;case i:return d("WAWap").S_WHATSAPP_NET;default:return d("WAWebCommsWapMd").JID(d("WAWebWidFactory").createWidFromWidLike(a))}}function c(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.type!=null?d("WAWap").CUSTOM_STRING(a.type):d("WAWap").DROP_ATTR;try{b=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a.ackId),"class":d("WAWap").CUSTOM_STRING(a.ackClass),to:l(a.to),type:b,participant:a.participant!=null?d("WAWebCommsWapMd").DEVICE_JID(d("WAWebWidFactory").createWid(a.participant)):d("WAWap").DROP_ATTR,error:a.error!=null?d("WAWap").INT(a.error):d("WAWap").DROP_ATTR});return d("WADeprecatedSendIq").deprecatedCastStanza(b,{preAck:!0})}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to send offline pre-ack for envelope: "," with error: ",""])),a.ackClass,b).sendLogs("offline-pre-ack")}});return m.apply(this,arguments)}var n=function(){return d("WABatcher").batch({delayMs:3e3,maxSize:400},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaDanglingReceipt").getTable().create({receipts:[],acks:a});return[]});return function(b){return a.apply(this,arguments)}}())}();g.parseAndSerializeOfflinePreAck=a;g.sendOfflinePreAck=c}),98);
__d("WAWebWamEnumOfflineResumeModes",[],(function(a,b,c,d,e,f){a=Object.freeze({RESUME_FROM_RESTART:1,RESUME_FROM_OPEN_TAB:2,UNKNOWN:3,CONNECT_REASON_USER:4,CONNECT_REASON_PUSH:5,CONNECT_REASON_BACKOFF:6});f.OFFLINE_RESUME_MODES=a}),66);
__d("WAWebWamEnumOfflineResumeStages",[],(function(a,b,c,d,e,f){a=Object.freeze({PAGE_LOAD:1,SOCKET_CONNECT:2,PROCESS_COMPLETE:3,SCREEN_LOAD:4,OFFLINE_PREVIEW:5,OFFLINE_COMPLETE_RECEIVED:6,PREACKS_SENT:7});f.OFFLINE_RESUME_STAGES=a}),66);
__d("WAWebOfflineResumeStageWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineResumeModes","WAWebWamEnumOfflineResumeStages"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({OfflineResumeStage:[3536,{attemptId:[13,a.TYPES.INTEGER],chatThreadCount:[4,a.TYPES.INTEGER],currentOfflineStage:[1,d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES],isResumeInForeground:[5,a.TYPES.BOOLEAN],isResumeStartedInForeground:[14,a.TYPES.BOOLEAN],lastPushTimestampMs:[12,a.TYPES.INTEGER],mailboxAge:[6,a.TYPES.INTEGER],offlineCallCount:[15,a.TYPES.INTEGER],offlineDecryptErrorCount:[7,a.TYPES.INTEGER],offlineMessageCount:[8,a.TYPES.INTEGER],offlineNotificationCount:[9,a.TYPES.INTEGER],offlineReceiptCount:[10,a.TYPES.INTEGER],offlineResumeMode:[11,d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES],offlineSessionId:[2,a.TYPES.STRING],offlineSizeBytes:[16,a.TYPES.INTEGER],offlineStageTimestampMs:[3,a.TYPES.INTEGER],passiveModeT:[17,a.TYPES.TIMER]},[1,1,1],"regular"]},{OfflineResumeStage:[]});g.OfflineResumeStageWamEvent=b}),98);
__d("WAWebWamEnumOfflineResumeResultType",[],(function(a,b,c,d,e,f){a=Object.freeze({COMPLETE:1,INCOMPLETE_UNKNOWN_ERROR:2,INCOMPLETE_DISCONNECT:3,INCOMPLETE_APP_RESTART:4});f.OFFLINE_RESUME_RESULT_TYPE=a}),66);
__d("WAWebOfflineResumeWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineResumeResultType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({OfflineResume:[3112,{affectedBySleepMode:[35,a.TYPES.BOOLEAN],appContext:[49,a.TYPES.STRING],appContextBitfield:[50,a.TYPES.INTEGER],attemptNumber:[36,a.TYPES.INTEGER],chatThreadCount:[1,a.TYPES.INTEGER],dbDurationT:[39,a.TYPES.TIMER],dbMainThreadDurationT:[40,a.TYPES.TIMER],dbMainThreadReadsCount:[41,a.TYPES.INTEGER],dbMainThreadWritesCount:[42,a.TYPES.INTEGER],dbReadsCount:[43,a.TYPES.INTEGER],dbWritesCount:[44,a.TYPES.INTEGER],disconnected:[45,a.TYPES.BOOLEAN],expectedOfflineCallCount:[23,a.TYPES.INTEGER],expectedOfflineMessageCount:[17,a.TYPES.INTEGER],expectedOfflineNotificationCount:[18,a.TYPES.INTEGER],expectedOfflineReceiptCount:[19,a.TYPES.INTEGER],isOfflineCompleteMissed:[2,a.TYPES.BOOLEAN],isResumeInForeground:[13,a.TYPES.BOOLEAN],isResumeStartedInForeground:[37,a.TYPES.BOOLEAN],isRunningFromServiceExtension:[22,a.TYPES.BOOLEAN],lastStanzaT:[3,a.TYPES.TIMER],logoutSessionId:[38,a.TYPES.INTEGER],mailboxAge:[14,a.TYPES.INTEGER],mainScreenLoadT:[4,a.TYPES.TIMER],nseMergeT:[54,a.TYPES.TIMER],offlineCallCount:[24,a.TYPES.INTEGER],offlineDecryptErrorCount:[5,a.TYPES.INTEGER],offlineMessageCount:[6,a.TYPES.INTEGER],offlineNotificationCount:[7,a.TYPES.INTEGER],offlinePreviewT:[8,a.TYPES.TIMER],offlineProcessingT:[20,a.TYPES.TIMER],offlineReceiptCount:[9,a.TYPES.INTEGER],offlineResumeResult:[21,d("WAWebWamEnumOfflineResumeResultType").OFFLINE_RESUME_RESULT_TYPE],offlineSessionT:[46,a.TYPES.TIMER],offlineSizeBytes:[10,a.TYPES.INTEGER],onTrickleMode:[15,a.TYPES.BOOLEAN],pageLoadT:[11,a.TYPES.TIMER],passiveModeT:[25,a.TYPES.TIMER],preackCallCount:[26,a.TYPES.INTEGER],preackMessageCount:[27,a.TYPES.INTEGER],preackNotificationCount:[28,a.TYPES.INTEGER],preackReceiptCount:[29,a.TYPES.INTEGER],preacksCount:[47,a.TYPES.INTEGER],processedCallCount:[30,a.TYPES.INTEGER],processedMessageCount:[31,a.TYPES.INTEGER],processedNotificationCount:[32,a.TYPES.INTEGER],processedReceiptCount:[33,a.TYPES.INTEGER],queuedMessageCount:[51,a.TYPES.INTEGER],queuedNotificationCount:[52,a.TYPES.INTEGER],queuedReceiptCount:[53,a.TYPES.INTEGER],runningTasks:[48,a.TYPES.STRING],socketConnectT:[12,a.TYPES.TIMER],transientOfflineSessionId:[34,a.TYPES.STRING]},[1,1,1],"regular"]},{OfflineResume:[]});g.OfflineResumeWamEvent=b}),98);
__d("WAWebWamOfflineResumeReporter",["$InternalEnum","WALogger","WAQplTypes","WARandomHex","WATimeUtils","WAWebABProps","WAWebAppTracker","WAWebDBTableUsage","WAWebGetAllModelStorageTableNames","WAWebOfflineResumeStageWamEvent","WAWebOfflineResumeWamEvent","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWamEnumOfflineResumeModes","WAWebWamEnumOfflineResumeStages","WAWebWamEnumWebScenarioCode","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m=b("$InternalEnum").Mirrored(["ResumeFromRestart","ResumeFromOpentab"]),n=function(){function a(a){this._mode=a}var b=a.prototype;b.start=function(){if(!d("WAWebABProps").getABPropConfigValue("web_offline_resume_qpl_enabled"))return;this.drop();this._qplEvent=d("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,{annotations:{string:{mode:m.getName(this._mode)}}})};b.end=function(){var a;(a=this._qplEvent)==null||a.end(d("WAQplTypes").QuickLogActionType.SUCCESS)};b.drop=function(){var a;(a=this._qplEvent)==null||a.drop();this._qplEvent=void 0};b._addPoint=function(a,b){var c;b=b!=null?{data:b}:{};(c=this._qplEvent)==null||c.addPoint(a,b)};b.markOfflinePreviewReceived=function(){this._addPoint("offlinePreviewReceived")};b.markMainScreenLoad=function(){this._addPoint("mainScreenLoad")};b.setAnnotations=function(a){var b;(b=this._qplEvent)==null||b.annotate(a)};return a}(),o=function(){function a(a,b){this._sessionId=b,this._offlineStartT=self.performance.now(),this._resumeMode=a,window.document&&(this._isStartedInForeground=!document.hidden)}var b=a.prototype;b._commitOfflineStage=function(a){a={offlineSessionId:this._sessionId,offlineResumeMode:this._resumeMode===m.ResumeFromOpentab?d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES.RESUME_FROM_OPEN_TAB:d("WAWebWamEnumOfflineResumeModes").OFFLINE_RESUME_MODES.RESUME_FROM_RESTART,offlineStageTimestampMs:Math.floor(self.performance.now()-this._offlineStartT),currentOfflineStage:a};window.document&&(a.isResumeInForeground=!document.hidden);this._isStartedInForeground!=null&&(a.isResumeStartedInForeground=this._isStartedInForeground);a=new(d("WAWebOfflineResumeStageWamEvent").OfflineResumeStageWamEvent)(a);this._addOfflineMetadata(a);a.commit()};b.logOfflineStart=function(){this._offlineStartT=self.performance.now()};b.logSocketConnect=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SOCKET_CONNECT)};b.logProcessComplete=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.PROCESS_COMPLETE)};b.logScreenLoad=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SCREEN_LOAD)};b.logOfflinePreview=function(){this._commitOfflineStage(d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.OFFLINE_PREVIEW)};b.logOfflineCount=function(a){var b;((b=this._offlineMessageCount)!=null?b:0)===0&&(this._offlineMessageCount=a.message);((b=this._offlineReceiptCount)!=null?b:0)===0&&(this._offlineReceiptCount=a.receipt);((b=this._offlineNotificationCount)!=null?b:0)===0&&(this._offlineNotificationCount=a.notification);((b=this._offlineCallCount)!=null?b:0)===0&&(this._offlineCallCount=a.call)};b.logOfflineDecryptionErrorCount=function(a){this._offlineDecryptErrorCount=a};b.logOfflineChatThreadCount=function(a){this._chatThreadCount=a};b.logOldestStanzaTime=function(a){(this._oldestStanzaTs==null||this._oldestStanzaTs>a)&&(this._oldestStanzaTs=a)};b.setLastPushCompleteTimestamp=function(){this._lastPushCompleteTimestampMs=d("WAWebUserPrefsGeneral").getLastPushCompleteTimestamp()};b._addOfflineMetadata=function(a){this._offlineMessageCount!=null&&(a.offlineMessageCount=this._offlineMessageCount),this._offlineReceiptCount!=null&&(a.offlineReceiptCount=this._offlineReceiptCount),this._offlineNotificationCount!=null&&(a.offlineNotificationCount=this._offlineNotificationCount),this._offlineCallCount!=null&&(a.offlineCallCount=this._offlineCallCount),this._oldestStanzaTs!=null&&(a.mailboxAge=r(this._oldestStanzaTs)),this._offlineDecryptErrorCount!=null&&(a.offlineDecryptErrorCount=this._offlineDecryptErrorCount),this._chatThreadCount!=null&&(a.chatThreadCount=q(this._chatThreadCount,10)),this._lastPushCompleteTimestampMs!=null&&a.currentOfflineStage===d("WAWebWamEnumOfflineResumeStages").OFFLINE_RESUME_STAGES.SOCKET_CONNECT&&(a.lastPushTimestampMs=this._lastPushCompleteTimestampMs,void d("WAWebUserPrefsGeneral").clearLastPushCompleteTimestamp(),this._lastPushCompleteTimestampMs=null)};return a}(),p=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.offlinePreviewCount=0,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebOfflineResumeWamEvent").OfflineResumeWamEvent);a=function(){function a(){this._initEvents(m.ResumeFromRestart)}var e=a.prototype;e._initEvents=function(a){this.isInitialSync=!1;this.oldestStanzaTs=0;this.offlineResume=new p();this.offlineResume.offlineMessageCount=0;this.offlineResume.offlineReceiptCount=0;this.offlineResume.offlineNotificationCount=0;this.offlineResume.offlineCallCount=0;this.offlineResume.offlineDecryptErrorCount=0;this.offlineResume.offlineSizeBytes=0;this.offlineResume.chatThreadCount=0;this.offlineResume.preackMessageCount=0;this.offlineResume.preackReceiptCount=0;this.offlineResume.isOfflineCompleteMissed=!1;this.qpl=new n(a);var b=this._generateOfflineSessionId();this.offlineStage=new o(a,b);this.endTableUsageMetric=d("WAWebDBTableUsage").beginDBTableUsage({webScenario:d("WAWebWamEnumWebScenarioCode").WEB_SCENARIO_CODE.OFFLINE_RESUME,tablesToLog:new Set(d("WAWebGetAllModelStorageTableNames").allModelStorageTableNames),offlineSessionId:b})};e.logOldestStanzaTime=function(a){this.offlineStage.logOldestStanzaTime(a);if(this.offlineResume==null)return;(this.oldestStanzaTs===0||this.oldestStanzaTs>a)&&(this.oldestStanzaTs=a)};e.logOfflineCount=function(a){var b;this.offlineStage.logOfflineCount(a);this.offlineStage.logOfflinePreview();if(!this.offlineResume)return;this.offlineResume.offlinePreviewCount=a.count;((b=this.offlineResume.offlineMessageCount)!=null?b:0)===0&&(this.offlineResume.offlineMessageCount=a.message);((b=this.offlineResume.offlineReceiptCount)!=null?b:0)===0&&(this.offlineResume.offlineReceiptCount=a.receipt);((b=this.offlineResume.offlineNotificationCount)!=null?b:0)===0&&(this.offlineResume.offlineNotificationCount=a.notification);((b=this.offlineResume.offlineCallCount)!=null?b:0)===0&&(this.offlineResume.offlineCallCount=a.call)};e.logOfflineDecryptionErrorCount=function(a){this.offlineStage.logOfflineDecryptionErrorCount(a);if(!this.offlineResume)return;this.offlineResume.offlineDecryptErrorCount=a};e.logAddOfflineSizeBytes=function(a){if(!this.offlineResume)return;this.offlineResume.offlineSizeBytes+=a};e.logOfflineChatThreadCount=function(a){this.offlineStage.logOfflineChatThreadCount(a);a=q(a,10);if(!this.offlineResume)return;this.offlineResume.chatThreadCount=a};e.logOfflinePreackCount=function(a,b){b===void 0&&(b=!1),this.offlineResume&&(b===!0?this.offlineResume.preackMessageCount+=a:this.offlineResume.preackReceiptCount+=a)};e.logOfflinePassiveT=function(){var a;if(((a=this.offlineResume)==null?void 0:a.passiveModeT)!=null)return;this._logPerformanceT("passiveModeT")};e._logPerformanceT=function(a){var b=Math.floor(self.performance.now());if(this.offlineResume==null)return;this.offlineResume[a]=b};e.logLastStanzaT=function(){var a;if(((a=this.offlineResume)==null?void 0:a.lastStanzaT)!=null)return;this._logPerformanceT("lastStanzaT");this.isInitialSync||this.offlineStage.logProcessComplete()};e.logMainScreenLoadT=function(){this._logPerformanceT("mainScreenLoadT"),this.qpl.markMainScreenLoad(),this.isInitialSync||this.offlineStage.logScreenLoad()};e.logOfflinePreviewT=function(){this._logPerformanceT("offlinePreviewT"),this.qpl.markOfflinePreviewReceived()};e.logOfflineStartT=function(){this._logPerformanceT("pageLoadT"),this.offlineStage.logOfflineStart(),window.document&&this.offlineResume&&(this.offlineResume.isResumeStartedInForeground=!document.hidden)};e.logSocketConnectT=function(){this.qpl.start(),this._logPerformanceT("socketConnectT"),this.isInitialSync||this.offlineStage.logSocketConnect()};e.logMissedOfflineComplete=function(){if(!this.offlineResume)return;this.offlineResume.isOfflineCompleteMissed=!0};e.setIsInitialSync=function(){this.isInitialSync=!0};e.setLastPushCompleteTimestamp=function(){return this.offlineStage.setLastPushCompleteTimestamp()};e.isBlockingOfflineResume=function(a){if(a.lastStanzaT!=null&&a.mainScreenLoadT!=null)return a.lastStanzaT<a.mainScreenLoadT;else if(a.socketConnectT!=null&&a.lastStanzaT!=null&&a.mainScreenLoadT==null)return!0;else if(a.socketConnectT!=null&&a.lastStanzaT==null&&a.mainScreenLoadT!=null)return!1;return null};e.commit=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.offlineResume;if(!a)return;a.offlineSizeBytes=q(a.offlineSizeBytes,1e3);a.mailboxAge=r(this.oldestStanzaTs);yield d("WAWebUserPrefsMultiDevice").setRecentMailboxAgeDays(a.mailboxAge);var b=this.isBlockingOfflineResume(a);a.lastStanzaT!=null&&a.socketConnectT!=null&&(a.offlineProcessingT=a.lastStanzaT-a.socketConnectT,d("WAWebAppTracker").attachWAMAppContext(a,a.offlineProcessingT));window.document&&(a.isResumeInForeground=!document.hidden);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] offline resume completes\n        ============== offline resume perf ================\n        count: ","\n        messageCount: ","\n        receiptCount: ","\n        notificationCount: ","\n        callCount: ","\n        chatThreadCount: ","\n        sizeBytes: ","\n        decryptErrorCount: ","\n        preackMessageCount: ","\n        preackReceiptCount: ","\n        lastStanzaT: ","\n        pageLoadT: ","\n        socketConnectT: ","\n        passiveModeT: ","\n        offlinePreviewT: ","\n        mainScreenLoadT: ","\n        offlineProcessingT: ","\n        isResumeInForeground: ","\n        isResumeStartedInForeground: ","\n        isBlockingOfflineResume: ","\n        mailboxAge: ","\n        ==================================================="])),a.offlinePreviewCount,a.offlineMessageCount,a.offlineReceiptCount,a.offlineNotificationCount,a.offlineCallCount,a.chatThreadCount,a.offlineSizeBytes,a.offlineDecryptErrorCount,a.preackMessageCount,a.preackReceiptCount,a.lastStanzaT,a.pageLoadT,a.socketConnectT,a.passiveModeT,a.offlinePreviewT,a.mainScreenLoadT,a.offlineProcessingT,a.isResumeInForeground,a.isResumeStartedInForeground,b,a.mailboxAge);var e=a.offlinePreviewCount===0;if(!this.isInitialSync&&!e){a.commit();this.qpl.setAnnotations({"int":{messageCount:a.offlineMessageCount,receiptCount:a.offlineReceiptCount,notificationCount:a.offlineNotificationCount,chatThreadCount:a.chatThreadCount,sizeBytes:a.offlineSizeBytes,decryptErrorCount:a.offlineDecryptErrorCount,preackMessageCount:a.preackMessageCount,preackReceiptCount:a.preackReceiptCount},bool:{isResumeInForeground:a.isResumeInForeground,isBlockingOfflineResume:b}});this.qpl.end();this.endTableUsageMetric();if(!c("gkx")("26258")){b=3*60*1e3;var f=10,g=Math.max(a.mainScreenLoadT,a.lastStanzaT);g-a.socketConnectT>b&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loading time exceeding product requirement, time ",""])),a.mainScreenLoadT).sendLogs("slow-offline-resume");a.offlineDecryptErrorCount>f&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] decryption error count exceeding product requirement, count ",""])),a.offlineDecryptErrorCount).sendLogs("slow-offline-resume")}}else this.isInitialSync?d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] skip posting for offline resume during initial sync"]))):e&&d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] skip posting for offline resume without envelopes"]))),this.qpl.drop();this.offlineResume=null});function e(){return a.apply(this,arguments)}return e}();e.resetEvent=function(){this.offlineResume==null&&(this._initEvents(m.ResumeFromOpentab),this.logOfflineStartT())};e._generateOfflineSessionId=function(){return""+d("WARandomHex").randomHex(4)+d("WATimeUtils").unixTimeWithoutClockSkewCorrection().toString(10)};return a}();function q(a,b){return c("gkx")("26258")?Math.round(a/b)*b:a}function r(a){if(a===0)return 0;a=d("WATimeUtils").unixTime()-a;return Math.round(a/d("WATimeUtils").DAY_SECONDS)}e=new a();g.roundUp=q;g.countDays=r;g.OfflineResumeReporter=e}),98);
__d("WAWebClearDanglingReceipts",["Promise","WAAbortError","WALogger","WATimeUtils","WAWebABProps","WAWebCommsSendPing","WAWebNetworkStatus","WAWebOfflineResumePreAckHandler","WAWebSchemaDanglingReceipt","WAWebSendReceiptJobCommon","WAWebWamOfflineResumeReporter","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q;function a(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: get "," danglingRecords"])),a.length);if(c.aborted){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: aborting receipts to signal.aborted"])));throw new(d("WAAbortError").AbortError)()}var e=new Map(),f=[],g=0;a.forEach(function(a){g+=a.receipts.length;var b=a.receipts;a=a.acks;b.forEach(function(a){var b=d("WAWebWidFactory").createWid(a.from),c=d("WAWebWidFactory").createWid(a.author),f=e.get(b);f||(f=new Map(),e.set(b,f));b=f.get(c);b||(b=[],f.set(c,b));b.push(a.externalId)});f=f.concat(a)});var n=String(d("WATimeUtils").unixTime());c=Array.from(e.keys()).map(function(a){var b=e.get(a);if(!b)return;return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:a,type:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:n,groupedReceipt:b})});a=f.map(function(a){return d("WAWebOfflineResumePreAckHandler").sendOfflinePreAck(a)});d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: starting sending "," receipts,  "," preAcks"])),c.length,a.length);yield (q||(q=b("Promise"))).all(c);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete sending "," receipts"])),c.length);yield q.all(a);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete sending  "," preAcks"])),a.length);yield s();d("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreackCount(g);d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sendAndClearDanglingReceipts: complete"])))});return r.apply(this,arguments)}function s(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!c("WAWebNetworkStatus").online){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] clearDanglingReceipts: skip due to offline"])));return}d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] clearDanglingReceipts: sending ping"])));var a=(yield d("WAWebCommsSendPing").blockSendPing());(a||!d("WAWebABProps").getABPropConfigValue("web_offline_resume_wait_for_ping_response_enabled"))&&(d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] clearDanglingReceipts: clearing dangling receipts"]))),yield d("WAWebSchemaDanglingReceipt").getTable().clear())});return t.apply(this,arguments)}g.sendAndClearDanglingReceipts=a;g.clearDanglingReceipts=s}),98);
__d("WAWebOfflineDeviceCache",["WAComms","WADeprecatedSendIq","WALogger","WAShiftTimer","WAWebApiPendingDeviceSync","WAWebPromiseQueue","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=3e3;a=function(){function a(){var a=this;this.pendingDeviceCache=new Set();this.pendingAcks=[];this.snapshotTimer=new(d("WAShiftTimer").ShiftTimer)(function(){a.createSnapshot()});this.checkpointQueue=new(d("WAWebPromiseQueue").PromiseQueue)()}var c=a.prototype;c.addOfflinePendingDevice=function(a,b){this.pendingDeviceCache.add(a),b&&this.pendingAcks.push(b),this.snapshotTimer.isScheduled()||(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][device-cache]: creating snapshot: schedule in "," ms"])),j),this.snapshotTimer.onOrAfter(j))};c.createSnapshot=function(){this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var a=Array.from(this.pendingDeviceCache),c=this.pendingAcks;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][device-cache]: creating snapshot for pending devices ",""])),a.join(","));this.checkpointQueue.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync(a),c.forEach(function(a){return d("WADeprecatedSendIq").deprecatedCastStanza(a)}),d("WAComms").cancelDeadSocketTimer()}));this.pendingDeviceCache=new Set();this.pendingAcks=[]};return a}();c=new a();g.OfflinePendingDeviceCache=c}),98);
__d("WASmaxOutOfflineBatchRequest",["WASmaxJsx","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.offlineBatchCount;a=d("WASmaxJsx").smax("ib",null,d("WASmaxJsx").smax("offline_batch",{count:d("WAWap").INT(a)}));return a}g.makeBatchRequest=a}),98);
__d("WASmaxOfflineBatchRPC",["WAComms","WASmaxOutOfflineBatchRequest","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WASmaxOutOfflineBatchRequest").makeBatchRequest(a);yield d("WAComms").castSmaxStanza(a)});return h.apply(this,arguments)}g.sendBatchRPC=a}),98);
__d("WAWebHandleOfflineAbProps",["WAWebABProps","WAWebRuntimeEnvironmentUtils"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("web_non_blocking_offline_resume_max_message_count")}function b(){return d("WAWebABProps").getABPropConfigValue("web_offline_stage_manager_singleton_enabled")}function c(){return!d("WAWebRuntimeEnvironmentUtils").isServiceWorker()&&d("WAWebABProps").getABPropConfigValue("web_offline_dynamic_batch_size_enabled")}function e(){var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("web_offline_dynamic_batch_config")),b=parseFloat(a.multiplier);a=a.version||"default";return{multiplier:Number.isNaN(b)?.2:b,version:a}}g.getNonBlockingOfflineResumeMaxMessageCount=a;g.isNonBlockingOfflineResumeExpEnabled=b;g.isOfflineDynamicBatchSizeEnabled=c;g.getOfflineDynamicBatchConfig=e}),98);
__d("WAWebOfflineHandler",["invariant","WALogger","WASmaxOfflineBatchRPC","WAWebABProps","WAWebAppTracker","WAWebCmd","WAWebEventsWaitForReadyForOffline","WAWebHandleOfflineAbProps","WAWebOfflineResumeUtils","WAWebPageLoadLogging","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s=200,t=10,u=200,v=100,w=new Map([[0,200],[1,100],[2,50],[3,10]]),x=a();c=function(){function a(){this.$2=!1,this.$3=0,this.$4=!1,this.$5=!1,this.$7=s,this.$8=0,this.$9=!1,this.$10=0}var c=a.prototype;c.initState=function(a){this.offlineResumeManager!=null&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] initState called more than once"]))),this.offlineResumeManager=a.getBlockingStageManager(),d("WAWebPageLoadLogging").addPageLoadQplAnnotation({blocking_resume:!0}),this.$1=a.getNonblockingStageManager};c.processOfflinePreviewIb=function(a){d("WAWebPageLoadLogging").addPageLoadQplPoint("offline_preview_received");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"OfflinePreviewReceived");d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.OfflineResume);this.$12();this.$9=d("WAWebHandleOfflineAbProps").isOfflineDynamicBatchSizeEnabled();if(this.$1!=null){var b=this.$1;d("WAWebCmd").Cmd.isMainStreamReadyMd&&this.isResumeFromRestartComplete()?z(a.message)?(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab][non-blocking] resume from current state of app"]))),this.offlineResumeManager=b({mainScreenLoaded:!0})):(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab] restart client due to exceed the LIMIT, message: ",""])),a.message),d("WAWebOfflineResumeUtils").refreshWindow()):!this.$2&&!this.isResumeFromRestartComplete()&&z(a.message)&&(d("WAWebPageLoadLogging").addPageLoadQplAnnotation({blocking_resume:!1}),this.offlineResumeManager=b())}this.$2=!0;this.offlineResumeManager.processOfflinePreview(a)};c.processMessageDecryptResult=function(a){this.offlineResumeManager.processDecryptResult(a),this.$3-=1,void this.$13()};c.addOfflinePendingMessage=function(){this.isResumeFromRestartComplete()||(this.$3+=1)};c.newOfflineStanza=function(a,b,c){var e=this;this.$4=!1;this.$8=Math.max(this.$8,c);this.$6==null&&(this.$6=self.setTimeout(function(){e.$13(),e.$6=null,d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _endBatchCheck: done"])))},0));return this.offlineResumeManager.newOfflineStanza(a,b,c)};c.offlineStanzaReceivedAfterComplete=function(){return this.offlineResumeManager.offlineStanzaReceivedAfterComplete()};c.getOfflineDeliveryProgress=function(){return this.offlineResumeManager.getOfflineDeliveryProgress()};c.getOfflineMessageCount=function(){return Math.max(this.offlineResumeManager.offlineMessagePreviewCounter,0)};c.isResumeOnSocketDisconnectInProgress=function(){return this.offlineResumeManager.isResumeOnSocketDisconnectInProgress()};c.isResumeFromRestartComplete=function(){return this.offlineResumeManager.isResumeFromRestartComplete()};c.isResumeComplete=function(){return this.offlineResumeManager.isResumeComplete()};c.getHasMessagesToDownload=function(){return this.offlineResumeManager.getHasMessagesToDownload()};c.getFinishedDownloading=function(){return this.getOfflineDeliveryProgress()===100};c.processOfflineIb=function(a){d("WAWebPageLoadLogging").addPageLoadQplPoint("offline_received");d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"OfflineIbReceived");return this.offlineResumeManager.processOfflineSessionComplete(a)["finally"](function(){d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.OfflineResume)})};c.shouldUseOfflineResumeScreen=function(){return this.offlineResumeManager.shouldUseOfflineResumeScreen()};c.getResumeUIProgressBarType=function(){return this.offlineResumeManager.getResumeUIProgressBarType()};c.hasInitOfflineResumeManager=function(){return this.offlineResumeManager!=null};c.getResumeType=function(){return this.offlineResumeManager.resumeType};c.$12=function(){this.$4=!1,this.$5=!1,this.$10=0};c.$14=function(a,b){var c=this;b===void 0&&(b=!1);b=b===!0||this.$10===0;this.$11!=null&&self.clearTimeout(this.$11);b?(d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanza: request next batch, pending message ",""])),this.$3),void d("WASmaxOfflineBatchRPC").sendBatchRPC({offlineBatchCount:a}),this.$10=Date.now(),this.$8=0,this.$4=!0,this.$5=!1):this.$11=self.setTimeout(function(){void c.$15()},v)};c.$15=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);var b=Date.now()-this.$10;a=a||!this.isResumeComplete()&&this.$3<=s&&b>=v&&this.$4===!1&&this.$5===!0;if(this.isResumeComplete()||this.$4||this.$5){this.isResumeComplete()||d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanzaDebounced: skipDebouncing: ",", prevPending: ",", currentPending: ",", complete: ",""])),a,this.$4,this.$5,this.isResumeComplete());if(a===!1)return}if(this.$3<=s){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive][debounced] _maybeRequestMoreStanzaDebounced: start request next batch"])));this.$5=!0;yield d("WAWebEventsWaitForReadyForOffline").waitForOfflineProcessReady();s;b=x(this.$8,this.$7);this.$7=b;this.$14(b,a)}});function c(b){return a.apply(this,arguments)}return c}();c.$13=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);if(this.$9)return this.$15(a);if(this.isResumeComplete()||this.$4||this.$5){this.isResumeComplete()||d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: skip, prevPending: ",", currentPending: ",", complete: ",""])),this.$4,this.$5,this.isResumeComplete());return}this.$3<=s&&(d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: start request next batch"]))),this.$5=!0,yield d("WAWebEventsWaitForReadyForOffline").waitForOfflineProcessReady(),void d("WASmaxOfflineBatchRPC").sendBatchRPC({offlineBatchCount:s}),this.$5=!1,this.$4=!0,d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][adaptive] _maybeRequestMoreStanza: request next batch, pending message ",""])),this.$3))});function c(b){return a.apply(this,arguments)}return c}();return a}();function y(a,b,c,d){d===void 0&&(d=.2);if(a===0)return u;if(a>3)return t;var e=null,f=a-(b!=null?b:0);if(f===0){e=Math.floor(c*d)+c;((f=w.get(a-1))!=null?f:u)<=e&&(e=c)}else e=w.get(a);e!=null||h(0,75725,a,b!=null?b:"N/A",c);return e!=null?e:u}function a(){var a=null;return function(b,c){var e=d("WAWebHandleOfflineAbProps").getOfflineDynamicBatchConfig(),f=e.version;e=e.multiplier;var g=a;a=b;switch(f){case"progressive":return y(b,g,c,e);default:return u}}}function z(a){if(a<=200&&d("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel"))return!0;return a>=d("WAWebHandleOfflineAbProps").getNonBlockingOfflineResumeMaxMessageCount()?!1:!0}e=new c();g.DEFAULT_MAX_BATCH_SIZE=u;g.OfflineMessageHandlerImpl=c;g.OfflineMessageHandler=e}),98);
__d("WAWebWebcMessageProcessingPerfWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMessageProcessingPerf:[5790,{dbStoringT:[7,a.TYPES.INTEGER],decryptionT:[1,a.TYPES.INTEGER],isOffline:[2,a.TYPES.BOOLEAN],lidProcessingT:[8,a.TYPES.INTEGER],parsingT:[3,a.TYPES.INTEGER],postProcessingT:[4,a.TYPES.INTEGER],preProcessingT:[5,a.TYPES.INTEGER],processingT:[6,a.TYPES.INTEGER],reportTokenValidationT:[9,a.TYPES.INTEGER]},[1,1,100],"regular"]},{WebcMessageProcessingPerf:[]});g.WebcMessageProcessingPerfWamEvent=b}),98);
__d("WAWebOfflineResumeMsgProcessReporter",["$InternalEnum","WALogger","WAWebEventsWaitForOfflineDeliveryEnd","WAWebRuntimeEnvironmentUtils","WAWebWebcMessageProcessingPerfWamEvent"],(function(a,b,c,d,e,f,g){var h,i,j=b("$InternalEnum")({Decryption:0,Parsing:1,PreProcessing:2,Processing:3,PostProcessing:4,ProcessReportingTokenInfo:5,DBStoring:6}),k={ACTIVE:!1,CACHE:[]};function l(){var a={dbStoringT:0,decryptionT:0,lidProcessingT:0,parsingT:0,postProcessingT:0,preProcessingT:0,processingT:0,reportTokenValidationT:0};k.CACHE.forEach(function(b){var c=b[0];b=b[1];switch(c){case j.DBStoring:a.dbStoringT+=b;break;case j.Decryption:a.decryptionT+=b;break;case j.ProcessReportingTokenInfo:a.reportTokenValidationT+=b;break;case j.Parsing:a.parsingT+=b;break;case j.PostProcessing:a.postProcessingT+=b;break;case j.PreProcessing:a.preProcessingT+=b;break;case j.Processing:a.processingT+=b;break}});Object.entries(a).forEach(function(b){var c=b[0];b=b[1];typeof b==="number"&&(a[c]=Math.round(b))});return a}function c(b){if(!k.ACTIVE)return;var c=a.performance.now();return function(){var d=a.performance.now();k.CACHE.push([b,d-c])}}function m(){k.ACTIVE=!0;var a=!1;void d("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd().then(function(){if(!a){if(!k.ACTIVE){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Reporter must be active to commit"]))).sendLogs("msg_process_reporter_not_active");return}a=!0;new(d("WAWebWebcMessageProcessingPerfWamEvent").WebcMessageProcessingPerfWamEvent)(babelHelpers["extends"]({},l(),{isOffline:!0})).commit();k={ACTIVE:!1,CACHE:[]}}else d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Reporter is already triggered"]))).sendLogs("msg_process_reporter_already_triggered")})}e={stage:j,startMarker:c,activate:function(a){if(d("WAWebRuntimeEnvironmentUtils").isWorker())return;a.message>5;if(a.message<=100)return;m()}};g.msgProcessReporter=e}),98);
__d("WAWebDBReplaceUnknownAssociations",["WAWebMessageAssociation.flow","WAWebSchemaMessageAssociation"],(function(a,b,c,d,e,f,g){function a(a){var b=[];if(a.length){var c=a.map(function(a){return[a.msgKey,d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN]});b.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkRemove(c));b.push(d("WAWebSchemaMessageAssociation").getMessageAssociationTable().bulkCreateOrReplace(a))}return b}g.replaceUnknownAssociations=a}),98);
__d("WAWebMessageAssociationUIUpdateFromStorage",["WAWebBackendApi","WAWebHandleMsgTypes.flow"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a.forEach(function(a){void d("WAWebBackendApi").frontendFireAndForget("updateMessageUI",{chatId:a.id.remote,msg:a,messageOverwriteOption:d("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,preserveOrder:!0})})}g.updateAssociatedMsgsUIFromStorage=a}),98);
__d("WAWebStoreMsgs",["Promise","WALogger","WAWebAddonGatingUtils","WAWebAddonProcessMsgs","WAWebAddonProcessMsgsUtils","WAWebApiFilterAndReplaceMessages","WAWebApiOrphanRevoke","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebCastToReactionMsg","WAWebCheckUpdateOrphanReactions","WAWebCmd","WAWebCommonMsgUtils","WAWebDBAddOnProviders","WAWebDBMessageBulkHelper","WAWebDBMessageSerialization","WAWebDBProcessEditProtocolMsgs","WAWebDBProcessGroupInviteMsgs","WAWebDBProcessPaymentMessages","WAWebDBProcessPollUpdateMsgs","WAWebDBProcessReactionsMsgs","WAWebDBProcessReplyMsgs","WAWebDBReplaceUnknownAssociations","WAWebDBStoreMessage","WAWebDBStoreRevokeMsgs","WAWebHandleForMessageRange","WAWebHandlePlaceholderWam","WAWebLinkify","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationUIUpdateFromStorage","WAWebMsgGetters","WAWebMsgType","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","WAWebProcessMessageAssociationMessages","WAWebSchemaMessage","WAWebStoreOrphans","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(a.map(function(a){return a.id.toString()}))});return t.apply(this,arguments)}function a(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;try{var e=(yield x(a)),f=Object.entries(e).map(function(a){var b=a[0];a=a[1];if(Array.isArray(a)&&a.length>0)return b+": "+a.length;else if(a instanceof Map&&a.size>0)return b+": "+a.size}).filter(Boolean).join(", ");d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] start: ",""])),f);var g=[],m=e.newMsgsMap,n=e.newAssociatedMsgs,o=e.replaceMsgs,p=e.revokeMsgs,q=e.paymentMsgs,t=e.reactionMsgs,u=e.groupInviteMsgs,y=e.chatsWithNewOfflineMsg,z=e.pollUpdateMsgs,A=e.removedPlaceholders,B=e.keepInChatMessages,C=e.editProtocolMsgs,D=e.replyMsgs,E=e.newsletterMsgs,F=e.unifiedAddons,G=e.botInvokeSystemMsgs;e=e.replaceCommentMsgs;n=(yield d("WAWebProcessMessageAssociationMessages").classifyAssociatedMsgsUsingExistingParentsCache(n,m));m=Array.from(m.values());if(Boolean(n==null?void 0:n.orphanAssociatedMsgs.length)){var H;g=g.concat((H=n==null?void 0:n.orphanAssociatedMsgs)!=null?H:[])}var I;n&&(I=d("WAWebApiFilterAndReplaceMessages").validateMsgFn(n==null?void 0:n.validAssociatedMsgs));H=(yield d("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages(m,I));H=H.newMsgs;yield d("WAWebDBMessageBulkHelper").persistNewMessagesInBulk(H,y);yield d("WAWebDBMessageBulkHelper").persistNewNewsletterMessagesInBulk(E);H=[d("WAWebSchemaMessage").getMessageTable().bulkCreateOrReplace(o)];var J=[];o.forEach(function(a){a.associationType!=null&&a.parentMsgKey!=null&&a.internalId!=null&&J.push({msgKey:a.id,parentMsgKey:a.parentMsgKey,associationType:a.associationType,msgKeyInternalId:a.internalId})});J.length>0&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&H.push.apply(H,d("WAWebDBReplaceUnknownAssociations").replaceUnknownAssociations(J));yield (r||(r=b("Promise"))).all(H);yield s(e);E=(yield d("WAWebAddonProcessMsgs").processMsgsAndGetOrphans(F));o=E.orphans;Boolean(o.length)&&(g=g.concat(o));g.length!==0&&(yield d("WAWebStoreOrphans").storeOrphans(g));H=(yield d("WAWebApiOrphanRevoke").applyAddonRevokes(F));if(H.length>0)for(e of H)p.push(e);yield w(p);yield d("WAWebDBProcessPaymentMessages").processPaymentMessages(q);yield d("WAWebDBProcessReactionsMsgs").processReactionMsgs(t);yield d("WAWebDBProcessGroupInviteMsgs").processGroupInviteMessages(u);n!=null&&n.detachedAssociatedMsgs.length&&d("WAWebMessageAssociationUIUpdateFromStorage").updateAssociatedMsgsUIFromStorage(n==null?void 0:n.detachedAssociatedMsgs);yield d("WAWebBackendApi").frontendSendAndReceive("processKeepInChatMessages",{keepInChatMessages:B,allowNotification:!1});yield d("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs(C);yield d("WAWebDBProcessReplyMsgs").processReplyMsgs(D);yield d("WAWebDBProcessPollUpdateMsgs").processPollUpdateMsgs(z);yield d("WAWebHandleForMessageRange").handleOfflineForMessageRange(a);if(G.length>0){var K=new Set();G.forEach(function(a){if(K.has(a.id.remote.toString()))return;K.add(a.id.remote.toString());void d("WAWebBackendApi").frontendFireAndForget("updateBotInvokeSystemMsgCreated",{chatId:a.id.remote})})}E=a.map(function(a){return a.id.toString()});try{yield d("WAWebBackendApi").frontendSendAndReceive("checkOrphanMutations",{msgIds:E,chatIds:y}),yield d("WAWebCheckUpdateOrphanReactions").checkUpdateForOrphanReactions(E)}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["storeMsgs: checkOrphanMutations failed during handleSingleMsg for: "," chat: "," Error: ",", message: ",", stack: ",""])),String(E.join(" ")),String(a[0].id.remote),b.name,b.message,b.stack).devConsole(b)}v(m,A);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] done: ",""])),f)}catch(a){c("gkx")("26258")?d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] Error: ",", message: ",", stack: ",""])),a.name,a.message,a.stack).sendLogs("storeMsgs-error",{sampling:.01}):d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] Error: ",", message: ",", stack: ",""])),a.name,a.message,a.stack).devConsole(a).sendLogs("storeMsgs-error: "+a.message)}});return u.apply(this,arguments)}function v(a,b){a=a.filter(function(a){return d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)&&a.type!==d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER});a.length>0&&void d("WAWebHandlePlaceholderWam").postPlaceholderActivityAddEvent(a);b.length>0&&void d("WAWebHandlePlaceholderWam").postPlaceholderActivityPopulateEvent(b)}function w(a){var c=[];a.forEach(function(a){a.protocolMessageKey&&c.push({revokeMsgKey:a.protocolMessageKey,newMsgKey:a.id,timestamp:a.t,subtype:a.subtype,sender:d("WAWebMsgGetters").getSender(a),revokeTimestamp:a.t,disappearingModeInitiator:a.disappearingModeInitiator,ephemeralDuration:a.ephemeralDuration,ephemeralSettingTimestamp:a.ephemeralSettingTimestamp,viewMode:a.viewMode})});return d("WAWebDBStoreRevokeMsgs").processRevokeMsgs(c).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(c.length>0){var b=[],e=new Set();c.forEach(function(a){b.push(a.revokeMsgKey.toString());a=a.revokeMsgKey.remote.toString();e.add(a)});yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(Array.from(e.values()).join(","),b))}return a});return function(b){return a.apply(this,arguments)}}())}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs]: classifyMsgs got "," message(s)"])),a.length);var b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return String(a.id)}),!1));d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs]: classifyMsgs got "," existing message(s)"])),b.filter(function(a){return a!=null}).length);var c=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],r=[],s=[],t=[],u=new Set(),v=new Map(),w=new Map(),x=[],y=[],B=[];a.forEach(function(a,m){var n=a,q=String(a.id);m=b[m];if(m!=null&&A(a,m)){if(a.type===d("WAWebMsgType").MSG_TYPE.COMMENT){var C=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(n);d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)&&C!=null&&t.push(C);y.push(a)}else{var D;C=d("WAWebDBMessageSerialization").dbRowFromMessage(n);C.t=m.t;C.internalId=m.internalId;C.rowId=m.rowId;C.pendingReadReceipt=m.pendingReadReceipt;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&m.placeholderCreatedWhenAccountIsHosted===!1&&C.senderOrRecipientAccountTypeHosted===!0&&(D=a.id)!=null&&(D=D.remote)!=null&&D.isUser()&&(C.hostedBizEncStateMismatch=!0,d("WAWebCmd").Cmd.isMainStreamReadyMd&&d("WAWebBackendApi").frontendFireAndForget("updateMsgModelHostedBizEncStateMismatchFlagToTrue",{msgId:a.id}));var E=d("WAWebDBStoreMessage").isPendingUnreadReceipt(n.id,n);C=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:C,chatId:n.id.remote.toString(),hasLink:d("WAWebLinkify").hasHttpLink(n),pendingReadReceipt:E});e.push(C)}d("WAWebCommonMsgUtils").isPlaceholderMsg(m.type)&&w.set(q,n)}else if(m&&!(d("WAWebCommonMsgUtils").isFutureproofMsg(m.type)&&z(a)))c.push(a.id.id);else{E=v.get(q);C=E!=null&&!d("WAWebCommonMsgUtils").isPlaceholderMsg(E.type);if(C)c.push(a.id.id);else{a.type===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a.subtype==="bot_invoke_disclaimer"&&x.push(n);if(d("WAWebMsgGetters").getIsNewsletterMsg(a)&&a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype!=="admin_revoke")s.push(n);else if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)&&d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(n)!=null){m=d("WAWebAddonProcessMsgsUtils").castToAddonMsgData(n);m!=null&&t.push(m)}else a.type===d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT?j.push(n):d("WAWebCastToReactionMsg").castToReactionMsgData(n)!=null?g.push(d("WAWebCastToReactionMsg").assertReactionMsgData(n)):a.kind===d("WAWebMsgType").MsgKind.PollVoteEncrypted?i.push(a):a.kind===d("WAWebMsgType").MsgKind.ProtocolRevoke?f.push(a):["sender_revoke","admin_revoke"].includes(a.subtype)?(f.push(a),d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["storeMsgs: receive a protocol message with a type ",""])),a.type).tags("messaging").sendLogs("storeMsgs-protocol",{sampling:.01})):a.type===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a.subtype==="send"||a.subtype==="payment_action_request_declined"||a.subtype==="payment_transaction_request_cancelled"?(h.push(n),v.set(q,n),u.add(String(a.id.remote))):a.type===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE?(k.push(n),v.set(q,n),u.add(String(a.id.remote))):a.type===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a.subtype==="message_edit"?l.push(n):a.quotedMsg||a.quotedStanzaID!=null?(r.push(n),v.set(q,n),u.add(String(a.id.remote))):a.associationType!=null?(v.set(q,n),B.push(a),u.add(String(a.id.remote))):a.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL?(v.set(q,n),u.add(String(a.id.remote))):d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["storeMsgs: skipping unhandled message with type "," and subtype ",""])),a.type,a.subtype)}}});c.length>0&&d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[store-msgs] [classify-msgs]: skip for "," duplicate messages, with id ",""])),c.length,c);return{newMsgsMap:v,newAssociatedMsgs:B,chatsWithNewOfflineMsg:Array.from(u),removedPlaceholders:Array.from(w.values()),replaceMsgs:e,revokeMsgs:f,paymentMsgs:h,reactionMsgs:g,pollUpdateMsgs:i,keepInChatMessages:j,groupInviteMsgs:k,editProtocolMsgs:l,replyMsgs:r,newsletterMsgs:s,unifiedAddons:t,botInvokeSystemMsgs:x,replaceCommentMsgs:y}});return y.apply(this,arguments)}function z(a){return d("WAWebAddonGatingUtils").isUnifiedInfraEnabled(a)?!0:Boolean(d("WAWebDBAddOnProviders").getAddOnProviderForMsg(a))}function A(a,b){return d("WAWebCommonMsgUtils").isPlaceholderMsg(b.type)&&!d("WAWebCommonMsgUtils").isPlaceholderMsg(a.type)||d("WAWebCommonMsgUtils").isFutureproofMsg(b.type)&&!d("WAWebCommonMsgUtils").isFutureproofMsg(a.type)&&!z(a)||d("WAWebCommonMsgUtils").isRichResponseMsg(b.type)&&d("WAWebCommonMsgUtils").isSomewhatParsedRichResponseMsg(a)}g.storeMsgs=a;g.classifyMsgs=x}),98);
__d("WAWebStoreOrphans",["WALogger","WAWebAddonProcessMsgsUtils","WAWebDBStoreMessageOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a)});d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[orphans-infra]: processed "," orphan(s)"])),a.length)});return i.apply(this,arguments)}g.storeOrphans=a}),98);
__d("WAWebCommonParsersParseBusinessProfile",["WAWebBizGatingUtils","WAWebBotTypes","WAWebBusinessProfileTypes","cr:5664","gkx"],(function(a,b,c,d,e,f,g){function a(a){var e=a.maybeChild("address");e=e?e.contentString():void 0;var f,g=a.maybeChild("description");g&&(f=g.contentString());g=a.maybeChild("email");g=g?g.contentString():void 0;var j=a.maybeChild("latitude");j=j?parseFloat(j.contentString()):void 0;var k=a.maybeChild("longitude");k=k?parseFloat(k.contentString()):void 0;var l=[];a.forEachChildWithTag("website",function(a){l.push({url:a.contentString()})});var m;if(d("WAWebBizGatingUtils").getFmxAgmEnabled()){var n=a.maybeChild("member_since_text");n&&(m=n.contentString())}var o=[];n=a.maybeChild("categories");n&&n.forEachChildWithTag("category",function(a){var b=a.attrString("id");o.push({id:b,localized_display_name:a.contentString()})});var p;n=a.maybeChild("business_hours");if(n){var q=n.maybeAttrString("timezone"),r=[];n.forEachChildWithTag("business_hours_config",function(a){r.push({day_of_week:a.attrString("day_of_week"),mode:a.attrString("mode"),open_time:a.hasAttr("open_time")?parseInt(a.attrString("open_time"),10):0,close_time:a.hasAttr("close_time")?parseInt(a.attrString("close_time"),10):0})});p={config:r};q!=null&&(p.timezone=q)}var s;n=a.maybeChild("profile_options");if(n){s={};q=n.maybeChild("commerce_experience");if(q){s.commerce_experience=(q=d("WAWebBusinessProfileTypes").CommerceExperienceTypes.cast(q.contentString()))!=null?q:d("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE}q=n.maybeChild("cart_enabled");q&&(s.cart_enabled=q.contentString()==="true");q=n.maybeChild("shop_url");q&&(s.shop_url=q.contentString());q=n.maybeChild("commerce_manager_url");q&&(s.commerce_manager_url=q.contentString());q=n.maybeChild("is_banned");q&&(s.is_banned=q.contentString()==="true");q=n.maybeChild("direct_connection");q&&(s.direct_connection=q.contentString()==="true");q=n.maybeChild("is_profile_edit_disabled");q&&(s.is_profile_edit_disabled=q.contentString()==="true")}n=a.maybeChild("direct_connection");var t;if(n){q=n.maybeChild("default_postcode");t={enabled:n.maybeAttrString("enabled")==="true",defaultPostcode:q?{code:q.attrString("code"),locationName:q.attrString("location_name")}:void 0}}var u=[];a.forEachChildWithTag("service_area",function(a){var b=a.maybeChild("radius"),c=a.maybeChild("latitude"),d=a.maybeChild("longitude");a=a.maybeChild("area_description");if(b&&c&&d){u.push({radius:parseFloat(b.contentString()),latitude:parseFloat(c.contentString()),longitude:parseFloat(d.contentString()),areaDescription:(b=a==null?void 0:a.contentString())!=null?b:""})}});n=a.maybeChild("catalog_status");q=n?n.attrString("status"):void 0;n={};var v={},w=!1,x,y=a.maybeChild("linked_accounts");if(y){w=!0;var z=y.maybeChild("fb_page");if(z){var A=z.maybeChild("display_name"),B=z.maybeChild("likes");n.display_name=A==null?void 0:A.contentString();n.likes=B==null?void 0:B.contentInt();A=z.maybeAttrString("id");A!=null&&(n.id=A)}B=y.maybeChild("ig_professional");if(B){z=B.maybeChild("ig_handle");A=B.maybeChild("followers");v={ig_handle:z==null?void 0:z.contentString(),followers:A==null?void 0:A.contentInt()}}}y=a.maybeChild("cover_photo");B=y?{id:y.attrString("id"),url:new URL(y.contentString())}:void 0;if(d("WAWebBizGatingUtils").isCustomURLViaBizProfileEnabled()){z=a.maybeChild("custom_url");z&&(x=z==null?void 0:z.contentString())}y=d("WAWebBotTypes").BizBotAutomatedType.cast((A=a.maybeChild("automated_type"))==null?void 0:A.contentString());A=d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.cast((z=a.maybeChild("welcome_message_protocol_mode"))==null?void 0:z.contentString());var C;z=a.maybeChild("prompts");z&&(C=h(z));z=(z=a.maybeChild("commands"))==null||(z=z.maybeChild("description"))==null?void 0:z.contentString();var D;a=a.maybeChild("commands");a&&(D=i(a));!c("gkx")("26258")&&b("cr:5664")&&(b("cr:5664").debugBotConfigs.injectBizBotFields===!0&&(A=d("WAWebBotTypes").BotWelcomeMsgProtocolModeType.BASIC,f="Hello! I'm Midjourney, your personal assistant. I'm here to assist you with anything you might need, from travel information to workout plans, and even caring for your plants. I can even sketch your imagination!",C=[{emoji:"\u2728",text:"Create an alien world!"},{emoji:"\ud83d\udd25",text:"Show a future city!"},{emoji:"\u2728",text:"Fantasy landscape? Generate now!"},{emoji:"\ud83d\udd25",text:"Describe a mythical world filled with magical creatures and let the bot generate an image that brings it to life!"},{emoji:"\u2728",text:"Picture an enchanted forest with towering trees, sparkling fairies, and vibrant flora, and let the bot create an image that captures its magic!"},{emoji:"\ud83d\udd25",text:"Imagine yourself as a time traveler who has just stepped into an ancient civilization. You find yourself surrounded by towering structures and exotic landscapes that are unfamiliar to you. Take a moment to observe the surroundings, notice the intricate details on the buildings and the unique attire worn by the people. Now, let the bot generate an image that captures the essence of this unexplored world, bringing forth a visual representation that transcends time and space!"}],z="Try these commands to get started",D=[{description:"Create images with Midjourney",name:"imagine"},{description:"View and adjust your personal settings",name:"settings"},{description:"Blend images together seamlessly",name:"blend"},{description:"View information about your profile",name:"info"},{description:"Subscribe to the profile for updates",name:"subscribe"}],l.length===0&&(l=[{url:"https://meta.com"}])));var E={address:e,description:f,email:g,latitude:j,longitude:k,website:l,categories:o,business_hours:p,catalog_status:q,profile_options:s,fb_page:n,ig_professional:v,profile_is_linked:w,directConnection:t,service_areas:u.length>0?u:void 0,cover_photo:B,custom_url:x,prompts:C,commands:D,commands_description:z,automated_type:y,welcome_message_protocol_mode:A,member_since_text:m};Object.keys(E).forEach(function(a){E[a]==null&&delete E[a]});return E}function h(a){var b=[];a.forEachChildWithTag("prompt",function(a){var c=a.maybeChild("emoji");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("text");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({emoji:c,text:a})});return b}function i(a){var b=[];a.forEachChildWithTag("command",function(a){var c=a.maybeChild("name");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("description");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({name:c,description:a})});return b}g["default"]=a}),98);
__d("WAWapDeprecatedSmaxID",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({SupportContactForm:3,CtwaGetContext:4,QueryOrder:5,CreateOrder:10,RefreshCart:11,CatalogGetProductList:21,SetCatalogVisibility:23,CommerceSettingsSet:25,CatalogGetSingleCollection:30,CatalogGetCollections:35,CatalogCreateCollection:36,CatalogUpdateCollection:40,CatalogDeleteCollections:43,CatalogAppealCollection:48,BizGetPublicKey:52,MerchantGetComplianceInfo:53,MerchantSetComplianceInfo:54,CatalogVerifyPostcode:70,BtmCustomUrlGet:78,BtmCustomUrlGetUser:79,QuerySubscription:90,UpdateCollectionList:92});c=a;f["default"]=c}),66);
__d("WAWebMerchantComplianceJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=function(a){var b,c,d;return{email:(a==null||(b=a.maybeChild("email"))==null?void 0:b.contentString())||"",landline_number:(a==null||(c=a.maybeChild("landline_number"))==null?void 0:c.contentString())||"",mobile_number:(a==null||(d=a.maybeChild("mobile_number"))==null?void 0:d.contentString())||""}},i=new(c("WADeprecatedWapParser"))("merchantComplianceResponse",function(a){a.assertTag("iq");a.assertFromServer();var b=[];a.forEachChildWithTag("merchant_info",function(a){var c,d,e,f;c=((c=a.maybeChild("entity_name"))==null?void 0:c.contentString())||"";d=((d=a.maybeChild("entity_type"))==null?void 0:d.contentString())||"";e=(e=a.maybeChild("entity_type_custom"))==null?void 0:e.contentString();var g=a.attrString("is_registered")==="true",i=a.maybeChild("customer_care_details");a=a.maybeChild("grievance_officer_details");i=babelHelpers["extends"]({},h(i));a=babelHelpers["extends"]({name:(a==null||(f=a.maybeChild("name"))==null?void 0:f.contentString())||""},h(a));b.push({entity_name:c,entity_type:d,is_registered:g,entity_type_custom:e,customer_care_details:i,grievance_officer_details:a})});return b});function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{to:b.S_WHATSAPP_NET,xmlns:"w:biz:merchant_info",id:b.generateId(),type:"get",smax_id:b.SMAX_ID(c("WAWapDeprecatedSmaxID").MerchantGetComplianceInfo)},a.map(function(a){return d("WAWap").wap("merchant_info",{jid:d("WAWebCommsWapMd").USER_JID(a.wid)})}));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,i));if(!a.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode);else return a.result});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a===void 0?{}:a;var b=a.entityName,e=a.entityType,f=a.isRegistered;f=f===void 0?!1:f;var g=a.entityTypeCustom,h=a.customerCareDetails;a=a.grievanceOfficerDetails;f=d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"w:biz:merchant_info",id:d("WAWap").generateId(),type:"set",smax_id:d("WAWap").SMAX_ID(c("WAWapDeprecatedSmaxID").MerchantSetComplianceInfo)},d("WAWap").wap("merchant_info",{is_registered:f?"true":"false"},b!==void 0?d("WAWap").wap("entity_name",null,b):null,e!==void 0?d("WAWap").wap("entity_type",null,e):null,g!==void 0?d("WAWap").wap("entity_type_custom",null,g):null,h?d("WAWap").wap("customer_care_details",null,h.email!==void 0?d("WAWap").wap("email",null,h.email):null,h.landlineNumber!==void 0?d("WAWap").wap("landline_number",null,h.landlineNumber):null,h.mobileNumber!==void 0?d("WAWap").wap("mobile_number",null,h.mobileNumber):null):null,a?d("WAWap").wap("grievance_officer_details",null,a.name!==void 0?d("WAWap").wap("name",null,a.name):null,a.email!==void 0?d("WAWap").wap("email",null,a.email):null,a.landlineNumber!==void 0?d("WAWap").wap("landline_number",null,a.landlineNumber):null,a.mobileNumber!==void 0?d("WAWap").wap("mobile_number",null,a.mobileNumber):null):null));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(f,i));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode);else return b.result});return k.apply(this,arguments)}g.getMerchantCompliance=a;g.setMerchantCompliance=e}),98);
__d("WAWebQueryBusinessProfile",["Promise","WAWebBackendErrors","WAWebBusinessProfileVersioningBridge","WAWebMerchantComplianceJob","WAWebQueryBusinessProfileJob"],(function(a,b,c,d,e,f,g){var h;function a(a,e){var f=d("WAWebBusinessProfileVersioningBridge").getBusinessProfileQueryVersion();e?e=(h||(h=b("Promise"))).all([c("WAWebQueryBusinessProfileJob")(a,f),d("WAWebMerchantComplianceJob").getMerchantCompliance(a)]).then(i):e=c("WAWebQueryBusinessProfileJob")(a,f);return d("WAWebBackendErrors").attachErrorLogger(e,"Query business profile failed")}function i(a){var b=a[0],c=a[1];return b.map(function(a,b){return babelHelpers["extends"]({},a,{profile:babelHelpers["extends"]({},a.profile,{legal_entity_details:c[b]})})})}g.queryBusinessProfile=a}),98);
__d("WAWebJidToWid",["WAJids","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebWidFactory").createUserWidOrThrow(a)}function b(a){return d("WAWebWidFactory").createUserLidOrThrow(a)}function c(a){return d("WAWebWidFactory").asUserWidOrThrow(d("WAWebWidFactory").createWid(a))}function e(a){return d("WAWebWidFactory").createUserLidOrThrow(a)}function f(a){return d("WAWebWidFactory").createDeviceWidOrThrow(a)}function h(a){return d("WAWebWidFactory").asChatWid(d("WAWebWidFactory").createWid(a))}function i(a){return d("WAWebWidFactory").createWid(a)}function j(a){a=d("WAJids").extractJidFromJidWithType(a);return d("WAWebWidFactory").createWid(a)}function k(a){return d("WAWebWidFactory").createWid(a)}g.userJidToUserWid=a;g.lidUserJidToUserLid=b;g.deviceJidToUserWid=c;g.lidDeviceJidToUserLid=e;g.deviceJidToDeviceWid=f;g.chatJidToChatWid=h;g.groupJidToWid=i;g.jidWithTypeToWid=j;g.newsletterJidToWid=k}),98);
__d("WAWebQueryBusinessProfileJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommonParsersParseBusinessProfile","WAWebCommsWapMd","WAWebJidToWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("businessProfileResponse",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("business_profile");var b=[];a.forEachChildWithTag("profile",function(a){var e=d("WAWebJidToWid").jidWithTypeToWid(a.attrJidWithType("jid")),f=a.attrString("tag");a=c("WAWebCommonParsersParseBusinessProfile")(a);Object.keys(a).length?b.push({wid:e,tag:f,profile:a}):b.push({wid:e,tag:f})});return b});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=(c=d("WAWap")).wap("iq",{to:c.S_WHATSAPP_NET,xmlns:"w:biz",id:c.generateId(),type:"get"},c.wap("business_profile",{v:c.INT(b)},a.map(function(a){return d("WAWap").wap("profile",{jid:d("WAWebCommsWapMd").USER_JID(a.wid),tag:a.tag!=null?d("WAWap").INT(a.tag):d("WAWap").DROP_ATTR})})));b=(yield d("WADeprecatedSendIq").deprecatedSendIq(c,h));if(!b.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode);else return b.result});return i.apply(this,arguments)}g["default"]=a}),98);
__d("WAWebSendMsgTypes",[],(function(a,b,c,d,e,f){a={Message:"message",Addon:"addon"};f.SendMessageRecordType=a}),66);
__d("WAWebPersistedJobDefinitions",["WATimeUtils","WAWebBackendErrors","WAWebBizGatingUtils"],(function(a,b,c,d,e,f,g){a={rotateKey:function(){return{type:"rotateKey",args:{},uniqKey:"rotateKey"}},setAbout:function(a){return{type:"setAbout",args:{content:a},uniqKey:"setAbout"}},queryProductList:function(a,b,c,e,f){c===void 0&&(c=null);if(d("WAWebBizGatingUtils").commerceFeaturesDisabledBySanctions())throw new(d("WAWebBackendErrors").E451)();return{type:"queryProductList",args:{catalogWid:a.toString(),productIds:b,width:e,height:f,directConnectionEncryptedInfo:c},uniqKey:"queryProductList:"+b.slice().sort().join(",")+":"+e+":"+f}},getPublicKey:function(a){return{type:"getPublicKey",args:{businessJid:a.toString()},uniqKey:"getPublicKey:"+a.toString()}},getSignedUserInfo:function(a){return{type:"getSignedUserInfo",args:{businessJid:a.toString()},uniqKey:"getSignedUserInfo:"+a.toString()}},verifyPostcode:function(a,b){return{type:"verifyPostcode",args:{businessJid:a.toString(),directConnectionEncryptedInfo:b},uniqKey:"verifyPostcode:"+a.toString()+":"+b}},deleteReactions:function(a,b){return{type:"deleteReactions",args:{chatId:a,parentMsgKeys:b},uniqKey:"deleteReactions:"+a}},deleteReactionsV2:function(a,b){return{type:"deleteReactionsV2",args:{chatId:a,parentMsgKeys:b}}},deleteAddOns:function(a,b){return{type:"deleteAddOns",args:{chatId:a,parentMsgKeys:b}}},sendRequestedKeyShare:function(a,b,c){return{type:"sendRequestedKeyShare",args:{keys:a,orphanKeys:b,peerDeviceId:c.toString()}}},dismissQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"dismissQuickPromotion",args:{id:a,ts:b},uniqKey:"dismissQuickPromotion-"+a+"-"+b}},primaryActionClickInQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"primaryActionClickInQuickPromotion",args:{id:a,ts:b},uniqKey:"primaryActionClickInQuickPromotion-"+a+"-"+b}},impressionOnQuickPromotion:function(a){var b=d("WATimeUtils").unixTime();return{type:"impressionOnQuickPromotion",args:{id:a,ts:b},uniqKey:"impressionOnQuickPromotion-"+a+"-"+b}},userExposureToQuickPromotion:function(a,b,c){var e=d("WATimeUtils").unixTime();return{type:"userExposureToQuickPromotion",args:{id:a,ts:e,experimentKey:b,exposureHoldout:c},uniqKey:"userExposureToQuickPromotion-"+a+"-"+e}},setTextStatus:function(a,b,c,d){return{type:"setTextStatus",args:{id:a,text:b,emoji:c,ephemeralDurationSeconds:d},uniqKey:"setTextStatus"}},queryAndUpdateGroupsMetadataByJids:function(a){var b=d("WATimeUtils").unixTime();return{type:"queryAndUpdateGroupsMetadataByJids",args:a,uniqKey:"handleGroupsDirtyNotification-"+b}},resendUserMsg:function(a,b,c){var d=a.data.id.toString();return{type:"resendUserMsg",args:{msgId:d,msgType:a.data.type,msgRecordType:a.type,excludeList:b.map(function(a){return a.toString()}),ackTime:c},uniqKey:"resendUserMsg-"+d}},resendGroupMsg:function(a,b,c,d,e,f,g){var h=a.data.id.toString();b=b.groupId;return{type:"resendGroupMsg",args:{msgId:h,msgType:a.data.type,msgRecordType:a.type,groupId:b,isDirect:c,oldList:d.map(function(a){return a.toString()}),phash:e,ackTime:f,serverAddressingMode:g},uniqKey:"resendGroupMsg-"+h}}};g.jobSerializers=a}),98);
__d("WAWebMarkAddOnsAsReadJob",["Promise","WAJobOrchestratorTypes","WAWebAddOnsMarkAddOnsAsReadDb","WAWebAddonMarkAsReadUtils","WAWebBackendApi","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markAddOnsAsRead",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebAddOnsMarkAddOnsAsReadDb").markAddOnsAsReadDb(a.updates),d("WAWebBackendApi").frontendFireAndForget("markAddOnsAsReadUi",{updatedMsgKeys:a.updates})});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted({updates:a})});return i.apply(this,arguments)}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markAddOnsAsReadUsingAddonInfra",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebAddonMarkAsReadUtils").processMarkAsRead(a.addons)});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted({addons:a})});return j.apply(this,arguments)}function e(a){return a.length===0?(h||(h=b("Promise"))).resolve({updatedAddOns:new Map(),updatedOrphans:[]}):d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markUnclassifiedAddOnsAsRead",function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebAddOnsMarkAddOnsAsReadDb").markUnclassifiedAddOnsAsReadDb(a.msgKeys));d("WAWebBackendApi").frontendFireAndForget("markAddOnsAsReadUi",{updatedMsgKeys:a.updatedAddOns});return a});return function(b){return a.apply(this,arguments)}}(),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted({msgKeys:a})}g.markAddOnsAsReadJob=a;g.markAddOnsAsReadUsingAddonInfraJob=c;g.markUnclassifiedAddOnsAsReadJob=e}),98);
__d("WAWebGroupDatabaseJob",["WAJobOrchestratorTypes","WAWebDBGroupParticipant","WAWebDBGroupsGroupMetadata","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateGroupMetadataTable",function(a){return d("WAWebDBGroupsGroupMetadata").updateGroupMetadataTable(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupInfos:a})}function b(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("updateGroupParticipantTableWithoutDeviceSync",function(a){return d("WAWebDBGroupParticipant").updateGroupParticipantTableWithoutDeviceSync(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupInfos:a})}function c(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("markGroupParticipantStale",function(a){return d("WAWebDBGroupParticipant").markGroupParticipantStale(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({group:a})}function e(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("bulkMarkGroupParticipantStale",function(a){return d("WAWebDBGroupParticipant").bulkMarkGroupParticipantStale(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupIds:a})}function f(a,b,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("modifyGroupParticipant",function(a){return d("WAWebDBGroupParticipant").modifyGroupParticipant(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({group:a,oldId:b,newId:c})}function h(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getGroupMetadata",function(a){return d("WAWebDBGroupsGroupMetadata").getGroupMetadataUNSAFE(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupWid:a})}function i(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getGroupParticipant",function(a){return d("WAWebDBGroupParticipant").getGroupParticipant(a)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted({groupWid:a})}g.updateGroupMetadataTableJob=a;g.updateGroupParticipantTableWithoutDeviceSyncJob=b;g.markGroupParticipantStaleJob=c;g.bulkMarkGroupParticipantStaleJob=e;g.modifyGroupParticipantJob=f;g.getGroupMetadataJob=h;g.getGroupParticipantJob=i}),98);
__d("WAWebGetIdentityKeysJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebCommsWapMd","WAWebCryptoCurve25519","WAWebJidToWid","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j=new(c("WADeprecatedWapParser"))("identityKeysParser",function(a){return a.child("list").mapChildren(function(a){if(a.hasChild("error")){var b=a.child("error"),e=b.attrInt("code");b=b.attrString("text");throw c("err")("identityKeysParser bad response: "+e+" "+b)}else return{type:a.child("type").contentBytes(1),identity:a.child("identity").contentBytes(32),user:d("WAWebJidToWid").deviceJidToDeviceWid(a.attrDeviceJid("jid"))}})});function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(a.map(function(a){return String(d("WAWebSignalCommonUtils").createSignalAddress(a))}))),c=a.filter(function(a,c){return b[c]==null});if(c.length===0){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getAndStoreIdentityKeys: got 0 missing keys"])));return}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getAndStoreIdentityKeys: query "," missing keys for "," contacts"])),c.length,a.length);a=(yield l(c));c=a.map(function(a){var b=a.identity;b=d("WAWebCryptoCurve25519").toSignalCurvePubKey(b.buffer.slice(b.byteOffset,b.byteLength+b.byteOffset));b=d("WAWebSignalCommonUtils").bufferToStr(b);a=d("WAWebSignalCommonUtils").createSignalAddress(a.user);return{identityKey:b,identifier:a.toString()}});return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkCreateIdentity(c)});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=a.map(function(a){return d("WAWap").wap("user",{jid:d("WAWebCommsWapMd").DEVICE_JID(a)})});b=(b=d("WAWap")).wap("iq",{xmlns:"encrypt",type:"get",to:b.S_WHATSAPP_NET,id:b.generateId()},b.wap("identity",null,a));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,j));if(!a.success)throw c("err")("getIdentityKeys bad response "+String(a));return a.result});return m.apply(this,arguments)}g.getAndStoreIdentityKeys=a}),98);
__d("WAWebSendAggregateDeliveryReceipts",["$InternalEnum","Promise","WAWebBackendApi","WAWebCmd","WAWebDBMsgUtils","WAWebHandleMsgMetaUtils","WAWebMsgProcessingApiUtils","WAWebPollsVotesSchema","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum").Mirrored(["Message","Reaction","PollVote","NotSupportedAddon"]),j=function(a){if(a.hasHideFailEnc){if(d("WAWebHandleMsgMetaUtils").isPollVoteMsgMeta(a.msgMeta))return i.PollVote;return d("WAWebHandleMsgMetaUtils").isReactionMsgMeta(a.msgMeta)?i.Reaction:i.NotSupportedAddon}return i.Message};function k(a){var b=new Map();a.forEach(function(a){var c,d=j(a);c=(c=b.get(d))!=null?c:b.set(d,[]).get(d);c==null||c.push(a)});return b}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=a.map(function(a){a=a.msgInfo;return d("WAWebMsgProcessingApiUtils").messageInfoToKey(a)});b=d("WAWebCmd").Cmd.isMainStreamReadyMd?yield b(a):a.map(function(){return!1});var e=new Set(),f=[];for(b of b.entries()){var g=b[0],h=b[1];h?e.add(a[g].toString()):f.push(a[g].toString())}if(f.length===0)return e;h=(yield c(f));return new Set([].concat(Array.from(e),Array.from(h)))});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){switch(a){case i.Message:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasMsgsInCollection",{msgKeys:a})},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set();return d("WAWebDBMsgUtils").getMsgsExistByMsgKey(a).then(function(c){for(c of c.entries()){var d=c[0],e=c[1];e&&b.add(a[d])}return b})});return function(b){return a.apply(this,arguments)}}());case i.Reaction:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasReactionsInCollection",{msgKeys:a})},function(a){var b=new Set();return d("WAWebSchemaReactions").getReactionsTable().anyOf(["msgKey"],a).then(function(a){for(a of a)b.add(a.msgKey);return b})});case i.PollVote:return l(c,function(a){return d("WAWebBackendApi").frontendSendAndReceive("hasPollVotesInCollection",{msgKeys:a})},function(a){return d("WAWebPollsVotesSchema").getTable().anyOf(["msgKey"],a,{shouldDecrypt:!1}).then(function(a){var b=new Set();for(a of a)b.add(a.msgKey);return b})});case i.NotSupportedAddon:a=new Set();for(c of c){var e=c.msgInfo;a.add(d("WAWebMsgProcessingApiUtils").messageInfoToKey(e).toString())}return a}});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a=a[1];var c=[],e=[];for(a of a)a.msgReceivedTimes>1?c.push({isInDB:!0,receipt:a}):e.push(a);if(e.length>0){var f=(yield n(b,e));c=c.concat(e.map(function(a){return{isInDB:f.has(d("WAWebMsgProcessingApiUtils").messageInfoToKey(a.msgInfo).toString()),receipt:a}}))}return c});return q.apply(this,arguments)}function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c;a=k(a);a=(yield (h||(h=b("Promise"))).all(Array.from(a.entries()).map(p)));return(c=[]).concat.apply(c,a)});return r.apply(this,arguments)}g.aggregateDeliveryReceipts=a}),98);
__d("WAWebUnknownStanzaWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({UnknownStanza:[3448,{unknownStanzaTag:[1,d("WAWebWamCodegenUtils").TYPES.STRING],unknownStanzaType:[2,d("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"regular"]},{UnknownStanza:[]});g.UnknownStanzaWamEvent=a}),98);
__d("WAWebPostUnknownStanzaMetric",["WAWebUnknownStanzaWamEvent"],(function(a,b,c,d,e,f,g){function a(a){new(d("WAWebUnknownStanzaWamEvent").UnknownStanzaWamEvent)({unknownStanzaTag:a.tag,unknownStanzaType:(a=a.attrs.type)==null?void 0:a.toString()}).commit()}g.postUnknownStanzaMetric=a}),98);
__d("WAWebCreateNackFromStanza",["$InternalEnum","WALogger","WAWap","WAWebCurrentUser","WAWebPostUnknownStanzaMetric"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=b("$InternalEnum")({StaleGroupAddressingMode:421,NewChatMessagesCapped:475,ParsingError:487,UnrecognizedStanza:488,UnrecognizedStanzaClass:489,UnrecognizedStanzaType:490,InvalidProtobuf:491,InvalidHostedCompanionStanza:493,MissingMessageSecret:495,SignalErrorOldCounter:496,MessageDeletedOnPeer:499,UnhandledError:500,UnsupportedAdminRevoke:550,UnsupportedLIDGroup:551,DBOperationFailed:552});function a(a,b){var c,e,f=a==null?void 0:a.tag,g=a==null||(c=a.attrs)==null?void 0:c.id,n=a==null||(e=a.attrs)==null||(e=e.type)==null?void 0:e.toString(),q=o.getName(b);try{var r,s;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: class: '","' type: '","' id: '","' reason: '","'"])),f,n,g,q);f==="receipt"&&b===o.UnrecognizedStanza&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unrecognized receipt stanza: type: '","'"])),n).sendLogs("unrecognized-receipt-stanza",{sampling:d("WAWebCurrentUser").isEmployee()?1:.001});((r=a.attrs.type)==null?void 0:r.toString())==="text"&&a.tag==="message"&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: unknown text type stanza"]))).sendLogs("createNackFromStanza-unknown-text-type-stanza",{sampling:.01});if(g!=null&&(a==null||(s=a.attrs)==null?void 0:s.from)!=null)return p(a,b);d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed: 'id' or 'form' is null for class: '","' type: '","' reason: '","'"])),f,n,q);d("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(a)}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed for class: '","' type: '","' id: '","' reason: '","'"])),f,n,g,q);d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["createNackFromStanza: failed with unhandled reason: ",""])),(r=a.message)!=null?r:a).sendLogs("send-nack-exception")}return"NO_ACK"}function p(a,b){var c=a.attrs;if(b===o.UnrecognizedStanza)return d("WAWap").wap("ack",{"class":d("WAWap").CUSTOM_STRING(a.tag),id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});switch(a.tag){case"notification":return d("WAWap").wap("ack",{"class":"notification",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});case"message":return d("WAWap").wap("ack",{"class":"message",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});case"receipt":return d("WAWap").wap("ack",{"class":"receipt",id:c.id,to:c.from,type:c.type||d("WAWap").DROP_ATTR,participant:c.participant||d("WAWap").DROP_ATTR,error:d("WAWap").INT(b)});default:d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["sendNack called with unsupported stanza tag: ",""])),a.tag).sendLogs("unsupported-nack");d("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(a);return"NO_ACK"}}g.NackReason=o;g.createNackFromStanza=a}),98);
__d("WAWebHandleMsgSendAck",["WADeprecatedSendIq","WALogger","WAWap","WAWebCommsWapMd","WAWebCreateNackFromStanza","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c,e){d("WADeprecatedSendIq").deprecatedCastStanza(d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a),"class":"message",from:d("WAWebCommsWapMd").DEVICE_JID(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()),to:b?d("WAWebCommsWapMd").JID(b):d("WAWap").DROP_ATTR,participant:e?d("WAWebCommsWapMd").DEVICE_JID(e):d("WAWap").DROP_ATTR,type:c!=null?c:d("WAWap").DROP_ATTR}))}function b(a,b,c,e,f,g){var i=null;f===d("WAWebCreateNackFromStanza").NackReason.InvalidProtobuf&&(g!=null?i=d("WAWap").wap("meta",{failure_reason:d("WAWap").INT(g)}):d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendNack: InvalidProtobuf error is missing e2eFailureReason"]))).sendLogs("invalid-protobuf-nack-missing-failure-reason"));d("WADeprecatedSendIq").deprecatedCastStanza(d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(a),"class":"message",from:d("WAWebCommsWapMd").DEVICE_JID(d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()),to:b?d("WAWebCommsWapMd").JID(b):d("WAWap").DROP_ATTR,participant:e?d("WAWebCommsWapMd").DEVICE_JID(e):d("WAWap").DROP_ATTR,type:c!=null?c:d("WAWap").DROP_ATTR,error:d("WAWap").INT(f)},i))}g.sendAck=a;g.sendNack=b}),98);
__d("WAWebPendingMessageKey",[],(function(a,b,c,d,e,f){function a(a,b,c){c=c.map(function(a){return String(a.e2eType)+":"+a.retryCount}).join(",");return a.toString()+"_"+b.toString()+"_"+c}f.createPendingMessageKey=a}),66);
__d("WAWebMessageDedupUtils",["WALogger","WAWebABProps","WAWebPendingMessageKey"],(function(a,b,c,d,e,f,g){var h,i,j,k=new Map();function a(){return d("WAWebABProps").getABPropConfigValue("web_pending_message_cache_enabled")}function b(a,b,c){a=d("WAWebPendingMessageKey").createPendingMessageKey(a,b,c);c=((b=k.get(a))!=null?b:0)+1;k.set(a,c);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] add message: ",", total: ",""])),a,c);return c}function c(a,b,c){a=d("WAWebPendingMessageKey").createPendingMessageKey(a,b,c);b=k.get(a);if(b==null)return!1;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] message "," is pending, total: ",""])),a,b);return!0}function e(a){a===0&&(k.size>0&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[message-dedup] message cache cleared, total: ",""])),k.size),k.clear())}g.isPengingMessageCacheEnabled=a;g.addPendingMessage=b;g.hasPendingMessage=c;g.maybeClearPendingMessages=e}),98);
__d("WAWebSendOfflineDeliveryReceiptJob",["Promise","WAComms","WALogger","WATimeUtils","WAWebCreateNackFromStanza","WAWebHandleMsgSendAck","WAWebLid1X1MigrationGating","WAWebMessageDedupUtils","WAWebPostIncomingMessageDropMetric","WAWebSchemaDanglingReceipt","WAWebSendAggregateDeliveryReceipts","WAWebSendReceiptJobCommon","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[];if(a.length===0)return b;a=(yield d("WAWebSendAggregateDeliveryReceipts").aggregateDeliveryReceipts(a));for(a of a){var c=a.receipt,e=a.isInDB,f=c.externalId,g=c.from,k=c.author,l=c.msgMeta,m=c.msgInfo;c=c.enc;var n=g.isUser()||g.isNewsletter()?null:k;e?(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts: duplicate message exists in the db: ",""])),f),void d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropDuplicateMessage({msgMeta:l,msgInfo:m,enc:c}),d("WAWebMessageDedupUtils").isPengingMessageCacheEnabled()?d("WAWebHandleMsgSendAck").sendAck(f,g,l.type,n):(m.category==="peer"&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[sendDeliveryReceipt] peer receipt using aggregated receipt flow ",""])),d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()).sendLogs("peer-receipt-using-aggregated-receipt"),b.push({externalId:f,from:g,author:k}))):(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts: duplicate message does not exist in the db: ",""])),f),void d("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropOldCounter({msgMeta:l,msgInfo:m,enc:c}),d("WAWebHandleMsgSendAck").sendNack(f,g,l.type,n,d("WAWebCreateNackFromStanza").NackReason.SignalErrorOldCounter))}return b});return o.apply(this,arguments)}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts"])));var c=[],e=[];for(a of a){var f=a.receiptInfo,g=a.duplicateMsgReceiptInfo;g!=null&&e.push(g);f!=null&&c.push(f)}c=c.concat(yield n(e));d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sendAggregateOfflineReceipts: "," receipts are ready to be sent"])),c.length);var h=new Map(),i=[];c.forEach(function(a){var b=a.from,c=a.author;a=a.externalId;var d=h.get(b);d||(d=new Map(),h.set(b,d));var e=d.get(c);e||(e=[],d.set(c,e));e.push(a);i.push({from:String(b),author:String(c),externalId:a})});var j=String(d("WATimeUtils").unixTime());void (m||(m=b("Promise"))).all(Array.from(h.keys()).map(function(a){var b=h.get(a);if(!b)return;var c=a.isUser()&&d("WAWebUserPrefsMeUser").isMeAccount(a);return d("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:a,type:c?d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.SENDER:d("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:j,groupedReceipt:b,recipient:c?a:null})}));d("WAComms").cancelDeadSocketTimer();i.length>0&&(yield d("WAWebSchemaDanglingReceipt").getTable().create({receipts:i,acks:[]}))});return p.apply(this,arguments)}g.handleDuplicateMsgReceipts=n;g.sendAggregateOfflineReceipts=a}),98);
__d("WAWebCommsAckParser",["WAJids","WAWebWidToJid"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAJids").extractJidFromJidWithType(d("WAWebWidToJid").widToJidWithType(a.from)),c=a.participant==null?void 0:d("WAWebWidToJid").widToDeviceJid(a.participant),e=a.recipient==null?void 0:d("WAWebWidToJid").widToUserJid(a.recipient);return babelHelpers["extends"]({},a,{from:b,participant:c,recipient:e})}g.toCoreAckTemplate=a}),98);
__d("WAWebSendReceiptJobCommon",["Promise","WADeprecatedSendIq","WADeprecatedWapParser","WAJids","WALogger","WAWap","WAWebABProps","WAWebCommsAckParser","WAWebCommsWapMd","WAWebCurrentUser","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebPrivacySettings","WAWebUserPrefsGeneral","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=Object.freeze({INACTIVE:"inactive",SENDER:"sender",DELIVERY:"delivery",READ:"read",READ_SELF:"read-self",PLAYED:"played",PLAYED_SELF:"played-self",HISTORY_SYNC_COMPLETION:"hist_sync",SERVER_ERROR:"server-error",PEER_MSG:"peer_msg"}),m=256,n=new(c("WADeprecatedWapParser"))("readReceiptAckParser",function(a){a.assertTag("ack");return{readReceipts:a.hasAttr("readreceipts")?a.attrEnum("readreceipts",d("WAWebPrivacySettings").ALL_NONE):null}});function o(a,b){b=c("lodash").flatten(Array.from(b.values()));var e=b[0];b=b.slice(1);b=b.length>0?d("WAWap").wap("list",null,b.map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})):null;e=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(e),to:d("WAWebCommsWapMd").JID(a),"class":"message",type:"text"},b);return d("WADeprecatedSendIq").deprecatedCastStanza(e)}function p(a,b,c,e){var f=a[0];a=a.slice(1);a=a.length>0?d("WAWap").wap("list",null,a.map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})):null;f=d("WAWap").wap("ack",{id:d("WAWap").CUSTOM_STRING(f),to:d("WAWebCommsWapMd").JID(b),recipient:c!=null?d("WAWebCommsWapMd").USER_JID(c):d("WAWap").DROP_ATTR,participant:e!=null?d("WAWebCommsWapMd").USER_JID(e):d("WAWap").DROP_ATTR,"class":"message",type:"text"},a);return d("WADeprecatedSendIq").deprecatedCastStanza(f)}function a(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.to,e=a.type,f=a.groupedReceipt,g=a.t,h=a.recipient;if(c.isNewsletter()&&e===l.DELIVERY)return o(c,f);var i=e===l.READ||e===l.PLAYED||e===l.READ_SELF||e===l.PLAYED_SELF||e===l.HISTORY_SYNC_COMPLETION;yield (k||(k=b("Promise"))).all(Array.from(f.keys()).map(function(a){var o=f.get(a);if(!o||o.length===0)return;var q=!c.isBot()&&a.isBot();if(e===l.DELIVERY&&q){var s,t;c.isUser()?(q=a,s=c):(q=c,t=a);p(o,q,s,t);return}var u=c.isUser()||c.isNewsletter()?null:a,v=c,w=h;w==null&&c.isUser()&&!c.isBot()&&a.isBot()&&(v=a,w=c);var x=[];q=function(){var a=o.splice(0,m),c=null;a.length>1&&(c=d("WAWap").wap("list",null,a.slice(1).map(function(a){return d("WAWap").wap("item",{id:d("WAWap").CUSTOM_STRING(a)})})));var f,h;u!=null&&(u.isPSA()?f=d("WAWebCommsWapMd").JID(u):u.isUser()&&(f=d("WAWebCommsWapMd").DEVICE_JID(u),d("WAWebABProps").getABPropConfigValue("lid_status_non_soaked_client_support_enabled")&&d("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()&&v.toString()===d("WAJids").STATUS_JID&&u.isLid()&&e===l.READ&&(h=d("WAWebLidMigrationUtils").toPn(u))));w&&r(w,v);var k=d("WAWap").wap("receipt",{to:d("WAWebCommsWapMd").JID(v),type:e===l.DELIVERY?d("WAWap").DROP_ATTR:e,id:d("WAWap").CUSTOM_STRING(a[0]),t:g!=null?d("WAWap").CUSTOM_STRING(g):d("WAWap").DROP_ATTR,participant:f!=null?f:d("WAWap").DROP_ATTR,peer_participant_pn:h?d("WAWebCommsWapMd").USER_JID(h):d("WAWap").DROP_ATTR,recipient:w?d("WAWebCommsWapMd").USER_JID(w):d("WAWap").DROP_ATTR},c);if(i){c=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b={id:a[0],from:v,"class":"receipt",type:e,participant:u,recipient:w};if(e===l.READ||e===l.READ_SELF){var c=(yield d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(k,d("WAWebCommsAckParser").toCoreAckTemplate(b)));c=n.parse(c);if(c.error)d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[messaging] sendAggregateReceipts: Invalid ack from server"]))).sendLogs("Invalid-Receipt-Ack");else{c=c.success.readReceipts;c!=null&&d("WAWebUserPrefsGeneral").setUserPrivacySettings(babelHelpers["extends"]({},d("WAWebUserPrefsGeneral").getUserPrivacySettings(),{readReceipts:c}))}}else return d("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(k,d("WAWebCommsAckParser").toCoreAckTemplate(b))});return function(){return c.apply(this,arguments)}}();x.push(c())}else x.push(d("WADeprecatedSendIq").deprecatedCastStanza(k))};while(o.length>0)q();return(k||(k=b("Promise"))).all(x)}))});return q.apply(this,arguments)}function r(a,b){if(a){var c=a.isLid()&&b.isUser()&&!b.isLid(),e=a.isUser()&&!a.isLid()&&b.isLid();(c||e)&&(d("WAWebCurrentUser").isEmployee()?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[sendDeliveryReceipt] will send mixed sender receipt (is employee). "," ",""])),a.toLogString(),b.toLogString()).sendLogs("mixed-sender-receipt"):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[sendDeliveryReceipt] will send mixed sender receipt. "," ",""])),a.toLogString(),b.toLogString()).sendLogs("mixed-sender-receipt"))}}g.RECEIPT_TYPE=l;g.sendBotInvokeResponseAcks=p;g.sendAggregateReceipts=a;g.logMixedSenderReceipt=r}),98);
__d("WAWebWamEnumReportingTokenValidationFailureReason",[],(function(a,b,c,d,e,f){a=Object.freeze({MISSING_MESSAGE_SECRET:0,EMPTY_REPORTING_TOKEN_CONTENT:1,MISMATCH_REPORTING_TOKEN:2,UNSUPPORTED_VERSION:3});f.REPORTING_TOKEN_VALIDATION_FAILURE_REASON=a}),66);
__d("WAWebReportingTokenUtils",["WABase64","WABinary","WACryptoHkdf","WACryptoHmac","WACryptoUtils","WAJids","WALogger","WATimeUtils","WAUseCaseSecret","WAWap","WAWebApiContact","WAWebCreateNackFromStanza","WAWebDBMessageSerialization","WAWebHandleMsgTypes.flow","WAWebLidMigrationUtils","WAWebMessageInsertDebugPlaceholder","WAWebMessagePluginGenerateReportingTokenContent","WAWebMessageSecretErrorsWamEvent","WAWebMessagingGatingUtils","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReportingTokenConfig","WAWebReportingTokenContent","WAWebSchemaMessage","WAWebUserPrefsMeUser","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType","WAWebWamEnumReportingTokenValidationFailureReason","WAWebWamMsgUtils","WAWebWamReportingTokenMismatchReporter","WAWebWid","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=16,q=32,r=6,s=7,t={DEFAULT:1,HISTORY_SYNC:-1},u={sampling:.01},v={sampling:1};function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.messageSecret,c=a.stanzaId,e=a.senderJid;a=a.remoteJid;c=d("WABinary").Binary.build(c,e,a,d("WAUseCaseSecret").UseCaseSecretModificationType.REPORT_TOKEN).readBuffer();return d("WACryptoHkdf").extractAndExpand(b instanceof ArrayBuffer?new Uint8Array(b):b,c,q)});return x.apply(this,arguments)}function y(a){return d("WAJids").extractFromJid(d("WAWebWidToJid").widToJidWithType(F(a)))}function z(a){return d("WAJids").extractFromJid(d("WAWebWidToJid").widToJidWithType(G(a)))}function A(a){a=d("WAWebWidToJid").widToJidWithType(a.id.remote);return{jidType:a.jidType,remoteJid:d("WAJids").extractFromJid(a)}}function a(a){var b;if(a.encFilehash==null&&a.caption==null)return null;b=new Uint8Array(d("WABase64").decodeB64((b=a.encFilehash)!=null?b:""));a=new TextEncoder().encode((a=a.caption)!=null?a:"");var c=new Uint8Array(b.length+a.length);c.set(b);c.set(a,b.length);return self.crypto.getRandomValues(new Uint8Array(c.length))}function B(a,b){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;if(!(d("WAWebMessagingGatingUtils").isReportingTokenSendingEnabled()&&d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(a.type,a.subtype)))return null;c=(c=a.messageSecret)!=null?c:(c=b.messageContextInfo)==null?void 0:c.messageSecret;var e=d("WAWebMsgGetters").getSender(a),f=A(a),g=f.jidType;f=f.remoteJid;if(g==="interopUser")return null;if(c==null){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_REPORTING_TOKEN,messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(a),messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET}).commit();return null}if(e==null||f==null)return null;g=d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion();c=(yield w({messageSecret:c,stanzaId:a.id.id,senderJid:d("WAWebWidToJid").widToUserJid(d("WAWebWidFactory").asUserWidOrThrow(e)),remoteJid:f}));if(a.reportingTokenContent!=null)e=a.reportingTokenContent;else{f=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,b);e=new(d("WAWebReportingTokenContent").ReportingTokenContentCalculator)(f.readByteArrayView(),d("WAWebReportingTokenConfig").getReportingTokenConfig(g)).getReportingTokenContent()}if(e==null||e.length===0)return null;a=(yield d("WACryptoHmac").hmacSha256(new Uint8Array(c),e!=null?e:new Uint8Array(0),p));return{version:g,reportingToken:new Uint8Array(a)}});return C.apply(this,arguments)}function e(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{b=(a=(yield B(a,b)))!=null?a:{};a=b.version;b=b.reportingToken;return b==null||a==null?null:d("WAWap").wap("reporting",null,d("WAWap").wap("reporting_token",{v:d("WAWap").CUSTOM_STRING(String(a))},b))}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["unexpected exception in generating reporting token body: ",""])),a).tags("messaging","wa-ice","report-token").sendLogs("report-token-unexpected-exception",u);return null}});return D.apply(this,arguments)}function f(a,b){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{b=(a=(yield B(a,b)))!=null?a:{};a=b.version;b=b.reportingToken;return b==null||a==null?null:{reportingTokenV:a,reportingTokenElementValue:b}}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["unexpected exception in generating reporting token mixin args: ",""])),a).tags("messaging","wa-ice","report-token").sendLogs("report-token-unexpected-exception",u);return null}});return E.apply(this,arguments)}function F(a){var b=d("WAWebMsgGetters").getBroadcastId(a);if(b!=null)return b;b=a.id.remote;if(!b.isRegularUser())return b;return b.isLid()?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow()}function G(a){var b=d("WAWebMsgGetters").getBroadcastId(a);if(b!=null)return b;b=a.id.remote;if(!b.isRegularUser())return b;return b.isLid()?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():d("WAWebUserPrefsMeUser").getMeLidUserOrThrow()}function H(a){return d("WAWebMsgGetters").getIsEdited(a)&&!d("WAWebMessagingGatingUtils").isReportingTokenEditReceiveEnabled()}function I(a){return(a.kind===d("WAWebMsgType").MsgKind.CommentEncrypted||a.kind===d("WAWebMsgType").MsgKind.EventEditEncrypted)&&!d("WAWebMessagingGatingUtils").isDualEncryptedReportingTokenReceiveEnabled()}function J(a,b){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{if(!d("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return{res:!0,reportingTokenContent:null,reportingTokenKey:null};var c=a.reportingTokenInfo;if(c==null||Object.keys(c).length===0)return{res:!0,reportingTokenContent:null,reportingTokenKey:null};if(c.reportingTag==null)return{res:!0,reportingTokenContent:null,reportingTokenKey:null};var e=c.reportingToken;c=(c=c.version)!=null?c:t.DEFAULT;var f={msg:a,reportingTokenVersion:c};if(e==null)return{res:!0,reportingTokenContent:null,reportingTokenKey:null};if(!d("WAWebMessagePluginGenerateReportingTokenContent").isMsgTypeReportingTokenCompatible(a.type,a.subtype))return{res:!0,reportingTokenContent:null,reportingTokenKey:null};if(H(a)||I(a))return{res:!0,reportingTokenContent:null,reportingTokenKey:null};var g;d("WAWebMsgGetters").getIsEdited(a)&&(g=(yield P(a.protocolMessageKey)));g=g!=null?g:a.messageSecret;if(g==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["message secret cannot be null for validating reporting token info: ","-",""])),a.type,a.subtype).tags("messaging","wa-ice","report-token").sendLogs("report-token-null-message-secret",v);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent(babelHelpers["extends"]({},f,{reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISSING_MESSAGE_SECRET}));return{res:!1,reportingTokenContent:null,reportingTokenKey:null}}var h=(yield L({messageSecret:g,commonLoggingProps:f,msg:a,plainProtobufBytes:b,receivedVersion:c,receivedReportingToken:e,isAlternateChecking:!1}));if(h.res===!0)return h;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["validateReportingTokenInfo: validation failed, try to use alternate sender and remote"])));h=(yield L({messageSecret:g,commonLoggingProps:f,msg:a,plainProtobufBytes:b,receivedVersion:c,receivedReportingToken:e,isAlternateChecking:!0}));if(!h.res){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Franking tag doesn't match for message ",": ","-",". Received version: ",""])),a.id.toString(),a.type,a.subtype,c).tags("messaging","wa-ice","report-token").sendLogs("report-token-mismatch",v);c>d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion()?d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.UNSUPPORTED_VERSION,reportingTokenVersion:c}):d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent({msg:a,reason:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.MISMATCH_REPORTING_TOKEN,reportingTokenVersion:c});if(N(c)){f=O(a);d("WAWebMessageInsertDebugPlaceholder").maybeInsertDebugPlaceholder({externalId:f.externalId,nackReason:d("WAWebCreateNackFromStanza").NackReason.ParsingError,msgInfo:f,offline:!1,additionalInfo:"reporting token validation failed for msg "+a.id.toString()})}}return h}catch(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["unexpected exception in validating reporting token info: ",""])),a).tags("messaging","wa-ice","report-token").sendLogs("report-token-unexpected-exception",u);return{res:!1,reportingTokenContent:null,reportingTokenKey:null}}});return K.apply(this,arguments)}function L(a){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.messageSecret,c=a.commonLoggingProps,e=a.msg,f=a.plainProtobufBytes,g=a.receivedVersion,h=a.receivedReportingToken;a=a.isAlternateChecking;var i=d("WAWebMsgGetters").getSender(e);if(a&&i!=null)if(i.isLid())i=d("WAWebLidMigrationUtils").toPn(i);else if(e.preMatChat!=null)i=e.preMatChat;else{var j=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(i));i=j!=null?d("WAWebWidFactory").createWid(j.toString()):null}if(i==null){a||d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["senderWid cannot be null for validating reporting token info"]))).tags("messaging","wa-ice","report-token").sendLogs("report-token-null-sender",v);return{res:!1,reportingTokenContent:null,reportingTokenKey:null}}j=a?z(e):y(e);a=new Uint8Array(yield w({messageSecret:b,stanzaId:e.id.id,senderJid:d("WAWebWidToJid").widToUserJid(i),remoteJid:j}));b=new(d("WAWebReportingTokenContent").ReportingTokenContentCalculator)(f,d("WAWebReportingTokenConfig").getReportingTokenConfig(g)).getReportingTokenContent();if(b.length===0){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["reporting token content cannot be empty for validating reporting token info. Message: ","-",""])),e.type,e.subtype).tags("messaging","wa-ice","report-token").sendLogs("report-token-empty-reporting-token-content",v);d("WAWebWamReportingTokenMismatchReporter").logReportingTokenValidationEvent(babelHelpers["extends"]({},c,{reason:g>d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion()?d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.UNSUPPORTED_VERSION:d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON.EMPTY_REPORTING_TOKEN_CONTENT}));return{res:!1,reportingTokenContent:null,reportingTokenKey:a}}i=new Uint8Array(yield d("WACryptoHmac").hmacSha256(a,b!=null?b:new Uint8Array(0),p));f=d("WACryptoUtils").uint8ArraysEqual(i,(j=h.subarray(0,32))!=null?j:new Uint8Array(0));return{res:f,reportingTokenContent:b,reportingTokenKey:a}});return M.apply(this,arguments)}function N(a){return a>d("WAWebMessagingGatingUtils").getSenderReportingTokenVersion()?!1:d("WAWebMessagingGatingUtils").isReportingTokenValidationFailureDebugPlaceholderEnabled()}function O(a){var b,e=a.id.id+"DEBUG",f=a.id.remote;e={author:(b=d("WAWebMsgGetters").getSender(a))!=null?b:a.from,chat:f,count:null,edit:-1,isHsm:!1,externalId:e,pushname:"Debug",ts:d("WATimeUtils").castToUnixTime(((b=a.t)!=null?b:0)+1)};return c("WAWebWid").isGroup(f)?babelHelpers["extends"]({},e,{type:d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.GROUP,isDirect:!1}):babelHelpers["extends"]({},e,{type:d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT})}function P(a){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return null;a=(yield d("WAWebSchemaMessage").getMessageTable().get(a.toString()));if(a==null)return null;a=d("WAWebDBMessageSerialization").messageFromDbRow(a);return a.messageSecret});return Q.apply(this,arguments)}g.REPORTING_TOKEN_KEY_SIZE=q;g.REPORTING_TOKEN_STORAGE_SIZE=r;g.REPORTING_TOKEN_INVALID_STORAGE_SIZE=s;g.REPORTING_TOKEN_VERSION=t;g.genReportingTokenKeyFromMessageSecret=w;g.getRemoteJidOnReceiverSide=y;g.getMediaReportingTokenContent=a;g.genReportingToken=B;g.genReportingTokenBody=e;g.genClientReportingTokenMixinArgs=f;g.shouldSkipProcessingEditedMsg=H;g.shouldSkipProcessingDualEncryptedMsg=I;g.validateReportingTokenInfo=J;g.showDebugPlaceholderForReportingTokenMismatch=N}),98);
__d("WAWebMexUsyncQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"include_about_status"},b={defaultValue:null,kind:"LocalArgument",name:"include_country_code"},c={defaultValue:null,kind:"LocalArgument",name:"include_username"},d={defaultValue:null,kind:"LocalArgument",name:"input"},e=[{kind:"Variable",name:"input",variableName:"input"}],f={alias:null,args:null,kind:"ScalarField",name:"jid",storageKey:null},g={condition:"include_country_code",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"country_code",storageKey:null}]},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},j={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],type:"XWA2ResponseStatus",abstractKey:null},k={condition:"include_username",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"username_info",plural:!1,selections:[h,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"pin",storageKey:null}],type:"XWA2Username",abstractKey:null},j],storageKey:null}]};i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},i],type:"XWA2AboutStatus",abstractKey:null};return{fragment:{argumentDefinitions:[a,b,c,d],kind:"Fragment",metadata:null,name:"WAWebMexUsyncQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"xwa2_fetch_wa_users",plural:!0,selections:[f,g,k,{condition:"include_about_status",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"about_status_info",plural:!1,selections:[i,j],storageKey:null}]}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[d,c,a,b],kind:"Operation",name:"WAWebMexUsyncQuery",selections:[{alias:null,args:e,concreteType:null,kind:"LinkedField",name:"xwa2_fetch_wa_users",plural:!0,selections:[h,f,g,k,{condition:"include_about_status",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"about_status_info",plural:!1,selections:[h,i,j],storageKey:null}]},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"XWA2User",abstractKey:null}],storageKey:null}]},params:{id:"29829202653362039",metadata:{},name:"WAWebMexUsyncQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("WAWebMexUsync",["WAWebMexClient","WAWebMexRelayEnvironment","WAWebMexUsyncQuery.graphql","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i=h!==void 0?h:h=b("WAWebMexUsyncQuery.graphql");function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{var b=a.users.filter(function(a){a=a.jid;return d("WAWebWidFactory").createWid(a).isUser()});if(b.length){b=(yield d("WAWebMexClient").fetchQuery(i,{input:{query_input:b,telemetry:a.telemetry},include_username:a.fetch.username===!0,include_about_status:a.fetch.about_status===!0,include_country_code:a.fetch.country_code===!0}));if(b.xwa2_fetch_wa_users!=null)return{response:b.xwa2_fetch_wa_users,error:null}}throw c("err")("[MEX][USYNC] xwa2_fetch_wa_users null")}catch(a){if(a instanceof d("WAWebMexRelayEnvironment").MexIqError)return{response:null,error:{code:a.code,text:"MexIqError:"+a.message}};if(a instanceof d("WAWebMexRelayEnvironment").MexFatalExtensionError)return{response:null,error:{code:a.error.extensions.error_code,text:"MexFatalExtensionError:"+a.error.message}};throw a}});return j.apply(this,arguments)}g.mexUsyncQuery=a}),98);
__d("WAWebMexLogNewsletterExposureJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"XWA2NewsletterLogExposureResponse",kind:"LinkedField",name:"xwa2_newsletter_log_exposure",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexLogNewsletterExposureJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexLogNewsletterExposureJobMutation",selections:b},params:{id:"29209687128675794",metadata:{},name:"WAWebMexLogNewsletterExposureJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebCommonNewsletterEnums",["$InternalEnum"],(function(a,b,c,d,e,f){c=(a=b("$InternalEnum"))({Subscriber:"subscriber",Admin:"admin",Guest:"guest",Owner:"owner"});d=a({Public:"public",Private:"private"});e=a({Active:"active",Suspended:"suspended",GeoSuspended:"geosuspended"});b=a({All:0,Basic:1,Blocklist:2,None:3});var g=a.Mirrored(["GEOSUSPEND","SUSPEND","VIOLATING_MSG","PROFILE_PICTURE_DELETION","SUSPEND_INFORM","GEOSUSPEND_INFORM"]),h=a.Mirrored(["SUSPENDED_DETAILED_SCREEN","DELETE_NEWSLETTER","VIOLATING_MESSAGES_SCREEN","PROFILE_PICTURE_DELETION_SCREEN","GEOSUSPENDED_COUNTRY_DETAILED_SCREEN","MULTIPLE_ALERTS_LIST_SCREEN","REQUEST_REVIEW_DESCRIPTION_SCREEN","REQUEST_REVIEW_REASON_SCREEN","APPEAL_OUTCOME_SCREEN","REMEDIATION_OPTIONS_SCREEN","DSB_STEP1_SCREEN","DSB_STEP2_SCREEN","DSB_STEP3_SCREEN","CONTACT_IP_REPORTER_STEP1_SCREEN","CONTACT_IP_REPORTER_STEP2_SCREEN","SUSPEND_INFORM_SCREEN","RM_REQUEST_REVIEW_SCREEN_STEP1_SCREEN","RM_REQUEST_REVIEW_SCREEN_STEP2_SCREEN","RM_REQUEST_REVIEW_SCREEN_STEP3_SCREEN","GEOSUSPEND_INFORM_SCREEN"]),i=a.Mirrored(["IP_SRT_VIOLATION","GENERIC_VIOLATION","RM_COPS","RM_PRODUCT_RESTRICTION","LEGAL_TDR","RESPONSE_VIOLATES_GUIDELINES"]),j=a.Mirrored(["All","Unread","MyChannels"]),k=a({Insights:0,PhotoPolls:1,QUESTIONS:2,ADMIN_NOTIFICATIONS:3,INVITE_ADMINS_BUTTON:4,INVITE_FOLLOWERS:5,QUIZ:6,ADMIN_CONTEXT_CARD_1:7,ADMIN_CONTEXT_CARD_2:8,ADMIN_CONTEXT_CARD_3:9,SHARE_STICKER_PACKS:10}),l=a.Mirrored(["ACTIVE","INACTIVE"]);a=a.Mirrored(["ENFORCEMENT","REPORT","RESPONSE_REPORT"]);f.NewsletterMembershipType=c;f.NewsletterPrivacy=d;f.NewsletterState=e;f.NewsletterReactionCodesSetting=b;f.EnforcementType=g;f.AlertScreen=h;f.NewsletterDSADecisionModalCategory=i;f.NewsletterInboxFilterTypes=j;f.NewsletterCapability=k;f.WamoSubStatus=l;f.ReviewType=a}),66);
__d("WAWebNewsletterQueryUtils",["WAJids","WAWebCommonNewsletterEnums","WAWebWid"],(function(a,b,c,d,e,f,g){var h=["hasNewsletterMembershipField","hasNewsletterMutedField","newsletterPictureFieldMixinArgs"];function i(a){if(a==null)return"guest";switch(a){case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:return"admin";case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:return"owner";case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:return"subscriber";default:return"guest"}}function a(a,b,e){e=k(e);if(c("WAWebWid").isNewsletter(a))return{queryPayloadsArgs:{jidQueryIQPayload:{anyJid:d("WAJids").toNewsletterJid(a),anyViewRole:i(b),allNewsletterMetadataIQRequestPayloadMixinArgs:e}}};e.hasNewsletterMembershipField;e.hasNewsletterMutedField;e.newsletterPictureFieldMixinArgs;e=babelHelpers.objectWithoutPropertiesLoose(e,h);return{queryPayloadsArgs:{inviteQueryIQPayload:babelHelpers["extends"]({anyKey:a,anyViewRole:i(b)},e,{newsletterPreviewTypePictureFieldMixinArgs:{baseNewsletterPictureFieldMixinArgs:{}}})}}}function j(){return{pictureArgs:[{pictureType:"image"},{pictureType:"preview"}]}}function k(a){return a==null?{hasNewsletterCreationTimeField:!0,hasNewsletterNameField:!0,newsletterPictureFieldMixinArgs:j(),hasNewsletterDescriptionField:!0,hasNewsletterInviteLinkField:!0,hasNewsletterHandleField:!0,hasNewsletterSubscribersField:!0,hasNewsletterPrivacyField:!0,hasNewsletterVerificationField:!0,hasNewsletterLinkedAccountsField:!0,hasNewsletterMembershipField:!0,hasNewsletterMutedField:!0,hasNewsletterStateField:!0}:{hasNewsletterCreationTimeField:a.creationTime,hasNewsletterNameField:a.name,newsletterPictureFieldMixinArgs:a.picture===!0?j():void 0,hasNewsletterDescriptionField:a.description,hasNewsletterInviteLinkField:a.inviteLink,hasNewsletterHandleField:a.handle,hasNewsletterSubscribersField:a.subscribers,hasNewsletterPrivacyField:a.privacy,hasNewsletterVerificationField:a.verification,hasNewsletterLinkedAccountsField:a.linkedAccounts,hasNewsletterMembershipField:a.membership,hasNewsletterMutedField:a.membership,hasNewsletterStateField:a.state}}function b(a){return c("WAWebWid").isNewsletter(a)?{queryNewsletterJIDParams:{anyJid:d("WAJids").toNewsletterJid(a)}}:{queryNewsletterInviteParams:{anyKey:a}}}function e(a){switch(a){case d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights:return"INSIGHTS";case d("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls:return"PHOTO_POLLS";case d("WAWebCommonNewsletterEnums").NewsletterCapability.QUESTIONS:return"QUESTIONS";case d("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_ADMINS_BUTTON:return"INVITE_ADMINS_BUTTON";case d("WAWebCommonNewsletterEnums").NewsletterCapability.INVITE_FOLLOWERS:return"INVITE_FOLLOWERS";case d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_NOTIFICATIONS:return"ADMIN_NOTIFICATIONS";case d("WAWebCommonNewsletterEnums").NewsletterCapability.QUIZ:return"QUIZ";case d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_1:return"ADMIN_CONTEXT_CARD_1";case d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_2:return"ADMIN_CONTEXT_CARD_2";case d("WAWebCommonNewsletterEnums").NewsletterCapability.ADMIN_CONTEXT_CARD_3:return"ADMIN_CONTEXT_CARD_3";case d("WAWebCommonNewsletterEnums").NewsletterCapability.SHARE_STICKER_PACKS:return"SHARE_STICKER_PACKS"}}g.getNewsletterMetadataQueryParamArgs=a;g.getNewsletterMetadataArgs=k;g.getNewsletterMessagesQueryParams=b;g.getNewsletterCapabilityFromEnum=e}),98);
__d("WAWebMexLogNewsletterExposureJob",["WALogger","WAWebMexClient","WAWebMexLogNewsletterExposureJobMutation.graphql","WAWebNewsletterQueryUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j=h!==void 0?h:h=b("WAWebMexLogNewsletterExposureJobMutation.graphql");function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={input:{newsletter_id:a,capability:d("WAWebNewsletterQueryUtils").getNewsletterCapabilityFromEnum(b)}};c=(yield d("WAWebMexClient").fetchQuery(j,c));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][NEWSLETTER] logged newsletter capability exposure"]))).tags("GQL","MEX").devConsole({newsletterJid:a,capability:b,response:c})});return k.apply(this,arguments)}g.mexLogNewsletterExposure=a}),98);
__d("WAWebMexSetUsernameJobMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"username",variableName:"input"}],concreteType:"XWA2UsernameSetMutationResponse",kind:"LinkedField",name:"xwa2_username_set",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"WAWebMexSetUsernameJobMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"WAWebMexSetUsernameJobMutation",selections:b},params:{id:"8896855000416010",metadata:{},name:"WAWebMexSetUsernameJobMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("WAWebMexSetUsernameJob",["WALogger","WAWebMexClient","WAWebMexSetUsernameJobMutation.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c={input:a},e=h!==void 0?h:h=b("WAWebMexSetUsernameJobMutation.graphql");e=(yield d("WAWebMexClient").fetchQuery(e,a!=null?c:{}));d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MEX][USERNAME] Successfully fetched set username mutation via mex"]))).tags("GQL","MEX").devConsole({response:e});return((a=e.xwa2_username_set)==null?void 0:a.result)==="SUCCESS"});return j.apply(this,arguments)}g.mexSetUsernameQueryJob=a}),98);
__d("WAWebMexUsersGetCountryCode",["WALogger","WAWebCountriesUtils","WAWebMexUsync","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMexUsync").mexUsyncQuery({users:a.map(function(a){return{jid:a.toJid()}}),telemetry:{context:"INTERACTIVE"},fetch:{country_code:!0}}));a=a.response;if(a!=null)return a.map(function(a){if(a.country_code==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["server missing user's country code"]))).sendLogs("missing-username-country-code-mex",{sampling:.01});return{error:!0}}return{usernameCountryCode:a.country_code}})});return j.apply(this,arguments)}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield i([a]));a=a==null?void 0:a[0];if(a==null||a.error===!0)return null;a=a.usernameCountryCode;if(a!=null)return d("WAWebCountriesUtils").asISOCountryCode(a)});return k.apply(this,arguments)}g.getMexUserCountryCode=a}),98);
__d("WAWebMexUsersGetUsername",["WAWebMexUsync","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebMexUsync").mexUsyncQuery({users:a.map(function(a){return{jid:a.toJid()}}),telemetry:{context:"INTERACTIVE"},fetch:{username:!0}}));a=a.response;if(a!=null)return a.map(function(a){return a.username_info==null?{error:!0,username:null}:{username:(a=a.username_info)==null?void 0:a.username}})});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield h([a]));return a==null?void 0:a[0].username});return j.apply(this,arguments)}g.getMexUserUsername=a}),98);
__d("WAWebSetPrivacyTokensJob",["$InternalEnum","WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebCommsWapMd","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("setPrivacyTokensParser",function(a){a={stanzaId:a.attrString("id")};return a});e=b("$InternalEnum")({TrustedContact:"trusted_contact"});function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;b=b.map(function(b){return d("WAWap").wap("token",{jid:d("WAWebCommsWapMd").USER_JID(a),t:d("WAWap").CUSTOM_STRING(String(c)),type:d("WAWap").CUSTOM_STRING(b)})});e=(yield d("WADeprecatedSendIq").deprecatedSendIq((e=d("WAWap")).wap("iq",{to:e.S_WHATSAPP_NET,type:"set",xmlns:"privacy",id:e.generateId()},e.wap("tokens",null,b)),h));if(!e.success)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(e.errorCode,e.errorText)});return i.apply(this,arguments)}g.TokenType=e;g.issuePrivacyToken=a}),98);
__d("WAWebTrustedContactsUtils",["$InternalEnum","WABase64","WATimeUtils","WAWebABProps"],(function(a,b,c,d,e,f,g){var h=6*30*24*60*60,i=b("$InternalEnum")({Sender:"sender",Receiver:"receiver"});function j(a){a=a===i.Receiver?"tctoken_duration":"tctoken_duration_sender";return Math.min(d("WAWebABProps").getABPropConfigValue(a),h)}function a(a,b){return a<k(b)}function k(a){var b=a===i.Receiver?"tctoken_num_buckets":"tctoken_num_buckets_sender";b=d("WAWebABProps").getABPropConfigValue(b);a=j(a);var c=Math.floor(d("WATimeUtils").unixTime()/a);c=c-(b-1);return d("WATimeUtils").castToUnixTime(c*a)}function c(a){if(a==null)return!0;var b=d("WAWebABProps").getABPropConfigValue("tctoken_duration_sender"),c=Math.floor(d("WATimeUtils").unixTime()/b);a=Math.floor(a/b);return c>a}function e(a){return d("WABase64").encodeB64(a)}g.TcTokenMode=i;g.getTcTokenDuration=j;g.isTokenExpired=a;g.tokenExpirationCutoff=k;g.shouldSendNewToken=c;g.encodeTcTokenForMex=e}),98);
__d("WAWebSendTcTokenWhenDeviceIdentityChange",["WALogger","WATimeUtils","WAWebApiChat","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebSetPrivacyTokensJob","WAWebTrustedContactsUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var c=d("WAWebLidMigrationUtils").toUserLid(a);c!=null&&(b=(yield d("WAWebApiChat").getChatRecordByAccountLid(c))[0])}else b=(yield d("WAWebApiChat").getChatRecord(a));if(b==null)return;c=b.tcTokenSenderTimestamp;if(c==null)return;if(d("WAWebTrustedContactsUtils").isTokenExpired(c,d("WAWebTrustedContactsUtils").TcTokenMode.Sender))return;try{var e;yield d("WAWebSetPrivacyTokensJob").issuePrivacyToken((e=d("WAWebLidMigrationUtils").toPn(a))!=null?e:a,[d("WAWebSetPrivacyTokensJob").TokenType.TrustedContact],d("WATimeUtils").castToUnixTime(c))}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendTcTokenWhenDeviceIdentityChange failed - ",""])),a).verbose().devConsole(a).sendLogs("send-tc-token-device-identity-change-failed")}});return i.apply(this,arguments)}g.sendTcTokenWhenDeviceIdentityChange=a}),98);
__d("WAWebUsyncBackoff",["Promise","WALogger"],(function(a,b,c,d,e,f,g){var h,i,j,k=new Map();function a(a,c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["usync: "," protocol: ","ms backoff started"])),a,c),k.set(a,new(j||(j=b("Promise")))(function(a){return self.setTimeout(a,c)}).then(function(){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["usync: "," protocol: ","ms backoff ended"])),a,c)}))}function c(a){return!l(a)?(j||(j=b("Promise"))).resolve():(j||(j=b("Promise"))).all(a.protocols.map(function(a){return k.get(a.getName())}))}function l(a){if(a.context==="interactive")return!1;var b=a.protocols.map(function(a){return a.getName()});return b.includes("devices")&&(a.context==="message"||a.context==="voip")?!1:!0}g.setProtocolBackoffMs=a;g.waitForBackoff=c}),98);
__d("WAWebUsyncBotProfile",["WAWap","WAWebBotTypes"],(function(a,b,c,d,e,f,g){function a(a){var b;a.assertTag("bot");var c=a.maybeChild("error");if(c)return{errorCode:c.attrInt("code"),errorText:c.attrString("text")};c=a.child("profile");a=c.child("name");a=a.contentString();var e=c.child("attributes");e=e.contentString();var f=c.child("description");f=f.contentString();var g=c.child("category");g=g.contentString();var j=c.maybeChild("default");j=(j==null?void 0:j.contentString())==="true";var k=c.maybeChild("prompts");k=h(k);b=(b=c.maybeAttrString("persona_id"))!=null?b:"";var l=c.maybeChild("commands");l=i(l);var m=l.commands;l=l.commandsDescription;var n,o=c.maybeChild("is_meta_created");o&&(n=(o==null?void 0:o.contentString())==="true");var p,q;o=c.maybeChild("creator");if(o){var r;p=(r=o.maybeChild("name"))==null?void 0:r.contentString();q=(r=o.maybeChild("profile_url"))==null?void 0:r.contentString()}var s;o=c.maybeChild("posing_as_professional");if(o)switch(o.attrString("type")){case"unknown":s=d("WAWebBotTypes").BotPosingAsProfessionalType.UNKNOWN;break;case"yes":s=d("WAWebBotTypes").BotPosingAsProfessionalType.YES;break;case"no":s=d("WAWebBotTypes").BotPosingAsProfessionalType.NO;break}return{name:a,attributes:e,description:f,category:g,isDefault:j,prompts:k,personaId:b,commands:m,commandsDescription:l,isMetaCreated:n,creatorName:p,creatorProfileUrl:q,posingAsProfessional:s}}function h(a){if(a==null)return[];var b=[];a.forEachChildWithTag("prompt",function(a){var c=a.maybeChild("emoji");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("text");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({emoji:c,text:a})});return b}function i(a){if(a==null)return{commands:[],commandsDescription:""};var b=[],c=a.maybeChild("description");c=(c=c==null?void 0:c.contentString())!=null?c:"";a.forEachChildWithTag("command",function(a){var c=a.maybeChild("name");c=(c=c==null?void 0:c.contentString())!=null?c:"";a=a.maybeChild("description");a=(a=a==null?void 0:a.contentString())!=null?a:"";b.push({name:c,description:a})});return{commands:b,commandsDescription:c}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"bot"};b.getQueryElement=function(){return d("WAWap").wap("bot",null,d("WAWap").wap("profile",{v:"1"}))};b.getUserElement=function(a){a=a.getPersonaId();return d("WAWap").wap("bot",null,d("WAWap").wap("profile",{persona_id:a!=null?d("WAWap").CUSTOM_STRING(a):d("WAWap").DROP_ATTR}))};return a}();g.botProfileParser=a;g.USyncBotProfileProtocol=b}),98);
__d("WAWebProtobufsVnameCert.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({ENTERPRISE:0});e=a({ON_PREMISE:0,FACEBOOK:1});f=a({SELF:0,BSP:1});b=a({ON_PREMISE:0,FACEBOOK:1});a=a({UNKNOWN:0,LOW:1,HIGH:2});var h={},i={},j={},k={},l={},m={};h.name="LocalizedName";h.internalSpec={lg:[1,(d=d("WAProtoConst")).TYPES.STRING],lc:[2,d.TYPES.STRING],verifiedName:[3,d.TYPES.STRING]};i.name="VerifiedNameCertificate";i.internalSpec={details:[1,d.TYPES.BYTES],signature:[2,d.TYPES.BYTES],serverSignature:[3,d.TYPES.BYTES]};j.name="VerifiedNameCertificate$Details";j.internalSpec={serial:[1,d.TYPES.UINT64],issuer:[2,d.TYPES.STRING],verifiedName:[4,d.TYPES.STRING],localizedNames:[8,d.FLAGS.REPEATED|d.TYPES.MESSAGE,h],issueTime:[10,d.TYPES.UINT64]};k.name="BizAccountPayload";k.internalSpec={vnameCert:[1,d.TYPES.MESSAGE,i],bizAcctLinkInfo:[2,d.TYPES.BYTES]};l.name="BizAccountLinkInfo";l.internalSpec={whatsappBizAcctFbid:[1,d.TYPES.UINT64],whatsappAcctNumber:[2,d.TYPES.STRING],issueTime:[3,d.TYPES.UINT64],hostStorage:[4,d.TYPES.ENUM,e],accountType:[5,d.TYPES.ENUM,c]};m.name="BizIdentityInfo";m.internalSpec={vlevel:[1,d.TYPES.ENUM,a],vnameCert:[2,d.TYPES.MESSAGE,i],signed:[3,d.TYPES.BOOL],revoked:[4,d.TYPES.BOOL],hostStorage:[5,d.TYPES.ENUM,b],actualActors:[6,d.TYPES.ENUM,f],privacyModeTs:[7,d.TYPES.UINT64],featureControls:[8,d.TYPES.UINT64]};g.BizAccountLinkInfo$AccountType=c;g.BizAccountLinkInfo$HostStorageType=e;g.BizIdentityInfo$ActualActorsType=f;g.BizIdentityInfo$HostStorageType=b;g.BizIdentityInfo$VerifiedLevelValue=a;g.LocalizedNameSpec=h;g.VerifiedNameCertificateSpec=i;g.VerifiedNameCertificate$DetailsSpec=j;g.BizAccountPayloadSpec=k;g.BizAccountLinkInfoSpec=l;g.BizIdentityInfoSpec=m}),98);
__d("WAWebValidateBusinessCertificate",["WAWebProtobufsVnameCert.pb","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h="ent:wa",i="smb:wa";function a(a){return{serial:a.serial,name:a.verifiedName,isApi:a.issuer===h,isSmb:a.issuer===i}}function b(a){if(!a)return null;a=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsVnameCert.pb").VerifiedNameCertificateSpec,a);if(!a.details)throw c("err")("verifyCertificate cert missing details");var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsVnameCert.pb").VerifiedNameCertificate$DetailsSpec,a.details);return{cert:a,details:b}}g.extractCertificateDetailsParams=a;g.getParsedProtoObjects=b}),98);
__d("WAWebCommonParsersVerifiedName",["WAWebHandleMsgCommon","WAWebHandleMsgTypes.flow","WAWebNonEmptyString","WAWebValidateBusinessCertificate"],(function(a,b,c,d,e,f,g){function h(a){a=d("WAWebValidateBusinessCertificate").getParsedProtoObjects(a);if(a!=null&&a.details){a=d("WAWebValidateBusinessCertificate").extractCertificateDetailsParams(a.details);var b=a.name,c=a.serial,e=a.isApi;a=a.isSmb;return{name:b,serial:String(c),isApi:e,isSmb:a}}}function a(a){var b=a.attrEnum("verified_level",d("WAWebHandleMsgCommon").MSG_VERIFIED_LEVEL),c=a.hasContent()?a.contentBytes():null,e=d("WAWebNonEmptyString").asMaybeNonEmptyString(a.maybeAttrString("serial"));c=c&&h(c)||{};var f=c.serial,g=c.name,i=c.isApi;c=c.isSmb;var j=d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(a.maybeAttrInt("actual_actors")),k=d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(a.maybeAttrInt("host_storage"));a=a.maybeAttrInt("privacy_mode_ts");j=j!=null&&k!=null&&a!=null?{actualActors:j,hostStorage:k,privacyModeTs:a}:null;return{level:b,serial:e!=null?e:f,name:g,isApi:i===!0,isSmb:c===!0,privacyMode:j}}g["default"]=a}),98);
__d("WAWebUsyncBusiness",["WAWap","WAWebCommonParsersVerifiedName"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("business");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.maybeChild("verified_name");a=b?c("WAWebCommonParsersVerifiedName")(b):null;return{verifiedName:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"business"};b.getQueryElement=function(){return d("WAWap").wap("business",null,d("WAWap").wap("verified_name",null))};b.getUserElement=function(a){return null};return a}();g.businessParser=a;g.USyncBusinessProtocol=b}),98);
__d("WAWebUsyncDevice",["WAWap","WAWebBizCoexGatingUtils"],(function(a,b,c,d,e,f,g){var h=2;function a(a){a.assertTag("devices");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.maybeChild("key-index-list");a=a.maybeChild("device-list");b=b==null?null:{ts:b.attrTime("ts"),signedKeyIndexBytes:b.hasContent()?b.contentBytes():null,expectedTs:b.hasAttr("expected_ts")?b.attrTime("expected_ts"):void 0};a=a==null?void 0:a.mapChildrenWithTag("device",function(a){var b={id:a.attrInt("id"),keyIndex:a.hasAttr("key-index")?a.attrInt("key-index"):null};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a.hasAttr("is_hosted")&&a.attrString("is_hosted")==="true"&&(b.isHosted=!0));return b});return{deviceList:a,keyIndex:b}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"devices"};b.getQueryElement=function(){return d("WAWap").wap("devices",{version:d("WAWap").CUSTOM_STRING(String(h))})};b.getUserElement=function(a){var b=a.getDeviceHash(),c=a.getTs();a=a.getExpectedTs();return b==null&&c==null&&a==null?null:d("WAWap").wap("devices",{device_hash:b!=null?d("WAWap").CUSTOM_STRING(b):d("WAWap").DROP_ATTR,ts:c!=null?d("WAWap").INT(c):d("WAWap").DROP_ATTR,expected_ts:a!=null?d("WAWap").INT(a):d("WAWap").DROP_ATTR})};return a}();g.deviceParser=a;g.USyncDeviceProtocol=b}),98);
__d("WAWebUsyncDisappearingMode",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("disappearing_mode");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.attrInt("duration",0);a=a.attrInt("t");return{duration:b,t:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"disappearing_mode"};b.getQueryElement=function(){return d("WAWap").wap("disappearing_mode",null)};b.getUserElement=function(a){return null};return a}();g.disappearingModeParser=a;g.USyncDisappearingModeProtocol=b}),98);
__d("WAWebUsyncFeature",["WAWap","err"],(function(a,b,c,d,e,f,g){var h={document:(b=d("WAWap")).wap("document",null),encrypt:b.wap("encrypt",null),encrypt_blist:b.wap("encrypt_blist",null),encrypt_contact:b.wap("encrypt_contact",null),encrypt_group_gen2:b.wap("encrypt_group_gen2",null),encrypt_image:b.wap("encrypt_image",null),encrypt_location:b.wap("encrypt_location",null),encrypt_url:b.wap("encrypt_url",null),encrypt_v2:b.wap("encrypt_v2",null),voip:b.wap("voip",null),multi_agent:b.wap("multi_agent",null)};function a(a){a.assertTag("feature");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};var c={};Object.keys(h).forEach(function(b){var d=a.maybeChild(b);d&&(c[b]=d.attrString("value"))});return c}e=function(){function a(a){this.queries=a;if(a.length===0)throw c("err")("must specify at least one query")}var b=a.prototype;b.getName=function(){return"feature"};b.getQueryElement=function(){return d("WAWap").wap("feature",null,this.queries&&this.queries.map(function(a){return h[a]}))};b.getUserElement=function(a){return null};return a}();g.featureParser=a;g.USyncFeaturesProtocol=e}),98);
__d("WAWebUsyncLid",["WAWap","WAWebCommsWapMd"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("lid");var b=a.maybeChild("error");return b?{errorCode:b.attrInt("code"),errorText:b.attrString("text")}:a.maybeAttrLidUserJid("val")}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"lid"};b.getQueryElement=function(){return d("WAWap").wap("lid",null)};b.getUserElement=function(a){a=a.getLid();return!a?null:d("WAWap").wap("lid",{jid:a?d("WAWebCommsWapMd").USER_JID(a):d("WAWap").DROP_ATTR})};return a}();g.lidParser=a;g.USyncLidProtocol=b}),98);
__d("WAWebUsyncPicture",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("picture");var b=a.maybeChild("error");return b?{errorCode:b.attrInt("code"),errorText:b.attrString("text")}:{id:a.attrInt("id")}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"picture"};b.getQueryElement=function(){return d("WAWap").wap("picture",null)};b.getUserElement=function(a){return null};return a}();g.pictureParser=a;g.USyncPictureProtocol=b}),98);
__d("WAWebPrivacyGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("data_privacy_phase_2_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("data_privacy_phase_2_non_e2ee_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("web_fetch_privacy_list_my_contacts_except")}function e(){return d("WAWebABProps").getABPropConfigValue("privacy_settings_about_lid_migration_enable")}function f(){return d("WAWebABProps").getABPropConfigValue("privacy_settings_group_add_lid_migration_enable")}function h(){return d("WAWebABProps").getABPropConfigValue("privacy_settings_profile_lid_migration_enable")}function i(){return d("WAWebABProps").getABPropConfigValue("privacy_settings_presence_lid_migration_enable")}function j(){return d("WAWebABProps").getABPropConfigValue("pnh_thread_promotion_to_general_lid")}function k(){return d("WAWebABProps").getABPropConfigValue("profile_scraping_privacy_token_in_about_usync")}function l(){return d("WAWebABProps").getABPropConfigValue("profile_scraping_privacy_token_in_about_iq")}g.isDataPrivacyPhase2Enabled=a;g.isDataPrivacyPhase2NonE2eeEnabled=b;g.isPrivacyListFetchEnabledForMyContactsExcept=c;g.isPrivacyListLidMigrationForStatusEnabled=e;g.isPrivacyListLidMigrationForGroupAddEnabled=f;g.isPrivacyListLidMigrationForProfilePictureEnabled=h;g.isPrivacyListLidMigrationForLastSeenEnabled=i;g.isPhoneNumberHidingThreadPromotionToGeneralLidEnabled=j;g.isProfileScrappingProtectionInUsyncEnabled=k;g.isProfileScrappingProtectionInMexFetchEnabled=l}),98);
__d("WAWebUsyncStatus",["WAWap","WAWebPrivacyGatingUtils"],(function(a,b,c,d,e,f,g){var h=null;function a(a){a.assertTag("status");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};return!a.hasContent()?a.hasAttr("code")&&a.attrInt("code")===401?"":h:a.contentString().length!==0?a.contentString():h}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"status"};b.getQueryElement=function(){return d("WAWap").wap("status",null)};b.getUserElement=function(a){if(!d("WAWebPrivacyGatingUtils").isProfileScrappingProtectionInUsyncEnabled())return null;a=a.getTcToken();return a?d("WAWap").wap("tctoken",null,a):null};return a}();g.statusParser=a;g.USyncStatusProtocol=b}),98);
__d("WAWebUsyncTextStatus",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("text_status");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b=a.hasAttr("text")?a.attrString("text"):void 0;var c=a.hasChild("emoji")?a.child("emoji"):void 0;c=c!=null&&c.hasAttr("content")?c==null?void 0:c.attrString("content"):void 0;var d=a.hasAttr("ephemeral_duration_sec")?a.attrInt("ephemeral_duration_sec"):void 0;a=a.hasAttr("last_update_time")?a.attrString("last_update_time"):void 0;return{text:b,emoji:c,ephemeralDurationSeconds:d,lastUpdateTime:a}}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"text_status"};b.getQueryElement=function(){return d("WAWap").wap("text_status",null)};b.getUserElement=function(a){return null};return a}();g.textStatusParser=a;g.USyncTextStatusProtocol=b}),98);
__d("WAWebUsyncUsername",["WAWap"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("username");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};return a.hasContent()?a.contentString():null}b=function(){function a(){}var b=a.prototype;b.getName=function(){return"username"};b.getQueryElement=function(){return d("WAWap").wap("username",null)};b.getUserElement=function(a){return null};return a}();g.usernameParser=a;g.USyncUsernameProtocol=b}),98);
__d("WAWebUsync",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","WAWebApiContact","WAWebCommsWapMd","WAWebJidToWid","WAWebUsyncBackoff","WAWebUsyncBotProfile","WAWebUsyncBusiness","WAWebUsyncContact","WAWebUsyncDevice","WAWebUsyncDisappearingMode","WAWebUsyncFeature","WAWebUsyncLid","WAWebUsyncPicture","WAWebUsyncStatus","WAWebUsyncTextStatus","WAWebUsyncUsername","WAWebWid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;a={PN:"pn",LID:"lid"};var l={FEATURE:"feature",DEVICE:"devices",CONTACT:"contact",PICTURE:"picture",STATUS:"status",BUSINESS:"business",DISAPPEARING_MODE:"disappearing_mode",LID:"lid",BOT:"bot",USERNAME:"username",TEXT_STATUS:"text_status"},m={feature:d("WAWebUsyncFeature").featureParser,devices:d("WAWebUsyncDevice").deviceParser,contact:d("WAWebUsyncContact").contactParser,picture:d("WAWebUsyncPicture").pictureParser,status:d("WAWebUsyncStatus").statusParser,business:d("WAWebUsyncBusiness").businessParser,disappearing_mode:d("WAWebUsyncDisappearingMode").disappearingModeParser,lid:d("WAWebUsyncLid").lidParser,bot:d("WAWebUsyncBotProfile").botProfileParser,username:d("WAWebUsyncUsername").usernameParser,text_status:d("WAWebUsyncTextStatus").textStatusParser};function n(a){var b=[];a.forEachChildWithTag("user",function(a){var c={},e=a.maybeChild(l.CONTACT);if(!a.hasAttr("jid")&&e==null)return;Object.keys(l).forEach(function(b){b=l[b];var d=a.maybeChild(b);d&&m[b]&&(c[b]=m[b](d))});a.hasAttr("jid")&&(c.id=d("WAWebJidToWid").deviceJidToUserWid(a.attrDeviceJid("jid")));a.hasAttr("pn_jid")&&(c.pn=d("WAWebJidToWid").deviceJidToUserWid(a.attrDeviceJid("pn_jid")));b.push(c)});return b}var o=new(c("WADeprecatedWapParser"))("usyncParser",function(a){a.assertAttr("type","result");var b={error:{},refresh:{},list:[]};a=a.child("usync");var c=a.child("result");a=a.child("list");Object.keys(l).forEach(function(a){a=l[a];var d=c.maybeChild(a);if(d){var e=d.maybeChild("error");e?b.error[a]={errorCode:e.attrInt("code"),errorText:e.attrString("text"),errorBackoff:e.attrInt("backoff")}:d.hasAttr("refresh")&&(b.refresh[a]=d.attrInt("refresh",0))}});b.list=n(a);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["usync query success!"])));return b});e=function(){function a(){this.context="interactive",this.mode="query",this.protocols=[],this.users=[],this.$1=!1}var e=a.prototype;e.withMode=function(a){this.mode=a;return this};e.withContext=function(a){this.context=a;return this};e.withContactProtocol=function(a){this.protocols.push(new(d("WAWebUsyncContact").USyncContactProtocol)(a));return this};e.withBusinessProtocol=function(){this.protocols.push(new(d("WAWebUsyncBusiness").USyncBusinessProtocol)());return this};e.withDeviceProtocol=function(){this.protocols.push(new(d("WAWebUsyncDevice").USyncDeviceProtocol)());return this};e.withDisappearingModeProtocol=function(){this.protocols.push(new(d("WAWebUsyncDisappearingMode").USyncDisappearingModeProtocol)());return this};e.withPictureProtocol=function(){this.protocols.push(new(d("WAWebUsyncPicture").USyncPictureProtocol)());return this};e.withStatusProtocol=function(){this.protocols.push(new(d("WAWebUsyncStatus").USyncStatusProtocol)());return this};e.withTextStatusProtocol=function(){this.protocols.push(new(d("WAWebUsyncTextStatus").USyncTextStatusProtocol)());return this};e.withFeaturesProtocol=function(a){this.protocols.push(new(d("WAWebUsyncFeature").USyncFeaturesProtocol)(a));return this};e.withLidProtocol=function(){this.$1||(this.protocols.push(new(d("WAWebUsyncLid").USyncLidProtocol)()),this.$1=!0);return this};e.withBotProfileProtocol=function(){this.protocols.push(new(d("WAWebUsyncBotProfile").USyncBotProfileProtocol)());return this};e.withUser=function(a,b){b===void 0&&(b=!1);var c=a.getId();b&&this.$1&&c!=null&&(c.isLid()?a.withLid(c):c.isRegularUserPn()&&this.$2(a,c));this.users.push(a);return this};e.$2=function(a,b){b=d("WAWebApiContact").getCurrentLid(b);b!=null&&a.withLid(b)};e.withUsernameProtocol=function(){this.protocols.push(new(d("WAWebUsyncUsername").USyncUsernameProtocol)());return this};e.$3=function(){var a=this;if(this.protocols.length===0)throw c("err")("a usync query must have at least one protocol");var b=this.users.filter(function(a){var b=a.getId();return b&&c("WAWebWid").isServer(b)?!1:a.validate()});b.length===0&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Usync warning: a usync query must have at least one user"])));var e=d("WAWap").wap("query",null,this.protocols.map(function(a){return a.getQueryElement()}));b=b.map(function(b){var c=b.getId();return d("WAWap").wap("user",{jid:c?d("WAWebCommsWapMd").USER_JID(c):d("WAWap").DROP_ATTR},a.protocols.map(function(a){return a.getUserElement(b)}))});b=d("WAWap").wap("list",null,b);return d("WAWap").wap("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"usync",type:"get",id:d("WAWap").generateId()},d("WAWap").wap("usync",{sid:d("WAWap").generateId(),index:"0",last:"true",mode:d("WAWap").CUSTOM_STRING(this.mode),context:d("WAWap").CUSTOM_STRING(this.context)},e,b))};e.execute=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.$3();d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["usync: ready to query for ",""])),this.protocols.map(function(a){return a.getName()}));yield d("WAWebUsyncBackoff").waitForBackoff(this);a=(yield d("WADeprecatedSendIq").deprecatedSendIq(a,o));if(a.success){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Usync success:"]))).devConsole(a.result);p(a.result);return a.result}return{error:{all:{errorCode:a.errorCode,errorText:a.errorText,errorType:a.errorType}},refresh:{},list:[]}});function c(){return a.apply(this,arguments)}return c}();return a}();function p(a){Object.keys(l).forEach(function(b){b=l[b];var c=a.error[b];if(c==null)return;c.errorBackoff!=null&&d("WAWebUsyncBackoff").setProtocolBackoffMs(b,c.errorBackoff*1e3)})}g.USYNC_ADDRESSING_MODE=a;g.USyncQuery=e}),98);
__d("WAWebUsyncContact",["WAWap","WAWebCommsWapMd","WAWebUsync"],(function(a,b,c,d,e,f,g){function a(a){a.assertTag("contact");var b=a.maybeChild("error");if(b)return{errorCode:b.attrInt("code"),errorText:b.attrString("text")};b={type:a.attrString("type")};var c=a.hasAttr("username");c&&(b.username=a.attrString("username"));a.hasContent()&&(b.content=a.contentString());return b}b=function(){function a(a){this.addressingMode=a}var b=a.prototype;b.getName=function(){return"contact"};b.getQueryElement=function(){return d("WAWap").wap("contact",{addressing_mode:this.addressingMode===d("WAWebUsync").USYNC_ADDRESSING_MODE.LID?d("WAWap").CUSTOM_STRING(d("WAWebUsync").USYNC_ADDRESSING_MODE.LID):d("WAWap").DROP_ATTR})};b.getUserElement=function(a){var b=a.getPhone(),c=a.getUsername(),e=a.getType(),f=a.getPin();a=a.getLid();if(b!=null)return d("WAWap").wap("contact",null,b);else if(c!=null)return d("WAWap").wap("contact",{username:d("WAWap").CUSTOM_STRING(c),pin:f!=null?d("WAWap").CUSTOM_STRING(f):d("WAWap").DROP_ATTR,lid:a!=null?d("WAWebCommsWapMd").USER_JID(a):d("WAWap").DROP_ATTR});else if(e!=null)return d("WAWap").wap("contact",{type:d("WAWap").CUSTOM_STRING(e)});return null};return a}();g.contactParser=a;g.USyncContactProtocol=b}),98);
__d("WAWebUsyncUser",["WALogger","WAWebBizCoexGatingUtils","WAWebNonEmptyString","WAWebWidValidator","err"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var b=a.prototype;b.withId=function(a){this.$1=a;return this};b.withLid=function(a){this.$2=a;return this};b.withDeviceHash=function(a){this.$4=d("WAWebNonEmptyString").asMaybeNonEmptyString(a);return this};b.withTs=function(a){this.$5=a;return this};b.withExpectedTs=function(a){this.$6=a;return this};b.withPhone=function(a){this.$3=a;return this};b.withPersonaId=function(a){this.$7=a;return this};b.withUsername=function(a){this.$8=a;return this};b.withUsernameKey=function(a){this.$9=a;return this};b.withType=function(a){this.$10=a;return this};b.withTcToken=function(a){this.$11=a;return this};b.getDeviceHash=function(){return this.$4};b.getPhone=function(){return this.$3};b.getId=function(){return this.$1};b.getLid=function(){return this.$2};b.getTs=function(){return this.$5};b.getExpectedTs=function(){return this.$6};b.getPersonaId=function(){return this.$7};b.getUsername=function(){return this.$8};b.getPin=function(){return this.$9};b.getType=function(){return this.$10};b.getTcToken=function(){return this.$11};b.validate=function(){if(this.$1==null&&this.$3==null&&this.$8==null)throw c("err")("user must have an id, phone or a username");else if(this.$1){var a=d("WAWebWidValidator").validateWid(this.$1.toString(),d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled());if(!a){var b;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["USync user created with invalid jid: ",""])),(b=this.$1)==null?void 0:b.toString())}return a}return!0};return a}();g.USyncUser=a}),98);
__d("WAWebQueryExistsJob",["WALogger","WAPhoneFindCC","WAWebABProps","WAWebApiContact","WAWebBackendErrors","WAWebDBCreateLidPnMappings","WAWebHandleUsernameSync","WAWebMexUsersGetUsername","WAWebSetUsernameJob","WAWebUsernameGatingUtils","WAWebUsernameTypes","WAWebUsync","WAWebUsyncUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function a(a){return a.isLid()?l({type:"lid",wid:a}):l({type:"phone",phone:"+"+a.toString()})}function e(a){return l({type:"phone",phone:a})}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebUsernameGatingUtils").usernameContactUsyncLidBased(),e=new(d("WAWebUsyncUser").USyncUser)(),f=new(d("WAWebUsync").USyncQuery)();a.type==="phone"?(f.withContactProtocol(b?d("WAWebUsync").USYNC_ADDRESSING_MODE.LID:d("WAWebUsync").USYNC_ADDRESSING_MODE.PN),e.withPhone(a.phone)):e.withId(a.wid);if(!b){f.withLidProtocol();if(a.type==="phone"){b=d("WAPhoneFindCC").extractDigits(a.phone)+"@c.us";if(c("WAWebWid").isWid(b)){b=d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").createUserWidOrThrow(b));b&&e.withLid(b)}}}f.withUser(e);f.withBusinessProtocol();f.withDisappearingModeProtocol();d("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&f.withUsernameProtocol();b=(yield f.execute());e=b.error.all||b.error.contact;if(e)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(e.errorCode,e.errorText);f=b.list;if(f.length!==1)return null;e=f[0];f=e.id;var g=e.contact,h=e.business,i=e.disappearing_mode,j=e.lid,k=e.pn;e=e.username;if(a.type==="phone"&&(g==null?void 0:g.type)!=="in")return null;a={wid:f,biz:h!=null,bizInfo:h};d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()&&e!=null&&(a.username=e);i&&(a.disappearingMode={duration:i.duration,settingTimestamp:i.t});g=null;h=null;f.isLid()?(g=k,h=f):(g=f,j!=null&&(h=d("WAWebWidFactory").createUserWidOrThrow(j,"lid")));g!=null&&h!=null&&(yield d("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:[{pn:g,lid:h}],flushImmediately:!0,learningSource:"usync"}));d("WAWebUsernameGatingUtils").usernameUsyncEnabled()&&(yield d("WAWebHandleUsernameSync").handleUsernameSync(b));return a});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying contact: "," for username info"])),a).devConsole({wid:a});var b=new(d("WAWebUsyncUser").USyncUser)(),c=new(d("WAWebUsync").USyncQuery)();b.withId(a);c.withUser(b);c.withUsernameProtocol();a=(yield c.execute());b=a.error.all||a.error.contact;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[usync] username info response"]))).devConsole({res:a,error:b});if(b)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(b.errorCode,b.errorText);c=a.list;if(c.length!==1)return null;b=c[0];if(b.id!=null)return{id:b.id,username:b.username,shouldDelete:!Object.prototype.hasOwnProperty.call(b,"username")}});return o.apply(this,arguments)}function f(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isLid())return;var b,c,e;if(d("WAWebABProps").getABPropConfigValue("mex_usync_username_query")){var f=d("WAWebWidFactory").createUserWidOrThrow(a.toString()),g=(yield d("WAWebMexUsersGetUsername").getMexUserUsername(f));c=f;g!=null?b=g:e=!0}else{f=(yield n(a));f!=null&&(b=f.username,c=f.id,e=f.shouldDelete)}if(c==null)return;g=!1;var h;if(b!=null){a=(yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:c,username:b}]));f=a.get(c.toString());g=(f==null?void 0:f.wasUpdated)===!0;h=f==null?void 0:f.oldUsername}else if(e===!0){a=(yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:c,deleteUsername:!0}]));f=a.get(c.toString());g=(f==null?void 0:f.wasUpdated)===!0;h=f==null?void 0:f.oldUsername}return{username:b,wasUpdated:g,oldUsername:h}});return p.apply(this,arguments)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.length<d("WAWebUsernameTypes").USERNAME_MIN_LENGTH||a.length>d("WAWebUsernameTypes").USERNAME_MAX_LENGTH)return null;d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[usync] querying username: "," for contact info"])),a).devConsole({queryUsername:a});var c=d("WAWebUsernameGatingUtils").usernameContactUsyncLidBased(),e=new(d("WAWebUsyncUser").USyncUser)(),f=new(d("WAWebUsync").USyncQuery)();f.withUser(e);f.withContactProtocol(c?d("WAWebUsync").USYNC_ADDRESSING_MODE.LID:d("WAWebUsync").USYNC_ADDRESSING_MODE.PN);f.withBusinessProtocol();e.withUsername(a);b!=null&&e.withUsernameKey(b);c=(yield f.execute());a=c.error.all||c.error.contact;d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[usync] username info response"]))).devConsole({res:c,error:a});if(a)throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText);e=c.list;if(e.length!==1)return null;b=e[0];f=b.id;a=b.contact;c=b.business;e=a.username;b=a.type;if(b==="out")return null;if(f!=null){if(e!=null){a=(yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:f,username:e}]));b=a.get(f.toString());e=(b==null?void 0:b.wasUpdated)===!0}else{a=(yield d("WAWebSetUsernameJob").setUsernamesJob([{userId:f,deleteUsername:!0}]));b=a.get(f.toString());e=(b==null?void 0:b.wasUpdated)===!0}return{wid:f,biz:c!=null,bizInfo:c,wasUpdated:e}}return{keyRequired:!0}});return r.apply(this,arguments)}g.queryWidExists=a;g.queryPhoneExists=e;g.queryExist=l;g.queryWidUsernameExists=f;g.queryUsernameExists=q}),98);
__d("WAWebSetUsernameJob",["WAJobOrchestratorTypes","WALogger","WAPromiseQueue","WAWebApiContact","WAWebApiContactUsernameFields","WAWebBackendApi","WAWebMexSetUsernameJob","WAWebOrchestratorNonPersistedJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=new(d("WAPromiseQueue").PromiseQueue)();function a(a){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setUsernameQueryJob",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("WAWebMexSetUsernameJob").mexSetUsernameQueryJob(a));if(b){b=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();yield l([a!=null?{userId:b,username:a}:{userId:b,deleteUsername:!0}]);return!0}return!1}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(a){var b=a.userId,c=a.username;a=a.usernameCountryCode;if(b==null)return null;if(c!=null&&a!=null)return{userId:b,username:c,usernameCountryCode:a};else if(c!=null)return{userId:b,username:c};else if(a!=null)return{userId:b,usernameCountryCode:a};return null}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=new Map(),e=a.map(function(a){a=a.userId;return a});e=(yield d("WAWebApiContactUsernameFields").bulkGetContactToUsernameInfoMap(e));for(a of a){var f=a.userId,g=a.username,i=a.usernameCountryCode,j=e.get(f.toJid()),k=!f.isLid()||d("WAWebApiContact").getPhoneNumber(f),l=g!=null&&((j==null?void 0:j.username)!==g||(j==null?void 0:j.usernameSoftDeleted)===!0)||a.deleteUsername===!0&&(k&&(j==null?void 0:j.username)!=null||!k&&(j==null?void 0:j.username)!==g),m=i!=null&&(j==null?void 0:j.usernameCountryCode)!==i;m=l||m;var n={wasUpdated:Boolean(m)};if(m&&l){n.oldUsername=(l=j==null?void 0:j.username)!=null?l:void 0}c.set(f.toString(),n);if(!m)continue;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[username] ",": updating "," username with ","\n       countryCode in db + collection"])),f.toLogString(),g==null||g===""?"empty":"non-empty",i==null?"empty":"non-empty");j=f.toJid();l={id:j};g!=null?l.username=g:a.deleteUsername===!0&&(k==null?l.usernameSoftDeleted=!0:l.username=void 0,a.displayNameLID!=null&&(l.displayNameLID=a.displayNameLID));i!=null&&(l.usernameCountryCode=i);b.push(l)}if(b.length===0)return c;yield d("WAWebApiContactUsernameFields").bulkUpdateUsernamesInDb(b);yield d("WAWebBackendApi").frontendSendAndReceive("bulkUpdateUsernames",{usernameUpdates:b});return c});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return i.enqueue(function(){return j(a)})});return m.apply(this,arguments)}function e(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return l(a.map(function(a){var b=a.userId;a=a.displayNameLID;return{userId:b,displayNameLID:a,deleteUsername:!0}}))});return n.apply(this,arguments)}g.setUsernameQueryJob=a;g.maybeCreateSetUsernameInfoJobArg=c;g.setUsernamesJob=l;g.deleteUsernamesJob=e}),98);
__d("WAWebSyncDeviceAdvDeviceListJob",["WAJobOrchestratorTypes","WAWebAdvSyncDeviceListApi","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(a,b,c){a={wids:a,context:b,phash:c};return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncDeviceList",function(a){return d("WAWebAdvSyncDeviceListApi").syncDeviceList(a)}).waitUntilCompleted(a)}function b(){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("syncMyDeviceList",function(a){return d("WAWebAdvSyncDeviceListApi").syncMyDeviceList()},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.SKIP}).waitUntilCompleted()}g.syncDeviceListJob=a;g.syncMyDeviceListJob=b}),98);
__d("WAWebBackendJobs.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Skmsg:"skmsg",Pkmsg:"pkmsg",Msg:"msg",Msmsg:"msmsg"});c=b("$InternalEnum")({Image:"image",Video:"video",Ptv:"ptv",Audio:"audio",Ptt:"ptt",Location:"location",VCard:"vcard",Document:"document",Url:"url",Call:"call",Gif:"gif",Future:"future",ContactArray:"contact_array",LiveLocation:"livelocation",ProfilePic:"profile_pic",Sticker:"sticker",StickerPack:"sticker_pack",Hsm:"hsm",ProductImage:"product_image",Template:"template",MdAppState:"md_app_state",MdHistorySync:"md_history_sync",List:"list",ListResponse:"list_response",Button:"button",ButtonResponse:"button_response",Order:"order",Product:"product",NativeFlowResponse:"native_flow_response"});d=b("$InternalEnum")({Hide:"hide",Show:"show"});f.CiphertextType=a;f.EncMediaType=c;f.DecryptFailType=d}),66);
__d("WAWebSignalCommonErrors",["WACustomError"],(function(a,b,c,d,e,f,g){a=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("SignalDecryptionError"));b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("SignalMessageCounterError"));g.SignalDecryptionError=a;g.SignalMessageCounterError=b}),98);
__d("WAWebVerifyProtobufMsgObjectKeys",["$InternalEnum","WALogger","WAWebCurrentUser","WAWebHandleMsgError","WAWebMsgType","WAWebProtobufsE2E.pb","err"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum")({Buttons:1,Template:2,SenderKeyDistribution:3,UnknownMessageKey:4});function j(a,b){switch(a){case"$$unknownFieldCount":return b[a]===0?null:d("WAWebMsgType").MSG_TYPE.UNKNOWN;case"messageContextInfo":return null;case"contactMessage":return d("WAWebMsgType").MSG_TYPE.VCARD;case"contactsArrayMessage":return d("WAWebMsgType").MSG_TYPE.MULTI_VCARD;case"conversation":case"extendedTextMessage":return d("WAWebMsgType").MSG_TYPE.CHAT;case"imageMessage":return d("WAWebMsgType").MSG_TYPE.IMAGE;case"locationMessage":case"liveLocationMessage":return d("WAWebMsgType").MSG_TYPE.LOCATION;case"documentMessage":return d("WAWebMsgType").MSG_TYPE.DOCUMENT;case"audioMessage":return d("WAWebMsgType").MSG_TYPE.AUDIO;case"videoMessage":return d("WAWebMsgType").MSG_TYPE.VIDEO;case"protocolMessage":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;case"highlyStructuredMessage":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;case"statusNotificationMessage":return d("WAWebMsgType").MSG_TYPE.STATUS_NOTIFICATION;case"sendPaymentMessage":case"requestPaymentMessage":case"paymentInviteMessage":return d("WAWebMsgType").MSG_TYPE.PAYMENT;case"declinePaymentRequestMessage":case"cancelPaymentRequestMessage":return d("WAWebMsgType").MSG_TYPE.UNKNOWN;case"stickerMessage":return d("WAWebMsgType").MSG_TYPE.STICKER;case"groupInviteMessage":return d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE;case"templateButtonReplyMessage":return d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY;case"productMessage":return d("WAWebMsgType").MSG_TYPE.PRODUCT;case"listMessage":return d("WAWebMsgType").MSG_TYPE.LIST;case"orderMessage":return d("WAWebMsgType").MSG_TYPE.ORDER;case"listResponseMessage":return d("WAWebMsgType").MSG_TYPE.LIST_RESPONSE;case"buttonsResponseMessage":return d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE;case"interactiveMessage":return d("WAWebMsgType").MSG_TYPE.INTERACTIVE;case"interactiveResponseMessage":return d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE;case"reactionMessage":return d("WAWebMsgType").MSG_TYPE.REACTION;case"encReactionMessage":return d("WAWebMsgType").MSG_TYPE.REACTION_ENC;case"encCommentMessage":return d("WAWebMsgType").MSG_TYPE.COMMENT;case"pinInChatMessage":return d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE;case"pollCreationMessage":case"pollCreationMessageV2":case"pollCreationMessageV3":case"pollCreationMessageV5":return d("WAWebMsgType").MSG_TYPE.POLL_CREATION;case"pollUpdateMessage":return d("WAWebMsgType").MSG_TYPE.POLL_UPDATE;case"keepInChatMessage":return d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT;case"requestPhoneNumberMessage":return d("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER;case"ptvMessage":return d("WAWebMsgType").MSG_TYPE.PTV;case"callLogMesssage":return d("WAWebMsgType").MSG_TYPE.CALL_LOG;case"buttonsMessage":return i.Buttons;case"templateMessage":return i.Template;case"senderKeyDistributionMessage":case"fastRatchetKeySenderKeyDistributionMessage":return i.SenderKeyDistribution;case"newsletterAdminInviteMessage":return d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE;case"newsletterFollowerInviteMessageV2":return d("WAWebMsgType").MSG_TYPE.NEWSLETTER_FOLLOWER_INVITE;case"eventMessage":return d("WAWebMsgType").MSG_TYPE.EVENT_CREATION;case"encEventResponseMessage":return d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE;case"secretEncryptedMessage":return((b=b[a])==null?void 0:b.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT?d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED:i.UnknownMessageKey;case"albumMessage":return d("WAWebMsgType").MSG_TYPE.ALBUM;case"stickerPackMessage":return d("WAWebMsgType").MSG_TYPE.STICKER_PACK;case"pollResultSnapshotMessage":return d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT;case"richResponseMessage":return d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE;case"messageHistoryBundle":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;case"messageHistoryNotice":return d("WAWebMsgType").MSG_TYPE.PROTOCOL;default:a;return i.UnknownMessageKey}}function k(a){if(a!=null&&typeof a==="object"&&"message"in a){a=a.message;if(a!=null&&typeof a==="object")return a}return null}function a(a){n(a);var b;for(var c of Object.keys(a)){var d=k(a[c]);if(d!=null){var e=l(d);for(e of e){var f=e[0];e[1];typeof f!=="number"&&(b=d)}}else{f=j(c,a);f!=null&&(b=a)}if(b!=null)break}return b}function l(a){var b=[];for(var c of Object.keys(a)){var e=k(a[c]);if(e!=null){var f=l(e);f.length===0?b.push([d("WAWebMsgType").MSG_TYPE.UNKNOWN,c]):b.push.apply(b,l(e))}else{f=j(c,a);f!=null&&b.push([f,c])}}return b}function m(a){return Boolean(a.find(function(a){a=a[0];return typeof a==="number"&&a===i.SenderKeyDistribution}))}function n(a){a=l(a);var b=a.length===1||a.length===2&&m(a);if(!b){d("WAWebCurrentUser").isEmployee()&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Protobuf message keys validation failed: ",""])),a.join()).sendLogs("protobuf-msg-keys-validation-failed-intern");throw new(d("WAWebHandleMsgError").MessageProtobufInvalidMessageTypes)(a.map(function(a){a[0];a=a[1];return a}))}}function o(a){var b=new Set();for(a of l(a)){var d=a[0];a[1];if(typeof d!=="number")b.add(d);else if(i.cast(d)!=null&&(d===i.Buttons||d===i.Template))throw c("err")("Undeclared message types")}return b}function e(a,b){return o(a).has(b)}g.UndeclaredMessageType=i;g.getUnwrappedProtobufMessage=a;g.getProtobufMessageTypesToKeys=l;g.verifyProtobufMessageObjectKeys=n;g.getProtobufMessageTypesSet=o;g.isProtobufHasMessageType=e}),98);
__d("WAWebWamEnumE2eCiphertextType",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE:0,PREKEY_MESSAGE:1,SENDER_KEY_MESSAGE:2,MESSAGE_SECRET_MESSAGE:3});f.E2E_CIPHERTEXT_TYPE=a}),66);
__d("WAWebWamEnumE2eDestination",[],(function(a,b,c,d,e,f){a=Object.freeze({INDIVIDUAL:0,GROUP:1,LIST:2,STATUS:3,CHANNEL:4,INTEROP:5});f.E2E_DESTINATION=a}),66);
__d("WAWebBackendJobsCommon",["WAJobOrchestratorTypes","WALogger","WAWap","WAWebAck","WAWebBackendJobs.flow","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebSendMsgCommonApi","WAWebSignalCommonErrors","WAWebVerifyProtobufMsgObjectKeys","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumPlaceholderReasonType","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j=2;function a(a){switch(a){case d("WAWebBackendJobs.flow").CiphertextType.Skmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.SENDER_KEY_MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Pkmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.PREKEY_MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Msg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.MESSAGE;case d("WAWebBackendJobs.flow").CiphertextType.Msmsg:return d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE.MESSAGE_SECRET_MESSAGE}}function b(a){var b=a.encMediaType,c=a.msgType;a=a.msgPollType;if(c===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction)return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;else if(c===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.medianotify)return d("WAWebWamEnumMediaType").MEDIA_TYPE.MEDIA_EXPRESS_NOTIFY;else if(a===d("WAWebHandleMsgCommon").POLL_TYPES.creation)return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;else if(a===d("WAWebHandleMsgCommon").POLL_TYPES.vote)return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;else if(b)switch(b){case d("WAWebBackendJobs.flow").EncMediaType.Image:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case d("WAWebBackendJobs.flow").EncMediaType.Video:return d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case d("WAWebBackendJobs.flow").EncMediaType.Ptv:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case d("WAWebBackendJobs.flow").EncMediaType.Audio:return d("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case d("WAWebBackendJobs.flow").EncMediaType.Ptt:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case d("WAWebBackendJobs.flow").EncMediaType.Location:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LOCATION;case d("WAWebBackendJobs.flow").EncMediaType.VCard:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case d("WAWebBackendJobs.flow").EncMediaType.Document:return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case d("WAWebBackendJobs.flow").EncMediaType.Url:return d("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case d("WAWebBackendJobs.flow").EncMediaType.Call:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CALL;case d("WAWebBackendJobs.flow").EncMediaType.Gif:return d("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case d("WAWebBackendJobs.flow").EncMediaType.Future:return d("WAWebWamEnumMediaType").MEDIA_TYPE.FUTURE;case d("WAWebBackendJobs.flow").EncMediaType.ContactArray:return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT_ARRAY;case d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIVE_LOCATION;case d("WAWebBackendJobs.flow").EncMediaType.ProfilePic:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PROFILE_PIC;case d("WAWebBackendJobs.flow").EncMediaType.Sticker:return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case d("WAWebBackendJobs.flow").EncMediaType.StickerPack:return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case d("WAWebBackendJobs.flow").EncMediaType.Hsm:return d("WAWebWamEnumMediaType").MEDIA_TYPE.HSM;case d("WAWebBackendJobs.flow").EncMediaType.ProductImage:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebBackendJobs.flow").EncMediaType.Template:return d("WAWebWamEnumMediaType").MEDIA_TYPE.TEMPLATE;case d("WAWebBackendJobs.flow").EncMediaType.MdAppState:return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_APP_STATE;case d("WAWebBackendJobs.flow").EncMediaType.MdHistorySync:return d("WAWebWamEnumMediaType").MEDIA_TYPE.MD_HISTORY_SYNC;case d("WAWebBackendJobs.flow").EncMediaType.List:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST;case d("WAWebBackendJobs.flow").EncMediaType.ListResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST_REPLY;case d("WAWebBackendJobs.flow").EncMediaType.Button:return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_MESSAGE;case d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case d("WAWebBackendJobs.flow").EncMediaType.Order:return d("WAWebWamEnumMediaType").MEDIA_TYPE.ORDER;case d("WAWebBackendJobs.flow").EncMediaType.Product:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_RESPONSE_NFM}return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}function k(a){if(a.deviceSentMessage){var b=a.deviceSentMessage.message;return b?k(b):null}else if(a.ephemeralMessage){b=a.ephemeralMessage.message;return b?k(b):null}else if(a.groupMentionedMessage){b=a.groupMentionedMessage.message;return b?k(b):null}else if(a.viewOnceMessageV2Extension){b=a.viewOnceMessageV2Extension.message;return b?k(b):null}else if(a.viewOnceMessage){b=a.viewOnceMessage.message;return b?k(b):null}else if(a.documentWithCaptionMessage){b=a.documentWithCaptionMessage.message;return b?k(b):null}else if(a.botInvokeMessage){b=a.botInvokeMessage.message;return b?k(b):null}else if(a.associatedChildMessage){b=a.associatedChildMessage.message;return b?k(b):null}else if(a.pollCreationOptionImageMessage){b=a.pollCreationOptionImageMessage.message;return b?k(b):null}else if(a.imageMessage)return d("WAWebBackendJobs.flow").EncMediaType.Image;else if(a.stickerMessage)return d("WAWebBackendJobs.flow").EncMediaType.Sticker;else if(a.stickerPackMessage)return d("WAWebBackendJobs.flow").EncMediaType.StickerPack;else if(a.lottieStickerMessage)return d("WAWebBackendJobs.flow").EncMediaType.Sticker;else if(a.locationMessage)return a.locationMessage.isLive===!0?d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:d("WAWebBackendJobs.flow").EncMediaType.Location;else if(a.contactMessage)return d("WAWebBackendJobs.flow").EncMediaType.VCard;else if(a.contactsArrayMessage)return d("WAWebBackendJobs.flow").EncMediaType.ContactArray;else if(a.documentMessage)return d("WAWebBackendJobs.flow").EncMediaType.Document;else if(a.audioMessage)return a.audioMessage.ptt===!0?d("WAWebBackendJobs.flow").EncMediaType.Ptt:d("WAWebBackendJobs.flow").EncMediaType.Audio;else if(a.videoMessage)return a.videoMessage.gifPlayback===!0?d("WAWebBackendJobs.flow").EncMediaType.Gif:d("WAWebBackendJobs.flow").EncMediaType.Video;else if(a.ptvMessage)return d("WAWebBackendJobs.flow").EncMediaType.Ptv;else if(a.buttonsMessage)return d("WAWebBackendJobs.flow").EncMediaType.Button;else if(a.buttonsResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse;else if(a.listMessage)return d("WAWebBackendJobs.flow").EncMediaType.List;else if(a.listResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.ListResponse;else if(a.orderMessage)return d("WAWebBackendJobs.flow").EncMediaType.Order;else if(a.productMessage)return d("WAWebBackendJobs.flow").EncMediaType.Product;else if(a.groupInviteMessage)return d("WAWebBackendJobs.flow").EncMediaType.Url;else if(a.interactiveResponseMessage)return d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse;else if(((b=a.extendedTextMessage)==null?void 0:b.matchedText)!=null&&a.extendedTextMessage.matchedText.trim()!=="")return d("WAWebBackendJobs.flow").EncMediaType.Url;else if(a.questionMessage){b=a.questionMessage.message;return b?k(b):null}else if(a.questionReplyMessage){b=a.questionReplyMessage.message;return b?k(b):null}return null}function e(a){var b=function(){switch(a){case d("WAWebBackendJobs.flow").EncMediaType.Image:return"image";case d("WAWebBackendJobs.flow").EncMediaType.Video:return"video";case d("WAWebBackendJobs.flow").EncMediaType.Ptv:return"ptv";case d("WAWebBackendJobs.flow").EncMediaType.Audio:return"audio";case d("WAWebBackendJobs.flow").EncMediaType.Ptt:return"ptt";case d("WAWebBackendJobs.flow").EncMediaType.VCard:return"vcard";case d("WAWebBackendJobs.flow").EncMediaType.Document:return"document";case d("WAWebBackendJobs.flow").EncMediaType.Gif:return"gif";case d("WAWebBackendJobs.flow").EncMediaType.ContactArray:return"contact_array";case d("WAWebBackendJobs.flow").EncMediaType.Location:return"location";case d("WAWebBackendJobs.flow").EncMediaType.LiveLocation:return"livelocation";case d("WAWebBackendJobs.flow").EncMediaType.Sticker:return"sticker";case d("WAWebBackendJobs.flow").EncMediaType.List:return"list";case d("WAWebBackendJobs.flow").EncMediaType.ListResponse:return"list_response";case d("WAWebBackendJobs.flow").EncMediaType.ButtonResponse:return"buttons_response";case d("WAWebBackendJobs.flow").EncMediaType.Order:return"order";case d("WAWebBackendJobs.flow").EncMediaType.Product:return"product";case d("WAWebBackendJobs.flow").EncMediaType.Url:return"url";case d("WAWebBackendJobs.flow").EncMediaType.NativeFlowResponse:return"native_flow_response";case d("WAWebBackendJobs.flow").EncMediaType.StickerPack:return"sticker_pack";default:return null}};b=b();if(b)return d("WAWap").CUSTOM_STRING(b);throw c("err")("Unsupported type")}function f(a){return function(b){return b==null?d("WAWap").DROP_ATTR:a(b)}}e=f(e);function l(a){switch(a){case d("WAWebBackendJobs.flow").DecryptFailType.Show:return d("WAWap").DROP_ATTR;case d("WAWebBackendJobs.flow").DecryptFailType.Hide:return d("WAWap").CUSTOM_STRING("hide")}}function m(a){if(a.isUser())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.INDIVIDUAL;else if(a.isGroup())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.GROUP;else if(a.isStatus())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.STATUS;else if(a.isBroadcast())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.LIST;else if(a.isNewsletter())return d("WAWebWamEnumE2eDestination").E2E_DESTINATION.CHANNEL}function n(a){if(a instanceof d("WAWebHandleMsgError").UnknownDeviceMessageError)return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.UNKNOWN_COMPANION_NO_PREKEY;if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError){var b=c("gkx")("26258")?.001:.01;switch(a.message){case"errSignalNoSession":case"errLoadSenderKeySession":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_NO_SESSION;case"errSignalInvalidMsg":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_INVALID_MESSAGE;case"errSignalInvalidKey":case"errSignalInvalidOneTimeKey":case"errSignalInvalidSignedPreKey":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_INVALID_KEY;case"errSignalTooManyMessagesInFuture":case"errSignalGrpTooManyMessagesInFuture":return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_FUTURE_MESSAGE;case"errInvalidMacWithDecryptedPlaintext":case"errInvalidMacInvalidCipherKey":case"errInvalidMacInvalidCipherKeyNewChain":var e="MsgPlaceholderBadMac-"+a.message;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getPlaceholderAddReason SignalBadMac reason"]))).sendLogs(e,{sampling:b});return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.SIGNAL_BAD_MAC}e="MsgPlaceholderOther-"+a.message;d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getPlaceholderAddReason Other reason"]))).sendLogs(e,{sampling:b});return d("WAWebWamEnumPlaceholderReasonType").PLACEHOLDER_REASON_TYPE.OTHER}}function o(a){if(a.interactiveResponseMessage){return(a=a.interactiveResponseMessage.nativeFlowResponseMessage)==null?void 0:a.name}return null}f=f(function(a){return d("WAWap").CUSTOM_STRING(a)});function p(a){switch(a){case d("WAWebAck").EDIT_ATTR.SENDER_REVOKE:return d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE;case d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE:return d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE;case d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT:return d("WAWebWamEnumEditType").EDIT_TYPE.EDITED;default:return d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED}}function q(a,b){var c;c=(c=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?c:a;return d("WAWebSendMsgCommonApi").isRevokeMsg(c)?b.subtype==="admin_revoke"?d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE:d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE:d("WAWebSendMsgCommonApi").isEditMsg(c)?d("WAWebWamEnumEditType").EDIT_TYPE.EDITED:d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED}function r(a){return a?d("WAJobOrchestratorTypes").JOB_PRIORITY.OFFLINE:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}g.CIPHERTEXT_VERSION=j;g.getMetricE2eCiphertextType=a;g.getMetricMediaType=b;g.mediaTypeFromProtobuf=k;g.encodeMaybeMediaType=e;g.encodeMaybeDecryptFail=l;g.getMetricE2eDestination=m;g.getPlaceholderAddReason=n;g.nativeFlowNameTypeFromProtobuf=o;g.encodeMaybeNativeFlowName=f;g.getMetricEditType=p;g.getMetricEditTypeFromMsg=q;g.getNonCriticalNotificationPriority=r}),98);
__d("WAWebAddOnsMarkAddOnsAsReadDb",["Promise","WANullthrows","WAWebDBAddOnProviders","WAWebDBMarkAsReadForTable","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).allSettled(Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];b=c("WANullthrows")(d("WAWebDBAddOnProviders").getProviderForAddOnType(b));return b.markAsRead==null?void 0:b.markAsRead(a)})));for(a of a)if(a.status==="rejected")throw a.reason});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map(),e=d("WAWebDBAddOnProviders").addOnProviders.map(function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var d=(yield b.markAsRead==null?void 0:b.markAsRead(a));c.set(b.type,d!=null?d:[])});return function(a){return d.apply(this,arguments)}}()),f=[],g=d("WAWebDBMarkAsReadForTable").markAsReadForTable("message-orphans",a.map(String)).then(function(a){f.push.apply(f,a)});e=(yield (h||(h=b("Promise"))).allSettled([].concat(e,[g])));for(g of e)if(g.status==="rejected")throw g.reason;return{updatedAddOns:c,updatedOrphans:f}});return j.apply(this,arguments)}g.markAddOnsAsReadDb=a;g.markUnclassifiedAddOnsAsReadDb=e}),98);
__d("WAWebApiTasksScheduledTime",["WAWebModelStorageUtils","WAWebSchemaTasksScheduledTime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaTasksScheduledTime").getTasksScheduledTimeTable().get(a).then(function(a){return a==null?void 0:a.time})}function b(a,b){return d("WAWebModelStorageUtils").getStorage().lock(["tasks-scheduled-time"],function(c){c=c[0];var d={taskName:a,time:b};return c.createOrReplace(d)})}g.getTaskScheduledTime=a;g.updateTaskScheduledTime=b}),98);
__d("WAWebLastADVCheckTimeApi",["Promise","WAWebApiTasksScheduledTime"],(function(a,b,c,d,e,f,g){var h,i;function a(){i==null&&(i=d("WAWebApiTasksScheduledTime").getTaskScheduledTime("advDeviceInfoCheck"));return i}function c(a){i=(h||(h=b("Promise"))).resolve(a)}g.getLastADVDeviceInfoCheckTime=a;g.setLastADVDeviceInfoCheckTime=c}),98);
__d("WAWebAdvHandlerApi",["Promise","WALogger","WAWebABProps","WAWebApiDeviceList","WAWebAppTracker","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebCryptoCurve25519","WAWebDeviceListPk","WAWebHandleAdvForMessageApi","WAWebHandleAdvForUsyncApi","WAWebIdentityUpdateDeviceTableApi","WAWebLastADVCheckTimeApi","WAWebProtobufsAdv.pb","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c,d,e,f,g){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,h){g===void 0&&(g=!1);var i=(yield d("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime());return d("WAWebHandleAdvForMessageApi").handleADVDeviceUpdateForMessage(a,b,c,e,f,g,i,h)});return j.apply(this,arguments)}function e(a){var d=a.wid,e=a.devices;a=a.type;return a==null?(i||(i=b("Promise"))).reject(c("err")("handleADVDeviceNotification: notification without type")):k(d,e,a)}function f(a){d("WAWebAppTracker").AppTracker.start(d("WAWebAppTracker").AppTrackerType.ADVProcessing);return m(a)["finally"](function(){d("WAWebAppTracker").AppTracker.stop(d("WAWebAppTracker").AppTrackerType.ADVProcessing)})}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=null;if(c==="add"){var f=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddress(a).toString()));e=f!=null?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(f)):null;if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&b.deviceList!=null){b.deviceList=(f=b.deviceList)==null?void 0:f.filter(function(a){return a.id!==d("WAWebBizCoexUtils").HOSTED_DEVICE_ID})}}f=(yield d("WAWebApiDeviceList").getDeviceRecord(a));var g=(yield d("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime());c=d("WAWebHandleAdvForUsyncApi").handleDeviceNotification(a,c,b,e,f,g);if(c){if(c.clearRecord){var h;yield d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(a,(f==null?void 0:f.devices)||[],!1,f==null?void 0:f.advAccountType,c==null||(h=c.update)==null?void 0:h.advAccountType)}return d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:a,update:c.update,currentRecord:f}])}});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a.forEach(function(a){var b;if((a==null||(b=a.devices)==null?void 0:b.deviceList)==null)return;a.devices.deviceList=(a=a.devices.deviceList)==null?void 0:a.filter(function(a){return a.id!==d("WAWebBizCoexUtils").HOSTED_DEVICE_ID})});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleADVDeviceSyncResultImpl: start to handling "," updates"])),a.length).devConsole(a);var c=a.map(function(a){return a.wid}),e=a.filter(function(a){return(a=a.devices.keyIndex)==null?void 0:a.signedKeyIndexBytes}),f=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(e.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a.wid).toString()}))),g=new Map();e.forEach(function(b,a){a=f[a];a!=null&&g.set(d("WAWebDeviceListPk").createDeviceListPK(b.wid),a)});e=(yield d("WAWebApiDeviceList").bulkGetDeviceRecord(c));c=[];var j=[],k=!1,l=[],m=self.performance.now();for(a of a.entries()){var n=a[0],q=a[1],r=g.get(d("WAWebDeviceListPk").createDeviceListPK(q.wid));r=r!=null?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(r)):null;n=e[n];r=d("WAWebHandleAdvForUsyncApi").handleADVSyncResult(q.wid,q.devices,r,n);d("WAWebABProps").getABPropConfigValue("web_anr_async_adv_processing_enabled")&&(self.performance.now()-m>o&&(yield p(),m=self.performance.now()));if(r==null)continue;r.identityUpdatePromise&&l.push(r.identityUpdatePromise);if(r.clearRecord){var s;c.push({wid:q.wid,currentList:(n==null?void 0:n.devices)||[],currentAdvAccountType:n==null?void 0:n.advAccountType,incomingAdvAccountType:(s=r.update)==null?void 0:s.advAccountType});j.push({wid:q.wid,currentRecord:{id:d("WAWebDeviceListPk").createDeviceListPK(q.wid),deleted:!0},update:r.update})}else{if((r==null?void 0:r.fromHandleOmittedResult)===!0){var t;(n==null?void 0:n.advAccountType)===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(r==null||(t=r.update)==null?void 0:t.advAccountType)===d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE&&(k=!0)}j.push({wid:q.wid,currentRecord:n,update:r.update})}}l.length>0&&(yield (i||(i=b("Promise"))).all(l));yield (i||(i=b("Promise"))).all(c.map(function(a){var b=a.wid,c=a.currentList,e=a.currentAdvAccountType;a=a.incomingAdvAccountType;return d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(b,c,!1,e,a)}));yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate(j,!1,k)});return n.apply(this,arguments)}var o=100;function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield new(i||(i=b("Promise")))(function(a){return self.setTimeout(a,0)})});return q.apply(this,arguments)}g.handleADVDeviceUpdateForMessage=a;g.handleADVDeviceNotification=e;g.handleADVDeviceSyncResult=f}),98);
__d("WAWebSignalConst",[],(function(a,b,c,d,e,f){a={REG_ID:"signal_reg_id",STATIC_PUBKEY:"signal_static_pubkey",STATIC_PRIVKEY:"signal_static_privkey",NEXT_PK_ID:"signal_next_pk_id",LAST_SPK_ID:"signal_last_spk_id",FIRST_UNUPLOAD_PK_ID:"signal_first_unupload_pk_id",SERVER_HAS_KEY:"signal_sever_has_pre_keys",ADV_SIGNED_IDENTITY:"adv_signed_identity"};f.META_KEYS=a}),66);
__d("WAWebSignalStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(a,b,c,d,e,f,g,h){var i,j="signal-storage",k=null;function a(){var a=new(c("WAWebIdb"))(j);k=new(d("WAWebStorage").Storage)(a)}function e(){k!=null||h(0,56356);return k}function f(){return k==null?(i||(i=b("Promise"))).reject(c("err")("[signal-storage] Storage should be created first before being destroyed")):k.purge().then(function(){k=null})["catch"](function(a){k=null;throw a})}g.DATABASE_NAME=j;g.createStorage=a;g.getStorage=e;g.destroyStorage=f}),98);
__d("WAWebSignalStorageVersions",["WAWebSignalStorageUtils"],(function(a,b,c,d,e,f,g){var h=6;function a(){return d("WAWebSignalStorageUtils").getStorage().versions.version(0)}function b(){return d("WAWebSignalStorageUtils").getStorage().versions.version(1)}function c(){return d("WAWebSignalStorageUtils").getStorage().versions.version(2)}function e(){return d("WAWebSignalStorageUtils").getStorage().versions.version(3)}function f(){return d("WAWebSignalStorageUtils").getStorage().versions.version(4)}function i(){return d("WAWebSignalStorageUtils").getStorage().versions.version(5)}function j(){return d("WAWebSignalStorageUtils").getStorage().versions.version(6)}g.versionToRollout=h;g.identityCreateTable=a;g.metaCreateTable=b;g.preKeyCreateTable=c;g.sessionCreateTable=e;g.signedPreKeyCreateTable=f;g.baseKeyCreateTable=i;g.senderKeyCreateTable=j}),98);
__d("WAWebSchemaBasekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey,j=c.addCompositeIndex;function a(){d("WAWebSignalStorageUtils").getStorage().add("baseKey-store").version(d("WAWebSignalStorageVersions").baseKeyCreateTable(),[i("id"),h("address"),h("originalMsgId"),h("baseKey"),j(["address","originalMsgId"])]).view(function(a){return{id:a.id,address:a.address,originalMsgId:a.originalMsgId,baseKey:a.baseKey}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("baseKey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaIdentity",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("identity-store").version(d("WAWebSignalStorageVersions").identityCreateTable(),[i("identifier"),h("identityKey"),h("rowId"),h("sentAddonRowId")]).view(function(a){return{identifier:a.identifier,identityKey:a.identityKey,rowId:a.rowId,sentAddonRowId:a.sentAddonRowId}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("identity-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaMeta",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("signal-meta-store").version(d("WAWebSignalStorageVersions").metaCreateTable(),[i("key"),h("value")]).view(function(a){return{key:a.key,value:a.value}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("signal-meta-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaPrekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("prekey-store").version(d("WAWebSignalStorageVersions").preKeyCreateTable(),[i("keyId"),h("keyPair"),h("isDirectDistribution")]).view(function(a){return{keyId:a.keyId,keyPair:a.keyPair,isDirectDistribution:a.isDirectDistribution}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("prekey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSenderkey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey,j=c.addIndex;function a(){d("WAWebSignalStorageUtils").getStorage().add("senderkey-store").version(d("WAWebSignalStorageVersions").senderKeyCreateTable(),[i("senderKeyName"),h("senderKey"),h("senderId"),j("senderId")]).view(function(a){return{senderKeyName:a.senderKeyName,senderKey:a.senderKey,senderId:a.senderId}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("senderkey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSession",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addUserDefinedPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("session-store").version(d("WAWebSignalStorageVersions").sessionCreateTable(),[i("address"),h("session")]).view(function(a){return{address:a.address,session:a.session}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("session-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSchemaSignedPrekey",["WAWebSignalStorageUtils","WAWebSignalStorageVersions","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebSignalStorageUtils").getStorage().add("signed-prekey-store").version(d("WAWebSignalStorageVersions").signedPreKeyCreateTable(),[i("keyId"),h("keyPair"),h("signature")]).view(function(a){return{keyId:a.keyId,keyPair:a.keyPair,signature:a.signature}})}function b(){return d("WAWebSignalStorageUtils").getStorage().table("signed-prekey-store")}g.addTable=a;g.getTable=b}),98);
__d("WAWebSignalStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebSchemaBasekey","WAWebSchemaIdentity","WAWebSchemaMeta","WAWebSchemaPrekey","WAWebSchemaSenderkey","WAWebSchemaSession","WAWebSchemaSignedPrekey","WAWebSignalStorageUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){i==null&&(yield d("WAWebDbRolloutUtil").loadSchemaVersions(),d("WAWebSignalStorageUtils").createStorage(),d("WAWebSchemaBasekey").addTable(),d("WAWebSchemaIdentity").addTable(),d("WAWebSchemaMeta").addTable(),d("WAWebSchemaPrekey").addTable(),d("WAWebSchemaSenderkey").addTable(),d("WAWebSchemaSession").addTable(),d("WAWebSchemaSignedPrekey").addTable(),i=d("WAWebSignalStorageUtils").getStorage().initialize()["catch"](function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).verbose().devConsole(a).sendLogs("Failed to initialize signal storage",{sendLogsType:d("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD});throw a}));return i});return j.apply(this,arguments)}function e(){return d("WAWebSignalStorageUtils").destroyStorage()["catch"](function(){return d("WAWebDexieCastTypes").dexieCastToPromise(new(c("WAWeb-dexie"))(d("WAWebSignalStorageUtils").DATABASE_NAME)["delete"]())})["finally"](function(){i=null})}g.getBaseKeyTable=d("WAWebSchemaBasekey").getTable;g.getIdentityTable=d("WAWebSchemaIdentity").getTable;g.getMetaTable=d("WAWebSchemaMeta").getTable;g.getPreKeyTable=d("WAWebSchemaPrekey").getTable;g.getSenderKeyTable=d("WAWebSchemaSenderkey").getTable;g.getSessionTable=d("WAWebSchemaSession").getTable;g.getSignedPreKeyTable=d("WAWebSchemaSignedPrekey").getTable;g.initialize=a;g.destroy=e}),98);
__d("WAWebSignalStoreApi",["Promise","WALogger","WAWebNoop","WAWebSignalCommonUtils","WAWebSignalConst","WAWebSignalStorage","WAWebSignalStorageUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j=1;a=function(){function a(){this.idToSignedPreKey=new Map()}var e=a.prototype;e.getMeta=function(a){var b=d("WAWebSignalStorage").getMetaTable();return b.get(a).then(function(a){return a?a.value:null})};e.putMeta=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=d("WAWebSignalStorage").getMetaTable();a=a.map(function(a){return c.createOrReplace(a)});yield (i||(i=b("Promise"))).all(a)});function c(b){return a.apply(this,arguments)}return c}();e.setServerHasPreKeys=function(a){this.putMeta([{key:d("WAWebSignalConst").META_KEYS.SERVER_HAS_KEY,value:a}])};e.getServerHasPreKeys=function(){return this.getMeta(d("WAWebSignalConst").META_KEYS.SERVER_HAS_KEY)};e.putADVSignedIdentity=function(a){return this.putMeta([{key:d("WAWebSignalConst").META_KEYS.ADV_SIGNED_IDENTITY,value:a}])};e.getADVSignedIdentity=function(){return this.getMeta(d("WAWebSignalConst").META_KEYS.ADV_SIGNED_IDENTITY)};e.getPreKeysByRange=function(a,b){var c=d("WAWebSignalStorage").getPreKeyTable();return c.greaterThan(["keyId"],a-1,{limit:b})};e.getPreKeyById=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.get(a)};e.removePreKeyById=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.remove(a)};e.bulkRemovePreKey=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.bulkRemove(a)};e.putPreKeys=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.bulkCreateOrReplace(a)};e.markPreKeyAsDirectDistribution=function(a){var b=d("WAWebSignalStorage").getPreKeyTable();return b.merge(a,{isDirectDistribution:1})};e.getSignedPreKey=function(){var a=this;return this.getMeta(d("WAWebSignalConst").META_KEYS.LAST_SPK_ID).then(function(b){return a.getSignedPreKeyById(b)})};e.getSignedPreKeyById=function(a){var c=this;if(this.idToSignedPreKey.has(a))return(i||(i=b("Promise"))).resolve(this.idToSignedPreKey.get(a));var e=d("WAWebSignalStorage").getSignedPreKeyTable();return e.get(a).then(function(b){c.idToSignedPreKey.set(a,b);return b})};e.putSignedPreKeys=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=d("WAWebSignalStorage").getSignedPreKeyTable();a=a.map(function(a){var b=a.keyId,d=a.keyPair,f=a.signature;return e.get(b).then(function(a){if(a)throw c("err")("signed preKey id "+b+" already exists");else{a={keyId:b,keyPair:d,signature:f};return e.create(a)}})});yield (i||(i=b("Promise"))).all(a)});function e(b){return a.apply(this,arguments)}return e}();e.putSession=function(a,b){var c=d("WAWebSignalStorage").getSessionTable();return c.createOrReplace({address:a,session:b})};e.bulkPutSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkCreateOrReplace(a)};e.removeSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.remove(a)};e.bulkRemoveSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkRemove(a)};e.getSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.get(a).then(function(a){return a?a.session:null})};e.bulkGetSession=function(a){var b=d("WAWebSignalStorage").getSessionTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?a.session:null})})};e.putIdentity=function(a,b){var c=d("WAWebSignalStorage").getIdentityTable();return c.createOrReplace({identifier:a,identityKey:b})};e.bulkPutIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkCreateOrReplace(a)};e.bulkGetIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?a.identityKey:null})})};e.getIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.get(a).then(function(a){return a?a.identityKey:null})};e.removeIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.remove(a)};e.bulkRemoveIdentity=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkRemove(a)};e.getIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.get(a).then(function(a){return a?{identityKey:a.identityKey,rowId:a.rowId,sentAddonRowId:a.sentAddonRowId}:null})};e.bulkGetIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkGet(a).then(function(a){return a.map(function(a){return a?{identityKey:a.identityKey,rowId:a.rowId}:null})})};e.bulkPutIdentityKeyWithRowId=function(a){var b=d("WAWebSignalStorage").getIdentityTable();return b.bulkCreateOrReplace(a)};e.saveBaseKey=function(a,b,c){var e=d("WAWebSignalStorage").getBaseKeyTable();return e.createOrReplace({address:a,originalMsgId:b,baseKey:c})};e.loadBaseKey=function(a,b){var c=d("WAWebSignalStorage").getBaseKeyTable();return c.equals(["address","originalMsgId"],[a,b]).then(function(a){return a&&a.length!==0?a[0].baseKey:null})};e.deleteBaseKey=function(a,b){var c=d("WAWebSignalStorage").getBaseKeyTable();return c.equals(["address","originalMsgId"],[a,b]).then(function(a){if(a&&a.length!==0)return c.remove(a[0].id)})};e.putSenderKey=function(a,b,c){var e=d("WAWebSignalStorage").getSenderKeyTable();return e.createOrReplace({senderKeyName:a,senderId:b,senderKey:c})};e.bulkPutSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.bulkCreateOrReplace(a)};e.removeSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.remove(a)};e.getSenderKey=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.get(a).then(function(a){return a?a.senderKey:null})};e.removeSenderKeyBySenderId=function(a){var b=d("WAWebSignalStorage").getSenderKeyTable();return b.equals(["senderId"],a).then(function(a){return b.bulkRemove(a.map(function(a){return a.senderKeyName}))})};e.clearCredential=function(){var a;a=[(a=d("WAWebSignalStorage")).getIdentityTable(),a.getMetaTable(),a.getPreKeyTable(),a.getSessionTable(),a.getSignedPreKeyTable()];return(i||(i=b("Promise"))).all(a.map(function(a){return a.clear()})).then(c("WAWebNoop"))};e.getRegistrationInfo=function(){var a=this;return this.registrationInfo!=null?(i||(i=b("Promise"))).resolve(this.registrationInfo):(i||(i=b("Promise"))).all([this.getMeta(d("WAWebSignalConst").META_KEYS.REG_ID),this.getMeta(d("WAWebSignalConst").META_KEYS.STATIC_PUBKEY),this.getMeta(d("WAWebSignalConst").META_KEYS.STATIC_PRIVKEY)]).then(function(c){var e=c[0],f=c[1];c=c[2];if(!e||!f||!c)return;return(i||(i=b("Promise"))).all([d("WAWebSignalCommonUtils").decryptRegistrationMaterial(f),d("WAWebSignalCommonUtils").decryptRegistrationMaterial(c)]).then(function(b){var c=b[0];b=b[1];a.registrationInfo={registrationId:e,identityKeyPair:{pubKey:c,privKey:b}};return a.registrationInfo})})};e.setRegistrationInfo=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;yield (i||(i=b("Promise"))).all([d("WAWebSignalCommonUtils").encryptRegistrationMaterial(a.identityKeyPair.pubKey),d("WAWebSignalCommonUtils").encryptRegistrationMaterial(a.identityKeyPair.privKey)]).then(function(e){var f=e[0];e=e[1];return(i||(i=b("Promise"))).all([c.putMeta([{key:d("WAWebSignalConst").META_KEYS.REG_ID,value:a.registrationId},{key:d("WAWebSignalConst").META_KEYS.STATIC_PUBKEY,value:f},{key:d("WAWebSignalConst").META_KEYS.STATIC_PRIVKEY,value:e}])])})});function c(b){return a.apply(this,arguments)}return c}();e.getOrGenPreKeys=function(a,c){var e=this;return d("WAWebSignalStorageUtils").getStorage().lock(["signal-meta-store","prekey-store"],function(){return(i||(i=b("Promise"))).all([e.getMeta(d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID),e.getMeta(d("WAWebSignalConst").META_KEYS.NEXT_PK_ID)]).then(function(f){var g=f[0];f=f[1];var l=g?g:j;g=f?f:j;f=g-l;var m=a-f;if(m<=0){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getPreKeys: no prekey needs to be generated, available: ",", need: ",""])),f,a);return e.getPreKeysByRange(l,a)}f=k(g,g+m).map(function(a){return c(a)});return(i||(i=b("Promise"))).all(f).then(function(a){return e.savePreKeys(a)}).then(function(){return e.getPreKeysByRange(l,a)})})})};e.getOrGenSinglePreKey=function(a){return this.getOrGenPreKeys(1,a).then(function(a){if(a.length!==1)throw c("err")("Expected to get exactly one key but got "+a.length);return a[0]})};e.savePreKeys=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var c=a[a.length-1];yield (i||(i=b("Promise"))).all([this.putMeta([{key:d("WAWebSignalConst").META_KEYS.NEXT_PK_ID,value:c.keyId+1}]),this.putPreKeys(a)])});function c(b){return a.apply(this,arguments)}return c}();e.markKeyAsUploaded=function(a){var e=this;return(i||(i=b("Promise"))).all([this.getMeta(d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID),this.getMeta(d("WAWebSignalConst").META_KEYS.NEXT_PK_ID)]).then(function(b){var f=b[0];b=b[1];if(a<0||!b||a>=b)throw c("err")("markKeyAsUploaded: key "+a+" is out of boundary.");b=f?Math.max(f,a+1):a+1;return e.putMeta([{key:d("WAWebSignalConst").META_KEYS.FIRST_UNUPLOAD_PK_ID,value:b}])})};e.rotateSignedPreKey=function(a,b){var c=this;return d("WAWebSignalStorageUtils").getStorage().lock(["signal-meta-store","signed-prekey-store"],function(){return c.getMeta(d("WAWebSignalConst").META_KEYS.LAST_SPK_ID).then(function(e){var f=e==null?j:e+1;return b(a,f).then(function(a){c.putSignedPreKeys([a]);c.putMeta([{key:d("WAWebSignalConst").META_KEYS.LAST_SPK_ID,value:f}]);return a})})})};return a}();function k(a,b){var c=[];for(a=a;a<b;a++)c.push(a);return c}e=new a();g.waSignalStore=e}),98);
__d("WAWebAdvSignatureApi",["invariant","Promise","WABase64","WABinary","WAByteArray","WALogger","WAWebAdvHandlerApi","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebCryptoCurve25519","WAWebCurrentUser","WAWebProtobufsAdv.pb","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSignalStoreApi","WAWebSignalUtilsApi","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","err"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s;function t(a,b,c,d){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=!1);var f=!1;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(f=a.isHosted());try{var g=d("WAWebWidFactory").asUserWidOrThrow(a);c=d("WAByteArray").uint8ArrayToBuffer(c);var q=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddress(a).toString()));if(q!=null){q=d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(q));if(d("WAWebSignalCommonUtils").bufferEqual(q,c))return!0}q=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,b);q!=null||h(0,56342);b=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadIdentityKey(d("WAWebSignalCommonUtils").createSignalAddress(g).toString()));g=b!=null?d("WAWebCryptoCurve25519").toCurveKeyPubKey(d("WAWebSignalCommonUtils").strToBuffer(b)):null;if(!G(q,c,g)){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: invalid account signature"])));return!1}if(!M(q,c,g,f)){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: invalid device signature"])));return!1}b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVDeviceIdentitySpec,q.details);b!=null||h(0,56341);f=q.accountSignatureKey;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(b.accountType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: add to coex cache for ",""])),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)),f=f&&f.byteLength>0?f:void 0);try{yield d("WAWebAdvHandlerApi").handleADVDeviceUpdateForMessage(a,b,g,f,c,e,b.accountType)}catch(b){if(!d("WAWebCurrentUser").isEmployee())d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: process adv device identity failed: ",""])),b);else{q=a.device;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["advDeviceIdentity failed for deviceId: ",""])),q);d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: process adv device identity failed: ",""])),b).sendLogs("validate-adv-identity-handle-update-for-message-failed")}return!1}d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: successfully verified accountSignature and deviceSignature"])));return!0}catch(a){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["validateADVIdentity: failed"]))).devConsole(a);return!1}});return u.apply(this,arguments)}function a(a,b,c,d){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){e===void 0&&(e=!1);c=c.find(function(a){return a.e2eType===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg});if(!c)return!0;d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["validateADVwithEncs: start validate prekey msg "])));try{a!=null||h(0,56346);c=d("WAWebSignalUtilsApi").extractIdentityKey(c.ciphertext);c!=null||h(0,56345);a=(yield t(a,b,new Uint8Array(c),e));yield d("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode();return a}catch(a){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["validateADVwithEncs: failed ",""])),a);return!1}});return v.apply(this,arguments)}var w=new Uint8Array([6,5]),x=new Uint8Array([6,6]),y=new Uint8Array([6,0]),z=new Uint8Array([6,1]),A=new Uint8Array([6,2]);function e(){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=new Uint8Array(32);self.crypto.getRandomValues(a);a=d("WABase64").encodeB64(a);yield d("WAWebUserPrefsMultiDevice").setADVSecretKey(a);return a});return B.apply(this,arguments)}function f(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebUserPrefsMultiDevice").getADVSecretKey());if(a==null)throw c("err")("secretKey is null or undefined");return a});return C.apply(this,arguments)}function D(a){if(a==null)return(s||(s=b("Promise"))).reject(c("err")("advSignedDeviceIdentity is null or undefined"));return a.deviceSignature==null?(s||(s=b("Promise"))).reject(c("err")("advSignedDeviceIdentity is missing deviceSignature")):d("WAWebSignalStoreApi").waSignalStore.putADVSignedIdentity(a)}function E(){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSignalStoreApi").waSignalStore.getADVSignedIdentity());if(a==null)throw c("err")("advSignedDeviceIdentity is null or undefined");if(a.deviceSignature==null)throw c("err")("advSignedDeviceIdentity is missing deviceSignature");return d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedDeviceIdentitySpec,a).readByteArrayView()});return F.apply(this,arguments)}function G(a,b,c){a=I(a,c);c=a.accountSignatureKey;var d=a.accountSignature;a=a.advDeviceIdentityDetails;return H(a,d,b,c)}function H(a,b,c,e){var f=y;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var g=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVDeviceIdentitySpec,a);g.deviceType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(f=w)}e!=null||h(0,56344);b!=null||h(0,56295);g=d("WABinary").Binary.build(f,a,c).readByteArrayView();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(e),g,new Uint8Array(b))}function I(a,b){var c=a.details,e=a.accountSignatureKey||b;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e=e&&e.byteLength>0?e:b);e!=null||h(0,56344);b=a.accountSignature;b!=null||h(0,56295);c!=null||h(0,70451);return{accountSignatureKey:e,accountSignature:b,advDeviceIdentityDetails:c}}function J(a,b,c){a=a.details;a=d("WABinary").Binary.build(z,a,b.pubKey,c).readByteArrayView().buffer;return d("WAWebCryptoCurve25519").calculateSignature(b,a)}function K(a,b,c,e,f){var g=z;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(c===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g=x));c=d("WABinary").Binary.build(g,a,b,f).readByteArrayView();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(b),c,new Uint8Array(e))}function L(a,b){var c=a.details,e=a.deviceSignature;e!=null||h(0,56343);a=a.accountSignatureKey||b;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a=a&&a.byteLength>0?a:b);a!=null||h(0,56344);c!=null||h(0,70451);return{accountSignatureKey:a,deviceSignature:e,advDeviceIdentityDetails:c}}function M(a,b,c,e){e===void 0&&(e=!1);a=L(a,c);c=a.accountSignatureKey;var f=a.deviceSignature;a=a.advDeviceIdentityDetails;var g=d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e&&(g=d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED));return K(a,b,g,f,c)}function N(){return O.apply(this,arguments)}function O(){O=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsMultiDevice").setADVSecretKey(void 0)});return O.apply(this,arguments)}function P(a,b){var c=a.details;a=a.accountSignature;a!=null||h(0,56295);c=d("WABinary").Binary.build(A,c).readByteArrayView();return d("WAWebCryptoCurve25519").verifySignature(new Uint8Array(b),c,new Uint8Array(a))}g.validateADVwithIdentityKey=t;g.validateADVwithEncs=a;g.ADV_HOSTED_PREFIX_DEVICE_IDENTITY_ACCOUNT_SIGNATURE=w;g.generateADVSecretKey=e;g.getADVSecretKey=f;g.setADVSignedIdentity=D;g.getADVEncodedIdentity=E;g.verifyDeviceIdentityAccountSignature=G;g.generateDeviceSignature=J;g.clearADVSecretKey=N;g.verifyKeyIndexListAccountSignature=P}),98);
__d("WAWebHandleAdvForMessageApi",["invariant","WAJids","WALogger","WAWebApiDeviceList","WAWebCurrentUser","WAWebHandleAdvListResetApi","WAWebHandleAdvNoListResetApi","WAWebSignalCommonUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i;function a(a,b,c,d,e,f,g,h){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e,f,g,j,k){g===void 0&&(g=!1);var l=b.rawId,m=b.timestamp;b=b.keyIndex;l!=null||h(0,56258);m!=null||h(0,56257);b!=null||h(0,56256);m={rawId:l,timestamp:m,keyIndex:b};b=a.device;b!=null&&b!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);b=d("WAWebWidFactory").asUserWidOrThrow(a);b=(yield d("WAWebApiDeviceList").getDeviceRecord(b));c=c==null||e!=null&&!d("WAWebSignalCommonUtils").bufferEqual(c,e);d("WAWebCurrentUser").isEmployee()&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleADVDeviceIdentity: isNewPrimaryIdentity-",""])),c);return!b||b.deleted||b.rawId!==l||c?d("WAWebHandleAdvListResetApi").handleListReset(a,m,c?e:null,f,b,g,j,k):d("WAWebHandleAdvNoListResetApi").handleNoListReset(a,m,f,b,g,j,k)});return j.apply(this,arguments)}g.handleADVDeviceUpdateForMessage=a}),98);
__d("WAWebAdvExpectedTsApi",["WATimeUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c){var d=b==null?void 0:b.timestamp;if(d==null)return{expectedTs:void 0,expectedTsLastDeviceJobTs:void 0,expectedTsUpdateTs:void 0};var e,f,g;b!=null&&!b.deleted&&(e=b.expectedTs,f=b.expectedTsLastDeviceJobTs,g=b.expectedTsUpdateTs);return h(a,d,c,e,f,g)}function h(a,b,c,e,f,g){f={expectedTs:e,expectedTsLastDeviceJobTs:f,expectedTsUpdateTs:g};if(b>=a||e!=null&&e>=a)return f;f.expectedTs=a;f.expectedTsLastDeviceJobTs=c!=null?c:void 0;(e==null||b>=e)&&(f.expectedTsUpdateTs=d("WATimeUtils").unixTimeWithoutClockSkewCorrection());return f}function b(a,b,c,d){if(c==null||c.deleted)return!1;if(c.expectedTs==null)return!1;if(a>=c.expectedTs)return!0;return a<c.expectedTs&&b===c.expectedTs&&d!=null&&(c.expectedTsLastDeviceJobTs==null||d>c.expectedTsLastDeviceJobTs)?!0:!1}g.computeExpectedTsForDeviceRecord=a;g.computeNewExpectedTs=h;g.shouldClearExpectedTs=b}),98);
__d("WAWebHandleAdvListResetApi",["invariant","WAJids","WALogger","WALongInt","WATimeUtils","WAWebABProps","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebDeviceListPk","WAWebIdentityUpdateDeviceTableApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){var i;function a(a,b,c,d,e,f,g,h){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,j,k,l){var m;j===void 0&&(j=!1);var n=b.rawId,o=b.timestamp;b=b.keyIndex;o=d("WALongInt").numberOrThrowIfTooLarge(o);var p=a.device;p!=null&&p!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);var q=d("WAWebWidFactory").asUserWidOrThrow(a),r=0;r=(m=g==null?void 0:g.timestamp)!=null?m:d("WATimeUtils").pastUnixTime((d("WAWebABProps").getABPropConfigValue("num_days_key_index_list_expiration")-1)*d("WATimeUtils").DAY_SECONDS);if(g!=null&&!g.deleted){if(g.timestamp>o){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleADVDeviceIdentity:handleListReset: incomingTs: "," localDeviceRecord.timestamp: ",""])),o,g.timestamp);throw c("err")("handleADVDeviceIdentity:handleListReset: out-of-order timestamp detected")}yield d("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(q,g.devices,j)}e&&(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddress(q).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(e)));m={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:n,timestamp:r,devices:[{id:p,keyIndex:b},{id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0}],validIndexes:null,currentIndex:null,deleted:!1};g=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(o,m,k);m.expectedTs=g.expectedTs;m.expectedTsLastDeviceJobTs=g.expectedTsLastDeviceJobTs;m.expectedTsUpdateTs=g.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l!=null&&(m.advAccountType=l));yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:q,update:m,currentRecord:null}],j);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddress(a).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(f))});return j.apply(this,arguments)}g.handleListReset=a}),98);
__d("WAWebHandleAdvNoListResetApi",["invariant","WAJids","WALogger","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebCryptoCurve25519","WAWebIdentityUpdateDeviceTableApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g,h){var i;function a(a,b,c,d,e,f,g){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,j,k){g===void 0&&(g=!1);var l=b.timestamp;b=b.keyIndex;l=d("WALongInt").numberOrThrowIfTooLarge(l);var m=a.device;m!=null&&m!==d("WAJids").DEFAULT_DEVICE_ID||h(0,56259);if(f.timestamp>=l&&f.validIndexes&&!f.validIndexes.includes(b)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleADVDeviceIdentity:handleNoListReset: incomingTs: "," localDeviceRecord.timestamp: "," incomingKeyIndex "," localDeviceRecord.validIndexes: ",""])),l,f.timestamp,b,f.validIndexes);throw c("err")("handleADVDeviceIdentity:handleNoListReset: out-of-order timestamp detected")}var n=new Map(f.devices.map(function(a){return[a.id,a.keyIndex]}));if(!n.has(m)||n.get(m)!==b){n.set(m,b);m=Array.from(n.entries()).map(function(a){var b=a[0];a=a[1];return{id:b,keyIndex:a}});b=babelHelpers["extends"]({},f,{devices:m,deleted:!1});n=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(l,b,j);b.expectedTs=n.expectedTs;b.expectedTsLastDeviceJobTs=n.expectedTsLastDeviceJobTs;b.expectedTsUpdateTs=n.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(b.advAccountType=k);yield d("WAWebIdentityUpdateDeviceTableApi").bulkApplyDeviceUpdate([{wid:d("WAWebWidFactory").asUserWidOrThrow(a),update:b,currentRecord:f}],g,!0);yield d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddress(a).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(e))}});return j.apply(this,arguments)}g.handleNoListReset=a}),98);
__d("WAWebHandleAdvDeviceNotificationApi",["WAJids","WALogger","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebBizCoexUtils","WAWebDeviceListPk","WAWebHandleAdvDeviceNotificationUtils","WAWebProtobufsAdv.pb"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c,e,f,g,j){if(!g||g.deleted){d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&d("WAWebBizCoexUtils").triggerUsyncForCoexDeviceAdd(b,a);return null}if(c<g.timestamp)return null;if(f==null)return null;f=d("WAWebHandleAdvDeviceNotificationUtils").decodeSignedKeyIndexBytes(f,e);if(!f)return null;e=f.rawId;var k=d("WALongInt").numberOrThrowIfTooLarge(f.timestamp),l=null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l=f.accountType,l===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleDeviceAddNotification: add to coex cache for ",""])),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)));if(k!==c)return null;c=!1;var m=null,n=g.timestamp;g.rawId!==e?c=!0:m=g.devices;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(g.advAccountType!=null&&(g.advAccountType!==l&&(c=!0,d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Clear record due to mismatch between local ADV account type and incoming ADV account type of "," for ",""])),l,a==null?void 0:a.toLogString()))));var o=new Set(f.validIndexes),p=f.currentIndex||0,q=m==null?[]:m.filter(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID&&(o.has(a.keyIndex)||a.keyIndex>p)});b.forEach(function(a){var b=a.id;a=a.keyIndex;b!==d("WAJids").DEFAULT_DEVICE_ID&&a!=null&&o.has(a)&&q.push({id:b,keyIndex:a})});q.push({id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0});g={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:e,timestamp:n,validIndexes:Array.from(o),devices:q,currentIndex:f.currentIndex,deleted:!1};m=d("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(k,g,j);g.expectedTs=m.expectedTs;g.expectedTsLastDeviceJobTs=m.expectedTsLastDeviceJobTs;g.expectedTsUpdateTs=m.expectedTsUpdateTs;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(l!=null&&(g.advAccountType=l));return{update:g,clearRecord:c}}function b(a,b,c){if(c==null||c.deleted)return null;if(b<c.timestamp)return null;var e=new Map(a.map(function(a){return[a.id,a.keyIndex]}));b=c.devices.filter(function(a){if(a.id!==d("WAJids").DEFAULT_DEVICE_ID){var b=e.get(a.id);return b==null||b!==a.keyIndex}return!1});b.push({id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0});return{update:babelHelpers["extends"]({},c,{devices:b}),clearRecord:!1}}g.handleDeviceAddNotification=a;g.handleDeviceRemoveNotification=b}),98);
__d("WAWebHandleAdvDeviceNotificationUtils",["WALogger","WAWebAdvSignatureApi","WAWebCryptoCurve25519","WAWebProtobufsAdv.pb","WAWebSignalCommonUtils","WAWebSignalProtocolStore","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a,b){var c;try{c=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedKeyIndexListSpec,b)}catch(a){return null}if(!d("WAWebAdvSignatureApi").verifyKeyIndexListAccountSignature(c,a))return null;var e;try{e=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVKeyIndexListSpec,c.details)}catch(a){return null}b=e;a=b.timestamp;var f=b.rawId,g=b.validIndexes,h=b.currentIndex;b=b.accountType;if(a==null)return null;return f==null?null:{timestamp:a,rawId:f,validIndexes:g,currentIndex:h,accountType:b}}function b(a,b){var c;try{c=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVSignedKeyIndexListSpec,b)}catch(a){return null}b=c.accountSignatureKey;if(b==null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["accountSignatureKey is null"]))).tags("verifySKeyIndexWithAccSigKey");return null}if(!d("WAWebAdvSignatureApi").verifyKeyIndexListAccountSignature(c,b)){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["account signature verification failed"]))).tags("verifySKeyIndexWithAccSigKey");return null}var e;try{e=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsAdv.pb").ADVKeyIndexListSpec,c.details)}catch(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["decode failed"]))).tags("verifySKeyIndexWithAccSigKey");return null}var f=e,g=f.timestamp,m=f.rawId,n=f.validIndexes,o=f.currentIndex;f=f.accountType;if(g==null){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["timestamp is null"]))).tags("verifySKeyIndexWithAccSigKey");return null}if(m==null){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["rawId is null"]))).tags("verifySKeyIndexWithAccSigKey");return null}a=d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(d("WAWebSignalCommonUtils").createSignalAddress(a).toString(),d("WAWebCryptoCurve25519").toSignalCurvePubKey(b));return{timestamp:g,rawId:m,validIndexes:n,currentIndex:o,accountType:f,identityUpdatePromise:a}}g.decodeSignedKeyIndexBytes=a;g.verifySKeyIndexWithAccSigKey=b}),98);
__d("WAWebHandleAdvOmittedResultApi",["WAJids","WAWebAdvExpectedTsApi","WAWebProtobufsAdv.pb"],(function(a,b,c,d,e,f,g){function a(a,b,c,e){if(!b||b.deleted)return null;if(a!=null&&a<b.timestamp)return null;var f=babelHelpers["extends"]({},b);a!=null&&(f.timestamp=a,d("WAWebAdvExpectedTsApi").shouldClearExpectedTs(a,c,b,e)&&(f.expectedTs=void 0,f.expectedTsLastDeviceJobTs=void 0,f.expectedTsUpdateTs=void 0));f.devices=[{id:d("WAJids").DEFAULT_DEVICE_ID,keyIndex:0}];b.advAccountType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(f.advAccountType=d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE);return{update:f,clearRecord:!1,fromHandleOmittedResult:!0}}g.handleOmittedResult=a}),98);
__d("WAWebHandleAdvForUsyncApi",["invariant","WAJids","WALogger","WAWebHandleAdvDeviceNotificationApi","WAWebHandleAdvKeyIndexResultApi","WAWebHandleAdvOmittedResultApi"],(function(a,b,c,d,e,f,g,h){var i;function a(a,b,c,e,f){var g=b.deviceList;b=b.keyIndex;if(b==null||b.signedKeyIndexBytes==null){if(g!=null&&g.some(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID})){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["processADVSyncResult: drop response with companion device but no keyIndexbytes"])));return}return d("WAWebHandleAdvOmittedResultApi").handleOmittedResult(b==null?void 0:b.ts,e,b==null?void 0:b.expectedTs,f)}var h=b.ts,j=b.expectedTs;b=b.signedKeyIndexBytes;return d("WAWebHandleAdvKeyIndexResultApi").handleKeyIndexResult(a,g,h,b,c,e,f,j)}function b(a,b,c,e,f,g){var i=c.deviceList;c=c.keyIndex;i!=null||h(0,75739,b);c!=null||h(0,75740,b);var j=c.ts,k=c.signedKeyIndexBytes;if(b==="add"){k!=null||h(0,75741,b);return d("WAWebHandleAdvDeviceNotificationApi").handleDeviceAddNotification(a,i,j,k,e,f,g)}if(b==="remove")return d("WAWebHandleAdvDeviceNotificationApi").handleDeviceRemoveNotification(i,c.ts,f)}g.handleADVSyncResult=a;g.handleDeviceNotification=b}),98);
__d("WAWebHandleAdvKeyIndexResultApi",["invariant","WAJids","WALogger","WALongInt","WAWebAdvExpectedTsApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebDeviceListPk","WAWebHandleAdvDeviceNotificationUtils","WAWebProtobufsAdv.pb"],(function(a,b,c,d,e,f,g,h){var i,j,k,l=99;function a(a,b,c,e,f,g,m,n){if((g==null?void 0:g.timestamp)!=null&&c<g.timestamp)return null;var o=null;if(d("WAWebBizCoexGatingUtils").hostedOverrideAdvAccountSignatureKeyEnabled()&&b!=null&&b.some(function(a){return!!a.isHosted})){o=d("WAWebHandleAdvDeviceNotificationUtils").verifySKeyIndexWithAccSigKey(a,e);if(!o)return null}else{if(f==null)return null;o=d("WAWebHandleAdvDeviceNotificationUtils").decodeSignedKeyIndexBytes(f,e);if(!o)return null}f=o.rawId;e=d("WALongInt").numberOrThrowIfTooLarge(o.timestamp);var p=null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(p=o.accountType,p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleKeyIndexResult: add to coex cache for ",""])),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(a)));if(e!==c)return null;c=!1;var q=null;b=b;if(g&&!g.deleted){b==null&&(b=g.devices);g.rawId!==f?c=!0:q=g.devices;if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var r=g.advAccountType!=null&&g.advAccountType!==p||g!=null&&p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&p!==(g==null?void 0:g.advAccountType);r&&(c=!0,d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Clear record due to mismatch between local ADV account type and incoming ADV account type of "," for ",""])),p,a==null?void 0:a.toLogString()))}}else if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){r=p===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g==null?void 0:g.deletedChangedToHost)!==!0;r&&(c=!0,d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Clear record to force hosted notification update"]))))}var s=new Map(),t=new Set(o.validIndexes),u=o.currentIndex||0;b&&b.forEach(function(a){var b=a.keyIndex;b!=null&&t.has(b)&&(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a.id===l&&(a.isHosted===!0||h(0,76137))),s.set(a.id,b))});q!=null&&q.forEach(function(a){a.keyIndex>u&&s.set(a.id,a.keyIndex)});s.set(d("WAJids").DEFAULT_DEVICE_ID,0);r=Array.from(s.entries()).map(function(a){var b=a[0];a=a[1];return d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&b===l?{id:b,keyIndex:a,isHosted:!0}:{id:b,keyIndex:a}});b=e;q={id:d("WAWebDeviceListPk").createDeviceListPK(a),rawId:f,timestamp:b,validIndexes:Array.from(t),devices:r,currentIndex:o.currentIndex,deleted:!1,advAccountType:p};!c&&!d("WAWebAdvExpectedTsApi").shouldClearExpectedTs(e,n,g,m)&&(g&&!g.deleted&&(q.expectedTs=g.expectedTs,q.expectedTsLastDeviceJobTs=g.expectedTsLastDeviceJobTs,q.expectedTsUpdateTs=g.expectedTsUpdateTs));return o.identityUpdatePromise?{update:q,clearRecord:c,identityUpdatePromise:o.identityUpdatePromise}:{update:q,clearRecord:c}}g.handleKeyIndexResult=a}),98);
__d("WAWebHandleUsernameSync",["WALogger","WAWebSetUsernameJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.error.username;if(b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleUsernameUsync: error ",": ",""])),b.errorCode,b.errorText);return}b=a.list;a=b.reduce(function(a,b){var c;if(b.username!=null){a.push({userId:b.id,username:b.username});return a}c=((c=b.contact)==null?void 0:c.type)==="out";if(c)return a;a.push({userId:b.id,deleteUsername:!0});return a},[]);yield d("WAWebSetUsernameJob").setUsernamesJob(a)});return i.apply(this,arguments)}g.handleUsernameSync=a}),98);
__d("WAWebABPropsSaga",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("saga_v1_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("saga_v1_reengagement_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("saga_v1_carousel")}function e(){return d("WAWebABProps").getABPropConfigValue("saga_protobuf_show_sysmsg_web")}function f(){return d("WAWebABProps").getABPropConfigValue("saga_protobuf_ai_stardust_web")}function h(){return d("WAWebABProps").getABPropConfigValue("saga_v1_nux_enabled")}function i(){return d("WAWebABProps").getABPropConfigValue("support_message_feedback_enabled")}g.getIsSagaV1Enabled=a;g.getIsSagaV1ReengagementEnabled=b;g.getIsSagaV1CarouselEnabled=c;g.getIsSagaProtobufSystemMessageEnabled=e;g.getIsSagaProtobufAIStardustEnabled=f;g.getIsSagaV1NuxEnabled=h;g.getSagaFeedbackEnabled=i}),98);
__d("WAWebProtobufsWeb.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsE2E.pb","WAWebProtobufsProtocol.pb"],(function(a,b,c,d,e,f,g){var h,i;c=(a=b("$InternalEnum"))({E2EE:0,FB:2,BSP:1,BSP_AND_FB:3});e=a({UNKNOWN:0,REVOKE:1,CIPHERTEXT:2,FUTUREPROOF:3,NON_VERIFIED_TRANSITION:4,UNVERIFIED_TRANSITION:5,VERIFIED_TRANSITION:6,VERIFIED_LOW_UNKNOWN:7,VERIFIED_HIGH:8,VERIFIED_INITIAL_UNKNOWN:9,VERIFIED_INITIAL_LOW:10,VERIFIED_INITIAL_HIGH:11,VERIFIED_TRANSITION_ANY_TO_NONE:12,VERIFIED_TRANSITION_ANY_TO_HIGH:13,VERIFIED_TRANSITION_HIGH_TO_LOW:14,VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:15,VERIFIED_TRANSITION_UNKNOWN_TO_LOW:16,VERIFIED_TRANSITION_LOW_TO_UNKNOWN:17,VERIFIED_TRANSITION_NONE_TO_LOW:18,VERIFIED_TRANSITION_NONE_TO_UNKNOWN:19,GROUP_CREATE:20,GROUP_CHANGE_SUBJECT:21,GROUP_CHANGE_ICON:22,GROUP_CHANGE_INVITE_LINK:23,GROUP_CHANGE_DESCRIPTION:24,GROUP_CHANGE_RESTRICT:25,GROUP_CHANGE_ANNOUNCE:26,GROUP_PARTICIPANT_ADD:27,GROUP_PARTICIPANT_REMOVE:28,GROUP_PARTICIPANT_PROMOTE:29,GROUP_PARTICIPANT_DEMOTE:30,GROUP_PARTICIPANT_INVITE:31,GROUP_PARTICIPANT_LEAVE:32,GROUP_PARTICIPANT_CHANGE_NUMBER:33,BROADCAST_CREATE:34,BROADCAST_ADD:35,BROADCAST_REMOVE:36,GENERIC_NOTIFICATION:37,E2E_IDENTITY_CHANGED:38,E2E_ENCRYPTED:39,CALL_MISSED_VOICE:40,CALL_MISSED_VIDEO:41,INDIVIDUAL_CHANGE_NUMBER:42,GROUP_DELETE:43,GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:44,CALL_MISSED_GROUP_VOICE:45,CALL_MISSED_GROUP_VIDEO:46,PAYMENT_CIPHERTEXT:47,PAYMENT_FUTUREPROOF:48,PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:49,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:50,PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:51,PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:52,PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:53,PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:54,PAYMENT_ACTION_SEND_PAYMENT_REMINDER:55,PAYMENT_ACTION_SEND_PAYMENT_INVITATION:56,PAYMENT_ACTION_REQUEST_DECLINED:57,PAYMENT_ACTION_REQUEST_EXPIRED:58,PAYMENT_ACTION_REQUEST_CANCELLED:59,BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:60,BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:61,BIZ_INTRO_TOP:62,BIZ_INTRO_BOTTOM:63,BIZ_NAME_CHANGE:64,BIZ_MOVE_TO_CONSUMER_APP:65,BIZ_TWO_TIER_MIGRATION_TOP:66,BIZ_TWO_TIER_MIGRATION_BOTTOM:67,OVERSIZED:68,GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:69,GROUP_V4_ADD_INVITE_SENT:70,GROUP_PARTICIPANT_ADD_REQUEST_JOIN:71,CHANGE_EPHEMERAL_SETTING:72,E2E_DEVICE_CHANGED:73,VIEWED_ONCE:74,E2E_ENCRYPTED_NOW:75,BLUE_MSG_BSP_FB_TO_BSP_PREMISE:76,BLUE_MSG_BSP_FB_TO_SELF_FB:77,BLUE_MSG_BSP_FB_TO_SELF_PREMISE:78,BLUE_MSG_BSP_FB_UNVERIFIED:79,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:80,BLUE_MSG_BSP_FB_VERIFIED:81,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:82,BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:83,BLUE_MSG_BSP_PREMISE_UNVERIFIED:84,BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:85,BLUE_MSG_BSP_PREMISE_VERIFIED:86,BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:87,BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:88,BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:89,BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:90,BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:91,BLUE_MSG_SELF_FB_TO_BSP_PREMISE:92,BLUE_MSG_SELF_FB_TO_SELF_PREMISE:93,BLUE_MSG_SELF_FB_UNVERIFIED:94,BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:95,BLUE_MSG_SELF_FB_VERIFIED:96,BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:97,BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:98,BLUE_MSG_SELF_PREMISE_UNVERIFIED:99,BLUE_MSG_SELF_PREMISE_VERIFIED:100,BLUE_MSG_TO_BSP_FB:101,BLUE_MSG_TO_CONSUMER:102,BLUE_MSG_TO_SELF_FB:103,BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:104,BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:105,BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:106,BLUE_MSG_UNVERIFIED_TO_VERIFIED:107,BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:108,BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:109,BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:110,BLUE_MSG_VERIFIED_TO_UNVERIFIED:111,BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:112,BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:113,BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:114,BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:115,BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:116,BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:117,E2E_IDENTITY_UNAVAILABLE:118,GROUP_CREATING:119,GROUP_CREATE_FAILED:120,GROUP_BOUNCED:121,BLOCK_CONTACT:122,EPHEMERAL_SETTING_NOT_APPLIED:123,SYNC_FAILED:124,SYNCING:125,BIZ_PRIVACY_MODE_INIT_FB:126,BIZ_PRIVACY_MODE_INIT_BSP:127,BIZ_PRIVACY_MODE_TO_FB:128,BIZ_PRIVACY_MODE_TO_BSP:129,DISAPPEARING_MODE:130,E2E_DEVICE_FETCH_FAILED:131,ADMIN_REVOKE:132,GROUP_INVITE_LINK_GROWTH_LOCKED:133,COMMUNITY_LINK_PARENT_GROUP:134,COMMUNITY_LINK_SIBLING_GROUP:135,COMMUNITY_LINK_SUB_GROUP:136,COMMUNITY_UNLINK_PARENT_GROUP:137,COMMUNITY_UNLINK_SIBLING_GROUP:138,COMMUNITY_UNLINK_SUB_GROUP:139,GROUP_PARTICIPANT_ACCEPT:140,GROUP_PARTICIPANT_LINKED_GROUP_JOIN:141,COMMUNITY_CREATE:142,EPHEMERAL_KEEP_IN_CHAT:143,GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST:144,GROUP_MEMBERSHIP_JOIN_APPROVAL_MODE:145,INTEGRITY_UNLINK_PARENT_GROUP:146,COMMUNITY_PARTICIPANT_PROMOTE:147,COMMUNITY_PARTICIPANT_DEMOTE:148,COMMUNITY_PARENT_GROUP_DELETED:149,COMMUNITY_LINK_PARENT_GROUP_MEMBERSHIP_APPROVAL:150,GROUP_PARTICIPANT_JOINED_GROUP_AND_PARENT_GROUP:151,MASKED_THREAD_CREATED:152,MASKED_THREAD_UNMASKED:153,BIZ_CHAT_ASSIGNMENT:154,CHAT_PSA:155,CHAT_POLL_CREATION_MESSAGE:156,CAG_MASKED_THREAD_CREATED:157,COMMUNITY_PARENT_GROUP_SUBJECT_CHANGED:158,CAG_INVITE_AUTO_ADD:159,BIZ_CHAT_ASSIGNMENT_UNASSIGN:160,CAG_INVITE_AUTO_JOINED:161,SCHEDULED_CALL_START_MESSAGE:162,COMMUNITY_INVITE_RICH:163,COMMUNITY_INVITE_AUTO_ADD_RICH:164,SUB_GROUP_INVITE_RICH:165,SUB_GROUP_PARTICIPANT_ADD_RICH:166,COMMUNITY_LINK_PARENT_GROUP_RICH:167,COMMUNITY_PARTICIPANT_ADD_RICH:168,SILENCED_UNKNOWN_CALLER_AUDIO:169,SILENCED_UNKNOWN_CALLER_VIDEO:170,GROUP_MEMBER_ADD_MODE:171,GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST_NON_ADMIN_ADD:172,COMMUNITY_CHANGE_DESCRIPTION:173,SENDER_INVITE:174,RECEIVER_INVITE:175,COMMUNITY_ALLOW_MEMBER_ADDED_GROUPS:176,PINNED_MESSAGE_IN_CHAT:177,PAYMENT_INVITE_SETUP_INVITER:178,PAYMENT_INVITE_SETUP_INVITEE_RECEIVE_ONLY:179,PAYMENT_INVITE_SETUP_INVITEE_SEND_AND_RECEIVE:180,LINKED_GROUP_CALL_START:181,REPORT_TO_ADMIN_ENABLED_STATUS:182,EMPTY_SUBGROUP_CREATE:183,SCHEDULED_CALL_CANCEL:184,SUBGROUP_ADMIN_TRIGGERED_AUTO_ADD_RICH:185,GROUP_CHANGE_RECENT_HISTORY_SHARING:186,PAID_MESSAGE_SERVER_CAMPAIGN_ID:187,GENERAL_CHAT_CREATE:188,GENERAL_CHAT_ADD:189,GENERAL_CHAT_AUTO_ADD_DISABLED:190,SUGGESTED_SUBGROUP_ANNOUNCE:191,BIZ_BOT_1P_MESSAGING_ENABLED:192,CHANGE_USERNAME:193,BIZ_COEX_PRIVACY_INIT_SELF:194,BIZ_COEX_PRIVACY_TRANSITION_SELF:195,SUPPORT_AI_EDUCATION:196,BIZ_BOT_3P_MESSAGING_ENABLED:197,REMINDER_SETUP_MESSAGE:198,REMINDER_SENT_MESSAGE:199,REMINDER_CANCEL_MESSAGE:200,BIZ_COEX_PRIVACY_INIT:201,BIZ_COEX_PRIVACY_TRANSITION:202,GROUP_DEACTIVATED:203,COMMUNITY_DEACTIVATE_SIBLING_GROUP:204,EVENT_UPDATED:205,EVENT_CANCELED:206,COMMUNITY_OWNER_UPDATED:207,COMMUNITY_SUB_GROUP_VISIBILITY_HIDDEN:208,CAPI_GROUP_NE2EE_SYSTEM_MESSAGE:209,STATUS_MENTION:210,USER_CONTROLS_SYSTEM_MESSAGE:211,SUPPORT_SYSTEM_MESSAGE:212,CHANGE_LID:213,BIZ_CUSTOMER_3PD_DATA_SHARING_OPT_IN_MESSAGE:214,BIZ_CUSTOMER_3PD_DATA_SHARING_OPT_OUT_MESSAGE:215,CHANGE_LIMIT_SHARING:216,GROUP_MEMBER_LINK_MODE:217,BIZ_AUTOMATICALLY_LABELED_CHAT_SYSTEM_MESSAGE:218,PHONE_NUMBER_HIDING_CHAT_DEPRECATED_MESSAGE:219,QUARANTINED_MESSAGE:220});f=a({ERROR:0,PENDING:1,SERVER_ACK:2,DELIVERY_ACK:3,READ:4,PLAYED:5});b=a({UNKNOWN:0,PENDING_SETUP:1,PENDING_RECEIVER_SETUP:2,INIT:3,SUCCESS:4,COMPLETED:5,FAILED:6,FAILED_RISK:7,FAILED_PROCESSING:8,FAILED_RECEIVER_PROCESSING:9,FAILED_DA:10,FAILED_DA_FINAL:11,REFUNDED_TXN:12,REFUND_FAILED:13,REFUND_FAILED_PROCESSING:14,REFUND_FAILED_DA:15,EXPIRED_TXN:16,AUTH_CANCELED:17,AUTH_CANCEL_FAILED_PROCESSING:18,AUTH_CANCEL_FAILED:19,COLLECT_INIT:20,COLLECT_SUCCESS:21,COLLECT_FAILED:22,COLLECT_FAILED_RISK:23,COLLECT_REJECTED:24,COLLECT_EXPIRED:25,COLLECT_CANCELED:26,COLLECT_CANCELLING:27,IN_REVIEW:28,REVERSAL_SUCCESS:29,REVERSAL_PENDING:30,REFUND_PENDING:31});var j=a({UNKNOWN_STATUS:0,PROCESSING:1,SENT:2,NEED_TO_ACCEPT:3,COMPLETE:4,COULD_NOT_COMPLETE:5,REFUNDED:6,EXPIRED:7,REJECTED:8,CANCELLED:9,WAITING_FOR_PAYER:10,WAITING:11}),k=a({UNKNOWN_CURRENCY:0,INR:1}),l=a({NOT_STARTED:0,FORCE_UPGRADE:1,DEVELOPMENT:2,PRODUCTION:3}),m=a({UNKNOWN_TYPE:0,PIN_FOR_ALL:1,UNPIN_FOR_ALL:2}),n=a({UNDEFINED:0,REACTION:1,EVENT_RESPONSE:2,POLL_UPDATE:3,PIN_IN_CHAT:4});a=a({NOT_INJECTED:0,INJECTED:1,INJECTED_PARTIAL:2,INJECTION_FAILED:3});var o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={};o.internalDefaults={status:f.PENDING};o.name="WebMessageInfo";o.internalSpec={key:[1,(h=d("WAProtoConst")).FLAGS.REQUIRED|h.TYPES.MESSAGE,(i=d("WAWebProtobufsProtocol.pb")).MessageKeySpec],message:[2,h.TYPES.MESSAGE,(d=d("WAWebProtobufsE2E.pb")).MessageSpec],messageTimestamp:[3,h.TYPES.UINT64],status:[4,h.TYPES.ENUM,f],participant:[5,h.TYPES.STRING],messageC2STimestamp:[6,h.TYPES.UINT64],ignore:[16,h.TYPES.BOOL],starred:[17,h.TYPES.BOOL],broadcast:[18,h.TYPES.BOOL],pushName:[19,h.TYPES.STRING],mediaCiphertextSha256:[20,h.TYPES.BYTES],multicast:[21,h.TYPES.BOOL],urlText:[22,h.TYPES.BOOL],urlNumber:[23,h.TYPES.BOOL],messageStubType:[24,h.TYPES.ENUM,e],clearMedia:[25,h.TYPES.BOOL],messageStubParameters:[26,h.FLAGS.REPEATED|h.TYPES.STRING],duration:[27,h.TYPES.UINT32],labels:[28,h.FLAGS.REPEATED|h.TYPES.STRING],paymentInfo:[29,h.TYPES.MESSAGE,q],finalLiveLocation:[30,h.TYPES.MESSAGE,d.Message$LiveLocationMessageSpec],quotedPaymentInfo:[31,h.TYPES.MESSAGE,q],ephemeralStartTimestamp:[32,h.TYPES.UINT64],ephemeralDuration:[33,h.TYPES.UINT32],ephemeralOffToOn:[34,h.TYPES.BOOL],ephemeralOutOfSync:[35,h.TYPES.BOOL],bizPrivacyStatus:[36,h.TYPES.ENUM,c],verifiedBizName:[37,h.TYPES.STRING],mediaData:[38,h.TYPES.MESSAGE,v],photoChange:[39,h.TYPES.MESSAGE,w],userReceipt:[40,h.FLAGS.REPEATED|h.TYPES.MESSAGE,y],reactions:[41,h.FLAGS.REPEATED|h.TYPES.MESSAGE,z],quotedStickerData:[42,h.TYPES.MESSAGE,v],futureproofData:[43,h.TYPES.BYTES],statusPsa:[44,h.TYPES.MESSAGE,x],pollUpdates:[45,h.FLAGS.REPEATED|h.TYPES.MESSAGE,A],pollAdditionalMetadata:[46,h.TYPES.MESSAGE,B],agentId:[47,h.TYPES.STRING],statusAlreadyViewed:[48,h.TYPES.BOOL],messageSecret:[49,h.TYPES.BYTES],keepInChat:[50,h.TYPES.MESSAGE,E],originalSelfAuthorUserJidString:[51,h.TYPES.STRING],revokeMessageTimestamp:[52,h.TYPES.UINT64],pinInChat:[54,h.TYPES.MESSAGE,F],premiumMessageInfo:[55,h.TYPES.MESSAGE,H],is1PBizBotMessage:[56,h.TYPES.BOOL],isGroupHistoryMessage:[57,h.TYPES.BOOL],botMessageInvokerJid:[58,h.TYPES.STRING],commentMetadata:[59,h.TYPES.MESSAGE,p],eventResponses:[61,h.FLAGS.REPEATED|h.TYPES.MESSAGE,I],reportingTokenInfo:[62,h.TYPES.MESSAGE,u],newsletterServerId:[63,h.TYPES.UINT64],eventAdditionalMetadata:[64,h.TYPES.MESSAGE,D],isMentionedInStatus:[65,h.TYPES.BOOL],statusMentions:[66,h.FLAGS.REPEATED|h.TYPES.STRING],targetMessageId:[67,h.TYPES.MESSAGE,i.MessageKeySpec],messageAddOns:[68,h.FLAGS.REPEATED|h.TYPES.MESSAGE,K],statusMentionMessageInfo:[69,h.TYPES.MESSAGE,L],isSupportAiMessage:[70,h.TYPES.BOOL],statusMentionSources:[71,h.FLAGS.REPEATED|h.TYPES.STRING],supportAiCitations:[72,h.FLAGS.REPEATED|h.TYPES.MESSAGE,M],botTargetId:[73,h.TYPES.STRING],groupHistoryIndividualMessageInfo:[74,h.TYPES.MESSAGE,N],groupHistoryBundleInfo:[75,h.TYPES.MESSAGE,O],interactiveMessageAdditionalMetadata:[76,h.TYPES.MESSAGE,C],quarantinedMessage:[77,h.TYPES.MESSAGE,P]};p.name="CommentMetadata";p.internalSpec={commentParentKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],replyCount:[2,h.TYPES.UINT32]};q.name="PaymentInfo";q.internalSpec={currencyDeprecated:[1,h.TYPES.ENUM,k],amount1000:[2,h.TYPES.UINT64],receiverJid:[3,h.TYPES.STRING],status:[4,h.TYPES.ENUM,j],transactionTimestamp:[5,h.TYPES.UINT64],requestMessageKey:[6,h.TYPES.MESSAGE,i.MessageKeySpec],expiryTimestamp:[7,h.TYPES.UINT64],futureproofed:[8,h.TYPES.BOOL],currency:[9,h.TYPES.STRING],txnStatus:[10,h.TYPES.ENUM,b],useNoviFiatFormat:[11,h.TYPES.BOOL],primaryAmount:[12,h.TYPES.MESSAGE,d.MoneySpec],exchangeAmount:[13,h.TYPES.MESSAGE,d.MoneySpec]};r.name="WebNotificationsInfo";r.internalSpec={timestamp:[2,h.TYPES.UINT64],unreadChats:[3,h.TYPES.UINT32],notifyMessageCount:[4,h.TYPES.UINT32],notifyMessages:[5,h.FLAGS.REPEATED|h.TYPES.MESSAGE,o]};s.name="NotificationMessageInfo";s.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],message:[2,h.TYPES.MESSAGE,d.MessageSpec],messageTimestamp:[3,h.TYPES.UINT64],participant:[4,h.TYPES.STRING]};t.name="WebFeatures";t.internalSpec={labelsDisplay:[1,h.TYPES.ENUM,l],voipIndividualOutgoing:[2,h.TYPES.ENUM,l],groupsV3:[3,h.TYPES.ENUM,l],groupsV3Create:[4,h.TYPES.ENUM,l],changeNumberV2:[5,h.TYPES.ENUM,l],queryStatusV3Thumbnail:[6,h.TYPES.ENUM,l],liveLocations:[7,h.TYPES.ENUM,l],queryVname:[8,h.TYPES.ENUM,l],voipIndividualIncoming:[9,h.TYPES.ENUM,l],quickRepliesQuery:[10,h.TYPES.ENUM,l],payments:[11,h.TYPES.ENUM,l],stickerPackQuery:[12,h.TYPES.ENUM,l],liveLocationsFinal:[13,h.TYPES.ENUM,l],labelsEdit:[14,h.TYPES.ENUM,l],mediaUpload:[15,h.TYPES.ENUM,l],mediaUploadRichQuickReplies:[18,h.TYPES.ENUM,l],vnameV2:[19,h.TYPES.ENUM,l],videoPlaybackUrl:[20,h.TYPES.ENUM,l],statusRanking:[21,h.TYPES.ENUM,l],voipIndividualVideo:[22,h.TYPES.ENUM,l],thirdPartyStickers:[23,h.TYPES.ENUM,l],frequentlyForwardedSetting:[24,h.TYPES.ENUM,l],groupsV4JoinPermission:[25,h.TYPES.ENUM,l],recentStickers:[26,h.TYPES.ENUM,l],catalog:[27,h.TYPES.ENUM,l],starredStickers:[28,h.TYPES.ENUM,l],voipGroupCall:[29,h.TYPES.ENUM,l],templateMessage:[30,h.TYPES.ENUM,l],templateMessageInteractivity:[31,h.TYPES.ENUM,l],ephemeralMessages:[32,h.TYPES.ENUM,l],e2ENotificationSync:[33,h.TYPES.ENUM,l],recentStickersV2:[34,h.TYPES.ENUM,l],recentStickersV3:[36,h.TYPES.ENUM,l],userNotice:[37,h.TYPES.ENUM,l],support:[39,h.TYPES.ENUM,l],groupUiiCleanup:[40,h.TYPES.ENUM,l],groupDogfoodingInternalOnly:[41,h.TYPES.ENUM,l],settingsSync:[42,h.TYPES.ENUM,l],archiveV2:[43,h.TYPES.ENUM,l],ephemeralAllowGroupMembers:[44,h.TYPES.ENUM,l],ephemeral24HDuration:[45,h.TYPES.ENUM,l],mdForceUpgrade:[46,h.TYPES.ENUM,l],disappearingMode:[47,h.TYPES.ENUM,l],externalMdOptInAvailable:[48,h.TYPES.ENUM,l],noDeleteMessageTimeLimit:[49,h.TYPES.ENUM,l]};u.name="ReportingTokenInfo";u.internalSpec={reportingTag:[1,h.TYPES.BYTES]};v.name="MediaData";v.internalSpec={localPath:[1,h.TYPES.STRING]};w.name="PhotoChange";w.internalSpec={oldPhoto:[1,h.TYPES.BYTES],newPhoto:[2,h.TYPES.BYTES],newPhotoId:[3,h.TYPES.UINT32]};x.name="StatusPSA";x.internalSpec={campaignId:[44,h.FLAGS.REQUIRED|h.TYPES.UINT64],campaignExpirationTimestamp:[45,h.TYPES.UINT64]};y.name="UserReceipt";y.internalSpec={userJid:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],receiptTimestamp:[2,h.TYPES.INT64],readTimestamp:[3,h.TYPES.INT64],playedTimestamp:[4,h.TYPES.INT64],pendingDeviceJid:[5,h.FLAGS.REPEATED|h.TYPES.STRING],deliveredDeviceJid:[6,h.FLAGS.REPEATED|h.TYPES.STRING]};z.name="Reaction";z.internalSpec={key:[1,h.TYPES.MESSAGE,i.MessageKeySpec],text:[2,h.TYPES.STRING],groupingKey:[3,h.TYPES.STRING],senderTimestampMs:[4,h.TYPES.INT64],unread:[5,h.TYPES.BOOL]};A.name="PollUpdate";A.internalSpec={pollUpdateMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],vote:[2,h.TYPES.MESSAGE,d.Message$PollVoteMessageSpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],unread:[5,h.TYPES.BOOL]};B.name="PollAdditionalMetadata";B.internalSpec={pollInvalidated:[1,h.TYPES.BOOL]};C.name="InteractiveMessageAdditionalMetadata";C.internalSpec={isGalaxyFlowCompleted:[1,h.TYPES.BOOL]};D.name="EventAdditionalMetadata";D.internalSpec={isStale:[1,h.TYPES.BOOL]};E.name="KeepInChat";E.internalSpec={keepType:[1,h.TYPES.ENUM,d.KeepType],serverTimestamp:[2,h.TYPES.INT64],key:[3,h.TYPES.MESSAGE,i.MessageKeySpec],deviceJid:[4,h.TYPES.STRING],clientTimestampMs:[5,h.TYPES.INT64],serverTimestampMs:[6,h.TYPES.INT64]};F.name="PinInChat";F.internalSpec={type:[1,h.TYPES.ENUM,m],key:[2,h.TYPES.MESSAGE,i.MessageKeySpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],messageAddOnContextInfo:[5,h.TYPES.MESSAGE,G]};G.name="MessageAddOnContextInfo";G.internalSpec={messageAddOnDurationInSecs:[1,h.TYPES.UINT32],messageAddOnExpiryType:[2,h.TYPES.ENUM,d.MessageContextInfo$MessageAddonExpiryType]};H.name="PremiumMessageInfo";H.internalSpec={serverCampaignId:[1,h.TYPES.STRING]};I.name="EventResponse";I.internalSpec={eventResponseMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],timestampMs:[2,h.TYPES.INT64],eventResponseMessage:[3,h.TYPES.MESSAGE,d.Message$EventResponseMessageSpec],unread:[4,h.TYPES.BOOL]};J.name="LegacyMessage";J.internalSpec={eventResponseMessage:[1,h.TYPES.MESSAGE,d.Message$EventResponseMessageSpec],pollVote:[2,h.TYPES.MESSAGE,d.Message$PollVoteMessageSpec]};K.internalDefaults={status:f.PENDING};K.name="MessageAddOn";K.internalSpec={messageAddOnType:[1,h.TYPES.ENUM,n],messageAddOn:[2,h.TYPES.MESSAGE,d.MessageSpec],senderTimestampMs:[3,h.TYPES.INT64],serverTimestampMs:[4,h.TYPES.INT64],status:[5,h.TYPES.ENUM,f],addOnContextInfo:[6,h.TYPES.MESSAGE,G],messageAddOnKey:[7,h.TYPES.MESSAGE,i.MessageKeySpec],legacyMessage:[8,h.TYPES.MESSAGE,J]};L.name="StatusMentionMessage";L.internalSpec={quotedStatus:[1,h.TYPES.MESSAGE,d.MessageSpec]};M.name="Citation";M.internalSpec={title:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],subtitle:[2,h.FLAGS.REQUIRED|h.TYPES.STRING],cmsId:[3,h.FLAGS.REQUIRED|h.TYPES.STRING],imageUrl:[4,h.FLAGS.REQUIRED|h.TYPES.STRING]};N.name="GroupHistoryIndividualMessageInfo";N.internalSpec={bundleMessageKey:[1,h.TYPES.MESSAGE,i.MessageKeySpec],editedAfterReceivedAsHistory:[2,h.TYPES.BOOL]};O.name="GroupHistoryBundleInfo";O.internalSpec={deprecatedMessageHistoryBundle:[1,h.TYPES.MESSAGE,d.Message$MessageHistoryBundleSpec],processState:[2,h.TYPES.ENUM,a]};P.name="QuarantinedMessage";P.internalSpec={originalData:[1,h.TYPES.BYTES],extractedText:[2,h.TYPES.STRING]};g.WebMessageInfo$BizPrivacyStatus=c;g.WebMessageInfo$StubType=e;g.WebMessageInfo$Status=f;g.PaymentInfo$TxnStatus=b;g.PaymentInfo$Status=j;g.PaymentInfo$Currency=k;g.WebFeatures$Flag=l;g.PinInChat$Type=m;g.MessageAddOn$MessageAddOnType=n;g.GroupHistoryBundleInfo$ProcessState=a;g.WebMessageInfoSpec=o;g.CommentMetadataSpec=p;g.PaymentInfoSpec=q;g.WebNotificationsInfoSpec=r;g.NotificationMessageInfoSpec=s;g.WebFeaturesSpec=t;g.ReportingTokenInfoSpec=u;g.MediaDataSpec=v;g.PhotoChangeSpec=w;g.StatusPSASpec=x;g.UserReceiptSpec=y;g.ReactionSpec=z;g.PollUpdateSpec=A;g.PollAdditionalMetadataSpec=B;g.InteractiveMessageAdditionalMetadataSpec=C;g.EventAdditionalMetadataSpec=D;g.KeepInChatSpec=E;g.PinInChatSpec=F;g.MessageAddOnContextInfoSpec=G;g.PremiumMessageInfoSpec=H;g.EventResponseSpec=I;g.LegacyMessageSpec=J;g.MessageAddOnSpec=K;g.StatusMentionMessageSpec=L;g.CitationSpec=M;g.GroupHistoryIndividualMessageInfoSpec=N;g.GroupHistoryBundleInfoSpec=O;g.QuarantinedMessageSpec=P}),98);
__d("WAWebParseWebMessageInfoApi",["WAJids","WALogger","WANullthrows","WATimeUtils","WAWebABProps","WAWebABPropsSaga","WAWebBizCoexGatingUtils","WAWebBotTypes","WAWebE2EProtoParser","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebEphemeralKeepInChat","WAWebLimitSharingProtoUtils","WAWebMessagingGatingUtils","WAWebMsgKey","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebProtobufsWeb.pb","WAWebReportingTokenUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a){return a.originalSelfAuthorUserJidString==null?d("WAWebUserPrefsMeUser").getMaybeMePnUser():d("WAWebE2EProtoUtils").decodeJid(a.originalSelfAuthorUserJidString)}function m(a,b){var e=d("WAWebE2EProtoUtils").decodeJidAndValidate(b.remoteJid,"remoteJid"),f=d("WAWebE2EProtoUtils").decodeJidAndValidate(b.participant,"participant"),g=l(a),i=d("WAWebE2EProtoUtils").decodeJidAndValidate(a.participant,"participant");f==null&&e!=null&&c("WAWebWid").isWid(e)&&e===d("WAWebWidFactory").createWid(d("WAJids").PSA_JID)&&(f=d("WAWebWidFactory").createWid(d("WAJids").PSA_JID));(c("WAWebWid").isGroup(e)||c("WAWebWid").isStatus(e))&&(f==null&&(b.fromMe===!0?f=g:a.participant!=null&&(f=d("WAWebE2EProtoUtils").decodeJid(a.participant))),i=i!=null?i:f);try{g=new(c("WAWebMsgKey"))({fromMe:c("WANullthrows")(b.fromMe),remote:e,id:c("WANullthrows")(b.id),participant:f});return{msgKey:g,author:i}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["drop: cannot create MsgKey: ",", ",""])),a.message,a.stack).sendLogs("history-sync-message-drop-cannot-create-msgkey",{sampling:.01});return}}function a(a){var b=a.key,e=d("WAWebE2EProtoUtils").decodeJidAndValidate(b.remoteJid,"remoteJid"),f=l(a),g=b.fromMe===!0?e:f,h=b.fromMe===!0?f:e,k=m(a,b);if(k==null)return;var o=k.msgKey;k=k.author;var p="in";f!=null&&e!=null&&e instanceof c("WAWebWid")&&d("WAWebUserPrefsMeUser").isMeAccount(e)&&(p=b.fromMe===!0?"out":"in");if(g==="broadcast"){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["drop: broadcast"]))).devConsole(a);return}f=!1;f=a.reactions.some(function(a){return a.text!=null});h={id:o,from:h,to:g,self:p,participant:o.participant,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.Unknown,t:(e=a.messageTimestamp)!=null?e:0,ack:a.status-1,author:k,invis:!!a.ignore,star:!!a.starred,broadcast:b.fromMe===!0&&a.broadcast,notifyName:a.pushName||"",encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(a.mediaCiphertextSha256),shareDuration:a.duration,labels:a.labels,ephemeralStartTimestamp:a.ephemeralStartTimestamp,ephemeralOutOfSync:a.ephemeralOutOfSync,bizPrivacyStatus:a.bizPrivacyStatus,verifiedBizName:a.verifiedBizName,reactions:a.reactions,hasReaction:f,agentId:a.agentId,revokeTimestamp:a.revokeMessageTimestamp,kicKey:void 0,kicState:void 0,pollInvalidated:((h=a.pollAdditionalMetadata)==null?void 0:h.pollInvalidated)===!0,eventInvalidated:((g=a.eventAdditionalMetadata)==null?void 0:g.isStale)===!0,replyCount:(p=a.commentMetadata)==null?void 0:p.replyCount,originalSelfAuthor:d("WAWebE2EProtoUtils").decodeJidAndValidate(a.originalSelfAuthorUserJidString,"originalSelfAuthorUserJidString"),kicTimestampMs:void 0,pinInChat:a.pinInChat,pmCampaignId:(e=a.premiumMessageInfo)==null?void 0:e.serverCampaignId,galaxyFlowDisabled:a.interactiveMessageAdditionalMetadata!=null?a.interactiveMessageAdditionalMetadata.isGalaxyFlowCompleted===!0:void 0,bizSource:((k=a.premiumMessageInfo)==null?void 0:k.serverCampaignId)!=null?"smb_promo":void 0,bizBotType:a.is1PBizBotMessage===!0?d("WAWebBotTypes").BizBotType.BIZ_1P:null,botTargetSenderJid:a.botMessageInvokerJid!=null?d("WAWebE2EProtoUtils").decodeJidAndValidate(a.botMessageInvokerJid,"botMessageInvokerJid"):null,groupHistoryBundleInfo:a.groupHistoryBundleInfo,groupHistoryBundleMessageKey:(b=a.groupHistoryIndividualMessageInfo)!=null&&b.bundleMessageKey?d("WAWebE2EProtoUtils").protobufToMsgKey((f=a.groupHistoryIndividualMessageInfo)==null?void 0:f.bundleMessageKey):null};c("WAWebWid").isCAPISupportAccount(o.remote)&&(a.isSupportAiMessage!=null&&d("WAWebABPropsSaga").getIsSagaProtobufAIStardustEnabled()&&(h.isSupportAIMessage=a.isSupportAiMessage),a.supportAiCitations!=null&&a.supportAiCitations.length>0&&(h.supportCitations=a.supportAiCitations));if(d("WAWebMessagingGatingUtils").isReportingTagSyncingEnabled()){h.reportingTokenInfo=a.reportingTokenInfo!=null?{reportingTag:(g=a.reportingTokenInfo)==null?void 0:g.reportingTag,version:d("WAWebReportingTokenUtils").REPORTING_TOKEN_VERSION.HISTORY_SYNC}:null}if(a.keepInChat!=null)try{p=d("WAWebEphemeralKeepInChat").parseKeepInChatHistorySyncMessage(a);p!=null&&Object.assign(h,p)}catch(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["parseWebMessageInfo: KIC fields are malformed"]))).devConsole(a)}if(a.message)return d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:a.message,message:h,msgContext:"history",paymentInfo:a.paymentInfo,finalLocation:a.finalLiveLocation,quotedPaymentInfo:a.quotedPaymentInfo,bizSource:h.bizSource});void d("WAWebLimitSharingProtoUtils").parseLimitSharingFromProtocolHistorySyncMessage(a,h);return n(a,h)}function n(a,b){if(a.messageStubType==null)return;var c=d("WAWebProtobufsWeb.pb").WebMessageInfo$StubType;switch(a.messageStubType){case c.REVOKE:b.type="revoked";b.subtype="sender";b.kind=d("WAWebMsgType").MsgKind.RevokedMessage;var e=a.messageStubParameters;e=e!=null&&e.length>0?e[0]:null;if(e!=null){b.protocolMessageKey=(e=m(a,babelHelpers["extends"]({},a.key,{id:e})))==null?void 0:e.msgKey}return b;case c.CIPHERTEXT:b.type="ciphertext";b.kind=d("WAWebMsgType").MsgKind.Ciphertext;return b;case c.OVERSIZED:b.type="oversized";b.kind=d("WAWebMsgType").MsgKind.Oversized;return b;case c.FUTUREPROOF:b.kind=d("WAWebMsgType").MsgKind.Unknown;b.subtype="phone";return b;case c.CAPI_GROUP_NE2EE_SYSTEM_MESSAGE:b.type="notification_template";b.subtype="is_capi_hosted_group";return b;case c.QUARANTINED_MESSAGE:b.type=d("WAWebMsgType").MSG_TYPE.QUARANTINED;b.kind=d("WAWebMsgType").MsgKind.QuarantinedMessage;b.quarantineOriginalProtobuf=(e=a.quarantinedMessage)==null?void 0:e.originalData;b.quarantineExtractedText=(c=a.quarantinedMessage)==null?void 0:c.extractedText;return b;default:return o(a,b)}}function o(a,b){var e;if(a.messageStubType==null)return;var f=d("WAWebProtobufsWeb.pb").WebMessageInfo$StubType;b.type="notification_template";b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.templateParams=Array.isArray(a.messageStubParameters)?a.messageStubParameters.map(function(b){return a.messageStubType===f.GROUP_CREATE||a.messageStubType===f.GROUP_CHANGE_SUBJECT?b:d("WAWebE2EProtoUtils").decodeJid(b)}):void 0;if(a.messageStubType==null){b.templateParams=void 0;return b}switch(a.messageStubType){case f.NON_VERIFIED_TRANSITION:b.subtype="non_verified_transition";break;case f.UNVERIFIED_TRANSITION:b.subtype="unverified_transition";break;case f.VERIFIED_TRANSITION:b.subtype="verified_transition";break;case f.VERIFIED_LOW_UNKNOWN:b.subtype="verified_low_unknown";break;case f.VERIFIED_HIGH:b.subtype="verified_high";break;case f.VERIFIED_INITIAL_UNKNOWN:b.subtype="verified_initial_unknown";break;case f.VERIFIED_INITIAL_LOW:b.subtype="verified_initial_low";break;case f.VERIFIED_INITIAL_HIGH:b.subtype="verified_initial_high";break;case f.VERIFIED_TRANSITION_ANY_TO_NONE:b.subtype="verified_transition_any_to_none";break;case f.VERIFIED_TRANSITION_ANY_TO_HIGH:b.subtype="verified_transition_any_to_high";break;case f.VERIFIED_TRANSITION_HIGH_TO_LOW:b.subtype="verified_transition_high_to_low";break;case f.VERIFIED_TRANSITION_HIGH_TO_UNKNOWN:b.subtype="verified_transition_high_to_unknown";break;case f.VERIFIED_TRANSITION_UNKNOWN_TO_LOW:b.subtype="verified_transition_unknown_to_low";break;case f.VERIFIED_TRANSITION_LOW_TO_UNKNOWN:b.subtype="verified_transition_low_to_unknown";break;case f.VERIFIED_TRANSITION_NONE_TO_LOW:b.subtype="verified_transition_none_to_low";break;case f.VERIFIED_TRANSITION_NONE_TO_UNKNOWN:b.subtype="verified_transition_none_to_unknown";break;case f.GROUP_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="create";b.body=b.templateParams[0];b.templateParams=void 0;break;case f.REPORT_TO_ADMIN_ENABLED_STATUS:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="allow_admin_reports";break;case f.GROUP_DELETE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="delete";b.templateParams=void 0;break;case f.GROUP_CHANGE_SUBJECT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subject";b.body=b.templateParams[0];b.templateParams=void 0;break;case f.GROUP_CHANGE_ICON:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="picture";b.body=b.templateParams[0];b.templateParams=void 0;break;case f.GROUP_CHANGE_INVITE_LINK:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="revoke_invite";break;case f.GROUP_CHANGE_DESCRIPTION:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="description";b.body=b.templateParams[0];break;case f.GROUP_CHANGE_RESTRICT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="restrict";b.body=b.templateParams[0];break;case f.GROUP_CHANGE_ANNOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="announce";b.body=b.templateParams[0];break;case f.GROUP_CHANGE_NO_FREQUENTLY_FORWARDED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="no_frequently_forwarded";b.body=b.templateParams[0];break;case f.GROUP_ANNOUNCE_MODE_MESSAGE_BOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="announce_msg_bounce";b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="add";b.recipients=b.templateParams;b.templateParams=void 0;Array.isArray(b.recipients)&&b.recipients.length===1&&b.author===b.recipients[0]&&(b.author=void 0);break;case f.GROUP_PARTICIPANT_REMOVE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="remove";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_PROMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="promote";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_DEMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="demote";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_INVITE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_LEAVE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="leave";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_CHANGE_NUMBER:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="modify";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_V4_ADD_INVITE_SENT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="v4_add_invite_sent";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_ADD_REQUEST_JOIN:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="v4_add_invite_join";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GROUP_INVITE_LINK_GROWTH_LOCKED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype=b.templateParams[0]==="true"?"growth_locked":"growth_unlocked";b.body="invite";b.templateParams=void 0;break;case f.GROUP_PARTICIPANT_LINKED_GROUP_JOIN:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_join";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.BROADCAST_CREATE:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="create";b.body=(e=b.templateParams[0])!=null?e:"0";b.templateParams=void 0;break;case f.BROADCAST_ADD:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="add";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.BROADCAST_REMOVE:b.type="broadcast_notification";b.kind=d("WAWebMsgType").MsgKind.BroadcastNotification;b.subtype="remove";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.GENERIC_NOTIFICATION:b.type="notification";b.kind=d("WAWebMsgType").MsgKind.Notification;b.body=b.templateParams[0];b.templateParams=void 0;break;case f.E2E_IDENTITY_CHANGED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="identity";b.body=b.templateParams[0]instanceof c("WAWebWid")?b.templateParams[0].toString():b.templateParams[0];b.templateParams=void 0;break;case f.E2E_IDENTITY_UNAVAILABLE:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="e2e_identity_unavailable";break;case f.CHAT_PSA:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="chat_psa";break;case f.E2E_DEVICE_CHANGED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="device";b.body=b.templateParams[0]instanceof c("WAWebWid")?b.templateParams[0].toString():b.templateParams[0];b.devicesAdded=parseInt(b.templateParams[1],10);b.devicesRemoved=parseInt(b.templateParams[2],10);b.templateParams=void 0;break;case f.E2E_ENCRYPTED:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="encrypt";break;case f.E2E_ENCRYPTED_NOW:b.type="e2e_notification";b.kind=d("WAWebMsgType").MsgKind.E2eNotification;b.subtype="encrypt_now";break;case f.CALL_MISSED_VOICE:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss";break;case f.CALL_MISSED_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_video";break;case f.CALL_MISSED_GROUP_VOICE:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_group";break;case f.CALL_MISSED_GROUP_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="miss_group_video";break;case f.SILENCED_UNKNOWN_CALLER_AUDIO:case f.SILENCED_UNKNOWN_CALLER_VIDEO:b.type="call_log";b.kind=d("WAWebMsgType").MsgKind.CallLog;b.subtype="silence";break;case f.INDIVIDUAL_CHANGE_NUMBER:b.subtype="change_number";break;case f.SENDER_INVITE:b.subtype="sender_invite";break;case f.RECEIVER_INVITE:b.subtype="receiver_invite";break;case f.MASKED_THREAD_CREATED:b.subtype="masked_thread_created";break;case f.CAG_MASKED_THREAD_CREATED:b.subtype="cag_masked_thread_created";break;case f.CHANGE_EPHEMERAL_SETTING:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="ephemeral";b.author=b.templateParams[1];break;case f.PAYMENT_CIPHERTEXT:b.type="payment";b.kind=d("WAWebMsgType").MsgKind.Payment;b.subtype="ciphertext";if(a.paymentInfo!=null){e=d("WAWebE2EProtoUtils").parseMsgPaymentInfo(a.paymentInfo);b.paymentStatus=e.paymentStatus;b.paymentTxnStatus=e.paymentTxnStatus;b.paymentCurrency=e.paymentCurrency;b.paymentAmount1000=e.paymentAmount1000;b.paymentMessageReceiverJid=e.paymentMessageReceiverJid;b.paymentExpiryTimestamp=e.paymentExpiryTimestamp;b.paymentTransactionTimestamp=e.paymentTransactionTimestamp}break;case f.PAYMENT_FUTUREPROOF:b.type="payment";b.kind=d("WAWebMsgType").MsgKind.Payment;b.subtype="futureproof";if(a.paymentInfo!=null){e=d("WAWebE2EProtoUtils").parseMsgPaymentInfo(a.paymentInfo);b.paymentStatus=e.paymentStatus;b.paymentTxnStatus=e.paymentTxnStatus;b.paymentCurrency=e.paymentCurrency;b.paymentAmount1000=e.paymentAmount1000;b.paymentMessageReceiverJid=e.paymentMessageReceiverJid;b.paymentExpiryTimestamp=e.paymentExpiryTimestamp;b.paymentTransactionTimestamp=e.paymentTransactionTimestamp}break;case f.PAYMENT_ACTION_REQUEST_CANCELLED:b.subtype="payment_transaction_request_cancelled";break;case f.PAYMENT_TRANSACTION_STATUS_UPDATE_FAILED:b.subtype="payment_transaction_status_update_failed";break;case f.PAYMENT_TRANSACTION_STATUS_UPDATE_REFUNDED:b.subtype="payment_transaction_status_update_refunded";break;case f.PAYMENT_TRANSACTION_STATUS_UPDATE_REFUND_FAILED:b.subtype="payment_transaction_status_update_refund_failed";break;case f.PAYMENT_TRANSACTION_STATUS_RECEIVER_PENDING_SETUP:b.subtype="payment_transaction_status_receiver_pending_setup";break;case f.PAYMENT_TRANSACTION_STATUS_RECEIVER_SUCCESS_AFTER_HICCUP:b.subtype="payment_transaction_status_receiver_success_after_hiccup";break;case f.PAYMENT_ACTION_ACCOUNT_SETUP_REMINDER:b.subtype="payment_action_account_setup_reminder";break;case f.PAYMENT_ACTION_SEND_PAYMENT_REMINDER:b.subtype="payment_action_send_payment_reminder";break;case f.PAYMENT_ACTION_SEND_PAYMENT_INVITATION:b.subtype="payment_action_send_payment_invitation";break;case f.PAYMENT_ACTION_REQUEST_DECLINED:b.subtype="payment_action_request_declined";break;case f.PAYMENT_ACTION_REQUEST_EXPIRED:b.subtype="payment_action_request_expired";break;case f.BIZ_VERIFIED_TRANSITION_TOP_TO_BOTTOM:b.subtype="biz_verified_transition_top_to_bottom";break;case f.BIZ_VERIFIED_TRANSITION_BOTTOM_TO_TOP:b.subtype="biz_verified_transition_bottom_to_top";break;case f.BIZ_INTRO_TOP:b.subtype="biz_intro_top";break;case f.BIZ_INTRO_BOTTOM:b.subtype="biz_intro_bottom";break;case f.BIZ_NAME_CHANGE:b.subtype="biz_name_change";break;case f.BIZ_MOVE_TO_CONSUMER_APP:b.subtype="biz_move_to_consumer_app";break;case f.BIZ_TWO_TIER_MIGRATION_TOP:b.subtype="biz_two_tier_migration_top";break;case f.BIZ_TWO_TIER_MIGRATION_BOTTOM:b.subtype="biz_two_tier_migration_bottom";break;case f.BLUE_MSG_BSP_FB_TO_BSP_PREMISE:b.subtype="blue_msg_bsp_fb_to_bsp_premise";break;case f.BLUE_MSG_BSP_FB_TO_SELF_FB:b.subtype="blue_msg_bsp_fb_to_self_fb";break;case f.BLUE_MSG_BSP_FB_TO_SELF_PREMISE:b.subtype="blue_msg_bsp_fb_to_self_premise";break;case f.BLUE_MSG_BSP_FB_UNVERIFIED:b.subtype="blue_msg_bsp_fb_unverified";break;case f.BLUE_MSG_BSP_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_bsp_premise_verified";break;case f.BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_FB_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_self_fb_verified";break;case f.BLUE_MSG_BSP_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_fb_unverified_to_self_premise_verified";break;case f.BLUE_MSG_BSP_FB_VERIFIED:b.subtype="blue_msg_bsp_fb_verified";break;case f.BLUE_MSG_BSP_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_bsp_premise_unverified";break;case f.BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_self_fb_unverified";break;case f.BLUE_MSG_BSP_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_fb_verified_to_self_premise_unverified";break;case f.BLUE_MSG_BSP_PREMISE_TO_SELF_PREMISE:b.subtype="blue_msg_bsp_premise_to_self_premise";break;case f.BLUE_MSG_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_premise_unverified";break;case f.BLUE_MSG_BSP_PREMISE_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_premise_unverified_to_self_premise_verified";break;case f.BLUE_MSG_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_bsp_premise_verified";break;case f.BLUE_MSG_BSP_PREMISE_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_bsp_premise_verified_to_self_premise_unverified";break;case f.BLUE_MSG_CONSUMER_TO_BSP_FB_UNVERIFIED:b.subtype="blue_msg_consumer_to_bsp_fb_unverified";break;case f.BLUE_MSG_CONSUMER_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_consumer_to_bsp_premise_unverified";break;case f.BLUE_MSG_CONSUMER_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_consumer_to_self_fb_unverified";break;case f.BLUE_MSG_CONSUMER_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_consumer_to_self_premise_unverified";break;case f.BLUE_MSG_SELF_FB_TO_BSP_PREMISE:b.subtype="blue_msg_self_fb_to_bsp_premise";break;case f.BLUE_MSG_SELF_FB_TO_SELF_PREMISE:b.subtype="blue_msg_self_fb_to_self_premise";break;case f.BLUE_MSG_SELF_FB_UNVERIFIED:b.subtype="blue_msg_self_fb_unverified";break;case f.BLUE_MSG_SELF_FB_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_self_fb_unverified_to_bsp_premise_verified";break;case f.BLUE_MSG_SELF_FB_UNVERIFIED_TO_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_self_fb_unverified_to_self_premise_verified";break;case f.BLUE_MSG_SELF_FB_VERIFIED:b.subtype="blue_msg_self_fb_verified";break;case f.BLUE_MSG_SELF_FB_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_fb_verified_to_bsp_premise_unverified";break;case f.BLUE_MSG_SELF_FB_VERIFIED_TO_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_fb_verified_to_self_premise_unverified";break;case f.BLUE_MSG_SELF_PREMISE_TO_BSP_PREMISE:b.subtype="blue_msg_self_premise_to_bsp_premise";break;case f.BLUE_MSG_SELF_PREMISE_UNVERIFIED:b.subtype="blue_msg_self_premise_unverified";break;case f.BLUE_MSG_SELF_PREMISE_VERIFIED:b.subtype="blue_msg_self_premise_verified";break;case f.BLUE_MSG_TO_BSP_FB:b.subtype="blue_msg_to_bsp_fb";break;case f.BLUE_MSG_TO_CONSUMER:b.subtype="blue_msg_to_consumer";break;case f.BLUE_MSG_TO_SELF_FB:b.subtype="blue_msg_to_self_fb";break;case f.BLUE_MSG_UNVERIFIED_TO_BSP_FB_VERIFIED:b.subtype="blue_msg_unverified_to_bsp_fb_verified";break;case f.BLUE_MSG_UNVERIFIED_TO_BSP_PREMISE_VERIFIED:b.subtype="blue_msg_unverified_to_bsp_premise_verified";break;case f.BLUE_MSG_UNVERIFIED_TO_SELF_FB_VERIFIED:b.subtype="blue_msg_unverified_to_self_fb_verified";break;case f.BLUE_MSG_UNVERIFIED_TO_VERIFIED:b.subtype="blue_msg_unverified_to_verified";break;case f.BLUE_MSG_VERIFIED_TO_BSP_FB_UNVERIFIED:b.subtype="blue_msg_verified_to_bsp_fb_unverified";break;case f.BLUE_MSG_VERIFIED_TO_BSP_PREMISE_UNVERIFIED:b.subtype="blue_msg_verified_to_bsp_premise_unverified";break;case f.BLUE_MSG_VERIFIED_TO_SELF_FB_UNVERIFIED:b.subtype="blue_msg_verified_to_self_fb_unverified";break;case f.BLUE_MSG_VERIFIED_TO_UNVERIFIED:b.subtype="blue_msg_verified_to_unverified";break;case f.BIZ_PRIVACY_MODE_INIT_FB:b.subtype="biz_privacy_mode_init_fb";(e=b.id)!=null&&(e=e.remote)!=null&&e.isBot()&&(b.subtype="bot_init");break;case f.BIZ_PRIVACY_MODE_INIT_BSP:b.subtype="biz_privacy_mode_init_bsp";break;case f.BIZ_PRIVACY_MODE_TO_FB:b.subtype="biz_privacy_mode_to_fb";(e=b.id)!=null&&(e=e.remote)!=null&&e.isBot()&&(b.subtype="bot_init");break;case f.BIZ_PRIVACY_MODE_TO_BSP:b.subtype="biz_privacy_mode_to_bsp";break;case f.DISAPPEARING_MODE:b.subtype="disappearing_mode";break;case f.BLOCK_CONTACT:b.subtype="block_contact";break;case f.ADMIN_REVOKE:b.type="revoked";b.subtype="admin";b.kind=d("WAWebMsgType").MsgKind.RevokedMessage;b.revokeSender=b.templateParams[1]instanceof c("WAWebWid")?b.templateParams[1]:void 0;b.revokeSender||d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ProtocolParser: admin revoke came without admin JID"]))).devConsole(b.templateParams);e=b.templateParams[0];b.protocolMessageKey=(e=m(a,{remoteJid:a.key.remoteJid,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b.from),id:e,participant:a.key.participant}))==null?void 0:e.msgKey;b.templateParams=void 0;break;case f.COMMUNITY_LINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_link";break;case f.COMMUNITY_LINK_SIBLING_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sibling_group_link";break;case f.COMMUNITY_LINK_SUB_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_link";break;case f.COMMUNITY_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_create";break;case f.COMMUNITY_UNLINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_unlink";break;case f.INTEGRITY_UNLINK_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="integrity_parent_group_unlink";break;case f.COMMUNITY_UNLINK_SIBLING_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sibling_group_unlink";break;case f.COMMUNITY_UNLINK_SUB_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_unlink";break;case f.COMMUNITY_PARTICIPANT_PROMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_promote";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.COMMUNITY_PARTICIPANT_DEMOTE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="linked_group_demote";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.EPHEMERAL_KEEP_IN_CHAT:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="ephemeral_keep_in_chat";break;case f.GROUP_MEMBERSHIP_JOIN_APPROVAL_MODE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="membership_approval_mode";break;case f.GROUP_MEMBER_ADD_MODE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="member_add_mode";break;case f.GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST_NON_ADMIN_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.recipients=b.templateParams;b.subtype="created_membership_requests";break;case f.GROUP_MEMBERSHIP_JOIN_APPROVAL_REQUEST:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="membership_approval_request";break;case f.GROUP_PARTICIPANT_JOINED_GROUP_AND_PARENT_GROUP:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="auto_add";break;case f.COMMUNITY_PARENT_GROUP_DELETED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="delete_parent_group";break;case f.BIZ_CHAT_ASSIGNMENT:b.subtype="chat_assignment";break;case f.BIZ_CHAT_ASSIGNMENT_UNASSIGN:b.subtype="chat_assignment_unassign";break;case f.COMMUNITY_PARENT_GROUP_SUBJECT_CHANGED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subject";b.body=b.templateParams[1];break;case f.CAG_INVITE_AUTO_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite_auto_add";b.recipients=[d("WAWebUserPrefsMeUser").getMaybeMePnUser()];break;case f.CAG_INVITE_AUTO_JOINED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="invite_auto_add";b.recipients=b.templateParams;b.templateParams=void 0;break;case f.COMMUNITY_PARTICIPANT_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_participant_add_rich";break;case f.SUB_GROUP_PARTICIPANT_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_participant_add_rich";break;case f.SUB_GROUP_INVITE_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="sub_group_invite_rich";b.author=void 0;break;case f.COMMUNITY_INVITE_AUTO_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_invite_auto_add_rich";b.author=void 0;break;case f.COMMUNITY_INVITE_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_invite_rich";b.author=void 0;break;case f.COMMUNITY_LINK_PARENT_GROUP_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_link_parent_group_rich";break;case f.COMMUNITY_CHANGE_DESCRIPTION:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="parent_group_description";b.body=b.templateParams[0];break;case f.PINNED_MESSAGE_IN_CHAT:b.type="pinned_message";b.kind=d("WAWebMsgType").MsgKind.PinnedMessage;break;case f.COMMUNITY_ALLOW_MEMBER_ADDED_GROUPS:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="allow_non_admin_sub_group_creation";break;case f.EMPTY_SUBGROUP_CREATE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="empty_subgroup_create";break;case f.SUGGESTED_SUBGROUP_ANNOUNCE:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="created_subgroup_suggestion";break;case f.SUBGROUP_ADMIN_TRIGGERED_AUTO_ADD_RICH:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="subgroup_admin_triggered_auto_add";break;case f.GENERAL_CHAT_ADD:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="general_chat_add";break;case f.GENERAL_CHAT_AUTO_ADD_DISABLED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="general_chat_auto_add_disabled";break;case f.BIZ_BOT_1P_MESSAGING_ENABLED:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_bot_1p_disclosure";break;case f.BIZ_BOT_3P_MESSAGING_ENABLED:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_bot_3p_disclosure";break;case f.CHANGE_USERNAME:b.subtype="change_username";break;case f.BIZ_COEX_PRIVACY_INIT_SELF:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_me_account_type_is_hosted";break;case f.BIZ_COEX_PRIVACY_TRANSITION_SELF:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_me_account_type_is_hosted_transition";break;case f.BIZ_COEX_PRIVACY_INIT:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_account_type_is_hosted";break;case f.BIZ_COEX_PRIVACY_TRANSITION:if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){b.templateParams=void 0;break}b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="biz_account_type_changed_to_hosted";break;case f.SUPPORT_AI_EDUCATION:b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;b.subtype="saga_init";break;case f.EVENT_CANCELED:case f.EVENT_UPDATED:e=babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(b),{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,eventName:b.templateParams[0],eventStartTime:d("WATimeUtils").unixTime(),isEventCanceled:a.messageStubType===f.EVENT_CANCELED,protocolMessageKey:c("WANullthrows")((e=m(a,c("WANullthrows")(a.targetMessageId)))==null?void 0:e.msgKey,"Error: buildMsgKey or targetMessageId is null or missing for event edit system message history sync parsing"),editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,latestEditMsgKey:void 0,latestEditSenderTimestampMs:void 0});return e;case f.COMMUNITY_OWNER_UPDATED:b.type="gp2";b.kind=d("WAWebMsgType").MsgKind.Gp2;b.subtype="community_owner_update";break;case f.COMMUNITY_SUB_GROUP_VISIBILITY_HIDDEN:b.templateParams[0]==="on"&&(b.type="gp2",b.kind=d("WAWebMsgType").MsgKind.Gp2,b.subtype="community_hidden_group");break;case f.SUPPORT_SYSTEM_MESSAGE:d("WAWebABProps").getABPropConfigValue("support_use_dedicated_system_event")?b.subtype="support_system_message":b.subtype="biz_privacy_mode_init_fb";break;case f.BIZ_AUTOMATICALLY_LABELED_CHAT_SYSTEM_MESSAGE:b.subtype="biz_automatically_labeled_chat_system_message";b.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE;b.kind=d("WAWebMsgType").MsgKind.NotificationTemplate;break;default:b.templateParams=void 0;break}return b}g.buildMsgKey=m;g.parseWebMessageInfo=a;g.parseMsgStubProto=n}),98);
__d("WAWebAdvUpdateParticipantApi",["WAJids","WALogger","WAWebPostSenderKeyExpiredMetric","WAWebSchemaParticipant","WAWebUserPrefsMeUser","WAWebWamEnumExpiryReason","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;try{e=(yield d("WAWebSchemaParticipant").getParticipantTable().equals(["participants"],String(a)))}catch(a){a.toString().includes("Failed to read large IndexedDB value")&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateGroupParticipantsInTransaction: error: ",""])),a).sendLogs("indexeddb-participant-read-large-value");throw a}var f=e.map(function(e){var f=e.rotateKey,g=new Map(e.senderKey);c.forEach(function(b){var c;b=String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b));f=f||((c=g.get(b))!=null?c:!1);g["delete"](b)});f&&g.forEach(function(a,b){return g.set(b,!1)});b.forEach(function(b){g.set(String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b)),!1)});l(a,f,e,b,c);return babelHelpers["extends"]({},e,{senderKey:g,rotateKey:f})});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(f)});return j.apply(this,arguments)}function c(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length===0)return;var b;try{b=(yield d("WAWebSchemaParticipant").getParticipantTable().anyOf(["participants"],a.map(function(a){return String(a.wid)})))}catch(a){a.toString().includes("Failed to read large IndexedDB value")&&d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateGroupParticipantsInTransaction: error: ",""])),a).sendLogs("indexeddb-participant-bulk-read-large-value");throw a}if(b.length===0)return;var c=new Map();a.forEach(function(a){c.set(String(a.wid),a)});a=b.map(function(a){var b=a.rotateKey,e=new Map(a.senderKey);a.participants.forEach(function(f){var g=c.get(f);if(!g)return;f=g.wid;var h=g.added,i=g.removed;i.forEach(function(a){var c;a=String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(g.wid.user,g.wid.server,a));b=b||((c=e.get(a))!=null?c:!1);e["delete"](a)});b&&e.forEach(function(a,b){return e.set(b,!1)});h.forEach(function(a){e.set(String(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(g.wid.user,g.wid.server,a)),!1)});l(f,b,a,h,i)});return babelHelpers["extends"]({},a,{senderKey:e,rotateKey:b})});return d("WAWebSchemaParticipant").getParticipantTable().bulkCreateOrReplace(a)});return k.apply(this,arguments)}function l(a,b,c,e,f){if(b&&!c.rotateKey){f.includes(d("WAJids").DEFAULT_DEVICE_ID)&&e.includes(d("WAJids").DEFAULT_DEVICE_ID)?b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.IDENTITY_CHANGE:(f=d("WAWebUserPrefsMeUser").getMaybeMePnUser())!=null&&f.equals(a)?b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.PEER_COMPANION_UNPAIR:b=d("WAWebWamEnumExpiryReason").EXPIRY_REASON.OTHER_DEVICE_UNPAIR;d("WAWebPostSenderKeyExpiredMetric").postSenderKeyExpiredMetric({chatId:c.groupId,deviceCount:c.senderKey.size,expiryReason:b})}}g.updateGroupParticipantsInTransaction=a;g.bulkUpdateGroupParticipantsInTransaction=c}),98);
__d("WAWebIdentityChangeApi",["Promise","WAJids","WANullthrows","WAWebAdvUpdateParticipantApi","WAWebApiContact","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebContactSystemMsg","WAWebDeviceListPk","WAWebHandleSingleMsg","WAWebModelStorageUtils","WAWebMsgType","WAWebOfflineDeviceCache","WAWebProtobufsAdv.pb","WAWebSchemaChat","WAWebSecurityCodeApi","WAWebSendTcTokenWhenDeviceIdentityChange","WAWebSignal","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;c=(c=a.device)!=null?c:d("WAJids").DEFAULT_DEVICE_ID;a=d("WAWebWidFactory").asUserWidOrThrow(a);if(c===d("WAJids").DEFAULT_DEVICE_ID){yield j({wid:a});c=(yield d("WAWebSecurityCodeApi").addSecurityCodeChangedNotifications({user:a,offline:b}));void d("WAWebSendTcTokenWhenDeviceIdentityChange").sendTcTokenWhenDeviceIdentityChange(a);return c}});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.wid,f=a.stanzaLid;a=a.offline;var g=[d("WAJids").DEFAULT_DEVICE_ID],i=[d("WAJids").DEFAULT_DEVICE_ID],j=!1;if(a===!0)d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(String(e),null),yield d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){return d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(e,i,g)});else{a=(yield d("WAWebApiDeviceList").getDeviceRecord(e));a&&!a.deleted&&(a.devices.forEach(function(a){a.id!==d("WAJids").DEFAULT_DEVICE_ID&&g.push(a.id)}),d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.advAccountType===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(j=!0));(h||(h=b("Promise"))).all(g.map(function(a){return a===d("WAJids").DEFAULT_DEVICE_ID?(h||(h=b("Promise"))).resolve():d("WAWebSignal").Session.deleteRemoteInfo(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(e.user,e.server,a))}));yield h.all([d("WAWebModelStorageUtils").getStorage().lock(["participant"],function(){return d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(e,i,g)}),d("WAWebApiDeviceList").createOrReplaceDeviceRecord({id:d("WAWebDeviceListPk").createDeviceListPK(e),deleted:!0})]);if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&j===!0){yield d("WAWebApiContact").updateContactAdvHostedType(e,d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE);a=[e.toString()];if(e.isLid()){j=d("WAWebApiContact").getPnIfLidIsLatestMapping(e);j!=null&&a.push(j.toString())}else f!=null&&a.push(f.toString());j=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a,!1));f=j.find(Boolean);if(f!=null){a=d("WAWebWidFactory").createWid(f.id);j=d("WAWebContactSystemMsg").genNotificationMsg(a,{type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,subtype:"encrypt_now",templateParams:[]});yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:c("WANullthrows")(j.from),newMsg:j,handleSingleMsgOrigin:"bizStateChangeNotification"})}void d("WAWebBizCoexUtils").triggerUsyncForCoexUpdate(e)}}});return k.apply(this,arguments)}g.handleNewIdentity=a;g.clearDeviceRecordForIdentityChange=j}),98);
__d("WAWebAdvHostedAccountTypeSystemMsg",["WATimeUtils","WAWebBizCoexGatingUtils","WAWebMsgKey","WAWebMsgType","WAWebProtobufsAdv.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function a(a,b,e,f){f===void 0&&(f=!1);if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var g=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});if(e===d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE)return{id:b,t:d("WATimeUtils").unixTime(),type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:f&&d("WAWebBizCoexGatingUtils").hostedOverrideAdvAccountSignatureKeyEnabled()?"encrypt_now":"encrypt",from:a,to:g};else if(e===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_account_type_changed_to_hosted",from:a,to:g}}return null}function b(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_me_account_type_is_hosted",from:a,to:e}}return null}function e(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(!a.isUser())return null;var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_account_type_is_hosted",from:a,to:e}}return null}function f(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&d("WAWebBizCoexGatingUtils").smbHostedLazySystemMsgInsertInHistorySyncEnabled()&&a.isUser()){var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow();b=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:b,t:d("WATimeUtils").unixTime(),type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"biz_me_account_type_is_hosted_transition",from:a,to:e}}return null}g.genAdvAccountTypeChangeNotificationMsg=a;g.genAdvMeAccountIsHostedNotificationMsg=b;g.genAdvAccountTypeInitialSysMsg=e;g.genAdvAccountTypeSelfTransitionToCoexNotificationMsg=f}),98);
__d("WAWebAdvDeviceNotificationApi",["Promise","WALogger","WAWebAdvHostedAccountTypeSystemMsg","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebProtobufsAdv.pb","WAWebSchemaChat","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={notifications:[],chatIds:[]};if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var f=[];if(a.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()))d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["SMB unexpected self adv system msg"]))).tags("generateAdvAccountTypeChangeNotifications");else{b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["accountTypeChangeNotification: check coex cache for ",""])),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(a));try{var g=(yield d("WAWebSchemaChat").getChatTable().get(String(a),!1));g&&f.push(d("WAWebWidFactory").createWid(g.id))}catch(a){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["get chats failed during generateAdvAccountTypeChangeNotifications"]))).verbose().devConsole(a);throw c("err")("get chays failed")}}g=f.map(function(c){return d("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeChangeNotificationMsg(c,a,b,!0)}).filter(Boolean);e.notifications=g;e.chatIds=f.map(String);return e}return e});return m.apply(this,arguments)}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())throw c("err")("hosted system msg gen: unexpected env");var e=[],f=new Set();a=(yield (k||(k=b("Promise"))).all(a.map(function(a){var c=a.wid;a=a.newAdvAccountType;return a!=null?l(c,a):(k||(k=b("Promise"))).resolve(null)})));a.forEach(function(a){a&&(e=e.concat(a.notifications),a.chatIds.forEach(function(a){return f.add(a)}))});return e.length>0?{notifications:e,chatIds:Array.from(f)}:{notifications:[],chatIds:[]}});return n.apply(this,arguments)}g.bulkGenerateDeviceAndAdvAccountTypeChangeNotifications=a}),98);
__d("WAWebApiGetDeviceUpdateLock",["WAWebBizCoexGatingUtils","WAWebModelStorageUtils"],(function(a,b,c,d,e,f,g){function a(a,b,c,e){c===void 0&&(c=!1);e===void 0&&(e=!1);var f=["participant","device-list"];b&&(f=[].concat(f,["message","message-association"]));c&&(f=[].concat(f,["missing-keys"]));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(e&&(f=[].concat(f,["contact"])));return d("WAWebModelStorageUtils").getStorage().lock(f,function(){return a()})}g.getDeviceUpdateLock=a}),98);
__d("WAWebCollectionVersionStore",["WAWebSchemaCollectionVersion"],(function(a,b,c,d,e,f,g){a=function(){function a(){}var b=a.prototype;b.get=function(a){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().get(a)};b.bulkGet=function(a){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().bulkGet(a)};b.getAll=function(){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().all()};b.update=function(a,b){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().createOrMerge(a,babelHelpers["extends"]({collection:a},b))};b.bulkUpdate=function(a){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().bulkCreateOrMerge(a)};b.clear=function(){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().clear()};return a}();a.locks=["collection-version"];g.WAWebCollectionVersionStore=a}),98);
__d("WAWebSyncdDb",["WALogger","WASyncAction.pb","WASyncdKeyTypes","WAWebSchemaCollectionVersion","WAWebSchemaMissingKeys","WAWebSchemaPendingMutations","WAWebSchemaSyncActions","WAWebSchemaSyncKeys","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().all()}function c(a,b){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().equals(a,b)}function e(a,b){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().equals(a,b)}function f(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: adding pending mutations:\n  ",""])),JSON.stringify(a.map(function(a){return{operation:a.operation,index:a.index,value:d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,a.binarySyncAction)}}),null,2));return d("WAWebSchemaPendingMutations").getPendingMutationsTable().bulkCreate(a)}function i(a){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().bulkRemove(a)}function j(a,b,c){return d("WAWebSchemaCollectionVersion").getCollectionVersionTable().createOrMerge(a,{collection:a,version:b,ltHash:c})}function k(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().get(a)}function l(a,b){return d("WAWebSchemaSyncActions").getSyncActionsTable().anyOf(a,b)}function m(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().createOrReplace(a)}function n(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkCreateOrReplace(a)}function o(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkCreateOrMerge(a.map(function(a){return babelHelpers["extends"]({},a)}))}function p(a){return d("WAWebSchemaSyncActions").getSyncActionsTable().bulkRemove(a)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaSyncKeys").getSyncKeysTable().get(new Uint8Array(d("WASyncdKeyTypes").fromSyncKeyId(a))));return a==null?a:d("WAWebSchemaSyncKeys").convertToSyncKeyFromRow(a)});return r.apply(this,arguments)}function s(){return d("WAWebSchemaSyncKeys").getSyncKeysTable().all().then(function(a){return a.map(d("WAWebSchemaSyncKeys").convertToSyncKeyFromRow)})}function t(a){return d("WAWebSchemaSyncKeys").getSyncKeysTable().createOrReplace(d("WAWebSchemaSyncKeys").convertFromSyncKeyToRow(a)).then(function(a){return d("WASyncdKeyTypes").toSyncKeyId(a.buffer)})}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaSyncKeys").getSyncKeysTable().equals(["keyEpoch"],a));a.forEach(function(a){return d("WAWebSchemaSyncKeys").getSyncKeysTable().merge({keyId:a.keyId},{timestamp:0})})});return v.apply(this,arguments)}function w(){return d("WAWebSchemaMissingKeys").getMissingKeysTable().count()}function x(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkGet(a).then(function(a){return a.map(function(a){return a==null?null:d("WAWebSchemaMissingKeys").convertToMissingKeyFromRow(a)})})}function y(){return d("WAWebSchemaMissingKeys").getMissingKeysTable().all().then(function(a){return a.map(d("WAWebSchemaMissingKeys").convertToMissingKeyFromRow)})}function z(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkRemove(a)}function A(a){return d("WAWebSchemaMissingKeys").getMissingKeysTable().bulkCreateOrMerge(a.map(d("WAWebSchemaMissingKeys").convertFromMissingKeyToRow))}g.getAllPendingMutationsRows=a;g.getPendingMutationsRows=c;g.getPendingMutationsRowsByIndex=e;g.appendPendingMutationsRows=f;g.bulkRemovePendingMutations=i;g.setCollectionVersion=j;g.getSyncAction=k;g.getSyncActionsRows=l;g.setSyncAction=m;g.setSyncActionRows=n;g.updateSyncActionRows=o;g.deleteSyncActionRows=p;g.getSyncKey=q;g.getAllSyncKeys=s;g.createSyncKey=t;g.expireSyncKey=u;g.getMissingKeyCount=w;g.bulkGetMissingKeys=x;g.getAllMissingKeys=y;g.bulkRemoveMissingKeys=z;g.createOrUpdateMissingKeys=A}),98);
__d("WAWebMissingKeyStore",["WAWebSchemaMissingKeys","WAWebSyncdDb"],(function(a,b,c,d,e,f,g){a=function(){function a(){}var b=a.prototype;b.getAll=function(){return d("WAWebSyncdDb").getAllMissingKeys()};b.bulkGet=function(a){return d("WAWebSyncdDb").bulkGetMissingKeys(a)};b.count=function(){return d("WAWebSyncdDb").getMissingKeyCount()};b.bulkUpdate=function(a){return d("WAWebSyncdDb").createOrUpdateMissingKeys(a)};b.bulkRemove=function(a){return d("WAWebSyncdDb").bulkRemoveMissingKeys(a)};b.clear=function(){return d("WAWebSchemaMissingKeys").getMissingKeysTable().clear()};return a}();a.locks=["missing-keys"];g.WAWebMissingKeyStore=a}),98);
__d("WAWebPendingMutationStore",["WAWebNoop","WAWebSchemaPendingMutations","WAWebSyncdDb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=function(){function a(){}var e=a.prototype;e.getByCollection=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getPendingMutationsRows(["collection"],a));return a.map(d("WAWebSchemaPendingMutations").convertToPendingMutationFromRow)});function c(b){return a.apply(this,arguments)}return c}();e.getAll=function(){return d("WAWebSyncdDb").getAllPendingMutationsRows()};e.bulkCreate=function(a){return d("WAWebSyncdDb").appendPendingMutationsRows(a).then(c("WAWebNoop"))};e.bulkRemove=function(a){return d("WAWebSyncdDb").bulkRemovePendingMutations(a)};e.clear=function(){return d("WAWebSchemaPendingMutations").getPendingMutationsTable().clear()};return a}();a.locks=["pending-mutations"];g.WAWebPendingMutationStore=a}),98);
__d("WAWebSyncActionStore",["Promise","WAWebSchemaSyncActions","WAWebSyncdDb","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var c=a.prototype;c.count=function(){return d("WAWebSchemaSyncActions").getSyncActionsTable().count()};c.get=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getSyncAction(a));return a==null?null:d("WAWebSchemaSyncActions").convertToSyncActionFromRow(a)});function c(b){return a.apply(this,arguments)}return c}();c.getByCollections=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getSyncActionsRows(["collection"],a.map(function(a){return a})));return a.map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)});function c(b){return a.apply(this,arguments)}return c}();c.getByIndexMacs=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return a.length<7?this.getByIndexMacsMultiQuery(a):this.getByIndexMacsSingleQuery(a)});function c(b){return a.apply(this,arguments)}return c}();c.getByIndexMacsMultiQuery=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).all(a.map(function(a){return d("WAWebSyncdDb").getSyncActionsRows(["indexMac"],[a])})));return a.flat().map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)});function c(b){return a.apply(this,arguments)}return c}();c.getByIndexMacsSingleQuery=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getSyncActionsRows(["indexMac"],a.map(function(a){return a})));return a.map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)});function c(b){return a.apply(this,arguments)}return c}();c.getByActionStates=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getSyncActionsRows(["actionState"],a.map(function(a){return a})));return a.map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)});function c(b){return a.apply(this,arguments)}return c}();c.getByModelInfos=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSyncdDb").getSyncActionsRows(["modelId","modelType","actionState"],a.map(function(a){return a})));return a.map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)});function c(b){return a.apply(this,arguments)}return c}();c.getAll=function(){return d("WAWebSchemaSyncActions").getSyncActionsTable().all().then(function(a){return a.map(d("WAWebSchemaSyncActions").convertToSyncActionFromRow)})};c.bulkSet=function(a){return d("WAWebSyncdDb").setSyncActionRows(a.map(d("WAWebSchemaSyncActions").convertFromSyncActionToRow))};c.bulkUpdate=function(a){return d("WAWebSyncdDb").updateSyncActionRows(a.map(d("WAWebSchemaSyncActions").convertFromSyncActionToRow))};c.bulkRemove=function(a){return d("WAWebSyncdDb").deleteSyncActionRows(a)};c.clear=function(){return d("WAWebSchemaSyncActions").getSyncActionsTable().clear()};return a}();a.locks=["sync-actions"];g.WAWebSyncActionStore=a}),98);
__d("WAWebSyncKeyStore",["WAWebNoop","WAWebSchemaSyncKeys","WAWebSyncdDb"],(function(a,b,c,d,e,f,g){a=function(){function a(){}var b=a.prototype;b.get=function(a){return d("WAWebSyncdDb").getSyncKey(a)};b.getAll=function(){return d("WAWebSyncdDb").getAllSyncKeys()};b.set=function(a){return d("WAWebSyncdDb").createSyncKey(a).then(c("WAWebNoop"))};b.expire=function(a){return d("WAWebSyncdDb").expireSyncKey(a)};b.clear=function(){return d("WAWebSchemaSyncKeys").getSyncKeysTable().clear()};return a}();a.locks=["sync-keys"];g.WAWebSyncKeyStore=a}),98);
__d("WAWebRunInTransaction",["Promise","WAWeb-dexie","WAWebCollectionVersionStore","WAWebMissingKeyStore","WAWebModelStorageUtils","WAWebPendingMutationStore","WAWebSyncActionStore","WAWebSyncKeyStore","err"],(function(a,b,c,d,e,f,g){var h,i={SyncActionStore:d("WAWebSyncActionStore").WAWebSyncActionStore,CollectionVersionStore:d("WAWebCollectionVersionStore").WAWebCollectionVersionStore,PendingMutationStore:d("WAWebPendingMutationStore").WAWebPendingMutationStore,MissingKeyStore:d("WAWebMissingKeyStore").WAWebMissingKeyStore,SyncKeyStore:d("WAWebSyncKeyStore").WAWebSyncKeyStore};a=function(a,e){if(c("WAWeb-dexie").currentTransaction!=null)return(h||(h=b("Promise"))).reject(c("err")("Calling runInTransaction recursively. This is not allowed."));var f=Object.keys(a);a=f.flatMap(function(a){return i[a].locks});return d("WAWebModelStorageUtils").getStorage().lock(a,function(){var a={};for(var b of f)a[b]=new i[b]();return e(a)})};g.runInTransaction=a}),98);
__d("WAWebGetMissingKey",["WAWebRunInTransaction"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.getAll()})}function b(a){return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkGet(a)})}function c(){return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return a.count()})}function e(a){return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(b){b=b.MissingKeyStore;return b.bulkUpdate(a)})}g.getAllMissingKeysInTransaction=a;g.bulkGetMissingKeysInTransaction=b;g.getMissingKeyCountTransaction=c;g.bulkUpdateMissingKeysInTransaction=e}),98);
__d("WAWebGetSyncKey",["WAWebRunInTransaction"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAWebRunInTransaction").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.get(a)})}function b(){return d("WAWebRunInTransaction").runInTransaction({SyncKeyStore:!0},function(a){a=a.SyncKeyStore;return a.getAll()})}function c(a){return d("WAWebRunInTransaction").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.set(a)})}function e(a){return d("WAWebRunInTransaction").runInTransaction({SyncKeyStore:!0},function(b){b=b.SyncKeyStore;return b.expire(a)})}g.getSyncKeyInTransaction_DO_NOT_USE=a;g.getAllSyncKeysInTransaction=b;g.setSyncKeyInTransaction=c;g.expireSyncKeyInTransaction=e}),98);
__d("WAWebSyncdCryptoUtils",["WACryptoUtils","WASyncdKeyTypes","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a.length===0)throw c("err")("buffers length is zero");if(a.length===1)return a[0];var b=a.map(function(a){return a.byteLength});b=b.reduce(function(a,b){return a+b});b=new Uint8Array(b);var d=0,e;for(e=0;e<a.length;e++)b.set(new Uint8Array(a[e]),d),d+=a[e].byteLength;return b.buffer}function b(a,b,d){if(b<0||d<0)throw c("err")("buffers length is zero");var e=new Array(3);a=new Uint8Array(a);e[0]=a.slice(0,b).buffer;e[1]=a.slice(b,b+d).buffer;e[2]=a.slice(b+d).buffer;return e}function e(a){return Uint8Array.from(a.split(" ").map(function(a){return parseInt(a,16)}))}function f(a){return Array.from(new Uint8Array(d("WASyncdKeyTypes").fromSyncKeyId(a))).map(function(a){return a.toString(16)}).toString().replace(/,/g," ")}function h(a){return Array.from(new Uint8Array(a)).map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function i(a){var b=new ArrayBuffer(8);new DataView(b).setUint32(4,a,!1);return b}function j(a,b){return d("WACryptoUtils").arrayBuffersEqual(d("WASyncdKeyTypes").fromSyncKeyId(a),d("WASyncdKeyTypes").fromSyncKeyId(b))}g.combine=a;g.split=b;g.hexToUint8Array=e;g.syncKeyIdToHex=f;g.arrayBufferToHexPadded=h;g.to64BitNetworkOrder=i;g.syncKeyIdsEqual=j}),98);
__d("WAWebSyncdGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("syncd_key_max_use_days")}function b(){return d("WAWebABProps").getABPropConfigValue("syncd_sentinel_timeout_seconds")}function c(){return d("WAWebABProps").getABPropConfigValue("syncd_inline_mutations_max_count")}function e(){return d("WAWebABProps").getABPropConfigValue("syncd_patch_protobuf_max_size")}function f(){return d("WAWebABProps").getABPropConfigValue("syncd_wait_for_key_timeout_days")}g.getSyncdKeyMaxUseDays=a;g.getSyncdSentinelTimeoutSeconds=b;g.getSyncdInlineMutationsMaxCount=c;g.getSyncdPatchProtobufMaxSize=e;g.getSyncdWaitForKeyTimeoutDays=f}),98);
__d("WASyncdConst",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";a=1e3;c=1e3*60*60;e=2;f=d("WATimeUtils").DAY_MILLISECONDS*2;d=100;var h=2e3,i=10,j=100,k=0,l=3,m=7,n=0,o=(b=b("$InternalEnum"))({Star:"star",Contact:"contact",Mute:"mute",PinDEPRECATED:"pin",Pin:"pin_v1",SettingPushName:"setting_pushName",LabelEdit:"label_edit",LabelMessage:"label_message",LabelJid:"label_jid",QuickReply:"quick_reply",LocaleSetting:"setting_locale",Archive:"archive",MarkChatAsRead:"markChatAsRead",ClearChat:"clearChat",DeleteMessageForMe:"deleteMessageForMe",Sentinel:"sentinel",UnarchiveChatsSetting:"setting_unarchiveChats",DeleteChat:"deleteChat",AndroidUnsupportedActions:"android_unsupported_actions",PrimaryFeature:"primary_feature",Subscription:"subscription",Nux:"nux",Agent:"deviceAgent",TimeFormat:"time_format",UserStatusMute:"userStatusMute",PrimaryVersion:"primary_version",RemoveRecentSticker:"removeRecentSticker",ChatAssignment:"agentChatAssignment",ChatAssignmentOpenedStatus:"agentChatAssignmentOpenedStatus",FavoriteSticker:"favoriteSticker",PnForLidChat:"pnForLidChat",ShareOwnPn:"shareOwnPn",ExternalWebBeta:"external_web_beta",MarketingMessage:"marketingMessage",MarketingMessageBroadcast:"marketingMessageBroadcast",StatusPrivacy:"status_privacy",BotWelcomeRequest:"bot_welcome_request",LabelReordering:"label_reordering",PaymentInfo:"payment_info",CustomPaymentMethods:"custom_payment_methods",LockChat:"lock",ChatLockSettings:"setting_chatLock",DeviceCapabilities:"device_capabilities",DisableLinkPreviews:"setting_disableLinkPreviews",NoteEdit:"note_edit",Favorites:"favorites",MerchantPaymentPartner:"merchant_payment_partner",AvatarUpdated:"avatar_updated_action",VoipRelayAllCalls:"setting_relayAllCalls",CallLog:"call_log",WaffleAccountLinkState:"waffle_account_link_state",PaymentTos:"payment_tos",Broadcast:"broadcast",BroadcastJid:"broadcast_jid",BusinessBroadcastList:"business_broadcast_list",DetectedOutcomeStatus:"detected_outcomes_status_action",GalaxyFlow:"galaxy_flow_action",LidContact:"lid_contact"}),p=b({Regular:"regular",RegularLow:"regular_low",RegularHigh:"regular_high",CriticalBlock:"critical_block",CriticalUnblockLow:"critical_unblock_low"}),q=b.Mirrored(["Success","SuccessHasMore","Conflict","ConflictHasMore","ErrorRetry","ErrorFatal","Blocked"]),r=b.Mirrored(["UpToDate","Dirty","FailingFiniteRetry","Fatal","Blocked"]),s=b.Mirrored(["Success","Malformed","Orphan","Unsupported","Skipped","Failed"]),t=b.Mirrored(["Msg","Chat","Agent","ChatAssignment","UserStatusMute","Account","FavoriteSticker"]),u=b.Mirrored(["ApplyRemoteAndDropLocal","SkipRemote","SkipRemoteAndDropLocal"]);b=b.Mirrored(["Patch","Snapshot","Local"]);g.BACKOFF_MIN_TIMEOUT=a;g.BACKOFF_MAX_TIMEOUT=c;g.BACKOFF_BASE=e;g.FINITE_FAILURE_EXPIRY_DURATION=f;g.MIN_INLINE_MUTATIONS=d;g.MAX_INLINE_MUTATIONS=h;g.MIN_PATCH_SIZE=i;g.MAX_PATCH_SIZE=j;g.DEFAULT_COLLECTION_VERSION=k;g.LABEL_ASSOCIATION_SYNC_VERSION=l;g.CHAT_ASSIGNMENT_SYNC_VERSION=m;g.MUTATION_NAME_INDEX=n;g.Actions=o;g.CollectionName=p;g.CollectionState=q;g.CollectionSyncState=r;g.SyncActionState=s;g.SyncModelType=t;g.ConflictResolutionState=u;g.SyncDataType=b}),98);
__d("WAWebWamEnumIsPureSyncdSessionEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:1,YES:2,NO:3,PROBABLY_YES:4,PROBABLY_NO:5});f.IS_PURE_SYNCD_SESSION_ENUM=a}),66);
__d("WAWebWamEnumLidMigrationStageEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({NOT_MIGRATED:1,PEER_MIGRATED:2,HISTORY_MIGRATED:3});f.LID_MIGRATION_STAGE_ENUM=a}),66);
__d("WAWebWamEnumRecoveryStatusEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIMARY_UNSUPPORTED:1,ABPROP_OFF:2,NOT_FATAL:3,COLLECTION_UNSUPPORTED:4,MUTATION_COUNT_TOO_HIGH:5,PRIMARY_DID_NOT_RESPOND:6});f.RECOVERY_STATUS_ENUM=a}),66);
__d("WAWebSyncdMetricFatalError",["$InternalEnum","WALogger","WAPREList","WAPREMetrics","WASyncdConst","WAWebWamEnumIsPureSyncdSessionEnum","WAWebWamEnumLidMigrationStageEnum","WAWebWamEnumRecoveryStatusEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(a,b){b=Object.values(b);return b.find(function(b){return b===a})}var m=b("$InternalEnum").Mirrored(["PATCH_PROTOBUF_SERIALIZATION_FAILED","MUTATIONS_PROTOBUF_SERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_SERIALIZATION_FAILED","ENCRYPTION_FAILED","MISSING_SNAPSHOT_VERSION","MISSING_SNAPSHOT_MAC","MISSING_SNAPSHOT_KEY_ID","MISSING_PATCH_VERSION","PATCH_WITH_BOTH_INLINE_AND_EXTERNAL_MUTATIONS","MISSING_PATCH_SNAPSHOT_MAC","MISSING_PATCH_MAC","MISSING_PATCH_KEY_ID","MISSING_EXTERNAL_BLOB_REFERENCE_MEDIA_KEY","MISSING_EXTERNAL_BLOB_REFERENCE_DIRECT_PATH","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_SHA256","MISSING_EXTERNAL_BLOB_REFERENCE_FILE_ENC_SHA256","MISSING_MUTATION_OPERATION","MISSING_MUTATION_RECORD","MISSING_MUTATION_INDEX","MISSING_MUTATION_VALUE","MISSING_MUTATION_KEY_ID","EXTERNAL_BLOB_REFERENCE_PROTOBUF_DESERIALIZATION_FAILED","SNAPSHOT_PROTOBUF_DESERIALIZATION_FAILED","PATCH_PROTOBUF_DESERIALIZATION_FAILED","MUTATIONS_PROTOBUF_DESERIALIZATION_FAILED","ACTION_DATA_PROTOBUF_DESERIALIZATION_FAILED","MISSING_ACTION_INDEX","MISSING_ACTION_VERSION","SNAPSHOT_MAC_MISMATCH_IN_SNAPSHOT","SNAPSHOT_MAC_MISMATCH_IN_PATCH","MAC_MISMATCH_PATCH","DECRYPTION_FAILED","DUPLICATE_PATCH_VERSION_IN_COLLECTION","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_PATCH","SAME_INDEX_FOR_MULTIPLE_MUTATIONS_IN_SNAPSHOT","MISSING_ACTION_VALUE","MISSING_ACTION_TIMESTAMP","XMPP_BAD_REQUEST_FOR_COLLECTION","XMPP_NOT_FOUND_FOR_COLLECTION","CYCLIC_MUTATION_DEPENDENCY_IN_PATCH","SERVER_DID_NOT_SEND_ALL_PATCHES","TERMINAL_PATCH_MISSING_DATA","TERMINAL_PATCH_DESERIALIZATION_ERROR","TERMINAL_PATCH_UNKNOWN","INVALID_ACTION_INDEX","XMPP_BAD_REQUEST_GLOBAL_ERROR","XMPP_NOT_FOUND_GLOBAL_ERROR","XMPP_BAD_METHOD_GLOBAL_ERROR","XMPP_NOT_ACCEPTABLE_GLOBAL_ERROR","TOO_MANY_INTERNAL_SERVER_ERRORS_IN_7D","TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY","MISSING_KEY_ON_ALL_CLIENTS"]),n=[];function a(a,b){b===void 0&&(b=!0);while(n.length>0){var c=n.pop();if(c==null)continue;b&&(c.recoveryStatus=d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM.PRIMARY_DID_NOT_RESPOND);c.recoveryRequestDurationMs=a;c.isFatal=b;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: flush fatal error after failed shapshot recovery: ",""])),c.type);d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_FATAL_ERROR).endFail("syncd fatal error: "+c.type,o(c))}}function c(a,b,c){if(c===!0){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: deferring fatal error due to inflight shapshot recovery: ",""])),a);n.push(babelHelpers["extends"]({type:a},b));return}d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.SYNCD_FATAL_ERROR).endFail("syncd fatal error: "+a,o(babelHelpers["extends"]({type:a},b)))}function o(a){var b=a.type,c=a.collection,d=a.patchSnapshotMutationCount,e=a.patchVersion,f=a.isFatal,g=a.isLtHashConsistent,h=a.macFatalCollectionNameMismatch,i=a.macFatalCurrentLthashMismatch,j=a.macFatalNewLthashMismatch,k=a.macFatalPatchVersionMismatch,l=a.macFatalNewLthashSubtractMismatch,m=a.macFatalNumberHasOverrideMutation,n=a.macFatalNumberNumAddMutation,o=a.macFatalNumberNumRemoveMutation,p=a.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,q=a.isPatchSenderPrimary,r=a.macFatalDidUseMacFetchFallback,s=a.macFatalHasMissingRemove,t=a.macFatalNumberAddMismatch,u=a.macFatalNumberRemoveMismatch,v=a.macFatalDidPreviousPatchFailPostSaveValidation,w=a.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,x=a.isPreviousPatchAnIncomingPatch,y=a.isLastPatchSenderAPrimaryDevice,z=a.isSenderIndexSameAsPreviousSenderIndex,A=a.didBootstrapFromSnapshot,B=a.isThereAnotherSyncdCompanion,C=a.isPureSyncdSession,D=a.lidMigrationStage,E=a.recoveryRequestDurationMs;a=a.recoveryStatus;return{string:{errorCode:b,collection:c==null?null:c},"int":{patchSnapshotMutationCount:d,patchVersion:e,macFatalNumberNumAddMutation:n,macFatalNumberNumRemoveMutation:o,isPureSyncdSession:C,lidMigrationStage:D,recoveryRequestDurationMs:E,recoveryStatus:a},bool:{isFatal:f,isLtHashConsistent:g,macFatalCollectionNameMismatch:h,macFatalCurrentLthashMismatch:i,macFatalNewLthashMismatch:j,macFatalPatchVersionMismatch:k,macFatalNewLthashSubtractMismatch:l,macFatalNumberHasOverrideMutation:m,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:p,isPatchSenderPrimary:q,macFatalDidUseMacFetchFallback:r,macFatalHasMissingRemove:s,macFatalNumberAddMismatch:t,macFatalNumberRemoveMismatch:u,macFatalDidPreviousPatchFailPostSaveValidation:v,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:w,isPreviousPatchAnIncomingPatch:x,isLastPatchSenderAPrimaryDevice:y,isSenderIndexSameAsPreviousSenderIndex:z,didBootstrapFromSnapshot:A,isThereAnotherSyncdCompanion:B}}}function e(a){var b,c,e,f,g,h,i,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=a==null||(b=a.string)==null?void 0:b.errorCode;if(L==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing error code for syncd fatal error"])));return null}var M=m.cast(L);if(M==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: unknown error code: "," for syncd fatal error"])),L);return null}return{type:M,collection:d("WASyncdConst").CollectionName.cast(a==null||(c=a.string)==null?void 0:c.collection),patchSnapshotMutationCount:a==null||(e=a["int"])==null?void 0:e.patchSnapshotMutationCount,patchVersion:a==null||(f=a["int"])==null?void 0:f.patchVersion,isFatal:a==null||(g=a.bool)==null?void 0:g.isFatal,isLtHashConsistent:a==null||(h=a.bool)==null?void 0:h.isLtHashConsistent,macFatalCollectionNameMismatch:a==null||(i=a.bool)==null?void 0:i.macFatalCollectionNameMismatch,macFatalCurrentLthashMismatch:a==null||(n=a.bool)==null?void 0:n.macFatalCurrentLthashMismatch,macFatalNewLthashMismatch:a==null||(o=a.bool)==null?void 0:o.macFatalNewLthashMismatch,macFatalPatchVersionMismatch:a==null||(p=a.bool)==null?void 0:p.macFatalPatchVersionMismatch,macFatalNewLthashSubtractMismatch:a==null||(q=a.bool)==null?void 0:q.macFatalNewLthashSubtractMismatch,macFatalNumberHasOverrideMutation:a==null||(r=a.bool)==null?void 0:r.macFatalNumberHasOverrideMutation,macFatalNumberNumAddMutation:a==null||(s=a["int"])==null?void 0:s.macFatalNumberNumAddMutation,macFatalNumberNumRemoveMutation:a==null||(t=a["int"])==null?void 0:t.macFatalNumberNumRemoveMutation,macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch:a==null||(u=a.bool)==null?void 0:u.macFatalSenderCurrentLthashToLocalCalculatedCurrentLthashMismatch,isPatchSenderPrimary:a==null||(v=a.bool)==null?void 0:v.isPatchSenderPrimary,macFatalDidUseMacFetchFallback:a==null||(w=a.bool)==null?void 0:w.macFatalDidUseMacFetchFallback,macFatalHasMissingRemove:a==null||(x=a.bool)==null?void 0:x.macFatalHasMissingRemove,macFatalNumberAddMismatch:a==null||(y=a.bool)==null?void 0:y.macFatalNumberAddMismatch,macFatalNumberRemoveMismatch:a==null||(z=a.bool)==null?void 0:z.macFatalNumberRemoveMismatch,macFatalDidPreviousPatchFailPostSaveValidation:a==null||(A=a.bool)==null?void 0:A.macFatalDidPreviousPatchFailPostSaveValidation,macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash:a==null||(B=a.bool)==null?void 0:B.macFatalPreviousPatchNewLthashToCurrentPatchCurrentLthash,isPreviousPatchAnIncomingPatch:a==null||(C=a.bool)==null?void 0:C.isPreviousPatchAnIncomingPatch,isLastPatchSenderAPrimaryDevice:a==null||(D=a.bool)==null?void 0:D.isLastPatchSenderAPrimaryDevice,isSenderIndexSameAsPreviousSenderIndex:a==null||(E=a.bool)==null?void 0:E.isSenderIndexSameAsPreviousSenderIndex,didBootstrapFromSnapshot:a==null||(F=a.bool)==null?void 0:F.didBootstrapFromSnapshot,isThereAnotherSyncdCompanion:a==null||(G=a.bool)==null?void 0:G.isThereAnotherSyncdCompanion,isPureSyncdSession:l(a==null||(H=a["int"])==null?void 0:H.isPureSyncdSession,d("WAWebWamEnumIsPureSyncdSessionEnum").IS_PURE_SYNCD_SESSION_ENUM),lidMigrationStage:l(a==null||(I=a["int"])==null?void 0:I.lidMigrationStage,d("WAWebWamEnumLidMigrationStageEnum").LID_MIGRATION_STAGE_ENUM),recoveryRequestDurationMs:a==null||(J=a["int"])==null?void 0:J.recoveryRequestDurationMs,recoveryStatus:l(a==null||(K=a["int"])==null?void 0:K.recoveryStatus,d("WAWebWamEnumRecoveryStatusEnum").RECOVERY_STATUS_ENUM)}}g.SyncdFatalErrorType=m;g.flushDeferredFatalError=a;g.reportSyncdFatalError=c;g.convertSyncdFatalErrorFromAnnotations=e}),98);
__d("WAWebSyncdStoreMissingKeys",["Promise","WAAsyncSleep","WALogger","WATimeUtils","WAWebBackendApi","WAWebGetMissingKey","WAWebGetSyncKey","WAWebRunInTransaction","WAWebSyncdCryptoUtils","WAWebSyncdGatingUtils","WAWebSyncdMetricFatalError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;function a(){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebBackendApi").frontendSendAndReceive("getDeviceFingerprint",{})).deviceIndexes;return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){c=c.MissingKeyStore;var d=(yield c.getAll());if(d.length===0)return(v||(v=b("Promise"))).resolve();d.forEach(function(b){var c=b.deviceResponses;c.forEach(function(c,d){a.includes(d)||b.deviceResponses["delete"](d)})});yield c.bulkUpdate(d);yield F({MissingKeyStore:c})});return function(a){return c.apply(this,arguments)}}())});return x.apply(this,arguments)}function c(a,c){var e=[],f=[];a.forEach(function(a){var b=a.keyData;a=d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId);b?e.push(a):f.push(a)});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys from device ","\n    \tkeys with keyData: ","\n    \tkeys without keyData: ",""],["syncd: updateMissingKeys from device ","\n    \\tkeys with keyData: ","\n    \\tkeys without keyData: ",""])),c,e,f);return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.MissingKeyStore;e.length>0&&(yield a.bulkRemove(e),yield z({MissingKeyStore:a}));if(f.length>0){var b=(yield a.bulkGet(f)).filter(Boolean);b.forEach(function(a){return a.deviceResponses.set(c,!1)});d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \tmissingKeys: [","]"],["syncd: updateMissingKeys: begin updating missing keys from device ","\n      \\tmissingKeys: [","]"])),c,f);yield a.bulkUpdate(b);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeys: finish updating missing keys from device ",""])),c);yield F({MissingKeyStore:a})}});return function(b){return a.apply(this,arguments)}}())}function y(){return d("WAWebRunInTransaction").runInTransaction({MissingKeyStore:!0},function(a){a=a.MissingKeyStore;return z({MissingKeyStore:a})})}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.MissingKeyStore;clearTimeout(w);w=null;a=(yield a.getAll());if(a.length===0)return;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["syncd: _setMissingKeyTimeout: missing keys: ",""])),a.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));a=a.reduce(function(a,b){return a.timestamp<b.timestamp?a:b});var b=d("WAWebSyncdGatingUtils").getSyncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS-(-a.timestamp+d("WATimeUtils").unixTimeMs());d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: earliest missing key: ",", timestamp=",", timeoutMs=",""])),d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId),a.timestamp,b);w=setTimeout(B,b)});return A.apply(this,arguments)}function B(){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey"])));if(!(yield D())){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["syncd: _timeoutWhileWaitingForMissingKey: no expired keys"])));return}d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.TIMEOUT_WHILE_WAITING_FOR_MISSING_KEY);d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: timeout while waiting for missing key"]))).sendLogs("syncd fatal error: timeout while waiting for missing key");void d("WAWebBackendApi").frontendFireAndForget("handleSyncdFatal",{})});return C.apply(this,arguments)}function D(){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["syncd: check if has expired keys"])));var a=(yield d("WAWebGetSyncKey").getAllSyncKeysInTransaction()).map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)});d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["syncd: all keys: ",""])),a);var b=(yield d("WAWebGetMissingKey").getAllMissingKeysInTransaction());d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing keys: ",""])),b.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));var c=b.filter(function(b){return!a.includes(b.keyHex)});d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncd: actually missing keys: ",""])),b.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));b=c.filter(function(a){return d("WAWebSyncdGatingUtils").getSyncdWaitForKeyTimeoutDays()*d("WATimeUtils").DAY_MILLISECONDS<d("WATimeUtils").unixTimeMs()-a.timestamp});d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["syncd: expired keys: ",""])),b.map(function(a){return d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a.keyId)}));return b.length>0});return E.apply(this,arguments)}function F(a){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.MissingKeyStore;a=(yield a.getAll());for(a of a){var b=!0;for(var c of a.deviceResponses.values())if(c==null){b=!1;break}if(b){d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["syncd: fatal error: missing key on all clients"]))).sendLogs("syncd: fatal error: missing key on all clients");d("WAWebSyncdMetricFatalError").reportSyncdFatalError(d("WAWebSyncdMetricFatalError").SyncdFatalErrorType.MISSING_KEY_ON_ALL_CLIENTS);yield d("WAAsyncSleep").asyncSleep(5e3);void d("WAWebBackendApi").frontendFireAndForget("handleSyncdFatal",{});return}}});return G.apply(this,arguments)}function e(a,b){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=function(){var a=new Map();b.forEach(function(b){return a.set(b,null)});return a};a=a.map(function(a){return{keyHex:d("WAWebSyncdCryptoUtils").syncKeyIdToHex(a),keyId:a,timestamp:d("WATimeUtils").unixTimeMs(),deviceResponses:c()}});yield d("WAWebGetMissingKey").bulkUpdateMissingKeysInTransaction(a);yield y()});return H.apply(this,arguments)}g.updateMissingKeyDevices=a;g.updateMissingKeys=c;g.setMissingKeyTimeoutInTransaction=y;g.hasExpiredKeys=D;g.addMissingKeys=e}),98);
__d("WAWebIdentityUpdateDeviceTableApi",["Promise","WAJids","WALogger","WAWebAdvDeviceNotificationApi","WAWebAdvUpdateParticipantApi","WAWebApiContact","WAWebApiDeviceList","WAWebApiGetDeviceUpdateLock","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebBizCoexUtils","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebDeviceListPk","WAWebGetMessageCache","WAWebProtobufsAdv.pb","WAWebSignalSessionApi","WAWebSyncdStoreMissingKeys","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function o(a,b){if(d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){if(a==null)return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED?b:null;switch(a){case d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED:return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE?b:null;case d("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE:return b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED?b:null}}if(b===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)throw c("err")("Unexpected account type");return null}function a(a,b,c,d,e){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j){f===void 0&&(f=!1);yield (n||(n=b("Promise"))).all(e.filter(function(a){return a.id!==d("WAJids").DEFAULT_DEVICE_ID}).map(function(b){return t(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,b.id))}));var k=[],l=e.map(function(a){return a.id}).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID}),m=o(g,j);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&m===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["clearDeviceRecord: check coex cache for ",""])),a==null?void 0:a.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(a),yield d("WAWebUserPrefsMultiDevice").setHaveProcessedCoexAdv());e=(yield r([{wid:a,added:k,removed:l,isNewRecord:!1,newAdvAccountType:m}],f,m!=null));var p=e.encryptedNotifications,q=e.chatIds;yield d("WAWebApiGetDeviceUpdateLock").getDeviceUpdateLock(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=p.length>0?d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(p,[],q,!1):(n||(n=b("Promise"))).resolve(),f=d("WAWebAdvUpdateParticipantApi").updateGroupParticipantsInTransaction(a,k,l),g={id:d("WAWebDeviceListPk").createDeviceListPK(a),deleted:!0};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&m===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(g.deletedChangedToHost=!0);g=d("WAWebApiDeviceList").createOrReplaceDeviceRecord(g)["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["remove from device list table failed"]))).verbose().devConsole(a).sendLogs("remove from device list table failed when clearing device record");throw c("err")("remove from device list table failed")});var h=(n||(n=b("Promise"))).resolve();d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(m!=null&&(h=d("WAWebApiContact").updateContactAdvHostedType(a,m)));yield n.all([e,f,g,h])}),p.length>0,!1,m!=null);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgInsertSuccess(p)});return p.apply(this,arguments)}function e(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){e===void 0&&(e=!1);f===void 0&&(f=!1);var g=[],h=[],i=!1,m=!1,p=!1;a.forEach(function(a){var b=a.wid,c=a.update;a=a.currentRecord;var e=c.devices;e=e.map(function(a){return a.id});var f=a&&!a.deleted?a.devices.map(function(a){return a.id}):[],k=Array.from(new Set(e).difference(new Set(f))).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID});f=Array.from(new Set(f).difference(new Set(e))).filter(function(a){return a!==d("WAJids").DEFAULT_DEVICE_ID});e=a==null;a=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?o(a==null?void 0:a.advAccountType,c==null?void 0:c.advAccountType):null;d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["bulkApplyDeviceUpdates: check coex cache for ",""])),b==null?void 0:b.toLogString()),d("WAWebBizCoexHostedAddVerification").assertThrowsWidAdvTypeFromVerificationCache(b));d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(a!=null&&(m=!0),a===d("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(p=!0));g.push({wid:b,added:k,removed:f,isNewRecord:e,newAdvAccountType:a});f.forEach(function(a){h.push(d("WAWebWidFactory").createDeviceWidFromUserAndDevice(b.user,b.server,a))});d("WAWebDeviceListPk").createDeviceListPK(b)===d("WAWebDeviceListPk").createDeviceListPK(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())&&f.length>0&&(i=!0)});d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&p===!0&&(yield d("WAWebUserPrefsMultiDevice").setHaveProcessedCoexAdv());e=(yield r(g,e,(e||f)&&m));var q=e.encryptedNotifications,s=e.chatIds;(n||(n=b("Promise"))).all(h.map(function(a){return t(a)}));var u=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(q==null?void 0:q.length)>0;yield d("WAWebApiGetDeviceUpdateLock").getDeviceUpdateLock(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=q.length>0?d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(q,[],s,!1):(n||(n=b("Promise"))).resolve(),f=d("WAWebAdvUpdateParticipantApi").bulkUpdateGroupParticipantsInTransaction(g),h=d("WAWebApiDeviceList").bulkCreateOrReplaceDeviceRecord(a.map(function(a){return a.update}))["catch"](function(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["bulkCreateOrReplace into device list table failed"]))).verbose().devConsole(a).sendLogs("bulkCreateOrReplace into device list table failed when applying device update");throw c("err")("bulkCreateOrReplace into device list table failed")}),j=i?h.then(function(){return d("WAWebSyncdStoreMissingKeys").updateMissingKeyDevices()["catch"](function(a){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncd: updateMissingKeyDevices failed with error:\n        ",""])),a)})}):(n||(n=b("Promise"))).resolve(),m=[];d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&u&&g.forEach(function(a){var b=a.wid;a=a.newAdvAccountType;a!=null&&m.push(d("WAWebApiContact").updateContactAdvHostedType(b,a))});yield (n||(n=b("Promise"))).all([e,f,h,j].concat(m))}),q.length>0,i,u);d("WAWebBizCoexUtils").sendWamCoexPrivacySysMsgInsertSuccess(q)});return q.apply(this,arguments)}function r(a,b,c){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!1);c=d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&c;a=c===!0?yield d("WAWebAdvDeviceNotificationApi").bulkGenerateDeviceAndAdvAccountTypeChangeNotifications(a):{notifications:[],chatIds:[]};var e=a.notifications;a=a.chatIds;c=c&&e.some(function(a){return d("WAWebBizCoexUtils").isCoexSystemMsgType(a.subtype)});if(!b||c){b=(yield d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(e));v(e);return{chatIds:a,encryptedNotifications:b}}d("WAWebGetMessageCache").getMessageCache().addMessages(e.map(function(a){return{msg:a}}),!1);return{chatIds:[],encryptedNotifications:[]}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield (n||(n=b("Promise"))).all([d("WAWebSignalSessionApi").deleteRemoteInfo(a),d("WAWebSignalSessionApi").deleteDeviceSenderKey(a)])}catch(b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["handleDevicesNotification: failed to clean the signal info for ",""])),a.user)}});return u.apply(this,arguments)}function v(a){return(n||(n=b("Promise"))).all(a.map(function(a){return d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:a.from,msgObjs:[babelHelpers["extends"]({},a,{recvFresh:!0,isNewMsg:!0})],meta:{add:"after",isHistory:!1},processMessagesOrigin:"updateDeviceTableApi"})}))}g.clearDeviceRecord=a;g.bulkApplyDeviceUpdate=e}),98);
__d("WAWebWamEnumPushNotificationInteractions",[],(function(a,b,c,d,e,f){a=Object.freeze({SHOWN:1,CLICKED:2});f.PUSH_NOTIFICATION_INTERACTIONS=a}),66);
__d("WAWebWamEnumWebNotificationSettingType",[],(function(a,b,c,d,e,f){a=Object.freeze({ALLOWED:1,BLOCKED:2,UNKNOWN:3});f.WEB_NOTIFICATION_SETTING_TYPE=a}),66);
__d("WAWebWamEnumOffboardSources",[],(function(a,b,c,d,e,f){a=Object.freeze({IN_APP_SETTING:1,OS_SETTING:2});f.OFFBOARD_SOURCES=a}),66);
__d("WAWebWamEnumOnboardSources",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:1,BACKGROUND_SYNC_BUTTERBAR:2,WEB_NOTIFICATION_BUTTERBAR:3,IN_APP_SETTING:4,AUTO_ENABLE:5});f.ONBOARD_SOURCES=a}),66);
__d("WAWebWebcBackgroundSyncAdoptionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOffboardSources","WAWebWamEnumOnboardSources","WAWebWamEnumPushNotificationInteractions","WAWebWamEnumWebNotificationSettingType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({WebcBackgroundSyncAdoption:[5302,{offboardSource:[1,d("WAWebWamEnumOffboardSources").OFFBOARD_SOURCES],onboardSource:[2,d("WAWebWamEnumOnboardSources").ONBOARD_SOURCES],pushNotificationInteraction:[3,d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS],webOsNotificationSetting:[4,d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE]},[1,1,1],"regular"]},{WebcBackgroundSyncAdoption:[]});g.WebcBackgroundSyncAdoptionWamEvent=a}),98);
__d("WAWebBackgroundSyncReporter",["WAWebUserPrefsGeneral","WAWebWamEnumPushNotificationInteractions","WAWebWamEnumWebNotificationSettingType","WAWebWebcBackgroundSyncAdoptionWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,b=(yield d("WAWebUserPrefsGeneral").getOfflineNotificationEngagement());a=((a=b==null?void 0:b.totalNotifShown)!=null?a:0)>0;b=((b=b==null?void 0:b.totalNotifTapToOpen)!=null?b:0)>0;b?h=d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS.CLICKED:a&&(h=d("WAWebWamEnumPushNotificationInteractions").PUSH_NOTIFICATION_INTERACTIONS.SHOWN)});return i.apply(this,arguments)}function c(a){var b,c=a.offboardSource;a=a.onboardSource;var e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.UNKNOWN;((b=window.Notification)==null?void 0:b.permission)==="granted"?e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.ALLOWED:((b=window.Notification)==null?void 0:b.permission)==="denied"&&(e=d("WAWebWamEnumWebNotificationSettingType").WEB_NOTIFICATION_SETTING_TYPE.BLOCKED);b=new(d("WAWebWebcBackgroundSyncAdoptionWamEvent").WebcBackgroundSyncAdoptionWamEvent)();b.set({offboardSource:c,onboardSource:a,pushNotificationInteraction:h,webOsNotificationSetting:e});b.commit()}g.setPushNotificationInteractionStatus=a;g.logBackgroundSyncAdoptionEvent=c}),98);
__d("WAWebNotificationConstants",[],(function(a,b,c,d,e,f){a="granted";b="default";c="denied";f.PERMISSION_ALLOWED=a;f.PERMISSION_DEFAULT=b;f.PERMISSION_DENIED=c}),66);
__d("WAWebUserPrefsNotifications",["WATimeUtils","WAWebBackgroundSyncReporter","WAWebEnvironment","WAWebNotificationConstants","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebWamEnumOnboardSources","cr:5151"],(function(a,b,c,d,e,f,g){function a(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_SOUNDS)!==!0}function e(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_SOUNDS,!a)}function f(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_RINGTONE)!==!0}function h(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_RINGTONE,!a)}function i(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_NOTIFICATIONS);if(typeof a!=="boolean"){var b;return c("WAWebEnvironment").isWindows?!0:((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED}return!a}function j(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_NOTIFICATIONS,!a)}function k(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_NOTIFICATIONS);if(typeof a!=="boolean"){var b;return c("WAWebEnvironment").isWindows?!0:((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED}return!a}function l(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_CALL_NOTIFICATIONS,!a)}function m(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED);if(typeof a!=="boolean"){var b;b=((b=window.Notification)==null?void 0:b.permission)===d("WAWebNotificationConstants").PERMISSION_ALLOWED;b&&d("WAWebBackgroundSyncReporter").logBackgroundSyncAdoptionEvent({offboardSource:null,onboardSource:d("WAWebWamEnumOnboardSources").ONBOARD_SOURCES.DEFAULT});return b}return a}function n(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED,a)}function o(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.SECURITY_NOTIFICATIONS)!==!0}function p(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.SECURITY_NOTIFICATIONS,!a)}var q={isDismissed:!1,firstSeenTime:null,lastDismissTime:null};function r(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.WEB_NOTIFICATIONS_BB_STATUS);if(a==null)return q;if(typeof a!=="object"||a instanceof Array)return q;a={isDismissed:a.isDismissed===!0,firstSeenTime:typeof a.firstSeenTime==="number"?d("WATimeUtils").castToUnixTime(a.firstSeenTime):null,lastDismissTime:typeof a.lastDismissTime==="number"?d("WATimeUtils").castToUnixTime(a.lastDismissTime):null};return a}function s(a){var b,e=r(),f=e.firstSeenTime;f=f===void 0?null:f;e=e.lastDismissTime;e=e===void 0?null:e;b=(b=a.firstSeenTime)!=null?b:f;f=(f=a.lastDismissTime)!=null?f:e;c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.WEB_NOTIFICATIONS_BB_STATUS,{isDismissed:a.isDismissed,firstSeenTime:b,lastDismissTime:f})}var t={isDismissed:!1,firstSeenTime:null,isLongResumeTime:!1};function u(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.OFFLINE_NOTIFICATIONS_BB_STATUS);if(a==null||typeof a!=="object"||a instanceof Array)return t;a={isDismissed:a.isDismissed===!0,firstSeenTime:typeof a.firstSeenTime==="number"?d("WATimeUtils").castToUnixTime(a.firstSeenTime):null,isLongResumeTime:a.isLongResumeTime===!0};return a}function v(a){var b,e=u(),f=e.isDismissed;f=f===void 0?!1:f;var g=e.firstSeenTime;g=g===void 0?null:g;e=e.isLongResumeTime;e=e===void 0?!1:e;b=(b=a.isDismissed)!=null?b:f;f=(f=a.firstSeenTime)!=null?f:g;a=(g=a.isLongResumeTime)!=null?g:e;c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.OFFLINE_NOTIFICATIONS_BB_STATUS,{isDismissed:b,firstSeenTime:f,isLongResumeTime:a})}function w(){var a=c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_PREVIEWS);return typeof a!=="boolean"&&c("WAWebEnvironment").isWindows?!0:a!==!0}function x(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_MUTE_PREVIEWS,!a)}function y(){return b("cr:5151")?c("WAWebUserPrefsStore").getUser(b("cr:5151").IGNORE_NONDIRECT_GROUP_MSG)===!0:!1}function z(a){b("cr:5151")&&c("WAWebUserPrefsStore").setUser(b("cr:5151").IGNORE_NONDIRECT_GROUP_MSG,a)}function A(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.OUTGOING_MESSAGE_SOUND)===!0}function B(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.OUTGOING_MESSAGE_SOUND,a)}function C(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_COLLAPSE_MUTED)===!0}function D(a){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_COLLAPSE_MUTED,a)}function E(){return c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED_ONCE)===!0}function F(){c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.GLOBAL_OFFLINE_NOTIFICATIONS_ENABLED_ONCE,!0)}g.getGlobalSounds=a;g.setGlobalSounds=e;g.getGlobalCallRingtone=f;g.setGlobalCallRingtone=h;g.getGlobalNotifications=i;g.setGlobalNotifications=j;g.getGlobalCallNotifications=k;g.setGlobalCallNotifications=l;g.getGlobalOfflineNotifications=m;g.setGlobalOfflineNotifications=n;g.getGlobalSecurityNotifications=o;g.setGlobalSecurityNotifications=p;g.DEFAULT_NOTIFICATION_BB_STATUS=q;g.getWebNotificationsBBStatus=r;g.setWebNotificationsBBStatus=s;g.DEFAULT_OFFLINE_NOTIFICATION_BB_STATUS=t;g.getOfflineNotificationsBBStatus=u;g.setOfflineNotificationsBBStatus=v;g.getGlobalPreviews=w;g.setGlobalPreviews=x;g.getIgnoreNondirectGroupMsg=y;g.setIgnoreNondirectGroupMsg=z;g.getOutgoingMessageSound=A;g.setOutgoingMessageSound=B;g.getCollapseMuted=C;g.setCollapseMuted=D;g.getOfflineNotificationsEnabledOnce=E;g.setOfflineNotificationsEnabledOnce=F}),98);
__d("WAWebSecurityCodeApi",["WALogger","WAWebApiContact","WAWebBackendApi","WAWebContactSystemMsg","WAWebDBEncryptMultipleMsgs","WAWebDBStoreEncryptedMsgs","WAWebGetMessageCache","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebSchemaParticipant","WAWebUserPrefsNotifications","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.user,c=a.stanzaLid;a=a.offline;if(b.isBot())return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["addSecurityCodeChangedNotifications"])));var e=null;b.isLid()?e=d("WAWebApiContact").getPnIfLidIsLatestMapping(b):b.isRegularUser()&&c!=null&&(e=c);c=(yield k(b,e));b=c.notifications;e=c.chatIds;if(b.length===0)return;if(!a){b=b.map(function(a){return babelHelpers["extends"]({},a,{recvFresh:!0,isNewMsg:!0})});for(a of b)d("WAWebBackendApi").frontendFireAndForget("processMultipleMessages",{chatId:a.from,msgObjs:[a],meta:{add:"after",isHistory:!1},processMessagesOrigin:"securityCodeApi"});a=(yield d("WAWebDBEncryptMultipleMsgs").encryptMultipleDBMsgs(b));yield d("WAWebDBStoreEncryptedMsgs").storeEncryptedDBMessages(a,e,!1);return c}d("WAWebGetMessageCache").getMessageCache().addMessages(b.map(function(a){return{msg:a}}),!1);return c});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={notifications:[],chatIds:[]};b=b==null?[a]:[a,b];if(!d("WAWebUserPrefsNotifications").getGlobalSecurityNotifications())return e;var f=[];try{var g=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b.map(function(a){return a.toString()}),!1)).filter(Boolean);f.push.apply(f,g.map(function(a){return{chatId:d("WAWebWidFactory").createWid(a.id),codeChangedUser:d("WAWebWidFactory").createUserWidOrThrow(a.id)}}));g=(yield d("WAWebSchemaParticipant").getParticipantTable().anyOf(["participants"],b.map(String)));var h=new Map();if(g.length>0){b=g.map(function(a){return a.groupId});(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().bulkGet(b)).forEach(function(a){a!=null&&h.set(a.id,a)})}g.forEach(function(b){var c=h.get(b.groupId);if(Boolean(c==null?void 0:c.defaultSubgroup)===!0&&a.isLid())return;f.push({chatId:d("WAWebWidFactory").createWid(b.groupId),codeChangedUser:a})})}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["get chats failed"]))).verbose().devConsole(a).sendLogs("get chats failed when creating device notification");throw c("err")("get chats failed")}b=f.map(function(a){var b=a.chatId;a=a.codeChangedUser;return d("WAWebContactSystemMsg").genSecurityCodeNotificationMsg(b,a)});e.notifications=b;e.chatIds=f.map(function(a){a=a.chatId;return a.toString()});return e});return l.apply(this,arguments)}g.addSecurityCodeChangedNotifications=a;g.generateSecurityCodeChangedNotifications=k}),98);
__d("WAWebMsgAGMProcessing",["WALogger","WATimeUtils","WAWebCtwaAGMUtils","WAWebCtwaLogger","WAWebDBMessageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebViewMode.flow","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h,i=50;function a(a){var b=a.msgKey,c=a.msgTimestamp,e=a.to,f=a.from;a=a.ctwaContext;if(a.greetingMessageBody==null||a.automatedGreetingMessageShown!==!0||a.sourceId==null)return null;c=c!=null?d("WATimeUtils").castToUnixTime(parseInt(c,10)):d("WATimeUtils").unixTimeMs();b={id:b,t:c,type:d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE,kind:d("WAWebMsgType").MsgKind.AutomatedGreetingMessage,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,from:f,to:e,ctwaContext:a,body:a.greetingMessageBody};return b}function e(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.ctwaContext;try{if(e==null)return[a];var f=d("WAWebCtwaAGMUtils").extractAGMPayload(e),g=d("WAWebMsgGetters").getIsSentByMe(a);if(e.automatedGreetingMessageShown!==!0||e.sourceId==null)return[a];if(c("isStringNullOrEmpty")(e.greetingMessageBody)){d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.null_greeting_message,fromBusiness:!g,agmPayload:f,businessWid:a.to,adId:e.sourceId});return[a]}if(e.sourceApp!=null&&!Object.values(d("WAWebCtwaAGMUtils").AGM_SOURCE_APP).includes(e.sourceApp)){d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.invalid_source_app,fromBusiness:!g,agmPayload:f,businessWid:a.to,adId:e.sourceId});return[a]}(f==null?void 0:f.ctaType)!=null&&!Object.values(d("WAWebCtwaAGMUtils").AGM_CTA_TYPE).includes(f==null?void 0:f.ctaType)&&d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.agm_invalid_cta_payload,fromBusiness:!g,agmPayload:f,businessWid:a.to,adId:e.sourceId});var i=a.id,j=a.from,l=a.to,n=a.viewMode,o=a.t;j=j;l=l;var p=(yield k(b.chat));p=m(e==null?void 0:e.sourceId,p);if(p){d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.duplicated,fromBusiness:!g,agmPayload:f,businessWid:l,adId:e.sourceId});return[a]}p={id:new(c("WAWebMsgKey"))({remote:b.chat,fromMe:!i.fromMe,id:yield c("WAWebMsgKey").newId()}),ctwaContext:e,body:e.greetingMessageBody,from:l,to:j,type:d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE,kind:d("WAWebMsgType").MsgKind.AutomatedGreetingMessage,viewMode:n,t:o!=null?o:d("WATimeUtils").unixTimeMs()};d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.injected,fromBusiness:!g,agmPayload:f,businessWid:l,adId:e.sourceId});c("isStringNullOrEmpty")(e.description)&&d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.bottomsheet_text_error,fromBusiness:!g,agmPayload:f,businessWid:l,adId:e.sourceId});c("isStringNullOrEmpty")(e.originalImageUrl)&&d("WAWebCtwaLogger").logAGMOperation({operationType:d("WAWebCtwaLogger").AGM_OPERATION_TYPE.agm_bottom_sheet_image_error,fromBusiness:!g,agmPayload:f,businessWid:l,adId:e.sourceId});return[p,a]}catch(b){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["generateAGMMsgs: cannot create MsgKey: ",""])),b);return[a]}});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebDBMessageUtils").beginningOfChat(a);a=d("WAWebDBMessageUtils").endOfChat(a);b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{lowerInclusive:!0,upperInclusive:!1,limit:i,reverse:!0}));return b.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE})});return l.apply(this,arguments)}function m(a,b){return a==null?!1:b.some(function(b){b=b.ctwaContext;return b!=null&&b.sourceId===a})}g.genHistoryAutomatedGreetingMsg=a;g.generateAutomatedGreetingMsgs=e}),98);
__d("WAWebBusinessHSMTypes",[],(function(a,b,c,d,e,f){a={MARKETING:"MARKETING",UTILITY:"UTILITY",AUTHENTICATION:"AUTHENTICATION"};f.HSM_TAG_TYPE=a}),66);
__d("WAWebDeviceSentMessageProtoUtils",[],(function(a,b,c,d,e,f){function a(a,b){var c=a==null?void 0:a.messageContextInfo;if(c==null){var d={deviceSentMessage:{destinationJid:b.toString({legacy:!0}),message:a}};return d}return{messageContextInfo:babelHelpers["extends"]({},c),deviceSentMessage:{destinationJid:b.toString({legacy:!0}),message:babelHelpers["extends"]({},a,{messageContextInfo:void 0})}}}function b(a){var b,c,d,e,f,g,h,i=a==null||(b=a.deviceSentMessage)==null?void 0:b.message;if(i==null)return null;c=babelHelpers["extends"]({},i.messageContextInfo,{messageSecret:(c=i==null||(d=i.messageContextInfo)==null?void 0:d.messageSecret)!=null?c:a==null||(e=a.messageContextInfo)==null?void 0:e.messageSecret,messageAssociation:(c=i==null||(f=i.messageContextInfo)==null?void 0:f.messageAssociation)!=null?c:a==null||(g=a.messageContextInfo)==null?void 0:g.messageAssociation,limitSharingV2:a==null||(h=a.messageContextInfo)==null?void 0:h.limitSharingV2,threadId:[]});return babelHelpers["extends"]({},i,{messageContextInfo:c})}f.wrapDeviceSentMessage=a;f.unwrapDeviceSentMessage=b}),66);
__d("WAWebProtobufsEphemeral.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="EphemeralSetting";a.internalSpec={duration:[1,d("WAProtoConst").TYPES.SFIXED32],timestamp:[2,d("WAProtoConst").TYPES.SFIXED64]};g.EphemeralSettingSpec=a}),98);
__d("WAWebEphemeralDecodeBroadcastSetting",["WABase64","WABinary","WACustomError","WATimeUtils","WAWebProtobufsEphemeral.pb","asyncToGeneratorRuntime","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h=new Uint8Array(32);function i(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield self.crypto.subtle.importKey("raw",a,"HKDF",!1,["deriveKey"]));b=(yield self.crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:h,info:b},a,{name:"HMAC",hash:"SHA-256"},!0,["verify"]));return self.crypto.subtle.exportKey("raw",b)});return j.apply(this,arguments)}function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=a.slice(0,12);a=a.slice(12,44);a=(yield self.crypto.subtle.importKey("raw",a,"AES-GCM",!1,["decrypt"]));return self.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(d),additionalData:c},a,b)});return l.apply(this,arguments)}function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.broadcastJid,e=a.recipient,f=a.sender,g=a.ephSetting;a=a.sharedSecret;b=b.toString({legacy:!0});e=e.toString({legacy:!0});f=f.toString({legacy:!0});e="Ephemeral "+e+" "+b;b=d("WABinary").Binary.build(e).readByteArrayView();e=new Uint8Array(a);a=d("WABase64").decodeB64(g);g=d("WABinary").Binary.build(f).readBuffer();f=(yield i(e,b));try{e=(yield k(f,a,g));b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsEphemeral.pb").EphemeralSettingSpec,e);f=b.duration;a=b.timestamp;if(f==null||a==null)throw c("err")("ephSetting decoded into malformed proto");return{ephemeralDuration:f,ephemeralSettingTimestamp:d("WATimeUtils").castLongIntToUnixTime(a)}}catch(a){throw new n(a)}});return m.apply(this,arguments)}var n=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("BroadcastEphSettingsError"));g.deriveKey=i;g.decodeBroadcastEphemeralSetting=a;g.BroadcastEphSettingsError=n}),98);
__d("WAWebFutureproofingEdit",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"message_edit",futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_edit"})}g.futureproofEdit=a}),98);
__d("WAWebGroupMsgReceiveUtils",["WAWebGroupType","WAWebMessageEditGatingUtils","WAWebSchemaGroupMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(a.toString()));if(!a)return!1;a=d("WAWebGroupType").getGroupTypeFromGroupMetadata(a);return a===d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP?!d("WAWebMessageEditGatingUtils").receiveCagMsgEditEnabled():!1});return h.apply(this,arguments)}g.futureproofEditInCAG=a}),98);
__d("WAWebMarketingMessagesUserFeedbackGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("mm_message_level_feedback_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("mm_message_level_feedback_not_interested_menu_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("mm_opt_out_enabled")}function e(){return d("WAWebABProps").getABPropConfigValue("mm_opt_out_list_server_sync_enabled")}function f(){return d("WAWebABProps").getABPropConfigValue("mm_message_level_feedback_analytics_enabled")}function h(){d("WAWebABProps").getABPropConfigValue("mm_user_controls_exposure")}function i(){return d("WAWebABProps").getABPropConfigValue("mm_opt_out_fmx_stop_for_high_trust")}function j(){var a=d("WAWebABProps").getABPropConfigValue("mm_user_controls_exception_number_prefixes");return a===""?[]:a.split(",").map(function(a){return a.trim()})}function k(a){if(a==null)return!1;var b=j();return b.some(function(b){return a.toString().startsWith(b)})}g.isMMMessageLevelFeedbackEnabled=a;g.isMMMessageLevelFeedbackNotInterestedMenuEnabled=b;g.isMMOptOutEnabled=c;g.isMMOptOutListServerSyncEnabled=e;g.isMMMessageLevelFeedbackAnalyticsEnabled=f;g.triggerExposureMMUserControls=h;g.isMMStopInFMXEnabled=i;g.getMMUserControlsExceptionNumberPrefixes=j;g.isMMUserControlsExceptionNumberPrefixMatch=k}),98);
__d("WAWebMsgProcessingApiUtils",["Promise","WAJids","WALogger","WANullthrows","WAWebABProps","WAWebAck","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBizGatingUtils","WAWebBusinessHSMTypes","WAWebDeviceSentMessageProtoUtils","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebEphemeralDecodeBroadcastSetting","WAWebFutureproofingEdit","WAWebGroupMsgReceiveUtils","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebHandleMsgMetaUtils","WAWebHandleMsgTypes.flow","WAWebMarketingMessagesUserFeedbackGatingUtils","WAWebMsgAGMProcessing","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWamEnumDeviceType","WAWebWamEnumDsmError","WAWebWamMsgUtils","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h=["msgProtobuf"],i=["msgProtobuf"],j=["msgProtobuf"],k=["decrypted","reparsing"],l,m,n,o;function p(a){var b,c="";((b=a.protocolMessage)==null?void 0:b.historySyncNotification)!=null?c="historySyncNotification":((b=a.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null?c="initialSecurityNotificationSettingSync":((b=a.protocolMessage)==null?void 0:b.appStateSyncKeyRequest)!=null?c="appStateSyncKeyRequest":((b=a.protocolMessage)==null?void 0:b.appStateSyncKeyShare)!=null?c="appStateSyncKeyShare":((b=a.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage)!=null?c="peerDataOperationRequestResponseMessage":((b=a.protocolMessage)==null?void 0:b.peerDataOperationRequestMessage)!=null?c="peerDataOperationRequestMessage":((b=a.protocolMessage)==null?void 0:b.cloudApiThreadControlNotification)!=null&&(c="cloudApiThreadControlNotification");d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["protocol message: wid error in type ",""])),c).sendLogs("wid error")}function q(a){var b=a.info,e=a.msgProtobuf,f=a.paymentInfo,g=a.bizInfo;a=a.msgBotInfo;var h,i=L(b);if(!d("WAWebUserPrefsMeUser").isMeAccountNonLid(i)){p(e);return}if(((i=e.protocolMessage)==null?void 0:i.historySyncNotification)!=null){i=d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:e,message:F(b),msgContext:"relay",paymentInfo:f,bizInfo:g});G(i,a);h={history:c("WANullthrows")(i.historySyncMetaData)}}else if(((b=e.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null){h={securityNotificationEnabled:{isEnabled:(f=e.protocolMessage.initialSecurityNotificationSettingSync.securityNotificationEnabled)!=null?f:!0}}}else if(((g=e.protocolMessage)==null?void 0:g.appStateSyncKeyShare)!=null)h={appStateSyncKeyShare:e.protocolMessage.appStateSyncKeyShare};else if(((a=e.protocolMessage)==null?void 0:a.appStateSyncKeyRequest)!=null)h={appStateSyncKeyRequest:e.protocolMessage.appStateSyncKeyRequest};else if(((i=e.protocolMessage)==null?void 0:i.peerDataOperationRequestResponseMessage)!=null){h={peerDataOperationRequestResponseMessage:(b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage}}else if(((f=e.protocolMessage)==null?void 0:f.peerDataOperationRequestMessage)!=null){h={peerDataOperationRequestMessage:(g=e.protocolMessage)==null?void 0:g.peerDataOperationRequestMessage}}else if(((a=e.protocolMessage)==null?void 0:a.cloudApiThreadControlNotification)!=null){h={cloudApiThreadControlNotification:(i=e.protocolMessage)==null?void 0:i.cloudApiThreadControlNotification}}return h}function a(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=a.msgProtobuf,f=a.info;if(((b=e.protocolMessage)==null?void 0:b.historySyncNotification)!=null||((b=e.protocolMessage)==null?void 0:b.initialSecurityNotificationSettingSync)!=null||((b=e.protocolMessage)==null?void 0:b.appStateSyncKeyShare)!=null||((b=e.protocolMessage)==null?void 0:b.appStateSyncKeyRequest)!=null||((b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestResponseMessage)!=null||((b=e.protocolMessage)==null?void 0:b.peerDataOperationRequestMessage)!=null||((b=e.protocolMessage)==null?void 0:b.cloudApiThreadControlNotification)!=null)return q({info:f,msgProtobuf:e,paymentInfo:a.paymentInfo,bizInfo:a.bizInfo,hsmInfo:a.hsmInfo});else if(((b=e.protocolMessage)==null?void 0:b.lidMigrationMappingSyncMessage)!=null)return{lidMigrationSyncMessage:e.protocolMessage.lidMigrationMappingSyncMessage};switch(f.type){case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT:return d("WAWebUserPrefsMeUser").isMeAccount(f.author)?u(a):y(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.GROUP:return f.isDirect&&d("WAWebUserPrefsMeUser").isMeAccount(f.author)&&!M(a)?u(a):y(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST:if(a.ciphertextType===d("WAWebBackendJobs.flow").CiphertextType.Skmsg){if(!f.bclHashValidated)throw c("err")("parseMessage: participants for peer broadcast message is not validated");return y(a)}return w(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST:return y(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.DIRECT_PEER_STATUS:return f.isDirect===!0?s(a):w(a);case d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS:return y(a);default:throw c("err")("Unrecognized MESSAGE_TYPE")}});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{return yield u(a)}catch(c){if(c instanceof d("WAWebHandleMsgError").DeviceSentMessageError){var b=Object.keys(a.msgProtobuf).filter(function(a){return a!=="$$unknownFieldCount"&&a!=="messageContextInfo"});if(b.length===1&&b[0]==="senderKeyDistributionMessage")return y(a)}throw c}});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var c=b.deviceSentMessage;if(c==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(K(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM);if(c.destinationJid==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(K(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM);c=c.destinationJid;b=(yield A(d("WAWebDeviceSentMessageProtoUtils").unwrapDeviceSentMessage(b),a));return babelHelpers["extends"]({deviceSent:{destination:d("WAWebWidFactory").createWid(c)}},b)});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,i);var c=a.info,e=b.deviceSentMessage;if(e==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(K(c.author),d("WAWebWamEnumDsmError").DSM_ERROR.MISSING_DSM);if(e.phash==null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(K(c.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM);e=e.phash;b=(yield A(d("WAWebDeviceSentMessageProtoUtils").unwrapDeviceSentMessage(b),a));return babelHelpers["extends"]({deviceSent:{phash:e,info:c}},b)});return x.apply(this,arguments)}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msgProtobuf;a=babelHelpers.objectWithoutPropertiesLoose(a,j);if(b.deviceSentMessage!=null)throw new(d("WAWebHandleMsgError").DeviceSentMessageError)(K(a.info.author),d("WAWebWamEnumDsmError").DSM_ERROR.INVALID_SENDER);b=(yield A(b,a));return babelHelpers["extends"]({deviceSent:null},b)});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f,g,h,i,j=b.info,l=b.paymentInfo,m=b.bizInfo,n=b.hidePlaceholder,o=b.processDecryptedProtoParams,p=b.hsmInfo,q=b.msgBotInfo,r=b.reportingTokenInfo,s=b.isMessageRetry,t=b.isOffline;b=b.protobufBytes;if(a==null)return{senderKey:null,storeMsg:null,renderableMsgs:[]};l=babelHelpers["extends"]({},d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:a,message:F(j),msgContext:"relay",paymentInfo:l,bizInfo:m,editAttr:j.edit,rcat:o==null?void 0:o.rcat,bizSource:o==null||(e=o.msgMeta)==null?void 0:e.bizSource,msgMeta:o==null?void 0:o.msgMeta,msgBotInfo:q}));m=l;m=m.disappearingModeTrigger;f=(f=l.id.remote)!=null?f:l.from;if(f!=null&&c("WAWebWid").isGroup(f)&&m!=null&&d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){m=(yield d("WAWebE2EProtoUtils").updateDisappearingModeForGroups(m,f));m!=null&&(l=babelHelpers["extends"]({},l,m))}G(l,q,o==null||(g=o.msgMeta)==null?void 0:g.targetSenderJid,o==null||(h=o.msgMeta)==null?void 0:h.targetId);if(p!=null){f=p.category;m=p.tag;l.hsmTag=m;l.hsmCategory=f;m===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.MARKETING&&d("WAWebMarketingMessagesUserFeedbackGatingUtils").triggerExposureMMUserControls()}if((o==null||(i=o.msgMeta)==null?void 0:i.bizSource)!=null){var u;l.bizSource=o==null||(u=o.msgMeta)==null?void 0:u.bizSource}q=a.senderKeyDistributionMessage!=null?C(j,a.senderKeyDistributionMessage):null;if(l.subtype==="message_edit"&&l.futureproofSubtype!=="message_edit"&&(yield d("WAWebGroupMsgReceiveUtils").futureproofEditInCAG(j.chat))){p=d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(l);l=babelHelpers["extends"]({},d("WAWebFutureproofingEdit").futureproofEdit(p))}f=l.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&q==null;m=l.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&q!=null;a=null;if(f&&o!=null){p=o.decrypted;o.reparsing;f=babelHelpers.objectWithoutPropertiesLoose(o,k);l.futureproofParams=f;l.futureproofBuffer=p}j.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS&&(l.campaignId=j.campaignId,l.campaignDuration=j.campaignDuration);j.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST&&(l.broadcastId=j.chat,l.bclParticipants=j.bclParticipants,a=l);if(j.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST){l.broadcastId=j.chat;f=(o=j.preMatChat)!=null?o:j.author;p=j.ephSetting;o=l.ephemeralSharedSecret;if(p!=null&&o!=null){f=(yield d("WAWebEphemeralDecodeBroadcastSetting").decodeBroadcastEphemeralSetting({broadcastJid:j.chat,recipient:f.isLid()?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),sender:f,ephSetting:p,sharedSecret:o}));p=f.ephemeralDuration;o=f.ephemeralSettingTimestamp;l.ephemeralDuration=p;l.ephemeralSettingTimestamp=o}}f=[];p=l.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN;o=m||p&&n===!0&&l.futureproofType==null;o||(j.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?f=(yield H(l,j.bclParticipants)):(l.subtype==="payment_transaction_request_cancelled"||l.subtype==="payment_action_request_declined")&&l.paymentRequestMessageKey==null||(l.reportingTokenInfo=r,l.plainProtobufBytes=b,l.preMatChat=j.preMatChat,l.isRetry=s,l.isOffline=t,(j.author!==l.from||j.author!==l.author)&&(l.senderWithDevice=j.author),d("WAWebBizGatingUtils").shouldGenerateAGMMsgs(l.ctwaContext)?f=(yield d("WAWebMsgAGMProcessing").generateAutomatedGreetingMsgs(l,j)):f=[l]));return{senderKey:q,storeMsg:a,renderableMsgs:f}});return B.apply(this,arguments)}function C(a,b){if(!a.chat.isGroup()&&!a.chat.isBroadcast())throw c("err")("should not have senderkey");var e=b.groupId;b=b.axolotlSenderKeyDistributionMessage;if(e==null||a.chat.toString({legacy:!0})!==e){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["parseSenderKeyDistribution: expected: ",", got: ",""])),a.chat.toString(),e!=null?e:"null");throw c("err")("parseSenderKeyDistribution: stanza group id mismatched with protobuf")}if(!b)throw c("err")("senderKeyDistributionMessage: from "+a.author.toString()+" has no content");return{groupId:e,key:b}}function D(a){if(a.edit===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&a.type!==d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST)return!1;return a.edit===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?!1:!0}function e(a){var b=a.msgInfo,c=a.placeholderType,e=a.msgMeta;a=a.placeholderAddReason;if(!D(b))return null;var f=null;switch(c){case d("WAWebHandleMsgTypes.flow").PlaceholderType.E2E:f=void 0;break;case d("WAWebHandleMsgTypes.flow").PlaceholderType.BOT_UNAVAILABLE_FANOUT:f="bot_unavailable_fanout";break;case d("WAWebHandleMsgTypes.flow").PlaceholderType.HOSTED_UNAVAILABLE_FANOUT:f="hosted_unavailable_fanout";break;case d("WAWebHandleMsgTypes.flow").PlaceholderType.VIEW_ONCE_UNAVAILABLE_FANOUT:f="view_once_unavailable_fanout";break;default:f="fanout"}c=d("WAWebHandleMsgMetaUtils").getMsgTypeFromMsgMeta(e);f=babelHelpers["extends"]({},F(b),{type:d("WAWebMsgType").MSG_TYPE.CIPHERTEXT,kind:d("WAWebMsgType").MsgKind.Ciphertext,subtype:f,e2eSenderType:d("WAWebWamMsgUtils").getWamE2eSenderType(b.author),placeholderAddReason:a,bclParticipants:b.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?b.bclParticipants:void 0});return c!=null?babelHelpers["extends"]({},f,{parentMsgKey:d("WAWebE2EProtoUtils").createMsgKeyFromThreadInfo(e,b,c),kind:d("WAWebMsgType").MsgKind.PlaceholderAddon,realType:c}):babelHelpers["extends"]({},f,{kind:d("WAWebMsgType").MsgKind.PlaceholderMessage})}function f(a,b){a=babelHelpers["extends"]({},F(a),{type:d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.DebugPlaceholder,body:b.toString()});return a}function E(a,b){if(b.botParticipant!=null)return b.botParticipant;if(!a.fromMe&&c("WAWebWid").isGroup(a.remote)||c("WAWebWid").isStatus(a.remote))return a.participant;return!d("WAWebUserPrefsMeUser").isMeDevice(b.author)&&d("WAWebUserPrefsMeUser").isMeAccount(b.author)?b.author:void 0}function F(a){var b,e,f,g=J(a),h=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),i=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow();g.fromMe&&c("WAWebWid").isGroup(g.remote)&&a.author.isLid()&&i!=null?i=i:i=h;i=g.fromMe?i:g.remote;i={id:g,from:i,to:g.fromMe?g.remote:h,type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:a.ts||0,ack:d("WAWebMsgKeyUtils").isNoteToSelf(g)?d("WAWebAck").ACK.READ:d("WAWebAck").ACK.SENT,author:E(g,a),notifyName:a.pushname||"",invis:!1,count:a.count,clientReceivedTsMillis:a.clientReceivedTsMillis};d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.hostedBizEncStateMismatch===!0&&(b=i.id)!=null&&(b=b.remote)!=null&&b.isUser()&&(i.hostedBizEncStateMismatch=!0);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.senderOrRecipientAccountTypeHosted===!0&&(e=i.id)!=null&&(e=e.remote)!=null&&e.isUser()&&(i.senderOrRecipientAccountTypeHosted=!0);d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&a.placeholderCreatedWhenAccountIsHosted!=null&&(f=i.id)!=null&&(f=f.remote)!=null&&f.isUser()&&(i.placeholderCreatedWhenAccountIsHosted=a.placeholderCreatedWhenAccountIsHosted);return i}function G(a,b,c,d){if(b!=null){a=a;Object.assign(a,{botEditTargetId:b.botEditTargetId,botEditType:b.botEditType,bizBotType:b.bizBotType,botTargetSenderJid:c,botMsgBodyType:b.botMsgBodyType,botResponseTargetId:d})}}function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=(yield (o||(o=b("Promise"))).all(e.map(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var e=b.preMatWid,f=b.ephSetting;b=b.wid;e=e!=null?e:c("WANullthrows")(b);var g;try{g=new(c("WAWebMsgKey"))({remote:b,fromMe:!0,id:a.id.id})}catch(a){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["drop: cannot create MsgKey: ",""])),a.stack);return null}var h,i;b=a.ephemeralSharedSecret;var j=a.broadcastId;if(j!=null&&f!=null&&b!=null){j=(yield d("WAWebEphemeralDecodeBroadcastSetting").decodeBroadcastEphemeralSetting({broadcastJid:j,recipient:e,sender:e.isLid()?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),ephSetting:f,sharedSecret:b}));h=j.ephemeralDuration;i=j.ephemeralSettingTimestamp}f=babelHelpers["extends"]({},a,{id:g,from:d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),to:e,broadcast:!0,ephemeralDuration:h,ephemeralSettingTimestamp:i,protocolMessageKey:a.protocolMessageKey==null?void 0:new(c("WAWebMsgKey"))({remote:e,fromMe:!0,id:a.protocolMessageKey.id})});return f});return function(a){return e.apply(this,arguments)}}())));return e.filter(Boolean)});return I.apply(this,arguments)}function J(a){if(a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST)return new(c("WAWebMsgKey"))({remote:d("WAWebWidFactory").asUserWidOrThrow(a.author),fromMe:!1,id:a.externalId});else if(a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT)return a.botParticipant!=null?new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),id:a.externalId,participant:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(a.botParticipant))}):new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),id:a.externalId});return new(c("WAWebMsgKey"))({remote:a.chat,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a.author),participant:d("WAWebWidFactory").asUserWidOrThrow(a.author),id:a.externalId})}function K(a){return a.device==null||a.device===d("WAJids").DEFAULT_DEVICE_ID?d("WAWebWamEnumDeviceType").DEVICE_TYPE.PRIMARY:d("WAWebWamEnumDeviceType").DEVICE_TYPE.COMPANION}function L(a){return a.type===d("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT?a.author:a.chat}function M(a){var b;return((b=a.meta)==null?void 0:b.appdata)===d("WAWebHandleMsgCommon").APPDATA["default"]&&a.msgProtobuf.senderKeyDistributionMessage!=null}function N(a,b){if(!d("WAWebABProps").getABPropConfigValue("web_capi_group_session_enabled"))return!1;if(a===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg){a=b.msgInfo.chat.isGroup();b=b.msgMeta.capi===!0;return a&&b}return!1}g.parseProtocolMessage=q;g.parseMessage=a;g.isRevokeInfo=D;g.generatePlaceholder=e;g.genDebugPlaceholderMsg=f;g.generateBaseMsg=F;g.generateBclMsgs=H;g.messageInfoToKey=J;g.getDeviceType=K;g.getFrom=L;g.shouldOmitSessionPersistence=N}),98);
__d("WAWebWamEnumAgentEngagementEnumType",[],(function(a,b,c,d,e,f){a=Object.freeze({DIRECT_CHAT:0,INVOKED:1,MEMBER:2});f.AGENT_ENGAGEMENT_ENUM_TYPE=a}),66);
__d("WAWebWamEnumBotType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,METABOT:1,BOT_1P_BIZ:2,BOT_3P_BIZ:3,UGC:4,META_CHARACTER:5});f.BOT_TYPE=a}),66);
__d("WAWebWamEnumInvisibleMessageCategoryType",[],(function(a,b,c,d,e,f){a=Object.freeze({PEER:1,INVISIBLE_KEY_DISTRIBUTION:2,OTHER:3,MEDIA_EXPRESS_NOTIFY:4,EPHEMERAL_SYNC_RESPONSE:5});f.INVISIBLE_MESSAGE_CATEGORY_TYPE=a}),66);
__d("WAWebWamEnumMessageDropReasonType",[],(function(a,b,c,d,e,f){a=Object.freeze({SYNCD_DELETION:1,ADMIN_REVOKE_NOT_ENABLED:2,RECEIVED_WITH_OLD_COUNTER:3,INVALID_STANZA:4,INVALID_PROTOBUF:5,MESSAGE_SECRET_ERROR:6,INVALID_LID_ADDRESSED_MESSAGE:7,UNKNOWN_MESSAGE_TYPE:8,DB_OPERATION_FAILED:9,INTERNAL_ERROR:10,EXPIRED:11,INVALID_HOSTED_COMPANION_STANZA:12,MESSAGE_REVOKED:13,PAYMENT_MESSAGE_REVOKED:14,DUPLICATE_MESSAGE:15,DUPLICATE_DELIVERY:16,INVALID_MESSAGE_REFERENCE:17,UNSUPPORTED_MESSAGE:18,MALICIOUS_DUPLICATE_MESSAGE:19,PEER_MESSAGE_FROM_OTHER_USER:20,INVALID_PEER_MESSAGE:21,INVALID_REPORTING_TOKEN:22,MISSING_REPORTING_TOKEN:23});f.MESSAGE_DROP_REASON_TYPE=a}),66);
__d("WAWebIncomingMessageDropWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumE2eDeviceType","WAWebWamEnumE2eFailureReason","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType","WAWebWamEnumTypeOfGroupEnum"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({IncomingMessageDrop:[3724,{agentEngagementType:[12,d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],botType:[14,d("WAWebWamEnumBotType").BOT_TYPE],e2eCiphertextType:[1,d("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eDestination:[2,d("WAWebWamEnumE2eDestination").E2E_DESTINATION],e2eFailureReason:[9,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON],e2eSenderType:[3,d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],encryptionType:[18,d("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],invisibleMessageCategory:[13,d("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isLid:[15,a.TYPES.BOOLEAN],isSimpleSignal:[19,a.TYPES.BOOLEAN],localAddressingMode:[16,d("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageDropReason:[4,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE],messageMediaType:[5,d("WAWebWamEnumMediaType").MEDIA_TYPE],offline:[6,a.TYPES.BOOLEAN],offlineCount:[11,a.TYPES.INTEGER],retryCount:[7,a.TYPES.INTEGER],revokeType:[8,d("WAWebWamEnumRevokeType").REVOKE_TYPE],typeOfGroup:[10,d("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{IncomingMessageDrop:[]});g.IncomingMessageDropWamEvent=b}),98);
__d("WAWebPostIncomingMessageDropMetric",["WADeprecatedWapParser","WAWebAck","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebDBMessageSerialization","WAWebHandleMsgCommon","WAWebIncomingMessageDropWamEvent","WAWebJidToWid","WAWebMsgGetters","WAWebMsgProcessingApiUtils","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType","WAWebWamMsgUtils"],(function(a,b,c,d,e,f,g){var h=new(c("WADeprecatedWapParser"))("incomingMsgParserForMetric",function(a){var b={};try{b.type=a.attrEnum("type",d("WAWebHandleMsgCommon").STANZA_MSG_TYPES)}catch(a){}try{b.pollType=b.type===d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll?a.child("meta").attrEnumOrNullIfUnknown("polltype",d("WAWebHandleMsgCommon").POLL_TYPES):null}catch(a){}try{var c;b.from=d("WAWebJidToWid").jidWithTypeToWid(a.attrJidWithType("from"));(c=b.from)!=null&&c.isUser()?b.author=b.from:(c=b.from)!=null&&c.isGroup()&&(b.author=a.hasAttr("participant")?d("WAWebJidToWid").deviceJidToDeviceWid(a.attrDeviceJid("participant")):null)}catch(a){}try{b.offline=a.attrInt("offline")}catch(a){}try{b.edit=a.attrInt("edit")}catch(a){}try{c=a.attrString("category");c=d("WAWebWamMsgUtils").getWamInvisibleMessageCatgoryType(c);c!=null&&(b.invisibleMessageCategoryType=c)}catch(a){}c=a.maybeChild("enc");if(c!=null){try{b.e2eType=c.attrEnumValues("type",d("WAWebBackendJobs.flow").CiphertextType.members())}catch(a){}try{b.encMediaType=d("WAWebBackendJobs.flow").EncMediaType.cast(c.maybeAttrString("mediatype"))}catch(a){}try{b.retryCount=c.attrInt("count")}catch(a){}}try{b.botType=d("WAWebWamEnumBotType").BOT_TYPE.UNKNOWN;if((c=b.author)!=null&&c.isBot())b.botType=d("WAWebWamEnumBotType").BOT_TYPE.METABOT;else{a=(c=a.maybeChild("bot"))==null?void 0:c.maybeAttrString("biz_bot");a==="1"?b.botType=d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ:a==="3"&&(b.botType=d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ)}}catch(a){}return b});function i(a){var b=a.messageDropReason;a=a.stanza;var c=null;try{c=h.parse(a).success}catch(a){}b=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:b,offline:((a=c)==null?void 0:a.offline)!=null,offlineCount:(b=c)==null?void 0:b.offline,messageMediaType:d("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:(a=c)==null?void 0:a.encMediaType,msgType:(b=c)==null?void 0:b.type,msgPollType:(a=c)==null?void 0:a.pollType})});if(((a=c)==null?void 0:a.from)!=null){a=d("WAWebBackendJobsCommon").getMetricE2eDestination(c.from);a!=null&&(b.e2eDestination=a)}if(((a=c)==null?void 0:a.author)!=null){a=d("WAWebWamMsgUtils").getWamE2eSenderType(c.author);a!=null&&(b.e2eSenderType=a)}((a=c)==null?void 0:a.e2eType)!=null&&(b.e2eCiphertextType=d("WAWebBackendJobsCommon").getMetricE2eCiphertextType(c.e2eType));((a=c)==null?void 0:a.retryCount)!=null&&(b.retryCount=c.retryCount);((a=c)==null?void 0:a.edit)===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:((a=c)==null?void 0:a.edit)===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&(b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER);if(((a=c)==null?void 0:a.from)!=null&&((a=c)==null?void 0:a.author)!=null){if(((a=c)==null||(a=a.author)==null?void 0:a.isBot())===!0){((a=c)==null||(a=a.from)==null?void 0:a.isBot())===!0?b.agentEngagementType=d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT:b.agentEngagementType=d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED}}if(((a=c)==null?void 0:a.botType)!=null){b.botType=(a=c)==null?void 0:a.botType}((a=c)==null?void 0:a.invisibleMessageCategoryType)!=null&&(b.invisibleMessageCategory=c.invisibleMessageCategoryType);b.commit()}function a(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_STANZA,stanza:a})}function b(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.UNKNOWN_MESSAGE_TYPE,stanza:a})}function e(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INTERNAL_ERROR,stanza:a})}function f(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DB_OPERATION_FAILED,stanza:a})}function j(a){i({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_HOSTED_COMPANION_STANZA,stanza:a})}function k(a,b){var c=a.msgInfo,e=a.msgMeta,f=a.enc;a=a.error;b=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:b,e2eCiphertextType:d("WAWebBackendJobsCommon").getMetricE2eCiphertextType(f.e2eType),messageMediaType:d("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:f.encMediaType,msgType:e.type,msgPollType:e.pollType}),retryCount:f.retryCount,offline:c.offline!=null,e2eFailureReason:a==null?void 0:a.e2eFailureReason});e=d("WAWebMsgProcessingApiUtils").getFrom(c);f=d("WAWebBackendJobsCommon").getMetricE2eDestination(e);f!=null&&(b.e2eDestination=f);if(e){a=d("WAWebWamMsgUtils").getWamE2eSenderType(e);a!=null&&(b.e2eSenderType=a)}c.edit===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE?b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:c.edit===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&(b.revokeType=d("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER);f=d("WAWebWamMsgUtils").getWamInvisibleMessageCatgoryType(c.category);f!=null&&(b.invisibleMessageCategory=f);if(c.offline!=null){e=parseInt(c.offline,10);Number.isNaN(e)||(b.offlineCount=e)}b.commit()}function l(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.RECEIVED_WITH_OLD_COUNTER)}function m(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DUPLICATE_MESSAGE)}function n(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_PROTOBUF)}function o(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_STANZA)}function p(a){k(a,d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.EXPIRED)}function q(a){for(a of a){var b=d("WAWebDBMessageSerialization").messageFromDbRow(a),c=new(d("WAWebIncomingMessageDropWamEvent").IncomingMessageDropWamEvent)({messageDropReason:d("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.DB_OPERATION_FAILED,messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(b)});b=d("WAWebMsgGetters").getFrom(b);b=d("WAWebBackendJobsCommon").getMetricE2eDestination(b);b!=null&&(c.e2eDestination=b);c.commit()}}g.postIncomingMessageDropInvalidStanza=a;g.postIncomingMessageDropUnknownMessageType=b;g.postIncomingMessageDropInternalError=e;g.postIncomingMessageDropDBOperationFailed=f;g.postIncomingMessageDropInvalidHostedCompanionStanza=j;g.postIncomingMessageDropOldCounter=l;g.postIncomingMessageDropDuplicateMessage=m;g.postIncomingMessageDropInvalidProtobuf=n;g.postIncomingMessageDropInvalidStanzaFromDecryptedMessageInfo=o;g.postIncomingMessageDropExpired=p;g.postIncomingMessageDropDBOperationFailedForMsgRows=q}),98);
__d("WAWebGetMessageCache",["WAWebMessageProcessorCache"],(function(a,b,c,d,e,f,g){var h=null;function a(){h==null&&(h=d("WAWebMessageProcessorCache").messageProcessorCache);return h}g.getMessageCache=a}),98);
__d("WAWebLogoutReasonConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({UserInitiated:"user_initiated",SyncdFailure:"syncd_failure",InvalidAdvStatus:"invalid_adv_status",CriticalSyncTimeout:"critical_sync_timeout",SyncdTimeout:"syncd_timeout",HistorySyncTimeout:"history_sync_timeout",AccountSyncTimeout:"account_sync_timeout",MDOptOut:"md_opt_out",UnknownCompanion:"unknown_companion",ClientVersionOutdated:"client_version_outdated",SyncdErrorDuringBootstrap:"syncd_error_during_bootstrap",AccountSyncError:"account_sync_error",StorageQuotaExceeded:"storage_quota_exceeded",PrimaryIdentityKeyChange:"primary_identity_key_change",MissingEncSalt:"missing_enc_salt",MissingScreenLockSalt:"missing_screen_lock_salt",AccountLocked:"account_locked",LidMigrationSplitThreadMismatch:"lid_migration_split_thread_mismatch",LidMigrationNoLidAvailiable:"lid_migration_no_lid_available",LidMigrationPrimaryMappingsObsolete:"lid_migration_primary_mappings_obsolete",LidMigrationPeerMappingsNotReceived:"lid_migration_peer_mapping_not_received",LidMigrationPeerMappingsMalformed:"lid_migration_peer_mapping_malformed",LidMigrationFailedToParseMapping:"lid_migration_failed_to_parse_mapping",LidMigrationCompanionIncompatibleKillswitch:"lid_migration_companion_incompatible_killswitch",LidMigrationOneOnOneThreadMigrationInternalError:"lid_migration_one_on_one_thread_migration_internal_error",LidBlocklistPnWhenMigrated:"lid_blocklist_pn_when_migrated",LidBlocklistChatDbUnmigrated:"lid_blocklist_chat_db_unmigrated",WebFailAddChat:"web_fail_add_chat",WebFailOfflineResume:"web_fail_offline_resume",WebFailStorageInitialization:"web_fail_storage_initialization",WebFailEncSalt:"web_fail_enc_salt"});c={CLIENT_FATAL:"0",SYNC_FAIL:"1",INITIAL_HISTORY_SYNC_TIMEOUT:"2",ACCOUNT_LOCKED:"3"};f.LogoutReason=a;f.LOGOUT_REASON_CODE=c}),66);
__d("WAWebPushNotificationsGatingUtils",["WAWebABProps","WAWebEnvironment","WAWebNotificationConstants","WAWebUA"],(function(a,b,c,d,e,f,g){function a(){return h()&&d("WAWebABProps").getABPropConfigValue("web_push_notifications")&&!c("WAWebEnvironment").isWindows}function b(a,b){return a===d("WAWebNotificationConstants").PERMISSION_DEFAULT||a===d("WAWebNotificationConstants").PERMISSION_DENIED&&b&&(d("WAWebUA").UA.isChrome||d("WAWebUA").UA.browser===d("WAWebUA").BROWSER_TYPE.EDGE)}function h(){try{var a=d("WAWebUA").UA.isSafari&&Number(d("WAWebUA").UA.browserVersion.split(".")[0])<16;return!a}catch(a){return!1}}function e(){try{var a=d("WAWebUA").UA.isSafari||d("WAWebUA").UA.browser===d("WAWebUA").BROWSER_TYPE.FIREFOX||d("WAWebUA").UA.isChrome&&Number(d("WAWebUA").UA.browserVersion.split(".")[0])<80;return!a}catch(a){return!1}}function f(){return d("WAWebUA").UA.isSafari||d("WAWebUA").UA.isFirefox?!1:!0}g.canEnableOfflineNotifications=a;g.canShowNotificationsBanner=b;g.canSupportOfflineNotifications=h;g.canSupportPeriodicBackgroundSync=e;g.canSupportNotificationActions=f}),98);
__d("WAWebPushNotificationsOfflineBbApi",["WAWebPushNotificationsGatingUtils","WAWebUserPrefsNotifications"],(function(a,b,c,d,e,f,g){var h=10*1e3,i=!0,j=null;function a(){d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&(i=!1,j=self.performance.now())}function b(){d("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&!i&&j!=null&&self.performance.now()-j>h&&d("WAWebUserPrefsNotifications").setOfflineNotificationsBBStatus({isLongResumeTime:!0})}g.setStartCommsT=a;g.setMainStreamModeReadyT=b}),98);
__d("WAWebSocketLogoutJob",["Promise","WALogger","WAWebBackendApi","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsGeneral","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("WAWebRuntimeEnvironmentUtils").isServiceWorker())try{yield (i||(i=b("Promise"))).all([d("WAWebUserPrefsGeneral").setOfflinePushDisabled(!0),d("WAWebUserPrefsGeneral").setLogoutReason({reason:a})])}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Socket logout failed, err: ",""])),a).sendLogs("sw-socket-logout-failed");return}d("WAWebBackendApi").frontendFireAndForget("socketLogout",{reason:a})});return j.apply(this,arguments)}g.socketLogout=a}),98);
__d("WAWebOfflineResumeUtils",["Promise","WABackoffUtils","WALogger","WAPromiseDelays","WAPromiseLoop","WAWebClearDanglingReceipts","WAWebCmd","WAWebGetMessageCache","WAWebLogoutReasonConstants","WAWebMessageReceiptBatcher","WAWebNetworkStatus","WAWebOffdStorageUpdateOfflinePeerReceipts","WAWebOfflineDeviceCache","WAWebPageLoadLogging","WAWebPruneExpiredMessagesWithAddOns","WAWebPushNotificationsOfflineBbApi","WAWebSocketLogoutJob","WAWebWamOfflineResumeReporter","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q={MIN_MESSAGE:20,LIMIT_WITH_MESSAGE:50,MAX_STANZA:200};function a(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebGetMessageCache").getMessageCache().createSnapshot();d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.createSnapshot();var a=[d("WAWebGetMessageCache").getMessageCache().checkpointQueue.wait(),d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.checkpointQueue.wait()];a.push(d("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches());yield (p||(p=b("Promise"))).all(a)});return r.apply(this,arguments)}function e(){if(!c("WAWebNetworkStatus").online){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: skip due to offline."])));return(p||(p=b("Promise"))).resolve()}return d("WAPromiseLoop").promiseLoop(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=d("WAPromiseDelays").delayMs(d("WABackoffUtils").expBackoff(c,12e4,1e3,.1));try{yield d("WAWebClearDanglingReceipts").clearDanglingReceipts();d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: done."])));return a()}catch(e){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: failed with error ","."])),e);if(c>3){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] runReceiptCleanUpLoop: Gave up clean up receipts "," tries"])),c);return a()}return b}});return function(b,c,d){return a.apply(this,arguments)}}())}function f(){var a;(a=window.location)==null||a.reload()}function s(a,b){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] restoreDataFromStorage failed for "," due to ",""])),a,b).verbose().sendLogs("offline-resume-fatal-error-"+a,{sendLogsType:d("WALogger").SendLogsType.USER_FORCEFULLY_LOGGED_OUT_SAD});void d("WAWebSocketLogoutJob").socketLogout(d("WAWebLogoutReasonConstants").LogoutReason.WebFailOfflineResume);return!0}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebPageLoadLogging").startPageLoadQplMeasure("restoreDataFromStorage");var c=a.shouldUpdateReceipts;c=c===void 0?!1:c;a=a.shouldRestoreChatsAndMsgs;var e=a===void 0?!0:a;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] restoreDataFromStorage."])));a=c?d("WAWebOffdStorageUpdateOfflinePeerReceipts").updatePeerReceipts():(p||(p=b("Promise"))).resolve();c=a.then(function(){return e?d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreChatsAndMessages")["catch"](function(a){s("chats",a)}):(p||(p=b("Promise"))).resolve()});a=d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreGroupsAndContacts")["catch"](function(a){s("groups-and-contacts",a)});var f=d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("restoreProfilePictures")["catch"](function(a){s("profile-pictures",a)});yield (p||(p=b("Promise"))).all([c,a,f]);d("WAWebPageLoadLogging").endPageLoadQplMeasure("restoreDataFromStorage")});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{yield d("WAWebPruneExpiredMessagesWithAddOns").pruneExpiredMessagesWithAddOns()}catch(a){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loadMainScreen: pruneExpiredMessages message failed with error: ",""])),a);throw a}yield t(a);x();d("WAWebCmd").Cmd.readyForProcessOffline();d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] loadMainScreen complete"])))});return w.apply(this,arguments)}function x(){d("WAWebCmd").Cmd.readyForMainStreamMode(),d("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logMainScreenLoadT(),d("WAWebPushNotificationsOfflineBbApi").setMainStreamModeReadyT()}function y(a,b){return a+b>q.MAX_STANZA||a>q.MIN_MESSAGE&&a+b>q.LIMIT_WITH_MESSAGE}g.clearOfflineSnapShot=a;g.runReceiptCleanUpLoop=e;g.refreshWindow=f;g.loadMainScreen=v;g.exceedResumeWithOpenTabLimit=y}),98);
__d("WAWebPruneExpiredMessagesWithAddOns",["WALogger","WAWebBackendApi","WAWebDBEphemeralMessage","WAWebMsgKey","WAWebPageLoadLogging","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebPageLoadLogging").startPageLoadQplMeasure("pruneExpiredMessagesWithAddOns");var a=(yield d("WAWebDBEphemeralMessage").pruneExpiredMessages()),b=a.length;if(b>0){var e=[],f=new Set();a.forEach(function(a){a=a.id.toString();f.add(c("WAWebMsgKey").fromString(a).remote.toString());e.push(a)});a=Array.from(f.values()).join(",").toString();d("WAWebBackendApi").frontendFireAndForget("deleteModelsForLastAddOnPreview",{messagesIds:e});yield d("WAWebPersistedJobManager").getJobManager().waitUntilPersisted(d("WAWebPersistedJobDefinitions").jobSerializers.deleteAddOns(a,e));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][utils] pruneExpiredMessagesWithAddOns: pruneExpiredMessages pruned "," msg(s)"])),b)}d("WAWebPageLoadLogging").endPageLoadQplMeasure("pruneExpiredMessagesWithAddOns")});return i.apply(this,arguments)}g.pruneExpiredMessagesWithAddOns=a}),98);
__d("WAWebE2EProtoParserApi",["WABase64","WALogger","WAWebGroupType","WAWebMediaCryptoEligibilityUtils","WAWebProtobufsE2E.pb","WAWebWid","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m;function a(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.PARENT:return d("WAWebGroupType").GroupType.COMMUNITY;case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.SUB:return d("WAWebGroupType").GroupType.LINKED_SUBGROUP;case d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$InviteLinkGroupType.DEFAULT_SUB:return d("WAWebGroupType").GroupType.LINKED_ANNOUNCEMENT_GROUP;default:return d("WAWebGroupType").GroupType.DEFAULT}}function b(a){return a!=null&&!a.includes("/u/")?a:void 0}function e(a){return a?d("WABase64").encodeB64(a):void 0}function f(a,b){if(!n(a,b))return;var c=a.type;if(!d("WAWebMediaCryptoEligibilityUtils").isMediaCryptoExpectedForMsg(a)){b.directPath==null&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""])),c).sendLogs(c+"-unencrypted-message-missing-direct-path");return}b.directPath==null&&b.fileEncSha256==null?d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["directPath and fileEncSha256 missing from msg type ",""])),c).sendLogs(c+"-message-missing-direct-path-and-file-enc"):b.directPath==null?d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""])),c).sendLogs(c+"-message-missing-direct-path"):b.fileEncSha256==null&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fileEncSha256 missing from msg type ",""])),c).sendLogs(c+"-message-missing-file-enc");b.url==null&&d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["url(deprecatedMms3Url) is missing from msg type ",""])),c).sendLogs(c+"-message-missing-mms3-url");b.mediaKey==null&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mediaKey is missing from msg type ",""])),c).sendLogs(c+"-message-missing-media-key")}function n(a,b){var d;if(c("gkx")("26258")&&Math.random()>.001)return!1;if(!a.id)return!1;return((d=a.id.remote)==null?void 0:d.user)==="status"&&c("WAWebWid").isPSA(a.author)&&b.staticUrl==null?!1:!0}g.parseInviteGrpType=a;g.decodeUrl=b;g.decodeBytes=e;g.validateRequiredMediaProperties=f;g.shouldLogE2eProtoValidation=n}),98);
__d("WAWebSendMsgCommonApi",["WADeprecatedWapParser","WAJids","WALogger","WAWap","WAWebABProps","WAWebAck","WAWebAddonRetryRequestUtils","WAWebDeviceListPk","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReactionsBEUtils","WAWebSchemaMessage","WAWebSendMsgTypes","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebVerifyProtobufMsgObjectKeys","WAWebWidFactory","asyncToGeneratorRuntime","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h,i,j,k=5;function a(){return(d("WAWebABProps").getABPropConfigValue("web_e2e_backfill_expire_time")||k)*60}function e(a){a=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,a);d("WAWebSignalCommonUtils").writeRandomPadMax16(a);return a.readByteArrayView()}function f(a){return a.protocolMessage!=null&&a.protocolMessage.type===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE}function l(a){var b;b=(b=(b=a.protocolMessage)==null?void 0:b.type)!=null?b:(b=a.editedMessage)==null||(b=b.message)==null||(b=b.protocolMessage)==null?void 0:b.type;return b===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT||((b=a.secretEncryptedMessage)==null?void 0:b.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT}function m(a){return a.keepInChatMessage!=null&&a.keepInChatMessage.key!=null&&a.keepInChatMessage.key.fromMe===!0&&a.keepInChatMessage.keepType===d("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL}function n(a,b){var c,e=d("WAWebVerifyProtobufMsgObjectKeys").getProtobufMessageTypesSet(a);c=(c=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?c:a;if(e.has(d("WAWebMsgType").MSG_TYPE.PROTOCOL)){a=(a=c.protocolMessage)==null?void 0:a.type;if(a===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE){b=b==="admin_revoke"?d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE:d("WAWebAck").EDIT_ATTR.SENDER_REVOKE;return d("WAWap").CUSTOM_STRING(String(b))}else if(a===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT))}else if(e.has(d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.MESSAGE_EDIT));else if(e.has(d("WAWebMsgType").MSG_TYPE.REACTION)){if(((b=c.reactionMessage)==null?void 0:b.text)===d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT)return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE))}else if(e.has(d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT)){if(m(c))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.SENDER_REVOKE))}else if(e.has(d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE))return d("WAWap").CUSTOM_STRING(String(d("WAWebAck").EDIT_ATTR.PIN_IN_CHAT));return d("WAWap").DROP_ATTR}function o(a,b){return n(a,b)}var p=new(c("WADeprecatedWapParser"))("sendMsgAckSyncParser",function(a){a.assertTag("ack");return{t:a.attrTime("t"),sync:a.hasAttr("sync")?a.attrString("sync"):null,phash:a.hasAttr("phash")?a.attrString("phash"):null,refreshLid:a.hasAttr("refresh_lid")?a.attrString("refresh_lid")==="true":!1,addressingMode:a.hasAttr("addressing_mode")?a.attrString("addressing_mode"):null,count:a.hasAttr("count")?a.attrInt("count"):null,error:a.hasAttr("error")?a.attrInt("error"):null}});function q(a){return a.device==null||a.device===d("WAJids").DEFAULT_DEVICE_ID}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.data.id;if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon){var e=(yield d("WAWebAddonRetryRequestUtils").hasSentAddonMsg(c));if(e!=null)return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().updateIdentityRangeAfterEncryption("sentAddonRowId",e.rowId,b.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a).toString()}))}else if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message){e=(yield d("WAWebSchemaMessage").getMessageTable().get(String(c),!1));a=e==null?void 0:e.rowId;if(a!=null)return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().updateIdentityRangeAfterEncryption("rowId",a,b.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a).toString()}))}});return s.apply(this,arguments)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.data.id;if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon){var c=(yield d("WAWebAddonRetryRequestUtils").hasSentAddonMsg(b));c||d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: addon not found: ",""])),b);return c==null?void 0:c.rowId}else if(a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Message){c=(yield d("WAWebSchemaMessage").getMessageTable().get(String(b),!1));c||d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: message not found: ",""])),b);return c==null?void 0:c.rowId}});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield t(a));if(e==null){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["filterDeviceWithChangedIdentity: cannot determine rowId for message: ",", type: ",""])),a.data.id,a.data.type);throw c("err")("filterDeviceWithChangedIdentity: cannot determine message rowId")}var f=new Map();b.forEach(function(a){f.set(d("WAWebDeviceListPk").createDeviceListPK(a),a)});var g=Array.from(f.values()).map(function(a){return d("WAWebWidFactory").createDeviceWidFromUserAndDevice(a.user,a.server,d("WAJids").DEFAULT_DEVICE_ID)}),h=(yield d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkGetIdentityWithRowId(g.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a)}))),i=new Set();h.forEach(function(b,c){b=a.type===d("WAWebSendMsgTypes").SendMessageRecordType.Addon?b==null?void 0:b.sentAddonRowId:b==null?void 0:b.rowId;c=g[c];(b==null||b>e)&&i.add(d("WAWebDeviceListPk").createDeviceListPK(c))});return b.filter(function(a){return!i.has(d("WAWebDeviceListPk").createDeviceListPK(a))})});return w.apply(this,arguments)}g.getResendTimeoutInSeconds=a;g.encodeAndPad=e;g.isRevokeMsg=f;g.isEditMsg=l;g.editAttribute=o;g.sendMsgAckSyncParser=p;g.isPrimaryDevice=q;g.updateIdentityRange=r;g.filterDeviceWithChangedIdentity=v}),98);
__d("WAWebSignal",["WAWebSignalCipherApi","WAWebSignalSessionApi"],(function(a,b,c,d,e,f,g){g.Cipher=d("WAWebSignalCipherApi"),g.Session=d("WAWebSignalSessionApi")}),98);
__d("WAWebSignalCipherApi",["Promise","WAWebCryptoLibrary","WAWebSignalCommonErrors","asyncToGeneratorRuntime","cr:4533","gkx"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c,d){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){g===void 0&&(g=!1);if(!c("gkx")("26258")){var i=b("cr:4533")==null?void 0:b("cr:4533").getDebugDecryptFail();if(i!=null&&i>0){b("cr:4533")==null||b("cr:4533").setDebugDecryptFail(i-1);return(h||(h=b("Promise"))).reject(new(d("WAWebSignalCommonErrors").SignalDecryptionError)())}}return d("WAWebCryptoLibrary").decryptSignalProto(a,e,f,g)});return i.apply(this,arguments)}function e(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebCryptoLibrary").encryptSignalProto(a,b)});return j.apply(this,arguments)}function f(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){if(!c("gkx")("26258")){var g=b("cr:4533")==null?void 0:b("cr:4533").getDebugDecryptFail();if(g!=null&&g>0){b("cr:4533")==null||b("cr:4533").setDebugDecryptFail(g-1);return(h||(h=b("Promise"))).reject(new(d("WAWebSignalCommonErrors").SignalDecryptionError)())}}return d("WAWebCryptoLibrary").decryptGroupSignalProto(a,e,f)});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return d("WAWebCryptoLibrary").encryptSenderKeyMsgSignalProto(a,b,c)});return m.apply(this,arguments)}g.decryptSignalProto=a;g.encryptSignalProto=e;g.decryptGroupSignalProto=f;g.encryptSenderKeyMsgSignalProto=l}),98);
__d("WAWebCryptoLibrarySignalGroupUtilsApi",[],(function(a,b,c,d,e,f){var g="v1";function a(a,b,c,d){return{signatureKey:a,chainKey:b,keyId:c,messageKeys:d==null?[]:d}}function b(a){return{sessions:a,version:g}}function c(a){return a}function d(a,b){return{counter:a,key:b}}function e(a,b){return b!=null?{pubKey:a,privKey:b}:a}f.makeLibsignalSenderKeyState=a;f.makeNewLibsignalSenderKeySession=b;f.makeLibsignalSenderKeyMsgKey=c;f.makeLibsignalSenderKeyChainKey=d;f.makeLibsignalSenderKeySignatureKey=e}),66);
__d("WAWebCryptoLibrarySenderkeySessionConversionApi",["invariant","WAByteArray","WAPromiseReduce","WASignalGroupSession","WASignalOther","WAWebCryptoLibrarySignalGroupUtilsApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.sessions;a=(yield d("WAPromiseReduce").promiseReduce(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=(yield j(b));return a==null?d("WASignalGroupSession").makeNewSenderKeySession(c):d("WASignalGroupSession").updateSessionWithNewSenderKeyState(a,c)});return function(b,c,d){return a.apply(this,arguments)}}(),null));a!=null||h(0,72944);return a});return i.apply(this,arguments)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.signatureKey.pubKey!==void 0?new Uint8Array(a.signatureKey.pubKey):new Uint8Array(a.signatureKey),c=a.signatureKey.privKey?d("WASignalOther").ensureSize(new Uint8Array(a.signatureKey.privKey),32):void 0,e=d("WASignalGroupSession").makeSenderKeyChainKey(a.chainKey.counter,d("WASignalOther").ensureSize(new Uint8Array(a.chainKey.key),32)),f=a.keyId,g=[],h=function*(b){if(a.messageKeys[b]){var c=a.messageKeys[b];c=(yield d("WASignalOther").hkdf(new Uint8Array(c),null,"WhisperGroup",50).then(function(a){return d("WASignalGroupSession").makeSenderKeyMsgKey(b,a)}));g.push(c)}};for(var i=0;i<a.messageKeys.length;i++)yield* h(i);h=g;i=d("WASignalGroupSession").makeSenderKeyState(b,c,e,f,h);return i});return k.apply(this,arguments)}function l(a){var b=[],c=d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeyChainKey(a.senderKeyChainKey.nextMsgIndex,d("WAByteArray").uint8ArrayToBuffer(a.senderKeyChainKey.chainKey)),e=a.senderKeyId,f=a.senderSigningKeyPrivate;f=f!=null?d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeySignatureKey(d("WAByteArray").uint8ArrayToBuffer(a.senderSigningKeyPublic),d("WAByteArray").uint8ArrayToBuffer(f)):d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeySignatureKey(d("WAByteArray").uint8ArrayToBuffer(a.senderSigningKeyPublic));a=d("WAWebCryptoLibrarySignalGroupUtilsApi").makeLibsignalSenderKeyState(f,c,e,b);return a}function c(a){a=a.senderKeyStates;a=a.map(function(a){return l(a)});return d("WAWebCryptoLibrarySignalGroupUtilsApi").makeNewLibsignalSenderKeySession(a)}g.toCryptoManagerSenderKeySession=a;g.toSignalSenderKeySession=c}),98);
__d("WAWebCryptoLibrarySessionConversionApi",["WAArrayBufferUtils","WALogger","WASignalKeys","WASignalOther","WASignalSessions","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=m(a);c=(yield k(c,b));var e=[];for(var f in a.sessions)if(a.sessions[f].indexInfo.closed!==-1){var g=(yield k(a.sessions[f],b));g=d("WASignalSessions").detachSession(g);e.push(g)}return d("WASignalSessions").setPrevSessions(c,e)});return j.apply(this,arguments)}function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=[];if(a.currentRatchet.lastRemoteEphemeralKey){var e=a[d("WAArrayBufferUtils").arrayBufferToString(a.currentRatchet.lastRemoteEphemeralKey)];if(e){var f=[],g=function*(a){var b=e.messageKeys[a];b=(yield d("WASignalOther").hkdf(new Uint8Array(b),null,"WhisperMessageKeys",80).then(function(b){return d("WASignalSessions").splitMsgKey(a,b)}));f.push(b)};for(var j=0;j<e.messageKeys.length;j++)yield* g(j);g=a.currentRatchet.lastRemoteEphemeralKey;j=e.chainKey.key;if(g!=null&&j!=null){g=d("WASignalSessions").makeRecvChain(d("WASignalKeys").castToSerializedPubKey(new Uint8Array(g)),e.chainKey.counter+1,d("WASignalOther").toBytes(j,32),f);c.push(g)}}}j=a[d("WAArrayBufferUtils").arrayBufferToString(a.currentRatchet.ephemeralKeyPair.pubKey)];g=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.currentRatchet.ephemeralKeyPair.pubKey));var k=j.chainKey.key,l=d("WASignalOther").toBytes(a.currentRatchet.ephemeralKeyPair.privKey,32);l=d("WASignalKeys").makeSerializedKeyPairFrom(l,g);g=d("WASignalSessions").makeSendChain(l,j.chainKey.counter+1,d("WASignalOther").toBytes(k,32));l=b&&{regId:b.registrationId,pubKey:d("WASignalKeys").serializeIdentity(new Uint8Array(b.identityKeyPair.pubKey))};j=b&&{regId:a.registrationId,pubKey:new Uint8Array(a.indexInfo.remoteIdentityKey)};k=a.indexInfo.baseKey&&d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.indexInfo.baseKey));b=a.currentRatchet.previousCounter;b===-1&&d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["toLibsignalSession: prevSendChainHighestIndex: ",", sendChainCounter: ",""])),b,g.nextMsgIndex);var m=d("WASignalOther").toBytes(a.currentRatchet.rootKey,32),n;a.pendingPreKey!=null&&(n=d("WASignalSessions").makeInitialExchangeInfo(a.pendingPreKey.preKeyId,a.pendingPreKey.signedKeyId,d("WASignalKeys").castToSerializedPubKey(new Uint8Array(a.pendingPreKey.baseKey))));a=[];l=d("WASignalSessions").makeSession(l,j,m,c,g,n,Math.max(b,0),a,k);return l}catch(a){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["toCryptoManagerSession: "," "])),a);throw a}});return l.apply(this,arguments)}function m(a){a=a.sessions;for(var b in a)if(a[b].indexInfo.closed===-1)return a[b];throw c("err")("getOpenSession: There are no open session")}g.toCryptoLibrarySessionPrevSessions=a;g.toCryptoManagerSession=k}),98);
__d("WAWebSignalConvertApi",["Promise","WALogger","WAWebCryptoCurve25519","WAWebCryptoLibrarySenderkeySessionConversionApi","WAWebCryptoLibrarySessionConversionApi","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function m(a){return(a==null?void 0:a.sessions)!=null}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(a==null||!m(a))return a;var e=(yield (l||(l=b("Promise"))).all([d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair(),d("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId()])),f=e[0];e=e[1];if(!f||e==null)throw c("err")("Attempted to loadSession without registration info");f={identityKeyPair:d("WAWebCryptoCurve25519").toCurveKeyPair(f),registrationId:e};d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSession: converting to crypto library"]))).sendLogs("libsignal-to-cryptolib-session",{sampling:0});return d("WAWebCryptoLibrarySessionConversionApi").toCryptoLibrarySessionPrevSessions(a,f)}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSession: failed with error ",""])),a).sendLogs("session-convert-error");throw a}});return n.apply(this,arguments)}function o(a){return a.sessions!=null}function e(a){try{if(a==null||!o(a))return a;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSenderKey: converting to crypto library"]))).sendLogs("libsignal-to-cryptolib-senderkey",{sampling:0});return d("WAWebCryptoLibrarySenderkeySessionConversionApi").toCryptoManagerSenderKeySession(a)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["maybeConvertSenderKey: failed with error ",""])),a).sendLogs("senderkey-convert-error");throw a}}g.shouldConvertSession=m;g.maybeConvertSession=a;g.maybeConvertSenderKey=e}),98);
__d("WAWebSignalSessionApi",["Promise","WABinary","WAJids","WALogger","WAWebAdvSignatureApi","WAWebApiContact","WAWebCryptoCurve25519","WAWebCryptoLibrary","WAWebCryptoLibraryDbCallbacksApi","WAWebCryptoLibrarySessionApi","WAWebCryptoLibraryUtilsApi","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebSignalStoreApi","WAWebWidFactory","asyncToGeneratorRuntime","cr:4533","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.wid,e=a.identity,f=a.deviceIdentity;c("gkx")("26258")?d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Signal::createSignalSession"]))):d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Signal::createSignalSession with ",""])),b.toString({legacy:!0}));if(b.device!=null&&b.device!==d("WAJids").DEFAULT_DEVICE_ID){if(!f)throw c("err")("Signal::createSignalSession: expected device-identity in keyBundle for companion device");f=(yield d("WAWebAdvSignatureApi").validateADVwithIdentityKey(b,f,e));if(!f)throw c("err")("Signal::createSignalSession: invalid identityKey fetched")}var g,m,n;try{g=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.identity).readBuffer())}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Signal::createSignalSession: invalid identityKey fetched");throw a}try{m=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.skey.pubkey).readBuffer())}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Signal::createSignalSession: invalid signedPreKey fetched");throw a}if(a.key)try{n=d("WAWebCryptoCurve25519").toSignalCurvePubKey(new(d("WABinary").Binary)(a.key.pubkey).readBuffer())}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Signal::createSignalSession: invalid preKey fetched")}e={registrationId:a.regId,identityKey:g,signedPreKey:{keyId:a.skey.id,publicKey:m,signature:new(d("WABinary").Binary)(a.skey.signature).readBuffer()}};a.key&&n&&(e.preKey={keyId:a.key.id,publicKey:n});return d("WAWebCryptoLibrarySessionApi").createSignalSession(e,b)});return s.apply(this,arguments)}function e(a){d("WAWebApiContact").checkPnToLidMapping(a,d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_HAS_SIGNAL_SESSIONS);return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().containSessions(a.map(function(a){return d("WAWebSignalCommonUtils").createSignalAddress(a).toString()}))}function f(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebCryptoLibrarySessionApi").getRemoteRegId(a)});return t.apply(this,arguments)}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_REMOTE_INFO);a=d("WAWebSignalCommonUtils").createSignalAddress(a).toString();a=[d("WAWebSignalProtocolStore").getSignalProtocolStore().removeIdentity(a),d("WAWebSignalProtocolStore").getSignalProtocolStore().removeSession(a)];yield (r||(r=b("Promise"))).all(a)});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_REMOTE_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(a).toString();yield d("WAWebSignalProtocolStore").getSignalProtocolStore().removeSession(a)});return x.apply(this,arguments)}function y(a){a=d("WAWebSignalCommonUtils").createSignalAddress(a).toString();return d("WAWebSignalProtocolStore").getPersistSignalProtocolStore().maybeCleanUpUnconvertedSession(a)}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebCryptoLibraryDbCallbacksApi").getCryptoDbCallbacks();a=d("WAJids").unsafeCoerceToDeviceJid(a.toJid());a=(yield c("WAWebCryptoLibraryUtilsApi").getSessionAliceBaseKey(a,b.loadSession));return a.success===!0?a.value:null});return A.apply(this,arguments)}function B(a,b){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_SAVE_SESSION_BASE_KEY);var c=d("WAWebSignalCommonUtils").createSignalAddress(a);a=(yield z(a));!a?d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["saveSessionBaseKey: for ",", no basekey provided"])),b):yield d("WAWebSignalStoreApi").waSignalStore.saveBaseKey(c.toString(),b,a)});return C.apply(this,arguments)}function D(a,b){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_HAS_SAME_BASE_KEY);var e=d("WAWebSignalCommonUtils").createSignalAddress(a);a=(yield (r||(r=b("Promise"))).all([z(a),d("WAWebSignalStoreApi").waSignalStore.loadBaseKey(e.toString(),c)]));e=a[0];a=a[1];if(!a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", no base key has been saved locally "])),c);return!1}if(!e){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", no session has been saved locally "])),c);return!1}if(!d("WAWebSignalCommonUtils").bufferEqual(a,e)){d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is different "])),c);return!1}d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["hasSameBaseKey: MsgId: ",", savedBaseKey and sessionBaseKey is same"])),c);return!0});return E.apply(this,arguments)}function F(a,b,c){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){return d("WAWebCryptoLibrarySessionApi").createGroupSenderSignalSession(d("WAWebWidFactory").createWid(b),a,c)});return G.apply(this,arguments)}function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebCryptoLibrary").getGroupSenderKeyInfo(a,b)});return I.apply(this,arguments)}function J(a,b){d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_GROUP_SENDER_KEY_INFO);b=d("WAWebSignalCommonUtils").createSignalAddress(b);a=a.toString({legacy:!0})+"::"+b.toString();return d("WAWebSignalStoreApi").waSignalStore.removeSenderKey(a)}function K(a){d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_SIGNAL_SESSION_DELETE_DEVICE_SENDER_KEY);a=String(d("WAWebSignalCommonUtils").createSignalAddress(a));return d("WAWebSignalStoreApi").waSignalStore.removeSenderKeyBySenderId(a)}g.createSignalSession=a;g.hasSignalSessions=e;g.getRemoteRegId=f;g.deleteRemoteInfo=u;g.deleteRemoteSession=w;g.maybeDeleteUnconvertedSession=y;g.saveSessionBaseKey=B;g.hasSameBaseKey=D;g.createGroupSignalSession=F;g.getGroupSenderKeyInfo=H;g.deleteGroupSenderKeyInfo=J;g.deleteDeviceSenderKey=K}),98);
__d("WAWebSignalUtilsApi",["WAWap","WAWebCryptoCurve25519","WAWebCryptoLibraryUtilsApi"],(function(a,b,c,d,e,f,g){function a(a){var b;return(b=d("WAWap")).wap("skey",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.keyId,3)),b.wap("value",null,a.keyPair.pubKey),b.wap("signature",null,a.signature))}function b(a){var b;return(b=d("WAWap")).wap("key",null,b.wap("id",null,b.BIG_ENDIAN_CONTENT(a.keyId,3)),b.wap("value",null,a.keyPair.pubKey))}function e(a){a=c("WAWebCryptoLibraryUtilsApi").extractIdentityKey(a);return a.success===!0?d("WAWebCryptoCurve25519").toCurveKeyPubKey(a.value):null}g.xmppSignedPreKey=a;g.xmppPreKey=b;g.extractIdentityKey=e}),98);
__d("WAWebCryptoLibrary",["Promise","WAByteArray","WACryptoLibrary","WAJids","WALogger","WASignalKeys","WAWebABProps","WAWebBackendJobs.flow","WAWebCryptoLibraryDbCallbacksApi","WAWebCryptoLibraryUtilsApi","WAWebSignalCommonErrors","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=d("WAWebCryptoLibraryDbCallbacksApi").getCryptoDbCallbacks();function z(){var a;return{establishOutgoingSession:(a=d("WACryptoLibrary")).establishOutgoingSession,decryptContent:a.decryptContent,encryptContent:a.encryptContent,encryptGroupContent:a.encryptGroupContent,decryptGroupContent:a.decryptGroupContent,saveSenderKeySession:a.saveSenderKeySession,rotateGroupSenderKey:a.rotateGroupSenderKey}}function a(a,b){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createSignalSession"])));var e=(yield y.getRegistrationInfo());if(!e)throw c("err")("No registration info found");return z().establishOutgoingSession({handleNewSession:y.handleNewSession},e,d("WAWebWidToJid").widToDeviceJid(a),b,void 0).then(function(a){if(!a.success){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createSignalSession failed with error ",""])),a.error);throw c("err")(a.error)}})});return A.apply(this,arguments)}function e(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){g===void 0&&(g=!1);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptSignalProto"])));e=e===d("WAWebBackendJobs.flow").CiphertextType.Pkmsg?"pkmsg":"msg";var h,i=(yield y.getRegistrationInfo());return!i?(x||(x=b("Promise"))).reject(c("err")("No registration info found")):z().decryptContent({handleNewSession:function(a,b,c,d,e){return y.handleNewSession(a,b,c,d,e,g)},loadOneTimePreKey:y.loadOneTimePreKey,loadSession:y.loadSession,loadSignedPreKey:y.loadSignedPreKey},i,d("WAWebWidToJid").widToDeviceJid(a),{ciphertext:f,type:e},function(a){h=d("WAByteArray").uint8ArrayToBuffer(a);return(x||(x=b("Promise"))).resolve()},{S508658PreventOldSessionLookupAndPromote:d("WAWebABProps").getABPropConfigValue("web_signal_prevent_old_session_lookup_and_promote")}).then(function(a){if(a.success){if(h==null)throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Null result on successful decryption");return h}a=a.error;d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptMessage failed with error ",""])),a);if(a==="errDuplicateMsg")throw new(d("WAWebSignalCommonErrors").SignalMessageCounterError)(a);else throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)(a)})["catch"](function(a){if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError||a instanceof d("WAWebSignalCommonErrors").SignalMessageCounterError)throw a;d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptSignalProto failed to decrypt: ",""])),a.stack);throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Unexpected decryption error")})});return B.apply(this,arguments)}function f(a,b){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptSignalProto"])));return z().encryptContent({handleNewSession:y.handleNewSession,loadSession:y.loadSession},d("WAWebWidToJid").widToDeviceJid(a),b,null).then(function(a){if(a.success){var b=a.value,e=b.type;b=b.ciphertext;return{type:(e=d("WAWebBackendJobs.flow").CiphertextType.cast(e))!=null?e:d("WAWebBackendJobs.flow").CiphertextType.Msg,ciphertext:d("WAByteArray").uint8ArrayToBuffer(b)}}d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptSignalProto:failed with error ",""])),a.error);throw c("err")(a.error)})}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebWidToJid").widToDeviceJid(a);a=(yield y.loadSession(a));return a==null?void 0:a.remote});return D.apply(this,arguments)}function E(a,b,c){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f;a=d("WAWebWidToJid").widToMulticastJid(a);f=(f=(f=d("WAJids").validateGroupJid(a))!=null?f:d("WAJids").validateStatusJid(a))!=null?f:d("WAJids").validateBroadcastJid(a);if(f==null)throw c("err")("Invalid multicast JID");a=d("WAWebWidToJid").widToDeviceJid(b);b=(yield z().encryptGroupContent({loadSenderKeySession:y.loadSenderKeySession,saveSenderKeySession:y.saveSenderKeySession},f,a,e));if(!b.success&&b.error==="errLoadSenderKeySession"){b.error;d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptGroupMessage no sender key, generating a new one"])));var g=(yield d("WASignalKeys").makeKeyPair());yield z().rotateGroupSenderKey({saveSenderKeySession:y.saveSenderKeySession},f,a,g);b=(yield z().encryptGroupContent({loadSenderKeySession:y.loadSenderKeySession,saveSenderKeySession:y.saveSenderKeySession},f,a,e))}if(b.success){g=b.value.ciphertext.ciphertext;f=b.value.senderKeyDistributionProto;return{ciphertext:d("WAByteArray").uint8ArrayToBuffer(g),senderKeyBytes:d("WAByteArray").uint8ArrayToBuffer(f)}}d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::encryptGroupMessage failed with error ",""])),b.error);throw c("err")(b.error)});return F.apply(this,arguments)}function G(a,b,e){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::processSenderKeyDistributionMsg"])));return z().saveSenderKeySession({loadSenderKeySession:y.loadSenderKeySession,saveSenderKeySession:y.saveSenderKeySession},a,d("WAWebWidToJid").widToDeviceJid(b),new Uint8Array(e)).then(function(a){if(!a.success){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::processSenderKeyDistributionMsg failed with error ",""])),a.error);throw c("err")(a.error)}})}function H(a,c,e){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupSignalProto"])));var f=null;return z().decryptGroupContent({loadSenderKeySession:y.loadSenderKeySession,saveSenderKeySession:y.saveSenderKeySession},d("WAWebWidToJid").widToMulticastJid(a),d("WAWebWidToJid").widToDeviceJid(c),e,function(a){f=d("WAByteArray").uint8ArrayToBuffer(a);return(x||(x=b("Promise"))).resolve()}).then(function(a){if(a.success){if(f==null)throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Null result on successful decryption of group msg");return f}a=a.error;d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupMessage failed ",""])),a);if(a==="errDuplicateMsg")throw new(d("WAWebSignalCommonErrors").SignalMessageCounterError)(a);else throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)(a)})["catch"](function(a){if(a instanceof d("WAWebSignalCommonErrors").SignalDecryptionError||a instanceof d("WAWebSignalCommonErrors").SignalMessageCounterError)throw a;d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::decryptGroupSignalProto failed to decrypt: ",""])),a);throw new(d("WAWebSignalCommonErrors").SignalDecryptionError)("Unexpected decryption error")})}function I(a,b){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::getGroupSenderKeyInfo"])));a=(yield c("WAWebCryptoLibraryUtilsApi").createSenderKeyDistributionMsg(y.loadSenderKeySession,y.saveSenderKeySession,d("WAJids").toGroupJid(a.toString({legacy:!0})),d("WAWebWidToJid").widToDeviceJid(b)));if(a.success)return d("WAByteArray").uint8ArrayToBuffer(a.value);d("WALogger").WARN(w||(w=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::getGroupSenderKeyInfo failed with error ",""])),a.error);throw c("err")(a.error)});return J.apply(this,arguments)}g.getCryptoLibModule=z;g.createSignalSession=a;g.decryptSignalProto=e;g.encryptSignalProto=f;g.getRemoteRegId=C;g.encryptSenderKeyMsgSignalProto=E;g.processSenderKeyDistributionMsg=G;g.decryptGroupSignalProto=H;g.getGroupSenderKeyInfo=I}),98);
__d("WAWebCryptoLibraryDbCallbacksApi",["Promise","WAByteArray","WAResultOrError","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WAWebApiContact","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){var a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebWidFactory").createDeviceWidOrThrow(a);d("WAWebApiContact").checkPnToLidMapping([a],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_LOAD_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(a);a=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSession(a));return a!=null?a:null});return function(b){return a.apply(this,arguments)}}(),c=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,i){i===void 0&&(i=!1);g=d("WAWebWidFactory").createDeviceWidOrThrow(a);d("WAWebApiContact").checkPnToLidMapping([g],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_HANDLE_NEW_SESSION);a=d("WAWebSignalCommonUtils").createSignalAddress(g);return(h||(h=b("Promise"))).all([!i&&d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSession(a,c),e&&d("WAWebSignalProtocolStore").getSignalProtocolStore().saveIdentity(a,d("WAByteArray").uint8ArrayToBuffer(e)),f!=null&&d("WAWebSignalProtocolStore").getSignalProtocolStore().removePreKey(f)]).then(function(){return d("WAResultOrError").makeResult()})});return function(b,c,d,e,f,g){return a.apply(this,arguments)}}(),e=function(a,b){b=d("WAWebWidFactory").createDeviceWidOrThrow(b);d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_LOAD_SENDER_KEY_SESSION);a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,b);return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSenderKey(a).then(function(a){if(a==null)return d("WAResultOrError").makeError("errLoadSenderKeySession");a=a;return d("WAResultOrError").makeResult(a)})},f=function(a,b,c){b=d("WAWebWidFactory").createDeviceWidOrThrow(b);d("WAWebApiContact").checkPnToLidMapping([b],d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_CRYPTO_LIBRARY_DB_CALLBACK_API_SAVE_SENDER_KEY_SESSION);a=d("WAWebSignalCommonUtils").createSignalLikeSenderKeyName(a,b);return d("WAWebSignalProtocolStore").getSignalProtocolStore().storeSenderKey(a,c)};return{loadSession:a,handleNewSession:c,loadSenderKeySession:e,saveSenderKeySession:f,loadSignedPreKey:function(a){return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadSignedPreKey(a).then(function(b){if(b==null)return null;var c=d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey,b.privKey);c=d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,{id:a,publicKey:d("WASignalKeys").serializePubKey(c),privateKey:c.privateKey,signature:new Uint8Array(b.signature),timestamp:0});return d("WASignalOther").castToByteEncoded(c)})},loadOneTimePreKey:function(a){return d("WAWebSignalProtocolStore").getSignalProtocolStore().loadPreKey(a).then(function(b){if(b==null)return null;b=d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey,b.privKey);b=d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,{id:a,publicKey:d("WASignalKeys").serializePubKey(b),privateKey:b.privateKey});return d("WASignalOther").castToByteEncoded(b)})},getRegistrationInfo:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getLocalRegistrationId()),b=(yield d("WAWebSignalProtocolStore").getSignalProtocolStore().getIdentityKeyPair());if(a==null||b==null)return;if(a&&b)return{regId:d("WASignalOther").castRegistrationId(a),staticKeyPair:d("WASignalKeys").makeKeyPairFromArrayBuffers(b.pubKey.slice(1),b.privKey)}});function c(){return a.apply(this,arguments)}return c}()}}g.getCryptoDbCallbacks=a}),98);
__d("WAWebCryptoLibrarySessionApi",["WALogger","WAWebCryptoLibrary"],(function(a,b,c,d,e,f,g){var h;function a(a){return d("WAWebCryptoLibrary").getRemoteRegId(a).then(function(a){return a==null?void 0:a.regId})}function b(a,b){var c;c={identity:new Uint8Array(a.identityKey),oneTimeKey:a.preKey&&{id:(c=a.preKey)==null?void 0:c.keyId,publicKey:((c=a.preKey)==null?void 0:c.publicKey)&&new Uint8Array((c=a.preKey)==null?void 0:c.publicKey)},regId:a.registrationId,signedKey:{id:a.signedPreKey.keyId,publicKey:new Uint8Array(a.signedPreKey.publicKey),signature:new Uint8Array(a.signedPreKey.signature)}};return d("WAWebCryptoLibrary").createSignalSession(b,c)}function c(a,b,c){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["CryptoLibrarySignal::createGroupSenderSignalSession"])));return d("WAWebCryptoLibrary").processSenderKeyDistributionMsg(a,b,c)}g.getRemoteRegId=a;g.createSignalSession=b;g.createGroupSenderSignalSession=c}),98);
__d("WAWebCryptoLibraryUtilsApi",["WACryptoPrimitives","WALogger","WAResultOrError","WASignalCipher","WASignalGroupCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WATimeUtils","WAWebCryptoLibrary","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h;a=function(){function a(){}var c=a.prototype;c.createSenderKeyDistributionMsg=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield a(c,e));if(!f.success&&f.error==="errLoadSenderKeySession"){var g=(yield d("WASignalKeys").makeKeyPair());yield d("WAWebCryptoLibrary").getCryptoLibModule().rotateGroupSenderKey({saveSenderKeySession:b},c,e,g);f=(yield a(c,e))}if(f.success){b=f.value.senderKeyStates.slice(-1);if(b.length>0)return d("WAResultOrError").makeResult(d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(b[0])))}return d("WAResultOrError").makeError("errGetSenderKeyProto")});function c(b,c,d,e){return a.apply(this,arguments)}return c}();c.getSessionAliceBaseKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield b(a));return b!=null&&b.aliceBaseKey?d("WAResultOrError").makeResult(d("WASignalOther").toBuffer(b.aliceBaseKey)):d("WAResultOrError").makeError("errSessionExists")});function c(b,c){return a.apply(this,arguments)}return c}();c.extractIdentityKey=function(a){a=d("WASignalCipher").readContent(a,d("WASignalSessions").FORMAT_VERSION,0);if(!a.success)return a;try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,a.value);var b=a.registrationId,c=a.signedPreKeyId,e=a.baseKey,f=a.identityKey;a=a.message;if(b==null||c==null||e==null||f==null||a==null)return d("WAResultOrError").makeError("errSignalDeserializePkInvalidProtoFormat");d("WASignalOther").ensureSize(new Uint8Array(f),33);return d("WAResultOrError").makeResult(f)}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["extractIdentityKey: parse proto failed"]))).devConsole(a);return d("WAResultOrError").makeError("errSignalDeserializePkKeyBadFormat")}};c.verifySignature=function(a,b,c){a=d("WASignalSignatures").convertPublicKeyToSerializedPubKey(a);c=d("WASignalOther").ensureSize(c,64);return d("WASignalSignatures").verifyMsgSignalVariant(a,b,c)};c.signMsg=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WASignalKeys").makeKeyPairFromArrayBuffers(a,b);b=(yield d("WASignalSignatures").signMsg(a,new Uint8Array(c)));return d("WASignalOther").toBuffer(b)});function c(b,c,d){return a.apply(this,arguments)}return c}();c.makePreKey=function(a){a=d("WASignalKeys").makePreKeys(a,1);a=a[0].plainObject;var b=a.id;a=a.keyPair;return{preKeyId:b,privKey:d("WASignalOther").toBuffer(a.privateKey),pubKey:d("WASignalOther").toBuffer(a.publicKey)}};c.makeSignedPreKey=function(a,b){a=d("WASignalKeys").makeKeyPairFromArrayBuffers(a.pubKey,a.privKey);b=d("WASignalSignatures").makeSignedPreKey(b,d("WATimeUtils").unixTimeMs(),a);return{preKeyId:b.id,signature:d("WASignalOther").toBuffer(b.signature),pubKey:d("WASignalOther").toBuffer(b.keyPair.publicKey),privKey:d("WASignalOther").toBuffer(b.keyPair.privateKey)}};c.makeKeyPair=function(){var a=d("WASignalKeys").makeKeyPair(),b=a.privateKey;a=a.publicKey;return{privKey:d("WASignalOther").toBuffer(b),pubKey:d("WASignalOther").toBuffer(a)}};return a}();a.prototype.verify=d("WACryptoPrimitives").verify;a.prototype.makeRegistrationId=d("WASignalOther").makeRegistrationId;a.prototype.makeSenderKeyId=d("WASignalOther").makeSenderKeyId;c=new a();e=c;g["default"]=e}),98);
__d("WAWebSignalProtocolStore",["WAWebSignalProtocolStoreUnifiedApi"],(function(a,b,c,d,e,f,g){function a(){return c("WAWebSignalProtocolStoreUnifiedApi")}function b(){return c("WAWebSignalProtocolStoreUnifiedApi")}function d(){c("WAWebSignalProtocolStoreUnifiedApi").switchToMemMode()}function e(){c("WAWebSignalProtocolStoreUnifiedApi").switchToPersistMode()}g.getSignalProtocolStore=a;g.getPersistSignalProtocolStore=b;g.enableMemSignalStore=d;g.enablePersistSignalStore=e}),98);
__d("WAWebProtocolStoreCommonApi",["WAWebSignalCommonUtils"],(function(a,b,c,d,e,f,g){function a(a){return a instanceof ArrayBuffer?d("WAWebSignalCommonUtils").bufferToStr(a):a}g.stringifyIdentityKey=a}),98);
__d("WAWebSignalProtocolStoreCacheApi",["Promise","WALogger","WASemaphore","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i;a=function(){function a(){var a;this.RegistrationInfo=null;this.SignedPreKeyStore=new Map();this.PrekeyStore=new Map();this.SessionStore=new Map();this.IdentityStore=new Map();this.SenderKeyStore=new Map();this.Mutex={session:new((a=d("WASemaphore")).Semaphore)(),identity:new a.Semaphore(),senderKey:new a.Semaphore(),preKey:new a.Semaphore()};this.Dirty={session:new Set(),identity:new Set(),senderKey:new Set(),preKey:new Set()}}var e=a.prototype;e.$1=function(){var a=this,b=[],d=[];this.Dirty.session.forEach(function(e){var f=a.SessionStore.get(e);if(!f)return;!f.deleted?b.push({address:e,session:c("lodash").cloneDeep(f.session)}):d.push(e)});return{update:b,remove:d}};e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=[],b=[],d=self.performance.now();for(var e of this.Dirty.session){self.performance.now()-d>k&&(yield l(),d=self.performance.now());var f=this.SessionStore.get(e);if(!f)continue;!f.deleted?a.push({address:e,session:c("lodash").cloneDeep(f.session)}):b.push(e)}return{update:a,remove:b}});function d(){return a.apply(this,arguments)}return d}();e.$3=function(){var a=this,b=[];this.Dirty.senderKey.forEach(function(d){var e=a.SenderKeyStore.get(d);if(e){var f=d.split("::");f.length===2&&b.push({senderKeyName:d,senderId:f[1],senderKey:c("lodash").cloneDeep(e)})}});return b};e.$4=function(){var a=this,b=[],c=[];this.Dirty.identity.forEach(function(d){var e=a.IdentityStore.get(d);if(!e)return;!e.deleted?b.push({identifier:d,identityKey:e.identityKey,rowId:e.rowId,sentAddonRowId:e.sentAddonRowId}):c.push(d)});return{update:b,remove:c}};e.$5=function(){var a=this,b=[];this.Dirty.preKey.forEach(function(c){var d=a.PrekeyStore.get(c);d!=null&&d.deleted&&b.push(parseInt(c,10))});return b};e.generateCacheUpdate=function(){var a=this.$4(),b=this.$1();b={sessionUpdate:b.update,sessionRemove:b.remove,identityUpdate:a.update,identityRemove:a.remove,senderKeyUpdate:this.$3(),preKeyRemove:this.$5()};j(b);return b};e.generateCacheUpdateThrottled=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this.$4(),b=(yield this.$2());b={sessionUpdate:b.update,sessionRemove:b.remove,identityUpdate:a.update,identityRemove:a.remove,senderKeyUpdate:this.$3(),preKeyRemove:this.$5()};j(b);return b});function c(){return a.apply(this,arguments)}return c}();e.clearDirty=function(){this.Dirty={session:new Set(),identity:new Set(),senderKey:new Set(),preKey:new Set()}};e.clear=function(){this.RegistrationInfo=null,this.SignedPreKeyStore.clear(),this.PrekeyStore.clear(),this.SessionStore.clear(),this.IdentityStore.clear(),this.SenderKeyStore.clear(),this.clearDirty()};return a}();function j(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Signal]signalSnapshot: get dirty updates for\n  session: ","\n  senderKey: ","\n  identity: ",";\n  preKeyRemove: ","\n  sessionRemove: ","\n  identityRemove: ","\n"])),a.sessionUpdate.map(function(a){return a.address}).join(",")||"[]",a.senderKeyUpdate.map(function(a){return a.senderKeyName}).join(",")||"[]",a.identityUpdate.map(function(a){return a.identifier}).join(",")||"[]",a.preKeyRemove.join(",")||"[]",a.sessionRemove.join(",")||"[]",a.identityRemove.join(",")||"[]").tags("unified-store")}var k=100;function l(){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield new(i||(i=b("Promise")))(function(a){return self.setTimeout(a,0)})});return m.apply(this,arguments)}g.SignalStoreCache=a}),98);
__d("WAWebSignalProtocolStoreUnifiedApi",["$InternalEnum","Promise","WALogger","WAWebABProps","WAWebBackendApi","WAWebCryptoCurve25519","WAWebIdentityChangeApi","WAWebProtocolStoreCommonApi","WAWebSignalCommonUtils","WAWebSignalConvertApi","WAWebSignalProtocolStoreCacheApi","WAWebSignalStorageUtils","WAWebSignalStoreApi","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=b("$InternalEnum").Mirrored(["Persist","Memory"]);a=function(){function a(){this.Direction={SENDING:1,RECEIVING:2},this.$1=new(d("WAWebSignalProtocolStoreCacheApi").SignalStoreCache)(),this.$2=v.Persist}var e=a.prototype;e.cache_TESTONLY=function(){return this.$1};e.getIdentityKeyPair=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;this.$1.RegistrationInfo||(this.$1.RegistrationInfo=(yield d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo()));return(a=this.$1.RegistrationInfo)!=null&&a.identityKeyPair?d("WAWebCryptoCurve25519").toSignalCurveKeyPair(this.$1.RegistrationInfo.identityKeyPair):void 0});function c(){return a.apply(this,arguments)}return c}();e.getLocalRegistrationId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;this.$1.RegistrationInfo||(this.$1.RegistrationInfo=(yield d("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo()));return((a=this.$1.RegistrationInfo)==null?void 0:a.registrationId)||void 0});function c(){return a.apply(this,arguments)}return c}();e.isTrustedIdentity=function(a,c){return(u||(u=b("Promise"))).resolve(!0)};e.$3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(!this.$1.IdentityStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getIdentityKeyWithRowId(a));this.$1.IdentityStore.set(a,b)}return((b=this.$1.IdentityStore.get(a))==null?void 0:b.identityKey)||void 0});function e(b){return a.apply(this,arguments)}return e}();e.loadIdentityKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.identity.acquire());try{return yield this.$3(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$4=function(a,b){this.$1.IdentityStore.set(a,{identityKey:b}),this.$1.Dirty.identity.add(a)};e.putIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this.$1.Mutex.identity.acquire());try{this.$4(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e.$5=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebProtocolStoreCommonApi").stringifyIdentityKey(b);var c=(yield this.loadIdentityKey(a));if(c!=null&&c===b)return;else if(c!=null){if(a===d("WAWebSignalCommonUtils").createSignalAddress(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()).toString()){d("WAWebBackendApi").frontendFireAndForget("handleSelfPrimaryIdentityChange",{});return}a!=null&&(yield d("WAWebIdentityChangeApi").handleNewIdentity(d("WAWebWidFactory").widFromSignalAddress(a),!1))}yield this.putIdentity(a,b)});function c(b,c){return a.apply(this,arguments)}return c}();e.saveIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a==null)throw c("err")("Tried to put identity key for undefined/null key");yield this.$5(a,b)});function d(b,c){return a.apply(this,arguments)}return d}();e.getIdentityWithRowId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)throw c("err")("Tried to get identity key for undefined/null key");yield this.loadIdentityKey(a);a=this.$1.IdentityStore.get(a);if(a==null||a.deleted!==void 0)return;return a});function d(b){return a.apply(this,arguments)}return d}();e.bulkGetIdentityWithRowId=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(a.length===0)return[];yield this.bulkLoadIdentityKey(a);return a.map(function(a){a=b.$1.IdentityStore.get(a);if(a==null||a.deleted!==void 0)return;return a})});function d(b){return a.apply(this,arguments)}return d}();e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(a==null)throw c("err")("Tried to get identity key for undefined/null key");if(a.length===0)return[];var e=new Array(a.length),f=[];a.forEach(function(a,c){if(b.$1.IdentityStore.has(a)){var d;e[c]=(d=b.$1.IdentityStore.get(a))==null?void 0:d.identityKey}else f.push({id:a,pos:c})});if(f.length>0){a=(yield d("WAWebSignalStoreApi").waSignalStore.bulkGetIdentityKeyWithRowId(f.map(function(a){return a.id})));a.forEach(function(a,c){c=f[c];b.$1.IdentityStore.set(c.id,a);e[c.pos]=a==null?void 0:a.identityKey})}return e});function e(b){return a.apply(this,arguments)}return e}();e.bulkLoadIdentityKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.identity.acquire());try{return yield this.$6(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this;if(a==null)throw c("err")("Tried to bulk put identity key with undefined/null");d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[Signal]bulkCreateIdentity: store "," value(s): start"])),a.length).tags("unified-store");yield d("WAWebSignalStorageUtils").getStorage().lock(["identity-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=a.map(function(a){return a.identifier}),c=(yield e.$6(b));b=a.filter(function(a,b){return!c[b]});b.length>0&&(yield d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentity(b),b.forEach(function(a){var b=a.identifier;a=a.identityKey;e.$1.IdentityStore.set(b,{identityKey:a})}));d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[Signal]bulkCreateIdentity: store "," value(s) (new: ","): end"])),a.length,b.length).tags("unified-store")}))});function e(b){return a.apply(this,arguments)}return e}();e.bulkCreateIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.identity.acquire());try{yield this.$7(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$8=function(a){this.$1.IdentityStore.set(a,{deleted:!0}),this.$1.Dirty.identity.add(a)};e.removeIdentity=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return(u||(u=b("Promise"))).reject(c("err")("Tried to remove identity key for undefined/null key"));var d=(yield this.$1.Mutex.identity.acquire());try{yield this.$8(a)}finally{d.release()}});function d(b){return a.apply(this,arguments)}return d}();e.$9=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this.$1.PrekeyStore.has(a)){var b;b=(b=(yield d("WAWebSignalStoreApi").waSignalStore.getPreKeyById(a)))==null?void 0:b.keyPair;this.$1.PrekeyStore.set(a,{keyPair:b})}b=this.$1.PrekeyStore.get(a);return(b==null?void 0:b.keyPair)||void 0});function c(b){return a.apply(this,arguments)}return c}();e.loadPreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.preKey.acquire());try{return yield this.$9(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$10=function(a){if(a==null)return(u||(u=b("Promise"))).reject(c("err")("Tried to remove pre key without keyId"));this.$1.PrekeyStore.set(a,{deleted:!0});this.$1.Dirty.preKey.add(a);return(u||(u=b("Promise"))).resolve()};e.removePreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.preKey.acquire());try{yield this.$10(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.loadSignedPreKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this.$1.SignedPreKeyStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSignedPreKeyById(a));b=b?{pubKey:b.keyPair.pubKey,privKey:b.keyPair.privKey,signature:b.signature}:null;this.$1.SignedPreKeyStore.set(a,b)}return this.$1.SignedPreKeyStore.get(a)||void 0});function c(b){return a.apply(this,arguments)}return c}();e.$11=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this.$1.SessionStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSession(a));this.$1.SessionStore.set(a,b?{session:b}:void 0)}return(yield d("WAWebSignalConvertApi").maybeConvertSession((b=this.$1.SessionStore.get(a))==null?void 0:b.session))||void 0});function c(b){return a.apply(this,arguments)}return c}();e.loadSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.session.acquire());try{return yield this.$11(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$12=function(a,b){if(a==null)throw c("err")("Tried to put session without identifier");this.$1.SessionStore.set(a,{session:b});this.$1.Dirty.session.add(a)};e.storeSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this.$1.Mutex.session.acquire());try{this.$12(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e.$13=function(a){if(a==null)throw c("err")("Tried to remove session without identifier");this.$1.SessionStore.set(a,{deleted:!0});this.$1.Dirty.session.add(a)};e.removeSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.session.acquire());try{this.$13(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$14=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=[];for(var e of a)this.$1.SessionStore.has(e)||c.push(e);if(c.length>0){e=(yield d("WAWebSignalStoreApi").waSignalStore.bulkGetSession(c));e.forEach(function(a,d){d=c[d];b.$1.SessionStore.set(d,a?{session:a}:void 0)})}return a.map(function(a){a=b.$1.SessionStore.get(a);return a!=null&&!(a!=null&&a.deleted)})});function c(b){return a.apply(this,arguments)}return c}();e.containSessions=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.session.acquire());try{return yield this.$14(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.$15=function(a,e){if(a==null)return(u||(u=b("Promise"))).reject(c("err")("Tried to put session without identifier"));if(!c("gkx")("26258"))if(Array.isArray(e==null?void 0:e.sessions)){var f,g=e.sessions[e.sessions.length-1];d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[Signal][storeSenderKey][unified] senderKeyName: "," keyId:"," chainCounter: ",""])),a,g==null?void 0:g.keyId,g==null||(f=g.chainKey)==null?void 0:f.counter)}else{var h,i;g=e==null||(h=e.senderKeyStates)==null?void 0:h[0];d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[Signal][storeSenderKey][unified] senderKeyName: "," keyId:"," chainCounter: ",""])),a,g==null?void 0:g.senderKeyId,g==null||(i=g.senderKeyChainKey)==null?void 0:i.nextMsgIndex)}this.$1.SenderKeyStore.set(a,e);this.$1.Dirty.senderKey.add(a);return(u||(u=b("Promise"))).resolve()};e.storeSenderKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield this.$1.Mutex.senderKey.acquire());try{yield this.$15(a,b)}finally{c.release()}});function c(b,c){return a.apply(this,arguments)}return c}();e.$16=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a==null)return void 0;if(!this.$1.SenderKeyStore.has(a)){var b=(yield d("WAWebSignalStoreApi").waSignalStore.getSenderKey(a));this.$1.SenderKeyStore.set(a,b)}return d("WAWebSignalConvertApi").maybeConvertSenderKey(this.$1.SenderKeyStore.get(a))||void 0});function c(b){return a.apply(this,arguments)}return c}();e.loadSenderKey=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.senderKey.acquire());try{return yield this.$16(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();e.switchToMemMode=function(){this.$2=v.Memory};e.switchToPersistMode=function(){this.$2=v.Persist};e.generateSnapshot=function(){if(this.$2===v.Memory)return this.$1.generateCacheUpdate()};e.deleteAllCache=function(){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[Signal]deleteAllCache"]))).tags("unified-store"),this.$1.clear()};e.flushBufferToDiskIfNotMemOnlyMode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$2===v.Memory){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: skip for memory mode"]))).tags("unified-store");return(u||(u=b("Promise"))).resolve()}d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: start"]))).tags("unified-store");var a=[yield this.$1.Mutex.identity.acquire(),yield this.$1.Mutex.session.acquire(),yield this.$1.Mutex.senderKey.acquire(),yield this.$1.Mutex.preKey.acquire()];d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: lock complete"]))).tags("unified-store");var c;d("WAWebABProps").getABPropConfigValue("web_anr_throttle_message_send")?c=(yield this.$1.generateCacheUpdateThrottled()):c=this.$1.generateCacheUpdate();try{yield d("WAWebSignalStorageUtils").getStorage().lock(["session-store","identity-store","prekey-store","senderkey-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (u||(u=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.bulkPutSession(c.sessionUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentityKeyWithRowId(c.identityUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutSenderKey(c.senderKeyUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkRemovePreKey(c.preKeyRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveSession(c.sessionRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveIdentity(c.identityRemove)])})),this.$1.clearDirty()}finally{a.forEach(function(a){return a.release()})}d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[Signal]flushBufferToDiskIfNotMemOnlyMode: done"]))).tags("unified-store")});function c(){return a.apply(this,arguments)}return c}();e.$17=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=this;d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: start"]))).tags("unified-store");yield this.$6(c);var f=[];c.forEach(function(c){var d=e.$1.IdentityStore.get(c);if(d&&!d.deleted&&(d[a]==null||d[a]>b)){d=babelHelpers["extends"]({},d);d[a]=b;e.$1.IdentityStore.set(c,d);e.$1.Dirty.identity.add(c);f.push(c)}});d("WALogger").DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: updates: "," to rowId: ",""])),JSON.stringify(f),b).tags("unified-store");d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[Signal]updateIdentityRangeAfterEncryption: "," updated"])),f.length).tags("unified-store")});function c(b,c,d){return a.apply(this,arguments)}return c}();e.updateIdentityRangeAfterEncryption=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=(yield this.$1.Mutex.identity.acquire());try{yield this.$17(a,b,c)}finally{d.release()}});function c(b,c,d){return a.apply(this,arguments)}return c}();e.$18=function(a){if(a==null)return(u||(u=b("Promise"))).resolve();var c=this.$1.SessionStore.get(a);c&&d("WAWebSignalConvertApi").shouldConvertSession(c.session)&&(d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[Signal]maybeCleanUpUnconvertedSession: delete unconverted session"]))).tags("unified-store"),this.$13(a));return(u||(u=b("Promise"))).resolve()};e.maybeCleanUpUnconvertedSession=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield this.$1.Mutex.session.acquire());try{return yield this.$18(a)}finally{b.release()}});function c(b){return a.apply(this,arguments)}return c}();return a}();e=new a();g["default"]=e}),98);
__d("WAWebAdvSyncDeviceListApi",["Promise","WALogger","WAWebAdvHandlerApi","WAWebApiContact","WAWebApiDeviceList","WAWebDeviceListPk","WAWebGetIdentityKeysJob","WAWebPhashUtils","WAWebUserPrefsMeUser","WAWebUsync","WAWebUsyncUser","WAWebWidFactory","asyncToGeneratorRuntime","err","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o=new Map();function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.wids,f=a.context;a=a.phash;d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["adv: begin syncDeviceList for ",""])),e.slice(0,3).join(",")+(e.length>3?"...":""));if(a!=null){var g=(yield d("WAWebApiDeviceList").getDeviceIds(e));g=g.map(function(a){return a==null?[]:a.devices.map(function(b){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(a.id,b.id,b.isHosted)})});g=c("lodash").flatMap(g,function(a){return a});g=(yield d("WAWebPhashUtils").phashV2(g));if(a===g)return}var i=new Set(),j=[];e.forEach(function(a){var b=o.get(d("WAWebDeviceListPk").createDeviceListPK(a));b?i.add(b):j.push(a)});if(j.length===0){yield (n||(n=b("Promise"))).all(Array.from(i));return}var k=r(j,f);j.map(function(a){o.set(d("WAWebDeviceListPk").createDeviceListPK(a),k)});yield (n||(n=b("Promise"))).all([k].concat(Array.from(i)))});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{var e=(yield d("WAWebApiDeviceList").getDeviceInfoForSync(a)),f=e.map(function(a){return a==null?[]:a.devices.map(function(b){return d("WAWebWidFactory").createDeviceWidFromDeviceListPk(a.id,b.id,b.isHosted)})}),g=(yield (n||(n=b("Promise"))).all(f.map(function(a){return a.length===0?"":d("WAWebPhashUtils").phashV2(a)})));f=a.map(function(a,b){return{id:a,hash:g[b],ts:(a=e[b])==null?void 0:a.timestamp,expectedTs:(a=e[b])==null?void 0:a.expectedTs}});return v(f,c)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to sync device list with error: ",""])),a)}finally{a.map(function(a){o["delete"](d("WAWebDeviceListPk").createDeviceListPK(a))})}});return s.apply(this,arguments)}function a(){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["adv: sync my device list begin"]))),yield p({wids:d("WAWebUserPrefsMeUser").getMePNandLIDWids(),context:null,phash:null}),d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["adv: sync my device list complete"])))});return t.apply(this,arguments)}function e(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield p({wids:a,context:null,phash:null});return d("WAWebApiDeviceList").getDeviceIds(a)});return u.apply(this,arguments)}function v(a,b){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.length===0)return;d("WAWebApiContact").checkPnToLidMapping(a.map(function(a){return a.id}),d("WAWebApiContact").CheckPnToLidMappingCaller.WAWEB_ADV_SYNC_DEVICE_LIST_SEND_DEVICE_SYNC_REQUEST);var e=new(d("WAWebUsync").USyncQuery)().withContext(b||"interactive").withDeviceProtocol();a.forEach(function(a){a.id.user!=="0"&&e.withUser(new(d("WAWebUsyncUser").USyncUser)().withId(a.id).withDeviceHash(String(a.hash)).withTs(a.ts).withExpectedTs(a.expectedTs))});b=(yield e.execute());if(b.error.all)throw c("err")("syncDeviceList: error "+b.error.all.errorCode+": "+b.error.all.errorText);b.error.devices&&d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["syncDeviceList: error ",": ",""])),b.error.devices.errorCode,b.error.devices.errorText);a=b.list.filter(function(a){return!("errorCode"in a.devices)});a=a.map(function(a){return{wid:a.id,devices:a.devices}});var f=a.filter(function(a){return(a=a.devices.keyIndex)==null?void 0:a.signedKeyIndexBytes}).map(function(a){return a.wid});d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["syncDeviceList: skipping "," out of "," records. Skipped records for users: ",""])),b.list.length-f.length,b.list.length,f.map(function(a){return a.toString()}).join(","));yield d("WAWebGetIdentityKeysJob").getAndStoreIdentityKeys(f);return d("WAWebAdvHandlerApi").handleADVDeviceSyncResult(a)});return w.apply(this,arguments)}g.syncDeviceList=p;g.syncMyDeviceList=a;g.syncAndGetDeviceList=e}),98);
__d("WAWebMessageInsertDebugPlaceholder",["WALogger","WAWebBackendApi","WAWebCmd","WAWebMessageProcessorCache","WAWebMessagingGatingUtils","WAWebMsgProcessingApiUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){if(!d("WAWebMessagingGatingUtils").isMessageDropPlaceholderEnabled())return;void j(a)}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.externalId,c=a.msgInfo,e=a.offline,f=a.nackReason;a=a.additionalInfo;if(c==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["_insertDebugPlaceholder: msgId::",", could not parse message info"])),b).tags("messaging");return}f=f.toString();a=a!=null?f+" "+a:f;f=babelHelpers["extends"]({},d("WAWebMsgProcessingApiUtils").generateBaseMsg(c),{type:d("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.DebugPlaceholder,body:a});try{yield d("WAWebMessageProcessorCache").messageProcessorCache.addMessages([{msg:f}],e!==!0),d("WAWebCmd").Cmd.isMainStreamReadyMd&&(yield d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:f.id.remote,msg:f}))}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["_insertDebugPlaceholder: msgId::",", failed to insert with error: ",""])),b,a).tags("messaging")}});return k.apply(this,arguments)}g.maybeInsertDebugPlaceholder=a}),98);
__d("WAWebMessagePostProcessBatcher",["Promise","WABatcher","WAWebBackendApi","WAWebMsgType","WAWebNoop","WAWebWorkerSafeBackendApi"],(function(a,b,c,d,e,f,g){var h,i={delayMs:1e3};a=function(){function a(){var a=this;this.$1=d("WABatcher").createSimpleBatcher(i,function(c){a.$2(c);return(h||(h=b("Promise"))).resolve([])})}var e=a.prototype;e.acceptMessage=function(a){return this.$1.accept(a)};e.runActiveBatches=function(){return this.$1.runActiveBatch().then(c("WAWebNoop"))};e.$2=function(a){d("WAWebBackendApi").frontendFireAndForget("processOrphanReadReceipts",{msgIds:a.map(function(a){return a.id})});a=a.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a.subtype==="send"});a.length>0&&d("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("processOrphanPaymentNotifications",{msgs:a})};return a}();e=new a();g.messagePostProcessBatcher=e}),98);
__d("WAWebMessagePostprocessRenderable",["Promise","WALogger","WAWebBackendApi","WAWebBizUpdateVerifiedInfoAction","WAWebMessagePostProcessBatcher","WAWebOfflineResumeMsgProcessReporter","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.msgInfo,e=a.messageOverwriteOption,f=a.msgs,g=a.isOffline,h=a.shouldQueryContactInfo,i=a.latestPrivacyMode,m=d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(d("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.PostProcessing);d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] UI update started"])));yield (l||(l=b("Promise"))).all(f.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:a.id.remote,msg:a,messageOverwriteOption:e,preserveOrder:!0,isOffline:g}),void d("WAWebMessagePostProcessBatcher").messagePostProcessBatcher.acceptMessage(a),g||void d("WAWebMessagePostProcessBatcher").messagePostProcessBatcher.runActiveBatches()});return function(b){return a.apply(this,arguments)}}()));(h||i!=null)&&n(a);d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] UI update completed"])));yield d("WAWebBackendApi").frontendSendAndReceive("updateUnattributedMessages",{messageInfo:c,messages:f});m==null||m()});return m.apply(this,arguments)}function n(a){var b=a.shouldQueryContactInfo,c=a.msgInfo,e=a.latestPrivacyMode;a=a.msgs;var f=c.chat;b&&d("WAWebBizUpdateVerifiedInfoAction").queryAndUpdateContactPropertiesOnNewChat(f)["catch"](function(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["query contact info on new chat failed"])))});!d("WAWebUserPrefsMeUser").isMeAccount(c.author)&&e!=null&&d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("updateBizPrivacyStatus",{msgIds:a.map(function(a){return a.id}),privacyMode:e})["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handlePrivacyModeChange: failed to update biz privacy status with error ",""])),a)})}g.postprocessRenderableMessages=a}),98);
__d("WAWebGetGroupAddressingMode",["WALogger","WAWebDBGroupsGroupMetadata","WAWebHandleMsgCommon","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.isGroup())return;a=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(a));if(a==null)return null;return a.isLidAddressingMode==null?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn:a.isLidAddressingMode?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn});return k.apply(this,arguments)}function c(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["bulkGetGroupAddressingMode: ",""])),a.join());var b=new Map(),c=(yield d("WAWebDBGroupsGroupMetadata").bulkGetGroupMetadata(a));a.map(function(a,e){if(!a.isGroup()){b.set(a.toString(),null);d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["bulkGetGroupAddressingMode: called with non-group: ",""])),a).sendLogs("get-group-addressing-mode-called-for-non-group",{sampling:.001});return}e=c[e];e!=null?b.set(e.id,e.isLidAddressingMode===!0?d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid:d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn):(b.set(a.toString(),null),d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["bulkGetGroupAddressingMode: missing group metadata record"]))).sendLogs("get-group-addressing-mode-missing-group-metadata",{sampling:.001}))});return b});return l.apply(this,arguments)}g.getGroupAddressingMode=a;g.bulkGetGroupAddressingMode=c}),98);
__d("WAWebWamEnumMismatchOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({INCOMING_GROUP_MESSAGE:1,ACK_OUTGOING_MESSAGE:2,GROUP_NOTIFICATION:3,GROUP_PROFILE_PICTURE_NOTIFICATION:4,IQ_RESPONSES:5});f.MISMATCH_ORIGIN_TYPE=a}),66);
__d("WAWebMessageProcessorCache",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebABProps","WAWebDBCreateLidPnMappings","WAWebDBReportingTokenUtils","WAWebGetGroupAddressingMode","WAWebGroupDatabaseJob","WAWebHandleMessageTypes.flow","WAWebHandleMsgCommon","WAWebPromiseQueue","WAWebSendOfflineDeliveryReceiptJob","WAWebSignalProtocolStore","WAWebSignalStorageUtils","WAWebSignalStoreApi","WAWebStoreMsgs","WAWebWamEnumMismatchOriginType","WAWebWidFactory","asyncToGeneratorRuntime","cr:13546"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;e=(a=b("cr:13546"))!=null?a:{};var u=e.handleAddressingModeMismatch;function v(){return d("WAWebABProps").getABPropConfigValue("web_message_processing_cache_size")}function w(){return x()>0}function x(){return d("WAWebABProps").getABPropConfigValue("web_offline_message_processor_timeout_seconds")}f=function(){function a(){var a=this;this.cache=[];this.additionalInfoCache=[];this.checkpointQueue=new(d("WAWebPromiseQueue").PromiseQueue)();this.nextCheckpointIndex=0;this.checkpointPromises=new Map();this.flushImmediately=!1;this.snapshotTimer=new(d("WAShiftTimer").ShiftTimer)(function(){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] flushing cache due to timeout"]))),a.createSnapshot()})}var e=a.prototype;e.size=function(){return this.cache.length};e.addMessages=function(a,b){var c;b===void 0&&(b=!1);(c=this.cache).push.apply(c,a);c=this.$1();if(b){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] flushing immediately"])));this.flushImmediately=!0;this.createSnapshot();return c}this.flushImmediately=!1;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] adding to cache (current length: ",", next checkpoint index: ","): ",""])),this.cache.length,this.nextCheckpointIndex,a.map(function(a){var b;return a.msg!=null?"msg "+((b=(b=a.msg)==null||(b=b.id)==null?void 0:b.id)!=null?b:""):"receipt "+(((b=a.receiptInfo)==null?void 0:b.externalId)||((b=a.duplicateMsgReceiptInfo)==null?void 0:b.externalId)||"")}));if(this.cache.length>=v()){d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] flushing due to max size reached: ",""])),this.cache.length);this.createSnapshot();return c}w()&&!this.snapshotTimer.isScheduled()&&this.snapshotTimer.onOrBefore(x()*1e3);return c};e.addAdditionalInfo=function(a,b){b===void 0&&(b=!1);this.additionalInfoCache.push(a);if(b){a=this.additionalInfoCache;this.additionalInfoCache=[];void this.$2(a)}};e.handleChangedAddressingMode=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=new Map();a.forEach(function(b){b=b.msg;if(b!=null&&b.id.remote.isGroup()){var a;(b==null?void 0:b.groupAddressingMode)==="pn"?a=d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn:(b==null?void 0:b.groupAddressingMode)==="lid"&&(a=d("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.lid);a!=null&&e.set(b.id.remote.toString(),a)}});a=Array.from(e.keys()).map(d("WAWebWidFactory").createWid);var f=(yield d("WAWebGetGroupAddressingMode").bulkGetGroupAddressingMode(a));a=[];for(var g of e.entries()){var h=g[0],i=g[1];f.get(h)!==i&&a.push(d("WAWebWidFactory").createWid(h))}this.flushImmediately||(yield d("WAWebGroupDatabaseJob").bulkMarkGroupParticipantStaleJob(a));yield (t||(t=b("Promise"))).all(a.map(function(a){return u==null?void 0:u(a,{localAddressingMode:c("WANullthrows")(f.get(a.toString()),"missing local addressing mode for group"),serverAddressingMode:c("WANullthrows")(e.get(a.toString()),"missing server addressing mode for group"),mismatchOrigin:d("WAWebWamEnumMismatchOriginType").MISMATCH_ORIGIN_TYPE.INCOMING_GROUP_MESSAGE})}))});function e(b){return a.apply(this,arguments)}return e}();e.$1=function(){var a=this,d=this.nextCheckpointIndex;if(!this.checkpointPromises.has(d)){var e,f=function(a){return void 0};this.checkpointPromises.set(d,{promise:new(t||(t=b("Promise")))(function(a,b){e=a,f=b}),markCheckpointDone:function(b){a.checkpointPromises["delete"](d);if(b!=null){f(b);return}e()}})}return c("WANullthrows")(this.checkpointPromises.get(d)).promise};e.$3=function(a){var b=[];a.forEach(function(a){a=a.msg;a!=null&&b.push(a)});return d("WAWebStoreMsgs").storeMsgs(b)};e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.filter(function(a){return a.type===d("WAWebHandleMessageTypes.flow").MsgAdditionalInfoType.ReportingInfo}).map(function(a){return a.data});void d("WAWebDBReportingTokenUtils").handleAddReportingInfos(a)});function c(b){return a.apply(this,arguments)}return c}();e.createSnapshot=function(){var a,c=this,e=this.cache,f=this.additionalInfoCache;this.cache=[];this.additionalInfoCache=[];this.snapshotTimer.isScheduled()&&this.snapshotTimer.cancel();var g=this.nextCheckpointIndex,h=g+e.length;this.nextCheckpointIndex=h;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": "," messages/receipts"])),g,h,e.length);if(e.length===0)return;var i=(a=(a=this.checkpointPromises.get(g))==null?void 0:a.markCheckpointDone)!=null?a:function(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["MessageProcessorCache: missing doneFn"]))).sendLogs("message-cache-missing-doneFn")},j=d("WAWebSignalProtocolStore").getSignalProtocolStore().generateSnapshot();void this.checkpointQueue.enqueue(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield (t||(t=b("Promise"))).all([c.$3(e),d("WAWebDBCreateLidPnMappings").flushLidPnMappingsToDb()]),d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": messages added to table"])),g,h),j!=null&&(yield d("WAWebSignalStorageUtils").getStorage().lock(["session-store","identity-store","prekey-store","senderkey-store"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (t||(t=b("Promise"))).all([d("WAWebSignalStoreApi").waSignalStore.bulkPutSession(j.sessionUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutIdentityKeyWithRowId(j.identityUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkPutSenderKey(j.senderKeyUpdate),d("WAWebSignalStoreApi").waSignalStore.bulkRemovePreKey(j.preKeyRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveSession(j.sessionRemove),d("WAWebSignalStoreApi").waSignalStore.bulkRemoveIdentity(j.identityRemove)])})),d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": signal stores updated"])),g,h)),yield d("WAWebSendOfflineDeliveryReceiptJob").sendAggregateOfflineReceipts(e),d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": aggregated receipts sent"])),g,h),yield c.$2(f),d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": additional info processed"])),g,h)}catch(a){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] createSnapshot ","-",": failed: ",""])),g,h,a);i(a);return}d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[message-cache] before markCheckpointDone"])));i()}));void this.handleChangedAddressingMode(e)};return a}();a=new f();g.messageProcessorCache=a}),98);
__d("WAWebSchemaPeerReadReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addColumn,i=c.addAutoIncrementingPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("peer-read-receipt").version(d("WAWebOffdStorageUtils").getStorage().versions.version(2),[i("id"),h("msgKeys"),h("ts"),h("ack")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("peer-read-receipt")}g.addTable=a;g.getTable=b}),98);
__d("WAWebMessageReceiptBatcher",["Promise","WABatcher","WAJids","WALogger","WAPromiseMap","WAWebAck","WAWebApiMessageInfoStore","WAWebBackendApi","WAWebDBBulkGetRootMsgs","WAWebHandleMsgReceiptCommon","WAWebHandlePrivacyModeUpdateMsgAction","WAWebLidStatusMigrationKeyUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebNoop","WAWebSchemaMessage","WAWebSchemaMessageInfo","WAWebSchemaPeerReadReceipt","WAWebUserPrefsMeUser","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","lodash"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=Object.freeze((a={},a[(e=d("WAWebAck")).ACK.SENT]=e.ACK_STRING.DELIVERY,a[e.ACK.RECEIVED]=e.ACK_STRING.DELIVERY,a[e.ACK.READ]=e.ACK_STRING.READ,a[e.ACK.PLAYED]=e.ACK_STRING.PLAYED,a[e.ACK.INACTIVE]=e.ACK_STRING.INACTIVE,a)),r={delayMs:1e3};f=function(){function a(){var a=this;this.$1=d("WABatcher").createSimpleBatcher(r,function(b){return a.$2(b).then(function(){return[]})});this.$3=d("WABatcher").createSimpleBatcher(r,function(b){return a.$4(b).then(function(){return[]})})}var e=a.prototype;e.acceptPeerReceipt=function(a){return this.$1.accept(a)};e.acceptOtherReceipt=function(a){return this.$3.accept(a)};e.runActiveBatches=function(){return(p||(p=b("Promise"))).all([this.$1.runActiveBatch(),this.$3.runActiveBatch()]).then(c("WAWebNoop"))};e.$5=function(a){var b=[];for(a of a){var e=a.ack,f=a.privacyMode,g=a.msgKeys,h=a.receiverId;e===d("WAWebAck").ACK.RECEIVED&&f!=null&&b.push({remote:h,deliveryPrivacyMode:f,msgKeys:g.map(function(a){return c("WAWebMsgKey").from(a)})})}return b};e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processPrivacyModeUpdates"]))),yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(a.remote,a.deliveryPrivacyMode),yield d("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("updateBizPrivacyStatus",{msgIds:a.msgKeys,privacyMode:a.deliveryPrivacyMode})});return function(b){return a.apply(this,arguments)}}())});function c(b){return a.apply(this,arguments)}return c}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=this.$8(a);b=b.map(function(a){return c("WAWebMsgKey").from(a)}).filter(function(a){return a.remote.isGroup()||a.remote.isStatus()||a.remote.isBot()});b=(yield d("WAWebApiMessageInfoStore").getHighestMsgAcks(b));for(b of b.entries()){var e=b[0],f=b[1];a.set(e,f)}return a});function e(b,c){return a.apply(this,arguments)}return e}();e.$8=function(a){var b=new Map();for(a of a){var d=a.msgKeys,e=a.ack,f=a.isBotInvoke,g=a.isSender;for(d of d)if(c("WAWebMsgKey").from(d).remote.isUser()&&f!==!0&&g!==!0){var h;b.set(d,Math.max(e,(h=b.get(d))!=null?h:Number.NEGATIVE_INFINITY))}}return b};e.$9=function(a){var b=new Map();a.forEach(function(a){var c=a.ack,e=a.ts,f=a.receiverId;a=a.msgKeys;var g=f.isNewsletter()?f.toJid():d("WAWebWidFactory").asUserWidOrThrow(f).toString(),h=(f=f.device)!=null?f:d("WAJids").DEFAULT_DEVICE_ID;a.forEach(function(a){var f=q[c];if(f==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher]: receipt has unsupported ack type ",""])),c);return}a=a+","+g;var j=b.get(a);if(!j){b.set(a,(a={},a[f]=e,a.deviceDelivered=new Set([h]),a))}else f!==q[d("WAWebAck").ACK.INACTIVE]&&(j[f]=u(j[f],e)),j.deviceDelivered.add(h)})});return Array.from(b,function(a){var b=a[0];a=a[1];b=b.split(",");var c=b[0];b=b[1];return[[c,b],a]})};e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["processOtherReceipts"])));var f=this.$9(a),g=Array.from(new Set(c("lodash").flatMap(a,function(a){return a.msgKeys}))),h=(yield d("WAWebModelStorageUtils").getStorage().lock(["message-info","message","chat"],b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var h=(yield (p||(p=b("Promise"))).all([d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkGet(f.map(function(a){var b=a[0];a[1];return b})),d("WAWebDBBulkGetRootMsgs").bulkGetRootMsgs(g,!1)])),i=h[0],j=h[1],l=new Map(g.map(function(a,b){return[a,j[b]]}));h=i.map(function(a,b){b=f[b];var c=b[0],d=c[0];c=c[1];b=b[1];if(!b)return null;if(!a)return{delivery:b.delivery,read:b.read,played:b.played,msgKey:d,receiverUserJid:c,deviceDelivered:Array.from(b.deviceDelivered),deviceNotDelivered:[]};var e=b.deviceDelivered;a.deviceDelivered.forEach(function(a){return e.add(a)});return{delivery:u(a.delivery,b.delivery),read:u(a.read,b.read),played:u(a.played,b.played),msgKey:a.msgKey,receiverUserJid:a.receiverUserJid,deviceDelivered:Array.from(e),deviceNotDelivered:a.deviceNotDelivered.filter(function(a){return!e.has(a)})}}).filter(Boolean);d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] process other receipts batch: ",""])),JSON.stringify(h));yield d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkCreateOrReplace(h);i=(yield e.$7(a,g));h=Array.from(i.entries()).map(function(a){var b=a[0];a=a[1];var d=c("WAWebMsgKey").fromString(b);d=d.remote;if(d.isUser()||d.isGroup()||d.isStatus()){d=l.get(b);if(d==null)return;if(a>((b=d.ack)!=null?b:Number.NEGATIVE_INFINITY))return{id:d.id.toString(),ack:a}}}).filter(Boolean);return{ackUpdates:h,receiptMsgKeyToMsg:l}})));yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(h.ackUpdates);d("WAWebBackendApi").frontendFireAndForget("updateMsgModelAcks",{updates:h.ackUpdates.map(function(a){var b=a.id;a=a.ack;return{id:c("WAWebMsgKey").from(b),ack:a}})});d("WAWebBackendApi").frontendFireAndForget("updateMsgInfo",{updates:c("lodash").flatMap(a,function(a){var b=a.msgKeys,e=a.ack,f=a.ts,g=a.receiverId;return b.map(function(a){a=h.receiptMsgKeyToMsg.get(a);if(a==null)return;a=c("WAWebMsgKey").from(a.id);if(!a.fromMe)return;if(!(a.remote.isUser()||a.remote.isGroup()||a.remote.isStatus()))return;var b=d("WAWebWidFactory").asUserWidOrThrow(g);if(d("WAWebUserPrefsMeUser").isMeAccount(b))return;return{msgKey:a,ts:f,participant:b,ack:e}})}).filter(Boolean)});this.$6(this.$5(a))["catch"](function(){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["_processOtherReceipts: failed to process privacy mode updates"])))})});function e(b){return a.apply(this,arguments)}return e}();e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["processPeerReceipts"])));d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher]: process peer receipts batch: ",""])),JSON.stringify(a));var b=a.some(function(a){return!a.isOffline});if(b){yield d("WAPromiseMap").promiseMap(a,s);return}b=a.map(function(a){var b=a.ts,c=a.msgKeys;a=a.ack;return{ts:b,msgKeys:c,ack:a}});yield d("WAWebSchemaPeerReadReceipt").getTable().bulkCreate(b)});function c(b){return a.apply(this,arguments)}return c}();return a}();function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["handleOnlinePeerReceipt"])));var b=a.msgKeys.map(function(a){return c("WAWebMsgKey").from(a)});if(a.remote.isStatus()){var e=b.map(d("WAWebLidStatusMigrationKeyUtils").matKeyConvert);d("WAWebBackendApi").frontendFireAndForget("handleReadStatus",{msgKeys:e});return d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:e,ack:d("WAWebAck").ACK.READ,t:a.ts})}if((a.remote.isUser()||a.remote.isGroup()||a.remote.isNewsletter())&&a.ack>=d("WAWebAck").ACK.RECEIVED)if(a.ack===d("WAWebAck").ACK.READ)return d("WAWebHandleMsgReceiptCommon").updateChatPeerRead(a.remote,b);else if(a.ack===d("WAWebAck").ACK.PLAYED)return d("WAWebBackendApi").frontendSendAndReceive("updateMsgPeerAcks",{msgKeys:b,ack:a.ack,t:a.ts})});return t.apply(this,arguments)}function u(a,b){if(a!=null&&b!=null)return Math.min(a,b);a=a!=null?a:b;return a!=null?a:void 0}e=new f();g.receiptBatcher=e}),98);
__d("WAWebMessageReceiptUtils",["WAWebLidMigrationUtils","WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return d("WAWebLidMigrationUtils").getAlternateMsgKey(a)}).filter(Boolean);b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(b.map(function(a){return a.toString()})));var c=new Set(b.map(function(a){return a==null?void 0:a.id}));return a.map(function(a){var b=d("WAWebLidMigrationUtils").getAlternateMsgKey(a);return b&&c.has(b.toString())?b:a}).filter(Boolean)});return h.apply(this,arguments)}g.fixStatusReceiptKeys=a}),98);
__d("WAWebOfflineResumeTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Toastbar:"toastbar",ButterBar:"butterbar",None:"none"});c=b("$InternalEnum").Mirrored(["Blocking","NonBlocking","Worker"]);f.ResumeUIProgressBarType=a;f.ResumeType=c}),66);
__d("WAWebThreadMetadata",["WALogger","WAWebBackendApi"],(function(a,b,c,d,e,f,g){var h,i=null;function a(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["processOfflineThreadMeta:"]))).devConsole(a),i=a,d("WAWebBackendApi").frontendFireAndForget("updateChatPreviewT",{threadMeta:a.chatTimestamp})}function b(){return i}function c(){var a;a=(a=i)==null?void 0:a.chatTimestamp;a!=null&&d("WAWebBackendApi").frontendFireAndForget("resetChatPreviewT",{chatIds:Object.keys(a)});i=null}g.setOfflineThreadMeta=a;g.getOfflineThreadMetaPreview=b;g.resetThreadMeta=c}),98);
__d("WAWebMsgSyncConfiguratedTunnel",["WALogger","WAWebMessagePostprocessRenderable","WAWebMsgSyncTunnelConfig","WAWebOfflineHandler","WAWebOfflineResumeTypes.flow","WAWebThreadMetadata","WAWebThreadMetadataUtil","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=["msgs"],i=["msgData"],j,k,l,m,n={CACHE:new Map(),ACTIVE:!1};function o(){var a=n.CACHE,b=n.CACHE;n.CACHE=new Map();n.ACTIVE=!1;return{cache:a,accessedChats:b}}function p(a,b){var c=a.id.remote,e=n.CACHE.get(c.toString());e==null&&(e=[],n.CACHE.set(c.toString(),e));e.push(babelHelpers["extends"]({},b,{msgData:a}));d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: cache "," "])),a.id.toString())}function q(a){var b=n.CACHE.get(a);n.CACHE["delete"](a);return b}function r(a){var b=d("WAWebMsgSyncTunnelConfig").msgSyncTunnelConfig.openedChat;if(b==null)return!1;a=a.id.remote;return a.equals(b)}function s(a,b){a=d("WAWebThreadMetadataUtil").getOfflineMetaPreviewForChat({chatTimestamp:a==null?void 0:a.chatTimestamp,chatId:b.id.remote,accountLid:void 0});return b.t===a}function a(){return{isEnabled:function(){return d("WAWebOfflineHandler").OfflineMessageHandler.getResumeType()!==d("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking?!1:!0},drainCacheForChat:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=q(a);if(b==null)return;t(b);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sendUIUpdate "," for the accessed chat"])),a)});function c(b){return a.apply(this,arguments)}return c}(),completeUIUpdate:function(){var a=o();a=a.cache;a.forEach(function(a,b){t(a)})},accept:function(a){if(!v())return u(a);n.ACTIVE||(n.ACTIVE=!0);var b=a.msgs,c=babelHelpers.objectWithoutPropertiesLoose(a,h);a=void 0;var e=d("WAWebThreadMetadata").getOfflineThreadMetaPreview();b.forEach(function(b){r(b)?(a=u(babelHelpers["extends"]({},c,{msgs:[b]})),d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sending UI update "," "])),b.id.toString())):(p(b,c),s(e,b)&&void w.drainCacheForChat(b.id.remote.toString()))});return a}}}function t(a){if(a.length===0)return;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: sending bulk UI update with "," messages"])),a.length);a.forEach(function(a){var b=a.msgData;a=babelHelpers.objectWithoutPropertiesLoose(a,i);return u(babelHelpers["extends"]({},a,{msgs:[b]}))})}function u(a){void d("WAWebMessagePostprocessRenderable").postprocessRenderableMessages(a)}var v=function(){return!1};function c(){return n}var w=a();g.isMsgSyncTunnelActive=v;g.internal_getTunnelState=c;g.msgSyncTunnel=w}),98);
__d("WAWebMsgSyncTunnelConfig",["WALogger","WAWebMsgSyncConfiguratedTunnel"],(function(a,b,c,d,e,f,g){var h,i,j={openedChat:null};function k(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["msgSyncTunnel: set new config"]))).devConsole({newConfig:a,oldConfig:babelHelpers["extends"]({},j)});Object.assign(j,a);if(a.openedChat!=null&&d("WAWebMsgSyncConfiguratedTunnel").internal_getTunnelState().ACTIVE){if(j.openedChat==null)return;void d("WAWebMsgSyncConfiguratedTunnel").msgSyncTunnel.drainCacheForChat(j.openedChat.toString())}}function a(a){if(!a)return;if(!d("WAWebMsgSyncConfiguratedTunnel").isMsgSyncTunnelActive())return;var b=j.openedChat;if(b==null)return;b.equals(a)||d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Active chat out of sync closed: ",", cached: ",""])),a,j.openedChat).sendLogs("msg_sync_tunnel_config_out_of_sync");k({openedChat:null})}function b(){if(!d("WAWebMsgSyncConfiguratedTunnel").isMsgSyncTunnelActive())return;k({openedChat:null})}g.msgSyncTunnelConfig=j;g.setMsgSyncTunnelConfig=k;g.resetMsgSyncTunnelOpenedChat=a;g.resetMsgSyncTunnelConfig=b}),98);
__d("WAWebAddonPluginProcessor",["WANullthrows","WAWebAddonCrossWindowUtils","WAWebMessagePluginProcessAsAddonRegistry"],(function(a,b,c,d,e,f,g){function a(){var a=new Map();for(var b of c("WAWebMessagePluginProcessAsAddonRegistry")){var d=b.type,e=b.processor;e!=null&&a.set(d,e)}return a}var h=a();function b(){return h}function e(a){var b;typeof a==="string"?b=a:b=d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a);return c("WANullthrows")(h.get(b))}function f(a){return Boolean(h.get(a))}g.getAddonProcessorsMap=b;g.getAddonProcessor=e;g.hasAddonProcessor=f}),98);
__d("WAWebPluginCreateRegistryLookup",[],(function(a,b,c,d,e,f){function a(a){var b=new Map();for(a of a){var c,d=a.type;c=(c=a.subtype)!=null?c:null;var e=b.get(d);e==null&&(e=new Map(),b.set(d,e));e.set(c,a)}return function(a,c){return(a=b.get(a))==null?void 0:a.get(c!=null?c:null)}}f.createMsgTypeRegistryLookup=a}),66);
__d("WAWebMessagePluginGenerateReportingTokenContent",["WAWebMessagePluginGenerateReportingTokenContentRegistry","WAWebMessagingGatingUtils","WAWebMsgType","WAWebPluginCreateRegistryLookup"],(function(a,b,c,d,e,f,g){var h=d("WAWebPluginCreateRegistryLookup").createMsgTypeRegistryLookup(c("WAWebMessagePluginGenerateReportingTokenContentRegistry"));function a(a){var b;return(b=h(a.type,a.subtype))==null||b.generateReportingTokenContent==null?void 0:b.generateReportingTokenContent(a)}function b(a,b){return!d("WAWebMessagingGatingUtils").isReportingTokenFromInclusionListEnabled()?a!==d("WAWebMsgType").MSG_TYPE.REACTION&&a!==d("WAWebMsgType").MSG_TYPE.REACTION_ENC&&a!==d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE&&a!==d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:Boolean((a=h(a,b))==null?void 0:a.generateReportingTokenContent)}g.generateReportingTokenContent=a;g.isMsgTypeReportingTokenCompatible=b}),98);
__d("WAWebMessagePluginParseProtobuf",["WALogger","WAWebMessagePluginParseProtobufRegistry","WAWebMultipleMessageParserPluginParseProtobuf","WAWebProtobufsE2E.pb","WAWebWamEnumEditType","gkx","isStringNullOrEmpty","justknobx"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var b,e=d("WAWebMultipleMessageParserPluginParseProtobuf").parseProtobufWithMultipleMessageParserPlugin(a),f=e.result;if((!c("gkx")("26258")||c("justknobx")._("2517"))&&a.msgContext==="relay"&&(a==null||(b=a.messageProtobuf)==null||(b=b.protocolMessage)==null?void 0:b.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT){var g,j;if(a.editAttr!==d("WAWebWamEnumEditType").EDIT_TYPE.EDITED&&c("isStringNullOrEmpty")((g=a==null||(j=a.msgBotInfo)==null?void 0:j.botEditType)!=null?g:"")){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[message-edit] edit protocol msg with incorrect attribute"]))).devConsole(a).sendLogs("message-edit-incorrect-edit-attribute");return null}}g=e.pluginsMatched;for(e of c("WAWebMessagePluginParseProtobufRegistry")){var k=e(a);if(k!=null){var l;g.push(k.msgData.type+":"+((l=k.msgData.subtype)!=null?l:"null"));f==null&&(f=k)}}if(g.length>1){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseProtoPlugins: Matched more than 1 plugin types ",""])),g.join(",")).sendLogs("parse-protobuf-unexpected-plugin-match");return null}return f}g.parseProtobuf=a}),98);
__d("WAWebGenerateChatReportingTokenContent",[],(function(a,b,c,d,e,f){function a(a){a=new TextEncoder().encode((a=a.body)!=null?a:"");return self.crypto.getRandomValues(new Uint8Array(a.length))}f["default"]=a}),66);
__d("WAWebMessagePluginGenerateReportingTokenContentRegistry",["WAWebGenerateAudioOrPttReportingTokenContent","WAWebGenerateChatReportingTokenContent","WAWebGenerateDocumentReportingTokenContent","WAWebGenerateImageReportingTokenContent","WAWebGenerateInteractiveResponseReportingTokenContent","WAWebGeneratePtvReportingTokenContent","WAWebGenerateStickerReportingTokenContent","WAWebGenerateVideoReportingTokenContent"],(function(a,b,c,d,e,f,g){a=[{type:"album",subtype:void 0,generateReportingTokenContent:null},{type:"audio",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateAudioOrPttReportingTokenContent")},{type:"biz_content_placeholder",subtype:void 0,generateReportingTokenContent:null},{type:"buttons_response",subtype:void 0,generateReportingTokenContent:null},{type:"chat",subtype:"url",generateReportingTokenContent:c("WAWebGenerateChatReportingTokenContent")},{type:"chat",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateChatReportingTokenContent")},{type:"ciphertext",subtype:"bot_unavailable_fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:"fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:"hosted_unavailable_fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:"view_once_unavailable_fanout",generateReportingTokenContent:null},{type:"ciphertext",subtype:void 0,generateReportingTokenContent:null},{type:"comment",subtype:void 0,generateReportingTokenContent:null},{type:"debug_placeholder",subtype:void 0,generateReportingTokenContent:null},{type:"document",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateDocumentReportingTokenContent")},{type:"event_creation",subtype:void 0,generateReportingTokenContent:null},{type:"event_edit_encrypted",subtype:void 0,generateReportingTokenContent:null},{type:"event_response",subtype:void 0,generateReportingTokenContent:null},{type:"groups_v4_invite",subtype:void 0,generateReportingTokenContent:null},{type:"hsm",subtype:void 0,generateReportingTokenContent:null},{type:"image",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateImageReportingTokenContent")},{type:"interactive",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateInteractiveResponseReportingTokenContent")},{type:"interactive_response",subtype:void 0,generateReportingTokenContent:null},{type:"keep_in_chat",subtype:void 0,generateReportingTokenContent:null},{type:"list",subtype:void 0,generateReportingTokenContent:null},{type:"list_response",subtype:void 0,generateReportingTokenContent:null},{type:"location",subtype:void 0,generateReportingTokenContent:null},{type:"multi_vcard",subtype:void 0,generateReportingTokenContent:null},{type:"native_flow",subtype:void 0,generateReportingTokenContent:null},{type:"newsletter_admin_invite",subtype:void 0,generateReportingTokenContent:null},{type:"newsletter_follower_invite",subtype:void 0,generateReportingTokenContent:null},{type:"newsletter_question_response",subtype:void 0,generateReportingTokenContent:null},{type:"notification_template",subtype:"contact_info_card",generateReportingTokenContent:null},{type:"order",subtype:void 0,generateReportingTokenContent:null},{type:"payment",subtype:"ciphertext",generateReportingTokenContent:null},{type:"payment",subtype:"futureproof",generateReportingTokenContent:null},{type:"payment",subtype:"invite",generateReportingTokenContent:null},{type:"payment",subtype:"request",generateReportingTokenContent:null},{type:"payment",subtype:"send",generateReportingTokenContent:null},{type:"pin_message",subtype:void 0,generateReportingTokenContent:null},{type:"pinned_message",subtype:void 0,generateReportingTokenContent:null},{type:"poll_creation",subtype:void 0,generateReportingTokenContent:null},{type:"poll_result_snapshot",subtype:void 0,generateReportingTokenContent:null},{type:"poll_update",subtype:"poll_vote",generateReportingTokenContent:null},{type:"product",subtype:void 0,generateReportingTokenContent:null},{type:"protocol",subtype:"admin_revoke",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_feedback",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_memu_onboarding",generateReportingTokenContent:null},{type:"protocol",subtype:"bot_request_welcome",generateReportingTokenContent:null},{type:"protocol",subtype:"ephemeral_setting",generateReportingTokenContent:null},{type:"protocol",subtype:"ephemeral_sync_response",generateReportingTokenContent:null},{type:"protocol",subtype:"event_edit_decrypted",generateReportingTokenContent:null},{type:"protocol",subtype:"history_sync_notification",generateReportingTokenContent:null},{type:"protocol",subtype:"limit_sharing_system_message",generateReportingTokenContent:null},{type:"protocol",subtype:"member_label",generateReportingTokenContent:null},{type:"protocol",subtype:"message_edit",generateReportingTokenContent:null},{type:"protocol",subtype:"message_history_bundle",generateReportingTokenContent:null},{type:"protocol",subtype:"message_history_notice",generateReportingTokenContent:null},{type:"protocol",subtype:"sender_revoke",generateReportingTokenContent:null},{type:"protocol",subtype:"share_phone_number",generateReportingTokenContent:null},{type:"protocol",subtype:"status_group_mention_message",generateReportingTokenContent:null},{type:"protocol",subtype:"status_mention_message",generateReportingTokenContent:null},{type:"ptt",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateAudioOrPttReportingTokenContent")},{type:"ptv",subtype:void 0,generateReportingTokenContent:c("WAWebGeneratePtvReportingTokenContent")},{type:"reaction",subtype:void 0,generateReportingTokenContent:null},{type:"reaction_enc",subtype:void 0,generateReportingTokenContent:null},{type:"request_phone_number",subtype:void 0,generateReportingTokenContent:null},{type:"revoked",subtype:"admin",generateReportingTokenContent:null},{type:"revoked",subtype:"sender",generateReportingTokenContent:null},{type:"rich_response",subtype:void 0,generateReportingTokenContent:null},{type:"status_notification",subtype:"status_notification_message",generateReportingTokenContent:null},{type:"sticker",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateStickerReportingTokenContent")},{type:"sticker-pack",subtype:void 0,generateReportingTokenContent:null},{type:"template_button_reply",subtype:void 0,generateReportingTokenContent:null},{type:"unknown",subtype:"payment_action_request_declined",generateReportingTokenContent:null},{type:"unknown",subtype:"payment_transaction_request_cancelled",generateReportingTokenContent:null},{type:"unknown",subtype:"phone",generateReportingTokenContent:null},{type:"unknown",subtype:"phone_only_feature",generateReportingTokenContent:null},{type:"unknown",subtype:void 0,generateReportingTokenContent:null},{type:"vcard",subtype:void 0,generateReportingTokenContent:null},{type:"video",subtype:void 0,generateReportingTokenContent:c("WAWebGenerateVideoReportingTokenContent")}];g["default"]=a}),98);
__d("WAWebAlbumsParseAlbumMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.albumMessage;if(b==null)return null;b=b.contextInfo;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.ALBUM,kind:d("WAWebMsgType").MsgKind.Album}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebBizContentPlaceholderMsgData.flow",["$InternalEnum"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MASK_LINKED_DEVICES:0});g.BizContentPlaceholderType=a}),98);
__d("WAWebParseBizContentPlaceholderProto",["WAWebBizContentPlaceholderMsgData.flow","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.placeholderMessage;if(b==null||b.type==null)return;b=h(b.type);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.BIZ_CONTENT_PLACEHOLDER,kind:d("WAWebMsgType").MsgKind.BizContentPlaceholder,bizContentPlaceholderType:b}),contextInfo:void 0}}function h(a){switch(a){case d("WAWebProtobufsE2E.pb").Message$PlaceholderMessage$PlaceholderType.MASK_LINKED_DEVICES:return d("WAWebBizContentPlaceholderMsgData.flow").BizContentPlaceholderType.MASK_LINKED_DEVICES}}g["default"]=a}),98);
__d("WAWebParseBotMemuOnboardingMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;if(((b=b.protocolMessage)==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_MEMU_ONBOARDING_MESSAGE)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_memu_onboarding"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseBotRequestWelcomeMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;if(((b=b.protocolMessage)==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_request_welcome"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseGroupInviteMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.groupInviteMessage;if(b==null)return;var c=b.caption,e=b.inviteCode,f=b.inviteExpiration,g=b.groupJid,h=b.groupName;b=b.contextInfo;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE,kind:d("WAWebMsgType").MsgKind.GroupsV4Invite,comment:c,inviteCode:e,inviteCodeExp:f==null?void 0:f.toString(),inviteGrp:g,inviteGrpName:h});return{msgData:a,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseListMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.listMessage;if(b==null)return;var c=b.listType;if(c===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT||c===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST){c=a.businessOwnerJid;var e=a.productListItemCount;if(b.listType===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST){var f;c=(f=b.productListInfo)==null?void 0:f.businessOwnerJid;e=(f=b.productListInfo)==null?void 0:f.productSections.reduce(function(a,b){return a+b.products.length},0)}f=babelHelpers["extends"]({},a,{businessOwnerJid:c,productListItemCount:e,type:d("WAWebMsgType").MSG_TYPE.LIST,kind:d("WAWebMsgType").MsgKind.List,list:b,footer:b.footerText})}else f=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown});return{msgData:f,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebMultiVcardMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({EMPTY_LIST:"contacts_array_empty_list",INVALID_LIST_SIZE:"contacts_array_invalid_list_size"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="MultiVcardMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.MultiVcardValidationErrorCode=a;g.MultiVcardMessageValidationError=c}),98);
__d("WAWebParseMultiVcardMessageProto",["WAWebMsgType","WAWebMultiVcardMessageValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.contactsArrayMessage;if(b==null)return;var e=b.contacts,f=b.contextInfo;b=b.displayName;if((a==="relay"||a==="outgoing")&&(e==null||e.length===0))throw new(d("WAWebMultiVcardMessageValidationError").MultiVcardMessageValidationError)(d("WAWebMultiVcardMessageValidationError").MultiVcardValidationErrorCode.EMPTY_LIST,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);a=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.MULTI_VCARD,kind:d("WAWebMsgType").MsgKind.MultiVcard,vcardFormattedName:b,vcardList:Array.isArray(e)?e.map(function(a){return{displayName:a.displayName,vcard:a.vcard,isMultiVcard:!1}}):[]});return{msgData:a,contextInfo:f}}g["default"]=a}),98);
__d("WAWebParsePaymentInviteMessageProto",["WALogger","WALongInt","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.paymentInviteMessage;if(b==null)return;if(b.serviceType===d("WAWebProtobufsE2E.pb").Message$PaymentInviteMessage$ServiceType.NOVI){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[payment-invite] parsePaymentInviteMessageProto: does not support novi transactions"])));return{msgData:babelHelpers["extends"]({},a,{kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:null}}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[payment-invite] render payment invite of type ",""])),b.serviceType);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"invite",paymentExpiryTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.expiryTimestamp),paymentInviteServiceType:b.serviceType}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebGroupHistoryGating",["WAWebABProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("group_history_receive")}function b(){return d("WAWebABProps").getABPropConfigValue("group_history_notice_receive")}g.isGroupHistoryReceiverEnabled=a;g.isGroupHistoryNoticeReceiverEnabled=b}),98);
__d("WAWebGroupHistoryMsgData.flow",["$InternalEnum"],(function(a,b,c,d,e,f,g){"use strict";a=b("$InternalEnum")({NONE:0,DOWNLOADING:1,DOWNLOADED:2,PROCESSING:3,INJECTED:4,FAILED:5,INJECTED_PARTIAL:6});g.MessageHistoryBundleProcessState=a}),98);
__d("WAWebMessageHistoryValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_MESSAGE_HISTORY_BUNDLE:"message_history_missing_bundle",MISSING_MIMETYPE:"message_history_missing_mimetype",INVALID_MIMETYPE:"message_history_invalid_mimetype",MISSING_FILE_SHA256:"message_history_missing_file_sha256",INVALID_FILE_SHA256_LENGTH:"message_history_invalid_file_sha256_length",MISSING_MEDIA_KEY:"message_history_missing_media_key",INVALID_MEDIA_KEY_LENGTH:"message_history_invalid_media_key_length",MISSING_FILE_ENC_SHA256:"message_history_missing_file_enc_sha256",INVALID_FILE_ENC_SHA256_LENGTH:"message_history_invalid_file_enc_sha256_length",MISSING_DIRECT_PATH:"message_history_missing_direct_path",MISSING_MESSAGE_HISTORY_METADATA:"message_history_missing_metadata",INVALID_HISTORY_RECEIVERS_LENGTH:"message_history_invalid_receivers_length",MISSING_OLDEST_MESSAGE_TIMESTAMP:"message_history_missing_oldest_timestamp",INVALID_MESSAGE_COUNT:"message_history_invalid_message_count"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="MessageHistoryValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.MessageHistoryValidationErrorCode=a;g.MessageHistoryValidationError=c}),98);
__d("WAWebMessageHistoryValidation",["WAWebMessageHistoryValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function h(a){if(a.historyReceivers==null||a.historyReceivers.length===0)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_HISTORY_RECEIVERS_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.oldestMessageTimestamp==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_OLDEST_MESSAGE_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.messageCount==null||Number(a.messageCount)<=0)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_MESSAGE_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}function a(a){if(a.mimetype==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_MIMETYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.mimetype!=="application/protobuf")throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_MIMETYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.fileSha256==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_FILE_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.fileSha256.byteLength!==32)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_FILE_SHA256_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.mediaKey==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_MEDIA_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.mediaKey.byteLength!==32)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_MEDIA_KEY_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.fileEncSha256==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_FILE_ENC_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.fileEncSha256.byteLength!==32)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.INVALID_FILE_ENC_SHA256_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.messageHistoryMetadata==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_MESSAGE_HISTORY_METADATA,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);h(a.messageHistoryMetadata)}function b(a){if(a.messageHistoryMetadata==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_MESSAGE_HISTORY_METADATA,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);h(a.messageHistoryMetadata)}g.validateMessageHistoryBundle=a;g.validateMessageHistoryNotice=b}),98);
__d("WAWebParseProtocolMessageHistoryNoticeProto",["WALogger","WAWebGroupHistoryGating","WAWebGroupHistoryMsgData.flow","WAWebMessageHistoryValidation","WAWebMsgType","WAWebUserPrefsMeUser","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(a){var b,c=a.messageProtobuf;a=a.baseMessage;c=c.messageHistoryNotice;if(c==null)return null;d("WAWebMessageHistoryValidation").validateMessageHistoryNotice(c);b=(b=c.messageHistoryMetadata)==null?void 0:b.historyReceivers.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebWidFactory").createWid(a))});if(!d("WAWebGroupHistoryGating").isGroupHistoryNoticeReceiverEnabled()&&b===!1&&!d("WAWebUserPrefsMeUser").isMeAccount(a.from)){var e;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_history_notice"}),contextInfo:(e=c.contextInfo)!=null?e:null}}if(b===!1&&!d("WAWebUserPrefsMeUser").isMeAccount(a.from)){b=(e=c.messageHistoryMetadata)==null?void 0:e.oldestMessageTimestamp;if(b==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[GroupHistory] oldestMessageTimestamp is null"])));return null}return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_NOTICE,kind:d("WAWebMsgType").MsgKind.MessageHistoryNotice,subtype:"message_history_notice",groupHistoryBundleMetadata:c.messageHistoryMetadata?babelHelpers["extends"]({},c.messageHistoryMetadata,{processState:d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.NONE}):null}),contextInfo:(e=c.contextInfo)!=null?e:null}}return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_history_notice"}),contextInfo:(b=c.contextInfo)!=null?b:null}}g["default"]=a}),98);
__d("WAWebParseProtocolSharePhoneNumberMessageProto",["WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;if(b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.SHARE_PHONE_NUMBER)return;b=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"share_phone_number"});return{msgData:b,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebStatusGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){var h=["\ud83d\ude0d","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude4f","\ud83d\udc4f","\ud83c\udf89","\ud83d\udcaf"],i=new Set(["\ud83d\ude0d","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude4f","\ud83d\udc4f","\ud83c\udf89","\ud83d\udcaf","\ud83d\udc4d","\u2764","\ud83d\ude0a","\ud83e\udd70","\ud83e\udd29","\ud83d\udc9a","\ud83e\udd23","\ud83d\ude06","\ud83d\udd25","\ud83d\ude4c","\ud83e\udd73","\ud83d\ude2d","\ud83d\ude14","\ud83e\udd7a","\ud83d\ude32","\ud83e\udd2f","\ud83d\ude21","\ud83d\ude24"]);function a(){try{var a=JSON.parse(d("WAWebABProps").getABPropConfigValue("status_reaction_emojis"));a=a.map(function(a){return String.fromCodePoint(a)}).filter(function(a){return i.has(a)});return a.length===0?h:a}catch(a){return h}}function b(){return d("WAWebABProps").getABPropConfigValue("web_status_likes_receive_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("status_mentions_receiver")}function e(){return d("WAWebABProps").getABPropConfigValue("status_mentions_group_mention_receiver")}function f(){return d("WAWebABProps").getABPropConfigValue("status_ranking_poster_side_gating_enabled")}function j(){return d("WAWebABProps").getABPropConfigValue("status_future_proofing")}function k(){return d("WAWebABProps").getABPropConfigValue("status_save_to_camera_roll_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("status_vpv_logging_enabled")}function m(){return d("WAWebABProps").getABPropConfigValue("status_pog_id_rotation_window_days")}g.statusQuickReplyEmojis=a;g.isStatusLikesReceiveEnabled=b;g.isStatusPrivateMentionsReceiveEnabled=c;g.isStatusPrivateGroupMentionsReceivingEnabled=e;g.canCheckStatusRankingPosterGating=f;g.isStatusEmbeddedContentFutureproofingEnabled=j;g.isStatusSaveToDiskEnabled=k;g.isStatusVPVLoggingEnabled=l;g.statusPogIdRotationWindowDays=m}),98);
__d("WAWebParseProtocolStatusGroupMentionMessageProto",["WAWebMsgType","WAWebStatusGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;if(!d("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled()&&!d("WAWebStatusGatingUtils").isStatusPrivateGroupMentionsReceivingEnabled())return;a=b.groupStatusMentionMessage;if(a==null||(a==null?void 0:a.message)==null)return;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"status_group_mention_message"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseProtocolStatusMentionMessageProto",["WAWebMsgType","WAWebStatusGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;if(!d("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled())return;a=b.statusMentionMessage;if(a==null||(a==null?void 0:a.message)==null)return;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"status_mention_message"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseProtocolStatusNotificationMessageProto",["WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;a=b.associatedChildMessage;b=b.statusNotificationMessage;if((a==null||(a==null?void 0:a.message)==null)&&b==null)return;var e=b;if(a!=null&&a.message!=null&&b==null){e=(b=a.message)==null?void 0:b.statusNotificationMessage}if(e==null)return;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.STATUS_NOTIFICATION,kind:d("WAWebMsgType").MsgKind.Unknown,viewMode:d("WAWebViewMode.flow").ViewModeType.HIDDEN,futureproofSubtype:"status_notification_message"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseRequestPhoneNumberMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.requestPhoneNumberMessage;if(b==null)return;b=b.contextInfo;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REQUEST_PHONE_NUMBER,kind:d("WAWebMsgType").MsgKind.RequestPhoneNumber});return{msgData:a,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseVcardMessageProto",["WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.contactMessage;if(b==null)return;var c=b.contextInfo,e=b.displayName;b=b.vcard;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.VCARD,kind:d("WAWebMsgType").MsgKind.Vcard,body:b,vcardFormattedName:e});return{msgData:a,contextInfo:c}}g["default"]=a}),98);
__d("WAWebMessagePluginParseProtobufRegistry",["WAWebAlbumsParseAlbumMessageProto","WAWebEventsParseEventCreationMessageProto","WAWebEventsParseEventEditEncryptedMessageProto","WAWebEventsParseEventResponseMessageProto","WAWebParseBizContentPlaceholderProto","WAWebParseBotFeedbackProtocolMessageProto","WAWebParseBotMemuOnboardingMessageProto","WAWebParseBotRequestWelcomeMessageProto","WAWebParseButtonsResponseMessageProto","WAWebParseCancelPaymentMessageProto","WAWebParseChatMessageProto","WAWebParseDeclinePaymentMessageProto","WAWebParseDocumentMessageProto","WAWebParseEncCommentMessageProto","WAWebParseEphemeralSyncResponseMessageProto","WAWebParseExtendedTextUrlChatMessageProto","WAWebParseGroupInviteMessageProto","WAWebParseHsmMessageProto","WAWebParseImageMessageProto","WAWebParseInteractiveMessageProto","WAWebParseInteractiveResponseMessageProto","WAWebParseKeepInChatMessageProto","WAWebParseListMessageProto","WAWebParseListResponseMessageProto","WAWebParseLocationMessageProto","WAWebParseMultiVcardMessageProto","WAWebParseNativeFlowButtonsMessageProto","WAWebParseNewsletterAdminInviteMessageProto","WAWebParseNewsletterFollowerInviteMessageProto","WAWebParseOrderMessageProto","WAWebParsePaymentInviteMessageProto","WAWebParsePinMessageProto","WAWebParsePollResultSnapshotMessageProto","WAWebParseProductMessageProto","WAWebParseProtocolAdminRevokeMessageProto","WAWebParseProtocolEphemeralSettingMessageProto","WAWebParseProtocolHistorySyncNotificationMessageProto","WAWebParseProtocolLimitSharingMessageProto","WAWebParseProtocolMemberLabelMessageProto","WAWebParseProtocolMessageEditProto","WAWebParseProtocolMessageHistoryBundleProto","WAWebParseProtocolMessageHistoryNoticeProto","WAWebParseProtocolSenderRevokeMessageProto","WAWebParseProtocolSharePhoneNumberMessageProto","WAWebParseProtocolStatusGroupMentionMessageProto","WAWebParseProtocolStatusMentionMessageProto","WAWebParseProtocolStatusNotificationMessageProto","WAWebParseRequestPaymentMessageProto","WAWebParseRequestPhoneNumberMessageProto","WAWebParseRichResponseMessageProto","WAWebParseSendPaymentMessageProto","WAWebParseStickerPackMessageProto","WAWebParseTemplateButtonReplyMessageProto","WAWebParseVcardMessageProto","WAWebParseVideoMessageProto","WAWebPollsParsePollCreationMessageProto","WAWebPollsParsePollVoteMessageProto","WAWebPttParseAudioMessageProto","WAWebPttParsePttMessageProto","WAWebPtvParsePtvMessageProto","WAWebReactionsParseReactionEncMessageProto","WAWebReactionsParseReactionMessageProto","WAWebStickersParseStickerMessageProto"],(function(a,b,c,d,e,f,g){a=[c("WAWebAlbumsParseAlbumMessageProto"),c("WAWebEventsParseEventCreationMessageProto"),c("WAWebEventsParseEventEditEncryptedMessageProto"),c("WAWebEventsParseEventResponseMessageProto"),c("WAWebParseBizContentPlaceholderProto"),c("WAWebParseBotFeedbackProtocolMessageProto"),c("WAWebParseBotMemuOnboardingMessageProto"),c("WAWebParseBotRequestWelcomeMessageProto"),c("WAWebParseButtonsResponseMessageProto"),c("WAWebParseCancelPaymentMessageProto"),c("WAWebParseChatMessageProto"),c("WAWebParseDeclinePaymentMessageProto"),c("WAWebParseDocumentMessageProto"),c("WAWebParseEncCommentMessageProto"),c("WAWebParseEphemeralSyncResponseMessageProto"),c("WAWebParseExtendedTextUrlChatMessageProto"),c("WAWebParseGroupInviteMessageProto"),c("WAWebParseHsmMessageProto"),c("WAWebParseImageMessageProto"),c("WAWebParseInteractiveMessageProto"),c("WAWebParseInteractiveResponseMessageProto"),c("WAWebParseKeepInChatMessageProto"),c("WAWebParseListMessageProto"),c("WAWebParseListResponseMessageProto"),c("WAWebParseLocationMessageProto"),c("WAWebParseMultiVcardMessageProto"),c("WAWebParseNativeFlowButtonsMessageProto"),c("WAWebParseNewsletterAdminInviteMessageProto"),c("WAWebParseNewsletterFollowerInviteMessageProto"),c("WAWebParseOrderMessageProto"),c("WAWebParsePaymentInviteMessageProto"),c("WAWebParsePinMessageProto"),c("WAWebParsePollResultSnapshotMessageProto"),c("WAWebParseProductMessageProto"),c("WAWebParseProtocolAdminRevokeMessageProto"),c("WAWebParseProtocolEphemeralSettingMessageProto"),c("WAWebParseProtocolHistorySyncNotificationMessageProto"),c("WAWebParseProtocolLimitSharingMessageProto"),c("WAWebParseProtocolMemberLabelMessageProto"),c("WAWebParseProtocolMessageEditProto"),c("WAWebParseProtocolMessageHistoryBundleProto"),c("WAWebParseProtocolMessageHistoryNoticeProto"),c("WAWebParseProtocolSenderRevokeMessageProto"),c("WAWebParseProtocolSharePhoneNumberMessageProto"),c("WAWebParseProtocolStatusGroupMentionMessageProto"),c("WAWebParseProtocolStatusMentionMessageProto"),c("WAWebParseProtocolStatusNotificationMessageProto"),c("WAWebParseRequestPaymentMessageProto"),c("WAWebParseRequestPhoneNumberMessageProto"),c("WAWebParseRichResponseMessageProto"),c("WAWebParseSendPaymentMessageProto"),c("WAWebParseStickerPackMessageProto"),c("WAWebParseTemplateButtonReplyMessageProto"),c("WAWebParseVcardMessageProto"),c("WAWebParseVideoMessageProto"),c("WAWebPollsParsePollCreationMessageProto"),c("WAWebPollsParsePollVoteMessageProto"),c("WAWebPttParseAudioMessageProto"),c("WAWebPttParsePttMessageProto"),c("WAWebPtvParsePtvMessageProto"),c("WAWebReactionsParseReactionEncMessageProto"),c("WAWebReactionsParseReactionMessageProto"),c("WAWebStickersParseStickerMessageProto")];g["default"]=a}),98);
__d("WAWebMessagePluginProcessAsAddonRegistry",["WAWebAddonCommentMsgProcessor","WAWebEventEditAddonMessageProcessor","WAWebEventResponseAddonMessageProcessor","WAWebPinAddonMessageProcessor","WAWebPollVoteAddonMessageProcessor","WAWebReactionAddonMessageProcessor"],(function(a,b,c,d,e,f,g){a=[{type:"album",processor:null},{type:"audio",processor:null},{type:"biz_content_placeholder",processor:null},{type:"buttons_response",processor:null},{type:"chat",processor:null},{type:"chat",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"ciphertext",processor:null},{type:"comment",processor:c("WAWebAddonCommentMsgProcessor")},{type:"debug_placeholder",processor:null},{type:"document",processor:null},{type:"event_creation",processor:null},{type:"event_edit_encrypted",processor:c("WAWebEventEditAddonMessageProcessor")},{type:"event_response",processor:c("WAWebEventResponseAddonMessageProcessor")},{type:"groups_v4_invite",processor:null},{type:"hsm",processor:null},{type:"image",processor:null},{type:"interactive",processor:null},{type:"interactive_response",processor:null},{type:"keep_in_chat",processor:null},{type:"list",processor:null},{type:"list_response",processor:null},{type:"location",processor:null},{type:"multi_vcard",processor:null},{type:"native_flow",processor:null},{type:"newsletter_admin_invite",processor:null},{type:"newsletter_follower_invite",processor:null},{type:"newsletter_question_response",processor:null},{type:"notification_template",processor:null},{type:"order",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"payment",processor:null},{type:"pin_message",processor:c("WAWebPinAddonMessageProcessor")},{type:"pinned_message",processor:null},{type:"poll_creation",processor:null},{type:"poll_result_snapshot",processor:null},{type:"poll_update",processor:c("WAWebPollVoteAddonMessageProcessor")},{type:"product",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"protocol",processor:null},{type:"ptt",processor:null},{type:"ptv",processor:null},{type:"reaction",processor:c("WAWebReactionAddonMessageProcessor")},{type:"reaction_enc",processor:c("WAWebReactionAddonMessageProcessor")},{type:"request_phone_number",processor:null},{type:"revoked",processor:null},{type:"revoked",processor:null},{type:"rich_response",processor:null},{type:"status_notification",processor:null},{type:"sticker",processor:null},{type:"sticker-pack",processor:null},{type:"template_button_reply",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"unknown",processor:null},{type:"vcard",processor:null},{type:"video",processor:null}];g["default"]=a}),98);
__d("WAWebMultipleMessageParserPluginParseProtobuf",["WAWebMultipleMessageParserPluginParseProtobufRegistry"],(function(a,b,c,d,e,f,g){function a(a){var b=[],d;for(var e of c("WAWebMultipleMessageParserPluginParseProtobufRegistry")){var f=e(a);if(f!=null){var g;b.push(f.msgData.type+":"+((g=f.msgData.subtype)!=null?g:"null"));d==null&&(d=f)}}return{result:d,pluginsMatched:b}}g.parseProtobufWithMultipleMessageParserPlugin=a}),98);
__d("WAWebMultipleMessageParserPluginParseProtobufRegistry",["WAWebParseHistorySyncProtocolMessageEditProto","WAWebParseNonNFMButtonsMessageProto","WAWebParseTemplateMessageProto"],(function(a,b,c,d,e,f,g){a=[c("WAWebParseHistorySyncProtocolMessageEditProto"),c("WAWebParseNonNFMButtonsMessageProto"),c("WAWebParseTemplateMessageProto")];g["default"]=a}),98);
__d("WAWebAudioMessageProtoUtils",["WALogger","WAWebE2EProtoParserApi"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){if(!d("WAWebE2EProtoParserApi").shouldLogE2eProtoValidation(a,b))return;a=a.type;b.seconds==null?d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["seconds is missing from msg type ",""])),a).sendLogs(a+"-message-missing-seconds"):b.seconds===0&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["seconds is 0 in msg type ",""])),a).sendLogs(a+"-message-incorrect-seconds");b.fileLength==null&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["fileLength is missing from msg type ",""])),a).sendLogs(a+"-message-missing-fileLength")}function b(a){return a.byteLength>=64&&a.byteLength<=192}g.validateRequiredAudioProperties=a;g.validateWaveform=b}),98);
__d("WAWebButtonsMessageProtoUtils",["WAWebE2EProtoUtils","WAWebMsgType","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseLocationMessageProto","WAWebParseVideoMessageProto","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.buttonsMessage,e=a.baseMessage,f=a.msgContext,g=b.documentMessage,h=b.imageMessage,i=b.locationMessage,j=b.videoMessage,k=b.contentText;a=b.footerText;var l=b.text;b=b.headerType;var m=function(){var a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,title:l==null?e.title:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(l),body:k==null?e.body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k)});if(h){var b;return(b=(b=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:h},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(g){return(b=(b=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:g},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(i){return(b=(b=c("WAWebParseLocationMessageProto")({messageProtobuf:{locationMessage:babelHelpers["extends"]({},i,{name:void 0,address:void 0})},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(j){return(b=(b=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:j},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}return a};m=m();return babelHelpers["extends"]({},m,{headerType:b,caption:k!=null?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k):m.caption,footer:a!=null?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a):m.footer})}function b(a,b,c){var e=a.documentMessage,f=a.imageMessage,g=a.locationMessage,h=a.videoMessage;if(b.isForwarded&&(e||f||g||h))return a;a={buttons:b.isForwarded===!0?void 0:b.dynamicReplyButtons,footerText:b.footer,contextInfo:c};e?(a.documentMessage=e,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.DOCUMENT,a.contentText=b.caption):f?(a.imageMessage=f,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.IMAGE,a.contentText=b.caption):g?(a.locationMessage=g,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.LOCATION,a.contentText=b.caption):h?(a.videoMessage=h,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.VIDEO,a.contentText=b.caption):b.title?(a.text=b.title,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.TEXT,a.contentText=b.body):(a.contentText=b.body,a.headerType=d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.EMPTY);return{buttonsMessage:a}}g.parseButtonsMessageProto=a;g.createDynamicReplyButtonsMessage=b}),98);
__d("WAWebBotMetadataProtoUtils",[],(function(a,b,c,d,e,f){function a(a,b){var c,d,e,f,g,h,i,j;(b==null||(c=b.botMetadata)==null||(c=c.pluginMetadata)==null?void 0:c.pluginType)!=null?a.botPluginType=b.botMetadata.pluginMetadata.pluginType:(b==null||(d=b.botMetadata)==null?void 0:d.pluginMetadata)!=null&&(a.botPluginMaybeParent=!0);(b==null||(e=b.botMetadata)==null||(e=e.pluginMetadata)==null?void 0:e.referenceIndex)!=null&&(a.botPluginReferenceIndex=b.botMetadata.pluginMetadata.referenceIndex);(b==null||(f=b.botMetadata)==null||(f=f.pluginMetadata)==null?void 0:f.provider)!=null&&(a.botPluginSearchProvider=b.botMetadata.pluginMetadata.provider);(b==null||(g=b.botMetadata)==null||(g=g.pluginMetadata)==null?void 0:g.searchProviderUrl)!=null&&(a.botPluginSearchUrl=b.botMetadata.pluginMetadata.searchProviderUrl);(b==null||(h=b.botMetadata)==null||(h=h.pluginMetadata)==null?void 0:h.thumbnailCdnUrl)!=null&&(a.botReelPluginThumbnailCdnUrl=b.botMetadata.pluginMetadata.thumbnailCdnUrl);(b==null||(i=b.botMetadata)==null||(i=i.pluginMetadata)==null?void 0:i.searchQuery)!=null&&(a.botPluginSearchQuery=b.botMetadata.pluginMetadata.searchQuery);if((b==null||(j=b.botMetadata)==null?void 0:j.messageDisclaimerText)!=null){var k;a.botMessageDisclaimerText=b==null||(k=b.botMetadata)==null?void 0:k.messageDisclaimerText}}f.parseBotMetadataProto=a}),66);
__d("WAWebCommonMsgSubtypeTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({Subject:"subject",Add:"add",Remove:"remove",Leave:"leave",Picture:"picture",Modify:"modify",Suspend:"suspend",Delete:"delete",Create:"create",Promote:"promote",Demote:"demote",Invite:"invite",RevokeInvite:"revoke_invite",Description:"description",ParentGroupDescription:"parent_group_description",Restrict:"restrict",Announce:"announce",AnnounceMsgBounce:"announce_msg_bounce",V4AddInviteSent:"v4_add_invite_sent",V4AddInviteJoin:"v4_add_invite_join",NoFrequentlyForwarded:"no_frequently_forwarded",InitialPHashMismatch:"initial_pHash_mismatch",Ephemeral:"ephemeral",GrowthLocked:"growth_locked",GrowthUnlocked:"growth_unlocked",ParentGroupLink:"parent_group_link",SiblingGroupLink:"sibling_group_link",SubGroupLink:"sub_group_link",ParentGroupUnlink:"parent_group_unlink",SiblingGroupUnlink:"sibling_group_unlink",SubGroupUnlink:"sub_group_unlink",LinkedGroupJoin:"linked_group_join",DeleteParentGroup:"delete_parent_group",DeleteParentGroupUnlink:"delete_parent_group_unlink",DeleteParentSubGroupUnlink:"delete_parent_sub_group_unlink",IntegrityParentGroupUnlink:"integrity_parent_group_unlink",IntegritySubGroupUnlink:"integrity_sub_group_unlink",LinkedGroupPromote:"linked_group_promote",LinkedGroupDemote:"linked_group_demote",MembershipApprovalMode:"membership_approval_mode",MembershipApprovalRequest:"membership_approval_request",MemberAddMode:"member_add_mode",MemberLinkMode:"member_link_mode",CreatedMembershipRequests:"created_membership_requests",RevokedMembershipRequests:"revoked_membership_requests",AutoAdd:"auto_add",DefaultSubGroupAdminAdd:"default_sub_group_admin_add",DefaultSubGroupPromote:"default_sub_group_promote",DefaultSubGroupDemote:"default_sub_group_demote",InviteAutoAdd:"invite_auto_add",CommunityParticipantAddRich:"community_participant_add_rich",CommunityInviteRich:"community_invite_rich",SubGroupParticipantAddRich:"sub_group_participant_add_rich",SubGroupInviteRich:"sub_group_invite_rich",CommunityLinkParentGroupRich:"community_link_parent_group_rich",CommunityInviteAutoAddRich:"community_invite_auto_add_rich",AllowNonAdminSubGroupCreation:"allow_non_admin_sub_group_creation",AllowAdminReports:"allow_admin_reports",CreatedSubgroupSuggestion:"created_subgroup_suggestion",RevokedSubGroupSuggestions:"revoked_sub_group_suggestions",AdminReportReceived:"admin_report_received",SubgroupSuggestionsChangeNumber:"subgroup_suggestions_change_number",SubgroupAdminTriggeredAutoAdd:"subgroup_admin_triggered_auto_add",SubgroupAdminTriggeredInviteAutoAdd:"subgroup_admin_triggered_invite_auto_add",EmptySubgroupCreate:"empty_subgroup_create",GeneralChatAdd:"general_chat_add",GeneralChatAutoAddDisabled:"general_chat_auto_add_disabled",CommunityOwnerUpdate:"community_owner_update",HiddenGroup:"hidden_group",GroupSafetyCheck:"group_safety_check",GroupAdder:"group_adder",MemberLabel:"member_label",MessageHistoryBundle:"message_history_bundle",MessageHistoryNotice:"message_history_notice",Url:"url",Encrypt:"encrypt",EncryptNow:"encrypt_now",E2EIdentityUnavailable:"e2e_identity_unavailable",Identity:"identity",Device:"device",ChatPsa:"chat_psa",ErrorInDeviceList:"error_in_device_list",Miss:"miss",MissVideo:"miss_video",MissGroup:"miss_group",MissGroupVideo:"miss_group_video",Silence:"silence",AdminRevoke:"admin_revoke",SenderRevoke:"sender_revoke",EphemeralSetting:"ephemeral_setting",EphemeralSyncResponse:"ephemeral_sync_response",SharePhoneNumber:"share_phone_number",AppStateFatalExceptionNotification:"app_state_fatal_exception_notification",AppStateSyncKeyShare:"app_state_sync_key_share",AppStateSyncKeyRequest:"app_state_sync_key_request",HistorySyncNotification:"history_sync_notification",MessageEdit:"message_edit",BotFeedback:"bot_feedback",BotMemuOnboarding:"bot_memu_onboarding",BotRequestWelcome:"bot_request_welcome",StatusMentionMessage:"status_mention_message",StatusGroupMentionMessage:"status_group_mention_message",StatusNotificationMessage:"status_notification_message",Request:"request",Send:"send",Ciphertext:"ciphertext",Futureproof:"futureproof",PollVote:"poll_vote",Sender:"sender",Admin:"admin",Phone:"phone",PhoneOnlyFeature:"phone_only_feature",Reaction:"reaction",NonVerifiedTransition:"non_verified_transition",UnverifiedTransition:"unverified_transition",VerifiedTransition:"verified_transition",VerifiedLowUnknown:"verified_low_unknown",VerifiedHigh:"verified_high",VerifiedInitialUnknown:"verified_initial_unknown",VerifiedInitialLow:"verified_initial_low",VerifiedInitialHigh:"verified_initial_high",VerifiedTransitionAnyToNone:"verified_transition_any_to_none",VerifiedTransitionAnyToHigh:"verified_transition_any_to_high",VerifiedTransitionHighToLow:"verified_transition_high_to_low",VerifiedTransitionHighToUnknown:"verified_transition_high_to_unknown",VerifiedTransitionUnknownToLow:"verified_transition_unknown_to_low",VerifiedTransitionLowToUnknown:"verified_transition_low_to_unknown",VerifiedTransitionNoneToLow:"verified_transition_none_to_low",VerifiedTransitionNoneToUnknown:"verified_transition_none_to_unknown",PaymentTransactionStatusUpdateFailed:"payment_transaction_status_update_failed",PaymentTransactionStatusUpdateRefunded:"payment_transaction_status_update_refunded",PaymentTransactionStatusUpdateRefundFailed:"payment_transaction_status_update_refund_failed",PaymentTransactionStatusReceiverPendingSetup:"payment_transaction_status_receiver_pending_setup",PaymentTransactionStatusReceiverSuccessAfterHiccup:"payment_transaction_status_receiver_success_after_hiccup",PaymentTransactionRequestCancelled:"payment_transaction_request_cancelled",PaymentActionAccountSetupReminder:"payment_action_account_setup_reminder",PaymentActionSendPaymentReminder:"payment_action_send_payment_reminder",PaymentActionSendPaymentInvitation:"payment_action_send_payment_invitation",PaymentActionRequestDeclined:"payment_action_request_declined",PaymentActionRequestExpired:"payment_action_request_expired",PaymentInviteAccountSetUp:"payment_invite_account_set_up",BizVerifiedTransitionTopToBottom:"biz_verified_transition_top_to_bottom",BizVerifiedTransitionBottomToTop:"biz_verified_transition_bottom_to_top",BizIntroTop:"biz_intro_top",BizIntroBottom:"biz_intro_bottom",BizNameChange:"biz_name_change",BizMoveToConsumerApp:"biz_move_to_consumer_app",BizTwoTierMigrationTop:"biz_two_tier_migration_top",BizTwoTierMigrationBottom:"biz_two_tier_migration_bottom",SenderInvite:"sender_invite",ReceiverInvite:"receiver_invite",ChangeNumber:"change_number",ChangeUsername:"change_username",ChangeLid:"change_lid",MaskedThreadCreated:"masked_thread_created",PhoneNumberThreadPromotion:"pnh_thread_promotion",CagMaskedThreadCreated:"cag_masked_thread_created",InfoEncrypted:"info_encrypted",DescAdd:"desc_add",DescRemove:"desc_remove",Fanout:"fanout",BotUnavailableFanout:"bot_unavailable_fanout",HostedUnavailableFanout:"hosted_unavailable_fanout",ViewOnceUnavailableFanout:"view_once_unavailable_fanout",DisappearingMode:"disappearing_mode",DisappearingModeUpdate:"disappearing_mode_update",DisappearingModeUnsupported:"disappearing_mode_unsupported",BlockContact:"block_contact",CommunityCreate:"community_create",EphemeralKeepInChat:"ephemeral_keep_in_chat",KeepInChat:"keep_in_chat",ChatAssignment:"chat_assignment",PeerDataOperationRequestMessage:"peer_data_operation_request_message",ChatAssignmentUnassign:"chat_assignment_unassign",PeerDataOperationRequestResponseMessage:"peer_data_operation_request_response_message",MarketingMessagesFromBusinessStopped:"marketing_messages_from_business_stopped",MarketingMessagesFromBusinessResumed:"marketing_messages_from_business_resumed",NewsletterCreated:"newsletter_created",NewsletterPrivacy:"newsletter_privacy",NewsletterDeleted:"newsletter_deleted",NewsletterAdminContextCard:"newsletter_admin_context_card",PollCreation:"poll_creation",PollUpdate:"poll_update",ContactInfoCard:"contact_info_card",OrderEphemeralExemption:"order_ephemeral_exemption",BotInit:"bot_init",BotTypingPlaceholder:"bot_typing_placeholder",BotInvokeDisclaimer:"bot_invoke_disclaimer",BizBot1PDisclosure:"biz_bot_1p_disclosure",BizBot3PDisclosure:"biz_bot_3p_disclosure",BlueMsgBspFbToBspPremise:"blue_msg_bsp_fb_to_bsp_premise",BlueMsgBspFbToSelfFb:"blue_msg_bsp_fb_to_self_fb",BlueMsgBspFbToSelfPremise:"blue_msg_bsp_fb_to_self_premise",BlueMsgBspFbUnverified:"blue_msg_bsp_fb_unverified",BlueMsgBspFbUnverifiedToBspPremiseVerified:"blue_msg_bsp_fb_unverified_to_bsp_premise_verified",BlueMsgBspFbUnverifiedToSelfFbVerified:"blue_msg_bsp_fb_unverified_to_self_fb_verified",BlueMsgBspFbUnverifiedToSelfPremiseVerified:"blue_msg_bsp_fb_unverified_to_self_premise_verified",BlueMsgBspFbVerified:"blue_msg_bsp_fb_verified",BlueMsgBspFbVerifiedToBspPremiseUnverified:"blue_msg_bsp_fb_verified_to_bsp_premise_unverified",BlueMsgBspFbVerifiedToSelfFbUnverified:"blue_msg_bsp_fb_verified_to_self_fb_unverified",BlueMsgBspFbVerifiedToSelfPremiseUnverified:"blue_msg_bsp_fb_verified_to_self_premise_unverified",BlueMsgBspPremiseToSelfPremise:"blue_msg_bsp_premise_to_self_premise",BlueMsgBspPremiseUnverified:"blue_msg_bsp_premise_unverified",BlueMsgBspPremiseUnverifiedToSelfPremiseVerified:"blue_msg_bsp_premise_unverified_to_self_premise_verified",BlueMsgBspPremiseVerified:"blue_msg_bsp_premise_verified",BlueMsgBspPremiseVerifiedToSelfPremiseUnverified:"blue_msg_bsp_premise_verified_to_self_premise_unverified",BlueMsgConsumerToBspFbUnverified:"blue_msg_consumer_to_bsp_fb_unverified",BlueMsgConsumerToBspPremiseUnverified:"blue_msg_consumer_to_bsp_premise_unverified",BlueMsgConsumerToSelfFbUnverified:"blue_msg_consumer_to_self_fb_unverified",BlueMsgConsumerToSelfPremiseUnverified:"blue_msg_consumer_to_self_premise_unverified",BlueMsgSelfFbToBspPremise:"blue_msg_self_fb_to_bsp_premise",BlueMsgSelfFbToSelfPremise:"blue_msg_self_fb_to_self_premise",BlueMsgSelfFbUnverified:"blue_msg_self_fb_unverified",BlueMsgSelfFbUnverifiedToBspPremiseVerified:"blue_msg_self_fb_unverified_to_bsp_premise_verified",BlueMsgSelfFbUnverifiedToSelfPremiseVerified:"blue_msg_self_fb_unverified_to_self_premise_verified",BlueMsgSelfFbVerified:"blue_msg_self_fb_verified",BlueMsgSelfFbVerifiedToBspPremiseUnverified:"blue_msg_self_fb_verified_to_bsp_premise_unverified",BlueMsgSelfFbVerifiedToSelfPremiseUnverified:"blue_msg_self_fb_verified_to_self_premise_unverified",BlueMsgSelfPremiseToBspPremise:"blue_msg_self_premise_to_bsp_premise",BlueMsgSelfPremiseUnverified:"blue_msg_self_premise_unverified",BlueMsgSelfPremiseVerified:"blue_msg_self_premise_verified",BlueMsgToBspFb:"blue_msg_to_bsp_fb",BlueMsgToConsumer:"blue_msg_to_consumer",BlueMsgToSelfFb:"blue_msg_to_self_fb",BlueMsgUnverifiedToBspFbVerified:"blue_msg_unverified_to_bsp_fb_verified",BlueMsgUnverifiedToBspPremiseVerified:"blue_msg_unverified_to_bsp_premise_verified",BlueMsgUnverifiedToSelfFbVerified:"blue_msg_unverified_to_self_fb_verified",BlueMsgUnverifiedToVerified:"blue_msg_unverified_to_verified",BlueMsgVerifiedToBspFbUnverified:"blue_msg_verified_to_bsp_fb_unverified",BlueMsgVerifiedToBspPremiseUnverified:"blue_msg_verified_to_bsp_premise_unverified",BlueMsgVerifiedToSelfFbUnverified:"blue_msg_verified_to_self_fb_unverified",BlueMsgVerifiedToUnverified:"blue_msg_verified_to_unverified",BizPrivacyModeInitFb:"biz_privacy_mode_init_fb",BizPrivacyModeInitBsp:"biz_privacy_mode_init_bsp",BizPrivacyModeToFb:"biz_privacy_mode_to_fb",BizPrivacyModeToBsp:"biz_privacy_mode_to_bsp",SagaInit:"saga_init",SupportSystemMessage:"support_system_message",BizAccountTypeChangedToHosted:"biz_account_type_changed_to_hosted",BizMeAccountTypeIsHostedSystemMsg:"biz_me_account_type_is_hosted",BizMeAccountTypeIsHostedSystemMsgTransition:"biz_me_account_type_is_hosted_transition",BizAccountTypeIsHostedSystemMsg:"biz_account_type_is_hosted",EventEditDecrypted:"event_edit_decrypted",HostedGroup:"is_capi_hosted_group",LimitSharingSystemMessage:"limit_sharing_system_message",BizAutomaticallyLabeledChatSystemMessage:"biz_automatically_labeled_chat_system_message",GuestUpsell:"guest_upsell",HostedGroupDoNotUseS440891:"is_hosted_group"});f.MsgSubtype=a}),66);
__d("WAWebMessageAssociationValidation",["$InternalEnum","WACustomError","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PARENT_MESSAGE_KEY:"missing_parent_message_key",INVALID_PARENT_MESSAGE_KEY:"invalid_parent_message_key",MISSING_ASSOCIATION_TYPE:"missing_association_type",MISMATCH_SENDER:"mismatch_sender",UNSUPPORTED_ASSOCIATION_TYPE:"unsupported_association_type",INVALID_CHILD_MESSAGE:"invalid_child_message"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="MessageAssociationValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);e=b("$InternalEnum")({MESSAGE_ASSOCIATIONS_MISMATCH:"message_associations_mismatch"});f=function(a){function b(b,c){b="errorCode: "+String(b);c!=null&&(b+=" comment: "+c);return a.call(this,b)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("MessageAssociationInfraError"));g.MessageAssociationValidationErrorCode=a;g.MessageAssociationValidationError=c;g.MessageAssociationInfraErrorCode=e;g.MessageAssociationInfraError=f}),98);
__d("WAWebE2EProtoParser",["WALogger","WANullthrows","WAWebABProps","WAWebABPropsSaga","WAWebAssociationProtoUtils","WAWebBotMetadataProtoUtils","WAWebCommonMsgSubtypeTypes","WAWebCrashlog","WAWebE2EProtoParserForCtwaContext","WAWebE2EProtoUtils","WAWebFutureproofProtoUtils","WAWebLimitSharingProtoUtils","WAWebMediaGatingUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationValidation","WAWebMessagePluginParseProtobuf","WAWebMmSignalSharingExpirationWindowUtils","WAWebMsgType","WAWebParseForwardedNewsletterMessageInfo","WAWebProtobufsE2E.pb","WAWebQuestionsProtoUtils","WAWebQuotedMessageProtoUtils","WAWebThreadsMetadataProtoUtils","WAWebWamEnumE2eFailureReason","WAWebWid"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;function q(a){var b=a.messageProtobuf,c=a.message,e=a.bizInfo,f=a.msgContext,g=a.paymentInfo,i=a.finalLocation,j=a.quotedPaymentInfo,k=a.editAttr,l=a.rcat,m=a.bizSource,n=a.msgMeta;a=a.msgBotInfo;b||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["drop: not Message"]))).devConsole(b,c).sendLogs("null-message");var o=b.messageContextInfo;b=r({messageProtobuf:b,message:c,msgContext:f,paymentInfo:g,finalLocation:i,quotedPaymentInfo:j,bizInfo:e,editAttr:k,rcat:l,bizSource:m,msgMeta:n,msgBotInfo:a});c=b.contextInfo;g=b.msgData;t(g,c,f,j);z(g,o);return g}function r(a){var b=a.messageProtobuf,c=a.message,e=a.bizInfo,f=a.msgContext,g=a.paymentInfo,h=a.finalLocation,j=a.quotedPaymentInfo,k=a.editAttr,l=a.rcat,m=a.bizSource,n=a.msgMeta;a=a.msgBotInfo;var o=b.callLogMesssage,p=d("WAWebAssociationProtoUtils").validateMessageAssociationInMessageContextInfo(c,b.messageContextInfo,f);if(p!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){var q=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(p,c,f);if(q.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN){var r=c;r=babelHelpers["extends"]({},r,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:"associatedUnknown",associationType:q.associationType,parentMsgKey:q.associationParentMsgKey,viewMode:q.viewMode});return{contextInfo:null,msgData:r}}}q=d("WAWebMessagePluginParseProtobuf").parseProtobuf({messageProtobuf:b,baseMessage:c,msgContext:f,paymentInfo:g,quotedPaymentInfo:j,editAttr:k,bizInfo:e,finalLocation:h,rcat:l,bizSource:m,msgMeta:n,messageAssociation:p,msgBotInfo:a});if(q){r=(q==null?void 0:q.msgData.type)===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&(q==null?void 0:q.msgData.futureproofType)!=null;if(!r&&d("WAWebQuestionsProtoUtils").shouldFutureProofQuestionMessage(q)){g=c;j=babelHelpers["extends"]({},g,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:"unknown",subtype:void 0});return{contextInfo:null,msgData:j}}if(p!=null){var t;e=d("WAWebAssociationProtoUtils").convertAssociationTypeFromProtoToClientSupportedAssociationType(p.associationType);if(!r&&e!==d("WAWebMessageAssociation.flow").MessageAssociationType.BOT_PLUGIN&&(q==null?void 0:q.msgData.associationType)!==e&&(b==null||(t=b.protocolMessage)==null?void 0:t.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseMsgProto: Association type mismatch, parsedData Msg type: ",", associationTypeFromProtoCasted: ",", parsedData associationType: ",""])),q==null?void 0:q.msgData.type,e,q==null?void 0:q.msgData.associationType);throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.INVALID_CHILD_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}}void d("WAWebLimitSharingProtoUtils").parseLimitSharingFromMessage(c,b);s(q.msgData);return q}h=b.deviceSentMessage;h&&v(c,h,f);o&&x(c,o);l=b.groupStatusMessageV2;l!=null&&d("WAWebABProps").getABPropConfigValue("group_status_receiver_enabled")&&y(c,l,f);m=d("WAWebFutureproofProtoUtils").maybeGetFutureproofMessage(b);m!=null&&w({message:c,futureproofMessage:m,msgContext:f,topLevelMessageContextInfo:b.messageContextInfo,editAttr:k});return{contextInfo:null,msgData:c}}function s(a){if(a.isViewOnce!==!0)return;["body","caption","deprecatedMms3Url","directPath","encFilehash","filehash","mediaKey","mediaKeyTimestamp","scanLengths","scansSidecar","size","staticUrl","thumbnailDirectPath","thumbnailEncSha256","thumbnailSha256","url","height","width"].forEach(function(b){a[b]=void 0});"metadataUrl"in a&&a.metadataUrl!=null&&d("WAWebMediaGatingUtils").isChannelVideoServerTranscodeUploadEnabled()&&(a.metadataUrl=void 0)}function t(a,b,c,e){if(!b)return;u(a,b,c,e);d("WAWebE2EProtoParserForCtwaContext").parseCtwaContextProto(a,b)}function u(a,b,c,e){var f=b.quotedMessage,g=b.mentionedJid,h=b.groupMentions;if(f!=null&&d("WAWebE2EProtoUtils").isQuotedSupported(f)){var i=a.selectedCarouselCardIndex!=null;a.quotedMsg=d("WAWebQuotedMessageProtoUtils").parseQuotedMessage({quotedMsg:f,msgContext:c,isCarouselCardReply:i,contextInfo:b,targetMessageKey:a.id})}d("WAWebQuestionsProtoUtils").maybeAddQuestionReplyQuotedMessage(a,b.questionReplyQuotedMessage);a.quotedMsg&&a.quotedMsg.type==="payment"&&e&&d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["parseContextInfoProto: payment not supported"])));a.quotedStanzaID=b.stanzaId;a.quotedParticipant=d("WAWebE2EProtoUtils").decodeJid(b.participant);a.quotedRemoteJid=d("WAWebE2EProtoUtils").decodeJid(b.remoteJid);a.quotedGroupSubject=d("WAWebE2EProtoUtils").decodeJid(b.groupSubject);a.quotedParentGroupJid=d("WAWebE2EProtoUtils").decodeJid(b.parentGroupJid);a.quotedType=b.quotedType;a.mentionedJidList=Array.isArray(g)?g.map(d("WAWebE2EProtoUtils").decodeJid):g;a.groupMentions=Array.isArray(h)?h.map(function(a){return{groupSubject:a.groupSubject,groupJid:d("WAWebE2EProtoUtils").decodeJid(a.groupJid)}}):h;a.isForwarded=b.isForwarded;a.isQuestion=b.isQuestion;a.forwardingScore=b.forwardingScore;b.expiration!=null&&(a.ephemeralDuration=b.expiration);b.ephemeralSettingTimestamp!=null&&(a.ephemeralSettingTimestamp=b.ephemeralSettingTimestamp);b.ephemeralSharedSecret!=null&&(a.ephemeralSharedSecret=b.ephemeralSharedSecret);f=b.disappearingMode;if(f!=null){c=d("WAWebE2EProtoUtils").protoToDisappearingModeInitiator(a,f);c!=null&&(a.disappearingModeInitiator=c);i=d("WAWebE2EProtoUtils").protoToDisappearingMode(a,f);i!=null&&(a.disappearingModeTrigger=i.disappearingModeTrigger,a.disappearingModeInitiatedByMe=i.initiatedByMe)}b.actionLink!=null&&(a.actionLink=b.actionLink);b.smbClientCampaignId!=null&&(a.smbClientCampaignId=b.smbClientCampaignId);if(b.forwardedNewsletterMessageInfo!=null)try{a.forwardedNewsletterMessageInfo=d("WAWebParseForwardedNewsletterMessageInfo").parseForwardedNewsletterMessageInfo(b.forwardedNewsletterMessageInfo)}catch(a){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["parseContextInfoProto: failed to parse forwarded newsletter info"]))).devConsole(a).sendLogs("Failed to parse Forwarded Newsletter Message Info.")}d("WAWebMmSignalSharingExpirationWindowUtils").updateMmSignalSharingExpirationWindow(a,b)}function v(a,b,c){var e=d("WAWebE2EProtoUtils").decodeJid(b.destinationJid);a.id.remote=e;a.to=e;Object.assign(a,q({messageProtobuf:b.message,message:a,msgContext:c}))}function w(a){var b=a.message,d=a.futureproofMessage,e=a.msgContext,f=a.topLevelMessageContextInfo;a=a.editAttr;d=c("WANullthrows")(d.message);var g=[];f=f==null?babelHelpers["extends"]({},d.messageContextInfo,{threadId:g}):babelHelpers["extends"]({},d.messageContextInfo,f,{threadId:g});Object.assign(b,q({messageProtobuf:babelHelpers["extends"]({},d,{messageContextInfo:f}),message:b,msgContext:e,editAttr:a}))}function x(a,b){a.type=d("WAWebMsgType").MSG_TYPE.CALL_LOG;var c=!!b.isVideo;b.participants.length>1?a.subtype=c?d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissGroupVideo:d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissGroup:a.subtype=c?d("WAWebCommonMsgSubtypeTypes").MsgSubtype.MissVideo:d("WAWebCommonMsgSubtypeTypes").MsgSubtype.Miss}function y(a,b,c){(b==null?void 0:b.message)!=null?(a.isGroupStatus=!0,Object.assign(a,q({messageProtobuf:b.message,message:a,msgContext:c}))):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[parseGroupStatusMessageV2] Unable to parse possible group status message"]))).sendLogs("parse-group-status-message-skipped")}function z(a,b){var e,f;if(!b)return;b.messageSecret!=null&&(a.messageSecret=new Uint8Array(b.messageSecret));((e=a.id)!=null&&(e=e.participant)!=null&&e.isBot()||(e=a.id)!=null&&(e=e.remote)!=null&&e.isBot())&&d("WAWebBotMetadataProtoUtils").parseBotMetadataProto(a,b);if(c("WAWebWid").isCAPISupportAccount(a==null||(f=a.id)==null?void 0:f.remote)&&(b==null?void 0:b.supportPayload)!=null){var g=JSON.parse(b.supportPayload);g.should_show_system_message!=null&&d("WAWebABPropsSaga").getIsSagaProtobufSystemMessageEnabled()&&(a.shouldShowSupportAISystemMessage=g.should_show_system_message);g.is_ai_message!=null&&d("WAWebABPropsSaga").getIsSagaProtobufAIStardustEnabled()&&(a.isSupportAIMessage=g.is_ai_message);Array.isArray(g.citation_items)&&g.citation_items.length>0&&(a.supportCitations=g.citation_items.map(function(a){return{title:a.title,subtitle:a.subtitle,cmsId:a.cms_id,imageUrl:a.image_url}}));if(g.should_upload_client_logs===!0&&d("WAWebABPropsSaga").getIsSagaV1ReengagementEnabled())if(g.ticket_id!=null&&g.ticket_id!=="no_ticket_created"){e=864e5;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Uploading logs for ticketId=",""])),g.ticket_id);e={reason:d("WAWebCrashlog").SERVER_REQUESTED,immediate:!0,isHighPri:!0,logType:d("WAWebCrashlog").LogType.SUPPORT,ticketId:g.ticket_id,fromTimestamp:Date.now()-e};d("WAWebCrashlog").upload(e).then(function(a){a==null?d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Logs upload failed for ticketId=",""])),g.ticket_id):d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Logs upload complete for ticketId=",", logsId=",""])),g.ticket_id,a)})}else d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["InAppSupport: Could not upload logs. No ticketId was provided."])))}b.threadId!=null&&d("WAWebABProps").getABPropConfigValue("web_threads_infra_enabled")&&d("WAWebThreadsMetadataProtoUtils").parseThreadsMetadataProto(a,b)}g.parseMsgProto=q;g.parseContextInfo=t;g.parseContextInfoProto=u;g.parseMessageContextInfoProto=z}),98);
__d("WAWebAddonProcessingError",["$InternalEnum","WAWebHandleMsgError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({MISSING_THREAD_MESSAGE_ID:"missing_thread_message_id",MISSING_THREAD_MESSAGE_SENDER_JID:"missing_thread_message_sender_jid"}),i=function(a){function b(b,c){b="type: "+b+", errorCode: "+String(c);c=a.call(this,b,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)||this;c.name="PlaceholderValidationError";return c}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);a=function(a,b){var c=a.threadMsgId;a=a.threadMsgSenderJid;if(c==null)throw new i(b,h.MISSING_THREAD_MESSAGE_ID);else if(a==null)throw new i(b,h.MISSING_THREAD_MESSAGE_SENDER_JID);return{threadMsgId:c,threadMsgSenderJid:a}};g.validateMsgMeta=a}),98);
__d("WAWebSpecialEmojisWithSkinTones",[],(function(a,b,c,d,e,f){a={"\ud83e\udd1d\ud83c\udffb":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffc":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffd":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udffe":"\ud83e\udd1d","\ud83e\udd1d\ud83c\udfff":"\ud83e\udd1d","\ud83d\udc6f\ud83c\udffb":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffc":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffd":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffe":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udfff":"\ud83d\udc6f","\ud83d\udc6f\ud83c\udffb\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffc\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffd\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udffe\u200d\u2642":"\ud83d\udc6f\u200d\u2642","\ud83d\udc6f\ud83c\udfff\u200d\u2642":"\ud83d\udc6f\u200d\u2642"};f["default"]=a}),66);
__d("WAWebConvertToTextWithoutSpecialEmojis",["WAWebEmojiCompile","WAWebSpecialEmojisWithSkinTones"],(function(a,b,c,d,e,f,g){var h=null;function a(a){if(!h){var b=c("WAWebEmojiCompile")(Object.keys(c("WAWebSpecialEmojisWithSkinTones")));h=new RegExp("("+b+")","g")}h.lastIndex=0;return a.replace(h,function(a){return c("WAWebSpecialEmojisWithSkinTones")[a]})}g.convertToTextWithoutSpecialEmojis=a}),98);
__d("WAWebInteractiveMessageType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NATIVE_FLOW:"native_flow",SHOPS_STOREFRONT:"shops_storefront",CAROUSEL:"carousel"});c=a;f["default"]=c}),66);
__d("WAWebInteractiveResponseMessageType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({NATIVE_FLOW:"native_flow"});c=a;f["default"]=c}),66);
__d("WAWebE2EProtoUtils",["invariant","WABase64","WAJids","WALogger","WALongInt","WANullthrows","WATypeUtils","WAWebABProps","WAWebAddonCrossWindowUtils","WAWebAddonProcessMsgsUtils","WAWebAddonProcessingError","WAWebApiContact","WAWebBackendApi","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBizGatingUtils","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebConvertToTextWithoutSpecialEmojis","WAWebDBGroupsGroupMetadata","WAWebEphemeralityTypes","WAWebHandleMsgCommon","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebInteractiveResponseMessageType","WAWebIsCagGroupCache","WAWebLidMigrationUtils","WAWebMobilePlatforms","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebNonEmptyString","WAWebPollsGatingUtils","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebVerifyProtobufMsgObjectKeys","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","cr:13547","err"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n;i=(i=b("cr:13547"))!=null?i:{};var o=i.syncDisappearingModeTriggerToDB;function p(a){var b;b=(b=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?b:a;if(b.ephemeralMessage){a=b.ephemeralMessage.message;return a?p(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.groupMentionedMessage){a=b.groupMentionedMessage.message;return a?p(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.botInvokeMessage){a=b.botInvokeMessage.message;return a?p(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.deviceSentMessage){a=b.deviceSentMessage.message;return a?p(a):d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text}if(b.reactionMessage||b.encReactionMessage)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction;if(b.eventMessage||b.encEventResponseMessage||((a=b.secretEncryptedMessage)==null?void 0:a.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event;if(b.pollCreationMessage||b.pollCreationMessageV2||b.pollCreationMessageV3||b.pollCreationMessageV5||b.pollUpdateMessage)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll;if(((a=b.extendedTextMessage)==null?void 0:a.matchedText)!=null&&b.extendedTextMessage.matchedText.trim()!=="")return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.media;if(Boolean(b.conversation)||b.extendedTextMessage||b.templateButtonReplyMessage||b.protocolMessage||b.interactiveMessage||b.keepInChatMessage||b.requestPhoneNumberMessage||b.editedMessage||b.pinInChatMessage||b.encCommentMessage||b.newsletterAdminInviteMessage||b.newsletterFollowerInviteMessageV2)return d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text;return b.pollResultSnapshotMessage?d("WAWebPollsGatingUtils").isPollResultSnapshotPollTypeEnvelopeEnabled()?d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll:d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text:d("WAWebHandleMsgCommon").STANZA_MSG_TYPES.media}function a(a){if(d("WAWebAddonCrossWindowUtils").getAddonProcessorType(a)===d("WAWebMsgType").MSG_TYPE.COMMENT){a=d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a);var b=d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(a.participant,"undefined participant"));b=d("WAWebLidMigrationUtils").toUserLidOrThrow(b);return{threadMsgId:a.id,threadMsgSenderLid:c("WANullthrows")(b,"undefined lid")}}}function e(a){var b;b=(b=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(a))!=null?b:a;if(b.reactionMessage||b.encReactionMessage||(a=b.pollUpdateMessage)!=null&&a.vote||b.keepInChatMessage||b.editedMessage||b.pinInChatMessage||((a=b.botInvokeMessage)==null||(a=a.message)==null||(a=a.protocolMessage)==null?void 0:a.type)===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE||b.encEventResponseMessage||((a=b.secretEncryptedMessage)==null?void 0:a.secretEncType)===d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT)return d("WAWebBackendJobs.flow").DecryptFailType.Hide;a=b.protocolMessage;return a&&(a.type===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE||a.type===d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REQUEST_WELCOME_MESSAGE||a.editedMessage)?d("WAWebBackendJobs.flow").DecryptFailType.Hide:d("WAWebBackendJobs.flow").DecryptFailType.Show}function f(a,b){var e=a.fromMe,f=a.id,g=a.participant;a=a.remoteJid;g=g!=null?g:b==null?void 0:b.toString();e!=null&&a!=null&&f!=null||h(0,56276);b=g!=null&&d("WAWebWidFactory").isWidlike(g)?d("WAWebWidFactory").createWid(g):void 0;g=d("WAWebWidFactory").createWid(a);(g.isGroup()||g.isBroadcast())&&e&&(b=d("WAWebUserPrefsMeUser").getMaybeMePnUser());return new(c("WAWebMsgKey"))({fromMe:e,id:f,participant:b,remote:d("WAWebWidFactory").createWid(a)})}function q(a){var b;return{fromMe:a.fromMe,id:a.id,participant:a.fromMe?void 0:(b=a.participant)==null?void 0:b.toString({legacy:!0}),remoteJid:a.remote.toString({legacy:!0})}}function r(a){return{paymentStatus:a.status,paymentTxnStatus:a.txnStatus,paymentCurrency:a.currency||"",paymentAmount1000:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.amount1000)),paymentMessageReceiverJid:d("WAWebWidFactory").createWid(c("WANullthrows")(a.receiverJid)),paymentExpiryTimestamp:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.expiryTimestamp),paymentTransactionTimestamp:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.transactionTimestamp))}}function s(a){var b,c=["XUS","XDX","USDP"];a=d("WAWebNonEmptyString").asMaybeNonEmptyString(a==null||(b=a.primaryAmount)==null?void 0:b.currencyCode)||(a==null?void 0:a.currency);return a!=null&&c.includes(a.toUpperCase())}function t(a,b){return a.remote.isGroup()&&!((a=a.participant)!=null&&a.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow()))&&!b.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())?!1:!0}function u(a){var b=a.name,c=a.bizInfo;a=a.msgContext;return b!=null||(c==null?void 0:c.nativeFlowName)!=null?!d("WAWebBizGatingUtils").nativeFlowMessagesEnabled()?!1:v({name:b,bizInfo:c,msgContext:a}):!0}function v(a){var b=a.name,d=a.bizInfo;a=a.msgContext;if(a!=="relay"&&b!=null)return!0;if((d==null?void 0:d.nativeFlowName)==null)return!1;if(b==null)return!1;return c("WAWebInteractiveMessagesNativeFlowName").cast(d.nativeFlowName)===c("WAWebInteractiveMessagesNativeFlowName").MIXED?!0:b!=null&&c("WAWebInteractiveMessagesNativeFlowName").cast(d.nativeFlowName)===b}function w(a){return a===c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||a===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD||a===c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO}function x(a){var b,e,f,g,h,i,j=a.interactiveMessage,k=j==null||(b=j.nativeFlowMessage)==null?void 0:b.buttons;if(k!=null&&k.length>0&&!d("WAWebBizTemplateAndInteractiveMessagesUtils").buttonsViolateButtonImprovementsConstraints(k.map(function(a){return{nativeFlowButton:a}})))return String(d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName(k[0].name));if(((e=a.buttonsMessage)==null||(e=e.buttons)==null?void 0:e.length)===1){return String(d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName((e=a.buttonsMessage.buttons[0].nativeFlowInfo)==null?void 0:e.name))}a=!(k!=null&&k.length)&&(((a=j==null||(f=j.body)==null||(f=f.text)==null?void 0:f.length)!=null?a:0)>0||((e=j==null||(g=j.header)==null||(g=g.title)==null?void 0:g.length)!=null?e:0)>0||((k=j==null||(h=j.footer)==null||(h=h.text)==null?void 0:h.length)!=null?k:0)>0||(j==null||(i=j.header)==null?void 0:i.imageMessage)!=null)&&!(j!=null&&j.shopStorefrontMessage);if(a)return String(c("WAWebInteractiveMessagesNativeFlowName").MIXED)}var y=["novi_login","novi_report_transaction","novi_hub","novi_view_code","novi_view_transaction","novi_view_bank_detail","novi_view_card_detail","wa_payment_transaction_details","wa_payment_learn_more","wa_payment_fbpin_reset"];function z(a){return a.some(function(a){return a.nativeFlowInfo&&y.includes(a.nativeFlowInfo.name)||y.includes(a.buttonId)})}function A(a){switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return d("WAWebBizGatingUtils").interactiveNativeFlowMessagesEnabled();case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return d("WAWebBizGatingUtils").shopsInteractiveMessageEnabled();case c("WAWebInteractiveMessageType").CAROUSEL:return d("WAWebBizGatingUtils").carouselsEnabled()}}function B(a){switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return"nativeFlowMessage";case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return"shopStorefrontMessage";case c("WAWebInteractiveMessageType").CAROUSEL:return"carouselMessage"}}function C(a){for(var b of c("WAWebInteractiveMessageType").members())if(B(b)in a)return b;return null}function D(a,b){b=b==null?void 0:b.messageVersion;if(b==null||a==null)return!1;switch(a){case c("WAWebInteractiveMessageType").NATIVE_FLOW:return b<=1;case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return b<=1;case c("WAWebInteractiveMessageType").CAROUSEL:return b<=1}}function E(a){switch(a){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:return"nativeFlowResponseMessage"}}function F(a){for(var b of c("WAWebInteractiveResponseMessageType").members())if(E(b)in a)return b;return null}function G(a){switch(a){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:return d("WAWebBizGatingUtils").interactiveNativeFlowResponseMessagesEnabled()}}function H(a){var b=a.type,d=a.message,e=a.bizInfo;a=a.msgContext;switch(b){case c("WAWebInteractiveResponseMessageType").NATIVE_FLOW:d=c("WANullthrows")(d.nativeFlowResponseMessage);var f=c("WANullthrows")(c("WAWebInteractiveMessagesNativeFlowName").cast(d.name)),g=c("WANullthrows")(d.version);if(g>1||!v({name:f,bizInfo:e,msgContext:a}))throw c("err")("Invalid message");return{name:f,version:g,type:b,paramsJson:c("WANullthrows")(d.paramsJson)}}}function I(a){return a.reactionMessage!=null?!1:!0}function J(a){return a!=null&&c("WAWebWid").isWid(a)?d("WAWebWidFactory").createWid(a):a}function K(a,b){a=J(a);typeof a==="string"&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," got decoded to a string: ",""])),b,a);return a}function L(a){if(a==null)return;c("WAWebWid").isWid(a)||h(0,64887);return d("WAWebWidFactory").createWid(a)}function M(a,b){if(a==null)return;var c=a.id;if(c==null)return;return P(c,a,b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon)}function N(a,b){if(a==null)return;var c=a.id;if(c==null)return;return P(c,a,b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message)}function O(a,b,e){a=d("WAWebAddonProcessingError").validateMsgMeta(a,e);e=a.threadMsgId;a=a.threadMsgSenderJid;return new(c("WAWebMsgKey"))({id:e,fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:b.chat,participant:a})}function P(a,b,e,f){var g,h,i,j;if(!(e!=null&&(g=e.id)!=null&&g.fromMe)){j=e.id.remote;var k=c("WAWebIsCagGroupCache").isCag(j);if(b.fromMe===!0){var l;h=!1;i=e.author;if(k&&(l=i)!=null&&l.isLid()&&f!==d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon){k=d("WAWebApiContact").getPhoneNumber(e.author);k!=null&&(i=k)}}else{k=J(b.participant);!(k instanceof c("WAWebWid"))?h=!0:(h=d("WAWebUserPrefsMeUser").isMeAccount(k),(!j.isUser()||k.isBot())&&(h?i=k.isLid()?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow():i=k))}}else{h=Boolean(b.fromMe);j=J(b.remoteJid);if(b.fromMe===!0){if(j instanceof c("WAWebWid")&&!(j.isUser()||j.isNewsletter())){k=c("WAWebIsCagGroupCache").isCag(j);k=k&&f!==d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon;k=k||!((f=e.author)!=null&&f.isLid())?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():d("WAWebUserPrefsMeUser").getMeLidUserOrThrow();i=k}}else i=J(b.participant)}e.type===d("WAWebMsgType").MSG_TYPE.REACTION&&j!=null&&(j instanceof c("WAWebWid")&&j.isBroadcast()&&!j.isStatus()||d("WAJids").interpretAndValidateJid(j.toString()).jidType==="broadcast")&&(j=J(b.participant),i=void 0);return new(c("WAWebMsgKey"))({id:a,fromMe:h,remote:j,participant:i})}function Q(a){return a==null||a===""||d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.ANDROID?a:d("WAWebConvertToTextWithoutSpecialEmojis").convertToTextWithoutSpecialEmojis(a)}function R(a){var b={fromMe:a.fromMe,id:a.id},c=S(a.remote);a=S(a.participant);d("WATypeUtils").isString(c)&&(b.remoteJid=c);d("WATypeUtils").isString(a)&&(b.participant=a);return b}function S(a){if(a instanceof c("WAWebWid"))return a.toString({legacy:!0});else if(d("WATypeUtils").isString(a))return a.replace(/@c.us$/,"@s.whatsapp.net");return void 0}function T(a){return a!=null&&a!==""?d("WABase64").decodeB64(a):void 0}function U(a){var b=S(a.to);a={fromMe:!0,id:a.id.id};d("WATypeUtils").isString(b)&&(a.remoteJid=b);return a}function V(a,b,c){if(Boolean(b.viewOnce))return;b.directPath==null&&b.staticUrl==null&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["directPath missing from msg type ",""])),a).sendLogs("outgoing-"+a+"-message-missing-direct-path");b.fileSha256==null&&d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["fileSha256 missing from msg type ",""])),a).sendLogs("outgoing-"+a+"-message-missing-file-sha");!c&&b.fileEncSha256==null&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["fileEncSha256 missing from msg type ",""])),a).sendLogs("outgoing-"+a+"-message-missing-file-enc-sha");b.url==null&&b.staticUrl==null&&!c&&d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["url(deprecatedMms3Url) missing from msg type ",""])),a).sendLogs("outgoing-"+a+"-message-missing-mms3-url")}function W(a,b,c){var e,f,g;switch(a){case d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER;break;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:e=d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER;break}if(d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){if(b)switch(b){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS;break;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:f=d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN;break}c!=null&&(g=c)}return{initiator:e,trigger:f,initiatedByMe:g}}function X(a,b){if(a.from==null)return;a=d("WAWebUserPrefsMeUser").isMeAccount(a.from);if(b.initiator==null)return;switch(b.initiator){case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:return d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:return a?d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther;case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:return a?d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe}}function Y(a,b){if(!d("WAWebABProps").getABPropConfigValue("dm_initiator_trigger"))return;a=d("WAWebUserPrefsMeUser").isMeAccount(a.from);var c=b.initiator,e=b.trigger,f=b.initiatedByMe;if(e!=null&&d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&e===d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING)return{disappearingModeTrigger:$(e),initiatedByMe:a?f:!f};if(e!=null&&f!=null)return{disappearingModeTrigger:$(e),initiatedByMe:a?f:!f};if(b.initiator==null)return;if(c!=null)switch(c){case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.CHANGED_IN_CHAT:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings};case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_ME:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:a};case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.BIZ_UPGRADE_FB_HOSTING:case d("WAWebProtobufsE2E.pb").DisappearingMode$Initiator.INITIATED_BY_OTHER:return{disappearingModeTrigger:d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!a}}}function aa(a,b){return Z.apply(this,arguments)}function Z(){Z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebDBGroupsGroupMetadata").getGroupMetadata(b)),e=c==null?void 0:c.disappearingModeInitiatedByMe;c!=null&&a!=null&&c.disappearingModeTrigger===d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups&&a!==d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups&&(void (o==null?void 0:o(b,a)),void d("WAWebBackendApi").frontendFireAndForget("syncEphemeralTriggerCollectionForGroup",{chatId:b,trigger:a}));if(e!=null)return{disappearingModeTrigger:a,disappearingModeInitiatedByMe:e}});return Z.apply(this,arguments)}function $(a){switch(a){case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING:return d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()?d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown}}i=function(a){return a};g.typeAttributeFromProtobuf=p;g.extractCommentTargetIdAndSenderLid=a;g.decryptFailAttributeFromProtobuf=e;g.protobufToMsgKey=f;g.msgKeyToProtobuf=q;g.parseMsgPaymentInfo=r;g.hasUnsupportedCurrency=s;g.isEitherSenderOrReceiverOfPaymentMessage=t;g.shouldParseNFM=u;g.isValidNativeFlowName=v;g.isOrderNativeFlow=w;g.getBizNativeFlowName=x;g.hasUnsupportedButtons=z;g.isInteractiveMessageTypeEnabled=A;g.getInteractiveMessageFieldNameForType=B;g.getInteractiveMessageTypeForProto=C;g.isSupportedInteractiveMessageVersion=D;g.getInteractiveResponseMessageFieldNameForType=E;g.getInteractiveResponseMessageTypeForProto=F;g.isInteractiveResponseMessageTypeEnabled=G;g.getInteractiveResponsePayload=H;g.isQuotedSupported=I;g.decodeJid=J;g.decodeJidAndValidate=K;g.strictDecodeJid=L;g.translateAddonMessageKeyToLocalReference=M;g.translateRegularMessageKeyToLocalReference=N;g.createMsgKeyFromThreadInfo=O;g.translateKeyToLocalReference=P;g.convertToTextWithoutSpecialEmojis=Q;g.encodeKey=R;g.encodeJid=S;g.encodeBytes=T;g.createMessageKey=U;g.validateOutgoingRequiredMediaProperties=V;g.disappearingModeInitiatorToProto=W;g.protoToDisappearingModeInitiator=X;g.protoToDisappearingMode=Y;g.updateDisappearingModeForGroups=aa;g.getMutableMessageProtobuf=i}),98);
__d("WAWebViewOnceGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("view_once_sp_receiver")}function b(){return d("WAWebABProps").getABPropConfigValue("enable_soox_message_receiving")}function c(){return d("WAWebABProps").getABPropConfigValue("enable_soox_message_sending")}g.isViewOnceSunsetEnabled=a;g.isReceivingViewOnceV2Enabled=b;g.isSendingViewOnceV2Enabled=c}),98);
__d("WAWebFutureproofProtoUtils",["WAWebBotGating","WAWebMessageAssociationGatingUtils","WAWebViewOnceGatingUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.viewOnceMessage,c=a.viewOnceMessageV2,e=a.viewOnceMessageV2Extension,f=a.ephemeralMessage,g=a.documentWithCaptionMessage,h=a.groupMentionedMessage,i=a.editedMessage,j=a.pollCreationMessageV4,k=a.pollCreationOptionImageMessage,l=a.associatedChildMessage,m=a.botInvokeMessage,n=a.questionMessage,o=a.questionReplyMessage;a=a.botForwardedMessage;if(h)return h;if(g)return g;if(b)return b;if(d("WAWebViewOnceGatingUtils").isViewOnceSunsetEnabled()){if(c)return c;if(e&&d("WAWebViewOnceGatingUtils").isReceivingViewOnceV2Enabled())return e}if(f)return f;if(i)return i;if(m)return m;if(j)return j;if(k)return k;if(l&&d("WAWebMessageAssociationGatingUtils").isFutureproofAssociatedChildEnabled())return l;if(n)return n;if(o)return o;return a&&d("WAWebBotGating").isRichResponseForwardReceivingEnabled()?a:null}g.maybeGetFutureproofMessage=a}),98);
__d("WAWebBizOrderDetailsParams",["$InternalEnum"],(function(a,b,c,d,e,f){e=b("$InternalEnum")({PIX_STATIC_CODE:"pix_static_code",PIX_DYNAMIC_CODE:"pix_dynamic_code",CARDS:"cards",PAYMENT_GATEWAY:"payment_gateway",PAYMENT_LINK:"payment_link",BOLETO:"boleto",OFFSITE_CARD_PAY:"offsite_card_pay"});b=b("$InternalEnum")({QUICK_REPLY:"quick_reply",CHAT_ATTACHMENT:"chat_attachment"});function a(a){return JSON.parse(a)}function c(a){return JSON.stringify(a)}function d(a){return JSON.stringify(a)}f.PaymentSettingType=e;f.OrderReferral=b;f.parse=a;f.stringify=c;f.stringifyPaymentStatus=d}),66);
__d("WAWebOrderDetails",["WAWebBizOrderDetailsParams","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","filterNulls"],(function(a,b,c,d,e,f,g){function h(a){var b=a==null?void 0:a.value;if(b==null)return;a=(a=a==null?void 0:a.offset)!=null?a:1;return parseFloat(b!=null?b:0)/parseInt(a,10)}function i(a){return a==null?null:c("filterNulls")(a.map(function(a){return(a==null?void 0:a.type)!=null?babelHelpers["extends"]({type:a.type},a.payment_instruction!=null?{paymentInstruction:a.payment_instruction}:{}):null}))}var j=function(){return"custom-item"},k=function(a,b){var c;if(a!=="review_and_pay"&&a!=="payment_info"||b==null)return null;b=d("WAWebBizOrderDetailsParams").parse(b);var e=b.order,f=b.currency,g=b.reference_id,k=b.payment_configuration,l=b.external_payment_configurations,m=b.payment_settings,n=h(b.total_amount);c=(c=e==null?void 0:e.items)!=null?c:[];var o=c.map(function(a){var b,c,d;return{id:(b=(b=a==null?void 0:a.product_id)!=null?b:a==null?void 0:a.retailer_id)!=null?b:"",name:(b=a==null?void 0:a.name)!=null?b:"",amount:h(a==null?void 0:a.amount),quantity:parseInt((b=a==null?void 0:a.quantity)!=null?b:0,10),isCustomItem:(b=a==null?void 0:a.isCustomItem)!=null?b:(a==null||(c=a.retailer_id)==null?void 0:c.indexOf(j()))===0,isQuantitySet:(b=a==null?void 0:a.isQuantitySet)!=null?b:!0,properties:a==null||(d=a.variant_info_list)==null?void 0:d.map(function(b){var a=b.name;b=b.value;return[a,b]})}}),p=o.reduce(function(a,b){return a+b.quantity},0);c=(c=c[0])==null?void 0:c.name;if(a==="payment_info"&&(m==null?void 0:m.length)===1&&m[0].type===d("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE){var q=m[0][d("WAWebBizOrderDetailsParams").PaymentSettingType.PIX_STATIC_CODE];c=q.merchant_name}if(g==null||f==null||n==null)return null;q=h(e==null?void 0:e.shipping);var r=h(e==null?void 0:e.tax),s=h(e==null?void 0:e.discount);e=h(e==null?void 0:e.subtotal);l=i(l);return babelHelpers["extends"]({title:c,referenceId:g,currency:f,quantity:p,shipping:q,tax:r,discount:s,subtotal:e,totalAmount:n,items:o,payment_configuration:k,type:b.type},l!=null?{externalPaymentConfigurations:l}:{},{paymentSettings:m,buttonName:a})};a=function(a){var b;if(a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS&&a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO)return null;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&(b=a.interactivePayload)!=null&&b.buttons){var e=a.interactivePayload.buttons[0],f=e.name;e=e.buttonParamsJson;return k(f,e)}else if(a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW){e=((f=a.nativeFlowButtons)!=null?f:[])[0].nativeFlowInfo;return k(e==null?void 0:e.name,e==null?void 0:e.paramsJson)}};g.getCustomItemIdPrefix=j;g.paramsJsonToOrderInfo=k;g.getOrderInfo=a}),98);
__d("WAWebNativeFlowValidation",["WAWebBizGatingUtils","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebGalaxyFlowFeatureSupport","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderDetails","WAWebOrderPaymentStatus","WAWebOrderStatus","justknobx"],(function(a,b,c,d,e,f,g){function a(a,b,e,f){if(a.nativeFlowName==null)return!1;switch(a.nativeFlowName){case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO:return d("WAWebOrderDetails").getOrderInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS:return d("WAWebOrderDetails").getOrderInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS:return d("WAWebOrderStatus").getOrderStatusInfo(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS:return d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD:return d("WAWebOrderPaymentStatus").getOrderPaymentStatusInfoFromNativeFlow(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK:return h(a)!==!1;case c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK_STATUS:return d("WAWebBizGatingUtils").isMessageWithLinkNfmEnabled();case c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_URL:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_URL,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE:return d("WAWebBizTemplateAndInteractiveMessagesUtils").isInteractiveCtaMessageEnabled(c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE,e,b)&&i(a)!=null;case c("WAWebInteractiveMessagesNativeFlowName").MIXED:return c("justknobx")._("4952");case c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW:return d("WAWebGalaxyFlowFeatureSupport").isFlowSupported(a,null,f)}return!1}function h(a){if(d("WAWebBizGatingUtils").isMessageWithLinkNfmEnabled()){if(a.nativeFlowName!==c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK||a.type!==d("WAWebMsgType").MSG_TYPE.INTERACTIVE||a.interactiveType!==c("WAWebInteractiveMessageType").NATIVE_FLOW||a.interactivePayload==null)return!1;a=a.interactivePayload;if(a!=null&&a.buttons&&a.buttons.length>0){a=a.buttons[0];var b=a.name;a=a.buttonParamsJson;if(b==="open_webview"&&a!=null)return!0}}return!1}function i(a){var b;a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&a.nativeFlowName!=null&&d("WAWebBizTemplateAndInteractiveMessagesUtils").supportedNativeFlowButtonNamesForInteractiveMsg.includes(a.nativeFlowName)&&((b=a.interactivePayload)==null?void 0:b.buttons)!=null&&a.interactivePayload.buttons.forEach(function(a){a=j(a);if(a)return!0});return!1}function j(a){a=d("WAWebBizTemplateAndInteractiveMessagesUtils").getNativeFlowNameByButtonName(a.name);return a!=null&&d("WAWebBizTemplateAndInteractiveMessagesUtils").supportedNativeFlowButtonNamesForInteractiveMsg.includes(a)}g.isValidNativeFlowMessage=a}),98);
__d("WAWebParseNonNFMButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo;a=a.msgContext;b=b.buttonsMessage;if(b==null)return;var g=b.buttons;g=g===void 0?[]:g;var h=b.headerType,i=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({buttonsMessage:b}));if(i!=null||(f==null?void 0:f.nativeFlowName)!=null)return;if(d("WAWebE2EProtoUtils").hasUnsupportedButtons(g))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};if(h===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.UNKNOWN||!new Set(d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.members()).has(h))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown}),contextInfo:b.contextInfo};i=d("WAWebButtonsMessageProtoUtils").parseButtonsMessageProto({buttonsMessage:b,baseMessage:e,msgContext:a});return g.length?{msgData:babelHelpers["extends"]({},i,{isDynamicReplyButtonsMsg:!0,dynamicReplyButtons:g}),contextInfo:b.contextInfo}:{msgData:i,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebWamEnumBlockEntryPoint",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,CHAT:1,PROFILE:2,BLOCK_LIST:3,TRIGGERED_BLOCK:4,ACCOUNT_INFO:5,CALL_LOG:6,OVERFLOW_MENU:7,GROUP_INFO:8,BLOCK_DIALOG:9,MESSAGE_MENU:10,MEDIA_VIEWER:11,OVERFLOW_MENU_BLOCK:12,ONE_TO_ONE_OLD_SPAM_BANNER_BLOCK:13,ONE_TO_ONE_SPAM_BANNER_BLOCK:14,BIZ_SPAM_BANNER_BLOCK:15,BLOCK_HEADER_CHAT:16,OVERFLOW_MENU_REPORT:17,ACCOUNT_INFO_REPORT:18,BIZ_OLD_SPAM_BANNER_BLOCK:19,CHAT_LIST_BLOCK:20,CHAT_LIST_NOINSUB_BLOCK:21,CHAT_LIST_CONTEXT_MENU_BLOCK:22,NOTIFICATION_BLOCK:23,ONE_TO_ONE_SPAM_BANNER_REPORT:24,BIZ_EXTENSION_MENU:25,VIEW_ONCE_VIEWER:26,STATUS_OVERFLOW_MENU_REPORT:27,ALBUM_MEDIA_MENU_REPORT:28,STATUS_POST_REPORT:29,MISSED_CALL_NOTIFICATION_BLOCK:30,CHAT_FMX_CARD_BLOCK:31,CHAT_FMX_CARD_BLOCK_SUSPICIOUS:32,CHAT_FMX_CARD_SAFETY_TOOLS_BLOCK:33,CHAT_FMX_CARD_SAFETY_TOOLS_BLOCK_SUSPICIOUS:34,CHAT_FMX_CARD_SAFETY_TOOLS_REPORT:35,CHAT_FMX_CARD_SAFETY_TOOLS_REPORT_SUSPICIOUS:36,ACCOUNT_INFO_BLOCK:37,CALL_LOG_BLOCK:38,BIZ_BLOCK_HEADER_CHAT:39,BIZ_OVERFLOW_MENU_BLOCK:40,PSA_BANNER_BLOCK:41,COMMENT_ACTIONS_BOTTOM_SHEET:42,CALL_SPAM_DIALOG_REPORT:43,CALL_SPAM_DIALOG_BLOCK:44,BIZ_ACCOUNT_INFO_BLOCK:45,BIZ_BLOCK_LIST:46,BIZ_CALL_LOG_BLOCK:47,ONGOING_CALL_LINK_BLOCK:48,ONE_TO_ONE_BLOCKED_CHAT_COMPOSER:49,CHAT_MORE_OPTIONS:50,CHAT_LONG_PRESS_OPTIONS:51,IAB_MENU_REPORT:52});f.BLOCK_ENTRY_POINT=a}),66);
__d("WAWebWamEnumMmSignalType",[],(function(a,b,c,d,e,f){a=Object.freeze({USER_BLOCK:0,USER_REPORT:1,FIRST_CUSTOMER_MESSAGE:2,FIRST_CUSTOMER_MESSAGE_CONTINUATION:3,FIRST_BIZ_REPLY:4,FIRST_BIZ_REPLY_CONTINUATION:5,SECOND_CUSTOMER_MESSAGE:6,SECOND_CUSTOMER_MESSAGE_CONTINUATION:7,SECOND_BIZ_REPLY:8,SECOND_BIZ_REPLY_CONTINUATION:9,THIRD_CUSTOMER_MESSAGE:10,THIRD_CUSTOMER_MESSAGE_CONTINUATION:11,THIRD_BIZ_REPLY:12,USER_INTERESTED:13,USER_NOT_INTERESTED:14,USER_STOP_OFFERS:15,USER_BLOCK_REASON_NO_LONGER_NEEDED:16,USER_BLOCK_REASON_NO_SIGN_UP:17,USER_BLOCK_REASON_SPAM:18,USER_BLOCK_REASON_OFFENSIVE_MESSAGES:19,USER_BLOCK_REASON_OTP_DID_NOT_REQUEST:20,USER_BLOCK_REASON_OTHER:21,USER_MUTE:22});f.MM_SIGNAL_TYPE=a}),66);
__d("WAWebMmSignalSharingGatingUtils",["WALogger","WAWebABProps","WAWebWamEnumBlockEntryPoint","WAWebWamEnumMmSignalType"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){return d("WAWebABProps").getABPropConfigValue("mm_data_sharing_disclosure_enabled")}function a(){return!k()?0:d("WAWebABProps").getABPropConfigValue("data_sharing_transparency_indicator_duration")}function b(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("ctwa_tos_filtering_enabled")}function c(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("disclosure_for_the_marketing_message_body_links_enabled")}function e(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("mm_signal_sharing_collection_window_logging_enabled")}function l(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("optimized_delivery_signal_collection_enabled")}function f(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("optimized_delivery_signal_collection_on_companions_enabled")}function m(){var a={store_consented_token_enabled:!1,store_non_consented_token_enabled:!1};if(!k())return a;try{return JSON.parse(d("WAWebABProps").getABPropConfigValue("optimized_delivery_tokens_storage_config"))}catch(b){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["wa:mmSignalSharing failed to parse optimized_delivery_tokens_storage_config ABProp, falling back to default config. Raw value: "," Error: ",""])),d("WAWebABProps").getABPropConfigValue("optimized_delivery_tokens_storage_config"),b);return a}}function n(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("shimmed_links_in_the_marketing_message_body_enabled")}function o(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("optimized_delivery_multiple_collection_windows_enabled")}function p(){var a=168,b=Object.keys(d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE).map(function(a){return d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE[a]});a={consented_collection_window_in_hours:a,non_consented_collection_window_in_hours:a,consented_types_allowlist:b,non_consented_types_allowlist:b};if(!k())return a;try{return JSON.parse(d("WAWebABProps").getABPropConfigValue("optimized_delivery_signal_collection_config"))}catch(b){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["wa:mmSignalSharing error fetching optimized_delivery_signal_collection_config ABProp: ",""])),b);return a}}function q(){return!k()?!1:d("WAWebABProps").getABPropConfigValue("mm_signal_sharing_verification_system_lid_enabled")}function r(){return k()&&l()}function s(){var a=Object.values(d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT).map(Number);if(!k())return a;try{return d("WAWebABProps").getABPropConfigValue("optimized_delivery_block_and_report_entry_points_allowlist_web").split(",").filter(function(a){return!isNaN(a)}).map(Number)}catch(b){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["wa:mmSignalSharing error fetching optimized_delivery_block_and_report_entry_points_allowlist_web ABProp: ",""])),b);return a}}g.isMmSignalSharingDisclosureEnabled=k;g.getMmSignalSharingCollectionWindow=a;g.getMmSignalSharingTosFiltering=b;g.isMmSignalSharingDisclosureForMarketingMessageBodyLinksEnabled=c;g.getMmSignalSharingCollectionWindowLoggingEnabled=e;g.getMmSignalSharingOptimizedDeliverySignalCollectionEnabled=l;g.getMmSignalSharingOptimizedDeliverySignalCollectionOnCompanionsEnabled=f;g.getMmSignalSharingOptimizedDeliveryTokensStorageConfig=m;g.getMmSignalSharingShimmedLinksInTheMarketingMessageBodyEnabled=n;g.isMmSignalSharingOptimizedDeliveryMultipleCollectionWindowsEnabled=o;g.getMmSignalSharingOptimizedDeliverySignalCollectionConfig=p;g.getMmSignalSharingVerificationSystemLidEnabled=q;g.isMmSignalSharingCollectionEnabled=r;g.getMmSignalSharingBlockAndReportEntryPointsAllowlist=s}),98);
__d("WAWebMmSignalSharingContextInfo",["WAWebMmSignalSharingGatingUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b;return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?null:a==null||(b=a.dataSharingContext)==null?void 0:b.showMmDisclosure}function a(a){return h(a)!=null}function i(a){var b;return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?null:a==null||(b=a.urlTrackingMap)==null?void 0:b.urlTrackingMapElements}function b(a){return i(a)!=null}g.getMmSignalSharingContextInfoDisclosureFlag=h;g.existsMmSignalSharingContextInfoDisclosureFlag=a;g.getMmSignalSharingURlTrackingMapElements=i;g.existsMmSignalSharingURlTrackingMapElements=b}),98);
__d("WAWebParseTemplateMessageProto",["WANullthrows","WAWebBizTemplateAndInteractiveMessagesUtils","WAWebE2EProtoUtils","WAWebMmSignalSharingContextInfo","WAWebMmSignalSharingGatingUtils","WAWebMsgType","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseInteractiveMessageProto","WAWebParseLocationMessageProto","WAWebParseVideoMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.msgContext;a=a.bizInfo;b=b.templateMessage;if(b==null)return;if(f==="relay"&&(a==null?void 0:a.verifiedHsmEnvelope)!==!0)return;var g=b.interactiveMessageTemplate;if(g)return h(e,f,b,a);a=(g=b.hydratedTemplate)!=null?g:c("WANullthrows")(b.hydratedFourRowTemplate);var i=a.documentMessage,j=a.imageMessage,k=a.locationMessage,l=a.videoMessage;g=a.hydratedButtons;var m=a.hydratedContentText;b=a.hydratedFooterText;var n=a.hydratedTitleText;a=a.templateId;var o=function(){var a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat},Boolean(m)&&{body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(m)});if(j){var b;return(b=(b=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:j},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(i){return(b=(b=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:i},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(k){return(b=(b=c("WAWebParseLocationMessageProto")({messageProtobuf:{locationMessage:k},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}if(l){return(b=(b=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:l},baseMessage:e,msgContext:f}))==null?void 0:b.msgData)!=null?b:a}return a};if(d("WAWebBizTemplateAndInteractiveMessagesUtils").buttonsViolateButtonImprovementsConstraints(g.map(function(a){return{hydratedTemplateButton:a}})))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:void 0};o=o();return{msgData:babelHelpers["extends"]({},o,{templateId:a,isFromTemplate:!0,caption:Boolean(m)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(m):o.caption,footer:Boolean(b)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b):o.footer,title:Boolean(n)?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(n):o.title},g.length>0&&{hydratedButtons:g}),contextInfo:void 0}}function h(a,b,e,f){var g,h,i=e.interactiveMessageTemplate,j=e.templateId;e=e.contextInfo;var k=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat},Boolean(i==null||(g=i.body)==null?void 0:g.text)&&{body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(i==null||(h=i.body)==null?void 0:h.text)});a=(b=(i=c("WAWebParseInteractiveMessageProto")({messageProtobuf:{interactiveMessage:i},baseMessage:a,msgContext:b,bizSource:a.bizSource||"",bizInfo:f}))==null?void 0:i.msgData)!=null?b:k;return{msgData:babelHelpers["extends"]({},a,{templateId:j,isFromTemplate:!0,caption:a.caption,footer:a.footer,title:a.title}),contextInfo:d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()&&(d("WAWebMmSignalSharingContextInfo").existsMmSignalSharingContextInfoDisclosureFlag()||d("WAWebMmSignalSharingContextInfo").existsMmSignalSharingURlTrackingMapElements()!=null)?e:void 0}}g["default"]=a}),98);
__d("WAWebQuotedMessageProtoUtils",["WALogger","WAWebE2EProtoParser","WAWebMsgType"],(function(a,b,c,d,e,f,g){var h;function i(a){var b=a.quotedMsg,c=a.msgContext;a=a.isCarouselCardReply;return d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:b,message:{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN},msgContext:c==="history"?"history_quoted":"quoted",bizSource:a?"quoted_carousel_card":null})}function a(a){try{return i(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["failed parsing quoted message: ",""])),a).sendLogs("parse-quoted-msg-error");return null}}g.parseQuotedMessage=a}),98);
__d("WAWebApiActiveMessageRanges",["Promise","WALogger","WANullthrows","WASyncAction.pb","WAWebDBMsgUtils","WAWebSchemaActiveMessageRanges","asyncToGeneratorRuntime","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){var h,i,j=new Map(),k={reset:function(){j=new Map()},removeRange:function(a,b){var c;(c=j.get(a))==null||c["delete"](b);return d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().remove([a,b])},createOrReplaceRange:function(a){var b=j.get(a.chatId);b==null&&(b=new Map(),j.set(a.chatId,b));b.set(a.action,a);return d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().createOrReplace(a)},bulkCreateOrReplaceRanges:function(a,c){c===void 0&&(c=!0);a.forEach(function(a){var b=j.get(a.chatId);b==null&&(b=new Map(),j.set(a.chatId,b));b.set(a.action,a)});return c?d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().bulkCreateOrReplace(a):(i||(i=b("Promise"))).resolve()},getRangesForChat:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=j.get(a);try{if(b==null){var c=(yield d("WAWebSchemaActiveMessageRanges").getActiveMessageRangesTable().anyOf(["chatId"],[a]));b=new Map(c.map(function(a){return[a.action,a]}));j.set(a,b)}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getRangesForChat failed with error: ",""])),a)}return b?Array.from(b.values()):[]});function c(b){return a.apply(this,arguments)}return c}()};function l(a,b){switch(a){case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive,actionValue:c("WANullthrows")(b.archiveChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead,actionValue:c("WANullthrows")(b.markChatAsReadAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia,actionValue:c("WANullthrows")(b.clearChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia,actionValue:c("WANullthrows")(b.deleteChatAction)};case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:return{action:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia,actionValue:c("WANullthrows")(b.deleteChatAction)};default:throw c("err")("unsupported action for message ranges: "+String(a))}}function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,c);var e=l(b,c);e=e.actionValue;e=((e=e.messageRange)==null?void 0:e.messages)||[];var f=(yield d("WAWebDBMsgUtils").filterReceivedMessagesInRange(a,e));e=Math.max(0,e.length-f.length);return k.createOrReplaceRange(babelHelpers["extends"]({chatId:a},l(b,c),{remainingMessages:e}))});return m.apply(this,arguments)}function e(a,b){return k.removeRange(a,b)}function f(a,b){b===void 0&&(b=!0);return k.bulkCreateOrReplaceRanges(a,b)}function n(a){return k.getRangesForChat(a)}function o(a,b){var e=Boolean(b==null?void 0:b.deleteStarred);b=Boolean(b==null?void 0:b.deleteMedia);switch(a){case"archive":return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive;case"markChatAsRead":return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead;case"clearChat":if(e&&b)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia;else if(e&&!b)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia;else if(b&&!e)return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia;return d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia;case"deleteChat":return b?d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia;default:throw c("err")("unsupported active message range action")}}g._cache=k;g.addActiveMessageRange=a;g.removeActiveMessageRange=e;g.bulkUpdateActiveMessageRanges=f;g.getActiveMessageRanges=n;g.getActiveRangeAction=o}),98);
__d("WAWebProtobufsMdStorageChatRowOpaqueData.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,IMAGE:1,VIDEO:2});c={};e={};f={};b={};c.name="ChatRowOpaqueData";c.internalSpec={draftMessage:[1,(d=d("WAProtoConst")).TYPES.MESSAGE,e]};e.name="ChatRowOpaqueData$DraftMessage";e.internalSpec={text:[1,d.TYPES.STRING],omittedUrl:[2,d.TYPES.STRING],ctwaContextLinkData:[3,d.TYPES.MESSAGE,b],ctwaContext:[4,d.TYPES.MESSAGE,f],timestamp:[5,d.TYPES.INT64]};f.name="ChatRowOpaqueData$DraftMessage$CtwaContextData";f.internalSpec={conversionSource:[1,d.TYPES.STRING],conversionData:[2,d.TYPES.BYTES],sourceUrl:[3,d.TYPES.STRING],sourceId:[4,d.TYPES.STRING],sourceType:[5,d.TYPES.STRING],title:[6,d.TYPES.STRING],description:[7,d.TYPES.STRING],thumbnail:[8,d.TYPES.STRING],thumbnailUrl:[9,d.TYPES.STRING],mediaType:[10,d.TYPES.ENUM,a],mediaUrl:[11,d.TYPES.STRING],isSuspiciousLink:[12,d.TYPES.BOOL]};b.name="ChatRowOpaqueData$DraftMessage$CtwaContextLinkData";b.internalSpec={context:[1,d.TYPES.STRING],sourceUrl:[2,d.TYPES.STRING],icebreaker:[3,d.TYPES.STRING],phone:[4,d.TYPES.STRING]};g.ChatRowOpaqueData$DraftMessage$CtwaContextData$ContextInfoExternalAdReplyInfoMediaType=a;g.ChatRowOpaqueDataSpec=c;g.ChatRowOpaqueData$DraftMessageSpec=e;g.ChatRowOpaqueData$DraftMessage$CtwaContextDataSpec=f;g.ChatRowOpaqueData$DraftMessage$CtwaContextLinkDataSpec=b}),98);
__d("WAWebDBChatSerialization",["WAWebProtobufsMdStorageChatRowOpaqueData.pb","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h=["draftMessage"];function a(a){a=babelHelpers["extends"]({},a);i(a);return a}function i(a){var b=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsMdStorageChatRowOpaqueData.pb").ChatRowOpaqueDataSpec,a.chatRowOpaqueData);h.forEach(function(c){(b==null?void 0:b[c])!=null&&(a[c]=b==null?void 0:b[c])})}function b(a){a=babelHelpers["extends"]({},a);j(a);return a}function j(a){var b={};h.forEach(function(c){b[c]=a[c],delete a[c]});var c=d("encodeProtobuf").encodeProtobuf(d("WAWebProtobufsMdStorageChatRowOpaqueData.pb").ChatRowOpaqueDataSpec,b);a.chatRowOpaqueData=c.readBuffer()}g.deserializeChat=a;g.serializeChat=b}),98);
__d("WAWebEphemeralityUtils",["WAWebEphemeralityTypes","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return 1;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return 3;default:return null}}function b(a,b){return b==null?a>0?1:null:a===b?2:1}function c(a){switch(a){case 1:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case 2:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case 3:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;default:return null}}function e(a){switch(a){case"1":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case"2":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case"3":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;default:return null}}function f(a){switch(a){case"chat_settings":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case"account_settings":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case"bulk_change":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case"biz_supports_fb_hosting":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting;case"unknown_groups":return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;case"unknown":default:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown}}function h(a){switch(a){case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.CHAT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.ACCOUNT_SETTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BULK_CHANGE:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.BIZ_SUPPORTS_FB_HOSTING:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting;case d("WAWebProtobufsE2E.pb").DisappearingMode$Trigger.UNKNOWN_GROUPS:return d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;default:return}}g.getGroupEphemeralTrigger=a;g.getEphemeralTriggerForGroupCreation=b;g.getDisappearingModeTrigger=c;g.getDisappearingModeTriggerString=e;g.getDisappearingModeTriggerFromString=f;g.getDisappearingModeTriggerFromProtobuf=h}),98);
__d("WAWebApiChat",["Promise","WALogger","WATimeUtils","WAWeb-dexie","WAWebAck","WAWebBackendApi","WAWebBusinessHSMTypes","WAWebChatThreadLogging","WAWebDBChatSerialization","WAWebDBMsgUtils","WAWebEphemeralityUtils","WAWebLidMigrationUtils","WAWebMiscErrors","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgType","WAWebSchemaChat","WAWebSchemaMessage","WAWebTrustedContactsUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="CreateChatDuplicateError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));function a(a,b){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord ",""])),a.toLogString());try{yield d("WAWebSchemaChat").getChatTable().create(babelHelpers["extends"]({id:a.toString()},b))}catch(e){if(e instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw e;d("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: create chat table failed"]))).verbose().devConsole(e);if(e instanceof c("WAWeb-dexie").ConstraintError){yield ea(a,b);throw new K()}throw c("err")("create chat table failed")}});return L.apply(this,arguments)}function e(a){return M.apply(this,arguments)}function M(){M=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield d("WAWebSchemaChat").getChatTable().get(a.toString(),!1));if(e)return{unreadCount:e.unreadCount,timestamp:e.t};d("WALogger").ERROR(D||(D=babelHelpers.taggedTemplateLiteralLoose(["chat with id "," is not found"])),a.toString());return(J||(J=b("Promise"))).reject(c("err")("Failed to find row in chat table"))});return M.apply(this,arguments)}function f(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateChatForMarkAsReadSync"])));return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.get(a));if(c==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["updateMarkChatAsReadSync: could not find chat with id ",""])),a);return}if(c.unreadCount===-1){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["updateMarkChatAsReadSync: createOrMerge"])));return b.createOrMerge(a,{id:a,unreadCount:0,unreadMentionsOfMe:[],unreadMentionCount:0})}});return function(a){return c.apply(this,arguments)}}())}function N(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["latestChatBulkUpdates: bulkCreateOrMerge"]))).tags("missing-lid");return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a)}function O(a){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateChatLastAddOnPreview: bulkCreateOrMerge"]))).tags("missing-lid");a=Array.from(a).map(function(a){var b=a[0];a=a[1];return{id:b,chatlistPreview:a,lastReactionPreview:void 0}});return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(a)}function P(a){return Q.apply(this,arguments)}function Q(){Q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaMessage").getMessageTable().equals(["from","pendingReadReceipt"],[a,d("WAWebDBMsgUtils").PendingReadReceiptType.Message],{shouldDecrypt:!1}));return a.filter(function(a){return a.type!==d("WAWebMsgType").MSG_TYPE.UNKNOWN})});return Q.apply(this,arguments)}function R(a,c,e){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: "]))).devConsole("lastReadRowId: "+(a!=null?a:"")+", chatId: "+c+", keepChatUnread: "+e.toString());return d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f){f[0];f=f[1];var g=(yield P(c)),h=[],i=0,j=[];g.forEach(function(b){b.hsmTag===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION&&d("WAWebBackendApi").frontendFireAndForget("logOTPMessageReadActions",{msgRow:b});if(a==null||b.rowId!=null&&b.rowId>a){i++;if(d("WAWebMsgGetters").getIsImportantMessage(b)){var c={id:b.id,timestamp:b.t};j.push(c)}return}h.push({id:b.id,ack:Math.max(b.ack,d("WAWebAck").ACK.READ),pendingReadReceipt:null})});g=i===0&&e?-1:i;d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: chatId: ",", update unread to ",""])),c,g);f=[f.merge(c,{id:c,unreadCount:g,unreadDividerOffset:0,unreadMentionsOfMe:j,unreadMentionCount:0})];h.length>0&&(d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: chatId: ",", update acks for "," messages"])),c,h.length),d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["markMessageAndChatAsRead: bulkCreateOrMerge"]))).tags("missing-lid"),f.push(d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(h).then(function(){return d("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging([{activityType:"msgRead",ts:d("WATimeUtils").unixTime(),chatId:d("WAWebWidFactory").createWid(c),readCount:h.length}])})));yield (J||(J=b("Promise"))).all(f)});return function(a){return f.apply(this,arguments)}}())}function S(a,c){d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["addUnreadMentionChat"])));return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=Array.from(a.keys());if(b.length===0)return;b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));if(!b||b.length===0){d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["addUnreadMentionChat: could not find chats"])));return}var e=[];b.forEach(function(b){if(b){var d=b.id.toString();b=(b=b.unreadMentionsOfMe)!=null?b:[];var f=a.get(d);f&&(b=b.concat(f));f={id:d,unreadMentionsOfMe:b};if(c){var g;g=(g=c.get(d))!=null?g:0;f={id:d,unreadMentionsOfMe:b,unreadMentionCount:g}}e.push(f)}});d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["addUnreadMentionChat: bulkCreateOrMerge"]))).tags("missing-lid");return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(e)});return function(a){return e.apply(this,arguments)}}())}function T(a){d("WALogger").LOG(t||(t=babelHelpers.taggedTemplateLiteralLoose(["removeUnreadMentionChat"])));return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=Array.from(a.keys());if(b.length===0)return;b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));if(!b||b.length===0){d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["removeUnreadMentionChat: could not find chats"])));return}var c=[];b.forEach(function(b){if(b){var d;d=(d=b.unreadMentionsOfMe)!=null?d:[];var e=a.get(b.id.toString());e&&(d=d.filter(function(a){return!e.includes(a.id)}));c.push({id:b.id.toString(),unreadMentionsOfMe:d})}});d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["removeUnreadMentionChat: bulkCreateOrMerge"]))).tags("missing-lid");return d("WAWebSchemaChat").getChatTable().bulkCreateOrMerge(c)});return function(a){return c.apply(this,arguments)}}())}function U(a){d("WALogger").LOG(w||(w=babelHelpers.taggedTemplateLiteralLoose(["updateChatArchiveDrawer"])));return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(c){c=c[0];var e=Array.from(a.keys());if(e.length===0)return(J||(J=b("Promise"))).resolve();e=e.map(function(b){var c;c=(c=a.get(b))!=null?c:!1;return{id:b,archiveAtMentionViewedInDrawer:c}});d("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["updateChatArchiveDrawer: bulkCreateOrMerge"]))).tags("missing-lid");return c.bulkCreateOrMerge(e)})}function V(a,c,e){c===void 0&&(c=1);e===void 0&&(e=!0);return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var f=(yield b.get(a));if(f==null){d("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["reduceChatUnreadCount: could not find chat with id ",""])),a);return}var g=Math.max(f.unreadCount-c,0);f=(f=f.unreadDividerOffset)!=null?f:0;e&&(f+=c);return b.merge(a,{unreadCount:g,unreadDividerOffset:f})});return function(a){return f.apply(this,arguments)}}())}function W(){d("WALogger").LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredTcTokens"])));var a=d("WAWebTrustedContactsUtils").tokenExpirationCutoff(d("WAWebTrustedContactsUtils").TcTokenMode.Receiver);return d("WAWebModelStorageUtils").getStorage().lock(["chat"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.lessThan(["tcTokenTimestamp"],a));if(!c||c.length===0)return;c=c.map(function(a){return{id:a.id,tcToken:null,tcTokenTimestamp:null}});d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["pruneExpiredTcTokens: bulkCreateOrMerge"]))).tags("missing-lid");return b.bulkCreateOrMerge(c)});return function(a){return c.apply(this,arguments)}}())}function X(){var a=d("WAWebTrustedContactsUtils").tokenExpirationCutoff(d("WAWebTrustedContactsUtils").TcTokenMode.Receiver),c=[];return d("WAWebModelStorageUtils").getStorage().lock(["orphan-tc-token"],function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var d=(yield b.all());d.forEach(function(b){var d=b.tcTokenTimestamp;d!=null&&d<a&&c.push(b.chatId)});return b.bulkRemove(c)});return function(a){return d.apply(this,arguments)}}())}function aa(a){return d("WAWebSchemaChat").getChatTable().get(a.toString(),!1)}function Y(a){return d("WAWebSchemaChat").getChatTable().anyOf(["accountLid"],[a.toString()])}function ba(a){return d("WAWebSchemaChat").getChatTable().bulkGet(a.map(function(a){return a.toString()}))}function ca(){return d("WAWebSchemaChat").getChatTable().all().then(function(a){return a.map(function(a){return d("WAWebDBChatSerialization").deserializeChat(a)})})}function da(a){return Z.apply(this,arguments)}function Z(){Z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return a.id.toString()}),c=(yield d("WAWebSchemaChat").getChatTable().bulkGet(b));b=a.map(function(a,b){a=a;if(c[b]!=null){b=c[b];var e=b.disappearingModeInitiatedByMe;b=b.disappearingModeTrigger;e!=null&&(a=babelHelpers["extends"]({},a,{disappearingModeInitiatedByMe:e}));b!=null&&(a=babelHelpers["extends"]({},a,{disappearingModeTrigger:d("WAWebEphemeralityUtils").getDisappearingModeTriggerFromString(b)}))}return a});return b});return Z.apply(this,arguments)}function ea(a,b){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{if(d("WAWebLidMigrationUtils").shouldHaveAccountLid(a)){d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: tried to create chat ",""])),a.toLogString()).tags("missing-lid");if(b.accountLid!=null){a=d("WAWebWidFactory").createUserLidOrThrow(b.accountLid);b=(yield Y(a));b.length===0?d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: no chat with the same accountLid ",""])),a.toLogString()).tags("missing-lid"):d("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: found chat with the same accountLid ",". chat id: ",""])),a.toLogString(),d("WAWebWidFactory").createWid(b[0].id).toLogString()).tags("missing-lid")}}else d("WALogger").LOG(H||(H=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: no account lid provided"]))).tags("missing-lid")}catch(a){d("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["createChatRecord: failed debugging duplicate record"]))).tags("missing-lid")}});return $.apply(this,arguments)}g.CreateChatDuplicateError=K;g.createChatRecord=a;g.getChatMeta=e;g.updateChatForMarkAsReadSync=f;g.latestChatBulkUpdates=N;g.bulkUpdateChatLastAddOnPreview=O;g.queryPendingReadReceiptMsgRows=P;g.markMessageAndChatAsRead=R;g.addUnreadMentionChat=S;g.removeUnreadMentionChat=T;g.updateChatArchiveDrawer=U;g.reduceChatUnreadCount=V;g.pruneExpiredTcTokens=W;g.pruneExpiredOrphanTcTokens=X;g.getChatRecord=aa;g.getChatRecordByAccountLid=Y;g.bulkGetChats=ba;g.getAllChatsDeserialized=ca;g.injectAdditionalEphemeralInfoFromDB=da}),98);
__d("WAWebApiFilterAndReplaceMessages",["WALogger","WAWebApiOrphanRevoke","WAWebLidMigrationUtils","WAWebMessageAssociationGatingUtils","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return function(b){return b.associationType!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()?a.get(b.id.toString()):b}}function e(a,b){var c=[];a.forEach(function(a){if(a!=null)if(b){var d=b(a);d&&c.push(d)}else c.push(a)});return c}function f(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebApiOrphanRevoke").getOrphansRevokesCache()),f=[],g=[];a.forEach(function(a){var i=a.id.toString(),j=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id);i=(i=e.get(i))!=null?i:j&&e.get(j.toString());if(i)d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["filterAndReplaceMessages: found orphan revoke for message id: ",""])),a.id.id),c("WAWebWid").isStatus(a.id.remote)||g.push(d("WAWebApiOrphanRevoke").createRevokeMsgFromOrphanRevoke(a,i)),f.push(i);else if(b){j=b(a);j&&g.push(j)}else g.push(a)});void d("WAWebApiOrphanRevoke").bulkRemoveOrphansUsingOrphansCache(f);return{newMsgs:g}});return i.apply(this,arguments)}g.validateMsgFn=a;g.filterAndReplaceMessagesInitialHistorySync=e;g.filterAndReplaceMessages=f}),98);
__d("WAWebApiMessageInfoStore",["WAJids","WALogger","WAWebAck","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebSchemaMessage","WAWebSchemaMessageInfo","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m=[d("WAWebAck").ACK_STRING.PLAYED,d("WAWebAck").ACK_STRING.READ,d("WAWebAck").ACK_STRING.DELIVERY],n=Object.freeze({ELIGIBLE:"ELGIBLE",INELIGIBLE_RECORD_MISSING:"INELIGIBLE_RECORD_MISSING",INELIGIBLE_ALREADY_DELIVERED:"INELIGIBLE_ALREADY_DELIVERED",INELIGIBLE_NOT_MD:"INELIGIBLE_NOT_MD",INELIGIBLE_CHANGED_IDENTITY:"INELIGIBLE_CHANGED_IDENTITY"});function a(a){var c=new Map();a.forEach(function(a){var b=a.msgKey;a=a.receiverId;var e=d("WAWebWidFactory").asUserWidOrThrow(a).toString();b=b.toString();var f=b+","+e;a=(a=a.device)!=null?a:d("WAJids").DEFAULT_DEVICE_ID;var g=c.get(f);!g?c.set(f,{msgKey:b,receiverUserJid:e,deviceDelivered:[],deviceNotDelivered:[a]}):g.deviceNotDelivered.push(a)});return d("WAWebModelStorageUtils").getStorage().lock(["message-info"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=Array.from(c.values()).map(function(a){return[a.msgKey,a.receiverUserJid]});a=(yield a.anyOf(["msgKey","receiverUserJid"],b));a.forEach(function(a){var b=a.msgKey+","+a.receiverUserJid,d=c.get(b);d&&c.set(b,babelHelpers["extends"]({},a,{deviceNotDelivered:[].concat(a.deviceNotDelivered,d.deviceNotDelivered)}))});return d("WAWebSchemaMessageInfo").getMessageInfoTable().bulkCreateOrReplace(Array.from(c.values()))});return function(b){return a.apply(this,arguments)}}())}function e(a,b,c,e){var f=d("WAWebWidFactory").asUserWidOrThrow(b).toString(),g=b.device||0;return d("WAWebSchemaMessageInfo").getMessageInfoTable().get([a.toString(),f]).then(function(l){if(!l){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: missing record for ",", ",""])),a.toString(),f);return n.INELIGIBLE_RECORD_MISSING}else if(l.deviceNotDelivered.includes(g)){if(c!=null&&e>=c)return n.ELIGIBLE;if(b.device!=null&&b.device!==d("WAJids").DEFAULT_DEVICE_ID){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":",": companion identity changed"])),a.toString(),f,g);return n.INELIGIBLE_CHANGED_IDENTITY}else if(l.delivery!=null){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":",": primary identity change after message has been delivered"])),a.toString(),f,g);return n.INELIGIBLE_CHANGED_IDENTITY}return n.ELIGIBLE}d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["MessageInfoStore: ",", ",":"," has been delivered"])),a.toString(),f,g);return n.INELIGIBLE_ALREADY_DELIVERED})}function f(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield p([a]));b=b.get(a.toString());if(!b)throw c("err")("No message info found for "+a.toString());return b});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(function(a){return a.toString()}))),e=new Map(),f=new Map();for(var g=0;g<a.length;g++){var h,i=a[g].toString();h=(h=(h=b[g])==null?void 0:h.latestEditMsgKey)!=null?h:i;f.set(h,i);var j={messageInfoRecords:[],ackReceiver:b[g]?b[g].count:null};e.set(h,j);if(a[g].remote.isUser()||a[g].remote.isStatus()){h=(h=d("WAWebLidMigrationUtils").getAlternateMsgKey(c("WAWebMsgKey").from(h)))==null?void 0:h.toString();h!=null&&(f.set(h,i),e.set(h,j))}}i=(yield d("WAWebSchemaMessageInfo").getMessageInfoTable().anyOf(["msgKey"],Array.from(e.keys())));i.forEach(function(a){var b;(b=e.get(a.msgKey))==null||b.messageInfoRecords.push(a)});h=r(e);j=new Map();for(g of h){b=g[0];a=g[1];i=f.get(b);i!=null&&j.set(i,a)}return j});return q.apply(this,arguments)}function r(a){var b=new Map(),e=function(){var a=f[0],e=f[1],g=e.ackReceiver;e=e.messageInfoRecords;var h=0,i={delivery:[],deliveryRemaining:0,played:[],playedRemaining:0,read:[],readRemaining:0},j=!1;e.forEach(function(b){var e=d("WAWebWidFactory").createWid(b.receiverUserJid);if(d("WAWebUserPrefsMeUser").isMeAccount(e))return;s(b);for(var f=0;f<m.length;f++){var g=m[f],k=b[g];if(k!=null){i[g].push({id:e,t:k});k=c("WAWebWid").isGroup(c("WAWebMsgKey").fromString(a).remote);k&&g==="read"&&e!=null&&e.isBot()&&(j=!0);if(k)break}}b.delivery!=null&&b.deliveryPrivacyMode!=null&&(i.deliveryPrivacyMode=b.deliveryPrivacyMode);h+=1});e=g!=null&&g!==0?g:h;j&&e++;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["queryMsgInfo: targetedMsgInfoKey: ",", ack count: ",", receiver: ",",\n        played: ",", read: ",", delivery: ",""])),a,g,e,i.played.length,i.read.length,i.delivery.length);i.playedRemaining=e-i.played.length;i.readRemaining=i.playedRemaining-i.read.length;i.deliveryRemaining=i.readRemaining-i.delivery.length;b.set(a,i)};for(var f of a.entries())e();return b}function s(a){var b=a.read;b!=null&&(a.delivery==null||a.delivery>b)&&(a.delivery=b)}function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map(),c=(yield p(a));for(a of a){var e=c.get(a.toString());if(e==null)continue;var f=void 0;e.playedRemaining===0&&e.played.length>0?f=d("WAWebAck").ACK.PLAYED:e.readRemaining===0&&e.read.length>0?f=d("WAWebAck").ACK.READ:e.deliveryRemaining===0&&e.delivery.length>0&&(f=d("WAWebAck").ACK.RECEIVED);f!=null&&b.set(a.toString(),f)}return b});return u.apply(this,arguments)}g.RetryEligibilityResult=n;g.createOrMergeReceiptRecords=a;g.isRetryEligible=e;g.queryMsgInfo=f;g.queryMsgInfos=p;g.getHighestMsgAcks=t}),98);
__d("WAWebApiOrphanReceipt",["WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebSchemaOrphanReceipt","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSchemaOrphanReceipt").getOrphanReceiptTable().remove(a)}function c(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[a];if(a.remote.isUser()){a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a);a!=null&&b.push(a)}a=(yield d("WAWebSchemaOrphanReceipt").getOrphanReceiptTable().bulkGet(b.map(String)));return a.find(function(a){return a!=null})});return h.apply(this,arguments)}function e(a,b,c){return d("WAWebModelStorageUtils").getStorage().lock(["orphan-receipt"],function(d){var e=d[0];return e.bulkGet(c).then(function(d){var f=c.reduce(function(c,e,f){f=d[f];f==null&&(f={msgKey:e});e=f[a];(e==null||e>b)&&(f[a]=b,c.push(f));return c},[]);return e.bulkCreateOrReplace(f)})})}g.removeOrphanReceipt=a;g.getOrphanReceipt=c;g.createOrUpdateOrphanReceipt=e}),98);
__d("WAWebApiOrphanRevoke",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebSchemaOrphanRevoke","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=new Map(),i=!1,j={reset:function(){h=new Map(),i=!1},bulkRemoveOrphans:function(a){a.forEach(function(a){h["delete"](a.msgKey)});return d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().bulkRemove(a.map(function(a){return a.msgKey}))},bulkCreateOrReplaceOrphanRevokes:function(a){a.forEach(function(a){h.has(a.msgKey)&&h["delete"](a.msgKey),h.set(a.msgKey,a)});return d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().bulkCreateOrReplace(a)},getAllOrphanRevokes:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!i){var a=(yield d("WAWebSchemaOrphanRevoke").getOrphanRevokeTable().all());h=new Map(a.map(function(a){return[a.msgKey,a]}));i=!0}return h});function c(){return a.apply(this,arguments)}return c}()};function a(a){return j.bulkCreateOrReplaceOrphanRevokes(a)}function e(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return j.getAllOrphanRevokes()});return k.apply(this,arguments)}function f(a){return j.bulkRemoveOrphans(a)}function l(a,b){var c;return{id:a.id,to:a.to,author:a.author,revokeSender:d("WAWebWidFactory").createWidFromWidLike((c=b.sender)!=null?c:d("WAWebMsgGetters").getSender(a)),type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedMessage,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:b.subtype==="admin_revoke"?"admin":"sender",protocolMessageKey:a.id,from:a.from,t:a.t,broadcast:a.broadcast}}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j.getAllOrphanRevokes()),e=[],f=[];a.forEach(function(a){var g=a.id.toString();if(b.has(g)){g=c("WANullthrows")(b.get(g));f.push(babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{id:c("WAWebMsgKey").fromString(g.msgKey),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:g.subtype==="admin_revoke"?"admin_revoke":"sender_revoke",protocolMessageKey:a.id,t:g.timestamp}));e.push(g)}});yield j.bulkRemoveOrphans(e);return f});return n.apply(this,arguments)}g.addOrphanRevokes=a;g.getOrphansRevokesCache=e;g.bulkRemoveOrphansUsingOrphansCache=f;g.createRevokeMsgFromOrphanRevoke=l;g.applyAddonRevokes=m}),98);
__d("WAWebApiVerifiedBusinessName",["invariant","$InternalEnum","Promise","WAWebBizGatingUtils","WAWebHandleMsgTypes.flow","WAWebLidMigrationUtils","WAWebSchemaVerifiedBusinessName","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g,h){var i;function a(){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().all()}var j=b("$InternalEnum").Mirrored(["Replace","Merge"]);function k(a){return d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable().get(u(a))}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.isLid()||h(0,86986);var b=(yield k(a));if(b==null){var c=d("WAWebLidMigrationUtils").toPn(a);if(c!=null){c=(yield k(c));if(c!=null)return babelHelpers["extends"]({},c,{id:u(a)})}}return b});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebLidMigrationUtils").toLid(a);if(b!=null){b=(yield k(b));if(b!=null)return babelHelpers["extends"]({},b,{id:u(a)})}return k(a)});return o.apply(this,arguments)}function c(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled())return k(a);return!a.isUser()?null:a.isLid()?l(a):n(a)});return p.apply(this,arguments)}function q(a,b,c){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=j.Replace);var e=d("WAWebSchemaVerifiedBusinessName").getVerifiedBusinessNameTable();a=u(a);b=babelHelpers["extends"]({},b,{id:a});c===j.Replace?yield e.createOrReplace(b):yield e.createOrMerge(a,b)});return r.apply(this,arguments)}function e(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield k(a));return(a==null?void 0:a.privacyMode)==null?null:t(a.privacyMode)});return s.apply(this,arguments)}function t(a){var b=d("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(a.actualActors),c=d("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(a.hostStorage);return b==null||c==null?null:{actualActors:b,hostStorage:c,privacyModeTs:a.privacyModeTs}}function u(a){return a.isLid()?a.toString():a.user}function f(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=j.Replace);a=d("WAWebBizGatingUtils").isLidMigrationForVnameEnabled()?d("WAWebLidMigrationUtils").getPnAndLidToUpdate(a):[a];return(i||(i=b("Promise"))).all(a.map(function(a){return q(a,c,e)}))});return v.apply(this,arguments)}g.getAllVerifiedNames=a;g.VerifiedBusinessNameUpdateType=j;g.getVerifiedBusinessNameRecord=k;g.getVerifiedBusinessNameRecordLidAware=c;g.createOrUpdateVerifiedBusinessName=q;g.getPrivacyMode=e;g.convertPrivacyModeFromStorageType=t;g.widToId=u;g.createOrUpdateVerifiedBusinessNameLidAware=f}),98);
__d("WAWebOffdStorageUpdateOfflinePeerReceipts",["Promise","WAJids","WALogger","WAWebAck","WAWebBackendApi","WAWebDBBulkGetRootMsgs","WAWebDBMsgUtils","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebLidStatusMigrationKeyUtils","WAWebMarkAddOnsAsReadJob","WAWebMessageReceiptUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebSchemaChat","WAWebSchemaMessage","WAWebSchemaPeerReadReceipt","WAWebUsernameTypes","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t;function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())return a;if(a.length===0)return a;var b=[],c=[],e=new Map();for(var f=0;f<a.length;f++){var g=a[f];if(g.id==null)continue;var j=d("WAWebWidFactory").createWid(g.id);if(j==null)continue;if(!j.isRegularUser()){b.push(g);continue}var k=g.id;if(k!=null){c.push(k);var l=d("WAWebLidMigrationUtils").toLid(j);e.set(k,{chatUpdate:g,lid:l,chatWid:j})}}if(c.length>0){k=(yield d("WAWebSchemaChat").getChatTable().bulkGet(c));for(g=0;g<c.length;g++){l=c[g];j=k[g];a=e.get(l);if(a==null)continue;f=a.chatUpdate;l=a.lid;a=a.chatWid;if(j!=null)b.push(f);else if(l!=null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["addAccountLidToUpdates: will add account_lid to ",", ",""])),a.toLogString(),l.toLogString());j=babelHelpers["extends"]({},f,{accountLid:l.toString()});a.isLid()&&(j.lidOriginType=d("WAWebUsernameTypes").LidOriginType.GENERAL);b.push(j)}else d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["addAccountLidToUpdates: did not find Lid for missing chat ",""])),a.toLogString())}}return b});return v.apply(this,arguments)}function a(){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"UpdatePeerReceipts_start");d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: start updatePeerReceipts"])));var a=(yield d("WAWebSchemaPeerReadReceipt").getTable().all());if(d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated())yield (t||(t=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.msgKeys=(yield d("WAWebDBBulkGetRootMsgs").fixMsgKeysWithChatId(a.msgKeys))});return function(b){return a.apply(this,arguments)}}()));else{var e=[],f=[];for(var g of a)for(var h of g.msgKeys){var i=c("WAWebMsgKey").fromString(h);i.remote.isLid()&&(g.ack===d("WAWebAck").ACK.READ?e.push(i):g.ack===d("WAWebAck").ACK.PLAYED&&f.push(i))}e.length>0&&a.push({ack:d("WAWebAck").ACK.READ,msgKeys:d("WAWebDBBulkGetRootMsgs").fixMsgKeysWithPnMapping(e).map(String)});f.length>0&&a.push({ack:d("WAWebAck").ACK.PLAYED,msgKeys:Array.from(f).map(String)})}d("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: find "," peer receipts"])),a.length);var r=[],s=[];a.forEach(function(a){a.ack===d("WAWebAck").ACK.READ?r.push(a):a.ack===d("WAWebAck").ACK.PLAYED?s.push(a):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["updatePeerReceipts: unknown ack type: ",""])),a.ack)});i=(yield x(r));h=i.chatUpdates;g=i.chatAckUpdates;e=i.statusAckUpdates;f=g.concat(e);d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish compute peer receipt updates"])));var v=new Map(e.map(function(a){return[a.id,a]})),w=new Map(f.map(function(a){return[a.id,a]}));a=D(s);a.forEach(function(a){var b=w.get(a.id);b==null?w.set(a.id,a):w.set(a.id,babelHelpers["extends"]({},b,{ack:a.ack}))});var y=Array.from(w.values());d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish compute peer played updates"])));d("WAWebBackendApi").frontendFireAndForget("updateOfflinePeerReceipt",{chatUpdates:h.map(function(a){return{chatId:a.id,unreadCount:a.unreadCount,unreadMentionsOfMe:(a=a.unreadMentionsOfMe)!=null?a:[]}}),ackUpdates:y.map(function(b){var a=b.id;v.has(b.id)&&(a=d("WAWebLidStatusMigrationKeyUtils").matKeyConvert(c("WAWebMsgKey").fromString(a)).toString());return{msgKey:a,ack:b.ack}})});var z=(yield u(h));d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["updatePeerReceipts: bulkCreateOrMerge ",""])),z.slice(-15).map(function(a){return a.id}).join(",")).tags("missing-lid");yield (t||(t=b("Promise"))).all([d("WAWebModelStorageUtils").getStorage().lock(["message","chat"],function(a){var c=a[0];a=a[1];return(t||(t=b("Promise"))).all([c.bulkCreateOrMerge(y),a.bulkCreateOrMerge(z)])}).then(function(){d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish update chat/message table"])))}),d("WAWebMarkAddOnsAsReadJob").markUnclassifiedAddOnsAsReadJob(Array.from(C(r)).map(function(a){return c("WAWebMsgKey").from(a)})).then(function(){d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: updatePeerReceipts: finish update add-on tables"])))})]);return d("WAWebSchemaPeerReadReceipt").getTable().clear().then(function(){d("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(d("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"UpdatePeerReceipts_end")})});return w.apply(this,arguments)}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["getUpdatesForPeerReadReceipts"])));var c=C(a),e=(yield g(a));g=Array.from(e.keys());a=g.reduce(function(a,b){a.push([b,d("WAWebDBMsgUtils").PendingReadReceiptType.Message]);a.push([b,d("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit]);return a},[]);var f=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["from","pendingReadReceipt"],a,{shouldDecrypt:!1}));d("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[init-from-storage]: getUpdatesForPeerReadReceipts: found "," pendingReadMessages"])),f.length);f.forEach(function(a){return i(e.get(a.from),a)});f.forEach(function(a){return j(e.get(a.from),a)});a=k();k=(yield A(c));g=g.map(function(a){var b=e.get(a);return b!=null&&b.lastUnreadMsgRowId!=null?{id:a,unreadCount:b.unreadCount,unreadMentionsOfMe:b.unreadMentionsOfMe}:null}).filter(Boolean);return{chatUpdates:g,chatAckUpdates:a,statusAckUpdates:k};function g(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return new Map(a.flatMap(function(a){return a.msgKeys}).map(z).filter(function(a){return a!==d("WAJids").STATUS_JID}).map(function(a){return[a,{unreadCount:0,lastUnreadMsgRowId:void 0,unreadMentionsOfMe:[],unreadMentionCount:0}]}))});return h.apply(this,arguments)}function i(a,b){var d=b.rowId;b=b.id;if(a==null||d==null)return;c.has(b)&&(a.lastUnreadMsgRowId==null||d>a.lastUnreadMsgRowId)&&(a.lastUnreadMsgRowId=d)}function j(a,b){var c=b.rowId;if(a==null||c==null||a.lastUnreadMsgRowId==null)return;if(c>a.lastUnreadMsgRowId){a.unreadCount+=1;if(d("WAWebMsgGetters").getIsImportantMessage(b)){c={id:b.id,timestamp:b.t};a.unreadMentionsOfMe.push(c)}}}function k(){return f.map(function(a){var b=a.rowId,c=e.get(a.from);if(c==null||b==null||c.lastUnreadMsgRowId==null)return null;return b<=c.lastUnreadMsgRowId?a.pendingReadReceipt===d("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit?null:{id:a.id,ack:d("WAWebAck").ACK.READ,pendingReadReceipt:null}:null}).filter(Boolean)}});return y.apply(this,arguments)}function z(a){return c("WAWebMsgKey").fromString(a).remote.toString()}function A(a){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=Array.from(a).filter(function(a){return z(a)===d("WAJids").STATUS_JID}).map(function(a){return c("WAWebMsgKey").fromString(a)});a=(yield d("WAWebMessageReceiptUtils").fixStatusReceiptKeys(a));return a.map(function(a){return{id:a.toString(),ack:d("WAWebAck").ACK.READ}})});return B.apply(this,arguments)}function C(a){return new Set(a.flatMap(function(a){return a.msgKeys}))}function D(a){var b=new Set();a.forEach(function(a){a.ack===d("WAWebAck").ACK.PLAYED&&a.msgKeys.forEach(function(a){return b.add(a)})});return Array.from(b).map(function(a){return{id:a,ack:d("WAWebAck").ACK.PLAYED,pendingReadReceipt:null}})}g.addAccountLidToUpdates=u;g.updatePeerReceipts=a;g.getStatusMsgAckUpdates=A}),98);
__d("WAWebSchemaPendingDeviceSync",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(a,b,c,d,e,f,g){c=d("WAWebStorageMutationBuilder").columnBuilder();var h=c.addUserDefinedPrimaryKey;function a(){d("WAWebOffdStorageUtils").getStorage().add("pending-device-sync").version(d("WAWebOffdStorageUtils").getStorage().versions.version(4),[h("id")]).view(function(a){return a})}function b(){return d("WAWebOffdStorageUtils").getStorage().table("pending-device-sync")}g.addTable=a;g.getTable=b}),98);
__d("WAWebApiPendingDeviceSync",["WALogger","WAWebSchemaPendingDeviceSync","WAWebSyncDeviceAdvDeviceListJob","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield d("WAWebSchemaPendingDeviceSync").getTable().all());yield d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob(a.map(function(a){return d("WAWebWidFactory").createWid(a.id)}),null,null);yield d("WAWebSchemaPendingDeviceSync").getTable().bulkRemove(a.map(function(a){return a.id}))}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["doPendingDeviceSync failed during RESUME_WITH_OPEN_TAB"]))).verbose().devConsole(a)}});return i.apply(this,arguments)}function c(a){return d("WAWebSchemaPendingDeviceSync").getTable().bulkCreateOrMerge(a.map(function(a){return{id:a}}))}g.doPendingDeviceSync=a;g.addUserToPendingDeviceSync=c}),98);
__d("WAWebTimestampConversionUtils",["WALogger","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){var b=a;try{d("WALongInt").numberOrThrowIfTooLarge(a)/d("WATimeUtils").unixTime()>10?(b=d("WALongInt").numberOrThrowIfTooLarge(a)/1e3,d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: adjusting future timestamp"])))):d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: no need to adjust timestamp"])))}catch(b){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["syncd: maybeMillisecondsToSeconds: messageTimestamp: "," too large to cast"])),a)}return b}g.maybeMillisecondsToSeconds=a}),98);
__d("WAWebActiveMessageRanges",["WALogger","WALongInt","WAWebApiActiveMessageRanges","WAWebHandleForMessageRangeEnums","WAWebSchemaActiveMessageRanges","WAWebTimestampConversionUtils"],(function(a,b,c,d,e,f,g){var h,i;function j(a,b){if(a==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["syncd: missing message range from row."])));return d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN}var c=a.messages;a=a.lastMessageTimestamp;var e=d("WAWebTimestampConversionUtils").maybeMillisecondsToSeconds(a!=null?a:0);e!==(a!=null?a:0)&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["syncd: last message timestamp was converted to seconds from ",""])),a).sendLogs("syncd: last message timestamp was converted to seconds",{sampling:.01});if(b.t!=null&&b.t<d("WALongInt").numberOrThrowIfTooLarge(e))return d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP;a=b.id;for(e of c){b=e.key;if(b!=null&&a!=null&&b.id===a.id)return d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL}return d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN}function a(a,b){d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a.remote.toString()).then(function(c){c.forEach(function(c){if([d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive,d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead].includes(c.action)&&j(c.actionValue.messageRange,{id:a,t:b})===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN)return d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.remote.toString(),c.action)})})}g.rangeContainsMessage=j;g.checkAndRemoveActiveMessageRanges=a}),98);
__d("WAWebWamEnumCollection",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:1,REGULAR_LOW:2,REGULAR_HIGH:3,CRITICAL_BLOCK:4,CRITICAL_UNBLOCK_LOW:5});f.COLLECTION=a}),66);
__d("WAWebWamEnumMdSyncdCriticalEventCode",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSAGE_RANGE_UNSET:1,MESSAGE_RANGE_LAST_SYSTEM_MESSAGE_TIMESTAMP_SET:2,MESSAGE_RANGE_MESSAGES_UNSET:3,MESSAGE_RANGE_MESSAGES_EMPTY:4,MESSAGE_RANGE_MESSAGES_CROSS_LIMIT:5,MESSAGE_RANGE_MESSAGE_KEY_UNSET:6,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_UNSET:7,MESSAGE_RANGE_MESSAGE_KEY_FROM_ME_UNSET:8,MESSAGE_RANGE_MESSAGE_KEY_STANZA_ID_UNSET:9,MESSAGE_RANGE_MESSAGE_KEY_REMOTE_JID_INVALID:10,MESSAGE_RANGE_MESSAGE_KEY_PARTICIPANT_UNSET:11,MALFORMED_PENDING_MUTATION:12,ACTION_INVALID_INDEX_DATA:13,MISSING_MUTATION_TO_REMOVE:14,LTHASH_INCONSISTENCY_ON_DAILY_CHECK:15,LTHASH_INCONSISTENCY_ON_SNAPSHOT_MAC_MISMATCH:16});f.MD_SYNCD_CRITICAL_EVENT_CODE=a}),66);
__d("WAWebMdCriticalEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCollection","WAWebWamEnumMdSyncdCriticalEventCode"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MdCriticalEvent:[2746,{collection:[2,d("WAWebWamEnumCollection").COLLECTION],mdCriticalEventCode:[1,d("WAWebWamEnumMdSyncdCriticalEventCode").MD_SYNCD_CRITICAL_EVENT_CODE]},[1,1,1],"regular"]},{MdCriticalEvent:[]});g.MdCriticalEventWamEvent=a}),98);
__d("WAWebSyncdActionUtils",["WASyncAction.pb","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return JSON.stringify([a].concat(b))}function a(a){var b=a.action,c=a.indexArgs,e=a.collection,f=a.value,g=a.version,i=a.operation;a=a.timestamp;return{collection:e,index:h(b,c),binarySyncAction:d("encodeProtobuf").encodeProtobuf(d("WASyncAction.pb").SyncActionValueSpec,babelHelpers["extends"]({},f,{timestamp:a})).readBuffer(),version:g,operation:i,timestamp:a,action:b}}function b(a){var b=a.remoteJid,c=a.id,d=a.fromMe;a=a.participant;return[b,c,d?"1":"0",a!=null&&!d?a:"0"]}g.buildIndex=h;g.buildPendingMutation=a;g.buildMessageKey=b}),98);
__d("WAWebSyncdUtils",["WASyncdConst","WAWebMdCriticalEventWamEvent","WAWebSyncdActionUtils","WAWebWamEnumCollection"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebSyncdActionUtils").buildIndex(d("WASyncdConst").Actions.Star,h(a))}function b(a){return h(a.id)}function h(a){var b=i(a);return[a.remote.toString({legacy:!0}),a.id,a.fromMe?"1":"0",b]}function i(a){var b="0";a.participant&&!a.remote.isUser()&&!a.fromMe&&(b=a.participant.toString({legacy:!0}));return b}function j(a){switch(a){case d("WASyncdConst").CollectionName.CriticalBlock:return d("WAWebWamEnumCollection").COLLECTION.CRITICAL_BLOCK;case d("WASyncdConst").CollectionName.CriticalUnblockLow:return d("WAWebWamEnumCollection").COLLECTION.CRITICAL_UNBLOCK_LOW;case d("WASyncdConst").CollectionName.Regular:return d("WAWebWamEnumCollection").COLLECTION.REGULAR;case d("WASyncdConst").CollectionName.RegularHigh:return d("WAWebWamEnumCollection").COLLECTION.REGULAR_HIGH;case d("WASyncdConst").CollectionName.RegularLow:return d("WAWebWamEnumCollection").COLLECTION.REGULAR_LOW}}function c(a,b){a=new(d("WAWebMdCriticalEventWamEvent").MdCriticalEventWamEvent)({mdCriticalEventCode:a});b!=null&&(a.collection=j(b));a.commit()}function e(a){return JSON.parse(a)[d("WASyncdConst").MUTATION_NAME_INDEX]}g.constructStarMsgKeyFromMsgKey=a;g.constructMsgKeySegments=b;g.constructMsgKeySegmentsFromMsgKey=h;g.extractParticipantForSync=i;g.collectionNameToMetric=j;g.uploadCriticalEventMetric=c;g.getMutationNameFromIndex=e}),98);
__d("WAWebHandleForMessageRange",["Promise","WALogger","WASyncAction.pb","WAWebActiveMessageRanges","WAWebAddonGatingUtils","WAWebApiActiveMessageRanges","WAWebHandleForMessageRangeEnums","WAWebMsgRangeContainmentHandlers","WAWebMsgType","WAWebSchemaActiveMessageRanges","WAWebSyncdDb","WAWebSyncdUtils","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j=new Set(),k=function(a){return a.reduce(function(a,b){return new Set([].concat(Array.from(a),Array.from(b)))},new Set())};function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e;switch(a.action){case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.Archive:a.actionValue.archived===!0?yield d("WAWebMsgRangeContainmentHandlers").handleForArchive(a,c):yield d("WAWebMsgRangeContainmentHandlers").handleForUnarchive(a,c);return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.MarkChatAsRead:yield d("WAWebMsgRangeContainmentHandlers").handleForMarkAsReadUnread(a,c,!!a.actionValue.read);return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatDeleteStarredKeepMedia:e=d("WAWebMsgRangeContainmentHandlers").handleForClearChat(a,c);return e?new Set([e]):j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.ClearChatKeepStarredKeepMedia:if(!(yield n(b.id))){e=d("WAWebMsgRangeContainmentHandlers").handleForClearChat(a,c);return e?new Set([e]):j}return j;case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatDeleteMedia:case d("WAWebSchemaActiveMessageRanges").ActiveRangeAction.DeleteChatKeepMedia:e=d("WAWebMsgRangeContainmentHandlers").handleForDeleteChat(a,c);return e?new Set([e]):j}d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleMessageContainment called with unknwon message range action action: ",""])),a.action);return j});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebSyncdUtils").constructStarMsgKeyFromMsgKey(a);a=(yield d("WAWebSyncdDb").getSyncAction(a));if(a){var b;a=d("decodeProtobuf").decodeProtobuf(d("WASyncAction.pb").SyncActionDataSpec,a.binarySyncData).value;return(a==null||(b=a.starAction)==null?void 0:b.starred)||!1}return!1});return o.apply(this,arguments)}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){e===void 0&&(e=!0);if(d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(c.type))return j;a=(yield d("WAWebApiActiveMessageRanges").getActiveMessageRanges(a.toString()));a=a.map(function(a){return[a,d("WAWebActiveMessageRanges").rangeContainsMessage(a.actionValue.messageRange,c)]});var f=a.filter(function(a){a=a[1];return a===d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL}).map(function(a){a=a[0];return a});f.forEach(function(a){a.remainingMessages--});yield d("WAWebApiActiveMessageRanges").bulkUpdateActiveMessageRanges(f,e);f=a.map(function(a){var b=a[0];a=a[1];return l(b,c,a)});e=(yield (i||(i=b("Promise"))).all(f));return k(e)});return q.apply(this,arguments)}function r(a){if(d("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(a.type))return!0;return a.type==="reaction"||a.type==="poll_update"?!0:!1}function a(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map();a.forEach(function(a){if(d("WAWebMsgType").SYSTEM_MESSAGE_TYPES.includes(a.type)||r(a))return;var b=c.get(a.id.remote.toString());(b==null||b.t<a.t)&&c.set(a.id.remote.toString(),a)});yield (i||(i=b("Promise"))).all(Array.from(c.entries()).map(function(a){var b=a[0];a=a[1];return p(d("WAWebWidFactory").createWid(b),a)}))});return s.apply(this,arguments)}g.handleForActiveMessageRange=p;g.handleOfflineForMessageRange=a}),98);
__d("WAWebChatDbUpdatesApi",["WALogger","WAWebBackendApi","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["setArchive: bulk update chat"])));try{var b=(yield d("WAWebSchemaChat").getChatTable().bulkGet(a.map(function(a){return a.id})));b=a[b.indexOf(null)];b&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["setArchive: some chats to archive do not exist. first: ",""])),d("WAWebWidFactory").createWid(b.id).toLogString()).tags("missing-lid")}catch(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["setArchive: failed to log missing chats"])))}yield d("WAWebSchemaChat").getChatTable().bulkMergeOnly(a);b=a.map(function(a){return{id:d("WAWebWidFactory").createWid(a.id),archive:a.archive}});d("WAWebBackendApi").frontendFireAndForget("chatCollectionUpdate",{updates:b})});return k.apply(this,arguments)}g.setArchive=a}),98);
__d("WAWebMsgRangeContainmentHandlers",["WALogger","WAWebApiActiveMessageRanges","WAWebBackendApi","WAWebChatDbUpdatesApi","WAWebHandleForMessageRangeEnums","WAWebUserPrefsMultiDevice","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN){b=(yield d("WAWebUserPrefsMultiDevice").getArchiveV2EnabledSetting());var c=(yield d("WAWebUserPrefsMultiDevice").getUnarchiveChatsSetting());(!b||c)&&(d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleForArchive: Unarchiving chat due to an incoming message"]))),d("WAWebChatDbUpdatesApi").setArchive([{id:a.chatId,archive:!1}]));yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action)}});return i.apply(this,arguments)}function c(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){(b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN||a.remainingMessages===0)&&(yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action))});return j.apply(this,arguments)}function e(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b===d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN?yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action):a.remainingMessages===0&&(d("WAWebBackendApi").frontendFireAndForget("updateChatReadStatus",{id:d("WAWebWidFactory").createWid(a.chatId),read:c}),yield d("WAWebApiActiveMessageRanges").removeActiveMessageRange(a.chatId,a.action))});return k.apply(this,arguments)}function f(a,b){switch(b){case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP:case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL:return d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage;case d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN:return}}function l(a,b){switch(b){case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_TIMESTAMP:case d("WAWebHandleForMessageRangeEnums").RangeContain.CONTAINS_BY_ADDITIONAL:return d("WAWebHandleForMessageRangeEnums").ActiveRangeHandlerAction.DropMessage;case d("WAWebHandleForMessageRangeEnums").RangeContain.DOES_NOT_CONTAIN:return}}g.handleForArchive=a;g.handleForUnarchive=c;g.handleForMarkAsReadUnread=e;g.handleForClearChat=f;g.handleForDeleteChat=l}),98);
__d("WASmaxInUserNoticeIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInUserNoticeIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInUserNoticeGetDisclosuresResponseClientError",["WAResultOrError","WASmaxInUserNoticeIQErrorBadRequestMixin","WASmaxInUserNoticeIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInUserNoticeIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(c.value);if(!c.success)return c;a=d("WASmaxInUserNoticeIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorBadRequestMixin:c.value},a.value))}g.parseGetDisclosuresResponseClientError=a}),98);
__d("WASmaxInUserNoticeIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInUserNoticeStageMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",0,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"stage",0,1e3);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,stage:a.value})}g.parseStageMixin=a}),98);
__d("WASmaxInUserNoticeGetDisclosuresResponseClientSuccess",["WAResultOrError","WASmaxInUserNoticeIQResultResponseMixin","WASmaxInUserNoticeStageMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"notice");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").attrIntRange(a,"version",1,void 0);if(!c.success)return c;var e=d("WASmaxParseUtils").attrIntRange(a,"type",0,void 0);if(!e.success)return e;a=d("WASmaxInUserNoticeStageMixin").parseStageMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({t:b.value,version:c.value,type:e.value},a.value))}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInUserNoticeIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!c.success)return c;b=d("WASmaxParseUtils").mapChildrenWithTag(a,"notice",0,Infinity,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{notice:b.value}))}g.parseGetDisclosuresResponseClientSuccessNotice=h;g.parseGetDisclosuresResponseClientSuccess=a}),98);
__d("WASmaxInUserNoticeIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInUserNoticeIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","rate-overlimit");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",429);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorRateOverlimitMixin=a}),98);
__d("WASmaxInUserNoticeUserNoticeServerError",["WAResultOrError","WASmaxInUserNoticeIQErrorInternalServerErrorMixin","WASmaxInUserNoticeIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInUserNoticeIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInUserNoticeIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorRateOverlimit"],[b,c])}g.parseUserNoticeServerError=a}),98);
__d("WASmaxInUserNoticeGetDisclosuresResponseServerError",["WAResultOrError","WASmaxInUserNoticeIQErrorResponseMixin","WASmaxInUserNoticeUserNoticeServerError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInUserNoticeIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInUserNoticeUserNoticeServerError").parseUserNoticeServerError(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorUserNoticeServerError:b.value}))}g.parseGetDisclosuresResponseServerError=a}),98);
__d("WASmaxOutUserNoticeBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutUserNoticeGetDisclosuresRequest",["WASmaxJsx","WASmaxOutUserNoticeBaseIQGetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){a=a.getUserDisclosuresT;a=d("WASmaxOutUserNoticeBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"tos"},d("WASmaxJsx").smax("get_user_disclosures",{t:d("WAWap").INT(a)})));return a}g.makeGetDisclosuresRequest=a}),98);
__d("WASmaxUserNoticeGetDisclosuresRPC",["WAComms","WASmaxInUserNoticeGetDisclosuresResponseClientError","WASmaxInUserNoticeGetDisclosuresResponseClientSuccess","WASmaxInUserNoticeGetDisclosuresResponseServerError","WASmaxOutUserNoticeGetDisclosuresRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=d("WASmaxOutUserNoticeGetDisclosuresRequest").makeGetDisclosuresRequest(a);b=(yield d("WAComms").sendSmaxStanza(a,b));var c=d("WASmaxInUserNoticeGetDisclosuresResponseClientSuccess").parseGetDisclosuresResponseClientSuccess(b,a);if(c.success)return{name:"GetDisclosuresResponseClientSuccess",value:c.value};var e=d("WASmaxInUserNoticeGetDisclosuresResponseClientError").parseGetDisclosuresResponseClientError(b,a);if(e.success)return{name:"GetDisclosuresResponseClientError",value:e.value};b=d("WASmaxInUserNoticeGetDisclosuresResponseServerError").parseGetDisclosuresResponseServerError(b,a);if(b.success)return{name:"GetDisclosuresResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("GetDisclosures",{ClientSuccess:c,ClientError:e,ServerError:b}))});return h.apply(this,arguments)}g.sendGetDisclosuresRPC=a}),98);
__d("WAWebGetUserDisclosuresQueryJob",["WASmaxUserNoticeGetDisclosuresRPC","WATimeUtils","WAWebBackendErrors","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=d("WATimeUtils").unixTime();a=(yield d("WASmaxUserNoticeGetDisclosuresRPC").sendGetDisclosuresRPC({getUserDisclosuresT:a}));switch(a.name){case"GetDisclosuresResponseClientSuccess":return a.value.notice;case"GetDisclosuresResponseClientError":var b=a.value.errorIQErrorBadRequestMixin,c=b.code;b=b.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(c),b);case"GetDisclosuresResponseServerError":c=a.value.errorUserNoticeServerError.value;b=c.code;a=c.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(b),a)}});return h.apply(this,arguments)}g.queryAllUserDisclosures=a}),98);
__d("WAWebGetUserDisclosuresJob",["WAJobOrchestratorTypes","WAWebGetUserDisclosuresQueryJob","WAWebOrchestratorNonPersistedJob"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getAllUserDisclosures",function(){return d("WAWebGetUserDisclosuresQueryJob").queryAllUserDisclosures()},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getAllUserDisclosures=a}),98);
__d("WAWebTosJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWebBackendErrors","WAWebNoop","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h=7200,i=259200,j=86400,k=new(c("WADeprecatedWapParser"))("tosNotices",function(a){a.assertTag("iq");a.assertFromServer();a=a.child("tos");var b={refresh:a.attrInt("refresh"),notice:[]};a.forEachChildWithTag("notice",function(a){var c=a.maybeAttrString("state")!=="false";a=a.attrString("id");b.notice.push({id:a,state:c})});(b.refresh>i||b.refresh<h)&&(b.refresh=j);return b});function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=d("WAWap")).wap("iq",{xmlns:"tos",id:b.generateId(),type:"get",to:b.S_WHATSAPP_NET},b.wap("request",null,a.map(function(a){return d("WAWap").wap("notice",{id:d("WAWap").CUSTOM_STRING(a)})})));a=(yield d("WADeprecatedSendIq").deprecatedSendIq(b,k));if(a.success)return a.result;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(a.errorCode,a.errorText)});return l.apply(this,arguments)}function e(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!c("gkx")("26258")){var b,e=new(c("WADeprecatedWapParser"))("tosNoticesDebug",c("WAWebNoop"));b=(b=d("WAWap")).wap("iq",{xmlns:"tos",id:b.generateId(),type:"set",to:b.S_WHATSAPP_NET},b.wap("delete",{id:a}));yield d("WADeprecatedSendIq").deprecatedSendIq(b,e)}});return m.apply(this,arguments)}function f(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=new(c("WADeprecatedWapParser"))("tosNoticesSet",c("WAWebNoop"));b=(b=d("WAWap")).wap("iq",{xmlns:"tos",id:b.generateId(),type:"set",to:b.S_WHATSAPP_NET},b.wap("request",{type:"session_update"},a.map(function(a){return d("WAWap").wap("notice",{id:d("WAWap").CUSTOM_STRING(a)})})));yield d("WADeprecatedSendIq").deprecatedSendIq(b,e)});return n.apply(this,arguments)}g.DEFAULT_TOS_REFRESH_INTERVAL=j;g.queryTosState=a;g.deleteTosState=e;g.updateTosState=f}),98);
__d("WAWebGetUserDisclosuresAction",["WATimeUtils","WAWebGetUserDisclosuresJob","WAWebTosJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=5;function a(){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebGetUserDisclosuresJob").getAllUserDisclosures());a=a.map(function(a){return{id:a.id.toString(),state:a.stage===h,timestamp:d("WATimeUtils").castToUnixTime(a.t)}});return{refresh:d("WAWebTosJob").DEFAULT_TOS_REFRESH_INTERVAL,notice:a}});return i.apply(this,arguments)}g.getUserDisclosuresAction=a}),98);
__d("WAWebWamoNewsletterGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("wamo_privacy_tos_show_channels_nux_enabled")}function h(){return d("WAWebABProps").getABPropConfigValue("newsletter_nux_notice_id")}function i(){return d("WAWebABProps").getABPropConfigValue("wamo_privacy_tos_unlinked_highlighted_notice_id")}function j(){return d("WAWebABProps").getABPropConfigValue("wamo_privacy_tos_linked_highlighted_notice_id")}function b(){return[h(),i(),j(),k()]}function c(){return d("WAWebABProps").getABPropConfigValue("wamo_privacy_tos_show_channels_nux_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("newsletter_admin_invite_nux_id")}g.shouldUseWamoTos=a;g.getNewsletterConsumerNux=h;g.getWamoUnlinkedTos=i;g.getWamoLinkedTos=j;g.getWamoNotices=b;g.shouldShowNewsletterAdminInviteNux=c;g.getNewsletterAdminInviteNux=k}),98);
__d("WAWebTos",["Promise","WACustomError","WAExponentialBackoff","WALogger","WAPromiseDelays","WATimeUtils","WAWebBackendErrors","WAWebBizGatingUtils","WAWebBotGating","WAWebBotTosIds","WAWebEventEmitter","WAWebGetUserDisclosuresAction","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingTos","WAWebNewsletterGatingUtils","WAWebTosJob","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebUserPrefsStore","WAWebWamoNewsletterGatingUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u="20210210",v=function(a){function b(b){return a.call(this,"Unknown user notice id: "+b)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("UnknownUserNoticeIdError")),w={minTimeout:1e3,maxTimeout:16e3,retries:5,signal:new AbortController().signal};a=function(a){function e(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.$TosManagerImpl$p_1=[],b.$TosManagerImpl$p_2=d("WAWebTosJob").DEFAULT_TOS_REFRESH_INTERVAL*1e3,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.clearDisclosureNoticeIds_TESTONLY=function(){this.$TosManagerImpl$p_1=[]};f.$TosManagerImpl$p_3=function(){var a=[];d("WAWebBizGatingUtils").tosFetchEnabled()&&a.push(u);if(d("WAWebBotGating").isBotEnabled()){a.push(d("WAWebBotTosIds").getBotAgentTosId(),d("WAWebBotTosIds").getBotInvokeTosId(),d("WAWebBotTosIds").getBotShortcutTosId());var b=d("WAWebBotGating").getMasterBotNoticeId();b!=null&&a.push(b.toString())}(d("WAWebBotGating").isBizBot1pEnabled()||d("WAWebBotGating").isBizBot3pEnabled())&&a.push(d("WAWebBotTosIds").getBizBotTosId());d("WAWebBotGating").isUgcBotEnabled()&&a.push(d("WAWebBotTosIds").getUgcAiStudioTosId());d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()&&a.push(d("WAWebMmSignalSharingTos").getMmSignalSharingDisclosureTosId());return a};f.$TosManagerImpl$p_4=function(){var a=this.$TosManagerImpl$p_3().concat(this.$TosManagerImpl$p_1);return a};f.$TosManagerImpl$p_5=function(a){a=new Set(this.$TosManagerImpl$p_1.concat(a));this.$TosManagerImpl$p_1=Array.from(a)};f.getLastAcceptedTime=function(a){a=this.$TosManagerImpl$p_6(a);a=c("WAWebUserPrefsStore").getUser(a);return a!=null&&typeof a==="number"?d("WATimeUtils").castToUnixTime(a):null};f.getState=function(a){try{var b=this.getStoreKey(a);b=c("WAWebUserPrefsStore").getUser(b);b=typeof b==="string"&&(b==="UNKNOWN"||b==="NOT_ACCEPTED"||b==="ACCEPTED")?b:"UNKNOWN";return b}catch(b){b instanceof v||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unexpected error when getting notice id state: ",""])),a).tags("tos-manager").sendLogs("Unexpected error when getting notice id state").devConsole(b);return"UNKNOWN"}};f.setState=function(a,b,c){this.$TosManagerImpl$p_1.includes(a)||x()&&this.$TosManagerImpl$p_3().includes(a)?(this.$TosManagerImpl$p_7(a,b,c),this.trigger("change")):d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager unrecognized user notice id: ",""])),a)};f.$TosManagerImpl$p_7=function(a,b,d){c("WAWebUserPrefsStore").setUser(this.getStoreKey(a),b),b==="ACCEPTED"&&d!=null?c("WAWebUserPrefsStore").setUser(this.$TosManagerImpl$p_6(a),d):c("WAWebUserPrefsStore").setUser(this.$TosManagerImpl$p_6(a),void 0)};f.run=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this;if(!x()&&!d("WAWebNewsletterGatingUtils").isNewsletterEnabled())return;try{yield d("WAExponentialBackoff").exponentialBackoff(w,function(a,c){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, run"])));return b.$TosManagerImpl$p_8()["catch"](function(b){if(b instanceof d("WAWebBackendErrors").ServerStatusCodeError)switch(b.statusCode){case 500:d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager query failed, retriable error: ",", failCount ",""])),b.message,c);return a(b)}throw b})})}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager state pull failed, error: ",""])),a).verbose().devConsole(a).sendLogs("ToS state manager run failed");if(a instanceof d("WAWebBackendErrors").ServerStatusCodeError&&a.statusCode===500)d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, will retry in "," ms"])),this.$TosManagerImpl$p_2);else{d("WALogger").DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, non recoverable error, exiting"])));return}}if((a==null?void 0:a.singleRun)===!0)return;if(this.$TosManagerImpl$p_9(this.$TosManagerImpl$p_4()).length>0){a=d("WAWebUserPrefsMeUser").getMaybeMePnUser();yield d("WAPromiseDelays").delayMs(this.$TosManagerImpl$p_2);d("WAWebUserPrefsMeUser").getMaybeMePnUser()===a&&void this.run()}});function c(b){return a.apply(this,arguments)}return c}();f.$TosManagerImpl$p_8=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;if(!d("WAWebUserPrefsMeUser").getMaybeMePnUser())return;var e=(yield (t||(t=b("Promise"))).all([this.$TosManagerImpl$p_10(),this.$TosManagerImpl$p_11()])),f=e[0];e=e[1];this.$TosManagerImpl$p_2=Math.min(f.refresh,e.refresh)*1e3;f=f.notice.concat(e.notice);var g=new Set(this.$TosManagerImpl$p_4());e=!1;f.filter(function(a){return g.has(a.id)}).forEach(function(b){var f=b.state?"ACCEPTED":"NOT_ACCEPTED",g=a.getStoreKey(b.id);c("WAWebUserPrefsStore").getUser(g)!==f&&(d("WALogger").DEV(o||(o=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, saving notice ",", state ",""])),b.id,f),c("WAWebUserPrefsStore").setUser(g,f),a.$TosManagerImpl$p_7(b.id,f,b.timestamp),e=!0)});c("WAWebUserPrefsStore").setUser(d("WAWebUserPrefsKeys").KEYS.TOS_STATE_FETCH_ITERATION,d("WAWebBizGatingUtils").tosFetchIteration());e&&(d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, trigger change event"]))),this.trigger("change"))});function e(){return a.apply(this,arguments)}return e}();f.$TosManagerImpl$p_12=function(){return{refresh:d("WAWebTosJob").DEFAULT_TOS_REFRESH_INTERVAL,notice:[]}};f.$TosManagerImpl$p_10=function(){if(!x())return(t||(t=b("Promise"))).resolve(this.$TosManagerImpl$p_12());var a=this.$TosManagerImpl$p_9(this.$TosManagerImpl$p_3());if(a.length>0){d("WALogger").DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager, fetch state for: ",""])),a);return d("WAWebTosJob").queryTosState(a)}return(t||(t=b("Promise"))).resolve(this.$TosManagerImpl$p_12())};f.$TosManagerImpl$p_11=function(){d("WAWebNewsletterGatingUtils").isNewsletterEnabled()&&this.populateTosManagerNewsletterIds();return this.$TosManagerImpl$p_1.length===0?(t||(t=b("Promise"))).resolve(this.$TosManagerImpl$p_12()):d("WAWebGetUserDisclosuresAction").getUserDisclosuresAction()};f.$TosManagerImpl$p_9=function(a){var b=this,e=parseInt(c("WAWebUserPrefsStore").getUser(d("WAWebUserPrefsKeys").KEYS.TOS_STATE_FETCH_ITERATION),10)||0;if(d("WAWebBizGatingUtils").tosFetchIteration()>e)return a;var f=a.map(function(a){return b.getState(a)});return a.filter(function(a,b){return f[b]!=="ACCEPTED"})};f.getStoreKey=function(a){var b=new Set(this.$TosManagerImpl$p_4());if(b.has(a))return"TOS_STATE_"+a;throw new v(a)};f.$TosManagerImpl$p_6=function(a){var b=new Set(this.$TosManagerImpl$p_4());if(b.has(a))return"TOS_STATE_"+a+"_LAST_ACCEPTED_TIME";throw new v(a)};f.maybeUpdateServer=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=this;if(x())try{var e=new Set(a);yield d("WAExponentialBackoff").exponentialBackoff(w,function(a,f){var g=c.$TosManagerImpl$p_13(e);return g.length>0?d("WAWebTosJob").updateTosState(g)["catch"](function(b){if(b instanceof d("WAWebBackendErrors").ServerStatusCodeError&&b.statusCode===500){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager server session state update failed, retriable error: ",", failCount ",""])),b.message,f);return a(b)}throw b}):(t||(t=b("Promise"))).resolve()})}catch(a){d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ToS state manager server session state update failed, error: ",""])),a).verbose().devConsole(a).sendLogs("ToS state manager server session state update failed")}});function c(b){return a.apply(this,arguments)}return c}();f.$TosManagerImpl$p_13=function(a){var b=this;if(d("WAWebUserPrefsMeUser").getMaybeMePnUser()){var c=this.$TosManagerImpl$p_3().map(function(a){return b.getState(a)});return this.$TosManagerImpl$p_3().filter(function(b,d){return c[d]==="ACCEPTED"&&a.has(b)})}return[]};f.$TosManagerImpl$p_14=function(a){c("WAWebUserPrefsStore").setUser(this.getStoreKey(a),void 0),c("WAWebUserPrefsStore").setUser(this.$TosManagerImpl$p_6(a),void 0)};f.resetAllState=function(){var a=this;this.$TosManagerImpl$p_4().forEach(function(b){a.$TosManagerImpl$p_14(b)});void d("WAWebTosJob").deleteTosState(u)};f.resetState=function(a){this.$TosManagerImpl$p_14(a),void d("WAWebTosJob").deleteTosState(a)};f.populateTosManagerNewsletterIds=function(){var a=[d("WAWebNewsletterGatingUtils").getNewsletterProducerTos(),d("WAWebNewsletterGatingUtils").getNewsletterConsumerTos(),d("WAWebNewsletterGatingUtils").getNewsletterAdminInviteTos()].concat(d("WAWebWamoNewsletterGatingUtils").getWamoNotices());this.$TosManagerImpl$p_5(a)};return e}(c("WAWebEventEmitter"));function x(){return d("WAWebBizGatingUtils").tosFetchEnabled()||d("WAWebBotGating").isBizBot1pEnabled()||d("WAWebBotGating").isBizBot3pEnabled()||d("WAWebBotGating").isUgcBotEnabled()}e=new a();g.TOS_3_ID=u;g.TosManager=e}),98);
__d("WAWebApi",["$InternalEnum"],(function(a,b,c,d,e,f){a={GROUP_INVITE:"GROUP_INVITE",MSG_SEND:"MSG_SEND",INVALID:"INVALID",CATALOG:"CATALOG",PRODUCT:"PRODUCT",PUSH_NOTIFICATION:"PUSH_NOTIFICATION",CREATE_COMMUNITY:"CREATE_COMMUNITY",NEWSLETTER:"NEWSLETTER",AVATAR_STICKERPACK:"AVATAR_STICKERPACK",ADVERTISE:"ADVERTISE",MANAGE_ADS:"MANAGE_ADS",MESSAGE_YOURSELF:"MESSAGE_YOURSELF",BROADCAST:"BROADCAST",STATUS_POST:"STATUS_POST",EDIT_PROFILE_PICTURE:"EDIT_PROFILE_PICTURE",CALL_USER:"CALL_USER",PAYMENT_LINK:"PAYMENT_LINK",FAVORITES:"FAVORITES",OPEN_CATALOG:"OPEN_CATALOG",STICKER_PACK:"STICKER_PACK",CATALOG_LINKING_CHAT_PSA:"CATALOG_LINKING_CHAT_PSA",UGC_BOT:"UGC_BOT",META_VERIFIED:"META_VERIFIED",CALL_LINK:"CALL_LINK",CTWA_ADS_DATA_SHARING:"CTWA_ADS_DATA_SHARING",WEB_REGISTRATION:"WEB_REGISTRATION",WEB_REGISTRATION_CAMPAIGN:"WEB_REGISTRATION_CAMPAIGN",BRAZIL_PAYMENTS:"BRAZIL_PAYMENTS"};c=b("$InternalEnum").Mirrored(["PIX_FAQ","PIX_ONBOARDING"]);f.APICmd=a;f.BrazilPaymentResultSubtype=c}),66);
__d("WAWebApiParseUtils",["WAWebBuildConstants"],(function(a,b,c,d,e,f,g){b=function(a){return a.replace(/\/+$/,"")};c=b(d("WAWebBuildConstants").BUILD_URL).replace(/[\/\.]/g,"\\$&");e="((?:/\\w+)*)";f="(?:(?:/\\w+)*)";function a(a){a=a.hostname;return a==="whatsapp.com"||a==="www.whatsapp.com"||a==="wa.me"}g.ORIGIN=c;g.OPTIONAL_PATH_PART=e;g.OPTIONAL_NON_CAPTURING_PATH_PART=f;g.isWhatsappHost=a}),98);
__d("WAWebBroadcastApiParse",["$InternalEnum","WAWebABProps","WAWebApiParseUtils"],(function(a,b,c,d,e,f,g){var h="channel",i="channels",j="status",k="updates",l=new RegExp("^"+d("WAWebApiParseUtils").ORIGIN+d("WAWebApiParseUtils").OPTIONAL_PATH_PART+"/accept/?\\?channel_invite_code=(?:&.*)?$","i"),m=b("$InternalEnum").Mirrored(["Newsletter","Status"]);function n(a){return a.length===0||a.length===1&&a[0]===""}function a(a){try{var b=new URL(a),c=b.pathname;c=c.split("/");c[0];var e=c[1];c=c.slice(2);if(d("WAWebApiParseUtils").isWhatsappHost(b)){if(!n(c))return null;switch(e){case i:case h:return{feature:m.Newsletter,url:b.href};case j:return{feature:m.Status,url:b.href};case k:return!d("WAWebABProps").getABPropConfigValue("status_deeplink_enabled")?null:{feature:m.Status,url:b.href}}}c=a.match(l);if(c)return{feature:m.Newsletter,url:a}}catch(a){}return null}g.BroadcastFeatureType=m;g.parseBroadcastFeatureLink=a}),98);
__d("WAWebExternalCtxConfig",["WAWebABProps"],(function(a,b,c,d,e,f,g){var h="partnertoken",i="token";function a(){return d("WAWebABProps").getABPropConfigValue("external_ctx_authorise_wa_chat")}function j(){return d("WAWebABProps").getABPropConfigValue("external_ctx_foa_logging")===1}function b(){var a=d("WAWebABProps").getABPropConfigValue("external_ctx_authorise_existing_chats");switch(a){case 1:return"NEW_CHATS_OR_EXISTING_CHATS_WITH_PARTNER_LINKS";case 2:return"ALL_CHATS";default:return"NEW_CHATS_ONLY"}}function c(){var a=d("WAWebABProps").getABPropConfigValue("external_ctx_url_param_names")||"";a=a.split(",").map(function(a){return a.trim()}).filter(function(a){return a!==""});a=a.length>0?a:[h];j()&&a.push(i);return a}g.isCtxLoggingEnabled=a;g.getFirstMessageLoggingOption=b;g.getExternalCtxUrlParamNames=c}),98);
__d("WAWebChatEntryPoint",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["NewsletterIntegrity","NewsletterChatlist","NewsletterDirectory","NewsletterDirectorySearch","NewsletterDirectoryCategory","NewsletterDirectoryCategorySearch","NewsLetterRecommendation","NewsletterUpdatesTab","NewsletterUpdatesTabSearch","NewsletterCreationFlow","NewsletterAdminInviteAcceptModal","NewsletterPostLinkCard","NewsletterLinkCard","NewsletterLinkCardButton","ForwardedNewsletterMessage","NewsletterCTAOnStatus","SimilarNewsletters","Link","Deeplink","Chatlist","Vcard","Notification","Unknown","BotChatListShortcut","PrivateReply","DirectMessage","ContactInfo","Mention","ChatsTab","NewslettersTab","CommunitiesTab","VoipWindow","MetaAINullStateSuggestion","MetaAITypeaheadSuggestion"]);f.ChatEntryPoint=a}),66);
__d("WAWebNewsletterApiParse",["$InternalEnum","WAWebApiParseUtils","WAWebChatEntryPoint","WAWebWamEnumTsSurface"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["Handle","InviteCode","Id"]),i="channel",j="create",k="directory",l=new RegExp("^"+d("WAWebApiParseUtils").ORIGIN+d("WAWebApiParseUtils").OPTIONAL_PATH_PART+"/accept/?\\?channel_invite_code=(\\w+)(?:&.*)?$","i"),m=new RegExp("^whatsapp://("+i+")/(\\w+)/?(?:\\?.*)?$","i");function n(a){return a.length===0||a.length===1&&a[0]===""}function o(a,b){try{var c=new URL(a),e=c.pathname;e=e.split("/");e[0];var f=e[1],g=e[2];e=e.slice(3);if(f===i&&d("WAWebApiParseUtils").isWhatsappHost(c)){if(n(e))switch(g){case j:return{type:"create",url:c.href};case k:return{type:"directory",url:c.href};default:if(g!=null&&g!=="")return{identifier:g,url:c.href,identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Link,discoverySurface:b!=null?b:d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_LINK}}if(g!==j&&g!==k&&(e.length===1||e.length===2&&e[1]==="")){f=parseInt(e[0],10);return babelHelpers["extends"]({identifier:g,url:c.href,identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Link,discoverySurface:d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_LINK},!Number.isNaN(f)&&{serverId:f})}}b=p(l,a);if(b!=null)return b;e=p(m,a);return e!=null?e:null}catch(a){return null}}function p(a,b){a=b.match(a);if(a){var c=a[2];if(c===j)return{type:"create",url:b};return c===k?{type:"directory",url:b}:{identifier:a[2],url:a[1]||"/",identifierType:h.InviteCode,type:"view",chatEntryPoint:d("WAWebChatEntryPoint").ChatEntryPoint.Deeplink,discoverySurface:d("WAWebWamEnumTsSurface").TS_SURFACE.CHANNEL_LINK}}return null}function a(a){if(a==null)return!1;return a.startsWith("http://")||a.startsWith("https://")?o(a)!=null:o("https://"+a)!=null}g.NewsletterIdentifierType=h;g.parseNewsletter=o;g.isNewsletterInviteCode=a}),98);
__d("WAWebStatusApiParse",["$InternalEnum","WAWebApiParseUtils","WAWebPonyfillsUrlSearchParams"],(function(a,b,c,d,e,f,g){"use strict";var h="status",i="text",j="photo",k=b("$InternalEnum").Mirrored(["Text","Media"]);function l(a){return a.length===0||a.length===1&&a[0]===""}function a(a){try{a=new URL(a);var b=a.pathname;if(!d("WAWebApiParseUtils").isWhatsappHost(a))return null;b=b.split("/");b[0];var e=b[1];b=b.slice(2);if(!l(b))return null;if(e!==h)return null;b=a.searchParams||new(c("WAWebPonyfillsUrlSearchParams"))(a.search);e=b.get(i);if(e!=null)return{postType:k.Text,url:a.href};e=b.get(j);if(e!=null)return{postType:k.Media,url:a.href}}catch(a){}return null}g.StatusPostType=k;g.parseStatusPostFeatureLink=a}),98);
__d("WAWebWamEnumDeepLinkType",[],(function(a,b,c,d,e,f){a=Object.freeze({DEEP_LINK_UNKNOWN:1,DEEP_LINK_CHAT:2,DEEP_LINK_CONTACT_QR_CODE:3,DEEP_LINK_PAYMENT:4,DEEP_LINK_PRODUCT:5,DEEP_LINK_CATALOG:6,DEEP_LINK_FUTURE_PROOF:7,DEEP_LINK_GROUP_INVITE:8,DEEP_LINK_MSG_FORWARD:9,DEEP_LINK_MESSAGE_QR_CODE:10,DEEP_LINK_OPT_IN_QR_CODE:11,DEEP_LINK_CTWA:12,DEEP_LINK_STICKERPACK:13,DEEP_LINK_NOVI_HUB:14,DEEP_LINK_NOVI_ADD_DEBIT_CARD:15,DEEP_LINK_NOVI_ADD_BANK_ACCOUNT:16,DEEP_LINK_NOVI_WITHDRAW:17,DEEP_LINK_NOVI_RESET_PASSWORD:18,DEEP_LINK_PAYMENT_SIGNUP:19,DEEP_LINK_BIZTOOLS_ACCOUNTS:20,DEEP_LINK_PAYMENT_VIRALITY:21,DEEP_LINK_SETTINGS_ACCOUNT_DELETE:22,DEEP_LINK_SETTINGS_ACCOUNT_REQUEST_INFO:23,DEEP_LINK_SETTINGS_CHATS_HISTORY:24,DEEP_LINK_DISAPPEARING_MODE:25,DEEP_LINK_ARCHIVE_SETTINGS:26,DEEP_LINK_TOS:27,DEEP_LINK_NOVI_CARE:28,DEEP_LINK_NOVI_TPP_ACCOUNT_LINKING:29,DEEP_LINK_CONTACT_SUPPORT:30,DEEP_LINK_BIZTOOLS_DIRECTORY:31,DEEP_LINK_DIRECTORY:32,DEEP_LINK_CALL:33,DEEP_LINK_DIRECTORY_DEEPER_CATEGORY_SELECTION:34,DEEP_LINK_PHOENIX:35,DEEP_LINK_HELP_CENTER_TO_SETTINGS_CHATS:36,DEEP_LINK_CREATE_COMMUNITY:37,DEEP_LINK_SMB_AD_CREATION:38,DEEP_LINK_SMB_MANAGE_ADS:39,DEEP_LINK_SMB_MANAGE_ADS_DETAIL:40,DEEP_LINK_STATUS_SHARE:41,DEEP_LINK_PREMIUM:42,DEEP_LINK_SETTINGS_LINKED_DEVICES:43,DEEP_LINK_SMB_AD_CREATION_FROM_CATALOG:44,DEEP_LINK_SMB_AD_CREATION_FROM_BIZTAB:45,DEEP_LINK_SMB_EDIT_PROFILE:46,DEEP_LINK_EDIT_PROFILE_PIC:47,DEEP_LINK_SMB_EDIT_CATALOG:48,DEEP_LINK_SMB_BIZ_HOURS:49,DEEP_LINK_SMB_LOCATION:50,DEEP_LINK_SMB_LINKED_ACCOUNTS:51,DEEP_LINK_PRIVACY_SETTINGS:52,DEEP_LINK_SMB_EDIT_DESCRIPTION:53,DEEP_LINK_SMB_AD_CREATION_RESUME:54,DEEP_LINK_PRIVACY_DISCLOSURE:55,DEEP_LINK_CHANNEL:56,DEEPLINK_SMB_BIZ_WEBSITE:57,DEEP_LINK_PRIVACY_CHECKUP:58,DEEP_LINK_SMB_SELF_CATALOG:59,DEEP_LINK_SCAN_MIGRATION_QR_CODE:60,DEEP_LINK_PROXY:61,DEEP_LINK_HELP:62,DEEP_LINK_PRICE_TIER:63,DEEP_LINK_CALLING_PRIVACY:64,DEEP_LINK_PAYMENTS_PUSH_PROVISIONING:65,DEEP_LINK_FB_EVENT_LINK:66,DEEP_LINK_SETTINGS_ACCOUNT_2FA:67,DEEP_LINK_SMB_ADVERTISE_PROFILE:68,DEEP_LINK_SMB_LABELS_WITH_BIZTAB:69,DEEP_LINK_SMB_GREETING_MESSAGE_WITH_BIZTAB:70,DEEP_LINK_SMB_AWAY_MESSAGE_WITH_BIZTAB:71,DEEP_LINK_SMB_ADVERTISE_LATEST_STATUS:72,DEEP_LINK_SMB_PROFILE_COMPLETENESS:73,DEEP_LINK_SMB_AD_DETAILS:74,DEEP_LINK_SETTINGS_ACCOUNT_SWITCHER:75,DEEP_LINK_CHAT_TRANSFER:76,DEEP_LINK_CODE_LINKING:77,DEEP_LINK_MARKETING_MESSAGE:78,DEEP_LINK_HOME_CHATS:79,DEEP_LINK_MESSAGE_YOURSELF:80,DEEP_LINK_SETTINGS_ACCOUNT_EMAIL:81,DEEP_LINK_EDIT_AD:82,DEEP_LINK_MESSAGING_GUIDE:83,DEEP_LINK_SMB_DRAFT_AD:84,DEEP_LINK_CALLING_AWARENESS_VOICE_CHAT:85,DEEP_LINK_CALLING_AWARENESS_SCHEDULED_CALL:86,DEEP_LINK_COEXISTENCE_ONBOARDING:87,DEEP_LINK_SETTINGS_STORAGE_MANAGEMENT:88,DEEP_LINK_PAYMENT_BRAZIL_MERCHANT:89,DEEP_LINK_PAYMENT_BRAZIL_BUYER:90,DEEP_LINK_PRIVACY_GROUPS:91,DEEP_LINK_PRIVACY_PROFILE:92,DEEP_LINK_AIS:93,DEEP_LINK_PENDING_AD_PAYMENT:94,DEEP_LINK_PENDING_AD_REVIEW:95,DEEP_LINK_SETTINGS_ACCOUNT_VERIFY_EMAIL:96,DEEP_LINK_CTWA_EXTERNAL:97,DEEP_LINK_SMB_BIZ_SEARCH_ONBOARDING_SHEET:98,DEEP_LINK_CALLING_AWARENESS_GROUP_CALL:99,DEEP_LINK_SMB_ORDERS_HOME:100,DEEP_LINK_ADS_DATA_SHARING:101,DEEP_LINK_VIDEO_PROMOTION:102,DEEP_LINK_CTWA_RECENTLY_SHARED_MEDIA:103,DEEP_LINK_MARKETING_MESSAGE_OPT_IN:104,DEEP_LINK_GROUPS_PRIVACY:105,DEEP_LINK_PROFILE_PRIVACY:106,DEEP_LINK_ORDERS_EDUCATION_VIDEO:107,DEEP_LINK_META_VERIFIED:108,DEEP_LINK_SMB_AGENT_ONBOARDING:109,DEEP_LINK_SETTINGS_CHATS_BACKUP:110,DEEP_LINK_COUPONS_PROMOTION_IMPRESSION:111,DEEP_LINK_INVITE_A_FRIEND:112,DEEP_LINK_UPDATES:113,DEEP_LINK_CONTACTS_PERMISSION:114,DEEP_LINK_NOTIFICATIONS_PERMISSION:115,DEEP_LINK_WABAI_ONBOARDING:116,DEEP_LINK_CHAT_LIST:117,DEEP_LINK_BRAZIL_MERCHANT_PIX_ADD:118,DEEP_LINK_PAYMENT_UPI_EXPLORE_BUSINESSES:119,DEEP_LINK_PAYMENT_UPI_ACCOUNT_RECOVERY:120,DEEP_LINK_PAYMENT_UPI_ADD_BANK_ACCOUNT:121,DEEP_LINK_PAYMENT_UPI_START_CAMERA:122,DEEP_LINK_PAYMENT_UPI_RESUME_ONBOARDING:123,DEEP_LINK_PAYMENT_UPI_ADD_NUMBER:124,DEEP_LINK_PAYMENT_UPI_SEND_PAYMENT:125,DEEP_LINK_PAYMENT_UPI_SET_PIN:126,DEEP_LINK_PAYMENT_UPI_SET_2FA:127,DEEP_LINK_SETTINGS_ACCOUNT_PASSKEYS:128,DEEP_LINK_DOWNLOAD_SOURCE_SFW:129,DEEP_LINK_AVATAR_EDITOR:130,DEEP_LINK_BIZTOOLS_ACCOUNTS_LINK_FB:131,DEEP_LINK_PAYMENT_UPI_PAYMENT_HISTORY:132,DEEP_LINK_PAYMENT_UPI_HELP_CENTER:133,DEEP_LINK_PAYMENT_UPI_ACCOUNT_DETAILS:134,DEEP_LINK_PAYMENT_UPI_INVITE_OTHERS:135,DEEP_LINK_PAYMENT_UPI_SEND_FIRST_PAYMENT:136,DEEP_LINK_CLICK_TO_CALL:137,DEEP_LINK_INTER_APP_IDENTITY_SWITCH:138,DEEP_LINK_LISTS:139,DEEP_LINK_META_AI_IMAGINE_ME_ONBOARDING:140,DEEP_LINK_MEDIA_SEND_LIVE_ACTIVITY_OPEN_APP:141,DEEP_LINK_WAMO:142,DEEP_LINK_PAYMENT_UPI_QR_PROMINENCE:143,DEEP_LINK_SURVEY:144,DEEP_LINK_SETTINGS_ACCOUNT_SECURITY_CHECKUP:145,DEEP_LINK_THUNDERSTORM:146,DEEP_LINK_HELP_BOTTOMSHEET:147,DEEP_LINK_FAVORITE_CHAT_FILTER:148,DEEP_LINK_CATALOG_CATEGORY:149,DEEP_LINK_CATALOG_COLLECTION:150,DEEP_LINK_MAIBA_WEB_COEX_ONBOARDING:151,DEEP_LINK_SMB_ADD_PRODUCT:152,DEEP_LINK_CALL_PHONE_NUMBER:153,DEEP_LINK_ABPROP_OVERRIDE:154,DEEP_LINK_PROFILE:155,DEEP_LINK_SETTINGS_CHAT_THEMES:156,DEEP_LINK_AIMEDIAINPUT:157,DEEP_LINK_AIVOICE:158,DEEP_LINK_NEW_CUSTOM_LIST:159,DEEP_LINK_SHARED_DEVICE_PRIVACY:160,DEEP_LINK_IPAD_LAUNCH_APPEVENT:161,DEEP_LINK_CATALOG_SETTINGS:162,DEEP_LINK_BOOST_CATALOG:163,DEEP_LINK_PRIVACY_STATUS:164,DEEP_LINK_INTEROP_SETTINGS:165,DEEP_LINK_SMB_AD_RESOLVE_PAYMENT:166,DEEP_LINK_CONSENT_LAUNCHER:167,DEEP_LINK_SETTINGS_HOME_SCREEN_NOTIFICATIONS:168,DEEP_LINK_WA_LINK_ACCOUNTS:169,DEEP_LINK_PAYMENT_PIX_DEEP_INTEGRATION:170,DEEP_LINK_ACCOUNT_TRANSFER:171,DEEP_LINK_SG_CONNECT_BOTTOMSHEET:172,DEEP_LINK_BIZ_AI_LEARNING_SUMMARY:173,DEEP_LINK_BIZ_AI_HUB:174,DEEP_LINK_BIZ_MANAGE_DATA_SHARING:175,DEEPLINK_SETTINGS_EDIT_PROFILE_PHOTO:176,DEEPLINK_ADD_STATUS_GALLERY:177,DEEP_LINK_TURN_OFF_DO_NOT_DISTURB:178,DEEP_LINK_SHARE_WHATSAPP_WEB:179,DEEP_LINK_ACCOUNTS_CENTER_ADD_ACCOUNT:180,DEEP_LINK_COEXISTENCE_REONBOARDING:181,DEEP_LINK_SMB_QUICK_REPLIES_WITH_BIZTAB:182,DEEP_LINK_STATUS_PRIVACY:183,DEEP_LINK_IAP_PB_SUBSCRIPTION_HUB:184,DEEP_LINK_SHARESHEET:185,DEEP_LINK_SETTINGS_RECOMMENDED_CHANNELS_NOTIFICATIONS:186,DEEP_LINK_PAA_LINKING:187,REGISTRATION:188,DEEP_LINK_SMB_LEARNING_HUB:189,DEEP_LINK_SUSPICIOUS_LINK:190,DEEP_LINK_REENGAGE_MESSAGE_REMINDER:191,DEEP_LINK_SETTINGS_BACKUP_TOKEN_EDUCATION_UPSELL:192,DEEP_LINK_WEB_SIGNUP:193,DEEP_LINK_SMB_BILLING_HUB:194,DEEP_LINK_WA_ME_DOWNLOAD:195,DEEP_LINK_SMB_DAILY_ADS_SUMMARY:196,DEEP_LINK_SET_ABOUT:197,DEEP_LINK_SMB_BIZTOOLS:198,DEEP_LINK_PRIVACY_ABOUT:199,DEEP_LINK_AUTOMATIC_EVENTS_ONBOARDING_NUX:200,DEEP_LINK_SERVER_INVITE:201,DEEP_LINK_PAYMENT_UPI_LITE_ONBOARD:202,DEEP_LINK_AVATAR_UNLOCKABLES:203,DEEP_LINK_SCALE_GOOD_CAMPAIGNS:204,DEEP_LINK_GOOGLE_ELIGIBILITY_API_OPT_OUT:205});f.DEEP_LINK_TYPE=a}),66);
__d("WAWebApiParse",["PaymentLink","WAArrayBufferUtils","WABase64","WABinary","WALogger","WAWebABProps","WAWebApi","WAWebApiParseUtils","WAWebBroadcastApiParse","WAWebExternalCtxConfig","WAWebFaqUrl","WAWebNewsletterApiParse","WAWebPonyfillsUrlSearchParams","WAWebStatusApiParse","WAWebUsernameGatingUtils","WAWebUsernameTypes","WAWebVoipGatingUtils","WAWebWamEnumDeepLinkType","gkx","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j=new RegExp("^"+(e=d("WAWebApiParseUtils")).ORIGIN+e.OPTIONAL_PATH_PART+"/accept/?\\?code=(\\w+)(?:&.*)?$","i"),k=/^https?:\/\/chat\.whatsapp\.com\/invite\/(\w+)(?:\?.*)?$/i,l=/^https?:\/\/chat\.whatsapp\.com\/(\w+)(?:\?.*)?$/i,m=/^whatsapp:\/\/chat\/?\?code=(\w+)(?:&.*)?$/i,n=function(a){var b=a.match(j);if(b)return{code:b[2],url:b[1]||"/"};b=a.match(k);if(b)return{code:b[1]};b=a.match(l);if(b)return{code:b[1]};b=a.match(m);if(b)return{code:b[1]}},o="utm_source",p="utm_campaign",q=["utm_source","utm_campaign","text","phone","data","source","context","icebreaker","source_url","type","token","attachment_uris","username","jid"];function r(a){return q.find(function(b){return b===a})}var s=32;function t(a){if(!a||typeof a!=="string")return;a=d("WABinary").Binary.build(a);if(a.size()>d("WAWebABProps").getABPropConfigValue("ctwa_data_max_length"))return;return a.readBuffer()}function u(a,b){a=t(a);if(!a)return;b.conversionTuple==null?b.conversionTuple={conversionData:a}:b.conversionTuple.conversionData=a}function v(a,b){a=a;var c=d("WABinary").numUtf8Bytes(a);if(c>s)return;b.conversionTuple==null?b.conversionTuple={conversionSource:a}:b.conversionTuple.conversionSource=a}function w(a,b,c){switch(a){case"source_url":c.ctwaContextLinkData!=null?c.ctwaContextLinkData.sourceUrl=b:c.ctwaContextLinkData={sourceUrl:b};return;case"context":c.ctwaContextLinkData!=null?c.ctwaContextLinkData.context=b:c.ctwaContextLinkData={context:b};return;case"icebreaker":c.ctwaContextLinkData!=null?c.ctwaContextLinkData.icebreaker=b:c.ctwaContextLinkData={icebreaker:b};return}}function x(a){if(a!=null&&a.split(".").length===3){a=a.split(".")[1].replace(/\s/g,"");try{a=d("WABase64").decodeB64UrlSafe(a);return JSON.parse(d("WAArrayBufferUtils").arrayBufferToString(a))}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseCTWADeeplinkToken: failed to parse token: ",""])),String(a)).sendLogs("ctwa-deeplink-token-parse-error").tags("ctwa-error");return{}}}return{}}function y(a){var b={};Object.keys(a).forEach(function(c){var d=a[c];if(d==null)return;switch(c){case"data":u(d,b);break;case"source":v(d,b);break;case"source_url":case"context":case"icebreaker":w(c,d,b);break;default:(c==="phone"||c==="text"||c==="type")&&(b[c]=d)}});return b}function z(a,b){var e={};new(c("WAWebPonyfillsUrlSearchParams"))(a).forEach(function(a,b){b=r(b.toLowerCase());if(b==null)return;switch(b){case"data":u(a,e);break;case"source":v(a,e);break;case"source_url":case"context":case"icebreaker":w(b,a,e);break;case"utm_campaign":e.utm!=null?e.utm.campaign=a:e.utm={campaign:a};break;case"utm_source":e.utm!=null?e.utm.source=a:e.utm={source:a};break;case"token":if(c("gkx")("16928")){var f=x(a);f=y(f);Object.assign(e,f);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseMsgSendParams:parsed values"]))).devConsole(e)}break;case"attachment_uris":e.attachmentUris=a.split(",");break;case"jid":e.jid=a;break;case"username":if(d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()){f=a.split("#");var g=f[0];f=f[1];e.username=g;f!=null&&d("WAWebUsernameTypes").isUsernameKey(f)&&(e.usernameKey=f)}break;default:b,e[b]=a}});e.phone!=null&&e.phone!==""&&(e.phone=e.phone.replace(/\D/g,"")+"@c.us",e.ctwaContextLinkData&&(e.ctwaContextLinkData.phone=e.phone));if(e.ctwaContextLinkData==null){a=T(b);a!=null&&(e.partnertoken=a)}if(!c("isStringNullOrEmpty")(e.phone)||!c("isStringNullOrEmpty")(e.text)||e.attachmentUris!=null&&e.attachmentUris.length>0||!c("isStringNullOrEmpty")(e.username))return e}var A=new RegExp("^"+e.ORIGIN+e.OPTIONAL_PATH_PART+"/send/?\\?(.+)$","i"),B=/^https?:\/\/api\.whatsapp\.com\/send\/?\?(.+)$/i,C=/^whatsapp:\/\/send\/?\?(.*)$/i,D=/^https?:\/\/wa\.me\/?(?:([0-9.]{0,20}))\/?\??(.+)?$/i,E=/^https?:\/\/wa\.me\/?(?:([0-9a-z.]{5,35}))?\/?\??(.+)?$/i,F=/^https?:\/\/wa\.me\/?(?:([0-9a-z._]{3,30}))(\/?\?([^#]*))?(?:#([0-9]{4}))?$/i;f=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})$/i;var G=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})$/i,H=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([0-9]{0,20})/([0-9]{0,20})$","i"),I=/^https?:\/\/wa\.me\/p\/([0-9]{0,20})\/([0-9]{0,20})(\/?\?.*)$/i,aa=/^whatsapp:\/\/product\/([0-9]{0,20})\/([0-9]{0,20})(\/?\?.*)$/i,ba=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([0-9]{0,20})/([0-9]{0,20})(/?.*)$","i"),ca=/^https?:\/\/wa\.me\/p\/([^\/]{0,200})\/([0-9]{0,20})$/i,da=/^whatsapp:\/\/product\/([^\/]{0,200})\/([0-9]{0,20})$/i,ea=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([^/]{0,200})/([0-9]{0,20})$","i"),fa=/^https?:\/\/wa\.me\/p\/([^\/]{0,200})\/([0-9]{0,20})(\/?\?.*)$/i,ga=/^whatsapp:\/\/product\/([^\/]{0,200})\/([0-9]{0,20})(\/?\?.*)$/i,ha=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/product/([^/]{0,200})/([0-9]{0,20})(/?.*)$","i"),ia=/^https?:\/\/wa\.me\/biz-add-product\/?(.+)$/i,ja=/^whatsapp-smb:\/\/advertise\/?(.+)$/i,ka=/^whatsapp-smb:\/\/manage-ads\/?(?:\?.*)?$/,la=/^whatsapp-smb:\/\/meta_verified\/?(?:\?.*)?$/i,ma=/^https?:\/\/wa\.me\/pay\/br\/merchant\/pix\/add\/?(.+)$/i,na=/^https?:\/\/faq\.whatsapp\.com\/1013401987232838\/?(.+)$/i,oa=/^whatsapp-smb:\/\/biztab\/manage-data-sharing\/?(?:\?.*)?$/i,pa=/^https?:\/\/wa\.me\/biz-catalog-settings\/?(.+)$/i,qa=/^https?:\/\/wa\.me\/biz-catalog-boost\/?(.+)$/i,ra=/^whatsapp:\/\/message_yourself\/?(?:\?.*)?$/i,sa=/^https?:\/\/wa\.me\/message_yourself\/?(?:\?.*)?$/i,ta=new RegExp("^"+e.ORIGIN+e.OPTIONAL_PATH_PART+"/calluser/?\\?(.+)$","i"),ua=/^https?:\/\/wa\.me\/call\?\\?(.+)$/i,va=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/reg/wacom[/\\?]{0,2}(.*)$","i"),J=[f,G,ca,da],K=[H,ea],L=[ba,ha],M=[I,aa,fa,ga],wa=[].concat(J,K,L,M);function N(a,b){for(var c=0;c<b.length;c++){var d=a.match(b[c]);if(d)return d}}f=function(a){return N(a,wa)!=null};var xa=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/push/","i"),O=/^https?:\/\/wa\.me\/c\/([0-9]{0,20})(?:\?.*)?$/i,P=/^whatsapp:\/\/catalog\/([0-9]{0,20})(?:\?.*)?$/i,Q=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/catalog/([0-9]{0,20})?$","i"),R=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/catalog/([0-9]{0,20})(/?.*)?$","i");G=function(a){return[O,P,Q,R].some(function(b){return a.match(b)})};var ya=/^https?:\/\/wa\.me\/favorites\/?(?:\\?.*)?$/i,za=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/favorites/?(?:\\?.*)?$","i");function S(a){if(d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled()){var b=a.match(F);if(b){var c;b[1]&&(c={username:b[1]});if(b[2]){var e=z(b[2],a);e&&(c=babelHelpers["extends"]({},c,e))}if(c){e=T(a);e!=null&&(c.partnertoken=e);b[4]&&(d("WAWebUsernameTypes").isUsernameKey(b[4])&&(c.usernameKey=b[4]))}return c}}}function Aa(a){var b=a.match(A);if(b){var c=z(b[2],a);if(c){c.url=b[1]||"/";return c}}b=a.match(B);if(b)return z(b[1],a);b=a.match(C);if(b)return z(b[1],a);b=a.match(D);if(b){var e;c=a.match(E);b[1]?e={phone:b[1]+"@c.us"}:c&&c[1]&&!c[2]&&(e={url:a,customURL:c[1]},e=babelHelpers["extends"]({},e,S(a)));if(b[2]){c=z(b[2],a);c&&(e=babelHelpers["extends"]({},e,c))}if(e){b=T(a);b!=null&&(e.partnertoken=b)}if(e!=null||!d("WAWebUsernameGatingUtils").username1on1ChatCreationEnabled())return e}return S(a)}function T(a){var b=d("WAWebExternalCtxConfig").getExternalCtxUrlParamNames();a=new URL(a);for(b of b){var c=a.searchParams.get(b);if(c!=null)return c}return null}var Ba=/^https?:\/\/wa\.me\/community\/create\/?(\?(.*))?$/i;function Ca(a){a=a.match(Ba);if(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a[1]).get("entrypoint");return{url:"/",entrypointType:a}}}function U(a,b){a={catalogOwnerJid:a[1]+"@s.whatsapp.net"};b=T(b);b!=null&&(a.partnertoken=b);return a}function V(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a);var b=a.get(o);a=a.get(p);if(a==null&&b==null)return null;var d={};b!=null&&(d.source=b);a!=null&&(d.campaign=a);return d}function Da(a){var b=a.match(O)||a.match(P);if(b)return U(b,a);b=a.match(Q);if(b)return babelHelpers["extends"]({},U(b,a),{url:"/"});b=a.match(R);if(b){var c=V(b[2]);return babelHelpers["extends"]({},U(b,a),c!=null&&{utm:c},{url:"/"})}}function W(a,b){a={productId:a[1],businessOwnerJid:a[2]+"@s.whatsapp.net"};b=T(b);b!=null&&(a.partnertoken=b);return a}function Ea(a){var b=N(a,J);if(b)return W(b,a);b=N(a,K);if(b)return babelHelpers["extends"]({},W(b,a),{url:"/"});b=N(a,L);if(b){var c=V(b[3]);return babelHelpers["extends"]({},W(b,a),c!=null&&{utm:c},{url:"/"})}b=N(a,M);if(b){c=V(b[3]);return babelHelpers["extends"]({},W(b,a),c!=null&&{utm:c})}}function Fa(a){a=a.match(xa);if(a)return{url:"/"}}function X(a){a=new(c("WAWebPonyfillsUrlSearchParams"))(a);var b=a.get("wa_campaign_id");if(b==null||b==="")return;a=a.get("wa_campaign_type");return a==null||a===""?null:{campaignId:b,campaignType:a}}function Ga(a){a=a.match(ja);if(a)return X(a[1])}function Ha(a){a=a.match(ia);if(a)return X(a[1])}function Ia(a){var b=a.match(ma);if(b){var c=X(b[1]);if(c)return{resultType:"BRAZIL_PAYMENTS",data:babelHelpers["extends"]({},c,{subType:d("WAWebApi").BrazilPaymentResultSubtype.PIX_ONBOARDING})}}b=a.match(na);if(b){c=X(b[1]);if(c)return{resultType:"BRAZIL_PAYMENTS",data:babelHelpers["extends"]({},c,{subType:d("WAWebApi").BrazilPaymentResultSubtype.PIX_FAQ})}}return null}function Ja(a){var b=a.match(pa);if(b){b=X(b[1]);if((b==null?void 0:b.campaignType)==="chat_psa")return{url:d("WAWebFaqUrl").getWhatsappUsePhoneFallbackUrl(),deepLinkType:d("WAWebWamEnumDeepLinkType").DEEP_LINK_TYPE.DEEP_LINK_CATALOG_SETTINGS}}b=a.match(qa);if(b){a=X(b[1]);if((a==null?void 0:a.campaignType)==="chat_psa")return{url:d("WAWebFaqUrl").getWhatsappUsePhoneFallbackUrl(),deepLinkType:d("WAWebWamEnumDeepLinkType").DEEP_LINK_TYPE.DEEP_LINK_BOOST_CATALOG}}}function Ka(a){return d("PaymentLink").getPaymentLinkUrlMetaData(a)}var La=/^https?:\/\/wa\.me\/stickerpack\/meta-avatar$/i,Ma=/^https?:\/\/wa\.me\/edit-profile-picture$/i,Y=/^https?:\/\/wa\.me\/stickerpack\/(?!meta-avatar)/i;function Z(a){a=a.match(Y);return a!=null}function Na(a){a=a.match(La);if(a)return{url:d("WAWebFaqUrl").getAvatarFaqUrl()}}var Oa=/^https?:\/\/wa\.me\/ais\/(\d{14,20})\/?(\?.*)?$/i,Pa=new RegExp("^"+e.ORIGIN+e.OPTIONAL_NON_CAPTURING_PATH_PART+"/ais/(\\d{14,20})/?(\\?.*)?$","i");function Qa(a){var b;a=((b=(b=a.match(Oa))!=null?b:a.match(Pa))!=null?b:[])[1];return a?{resultType:d("WAWebApi").APICmd.UGC_BOT,data:{fbid:a}}:null}function Ra(a){if(Z(a)){a=new URL(a);a=a.pathname.split("/");a[0];a[1];a=a[2];return a}}function Sa(a){var b=a.match(Y);if(b){b=Ra(a);return{resultType:"STICKER_PACK",data:{url:b}}}}var Ta=/^https:\/\/call\.whatsapp\.com\/(video|voice)\/(\w+)(?:\?.*)?$/i;function $(a){a=a.match(Ta);if(a)return{resultType:"CALL_LINK",data:{token:a[2],callType:a[1]}}}function a(a){return $(a)!=null}function Ua(a){a=a.match(va);if(a&&a[0])return{referrer:"wacom",url:"/"}}function b(a,b){if(typeof a!=="string")return{resultType:d("WAWebApi").APICmd.INVALID};var c=n(a);if(c)return{resultType:d("WAWebApi").APICmd.GROUP_INVITE,data:c};c=Da(a);if(c)return{resultType:d("WAWebApi").APICmd.CATALOG,data:c};c=Ea(a);if(c)return{resultType:d("WAWebApi").APICmd.PRODUCT,data:c};c=Ca(a);if(c)return{resultType:d("WAWebApi").APICmd.CREATE_COMMUNITY,data:c};c=Na(a);if(c)return{resultType:d("WAWebApi").APICmd.AVATAR_STICKERPACK,data:c};c=d("WAWebStatusApiParse").parseStatusPostFeatureLink(a);if(c)return{resultType:d("WAWebApi").APICmd.STATUS_POST,data:c};c=d("WAWebBroadcastApiParse").parseBroadcastFeatureLink(a);if(c)return{resultType:d("WAWebApi").APICmd.BROADCAST,data:c};c=d("WAWebNewsletterApiParse").parseNewsletter(a,b);if(c)return{resultType:d("WAWebApi").APICmd.NEWSLETTER,data:c};if([ra,sa].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.MESSAGE_YOURSELF};if([ya,za].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.FAVORITES,data:{url:"/"}};b=Ha(a);if(b!=null)return{resultType:d("WAWebApi").APICmd.OPEN_CATALOG,data:b};c=Ja(a);if(c!=null)return{resultType:d("WAWebApi").APICmd.CATALOG_LINKING_CHAT_PSA,data:c};b=Sa(a);if(b){return{resultType:d("WAWebApi").APICmd.STICKER_PACK,data:{url:(c=b.data.url)!=null?c:""}}}b=Fa(a);if(b)return{resultType:d("WAWebApi").APICmd.PUSH_NOTIFICATION,data:b};c=Ga(a);if(c!=null)return{resultType:d("WAWebApi").APICmd.ADVERTISE,data:c};if(d("WAWebVoipGatingUtils").callLinksEnabledOnWindowsHybrid()){b=$(a);if(b)return b}if(a.match(ka))return{resultType:d("WAWebApi").APICmd.MANAGE_ADS,trigger:"chatListBanner"};if(a.match(la))return{resultType:d("WAWebApi").APICmd.META_VERIFIED};if(a.match(oa)){c=new URL(a);b=c.searchParams.get("source");return{resultType:d("WAWebApi").APICmd.CTWA_ADS_DATA_SHARING,source:b!=null?b:"unknown"}}c=Ia(a);if(c)return c;if(a.match(Ma))return{resultType:d("WAWebApi").APICmd.EDIT_PROFILE_PICTURE};if(d("WAWebABProps").getABPropConfigValue("wa_web_calling_deep_link_error")&&[ta,ua].some(function(b){return a.match(b)}))return{resultType:d("WAWebApi").APICmd.CALL_USER,data:{url:"/"}};b=Ka(a);if(b!=null)return{resultType:d("WAWebApi").APICmd.PAYMENT_LINK,data:b};c=Qa(a);if(c)return c;b=Aa(a);if(b)return{resultType:d("WAWebApi").APICmd.MSG_SEND,data:b};c=Ua(a);return c!=null?{resultType:d("WAWebApi").APICmd.WEB_REGISTRATION_CAMPAIGN,data:c}:{resultType:d("WAWebApi").APICmd.INVALID}}g.parseConversionData=t;g.parseCTWADeeplinkToken=x;g.matchProductUrl=f;g.matchCatalogUrl=G;g.isStickerPackURL=Z;g.parseCallLink=$;g.isValidCallLink=a;g.parseAPICmd=b}),98);
__d("WAWebCTWAConstants",[],(function(a,b,c,d,e,f){a="11478";b="11525";c="11522";d="12015";e="12502";var g="12503",h=new Map([[a,"WHATSAPP_FOR_SMB_WEB_WHATSAPP_SMB_WEB_CHATLIST_BANNER_QP"],[b,"WHATSAPP_FOR_WEB_GROUPSBANNER_QP"],[c,"WHATSAPP_FOR_WEB_PROFILEBANNER_QP"],[d,"WHATSAPP_FOR_SMB_WEB_BUSINESS_HOME_CARD_QP"],[g,"WHATSAPP_FOR_SMB_WEB_UPDATES_TAB_FOOTER_NOTICE_QP"],[e,"WHATSAPP_FOR_WEB_UPDATES_TAB_FOOTER_NOTICE_QP"]]),i=20*1e3,j=20*1e3,k=20*1e3,l=20*1e3,m=Object.freeze({NEW_ORDER:2,PENDING_PAYMENT:3,PAID:4,ORDER_COMPLETE:5}),n=new Set(Object.keys(m).map(function(a){return m[a]})),o=1,p=7,q=8,r=6,s=2,t=9,u=10;f.QP_SURFACE_ID_CHAT_LIST_TOP=a;f.QP_SURFACE_ID_EXITED_GROUP=b;f.QP_SURFACE_ID_PROFILE=c;f.QP_SURFACE_BUSINESS_HOME_TOP_CARD=d;f.QP_SURFACE_UPDATES_TAB_PRIVACY_FOOTER=e;f.QP_SURFACE_BUSINESS_UPDATES_TAB_PRIVACY_FOOTER=g;f.KNOWN_QP_SURFACES=h;f.QP_FETCH_TIMEOUT_MS=i;f.QP_ACTION_MUTATION_TIMEOUT_MS=j;f.MANAGE_ADS_FETCH_TIMEOUT_MS=k;f.AD_ENTRY_POINTS_FETCH_TIMEOUT_MS=l;f.ALLOWED_PREDEFINED_LABEL_IDS=m;f.ALLOWED_PREDEFINED_LABEL_IDS_SET=n;f.NEW_CUSTOMER_PREDEFINED_ID=o;f.FOLLOW_UP_PREDEFINED_ID=p;f.LEAD_PREDEFINED_ID=q;f.IMPORTANT_PREDEFINED_ID=r;f.NEW_ORDER_PREDEFINED_ID=s;f.DETECTED_OUTCOME_NEW_ORDER_PREDEFINED_ID=t;f.DETECTED_OUTCOME_LEAD_PREDEFINED_ID=u}),66);
__d("WAWebGetters",["err"],(function(a,b,c,d,e,f,g){var h=function(){var a=i;i++;return a},i=0;function a(a){a=a||{};var b=a.root,d=a.rootEqualityCheck;a=a.createCache;a=a===void 0?s:a;var e=a(),f=h(),g=function(){var a=i;i++;return a},i=0,l=b!=null?b:k({getterGroupId:f,getterId:g(),resultEqualityCheck:d!=null?d:r,cache:e});if(l.kind!=="identity")throw c("err")("root must be an identity getter but got kind "+l.kind);return{field:function(a,b){b=b||{};var c=b["default"],d=b.getDefault;b=b.resultEqualityCheck;b=b===void 0?r:b;var h;d!=null?h=function(b){b=b[0];return(b=b[a])!=null?b:d()}:c===void 0?h=function(b){b=b[0];return b[a]}:h=function(b){b=b[0];return(b=b[a])!=null?b:c};return j({getterGroupId:f,getterId:g(),root:l,cache:e,resultFunc:h,resultEqualityCheck:b,props:{kind:"field",dependencyKey:a,dependencies:[l]}})},computed:function(a,b,c){c=c||{};c=c.resultEqualityCheck;c=c===void 0?r:c;return j({getterGroupId:f,getterId:g(),root:l,cache:e,resultFunc:a,resultEqualityCheck:c,props:{kind:"computed",dependencies:b}})},unsafeIdentityGetter:l,clearCacheFor:function(a){e["delete"](t(a))}}}function j(a){var b=a.getterGroupId,d=a.getterId,e=a.root,f=a.cache,g=a.resultFunc,h=a.resultEqualityCheck;a=a.props;var i=a.dependencies,j=i.length,k=n(d),m=o(d),r=p(d);return l({getterGroupId:b,getterId:d,root:e,cache:f,props:babelHelpers["extends"]({},a,{resultFunc:g}),recomputeIfNeeded:function(a,d,e){a=e[b];var f=a[m],l=a[r];if(l!=null&&f!=null){if(l===d)return f;if(l!=null&&j>0){var n=!1;for(var o=0;o<j;o++){var p=i[o];p=p.$$extractChangedAt(e[p.$$getterGroupId]);n=p==null||p>l;if(n)break}if(!n){a[r]=d;return f}}}p=new Array(j);for(o=0;o<j;o++){l=i[o];n=l.$$extractResult(e[l.$$getterGroupId]);if(n===void 0)throw c("err")("No result was stored");p[o]=u(n)}l=g(p);n=a[k];if(f!=null&&n!==void 0&&h(l,u(n))){a[r]=d;return f}a[k]=l===void 0?q:l;a[m]=d;a[r]=d;return d}})}function k(a){var b=a.getterGroupId,c=a.getterId,d=a.resultEqualityCheck;a=a.cache;var e=n(c),f=o(c),g=p(c);return l({getterGroupId:b,getterId:c,root:null,cache:a,props:{kind:"identity",dependencies:[]},recomputeIfNeeded:function(a,c,h){h=h[b];var i=h[e],j=a,k=h[g];a=a==null?0:a.revisionNumber||0;if(i!==void 0&&k===a&&d(j,u(i)))return c;k=c+1;h[e]=j===void 0?q:j;h[f]=k;h[g]=a;return k}})}function l(a){var b=a.getterGroupId,d=a.getterId,e=a.root,f=a.cache,g=a.recomputeIfNeeded;a=a.props;var h=a.dependencies,i=n(d),j=o(d),k=p(d);d=function(a){var d=t(a),e={};for(var f=0;f<s.length;f++){var g=s[f],h=r[g],j=h.get(d);j==null&&(j={},h.set(d,j));e[g]=j}h=q.$$recomputeIfNeeded(a,q.$$extractChangedAt(e[q.$$getterGroupId])||0,e);g=e[b];j=g[k];if(j==null||h>j)for(d=0;d<l.length;d++){f=j!=null;var m=l[d];for(var n=0;n<m.length;n++){var o=m[n].$$recomputeIfNeeded(a,h,e);(j==null||o>j)&&(f=!1)}if(f)break}o=g[i];if(o===void 0)throw c("err")("No result was stored");return u(o)};a=Object.assign(d,{kind:a.kind,dependencies:h,dependencyKey:a.dependencyKey,resultFunc:a.resultFunc,$$getterGroupId:b,$$root:e||d,$$cache:f,$$recomputeIfNeeded:g,$$extractChangedAt:function(a){return a[j]},$$extractResult:function(a){return a[i]}});var l=m(a),q=a.$$root;for(e=0;e<h.length;e++)if(h[e].$$root!==q)throw c("err")("Getter created with multiple roots. This means you used getters that came from different `createGetterFactories()` calls as dependencies in a `computed()` getter. If you want to do this, you must pass the identity getter created by one of the `createGetterFactories()` calls as the `root` option to the other.");var r=(d={},d[q.$$getterGroupId]=q.$$cache,d),s=[q.$$getterGroupId];for(f=0;f<l.length;f++)for(g=0;g<l[f].length;g++){h=l[f][g];e=h.$$getterGroupId;d=h.$$cache;r[e]==null&&(s.push(e),r[e]=d)}return a}function m(a){a=[a];for(var b=0;b<a.length;b++){var d=a[b];d.dependencies!=null&&a.push.apply(a,d.dependencies)}d=Array.from(new Set(a.reverse()));b=[];a=[];for(var e=0;e<d.length;e++){var f=d[e];switch(f.kind){case"identity":break;case"field":b.push(f);break;case"computed":a.push(f);break;default:throw c("err")("Invalid getter kind: "+f.kind)}}return[b,a].filter(function(a){return a.length>0})}var n=function(a){return 3*a},o=function(a){return 3*a+1},p=function(a){return 3*a+2};b=function(){function a(){}var b=a.prototype;b.toString=function(){return"UndefinedSentinel"};return a}();var q=new b();function r(a,b){return a===b}function s(){return new Map()}function t(a){if(a==null)throw c("err")("Getter was called with "+String(a)+" data.");a=a.id;if(a==null)throw c("err")("Data passed to getter must include an id property (it's how we memoize) but got "+String(a));return a.toString()}function u(a){return a===q?void 0:a}g.createGetterFactories=a}),98);
__d("WAWebDummyCacheMap",[],(function(a,b,c,d,e,f){a=function(){function a(){this.size=0}var b=a.prototype;b.clear=function(){};b["delete"]=function(){return!1};b.get=function(){return void 0};b.has=function(){return!1};b.set=function(){return this};return a}();f.FakeCacheMap=a}),66);
__d("WAWebGettersCaches",["WAWebABProps","WAWebDummyCacheMap","WAWebEnvironment"],(function(a,b,c,d,e,f,g){a=function(){return c("WAWebEnvironment").isWindows?d("WAWebABProps").getABPropConfigValue("web_hybrid_getters_cache_enabled")?new Map():new(d("WAWebDummyCacheMap").FakeCacheMap)():new Map()};b=a;e=a;f=a;var h=a,i=function(){return new Map()},j=function(){return new Map()},k=a,l=a,m=a,n=a,o=a,p=a,q=a,r=a,s=a,t=a,u=a,v=a,w=a,x=a,y=a,z=a,A=a,B=a,C=a,D=a,E=a;a=a;g.createMessagesCache=b;g.createFrontendMessagesCache=e;g.createChatCache=f;g.createFrontendChatCache=h;g.createContactsCache=i;g.createFrontendContactsCache=j;g.createLabelsCache=k;g.createMuteCache=l;g.createPinInChatsCache=m;g.createFrontendPinInChatsCache=n;g.createMsgInfosCache=o;g.createPollVotesCache=p;g.createFrontendPollVotesCache=q;g.createNewsletterPollVotesCache=r;g.createFrontendNewsletterPollVotesCache=s;g.createSettingsCache=t;g.createStickerModelMdCache=u;g.createMediaEditControllerCache=v;g.createOrderCache=w;g.createOrderItemCache=x;g.createQuickReplyCache=y;g.createFrontendQuickReplyCache=z;g.createStatusCache=A;g.createFrontendStatusCache=B;g.createRecordingSessionCache=C;g.createEventResponseCache=D;g.createFrontendEventResponseCache=E;g.createCatalogCache=a}),98);
__d("WAWebChatGetters",["WAWebGetters","WAWebGettersCaches","WAWebWid"],(function(a,b,c,d,e,f,g){a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createChatCache});b=a.field;e=a.computed;f=a.unsafeIdentityGetter;d=a.clearCacheFor;a=d;d=f;f=b("id");var h=b("t"),i=b("unreadCount",{"default":0}),j=b("archive"),k=b("isReadOnly"),l=b("isLocked"),m=b("muteExpiration",{"default":0}),n=b("isAutoMuted",{"default":!1}),o=b("name"),p=b("pin"),q=b("labels"),r=b("endOfHistoryTransferType"),s=b("pendingInitialLoading",{"default":!1}),t=b("changeNumberOldJid"),u=b("changeNumberNewJid"),v=b("chatlistPreview"),w=b("lastReactionPreview"),x=b("draftMessage"),y=b("capiThreadControl"),z=b("tcToken"),A=b("tcTokenTimestamp");b=b("previewT");var B=e(function(a){a=a[0];return c("WAWebWid").isUser(a)},[f]),C=e(function(a){a=a[0];return c("WAWebWid").isPSA(a)},[f]),D=e(function(a){a=a[0];return c("WAWebWid").isIAS(a)},[f]),E=e(function(a){a=a[0];return c("WAWebWid").isGroup(a)},[f]),F=e(function(a){a=a[0];return c("WAWebWid").isBroadcast(a)},[f]),G=e(function(a){a=a[0];return c("WAWebWid").isNewsletter(a)},[f]),H=e(function(a){var b=a[0];a=a[1];return!b&&!a},[F,C]),I=e(function(a){a=a[0];return!a},[F]);e=e(function(a){a=a[0];return a!==0},[i]);g.clearChatGetterCacheFor=a;g.getChatUnsafe=d;g.getId=f;g.getT=h;g.getUnreadCount=i;g.getArchive=j;g.getIsReadOnly=k;g.getIsLocked=l;g.getMuteExpiration=m;g.getIsAutoMuted=n;g.getName=o;g.getPin=p;g.getLabels=q;g.getEndOfHistoryTransferType=r;g.getPendingInitialLoading=s;g.getChangeNumberOldJid=t;g.getChangeNumberNewJid=u;g.getChatlistPreview=v;g.getLastReactionPreview=w;g.getDraftMessage=x;g.getCapiThreadControl=y;g.getTcToken=z;g.getTcTokenTimestamp=A;g.getPreviewT=b;g.getIsUser=B;g.getIsPSA=C;g.getIsIAS=D;g.getIsGroup=E;g.getIsBroadcast=F;g.getIsNewsletter=G;g.getIsEligibleForContactSync=H;g.getCanUnread=I;g.getHasUnread=e}),98);
__d("WAWebClientFeatureFlags",["WAWebEnvironment","gkx"],(function(a,b,c,d,e,f,g){d=!1;var h={lid_debug:!1,youtube_video_preview_without_blur:!c("gkx")("26258"),message_add_ons:!1,reactions_filter_problematic_flags:!0,skip_compliance_phone_check:!1,debug_commands:d,debug_1_year_history_sync:c("WAWebEnvironment").isWindows};function a(a){return h[a]}function i(a){h[a]=!0}function j(a){h[a]=!1}function b(){if(!c("gkx")("26258")){var a;a=new URLSearchParams(((a=location.search)!=null?a:"").toLowerCase());k(a,"feature_enable",i);k(a,"feature_disable",j)}}function k(a,b,c){a=a.get(b);if(a==null)return;b=a.split(",");b.forEach(function(a){a in h&&c(a)})}g.isFeatureEnabled=a;g.debugEnableFeatureFlag=i;g.debugDisableFeatureFlag=j;g.overwriteDebugFeatures=b}),98);
__d("WAWebComplianceConstants",[],(function(a,b,c,d,e,f){a={INDIA:"IN"};b={ENTITY_NAME:1024,ENTITY_TYPE_CUSTOM:1024,EMAIL:256,GRIEVANCE_OFFICER_NAME:256,LANDLINE_NUMBER:20,MOBILE_NUMBER:20,IMPORTER_NAME:1024,STREET1:1024,STREET2:1024,CITY:1024,REGION:1024,POSTAL_CODE:12};f.COMPLIANCE_INFO_CODES=a;f.COMPLIANCE_INFO_LENGTH=b}),66);
__d("WAWebL10NCountryCodes",[],(function(a,b,c,d,e,f){var g={1:{2:{0:{4:{c:"CA"}},2:{6:{c:"CA"}},3:{6:{c:"CA"}},4:{2:{c:"BS"},9:{c:"CA"}},5:{0:{c:"CA"}},6:{4:{c:"AI"},8:{c:"AG"}},8:{4:{c:"VG"},9:{c:"CA"}}},3:{0:{6:{c:"CA"}},4:{0:{c:"VI"},3:{c:"CA"},5:{c:"KY"}},6:{5:{c:"CA"},7:{c:"CA"}}},4:{0:{3:{c:"CA"}},1:{6:{c:"CA"},8:{c:"CA"}},3:{1:{c:"CA"},7:{c:"CA"},8:{c:"CA"}},4:{1:{c:"BM"}},5:{0:{c:"CA"}},7:{3:{c:"GD"}}},5:{0:{6:{c:"CA"}},1:{4:{c:"CA"},9:{c:"CA"}},4:{8:{c:"CA"}},7:{9:{c:"CA"}},8:{1:{c:"CA"},7:{c:"CA"}}},6:{0:{4:{c:"CA"}},1:{3:{c:"CA"}},3:{9:{c:"CA"}},4:{7:{c:"CA"},9:{c:"TC"}},5:{8:{c:"JM"}},6:{4:{c:"MS"}},7:{0:{c:"MP"},1:{c:"GU"},2:{c:"CA"}},8:{4:{c:"AS"}}},7:{0:{5:{c:"CA"},9:{c:"CA"}},2:{1:{c:"MF"}},5:{8:{c:"LC"}},6:{7:{c:"DM"}},7:{8:{c:"CA"}},8:{0:{c:"CA"},2:{c:"CA"},4:{c:"VC"},7:{c:"PR"}}},8:{0:{7:{c:"CA"},9:{c:"DO"}},1:{9:{c:"CA"}},2:{5:{c:"CA"},9:{c:"DO"}},4:{9:{c:"DO"}},6:{7:{c:"CA"},8:{c:"TT"},9:{c:"KN"}},7:{3:{c:"CA"},6:{c:"JM"}}},9:{0:{2:{c:"CA"},5:{c:"CA"}},3:{9:{c:"PR"}}}},2:{0:{c:"EG"},1:{1:{c:"SS"},2:{c:"MA"},3:{c:"DZ"},6:{c:"TN"},8:{c:"LY"}},2:{0:{c:"GM"},1:{c:"SN"},2:{c:"MR"},3:{c:"ML"},4:{c:"GN"},5:{c:"CI"},6:{c:"BF"},7:{c:"NE"},8:{c:"TG"},9:{c:"BJ"}},3:{0:{c:"MU"},1:{c:"LR"},2:{c:"SL"},3:{c:"GH"},4:{c:"NG"},5:{c:"TD"},6:{c:"CF"},7:{c:"CM"},8:{c:"CV"},9:{c:"ST"}},4:{0:{c:"GQ"},1:{c:"GA"},2:{c:"CG"},3:{c:"CD"},4:{c:"AO"},5:{c:"GW"},6:{c:"IO"},7:{c:"AC"},8:{c:"SC"},9:{c:"SD"}},5:{0:{c:"RW"},1:{c:"ET"},2:{c:"SO"},3:{c:"DJ"},4:{c:"KE"},5:{c:"TZ"},6:{c:"UG"},7:{c:"BI"},8:{c:"MZ"}},6:{0:{c:"ZM"},1:{c:"MG"},2:{c:"RE"},3:{c:"ZW"},4:{c:"NA"},5:{c:"MW"},6:{c:"LS"},7:{c:"BW"},8:{c:"SZ"},9:{c:"KM"}},7:{c:"ZA"},9:{0:{c:"SH"},1:{c:"ER"},7:{c:"AW"},8:{c:"FO"},9:{c:"GL"}}},3:{0:{c:"GR"},1:{c:"NL"},2:{c:"BE"},3:{c:"FR"},4:{c:"ES"},5:{0:{c:"GI"},1:{c:"PT"},2:{c:"LU"},3:{c:"IE"},4:{c:"IS"},5:{c:"AL"},6:{c:"MT"},7:{c:"CY"},8:{c:"FI"},9:{c:"BG"}},6:{c:"HU"},7:{0:{c:"LT"},1:{c:"LV"},2:{c:"EE"},3:{c:"MD"},4:{c:"AM"},5:{c:"BY"},6:{c:"AD"},7:{c:"MC"},8:{c:"SM"}},8:{0:{c:"UA"},1:{c:"RS"},2:{c:"ME"},3:{c:"XK"},5:{c:"HR"},6:{c:"SI"},7:{c:"BA"},9:{c:"MK"}},9:{c:"IT"}},4:{0:{c:"RO"},1:{c:"CH"},2:{0:{c:"CZ"},1:{c:"SK"},3:{c:"LI"}},3:{c:"AT"},4:{c:"GB"},5:{c:"DK"},6:{c:"SE"},7:{c:"NO"},8:{c:"PL"},9:{c:"DE"}},5:{0:{0:{c:"FK"},1:{c:"BZ"},2:{c:"GT"},3:{c:"SV"},4:{c:"HN"},5:{c:"NI"},6:{c:"CR"},7:{c:"PA"},8:{c:"PM"},9:{c:"HT"}},1:{c:"PE"},2:{c:"MX"},3:{c:"CU"},4:{c:"AR"},5:{c:"BR"},6:{c:"CL"},7:{c:"CO"},8:{c:"VE"},9:{0:{c:"GP"},1:{c:"BO"},2:{c:"GY"},3:{c:"EC"},4:{c:"GF"},5:{c:"PY"},6:{c:"MQ"},7:{c:"SR"},8:{c:"UY"},9:{c:"CW"}}},6:{0:{c:"MY"},1:{c:"AU"},2:{c:"ID"},3:{c:"PH"},4:{c:"NZ"},5:{c:"SG"},6:{c:"TH"},7:{0:{c:"TL"},2:{c:"NF"},3:{c:"BN"},4:{c:"NR"},5:{c:"PG"},6:{c:"TO"},7:{c:"SB"},8:{c:"VU"},9:{c:"FJ"}},8:{0:{c:"PW"},1:{c:"WF"},2:{c:"CK"},3:{c:"NU"},5:{c:"WS"},6:{c:"KI"},7:{c:"NC"},8:{c:"TV"},9:{c:"PF"}},9:{0:{c:"TK"},1:{c:"FM"},2:{c:"MH"}}},7:{c:"RU"},8:{1:{c:"JP"},2:{c:"KR"},4:{c:"VN"},5:{0:{c:"KP"},2:{c:"HK"},3:{c:"MO"},5:{c:"KH"},6:{c:"LA"}},6:{c:"CN"},8:{0:{c:"BD"},6:{c:"TW"}}},9:{0:{c:"TR"},1:{c:"IN"},2:{c:"PK"},3:{c:"AF"},4:{c:"LK"},5:{c:"MM"},6:{0:{c:"MV"},1:{c:"LB"},2:{c:"JO"},3:{c:"SY"},4:{c:"IQ"},5:{c:"KW"},6:{c:"SA"},7:{c:"YE"},8:{c:"OM"}},7:{0:{c:"PS"},1:{c:"AE"},2:{c:"IL"},3:{c:"BH"},4:{c:"QA"},5:{c:"BT"},6:{c:"MN"},7:{c:"NP"}},8:{c:"IR"},9:{2:{c:"TJ"},3:{c:"TM"},4:{c:"AZ"},5:{c:"GE"},6:{c:"KG"},8:{c:"UZ"}}}};function h(a,b){if(a!=null&&a.length>0&&b!=null){b=b[a[0]];a=a;while(a.length>0&&b){if(b.c)return b.c;a=a.substr(1,a.length-1);b=b[a[0]]}}return""}function a(a){if(a==null||a.length===0)return"";var b=h(a,g);if(b===""&&a[0]==="1")return"US";return b==="RU"&&["6","7"].includes(a[1])?"KZ":b}f.getCountryShortcodeByPhone=a}),66);
__d("WAWebListsGatingUtils",["WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function h(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("primary_lists_support")&&d("WAWebABProps").getABPropConfigValue("lists_feature_enabled")}function a(){return!d("WAWebMobilePlatforms").isSMB()&&h()}g.isListsEnabled=h;g.shouldListsSettingsItemBeVisible=a}),98);
__d("WAWebBizGatingUtils",["$InternalEnum","WALogger","WAWebABProps","WAWebBusinessProfileTypes","WAWebCTWAConstants","WAWebChatGetters","WAWebClientFeatureFlags","WAWebComplianceConstants","WAWebL10NCountryCodes","WAWebLidMigrationUtils","WAWebListsGatingUtils","WAWebMobilePlatforms","WAWebPrimaryFeatures","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){var h,i;function a(){return d("WAWebMobilePlatforms").isSMB()}function c(){return d("WAWebMobilePlatforms").isSMB()}function j(){return d("WAWebMobilePlatforms").isSMB()}function e(a){return!d("WAWebChatGetters").getIsNewsletter(a)&&j()&&!((a=a.contact.businessProfile)!=null&&a.isBizBot3p)}function f(){return d("WAWebABProps").getABPropConfigValue("web_biz_profile_options")}function k(){return d("WAWebABProps").getABPropConfigValue("smb_collections_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("smb_collections_appeal_flow_enabled")}function m(){return d("WAWebABProps").getABPropConfigValue("nfm_rendering_enabled")}function n(){return!d("WAWebABProps").getABPropConfigValue("interactive_message_native_flow_killswitch")}function o(){return!d("WAWebABProps").getABPropConfigValue("interactive_response_message_killswitch")}function p(){return!d("WAWebABProps").getABPropConfigValue("interactive_response_message_native_flow_killswitch")}function q(a){var b;if(a!=null){b=(a=d("WAWebLidMigrationUtils").toPn(a))==null?void 0:a.user;if(b==null)return!0}return u(b)}function r(a){return y(a,function(){return d("WAWebABProps").getABPropConfigValue("smb_ecommerce_compliance_india_m4")})}function s(a){return y(a,function(){return d("WAWebABProps").getABPropConfigValue("smb_ecommerce_compliance_india_m4_5")})}function t(a){var b,c=y(a==null?void 0:a.id,function(){return d("WAWebABProps").getABPropConfigValue("web_abprop_block_catalog_creation_ecommerce_compliance_india")});return c&&(a==null||(b=a.profileOptions)==null?void 0:b.commerceExperience)===d("WAWebBusinessProfileTypes").CommerceExperienceTypes.NONE}function u(a){a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a||"");var b=d("WAWebComplianceConstants").COMPLIANCE_INFO_CODES.INDIA;return a===b||d("WAWebClientFeatureFlags").isFeatureEnabled("skip_compliance_phone_check")}function v(a){a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a);return a==="BR"}function w(a){if(!a)return!1;a=(a=d("WAWebLidMigrationUtils").toPn(a))==null?void 0:a.user;return a==null?!1:u(a)||v(a)}function x(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("web_business_tools_drawer_enabled")}function y(a,b){b===void 0&&(b=function(){return!1});var c;if(a!=null){c=(a=d("WAWebLidMigrationUtils").toPn(a))==null?void 0:a.user;if(c==null)return!0}return!u(c)?!1:b()}function z(){return!d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("tos_3_client_gating_enabled"):!1}function A(){return d("WAWebABProps").getABPropConfigValue("tos_client_state_fetch_iteration")}function B(){return!d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("tos_client_state_fetch_enabled"):!1}function C(){return d("WAWebABProps").getABPropConfigValue("web_shop_storefront_message")}function D(){return d("WAWebABProps").getABPropConfigValue("banned_shops_ux_enabled")}function E(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("smb_click_to_chat_logging_enabled"):!1}function F(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("smb_biz_profile_logging_enabled"):!1}function G(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_linked_accounts_killswitch")}function H(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_linked_account_enabled")}function I(){return d("WAWebABProps").getABPropConfigValue("commerce_sanctioned")}function J(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_edit_cover_photo_enabled")}function K(){return d("WAWebABProps").getABPropConfigValue("web_abprop_business_profile_refresh_cover_photo_view_enabled")}function L(){return d("WAWebABProps").getABPropConfigValue("catalog_categories_enabled")}var M=b("$InternalEnum")({DIGITAL_GOODS:"digital-goods",PHYSICAL_GOODS:"physical-goods",ANY:"any",NONE:"none"});function aa(a){a===void 0&&(a=M.NONE);try{var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("order_details_quick_pay"));b=b.allowed_product_type;if(b&&b!==M.NONE)return b===M.ANY||b===a}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["isOrderDetailsQuickPayEnabled failed to parse config json: error ",""])),a)}return!1}function ba(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_billing_enabled")}function ca(){return d("WAWebABProps").getABPropConfigValue("web_enable_biz_catalog_view_ps_logging")}function da(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smart_filters_enabled")||!d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smart_filters_enabled_consumer")}function N(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_multi_device_message_attribution_enabled")}b=function(){return d("WAWebABProps").getABPropConfigValue("order_messages_ephemeral_exception_enabled")};function ea(){return N()&&d("WAWebABProps").getABPropConfigValue("smb_multi_device_agents_logging_V2_enabled")}function fa(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("smb_orange_enabled")}function ga(){return!d("WAWebMobilePlatforms").isSMB()?!1:O()||P()}function O(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("premium_blue_enabled")}function P(){return!d("WAWebMobilePlatforms").isSMB()?!1:d("WAWebABProps").getABPropConfigValue("smb_billing_enabled")||d("WAWebABProps").getABPropConfigValue("smb_ctwa_billing_enabled")}function ha(){return d("WAWebABProps").getABPropConfigValue("native_commerce_threads_logging_enabled")}function ia(){return d("WAWebABProps").getABPropConfigValue("smb_biz_profile_custom_url")}function Q(){return d("WAWebABProps").getABPropConfigValue("wa_web_fmx_agm_enabled")}function R(){return d("WAWebABProps").getABPropConfigValue("wamo_agm_enabled")}function ja(){return d("WAWebABProps").getABPropConfigValue("web_quantity_controls_enabled")}function ka(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_biz_quick_reply_sync_support")}function la(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_collections_reordering_enabled")}function ma(){return d("WAWebABProps").getABPropConfigValue("smb_temp_cover_photo_privacy_messaging")}function S(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_enabled")}function na(){return S()&&d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_system_messages_enabled")}function oa(){return!S()?0:d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_nux_impressions")}function pa(){return d("WAWebABProps").getABPropConfigValue("smb_hide_unsupported_currency_price")}function qa(){return d("WAWebABProps").getABPropConfigValue("graphql_privacy_imp_m1")}function ra(){return d("WAWebABProps").getABPropConfigValue("graphql_privacy_imp_m2")}function sa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_create_product_catalog")}function ta(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product_catalog")}function ua(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_add_product")}function va(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_edit_product")}function wa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_delete_product")}function xa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product")}function ya(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_report_product")}function za(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_appeal_product")}function Aa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_create_collection")}function Ba(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_collection")}function Ca(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_collection_list")}function Da(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_delete_collection")}function Ea(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_appeal_collection")}function Fa(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_collection")}function Ga(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_single_collection")}function Ha(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_product_list")}function Ia(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_update_product_visibility")}function Ja(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_commerce_settings")}function Ka(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_verify_postcode")}function La(){return d("WAWebABProps").getABPropConfigValue("smb_catalog_graphql_get_public_key")}function Ma(){return d("WAWebABProps").getABPropConfigValue("smb_orders_graphql_refresh_cart")}function Na(){return!d("WAWebMobilePlatforms").isSMB()?"{}":d("WAWebABProps").getABPropConfigValue("smb_billing_premium_access_config")}function Oa(){return d("WAWebABProps").getABPropConfigValue("country_client_gating_enabled")}function Pa(){return d("WAWebABProps").getABPropConfigValue("order_details_custom_item_enabled")}function Qa(){return d("WAWebABProps").getABPropConfigValue("order_details_from_catalog_enabled")}function Ra(){return d("WAWebABProps").getABPropConfigValue("order_details_from_cart_enabled")}function Sa(){return d("WAWebABProps").getABPropConfigValue("order_details_total_order_minimum_value")}function Ta(a){return Z(a)?5e3:d("WAWebABProps").getABPropConfigValue("order_details_total_maximum_value")}function Ua(){return d("WAWebABProps").getABPropConfigValue("order_management_enabled")}function Va(){return d("WAWebABProps").getABPropConfigValue("btm_threads_logging_enabled")}function Wa(a){return a?d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_chats_reorder_on_chat_unassignment_enabled"):d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_chats_reorder_on_chat_assignment_enabled")}function Xa(){return d("WAWebABProps").getABPropConfigValue("utm_tracking_expiration_hours")}function Ya(){return d("WAWebABProps").getABPropConfigValue("utm_tracking_enabled")}function Za(){return!d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_thread_ad_attribution_enabled")||d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_web_parse_always_show_ad_attribution")}function $a(){return d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_hide_ad_context_if_soft_dismissed_in_primary")}function ab(){return d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_disclosure_update_enabled")&&d("WAWebABProps").getABPropConfigValue("biz_ai_tos_variant")===0}function bb(){return d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_disclosure_update_enabled")&&d("WAWebABProps").getABPropConfigValue("biz_ai_tos_variant")===1}function cb(){return d("WAWebABProps").getABPropConfigValue("ctwa_mm_biz_ai_disclosure_update_enabled")&&d("WAWebABProps").getABPropConfigValue("biz_ai_tos_variant")===2}function db(){return d("WAWebABProps").getABPropConfigValue("ctwa_data_sharing_disclosure_new_content_for_info_sharing")}function eb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_consent")}function fb(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_opt_in_cool_off_period")}function gb(){return d("WAWebABProps").getABPropConfigValue("smb_md_agent_chat_assignment_notifications_enabled")}function hb(){return d("WAWebABProps").getABPropConfigValue("biz_ai_consumer_tos_update_enabled")}function T(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_ads_action_banner_enabled_web")}function ib(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_action_banner_logging_enabled_web")}function jb(){return T()&&d("WAWebABProps").getABPropConfigValue("in_app_comms_manage_ads_web_banner_campaign_enabled")}function kb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("qp_campaign_client_enabled")}function lb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_enabled")}function mb(){return d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_frequency_mins")}function nb(){var a=d("WAWebABProps").getABPropConfigValue("smb_graphql_to_fetch_qp_surface_ids"),b=new Map(Array.from(d("WAWebCTWAConstants").KNOWN_QP_SURFACES.values(),function(a){return[a,a]})),c=new Set();a.split(",").forEach(function(a){var e=b.get(a);e!=null?c.add(e):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["qpSurfaceIdsUsingGraphQL: unknown surface ID ",""])),a)});return c}var ob=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_home_header_enabled")},pb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_home_header_dropdown_enabled")},qb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_creation_entry_point_catalog_web")},rb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_creation_entry_point_catalog_product_web")};function U(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("kill_switch_ctwa_ml_entry_point_config")===!1}function sb(){return d("WAWebABProps").getABPropConfigValue("ctwa_entry_point_config_fetch_threshhold")}function tb(){return U()&&d("WAWebABProps").getABPropConfigValue("ctwa_long_term_holdout_content_enabled")}function ub(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_long_term_holdout_client_side_check")}var vb=function(a){return d("WAWebMobilePlatforms").isSMB()&&(a==null?void 0:a.hasCreatedAd)===!0&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_entrypoint_manage_ads_home_header_dropdown_enabled")},wb=function(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_ctwa_web_fetch_linked_accounts_enabled")};function xb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_native_ads_creation_web_enabled")}function yb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_native_ads_creation_web_hawk_tool_enabled")}function zb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_native_ads_creation_web_targeting_modal_hawk_tool_enabled")}function Ab(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_core_biz_profile_ux_refreshed")}function V(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web")}function Bb(){return V()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_ad_actions_menu")}function Cb(){return V()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_ad_metrics")}function W(){return V()&&d("WAWebABProps").getABPropConfigValue("ctwa_manage_ads_tab_web_recovery_flow")}function Db(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_token_storage_kill_switch_web")===!1}function Eb(){return d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_nonce_push_wait_timeout_web")}function Fb(){return d("WAWebABProps").getABPropConfigValue("ctwa_ad_account_nonce_retries_max_web")}function Gb(){return W()&&d("WAWebABProps").getABPropConfigValue("smb_graphql_token_recovery_during_account_recovery_enabled")}function Hb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("business_tool_enhanced_logging")}function Ib(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_labels_ctwa_data_sharing")}function Jb(){return d("WAWebMobilePlatforms").isSMB()&&X()}function X(){return d("WAWebABProps").getABPropConfigValue("payments_br_content_optimization_variant")!==0}function Kb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_smb_data_sharing_settings_killswitch")===!1}function Lb(){return d("WAWebABProps").getABPropConfigValue("ctwa_enable_biz_data_sharing_after_nux_dismiss")}function Mb(){return d("WAWebABProps").getABPropConfigValue("ctwa_show_ads_data_sharing_after_message")}function Nb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_message_labels_ctwa_data_sharing")}function Ob(){return d("WAWebABProps").getABPropConfigValue("payments_link_to_lite_consumer_enabled")}function Pb(){return d("WAWebABProps").getABPropConfigValue("smb_premium_messages_click_logging_enabled")}function Y(){return d("WAWebABProps").getABPropConfigValue("row_buyer_order_revamp_m0_enabled")}function Qb(){return d("WAWebABProps").getABPropConfigValue("seller_orders_management_revamp")}function Rb(){return Y()&&d("WAWebABProps").getABPropConfigValue("buyer_initiated_order_request_variant_enabled")}function Sb(){return d("WAWebABProps").getABPropConfigValue("order_statuses_revamp_m1_enabled")}function Tb(){return d("WAWebABProps").getABPropConfigValue("smb_premium_messages_url_cta_alert_dialog_enabled")}function Z(a){var b=d("WAWebLidMigrationUtils").toPn(d("WAWebUserPrefsMeUser").getMePnUserOrThrow());b=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(b==null?void 0:b.user);a=d("WAWebLidMigrationUtils").toPn(a.contact.id);a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a==null?void 0:a.user);return b==="BR"&&a==="BR"}function Ub(){return d("WAWebABProps").getABPropConfigValue("carousel_message_client_enabled")}function Vb(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_biz_label_sync_support")}function Wb(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebABProps").getABPropConfigValue("smb_label_improvements_reordering")}function Xb(){return(d("WAWebMobilePlatforms").isSMB()||d("WAWebListsGatingUtils").isListsEnabled())&&d("WAWebABProps").getABPropConfigValue("smb_label_improvements_reordering")&&d("WAWebABProps").getABPropConfigValue("web_smb_label_reordering_m2_two_way")}function Yb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_new_customer_label_signals")}function Zb(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_lead_labels_send_signals")}function $b(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("ctwa_important_label_sends_signals")}function ac(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smba_premium_messages_leaving_wa_content")}function bc(){return d("WAWebABProps").getABPropConfigValue("smba_premium_messages_insights_v2_trackable_link_domain")}function cc(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("smb_notes_v1_enabled")}function dc(){return d("WAWebABProps").getABPropConfigValue("smb_notes_privacy_string")}function ec(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("wa_web_business_tools_top_card_enabled")}function fc(){return d("WAWebABProps").getABPropConfigValue("smb_meta_verified_context_card")}function gc(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("profile_edit_for_mv_users_enabled")}function hc(){return d("WAWebABProps").getABPropConfigValue("web_catalog_video_view_fallback_enabled")}function ic(){return d("WAWebABProps").getABPropConfigValue("web_catalog_video_view_enabled")}function jc(){return d("WAWebABProps").getABPropConfigValue("smb_custom_url_get_user_graphql_migration_enabled")}function kc(){return d("WAWebABProps").getABPropConfigValue("web_biz_ai_chat_assignment_hiding_enabled")}function lc(){return d("WAWebABProps").getABPropConfigValue("smb_ai_agents_web_chat_assignment_interop_enabled")}function mc(){return d("WAWebABProps").getABPropConfigValue("lid_migration_for_vname_enabled")}function nc(){return d("WAWebABProps").getABPropConfigValue("use_signed_shimmed_url_link")}function oc(){return d("WAWebABProps").getABPropConfigValue("lid_migration_for_biz_profile_enabled")}function pc(){return d("WAWebABProps").getABPropConfigValue("catalog_product_sale_price_enabled")}function qc(){return d("WAWebABProps").getABPropConfigValue("catalog_lid_migration_enabled")}function rc(){return d("WAWebABProps").getABPropConfigValue("ctwa_signal_decoupling_enabled")}function $(){return d("WAWebABProps").getABPropConfigValue("smb_product_country_of_origin_m1")}function sc(){return d("WAWebABProps").getABPropConfigValue("ctwa_download_3pd_signals")}function tc(a){return q(a)||$()}function uc(){return q(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())}function vc(){return d("WAWebABProps").getABPropConfigValue("web_catalog_recovery_flow_enabled")}function wc(a){var b=R(),c=Q();return a!=null&&(b||c&&a.sourceApp!=="whatsapp")}function xc(){return d("WAWebABProps").getABPropConfigValue("web_catalog_viewing_variants_enabled")}function yc(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_detected_outcome_labels_soak_enabled")}function zc(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_detected_outcome_labels_enabled")}function Ac(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_detected_outcome_labels_merger_enabled")}function Bc(){return d("WAWebABProps").getABPropConfigValue("smb_business_broadcast_import_contact")}function Cc(){return d("WAWebABProps").getABPropConfigValue("smb_business_broadcast_send_web")}function Dc(){return d("WAWebABProps").getABPropConfigValue("ctwa_smb_detected_outcome_labels_banners_enabled")}function Ec(){return d("WAWebABProps").getABPropConfigValue("web_linked_catalog_consumer_cart_enabled")}function Fc(){return d("WAWebABProps").getABPropConfigValue("ctwa_custom_label_signals_enabled")}function Gc(){return d("WAWebABProps").getABPropConfigValue("ctwa_web_custom_label_signals_enabled")}function Hc(){return d("WAWebABProps").getABPropConfigValue("ctwa_custom_label_algorithm")}function Ic(){return d("WAWebABProps").getABPropConfigValue("ctwa_3pd_data_sharing_cooldown_for_opted_out")}function Jc(){return d("WAWebABProps").getABPropConfigValue("ctwa_web_3pd_data_sharing_cooldown_for_opted_out")}function Kc(){return d("WAWebMobilePlatforms").isSMB()&&d("WAWebABProps").getABPropConfigValue("payments_br_pix_web_attachment_tray")}function Lc(){return d("WAWebABProps").getABPropConfigValue("smb_ctwa_chat_header_label_entry_point_enabled")}g.canDisplayLabel=a;g.canEditLabelAssociation=c;g.canSendQuickReply=j;g.canSendQuickReplyInChat=e;g.webBizProfileOptions=f;g.canManageCollections=k;g.canAppealCollections=l;g.nativeFlowMessagesEnabled=m;g.interactiveNativeFlowMessagesEnabled=n;g.interactiveResponseMessagesEnabled=o;g.interactiveNativeFlowResponseMessagesEnabled=p;g.canSeeECommerceComplianceIndiaSoftEnforcement=q;g.canSeeECommerceComplianceIndiaHardEnforcementBusinessJourney=r;g.canSeeECommerceComplianceIndiaCountryOriginExemptBusinessJourney=s;g.blockCatalogCreationECommerceComplianceIndia=t;g.isWidInPaymentsCountry=w;g.isBizToolsDrawerEnabled=x;g.tos3GatingEnabled=z;g.tosFetchIteration=A;g.tosFetchEnabled=B;g.shopsInteractiveMessageEnabled=C;g.bannedShopsEnabled=D;g.smbClickToChatLoggingEnabled=E;g.smbBizProfileLoggingEnabled=F;g.bizLinkedAccountsEnabled=G;g.canViewBizLinkedAccounts=H;g.commerceFeaturesDisabledBySanctions=I;g.isBizCoverPhotoEditEnabled=J;g.isBizCoverPhotoViewEnabled=K;g.catalogCategoriesEnabled=L;g.QuickPayProductTypeGating=M;g.isOrderDetailsQuickPayEnabled=aa;g.billingEnabled=ba;g.isPSForCatalogViewEnabled=ca;g.smartFiltersEnabled=da;g.isMultiDeviceMessageAttributionEnabled=N;g.inOrderMessagesEphemeralExceptionEnabled=b;g.isMultiDeviceAgentsLoggingEnabled=ea;g.isSmbOrangeEnabled=fa;g.subscriptionFetchEnabled=ga;g.isMetaVerifiedEnabled=O;g.isPremiumBillingEnabled=P;g.commerceThreadsLoggingEnabled=ha;g.isCustomURLViaBizProfileEnabled=ia;g.getFmxAgmEnabled=Q;g.getWamoAgmEnabled=R;g.isQuantityControlsFeatureEnabled=ja;g.quickRepliesManagementEnabled=ka;g.isCollectionReorderingEnabled=la;g.coverPhotoPrivacyMessagingEnabled=ma;g.chatAssignmentEnabled=S;g.chatAssignmentSystemMessagesEnabled=na;g.chatAssignmentMaxNuxImpressions=oa;g.hideUnsupportedCurrency=pa;g.graphQLForCatalogM1Enabled=qa;g.graphQLForCollectionM2Enabled=ra;g.graphQLForCreateProductCatalogEnabled=sa;g.graphQLForGetProductCatalogEnabled=ta;g.graphQLForAddProductEnabled=ua;g.graphQLForEditProductEnabled=va;g.graphQLForDeleteProductEnabled=wa;g.graphQLForGetProductEnabled=xa;g.graphQLForReportProductEnabled=ya;g.graphQLForAppealProductEnabled=za;g.graphQLForCreateCollectionEnabled=Aa;g.graphQLForUpdateCollectionEnabled=Ba;g.graphQLForUpdateCollectionListEnabled=Ca;g.graphQLForDeleteCollectionEnabled=Da;g.graphQLForAppealCollectionEnabled=Ea;g.graphQLForGetCollectionsEnabled=Fa;g.graphQLForGetSingleCollectionEnabled=Ga;g.graphQLForGetProductListEnabled=Ha;g.graphQLForUpdateProductVisibilityEnabled=Ia;g.graphQLForCommerceSettingsEnabled=Ja;g.isGraphQLForVerifyPostcodeEnabled=Ka;g.isGraphQLForGetPublicKeyEnabled=La;g.graphQLForRefreshCartEnabled=Ma;g.getBillingPremiumAccessConfig=Na;g.countryGatingEnabled=Oa;g.orderDetailsCustomItemEnabled=Pa;g.orderDetailsFromCatalogEnabled=Qa;g.orderDetailsFromCartEnabled=Ra;g.orderDetailsTotalOrderMinimumValue=Sa;g.orderDetailsTotalMaxValue=Ta;g.orderManagementEnabled=Ua;g.btmThreadsLoggingEnabled=Va;g.shouldReorderChatOnAssignment=Wa;g.utmTrackingExpirationInHours=Xa;g.isUtmTrackingEnabled=Ya;g.isAdsAttributionEnabled=Za;g.isHideAdContextIfSoftDismissed=$a;g.isUpdatedConsumerDisclosureUiRowEnabled=ab;g.isUpdatedConsumerDisclosureUiIndiaEnabled=bb;g.isUpdatedConsumerDisclosureUiBrazilEnabled=cb;g.shouldUseNewContentForConsumerDisclosure=db;g.smbDataSharingConsentEnabled=eb;g.smbDataSharingOptInCoolOffSeconds=fb;g.chatAssignmentNotificationsEnabled=gb;g.isNonBlockingConsumerTosAbpropEnabled=hb;g.adsActionBannersEnabled=T;g.adsActionBannersLoggingEnabled=ib;g.adsActionBannersEnabledOnStartup=d("WAWebMobilePlatforms").isSMB;g.adsActionManageAdsBannerEnabled=jb;g.qpCampaignsEnabled=kb;g.qpGraphQLEnabled=lb;g.qpGraphQLFetchIntervalMinutes=mb;g.qpSurfaceIdsUsingGraphQL=nb;g.shouldShowAdCreationIcon=ob;g.shouldShowAdCreationDropdown=pb;g.adCreationEntryPointCatalogEnabled=qb;g.adCreationEntryPointCatalogProductEnabled=rb;g.adEntryPointsConfigurationFetchEnabled=U;g.adEntryPointsConfigurationFetchThreshold=sb;g.adEntryPointsConfigurationFetchM1Enabled=tb;g.isInLongTermHoldoutFallbackWhenAdEntryPointsConfigurationMissing=ub;g.shouldShowManageAdsDropdown=vb;g.shouldFetchLinkedAccounts=wb;g.nativeAdsCreationEnabled=xb;g.nativeAdsCreationHawkToolEnabled=yb;g.nativeAdsCreationTargetingModalHawkToolEnabled=zb;g.businessProfileRefreshEnabled=Ab;g.adManagementEnabled=V;g.adManagementActionsDisplayingEnabled=Bb;g.adManagementMetricsDisplayingEnabled=Cb;g.adManagementRecoveryFlowEnabled=W;g.adAccountTokenStoringEnabled=Db;g.adAccountTokenNoncePushWaitTimeoutSeconds=Eb;g.adAccountTokenNonceMaxRetries=Fb;g.grapQLRecoveryDuringAdAccountRecoveryEnabled=Gb;g.isSMBEnhancedLoggingEnabled=Hb;g.isSMBLabelsDataSharingEnabledForChats=Ib;g.isSMBDataSharingOrderCopyOptimizationEnabled=Jb;g.isOrderContentOptimizationEnabled=X;g.shouldShowSMBDataSharingSettings=Kb;g.showDataSharingInSettingsAfterNuxDismiss=Lb;g.showDataSharingInSettingsAfterCtwaMessageReceived=Mb;g.isSMBLabelsDataSharingEnabledForMessages=Nb;g.isMessageWithLinkNfmEnabled=Ob;g.isPremiumMessagesClickLoggingEnabled=Pb;g.isBuyerOrderRevampEnabled=Y;g.isSellerOrderRevampEnabled=Qb;g.isBuyerOrderRequestVariantEnabled=Rb;g.isOrderStatusM1Enabled=Sb;g.isPremiumMessagesUrlCtaDialogEnabled=Tb;g.isBrazilToBrazilOrder=Z;g.carouselsEnabled=Ub;g.labelsEditingEnabled=Vb;g.isLabelReorderingSyncFromPrimaryEnabled=Wb;g.isLabelReorderingInWebEnabled=Xb;g.is3pdSignalNewCustomerEnabled=Yb;g.is3pdLeadOptimisationLabelSignalsEnabled=Zb;g.is3pdImportantLabelSignalsEnabled=$b;g.isPremiumMessagesNewLeavingWAContentEnabled=ac;g.getTrackableLinkDomain=bc;g.smbNotesV1Enabled=cc;g.smbNotesPrivacyStringABProp=dc;g.isBizToolsTopCardEnabled=ec;g.isMetaVerifiedContextCardEnabled=fc;g.isMetaVerifiedLockedProfileEditingV1Enabled=gc;g.isCatalogVideoViewFallbackEnabled=hc;g.isCatalogVideoViewEnabled=ic;g.isGetCustomUrlUserGraphqlMigrationEnabled=jc;g.isBizAiChatAssignmentHidingEnabled=kc;g.isBizAiChatAssignmentInteropTosEnabled=lc;g.isLidMigrationForVnameEnabled=mc;g.isUsingSignedShimmedLinkInCatalogueEnabled=nc;g.isLidMigrationForBusinessProfileEnabled=oc;g.isCatalogProductSalePriceEnabled=pc;g.isLidMigrationForCatalogEnabled=qc;g.isSignalDecouplingEnabled=rc;g.isCountryOfOriginEnabled=$;g.isDownload3PDSignalsEnabled=sc;g.showComplianceFieldsInEditProductDrawer=tc;g.showImporterInformationInEditProductDrawer=uc;g.catalogTokenRecoveryEnabled=vc;g.shouldGenerateAGMMsgs=wc;g.isCatalogVariantsViewingEnabled=xc;g.isCTWADetectedOutcomeWS1Enabled=yc;g.isCTWADetectedOutcomeWS3Enabled=zc;g.isCTWADetectedOutcomeWS4Enabled=Ac;g.isBizBroadcastContactImportEnabled=Bc;g.isBizBroadcastSendWebEnabled=Cc;g.isCTWADetectedOutcomeWS2Enabled=Dc;g.isConsumerLinkedCatalogCartEnabled=Ec;g.isCTWACustomLabelsSignalsEnabled=Fc;g.isCTWAWebCustomLabelsSignalsEnabled=Gc;g.getCTWACustomLabelAlgorithmGroup=Hc;g.isCTWA3pdCooldownForOptedOutUsersEnabled=Ic;g.isCTWAWeb3pdCooldownForOptedOutUsersEnabled=Jc;g.isPixInAttachmentTrayEnabled=Kc;g.isCTWAChatHeaderLabelEntryPointEnabled=Lc}),98);
__d("WAWebBizTemplateAndInteractiveMessagesUtils",["WAWebABProps","WAWebBizGatingUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){var h=3,i=[(e=c("WAWebInteractiveMessagesNativeFlowName")).QUICK_REPLY,e.CTA_CALL,e.CTA_URL,e.CTA_CATALOG,e.CTA_COPY_CODE,e.CTA_FLOW,e.ORDER_STATUS];function j(a){switch(a){case"review_and_pay":return c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS;case"payment_info":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO;case"review_order":return c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS;case"order_status":return d("WAWebABProps").getABPropConfigValue("rich_order_status_wa_web")?c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS:null;case"payment_status":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS;case"payment_method":return c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD;case"open_webview":return c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK;case"message_with_link_status":return c("WAWebInteractiveMessagesNativeFlowName").MESSAGE_WITH_LINK_STATUS;case"cta_url":return c("WAWebInteractiveMessagesNativeFlowName").CTA_URL;case"cta_call":return c("WAWebInteractiveMessagesNativeFlowName").CTA_CALL;case"quick_reply":return c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY;case"cta_catalog":return c("WAWebInteractiveMessagesNativeFlowName").CTA_CATALOG;case"cta_copy":return c("WAWebInteractiveMessagesNativeFlowName").CTA_COPY_CODE;case"galaxy_message":return c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW}}function a(a,b,e){if(d("WAWebMsgGetters").isBizSourceFromMarketingMessage(e))return d("WAWebABProps").getABPropConfigValue("web_premium_messages_interactivity_rendering_enabled");else if(e==="quoted_carousel_card"&&a===c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY)return d("WAWebBizGatingUtils").carouselsEnabled();else if(l(a))return!0;return b===!0?d("WAWebABProps").getABPropConfigValue("web_premium_messages_interactivity_rendering_enabled"):!1}var k=function(a){if(a.hydratedTemplateButton!=null)return a.hydratedTemplateButton.quickReplyButton!=null;else if(a.nativeFlowButton!=null)return a.nativeFlowButton.name===String(c("WAWebInteractiveMessagesNativeFlowName").QUICK_REPLY);return!1};function b(a){if(a.length>h)return!0;if(a.length>0){var b=k(a[0]);if(!a.slice(1).every(function(a){var c=k(a);a=(a=a.nativeFlowButton)==null?void 0:a.name;a=j(a);a=a!=null?i.includes(a):!0;return a&&b===c}))return!0}return!1}function l(a){return i.includes(a)}g.supportedNativeFlowButtonNamesForInteractiveMsg=i;g.getNativeFlowNameByButtonName=j;g.isInteractiveCtaMessageEnabled=a;g.buttonsViolateButtonImprovementsConstraints=b}),98);
__d("WAWebMessagingGatingUtils",["WAWebABProps","WAWebDBReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_to_new_groups")}function b(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_min_group_size")}function c(){return d("WAWebABProps").getABPropConfigValue("web_send_invisible_msg_max_group_size")}function e(){var a;return(a=d("WAWebABProps").getABPropConfigValue("group_size_bypassing_sampling"))!=null?a:1e5}function f(){return l()>0}function h(){return d("WAWebABProps").getABPropConfigValue("rt_receive_reporting_tag")}function i(){return d("WAWebABProps").getABPropConfigValue("rt_sync_reporting_tag")}function j(){var a;return(a=d("WAWebABProps").getABPropConfigValue("rt_clean_reporting_tag"))!=null?a:d("WAWebDBReportingTokenUtils").DEFAULT_RT_CLEANUP_OLDER_THAN_DAYS}function k(){return d("WAWebABProps").getABPropConfigValue("rt_clean_reporting_token")}function l(){return d("WAWebABProps").getABPropConfigValue("rt_sender_reporting_token_version")}function m(){return d("WAWebABProps").getABPropConfigValue("rt_sender_dual_encrypted_msg_enabled")}function n(){return d("WAWebABProps").getABPropConfigValue("rt_receiver_dual_encrypted_msg_enabled")}function o(){return d("WAWebABProps").getABPropConfigValue("rt_edit_receive")}function p(){return d("WAWebABProps").getABPropConfigValue("rt_web_delay_processing")}function q(){return d("WAWebABProps").getABPropConfigValue("rt_report_token_from_inclusion_list")}function r(){return d("WAWebABProps").getABPropConfigValue("ft_validation_failure_drop_placeholder")}function s(){return d("WAWebABProps").getABPropConfigValue("visible_message_drop_placeholder_enabled_internal_only")}function t(){return d("WAWebABProps").getABPropConfigValue("disappearing_message_timer_more_options")}g.sendKeyDistributionMsgToNewGroups=a;g.sendKeyDistributionMsgMinGroupSize=b;g.sendKeyDistributionMsgMaxGroupSize=c;g.getGroupSizeBypassingSampling=e;g.isReportingTokenSendingEnabled=f;g.isReportingTokenReceivingEnabled=h;g.isReportingTagSyncingEnabled=i;g.getReportingTagCleanupDays=j;g.getReportingTokenCleanupDays=k;g.getSenderReportingTokenVersion=l;g.isDualEncryptedReportingTokenSendingEnabled=m;g.isDualEncryptedReportingTokenReceiveEnabled=n;g.isReportingTokenEditReceiveEnabled=o;g.isWebReportingTokenDelayProcessingEnabled=p;g.isReportingTokenFromInclusionListEnabled=q;g.isReportingTokenValidationFailureDebugPlaceholderEnabled=r;g.isMessageDropPlaceholderEnabled=s;g.isDisappearingMessageTimerShorterOptionsEnabled=t}),98);
__d("WAWebSyncGatingUtils",["WALogger","WAWebABProps","WAWebMobilePlatforms","WAWebPrimaryFeaturesModel","WAWebUserPrefsHistorySync"],(function(a,b,c,d,e,f,g){var h;function a(){if(!d("WAWebPrimaryFeaturesModel").PrimaryFeatures.historySyncOnDemand)return!1;var a=d("WAWebUserPrefsHistorySync").getInitialHistorySyncCompleteLocalStorage(),b=d("WAWebUserPrefsHistorySync").getHistoryInitialSyncBoundary();if(a&&(b==null||Object.keys(b).length===0)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[rdu] History sync on demand feature is disabled as initial sync is incomplete or initial sync boundary is not available"])));return!1}a=d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.ANDROID||d("WAWebMobilePlatforms").getMobilePlatform()===d("WAWebMobilePlatforms").PLATFORMS.SMBA;return a&&d("WAWebPrimaryFeaturesModel").PrimaryFeatures.isPrimaryBetaBuild&&d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_with_android_beta")?!0:d("WAWebABProps").getABPropConfigValue("history_sync_on_demand")}function b(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.historySyncOnDemand}function c(){return d("WAWebABProps").getABPropConfigValue("placeholder_message_resend")}function e(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.webLinkPreviewNseSupport}function f(){return d("WAWebPrimaryFeaturesModel").PrimaryFeatures.messagePlaceholderResendNseSupport}function i(){return d("WAWebABProps").getABPropConfigValue("web_noncritical_history_sync_message_processing_break_iteration")}function j(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_handling_loop_restart_v2_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_chunk_download_optimization")}function l(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_worker_compatible_handling")}function m(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_next_chunk_fetch_optimization")}function n(){return d("WAWebABProps").getABPropConfigValue("web_recent_sync_chunk_data_handling_worker")}function o(){return d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_companion")}function p(){return d("WAWebABProps").getABPropConfigValue("history_sync_on_demand_time_boundary_days_desktops")}g.isHistorySyncOnDemandEnabled=a;g.shouldPopulateStarMessageWithTimestamp=b;g.isPlaceholderMessageResendEnabled=c;g.isWebLinkPreviewNseSupportEnabled=e;g.isMessagePlaceholderResendNseSupportEnabled=f;g.getRecentSyncMessageProcessingBreakIteration=i;g.isHistorySyncHandlingRestartV2Enabled=j;g.isRecentSyncDownloadOptimizationEnabled=k;g.isRecentSyncWorkerComaptibleHandlingEnabled=l;g.isRecentSyncNextChunkFetchOptimizationEnabled=m;g.isRecentSyncChunkDataHandlingInWorkerEnabled=n;g.isOnDemandExtendedHistorySyncForHybridEnabled=o;g.getHistorySyncOnDemandTimeBoundaryDaysForDesktops=p}),98);
__d("WAWebBizSystemMsgSubtypes",[],(function(a,b,c,d,e,f){a=["blue_msg_bsp_fb_to_bsp_premise","blue_msg_bsp_fb_to_self_fb","blue_msg_bsp_fb_to_self_premise","blue_msg_bsp_fb_unverified","blue_msg_bsp_fb_unverified_to_bsp_premise_verified","blue_msg_bsp_fb_unverified_to_self_fb_verified","blue_msg_bsp_fb_unverified_to_self_premise_verified","blue_msg_bsp_fb_verified","blue_msg_bsp_fb_verified_to_bsp_premise_unverified","blue_msg_bsp_fb_verified_to_self_fb_unverified","blue_msg_bsp_fb_verified_to_self_premise_unverified","blue_msg_bsp_premise_to_self_premise","blue_msg_bsp_premise_unverified","blue_msg_bsp_premise_unverified_to_self_premise_verified","blue_msg_bsp_premise_verified","blue_msg_bsp_premise_verified_to_self_premise_unverified","blue_msg_consumer_to_bsp_fb_unverified","blue_msg_consumer_to_bsp_premise_unverified","blue_msg_consumer_to_self_fb_unverified","blue_msg_consumer_to_self_premise_unverified","blue_msg_self_fb_to_bsp_premise","blue_msg_self_fb_to_self_premise","blue_msg_self_fb_unverified","blue_msg_self_fb_unverified_to_bsp_premise_verified","blue_msg_self_fb_unverified_to_self_premise_verified","blue_msg_self_fb_verified","blue_msg_self_fb_verified_to_bsp_premise_unverified","blue_msg_self_fb_verified_to_self_premise_unverified","blue_msg_self_premise_to_bsp_premise","blue_msg_self_premise_unverified","blue_msg_self_premise_verified","blue_msg_to_bsp_fb","blue_msg_to_consumer","blue_msg_to_self_fb","blue_msg_unverified_to_bsp_fb_verified","blue_msg_unverified_to_bsp_premise_verified","blue_msg_unverified_to_self_fb_verified","blue_msg_unverified_to_verified","blue_msg_verified_to_bsp_fb_unverified","blue_msg_verified_to_bsp_premise_unverified","blue_msg_verified_to_self_fb_unverified","blue_msg_verified_to_unverified"];b=["biz_privacy_mode_init_fb","biz_privacy_mode_init_bsp"];c=["biz_privacy_mode_to_fb","biz_privacy_mode_to_bsp"];d=[].concat(b,c);e=["biz_account_type_is_hosted","biz_account_type_changed_to_hosted","biz_me_account_type_is_hosted","biz_me_account_type_is_hosted_transition"];c="product_inquiry";f.BIZ_SYSTEM_MSG_SUBTYPES=a;f.BIZ_SYSTEM_MSG_SUBTYPES_V2_INIT=b;f.BIZ_SYSTEM_MSG_SUBTYPES_V2=d;f.COEX_MSG_SUBTYPES=e;f.PRODUCT_INQUIRY_TYPE=c}),66);
__d("WAWebCallLogMsgData.flow",["$InternalEnum"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum").Mirrored(["Completed","Missed","Rejected","Canceled","AcceptedElsewhere","Ongoing","Failed","Unknown"]);g.CallOutcome=a}),98);
__d("WAWebEphemeralConstants",["$InternalEnum","WATimeUtils"],(function(a,b,c,d,e,f,g){c=d("WATimeUtils").DAY_SECONDS*7;e=d("WATimeUtils").DAY_SECONDS*90;f=b("$InternalEnum").Mirrored(["KEPT","UNKEPT"]);var h=b("$InternalEnum").Mirrored(["Seconds","Minutes","Hours","Days","Weeks"]);function a(a,b){b===void 0&&(b=!1);if(a<=d("WATimeUtils").MINUTE_SECONDS)return{duration:a,unit:h.Seconds};else if(a<d("WATimeUtils").HOUR_SECONDS){var c=Math.floor(a/60);return{duration:c,unit:h.Minutes}}else if(a<=d("WATimeUtils").DAY_SECONDS){c=Math.floor(a/60/60);return{duration:c,unit:h.Hours}}else if(Boolean(b)){if(a<d("WATimeUtils").WEEK_SECONDS){c=Math.floor(a/24/60/60);return{duration:c,unit:h.Days}}b=Math.floor(a/7/24/60/60);return{duration:b,unit:h.Weeks}}c=Math.floor(a/24/60/60);return{duration:c,unit:h.Days}}g.ONE_DAY=d("WATimeUtils").DAY_SECONDS;g.SEVEN_DAYS=c;g.NINETY_DAYS=e;g.KeepInChatState=f;g.DurationUnit=h;g.getDurationForString=a}),98);
__d("WAWebEphemeralityWAMUtils",["WAWebEphemeralityTypes","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType"],(function(a,b,c,d,e,f,g){function a(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.ACCOUNT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.CHAT_SETTINGS;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BulkChange:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.BULK_CHANGE;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.UNKNOWN_GROUP;case d("WAWebEphemeralityTypes").DisappearingModeTrigger.BizSupportFbHosting:case d("WAWebEphemeralityTypes").DisappearingModeTrigger.Unknown:return d("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE.UNKNOWN}}function b(a){a===void 0&&(a=!1);return Boolean(a)?d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_ME:d("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE.INITIATED_BY_OTHER}function c(a){switch(a){case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_ME;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther:case d("WAWebEphemeralityTypes").DisappearingModeInitiator.BizUpgradeFbHosting:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.INITIATED_BY_OTHER;case d("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:return d("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE.CHAT}}g.getWamDisappearingModeTrigger=a;g.getWamDisappearingModeInitiatedByMe=b;g.getWamDisappearingModeInitiator=c}),98);
__d("WAWebInteractiveMessageHeaderMediaType",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["IMAGE","VIDEO","DOCUMENT","PRODUCT"]);c=new Set([a.IMAGE,a.VIDEO,a.DOCUMENT,a.PRODUCT]);f.InteractiveMessageHeaderMediaType=a;f.IM_MEDIA_HEADER_TYPES=c}),66);
__d("WAWebNewsletterIsNewsletterMsg",["WAWebWid"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.from;a=a.to;return c("WAWebWid").isNewsletter(b)||c("WAWebWid").isNewsletter(a)}g["default"]=a}),98);
__d("WAWebCreateViewModeProcessor",[],(function(a,b,c,d,e,f){function a(a){return babelHelpers["extends"]({},a)}function b(a){return babelHelpers["extends"]({},a,{messageVisibleInChat:function(){return!0},messageVisibleInChatlistPreview:function(){return!0},shouldShowInNotification:function(){return!0},shouldShowInSearch:function(){return!0},shouldIncludeInChatSpamReport:function(){return!0}})}function c(a){return babelHelpers["extends"]({},a,{messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!1},shouldIncludeInChatSpamReport:function(){return!1}})}f.createViewModeProcessor=a;f.createFullyVisibleViewModeProcessor=b;f.createFullyHiddenViewModeProcessor=c}),66);
__d("WAWebCallLogViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.HISTORY_SYNCED_CALL_LOG,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.CALL_LOG],messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!0},shouldIncludeInChatSpamReport:function(){return!1}});b=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.CALL_LOG_OFFLINE_RESUME,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.CALL_LOG],messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!0},shouldIncludeInChatSpamReport:function(){return!1}});c=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.CALL_LOG_AD_HOC_GROUP_CALL,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.CALL_LOG],messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!0},shouldIncludeInChatSpamReport:function(){return!1}});g.HistorySyncedCallLogViewModeProcessor=a;g.CallLogOfflineResumeViewModeProcessor=b;g.CallLogAdHocGroupCallViewModeProcessor=c}),98);
__d("WAWebHiddenViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyHiddenViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.HIDDEN});b=a;g["default"]=b}),98);
__d("WAWebInvisiblePlaceholderViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyHiddenViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.ALBUM,d("WAWebMsgType").MSG_TYPE.POLL_CREATION]});g.InvisiblePlaceholderViewModeProcessor=a}),98);
__d("WAWebMediaAlbumViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebMsgType","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM,compatibleMessageTypes:[d("WAWebMsgType").MSG_TYPE.IMAGE,d("WAWebMsgType").MSG_TYPE.VIDEO],messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!0},shouldIncludeInChatSpamReport:function(){return!1}});g.mediaAlbumViewModeProcessor=a}),98);
__d("WAWebNewsletterTombstoneViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE,messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!1},shouldIncludeInChatSpamReport:function(){return!1}});b=a;g["default"]=b}),98);
__d("WAWebPollMediaViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.POLL_MEDIA,messageVisibleInChat:function(){return!1},messageVisibleInChatlistPreview:function(){return!1},shouldShowInNotification:function(){return!1},shouldShowInSearch:function(){return!1},shouldIncludeInChatSpamReport:function(){return!1}});b=a;g["default"]=b}),98);
__d("WAWebVisibleViewModeProcessor",["WAWebCreateViewModeProcessor","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){a=d("WAWebCreateViewModeProcessor").createFullyVisibleViewModeProcessor({type:d("WAWebViewMode.flow").ViewModeType.VISIBLE});b=a;g["default"]=b}),98);
__d("WAWebViewModeProcessor",["WAWebCallLogViewModeProcessor","WAWebHiddenViewModeProcessor","WAWebInvisiblePlaceholderViewModeProcessor","WAWebMediaAlbumViewModeProcessor","WAWebNewsletterTombstoneViewModeProcessor","WAWebPollMediaViewModeProcessor","WAWebViewMode.flow","WAWebVisibleViewModeProcessor"],(function(a,b,c,d,e,f,g){function a(a){if(a==null)return c("WAWebVisibleViewModeProcessor");switch(a){case d("WAWebViewMode.flow").ViewModeType.VISIBLE:return c("WAWebVisibleViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.HIDDEN:return c("WAWebHiddenViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.MEDIA_ALBUM:return d("WAWebMediaAlbumViewModeProcessor").mediaAlbumViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.INVISIBLE_PLACEHOLDER:return d("WAWebInvisiblePlaceholderViewModeProcessor").InvisiblePlaceholderViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE:return c("WAWebNewsletterTombstoneViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.POLL_MEDIA:return c("WAWebPollMediaViewModeProcessor");case d("WAWebViewMode.flow").ViewModeType.HISTORY_SYNCED_CALL_LOG:return d("WAWebCallLogViewModeProcessor").HistorySyncedCallLogViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.CALL_LOG_OFFLINE_RESUME:return d("WAWebCallLogViewModeProcessor").CallLogOfflineResumeViewModeProcessor;case d("WAWebViewMode.flow").ViewModeType.CALL_LOG_AD_HOC_GROUP_CALL:return d("WAWebCallLogViewModeProcessor").CallLogAdHocGroupCallViewModeProcessor}}g.getViewModeProcessor=a}),98);
__d("WAWebViewModeUtils",["WAWebMessageAssociation.flow","WAWebMsgType","WAWebPollCreationUtils","WAWebViewMode.flow","WAWebViewModeProcessor"],(function(a,b,c,d,e,f,g){function h(a,b){b=d("WAWebViewModeProcessor").getViewModeProcessor(b);switch(a){case d("WAWebViewMode.flow").ViewModeSurface.CHAT:return b.messageVisibleInChat();case d("WAWebViewMode.flow").ViewModeSurface.SEARCH:return b.shouldShowInSearch();case d("WAWebViewMode.flow").ViewModeSurface.CHAT_LIST:return b.messageVisibleInChatlistPreview();case d("WAWebViewMode.flow").ViewModeSurface.NOTIFICATION:return b.shouldShowInNotification();case d("WAWebViewMode.flow").ViewModeSurface.CHAT_SPAM_REPORT:return b.shouldIncludeInChatSpamReport()}}function a(a){return a.associationType===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL||a.type===d("WAWebMsgType").MSG_TYPE.POLL_CREATION&&a.pollContentType===d("WAWebPollCreationUtils").PollContentType.IMAGE?!0:h(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a.viewMode)}g.isViewModeVisibleInSurface=h;g.isMessageExistingInChat=a}),98);
__d("WAWebMsgGetters",["WABase64","WALogger","WAPhoneFindCC","WATimeUtils","WATypeUtils","WAWebAck","WAWebBizSystemMsgSubtypes","WAWebBotTypes","WAWebBusinessHSMTypes","WAWebCallLogMsgData.flow","WAWebCommonMsgUtils","WAWebConstantsDeprecated","WAWebEphemeralConstants","WAWebEphemeralityWAMUtils","WAWebGetters","WAWebGettersCaches","WAWebInteractiveMessageHeaderMediaType","WAWebMimeTypes","WAWebMsgType","WAWebMusicParsingUtils","WAWebNewsletterIsNewsletterMsg","WAWebPollCreationUtils","WAWebProtobufsAICommon.pb","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebVcardParsingUtils","WAWebViewMode.flow","WAWebViewModeUtils","WAWebWamEnumEditType","WAWebWid","WAWebWidFactory","gkx","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){var h,i,j,k;a=d("WAWebGetters").createGetterFactories({createCache:d("WAWebGettersCaches").createMessagesCache});b=a.field;e=a.computed;f=a.unsafeIdentityGetter;a=a.clearCacheFor;a=a;f=f;function l(a){if(a instanceof c("WAWebWid"))return a;return a.user!=null?d("WAWebWidFactory").createUserWidOrThrow(a.user,a.server):a}var m=b("type"),n=b("subtype"),o=b("id"),aa=b("serverId"),p=b("to"),q=b("from"),r=b("broadcastId"),ba=e(function(a){var b=a[0];a=a[1];return a!=null?a:b.remote},[o,r]),s=b("viewMode"),t=b("author"),u=b("ack"),ca=b("viewCount"),da=b("viewed"),v=b("originalSelfAuthor"),w=b("kicState"),ea=b("kicTimestampMs"),x=b("list"),y=b("latestEditMsgKey"),fa=b("errorCode"),z=b("ephemeralDuration"),ga=b("ephemeralSettingUser"),A=b("t",{"default":0}),ha=b("clientReceivedTsMillis"),B=b("backgroundColor"),ia=b("headerType"),C=b("interactiveHeader"),ja=b("interactiveType"),ka=b("footer"),D=b("mentionedJidList"),la=b("groupMentions",{getDefault:function(){return[]}}),E=b("quotedMsg"),ma=b("quotedRemoteJid"),F=b("quotedParticipant"),na=b("quotedType"),G=b("rcat"),oa=b("isViewOnce",{"default":!1}),pa=b("isGif",{"default":!1}),qa=b("gifAttribution",{"default":d("WAWebProtobufsE2E.pb").Message$VideoMessage$Attribution.NONE}),ra=b("ctwaContext"),sa=b("mimetype"),ta=b("filehash"),ua=b("deprecatedMms3Url"),va=b("waveform"),wa=b("disappearingModeInitiator"),xa=b("disappearingModeTrigger"),ya=b("disappearingModeInitiatedByMe"),za=b("activeBotMsgStreamingInProgress"),H=b("bizBotType"),Aa=b("botTargetSenderJid"),Ba=b("isSupportAIMessage"),Ca=b("lastBotEditBodyLength"),Da=b("botEditType"),Ea=b("forwardedNewsletterMessageInfo"),Fa=b("newsletterAdminInviteInfo"),Ga=b("newsletterFollowerInviteInfo"),I=b("isGroupStatus");I=e(function(a){a=a[0];return a===!0},[I]);var Ha=b("bizSource");function Ia(a){return a==="smb_promo"}var Ja=e(function(a){a=a[0];return Ia(a)},[Ha]),Ka=e(function(a){a=a[0];return a!=null},[E]),La=e(function(a){a=a[0];return d("WAWebMimeTypes").isOpus(a)},[sa]),Ma=e(function(a){a=a[0];return a==null?null:d("WABase64").encodeB64UrlSafe(a,!0)},[G]),Na=e(function(a){a=a[0];return a==null?!1:a.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(l(a))})},[D]),Oa=b("local",{"default":!1}),J=e(function(a){var b=a[0];a=a[1];return b&&a?d("WAWebUserPrefsMeUser").isMeAccount(l(a)):!1},[E,F]);J=e(function(a){var b=a[0];a=a[1];return b||a},[Na,J]);var Pa=b("botPluginReferenceIndex"),Qa=e(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];if(c!=null)return!1;if(!d("WAWebViewModeUtils").isViewModeVisibleInSurface(d("WAWebViewMode.flow").ViewModeSurface.CHAT,a))return!1;switch(b){case"interactive":return e;case"chat":case"image":case"video":case"ptv":case"audio":case"ptt":case"document":case"vcard":case"location":case"ciphertext":case"oversized":case"multi_vcard":case"sticker":case"status":case"product":case"groups_v4_invite":case"poll_creation":case"poll_result_snapshot":case"list":case"newsletter_admin_invite":case"newsletter_follower_invite":case"event_creation":case"sticker-pack":case"album":case"rich_response":case"automated_greeting_message":case"quarantined":return!0;default:b;return!1}},[m,Pa,Ja,s]),K=e(function(a){var b=a[0];a=a[1];return c("WAWebWid").isGroup(b)||c("WAWebWid").isGroup(a)},[q,p]),L=e(function(a){var b=a[0];a=a[1];return c("WAWebNewsletterIsNewsletterMsg")({from:b,to:a})},[q,p]),M=e(function(a){var b=a[0];a=a[1];return b||a!=null},[L,Ea]),N=e(function(a){var b=a[0];a=a[1];return c("WAWebWid").isStatus(b.remote)||a},[o,I]),Ra=e(function(a){var b=a[0];a=a[1];return d("WAWebCommonMsgUtils").isNotificationType(b,a)},[m,n]),O=e(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];if(b.self==="in"||c){c||d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["id.self === 'in' for a non-notification message, type: ",", subtype: ",", id: ",""])),e,a,b.toString()).sendLogs("self-in-not-notification");return!1}return b.fromMe},[o,Ra,m,n]),P=e(function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6];a=a[7];if(g)return b.remote;return c?h?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():i:e||f||a!=null&&a.isBot()?a:i},[o,O,K,N,I,L,q,t]),Sa=e(function(a){var b=a[0],e=a[1];a=a[2];b=b||e;b!=null&&b.isUser==null&&(c("gkx")("26258")?d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unexpected non-wid for originalSelfAuthorOrSender; typeof=","; msg.type=",""])),typeof b,a).sendLogs("non-wid-originalselfauthororsender"):d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Unexpected non-wid for originalSelfAuthorOrSender; value=","; typeof=","; msg.type=",""])),String(b),typeof b,a).sendLogs("non-wid-originalselfauthororsender"));return b!=null&&b.isUser!=null&&b.isUser()?d("WAWebWidFactory").asUserWidOrThrow(b):null},[v,P,m]),Ta=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.REACTION||a===d("WAWebMsgType").MSG_TYPE.REACTION_ENC},[m]),Ua=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.POLL_UPDATE&&a==="poll_vote"},[m,n]),Va=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.UNKNOWN||b===d("WAWebMsgType").MSG_TYPE.PAYMENT&&a==="futureproof"},[m,n]),Wa=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.STICKER},[m]),Xa=b("isCarouselCard",{"default":!1}),Q=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.DOCUMENT},[m]);Q=e(function(a){var b=a[0],c=a[1];a=a[2];return!b&&!c&&!a},[oa,Wa,Q]);var Ya=e(function(a){a=a[0];return a===d("WAWebEphemeralConstants").KeepInChatState.KEPT},[w]),Za=e(function(a){a=a[0];return a===d("WAWebEphemeralConstants").KeepInChatState.UNKEPT},[w]),$a=e(function(a){a=a[0];return c("WAWebWid").isPSA(a.remote)},[o]),ab=e(function(a){a=a[0];return c("WAWebWid").isIAS(a.remote)},[o]),bb=e(function(a){a=a[0];return c("WAWebWid").isAiHub(a.remote)},[o]),cb=e(function(a){a=a[0];return c("WAWebWid").isCAPISupportAccount(a.remote)},[o]),db=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.LIST&&(a==null?void 0:a.listType)===d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST},[m,x]),eb=b("title"),R=b("body",{"default":""}),fb=b("caption"),gb=b("comment"),hb=b("pollName",{"default":""}),ib=b("pollOptions"),jb=b("pollSelectableOptionsCount",{"default":0}),kb=b("pollInvalidated",{"default":!1}),lb=b("pollContentType",{"default":d("WAWebPollCreationUtils").PollContentType.TEXT}),mb=b("pollType",{"default":d("WAWebPollCreationUtils").PollType.POLL}),nb=b("correctOptionIndex"),ob=b("pollVotesSnapshot"),pb=b("quarantineExtractedText"),qb=b("eventName",{"default":""}),rb=b("eventDescription"),sb=b("eventStartTime",{"default":0}),tb=b("eventEndTime"),ub=b("eventJoinLink"),vb=b("eventLocation"),wb=b("isEventCanceled",{"default":!1}),xb=b("eventInvalidated",{"default":!1}),yb=b("eventIsScheduledCall",{"default":!1}),zb=b("eventExtraGuestsAllowed",{"default":!1}),Ab=b("replyCount",{"default":0}),Bb=b("nativeFlowName"),Cb=b("nativeFlowButtons"),Db=b("galaxyFlowDisabled",{"default":!1}),Eb=b("paymentCurrency",{"default":""}),Fb=b("paymentAmount1000",{"default":0}),Gb=b("paymentMessageReceiverJid"),Hb=b("paymentStatus"),Ib=b("paymentTxnStatus"),Jb=b("paymentNoteMsg"),Kb=b("paymentRequestMessageKey"),Lb=b("paymentExpiryTimestamp"),Mb=b("paymentInviteServiceType"),Nb=b("isFromTemplate",{"default":!1}),Ob=b("isLive",{"default":!1}),S=b("isDynamicReplyButtonsMsg",{"default":!1}),Pb=b("dynamicReplyButtons"),Qb=e(function(a){var b=a[0],c=a[1];a=a[2];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&c==="ephemeral_setting"?!1:a!=null&&a!==0},[m,n,z]),Rb=e(function(a){a=a[0];return a!=null},[y]),Sb=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a==="message_edit"},[m,n]),Tb=e(function(a){var b=a[0];a=a[1];if(!b)return null;b="rgba(86, 150, 255, 255)";a=a;if(a==null||a===0)return b;b=a>>24&255;var c=a>>16&255,d=a>>8&255;a=a&255;return"rgba("+c+", "+d+", "+a+", "+b+")"},[N,B]),Ub=e(function(a){a=a[0];switch(a){case"protocol":case"chat":case"location":case"vcard":case"multi_vcard":case"image":case"video":case"ptv":case"audio":case"ptt":case"document":case"sticker":case"status":case"product":case"groups_v4_invite":case"order":case"poll_creation":case"poll_result_snapshot":case"newsletter_admin_invite":case"newsletter_follower_invite":case"comment":case"event_creation":case"sticker-pack":case"album":case"rich_response":case"newsletter_question_response":case"quarantined":return!0;default:a;return!1}},[m]),Vb=e(function(a){var b=a[0],c=a[1];a=a[2];return b.fromMe&&c&&a},[o,Oa,Ub]),Wb=b("revokeSender"),Xb=e(function(a){a=a[0];return a!=null&&d("WAWebUserPrefsMeUser").isMeAccount(a)},[Wb]),Yb=e(function(a){var b=a[0],c=a[1];a=a[2];b=b.fromMe;b=b?c==null?void 0:c.toString({legacy:!0}):a==null?void 0:a.toString({legacy:!0});c=d("WAWebUserPrefsMeUser").getMaybeMePnUser();a=c==null?void 0:c.toString({legacy:!0});if(b&&a!=null)return d("WAPhoneFindCC").phoneCC(b)!==d("WAPhoneFindCC").phoneCC(a);d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Msg: could not derive isInternational as some data is missing"])));return!1},[o,p,q]),Zb=e(function(a){var b=a[0];a=a[1];if(b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE){if(d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES.includes(a))return!0;if(d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES_V2.includes(a))return!0;switch(a){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}}return!1},[m,n]),$b=e(function(a){var b=a[0];a=a[1];switch(b){case"image":case"video":case"audio":case"sticker-pack":return!0;case"interactive":return a==null?!1:a.mediaType===d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE||a.mediaType===d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO;default:return!1}},[m,C]),T=b("isForwarded",{"default":!1}),ac=b("forwardingScore"),bc=e(function(a){var b=a[0];a=a[1];return a==null?b?1:0:a||0},[T,ac]),cc=e(function(a){a=a[0];return a>=c("WAWebConstantsDeprecated").FREQUENTLY_FORWARDED_SENTINEL},[bc]),dc=b("isQuestion",{"default":!1}),ec=b("questionResponsesCount"),fc=b("readQuestionResponsesCount"),gc=e(function(a){var b=a[0];a=a[1];return b-a},[ec,fc]),hc=b("questionReplyQuotedMessage"),ic=e(function(a){a=a[0];return a!=null},[hc]),jc=e(function(a){var b=a[0];a=a[1];return b.fromMe&&a!=null&&a.some(function(a){return a.isBot()})},[o,D]),kc=e(function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b||c||a||!d},[T,M,O,jc]),lc=b("invis",{"default":!1}),mc=b("isNewMsg",{"default":!1}),nc=b("isSendFailure",{"default":!1}),oc=e(function(a){var b=a[0],c=a[1];a=a[2];return b&&c!=null&&c<d("WAWebAck").ACK.CLOCK||a},[O,u,nc]),pc=e(function(a){var b=a[0];a=a[1];if(b!==d("WAWebMsgType").MSG_TYPE.VCARD)return void 0;try{return d("WAWebVcardParsingUtils").parseVcard(a)}catch(a){return void 0}},[m,R]),qc=b("description"),rc=b("matchedText",{"default":""}),sc=b("thumbnail"),tc=b("thumbnailHQ"),uc=b("musicArtwork"),vc=b("richPreviewType",{"default":d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$PreviewType.NONE}),wc=b("paymentLinkMetadata",{"default":null}),xc=b("faviconMMSMetadata",{"default":null}),yc=e(function(a){var b;a=a[0];a=a==null||(b=a.provider)==null?void 0:b.paramsJson;if(a==null)return null;try{var c,d,e=null;a=JSON.parse(a);if((a==null||(c=a.meta_tags)==null?void 0:c.is_business_verified)!=null){var f;e=babelHelpers["extends"]({},e,{isBusinessVerified:a==null||(f=a.meta_tags)==null?void 0:f.is_business_verified})}a=a==null||(d=a.meta_tags)==null||(d=d.provider_name)==null?void 0:d.trim();a!=null&&a.length>0&&(e=babelHelpers["extends"]({},e,{providerName:a}));return e}catch(a){return null}},[wc]),zc=e(function(a){a=a[0];return(a==null?void 0:a.isBusinessVerified)===!0&&(a==null?void 0:a.providerName)!=null},[yc]),Ac=e(function(a){var b=a[0],e=a[1],f=a[2];a=a[3];return d("WATypeUtils").isString(a)&&(!c("isStringNullOrEmpty")(e)||!c("isStringNullOrEmpty")(f))&&b!=null&&b.includes(a)},[R,eb,qc,rc]),Bc=e(function(a){var b=a[0];a=a[1];return b||a},[S,Nb]),Cc=e(function(a){var b=a[0];a=a[1];return a||b===d("WAWebMsgType").MSG_TYPE.LIST||b===d("WAWebMsgType").MSG_TYPE.INTERACTIVE},[m,S]),Dc=768,Ec=e(function(a){var b=a[0];a=a[1];var c=308;return a!=null&&a.isBot()?Infinity:b?c:Dc},[cc,P]),Fc=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION&&a==="encrypt"||d("WAWebBizSystemMsgSubtypes").BIZ_SYSTEM_MSG_SUBTYPES_V2_INIT.includes(a)},[m,n]),Gc=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE&&a==="disappearing_mode"},[m,n]),Hc=b("kicKey"),Ic=e(function(a){var b=a[0];a=a[1];if(b!=null)if(b.fromMe)return d("WAWebUserPrefsMeUser").getMaybeMePnUser();else if(a&&b.participant!=null)return d("WAWebWidFactory").asUserWidOrThrow(b.participant);else if(!a)return d("WAWebWidFactory").asUserWidOrThrow(b.remote)},[Hc,K]),Jc=e(function(a){var b=a[0],c=a[1];a=a[2];if(a==="ephemeral_setting")return null;return b==null||b===0?null:c+b},[z,A,n]),U=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&(a==="sender_revoke"||a==="admin_revoke")},[m,n]),Kc=b("revokeDuration"),Lc=e(function(a){var b=a[0],c=a[1];a=a[2];return c?b==="admin_revoke"?d("WAWebWamEnumEditType").EDIT_TYPE.ADMIN_REVOKE:d("WAWebWamEnumEditType").EDIT_TYPE.SENDER_REVOKE:a?d("WAWebWamEnumEditType").EDIT_TYPE.EDITED:d("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED},[n,U,Rb]),Mc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeTrigger(a)},[xa]),Nc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiatedByMe(a)},[ya]),Oc=e(function(a){a=a[0];if(a==null)return;return d("WAWebEphemeralityWAMUtils").getWamDisappearingModeInitiator(a)},[wa]),Pc=b("inviteCode",{"default":""}),Qc=b("inviteCodeExp",{"default":""}),Rc=b("inviteGrp",{"default":""}),Sc=b("inviteGrpName"),Tc=b("inviteGrpJpegThum"),Uc=b("inviteGrpType"),Vc=e(function(a){var b=a[0],c=a[1];a=a[2];if(b!==d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!c)return!0;b=new Date().getTime()/1e3;return parseInt(b,10)>=parseInt(a,10)},[m,Pc,Qc]),Wc=e(function(a){var b=a[0];a=a[1];if(b!==d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE)return!1;if(a==null)return!0;b=a.inviteExpiration;a=d("WATimeUtils").unixTime();return a>=b},[m,Fa]),Xc=b("productHeaderImageRejected",{"default":!1}),Yc=e(function(a){var b,c=a[0];a=a[1];return c===!0?null:(c=a==null||(b=a.productListInfo)==null||(b=b.headerImage)==null?void 0:b.jpegThumbnail)!=null?c:null},[Xc,x]),Zc=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PTT||b===d("WAWebMsgType").MSG_TYPE.PTV||a&&b===d("WAWebMsgType").MSG_TYPE.AUDIO},[m,M]),$c=b("hasReaction",{"default":!1}),ad=b("recipients",{getDefault:function(){return[]}}),bd=b("templateParams",{getDefault:function(){return[]}}),cd=b("clientUrl",{"default":""}),dd=b("loc",{"default":""}),ed=b("lat"),fd=b("lng"),gd=b("shareDuration"),hd=b("finalLat"),id=b("finalLng"),jd=b("star",{"default":!1}),kd=b("currencyCode"),ld=b("priceAmount1000"),md=b("salePriceAmount1000"),nd=b("isVcardOverMmsDocument",{"default":!1}),V=b("interactiveAnnotations"),W=e(function(a){a=a[0];return a==null?null:a.filter(function(a){return((a=a.embeddedContent)==null?void 0:a.embeddedMusic)!=null})},[V]),od=e(function(a){a=a[0];return a==null?!1:a.some(function(a){return((a=a.embeddedContent)==null?void 0:a.embeddedMessage)!=null})},[V]),X=e(function(a){a=a[0];return a==null?null:a[0]},[W]),pd=e(function(a){var b=a[0];a=a[1];return b&&a!=null&&a.length>0},[N,W]),qd=e(function(a){var b=a[0];a=a[1];return b&&a!=null},[L,X]),rd=e(function(a){var b=a[0];a=a[1];return b&&a},[N,od]),sd=e(function(a){a=a[0];if(a==null)return null;a=(a=a.embeddedContent)==null?void 0:a.embeddedMusic;return a==null?null:d("WAWebMusicParsingUtils").toMusicMetadata(a)},[X]),td=b("messageSecret"),ud=b("broadcast",{"default":!1}),vd=b("vcardList",{getDefault:function(){return[]}}),wd=b("vcardFormattedName"),xd=b("labels",{getDefault:function(){return[]}}),yd=b("agentId"),zd=b("url"),Ad=b("retailerId"),Bd=b("businessOwnerJid"),Cd=b("productId"),Dd=b("productImageCount"),Ed=b("isMdHistoryMsg",{"default":!1}),Fd=b("campaignId"),Gd=b("filename"),Hd=b("smbClientCampaignId"),Id=b("isCaptionByUser",{"default":!1}),Jd=b("doNotPlayInline"),Kd=b("thumbnailDirectPath"),Ld=b("thumbnailHeight"),Md=b("thumbnailWidth"),Nd=b("orderTitle"),Od=b("itemCount"),Pd=b("totalAmount1000"),Qd=b("totalCurrencyCode"),Rd=b("futureproofType"),Sd=b("futureproofSubtype"),Td=b("ephemeralOutOfSync"),Ud=b("isAvatar"),Vd=b("bizPrivacyStatus"),Wd=b("verifiedBizName"),Xd=b("mediaKey"),Yd=b("message",{"default":""}),Zd=b("size",{"default":0}),$d=b("hostedBizEncStateMismatch"),ae=e(function(a){a=a[0];return a==="bot_unavailable_fanout"},[n]),be=e(function(a){a=a[0];return a==="view_once_unavailable_fanout"},[n]),ce=e(function(a){var b=a[0];a=a[1];return b.remote.isBot()?b.fromMe:a!=null&&a.some(function(a){return a.isBot()})},[o,D]),de=e(function(a){var b=a[0];a=a[1];return!b.fromMe&&a===d("WAWebBotTypes").BizBotType.BIZ_1P},[o,H]),ee=e(function(a){var b=a[0];a=a[1];return!b.fromMe&&a===d("WAWebBotTypes").BizBotType.BIZ_3P},[o,H]),fe=b("botPluginSearchProvider"),ge=b("botPluginSearchUrl"),he=b("botResponseTargetId"),ie=b("botPluginSearchQuery"),je=b("botPluginType"),ke=b("botMessageDisclaimerText"),le=b("richResponse"),me=e(function(a){var b=a[0],c=a[1];a=a[2];return b!=null&&c!=null&&a!=null},[fe,ge,ie]),Y=e(function(a){a=a[0];return(a==null?void 0:a.isBot())===!0},[P]),ne=e(function(a){var b=a[0];a=a[1];return Boolean(b&&d("WAWebUserPrefsMeUser").isMeAccount(a))},[Y,Aa]),oe=e(function(a){var b=a[0];a=a[1];return a&&!b.remote.isBot()},[o,Y]),pe=e(function(a){var b=a[0],c=a[1];a=a[2];return b||c||a},[Y,de,ee]),qe=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&a==="bot_feedback"},[m,n]),Z=b("hsmTag"),re=e(function(a){a=a[0];return a===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.AUTHENTICATION},[Z]),se=e(function(a){a=a[0];return a===d("WAWebBusinessHSMTypes").HSM_TAG_TYPE.MARKETING},[Z]),te=b("botRespOrInvocationRevokeBotWid"),ue=e(function(a){var b=a[0];a=a[1];return Boolean((b==null?void 0:b.isBot())&&a)},[te,U]),ve=e(function(a){var b=a[0];a=a[1];return a&&(b===d("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.SEARCH||b===d("WAWebProtobufsAICommon.pb").BotPluginMetadata$PluginType.REELS)},[je,Y]),we=b("botPluginMaybeParent"),xe=b("botReelPluginThumbnailCdnUrl"),ye=e(function(a){a=a[0];return a===d("WAWebMsgType").MSG_TYPE.BIZ_CONTENT_PLACEHOLDER},[m]),ze=b("statusMentioned"),Ae=b("isWamoSub"),$=b("isVideoCall");$=e(function(a){var b=a[0],c=a[1];a=a[2];return b===d("WAWebMsgType").MSG_TYPE.CALL_LOG&&(c==="miss_video"||c==="miss_group_video"||a===!0)},[m,n,$]);var Be=e(function(a){var b=a[0];a=a[1];return b===d("WAWebMsgType").MSG_TYPE.CALL_LOG?a.id:null},[m,o]),Ce=b("callOutcome"),De=b("callSilenceReason"),Ee=e(function(a){var b=a[0],c=a[1];a=a[2];return b===d("WAWebMsgType").MSG_TYPE.CALL_LOG&&(c==="silence"||a!=null)},[m,n,De]),Fe=e(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return b===d("WAWebMsgType").MSG_TYPE.CALL_LOG&&!d("WAWebUserPrefsMeUser").isMeAccount(a)&&(c==="miss_video"||c==="miss_group_video"||c==="miss"||c==="miss_group"||e==null||![d("WAWebCallLogMsgData.flow").CallOutcome.Completed,d("WAWebCallLogMsgData.flow").CallOutcome.Ongoing,d("WAWebCallLogMsgData.flow").CallOutcome.AcceptedElsewhere].includes(e))},[m,n,Ce,P]),Ge=b("callDuration"),He=b("callParticipants"),Ie=b("isCallLink"),Je=b("callLinkToken"),Ke=e(function(a){var b=a[0],e=a[1];a=a[2];return!b&&(!c("isStringNullOrEmpty")(a)||e!=null&&e.filter(function(a){return!d("WAWebUserPrefsMeUser").isMeAccount(a.participant)}).length>1)},[K,He,Je]);e=e(function(a){var b=a[0];a=a[1];return b||a},[K,Ke]);var Le=b("finalCallOutcome"),Me=b("groupHistoryBundleMessageKey");b=b("groupHistoryBundleMetadata");g.clearMsgGetterCacheFor=a;g.getMsgUnsafe=f;g.getType=m;g.getSubtype=n;g.getId=o;g.getServerId=aa;g.getTo=p;g.getFrom=q;g.getBroadcastId=r;g.getRemote=ba;g.getViewMode=s;g.getAuthor=t;g.getAck=u;g.getViewCount=ca;g.getViewed=da;g.getOriginalSelfAuthor=v;g.getKicState=w;g.getKicTimestampMs=ea;g.getList=x;g.getLatestEditMsgKey=y;g.getErrorCode=fa;g.getEphemeralDuration=z;g.getEphemeralSettingUser=ga;g.getT=A;g.getClientReceivedTsMillis=ha;g.getBackgroundColor=B;g.getHeaderType=ia;g.getInteractiveHeader=C;g.getInteractiveType=ja;g.getFooter=ka;g.getMentionedJidList=D;g.getGroupMentions=la;g.getQuotedMsg=E;g.getQuotedRemoteJid=ma;g.getQuotedParticipant=F;g.getQuotedType=na;g.getRcat=G;g.getIsViewOnce=oa;g.getIsGif=pa;g.getGifAttribution=qa;g.getCtwaContext=ra;g.getMimetype=sa;g.getFilehash=ta;g.getDeprecatedMms3Url=ua;g.getWaveform=va;g.getDisappearingModeInitiator=wa;g.getDisappearingModeTrigger=xa;g.getDisappearingModeInitiatedByMe=ya;g.getActiveBotMsgStreamingInProgress=za;g.getBizBotType=H;g.getBotTargetSenderJid=Aa;g.getIsSupportAIMessage=Ba;g.getLastBotEditBodyLength=Ca;g.getBotEditType=Da;g.getForwardedNewsletterMessageInfo=Ea;g.getNewsletterAdminInviteInfo=Fa;g.getNewsletterFollowerInviteInfo=Ga;g.getIsGroupStatus=I;g.getBizSource=Ha;g.isBizSourceFromMarketingMessage=Ia;g.getIsMarketingMessage=Ja;g.getIsReply=Ka;g.getIsOpus=La;g.getRcatString=Ma;g.getHasMentionOfMe=Na;g.getLocal=Oa;g.getIsImportantMessage=J;g.getBotPluginReferenceIndex=Pa;g.getIsUnreadType=Qa;g.getIsGroupMsg=K;g.getIsNewsletterMsg=L;g.getHasOriginatedFromNewsletter=M;g.getIsStatus=N;g.getIsNotification=Ra;g.getIsSentByMe=O;g.getSender=P;g.getOriginalSender=Sa;g.getIsReaction=Ta;g.getIsPollVote=Ua;g.getIsFutureproof=Va;g.getIsStickerMsg=Wa;g.getIsCarouselCard=Xa;g.getHasThumbList=Q;g.getIsKept=Ya;g.getIsUnkept=Za;g.getIsPSA=$a;g.getIsIAS=ab;g.getIsAiHub=bb;g.getIsCAPISupport=cb;g.getIsProductListMessage=db;g.getTitle=eb;g.getBody=R;g.getCaption=fb;g.getComment=gb;g.getPollName=hb;g.getPollOptions=ib;g.getPollSelectableOptionsCount=jb;g.getPollInvalidated=kb;g.getPollContentType=lb;g.getPollType=mb;g.getPollCorrectOptionIndex=nb;g.getPollVotesSnapshot=ob;g.getQuarantineExtractedText=pb;g.getEventName=qb;g.getEventDescription=rb;g.getEventStartTime=sb;g.getEventEndTime=tb;g.getEventJoinLink=ub;g.getEventLocation=vb;g.getIsEventCanceled=wb;g.getEventInvalidated=xb;g.getEventIsScheduledCall=yb;g.getEventExtraGuestsAllowed=zb;g.getReplyCount=Ab;g.getNativeFlowName=Bb;g.getNativeFlowButtons=Cb;g.getGalaxyFlowDisabled=Db;g.getPaymentCurrency=Eb;g.getPaymentAmount1000=Fb;g.getPaymentMessageReceiverJid=Gb;g.getPaymentStatus=Hb;g.getPaymentTxnStatus=Ib;g.getPaymentNoteMsg=Jb;g.getPaymentRequestMessageKey=Kb;g.getPaymentExpiryTimestamp=Lb;g.getPaymentInviteServiceType=Mb;g.getIsFromTemplate=Nb;g.getIsLive=Ob;g.getIsDynamicReplyButtonsMsg=S;g.getDynamicReplyButtons=Pb;g.getIsEphemeral=Qb;g.getIsEdited=Rb;g.getIsEditProtocolMsg=Sb;g.getStatusCanvasColor=Tb;g.getIsUserCreatedType=Ub;g.getIsSentByMeFromWeb=Vb;g.getRevokeSender=Wb;g.getIsRevokedByMe=Xb;g.getIsInternational=Yb;g.getIsBizNotification=Zb;g.getIsMedia=$b;g.getIsForwarded=T;g.getForwardingScore=ac;g.getNumTimesForwarded=bc;g.getIsFrequentlyForwarded=cc;g.getIsQuestion=dc;g.getQuestionResponsesCount=ec;g.getReadQuestionResponsesCount=fc;g.getUnreadQuestionResponsesCount=gc;g.getQuestionReplyQuotedMessage=hc;g.getIsQuestionReply=ic;g.getIsBotInvoke=jc;g.getShouldDisplayAsForwarded=kc;g.getInvis=lc;g.getIsNewMsg=mc;g.getIsSendFailure=nc;g.getIsFailed=oc;g.getVcard=pc;g.getDescription=qc;g.getMatchedText=rc;g.getThumbnail=sc;g.getThumbnailHQ=tc;g.getMusicArtwork=uc;g.getRichPreviewType=vc;g.getPaymentLinkMetadata=wc;g.getFaviconMMSMetadata=xc;g.getPaymentLinkPreviewMetaTags=yc;g.getHasPaymentLinkTrustSignals=zc;g.getLinkPreview=Ac;g.getSupportsMessageFooter=Bc;g.getSupportsMessageFooterLinks=Cc;g.INITIAL_PAGE_SIZE=Dc;g.getInitialPageSize=Ec;g.getIsInitialE2ENotification=Fc;g.getIsDisappearingModeSystemMessage=Gc;g.getKicKey=Hc;g.getKicSender=Ic;g.getEphemeralExpirationTimestamp=Jc;g.getIsRevoke=U;g.getRevokeDuration=Kc;g.getWamEditType=Lc;g.getWamDisappearingModeTrigger=Mc;g.getWamDisappearingModeInitiatedByMe=Nc;g.getWamDisappearingModeInitiator=Oc;g.getInviteCode=Pc;g.getInviteCodeExp=Qc;g.getInviteGrp=Rc;g.getInviteGrpName=Sc;g.getInviteGrpJpegThum=Tc;g.getInviteGrpType=Uc;g.getIsGroupsV4InviteExpired=Vc;g.getIsNewsletterAdminInviteExpired=Wc;g.getProductHeaderImageRejected=Xc;g.getProductListHeaderImage=Yc;g.getIsAckPlayable=Zc;g.getHasReaction=$c;g.getRecipients=ad;g.getTemplateParams=bd;g.getClientUrl=cd;g.getLoc=dd;g.getLat=ed;g.getLng=fd;g.getShareDuration=gd;g.getFinalLat=hd;g.getFinalLng=id;g.getStar=jd;g.getCurrencyCode=kd;g.getPriceAmount1000=ld;g.getSalePriceAmount1000=md;g.getIsVcardOverMmsDocument=nd;g.getInteractiveAnnotations=V;g.getMusicAnnotations=W;g.getHasEmbeddedMessagesAnnotation=od;g.getFirstMusicAnnotation=X;g.isStatusWithMusic=pd;g.isNewsletterMsgWithMusic=qd;g.isStatusWithEmbeddedMessages=rd;g.getFirstMusicAnnotationEmbeddedContent=sd;g.getMessageSecret=td;g.getBroadcast=ud;g.getVcardList=vd;g.getVcardFormattedName=wd;g.getLabels=xd;g.getAgendId=yd;g.getUrl=zd;g.getRetailerId=Ad;g.getBusinessOwnerJid=Bd;g.getProductId=Cd;g.getProductImageCount=Dd;g.getIsMdHistoryMsg=Ed;g.getCampaignId=Fd;g.getFilename=Gd;g.getSmbClientCampaignId=Hd;g.getIsCaptionByUser=Id;g.getDoNotPlayInline=Jd;g.getThumbnailDirectPath=Kd;g.getThumbnailHeight=Ld;g.getThumbnailWidth=Md;g.getOrderTitle=Nd;g.getItemCount=Od;g.getTotalAmount1000=Pd;g.getTotalCurrencyCode=Qd;g.getFutureproofType=Rd;g.getFutureproofSubtype=Sd;g.getEphemeralOutOfSync=Td;g.getIsAvatar=Ud;g.getBizPrivacyStatus=Vd;g.getVerifiedBizName=Wd;g.getMediaKey=Xd;g.getMessage=Yd;g.getSize=Zd;g.getHostedBizEncStateMismatch=$d;g.getIsBotFutureproofPlaceholder=ae;g.getIsViewOncePlaceholder=be;g.getIsBotQuery=ce;g.getIsBizBot1pResponse=de;g.getIsBizBot3pResponse=ee;g.getBotPluginSearchProvider=fe;g.getBotPluginSearchUrl=ge;g.getBotResponseTargetId=he;g.getBotPluginSearchQuery=ie;g.getBotPluginType=je;g.getBotMessageDisclaimerText=ke;g.getRichResponse=le;g.getIsBotSearchResponse=me;g.getIsMetaBotResponse=Y;g.isMetaBotResponseToMyInvoke=ne;g.getIsMetaBotInvokeResponse=oe;g.getIsBotResponse=pe;g.getIsBotFeedbackMessage=qe;g.getHsmTag=Z;g.getIsAuthenticationMessage=re;g.getIsMarketingTemplateTag=se;g.getBotRespOrInvocationRevokeBotWid=te;g.getIsRevokeForMsgFromOrDeliveredToBot=ue;g.getIsBotPluginCarouselMsg=ve;g.getBotPluginMaybeParent=we;g.getBotReelPluginThumbnailCdnUrl=xe;g.getIsBizContentPlaceholder=ye;g.getStatusMentioned=ze;g.getIsWamoSub=Ae;g.getIsVideoCall=$;g.getCallId=Be;g.getCallOutcome=Ce;g.getCallSilenceReason=De;g.getIsCallSilenced=Ee;g.getIsMissedCall=Fe;g.getCallDuration=Ge;g.getCallParticipants=He;g.getIsCallLink=Ie;g.getCallLinkToken=Je;g.getIsAdHocGroupCall=Ke;g.getIsGroupCall=e;g.getFinalCallOutcome=Le;g.getGroupHistoryBundleMessageKey=Me;g.getGroupHistoryBundleMetadata=b}),98);
__d("WAWebL10NNumbersPluginRegistry",[],(function(a,b,c,d,e,f){var g=Math.pow(10,3),h=Math.pow(10,6);function i(a,b,c,d){d===void 0&&(d=1);var e=".";a=a/Math.pow(10,b);b=a.toString(10).split(".");a=b[0];b=b[1];return b==null||b.startsWith("0".repeat(d))||Number.parseInt(a,10)>=100?parseInt(a,10).toLocaleString(c):parseFloat(""+a+e+b.slice(0,d)).toLocaleString(c)}function j(a,b){return Intl.NumberFormat(b,{notation:"compact"}).format(a)}b={locales:["fr","fr-BE","fr-CA","fr-CH","fr-FR"],format:function(a,b){a=j(a,b);return a.toLocaleUpperCase(b)}};c={locales:["he","he-IL"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?i(a,3,b)+" \u05d0\u05dc\u05e3":i(a,6,b)+" \u05de\u05d9\u05dc\u05d9\u05d5\u05df"}};d={locales:["ro","ro-RO"],format:function(a,b){if(a<g)return a.toLocaleString(b);if(a===g)return"1 mie";return a<h?i(a,3,b)+" mii":i(a,6,b)+" mil."}};e={locales:["zh-SG","zh-CN"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,b)}};var k={locales:["ja"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,b)}},l={locales:["de","de-AT","de-CH","de-DE","de-LI","de-LU"],format:function(a,b){return a>g&&a<h?i(a,3,b)+" Tsd.":j(a,b)}},m={locales:["it","it-CH","it-IT"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?i(a,3,b)+" mila":i(a,6,b)+" mln"}},n={locales:["pt","pt-BR","pt-PT"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<h?j(a,b):i(a,6,b)+" M"}},o={locales:["zh-TW","zh-MO","zh-HK"],format:function(a,b){if(a<g)return a.toLocaleString(b);return a<Math.pow(10,4)?i(a,3,b)+"\u5343":j(a,"zh-TW")}},p=[l,b,m,c,k,n,d,o,e];l=a();function a(){var a=new Map(),b=function(b){b.locales.forEach(function(c){return a.set(c,b)})};for(var c of p)b(c);return a}f.M=h;f.l10nNumberFormattersRegister=l}),66);
__d("WAWebLocaleToTranslation",[],(function(a,b,c,d,e,f){a={pt:"pt_br",pt_ao:"pt_pt",pt_ch:"pt_pt",pt_cv:"pt_pt",pt_fr:"pt_pt",pt_gq:"pt_pt",pt_gw:"pt_pt",pt_lu:"pt_pt",pt_mo:"pt_pt",pt_mz:"pt_pt",pt_pt:"pt_pt",pt_st:"pt_pt",pt_tl:"pt_pt"};b=babelHelpers["extends"]({},a,{zh_hans:"zh_cn",zh_hant:"zh_tw",zh_sg:"zh_cn",tl:"fil","in":"id",iw:"he",mo:"ro",jw:"jv",ji:"yi"});c=b;f["default"]=c}),66);
__d("WAWebSupportedLocales",[],(function(a,b,c,d,e,f){a=Object.freeze({af:"af",ar:"ar",ar_xb:"ar-XB",az:"az",bg:"bg",bn:"bn",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fil:"fil",fr:"fr",gu:"gu",he:"he",hi:"hi",hr:"hr",hu:"hu",id:"id",it:"it",ja:"ja",kk:"kk",kn:"kn",ko:"ko",lt:"lt",lv:"lv",mk:"mk",ml:"ml",mr:"mr",ms:"ms",nb:"nb",nl:"nl",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt-BR",pt_pt:"pt-PT",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tr:"tr",uk:"uk",ur:"ur",uz:"uz",vi:"vi",zh_cn:"zh-CN",zh_hk:"zh-HK",zh_tw:"zh-TW"});b=a;f["default"]=b}),66);
__d("WAWebBaseL10N",["Locale","WAWeb-moment","WAWebEventEmitter","WAWebL10NHelpers","WAWebL10NNumbersPluginRegistry","WAWebLocaleToTranslation","WAWebSupportedLocales","err","filesize","latenize"],(function(a,b,c,d,e,f,g){var h=new Set(["fa"]),i="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".split(""),j=1024*1024*1024,k=Math.pow(10,6),l=Math.pow(10,3),m=Math.pow(10,4);function n(a){return i[parseInt(a,10)]}var o=c("err")("Unimplemented method");a=function(a){function b(b){var c;c=a.call(this)||this;if(!b)throw o;c.$WAWebBaseL10n$p_1=b;c.customizeMoment();return c}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.getLocale=function(){throw o};e.getNormalizedLocale=function(){throw o};e.getFullLocale=function(){throw o};e.setLocale=function(a,b,c){throw o};e.normalizeLocaleToWajsLocale=function(a){a=a.replace(/-/g,"_").toLowerCase();var b=this.$WAWebBaseL10n$p_2(a);if(b)return b;b=a;while(b){b=b.split("_").slice(0,-1).join("_");a=b&&this.$WAWebBaseL10n$p_2(b);if(a)return a}return void 0};e.isLocaleSupported=function(a){return!!a&&!!this.normalizeLocaleToWajsLocale(a)};e.$WAWebBaseL10n$p_2=function(a){a=c("WAWebLocaleToTranslation")[a]||a;return c("WAWebSupportedLocales")[a]};e.isRTL=function(){return d("Locale").isRTL()};e.LR=function(a,b){return this.isRTL()?b:a};e.embedDir=function(a,b){b===void 0&&(b=this.isRTL());return b?this.embedRTL(a):this.embedLTR(a)};e.embedLTR=function(a){return"\u202a"+a+"\u202c"};e.embedRTL=function(a){return"\u202b"+a+"\u202c"};e.isolateLTR=function(a){return"\u2066"+a+"\u2069"};e.isolateRTL=function(a){return"\u2067"+a+"\u2069"};e.forceLTR=function(a){return"\u200e"+a};e.forceRTL=function(a){return"\u200f"+a};e.useArabicScriptDigits=function(a){return h.has(a!=null?a:this.getNormalizedLocale())};e.isLatinAlphabetLanguage=function(a){return c("latenize").isLatin(this.removeAccents(a))};e.d=function(a,b,c){var e=d("WAWebL10NNumbersPluginRegistry").l10nNumberFormattersRegister.get(this.getFullLocale());if(e!=null&&typeof a==="number")return e.format(a,this.getFullLocale());e=typeof a==="number"&&(a>=k||a>=l&&a<m)?1:0;return this.n(a,b,babelHelpers["extends"]({},c,{notation:"compact",roundingMode:"trunc",trailingZeroDisplay:"stripIfInteger",minimumFractionDigits:e,maximumFractionDigits:e}))};e.n=function(a,b,c){a=a;if(typeof a==="number")return Intl.NumberFormat(this.getFullLocale(),c).format(a);return this.useArabicScriptDigits(b)?a.toString().replace(/[0-9]/g,n):a};e.filesizeWithParams=function(a,b){var d=a>j?1:0,e=this.getFullLocale();return this.n(c("filesize")(a,{base:2,round:d,locale:e,symbols:b}))};e.normalizeForm=function(a){a===void 0&&(a="");return d("WAWebL10NHelpers").normalizeForm(a)};e.removeAccents=function(a){a===void 0&&(a="");return d("WAWebL10NHelpers").removeAccents(a)};e.accentFold=function(a){a===void 0&&(a="");return this.removeAccents(a).toLowerCase()};e.customizeMoment=function(){var a;(a=c("WAWeb-moment")).relativeTimeRounding(Math.floor);a.relativeTimeThreshold("s",60);a.relativeTimeThreshold("m",60);a.relativeTimeThreshold("h",24)};return b}(c("WAWebEventEmitter"));g.WAWebBaseL10n=a}),98);
__d("WAWebL10NCoerceToFBLocale",["bcp-47","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h="en_US",i=new Map([["af","af_ZA"],["ar","ar_AR"],["az","az_AZ"],["bg","bg_BG"],["bn","bn_IN"],["ca","ca_ES"],["cs","cs_CZ"],["da","da_DK"],["de","de_DE"],["el","el_GR"],["en","en_US"],["es","es_LA"],["et","et_EE"],["fa","fa_IR"],["fi","fi_FI"],["fr","fr_FR"],["gu","gu_IN"],["he","he_IL"],["hi","hi_IN"],["hr","hr_HR"],["hu","hu_HU"],["id","id_ID"],["it","it_IT"],["ja","ja_JP"],["kk","kk_KZ"],["kn","kn_IN"],["ko","ko_KR"],["lt","lt_LT"],["lv","lv_LV"],["mk","mk_MK"],["ml","ml_IN"],["mr","mr_IN"],["ms","ms_MY"],["nb","nb_NO"],["nl","nl_NL"],["pa","pa_IN"],["pl","pl_PL"],["pt","pt_BR"],["ro","ro_RO"],["ru","ru_RU"],["sk","sk_SK"],["sl","sl_SI"],["sq","sq_AL"],["sr","sr_RS"],["sv","sv_SE"],["sw","sw_KE"],["ta","ta_IN"],["te","te_IN"],["th","th_TH"],["tl","tl_PH"],["tr","tr_TR"],["uk","uk_UA"],["ur","ur_PK"],["uz","uz_UZ"],["vi","vi_VN"],["zh","zh_CN"]]),j=new Map([["pt_ao","pt_PT"],["pt_ch","pt_PT"],["pt_cv","pt_PT"],["pt_fr","pt_PT"],["pt_gq","pt_PT"],["pt_gw","pt_PT"],["pt_lu","pt_PT"],["pt_mo","pt_PT"],["pt_mz","pt_PT"],["pt_pt","pt_PT"],["pt_st","pt_PT"],["pt_tl","pt_PT"],["zh_cn","zh_CN"],["zh_hk","zh_HK"],["zh_tw","zh_TW"],["zh_hant","zh_HK"],["zh_hans","zh_CN"],["fil","tl_PH"],["in","id_ID"],["iw","he_IL"],["mo","ro_RO"],["jw","jv_ID"],["ji","yi_DE"],["en_al","en_GB"],["en_dz","en_GB"],["en_ao","en_GB"],["en_ai","en_GB"],["en_ag","en_GB"],["en_au","en_GB"],["en_at","en_GB"],["en_az","en_GB"],["en_bs","en_GB"],["en_bd","en_GB"],["en_bb","en_GB"],["en_be","en_GB"],["en_bz","en_GB"],["en_bj","en_GB"],["en_bm","en_GB"],["en_ba","en_GB"],["en_bw","en_GB"],["en_io","en_GB"],["en_vg","en_GB"],["en_bg","en_GB"],["en_kh","en_GB"],["en_cm","en_GB"],["en_ky","en_GB"],["en_cx","en_GB"],["en_cc","en_GB"],["en_ck","en_GB"],["en_hr","en_GB"],["en_cy","en_GB"],["en_cz","en_GB"],["en_dk","en_GB"],["en_dg","en_GB"],["en_dm","en_GB"],["en_ec","en_GB"],["en_eg","en_GB"],["en_er","en_GB"],["en_ee","en_GB"],["en_et","en_GB"],["en_fk","en_GB"],["en_fj","en_GB"],["en_fi","en_GB"],["en_fr","en_GB"],["en_ga","en_GB"],["en_gm","en_GB"],["en_ge","en_GB"],["en_de","en_GB"],["en_gh","en_GB"],["en_gi","en_GB"],["en_gr","en_GB"],["en_gd","en_GB"],["en_gg","en_GB"],["en_gn","en_GB"],["en_gy","en_GB"],["en_hn","en_GB"],["en_hk","en_GB"],["en_hu","en_GB"],["en_in","en_GB"],["en_ie","en_GB"],["en_im","en_GB"],["en_it","en_GB"],["en_jm","en_GB"],["en_je","en_GB"],["en_kz","en_GB"],["en_ke","en_GB"],["en_ki","en_GB"],["en_ls","en_GB"],["en_lr","en_GB"],["en_ly","en_GB"],["en_lt","en_GB"],["en_mo","en_GB"],["en_mg","en_GB"],["en_mw","en_GB"],["en_my","en_GB"],["en_mt","en_GB"],["en_mu","en_GB"],["en_fm","en_GB"],["en_md","en_GB"],["en_mn","en_GB"],["en_ms","en_GB"],["en_ma","en_GB"],["en_na","en_GB"],["en_nr","en_GB"],["en_np","en_GB"],["en_nl","en_GB"],["en_nz","en_GB"],["en_ni","en_GB"],["en_ne","en_GB"],["en_ng","en_GB"],["en_nu","en_GB"],["en_nf","en_GB"],["en_mk","en_GB"],["en_no","en_GB"],["en_pk","en_GB"],["en_pw","en_GB"],["en_pg","en_GB"],["en_ph","en_GB"],["en_pn","en_GB"],["en_pl","en_GB"],["en_pt","en_GB"],["en_qa","en_GB"],["en_ro","en_GB"],["en_ru","en_GB"],["en_rw","en_GB"],["en_ws","en_GB"],["en_sa","en_GB"],["en_rs","en_GB"],["en_sc","en_GB"],["en_sl","en_GB"],["en_sg","en_GB"],["en_sx","en_GB"],["en_sk","en_GB"],["en_sb","en_GB"],["en_za","en_GB"],["en_ss","en_GB"],["en_es","en_GB"],["en_lk","en_GB"],["en_sh","en_GB"],["en_kn","en_GB"],["en_lc","en_GB"],["en_vc","en_GB"],["en_sd","en_GB"],["en_sr","en_GB"],["en_sz","en_GB"],["en_se","en_GB"],["en_ch","en_GB"],["en_tw","en_GB"],["en_tz","en_GB"],["en_tg","en_GB"],["en_tk","en_GB"],["en_to","en_GB"],["en_tt","en_GB"],["en_tn","en_GB"],["en_tr","en_GB"],["en_tc","en_GB"],["en_tv","en_GB"],["en_ug","en_GB"],["en_ua","en_GB"],["en_gb","en_GB"],["en_uz","en_GB"],["en_vu","en_GB"],["en_zm","en_GB"],["en_zw","en_GB"]]),k=new Map([["fb_aa","fb_AA"],["fb_ac","fb_AC"],["fb_ar","fb_AR"],["fb_ha","fb_HA"],["fb_hx","fb_HX"],["fb_ll","fb_LL"],["fb_ls","fb_LS"],["fb_lt","fb_LT"],["fb_rl","fb_RL"],["fb_zh","fb_ZH"],["fbt_ac","fbt_AC"]]);function a(a){if(c("gkx")("26259")){if(a.startsWith("en")&&c("gkx")("18726"))return"en_PI";var b=a.toLocaleLowerCase("en").replaceAll("-","_");if(k.has(b)){return(b=k.get(b))!=null?b:h}}b=a.toLocaleLowerCase("en").replaceAll("_","-");try{a=c("bcp-47").parse(b);b=[];a.region!=null&&b.push(a.language+"_"+a.region);a.script!=null&&b.push(a.language+"_"+a.script);for(b of b){var d=j.get(b);if(d)return d}return(d=i.get(a.language))!=null?d:h}catch(a){return h}}function b(a){return c("gkx")("26259")?k.has(a.toLocaleLowerCase("en")):!1}g.DEFAULT_WA_WEB_LOCALE=h;g.LANGUAGE_TO_FB_LOCALE=i;g.EXCEPTION_LANG_REGION_TO_FB_LOCALE=j;g.DEBUG_LOCALES=k;g.coerceWAWebL10nLocaleToFBLocale=a;g.isWAWebl10nDebugLocale=b}),98);
__d("WAWebL10NConstants",[],(function(a,b,c,d,e,f){a={DEBUG:99,SAVED:6,PHONE:5,PREVIOUS:4,URL:3,BROWSER:2,DEFAULT:1};b="en";c="en-US";d=new Set(["ur"]);e=new Set(["af","az","ca","cs","da","de","el","et","fi","fr","he","hr","hu","id","it","kk","lt","mk","nb","pl","pt","pt-BR","ro","ru","sk","sl","sr","sv","th","tr","uk"]);var g={"zh-tw":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY\u5e74MMMD\u65e5",LL:"YYYY\u5e74MMMD\u65e5",LLL:"YYYY\u5e74MMMD\u65e5LT",LLLL:"YYYY\u5e74MMMD\u65e5ddddLT",l:"YYYY\u5e74MMMD\u65e5",ll:"YYYY\u5e74MMMD\u65e5",lll:"YYYY\u5e74MMMD\u65e5LT",llll:"YYYY\u5e74MMMD\u65e5ddddLT"}},"zh-cn":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY-MM-DD",LL:"YYYY\u5e74MMMD\u65e5",LLL:"YYYY\u5e74MMMD\u65e5LT",LLLL:"YYYY\u5e74MMMD\u65e5ddddLT",l:"YYYY\u5e74MMMD\u65e5",ll:"YYYY\u5e74MMMD\u65e5",lll:"YYYY\u5e74MMMD\u65e5LT",llll:"YYYY\u5e74MMMD\u65e5ddddLT"}},ar:{longDateFormat:{LT:"h:mm A",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"}},ta:{longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY, h:mm A"},preparse:null,postformat:null,meridiem:null,meridiemHour:null},nl:{longDateFormat:{l:"DD-MM-YYYY",L:"DD-MM-YYYY"}},"en-ie":{longDateFormat:{l:"DD/MM/YYYY",L:"DD/MM/YYYY"}},hi:{preparse:function(a){return a},postformat:function(a){return a},longDateFormat:{LT:"A h:mm \u092c\u091c\u0947",LTS:"A h:mm:ss \u092c\u091c\u0947",LLL:"D MMMM YYYY A h:mm \u092c\u091c\u0947",LLLL:"dddd, D MMMM YYYY, A h:mm \u092c\u091c\u0947"},meridiem:function(a,b,c){if(a===0&&b===0)return"\u092e\u0927\u094d\u092f\u0930\u093e\u0924\u094d\u0930\u093f";if(a>=20||a<4)return"\u0930\u093e\u0924";if(a>=4&&a<12)return"\u0938\u0941\u092c\u0939";return a>=12&&a<16?"\u0926\u094b\u092a\u0939\u0930":"\u0936\u093e\u092e"}}},h={"pt-pt":{weekdays:["Domingo","Segunda-feira","Ter\xe7a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S\xe1bado"]}};h=babelHelpers["extends"]({},g,h);f.L10N_PRIORITY=a;f.DEFAULT_LOCALE=b;f.DEFAULT_MOMENT_LOCALE=c;f.SHOULD_USE_MOMENT_LOCALE_FORMAT=d;f.LOCALES_THAT_PREFER_24HOUR_TIME=e;f.LOCALE_DATE_TIME_CUSTOMIZATIONS=g;f.LOCALE_CUSTOMIZATIONS=h}),66);
__d("WAWebL10nGetRenderedLocale",["IntlCurrentLocale"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("IntlCurrentLocale").code}g.WAWebL10nGetRenderedLocale=a}),98);
__d("WAWebLocaleToMomentResource",[],(function(a,b,c,d,e,f){a={"zh-HK":"zh-TW",pa:"pa-IN"};b=a;f["default"]=b}),66);
__d("WAWebMomentLocales",["JSResource","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){switch(a.toLocaleLowerCase("en")){case"en-au":yield c("JSResource")("WAWebMoment-en-au").__setRef("WAWebMomentLocales").load();return!0;case"en-ca":yield c("JSResource")("WAWebMoment-en-ca").__setRef("WAWebMomentLocales").load();return!0;case"en-gb":yield c("JSResource")("WAWebMoment-en-gb").__setRef("WAWebMomentLocales").load();return!0;case"en-ie":yield c("JSResource")("WAWebMoment-en-ie").__setRef("WAWebMomentLocales").load();return!0;case"en-in":yield c("JSResource")("WAWebMoment-en-in").__setRef("WAWebMomentLocales").load();return!0;case"en-nz":yield c("JSResource")("WAWebMoment-en-nz").__setRef("WAWebMomentLocales").load();return!0;case"en-sg":yield c("JSResource")("WAWebMoment-en-sg").__setRef("WAWebMomentLocales").load();return!0;case"af":yield c("JSResource")("WAWebMoment-af").__setRef("WAWebMomentLocales").load();return!0;case"ar-dz":yield c("JSResource")("WAWebMoment-ar-dz").__setRef("WAWebMomentLocales").load();return!0;case"ar":yield c("JSResource")("WAWebMoment-ar").__setRef("WAWebMomentLocales").load();return!0;case"ar-kw":yield c("JSResource")("WAWebMoment-ar-kw").__setRef("WAWebMomentLocales").load();return!0;case"ar-ly":yield c("JSResource")("WAWebMoment-ar-ly").__setRef("WAWebMomentLocales").load();return!0;case"ar-ma":yield c("JSResource")("WAWebMoment-ar-ma").__setRef("WAWebMomentLocales").load();return!0;case"ar-sa":yield c("JSResource")("WAWebMoment-ar-sa").__setRef("WAWebMomentLocales").load();return!0;case"ar-tn":yield c("JSResource")("WAWebMoment-ar-tn").__setRef("WAWebMomentLocales").load();return!0;case"az":yield c("JSResource")("WAWebMoment-az").__setRef("WAWebMomentLocales").load();return!0;case"be":yield c("JSResource")("WAWebMoment-be").__setRef("WAWebMomentLocales").load();return!0;case"bg":yield c("JSResource")("WAWebMoment-bg").__setRef("WAWebMomentLocales").load();return!0;case"bm":yield c("JSResource")("WAWebMoment-bm").__setRef("WAWebMomentLocales").load();return!0;case"bn-bd":yield c("JSResource")("WAWebMoment-bn-bd").__setRef("WAWebMomentLocales").load();return!0;case"bn":yield c("JSResource")("WAWebMoment-bn").__setRef("WAWebMomentLocales").load();return!0;case"bo":yield c("JSResource")("WAWebMoment-bo").__setRef("WAWebMomentLocales").load();return!0;case"br":yield c("JSResource")("WAWebMoment-br").__setRef("WAWebMomentLocales").load();return!0;case"bs":yield c("JSResource")("WAWebMoment-bs").__setRef("WAWebMomentLocales").load();return!0;case"ca":yield c("JSResource")("WAWebMoment-ca").__setRef("WAWebMomentLocales").load();return!0;case"cs":yield c("JSResource")("WAWebMoment-cs").__setRef("WAWebMomentLocales").load();return!0;case"cv":yield c("JSResource")("WAWebMoment-cv").__setRef("WAWebMomentLocales").load();return!0;case"cy":yield c("JSResource")("WAWebMoment-cy").__setRef("WAWebMomentLocales").load();return!0;case"da":yield c("JSResource")("WAWebMoment-da").__setRef("WAWebMomentLocales").load();return!0;case"de-at":yield c("JSResource")("WAWebMoment-de-at").__setRef("WAWebMomentLocales").load();return!0;case"de-ch":yield c("JSResource")("WAWebMoment-de-ch").__setRef("WAWebMomentLocales").load();return!0;case"de":yield c("JSResource")("WAWebMoment-de").__setRef("WAWebMomentLocales").load();return!0;case"dv":yield c("JSResource")("WAWebMoment-dv").__setRef("WAWebMomentLocales").load();return!0;case"el":yield c("JSResource")("WAWebMoment-el").__setRef("WAWebMomentLocales").load();return!0;case"eo":yield c("JSResource")("WAWebMoment-eo").__setRef("WAWebMomentLocales").load();return!0;case"es-do":yield c("JSResource")("WAWebMoment-es-do").__setRef("WAWebMomentLocales").load();return!0;case"es":yield c("JSResource")("WAWebMoment-es").__setRef("WAWebMomentLocales").load();return!0;case"es-mx":yield c("JSResource")("WAWebMoment-es-mx").__setRef("WAWebMomentLocales").load();return!0;case"es-us":yield c("JSResource")("WAWebMoment-es-us").__setRef("WAWebMomentLocales").load();return!0;case"et":yield c("JSResource")("WAWebMoment-et").__setRef("WAWebMomentLocales").load();return!0;case"eu":yield c("JSResource")("WAWebMoment-eu").__setRef("WAWebMomentLocales").load();return!0;case"fa":yield c("JSResource")("WAWebMoment-fa").__setRef("WAWebMomentLocales").load();return!0;case"fi":yield c("JSResource")("WAWebMoment-fi").__setRef("WAWebMomentLocales").load();return!0;case"fil":yield c("JSResource")("WAWebMoment-fil").__setRef("WAWebMomentLocales").load();return!0;case"fo":yield c("JSResource")("WAWebMoment-fo").__setRef("WAWebMomentLocales").load();return!0;case"fr-ca":yield c("JSResource")("WAWebMoment-fr-ca").__setRef("WAWebMomentLocales").load();return!0;case"fr-ch":yield c("JSResource")("WAWebMoment-fr-ch").__setRef("WAWebMomentLocales").load();return!0;case"fr":yield c("JSResource")("WAWebMoment-fr").__setRef("WAWebMomentLocales").load();return!0;case"fy":yield c("JSResource")("WAWebMoment-fy").__setRef("WAWebMomentLocales").load();return!0;case"ga":yield c("JSResource")("WAWebMoment-ga").__setRef("WAWebMomentLocales").load();return!0;case"gd":yield c("JSResource")("WAWebMoment-gd").__setRef("WAWebMomentLocales").load();return!0;case"gl":yield c("JSResource")("WAWebMoment-gl").__setRef("WAWebMomentLocales").load();return!0;case"gom-deva":yield c("JSResource")("WAWebMoment-gom-deva").__setRef("WAWebMomentLocales").load();return!0;case"gom-latn":yield c("JSResource")("WAWebMoment-gom-latn").__setRef("WAWebMomentLocales").load();return!0;case"gu":yield c("JSResource")("WAWebMoment-gu").__setRef("WAWebMomentLocales").load();return!0;case"he":yield c("JSResource")("WAWebMoment-he").__setRef("WAWebMomentLocales").load();return!0;case"hi":yield c("JSResource")("WAWebMoment-hi").__setRef("WAWebMomentLocales").load();return!0;case"hr":yield c("JSResource")("WAWebMoment-hr").__setRef("WAWebMomentLocales").load();return!0;case"hu":yield c("JSResource")("WAWebMoment-hu").__setRef("WAWebMomentLocales").load();return!0;case"hy-am":yield c("JSResource")("WAWebMoment-hy-am").__setRef("WAWebMomentLocales").load();return!0;case"id":yield c("JSResource")("WAWebMoment-id").__setRef("WAWebMomentLocales").load();return!0;case"is":yield c("JSResource")("WAWebMoment-is").__setRef("WAWebMomentLocales").load();return!0;case"it-ch":yield c("JSResource")("WAWebMoment-it-ch").__setRef("WAWebMomentLocales").load();return!0;case"it":yield c("JSResource")("WAWebMoment-it").__setRef("WAWebMomentLocales").load();return!0;case"ja":yield c("JSResource")("WAWebMoment-ja").__setRef("WAWebMomentLocales").load();return!0;case"jv":yield c("JSResource")("WAWebMoment-jv").__setRef("WAWebMomentLocales").load();return!0;case"ka":yield c("JSResource")("WAWebMoment-ka").__setRef("WAWebMomentLocales").load();return!0;case"kk":yield c("JSResource")("WAWebMoment-kk").__setRef("WAWebMomentLocales").load();return!0;case"km":yield c("JSResource")("WAWebMoment-km").__setRef("WAWebMomentLocales").load();return!0;case"kn":yield c("JSResource")("WAWebMoment-kn").__setRef("WAWebMomentLocales").load();return!0;case"ko":yield c("JSResource")("WAWebMoment-ko").__setRef("WAWebMomentLocales").load();return!0;case"ku":yield c("JSResource")("WAWebMoment-ku").__setRef("WAWebMomentLocales").load();return!0;case"ky":yield c("JSResource")("WAWebMoment-ky").__setRef("WAWebMomentLocales").load();return!0;case"lb":yield c("JSResource")("WAWebMoment-lb").__setRef("WAWebMomentLocales").load();return!0;case"lo":yield c("JSResource")("WAWebMoment-lo").__setRef("WAWebMomentLocales").load();return!0;case"lt":yield c("JSResource")("WAWebMoment-lt").__setRef("WAWebMomentLocales").load();return!0;case"lv":yield c("JSResource")("WAWebMoment-lv").__setRef("WAWebMomentLocales").load();return!0;case"me":yield c("JSResource")("WAWebMoment-me").__setRef("WAWebMomentLocales").load();return!0;case"mi":yield c("JSResource")("WAWebMoment-mi").__setRef("WAWebMomentLocales").load();return!0;case"mk":yield c("JSResource")("WAWebMoment-mk").__setRef("WAWebMomentLocales").load();return!0;case"ml":yield c("JSResource")("WAWebMoment-ml").__setRef("WAWebMomentLocales").load();return!0;case"mn":yield c("JSResource")("WAWebMoment-mn").__setRef("WAWebMomentLocales").load();return!0;case"mr":yield c("JSResource")("WAWebMoment-mr").__setRef("WAWebMomentLocales").load();return!0;case"ms":yield c("JSResource")("WAWebMoment-ms").__setRef("WAWebMomentLocales").load();return!0;case"ms-my":yield c("JSResource")("WAWebMoment-ms-my").__setRef("WAWebMomentLocales").load();return!0;case"mt":yield c("JSResource")("WAWebMoment-mt").__setRef("WAWebMomentLocales").load();return!0;case"my":yield c("JSResource")("WAWebMoment-my").__setRef("WAWebMomentLocales").load();return!0;case"nb":yield c("JSResource")("WAWebMoment-nb").__setRef("WAWebMomentLocales").load();return!0;case"ne":yield c("JSResource")("WAWebMoment-ne").__setRef("WAWebMomentLocales").load();return!0;case"nl-be":yield c("JSResource")("WAWebMoment-nl-be").__setRef("WAWebMomentLocales").load();return!0;case"nl":yield c("JSResource")("WAWebMoment-nl").__setRef("WAWebMomentLocales").load();return!0;case"nn":yield c("JSResource")("WAWebMoment-nn").__setRef("WAWebMomentLocales").load();return!0;case"oc-lnc":yield c("JSResource")("WAWebMoment-oc-lnc").__setRef("WAWebMomentLocales").load();return!0;case"pa-in":yield c("JSResource")("WAWebMoment-pa-in").__setRef("WAWebMomentLocales").load();return!0;case"pl":yield c("JSResource")("WAWebMoment-pl").__setRef("WAWebMomentLocales").load();return!0;case"pt-br":yield c("JSResource")("WAWebMoment-pt-br").__setRef("WAWebMomentLocales").load();return!0;case"pt":yield c("JSResource")("WAWebMoment-pt").__setRef("WAWebMomentLocales").load();return!0;case"ro":yield c("JSResource")("WAWebMoment-ro").__setRef("WAWebMomentLocales").load();return!0;case"ru":yield c("JSResource")("WAWebMoment-ru").__setRef("WAWebMomentLocales").load();return!0;case"sd":yield c("JSResource")("WAWebMoment-sd").__setRef("WAWebMomentLocales").load();return!0;case"se":yield c("JSResource")("WAWebMoment-se").__setRef("WAWebMomentLocales").load();return!0;case"si":yield c("JSResource")("WAWebMoment-si").__setRef("WAWebMomentLocales").load();return!0;case"sk":yield c("JSResource")("WAWebMoment-sk").__setRef("WAWebMomentLocales").load();return!0;case"sl":yield c("JSResource")("WAWebMoment-sl").__setRef("WAWebMomentLocales").load();return!0;case"sq":yield c("JSResource")("WAWebMoment-sq").__setRef("WAWebMomentLocales").load();return!0;case"sr-cyrl":yield c("JSResource")("WAWebMoment-sr-cyrl").__setRef("WAWebMomentLocales").load();return!0;case"sr":yield c("JSResource")("WAWebMoment-sr").__setRef("WAWebMomentLocales").load();return!0;case"ss":yield c("JSResource")("WAWebMoment-ss").__setRef("WAWebMomentLocales").load();return!0;case"sv":yield c("JSResource")("WAWebMoment-sv").__setRef("WAWebMomentLocales").load();return!0;case"sw":yield c("JSResource")("WAWebMoment-sw").__setRef("WAWebMomentLocales").load();return!0;case"ta":yield c("JSResource")("WAWebMoment-ta").__setRef("WAWebMomentLocales").load();return!0;case"te":yield c("JSResource")("WAWebMoment-te").__setRef("WAWebMomentLocales").load();return!0;case"tet":yield c("JSResource")("WAWebMoment-tet").__setRef("WAWebMomentLocales").load();return!0;case"tg":yield c("JSResource")("WAWebMoment-tg").__setRef("WAWebMomentLocales").load();return!0;case"th":yield c("JSResource")("WAWebMoment-th").__setRef("WAWebMomentLocales").load();return!0;case"tk":yield c("JSResource")("WAWebMoment-tk").__setRef("WAWebMomentLocales").load();return!0;case"tlh":yield c("JSResource")("WAWebMoment-tlh").__setRef("WAWebMomentLocales").load();return!0;case"tl-ph":yield c("JSResource")("WAWebMoment-tl-ph").__setRef("WAWebMomentLocales").load();return!0;case"tr":yield c("JSResource")("WAWebMoment-tr").__setRef("WAWebMomentLocales").load();return!0;case"tzl":yield c("JSResource")("WAWebMoment-tzl").__setRef("WAWebMomentLocales").load();return!0;case"tzm":yield c("JSResource")("WAWebMoment-tzm").__setRef("WAWebMomentLocales").load();return!0;case"tzm-latn":yield c("JSResource")("WAWebMoment-tzm-latn").__setRef("WAWebMomentLocales").load();return!0;case"ug-cn":yield c("JSResource")("WAWebMoment-ug-cn").__setRef("WAWebMomentLocales").load();return!0;case"uk":yield c("JSResource")("WAWebMoment-uk").__setRef("WAWebMomentLocales").load();return!0;case"ur":yield c("JSResource")("WAWebMoment-ur").__setRef("WAWebMomentLocales").load();return!0;case"uz":yield c("JSResource")("WAWebMoment-uz").__setRef("WAWebMomentLocales").load();return!0;case"uz-latn":yield c("JSResource")("WAWebMoment-uz-latn").__setRef("WAWebMomentLocales").load();return!0;case"vi":yield c("JSResource")("WAWebMoment-vi").__setRef("WAWebMomentLocales").load();return!0;case"x-pseudo":yield c("JSResource")("WAWebMoment-x-pseudo").__setRef("WAWebMomentLocales").load();return!0;case"yo":yield c("JSResource")("WAWebMoment-yo").__setRef("WAWebMomentLocales").load();return!0;case"zh-cn":yield c("JSResource")("WAWebMoment-zh-cn").__setRef("WAWebMomentLocales").load();return!0;case"zh-hk":yield c("JSResource")("WAWebMoment-zh-hk").__setRef("WAWebMomentLocales").load();return!0;case"zh-mo":yield c("JSResource")("WAWebMoment-zh-mo").__setRef("WAWebMomentLocales").load();return!0;case"zh-tw":yield c("JSResource")("WAWebMoment-zh-tw").__setRef("WAWebMomentLocales").load();return!0;default:return!1}});return h.apply(this,arguments)}g.downloadAndDefineLocale=a}),98);
__d("WAWebL10N",["WALogger","WAWeb-moment","WAWebABProps","WAWebBackendApi","WAWebBaseL10N","WAWebDebounce","WAWebEnvironment","WAWebEventsWaitForMainStreamReadyMd","WAWebL10NCoerceToFBLocale","WAWebL10NConstants","WAWebL10NHelpers","WAWebL10nGetRenderedLocale","WAWebLocaleToMomentResource","WAWebMomentLocales","WAWebUserPrefsLocales","asyncToGeneratorRuntime","bcp-47","gkx","justknobx","nullthrows"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=5e3,u=d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE.replaceAll("_","-");a=function(a){function e(){var e;e=a.call(this,{l:"en",loc:"en"})||this;e.$L10n$p_4=null;e.setLocale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(a==null)return;c=c!=null?c:!1,b=b!=null?b:d("WAWebL10NConstants").L10N_PRIORITY.PHONE;var f=d("WAWebL10NHelpers").isLocalLanguageOverrideEnabled(),g=f&&b>=d("WAWebL10NConstants").L10N_PRIORITY.SAVED,l=e.normalizeLocaleToBcp47Compliant(a);if(l==null||l===e.$L10n$p_2)return;g?d("WAWebUserPrefsLocales").setUserLangPref(a):d("WAWebUserPrefsLocales").setPhoneLangPref(a);if(f&&b===d("WAWebL10NConstants").L10N_PRIORITY.PHONE&&d("WAWebUserPrefsLocales").getUserLangPref()!=null)return;g=e.$L10n$p_1;e.$L10n$p_2=l;a=d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(l);yield d("WAWebBackendApi").frontendSendAndReceive("setLocalePrefCookie",{locale:a});e.$L10n$p_3=l;e.$L10n$p_4=a;c===!0&&b===d("WAWebL10NConstants").L10N_PRIORITY.SAVED&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: USER TRIGGERED Language change detected from "," to ","."])),g,a);d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: fullLocale:",", renderedLocale:",", newLocale:",""])),l,e.$L10n$p_1,a);if(c!==!0)e.trigger("locale_changed_on_phone",{newLocale:a,currentLocale:g});else if(g===a)e.$L10n$p_9.cancel(),d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: No language change detected (","), skipping page reload."])),g),yield e.applyMomentLocale(l),e.trigger("locale_change",{l:a,loc:l});else if(c===!0){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[l10n] setLocale: Language change detected from "," to ",", reloading page."])),g,a);e.$L10n$p_1=a;if(b>=d("WAWebL10NConstants").L10N_PRIORITY.SAVED){e.$L10n$p_10();return}void e.$L10n$p_9()}});return function(b,c,d){return a.apply(this,arguments)}}();e.$L10n$p_9=c("WAWebDebounce")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c("WAWebEventsWaitForMainStreamReadyMd")();return e.$L10n$p_10()}),t);e.$L10n$p_1=d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale();e.$L10n$p_2=e.$L10n$p_5(d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale());var f=e.$L10n$p_6(),g=e.$L10n$p_7();g=f!=null?f:g;f=f==null;if(g==null){d("WAWebUserPrefsLocales").setPhoneLangPref(e.$L10n$p_1);return babelHelpers.assertThisInitialized(e)}var m=e.$L10n$p_5(g);e.$L10n$p_3=m;if(m==null){f?d("WAWebUserPrefsLocales").setPhoneLangPref(e.$L10n$p_1):d("WAWebUserPrefsLocales").setUserLangPref(e.$L10n$p_1);return babelHelpers.assertThisInitialized(e)}f=d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(m);e.$L10n$p_4=f;f===e.$L10n$p_1&&(d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Using pref locale as full locale: ","; rendered locale: ",""])),g,e.$L10n$p_1),e.$L10n$p_2=m);void e.applyMomentLocale(m);return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.init=function(a){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[l10n] init: with locale ",""])),a);return this.setLocale(a,d("WAWebL10NConstants").L10N_PRIORITY.SAVED,!1)};f.getLocale=function(){return this.$L10n$p_1};f.getFullLocale=function(){return!c("gkx")("26258")?d("WAWebL10NCoerceToFBLocale").isWAWebl10nDebugLocale(this.$L10n$p_2)?u:this.$L10n$p_2:this.$L10n$p_2};f.getNormalizedLocale=function(){var a;return(a=this.normalizeLocaleToWajsLocale(String(this.getLocale())))!=null?a:this.getLocale()};f.getLanguage=function(){return this.$L10n$p_8(this.getFullLocale())};f.$L10n$p_8=function(a){return d("bcp-47").parse(a).language};f.getRegion=function(){var a;a=(a=d("bcp-47").parse(this.getFullLocale()))==null?void 0:a.region;if(a!=null)return a;a=this.$L10n$p_1.replace(/_/g,"-");return c("nullthrows")((a=d("bcp-47").parse(a))==null?void 0:a.region)};f.$L10n$p_6=function(){return this.normalizeLocaleToBcp47Compliant(d("WAWebUserPrefsLocales").getUserLangPref())};f.$L10n$p_7=function(){return this.normalizeLocaleToBcp47Compliant(d("WAWebUserPrefsLocales").getPhoneLangPref())};f.normalizeLocaleToBcp47Compliant=function(a){if(a==null)return null;var b=this.$L10n$p_5(a);if(b!==a){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(['[l10n] _cleanRawLocaleString: loc: "','", cleaned: "','"'])),a,b);try{new Intl.NumberFormat(b)}catch(a){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(['[l10n] _cleanRawLocaleString: "','" not compatible with Intl.NumberFormat, falling back to "','"'])),b,d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE),b=d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE.replaceAll("_","-")}}return b};f.$L10n$p_5=function(a){return a.replace(/@.*/,"").replace(/_/g,"-")};f.$L10n$p_10=function(){self.setTimeout(function(){window.location.reload()},100)};f.applyMomentLocale=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.toLocaleLowerCase("en");var b;if(a===d("WAWebL10NConstants").DEFAULT_MOMENT_LOCALE.toLocaleLowerCase("en"))b=a;else{var e=[];e.push(a);if(a.match(/en/i)==null){a=a.replace(/_/g,"-");e.push(a);c("WAWebLocaleToMomentResource")[a]!=null&&e.push(c("WAWebLocaleToMomentResource")[a])}e.push(this.getLanguage());e.push(u);for(a=0;a<e.length;++a){var f=(yield d("WAWebMomentLocales").downloadAndDefineLocale(e[a]));if(f){b=e[a];break}}}b==null&&(d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Could not fetch moment locales, using default en-US"]))),b=d("WAWebL10NConstants").DEFAULT_MOMENT_LOCALE);c("WAWeb-moment").locale(b);d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[l10n] moment locale updated to: ",""])),b);this.customizeMomentLocale(c("WAWeb-moment").locale())});function e(b){return a.apply(this,arguments)}return e}();f.customizeMomentLocale=function(a){var b=d("WAWebL10NConstants").LOCALE_CUSTOMIZATIONS[a];b&&c("WAWeb-moment").locale(a,b)};f.checkForLocaleMismatchBetweenCookieAndUserPref=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if((c("WAWebEnvironment").isWindows||d("WAWebABProps").getABPropConfigValue("wa_web_unexpected_locale_reload_fix_enabled")?d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(this.$L10n$p_1):this.$L10n$p_1)===this.$L10n$p_4){d("WAWebUserPrefsLocales").setLangPrefCookieDidMismatchWithUserPref(!1);return}d("WAWebUserPrefsLocales").getLangPrefCookieDidMismatchWithUserPref()?d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Mismatch between rendered locale: ","; and cleaned user-pref locale: ","; NOT setting cookie to avoid refresh loop."])),this.$L10n$p_1,this.$L10n$p_3):this.$L10n$p_4&&(d("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[l10n] constructor: Mismatch between rendered locale and user-pref locale. Using cleaned user-pref locale: ","; setting cookie to: ",""])),this.$L10n$p_3,this.$L10n$p_4),yield d("WAWebBackendApi").frontendSendAndReceive("setLocalePrefCookie",{locale:this.$L10n$p_4}),d("WAWebUserPrefsLocales").setLangPrefCookieDidMismatchWithUserPref(!0),c("justknobx")._("2237")||void this.$L10n$p_9())});function e(){return a.apply(this,arguments)}return e}();return e}(d("WAWebBaseL10N").WAWebBaseL10n);e=new a();g["default"]=e}),98);
__d("WAWebAccentDiacriticRegex",[],(function(a,b,c,d,e,f){a=/(?:[\^`\xA8\xAF\xB4\xB7\xB8\u02B0-\u034E\u0350-\u0357\u035D-\u0362\u0374\u0375\u037A\u0384\u0385\u0483-\u0487\u0559\u0591-\u05A1\u05A3-\u05BD\u05BF\u05C1\u05C2\u05C4\u064B-\u0652\u0657\u0658\u06DF\u06E0\u06E5\u06E6\u06EA-\u06EC\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F5\u0818\u0819\u08E3-\u08FE\u093C\u094D\u0951-\u0954\u0971\u09BC\u09CD\u0A3C\u0A4D\u0ABC\u0ACD\u0AFD-\u0AFF\u0B3C\u0B4D\u0BCD\u0C4D\u0CBC\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E47-\u0E4C\u0E4E\u0EC8-\u0ECC\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F82-\u0F84\u0F86\u0F87\u0FC6\u1037\u1039\u103A\u1087-\u108D\u108F\u109A\u109B\u17C9-\u17D3\u17DD\u1939-\u193B\u1A75-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B34\u1B44\u1B6B-\u1B73\u1BAA\u1BAB\u1C36\u1C37\u1C78-\u1C7D\u1CD0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1D2C-\u1D6A\u1DC4-\u1DCF\u1DF5-\u1DF9\u1DFD-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2CEF-\u2CF1\u2E2F\u302A-\u302F\u3099-\u309C\u30FC\uA66F\uA67C\uA67D\uA67F\uA69C\uA69D\uA6F0\uA6F1\uA717-\uA721\uA788\uA7F8\uA7F9\uA8C4\uA8E0-\uA8F1\uA92B-\uA92E\uA953\uA9B3\uA9C0\uA9E5\uAA7B-\uAA7D\uAABF-\uAAC2\uAAF6\uAB5B-\uAB5F\uABEC\uABED\uFB1E\uFE20-\uFE2F\uFF3E\uFF40\uFF70\uFF9E\uFF9F\uFFE3]|\uD800\uDEE0|\uD802[\uDEE5\uDEE6]|\uD803[\uDD22-\uDD27\uDF46-\uDF50]|\uD804[\uDCB9\uDCBA\uDD33\uDD34\uDD73\uDDC0\uDDCA-\uDDCC\uDE35\uDE36\uDEE9\uDEEA\uDF3C\uDF4D\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC42\uDC46\uDCC2\uDCC3\uDDBF\uDDC0\uDE3F\uDEB6\uDEB7\uDF2B]|\uD806[\uDC39\uDC3A\uDE34\uDE47\uDE99]|\uD807[\uDC3F\uDD42\uDD44\uDD45\uDD97]|\uD81A[\uDEF0-\uDEF4]|\uD81B[\uDF8F-\uDF9F]|\uD834[\uDD67-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD46\uDD48-\uDD4A])/g;b=a;f["default"]=b}),66);
__d("WAWebL10NHelpers",["WAWebABProps","WAWebAccentDiacriticRegex","WAWebEnvironment","WAWebL10N","WAWebL10NCoerceToFBLocale","latenize"],(function(a,b,c,d,e,f,g){function h(a){a===void 0&&(a="");return a.normalize("NFKD")}function a(a){a===void 0&&(a="");return c("latenize")(h(a).replace(c("WAWebAccentDiacriticRegex"),""))}function b(a){a=a.replace(/_/g,"-").split("-");return a[0].toLowerCase()}function e(a){a=a.replace(/_/g,"-").split("-");return a.length<=1?null:a[a.length-1].toUpperCase()}var i=new Set(["en-GB","en-AU","en-IN"]);function f(){var a=c("WAWebL10N").getFullLocale();return i.has(a)&&d("WAWebABProps").getABPropConfigValue("british_english_localization_enabled_web")}function j(){return c("WAWebEnvironment").isWindows===!0}function k(){var a=navigator.language;a=a||d("WAWebL10NCoerceToFBLocale").DEFAULT_WA_WEB_LOCALE;return d("WAWebL10NCoerceToFBLocale").coerceWAWebL10nLocaleToFBLocale(a)}g.normalizeForm=h;g.removeAccents=a;g.getLanguageCodeFromLocale=b;g.getRegionCodeFromLocale=e;g.isUsingSupportedBritishEnglishLocale=f;g.isLocalLanguageOverrideEnabled=j;g.getSystemLocale=k}),98);
__d("WAWebCountriesNativeCountryNames",[],(function(a,b,c,d,e,f){a={AC:"Ascension Island",AD:"Andorra",AE:"\u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0645\u062a\u062d\u062f\u0629",AF:"\u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646",AG:"Antigua & Barbuda",AI:"Anguilla",AL:"Shqip\xebri",AM:"\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576",AO:"Angola",AR:"Argentina",AS:"American Samoa",AT:"\xd6sterreich",AU:"Australia",AW:"Aruba",AX:"\xc5land",AZ:"Az\u0259rbaycan",BA:"Bosna i Hercegovina",BB:"Barbados",BD:"\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6",BE:"Belgi\xeb",BF:"Burkina Faso",BG:"\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f",BH:"\u0627\u0644\u0628\u062d\u0631\u064a\u0646",BI:"Burundi",BJ:"B\xe9nin",BL:"Saint-Barth\xe9lemy",BM:"Bermuda",BN:"Brunei",BO:"Bolivia",BQ:"Caribisch Nederland",BR:"Brasil",BS:"Bahamas",BT:"\u0f60\u0f56\u0fb2\u0f74\u0f42",BW:"Botswana",BY:"\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c",BZ:"Belize",CA:"Canada",CC:"Kepulauan Cocos (Keeling)",CD:"Congo-Kinshasa",CF:"R\xe9publique centrafricaine",CG:"Congo-Brazzaville",CH:"Schweiz",CI:"C\xf4te d\u2019Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"\u4e2d\u56fd",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cabo Verde",CW:"Cura\xe7ao",CX:"Christmas Island",CY:"\u039a\u03cd\u03c0\u03c1\u03bf\u03c2",CZ:"\u010cesko",DE:"Deutschland",DJ:"Djibouti",DK:"Danmark",DM:"Dominica",DO:"Rep\xfablica Dominicana",DZ:"\u0627\u0644\u062c\u0632\u0627\u0626\u0631",EC:"Ecuador",EE:"Eesti",EG:"\u0645\u0635\u0631",ER:"\u0625\u0631\u064a\u062a\u0631\u064a\u0627",ES:"Espa\xf1a",ET:"\u12a2\u1275\u12ee\u1335\u12eb",FI:"Suomi",FJ:"Fiji",FK:"Falkland Islands",FM:"Micronesia",FO:"F\xf8royar",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd",GF:"Guyane fran\xe7aise",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Kalaallit Nunaat",GM:"Gambia",GN:"Guin\xe9e",GP:"Guadeloupe",GQ:"Guinea Ecuatorial",GR:"\u0395\u03bb\u03bb\u03ac\u03b4\u03b1",GT:"Guatemala",GU:"Guam",GW:"Guin\xe9-Bissau",GY:"Guyana",HK:"\u4e2d\u570b\u9999\u6e2f\u7279\u5225\u884c\u653f\u5340",HN:"Honduras",HR:"Hrvatska",HT:"Ha\xefti",HU:"Magyarorsz\xe1g",ID:"Indonesia",IE:"Ireland",IL:"\u05d9\u05e9\u05e8\u05d0\u05dc",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"\u0627\u0644\u0639\u0631\u0627\u0642",IR:"\u0627\u06cc\u0631\u0627\u0646",IS:"\xcdsland",IT:"Italia",JE:"Jersey",JM:"Jamaica",JO:"\u0627\u0644\u0623\u0631\u062f\u0646",JP:"\u65e5\u672c",KE:"Kenya",KG:"\u041a\u044b\u0440\u0433\u044b\u0437\u0441\u0442\u0430\u043d",KH:"\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6",KI:"Kiribati",KM:"\u062c\u0632\u0631 \u0627\u0644\u0642\u0645\u0631",KN:"St. Kitts & Nevis",KP:"\uc870\uc120\ubbfc\uc8fc\uc8fc\uc758\uc778\ubbfc\uacf5\ud654\uad6d",KR:"\ub300\ud55c\ubbfc\uad6d",KW:"\u0627\u0644\u0643\u0648\u064a\u062a",KY:"Cayman Islands",KZ:"\u049a\u0430\u0437\u0430\u049b\u0441\u0442\u0430\u043d",LA:"\u0ea5\u0eb2\u0ea7",LB:"\u0644\u0628\u0646\u0627\u0646",LC:"St. Lucia",LI:"Liechtenstein",LK:"\u0dc1\u0dca\u200d\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0",LR:"Liberia",LS:"Lesotho",LT:"Lietuva",LU:"L\xebtzebuerg",LV:"Latvija",LY:"\u0644\u064a\u0628\u064a\u0627",MA:"\u0627\u0644\u0645\u063a\u0631\u0628",MC:"Monaco",MD:"Republica Moldova",ME:"\u0426\u0440\u043d\u0430 \u0413\u043e\u0440\u0430",MF:"Saint-Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"\u0421\u0435\u0432\u0435\u0440\u043d\u0430 \u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0438\u0458\u0430",ML:"Mali",MM:"\u1019\u103c\u1014\u103a\u1019\u102c",MN:"\u041c\u043e\u043d\u0433\u043e\u043b",MO:"\u4e2d\u570b\u6fb3\u9580\u7279\u5225\u884c\u653f\u5340",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"M\xe9xico",MY:"Malaysia",MZ:"Mo\xe7ambique",NA:"Namibia",NC:"Nouvelle-Cal\xe9donie",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Nederland",NO:"Norge",NP:"\u0928\u0947\u092a\u093e\u0932",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"\u0639\u064f\u0645\u0627\u0646",PA:"Panam\xe1",PE:"Per\xfa",PF:"Polyn\xe9sie fran\xe7aise",PG:"Papua New Guinea",PH:"Philippines",PK:"\u067e\u0627\u06a9\u0633\u062a\u0627\u0646",PL:"Polska",PM:"Saint-Pierre-et-Miquelon",PR:"Puerto Rico",PS:"\u0627\u0644\u0623\u0631\u0627\u0636\u064a \u0627\u0644\u0641\u0644\u0633\u0637\u064a\u0646\u064a\u0629",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"\u0642\u0637\u0631",RE:"La R\xe9union",RO:"Rom\xe2nia",RS:"\u0421\u0440\u0431\u0438\u0458\u0430",RU:"\u0420\u043e\u0441\u0441\u0438\u044f",RW:"U Rwanda",SA:"\u0627\u0644\u0645\u0645\u0644\u0643\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629",SB:"Solomon Islands",SC:"Seychelles",SD:"\u0627\u0644\u0633\u0648\u062f\u0627\u0646",SE:"Sverige",SG:"Singapore",SH:"St. Helena",SI:"Slovenija",SJ:"\u0428\u043f\u0438\u0446\u0431\u0435\u0440\u0433\u0435\u043d \u0438 \u042f\u043d-\u041c\u0430\u0439\u0435\u043d",SK:"Slovensko",SL:"Sierra Leone",SM:"San Marino",SN:"S\xe9n\xe9gal",SO:"Soomaaliya",SR:"Suriname",SS:"South Sudan",ST:"S\xe3o Tom\xe9 e Pr\xedncipe",SV:"El Salvador",SX:"Sint-Maarten",SY:"\u0633\u0648\u0631\u064a\u0627",SZ:"Eswatini",TC:"Turks & Caicos Islands",TD:"Tchad",TG:"Togo",TH:"\u0e44\u0e17\u0e22",TJ:"\u0422\u043e\u04b7\u0438\u043a\u0438\u0441\u0442\u043e\u043d",TK:"Tokelau",TL:"Timor-Leste",TM:"T\xfcrkmenistan",TN:"\u062a\u0648\u0646\u0633",TO:"Tonga",TR:"T\xfcrkiye",TT:"Trinidad & Tobago",TV:"Tuvalu",TW:"\u53f0\u7063",TZ:"Tanzania",UA:"\u0423\u043a\u0440\u0430\u0457\u043d\u0430",UG:"Uganda",US:"United States",UY:"Uruguay",UZ:"O\u02bbzbekiston",VA:"Citt\xe0 del Vaticano",VC:"St. Vincent & Grenadines",VE:"Venezuela",VG:"British Virgin Islands",VI:"U.S. Virgin Islands",VN:"Vi\u1ec7t Nam",VU:"Vanuatu",WF:"Wallis-et-Futuna",WS:"Samoa",XK:"Kosov\xeb",YE:"\u0627\u0644\u064a\u0645\u0646",YT:"Mayotte",ZA:"iNingizimu Afrika",ZM:"Zambia",ZW:"Zimbabwe"};f["default"]=a}),66);
__d("WAWebLocaleModules",["JSResource","WAWebL10nGetRenderedLocale","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){switch(d("WAWebL10nGetRenderedLocale").WAWebL10nGetRenderedLocale()){case"af_ZA":return c("JSResource")("WAWebCountriesLocaleAF").__setRef("WAWebLocaleModules").load();case"ar_AR":return c("JSResource")("WAWebCountriesLocaleAR").__setRef("WAWebLocaleModules").load();case"az_AZ":return c("JSResource")("WAWebCountriesLocaleAZ").__setRef("WAWebLocaleModules").load();case"bg_BG":return c("JSResource")("WAWebCountriesLocaleBG").__setRef("WAWebLocaleModules").load();case"bn_IN":return c("JSResource")("WAWebCountriesLocaleBN").__setRef("WAWebLocaleModules").load();case"ca_ES":return c("JSResource")("WAWebCountriesLocaleCA").__setRef("WAWebLocaleModules").load();case"cs_CZ":return c("JSResource")("WAWebCountriesLocaleCS").__setRef("WAWebLocaleModules").load();case"da_DK":return c("JSResource")("WAWebCountriesLocaleDA").__setRef("WAWebLocaleModules").load();case"de_DE":return c("JSResource")("WAWebCountriesLocaleDE").__setRef("WAWebLocaleModules").load();case"el_GR":return c("JSResource")("WAWebCountriesLocaleEL").__setRef("WAWebLocaleModules").load();case"en_GB":return c("JSResource")("WAWebCountriesLocaleEN").__setRef("WAWebLocaleModules").load();case"es_LA":return c("JSResource")("WAWebCountriesLocaleES").__setRef("WAWebLocaleModules").load();case"et_EE":return c("JSResource")("WAWebCountriesLocaleET").__setRef("WAWebLocaleModules").load();case"fa_IR":return c("JSResource")("WAWebCountriesLocaleFA").__setRef("WAWebLocaleModules").load();case"fi_FI":return c("JSResource")("WAWebCountriesLocaleFI").__setRef("WAWebLocaleModules").load();case"tl_PH":return c("JSResource")("WAWebCountriesLocaleFIL").__setRef("WAWebLocaleModules").load();case"fr_FR":return c("JSResource")("WAWebCountriesLocaleFR").__setRef("WAWebLocaleModules").load();case"gu_IN":return c("JSResource")("WAWebCountriesLocaleGU").__setRef("WAWebLocaleModules").load();case"he_IL":return c("JSResource")("WAWebCountriesLocaleHE").__setRef("WAWebLocaleModules").load();case"hi_IN":return c("JSResource")("WAWebCountriesLocaleHI").__setRef("WAWebLocaleModules").load();case"hr_HR":return c("JSResource")("WAWebCountriesLocaleHR").__setRef("WAWebLocaleModules").load();case"hu_HU":return c("JSResource")("WAWebCountriesLocaleHU").__setRef("WAWebLocaleModules").load();case"id_ID":return c("JSResource")("WAWebCountriesLocaleID").__setRef("WAWebLocaleModules").load();case"it_IT":return c("JSResource")("WAWebCountriesLocaleIT").__setRef("WAWebLocaleModules").load();case"ja_JP":return c("JSResource")("WAWebCountriesLocaleJA").__setRef("WAWebLocaleModules").load();case"kk_KZ":return c("JSResource")("WAWebCountriesLocaleKK").__setRef("WAWebLocaleModules").load();case"kn_IN":return c("JSResource")("WAWebCountriesLocaleKN").__setRef("WAWebLocaleModules").load();case"ko_KR":return c("JSResource")("WAWebCountriesLocaleKO").__setRef("WAWebLocaleModules").load();case"lt_LT":return c("JSResource")("WAWebCountriesLocaleLT").__setRef("WAWebLocaleModules").load();case"lv_LV":return c("JSResource")("WAWebCountriesLocaleLV").__setRef("WAWebLocaleModules").load();case"mk_MK":return c("JSResource")("WAWebCountriesLocaleMK").__setRef("WAWebLocaleModules").load();case"ml_IN":return c("JSResource")("WAWebCountriesLocaleML").__setRef("WAWebLocaleModules").load();case"mr_IN":return c("JSResource")("WAWebCountriesLocaleMR").__setRef("WAWebLocaleModules").load();case"ms_MY":return c("JSResource")("WAWebCountriesLocaleMS").__setRef("WAWebLocaleModules").load();case"nb_NO":return c("JSResource")("WAWebCountriesLocaleNB").__setRef("WAWebLocaleModules").load();case"nl_NL":return c("JSResource")("WAWebCountriesLocaleNL").__setRef("WAWebLocaleModules").load();case"pa_IN":return c("JSResource")("WAWebCountriesLocalePA").__setRef("WAWebLocaleModules").load();case"pl_PL":return c("JSResource")("WAWebCountriesLocalePL").__setRef("WAWebLocaleModules").load();case"pt_BR":case"pt_PT":return c("JSResource")("WAWebCountriesLocalePT").__setRef("WAWebLocaleModules").load();case"ro_RO":return c("JSResource")("WAWebCountriesLocaleRO").__setRef("WAWebLocaleModules").load();case"ru_RU":return c("JSResource")("WAWebCountriesLocaleRU").__setRef("WAWebLocaleModules").load();case"sk_SK":return c("JSResource")("WAWebCountriesLocaleSK").__setRef("WAWebLocaleModules").load();case"sl_SI":return c("JSResource")("WAWebCountriesLocaleSL").__setRef("WAWebLocaleModules").load();case"sq_AL":return c("JSResource")("WAWebCountriesLocaleSQ").__setRef("WAWebLocaleModules").load();case"sr_RS":return c("JSResource")("WAWebCountriesLocaleSR").__setRef("WAWebLocaleModules").load();case"sv_SE":return c("JSResource")("WAWebCountriesLocaleSV").__setRef("WAWebLocaleModules").load();case"sw_KE":return c("JSResource")("WAWebCountriesLocaleSW").__setRef("WAWebLocaleModules").load();case"ta_IN":return c("JSResource")("WAWebCountriesLocaleTA").__setRef("WAWebLocaleModules").load();case"te_IN":return c("JSResource")("WAWebCountriesLocaleTE").__setRef("WAWebLocaleModules").load();case"th_TH":return c("JSResource")("WAWebCountriesLocaleTH").__setRef("WAWebLocaleModules").load();case"tr_TR":return c("JSResource")("WAWebCountriesLocaleTR").__setRef("WAWebLocaleModules").load();case"uk_UA":return c("JSResource")("WAWebCountriesLocaleUK").__setRef("WAWebLocaleModules").load();case"ur_PK":return c("JSResource")("WAWebCountriesLocaleUR").__setRef("WAWebLocaleModules").load();case"uz_UZ":return c("JSResource")("WAWebCountriesLocaleUZ").__setRef("WAWebLocaleModules").load();case"vi_VN":return c("JSResource")("WAWebCountriesLocaleVI").__setRef("WAWebLocaleModules").load();case"zh_CN":return c("JSResource")("WAWebCountriesLocaleZH-CN").__setRef("WAWebLocaleModules").load();case"zh_TW":return c("JSResource")("WAWebCountriesLocaleZH-TW").__setRef("WAWebLocaleModules").load();case"zh_HK":return c("JSResource")("WAWebCountriesLocaleZH-HK").__setRef("WAWebLocaleModules").load();default:return c("JSResource")("WAWebCountriesLocaleEN").__setRef("WAWebLocaleModules").load()}});return h.apply(this,arguments)}g.getCountryData=a}),98);
__d("WAWebCountriesUtils",["WAWebCountriesNativeCountryNames","WAWebL10NCountryCodes","WAWebLidMigrationUtils","WAWebLocaleModules","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=Object.freeze({META_RECOGNIZED:"META_RECOGNIZED",WHATSAPP_REGISTRATION:"WHATSAPP_REGISTRATION"}),i=new Map(Object.entries(c("WAWebCountriesNativeCountryNames")).map(function(a){a=a[0];return[a,a]})),j=(c={},c[h.META_RECOGNIZED]=["AC","CP","DG","EA","EU","EZ","IC","QO","TA","UN","XA","XB"],c[h.WHATSAPP_REGISTRATION]=["AQ","BV","CP","DG","EA","EH","EU","EZ","GS","HM","IC","PN","QO","TA","TF","UM","UN","XA","XB","ZZ"],c);function k(a,b,c){if(a==null||a==="")return void 0;if(c==null)return void 0;return b&&j[b].includes(a.toUpperCase())?void 0:c[a.toUpperCase()]}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield d("WAWebLocaleModules").getCountryData());return k(a,b,c)});return m.apply(this,arguments)}function n(a){if(a.countriesMap==null)return[];var b=Object.entries(a.countriesMap).filter(function(b){b=b[0];return!b.includes("@")&&!j[a.filter].includes(b)}).sort(function(a,b){a=a[1];b=b[1];return String(a).localeCompare(String(b))});a.prependWith!=null&&b.unshift([a.prependWith[0],a.prependWith[1].toJSON()]);return b.map(function(a){var b=a[0];a=a[1];return[b,a]})}function a(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebLocaleModules").getCountryData());return n(babelHelpers["extends"]({},a,{countriesMap:b}))});return o.apply(this,arguments)}function e(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(a=d("WAWebLidMigrationUtils").toPn(a))==null?void 0:a.user;a=d("WAWebL10NCountryCodes").getCountryShortcodeByPhone(a);if(a!=="")return l(a)});return p.apply(this,arguments)}function f(a){return i.get(a)}g.COUNTRY_FILTER_TYPE=h;g.getCountryNameWithMap=k;g.getCountryNameFromCountryCode=l;g.getCountriesWithMap=n;g.getCountries=a;g.getCountryNameFromWid=e;g.asISOCountryCode=f}),98);
__d("WAWebServerPropConstants",[],(function(a,b,c,d,e,f){a=64;b=64;c=5e3;d=5;e=1500;var g=100*1024*1024,h=2e3*1024*1024,i=3;f.MMS_VCARD_AUTODOWNLOAD_SIZE_KB=a;f.VCARD_AS_DOCUMENT_SIZE_KB=b;f.VCARD_MAX_SIZE_KB=c;f.MULTICAST_LIMIT_GLOBAL=d;f.PTT_PLAYBACK_SPEED_HIDE_DELAY=e;f.DEFAULT_MAX_FILE_SIZE_BYTES=g;f.MAX_FILE_SIZE_BYTES=h;f.UNINITIALIZED_VALUE_WEB_BIZ_PROFILE_OPTIONS=i}),66);
__d("WAWebStateUtils",[],(function(a,b,c,d,e,f){function a(a){return a!=null&&a.$ProxyState$state?a.$ProxyState$state:a}f.unproxy=a}),66);
__d("WAWebWamEnumMediaPickerOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT_PHOTO_LIBRARY:1,CAMERA_TAB_CAPTURE:2,FORWARD:3,PASTE:4,SHARE_EXTENSION:5,EXPORT:6,MENU_CAMERA_CAPTURE:7,EXTERNAL_CAMERA:8,LINK_PREVIEW_DOWNLOAD:9,CAMERA_TAB_MEDIA_STRIP:10,CAMERA_TAB_PHOTO_LIBRARY:11,CHAT_BUTTON_CAMERA_CAPTURE:12,CHAT_BUTTON_CAMERA_MEDIA_STRIP:13,CHAT_BUTTON_CAMERA_PHOTO_LIBRARY:14,STATUS_TAB_CAMERA_CAPTURE:15,STATUS_TAB_CAMERA_MEDIA_STRIP:16,STATUS_TAB_CAMERA_PHOTO_LIBRARY:17,STATUS_REPLY_CAMERA_CAPTURE:18,STATUS_REPLY_CAMERA_MEDIA_STRIP:19,STATUS_REPLY_CAMERA_PHOTO_LIBRARY:20,MENU_CAMERA_PHOTO_LIBRARY:21,CHAT_GIF_INAPP:22,CHAT_GIF_EXTERNAL:23,STATUS_REPLY_GIF_INAPP:24,STATUS_REPLY_GIF_EXTERNAL:25,SMB_QUICK_REPLY_EDIT:26,SMB_QUICK_REPLY_SEND:27,MEDIA_BROWSER:28,CHAT_QUICK_EDIT:29,CAMERA_TAB_GIF:30,STATUS_TAB_GIF:31,PAYMENT_COMPOSER:32,PHOTO_RECEIVED:33,PHOTO_RECEIVED_GALLERY:34,AD_CREATION:35,EXTERNAL_DROP:36,IN_APP_BROWSER:37,PREMIUM_MESSAGE_COMPOSER:38,DOCUMENT_PICKER:39,IN_APP_BUG_REPORTING:40,STICKER_TRAY_CREATE_STICKER:41,STICKER_TRAY_EDIT_STICKER:42,STICKER_MESSAGE_CREATE_YOUR_OWN:43,STICKER_MESSAGE_EDIT_STICKER:44,MEDIA_VIEWER_CREATE_STICKER:45,STATUS_NEWSLETTER_CARD:46,CUTOUT_IMAGE_EDIT_STICKER:47,STICKER_TRAY_CREATE_STICKER_CAPTURE:48,THUNDERSTORM_IN_APP_PHOTO_LIBRARY:49,TRANSPARENT_IMAGE_EDIT_STICKER:50,BUSINESS_FLOWS:51,SYSTEM_INTENT:52,SMB_CATALOG_CAMERA:53,SMB_CATALOG_VIDEO_UPLOAD:54,STATUS_MENTION_RESHARE:55,MY_STATUS_FAB_CAMERA_CAPTURE:56,MY_STATUS_FAB_CAMERA_MEDIA_STRIP:57,STATUS_TAB_FAB_CAMERA_CAPTURE:58,STATUS_TAB_FAB_CAMERA_MEDIA_STRIP:59,HOME_TOOLBAR_CHATS_CAMERA_CAPTURE:60,HOME_TOOLBAR_CHATS_CAMERA_MEDIA_STRIP:61,HOME_TOOLBAR_CHATS_CAMERA_PHOTO_LIBRARY:62,HOME_TOOLBAR_STATUS_CAMERA_CAPTURE:63,HOME_TOOLBAR_STATUS_CAMERA_MEDIA_STRIP:64,HOME_TOOLBAR_STATUS_CAMERA_PHOTO_LIBRARY:65,HOME_TOOLBAR_CALLS_CAMERA_CAPTURE:66,HOME_TOOLBAR_CALLS_CAMERA_MEDIA_STRIP:67,HOME_TOOLBAR_CALLS_CAMERA_PHOTO_LIBRARY:68,HOME_TOOLBAR_COMMUNITY_CAMERA_CAPTURE:69,HOME_TOOLBAR_COMMUNITY_CAMERA_MEDIA_STRIP:70,HOME_TOOLBAR_COMMUNITY_CAMERA_PHOTO_LIBRARY:71,STATUS_TAB_SELF_POG_CAMERA_MEDIA_STRIP:72,STATUS_TAB_SELF_POG_CAMERA_CAPTURE:73,CHATS_TAB_CAMERA_MEDIA_STRIP:74,CHATS_TAB_CAMERA_CAPTURE:75,SELF_POG_ON_STATUS_VIEWER:76,STICKER_MAKER_CAMERA_CAPTURE:77,UPDATES_TAB_CREATE_STATUS_CAMERA_BUTTON:78,UPDATES_TAB_CREATE_STATUS_UNIFIED_BUTTON:79,MY_STATUS_ADD_STATUS_BUTTON:80,UNIFIED_CREATION_QUICK_ACTION_CAMERA:81,UNIFIED_CREATION_MENU_CAMERA:82,UNIFIED_CREATION_MENU_GALLERY:83,SHARE_EXTENSION_STATUS_IG_STORY_SELF_VIEWER:84,SHARE_EXTENSION_STATUS_IG_REELS_SHARE:85,STATUS_POST_RESHARE:86,POLL_CREATION:87,MUSIC_ATTRIBUTION:88,MUSIC_STANDALONE_TYPE:89,STATUS_PROMPT_RESPONSE:90,STATUS_LAYOUTS_ACTION:91,STATUS_LAYOUTS_EDITOR:92,AI_IMAGINE_BOTTOM_SHEET:93,AI_IMAGINE_MESSAGE_QUICK_ACTION:94,MAIBA_KNOWLEDGE:95,FORWARD_FROM_STATUS:96,AI_COMPOSER_CAMERA:97,AI_ATTACHMENT_TRAY_CAMERA:98,AI_ATTACHMENT_TRAY_GALLERY:99,GROUP_STATUS_INFO:100,STATUS_VIEWER_TOPBAR:101,STATUS_QUESTION_ANSWER_POST_RESHARE:102,STATUS_ADD_YOURS_AI_IMAGINE:103,NEWSLETTER_QUESTION:104,NEWSLETTER_QUESTION_RESPONSE_REPLY:105,FACEBOOK_STORY:106,INSTAGRAM_STORY:107,MAIBA_PRODUCT_INFO:108,LAYOUTS_ATTRIBUTION:109,NEWSLETTER_MUSIC:110});f.MEDIA_PICKER_ORIGIN_TYPE=a}),66);
__d("WAWebMediaGatingUtils",["WAWebABProps","WAWebChatGetters","WAWebMmsMediaTypes","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebServerPropConstants","WAWebStateUtils","WAWebWamEnumMediaPickerOriginType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isNewsletter()&&!d("WAWebNewsletterGatingUtils").isNewsletterMediaAlbumUploadEnabled())return 1;b=d("WAWebABProps").getABPropConfigValue("media_picker_select_limit");return a<=b?b:d("WAWebABProps").getABPropConfigValue("media_picker_select_limit_new")}function b(a){return a.isNewsletter()?d("WAWebNewsletterGatingUtils").isNewsletterMediaAlbumUploadEnabled():!0}function e(){return d("WAWebABProps").getABPropConfigValue("web_native_fetch_media_download")}function f(){return d("WAWebABProps").getABPropConfigValue("web_original_photo_quality_upload_enabled")}function h(){return d("WAWebABProps").getABPropConfigValue("enable_receiving_hd_photo_quality")}function i(){return d("WAWebABProps").getABPropConfigValue("web_sticky_hd_photo_setting_enabled")}function j(){return d("WAWebABProps").getABPropConfigValue("web_hd_media_global_setting_enabled")}function k(a){return a*1024*1024}function l(a,b,c){if(b===d("WAWebWamEnumMediaPickerOriginType").MEDIA_PICKER_ORIGIN_TYPE.STATUS_TAB_CAMERA_PHOTO_LIBRARY)return k(d("WAWebABProps").getABPropConfigValue("default_status_media_limit_mb"));switch(a){case"audio":return k(d("WAWebABProps").getABPropConfigValue("default_audio_limit_mb"));case"document":case"sticker-pack":return c===!0?d("WAWebServerPropConstants").VCARD_MAX_SIZE_KB*1024:d("WAWebServerPropConstants").MAX_FILE_SIZE_BYTES;case"video":return k(d("WAWebABProps").getABPropConfigValue("default_video_limit_mb"));case"image":case"sticker":return k(d("WAWebABProps").getABPropConfigValue("default_media_limit_mb"));default:a;return k(d("WAWebABProps").getABPropConfigValue("default_media_limit_mb"))}}function m(a){if(d("WAWebChatGetters").getIsNewsletter(d("WAWebStateUtils").unproxy(a))){a=new Set([d("WAWebMsgType").MSG_TYPE.IMAGE,d("WAWebMsgType").MSG_TYPE.VIDEO,d("WAWebMsgType").MSG_TYPE.STICKER]);d("WAWebNewsletterGatingUtils").isNewsletterAudioFileSendingEnabled()&&a.add(d("WAWebMsgType").MSG_TYPE.AUDIO);return a}return d("WAWebMsgType").ALL_MSG_TYPES_SET}function n(){return typeof self.BigInt==="function"}function o(a){a=a.type.startsWith("video/");return a&&n()&&d("WAWebABProps").getABPropConfigValue("web_wasm_worker_enabled_www")}function p(){return d("WAWebABProps").getABPropConfigValue("web_larger_link_previews")}function q(a){a=d("WAWebMmsMediaTypes").msgToMediaType({type:a.type,isGif:a.isGif,interactiveHeader:a.interactiveHeader,isNewsletter:c("WAWebWid").isNewsletter(a.to)});return r(a)}function r(a){switch(a){case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_IMAGE:return d("WAWebABProps").getABPropConfigValue("enable_channel_image_server_thumbnail");case d("WAWebMmsMediaTypes").MEDIA_TYPES.NEWSLETTER_VIDEO:return d("WAWebABProps").getABPropConfigValue("enable_channel_video_server_thumbnail");default:return!1}}function s(){return d("WAWebABProps").getABPropConfigValue("web_channel_video_server_transcode_upload")}g.getMaxNumberSelectableMedia=a;g.supportsMultipleUploads=b;g.isNativeFetchEnabled=e;g.isSendHQPhotoEnabled=f;g.isReceiveHQPhotoEnabled=h;g.isStickyHQPhotoSettingEnabled=i;g.isHDMediaGlobalSettingEnabled=j;g.getUploadLimit=l;g.getSupportedMediaTypesForChat=m;g.shouldUseWasmMediaWorkerForFile=o;g.shouldUseLargeHQPreviewInComposer=p;g.isThumbnailGenerationForMsgOnServerEnabled=q;g.isThumbnailGenerationOnServerEnabledForMediaType=r;g.isChannelVideoServerTranscodeUploadEnabled=s}),98);
__d("WAWebMmsMediaTypes",["WAWebInteractiveMessageHeaderMediaType","WAWebMsgGetters","WAWebMsgType","err","lodash"],(function(a,b,c,d,e,f,g){var h=Object.freeze({AUDIO:"audio",DOCUMENT:"document",GIF:"gif",IMAGE:"image",NATIVE_FLOW:"native_flow",PPIC:"ppic",PRODUCT:"product",PTT:"ptt",STICKER:"sticker",VIDEO:"video",PTV:"ptv",TEMPLATE:"template",THUMBNAIL_DOCUMENT:"thumbnail-document",THUMBNAIL_IMAGE:"thumbnail-image",THUMBNAIL_VIDEO:"thumbnail-video",THUMBNAIL_LINK:"thumbnail-link",HISTORY_SYNC:"md-msg-hist",MD_APP_STATE:"md-app-state",PRODUCT_CATALOG_IMAGE:"product-catalog-image",PAYMENT_BG_IMAGE:"payment-bg-image",BIZ_COVER_PHOTO:"biz-cover-photo",PREVIEW:"preview",NEWSLETTER_AUDIO:"newsletter-audio",NEWSLETTER_DOCUMENT:"newsletter-document",NEWSLETTER_IMAGE:"newsletter-image",NEWSLETTER_GIF:"newsletter-gif",NEWSLETTER_PTT:"newsletter-ptt",NEWSLETTER_PTV:"newsletter-ptv",NEWSLETTER_STICKER:"newsletter-sticker",NEWSLETTER_THUMBNAIL_LINK:"newsletter-thumbnail-link",NEWSLETTER_VIDEO:"newsletter-video",NATIVE_AD_IMAGE:"ads-image",NATIVE_AD_VIDEO:"ads-video",STICKER_PACK:"sticker-pack",THUMBNAIL_STICKER_PACK:"thumbnail-sticker-pack",MUSIC_ARTWORK:"music-artwork",GROUP_HISTORY:"group-history",NEWSLETTER_STICKER_PACK:"newsletter-sticker-pack"});e=c("lodash").values(h);function a(a){var b;if(a==null)b=h.DOCUMENT;else if(a in h)b=h[a];else throw c("err")("castToV4: unexpected mmsv3 type "+a);return b}function i(a){var b=a.type,e=a.isGif,f=a.interactiveHeader,g=a.isNewsletter;a=a.isAdsMedia;switch(b){case d("WAWebMsgType").MSG_TYPE.IMAGE:if(g)return h.NEWSLETTER_IMAGE;else if(a===!0)return h.NATIVE_AD_IMAGE;return h.IMAGE;case d("WAWebMsgType").MSG_TYPE.VIDEO:if(g)return e===!0?h.NEWSLETTER_GIF:h.NEWSLETTER_VIDEO;else if(a===!0)return h.NATIVE_AD_VIDEO;return e===!0?h.GIF:h.VIDEO;case d("WAWebMsgType").MSG_TYPE.AUDIO:return g?h.NEWSLETTER_AUDIO:h.AUDIO;case d("WAWebMsgType").MSG_TYPE.PTT:return g?h.NEWSLETTER_PTT:h.PTT;case d("WAWebMsgType").MSG_TYPE.PTV:return g?h.NEWSLETTER_PTV:h.PTV;case d("WAWebMsgType").MSG_TYPE.DOCUMENT:return h.DOCUMENT;case d("WAWebMsgType").MSG_TYPE.STICKER_PACK:return g?h.NEWSLETTER_STICKER_PACK:h.STICKER_PACK;case d("WAWebMsgType").MSG_TYPE.STICKER:return g?h.NEWSLETTER_STICKER:h.STICKER;case d("WAWebMsgType").MSG_TYPE.PRODUCT:return h.PRODUCT;case d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW:return h.NATIVE_FLOW;case d("WAWebMsgType").MSG_TYPE.INTERACTIVE:if((f==null?void 0:f.mediaType)!=null)switch(f.mediaType){case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT:return h.DOCUMENT;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO:return h.VIDEO;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE:return h.IMAGE;case d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.PRODUCT:return h.PRODUCT}break;case d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:return h.GROUP_HISTORY}throw c("err")("msg is not a media msg: "+b+", isGif="+String(e))}function b(a){return i({type:a.type,interactiveHeader:a.interactiveHeader,isGif:a.type===d("WAWebMsgType").MSG_TYPE.VIDEO?a.isGif:!1,isNewsletter:d("WAWebMsgGetters").getIsNewsletterMsg(a),isAdsMedia:a.isAdsMedia})}g.MEDIA_TYPES=h;g.MEDIA_TYPE_VALUES=e;g.castToV4=a;g.msgToMediaType=i;g.getMsgMediaType=b}),98);
__d("WAWebMediaCryptoEligibilityUtils",["WAWebChatGetters","WAWebMmsMediaTypes","WAWebMsgGetters"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebChatGetters").getIsNewsletter(a)?!1:!0}function b(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)?!1:!0}var h=new Set([(f=d("WAWebMmsMediaTypes")).MEDIA_TYPES.NEWSLETTER_AUDIO,f.MEDIA_TYPES.NEWSLETTER_DOCUMENT,f.MEDIA_TYPES.NEWSLETTER_GIF,f.MEDIA_TYPES.NEWSLETTER_IMAGE,f.MEDIA_TYPES.NEWSLETTER_PTT,f.MEDIA_TYPES.NEWSLETTER_PTV,f.MEDIA_TYPES.NEWSLETTER_STICKER,f.MEDIA_TYPES.NEWSLETTER_THUMBNAIL_LINK,f.MEDIA_TYPES.NEWSLETTER_VIDEO,f.MEDIA_TYPES.NEWSLETTER_STICKER_PACK]);function i(a){return h.has(a)}function c(a){return i(a)?!1:!0}function e(a){return i(a)?!1:!0}g.isMediaCryptoExpectedForChat=a;g.isMediaCryptoExpectedForMsg=b;g.isMediaCryptoExpectedForMediaType=c;g.isRmrSupportedForMediaType=e}),98);
__d("WAWebBaseMirror",["lodash"],(function(a,b,c,d,e,f,g){function a(a){var b={},c=0,d=function(a){b["change:"+a]=c++};a.props&&Object.keys(a.props).forEach(d);a.session&&Object.keys(a.session).forEach(d);a.derived&&Object.keys(a.derived).forEach(d);return b}var h="change",i=32;function b(a,b){var c=[];for(var d=0;d<b.length;d++){var e=a["change:"+b[d]],f=Math.floor(e/i);e=e%i;k(c,f+1);c[f]|=1<<e}return c}d=function(){function a(a){this.state=a}var b=a.prototype;b.destructor=function(){this.state.off("all",this.onGatherEvent,this)};b.initListener=function(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[]};b.onGatherEvent=function(a){if(a===h){var b=this.changeEvents;if(!b.filter(Boolean).length)return;this.onChange();this.changeEvents=[]}else{b=this.state.mirrorMask[a];if(b===void 0)return;a=b/i|0;b=b%i|0;k(this.changeEvents,a+1);this.changeEvents[a]|=1<<b}};b.onChange=function(){if(this.listeners==null)return;var a=this.state,b=this.changeEvents;c("lodash").zip(this.masks,this.listeners).forEach(function(c){var d=c[0];c=c[1];var e=Math.min(b.length,d.length);for(var f=0;f<e;f++)if(b[f]&d[f]){var g=c[0],h=c[1];g!=null&&h!=null&&g(h,a);break}})};b.addListener=function(a,b,c){this.listeners||this.initListener();this.masks.push(b);(b=this.listeners)==null||b.push([a,c])};b.removeListener=function(a){var b=this.listeners;if(b==null)return;for(var c=0;c<b.length;c++)b[c][0]===a&&(b[c][0]=null,b[c][1]=null,j(this.masks,c),j(b,c))};return a}();function j(a,b){a[b]=a[a.length-1],a.pop()}function k(a,b){if(b<=a.length)return;b=b-a.length;for(var c=0;c<b;c++)a.push(0)}g.genMirrorMask=a;g.genBitMask=b;g.BaseMirror=d}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("toposort-1.0.3",[],(function(a,b,c,d,e,f){"use strict";a={};var g={exports:a};function h(){g.exports=a=function(a){return b(c(a),a)};a.array=b;function b(a,b){var c=a.length,d=new Array(c),e={},f=c;while(f--)e[f]||g(a[f],f,[]);return d;function g(h,f,i){if(i.indexOf(h)>=0)throw new Error("Cyclic dependency: "+JSON.stringify(h));if(!~a.indexOf(h))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(h));if(e[f])return;e[f]=!0;var j=b.filter(function(a){return a[0]===h});if(f=j.length){i=i.concat(h);do{var k=j[--f][1];g(k,a.indexOf(k),i)}while(f)}d[--c]=h}}function c(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=a[c];b.indexOf(e[0])<0&&b.push(e[0]);b.indexOf(e[1])<0&&b.push(e[1])}return b}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);
__d("toposort",["toposort-1.0.3"],(function(a,b,c,d,e,f){e.exports=b("toposort-1.0.3")()}),null);
__d("WAWebModelUtils",["WANullthrows","WATypeUtils","err","isEmptyObject","isPlainObject","lodash","toposort"],(function(a,b,c,d,e,f,g){var h={sentinel:"DEFAULT VALUE PLACEHOLDER"},i={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"},j=Symbol("NO_DEFAULT_VALUE"),k={PROPS:"Props",SESSION:"Session",DERIVED:"Derived",GETTER:"Getter",COLLECTION:"Collection"};function a(a){a===void 0&&(a=j);a={defaultValue:a,type:k.PROPS};return a}function b(a){a===void 0&&(a=j);a={defaultValue:a,type:k.SESSION};return a}function e(a,b){a={fn:a,deps:b,type:k.DERIVED};return a}function f(a){a={fn:a,type:k.GETTER};return a}function l(a){a={val:a,type:k.COLLECTION};return a}function m(a){a=a.defaultValue;return a===j?{}:{defaultValue:a}}var n="__x_";function o(a){return n+a}function p(a,b,e,f){if(!c("isPlainObject")(e))throw c("err")("Invalid Prop/Session definition.");var g={sk:o(b),evt:"change:"+b,attr:f};e.defaultValue!==void 0&&(g.defaultValue=e.defaultValue);a._definition[b]=g;var i=d("WATypeUtils").isFunction(g.defaultValue);if(g.defaultValue!=null&&!i)if(Array.isArray(g.defaultValue))throw c("err")("Do not return mutable types as default values as they are shared. Type: Array provided.");else if(c("isPlainObject")(g.defaultValue))throw c("err")("Do not return mutable types as default values as they are shared. Type: Object provided.");var j=g.sk;Object.defineProperty(a,b,{set:function(a){this.set(b,a)},get:function(){var a=this[j];if(a!==h)return a;return i?this[j]=g.defaultValue():g.defaultValue}})}function q(a,b,c){var d=o(b),e=c.fn;a._definition[b]=a._derived[b]={sk:d,evt:"change:"+b,attr:i.DERIVED,fn:e,deps:c.deps};Object.defineProperty(a,b,{get:function(){var a=this[d];if(a!==h)return a;a=e.call(this);this[d]=a;return a},set:function(){throw new TypeError("'"+b+"' is a derived property, it can't be set directly.")}})}function r(a){var b=[];for(var c in a){if(typeof a[c]==="function")continue;b.push([c,a[c]])}return b}function s(a){var b={},c=Object.getPrototypeOf({}),d=a;Object.getOwnPropertyNames(d).forEach(function(a){if(typeof d[a]!=="function")return;b[a]=d[a]});while((d=Object.getPrototypeOf(d))&&d!==c)Object.getOwnPropertyNames(d).forEach(function(a){if(a in b)return;b[a]=d[a]});return b}function t(a){var b=new a({},{_internalInitializationDoNotUse:!0}),d={name:a.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:a.isIdType};a.Collection&&(d.Collection=a.Collection);a.idClass&&(d.idClass=a.idClass);a.allowedIds&&(d.allowedIds=a.allowedIds);var e=new Set(["constructor"]),f=new Set(["collection","parent","revisionNumber","__changes","__fired","__initialized"]),g=new Map(r(b).filter(function(a){var b=a[0];a=a[1];return!f.has(b)&&(a==null?void 0:a.type)===k.GETTER}).map(function(a){var b=a[0];a=a[1].fn;return[a,b]})),h=c("lodash").memoize(function(a){a=c("lodash").flatMap((a=a.dependencies)!=null?a:[],function(a){if(a.dependencyKey!=null)return[a.dependencyKey];var b=g.get(a);return b!=null?[b]:h(a)});return Array.from(new Set(a))});r(b).forEach(function(b){var g=b[0];b=b[1];if(f.has(g)||b==null)return;switch(b.type){case k.PROPS:d.props[g]=m(b);break;case k.SESSION:d.session[g]=m(b);break;case k.DERIVED:d.derived[g]=c("lodash").omit(b,"type");e.add(b.fn.name);break;case k.GETTER:var i=b.fn;d.derived[g]={fn:function(){return i(this)},deps:h(i)};e.add(i.name);break;case k.COLLECTION:d.collections[g]=b.val;break;default:throw c("err")("Invalid defineModel Class type for "+a.name+":"+g+".")}});var i=s(b);e.forEach(function(a){delete i[a]});Object.assign(d,i);return d}function u(a,b){var c;a=(c={},c[b]=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a),c)[b];return a}function v(a,b){var d,e=c("WANullthrows")(b.name);delete b.name;a=u(a,e);var f=a.prototype,g=f.__props=[],j=f.__session=[],k=f.__derived=[],l=f._collections={};e=f._definition={};var m=f._derived={},n=["props","session","derived","collections"];(d=c("lodash")).forOwn(b.props,function(a,b){g.push(b),p(f,b,a,i.PROP)});d.forOwn(b.session,function(a,b){j.push(b),p(f,b,a,i.SESSION)});d.forOwn(b.derived,function(a,b){k.push(b),q(f,b,a)});d.forOwn(b.collections,function(a,b){l[b]=a});Object.assign(f,d.omit(b,n));var o=g.concat(j),r=o.length;Object.defineProperties(f,{attributes:{get:function(){var a={};for(var b=0;b<r;++b)a[o[b]]=this[o[b]];return a}},isState:{get:function(){return!0},set:function(){throw c("err")("attempt to set isState")}}});d={};for(b=0;b<r;b++){n=o[b];"defaultValue"in e[n]&&(d[n]=h)}c("isEmptyObject")(d)||(f.__defaults=d);if(k.length){var s=[],t={},v={};c("lodash").forOwn(m,function(a,b){v[b]=!0,c("lodash").forOwn(a.deps,function(a){v[a]=!0,(t[a]||(t[a]=[])).push(b),s.push([b,a])})});s.length&&(f._deps=t,f._topo=c("toposort").array(Object.keys(v),s).reverse(),f._topoIndexMap=new Map(f._topo.map(function(a,b){return[a,b]})))}return a}g.INIT=h;g.Attr=i;g.prop=a;g.session=b;g.derived=e;g.getter=f;g.collection=l;g.convert=t;g.stateExtend=v}),98);
__d("WAWebProxyStateFactory",["WACustomError","WALogger","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k=["props","session","collections","derived"],l=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("DuplicatedProxyProperty")),m={};a=function(a,b,e){var f=b.props,g=b.session,n=b.collections,o=b.derived;b=babelHelpers.objectWithoutPropertiesLoose(b,k);var p=function(a){this.$ProxyState$state=a},q={};[f,g,n,o].forEach(function(b){if(!b)return;Object.keys(b).forEach(function(b){q[b]={get:function(){c("gkx")("26258")?d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(['Cannot read proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."])),a,b,this.$ProxyState$ComponentName):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(['Cannot read proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."])),a,b,this.$ProxyState$ComponentName).sendLogs("Invalid ProxyState Access");return this.$ProxyState$state[b]},set:function(c){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(['Cannot write proxy property "',".",'" created in <',"/>. Make sure it is in your list of concerns."])),a,b,this.$ProxyState$ComponentName).sendLogs("Invalid ProxyState Write"),this.$ProxyState$state[b]=c}}})});q.proxyName={value:a};q.mirrorMask={value:e};["set","get"].concat(Object.keys(b)).forEach(function(a){q[a]={value:function(){var b=this.$ProxyState$state;return b[a].apply(b,arguments)}}});p.prototype=Object.create(null,q);p.prototype.constructor=p;if(a in m)throw new l('Duplicated proxy property "'+a+'".');m[a]=p};g.ProxyStates=m;g.ProxyStateFactory=a}),98);
__d("WAWebBaseModel",["WALogger","WANullthrows","WATypeUtils","WAWebBaseMirror","WAWebCmd","WAWebEventEmitter","WAWebModelUtils","WAWebNetworkStatus","WAWebProxyStateFactory","cr:5292","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n;function a(a){return typeof a==="string"?a:a.toString()}var o=/^change:/,p=function(a){function e(b,c){var e;c===void 0&&(c={});e=a.call(this)||this;e.stale=d("WAWebModelUtils").session(!1);e.revisionNumber=1;e.__fired=null;e.__changes=null;e.__initialized=!1;if(c._internalInitializationDoNotUse)return babelHelpers.assertThisInitialized(e);e.stale=(b==null?void 0:b.stale)||e.getDefault("stale")===!0;e.parent=c.parent;e.collection=c.collection;e._initDeriveds();e._initCollections();var f=e.__defaults;f=f?babelHelpers["extends"]({},f,b):b;f&&!q(f)&&e.set(f,babelHelpers["extends"]({silent:!0},c));e.initialize();e.__initialized=!0;return e}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){if(this.collection&&this.id&&!this.collection.modelClass.prototype.isIdType(this.id)){var a=this.collection?typeof this.collection.modelClass.prototype.idClass:"N/A";throw c("err")("Model id:"+String(this.id)+" is wrong type ("+typeof this.id+" vs expected "+a+")")}this._uiObservers=0;this.mirrorMask&&(this.mirror=new(d("WAWebBaseMirror").BaseMirror)(this))};f._refreshStaleModel=function(){if(!this._uiObservers&&this.stale)return;if(this.getCollection)this.getCollection().find(this.id);else throw c("err")("base_model:_refreshStaleModel getCollection does not exist")};f.incObservers=function(a){this._uiObservers++;if(a)return;c("WAWebNetworkStatus").online&&this.stale&&(d("WAWebCmd").Cmd.uiBusy?this.listenToOnce(d("WAWebCmd").Cmd,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())};f.decObservers=function(){this._uiObservers>0&&this._uiObservers--,this._uiObservers===0&&this.stopListening(d("WAWebCmd").Cmd,"ui_idle",this._refreshStaleModel)};f.hasObservers=function(){return this._uiObservers>0};f.getObservers_TEST_ONLY=function(){return null};f.addChild=function(a,b){var c={};c[a]=b;this.set(c,{silent:!0});this.listenTo(b,"all",this._getCachedEventBubblingHandler(a))};f.get=function(a){return this[a]};f.set=function(a,e,f){!c("gkx")("26258")&&b("cr:5292")!=null&&b("cr:5292").currentTransaction&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Detected UI change inside a transaction in model ",".\n      This can result in a consistency issue. See https://fburl.com/aleoj4tt item #1 for details."])),this.constructor.name);f=f;if(typeof a==="string")return this._set(a,e,f);f=e;return(e=f)!=null&&e.merge?this._set(r(a),f):this._set(a,f)};f._markChange=function(a,b){if(!this.__initialized)return;this._getChanges().push({key:a,oldValue:b});this.__fired&&(this.__fired[a]=!1)};f._set=function(a,b,e){var f,g=this;this.revisionNumber++;var h=!!this.__changes;f=d("WATypeUtils").isString(a)?[(f={},f[a]=b,f),e]:[a,b];var i=f[0],j=f[1],k=new Set();Object.keys(i).forEach(function(a){a=g._setKV(a,i[a],j);a==null||a.forEach(function(a){k.add(a)})});if(k.size>0){var l=c("WANullthrows")(this._topo,"_topo unexpectedly undefined"),m=c("WANullthrows")(this._topoIndexMap);e=function(a){var b=l[a];if(!k.has(b))return 1;b=g._setD(b);b==null||b.forEach(function(b){var d=c("WANullthrows")(m.get(b));if(d<a)throw c("err")("Circular derived properties / event listeners");k.add(b)})};for(a=0;a<l.length;a++)if(e(a))continue}b=j==null?void 0:j.silent;if(!b&&this.hasUnfiredChanges()){f=this.__fired={};e=this._getChanges();a=e.length>0;while(e.length){b=e.shift();var n=b.key;b=b.oldValue;if(!f[n]){f[n]=!0;var o=this._definition[n].evt;if(this.isListening(o)||this.isListening("all")){n=this[n];this.trigger(o,this,n,b)}}}(a&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}h||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null));return this};f._setKV=function(a,b,e){if(this._collections[a]){this[a].set(b,e);return}e=this._definition[a];if(!e){this[a]=b;return}else if(e.attr===d("WAWebModelUtils").Attr.DERIVED)throw c("err")("Attempting to directly set derived property: "+a);e=e.sk;var f=this[a];if(b===f)return;this[e]=b;this._markChange(a,f);return(e=this._deps)==null?void 0:e[a]};f._setD=function(a){var b=this._definition[a],c=b.sk;b=b.fn.call(this);var d=this[c];if(b===d)return;this[c]=b;this._markChange(a,d);return(c=this._deps)==null?void 0:c[a]};f.hasUnfiredChanges=function(){var a=this.__fired,b=this.__changes;if(!b)return!1;if(!a)return!0;for(var c=0;c<b.length;c++)if(!a[b[c].key])return!0;return!1};f._getChanges=function(){return this.__changes||(this.__changes=[])};f._initDeriveds=function(){var a=this;this.__derived.forEach(function(b){a[a._definition[b].sk]=d("WAWebModelUtils").INIT})};f._initCollections=function(){var a=this;Object.entries(this._collections).forEach(function(b){var c=b[0];b=b[1];a[c]=new b(null,{parent:a})})};f.unset=function(a,b){a=Array.isArray(a)?a:[a];var c={};for(a of a)c[a]=void 0;this.set(c,b)};f.clear=function(){this.unset([].concat(this.__props,this.__session))};f["delete"]=function(){this.stopListening()};f.reset=function(){this.set(this.__defaults)};f.toJSON=function(){return this.serialize()};f.serialize=function(){var a=this,b={};for(var c=0;c<this.__props.length;c++)b[this.__props[c]]=this[this.__props[c]];Object.keys(this._collections).forEach(function(c){b[c]=a[c].serialize()});return b};f.getDefault=function(a){a=this._definition[a];if(!a)return void 0;a=a.defaultValue;return d("WATypeUtils").isFunction(a)?a():a};f._getCachedEventBubblingHandler=function(a){return function(b,c,d){o.test(b)?this.trigger("change:"+a+"."+b.split(":")[1],c,d):b==="change"&&this.trigger("change",this)}.bind(this)};e.isIdType=function(a){if(this.allowedIds&&this.allowedIds.includes(a))return!0;return this.idClass?a instanceof this.idClass:typeof a==="string"};f.pp=function(){var a=this;if(!c("gkx")("26258")){var b="#cc3333",e="#33cc33",f="#3333cc";this.__props.length&&d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["props:"]))).color(b);this.__props.forEach(function(c){var e=a[c];d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"])),c).color(b).devConsole(e)});this.__session.length&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["session:"]))).color(e);this.__session.forEach(function(b){var c=a[b];d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"])),b).color(e).devConsole(c)});this.__derived.length&&d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["derived:"]))).color(f);this.__derived.forEach(function(b){var c=a[b];d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["\t",":"],["\\t",":"])),b).color(f).devConsole(c)})}};return e}(c("WAWebEventEmitter"));function e(a){var b=d("WAWebModelUtils").convert(a),c=d("WAWebModelUtils").stateExtend(p,b);if(a.Proxy){var e=d("WAWebBaseMirror").genMirrorMask(b);c.prototype.mirrorMask=e;c.prototype.proxyName=a.Proxy;d("WAWebProxyStateFactory").ProxyStateFactory(a.Proxy,b,e)}return c}function q(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}function r(a){var b=Object.keys(a),c=b.length,d={};for(var e=0;e<c;e++){var f=b[e];a[f]!==void 0&&(d[f]=a[f])}return d}g.prop=(f=d("WAWebModelUtils")).prop;g.session=f.session;g.derived=f.derived;g.getter=f.getter;g.collection=f.collection;g.idTypeToString=a;g.BaseModel=p;g.defineModel=e}),98);
__d("WAWebCtwaAGMUtils",["WALogger","WAWebBizGatingUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;c={URL:"url",CALL:"call",CATALOG:"catalog",FLOW:"flow"};var i={FACEBOOK:"facebook",INSTAGRAM:"instagram",WHATSAPP:"whatsapp"};function a(a){if(a.ctaPayload==null)return null;try{a=JSON.parse(a.ctaPayload);return{ctaType:a.cta_type,ctaText:a.cta_text,ctaPayload:(a=a.cta_payload)!=null?a:null}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["drop: cannot parse CtWA CTA payload: ",""])),a.stack);return null}}function b(a){var b=d("WAWebBizGatingUtils").getFmxAgmEnabled();return d("WAWebBizGatingUtils").getWamoAgmEnabled()?b:b&&a!==i.WHATSAPP}g.AGM_CTA_TYPE=c;g.AGM_SOURCE_APP=i;g.extractAGMPayload=a;g.isWamoAGMIntegrationEnabled=b}),98);
__d("WAWebMsgDataUtils",["WALogger","WATimeUtils","WAWebAck","WAWebBizGatingUtils","WAWebBotTypes","WAWebChatGetters","WAWebCommonMsgUtils","WAWebCurrentUser","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.type,e=a.subtype,f;b===d("WAWebMsgType").MSG_TYPE.GP2?e==="subject"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="add"||e==="invite"||e==="invite_auto_add"||e==="linked_group_join"||e==="community_invite_auto_add_rich"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="community_owner_update"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.DEFAULT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="linked_group_promote"||e==="linked_group_demote"?c("WAWebWid").isGroup(a.id.remote)&&a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])&&!d("WAWebUserPrefsMeUser").isMeAccount(a.author)?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="remove"?a.recipients&&d("WAWebUserPrefsMeUser").isMePrimary(a.recipients[0])?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:e==="create"||e==="empty_subgroup_create"||e==="general_chat_add"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="created_subgroup_suggestion"?f=d("WAWebCommonMsgUtils").EventType.DEFAULT:e==="parent_group_link"||e==="auto_add"||e==="default_sub_group_admin_add"||e==="community_participant_add_rich"||e==="subgroup_admin_triggered_auto_add"||e==="subgroup_admin_triggered_invite_auto_add"||e==="sibling_group_link"||e==="community_invite_rich"||e==="sub_group_participant_add_rich"||e==="sub_group_invite_rich"||e==="community_link_parent_group_rich"?f=d("WAWebCommonMsgUtils").EventType.SIGNIFICANT:e==="membership_approval_request"||e==="created_membership_requests"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:e==="sibling_group_unlink"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.BROADCAST_NOTIFICATION||b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION||b===d("WAWebMsgType").MSG_TYPE.E2E_NOTIFICATION?e==="create"?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.GROUPS_V4_INVITE&&d("WAWebUserPrefsMeUser").isMePrimary(a.from)?f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.CALL_LOG?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:a.broadcast===!0?c("WAWebWid").isBroadcast(a.id.remote)?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:d("WAWebMsgGetters").getIsGroupStatus(a)?f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.REVOKED?f=d("WAWebCommonMsgUtils").EventType.IGNORE:c("WAWebWid").isPSA(a.id.remote)?f=a.ack===d("WAWebAck").ACK.RECEIVED?d("WAWebCommonMsgUtils").EventType.DEFAULT:d("WAWebCommonMsgUtils").EventType.AMBIENT:b===d("WAWebMsgType").MSG_TYPE.CIPHERTEXT||b===d("WAWebMsgType").MSG_TYPE.OVERSIZED?f=d("WAWebCommonMsgUtils").EventType.AMBIENT:b===d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE?e==="sender_invite"||(e==="chat_assignment"||e==="chat_assignment_unassign")&&d("WAWebBizGatingUtils").shouldReorderChatOnAssignment(e==="chat_assignment_unassign")?f=d("WAWebCommonMsgUtils").EventType.NOTEWORTHY:f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.PROTOCOL&&e==="ephemeral_setting"?f=d("WAWebCommonMsgUtils").EventType.IGNORE:b===d("WAWebMsgType").MSG_TYPE.REACTION?f=d("WAWebCommonMsgUtils").EventType.IGNORE:f=d("WAWebCommonMsgUtils").EventType.DEFAULT;return f}function e(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.id,f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),g=d("WAWebUserPrefsMeUser").getMeLidUserOrThrow(),i=a.id.isLid()?g:f,j=void 0;if(d("WAWebChatGetters").getIsGroup(a)){var k;i=((k=a.groupMetadata)==null?void 0:k.isLidAddressingMode)===!0?g:f;j=d("WAWebWidFactory").asUserWidOrThrow(i);if(d("WAWebCurrentUser").isEmployee()){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["genOutgoingMsgData: generating key for group ",", has metadata: ",",\n          isLidAddressingMode: ",", participant: ",""])),e.toString(),a.groupMetadata!=null,(k=a.groupMetadata)==null?void 0:k.isLidAddressingMode,j)}}else a.id.isStatus()&&(j=f);g=new(c("WAWebMsgKey"))({from:i,to:e,id:yield c("WAWebMsgKey").newId(),participant:j,selfDir:"out"});f=(k=a.contact.businessProfile)==null?void 0:k.automatedType;var l;if(f)switch(f){case d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P:l=d("WAWebBotTypes").BizBotType.BIZ_1P;break;case d("WAWebBotTypes").BizBotAutomatedType.FULL_3P:l=d("WAWebBotTypes").BizBotType.BIZ_3P;break;case d("WAWebBotTypes").BizBotAutomatedType.UNKNOWN:l=null}return{id:g,from:i,to:e,type:b,t:d("WATimeUtils").unixTime(),viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,isNewMsg:!0,local:!0,ack:d("WAWebAck").ACK.CLOCK,bizBotType:l}});return i.apply(this,arguments)}g.eventTypeFromMsgType=a;g.genOutgoingMsgData=e}),98);
__d("WAWebWamMsgUtils",["WAWebApiParse","WAWebBotTypes","WAWebHandleMsgCommon","WAWebInteractiveMessageType","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumE2eDeviceType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){if(d("WAWebMsgGetters").getIsStatus(a))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS;else if(d("WAWebMsgGetters").getIsGroupMsg(a))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP;else if(c("WAWebWid").isBroadcast(a.id.remote)||d("WAWebMsgGetters").getBroadcastId(a)!=null)return d("WAWebWamEnumMessageType").MESSAGE_TYPE.BROADCAST;else if(c("WAWebWid").isNewsletter(a.id.remote))return d("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL;return d("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL}function b(a){switch(a){case"chat":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL;case"group":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP;case"peer_broadcast":case"other_broadcast":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.BROADCAST;case"direct_peer_status":case"other_status":return d("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS}}function e(a){if(a.isDynamicReplyButtonsMsg===!0)return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_MESSAGE;switch(a.type){case"image":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"video":return a.isGif===!0?d("WAWebWamEnumMediaType").MEDIA_TYPE.GIF:d("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"ptv":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"audio":return d("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO;case"ptt":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case"document":return d("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"unknown":return d("WAWebWamEnumMediaType").MEDIA_TYPE.FUTURE;case"location":return a.isLive===!0?d("WAWebWamEnumMediaType").MEDIA_TYPE.LIVE_LOCATION:d("WAWebWamEnumMediaType").MEDIA_TYPE.LOCATION;case"vcard":return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case"multi_vcard":return d("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT_ARRAY;case"chat":if(a.matchedText!=null){if(d("WAWebApiParse").matchCatalogUrl(a.matchedText))return d("WAWebWamEnumMediaType").MEDIA_TYPE.CATALOG_LINK;else if(d("WAWebApiParse").matchProductUrl(a.matchedText))return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LINK;return d("WAWebWamEnumMediaType").MEDIA_TYPE.URL}return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"sticker":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case"product":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_IMAGE;case"list":var b;b=(b=(b=a.list)==null?void 0:b.listType)!=null?b:d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.UNKNOWN;switch(b){case d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.SINGLE_SELECT:return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST;case d("WAWebProtobufsE2E.pb").Message$ListMessage$ListType.PRODUCT_LIST:return d("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LIST;default:return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}case"list_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.LIST_REPLY;case"buttons_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.BUTTON_RESPONSE_MESSAGE;case"order":return d("WAWebWamEnumMediaType").MEDIA_TYPE.ORDER;case"interactive":return h(a.interactiveType);case"reaction":case"reaction_enc":return d("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case"poll_creation":return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;case"poll_result_snapshot":return d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_RESULT_SNAPSHOT;case"poll_update":return a.subtype==="poll_vote"?d("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE:d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"keep_in_chat":return a.keepType===d("WAWebProtobufsE2E.pb").KeepType.KEEP_FOR_ALL?d("WAWebWamEnumMediaType").MEDIA_TYPE.KEEP:d("WAWebWamEnumMediaType").MEDIA_TYPE.UNKEEP;case"pin_message":return d("WAWebWamEnumMediaType").MEDIA_TYPE.PIN_IN_CHAT;case"protocol":return a.subtype==="ephemeral_sync_response"?d("WAWebWamEnumMediaType").MEDIA_TYPE.EPHEMERAL_SYNC_RESPONSE:d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"event_creation":return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_CREATE;case"event_response":return d("WAWebWamEnumMediaType").MEDIA_TYPE.EVENT_RESPOND;case"album":return d("WAWebWamEnumMediaType").MEDIA_TYPE.MEDIA_ALBUM;case"sticker-pack":return d("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;default:a.type;return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}}function h(a){if(a==null)return d("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;switch(a){case c("WAWebInteractiveMessageType").SHOPS_STOREFRONT:return d("WAWebWamEnumMediaType").MEDIA_TYPE.SHOP_STOREFRONT;case c("WAWebInteractiveMessageType").NATIVE_FLOW:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_NFM;case c("WAWebInteractiveMessageType").CAROUSEL:return d("WAWebWamEnumMediaType").MEDIA_TYPE.INTERACTIVE_CAROUSEL}}function f(a){if(!(a instanceof c("WAWebWid")))return null;return d("WAWebUserPrefsMeUser").isMeAccount(a)?a.isCompanion()?d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.MY_COMPANION:d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.MY_PRIMARY:a.isCompanion()?d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.OTHER_COMPANION:d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE.OTHER_PRIMARY}function i(a){if(a.id.remote.isBot())return d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT;var b=d("WAWebMsgGetters").getIsBotQuery(a);a=d("WAWebMsgGetters").getIsMetaBotResponse(a);return b||a?d("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED:null}function j(a,b,c){if(a!=null&&a.isBot())return d("WAWebWamEnumBotType").BOT_TYPE.METABOT;if(b){if(b===d("WAWebBotTypes").BizBotType.BIZ_1P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;if(b===d("WAWebBotTypes").BizBotType.BIZ_3P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}if(c){if(c===d("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_1P_BIZ;if(c===d("WAWebBotTypes").BizBotAutomatedType.FULL_3P)return d("WAWebWamEnumBotType").BOT_TYPE.BOT_3P_BIZ}return d("WAWebWamEnumBotType").BOT_TYPE.UNKNOWN}function k(a){if(a==null||a==="")return null;switch(a){case d("WAWebHandleMsgCommon").CATEGORY_PEER:return d("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE.PEER;default:return null}}function l(a,b,c){return b.isGroup()?Boolean(c):a.from.isLid()||a.to.isLid()}g.getWamMessageType=a;g.getMessageTypeFromMsgInfoType=b;g.getWamMediaType=e;g.getInteractiveWamType=h;g.getWamE2eSenderType=f;g.getWamAgentEngagementType=i;g.getWamBotType=j;g.getWamInvisibleMessageCatgoryType=k;g.msgIsLid=l}),98);
__d("WAWebOrderPaymentStatus",["$InternalEnum","WAWebE2EProtoUtils","WAWebInteractiveMessageType","WAWebMsgType"],(function(a,b,c,d,e,f,g){var h=-1e3;e=(a=b("$InternalEnum"))({Pending:"pending",Captured:"captured",Failed:"failed"});f=a({Confirm:"confirm",PaymentInstruction:"payment_instruction"});b=a({CPI:"cpi",PIX:"pix",NATIVE:"native",PAYMENT_LINK:"payment_link",BOLETO:"boleto"});a=a({P2M_LITE:"p2m_lite",P2M_PRO:"p2m_pro",P2M_BASIC:"p2m_basic"});var i=function(a){var b={};try{b=JSON.parse(a)}catch(a){return null}if(b==null)return null;a=b;b=a.reference_id;var c=a.payment_method;a=a.payment_status;return b==null||a==null&&c==null?null:{refId:b,paymentMethod:c,paymentStatus:a}},j=function(a){var b;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)&&(b=a.interactivePayload)!=null&&b.buttons){a=a.interactivePayload;a=a.buttons[0].buttonParamsJson;if(a!=null)return i(a)}return null},k=function(a){var b;return a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)&&(b=a.interactivePayload)!=null&&b.buttons?a.interactivePayload.buttons[0]:null},l=function(a){a=k(a);if(a==null)return null;var b=a.name;a=a.buttonParamsJson;return b!=null&&a!=null?i(a):null},m=function(a,b){a=a.msgs.getModelsArray().slice(h);var e=null;a=a.findLast(function(a){if(a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN&&a.subtype==="phone_only_feature"&&a.quotedMsg!=null){var f;e=j(a.quotedMsg);if(((f=e)==null?void 0:f.refId)===b)return!0}else if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName)){e=l(a);if(((f=e)==null?void 0:f.refId)===b)return!0}return!1});return a!=null&&e!=null?e:null};g.OrderPaymentStatus=e;g.OrderPaymentMethod=f;g.OrderAcceptedPaymentMethods=b;g.OrderP2MType=a;g.paramsJsonToOrderPaymentInfo=i;g.getOrderPaymentStatusInfo=j;g.getOrderPaymentStatusInfoFromNativeFlow=l;g.findLastOrderPaymentStatusInfo=m}),98);
__d("WAWebOrderStatus",["$InternalEnum","WAWebBizGatingUtils","WAWebE2EProtoUtils","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebOrderDetails","WAWebOrderPaymentStatus","WAWebOrderStatusButton"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Pending:"pending",Processing:"processing",PartiallyShipped:"partially_shipped",Shipped:"shipped",Complete:"completed",Canceled:"canceled",PaymentRequested:"payment_requested",PreparingToShip:"preparing_to_ship",Delivered:"delivered",Confirmed:"confirmed",Delayed:"delayed",OutForDelivery:"out_for_delivery",Failed:"failed",Refunded:"refunded"}),i=function(a){if(a==null)return null;try{a=JSON.parse(a);var b=a.order,c=a.payment;a=a.reference_id;b=h.cast(b==null?void 0:b.status);c=d("WAWebOrderPaymentStatus").OrderPaymentStatus.cast(c==null?void 0:c.status);return a==null||b==null?null:{refId:a,status:b,paymentStatus:c}}catch(a){return null}},j=function(a){var b;if(!d("WAWebE2EProtoUtils").isOrderNativeFlow(a.nativeFlowName))return null;if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW&&(b=a.interactivePayload)!=null&&b.buttons){var e=a.interactivePayload.buttons[0].buttonParamsJson;return i(e)}else if(a.type===d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW){a=((e=a.nativeFlowButtons)!=null?e:[])[0].nativeFlowInfo;return i(a==null?void 0:a.paramsJson)}};a=function(a){return d("WAWebOrderStatusButton").getOrderStatusButton(a)!=null};e=function(a){a=a.order;var b=a.tracking;a=a.status;return b!=null&&a!==h.Canceled&&a!==h.Refunded&&a!==h.Failed};f=function(a,b){a=a.msgs.getModelsArray().slice(-1e3);a=(a=a.findLast(function(a){return a.nativeFlowName!=null&&[c("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS,c("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO].includes(a.nativeFlowName)&&((a=d("WAWebOrderDetails").getOrderInfo(a))==null?void 0:a.referenceId)===b}))==null?void 0:a.safe();return a};var k=function(a,b){a=a.msgs.getModelsArray().slice(-1e3);a=(a=a.findLast(function(a){return(a==null?void 0:a.nativeFlowName)===c("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS&&((a=j(a))==null?void 0:a.refId)===b}))==null?void 0:a.safe();return a},l=function(a){if(a==null)return null;switch(a){case h.Complete:return d("WAWebOrderPaymentStatus").OrderPaymentStatus.Captured;case h.Canceled:case h.Failed:return d("WAWebOrderPaymentStatus").OrderPaymentStatus.Failed;default:return d("WAWebOrderPaymentStatus").OrderPaymentStatus.Pending}},m=function(a){return a==null?!1:a.items.length===0};b=function(a,b){return!a.contact.isEnterprise&&m(b)};var n=function(){return d("WAWebBizGatingUtils").isOrderStatusM1Enabled()?h.PaymentRequested:h.Pending},o=function(a,b){a=k(a,b);b=a!=null?j(a):null;return(a=b==null?void 0:b.status)!=null?a:h.Pending},p=function(a,b){a=k(a,b);b=a!=null?j(a):null;var c=b==null?void 0:b.paymentStatus;if(a!=null&&c==null){b=(a=b==null?void 0:b.status)!=null?a:h.Pending;c=l(b)}return c},q=function(a,b){a=a.msgs.reduce(function(a,c){var e=d("WAWebOrderStatusButton").getOrderStatusButton(c);c=c.safe();return e==null||c.type!==d("WAWebMsgType").MSG_TYPE.INTERACTIVE||e.reference_id!==b.reference_id?a:{first:(e=a.first)!=null?e:c,last:c}},{first:null,last:null});var c=a.first;a=a.last;var e=c&&d("WAWebOrderStatusButton").getOrderStatusButton(c),f=a&&d("WAWebOrderStatusButton").getOrderStatusButton(a);e=(e!=null?e:b).order.items;return{drawerButton:babelHelpers["extends"]({},f!=null?f:b,{order:babelHelpers["extends"]({},(f!=null?f:b).order,{items:e})}),messageBubbleButton:babelHelpers["extends"]({},b,{order:babelHelpers["extends"]({},b.order,{items:e})}),firstMessage:c,lastMessage:a}};g.OrderStatus=h;g.paramsJsonToOrderStatusInfo=i;g.getOrderStatusInfo=j;g.hasOrderStatusButton=a;g.shouldShowTrackingInfo=e;g.findOrderDetailsMessage=f;g.isSimplifiedOrder=m;g.isPaymentRequest=b;g.getDefaultOrderStatus=n;g.findOrderStatus=o;g.findOrderPaymentStatus=p;g.getMergedOrderStatus=q}),98);
__d("LoggingPaymentLinkWithoutPreviewFeature",["PaymentLink","WAWebLinkify","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){"use strict";function h(){return d("PaymentLink").shouldDetectInComposer()}function a(a,b,c){if(!h())return b;var e=a==null?void 0:a.psp;if(e==null&&a==null){a=d("WAWebLinkify").findLink(c,!1,d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow());e=a!=null?d("PaymentLink").getPSP(a.url):null}return e==null?b:babelHelpers["extends"]({},b,{provider:{paramsJson:JSON.stringify({name:e})}})}g.getMetadata=a}),98);
__d("PaymentLinkPSPImagePathMapper",["bx"],(function(a,b,c,d,e,f,g){"use strict";b=Object.freeze({"mercadopago-light":(a=c("bx")).getURL(a("32187")),"mercadopago-dark":a.getURL(a("32186"))});g.PaymentLinkPSPImagePathMapper=b}),98);
__d("WAWebPonyfillsCryptoRandomUUID",[],(function(a,b,c,d,e,f){function a(){return"randomUUID"in self.crypto?self.crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(a){return(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16)})}f["default"]=a}),66);
__d("PaymentLinkTraceIdLoggingFeature",["WALogger","WAWebABProps","WAWebMobilePlatforms","WAWebPonyfillsCryptoRandomUUID"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b;if(!d("WAWebMobilePlatforms").isSMB()||!d("WAWebABProps").getABPropConfigValue("payment_link_trace_id_logging_enabled"))return a;var e=a==null||(b=a.provider)==null?void 0:b.paramsJson;try{if(e==null)return a;e=JSON.parse(e);e=babelHelpers["extends"]({},e,{payment_link_trace_id:c("WAWebPonyfillsCryptoRandomUUID")().toLowerCase()});return babelHelpers["extends"]({},a,{provider:{paramsJson:JSON.stringify(e)}})}catch(b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[PAYMENT LINK TRACE ID LOGGING] error while parsing paramsJson from payment link metadata: ",""])),b).sendLogs("[PAYMENT LINK TRACE ID LOGGING] error while parsing paramsJson from payment link metadata");return a}}g.setTraceId=a}),98);
__d("PaymentLink",["LoggingPaymentLinkWithoutPreviewFeature","PaymentLinkPSPImagePathMapper","PaymentLinkPreviewWithTrustSignalsFeature","PaymentLinkTraceIdLoggingFeature","PaymentLinkWithCTAFeature","WAWebABProps","WAWebMobilePlatforms"],(function(a,b,c,d,e,f,g){"use strict";f="Open payment link";function a(a,b){if(a==null)return null;a=a+(b?"-dark":"-light");return Object.prototype.hasOwnProperty.call(d("PaymentLinkPSPImagePathMapper").PaymentLinkPSPImagePathMapper,a)?d("PaymentLinkPSPImagePathMapper").PaymentLinkPSPImagePathMapper[a]:null}function b(a){var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("smb_payment_links_url_regex_list"));for(var c in b)if(a.match(c))return b[c];return null}function h(){return d("WAWebMobilePlatforms").isSMB()}function c(a,b){var c=null;c=d("PaymentLinkWithCTAFeature").getMetadata(a,c);c=d("LoggingPaymentLinkWithoutPreviewFeature").getMetadata(a,c,b);c=d("PaymentLinkPreviewWithTrustSignalsFeature").setMetadata(a,c,b);c=d("PaymentLinkTraceIdLoggingFeature").setTraceId(c);return c}function e(a){var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("smb_payment_links_url_regex_list"));for(var c in b)if(a.match(c))return{psp:b[c],shouldDetectInComposer:h()};return null}g.CTA_TEXT=f;g.getPSPIconPath=a;g.getPSP=b;g.shouldDetectInComposer=h;g.getPaymentLinkMessageMetadata=c;g.getPaymentLinkUrlMetaData=e}),98);
__d("PaymentLinkPreviewWithTrustSignalsFeature",["WALogger","WAWebABProps","WAWebLinkify","WAWebMobilePlatforms","WAWebMsgGetters","WAWebUserPrefsMeUser"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return d("WAWebMsgGetters").getHasPaymentLinkTrustSignals(a)}function j(a,b,c,e){if(a==null&&b==null)return!1;if(b==null||b.length===0)return!0;if(a!==!0)return!0;b=c==null?void 0:c.psp;if(b==null)return!1;if(!k(b))return!1;a=d("WAWebLinkify").findLinks(e,!1,d("WAWebUserPrefsMeUser").getMeDevicePnOrThrow());if(a.length!==1)return!1;return d("WAWebABProps").getABPropConfigValue("payment_br_holdout")?!1:d("WAWebABProps").getABPropConfigValue("payment_links_trust_signals_metatag_enabled")}function k(a){try{var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("payment_links_trust_signals_metatag_psp_list"));b=b==null?void 0:b.psp;return!Array.isArray(b)?!1:b.includes(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[PAYMENT LINK WITH TRUST SIGNALS] error while parsing json for ab prop payment_links_trust_signals_metatag_psp_list: ",""])),a);return!1}}function b(a,b,c){var e;if(!d("WAWebMobilePlatforms").isSMB())return b;var f=a==null?void 0:a.previewMetadata;if(f==null)return b;var g=f.isBusinessVerified;f=(f=f.providerName)==null?void 0:f.trim();if(!j(g,f,a,c))return b;a=b==null||(e=b.provider)==null?void 0:e.paramsJson;try{c=a==null?null:JSON.parse(a);if(g!=null){c=babelHelpers["extends"]({},c,{meta_tags:babelHelpers["extends"]({},(a=c)==null?void 0:a.meta_tags,{is_business_verified:g})})}if(f!=null&&f.length>0){c=babelHelpers["extends"]({},c,{meta_tags:babelHelpers["extends"]({},(a=c)==null?void 0:a.meta_tags,{provider_name:f})})}return c==null?b:babelHelpers["extends"]({},b,{provider:{paramsJson:JSON.stringify(c)}})}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[PAYMENT LINK WITH TRUST SIGNALS] error while parsing paramsJson from payment link metadata: ",""])),a);return b}}g.shouldShowPaymentLinkTrustSignals=a;g.isPSPInTrustSignalsFeatureAllowlist=k;g.setMetadata=b}),98);
__d("PaymentLinkWithCTAFeature",["$InternalEnum","PaymentLink","WALogger","WAWebABProps","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum")({LINK_PREVIEW_HEADER_WITH_CTA:0,ORDER_HEADER_WITH_CTA:1,DEFAULT:2});function a(a){var b;return j()?!1:(a==null||(b=a.header)==null?void 0:b.headerType)===d("WAWebProtobufsE2E.pb").Message$PaymentLinkMetadata$PaymentLinkHeader$PaymentLinkHeaderType.ORDER}function j(){return d("WAWebABProps").getABPropConfigValue("smb_payment_links_cta_button_kill_switch")}function k(a){if(j())return i.DEFAULT;try{var b=JSON.parse(d("WAWebABProps").getABPropConfigValue("smb_payment_links_cta_psp_list"));b=b==null?void 0:b.psp;if(!Array.isArray(b)||(b==null?void 0:b.includes(a))===!1)return i.DEFAULT}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[PAYMENT LINK WITH CTA] error while parsing json for ab prop smb_payment_links_cta_psp_list: ",""])),a);return i.DEFAULT}return d("WAWebABProps").getABPropConfigValue("payment_br_holdout")?i.DEFAULT:(b=i.cast(d("WAWebABProps").getABPropConfigValue("smb_payment_links_cta_variant")))!=null?b:i.DEFAULT}function c(a,b){a=a==null?void 0:a.psp;if(a==null)return b;a=k(a);switch(a){case i.LINK_PREVIEW_HEADER_WITH_CTA:return babelHelpers["extends"]({},b,{button:{displayText:d("PaymentLink").CTA_TEXT},header:{headerType:d("WAWebProtobufsE2E.pb").Message$PaymentLinkMetadata$PaymentLinkHeader$PaymentLinkHeaderType.LINK_PREVIEW}});case i.ORDER_HEADER_WITH_CTA:return babelHelpers["extends"]({},b,{button:{displayText:d("PaymentLink").CTA_TEXT},header:{headerType:d("WAWebProtobufsE2E.pb").Message$PaymentLinkMetadata$PaymentLinkHeader$PaymentLinkHeaderType.ORDER}});case i.DEFAULT:return b}}g.PaymentLinkVariant=i;g.shouldShowPaymentLinkOrderHeader=a;g.isKillSwitchEnabled=j;g.getMetadata=c}),98);
__d("WAWebProtobufsUserPassword.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,PBKDF2_HMAC_SHA512:1,PBKDF2_HMAC_SHA384:2});c=b("$InternalEnum")({UTF8:0,UTF8_BROKEN:1});e={};f={};b={};e.name="UserPassword";e.internalSpec={encoding:[1,(d=d("WAProtoConst")).TYPES.ENUM,c],transformer:[2,d.TYPES.ENUM,a],transformerArg:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,f],transformedData:[4,d.TYPES.BYTES]};f.name="UserPassword$TransformerArg";f.internalSpec={key:[1,d.TYPES.STRING],value:[2,d.TYPES.MESSAGE,b]};b.name="UserPassword$TransformerArg$Value";b.internalSpec={asBlob:[1,d.TYPES.BYTES],asUnsignedInteger:[2,d.TYPES.UINT32],__oneofs__:{value:["asBlob","asUnsignedInteger"]}};g.UserPassword$Transformer=a;g.UserPassword$Encoding=c;g.UserPasswordSpec=e;g.UserPassword$TransformerArgSpec=f;g.UserPassword$TransformerArg$ValueSpec=b}),98);
__d("WAWebProtobufsChatLockSettings.pb",["WAProtoConst","WAWebProtobufsUserPassword.pb"],(function(a,b,c,d,e,f,g){a={};a.name="ChatLockSettings";a.internalSpec={hideLockedChats:[1,d("WAProtoConst").TYPES.BOOL],secretCode:[2,d("WAProtoConst").TYPES.MESSAGE,d("WAWebProtobufsUserPassword.pb").UserPasswordSpec]};g.ChatLockSettingsSpec=a}),98);
__d("WAWebProtobufsDeviceCapabilities.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({NONE:0,MINIMAL:1,FULL:2});c={};e={};f={};b={};c.name="DeviceCapabilities";c.internalSpec={chatLockSupportLevel:[1,(d=d("WAProtoConst")).TYPES.ENUM,a],lidMigration:[2,d.TYPES.MESSAGE,b],businessBroadcast:[3,d.TYPES.MESSAGE,f],userHasAvatar:[4,d.TYPES.MESSAGE,e]};e.name="DeviceCapabilities$UserHasAvatar";e.internalSpec={userHasAvatar:[1,d.TYPES.BOOL]};f.name="DeviceCapabilities$BusinessBroadcast";f.internalSpec={importListEnabled:[1,d.TYPES.BOOL]};b.name="DeviceCapabilities$LIDMigration";b.internalSpec={chatDbMigrationTimestamp:[1,d.TYPES.UINT64]};g.DeviceCapabilities$ChatLockSupportLevel=a;g.DeviceCapabilitiesSpec=c;g.DeviceCapabilities$UserHasAvatarSpec=e;g.DeviceCapabilities$BusinessBroadcastSpec=f;g.DeviceCapabilities$LIDMigrationSpec=b}),98);
__d("WAWebProtobufSyncAction.pb",["$InternalEnum","WAProtoConst","WAWebProtobufsChatLockSettings.pb","WAWebProtobufsDeviceCapabilities.pb","WAWebProtobufsProtocol.pb"],(function(a,b,aa,c,ba,d,e){var f;aa=(a=b("$InternalEnum"))({REGULAR:0,SCHEDULED_CALL:1,VOICE_CHAT:2});ba=a({NONE:0,SCHEDULED:1,PRIVACY:2,LIGHTWEIGHT:3});d=a({CONNECTED:0,REJECTED:1,CANCELLED:2,ACCEPTEDELSEWHERE:3,MISSED:4,INVALID:5,UNAVAILABLE:6,UPCOMING:7,FAILED:8,ABANDONED:9,ONGOING:10});b=a({ENABLED:0,DISABLED:1});var ca=a({UPDATED:0,CREATED:1,DELETED:2}),da=a({ENABLED:0,ENABLED_HAS_LEARNING:1,DISABLED:2}),ea=a({BR_PAY_PRIVACY_POLICY:0}),fa=a({DEFAULT_ALL_MESSAGES:0,ALL_MESSAGES:1,HIGHLIGHTS:2,DEFAULT_HIGHLIGHTS:3}),ga=a({ACTIVE:0,PAUSED:1,UNLINKED:2}),ha=a({ACTIVE:0,INACTIVE:1}),ia=a({UNSTRUCTURED:1,STRUCTURED:2}),ja=a({ALLOW_LIST:0,DENY_LIST:1,CONTACTS:2,CLOSE_FRIENDS:3}),ka=a({PERSONALIZED:0}),la=a({LID:1,PN:2}),ma=a({NONE:0,UNREAD:1,GROUPS:2,FAVORITES:3,PREDEFINED:4,CUSTOM:5,COMMUNITY:6,SERVER_ASSIGNED:7});a=a({ANDROID:0,SMBA:1,IPHONE:2,SMBI:3,WEB:4,UWP:5,DARWIN:6,IPAD:7,WEAROS:8,WASG:9,WEARM:10,CAPI:11});var g={},h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={},na={},oa={},pa={},qa={},ra={},sa={},ta={},ua={},va={},wa={},$={},xa={},ya={},za={},Aa={},Ba={},Ca={},Da={},Ea={},Fa={},Ga={},Ha={},Ia={},Ja={},Ka={},La={},Ma={},Na={},Oa={};g.name="RecentEmojiWeight";g.internalSpec={emoji:[1,(f=c("WAProtoConst")).TYPES.STRING],weight:[2,f.TYPES.FLOAT]};h.name="CallLogRecord";h.internalSpec={callResult:[1,f.TYPES.ENUM,d],isDndMode:[2,f.TYPES.BOOL],silenceReason:[3,f.TYPES.ENUM,ba],duration:[4,f.TYPES.INT64],startTime:[5,f.TYPES.INT64],isIncoming:[6,f.TYPES.BOOL],isVideo:[7,f.TYPES.BOOL],isCallLink:[8,f.TYPES.BOOL],callLinkToken:[9,f.TYPES.STRING],scheduledCallId:[10,f.TYPES.STRING],callId:[11,f.TYPES.STRING],callCreatorJid:[12,f.TYPES.STRING],groupJid:[13,f.TYPES.STRING],participants:[14,f.FLAGS.REPEATED|f.TYPES.MESSAGE,i],callType:[15,f.TYPES.ENUM,aa]};i.name="CallLogRecord$ParticipantInfo";i.internalSpec={userJid:[1,f.TYPES.STRING],callResult:[2,f.TYPES.ENUM,d]};j.name="SyncActionValue";j.internalSpec={timestamp:[1,f.TYPES.INT64],starAction:[2,f.TYPES.MESSAGE,Ma],contactAction:[3,f.TYPES.MESSAGE,La],muteAction:[4,f.TYPES.MESSAGE,Ka],pinAction:[5,f.TYPES.MESSAGE,Ja],pushNameSetting:[7,f.TYPES.MESSAGE,Ia],quickReplyAction:[8,f.TYPES.MESSAGE,Ga],recentEmojiWeightsAction:[11,f.TYPES.MESSAGE,Da],labelEditAction:[14,f.TYPES.MESSAGE,Ea],labelAssociationAction:[15,f.TYPES.MESSAGE,Fa],localeSetting:[16,f.TYPES.MESSAGE,Ha],archiveChatAction:[17,f.TYPES.MESSAGE,Ca],deleteMessageForMeAction:[18,f.TYPES.MESSAGE,Ba],keyExpiration:[19,f.TYPES.MESSAGE,va],markChatAsReadAction:[20,f.TYPES.MESSAGE,Aa],clearChatAction:[21,f.TYPES.MESSAGE,za],deleteChatAction:[22,f.TYPES.MESSAGE,ya],unarchiveChatsSetting:[23,f.TYPES.MESSAGE,xa],primaryFeature:[24,f.TYPES.MESSAGE,ua],androidUnsupportedActions:[26,f.TYPES.MESSAGE,ta],agentAction:[27,f.TYPES.MESSAGE,sa],subscriptionAction:[28,f.TYPES.MESSAGE,ra],userStatusMuteAction:[29,f.TYPES.MESSAGE,qa],timeFormatAction:[30,f.TYPES.MESSAGE,pa],nuxAction:[31,f.TYPES.MESSAGE,oa],primaryVersionAction:[32,f.TYPES.MESSAGE,na],stickerAction:[33,f.TYPES.MESSAGE,Y],removeRecentStickerAction:[34,f.TYPES.MESSAGE,Z],chatAssignment:[35,f.TYPES.MESSAGE,X],chatAssignmentOpenedStatus:[36,f.TYPES.MESSAGE,W],pnForLidChatAction:[37,f.TYPES.MESSAGE,V],marketingMessageAction:[38,f.TYPES.MESSAGE,T],marketingMessageBroadcastAction:[39,f.TYPES.MESSAGE,S],externalWebBetaAction:[40,f.TYPES.MESSAGE,R],privacySettingRelayAllCalls:[41,f.TYPES.MESSAGE,P],callLogAction:[42,f.TYPES.MESSAGE,O],ugcBot:[43,f.TYPES.MESSAGE,N],statusPrivacy:[44,f.TYPES.MESSAGE,M],botWelcomeRequestAction:[45,f.TYPES.MESSAGE,K],deleteIndividualCallLog:[46,f.TYPES.MESSAGE,J],labelReorderingAction:[47,f.TYPES.MESSAGE,I],paymentInfoAction:[48,f.TYPES.MESSAGE,H],customPaymentMethodsAction:[49,f.TYPES.MESSAGE,E],lockChatAction:[50,f.TYPES.MESSAGE,D],chatLockSettings:[51,f.TYPES.MESSAGE,c("WAWebProtobufsChatLockSettings.pb").ChatLockSettingsSpec],wamoUserIdentifierAction:[52,f.TYPES.MESSAGE,C],privacySettingDisableLinkPreviewsAction:[53,f.TYPES.MESSAGE,B],deviceCapabilities:[54,f.TYPES.MESSAGE,c("WAWebProtobufsDeviceCapabilities.pb").DeviceCapabilitiesSpec],noteEditAction:[55,f.TYPES.MESSAGE,z],favoritesAction:[56,f.TYPES.MESSAGE,x],merchantPaymentPartnerAction:[57,f.TYPES.MESSAGE,w],waffleAccountLinkStateAction:[58,f.TYPES.MESSAGE,v],usernameChatStartMode:[59,f.TYPES.MESSAGE,U],notificationActivitySettingAction:[60,f.TYPES.MESSAGE,u],lidContactAction:[61,f.TYPES.MESSAGE,t],ctwaPerCustomerDataSharingAction:[62,f.TYPES.MESSAGE,s],paymentTosAction:[63,f.TYPES.MESSAGE,r],privacySettingChannelsPersonalisedRecommendationAction:[64,f.TYPES.MESSAGE,A],businessBroadcastAssociationAction:[65,f.TYPES.MESSAGE,q],detectedOutcomesStatusAction:[66,f.TYPES.MESSAGE,Q],maibaAiFeaturesControlAction:[68,f.TYPES.MESSAGE,n],businessBroadcastListAction:[69,f.TYPES.MESSAGE,p],musicUserIdAction:[70,f.TYPES.MESSAGE,L],statusPostOptInNotificationPreferencesAction:[71,f.TYPES.MESSAGE,m],avatarUpdatedAction:[72,f.TYPES.MESSAGE,l],privateProcessingSettingAction:[74,f.TYPES.MESSAGE,k]};k.name="SyncActionValue$PrivateProcessingSettingAction";k.internalSpec={privateProcessingStatus:[1,f.TYPES.ENUM,b]};l.name="SyncActionValue$AvatarUpdatedAction";l.internalSpec={eventType:[1,f.TYPES.ENUM,ca],recentAvatarStickers:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,Y]};m.name="SyncActionValue$StatusPostOptInNotificationPreferencesAction";m.internalSpec={enabled:[1,f.TYPES.BOOL]};n.name="SyncActionValue$MaibaAIFeaturesControlAction";n.internalSpec={aiFeatureStatus:[1,f.TYPES.ENUM,da]};o.name="SyncActionValue$BroadcastListParticipant";o.internalSpec={lidJid:[1,f.FLAGS.REQUIRED|f.TYPES.STRING],pnJid:[2,f.TYPES.STRING]};p.name="SyncActionValue$BusinessBroadcastListAction";p.internalSpec={deleted:[1,f.TYPES.BOOL],participants:[2,f.FLAGS.REPEATED|f.TYPES.MESSAGE,o],listName:[3,f.TYPES.STRING]};q.name="SyncActionValue$BusinessBroadcastAssociationAction";q.internalSpec={deleted:[1,f.TYPES.BOOL]};r.name="SyncActionValue$PaymentTosAction";r.internalSpec={paymentNotice:[1,f.FLAGS.REQUIRED|f.TYPES.ENUM,ea],accepted:[2,f.FLAGS.REQUIRED|f.TYPES.BOOL]};s.name="SyncActionValue$CtwaPerCustomerDataSharingAction";s.internalSpec={isCtwaPerCustomerDataSharingEnabled:[1,f.TYPES.BOOL]};t.name="SyncActionValue$LidContactAction";t.internalSpec={fullName:[1,f.TYPES.STRING],firstName:[2,f.TYPES.STRING],username:[3,f.TYPES.STRING]};u.name="SyncActionValue$NotificationActivitySettingAction";u.internalSpec={notificationActivitySetting:[1,f.TYPES.ENUM,fa]};v.name="SyncActionValue$WaffleAccountLinkStateAction";v.internalSpec={linkState:[2,f.TYPES.ENUM,ga]};w.name="SyncActionValue$MerchantPaymentPartnerAction";w.internalSpec={status:[1,f.FLAGS.REQUIRED|f.TYPES.ENUM,ha],country:[2,f.FLAGS.REQUIRED|f.TYPES.STRING],gatewayName:[3,f.TYPES.STRING],credentialId:[4,f.TYPES.STRING]};x.name="SyncActionValue$FavoritesAction";x.internalSpec={favorites:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,y]};y.name="SyncActionValue$FavoritesAction$Favorite";y.internalSpec={id:[1,f.TYPES.STRING]};z.name="SyncActionValue$NoteEditAction";z.internalSpec={type:[1,f.TYPES.ENUM,ia],chatJid:[2,f.TYPES.STRING],createdAt:[3,f.TYPES.INT64],deleted:[4,f.TYPES.BOOL],unstructuredContent:[5,f.TYPES.STRING]};A.name="SyncActionValue$PrivacySettingChannelsPersonalisedRecommendationAction";A.internalSpec={isUserOptedOut:[1,f.TYPES.BOOL]};B.name="SyncActionValue$PrivacySettingDisableLinkPreviewsAction";B.internalSpec={isPreviewsDisabled:[1,f.TYPES.BOOL]};C.name="SyncActionValue$WamoUserIdentifierAction";C.internalSpec={identifier:[1,f.TYPES.STRING]};D.name="SyncActionValue$LockChatAction";D.internalSpec={locked:[1,f.TYPES.BOOL]};E.name="SyncActionValue$CustomPaymentMethodsAction";E.internalSpec={customPaymentMethods:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,F]};F.name="SyncActionValue$CustomPaymentMethod";F.internalSpec={credentialId:[1,f.FLAGS.REQUIRED|f.TYPES.STRING],country:[2,f.FLAGS.REQUIRED|f.TYPES.STRING],type:[3,f.FLAGS.REQUIRED|f.TYPES.STRING],metadata:[4,f.FLAGS.REPEATED|f.TYPES.MESSAGE,G]};G.name="SyncActionValue$CustomPaymentMethodMetadata";G.internalSpec={key:[1,f.FLAGS.REQUIRED|f.TYPES.STRING],value:[2,f.FLAGS.REQUIRED|f.TYPES.STRING]};H.name="SyncActionValue$PaymentInfoAction";H.internalSpec={cpi:[1,f.TYPES.STRING]};I.name="SyncActionValue$LabelReorderingAction";I.internalSpec={sortedLabelIds:[1,f.FLAGS.REPEATED|f.TYPES.INT32]};J.name="SyncActionValue$DeleteIndividualCallLogAction";J.internalSpec={peerJid:[1,f.TYPES.STRING],isIncoming:[2,f.TYPES.BOOL]};K.name="SyncActionValue$BotWelcomeRequestAction";K.internalSpec={isSent:[1,f.TYPES.BOOL]};L.name="SyncActionValue$MusicUserIdAction";L.internalSpec={musicUserId:[1,f.TYPES.STRING]};M.name="SyncActionValue$StatusPrivacyAction";M.internalSpec={mode:[1,f.TYPES.ENUM,ja],userJid:[2,f.FLAGS.REPEATED|f.TYPES.STRING]};N.name="SyncActionValue$UGCBot";N.internalSpec={definition:[1,f.TYPES.BYTES]};O.name="SyncActionValue$CallLogAction";O.internalSpec={callLogRecord:[1,f.TYPES.MESSAGE,h]};P.name="SyncActionValue$PrivacySettingRelayAllCalls";P.internalSpec={isEnabled:[1,f.TYPES.BOOL]};Q.name="SyncActionValue$DetectedOutcomesStatusAction";Q.internalSpec={isEnabled:[1,f.TYPES.BOOL]};R.name="SyncActionValue$ExternalWebBetaAction";R.internalSpec={isOptIn:[1,f.TYPES.BOOL]};S.name="SyncActionValue$MarketingMessageBroadcastAction";S.internalSpec={repliedCount:[1,f.TYPES.INT32]};T.name="SyncActionValue$MarketingMessageAction";T.internalSpec={name:[1,f.TYPES.STRING],message:[2,f.TYPES.STRING],type:[3,f.TYPES.ENUM,ka],createdAt:[4,f.TYPES.INT64],lastSentAt:[5,f.TYPES.INT64],isDeleted:[6,f.TYPES.BOOL],mediaId:[7,f.TYPES.STRING]};U.name="SyncActionValue$UsernameChatStartModeAction";U.internalSpec={chatStartMode:[1,f.TYPES.ENUM,la]};V.name="SyncActionValue$PnForLidChatAction";V.internalSpec={pnJid:[1,f.TYPES.STRING]};W.name="SyncActionValue$ChatAssignmentOpenedStatusAction";W.internalSpec={chatOpened:[1,f.TYPES.BOOL]};X.name="SyncActionValue$ChatAssignmentAction";X.internalSpec={deviceAgentID:[1,f.TYPES.STRING]};Y.name="SyncActionValue$StickerAction";Y.internalSpec={url:[1,f.TYPES.STRING],fileEncSha256:[2,f.TYPES.BYTES],mediaKey:[3,f.TYPES.BYTES],mimetype:[4,f.TYPES.STRING],height:[5,f.TYPES.UINT32],width:[6,f.TYPES.UINT32],directPath:[7,f.TYPES.STRING],fileLength:[8,f.TYPES.UINT64],isFavorite:[9,f.TYPES.BOOL],deviceIdHint:[10,f.TYPES.UINT32],isLottie:[11,f.TYPES.BOOL],imageHash:[12,f.TYPES.STRING],isAvatarSticker:[13,f.TYPES.BOOL]};Z.name="SyncActionValue$RemoveRecentStickerAction";Z.internalSpec={lastStickerSentTs:[1,f.TYPES.INT64]};na.name="SyncActionValue$PrimaryVersionAction";na.internalSpec={version:[1,f.TYPES.STRING]};oa.name="SyncActionValue$NuxAction";oa.internalSpec={acknowledged:[1,f.TYPES.BOOL]};pa.name="SyncActionValue$TimeFormatAction";pa.internalSpec={isTwentyFourHourFormatEnabled:[1,f.TYPES.BOOL]};qa.name="SyncActionValue$UserStatusMuteAction";qa.internalSpec={muted:[1,f.TYPES.BOOL]};ra.name="SyncActionValue$SubscriptionAction";ra.internalSpec={isDeactivated:[1,f.TYPES.BOOL],isAutoRenewing:[2,f.TYPES.BOOL],expirationDate:[3,f.TYPES.INT64]};sa.name="SyncActionValue$AgentAction";sa.internalSpec={name:[1,f.TYPES.STRING],deviceID:[2,f.TYPES.INT32],isDeleted:[3,f.TYPES.BOOL]};ta.name="SyncActionValue$AndroidUnsupportedActions";ta.internalSpec={allowed:[1,f.TYPES.BOOL]};ua.name="SyncActionValue$PrimaryFeature";ua.internalSpec={flags:[1,f.FLAGS.REPEATED|f.TYPES.STRING]};va.name="SyncActionValue$KeyExpiration";va.internalSpec={expiredKeyEpoch:[1,f.TYPES.INT32]};wa.name="SyncActionValue$SyncActionMessage";wa.internalSpec={key:[1,f.TYPES.MESSAGE,c("WAWebProtobufsProtocol.pb").MessageKeySpec],timestamp:[2,f.TYPES.INT64]};$.name="SyncActionValue$SyncActionMessageRange";$.internalSpec={lastMessageTimestamp:[1,f.TYPES.INT64],lastSystemMessageTimestamp:[2,f.TYPES.INT64],messages:[3,f.FLAGS.REPEATED|f.TYPES.MESSAGE,wa]};xa.name="SyncActionValue$UnarchiveChatsSetting";xa.internalSpec={unarchiveChats:[1,f.TYPES.BOOL]};ya.name="SyncActionValue$DeleteChatAction";ya.internalSpec={messageRange:[1,f.TYPES.MESSAGE,$]};za.name="SyncActionValue$ClearChatAction";za.internalSpec={messageRange:[1,f.TYPES.MESSAGE,$]};Aa.name="SyncActionValue$MarkChatAsReadAction";Aa.internalSpec={read:[1,f.TYPES.BOOL],messageRange:[2,f.TYPES.MESSAGE,$]};Ba.name="SyncActionValue$DeleteMessageForMeAction";Ba.internalSpec={deleteMedia:[1,f.TYPES.BOOL],messageTimestamp:[2,f.TYPES.INT64]};Ca.name="SyncActionValue$ArchiveChatAction";Ca.internalSpec={archived:[1,f.TYPES.BOOL],messageRange:[2,f.TYPES.MESSAGE,$]};Da.name="SyncActionValue$RecentEmojiWeightsAction";Da.internalSpec={weights:[1,f.FLAGS.REPEATED|f.TYPES.MESSAGE,g]};Ea.name="SyncActionValue$LabelEditAction";Ea.internalSpec={name:[1,f.TYPES.STRING],color:[2,f.TYPES.INT32],predefinedId:[3,f.TYPES.INT32],deleted:[4,f.TYPES.BOOL],orderIndex:[5,f.TYPES.INT32],isActive:[6,f.TYPES.BOOL],type:[7,f.TYPES.ENUM,ma],isImmutable:[8,f.TYPES.BOOL]};Fa.name="SyncActionValue$LabelAssociationAction";Fa.internalSpec={labeled:[1,f.TYPES.BOOL]};Ga.name="SyncActionValue$QuickReplyAction";Ga.internalSpec={shortcut:[1,f.TYPES.STRING],message:[2,f.TYPES.STRING],keywords:[3,f.FLAGS.REPEATED|f.TYPES.STRING],count:[4,f.TYPES.INT32],deleted:[5,f.TYPES.BOOL]};Ha.name="SyncActionValue$LocaleSetting";Ha.internalSpec={locale:[1,f.TYPES.STRING]};Ia.name="SyncActionValue$PushNameSetting";Ia.internalSpec={name:[1,f.TYPES.STRING]};Ja.name="SyncActionValue$PinAction";Ja.internalSpec={pinned:[1,f.TYPES.BOOL]};Ka.name="SyncActionValue$MuteAction";Ka.internalSpec={muted:[1,f.TYPES.BOOL],muteEndTimestamp:[2,f.TYPES.INT64],autoMuted:[3,f.TYPES.BOOL]};La.name="SyncActionValue$ContactAction";La.internalSpec={fullName:[1,f.TYPES.STRING],firstName:[2,f.TYPES.STRING],lidJid:[3,f.TYPES.STRING],saveOnPrimaryAddressbook:[4,f.TYPES.BOOL],pnJid:[5,f.TYPES.STRING],username:[6,f.TYPES.STRING]};Ma.name="SyncActionValue$StarAction";Ma.internalSpec={starred:[1,f.TYPES.BOOL]};Na.name="SyncActionData";Na.internalSpec={index:[1,f.TYPES.BYTES],value:[2,f.TYPES.MESSAGE,j],padding:[3,f.TYPES.BYTES],version:[4,f.TYPES.INT32]};Oa.name="PatchDebugData";Oa.internalSpec={currentLthash:[1,f.TYPES.BYTES],newLthash:[2,f.TYPES.BYTES],patchVersion:[3,f.TYPES.BYTES],collectionName:[4,f.TYPES.BYTES],firstFourBytesFromAHashOfSnapshotMacKey:[5,f.TYPES.BYTES],newLthashSubtract:[6,f.TYPES.BYTES],numberAdd:[7,f.TYPES.INT32],numberRemove:[8,f.TYPES.INT32],numberOverride:[9,f.TYPES.INT32],senderPlatform:[10,f.TYPES.ENUM,a],isSenderPrimary:[11,f.TYPES.BOOL]};e.CallLogRecord$CallType=aa;e.CallLogRecord$SilenceReason=ba;e.CallLogRecord$CallResult=d;e.SyncActionValue$PrivateProcessingSettingAction$PrivateProcessingStatus=b;e.SyncActionValue$AvatarUpdatedAction$AvatarEventType=ca;e.SyncActionValue$MaibaAIFeaturesControlAction$MaibaAIFeatureStatus=da;e.SyncActionValue$PaymentTosAction$PaymentNotice=ea;e.SyncActionValue$NotificationActivitySettingAction$NotificationActivitySetting=fa;e.SyncActionValue$WaffleAccountLinkStateAction$AccountLinkState=ga;e.SyncActionValue$MerchantPaymentPartnerAction$Status=ha;e.SyncActionValue$NoteEditAction$NoteType=ia;e.SyncActionValue$StatusPrivacyAction$StatusDistributionMode=ja;e.SyncActionValue$MarketingMessageAction$MarketingMessagePrototypeType=ka;e.SyncActionValue$UsernameChatStartModeAction$ChatStartMode=la;e.SyncActionValue$LabelEditAction$ListType=ma;e.PatchDebugData$Platform=a;e.RecentEmojiWeightSpec=g;e.CallLogRecordSpec=h;e.CallLogRecord$ParticipantInfoSpec=i;e.SyncActionValueSpec=j;e.SyncActionValue$PrivateProcessingSettingActionSpec=k;e.SyncActionValue$AvatarUpdatedActionSpec=l;e.SyncActionValue$StatusPostOptInNotificationPreferencesActionSpec=m;e.SyncActionValue$MaibaAIFeaturesControlActionSpec=n;e.SyncActionValue$BroadcastListParticipantSpec=o;e.SyncActionValue$BusinessBroadcastListActionSpec=p;e.SyncActionValue$BusinessBroadcastAssociationActionSpec=q;e.SyncActionValue$PaymentTosActionSpec=r;e.SyncActionValue$CtwaPerCustomerDataSharingActionSpec=s;e.SyncActionValue$LidContactActionSpec=t;e.SyncActionValue$NotificationActivitySettingActionSpec=u;e.SyncActionValue$WaffleAccountLinkStateActionSpec=v;e.SyncActionValue$MerchantPaymentPartnerActionSpec=w;e.SyncActionValue$FavoritesActionSpec=x;e.SyncActionValue$FavoritesAction$FavoriteSpec=y;e.SyncActionValue$NoteEditActionSpec=z;e.SyncActionValue$PrivacySettingChannelsPersonalisedRecommendationActionSpec=A;e.SyncActionValue$PrivacySettingDisableLinkPreviewsActionSpec=B;e.SyncActionValue$WamoUserIdentifierActionSpec=C;e.SyncActionValue$LockChatActionSpec=D;e.SyncActionValue$CustomPaymentMethodsActionSpec=E;e.SyncActionValue$CustomPaymentMethodSpec=F;e.SyncActionValue$CustomPaymentMethodMetadataSpec=G;e.SyncActionValue$PaymentInfoActionSpec=H;e.SyncActionValue$LabelReorderingActionSpec=I;e.SyncActionValue$DeleteIndividualCallLogActionSpec=J;e.SyncActionValue$BotWelcomeRequestActionSpec=K;e.SyncActionValue$MusicUserIdActionSpec=L;e.SyncActionValue$StatusPrivacyActionSpec=M;e.SyncActionValue$UGCBotSpec=N;e.SyncActionValue$CallLogActionSpec=O;e.SyncActionValue$PrivacySettingRelayAllCallsSpec=P;e.SyncActionValue$DetectedOutcomesStatusActionSpec=Q;e.SyncActionValue$ExternalWebBetaActionSpec=R;e.SyncActionValue$MarketingMessageBroadcastActionSpec=S;e.SyncActionValue$MarketingMessageActionSpec=T;e.SyncActionValue$UsernameChatStartModeActionSpec=U;e.SyncActionValue$PnForLidChatActionSpec=V;e.SyncActionValue$ChatAssignmentOpenedStatusActionSpec=W;e.SyncActionValue$ChatAssignmentActionSpec=X;e.SyncActionValue$StickerActionSpec=Y;e.SyncActionValue$RemoveRecentStickerActionSpec=Z;e.SyncActionValue$PrimaryVersionActionSpec=na;e.SyncActionValue$NuxActionSpec=oa;e.SyncActionValue$TimeFormatActionSpec=pa;e.SyncActionValue$UserStatusMuteActionSpec=qa;e.SyncActionValue$SubscriptionActionSpec=ra;e.SyncActionValue$AgentActionSpec=sa;e.SyncActionValue$AndroidUnsupportedActionsSpec=ta;e.SyncActionValue$PrimaryFeatureSpec=ua;e.SyncActionValue$KeyExpirationSpec=va;e.SyncActionValue$SyncActionMessageSpec=wa;e.SyncActionValue$SyncActionMessageRangeSpec=$;e.SyncActionValue$UnarchiveChatsSettingSpec=xa;e.SyncActionValue$DeleteChatActionSpec=ya;e.SyncActionValue$ClearChatActionSpec=za;e.SyncActionValue$MarkChatAsReadActionSpec=Aa;e.SyncActionValue$DeleteMessageForMeActionSpec=Ba;e.SyncActionValue$ArchiveChatActionSpec=Ca;e.SyncActionValue$RecentEmojiWeightsActionSpec=Da;e.SyncActionValue$LabelEditActionSpec=Ea;e.SyncActionValue$LabelAssociationActionSpec=Fa;e.SyncActionValue$QuickReplyActionSpec=Ga;e.SyncActionValue$LocaleSettingSpec=Ha;e.SyncActionValue$PushNameSettingSpec=Ia;e.SyncActionValue$PinActionSpec=Ja;e.SyncActionValue$MuteActionSpec=Ka;e.SyncActionValue$ContactActionSpec=La;e.SyncActionValue$StarActionSpec=Ma;e.SyncActionDataSpec=Na;e.PatchDebugDataSpec=Oa}),98);
__d("WAWebProtobufsHistorySync.pb",["$InternalEnum","WAProtoConst","WAWebProtobufSyncAction.pb","WAWebProtobufsChatLockSettings.pb","WAWebProtobufsE2E.pb","WAWebProtobufsProtocol.pb","WAWebProtobufsWeb.pb"],(function(a,b,c,d,e,f,g){var h;c=(a=b("$InternalEnum"))({IN_WAITLIST:0,AI_AVAILABLE:1});e=a({INITIAL_BOOTSTRAP:0,INITIAL_STATUS_V3:1,FULL:2,RECENT:3,PUSH_NAME:4,NON_BLOCKING_DATA:5,ON_DEMAND:6});f=a({COMPLETE_BUT_MORE_MESSAGES_REMAIN_ON_PRIMARY:0,COMPLETE_AND_NO_MORE_MESSAGE_REMAIN_ON_PRIMARY:1,COMPLETE_ON_DEMAND_SYNC_BUT_MORE_MSG_REMAIN_ON_PRIMARY:2});b=a({REGULAR:0,ADMIN:1,SUPERADMIN:2});var i=a({DEFAULT:0,OFF:1,ON:2}),j=a({LEFT:0,REMOVED:1});a=a({E2EE_MSG:1,NE2EE_SELF:2,NE2EE_OTHER:3});var k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={};k.name="HistorySync";k.internalSpec={syncType:[1,(h=d("WAProtoConst")).FLAGS.REQUIRED|h.TYPES.ENUM,e],conversations:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,l],statusV3Messages:[3,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d("WAWebProtobufsWeb.pb").WebMessageInfoSpec],chunkOrder:[5,h.TYPES.UINT32],progress:[6,h.TYPES.UINT32],pushnames:[7,h.FLAGS.REPEATED|h.TYPES.MESSAGE,p],globalSettings:[8,h.TYPES.MESSAGE,s],threadIdUserSecret:[9,h.TYPES.BYTES],threadDsTimeframeOffset:[10,h.TYPES.UINT32],recentStickers:[11,h.FLAGS.REPEATED|h.TYPES.MESSAGE,u],pastParticipants:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,v],callLogRecords:[13,h.FLAGS.REPEATED|h.TYPES.MESSAGE,d("WAWebProtobufSyncAction.pb").CallLogRecordSpec],aiWaitListState:[14,h.TYPES.ENUM,c],phoneNumberToLidMappings:[15,h.FLAGS.REPEATED|h.TYPES.MESSAGE,m],companionMetaNonce:[16,h.TYPES.STRING],shareableChatIdentifierEncryptionKey:[17,h.TYPES.BYTES],accounts:[18,h.FLAGS.REPEATED|h.TYPES.MESSAGE,n]};l.name="Conversation";l.internalSpec={id:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],messages:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,o],newJid:[3,h.TYPES.STRING],oldJid:[4,h.TYPES.STRING],lastMsgTimestamp:[5,h.TYPES.UINT64],unreadCount:[6,h.TYPES.UINT32],readOnly:[7,h.TYPES.BOOL],endOfHistoryTransfer:[8,h.TYPES.BOOL],ephemeralExpiration:[9,h.TYPES.UINT32],ephemeralSettingTimestamp:[10,h.TYPES.INT64],endOfHistoryTransferType:[11,h.TYPES.ENUM,f],conversationTimestamp:[12,h.TYPES.UINT64],name:[13,h.TYPES.STRING],pHash:[14,h.TYPES.STRING],notSpam:[15,h.TYPES.BOOL],archived:[16,h.TYPES.BOOL],disappearingMode:[17,h.TYPES.MESSAGE,d("WAWebProtobufsE2E.pb").DisappearingModeSpec],unreadMentionCount:[18,h.TYPES.UINT32],markedAsUnread:[19,h.TYPES.BOOL],participant:[20,h.FLAGS.REPEATED|h.TYPES.MESSAGE,q],tcToken:[21,h.TYPES.BYTES],tcTokenTimestamp:[22,h.TYPES.UINT64],contactPrimaryIdentityKey:[23,h.TYPES.BYTES],pinned:[24,h.TYPES.UINT32],muteEndTime:[25,h.TYPES.UINT64],wallpaper:[26,h.TYPES.MESSAGE,r],mediaVisibility:[27,h.TYPES.ENUM,i],tcTokenSenderTimestamp:[28,h.TYPES.UINT64],suspended:[29,h.TYPES.BOOL],terminated:[30,h.TYPES.BOOL],createdAt:[31,h.TYPES.UINT64],createdBy:[32,h.TYPES.STRING],description:[33,h.TYPES.STRING],support:[34,h.TYPES.BOOL],isParentGroup:[35,h.TYPES.BOOL],parentGroupId:[37,h.TYPES.STRING],isDefaultSubgroup:[36,h.TYPES.BOOL],displayName:[38,h.TYPES.STRING],pnJid:[39,h.TYPES.STRING],shareOwnPn:[40,h.TYPES.BOOL],pnhDuplicateLidThread:[41,h.TYPES.BOOL],lidJid:[42,h.TYPES.STRING],username:[43,h.TYPES.STRING],lidOriginType:[44,h.TYPES.STRING],commentsCount:[45,h.TYPES.UINT32],locked:[46,h.TYPES.BOOL],systemMessageToInsert:[47,h.TYPES.ENUM,a],capiCreatedGroup:[48,h.TYPES.BOOL],accountLid:[49,h.TYPES.STRING],limitSharing:[50,h.TYPES.BOOL],limitSharingSettingTimestamp:[51,h.TYPES.INT64],limitSharingTrigger:[52,h.TYPES.ENUM,d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger],limitSharingInitiatedByMe:[53,h.TYPES.BOOL],maibaAiThreadEnabled:[54,h.TYPES.BOOL]};m.name="PhoneNumberToLIDMapping";m.internalSpec={pnJid:[1,h.TYPES.STRING],lidJid:[2,h.TYPES.STRING]};n.name="Account";n.internalSpec={lid:[1,h.TYPES.STRING],username:[2,h.TYPES.STRING],countryCode:[3,h.TYPES.STRING],isUsernameDeleted:[4,h.TYPES.BOOL]};o.name="HistorySyncMsg";o.internalSpec={message:[1,h.TYPES.MESSAGE,d("WAWebProtobufsWeb.pb").WebMessageInfoSpec],msgOrderId:[2,h.TYPES.UINT64]};p.name="Pushname";p.internalSpec={id:[1,h.TYPES.STRING],pushname:[2,h.TYPES.STRING]};q.name="GroupParticipant";q.internalSpec={userJid:[1,h.FLAGS.REQUIRED|h.TYPES.STRING],rank:[2,h.TYPES.ENUM,b],memberLabel:[3,h.TYPES.MESSAGE,d("WAWebProtobufsE2E.pb").MemberLabelSpec]};r.name="WallpaperSettings";r.internalSpec={filename:[1,h.TYPES.STRING],opacity:[2,h.TYPES.UINT32]};s.name="GlobalSettings";s.internalSpec={lightThemeWallpaper:[1,h.TYPES.MESSAGE,r],mediaVisibility:[2,h.TYPES.ENUM,i],darkThemeWallpaper:[3,h.TYPES.MESSAGE,r],autoDownloadWiFi:[4,h.TYPES.MESSAGE,t],autoDownloadCellular:[5,h.TYPES.MESSAGE,t],autoDownloadRoaming:[6,h.TYPES.MESSAGE,t],showIndividualNotificationsPreview:[7,h.TYPES.BOOL],showGroupNotificationsPreview:[8,h.TYPES.BOOL],disappearingModeDuration:[9,h.TYPES.INT32],disappearingModeTimestamp:[10,h.TYPES.INT64],avatarUserSettings:[11,h.TYPES.MESSAGE,x],fontSize:[12,h.TYPES.INT32],securityNotifications:[13,h.TYPES.BOOL],autoUnarchiveChats:[14,h.TYPES.BOOL],videoQualityMode:[15,h.TYPES.INT32],photoQualityMode:[16,h.TYPES.INT32],individualNotificationSettings:[17,h.TYPES.MESSAGE,y],groupNotificationSettings:[18,h.TYPES.MESSAGE,y],chatLockSettings:[19,h.TYPES.MESSAGE,d("WAWebProtobufsChatLockSettings.pb").ChatLockSettingsSpec],chatDbLidMigrationTimestamp:[20,h.TYPES.INT64]};t.name="AutoDownloadSettings";t.internalSpec={downloadImages:[1,h.TYPES.BOOL],downloadAudio:[2,h.TYPES.BOOL],downloadVideo:[3,h.TYPES.BOOL],downloadDocuments:[4,h.TYPES.BOOL]};u.name="StickerMetadata";u.internalSpec={url:[1,h.TYPES.STRING],fileSha256:[2,h.TYPES.BYTES],fileEncSha256:[3,h.TYPES.BYTES],mediaKey:[4,h.TYPES.BYTES],mimetype:[5,h.TYPES.STRING],height:[6,h.TYPES.UINT32],width:[7,h.TYPES.UINT32],directPath:[8,h.TYPES.STRING],fileLength:[9,h.TYPES.UINT64],weight:[10,h.TYPES.FLOAT],lastStickerSentTs:[11,h.TYPES.INT64],isLottie:[12,h.TYPES.BOOL],imageHash:[13,h.TYPES.STRING],isAvatarSticker:[14,h.TYPES.BOOL]};v.name="PastParticipants";v.internalSpec={groupJid:[1,h.TYPES.STRING],pastParticipants:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,w]};w.name="PastParticipant";w.internalSpec={userJid:[1,h.TYPES.STRING],leaveReason:[2,h.TYPES.ENUM,j],leaveTs:[3,h.TYPES.UINT64]};x.name="AvatarUserSettings";x.internalSpec={fbid:[1,h.TYPES.STRING],password:[2,h.TYPES.STRING]};y.name="NotificationSettings";y.internalSpec={messageVibrate:[1,h.TYPES.STRING],messagePopup:[2,h.TYPES.STRING],messageLight:[3,h.TYPES.STRING],lowPriorityNotifications:[4,h.TYPES.BOOL],reactionsMuted:[5,h.TYPES.BOOL],callVibrate:[6,h.TYPES.STRING]};g.HistorySync$BotAIWaitListState=c;g.HistorySync$HistorySyncType=e;g.Conversation$EndOfHistoryTransferType=f;g.GroupParticipant$Rank=b;g.MediaVisibility=i;g.PastParticipant$LeaveReason=j;g.PrivacySystemMessage=a;g.HistorySyncSpec=k;g.ConversationSpec=l;g.PhoneNumberToLIDMappingSpec=m;g.AccountSpec=n;g.HistorySyncMsgSpec=o;g.PushnameSpec=p;g.GroupParticipantSpec=q;g.WallpaperSettingsSpec=r;g.GlobalSettingsSpec=s;g.AutoDownloadSettingsSpec=t;g.StickerMetadataSpec=u;g.PastParticipantsSpec=v;g.PastParticipantSpec=w;g.AvatarUserSettingsSpec=x;g.NotificationSettingsSpec=y}),98);
__d("WAWebUserPrefsHistorySync",["WALogger","WATimeUtils","WAWebHistorySyncUtils","WAWebPermanentStorage","WAWebProtobufsHistorySync.pb","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsMultiDevice","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){if(a==null||b==null)return;a===d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT&&(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set last history sync chunk with chunk order ",""])),b),yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_RECENT_SYNC_CHUNK_PROCESSED,{chunkOrder:b,progress:e}));yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED,a+"_"+b);c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED,a+"_"+b,{shouldWriteToIdb:!1})});return j.apply(this,arguments)}function e(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_CHUNK_PROCESSED);return a}function f(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.MD_HISTORY_LAST_RECENT_SYNC_CHUNK_PROCESSED);return a}function k(){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.INITIAL_HISTORY_SYNCED,!0);return c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.INITIAL_HISTORY_SYNCED,"true",{shouldWriteToIdb:!1})});return l.apply(this,arguments)}function m(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.INITIAL_HISTORY_SYNCED);return a===!0}function n(){return!!c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.INITIAL_HISTORY_SYNCED,{storage:c("WAWebPermanentStorage")})}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=(yield q()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS,babelHelpers["extends"]({},b,a));c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_STATUS,babelHelpers["extends"]({},b,a),{shouldWriteToIdb:!1})});return p.apply(this,arguments)}function q(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS);return a}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC,a)});return s.apply(this,arguments)}function t(){var a;return(a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC))!=null?a:0}function u(a){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ESTIMATED_HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC,a)});return v.apply(this,arguments)}function w(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.ESTIMATED_HISTORY_SYNC_CHUNK_COUNT_FOR_END_OF_RECENT_SYNC);return a!=null?a:0}function x(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_REMAINING_PAUSED_SECONDS);if(typeof a==="number")return a}function y(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").MD_KEYS.HISTORY_SYNC_REMAINING_PAUSED_SECONDS,a)}function z(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HISTORY_SYNC_EARLIEST_DATE);if(typeof a!=="number"||a===0){var b;b=(b=d("WAWebUserPrefsMultiDevice").getPairingTimestamp())!=null?b:d("WATimeUtils").unixTime();var e=d("WAWebHistorySyncUtils").getEarliestHistorySyncDate();return b-e}return a}function A(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HISTORY_SYNC_EARLIEST_DATE,a)}function B(a,b,c){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(c==null||a!==d("WAWebProtobufsHistorySync.pb").HistorySync$HistorySyncType.RECENT)return;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] set recent sync single chunk "," status to ",""])),c,b);c=(a={},a[c]=b,a);a=(b=(yield D()))!=null?b:{};yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_SINGLE_CHUNK_STATUS,babelHelpers["extends"]({},a,c))});return C.apply(this,arguments)}function D(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_SINGLE_CHUNK_STATUS);return a}function E(a){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").HASHED_KEYS.INITIAL_HIST_BOUNDARY,a)});return F.apply(this,arguments)}function G(){return d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").HASHED_KEYS.INITIAL_HIST_BOUNDARY)}function H(a){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS_AFTER_PAIRING_LOGGING_COUNT,a)});return I.apply(this,arguments)}function J(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_STATUS_AFTER_PAIRING_LOGGING_COUNT);return a}function K(a){return L.apply(this,arguments)}function L(){L=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;b=(b=M())!=null?b:0;yield d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_TOTAL_PROCESSED_MESSAGE_COUNT,b+a)});return L.apply(this,arguments)}function M(){var a=d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(d("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.HISTORY_SYNC_TOTAL_PROCESSED_MESSAGE_COUNT);return a}g.setLastHistorySyncedChunk=a;g.getLastHistorySyncedChunk=e;g.getLastHistoryRecentSyncedChunk=f;g.setInitialHistorySyncComplete=k;g.getInitialHistorySyncComplete=m;g.getInitialHistorySyncCompleteLocalStorage=n;g.setHistorySyncStatus=o;g.getHistorySyncStatus=q;g.setChunkCountForEndOfRecentHistorySync=r;g.getChunkCountForEndOfRecentHistorySync=t;g.setEstimatedChunkCountForEndOfRecentHistorySync=u;g.getEstimatedChunkCountForEndOfRecentHistorySync=w;g.getHistorySyncRemainingPausedSeconds=x;g.setHistorySyncRemainingPausedSeconds=y;g.getHistorySyncEarliestDate=z;g.setHistorySyncEarliestDate=A;g.setRecentSyncSingleChunkStatus=B;g.getRecentSyncSingleChunkStatus=D;g.setHistoryInitialSyncBoundary=E;g.getHistoryInitialSyncBoundary=G;g.setHistorySyncStatusAfterPairingLoggingCount=H;g.getHistorySyncStatusAfterPairingLoggingCount=J;g.setHistorySyncTotalProcessedMessageCount=K;g.getHistorySyncTotalProcessedMessageCount=M}),98);
__d("WAWebUserPrefsLocales",["WAComms","WAWebL10NHelpers","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsLocalStorage","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(){var a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE);return a!=null?a:c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG)}function b(){return c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER)}function e(a){d("WAWebL10NHelpers").isLocalLanguageOverrideEnabled()&&(c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER,a),d("WAComms").isSocketConnected()&&void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_USER,a))}function f(a){c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE,a),d("WAComms").isSocketConnected()&&void d("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(d("WAWebUserPrefsKeys").KEYS.LANG_FROM_PHONE,a)}function h(a){c("WAWebUserPrefsLocalStorage").setItemToLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_DID_MISMATCH_WITH_COOKIE,a)}function i(){var a;return(a=c("WAWebUserPrefsLocalStorage").getItemFromLocalStorage(d("WAWebUserPrefsKeys").KEYS.LANG_DID_MISMATCH_WITH_COOKIE))!=null?a:!1}function j(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE,a)}function k(a){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_DEVICE,a)}function l(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE);if(typeof a==="boolean")return a;a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24);typeof a==="boolean"&&c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_PHONE,a);return typeof a==="boolean"?a:null}function m(){var a=c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").KEYS.HOUR_24_FROM_DEVICE);return typeof a==="boolean"?a:null}g.getPhoneLangPref=a;g.getUserLangPref=b;g.setUserLangPref=e;g.setPhoneLangPref=f;g.setLangPrefCookieDidMismatchWithUserPref=h;g.getLangPrefCookieDidMismatchWithUserPref=i;g.setPhoneHour24=j;g.setDeviceHour24=k;g.getPhoneHour24=l;g.getDeviceHour24=m}),98);
__d("WAWebEventsWaitForBbEvent",["Promise","WAAbortError"],(function(a,b,c,d,e,f,g){var h;function a(a,c,e,f){e===void 0&&(e=function(){return!0});return f!=null&&f.aborted?(h||(h=b("Promise"))).reject(new(d("WAAbortError").AbortError)()):new(h||(h=b("Promise")))(function(b,g){var h=function(){if(!e.apply(this,arguments))return;j==null||j();b(arguments)},i=function(){j==null||j(),g(new(d("WAAbortError").AbortError)())},j=function(){a.off(c,h),f==null||f.removeEventListener("abort",i),j=null};f==null||f.addEventListener("abort",i);a.on(c,h)})}g["default"]=a}),98);
__d("WAWebEventsWaitForMainStreamReadyMd",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent"],(function(a,b,c,d,e,f,g){var h;function a(){return d("WAWebCmd").Cmd.isMainStreamReadyMd?(h||(h=b("Promise"))).resolve():c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"main_stream_mode_ready")}g["default"]=a}),98);
__d("WAWebEventsWaitForOfflineDeliveryEnd",["WACustomError","WALogger","WAPromiseTimeout","WAWebCmd","WAWebEventsWaitForBbEvent","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){var h,i,j=5*60*1e3;function a(){if(i!=null)return;i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_delivery_end");d("WAWebCmd").Cmd.on("offline_delivery_state_reset",function(){i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_delivery_end")})}function e(){return d("WAWebCmd").Cmd.isOfflineDeliveryEnd}function f(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebCmd").Cmd.isOfflineDeliveryEnd)return;if(i==null)throw c("err")("waitForOfflineDeliveryEnd called before init");try{yield d("WAPromiseTimeout").promiseTimeout(i,j)}catch(a){if(a instanceof d("WACustomError").TimeoutError)d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume] offline delievery promise not resolved within 5 mins"]))).sendLogs("offline-resume-promise-unresolved",{sampling:.01});else throw a}yield i});return k.apply(this,arguments)}g.initWaitForOfflineDeliveryEnd=a;g.isOfflineDeliveryEnd=e;g.waitForOfflineDeliveryEnd=f}),98);
__d("WAWebEventsWaitForReadyForOffline",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent","err"],(function(a,b,c,d,e,f,g){var h,i;function a(){if(i!=null)return;i=c("WAWebEventsWaitForBbEvent")(d("WAWebCmd").Cmd,"offline_process_ready")}function e(){return i==null?(h||(h=b("Promise"))).reject(c("err")("waitForOfflineProcessReady called before init")):i}g.initWaitForOfflineProcessReady=a;g.waitForOfflineProcessReady=e}),98);
__d("WAWebThreadMetadataUtil",["WALogger","WAWebLidMigrationUtils"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.chatTimestamp,c=a.chatId;a=a.accountLid;if(b==null)return;if(d("WAWebLidMigrationUtils").shouldHaveAccountLid(c))if(a==null)d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[getOfflineMetaPreviewForChat] accountLid is null for a migrated client"]))).sendLogs("account-lid-null-offline-metadata");else{a=b[a.toString({legacy:!0})];if(a)return a}return b[c.toString({legacy:!0})]}g.getOfflineMetaPreviewForChat=a}),98);
__d("WASignalAggregator",["err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){var a=this;this.$1=!1;this.$2=new AbortController();this.$3=new Set();this.signal=this.$2.signal;this.$5=function(b){a["delete"](b.currentTarget),a.$6()}}var b=a.prototype;b.add=function(){this.$4();for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d of b)d.aborted||(d.addEventListener("abort",this.$5),this.$3.add(d));this.$6()};b.$6=function(){if(this.$1)return;var a=Array.from(this.$3).every(function(a){return a.aborted});if(!a)return;this.dispose();this.$2.abort()};b["delete"]=function(){this.$4(),this.$7.apply(this,arguments)};b.$7=function(){var a=!1;for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];for(var e of c)this.$3["delete"](e)&&(a=!0,e.removeEventListener("abort",this.$5));a&&this.$6()};b.$4=function(){if(this.$1)throw c("err")("Attempt to modify disposed SignalAggregator")};b.dispose=function(){if(this.$1)return;this.$1=!0;for(var a of this.$3)this.$7(a)};b.getSignals__INTERNAL=function(){return this.$3};return a}();g["default"]=a}),98);
__d("WAMemoizeConcurrent",["Promise","WAAbortError","WAPromiseRaceAbort","WASignalAggregator"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f=new Map();return function(g){var i;if(g!=null&&(i=g.signal)!=null&&i.aborted)return(h||(h=b("Promise"))).reject(new(d("WAAbortError").AbortError)());var j=a.call(this,g),k=f.get(j);if(k==null||k.aggregator.signal.aborted){var l=new(c("WASignalAggregator"))(),m=babelHelpers["extends"]({},g,{signal:l.signal});k={aggregator:l,promise:e.call(this,m)["finally"](function(){l.dispose(),f["delete"](j)})};f.set(j,k)}m=(g==null?void 0:g.signal)||new AbortController().signal;k.aggregator.add(m);return c("WAPromiseRaceAbort")(k.promise,m)}}g["default"]=a}),98);
__d("WAWebNetworkGetResponseIfOnline",["WAWebXHR"],(function(a,b,c,d,e,f,g){function a(a,b,d,e,f){b===void 0&&(b="GET");return c("WAWebXHR").request(a,b,d,f,e).then(function(a){return a.status&&a.status<12e3?a:null})["catch"](function(){return null})}g["default"]=a}),98);
__d("WAWebNetworkStatus",["Promise","WALogger","WAMemoizeConcurrent","WAWebBaseModel","WAWebBuildConstants","WAWebMiscBrowserUtils","WAWebNetworkGetResponseIfOnline","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=d("WAWebBuildConstants").DYN_ORIGIN+"status.json",r=!1;a=function(a){function e(){var e;for(var f=arguments.length,g=new Array(f),o=0;o<f;o++)g[o]=arguments[o];return(e=a.call.apply(a,[this].concat(g))||this,e.online=d("WAWebBaseModel").session(!0),e.simulatedOfflineConditions=d("WAWebBaseModel").session(!1),e.waitIfOffline=c("WAMemoizeConcurrent")(function(){return"all"},b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this;if(this.online)return;if(c("WAWebMiscBrowserUtils").info().name!=="Firefox"&&navigator.onLine){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: XHR online is false, but navigator.onLine is true, resolving promise"])));return}d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: Waiting..."])));yield new(p||(p=b("Promise")))(function(b){a.listenToOnce(a,"change:online",function(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["waitIfOffline: Continuing..."]))),b()})})})),e.checkOnline=c("WAMemoizeConcurrent")(function(){return"all"},b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline checking"])));if((r||c("gkx")("26256"))&&this.simulatedOfflineConditions){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline simulating offline behavior"])));return}try{var a=(yield c("WAWebNetworkGetResponseIfOnline")(q,"GET",null,void 0));this.online=!!a;d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline response ",""])),String(this.online))}catch(a){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["NetworkStatus:checkOnline errored! ",""])),String(a)).devConsole(a)}})),babelHelpers.assertThisInitialized(e))||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.initialize=function(){this.listenTo(this,"change:online",this.$NetworkStatus$p_1),this.$NetworkStatus$p_1()};f.$NetworkStatus$p_1=function(){var a=this.online;d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[comms] NetworkStatus ",""])),a?"online":"offline").tags("comms")};f.simulateNetworkStatus=function(a){(r||c("gkx")("26256"))&&(this.online=a,this.simulatedOfflineConditions=!a)};return e}(d("WAWebBaseModel").BaseModel);e=d("WAWebBaseModel").defineModel(a);f=new e();g["default"]=f}),98);
__d("WAWebHistorySyncUtils",["WATimeUtils","WAWebEnvironment","WAWebPrimaryFeaturesModel","WAWebSyncGatingUtils"],(function(a,b,c,d,e,f,g){function a(){if(!c("WAWebEnvironment").isWindows)return 90*d("WATimeUtils").DAY_SECONDS;if(d("WAWebPrimaryFeaturesModel").PrimaryFeatures.extendedHistorySyncOnDemand&&d("WAWebSyncGatingUtils").isOnDemandExtendedHistorySyncForHybridEnabled()){var a=d("WAWebSyncGatingUtils").getHistorySyncOnDemandTimeBoundaryDaysForDesktops();return a*d("WATimeUtils").DAY_SECONDS}return d("WATimeUtils").YEAR_SECONDS}g.getEarliestHistorySyncDate=a}),98);
__d("WAWebFMXGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("fmx_ctwa_kill_switch")}function b(){return d("WAWebABProps").getABPropConfigValue("enable_fmx_logging")}g.fmxCTWAKillSwitchEnabled=a;g.fmxLoggingEnabled=b}),98);
__d("WAWebContactSystemMsg",["WATimeUtils","WAWebApiContact","WAWebBizGatingUtils","WAWebFMXGatingUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){function a(a,b){var e=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),f=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(b),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return{id:f,t:d("WATimeUtils").unixTime(),type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"identity",from:a,to:e,body:b.toString()}}function e(a,b){b===void 0&&(b="encrypt");return l(a,{type:"e2e_notification",kind:d("WAWebMsgType").MsgKind.E2eNotification,subtype:b,templateParams:[]})}function f(a,b,c){c===void 0&&(c=[]);return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:b,templateParams:c})}function h(a,b,e){var f=e?d("WAWebUserPrefsMeUser").getMePnUserOrThrow():a;if(f==null)throw c("err")("Cannot set null initiator for DDM system message: "+a.toString()+" / "+String(e));return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode",templateParams:[],ephemeralDuration:b,ephemeralSettingUser:f})}function i(a,b,c){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode_update",templateParams:[],ephemeralDuration:b,ephemeralSettingUser:c})}function j(a){var b=a.chatId,c=a.oldUsername,e=a.newUsername,f=a.wid;a=a.displayName;return l(b,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"change_username",templateParams:[c!=null?c:"",e!=null?e:"",f,a!=null?a:""]})}function k(a){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"disappearing_mode_unsupported",templateParams:[]})}function l(a,b){var e=d("WAWebUserPrefsMeUser").getMaybeMeDeviceLid(),f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),g=new(c("WAWebMsgKey"))({fromMe:d("WAWebUserPrefsMeUser").isMeAccount(a),remote:a,id:c("WAWebMsgKey").newId_DEPRECATED()});return babelHelpers["extends"]({id:g,t:d("WATimeUtils").unixTime(),from:a,to:a.isLid()&&e!=null?e:f},b)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b.isEnterprise&&!d("WAWebBizGatingUtils").getFmxAgmEnabled())return null;if(b.isEnterprise&&!b.isFMXCtWA&&d("WAWebBizGatingUtils").getFmxAgmEnabled())return null;if(!a.isUser()||b.isWASupportStartingChat||b.iAmStartingChat&&!b.isFMXCtWA||b.isFromCTWA&&!b.isFMXCtWA&&d("WAWebFMXGatingUtils").fmxCTWAKillSwitchEnabled())return null;if(a.isBot())return null;b=(yield d("WAWebApiContact").isAddressBookContact(a.toJid()));return b?null:l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"contact_info_card",templateParams:[a]})});return n.apply(this,arguments)}function o(a,b){return l(a,{type:"notification_template",kind:d("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"limit_sharing_system_message",limitSharing:b,templateParams:[]})}g.genSecurityCodeNotificationMsg=a;g.genEncryptNotificationMsg=e;g.genNonE2ENotificationMsg=f;g.genDefaultDisappearingModeSystemMsg=h;g.genDisappearingModeUpdateSystemMsg=i;g.genUsernameChangeSystemMsg=j;g.genDisappearingModeUnsupportedSystemMsg=k;g.genNotificationMsg=l;g.genContactInfoCardMsg=m;g.genLimitSharingUpdateSystemMsg=o}),98);
__d("WAWebWamEnumCtwaBizUserJourneyOperation",[],(function(a,b,c,d,e,f){a=Object.freeze({AGM_INJECTED:1,AGM_CTA_CLICKED:2,AGM_VIEW_DETAILS_CLICKED:3,AGM_BOTTOMSHEET_SHOWN:4,AGM_BOTTOMSHEET_CLOSED:5,AGM_BOTTOMSHEET_EXTERNAL_NAVIGATION:6,DUPLICATED_AGM_NOT_INJECTED:7,AGM_WELCOME_MESSAGE_NULL:8,AGM_INVALID_CTA_TYPE_FROM_MESSAGE:9,AGM_INVALID_CTA_PAYLOAD_FROM_MESSAGE:10,AGM_INVALID_SOURCE_APP_FROM_MESSAGE:11,AGM_BOTTOMSHEET_IMAGE_ERROR:12,AGM_BOTTOMSHEET_TEXT_ERROR:13});f.CTWA_BIZ_USER_JOURNEY_OPERATION=a}),66);
__d("WAWebCtwaBizUserJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCtwaBizUserJourneyOperation"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CtwaBizUserJourney:[5992,{adId:[3,a.TYPES.STRING],bizFeatureEnabled:[4,a.TYPES.STRING],businessPhoneNumber:[5,a.TYPES.INTEGER],ctwaBizUserJouneryEntryPoint:[6,a.TYPES.STRING],ctwaBizUserJourneyMetadata:[1,a.TYPES.STRING],ctwaBizUserJourneyOperation:[2,d("WAWebWamEnumCtwaBizUserJourneyOperation").CTWA_BIZ_USER_JOURNEY_OPERATION]},[1,1,1],"regular"]},{CtwaBizUserJourney:[]});g.CtwaBizUserJourneyWamEvent=b}),98);
__d("WAWebWamEnumCtwaAdVariantType",[],(function(a,b,c,d,e,f){a=Object.freeze({CTWA:1,CAWC:2,WAMO:3});f.CTWA_AD_VARIANT_TYPE=a}),66);
__d("WAWebWamEnumCtwaChatCreationMode",[],(function(a,b,c,d,e,f){a=Object.freeze({JID:0,LID:1});f.CTWA_CHAT_CREATION_MODE=a}),66);
__d("WAWebWamEnumCtwaUserJourneyOperationType",[],(function(a,b,c,d,e,f){a=Object.freeze({LAND_ON_WHATSAPP:1,GET_CONTEXT_CALL_INITIATED:2,GET_CONTEXT_CALL_SUCCESS:3,AD_CONTEXT_FALLBACK_RENDERED:4,AD_CONTEXT_DISMISSED:5,KILL_APP:6,BACK_BUTTON_CLICKED:7,CALL_BUSINESS_BUTTON_CLICKED:8,VIEW_CATALOG_BUTTON_CLICKED:9,PROFILE_PHOTO_CLICKED:10,BIZ_PROFILE_CLICKED:11,GET_CONTEXT_CALL_FAILED:12,CHAT_SETTINGS_CLICKED:13,FIRST_CUSTOM_MESSAGE_SENT_WITH_AD_CONTEXT:14,FIRST_CUSTOM_MESSAGE_SENT_WITHOUT_AD_CONTEXT:15,ICEBREAKER_SENT:16,AD_CONTEXT_FULLPREVIEW_RENDERED:17,TRUST_BANNER_SHOWN:18,TRUST_BANNER_DISMISSED:19,CTWA_ADD_CONTACT_DIALOG_OPEN:20,CTWA_ADD_CONTACT_CREATE_NEW:21,CTWA_ADD_CONTACT_EXISTING:22,CTWA_ARCHIVE_THREAD:23,CTWA_DELETE_THREAD:24,CTWA_PARSE_DEEP_LINK_START:25,CTWA_PARSE_DEEP_LINK_SUCCESS:26,CTWA_PARSE_DEEP_LINK_FAILURE:27,CTWA_CONSUMER_DISCLOSURE_SHOWN_BLOCKING:28,CTWA_CONSUMER_DISCLOSURE_SHOWN_NONBLOCKING:29,CTWA_CONSUMER_DISCLOSURE_NOT_SHOWN_ACCEPTED:30,CTWA_CONSUMER_DISCLOSURE_NOT_SHOWN_COOLDOWN:31,CTWA_CONSUMER_DISCLOSURE_NOT_SHOWN_OTHER:32,CTWA_CONSUMER_DISCLOSURE_ACCEPTED:33,CTWA_CONSUMER_DISCLOSURE_NOT_ACCEPTED:34,FIRST_MESSAGE_SENT_WITHOUT_AD_PAYLOAD:35,FIRST_MESSAGE_SENT_WITH_AD_PAYLOAD:36,CALL_SENT_WITHOUT_AD_PAYLOAD:37,CALL_SENT_WITH_AD_PAYLOAD:38,CTWA_CONSUMER_DISCLOSURE_SHOWN_INTHREAD_BLOCKING:39,CONSUMER_DISCLOSURE_NOT_SHOWN_EXEMPT:40,AGM_SPINNER_HIDES_FROM_GET_CONTEXT_COMPLETION:41,AGM_SPINNER_HIDES_FROM_USER_ACTION:42,AGM_SPINNER_HIDES_FROM_MAX_LOADING_TIME:43,AGM_INJECTED:44,AGM_CTA_CLICKED:45,AGM_VIEW_DETAILS_CLICKED:46,AGM_BOTTOMSHEET_SHOWN:47,AGM_BOTTOMSHEET_CLOSED:48,AGM_BOTTOMSHEET_EXTERNAL_NAVIGATION:49,DUPLICATED_AGM_NOT_INJECTED:50,AGM_WELCOME_MESSAGE_NULL:51,AGM_INVALID_CTA_TYPE_FROM_ACTION_LINK:52,AGM_INVALID_CTA_PAYLOAD_FROM_ACTION_LINK:53,AGM_INVALID_SOURCE_APP_FROM_ACTION_LINK:54,AGM_BOTTOMSHEET_IMAGE_ERROR:55,AGM_BOTTOMSHEET_TEXT_ERROR:56,AGM_SPINNER_SHOWN:57,LAND_ON_CHAT_THREAD:58,AD_CONTEXT_PREVIEW_CLICKED:60,BIZ_CONTEXT_CARD_CLICKED:61,BIZ_CONTEXT_CARD_INSERTED:62,BIZ_CONTEXT_CARD_EXIST:63,LAND_ON_EMPTY_CHAT_THREAD:64,AGM_NOT_INJECTED_TIMEOUT:65,AGM_NOT_INJECTED_OTHER:66,AGM_AD_PREVIEW_OPENED:67,AGM_AD_PREVIEW_CLOSED:68,BIZ_CONTEXT_CARD_NOT_INSERTED:69,GET_CONTEXT_CALL_SUCCESS_PROCESSED:70,AD_CONTEXT_NOT_SHOWN:71,AD_PREVIEW_MEDIA_NOT_AVAILABLE:72,AD_PREVIEW_MEDIA_URL_EXPIRED:73,CALL_CONFIRMATION_BOTTOMSHEET_SHOWN:74,CALL_CONFIRMATION_BOTTOMSHEET_DISMISSED:75,CALL_CONFIRMATION_BOTTOMSHEET_CLICKED:76});f.CTWA_USER_JOURNEY_OPERATION_TYPE=a}),66);
__d("WAWebWamEnumTrustBannerAction",[],(function(a,b,c,d,e,f){a=Object.freeze({VIEWED:0,DISMISSED:1});f.TRUST_BANNER_ACTION=a}),66);
__d("WAWebCtwaUserJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCtwaAdVariantType","WAWebWamEnumCtwaChatCreationMode","WAWebWamEnumCtwaUserJourneyOperationType","WAWebWamEnumTrustBannerAction"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CtwaUserJourney:[3466,{adId:[1,a.TYPES.STRING],businessJid:[2,a.TYPES.STRING],ctwaAdVariant:[14,d("WAWebWamEnumCtwaAdVariantType").CTWA_AD_VARIANT_TYPE],ctwaChatCreationMode:[6,d("WAWebWamEnumCtwaChatCreationMode").CTWA_CHAT_CREATION_MODE],ctwaUserJourneyMetadata:[12,a.TYPES.STRING],ctwaUserJourneyOperation:[3,d("WAWebWamEnumCtwaUserJourneyOperationType").CTWA_USER_JOURNEY_OPERATION_TYPE],elapsedTimeInMs:[13,a.TYPES.INTEGER],featureEnabled:[9,a.TYPES.STRING],icebreakersShown:[4,a.TYPES.BOOLEAN],sequenceNumber:[5,a.TYPES.INTEGER],threadCreationDate:[10,a.TYPES.STRING],threadIdHmac:[11,a.TYPES.STRING],trustBannerAction:[7,d("WAWebWamEnumTrustBannerAction").TRUST_BANNER_ACTION],trustBannerType:[8,a.TYPES.STRING]},[1,1,1],"private",113760892]},{CtwaUserJourney:[]});g.CtwaUserJourneyWamEvent=b}),98);
__d("WAWebCtwaLogger",["WAWebBizGatingUtils","WAWebCtwaBizUserJourneyWamEvent","WAWebCtwaUserJourneyWamEvent","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebWamEnumCtwaBizUserJourneyOperation","WAWebWamEnumCtwaUserJourneyOperationType"],(function(a,b,c,d,e,f,g){"use strict";b=["agm"];var h=b.join(", ");c={injected:"injected",duplicated:"duplicated",null_greeting_message:"null_greeting_message",invalid_source_app:"invalid_source_app",bottomsheet_text_error:"bottomsheet_text_error",agm_cta_clicked:"agm_cta_clicked",agm_bottomsheet_external_navigation:"agm_bottomsheet_external_navigation",agm_view_details_clicked:"agm_view_details_clicked",agm_bottom_sheet_shown:"agm_bottom_sheet_shown",agm_bottom_sheet_closed:"agm_bottom_sheet_closed",agm_invalid_cta_payload:"agm_invalid_cta_payload",agm_bottom_sheet_image_error:"agm_bottom_sheet_image_error"};f=(e={},e[c.injected]="AGM_INJECTED",e[c.duplicated]="DUPLICATED_AGM_NOT_INJECTED",e[c.null_greeting_message]="AGM_WELCOME_MESSAGE_NULL",e[c.bottomsheet_text_error]="AGM_BOTTOMSHEET_TEXT_ERROR",e[c.agm_cta_clicked]="AGM_CTA_CLICKED",e[c.agm_bottomsheet_external_navigation]="AGM_BOTTOMSHEET_EXTERNAL_NAVIGATION",e[c.agm_view_details_clicked]="AGM_VIEW_DETAILS_CLICKED",e[c.agm_bottom_sheet_shown]="AGM_BOTTOMSHEET_SHOWN",e[c.agm_bottom_sheet_closed]="AGM_BOTTOMSHEET_CLOSED",e[c.agm_bottom_sheet_image_error]="AGM_BOTTOMSHEET_IMAGE_ERROR",e);var i=babelHelpers["extends"]({},f,(b={},b[c.invalid_source_app]="AGM_INVALID_SOURCE_APP_FROM_MESSAGE",b[c.agm_invalid_cta_payload]="AGM_INVALID_CTA_PAYLOAD_FROM_MESSAGE",b)),j=babelHelpers["extends"]({},f,(e={},e[c.invalid_source_app]="AGM_INVALID_SOURCE_APP_FROM_ACTION_LINK",e[c.agm_invalid_cta_payload]="AGM_INVALID_CTA_PAYLOAD_FROM_ACTION_LINK",e));function a(a){var b=a.operationType,c=a.fromBusiness,e=a.agmPayload,f=a.businessWid;a=a.adId;e={ctaType:(e=e==null?void 0:e.ctaType)!=null?e:null,adID:a};if(!c){a=j[b];k(babelHelpers["extends"]({},e,{operation:d("WAWebWamEnumCtwaUserJourneyOperationType").CTWA_USER_JOURNEY_OPERATION_TYPE[a],businessPhoneNumber:f}))}else{c=i[b];l(babelHelpers["extends"]({},e,{operation:d("WAWebWamEnumCtwaBizUserJourneyOperation").CTWA_BIZ_USER_JOURNEY_OPERATION[c],businessWid:f}))}}function k(a){if(d("WAWebBizGatingUtils").getFmxAgmEnabled()){var b=a.operation,c=a.ctaType,e=a.businessPhoneNumber;a=a.adID;new(d("WAWebCtwaUserJourneyWamEvent").CtwaUserJourneyWamEvent)({adId:String(a),ctwaUserJourneyOperation:b,businessJid:n(e),icebreakersShown:!1,ctwaUserJourneyMetadata:JSON.stringify({agm_cta_type:c}),featureEnabled:h}).commit()}}function l(a){if(d("WAWebBizGatingUtils").getFmxAgmEnabled()){var b=a.operation,c=a.ctaType,e=a.businessWid;a=a.adID;new(d("WAWebCtwaBizUserJourneyWamEvent").CtwaBizUserJourneyWamEvent)({adId:String(a),ctwaBizUserJourneyOperation:b,businessPhoneNumber:parseInt(n(e),10),bizFeatureEnabled:h,ctwaBizUserJourneyMetadata:JSON.stringify({agm_cta_type:c})}).commit()}}function m(a){return a!=null?a.toString():"null"}function n(a){var b=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();b=b?d("WAWebLidMigrationUtils").toLid(a):null;b=b!=null?b:a;return m(b)}g.AGM_OPERATION_TYPE=c;g.logAGMOperation=a}),98);
__d("WAWebReportingTokenValidationFailureSenderWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDeviceType","WAWebWamEnumE2eDeviceType","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumReportingTokenValidationFailureReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ReportingTokenValidationFailureSender:[6094,{clientMessageId:[1,a.TYPES.STRING],e2eReceiverType:[2,d("WAWebWamEnumDeviceType").DEVICE_TYPE],e2eSenderType:[3,d("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],editType:[4,d("WAWebWamEnumEditType").EDIT_TYPE],isLid:[5,a.TYPES.BOOLEAN],isMessageMediaRetry:[14,a.TYPES.BOOLEAN],isMessageRetry:[6,a.TYPES.BOOLEAN],isSecretEncryptedMsg:[12,a.TYPES.BOOLEAN],messageIsForward:[15,a.TYPES.BOOLEAN],messageMediaType:[7,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[8,d("WAWebWamEnumMessageType").MESSAGE_TYPE],offline:[9,a.TYPES.BOOLEAN],reportingTokenValidationFailureReason:[10,d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON],reportingTokenVersion:[13,a.TYPES.INTEGER],senderJid:[11,a.TYPES.STRING]},[1,1,1],"private",113760892]},{ReportingTokenValidationFailureSender:[]});g.ReportingTokenValidationFailureSenderWamEvent=b}),98);
__d("WAWebReportingTokenValidationFailureWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumReportingTokenValidationFailureReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({ReportingTokenValidationFailure:[5466,{editType:[1,d("WAWebWamEnumEditType").EDIT_TYPE],isLid:[5,a.TYPES.BOOLEAN],isMessageMediaRetry:[10,a.TYPES.BOOLEAN],isMessageRetry:[6,a.TYPES.BOOLEAN],isSecretEncryptedMsg:[8,a.TYPES.BOOLEAN],messageIsForward:[11,a.TYPES.BOOLEAN],messageMediaType:[2,d("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[3,d("WAWebWamEnumMessageType").MESSAGE_TYPE],offline:[7,a.TYPES.BOOLEAN],reportingTokenValidationFailureReason:[4,d("WAWebWamEnumReportingTokenValidationFailureReason").REPORTING_TOKEN_VALIDATION_FAILURE_REASON],reportingTokenVersion:[9,a.TYPES.INTEGER]},[1,1,1],"regular"]},{ReportingTokenValidationFailure:[]});g.ReportingTokenValidationFailureWamEvent=b}),98);
__d("WAWebWamReportingTokenMismatchReporter",["WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebReportingTokenValidationFailureSenderWamEvent","WAWebReportingTokenValidationFailureWamEvent","WAWebWamEnumDeviceType","WAWebWamMsgUtils"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.msg,e=a.reason;a=a.reportingTokenVersion;b=(b=c.senderWithDevice)!=null?b:d("WAWebMsgGetters").getSender(c);new(d("WAWebReportingTokenValidationFailureWamEvent").ReportingTokenValidationFailureWamEvent)({editType:d("WAWebMsgGetters").getWamEditType(c),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(c),messageType:d("WAWebWamMsgUtils").getWamMessageType(c),reportingTokenValidationFailureReason:e,isLid:d("WAWebMsgKeyUtils").isLidMsgKey(c.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message),isMessageRetry:c.isRetry===!0,offline:c.isOffline===!0,reportingTokenVersion:a,messageIsForward:d("WAWebMsgGetters").getIsForwarded(c),isSecretEncryptedMsg:c.kind===d("WAWebMsgType").MsgKind.CommentEncrypted}).commit();e={clientMessageId:c.id.id,e2eReceiverType:d("WAWebWamEnumDeviceType").DEVICE_TYPE.COMPANION,editType:d("WAWebMsgGetters").getWamEditType(c),messageMediaType:d("WAWebWamMsgUtils").getWamMediaType(c),messageType:d("WAWebWamMsgUtils").getWamMessageType(c),reportingTokenValidationFailureReason:e,isLid:d("WAWebMsgKeyUtils").isLidMsgKey(c.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message),isMessageRetry:c.isRetry===!0,offline:c.isOffline===!0,reportingTokenVersion:a,messageIsForward:d("WAWebMsgGetters").getIsForwarded(c),isSecretEncryptedMsg:c.kind===d("WAWebMsgType").MsgKind.CommentEncrypted};if(b!=null){e.senderJid=b.toString();a=d("WAWebWamMsgUtils").getWamE2eSenderType(b);a!=null&&(e.e2eSenderType=a)}new(d("WAWebReportingTokenValidationFailureSenderWamEvent").ReportingTokenValidationFailureSenderWamEvent)(e).commit()}g.logReportingTokenValidationEvent=a}),98);
__d("WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction",[],(function(a,b,c,d,e,f){a=Object.freeze({DISPLAYED:1,TAPPED:2});f.COEX_STATUS_REPLY_PRIVACY_DISCLAIMER_USER_ACTION=a}),66);
__d("WAWebWamEnumCoexSysMsgInsertionChannel",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT_OPEN:0,MESSAGE_RECEIVE:1,HISTORY_SYNC:2});f.COEX_SYS_MSG_INSERTION_CHANNEL=a}),66);
__d("WAWebWamEnumCoexSysMsgStateTransitionAttempt",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE_TO_HOSTED:0,HOSTED_TO_E2EE:1,HOSTED_TO_HOSTED:2});f.COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT=a}),66);
__d("WAWebCoexPrivacySysMsgWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction","WAWebWamEnumCoexSysMsgInsertionChannel","WAWebWamEnumCoexSysMsgStateTransitionAttempt"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CoexPrivacySysMsg:[5204,{coexStatusReplyPrivacyDisclaimerUserAction:[8,d("WAWebWamEnumCoexStatusReplyPrivacyDisclaimerUserAction").COEX_STATUS_REPLY_PRIVACY_DISCLAIMER_USER_ACTION],coexSysMsgBusinessId:[1,a.TYPES.STRING],coexSysMsgInsertionChannel:[9,d("WAWebWamEnumCoexSysMsgInsertionChannel").COEX_SYS_MSG_INSERTION_CHANNEL],coexSysMsgInsertionErrorCode:[2,a.TYPES.INTEGER],coexSysMsgInsertionErrorMsg:[3,a.TYPES.STRING],coexSysMsgInsertionSuccess:[4,a.TYPES.BOOLEAN],coexSysMsgIsSelf:[5,a.TYPES.BOOLEAN],coexSysMsgMultiDeviceId:[6,a.TYPES.INTEGER],coexSysMsgStateTransitionAttempt:[7,d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT]},[1,1,1],"private",113760892]},{CoexPrivacySysMsg:[]});g.CoexPrivacySysMsgWamEvent=b}),98);
__d("WAWebBizCoexUtils",["WALogger","WATimeUtils","WAWebBizCoexGatingUtils","WAWebCoexPrivacySysMsgWamEvent","WAWebMsgKey","WAWebOfflineDeviceCache","WAWebOfflineHandler","WAWebSchemaChat","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","WAWebWamEnumCoexSysMsgInsertionChannel","WAWebWamEnumCoexSysMsgStateTransitionAttempt","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=99,j=["biz_account_type_is_hosted","biz_account_type_changed_to_hosted","biz_me_account_type_is_hosted","biz_me_account_type_is_hosted_transition"],k=new Set(),l=new Set();function a(a){return a.some(function(a){return a.isHosted()})}function e(a,b){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a==null)return;((a=a[0])==null?void 0:a.id)===i&&m(b)}function m(a){!d("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()?d("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(a.toString(),null):void d("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([a],null,null)}function f(a){return!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||a==null?!1:j.includes(a)}function n(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())return!1;return d("WAWebUserPrefsMultiDevice").getIsHostedMeAccountFromLocalStorage()||a.isHosted===!0?!0:!1}function o(a){if(!d("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())return;q(a.map(function(a){var b=a[0];a[1];return b==null?null:{id:b.id,subtype:b.subtype}}))}function p(a){var b;q([{id:a==null||(b=a.id)==null?void 0:b.toString(),subtype:a==null?void 0:a.subtype,channel:d("WAWebWamEnumCoexSysMsgInsertionChannel").COEX_SYS_MSG_INSERTION_CHANNEL.HISTORY_SYNC}])}function q(a){try{var b,e=d("WAWebUserPrefsMeUser").getMaybeMeDevicePn(),f=(b=e==null?void 0:e.device)!=null?b:0;a.forEach(function(a){if((a==null?void 0:a.id)==null)return;var b=c("WAWebMsgKey").fromString(a.id),g={coexSysMsgInsertionSuccess:!0,coexSysMsgMultiDeviceId:f,coexSysMsgStateTransitionAttempt:d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.E2EE_TO_HOSTED,coexSysMsgIsSelf:!1};g=new(d("WAWebCoexPrivacySysMsgWamEvent").CoexPrivacySysMsgWamEvent)(g);a.channel!=null&&(g.coexSysMsgInsertionChannel=a.channel);switch(a.subtype){case"biz_account_type_is_hosted":g.coexSysMsgStateTransitionAttempt=d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.HOSTED_TO_HOSTED;g.coexSysMsgBusinessId=b.remote.user;break;case"biz_account_type_changed_to_hosted":g.coexSysMsgStateTransitionAttempt=d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.E2EE_TO_HOSTED;g.coexSysMsgBusinessId=b.remote.user;break;case"biz_me_account_type_is_hosted":g.coexSysMsgIsSelf=!0;g.coexSysMsgStateTransitionAttempt=d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.HOSTED_TO_HOSTED;g.coexSysMsgBusinessId=(a=e==null?void 0:e.user)!=null?a:"";break;case"biz_me_account_type_is_hosted_transition":g.coexSysMsgIsSelf=!0;g.coexSysMsgStateTransitionAttempt=d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.E2EE_TO_HOSTED;g.coexSysMsgBusinessId=(a=e==null?void 0:e.user)!=null?a:"";break;case"encrypt":var h;g.coexSysMsgStateTransitionAttempt=d("WAWebWamEnumCoexSysMsgStateTransitionAttempt").COEX_SYS_MSG_STATE_TRANSITION_ATTEMPT.HOSTED_TO_E2EE;g.coexSysMsgBusinessId=b==null||(h=b.remote)==null?void 0:h.user;break;default:return}g.commit()})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["comit coex system msg wam event failed with error: "," message: ",""])),a.name,a.message).verbose().devConsole(a).sendLogs("comit coex system msg wam event failed")}}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(k.has(a))return!1;var b=(yield d("WAWebSchemaChat").getChatTable().get(a,!1));k.add(a);return!b});return s.apply(this,arguments)}function t(a){k["delete"](a.toString())}function u(a){a=a.toString()+"_"+d("WATimeUtils").unixTime().toString();if(l.has(a))return!0;l.add(a);return!1}function v(){l.clear()}g.HOSTED_DEVICE_ID=i;g.fanoutListContainsHostedDevice=a;g.triggerUsyncForCoexDeviceAdd=e;g.triggerUsyncForCoexUpdate=m;g.isCoexSystemMsgType=f;g.isMeOrCurrentContactHosted=n;g.sendWamCoexPrivacySysMsgInsertSuccess=o;g.sendWamCoexPrivacySysMsgHistorySyncInsert=p;g.shouldCreateFallbackHostedAdvSystemMsgOnPlaceholder=r;g.deleteChatFromFallbackHostedAdvSystemMsgOnPlaceholderCache=t;g.shouldDedupInitialHostedSystemMsg=u;g.clearDedupInitialHostedSystemMsgCache=v}),98);
__d("WAWebParseBotFeedbackProtocolMessageProto",["WAWebBotTypes","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsAICommon.pb","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;var c=b.type;b=b.botFeedbackMessage;if(c!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.BOT_FEEDBACK_MESSAGE)return;if(b==null)return;c=b.messageKey;var e=b.kind;b=b.text;if(c==null)return;if(e==null)return;var f;switch(e){case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_POSITIVE:f=d("WAWebBotTypes").BotFeedbackKind.POSITIVE;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_GENERIC:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_HELPFUL:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_HELPFUL;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_INTERESTING:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_INTERESTING;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_ACCURATE:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_ACCURATE;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_SAFE:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_SAFE;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_OTHER:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_OTHER;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_REFUSED:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_REFUSED;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_VISUALLY_APPEALING;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_RELEVANT_TO_TEXT;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_CLARITY:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_ENTERTAINING;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_CUSTOMIZABLE;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_PERSONALIZED:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_NOT_INTERESTING;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC;break;case d("WAWebProtobufsAICommon.pb").BotFeedbackMessage$BotFeedbackKind.BOT_FEEDBACK_NEGATIVE:f=d("WAWebBotTypes").BotFeedbackKind.NEGATIVE_GENERIC;break}if(f==null)return;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"bot_feedback",protocolMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a),botFeedbackKind:f,botFeedbackText:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebRichResponseValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){"use strict";a=b("$InternalEnum")({INVALID_MESSAGE_TYPE:"rich_response_invalid_name",MISSING_MESSAGE_TYPE:"rich_response_missing_message_type",INVALID_SENDER:"rich_response_invalid_sender"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="RichResponseValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.RichResponseValidationErrorCode=a;g.RichResponseValidationError=c}),98);
__d("WAWebParseRichResponseMessageProto",["WAWebBotGating","WAWebMsgType","WAWebRichResponseParseUtils","WAWebRichResponseValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.richResponseMessage;if(b==null)return;if(!h(a,b))throw new(d("WAWebRichResponseValidationError").RichResponseValidationError)(d("WAWebRichResponseValidationError").RichResponseValidationErrorCode.INVALID_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var c=b.submessages,e=b.messageType;if(e==null)throw new(d("WAWebRichResponseValidationError").RichResponseValidationError)(d("WAWebRichResponseValidationError").RichResponseValidationErrorCode.MISSING_MESSAGE_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=d("WAWebRichResponseParseUtils").generateFutureproofRichResponse(e,c);c=d("WAWebBotGating").isRichStructuredResponseReceiverEnabled()?d("WAWebRichResponseParseUtils").parseRichResponse(e):e;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE,kind:d("WAWebMsgType").MsgKind.RichResponse,richResponse:c}),contextInfo:d("WAWebBotGating").isRichResponseForwardReceivingEnabled()?b.contextInfo:void 0}}function h(a,b){if(a.from.isBot())return!0;if(((a=a.id.participant)==null?void 0:a.isBot())===!0)return!0;a=b.contextInfo;return(a==null?void 0:a.isForwarded)===!0&&d("WAWebBotGating").isRichResponseForwardReceivingEnabled()}g["default"]=a}),98);
__d("WAWebBotGating",["WATimeUtils","WAWebABProps","WAWebBotGenTypingIndicatorMsg","WAWebBotTos","WAWebBotTosIds","WAWebCommonMsgUtils","WAWebL10N","WAWebMobilePlatforms","WAWebMsgGetters","WAWebMsgType","WAWebRichResponse.flow"],(function(a,b,c,d,e,f,g){function h(){if(d("WAWebMobilePlatforms").isSMB())return!1;return!t()?!1:i()}function i(){return d("WAWebABProps").getABPropConfigValue("bonsai_enabled")===!0}function j(){return d("WAWebABProps").getABPropConfigValue("bonsai_entry_point_enabled")===!0}function a(){return h()&&d("WAWebABProps").getABPropConfigValue("bonsai_ptt_enabled")===!0}function b(a){return!h()?!1:Boolean(d("WAWebMsgGetters").getIsMetaBotResponse(a))||a.subtype===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE}function e(){return d("WAWebABProps").getABPropConfigValue("wabai_message_rendering_enabled")}function f(){return d("WAWebABProps").getABPropConfigValue("wabai_message_feedback_enabled")}function k(){return d("WAWebABProps").getABPropConfigValue("bot_3p_status")!==0}function l(){return d("WAWebABProps").getABPropConfigValue("bot_3p_status")===2}function m(){return h()&&j()&&d("WAWebABProps").getABPropConfigValue("bonsai_chat_list_entry_point_enabled")}function n(){return h()&&j()&&!m()}function o(){return d("WAWebABProps").getABPropConfigValue("wabai_consent_cooldown")}function p(){return d("WAWebABProps").getABPropConfigValue("wabai_consent_required")}function q(){return h()&&d("WAWebABProps").getABPropConfigValue("bot_commands_1p_enabled")}var r,s;function t(){var a;a=(a=d("WAWebABProps").getABPropConfigValue("bonsai_supported_languages"))!=null?a:"en";if(s!==a||r==null){var b=a.toLowerCase().split(",").map(function(a){return a.trim()});s=a;r=b.includes(c("WAWebL10N").getLanguage())}return r}function u(){return d("WAWebABProps").getABPropConfigValue("bonsai_fp_ugc_sender")}function v(){return d("WAWebABProps").getABPropConfigValue("ai_home_graphql_enabled")}function w(){return d("WAWebABProps").getABPropConfigValue("ai_ugc_not_an_expert_enabled")}function x(){return d("WAWebABProps").getABPropConfigValue("ai_home_bot_profile_sync_interval_sec")*1e3}function y(){return d("WAWebABProps").getABPropConfigValue("ai_forward_flow_enabled")}function z(){return!h()?!1:d("WAWebABProps").getABPropConfigValue("ai_web_forward_flow_enabled")}function A(){return d("WAWebABProps").getABPropConfigValue("ai_forward_flow_surface_meta_ai_as_contact_enabled")}function B(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_main_gate_enabled")}function C(){return!B()?!1:d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("ai_rich_response_smb_web_structured_response_enabled"):d("WAWebABProps").getABPropConfigValue("ai_rich_response_web_structured_response_enabled")}function D(){return!B()?!1:d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("ai_rich_response_smb_web_structured_response_receiver_enabled"):d("WAWebABProps").getABPropConfigValue("ai_rich_response_web_structured_response_receiver_enabled")}function E(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_heading_enabled")}function F(){return!B()?!1:d("WAWebABProps").getABPropConfigValue("ai_rich_response_heading_receiver_enabled")}function G(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_subheading_enabled")}function H(){return!B()?!1:d("WAWebABProps").getABPropConfigValue("ai_rich_response_subheading_receiver_enabled")}function I(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_structured_response_table_enabled")}function J(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_structured_response_table_receiver_enabled")}function K(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_structured_response_inline_reels_enabled")}function L(){return d("WAWebABProps").getABPropConfigValue("ai_rich_response_structured_response_inline_reels_receiver_enabled")}function M(){return D()&&d("WAWebABProps").getABPropConfigValue("ai_rich_response_forward_receiving_enabled")}function N(a){return a.richResponse.parseState!==d("WAWebRichResponse.flow").RichResponseParseState.Unparsed&&D()}function O(a){if(a.type===d("WAWebMsgType").MSG_TYPE.REVOKED)return!1;if(!d("WAWebMsgGetters").getIsBotSearchResponse(a))return!1;return d("WAWebCommonMsgUtils").isRichResponseMsg(a.type)&&!D()?!1:!0}function P(){return d("WAWebABProps").getABPropConfigValue("ai_chat_persistent_meta_ai_banner_enabled")}function Q(){var a=d("WAWebABProps").getABPropConfigValue("ai_pdfn_tos_non_blocking_notices");return a.split(",").map(function(a){return a.trim()}).filter(function(a){return!isNaN(a)&&a!==""}).map(Number)}function R(){return d("WAWebABProps").getABPropConfigValue("ai_chat_persistent_meta_ai_banner_logging_enabled")}function S(){return d("WAWebABProps").getABPropConfigValue("ai_chat_meta_ai_banner_m2_enabled")}function T(){return d("WAWebABProps").getABPropConfigValue("ai_chat_meta_ai_glasses_banner_enabled")}function U(){var a=d("WAWebABProps").getABPropConfigValue("ai_pdfn_tos_master_notice_id");if(a.trim()==="")return null;a=Number(a);return isNaN(a)?null:a}function V(){var a=d("WAWebABProps").getABPropConfigValue("ai_experiment_graphql_config");if(a.trim()==="")return void 0;a=a.split(",").map(function(a){return parseInt(a,10)}).filter(function(a){return!isNaN(a)});return a.length===0?void 0:a}function W(){return d("WAWebABProps").getABPropConfigValue("ai_search_null_state_update_interval")*1e3}function X(){return d("WATimeUtils").DAY_MILLISECONDS}function Y(){return 1e3}function Z(){if(!h()||!j())return!1;return!d("WAWebBotTos").hasSeenShortcutTos()&&!d("WAWebBotTos").canShowBotTos(d("WAWebBotTosIds").getBotShortcutTosId())?!1:d("WAWebABProps").getABPropConfigValue("ai_search_experience_web_enabled")}function $(){return d("WAWebABProps").getABPropConfigValue("ai_search_null_state_row_count")}function aa(){return d("WAWebABProps").getABPropConfigValue("ai_search_max_num_suggestions")}function ba(a){return a.trimmed().length>=3&&!a.hasFilter()}function ca(){return d("WAWebABProps").getABPropConfigValue("ai_chat_threads_infra_enabled")}g.isBotEnabled=h;g.isBotPttEnabled=a;g.shouldAnimateAsBotStream=b;g.isBizBot1pEnabled=e;g.isBizBot1pFeedbackEnabled=f;g.isBizBot3pEnabled=k;g.isBizBot3pAvailable=l;g.isBotShortcutEntryPointEnabled=m;g.isBotNewChatEntryPointEnabled=n;g.bizBotConsentDismissalCooldown=o;g.isBizBotConsentRequired=p;g.isMetaBotCommandsEnabled=q;g.isFbidBotEnabled=u;g.isUgcBotEnabled=v;g.isUgcNotExpertEnabled=w;g.ugcBotProfileSyncInterval=x;g.isAiForwardFlowEnabled=y;g.isAiWebForwardEnabled=z;g.isAiAsContactEnabled=A;g.isRichStructuredResponseEnabled=C;g.isRichStructuredResponseReceiverEnabled=D;g.isRichResponseHeadingEnabled=E;g.isRichResponseHeadingReceiverEnabled=F;g.isRichResponseSubHeadingEnabled=G;g.isRichResponseSubheadingReceiverEnabled=H;g.isRichResponseTableEnabled=I;g.isRichResponseTableReceiverEnabled=J;g.isRichResponseInlineReelsEnabled=K;g.isRichResponseInlineReelsReceiverEnabled=L;g.isRichResponseForwardReceivingEnabled=M;g.shouldRenderStructuredRichResponseMsg=N;g.showBotSearchPlugin=O;g.isAiChatPersistentMetaAIBannerEnabled=P;g.getNonBlockingBotNoticeIds=Q;g.isAiChatPersistentMetaAIBannerLoggingEnabled=R;g.isAiChatBannerM2Enabled=S;g.isAiChatMetaAIGlassesBannerEnabled=T;g.getMasterBotNoticeId=U;g.getAiExperimentGraphqlConfig=V;g.getMetaAISearchNullStateSuggestionsUpdateIntervalMs=W;g.getMetaAISearchTypeAheadSuggestionsUpdateIntervalMs=X;g.getMetaAISearchTypeAheadSuggestionsLRUCacheCapacity=Y;g.isMetaAISearchExperienceEnabled=Z;g.getMetaAISearchNullStateRowCount=$;g.getMetaAISearchTypeAheadMaxSuggestionsCount=aa;g.canSearchMetaAiSuggestions=ba;g.isAiChatThreadsInfraEnabled=ca}),98);
__d("WAWebBotGenTypingIndicatorMsg",["WAWebABProps","WAWebBackendApi","WAWebBotGating","WAWebMsgKey","WAWebMsgType","WAWebWid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){f="bot_typing_placeholder";function a(a,b){h(a,b)&&void i(a)}function h(a,b){var e=d("WAWebBotGating").isBotEnabled()&&a.id instanceof c("WAWebWid")&&a.id.isBot();a=d("WAWebBotGating").isBizBot3pEnabled()&&((a=a.contact.businessProfile)==null?void 0:a.isBizBot3p)===!0;return(e||a)&&b.type!==d("WAWebMsgType").MSG_TYPE.PROTOCOL&&b.type===d("WAWebMsgType").MSG_TYPE.CHAT}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!d("WAWebBotGating").isBotEnabled())return;var b=a.id;if(b instanceof c("WAWebWid")&&!b.isBot()&&!((a=a.contact.businessProfile)!=null&&a.isBizBot3p))return;a=new(c("WAWebMsgKey"))({fromMe:!1,remote:b,id:c("WAWebMsgKey").newId_DEPRECATED()});d("WAWebBackendApi").frontendFireAndForget("addInitialBotTypingIndicatorToChat",{chatId:b,msgKey:a})});return j.apply(this,arguments)}function e(){var a=d("WAWebABProps").getABPropConfigValue("bonsai_ti_timeout_duration_ms");return a}g.BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE=f;g.maybeGenBotTypingIndicatorMessage=a;g.getBotTypingIndicatorTimeout=e}),98);
__d("WAWebPDFNTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({PDFN_ACCEPTED:"5"});b=Object.freeze({ACCEPTED:5,OK:155});c=Object.freeze({ACCEPTED:"ACCEPTED"});f.NOTICE_STAGES=a;f.DISCLOSURE_STAGE=b;f.NOTICE_STATUS=c}),66);
__d("WAWebBotTos",["WATimeUtils","WAWebBotGating","WAWebBotTosIds","WAWebBotTypes","WAWebPDFNTypes","WAWebSetUserDisclosureStageAction","WAWebTos","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h="BIZ_BOT_TOS_DISMISSED_AT";function a(){var a;return(a=d("WAWebBotGating").getNonBlockingBotNoticeIds())==null?void 0:a.some(function(a){return d("WAWebTos").TosManager.getState(String(a))==="ACCEPTED"})}function e(){return i()||j()||k()}function i(){return d("WAWebTos").TosManager.getState(d("WAWebBotTosIds").getBotAgentTosId())==="ACCEPTED"}function j(){return d("WAWebTos").TosManager.getState(d("WAWebBotTosIds").getBotInvokeTosId())==="ACCEPTED"}function k(){return d("WAWebTos").TosManager.getState(d("WAWebBotTosIds").getBotShortcutTosId())==="ACCEPTED"}function f(){var a=d("WAWebBotGating").getMasterBotNoticeId();return a==null?!1:d("WAWebTos").TosManager.getState(String(a))==="ACCEPTED"}function l(a){if(a===d("WAWebBotTypes").BizBotType.BIZ_1P&&!d("WAWebBotGating").isBizBotConsentRequired()||m())return!0;a=c("WAWebUserPrefsStore").getUser(h);if(typeof a!=="number")return!1;var b=d("WAWebBotGating").bizBotConsentDismissalCooldown();if(b<0)return!0;return b===0?!1:d("WATimeUtils").unixTime()-a<b}function m(){return d("WAWebTos").TosManager.getState(d("WAWebBotTosIds").getBizBotTosId())==="ACCEPTED"}function n(){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield v(Number(d("WAWebBotTosIds").getBotAgentTosId()))});return o.apply(this,arguments)}function p(){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield v(Number(d("WAWebBotTosIds").getBotInvokeTosId()))});return q.apply(this,arguments)}function r(){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield v(Number(d("WAWebBotTosIds").getBotShortcutTosId()))});return s.apply(this,arguments)}function t(){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield v(Number(d("WAWebBotTosIds").getBizBotTosId()))});return u.apply(this,arguments)}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebSetUserDisclosureStageAction").updateUserDisclosureStateAction(a,d("WAWebPDFNTypes").DISCLOSURE_STAGE.ACCEPTED)});return w.apply(this,arguments)}function x(){y(d("WATimeUtils").unixTime())}function y(a){c("WAWebUserPrefsStore").setUser(h,a)}function z(){return d("WAWebTos").TosManager.getState(d("WAWebBotTosIds").getUgcAiStudioTosId())==="ACCEPTED"}function A(a){var b=d("WAWebBotGating").getNonBlockingBotNoticeIds();return b.length===0?!1:b.includes(Number(a))}function B(a){if(A(Number(a)))return!0;var b=d("WAWebBotGating").getMasterBotNoticeId();return b!=null?!0:d("WAWebBotTosIds").supportedTosNoticeIds.has(a)}g.hasAcceptedNonBlockingBotTos=a;g.hasSeenBotTos=e;g.hasSeenAgentTos=i;g.hasSeenInvokeTos=j;g.hasSeenShortcutTos=k;g.hasSeenMasterBotTos=f;g.hasSeenBizBotTos=l;g.hasAcceptedBizBotTos=m;g.markSeenAgentTos=n;g.markSeenInvokeTos=p;g.markSeenShortcutTos=r;g.acceptBizBotTos=t;g.dismissBizBotTos=x;g.setBizBotTosDismissalTime=y;g.hasSeenUgcTos=z;g.isNonBlockingBotNotice=A;g.canShowBotTos=B}),98);
__d("WAWebWamEnumAdditionalCategoryType",[],(function(a,b,c,d,e,f){a=Object.freeze({META_AI_MODEL_BASE:1,META_AI_MODEL_PREMIUM:2});f.ADDITIONAL_CATEGORY_TYPE=a}),66);
__d("WAWebWamEnumBotDiscoveryPathType",[],(function(a,b,c,d,e,f){a=Object.freeze({CURATED_DISPLAY:1,SEARCH:2,VIEW_ALL:3,DEEPLINK_USER_SHARED:4,INFINITE_SCROLL:5});f.BOT_DISCOVERY_PATH_TYPE=a}),66);
__d("WAWebWamEnumBotEntryPointType",[],(function(a,b,c,d,e,f){a=Object.freeze({WA_CHAT:1,STATUS:2,NEW_CHAT:3,INVOKE:4,SHARED_AI:5,NOTIFICATION:6,BANNER:7,AI_CHATS_LIST_BUTTON:8,AI_CONTACT_ON_WA:9,DEEPLINK_USER_SHARED:10,DEEPLINK_QP:11,AI_SEARCH_CHATS_LIST:12,CHAT_INFO_PAGE:13,AI_VOICE:14,AI_CHAT_SHORTCUT:15,AI_IMAGINE_BOTTOM_SHEET:16,AI_HOME_PREVIEW:17,AI_SEARCH_CHATS_LIST_VOICE:18,AI_CHAT_THREAD_VOICE:19,AI_FAB_VOICE:20,CHAT_INFO_SETTINGS:21,CHAT_THREAD:22,AI_MEMORY_BOTTOM_SHEET:23,FORWARD:24,AI_MEMORY_SYSTEM_MESSAGE:25,AI_WIDGET:26,SHARE:27,AI_NEW_FAB_VOICE:28,AI_TAB_DISCOVERY:29,CHAT_LIST:30,AI_TAB:31,AI_HOME_IN_TAB:32,AI_NULL_STATE:33,AI_STUDIO_CREATION:34,AI_STUDIO_PROFILE_EDIT:35,BOT_SETTINGS:36,META_AI_LONG_PRESS_CONTEXT_MENU:37,FAB:38,AI_NEW_FAB_VOICE_CALL_HISTORY:39,AI_STUDIO_CREATION_FAB:40,INVOKE_META_AI_1ON1:41,INVOKE_META_AI_GROUP:42,AI_STUDIO_YOUR_AI:43,ASK_META_AI_CONTEXT_MENU:44});f.BOT_ENTRY_POINT_TYPE=a}),66);
__d("WAWebWamEnumChatFilterActionTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({OPEN:1,SELECT_FILTER:2,SEARCH_WITH_FILTER:3,SEARCH:4,SEARCH_ITEM_SELECTED:5,SEARCH_MSG_SENT:6,UNSELECT_FILTER:7,AUTO_CLEAR_FILTER:8,VIEW:9,GROUP_NAVIGATION:10,GROUP_DISCOVERY:11,GROUP_JOIN:12,SUBGROUP_SWITCHER_CLICK:13,SUBGROUP_MENTION_CLICK:14,COMMUNITY_RICH_SYSTEM_MESSAGE_CLICK:15,GROUP_SYSTEM_MESSAGE_CLICK:16,NESTING_VIEW_COMMUNITY_CLICK:17,SELECT_COMMUNITY_ADMINS_CAN_ADD_GROUPS:18,SELECT_EVERYONE_CAN_ADD_GROUPS:19,GROUP_JOIN_REQUEST:20,NOTIFICATION_RECEIVED:21,NOTIFICATION_RENDERED:22,TAP_TO_OPEN:23,TAP_TO_REPLY:24,VOIP_CALLBACK:25,VOIP_MESSAGE:26,VOIP_DECLINE:27,MARK_AS_READ:28,AI_NEW_CHAT_CLICK:29,AI_TAB_SELECTION_CLICK:30,AI_PERSONA_SELECTION_CLICK:31,AI_TOS_VIEW:32,AI_TOS_ACCEPT_CLICK:33,AI_TOS_DISMISS_CLICK:34,AI_NEW_UGC_CLICK:35,AI_UGC_CREATION_START_CLICK:36,AI_GENDER_AGE_SELECTION_CLICK:37,AI_PERSONALITY_SELECTION_CLICK:38,AI_INTEREST_SELECTION_CLICK:39,AI_AVATAR_SELECTION_CLICK:40,AI_NAME_SELECTION_CLICK:41,AI_UGC_CREATION_FINISH_CLICK:42,REQUEST_WAITLIST_DIALOG_APPEAR:43,REQUEST_WAITLIST_SELECT:44,FILTER_VIEWED:45,FILTER_EMPTY_STATE_VIEWED:46,BUSINESS_SERP_LOADED:47,BIZ_SEE_MORE_CLICKED:48,IMPRESSION:49,BIZ_SEARCH_SET_LOCATION_CLICKED:50,CLOSE_BTN_CLICKED:51,AI_CHAT_CLICK:52,NEW_CHAT_CLICK:53,SERP_LOADED:54,CLICK:55,ENTER:56,DISMISS:57,SEND_MESSAGE_SUCCESS:58,META_AI_MODEL_SETTING_SHOW:59,META_AI_MODEL_UPDATE:60,AI_CHARACTER_EXPLORE_CLICK:61,AI_CHARACTER_EXISTING_CHAT_CLICK:62,AI_CHARACTER_PREVIEWED:63,AI_CHARACTER_PROMPT_CLICK:64,AI_CHARACTER_START_CHATTING_CLICK:65,AI_CHARACTER_SHARE_CLICKED:66,AI_CHARACTER_CREATOR_PROFILE_CLICK:67,AI_TOS_DISMISS_NOT_ACCEPTED:68,AI_TOS_DISMISS_AUTO_ACCEPTED:69,AI_CHARACTER_CHAT_CLICK:70,AI_HOME_IMPRESSION:71,AI_VOICE_NUX_VIEW:72,AI_VOICE_NUX_ALLOW:73,AI_VOICE_NUX_DISMISS:74,AI_VOICE_MIC_PERMISSION_VIEW:75,AI_VOICE_MIC_PERMISSION_ALLOW:76,AI_VOICE_MIC_PERMISSION_DISMISS:77,AI_VOICE_AUDIO_RECORDING_PERMISSION_VIEW:78,AI_VOICE_AUDIO_RECORDING_PERMISSION_WHILE_USING_THE_APP_CLICK:79,AI_VOICE_AUDIO_RECORDING_PERMISSION_ONLY_THIS_TIME_CLICK:80,AI_VOICE_HALF_SHEET_VIEW:81,AI_VOICE_HALF_SHEET_CONNECT:82,AI_VOICE_FULL_SHEET_VIEW:83,SCAN:84,AI_VOICE_MIC_PERMISSION_REDIRECT_TO_SETTING:85,AI_VOICE_SEARCH_CHATS_LIST_CLICK:86,AI_VOICE_CHAT_THREAD_CLICK:87,AI_VOICE_FAB_CLICK:88,XMA_REELS_PLUGIN_PREVIEWED:89,XMA_REELS_CLICKED:90,AI_MEMORY_DELETE:91,AI_MEMORY_ALL_DELETE:92,AI_MEMORY_DISMISS_CLICK:93,AI_MEMORY_BOTTOM_SHEET_VIEW_ALL_CLICK:94,AI_MEMORY_VIEW:95,AI_MULTIMODAL_SESSION_BEGIN:96,AI_VOICE_TO_TEXT_TRANSITION:97,AI_VOICE_CONNECTION_ERROR:98,AI_VOICE_TAP_ICEBREAKER:99,AI_MULTIMODAL_HISTORY_FETCH:100,AI_LISTENING_ENABLE:101,AI_LISTENING_DISABLE:102,AI_TAB_CLICK:103,AI_TAB_IMPRESSION:104,AI_DISCOVERY_CLICK:105,AI_DISCOVERY_PREVIEW:106,AI_CHARACTER_AUDIO_MUTED:107,AI_CHARACTER_AUDIO_UNMUTED:108,AI_TAB_CHARACTER_PREVIEWED:109,AI_CHARACTER_IMPRESSION:110,AI_INLINE_TOS_RENDERED:111,AI_INLINE_TOS_VIEWED_ATTEMPT:112,AI_INLINE_TOS_VIEWED:113,AI_INITIATION_CONTINUE_ACCEPTED:114,NOVICE_AI_TAB_CLICK:115,AI_VOICE_BACKGROUND_CALL:116,AI_VOICE_FOREGROUND_CALL:119,AI_VOICE_START_CALL:120,AI_VOICE_END_CALL:121,AI_VOICE_AUTO_END_CALL:122,AI_NULL_STATE_PROMPT_SEND:125,AI_NULL_STATE_HISTORY_FETCH:126,AI_VOICE_CONVERSATION_STARTER_CLICK:127,AI_VOICE_START_VOICE_MODE:128,AI_VOICE_SEND_TEXT:129,AI_TOS_NOTICE_ID_ERROR:130,AI_HOME_PULL_TO_REFRESH:131,AI_VOICE_VIEW_VOICE_SELECTION:132,AI_VOICE_SKIP_VOICE_SELECTION:133,AI_VOICE_CANCEL_VOICE_SELECTION:134,AI_VOICE_SELECT_VOICE_SELECTION:135,AI_VOICE_ON_DEFAULT_ENABLED:136,AI_VOICE_ON_DEFAULT_DISABLED:137,AI_MEMORY_UPDATED:138,AI_CREATION_BUTTON_CLICK:139,AI_CREATION_TOS_PREVIEWED:140,AI_CREATION_PREVIEW:141,AI_CREATION_DESCRIPTION_SUBMIT:142,AI_CREATION_PERSONALITY_CATEGORY_PREVIEW:143,AI_CREATION_PERSONALITY_SUBMIT:144,AI_CREATION_AVATAR_CREATE_PREVIEWED:145,AI_CREATION_AVATAR_SUBMIT:146,AI_CREATION_AUDIENCE_PUBLIC:147,AI_CREATION_AUDIENCE_ONLY_ME:148,AI_CREATION_CONFIRMED:149,AI_CREATION_DELETION_STARTED:150,AI_CREATION_DELETION_COMPLETED:151,AI_CREATION_REPORT_STARTED:152,AI_CREATION_REPORT_COMPLETED:153,AI_CREATION_NAMING_PREVIEWED:154,AI_CREATION_NAMING_SUBMIT:155,AI_CREATION_INTRO_PREVIEWED:156,AI_CREATION_INTRO_SUBMIT:157,AI_CREATION_REVIEW_PREVIEWED:158,AI_CREATION_SUBMIT:159,AI_CHAT_THREAD_VOICE_VIEW:160,AI_VOICE_CONVERSATION_STARTER_VIEW:161,AI_HIDE_REQUEST_SUBMITTED:162,AI_CHARACTER_EXPLORE_VIEWED:163,META_AI_CHAT_THREAD_VIEWED_TEXT:164,META_AI_CHAT_THREAD_VIEWED_VOICE:165,TAP_TO_FORWARD:166,TAP_TO_COPY:167,TAP_TO_STAR:168,TAP_TO_DELETE:169,TAP_TO_REACT:170,SWIPE_TO_REPLY:171,AI_CREATION_AVATAR_EDIT_CLICK:172,AI_CREATION_AVATAR_CREATE_NEW:173,AI_CREATION_VOICE_SELECTION_PREVIEWED:174,AI_CREATION_NAMING_EDIT_SAVED:175,AI_CREATION_DESCRIPTION_EDIT_SAVED:176,AI_CREATION_INTRODUCTION_EDIT_SAVED:177,AI_CREATION_WELCOME_MSG_SAVED:178,AI_CREATION_ICEBREAKER_SAVED:179,AI_CREATION_INSTRUCTIONS_SAVED:180,AI_CREATION_INSTRUCTIONS_DELETED:181,AI_CREATION_EXAMPLE_DIALOG_SAVED:182,AI_CREATION_EXAMPLE_DIALOG_DELETED:183,AI_CREATION_ADVANCED_SETTINGS_PREVIEWED:184,AI_CREATION_VOICE_PREVIEWED:185,AI_CREATION_VOICE_SUBMIT:186,AI_VOICE_TOS_ACCEPT_CLICK:187,AI_VOICE_TOS_VIEW:188,AI_CREATION_AVATAR_REGENERATION:189,AI_VOICE_RING_TAP_CLICK:190,AI_VOICE_RING_UNDO_MUTE_UNMUTE:191,AI_HOME_BOUNCE:192,AI_CREATION_AVATAR_EDIT_BUTTON_CLICK:193,AI_CREATION_AVATAR_EDIT_DONE:194,AI_CREATION_AVATAR_EDIT_SUBMIT:195,AI_CREATION_AVATAR_CROP_CLICK:196,AI_CREATION_AVATAR_CROP_DONE:197,AI_CREATION_IMAGE_UPLOAD_CLICK:198,AI_CREATION_IMAGE_UPLOAD_DONE:199,AI_CREATION_AVATAR_EDIT_PREVIEWED:200,AI_CREATION_DISCARD_EDIT_DIALOG_PREVIEWED:201,AI_CREATION_DISCARD_EDIT_DIALOG_CONFIRMED:202,AI_HOME_BOUNCE_250MS:203,AI_HOME_BOUNCE_750MS:205,AI_HOME_BOUNCE_1000MS:206,AI_HOME_BOUNCE_2000MS:207,AI_HOME_BOUNCE_3000MS:208,AI_HOME_BOUNCE_5000MS:209,AI_PROACTIVE_MESSAGE_UPDATED:210,AI_PROACTIVE_MESSAGE_UPDATED_SUCCESS:211,AI_PROACTIVE_MESSAGE_UPDATED_FAILURE:212,AI_PROACTIVE_MESSAGE_DISMISS:213,AI_PROACTIVE_MESSAGE_VIEW:214,UGC_INTEREST_PAGE_IMPRESSION:215,MANAGE_INTERESTS_CLICK:216,EDIT_UGC_INTERESTS:217,INTEREST_PAGE_CONTINUE_CLICK:218,INTEREST_PAGE_EXIT:219,AI_CATEGORIES_CHANGE:220,AI_SCROLL_DEPTH_CHANGE:221,NUX_INTEREST_QUIZ_IMPRESSION:222,NUX_INTEREST_QUIZ_DISMISSED:223,INTEREST_PAGE_DONE_CLICK:224,NUX_INTEREST_QUIZ_CONTINUE_CLICK:225,AI_CHARACTER_HIDE:226,AI_CHARACTER_UNHIDE:227});f.CHAT_FILTER_ACTION_TYPES=a}),66);
__d("WAWebWamEnumDiscoveryOriginType",[],(function(a,b,c,d,e,f){a=Object.freeze({AI_TAB:1,AI_HOME:2,AI_HOME_IN_TAB:3});f.DISCOVERY_ORIGIN_TYPE=a}),66);
__d("WAWebWamEnumInlineTosStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({SUCCESS:1,FAIL:2});f.INLINE_TOS_STATUS=a}),66);
__d("WAWebWamEnumInputType",[],(function(a,b,c,d,e,f){a=Object.freeze({SUGGESTION:1,USER_INPUT:2,USER_INPUT_AND_SUGGESTION:3});f.INPUT_TYPE=a}),66);
__d("WAWebBotJourneyWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAdditionalCategoryType","WAWebWamEnumBotDiscoveryPathType","WAWebWamEnumBotEntryPointType","WAWebWamEnumChatFilterActionTypes","WAWebWamEnumDiscoveryOriginType","WAWebWamEnumInlineTosStatus","WAWebWamEnumInputType","WAWebWamEnumTsSurface"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({BotJourney:[4630,{actionType:[1,d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES],additionalCategory:[11,d("WAWebWamEnumAdditionalCategoryType").ADDITIONAL_CATEGORY_TYPE],aiCreationAvatarCropChanges:[38,a.TYPES.STRING],aiCreationInputType:[29,d("WAWebWamEnumInputType").INPUT_TYPE],aiCreationPersonalityCategoryInsert:[26,a.TYPES.STRING],aiCreationPersonalityCategorySelect:[27,a.TYPES.STRING],aiDiscoveryTab:[4,a.TYPES.STRING],aiSessionId:[18,a.TYPES.STRING],aiVoiceOnSelectionDefault:[24,a.TYPES.BOOLEAN],aiVoiceSelectionEnum:[25,a.TYPES.STRING],appSessionId:[2,a.TYPES.STRING],botDiscoveryPath:[8,d("WAWebWamEnumBotDiscoveryPathType").BOT_DISCOVERY_PATH_TYPE],botEntryPoint:[7,d("WAWebWamEnumBotEntryPointType").BOT_ENTRY_POINT_TYPE],botPersonaId:[5,a.TYPES.STRING],callRandomId:[13,a.TYPES.STRING],categoryType:[40,a.TYPES.STRING],conversationStarterCategory:[22,a.TYPES.STRING],conversationStarterIndex:[23,a.TYPES.INTEGER],conversationStarterPromptMode:[28,a.TYPES.STRING],deviceLanguage:[16,a.TYPES.STRING],discoveryOrigin:[19,d("WAWebWamEnumDiscoveryOriginType").DISCOVERY_ORIGIN_TYPE],hasContinueChatting:[41,a.TYPES.BOOLEAN],hasYourAiCategory:[42,a.TYPES.BOOLEAN],inlineTosNoticeId:[20,a.TYPES.STRING],inlineTosStatus:[21,d("WAWebWamEnumInlineTosStatus").INLINE_TOS_STATUS],interestCategoriesSelected:[39,a.TYPES.INTEGER],isCache:[45,a.TYPES.BOOLEAN],isMetaAiAssistant:[12,a.TYPES.BOOLEAN],isMetaAiCharacterBotChat:[9,a.TYPES.BOOLEAN],isUserCreatedAgent:[10,a.TYPES.BOOLEAN],metricCount:[17,a.TYPES.INTEGER],scrollDepth:[44,a.TYPES.INTEGER],scrollFetchLatency:[43,a.TYPES.INTEGER],uiSurface:[6,d("WAWebWamEnumTsSurface").TS_SURFACE],xmaReelIndex:[14,a.TYPES.INTEGER],xmaReelMaxIndex:[15,a.TYPES.INTEGER]},[1,1,1],"regular"]},{BotJourney:[[[],["appSessionId","actionType","botEntryPoint"],[]]]});g.BotJourneyWamEvent=b}),98);
__d("WAWebBotUtils",["WAWebWidFactory"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WAWebWidFactory").createUserWidOrThrow("13135550002@c.us"),i=d("WAWebWidFactory").createUserWidOrThrow("867051314767696@bot");function a(a){return a.equals(h)||a.equals(i)}g.META_BOT_PN_WID=h;g.META_BOT_FBID_WID=i;g.isMetaAiBot=a}),98);
__d("WAWebGetSharedSessionId",["WAWebPonyfillsCryptoRandomUUID"],(function(a,b,c,d,e,f,g){var h=c("WAWebPonyfillsCryptoRandomUUID")();function a(){return h}g.getSharedSessionId=a}),98);
__d("WAWebBotLogging",["$InternalEnum","WAWebBotJourneyWamEvent","WAWebBotUtils","WAWebChatEntryPoint","WAWebGetSharedSessionId","WAWebWamEnumBotEntryPointType","WAWebWamEnumChatFilterActionTypes"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum").Mirrored(["Agent","Shortcut","Invoke","Search"]),i=b("$InternalEnum").Mirrored(["View","Accept","Dismiss"]),j=function(){var a=new Set();h.members().forEach(function(b){$$gen$m0:{if(b===h.Agent||b===h.Shortcut){a.add(b);break $$gen$m0}if(b===h.Search||b===h.Invoke)break $$gen$m0;throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+b)}});return a}(),k=function(){var a=new Set();d("WAWebChatEntryPoint").ChatEntryPoint.members().forEach(function(b){$$gen$m1:{if(b===d("WAWebChatEntryPoint").ChatEntryPoint.MetaAINullStateSuggestion||b===d("WAWebChatEntryPoint").ChatEntryPoint.MetaAITypeaheadSuggestion){a.add(b);break $$gen$m1}if(b===d("WAWebChatEntryPoint").ChatEntryPoint.BotChatListShortcut||b===d("WAWebChatEntryPoint").ChatEntryPoint.Chatlist||b===d("WAWebChatEntryPoint").ChatEntryPoint.ChatsTab||b===d("WAWebChatEntryPoint").ChatEntryPoint.CommunitiesTab||b===d("WAWebChatEntryPoint").ChatEntryPoint.ContactInfo||b===d("WAWebChatEntryPoint").ChatEntryPoint.Deeplink||b===d("WAWebChatEntryPoint").ChatEntryPoint.DirectMessage||b===d("WAWebChatEntryPoint").ChatEntryPoint.ForwardedNewsletterMessage||b===d("WAWebChatEntryPoint").ChatEntryPoint.Link||b===d("WAWebChatEntryPoint").ChatEntryPoint.Mention||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsLetterRecommendation||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterAdminInviteAcceptModal||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterCTAOnStatus||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterChatlist||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterCreationFlow||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterDirectory||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterDirectoryCategory||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterDirectoryCategorySearch||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterDirectorySearch||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterIntegrity||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCard||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCardButton||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterPostLinkCard||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterUpdatesTab||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterUpdatesTabSearch||b===d("WAWebChatEntryPoint").ChatEntryPoint.NewslettersTab||b===d("WAWebChatEntryPoint").ChatEntryPoint.Notification||b===d("WAWebChatEntryPoint").ChatEntryPoint.PrivateReply||b===d("WAWebChatEntryPoint").ChatEntryPoint.SimilarNewsletters||b===d("WAWebChatEntryPoint").ChatEntryPoint.Unknown||b===d("WAWebChatEntryPoint").ChatEntryPoint.Vcard||b===d("WAWebChatEntryPoint").ChatEntryPoint.VoipWindow)break $$gen$m1;throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+b)}});return a}();function l(a){switch(a){case h.Agent:return d("WAWebWamEnumBotEntryPointType").BOT_ENTRY_POINT_TYPE.AI_CONTACT_ON_WA;case h.Shortcut:return d("WAWebWamEnumBotEntryPointType").BOT_ENTRY_POINT_TYPE.AI_CHATS_LIST_BUTTON;case h.Invoke:return d("WAWebWamEnumBotEntryPointType").BOT_ENTRY_POINT_TYPE.INVOKE;case h.Search:return d("WAWebWamEnumBotEntryPointType").BOT_ENTRY_POINT_TYPE.AI_SEARCH_CHATS_LIST}}function m(a){switch(a){case i.View:return d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.AI_TOS_VIEW;case i.Accept:return d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.AI_TOS_ACCEPT_CLICK;case i.Dismiss:return d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.AI_TOS_DISMISS_CLICK}}function a(a){if(!j.has(a))return;a=new(d("WAWebBotJourneyWamEvent").BotJourneyWamEvent)({appSessionId:d("WAWebGetSharedSessionId").getSharedSessionId(),actionType:d("WAWebWamEnumChatFilterActionTypes").CHAT_FILTER_ACTION_TYPES.AI_CHAT_CLICK,botEntryPoint:l(a)});a.commit()}function c(a,b){b=new(d("WAWebBotJourneyWamEvent").BotJourneyWamEvent)({appSessionId:d("WAWebGetSharedSessionId").getSharedSessionId(),actionType:m(b),botEntryPoint:l(a)});b.commit()}function e(a,b){if(k.has(b))return h.Search;return b===d("WAWebChatEntryPoint").ChatEntryPoint.BotChatListShortcut||d("WAWebBotUtils").isMetaAiBot(a)?h.Shortcut:h.Agent}g.BotEntryPointType=h;g.BotTosActionType=i;g.logAiChatClickBotJourneyEvent=a;g.logAiTosBotJourneyEvent=c;g.getBotEntryPoint=e}),98);
__d("WAWebBotTosIds",["WAWebABProps","WAWebBotGating","WAWebBotLogging"],(function(a,b,c,d,e,f,g){var h="20230901",i="20230902",j="20240216",k="20231027",l="20240729";a=new Set([h,i,j]);var m=function(){var a=d("WAWebABProps").getABPropConfigValue("ai_pdfn_tos_shortcut_notice_id").trim();a=a!=null&&a!==""?a:h;return a},n=function(){var a=d("WAWebABProps").getABPropConfigValue("ai_pdfn_tos_shortcut_notice_id").trim();a=a!=null&&a!==""?a:j;return a},o=function(){var a=d("WAWebABProps").getABPropConfigValue("ai_pdfn_tos_invoke_notice_id").trim();a=a!=null&&a!==""?a:i;return a};b=function(){return k};c=function(a){var b=d("WAWebBotGating").getMasterBotNoticeId();if(b!=null)return b;switch(a){case d("WAWebBotLogging").BotEntryPointType.Shortcut:case d("WAWebBotLogging").BotEntryPointType.Search:return Number(n());case d("WAWebBotLogging").BotEntryPointType.Invoke:return Number(o());case d("WAWebBotLogging").BotEntryPointType.Agent:return Number(m())}};e=function(){return l};g.supportedTosNoticeIds=a;g.getBotAgentTosId=m;g.getBotShortcutTosId=n;g.getBotInvokeTosId=o;g.getBizBotTosId=b;g.getApplicableBotNoticeId=c;g.getUgcAiStudioTosId=e}),98);
__d("WAWebRichResponseParseUtils",["WALogger","WAWebBotGating","WAWebProtobufsAICommon.pb","WAWebRichResponse.flow","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){return{type:d("WAWebRichResponse.flow").RichResponseFragmentType.Unknown,fragment:a}}function a(a,b){return{parseState:d("WAWebRichResponse.flow").RichResponseParseState.Unparsed,type:a,fragments:b.map(j)}}function b(a){try{var b=a.type,c=a.fragments;b=k(b);c=c.map(m);return w(b,c)}catch(b){return a}}function k(a){return typeof a==="string"?a:l(a)}function l(a){switch(a){case d("WAWebProtobufsAICommon.pb").AIRichResponseMessageType.AI_RICH_RESPONSE_TYPE_STANDARD:return d("WAWebRichResponse.flow").ParsedRichResponseType.Standard;case d("WAWebProtobufsAICommon.pb").AIRichResponseMessageType.AI_RICH_RESPONSE_TYPE_UNKNOWN:throw c("err")("parseRichResponseType: Unknown rich response type")}}function m(a){if(a.type!==d("WAWebRichResponse.flow").RichResponseFragmentType.Unknown)return a;try{return n(a.fragment)}catch(b){return a}}function n(a){if(a.messageType==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Empty rich response submessage type"]))).tags("wa-web-ai-logging").devConsole(a).sendLogs("empty-rich-response-submessage-type",{sampling:.001});throw c("err")("getRichResponseFragmentFromSubmessage: Missing message type")}switch(a.messageType){case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_TEXT:return r(a);case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_CODE:case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_DYNAMIC:case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_GRID_IMAGE:case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_INLINE_IMAGE:break;case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_TABLE:return s(a);case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_CONTENT_ITEMS:return u(a);case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_UNKNOWN:case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_LATEX:case d("WAWebProtobufsAICommon.pb").AIRichResponseSubMessageType.AI_RICH_RESPONSE_MAP:break}throw c("err")("Unsupported rich response fragment type")}function o(a){return a.type!==d("WAWebRichResponse.flow").RichResponseFragmentType.Unknown}function p(a){return a.type===d("WAWebRichResponse.flow").RichResponseFragmentType.Unknown}function q(a,b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unknown rich response submessage was of type ",""])),b).tags("wa-web-ai-logging").devConsole(a).sendLogs("missing-rich-submessage-"+b+"-type-"+b,{sampling:.001})}function r(a){var b=a.messageText;if(b==null){q(a,"text");throw c("err")("parseRichResponseTextSubmessage: Missing message text")}return{type:d("WAWebRichResponse.flow").RichResponseFragmentType.Text,text:b}}function s(a){if(!d("WAWebBotGating").isRichResponseTableReceiverEnabled())throw c("err")("getRichResponseFragmentFromSubmessage: Table receiver prop is off");a=a.tableMetadata;if(a==null)throw c("err")("Missing table");a=a.rows.map(function(a){var b;return{isHeading:(b=a.isHeading)!=null?b:!1,items:a.items}});return{type:d("WAWebRichResponse.flow").RichResponseFragmentType.Table,table:a}}function t(a,b){var d=b.title,e=b.profileIconUrl,f=b.thumbnailUrl;b=b.videoUrl;if(d==null||e==null||f==null||b==null){q(a,"Inline Reels - Missing fields");throw c("err")("Missing reel item fields")}return{title:d,profileIconUrl:e,thumbnailUrl:f,videoUrl:b}}function u(a){var b=a.contentItemsMetadata;if(b==null)throw c("err")("Missing content items");b=b.itemsMetadata.map(function(b){b=b.reelItem;if(b!=null&&d("WAWebBotGating").isRichResponseInlineReelsReceiverEnabled())return t(a,b)}).filter(Boolean);if(b==null||b.length===0)throw c("err")("Unsupported ContentItems Type");return{type:d("WAWebRichResponse.flow").RichResponseFragmentType.ContentItems,contentItem:{type:d("WAWebRichResponse.flow").RichResponseContentItemsType.Carousel,items:b}}}function v(a){return a.reduce(function(a,b){o(b)&&a.push(b);return a},[])}function w(a,b){if(b.every(p))throw c("err")("No fragments parsed");return b.every(o)?{parseState:d("WAWebRichResponse.flow").RichResponseParseState.Parsed,type:a,fragments:v(b)}:{parseState:d("WAWebRichResponse.flow").RichResponseParseState.Partial,type:a,fragments:b}}g.generateFutureproofRichResponse=a;g.parseRichResponse=b}),98);
__d("WAWebParseChatMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebParseExtendedTextMessageProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;var e=b.conversation,f=b.extendedTextMessage;if(e==null&&f==null)return;if(e!=null)return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(e)}),contextInfo:void 0};if(d("WAWebParseExtendedTextMessageProtoUtils").isUrlExtendedTextMessage(f))return;return d("WAWebParseExtendedTextMessageProtoUtils").parseExtendedTextMessageProto({messageProtobuf:b,baseMessage:c,msgContext:a})}g["default"]=a}),98);
__d("WAWebParseExtendedTextUrlChatMessageProto",["WAWebMsgType","WAWebParseExtendedTextMessageProtoUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.rcat;a=a.msgContext;var f=b.extendedTextMessage;if(f==null)return;if(!d("WAWebParseExtendedTextMessageProtoUtils").isUrlExtendedTextMessage(f))return;b=d("WAWebParseExtendedTextMessageProtoUtils").parseExtendedTextMessageProto({messageProtobuf:b,baseMessage:c,msgContext:a});a=babelHelpers["extends"]({},c,b==null?void 0:b.msgData,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,subtype:"url",rcat:e});return{msgData:a,contextInfo:f==null?void 0:f.contextInfo}}g["default"]=a}),98);
__d("WAWebParseExtendedTextMessageProtoUtils",["WALongInt","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){return Boolean(a==null?void 0:a.matchedText)||Boolean(a==null?void 0:a.description)||Boolean(a==null?void 0:a.title)}function b(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.extendedTextMessage;if(b==null)return;var c=d("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$FontType,e;if((b==null?void 0:b.font)!=null)switch(b.font){case c.SYSTEM:case c.SYSTEM_TEXT:case c.FB_SCRIPT:case c.SYSTEM_BOLD:case c.MORNINGBREEZE_REGULAR:case c.CALISTOGA_REGULAR:case c.EXO2_EXTRABOLD:case c.COURIERPRIME_BOLD:e=b.font;break}c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.CHAT,kind:d("WAWebMsgType").MsgKind.Chat,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((b==null?void 0:b.text)||""),matchedText:b==null?void 0:b.matchedText,description:b==null?void 0:b.description,title:b==null?void 0:b.title,thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.jpegThumbnail)||"",richPreviewType:b==null?void 0:b.previewType,doNotPlayInline:b==null?void 0:b.doNotPlayInline,textColor:b==null?void 0:b.textArgb,backgroundColor:b==null?void 0:b.backgroundArgb,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.mediaKey),mediaKeyTimestamp:(b==null?void 0:b.mediaKeyTimestamp)!=null?d("WALongInt").numberOrThrowIfTooLarge(b.mediaKeyTimestamp):a.mediaKeyTimestamp,thumbnailDirectPath:b==null?void 0:b.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(b==null?void 0:b.thumbnailEncSha256),thumbnailHeight:b==null?void 0:b.thumbnailHeight,thumbnailWidth:b==null?void 0:b.thumbnailWidth,inviteGrpType:(b==null?void 0:b.inviteLinkGroupTypeV2)!=null?d("WAWebE2EProtoParserApi").parseInviteGrpType(b==null?void 0:b.inviteLinkGroupTypeV2):a.inviteGrpType,font:e!=null?e:a.font,paymentLinkMetadata:b==null?void 0:b.paymentLinkMetadata,faviconMMSMetadata:h(b==null?void 0:b.faviconMMSMetadata,a.mediaKeyTimestamp)});return{msgData:c,contextInfo:b==null?void 0:b.contextInfo}}function h(a,b){return a==null?null:{mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(a.mediaKey),mediaKeyTimestamp:a.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(a.mediaKeyTimestamp):b,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(a.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(a.thumbnailEncSha256),thumbnail:null}}g.isUrlExtendedTextMessage=a;g.parseExtendedTextMessageProto=b;g.parseFaviconMMSMetadata=h}),98);
__d("WAWebAddonCreateMsgProcessor",["WAWebAddonConstants"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.Regular})}function b(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.DualEncrypted})}function c(a){return babelHelpers["extends"]({},a,{type:d("WAWebAddonConstants").AddonProcessorType.DualEncryptedWithMessageTraits})}g.createAddonMsgProcessor=a;g.createAddonMsgProcessorDualEncrypted=b;g.createAddonMessageProcessorDualEncryptedWithMessageTraits=c}),98);
__d("WAWebAddonCommentMsgProcessor",["Promise","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebApiChat","WAWebBackendApi","WAWebCommentParseWebMsgInfoComment","WAWebCommentUtils","WAWebDBCommentMessageSerialization","WAWebLastAddOnDBSerialization","WAWebMsgType","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=d("WAWebAddonCreateMsgProcessor").createAddonMessageProcessorDualEncryptedWithMessageTraits({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(a){a=d("WAWebCommentParseWebMsgInfoComment").parseWebMsgInfoComment(a);return(h||(h=b("Promise"))).resolve(a)},toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.CommentEncrypted?a:d("WAWebCommentUtils").commentMsgDataToEncCommentMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.CommentDecrypted?a:d("WAWebCommentUtils").encCommentMsgDataToCommentMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("upsertCommentModelCollection",{comments:a.add,commentsToRemove:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;var c=[];for(a of a)if(a.kind===d("WAWebMsgType").MsgKind.CommentEncrypted){var e=(yield i.convert.toDualDecryptedMsgData(a,b.getForAddon(a)));c.push(e)}else c.push(a);return c});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.processMode,e=b.parents,f=b.existingPlaceholderKeys;if(c===d("WAWebAddonConstants").AddonProcessMode.SendRetry)return;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromCommentRowType(d("WAWebDBCommentMessageSerialization").dbRowFromCommentMessage(a))}));if(c===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b=f.size>0?a.filter(function(a){return!f.has(a.id.toString())}):a;yield d("WAWebCommentUtils").updateReplyCount(b,e,[]);c=(yield d("WAWebCommentUtils").genChatIdToLastTimestamp(a));yield d("WAWebApiChat").latestChatBulkUpdates(c);d("WAWebBackendApi").frontendFireAndForget("updateChatToLatest",{chatIdToLatestUpdates:c})});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("WAWebBackendApi").frontendFireAndForget("handleCommentNotification",{comments:a.add,revokes:a.remove})});function c(b){return a.apply(this,arguments)}return c}()});a=i;g["default"]=a}),98);
__d("WAWebApiUpdateReplyCount",["WAWebSchemaMessage","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=[];for(a of a){var e=a[0],f=a[1],g=b.getByParentMsgKey(e);if(g==null)continue;g=(g=g.replyCount)!=null?g:0;c.push({id:e,replyCount:g+f})}yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)});return h.apply(this,arguments)}g.updateReplyCountInParentMsgs=a}),98);
__d("WAWebCommentGroupBy",[],(function(a,b,c,d,e,f){function a(a,b){var c=new Map();for(a of a){var d,e=a.parentMsgKey.toString();d=(d=c.get(e))!=null?d:0;c.set(e,d+1)}for(e of b){d=e.parentMsgKey.toString();b=(a=c.get(d))!=null?a:0;c.set(d,b-1)}return c}f.commentCountByParents=a}),66);
__d("WAWebCommentMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_COMMENT_ENC_IV:"comment_missing_enc_iv",MISSING_COMMENT_ENC_PAYLOAD:"comment_missing_enc_payload",MISSING_COMMENT_MESSAGE_KEY:"comment_missing_target_message_key",INVALID_COMMENT_ENC_IV:"comment_invalid_enc_iv",MISSING_COMMENT_SENDER:"comment_missing_sender",MISSING_MESSAGE_SECRET:"comment_parent_missing_message_secret",MISSING_ORIGINAL_MESSAGE_SENDER:"comment_missing_original_message_sender",MISSING_COMMENT_CONTENT:"comment_missing_comment_content"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="CommentMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.CommentMessageValidationErrorCode=a;g.CommentMessageValidationError=c}),98);
__d("WAWebCommentMsgDataConversion",["WANullthrows","WAWebCommentMessageValidationError","WAWebMsgType","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function h(a){var b;return(b=a.conversation)!=null?b:(b=a.extendedTextMessage)==null?void 0:b.text}function a(a,b){a=h(a);if(a==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_CONTENT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{ack:b.ack,body:a,from:b.from,to:b.to,id:b.id,parentMsgKey:b.targetMessageKey,author:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(b.author)),t:b.t,type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,read:!1}}g.extractCommentTextFromMessage=h;g.convertMessageToCommentMsgData=a}),98);
__d("WAWebReferentialMsgKey",["WAWebMsgKey","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){if(a.broadcastId&&d("WAWebWidFactory").isWidlike(a.broadcastId)){var b=a.id;return new(c("WAWebMsgKey"))({fromMe:b.fromMe,remote:d("WAWebWidFactory").createWidFromWidLike(a.broadcastId),id:b.id,participant:b.remote})}return a.id}g.getReferentialMsgKey=a}),98);
__d("WAWebCommentUtils",["WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebApiUpdateReplyCount","WAWebBackendApi","WAWebCommentGroupBy","WAWebCommentMsgDataConversion","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessCommentMsg","WAWebReferentialMsgKey","WAWebSchemaChat","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();for(a of a){var c=a.id.remote.toString(),e=a.t;if(e==null)continue;var f=b.get(c);b.set(c,{id:c.toString(),t:Math.max(e,(c=f==null?void 0:f.t)!=null?c:0),unreadCount:(f==null?void 0:f.unreadCount)!=null?f.unreadCount+1:1})}for(e of b.entries()){c=e[0];f=e[1];a=(yield d("WAWebSchemaChat").getChatTable().get(c));a!=null&&f.unreadCount!=null&&(f.unreadCount+=a.unreadCount)}c=Array.from(b.values());return c});return h.apply(this,arguments)}function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=self.crypto.getRandomValues(new Uint8Array(12));e={type:d("WAWebMsgType").MsgKind.CommentDecrypted,encode:e};var g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.CommentDecrypted,a);e=(yield d("WAWebAddonEncryption").encryptAddOn(e,{messageSecret:g,iv:f,originalMessageSender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))),addOnSender:d("WAWebWidFactory").asUserWidOrThrow(b),stanzaId:a.id.id}));g=e.encPayload;b=e.reportingTokenContent;return babelHelpers["extends"]({encIv:f.buffer,encPayload:g,targetMessageKey:d("WAWebReferentialMsgKey").getReferentialMsgKey(a)},b!=null&&{reportingTokenContent:b})});return j.apply(this,arguments)}function e(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("WAWebCommentGroupBy").commentCountByParents(a,c);yield d("WAWebApiUpdateReplyCount").updateReplyCountInParentMsgs(a,b);d("WAWebBackendApi").frontendFireAndForget("updateReplyCount",{replyCountMap:a})});return k.apply(this,arguments)}function f(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebProcessCommentMsg").processEncCommentMsg(a,b));return d("WAWebCommentMsgDataConversion").convertMessageToCommentMsgData(b,a)});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e={conversation:a.body};a.messageSecret!=null&&(e.messageContextInfo={messageSecret:a.messageSecret.buffer,threadId:[]});var f=d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)));return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),yield i(b,f,e),{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:a.t,addonEncrypted:!0,ack:a.ack,messageSecret:a.messageSecret})});return n.apply(this,arguments)}g.genChatIdToLastTimestamp=a;g.getEncCommentsFields=i;g.updateReplyCount=e;g.encCommentMsgDataToCommentMsgData=f;g.commentMsgDataToEncCommentMsgData=m}),98);
__d("WAWebProcessCommentMsg",["WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebCommentMessageValidationError","WAWebHandleMsgValidate","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=a.targetMessageKey,e=a.encIv,f=a.encPayload;if(e==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);c=a.author?a.author:a.id.participant;var g=d("WAWebMsgGetters").getOriginalSender(b);if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_ORIGINAL_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.CommentEncrypted,encryptedAddOn:f};var h=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.CommentEncrypted,b);f=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:h,iv:e,stanzaId:b.id.id,originalMessageSender:g,addOnSender:d("WAWebWidFactory").asUserWidOrThrow(c)}));h=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,f);g=(b=(e=h.messageContextInfo)==null?void 0:e.messageSecret)!=null?b:a.messageSecret;c=babelHelpers["extends"]({},a,{plainProtobufBytes:new Uint8Array(f)});g!=null&&(c.messageSecret=new Uint8Array(g));yield d("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:[c],forceDualEncryptedValidation:!0});return h});return h.apply(this,arguments)}g.processEncCommentMsg=a}),98);
__d("WAWebDBCommentMessageSerialization",["WANullthrows","WAWebDBMessageSerialization","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){a=babelHelpers["extends"]({},a);d("WAWebDBMessageSerialization").movEncFieldToOpaqueData(a);return babelHelpers["extends"]({},a,{msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),sender:a.author.toString()})}function b(a){var b;return{msgKey:a.id.toString(),sender:c("WANullthrows")(d("WAWebMsgGetters").getSender(a),"undefined sender").toString(),parentMsgKey:a.parentMsgKey.toString(),t:d("WAWebMsgGetters").getT(a),ack:(b=d("WAWebMsgGetters").getAck(a))!=null?b:void 0,read:a.read,isOverwrittenByRevoke:!0,subtype:a.subtype,revokeTimestamp:a.revokeTimestamp,protocolMessageKey:a.protocolMessageKey.toString()}}function e(a){return{isPlaceholder:!0,msgKey:a.id.toString(),sender:c("WANullthrows")(d("WAWebMsgGetters").getSender(a),"undefined sender").toString(),parentMsgKey:a.parentMsgKey.toString(),read:a.read,t:d("WAWebMsgGetters").getT(a)}}function f(a){var b=c("WAWebMsgKey").from(a.msgKey),e=c("WAWebMsgKey").from(a.parentMsgKey);e=babelHelpers["extends"]({id:b,parentMsgKey:e,ack:a.ack,t:a.t},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE});if(a.isOverwrittenByRevoke===!0){return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.REVOKED,kind:d("WAWebMsgType").MsgKind.RevokedAddon,subtype:c("WANullthrows")(a.subtype),revokeAddonType:d("WAWebMsgType").MSG_TYPE.COMMENT,revokeTimestamp:(b=a.revokeTimestamp)!=null?b:void 0,protocolMessageKey:c("WAWebMsgKey").from(c("WANullthrows")(a.protocolMessageKey,"undefined protocolMessageKey"))})}if(a.isPlaceholder===!0)return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.CIPHERTEXT,kind:d("WAWebMsgType").MsgKind.PlaceholderAddon,realType:d("WAWebMsgType").MSG_TYPE.COMMENT});b=babelHelpers["extends"]({},a);d("WAWebDBMessageSerialization").movFieldFromOpaqueDataBackToMsg(b);return babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,from:d("WAWebWidFactory").createUserWidOrThrow(b.sender),body:b.body,author:d("WAWebWidFactory").createUserWidOrThrow(b.sender),read:(e=a.read)!=null?e:!1})}g.dbRowFromCommentMessage=a;g.dbRowFromRevokedMsgData=b;g.dbRowFromPlaceholderAddon=e;g.commentMessageFromDbRow=f}),98);
__d("WAWebCommentParseWebMsgInfoComment",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebCommentMsgDataConversion","WAWebMsgKeyUtils","WAWebMsgType","WAWebParseWebMessageInfoApi","WAWebViewMode.flow"],(function(a,b,c,d,e,f,g){var h,i;function j(a){var b,e=a.webMsgInfo;a=a.isFromCag;var f=e==null||(b=e.message)==null?void 0:b.commentMessage,g=e==null?void 0:e.commentMetadata,k=[];if(e==null||(g==null?void 0:g.commentParentKey)==null)return k;a=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e.key,a,e.participant));a=a.msgKey;var l=c("WANullthrows")(e.messageTimestamp),m;(f==null?void 0:f.message)!=null&&(m=d("WAWebCommentMsgDataConversion").extractCommentTextFromMessage(f.message));if(m==null){g=c("WANullthrows")(d("WAWebParseWebMessageInfoApi").buildMsgKey(e,c("WANullthrows")(g==null?void 0:g.commentParentKey)));g=g.msgKey;try{var n=d("WAWebParseWebMessageInfoApi").parseMsgStubProto(e,j);g=babelHelpers["extends"]({id:a,parentMsgKey:g},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{revokeAddonType:d("WAWebMsgType").MSG_TYPE.COMMENT,protocolMessageKey:n.protocolMessageKey,subtype:n.subtype,kind:d("WAWebMsgType").MsgKind.RevokedAddon,revokeTimestamp:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(e.revokeMessageTimestamp)),type:d("WAWebMsgType").MSG_TYPE.REVOKED,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:d("WALongInt").numberOrThrowIfTooLarge(l)});k.push(g)}catch(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[parseWebMsgInfoComment] has revoke stub ",", parameters ",""])),Boolean(e.messageStubType),(n=e.messageStubParameters)==null?void 0:n.length);d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[parseWebMsgInfoComment] failed to parse comment revoke "," with error ",""])),e.key.id,a).sendLogs("parse-comment-revoke",{sampling:.01})}}else if(f!=null){g=c("WANullthrows")(f.targetMessageKey);n=c("WANullthrows")(d("WAWebParseWebMessageInfoApi").buildMsgKey(e,g));f=n.msgKey;k.push(babelHelpers["extends"]({id:a,parentMsgKey:f},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{body:m,type:d("WAWebMsgType").MSG_TYPE.COMMENT,read:!0,kind:d("WAWebMsgType").MsgKind.CommentDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,t:d("WALongInt").numberOrThrowIfTooLarge(l)}))}return k}g.parseWebMsgInfoComment=j}),98);
__d("WAWebParseEncCommentMessageProto",["WAWebCommentMessageValidationError","WAWebE2EProtoUtils","WAWebMsgType","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encCommentMessage;if(b==null)return;var c=b.encIv,e=b.encPayload;b=b.targetMessageKey;if(c==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,a);if(b==null)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.MISSING_COMMENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(c.byteLength!==12)throw new(d("WAWebCommentMessageValidationError").CommentMessageValidationError)(d("WAWebCommentMessageValidationError").CommentMessageValidationErrorCode.INVALID_COMMENT_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.COMMENT,kind:d("WAWebMsgType").MsgKind.CommentEncrypted,addonEncrypted:!0,encIv:c,encPayload:e,targetMessageKey:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebGalaxyFlowFeatureSupport",["WALogger","WAWebABProps","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebPrimaryFeaturesModel"],(function(a,b,c,d,e,f,g){var h,i=3;function j(a){return a.wa_flow_response_params!=null||a.flow_message_version!=null&&+a.flow_message_version>=i}function k(a){if(a==null)return null;try{return JSON.parse(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to parse button params JSON: ",""])),a).devConsole(a);return null}}function l(a){if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE){var b,e=a==null||(b=a.interactivePayload)==null?void 0:b.buttons;if(e!=null&&e.length>0){return(e=e.find(function(a){return a.name===c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW}))==null?void 0:e.buttonParamsJson}}if(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE){var f;return a==null||(f=a.interactivePayload)==null?void 0:f.buttonParamsJson}return null}function a(a,b,e){if(!d("WAWebABProps").getABPropConfigValue("flows_wa_web"))return!1;e=e!=null?e.galaxyFlowDisabled!==void 0:!1;if(!e&&!d("WAWebPrimaryFeaturesModel").PrimaryFeatures.isGalaxyFlowCompanionSyncSupported)return!1;if(a.type===d("WAWebMsgType").MSG_TYPE.AUTOMATED_GREETING_MESSAGE&&b!=null)return j({flow_message_version:b});e=(a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE||a.type===d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE)&&a.interactiveType===c("WAWebInteractiveMessageType").NATIVE_FLOW;if(!e)return!1;b=l(a);e=k(b);return e==null?!1:j(e)}g.isFlowSupported=a}),98);
__d("WAWebE2EProtoParserForCtwaContext",["WAWebABProps","WAWebBizGatingUtils","WAWebCtwaAGMUtils","WAWebE2EProtoParserApi","WAWebLinkify"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.externalAdReply==null&&!d("WAWebABProps").getABPropConfigValue("wa_web_parse_always_show_ad_attribution"))return;var c={},e=b.alwaysShowAdAttribution,f=b.conversionSource,g=b.conversionData,h=b.ctwaPayload,i=b.ctwaSignals;e!=null&&(c.alwaysShowAdAttribution=e);f!=null&&(c.conversionSource=f);i!=null&&h!=null&&d("WAWebBizGatingUtils").isSignalDecouplingEnabled()?c.conversionData=h:g!=null&&(c.conversionData=g);i!=null&&d("WAWebBizGatingUtils").isSignalDecouplingEnabled()&&(c.ctwaSignals=i);e=b.externalAdReply;if(e!=null){c.sourceUrl=e.sourceUrl;c.description=e.body;c.title=e.title;e.thumbnail!=null&&(c.thumbnail=d("WAWebE2EProtoParserApi").decodeBytes(e.thumbnail));c.thumbnailUrl=e.thumbnailUrl;c.mediaType=e.mediaType;c.mediaUrl=e.mediaUrl;f=d("WAWebLinkify").findLink(e.sourceUrl||"",!1,a.from);f!=null&&f.suspiciousCharacters!=null&&f.suspiciousCharacters.size!=null&&(c.isSuspiciousLink=f.suspiciousCharacters.size>0);e.adContextPreviewDismissed!=null&&d("WAWebBizGatingUtils").isHideAdContextIfSoftDismissed()&&(c.adContextPreviewDismissed=e.adContextPreviewDismissed);e.sourceApp!=null&&(c.sourceApp=e.sourceApp);h=d("WAWebCtwaAGMUtils").isWamoAGMIntegrationEnabled(e.sourceApp);h&&(e.greetingMessageBody!=null&&(c.greetingMessageBody=e.greetingMessageBody),e.automatedGreetingMessageShown!=null&&(c.automatedGreetingMessageShown=e.automatedGreetingMessageShown),e.ctaPayload!=null&&(c.ctaPayload=e.ctaPayload),e.sourceId!=null&&(c.sourceId=e.sourceId),e.originalImageUrl!=null&&(c.originalImageUrl=e.originalImageUrl))}Object.keys(c).length>0&&(a.ctwaContext=c)}g.parseCtwaContextProto=a}),98);
__d("WAWebGenerateDocumentReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebMediaCleanFileName",["WALogger"],(function(a,b,c,d,e,f,g){var h;function i(a){if(!a)return a;a=a.replace(/[\u202a-\u202e\u2066-\u2069\u200E\u200F\u061C]/g,"\ufffd");var b=a.split(".");if(b.length===1)return a;for(var c=b.length-1;c>0;c--){var d=b[c].trim();if(d.length)return b.slice(0,c).join(".")+"."+d}return a}function a(a){if(a==null)return a;var b=i(a);if(a!==b&&b){a=["bat","exe","cmd","com","lnk","pif","scr","vb","vbe","vbs","wsh","js","ps1","hta","sh","csh","msi","app","scpt","applescript","reg","vbe","wsf","sct"];var c=b.split(".");c=c.length>=2?c.pop():"";c!=null&&a.includes(c)&&d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["cleanIncomingFilename:extension: ",""])),c).verbose()}return b}g.cleanFilename=i;g.cleanIncomingFilename=a}),98);
__d("WAWebStickerMimeUtils",[],(function(a,b,c,d,e,f){var g="application/was",h="image/webp";function a(){return new Set([h,g])}f.WhatsAppLottieStickerMimeType=g;f.getValidStickerMimeTypes=a}),66);
__d("WAWebMediaMessageGetValidatedProperties",["$InternalEnum","WALogger","WALongInt","WAWebHandleMsgError","WAWebMsgType","WAWebNewsletterIsNewsletterMsg","WAWebStickerMimeUtils","WAWebURLUtils","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){var h,i,j=b("$InternalEnum")({MISSING_MEDIA_KEY:"missing_media_key",INVALID_SHA256:"invalid_sha256",INVALID_ENC_SHA256:"invalid_enc_sha256",INVALID_URL:"invalid_url",INVALID_MIME_TYPE:"invalid_mime_type",INVALID_MEDIA_KEY:"invalid_media_key",INVALID_FILE_LENGTH:"invalid_file_length"}),k=function(a){function b(b,c,d,e){c=String(c)+" for "+b+" message";b=a.call(this,c,d,e)||this;b.name="MediaMessageValidationError";return b}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError),l="audio/ogg; codecs=opus",m="audio/mp4",n="audio/mpeg",o="audio/aac",p="audio/amr",q="image/jpeg",r="image/png",s="image/webp",t="video/mp4",u="video/3gpp",v="video/",w="image/";function a(a){return x(a)||a.startsWith(w)}function x(a){return a.startsWith(v)}function y(a){var b,c;c=(b={},b[(c=d("WAWebMsgType")).MSG_TYPE.IMAGE]=new Set([q,r,s]),b[c.MSG_TYPE.STICKER]=d("WAWebStickerMimeUtils").getValidStickerMimeTypes(),b[c.MSG_TYPE.VIDEO]=new Set([t,u]),b[c.MSG_TYPE.AUDIO]=new Set([l,m,n,o,p]),b[c.MSG_TYPE.PTT]=new Set([l,m,n,o,p]),b);return c[a]}function z(a){a=c("WAWebURLUtils").hostname(a);return a.endsWith(".whatsapp.net")||a==="whatsapp.net"}var A=function(a){return a.id==null};function e(a,b,e,f){var g=a.mediaKey,l=a.fileSha256,m=a.fileEncSha256,n=a.fileLength,o=a.url;a=a.mimetype;e=e==="relay"||e==="outgoing";if(!e)return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:d("WALongInt").numberOrThrowIfTooLarge(n!=null?n:0),url:o,mimetype:a};if(A(b))return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:d("WALongInt").numberOrThrowIfTooLarge(n!=null?n:0),url:o,mimetype:a};if(!c("WAWebNewsletterIsNewsletterMsg")({from:b.from,to:b.to})){if(g==null)throw new k(f,j.MISSING_MEDIA_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_KEY);if(g.byteLength!==32)throw new k(f,j.INVALID_MEDIA_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_KEY);if(m!=null&&m.byteLength!==32)throw new k(f,j.INVALID_ENC_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_SHA256)}if((l==null?void 0:l.byteLength)!==32)throw new k(f,j.INVALID_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_SHA256);if(o!=null&&(!c("WAWebURLUtils").isHttps(o)||!z(o)))throw new k(f,j.INVALID_URL,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MEDIA_URL);if(f===d("WAWebMsgType").MSG_TYPE.STICKER_PACK&&a!=null)throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE);if(a==null&&f!==d("WAWebMsgType").MSG_TYPE.STICKER_PACK)throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE);e=y(f);if(a!=null&&e!=null&&!e.has(a)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unexpected "," for "," message"])),a,f);throw new k(f,j.INVALID_MIME_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_MIME_TYPE)}var p;f===d("WAWebMsgType").MSG_TYPE.STICKER?n!=null?(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>=0):b=!0:f===d("WAWebMsgType").MSG_TYPE.DOCUMENT?n==null?b=!1:(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>=0):n==null?b=!1:(p=d("WALongInt").numberOrThrowIfTooLarge(n),b=p>0);if(!b){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Invalid file length "," with a type "," for "," message"])),n,typeof n,f);throw new k(f,j.INVALID_FILE_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_IMAGE_FILE_LENGTH,{sendLogs:f===d("WAWebMsgType").MSG_TYPE.IMAGE?.01:!0})}return{mediaKey:g,fileSha256:l,fileEncSha256:m,fileLength:p,url:o,mimetype:a}}g.MediaMessageValidationError=k;g.isMediaMimeType=a;g.isVideoMimeType=x;g.isWhatsAppSubdomain=z;g.getValidatedMediaMessageProperties=e}),98);
__d("WAWebParseDocumentMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaCleanFileName","WAWebMediaMessageGetValidatedProperties","WAWebMsgType","WAWebServerPropConstants"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.documentMessage;if(b==null)return;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.DOCUMENT);var e=a.mediaKey,f=a.fileSha256,g=a.fileEncSha256,h=a.fileLength;h=h===void 0?0:h;a=a.url;var i=d("WAWebMediaCleanFileName").cleanIncomingFilename(b.fileName||b.title),j=b.caption!=null&&b.caption!=="",k=j?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.caption):i;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.DOCUMENT,kind:d("WAWebMsgType").MsgKind.Document,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:b.directPath,mimetype:b.mimetype,filehash:d("WAWebE2EProtoParserApi").decodeBytes(f),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(g),size:h,pageCount:b.pageCount||0,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(e),mediaKeyTimestamp:b.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(b.mediaKeyTimestamp):d("WATimeUtils").unixTime(),filename:i,isCaptionByUser:j,caption:k,body:d("WAWebE2EProtoParserApi").decodeBytes(b.jpegThumbnail)||"",isVcardOverMmsDocument:Boolean(b.contactVcard)&&h<=d("WAWebServerPropConstants").VCARD_MAX_SIZE_KB*1024,thumbnailDirectPath:b.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(b.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(b.thumbnailEncSha256),thumbnailHeight:b.thumbnailHeight,thumbnailWidth:b.thumbnailWidth});return{msgData:c,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseKeepInChatMessageProto",["WALongInt","WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.keepInChatMessage;if(b==null)return;var c=b.key,e=b.keepType;b=b.timestampMs;c=babelHelpers["extends"]({},a,{keptMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a),type:d("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT,kind:d("WAWebMsgType").MsgKind.KeepInChat,keepType:e,senderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b)});return{msgData:c,contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseEphemeralSyncResponseMessageProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||a!=="relay"||b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SYNC_RESPONSE)return;a=b.ephemeralExpiration;var f=b.ephemeralSettingTimestamp,g=b.disappearingMode;if(a==null||f==null||g==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["EPHEMERAL_SYNC_RESPONSE msg does not contain all fields"]))).devConsole({protocolMessage:b});return}var i;b.disappearingMode!=null&&(i=d("WAWebE2EProtoUtils").protoToDisappearingMode(b,b.disappearingMode));return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"ephemeral_sync_response",ephemeralDuration:a,ephemeralSettingTimestamp:d("WALongInt").numberOrThrowIfTooLarge(f),disappearingModeInitiator:c("WANullthrows")(d("WAWebE2EProtoUtils").protoToDisappearingModeInitiator(e,g)),disappearingModeTrigger:(b=i)==null?void 0:b.disappearingModeTrigger,disappearingModeInitiatedByMe:(a=i)==null?void 0:a.initiatedByMe}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebEphemeralKeepInChat",["WANullthrows","WAWebEphemeralKeepInChatUtils","WAWebMsgKey","WAWebWidFactory","err"],(function(a,b,c,d,e,f,g){function a(a){a=a.keepInChat;if(a!=null&&a.key!=null){var b=a.key,e=b.id,f=b.remoteJid,g=b.participant;b=b.fromMe;var h=a.keepType;a=a.serverTimestampMs;if(e==null||h==null||a==null||f==null)throw c("err")("parseKeepInChatHistorySyncMessage: malformed KIC WebMessageInfo");h=d("WAWebEphemeralKeepInChatUtils").parseKeepTypeToKicState(h);if(h==null)throw c("err")("parseKeepInChatHistorySyncMessage: KeepType has unsupported value");return{kicKey:new(c("WAWebMsgKey"))({fromMe:c("WANullthrows")(b),id:c("WANullthrows")(e),remote:c("WANullthrows")(d("WAWebWidFactory").createWidFromWidLike(f)),participant:g!=null?d("WAWebWidFactory").createWidFromWidLike(g):void 0}),kicState:h,kicTimestampMs:parseInt(a,10)}}}g.parseKeepInChatHistorySyncMessage=a}),98);
__d("WAWebEphemeralKeepInChatUtils",["WAWebBackendApi","WAWebEphemeralConstants","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){if(a!=null&&a===d("WAWebProtobufsE2E.pb").KeepType.KEEP_FOR_ALL)return d("WAWebEphemeralConstants").KeepInChatState.KEPT;else if(a!=null&&a===d("WAWebProtobufsE2E.pb").KeepType.UNDO_KEEP_FOR_ALL)return d("WAWebEphemeralConstants").KeepInChatState.UNKEPT;return null}function b(a){return a===d("WAWebEphemeralConstants").KeepInChatState.KEPT}function h(a){return a===d("WAWebEphemeralConstants").KeepInChatState.UNKEPT}function e(a){var b,c;a.forEach(function(a){(!b||i(a,b)===1)&&(c=b,b=a)});c!=null&&d("WAWebBackendApi").frontendFireAndForget("logTieBreakIgnoredKicWam",{keepInChatMessage:c});return b}function i(a,b){if(a.senderTimestampMs==null)return-1;if(b.senderTimestampMs==null)return 1;if(a.senderTimestampMs>b.senderTimestampMs)return 1;else if(a.senderTimestampMs===b.senderTimestampMs&&a.id.id>b.id.id)return 1;return-1}function j(a){if(a.kicKey!=null){var b,c=d("WAWebMsgGetters").getIsGroupMsg(a);if(((b=a.kicKey)==null?void 0:b.fromMe)===!0)return d("WAWebUserPrefsMeUser").getMaybeMePnUser();else if(c&&((b=a.kicKey)==null?void 0:b.participant)!=null)return d("WAWebWidFactory").asUserWidOrThrow(a.kicKey.participant);else if(!c&&((b=a.kicKey)==null?void 0:b.remote)!=null)return d("WAWebWidFactory").asUserWidOrThrow(a.kicKey.remote)}}function f(a){return h(a.kicState)&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(j(a),d("WAWebMsgGetters").getSender(a)))}g.parseKeepTypeToKicState=a;g.isKept=b;g.runKeepInChatTieBreaker=e;g.compareKeepInChatMessages=i;g.kicSenderSuperPowerActive=f}),98);
__d("WAWebEventEditAddonMessageProcessor",["Promise","WAArrayGroupBy","WAWebAddonCreateMsgProcessor","WAWebDBProcessEditProtocolMsgs","WAWebGenerateEventEditSystemMessages","WAWebProcessEncryptedEventEditMsgs","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessor({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(){return(h||(h=b("Promise"))).resolve([])}},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;a=(yield d("WAWebProcessEncryptedEventEditMsgs").processEncryptedEventEditMsgs(a,b));b=a.filter(function(a){return a.isLatest});yield d("WAWebDBProcessEditProtocolMsgs").updateMessageEditsLocally(a,b);a=d("WAArrayGroupBy").groupBy(b,function(a){return a.protocolMsg.id.remote.toString()});yield d("WAWebGenerateEventEditSystemMessages").generateEventEditSystemMessages(a);return[]});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebEventResponseAddonMessageProcessor",["WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebCreateEncryptedEventResponseMsgData","WAWebDBMarkFutureproofMessagesReparsed","WAWebEventResponseMsgDataConversion","WAWebEventsParseWebMsgInfoEventResponse","WAWebMsgType","WAWebPrepareEventResponsesToUpsert","WAWebProcessEncryptedEventResponseMsgs","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebEventsParseWebMsgInfoEventResponse").parseWebMsgInfoEventResponses(a)});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.EventResponseEncrypted?a:d("WAWebCreateEncryptedEventResponseMsgData").createEncryptedEventResponseMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted?a:d("WAWebProcessEncryptedEventResponseMsgs").decryptEncryptedEventResponseMsg(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebBackendApi").frontendSendAndReceive("upsertEventResponsesModelCollection",{eventResponses:a.add,eventResponsesToRemove:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.parents;a=(yield d("WAWebProcessEncryptedEventResponseMsgs").processEncryptedEventResponseMsgs(a,b));b=(yield d("WAWebPrepareEventResponsesToUpsert").prepareEventResponsesToUpsert(a));return b});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;var c=a.map(d("WAWebEventResponseMsgDataConversion").eventResponseMsgDataToResponseData);yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(c);if(b===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebEventsValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_MESSAGE_SECRET:"missing_message_secret",INVALID_MESSAGE_SECRET:"invalid_message_secret",EVENT_CREATION_INVALID_NAME:"event_creation_invalid_name",EVENT_CREATION_INVALID_DESCRIPTION:"event_creation_invalid_description",EVENT_CREATION_INVALID_CANCELED_STATUS:"event_creation_invalid_canceled_status",EVENT_CREATION_MISSING_DATE:"event_creation_missing_date",EVENT_CREATION_INVALID_LOCATION:"event_creation_invalid_location",EVENT_CREATION_INVALID_LOCATION_NAME:"event_creation_invalid_location_name",EVENT_CREATION_INVALID_LOCATION_ADDRESS:"event_creation_invalid_location_address",EVENT_CREATION_MISSING_MESSAGE_SENDER:"event_creation_missing_message_sender",EVENT_CREATION_INVALID_END_TIME:"event_creation_invalid_end_time",EVENT_CREATION_INVALID_JOIN_LINK:"event_creation_invalid_join_link"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="EventCreationValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);e=b("$InternalEnum")({EVENT_RESPONSE_MISSING_MESSAGE_KEY:"event_response_missing_message_key",EVENT_RESPONSE_MISSING_ENC_IV:"event_response_missing_enc_iv",EVENT_RESPONSE_INVALID_SIZE_ENC_IV:"event_response_invalid_size_enc_iv",EVENT_RESPONSE_MISSING_ENC_PAYLOAD:"event_response_missing_enc_payload",EVENT_RESPONSE_MISSING_MESSAGE_SENDER:"event_response_missing_message_sender"});f=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="EncryptedEventResponseValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);b=b("$InternalEnum")({EVENT_EDIT_MISSING_TARGET_MESSAGE_KEY:"event_edit_missing_target_message_key",EVENT_EDIT_MISSING_ENC_IV:"event_edit_missing_enc_iv",EVENT_EDIT_INVALID_SIZE_ENC_IV:"event_edit_invalid_size_enc_iv",EVENT_EDIT_MISSING_ENC_PAYLOAD:"event_edit_missing_enc_payload",EVENT_EDIT_MISSING_MESSAGE_SENDER:"event_edit_missing_message_sender",EVENT_EDIT_MISSING_EDITED_MESSAGE:"event_edit_missing_edited_message",EVENT_EDIT_MISSING_SENDER_TIMESTAMP:"event_edit_missing_sender_timestamp",EVENT_EDIT_PARENT_SENDER_MISMATCH:"event_edit_parent_sender_mismatch",EVENT_EDIT_INVALID_PROTOCOL_MESSAGE_TYPE:"event_edit_invalid_protocol_message_type",EVENT_EDIT_MISSING_MESSAGE_SECRET:"event_edit_missing_message_secret"});d=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="EncryptedEventEditValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.EventCreationValidationErrorCode=a;g.EventCreationValidationError=c;g.EncryptedEventResponseValidationErrorCode=e;g.EncryptedEventResponseValidationError=f;g.EncryptedEventEditValidationErrorCode=b;g.EncryptedEventEditValidationError=d}),98);
__d("WAWebCreateEncryptedEventResponseMsgData",["WANullthrows","WAWebAck","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebEventsValidationError","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=self.crypto.getRandomValues(new Uint8Array(12)),f={type:d("WAWebMsgType").MsgKind.EventResponseDecrypted,encode:{response:a.eventResponse,timestampMs:a.senderTimestampMs}},g=d("WAWebMsgGetters").getOriginalSender(b),h=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventResponseDecrypted,b);if(g==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=(yield d("WAWebAddonEncryption").encryptAddOn(f,{messageSecret:h,iv:e,stanzaId:b.id.id,originalMessageSender:g,addOnSender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))),parentWid:b.from}));h=f.encPayload;return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,addonEncrypted:!0,t:Math.floor(a.senderTimestampMs/1e3),ack:(g=a.ack)!=null?g:d("WAWebAck").ACK.CLOCK,targetMessageKey:b.id,encPayload:h,encIv:e.buffer})});return h.apply(this,arguments)}g.createEncryptedEventResponseMsgData=a}),98);
__d("WAWebEventEditDecryptedMsgDataConversion",["WALongInt","WANullthrows","WAWebE2EProtoUtils","WAWebEventsParseEventCreationMessageProto","WAWebEventsValidationError","WAWebMsgKeyUtils","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebProtobufsE2E.pb","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a,b,e){a=c("WANullthrows")(a.protocolMessage,"[Event][Edit] Missing protocol message");if(a.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_INVALID_PROTOCOL_MESSAGE_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.EDIT_TYPE_AND_PROTOCOL_MISMATCH);var f=d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(b),g=c("WANullthrows")(d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(a.key,f)),h=a.editedMessage;if(h==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_EDITED_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=d("WALongInt").maybeNumberOrThrowIfTooLarge(a.timestampMs);if(a==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);h=c("WANullthrows")(c("WAWebEventsParseEventCreationMessageProto")({messageProtobuf:babelHelpers["extends"]({},h,{messageContextInfo:{messageSecret:c("WANullthrows")((h=b.messageSecret)!=null?h:e).buffer,threadId:[]}}),baseMessage:f,msgContext:"relay"}),"[Event][Edit] Failed to parse edited event fields");e=h.msgData;return babelHelpers["extends"]({},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message),{id:b.id,t:Math.floor(c("WANullthrows")(a)/1e3),type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,latestEditSenderTimestampMs:a,latestEditMsgKey:b.id,protocolMessageKey:g,editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,eventName:c("WANullthrows")(e==null?void 0:e.eventName),eventStartTime:c("WANullthrows")(e==null?void 0:e.eventStartTime),isEventCanceled:(f=e==null?void 0:e.isEventCanceled)!=null?f:!1,eventLocation:(h=e==null?void 0:e.eventLocation)!=null?h:void 0,eventDescription:(a=e==null?void 0:e.eventDescription)!=null?a:void 0,eventJoinLink:(g=e==null?void 0:e.eventJoinLink)!=null?g:void 0,eventEndTime:(f=e==null?void 0:e.eventEndTime)!=null?f:void 0,eventIsScheduledCall:(h=e==null?void 0:e.eventIsScheduledCall)!=null?h:void 0,eventExtraGuestsAllowed:(a=e==null?void 0:e.eventExtraGuestsAllowed)!=null?a:void 0,reportingTokenInfo:b.reportingTokenInfo})}g.protobufToEventEditDecryptedMsgData=a}),98);
__d("WAWebEventResponseMsgDataConversion",["WANullthrows","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b;return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,parentMsgKey:a.parentMsgKey,eventResponse:c("WANullthrows")(a.responseProtobuf.response,"eventResponse"),senderTimestampMs:a.senderTimestampMs,t:(b=a.t)!=null?b:void 0,read:a.read,ack:(b=a.ack)!=null?b:void 0})}function b(a){var b;return babelHelpers["extends"]({id:a.id},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,parentMsgKey:a.parentMsgKey,eventResponse:a.eventResponse,senderTimestampMs:a.senderTimestampMs,t:(b=a.t)!=null?b:void 0,read:a.read,ack:(b=a.ack)!=null?b:void 0})}function e(a){return{type:"event_response",msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),timestamp:a.senderTimestampMs,sender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))).toString(),eventResponse:a.eventResponse}}g.protobufToEventResponseMsgData=a;g.eventResponseToEventResponseMsgData=b;g.eventResponseMsgDataToResponseData=e}),98);
__d("WAWebGenerateEventEditSystemMessages",["Promise","WANullthrows","WAWebBackendApi","WAWebDBProcessMessage","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a[0];a=a[1];var e=d("WAWebWidFactory").createWid(c);c=(yield (h||(h=b("Promise"))).all(a.map(function(a){var b=a.protocolMsg.latestEditSenderTimestampMs;if(b==null||d("WAWebMsgGetters").getIsFailed(a.protocolMsg))return;return j(e,b,a)}).filter(Boolean)));a=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:e,msgObjs:c,meta:{add:"after",isHistory:!1},processMessagesOrigin:"eventEditMessage"}));a&&(yield d("WAWebDBProcessMessage").storeMessages(c,e))});return function(b){return a.apply(this,arguments)}}()))});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f,g=e.editedMsgData,h=e.protocolMsg,i=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),j=c("WANullthrows")(d("WAWebMsgGetters").getSender(h));g={eventName:c("WANullthrows")(g==null?void 0:g.eventName),eventStartTime:c("WANullthrows")(g==null?void 0:g.eventStartTime),eventEndTime:g==null?void 0:g.eventEndTime,isEventCanceled:(f=g==null?void 0:g.isEventCanceled)!=null?f:!1,eventLocation:(f=g==null?void 0:g.eventLocation)!=null?f:void 0,eventDescription:(f=g==null?void 0:g.eventDescription)!=null?f:void 0,eventJoinLink:(f=g==null?void 0:g.eventJoinLink)!=null?f:void 0};return babelHelpers["extends"]({id:new(c("WAWebMsgKey"))({id:yield c("WAWebMsgKey").newId(),fromMe:d("WAWebUserPrefsMeUser").isMeAccount(j),remote:a,participant:j}),author:j,from:a,to:i,t:h.t,type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,subtype:"event_edit_decrypted",viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,kind:d("WAWebMsgType").MsgKind.ProtocolEventEdit,editMsgType:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,latestEditMsgKey:h.latestEditMsgKey,latestEditSenderTimestampMs:b,protocolMessageKey:e.parentMsg.id},g)});return k.apply(this,arguments)}g.generateEventEditSystemMessages=a}),98);
__d("WAWebMaxPerGroup",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(a of a){var e=c(a),f=d.get(e);(f==null||b(a)>=b(f))&&d.set(e,a)}return Array.from(d.values())}f.maxPerGroup=a}),66);
__d("WAWebPrepareEventResponsesToUpsert",["WANullthrows","WAWebAddonDBTable","WAWebLidMigrationUtils","WAWebMaxPerGroup","WAWebMsgGetters","WAWebMsgType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WAWebWidFactory").createWidFromWidLike(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)));return String(a.parentMsgKey)+"|"+String(d("WAWebLidMigrationUtils").toLid(b))+"|"+String(d("WAWebLidMigrationUtils").toPn(b))}function i(a){return d("WAWebMaxPerGroup").maxPerGroup(a,function(a){return a.senderTimestampMs},h)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(function(a){return[a.parentMsgKey,c("WANullthrows")(d("WAWebMsgGetters").getSender(a))]});a=i(a);b=(yield d("WAWebAddonDBTable").addonDBTable.bulkGetByParentAndSender(d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,b));var e=new Map();b.forEach(function(a){a.kind===d("WAWebMsgType").MsgKind.EventResponseDecrypted&&e.set(h(a),a)});var f=[];a.forEach(function(a){var b=e.get(h(a));if(b!=null&&b.senderTimestampMs>a.senderTimestampMs)return;var c=b!=null&&b.eventResponse===a.eventResponse;b=(b=b==null?void 0:b.read)!=null?b:!1;c=c&&b&&a.read!==b?babelHelpers["extends"]({},a,{read:!0}):a;f.push(c)});return f});return j.apply(this,arguments)}g.getNewestEventResponses=i;g.prepareEventResponsesToUpsert=a}),98);
__d("WAWebProcessEncryptedEventEditMsgs",["Promise","WALogger","WAWebABProps","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebAddonInfraError","WAWebApiContact","WAWebDBProcessEditProtocolMsgs","WAWebEventEditDecryptedMsgDataConversion","WAWebEventsValidationError","WAWebHandleMsgValidate","WAWebLidMigrationUtils","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebVerifyProtobufMsgObjectKeys","WAWebWamEnumE2eFailureReason","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=new Map();a.forEach(function(a){if(a.kind!==d("WAWebMsgType").MsgKind.EventEditEncrypted)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.UnexpectedMsgType);var b=c.getForAddon(a);e.set(a,b)});if(e.size===0)return[];a=(yield (j||(j=b("Promise"))).allSettled(Array.from(e.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebEventsValidationError").EventCreationValidationError||a instanceof d("WAWebEventsValidationError").EncryptedEventEditValidationError||a instanceof d("WAWebAddonEncryptionError").DualEncryptionValidationError){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event edit failed: ",""])),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event edit failed: ","\n",""],["Processing encrypted event edit failed: ","\\n",""])),a.message,a.stack).sendLogs("event_edit_unknown_error")}}).filter(Boolean)});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.encIv,f=a.encPayload,g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventEditEncrypted,b),h=d("WAWebMsgGetters").getOriginalSender(b),i=d("WAWebMsgGetters").getSender(a);if(i==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(!c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(i,h)))throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_PARENT_SENDER_MISMATCH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.EventEditEncrypted,encryptedAddOn:f};i=d("WAWebWidFactory").asUserWidOrThrow(i);var j=h,k=i;if(d("WAWebABProps").getABPropConfigValue("lid_one_to_one_migration_event_response_force_pn_jid")&&b.from.isRegularUser()){if(h.isLid()){var l;j=(l=d("WAWebApiContact").getPhoneNumber(h))!=null?l:h}if(i.isLid()){k=(l=d("WAWebApiContact").getPhoneNumber(i))!=null?l:i}}var m;try{m=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:j,addOnSender:k}))}catch(a){if(a instanceof d("WAWebAddonEncryptionError").DualEncryptionValidationError&&(h!==j||i!==k))m=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:h,addOnSender:i}));else throw a}l=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").MessageSpec,m);k=d("WAWebEventEditDecryptedMsgDataConversion").protobufToEventEditDecryptedMsgData((j=d("WAWebVerifyProtobufMsgObjectKeys").getUnwrappedProtobufMessage(l))!=null?j:l,a,g);h=(e=(f=l.messageContextInfo)==null?void 0:f.messageSecret)!=null?e:a.messageSecret;i=babelHelpers["extends"]({},k,{plainProtobufBytes:new Uint8Array(m)});h!=null&&(i.messageSecret=new Uint8Array(h));yield d("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:[i],forceDualEncryptedValidation:!0});return d("WAWebDBProcessEditProtocolMsgs").generateMessageEdit(b,k)});return m.apply(this,arguments)}g.processEncryptedEventEditMsgs=a}),98);
__d("WAWebProcessEncryptedEventResponseMsgs",["Promise","WALogger","WALongInt","WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebApiContact","WAWebEventResponseMsgDataConversion","WAWebEventsValidationError","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=[],f=new Map();a.forEach(function(a){if(a.addonEncrypted){var b=c.getForAddon(a);f.set(a,b)}else e.push(a)});if(f.size===0)return e;a=(yield (j||(j=b("Promise"))).allSettled(Array.from(f.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return e.concat(a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebEventsValidationError").EventCreationValidationError||a instanceof d("WAWebEventsValidationError").EncryptedEventResponseValidationError){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event response failed: ",""])),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Processing encrypted event response failed: ","\n",""],["Processing encrypted event response failed: ","\\n",""])),a.message,a.stack).sendLogs("unknown-error")}}).filter(Boolean))});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.encIv,f=a.encPayload,g=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.EventResponseEncrypted,b),h=d("WAWebMsgGetters").getOriginalSender(b),i=d("WAWebMsgGetters").getSender(a);if(i==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f={type:d("WAWebMsgType").MsgKind.EventResponseEncrypted,encryptedAddOn:f};i=d("WAWebWidFactory").asUserWidOrThrow(i);var j=null;try{j=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:h,addOnSender:i}))}catch(a){if(!h.isLid()||!i.isLid())throw a;var k=d("WAWebApiContact").getPhoneNumber(h),l=d("WAWebApiContact").getPhoneNumber(i);if(k==null||l==null)throw a;h=k!=null?k:h;i=l!=null?l:i;j=(yield d("WAWebAddonEncryption").decryptAddOn(f,{messageSecret:g,iv:e,stanzaId:b.id.id,originalMessageSender:h,addOnSender:i}))}k=d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$EventResponseMessageSpec,j);return d("WAWebEventResponseMsgDataConversion").protobufToEventResponseMsgData({responseProtobuf:k,parentMsgKey:a.targetMessageKey,id:a.id,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(k.timestampMs)),t:d("WAWebMsgGetters").getT(a),ack:(l=a.ack)!=null?l:null,read:d("WAWebUserPrefsMeUser").isMeAccount(i)})});return m.apply(this,arguments)}g.processEncryptedEventResponseMsgs=a;g.decryptEncryptedEventResponseMsg=l}),98);
__d("WAWebEventResponseDBSerialization",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","err"],(function(a,b,c,d,e,f,g){function h(a){a=d("WAWebProtobufsE2E.pb").Message$EventResponseMessage$EventResponseType.cast(new Uint8Array(a)[0]);if(a==null)throw c("err")("Value contained in array buffer is not a valid event response");return a}function i(a){var b=new ArrayBuffer(1);b=new Uint8Array(b);b[0]=a;return b.buffer}function a(a){var b=c("WANullthrows")(d("WAWebMsgGetters").getSender(a));return{msgKey:a.id.toString(),parentMsgKey:a.parentMsgKey.toString(),eventResponse:i(a.eventResponse),senderTimestampMs:a.senderTimestampMs,sender:b.toString(),t:a.t,ack:a.ack,read:d("WAWebUserPrefsMeUser").isMeAccount(b)||a.read}}function b(a){var b=c("WAWebMsgKey").from(a.msgKey);return babelHelpers["extends"]({id:b},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseDecrypted,ack:a.ack,t:a.t,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,eventResponse:h(a.eventResponse),parentMsgKey:c("WAWebMsgKey").from(a.parentMsgKey),senderTimestampMs:a.senderTimestampMs,read:(b=a.read)!=null?b:!1})}g.dbRowFromEventResponseMessage=a;g.eventResponseMessageFromDBRow=b}),98);
__d("WAWebEventsGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("event_name_length_limit")}function b(){return d("WAWebABProps").getABPropConfigValue("event_description_length_limit")}function c(){return d("WAWebABProps").getABPropConfigValue("events_m3_end_time_receive")}function e(){return d("WAWebABProps").getABPropConfigValue("events_m3_end_time_send")}function f(){return d("WAWebABProps").getABPropConfigValue("events_m3_maybe_respone_send")}function h(){return d("WAWebABProps").getABPropConfigValue("events_m3_maybe_response_receive")}g.getEventsNameLengthLimit=a;g.getEventsDescriptionLengthLimit=b;g.isEventEndTimeReceiveEnabled=c;g.isEventEndTimeSendEnabled=e;g.isEventMaybeSendEnabled=f;g.isEventMaybeReceiveEnabled=h}),98);
__d("WAWebEventsParseEventCreationMessageProto",["WALongInt","WAWebApiParse","WAWebEventsGatingUtils","WAWebEventsValidationError","WAWebMsgType","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;var e=b.eventMessage;if(e==null)return null;var f=e.contextInfo,g=e.isCanceled,h=e.name,i=e.description,j=e.joinLink,k=e.startTime,l=e.endTime,m=e.location,n=e.isScheduleCall;e=e.extraGuestsAllowed;k=d("WALongInt").maybeNumberOrThrowIfTooLarge(k);l=d("WALongInt").maybeNumberOrThrowIfTooLarge(l);if(j!=null&&d("WAWebApiParse").isValidCallLink(j)===!1)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_JOIN_LINK,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(h==null||h===""||h.length>d("WAWebEventsGatingUtils").getEventsNameLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(k==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_MISSING_DATE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(i!=null&&i.length>d("WAWebEventsGatingUtils").getEventsDescriptionLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_DESCRIPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_CANCELED_STATUS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(m!=null){var o=m.name,p=m.address,q=m.degreesLatitude,r=m.degreesLongitude;if(o!=null&&o.length>d("WAWebEventsGatingUtils").getEventsDescriptionLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_LOCATION_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(p!=null&&p.length>d("WAWebEventsGatingUtils").getEventsDescriptionLengthLimit())throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_LOCATION_ADDRESS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(q==null&&r!=null||q!=null&&r==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_LOCATION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}if(l!=null&&l<k)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.EVENT_CREATION_INVALID_END_TIME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);o=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.EVENT_CREATION,kind:d("WAWebMsgType").MsgKind.EventCreation,eventName:h,eventDescription:i,eventJoinLink:j,eventStartTime:k,isEventCanceled:Boolean(g),eventLocation:m,eventEndTime:l!=null?l:void 0,eventIsScheduledCall:n!=null?n:void 0,eventExtraGuestsAllowed:e!=null?e:void 0});if(a==="quoted"||a==="history_quoted"||a==="history")return{msgData:o,contextInfo:f};q=(p=b.messageContextInfo)==null?void 0:p.messageSecret;if(q==null)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.MISSING_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET);if(q.byteLength!==32)throw new(d("WAWebEventsValidationError").EventCreationValidationError)(d("WAWebEventsValidationError").EventCreationValidationErrorCode.INVALID_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID);return{msgData:o,contextInfo:f}}g["default"]=a}),98);
__d("WAWebEventsParseEventEditEncryptedMessageProto",["WAWebE2EProtoUtils","WAWebEventsValidationError","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a.msgContext;a=b.secretEncryptedMessage;if(a==null||a.secretEncType!==d("WAWebProtobufsE2E.pb").Message$SecretEncryptedMessage$SecretEncType.EVENT_EDIT)return;b=a.targetMessageKey;var e=a.encPayload;a=a.encIv;b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,c);if(b==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_TARGET_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a.byteLength!==12)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_INVALID_SIZE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventEditValidationError)(d("WAWebEventsValidationError").EncryptedEventEditValidationErrorCode.EVENT_EDIT_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.EVENT_EDIT_ENCRYPTED,kind:d("WAWebMsgType").MsgKind.EventEditEncrypted,encIv:a,encPayload:e,targetMessageKey:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebEventsParseEventResponseMessageProto",["WAWebE2EProtoUtils","WAWebEventsValidationError","WAWebMsgType","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encEventResponseMessage;if(b==null)return null;var c=b.eventCreationMessageKey,e=b.encPayload;b=b.encIv;c=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(c,a);if(c==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b.byteLength!==12)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_INVALID_SIZE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebEventsValidationError").EncryptedEventResponseValidationError)(d("WAWebEventsValidationError").EncryptedEventResponseValidationErrorCode.EVENT_RESPONSE_MISSING_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE,kind:d("WAWebMsgType").MsgKind.EventResponseEncrypted,addonEncrypted:!0,encIv:b,encPayload:e,targetMessageKey:c}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebEventsParseWebMsgInfoEventResponse",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebEventResponseMsgDataConversion","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.webMsgInfo,e=a.parsedWebMsgInfo,f=a.isFromCag;try{if(!(b!=null&&b.eventResponses)||!e||e.type!==d("WAWebMsgType").MSG_TYPE.EVENT_CREATION)return[];var g=e;return b.eventResponses.map(function(a){try{var b,e=(b=c("WANullthrows"))(a.eventResponseMessageKey,"eventResponseMessageKey"),i=b(a.eventResponseMessage,"eventResponseMessage");e=b(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e,f));e=e.msgKey;return d("WAWebEventResponseMsgDataConversion").protobufToEventResponseMsgData({responseProtobuf:i,id:e,parentMsgKey:g.id,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(b(i.timestampMs,"senderTimestampMs")),t:d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(a.timestampMs),ack:null,read:a.unread!==!0})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to parse eventResponse with error ",""])),a.message).devConsole(a).sendLogs("parseWebMsgInfoEventResponses-responses-parse-error");return null}}).filter(Boolean)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoEventResponses failed with error "," "," and stack ",""])),a==null?void 0:a.name,a==null?void 0:a.code,a==null?void 0:a.stack).sendLogs("parseWebMsgInfoEventResponses-error");return[]}});return j.apply(this,arguments)}g.parseWebMsgInfoEventResponses=a}),98);
__d("WAWebGenerateInteractiveResponseReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebParseButtonsResponseMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.buttonsResponseMessage;if(b==null)return;if(b.type===d("WAWebProtobufsE2E.pb").Message$ButtonsResponseMessage$Type.DISPLAY_TEXT){var c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.BUTTONS_RESPONSE,kind:d("WAWebMsgType").MsgKind.ButtonsResponse,selectedButtonId:b.selectedButtonId,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.selectedDisplayText)});return{msgData:c,contextInfo:b.contextInfo}}return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown}),contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseHsmMessageProto",["WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.highlyStructuredMessage;if(b==null)return;b=(b=b.hydratedHsm)==null?void 0:b.hydratedTemplate;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.HSM,kind:d("WAWebMsgType").MsgKind.Hsm,body:b?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.hydratedContentText):a.body}),contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebParseInteractiveMessageProto",["WAWebABProps","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebHandleMsgError","WAWebInteractiveMessageHeaderMediaType","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgKey","WAWebMsgType","WAWebNativeFlowValidation","WAWebParseDocumentMessageProto","WAWebParseImageMessageProto","WAWebParseProductMessageProto","WAWebParseVideoMessageProto","WAWebWamEnumE2eFailureReason","filterNulls"],(function(a,b,c,d,e,f,g){var h=d("WAWebABProps").getABPropConfigValue("enable_product_carousel_message");function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo,g=a.bizSource;a=a.msgContext;b=b.interactiveMessage;if(b==null)return;var h=d("WAWebE2EProtoUtils").getInteractiveMessageTypeForProto(b);if(!h||!d("WAWebE2EProtoUtils").isInteractiveMessageTypeEnabled(h))return l(e,b);var k=b.body,m=b.footer,n=d("WAWebE2EProtoUtils").getInteractiveMessageFieldNameForType(h);k={type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE,kind:d("WAWebMsgType").MsgKind.Interactive,caption:(k=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k==null?void 0:k.text))!=null?k:"",interactiveType:h,interactivePayload:b[n],pmCampaignId:f==null?void 0:f.campaignId,bizSource:g};if(!d("WAWebE2EProtoUtils").isSupportedInteractiveMessageVersion(h,b[n]))return l(e,b);n=null;var o=b.carouselMessage;if(o!=null){n=j(e,o,a,f,g);if(n==null)return l(e,b)}if(h===c("WAWebInteractiveMessageType").NATIVE_FLOW){o=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({interactiveMessage:b}));k=babelHelpers["extends"]({},k,{nativeFlowName:o});if(a==="relay"||a==="history"){var p;if(!d("WAWebE2EProtoUtils").isValidNativeFlowName({name:o,bizInfo:f,msgContext:a})||!d("WAWebNativeFlowValidation").isValidNativeFlowMessage(k,g,e==null||(p=e.id)==null?void 0:p.fromMe,e))return l(e,b)}}h=b.header!=null?i(b.header,e,a):void 0;return{msgData:babelHelpers["extends"]({},e,(o=h==null?void 0:h.headerMessage)!=null?o:{},k,{interactiveHeader:h==null?void 0:h.interactiveHeader,footer:m?d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(m.text):e.footer,carouselCardsParsed:n!=null?n:void 0}),contextInfo:b.contextInfo}}function i(a,b,e){var f=function(){if(a.imageMessage){var f;f=(f=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:a.imageMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData;if(f&&f.kind!==d("WAWebMsgType").MsgKind.Image)throw new(d("WAWebHandleMsgError").MessageValidationError)("parseInteractiveHeaderMessageProto: header imageMessage is not an ImageMsgData",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{headerMessage:f,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.IMAGE}}if(a.documentMessage){return{headerMessage:(f=c("WAWebParseDocumentMessageProto")({messageProtobuf:{documentMessage:a.documentMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.DOCUMENT}}if(a.videoMessage){f=(f=c("WAWebParseVideoMessageProto")({messageProtobuf:{videoMessage:a.videoMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData;if(f&&f.kind!==d("WAWebMsgType").MsgKind.Video)throw new(d("WAWebHandleMsgError").MessageValidationError)("parseInteractiveHeaderMessageProto: header videoMessage is not an VideoMsgData",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{headerMessage:f,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.VIDEO}}if(h&&a.productMessage){f=(f=c("WAWebParseProductMessageProto")({messageProtobuf:{productMessage:a.productMessage},baseMessage:b,msgContext:e}))==null?void 0:f.msgData;return{headerMessage:f,mediaType:d("WAWebInteractiveMessageHeaderMediaType").InteractiveMessageHeaderMediaType.PRODUCT}}};f=a.hasMediaAttachment===!0?f():void 0;return{headerMessage:f==null?void 0:f.headerMessage,interactiveHeader:{title:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.title),subtitle:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.subtitle),thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail),hasMediaAttachment:Boolean(a.hasMediaAttachment),mediaType:f==null?void 0:f.mediaType}}}function j(a,b,d,e,f){b=b.cards.map(function(b){return k(b,a,d,e,f)});b=c("filterNulls")(b);return b.length===0?null:b}function k(a,b,e,f,g){var j=a.body,k=a.header,l=d("WAWebE2EProtoUtils").getInteractiveMessageTypeForProto(a);if(!l||!d("WAWebE2EProtoUtils").isInteractiveMessageTypeEnabled(l))return null;j=babelHelpers["extends"]({},k,{type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE,kind:d("WAWebMsgType").MsgKind.Interactive,caption:(j=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j==null?void 0:j.text))!=null?j:"",interactiveType:l,interactivePayload:a.nativeFlowMessage,pmCampaignId:f==null?void 0:f.campaignId,bizSource:g});l=k!=null?i(k,b,e):void 0;a=l==null?void 0:l.headerMessage;if(l==null||a==null)return null;f=babelHelpers["extends"]({},l.interactiveHeader,{title:null,subtitle:null});g=new(c("WAWebMsgKey"))({fromMe:a.id.fromMe,remote:a.id.remote,participant:a.id.participant,id:c("WAWebMsgKey").newId_DEPRECATED()});if(a.type===d("WAWebMsgType").MSG_TYPE.VIDEO)return babelHelpers["extends"]({},a,j,{id:g,interactiveHeader:f,footer:null,isCarouselCard:!0,parentMsgId:b.id.clone()});if(a.type===d("WAWebMsgType").MSG_TYPE.IMAGE)return babelHelpers["extends"]({},a,j,{id:g,interactiveHeader:f,footer:null,isCarouselCard:!0,parentMsgId:b.id.clone()});if(h&&a.type===d("WAWebMsgType").MSG_TYPE.PRODUCT)return babelHelpers["extends"]({},a,j,{id:g,interactiveHeader:f,footer:null,isCarouselCard:!0,parentMsgId:b.id.clone()})}function l(a,b){return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebGalaxyFlowMessageInteractiveResponseMessageParser",["WAWebBackendApi","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgKey","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a,b){var e;if((b==null||(e=b.nativeFlowResponseMessage)==null?void 0:e.paramsJson)!=null){var f,g=JSON.parse(b==null||(f=b.nativeFlowResponseMessage)==null?void 0:f.paramsJson);b=b.contextInfo;var h={msgData:babelHelpers["extends"]({},a,{interactiveType:c("WAWebInteractiveMessageType").NATIVE_FLOW,kind:d("WAWebMsgType").MsgKind.InteractiveResponse,type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE,nativeFlowName:c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW}),contextInfo:b};if(b){var i=b.stanzaId;b=b.participant;if(i!=null&&b!=null){b=new(c("WAWebMsgKey"))({id:i,fromMe:!1,remote:a.id.remote});void d("WAWebBackendApi").frontendFireAndForget("addGalaxyDisableCTAMessageId",{messageId:b.toString()})}}return g.wa_flow_response_params==null?h:babelHelpers["extends"]({},h,{msgData:babelHelpers["extends"]({},h.msgData,{interactivePayload:{name:c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW,buttonParamsJson:JSON.stringify(babelHelpers["extends"]({},g,{flow_message_version:1,flow_token:g.flow_token,flow_id:g.wa_flow_response_params.flow_id,flow_response_message:g.wa_flow_response_params.response_message,flow_cta:g.wa_flow_response_params.title}))}})})}}g.getGalaxyMessageInteractiveResponse=a}),98);
__d("WAFlowsExpiredCacheCleaner",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(){return new(g||(g=b("Promise")))(function(a,b){try{var c=document.createElement("iframe");c.style.display="none";c.src="https://flows.whatsapp.net/flows/cache_management/";c.onload=function(){document.body.removeChild(c),a(0)};c.onerror=function(a){c.parentNode&&document.body.removeChild(c),b(a)};document.body.appendChild(c)}catch(a){b(a)}})}f.clearExpiredCachedStates=a}),66);
__d("WAWebGalaxyFlowsUtils",["Promise","WABase64","WAFlowsExpiredCacheCleaner","WALogger","WAWebABProps","WAWebCommonMsgSubtypeTypes","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebStateUtils","asyncToGeneratorRuntime","tryParseJSONMixed"],(function(a,b,c,d,e,f,g){var h,i,j;function a(){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(d("WAWebABProps").getABPropConfigValue("flows_wa_web")){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["clearGalaxyFlowsCache: clearing Galaxy Flows cache"])));try{yield d("WAFlowsExpiredCacheCleaner").clearExpiredCachedStates()}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to clear expired Galaxy Flow cached states: ",""])),a).verbose().devConsole(a)}}});return k.apply(this,arguments)}function e(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield window.fetch("/flows/json/"+a));return a.json()});return l.apply(this,arguments)}function f(a){a=d("WAWebStateUtils").unproxy(a);a.type=d("WAWebMsgType").MSG_TYPE.UNKNOWN;a.subtype=d("WAWebCommonMsgSubtypeTypes").MsgSubtype.PhoneOnlyFeature;return a}function m(a){return((a=a.nativeFlowResponseMessage)==null?void 0:a.name)===String(c("WAWebInteractiveMessagesNativeFlowName").CTA_FLOW)&&d("WAWebABProps").getABPropConfigValue("flows_wa_web")}function n(a){if(a.nativeFlowResponseMessage!=null&&a.nativeFlowResponseMessage.paramsJson!=null){a=c("tryParseJSONMixed")(a.nativeFlowResponseMessage.paramsJson);if(a!=null&&typeof a==="object"&&a.wa_flow_response_params!=null&&a.wa_flow_response_params.flow_creation_source!=null){a=a.wa_flow_response_params.flow_creation_source==="FLEXIBLE_CHECKOUT";return a}}return!1}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=s();return q(a.id,b).then(function(a){var b=a.flowQPLMessageId;a=a.flowWAMMessageId;return{flowQPLMessageId:b,flowWAMMessageId:a}})});return p.apply(this,arguments)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=new TextEncoder(),f=e.encode(a+c+"_qpl");e=e.encode(a+c+"_wam");a=(yield (j||(j=b("Promise"))).all([crypto.subtle.digest({name:"SHA-256"},f),crypto.subtle.digest({name:"SHA-256"},e)]));c=a[0];f=a[1];e=d("WABase64").encodeB64(c);a=d("WABase64").encodeB64(f);return{flowQPLMessageId:e,flowWAMMessageId:a}});return r.apply(this,arguments)}function s(){var a=new Uint8Array(16);crypto.getRandomValues(a);return Array.from(a).map(function(a){return String.fromCharCode(a)}).join("")}g.clearGalaxyFlowsCache=a;g.fetchFlowJSON=e;g.getInvalidatedFlowMessageFromHistorySync=f;g.isResponseFlowSupported=m;g.isFlexibleCheckoutForm=n;g.computeMessageIds=o}),98);
__d("WAWebParseInteractiveResponseMessageProto",["WAWebBizGatingUtils","WAWebE2EProtoUtils","WAWebGalaxyFlowMessageInteractiveResponseMessageParser","WAWebGalaxyFlowsUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.bizInfo;a=a.msgContext;b=b.interactiveResponseMessage;if(b==null)return;var f=d("WAWebE2EProtoUtils").getInteractiveResponseMessageTypeForProto(b);if(!d("WAWebBizGatingUtils").interactiveNativeFlowResponseMessagesEnabled()||!f||!d("WAWebE2EProtoUtils").isInteractiveResponseMessageTypeEnabled(f))return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};if(d("WAWebGalaxyFlowsUtils").isResponseFlowSupported(b))return d("WAWebGalaxyFlowsUtils").isFlexibleCheckoutForm(b)?{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}:d("WAWebGalaxyFlowMessageInteractiveResponseMessageParser").getGalaxyMessageInteractiveResponse(c,b);try{var g;return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.INTERACTIVE_RESPONSE,kind:d("WAWebMsgType").MsgKind.InteractiveResponse,body:(g=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis((g=b.body)==null?void 0:g.text))!=null?g:"",interactivePayload:d("WAWebE2EProtoUtils").getInteractiveResponsePayload({type:f,message:b,bizInfo:e,msgContext:a})}),contextInfo:b.contextInfo}}catch(a){return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}}}g["default"]=a}),98);
__d("WAWebParseListResponseMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.listResponseMessage;if(b==null)return;if(b.listType===d("WAWebProtobufsE2E.pb").Message$ListResponseMessage$ListType.SINGLE_SELECT){var c=babelHelpers["extends"]({},b,{contextInfo:void 0}),e=b.title||"";b.description!=null&&b.description!==""&&(e+="\n"+b.description);a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.LIST_RESPONSE,kind:d("WAWebMsgType").MsgKind.ListResponse,listResponse:c,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(e)});return{msgData:a,contextInfo:b.contextInfo}}}g["default"]=a}),98);
__d("WAWebParseNativeFlowButtonsMessageProto",["WAWebButtonsMessageProtoUtils","WAWebE2EProtoUtils","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType","WAWebNativeFlowValidation","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.bizInfo,g=a.bizSource;a=a.msgContext;b=b.buttonsMessage;if(b==null)return;var h=b.buttons;h=h===void 0?[]:h;var i=b.headerType,j=c("WAWebInteractiveMessagesNativeFlowName").cast(d("WAWebE2EProtoUtils").getBizNativeFlowName({buttonsMessage:b}));if(a==="relay"&&(j==null||j!==c("WAWebInteractiveMessagesNativeFlowName").cast(f==null?void 0:f.nativeFlowName)))return;if(!d("WAWebE2EProtoUtils").shouldParseNFM({name:j,bizInfo:f,msgContext:a})||d("WAWebE2EProtoUtils").hasUnsupportedButtons(h))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo};if(i===d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.UNKNOWN||!new Set(d("WAWebProtobufsE2E.pb").Message$ButtonsMessage$HeaderType.members()).has(i))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:void 0}),contextInfo:b.contextInfo};f=d("WAWebButtonsMessageProtoUtils").parseButtonsMessageProto({buttonsMessage:b,baseMessage:e,msgContext:a});if(j==null)return;i=babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.NATIVE_FLOW,kind:d("WAWebMsgType").MsgKind.NativeFlow,nativeFlowName:c("WAWebInteractiveMessagesNativeFlowName").cast(j),nativeFlowButtons:h});return!i.nativeFlowName||!d("WAWebNativeFlowValidation").isValidNativeFlowMessage(i,g)?{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b.contextInfo}:{msgData:i,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebParseTemplateButtonReplyMessageProto",["WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.templateButtonReplyMessage;if(b==null)return;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.TEMPLATE_BUTTON_REPLY,kind:d("WAWebMsgType").MsgKind.TemplateButtonReply,body:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(b.selectedDisplayText),selectedIndex:b.selectedIndex,selectedId:b.selectedId,selectedCarouselCardIndex:b.selectedCarouselCardIndex});return{msgData:a,contextInfo:b.contextInfo}}g["default"]=a}),98);
__d("WAWebLidMigrationDbUtils",["WALogger","WAWebApiChat","WAWebApiContact","WAWebLid1X1MigrationGating","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map(),c=a.filter(function(a){a=d("WAWebWidFactory").createWid(a);return a.isRegularUser()&&!a.isLid()});if(c.length===0)return b;var e=(yield d("WAWebSchemaChat").getChatTable().bulkGet(c));e.forEach(function(a,e){a=a==null?void 0:a.accountLid;if(a==null){var f=d("WAWebWidFactory").createUserWidOrThrow(c[e]);a=(f=d("WAWebApiContact").getCurrentLid(f))==null?void 0:f.toString()}a!=null&&b.set(c[e],a)});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["findAccountLidsForPnChatIds: found "," accountLids for "," PN chatIds"])),b.size,a.length);return b});return i.apply(this,arguments)}function c(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a=a.filter(function(a){a=d("WAWebWidFactory").createWid(a);return a.isLid()});if(a.length===0)return b;var c=(yield d("WAWebSchemaChat").getChatTable().anyOf(["accountLid"],a));c.forEach(function(a){var c=a.accountLid;c!=null&&b.set(c,a.id)});a.forEach(function(a){if(!b.has(a)){var c=d("WAWebWidFactory").createUserLidOrThrow(a);c=(c=d("WAWebApiContact").getPhoneNumber(c))==null?void 0:c.toString();c!=null&&b.set(a,c)}});return b});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated();if(b){b=(yield d("WAWebApiChat").getChatRecordByAccountLid(a));b=b[0];b=b==null?void 0:b.id;if(!b)return;return d("WAWebWidFactory").createUserWidOrThrow(b)}return d("WAWebApiContact").getPhoneNumber(a)});return k.apply(this,arguments)}g.findAccountLidsForPnChatIds=a;g.findChatIdsForAccountLids=c;g.getChatWidFromUserLid=e}),98);
__d("WAWebLidMigrationUtils",["WALogger","WAWebApiContact","WAWebChatGetters","WAWebCurrentUser","WAWebLid1X1MigrationGating","WAWebMsgKey","WAWebMsgKeyUtils","WAWebUserPrefsHistorySync","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDeviceDebug","WAWebWidFactory","err","gkx"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.isRegularUser()}function k(a){return a.isLid()?d("WAWebApiContact").getPhoneNumber(a):a}function l(a){return a.isLid()?a:d("WAWebApiContact").getCurrentLid(d("WAWebWidFactory").asUserWidOrThrow(a))}function m(a){a=d("WAWebWidFactory").asUserWidOrThrow(a);return a.isLid()?a:d("WAWebApiContact").getCurrentLid(a)}function b(a){var b=m(a);if(b==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[lid-migration] getEnforceCurrentLidForUserWid: No LID for user"]))).devConsole(a);throw c("err")("No LID for user")}return b}function e(a){var b=k(a);if(b==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[lid-migration] getPhoneNumberOrThrow: No PN for user"]))).devConsole(a);throw c("err")("No PN for user")}return b}function f(a){return a?l:k}function n(a,b){if(a!=null&&b!=null&&a.isUser()&&b.isUser()&&a.isLid()!==b.isLid()){var c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a));if(c!=null)return[c,b];c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(b));if(c!=null)return[a,c]}return[a,b]}function o(a){if(a.remote.isGroup()||a.remote.isStatus())return p(a);else if(a.remote.isUser())return q(a)}function p(a){var b=a.participant!=null?d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a.participant)):null;if(b==null)return;return new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:a.remote,id:a.id,participant:b})}function q(a){var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a.remote));if(b==null)return;return new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:b,id:a.id,participant:a.participant})}function r(a,b){var c=a.id.isLid(),e=a.isCAG();a=d("WAWebChatGetters").getIsGroup(a)&&Boolean((a=a.groupMetadata)==null?void 0:a.isLidAddressingMode);switch(b){case d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon:return c||e||a?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow();case d("WAWebMsgKeyUtils").TranslateMsgKeyType.EditMessage:case d("WAWebMsgKeyUtils").TranslateMsgKeyType.Message:return e?a?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow():c||a?d("WAWebUserPrefsMeUser").getMeLidUserOrThrow():d("WAWebUserPrefsMeUser").getMePnUserOrThrow()}}function s(a){if(!a.isLid()){var b=l(a);if(b!=null)return[a,b]}else{b=k(a);if(b!=null)return[a,b]}return[a]}function t(a){return!c("gkx")("26258")&&(a==null?void 0:a.isLid())===!0&&d("WAWebUserPrefsMultiDeviceDebug").getLidMigrationDebugMode()}function u(a){return!c("gkx")("26258")&&a===!0&&d("WAWebUserPrefsMultiDeviceDebug").getLidMigrationDebugMode()}function v(a){return c("gkx")("26258")?!1:t(a.id.remote)||t(a.id.participant)}function w(a){return a==null?"none":a?"lid":"pn"}function x(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[lid migration]\nisEmployee: ",",\nis 1-1 migrated: ",",\nmigration source:  ",",\ninitial history complete: ",""])),d("WAWebCurrentUser").isEmployee(),d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated(),d("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.lidMigrationSource(),d("WAWebUserPrefsHistorySync").getInitialHistorySyncComplete())}function y(a){var b=a.id;return b.isLid()||b.isGroup()&&Boolean((b=a.groupMetadata)==null?void 0:b.isLidAddressingMode)}g.shouldHaveAccountLid=a;g.toPn=k;g.toLid=l;g.toUserLid=m;g.toUserLidOrThrow=b;g.toPnOrThrow=e;g.toAddressingModeFactory=f;g.toCommonAddressingMode=n;g.getAlternateMsgKey=o;g.getMeUserLidOrJidForChat=r;g.getPnAndLidToUpdate=s;g.getShouldShowLidDebugUI=t;g.getShouldShowLidDebugUIForGroups=u;g.getShouldShowLidDebugUIForMsg=v;g.getAddressingModeString=w;g.logLidMetadata=x;g.chatIsLid=y}),98);
__d("WAWebLidStatusMigrationKeyUtils",["WAWebLidStatusMigrationUtils","WAWebMsgKey"],(function(a,b,c,d,e,f,g){function a(a){return!a.remote.isStatus()?a:new(c("WAWebMsgKey"))({fromMe:a.fromMe,remote:a.remote,id:a.id,participant:a.participant?d("WAWebLidStatusMigrationUtils").matWidConvert(a.participant):void 0})}g.matKeyConvert=a}),98);
__d("WAWebLidStatusMigrationUtils",["WAWebLidMigrationUtils","WAWebLidStatusMigrationGating"],(function(a,b,c,d,e,f,g){function a(a){var b;if(!a.isRegularUser())return a;var c=d("WAWebLidStatusMigrationGating").getLidStatusMigrationStage();return c==="pre_mat"?(b=d("WAWebLidMigrationUtils").toPn(a))!=null?b:a:c==="mat"?(b=d("WAWebLidMigrationUtils").toLid(a))!=null?b:a:function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+c)}()}g.matWidConvert=a}),98);
__d("WAWebDBUpdateChatTable",["WALogger","WAWebMiscErrors","WAWebSchemaChat","err"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return d("WAWebSchemaChat").getChatTable().merge(a.toString(),b)["catch"](function(a){if(a instanceof d("WAWebMiscErrors").DbOnLogoutAbort)throw a;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateChatTable: failed to update in storage"]))).verbose().devConsole(a).sendLogs("updateChatTable failed");throw c("err")("updateChatTable failed")})}g.updateChatTable=a}),98);
__d("WAWebLimitSharingModelUtils",["WAWebBackendApi","WAWebContactSystemMsg","WAWebDBUpdateChatTable","WAWebHandleSingleMsg","WAWebProtobufsProtocol.pb","WAWebSchemaChat","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebSchemaChat").getChatTable().get(a)});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebDBUpdateChatTable").updateChatTable(a,{limitSharing:b}),d("WAWebBackendApi").frontendFireAndForget("updateChatLimitSharing",{id:a,limitSharing:b})});return k.apply(this,arguments)}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b;a=(yield h(a.toString()));if((a==null||(b=a.limitSharing)==null?void 0:b.sharingLimited)===!0){var c={sharingLimited:a.limitSharing.sharingLimited,trigger:a.limitSharing.trigger};a=d("WAWebWidFactory").createWid(a.id);yield n(a,c)}});return l.apply(this,arguments)}function c(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatWID;a=a.sharingLimited;if(a===!0){var c,e=(yield h(b.toString()));if((e==null||(c=e.limitSharing)==null?void 0:c.sharingLimited)!==a){e={sharingLimited:a,trigger:d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.UNKNOWN};yield j(b,e);return n(b,e)}}});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebContactSystemMsg").genLimitSharingUpdateSystemMsg(a,b);yield d("WAWebHandleSingleMsg").handleSingleMsg({chatId:a,newMsg:b,handleSingleMsgOrigin:"limitSharing"});return b});return o.apply(this,arguments)}g.getChat=h;g.updateChat=j;g.createLimitSharingMsgOnChatClear=a;g.genLimitSharingSystemMessageOnPersistedChat=c;g.genLimitSharingSystemMessage=n}),98);
__d("WAWebLimitSharingPropMappingUtils",["WAWebProtobufsProtocol.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"1":return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.CHAT_SETTING;case"2":return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.BIZ_SUPPORTS_FB_HOSTING;case"3":return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.UNKNOWN_GROUP;default:return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.UNKNOWN}}function b(a){switch(a){case"CHAT_SETTING":return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.CHAT_SETTING;case"BIZ_SUPPORTS_FB_HOSTING":return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.BIZ_SUPPORTS_FB_HOSTING;default:return d("WAWebProtobufsProtocol.pb").LimitSharing$Trigger.UNKNOWN}}g.getLimitSharingTriggerFromHistorySyncStubParameter=a;g.getLimitSharingTriggerFromGroupSettingsChange=b}),98);
__d("WAWebLimitSharingProtoUtils",["WAWebCommonMsgSubtypeTypes","WAWebLimitSharingModelUtils","WAWebLimitSharingPropMappingUtils","WAWebMsgType","WAWebProtobufsWeb.pb","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.messageStubType===d("WAWebProtobufsWeb.pb").WebMessageInfo$StubType.CHANGE_LIMIT_SHARING){var c=a.messageStubParameters,e=c[0],f=c[1];c=c[2];e={sharingLimited:e==="true",limitSharingSettingTimestamp:Number(a.messageTimestamp)*1e3,trigger:d("WAWebLimitSharingPropMappingUtils").getLimitSharingTriggerFromHistorySyncStubParameter(f)};a=o(e,c?d("WAWebWidFactory").createWid(c):void 0);yield t(b,a)}});return h.apply(this,arguments)}function c(a){return{sharingLimited:a.limitSharing,trigger:d("WAWebLimitSharingPropMappingUtils").getLimitSharingTriggerFromHistorySyncStubParameter(String(a.limitSharingTrigger)),initiatedByMe:a.limitSharingInitiatedByMe,limitSharingSettingTimestamp:a.limitSharingSettingTimestamp}}function e(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;if(b==null||(a==null?void 0:a.from)==null||(a==null||(c=a.id)==null?void 0:c.remote)==null)return;var d=s(b);if(d)yield j(a,d);else if((d=b.messageContextInfo)!=null&&d.limitSharingV2){yield l(a,(d=b.messageContextInfo)==null?void 0:d.limitSharingV2)}});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=o(b,d("WAWebWidFactory").createWid(a.from.toString()));yield t(a,b);yield p(a,b)});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=o(b);yield p(a,b,!0)});return m.apply(this,arguments)}function n(a){var b,c,d=a.limitSharingMessage;a=a.protocolMessage;return d!=null&&(b=d.message)!=null&&(b=b.protocolMessage)!=null&&b.limitSharing?d==null||(c=d.message)==null?void 0:c.protocolMessage:a}function o(a,b){return{sharingLimited:a==null?void 0:a.sharingLimited,trigger:a==null?void 0:a.trigger,limitSharingSettingTimestamp:a==null?void 0:a.limitSharingSettingTimestamp,initiatedBy:b}}function p(a,b,c){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c===void 0&&(c=!1);a=(yield d("WAWebLimitSharingModelUtils").getChat(a.id.remote.toString()));if(a&&r(b,a)){a=d("WAWebWidFactory").createWid(a.id);yield d("WAWebLimitSharingModelUtils").updateChat(a,b);c&&(yield d("WAWebLimitSharingModelUtils").genLimitSharingSystemMessage(a,b))}});return q.apply(this,arguments)}function r(a,b){var c;a=(a=a==null?void 0:a.limitSharingSettingTimestamp)!=null?a:0;b=(b=b==null||(c=b.limitSharing)==null?void 0:c.limitSharingSettingTimestamp)!=null?b:0;return Number(a)>Number(b)}function s(a){return(a=n(a))==null?void 0:a.limitSharing}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a.type=d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,a.subtype=d("WAWebCommonMsgSubtypeTypes").MsgSubtype.LimitSharingSystemMessage,a.limitSharing=b});return u.apply(this,arguments)}g.parseLimitSharingFromProtocolHistorySyncMessage=a;g.getLimitSharingFromProtocolHistorySyncConversation=c;g.parseLimitSharingFromMessage=e;g.getLimitSharingEnvelopeFromProtobuf=n;g.getLimitSharingFromEnvelope=o}),98);
__d("WAWebUserPrefsLabelAssociationsLidMigration",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(a,b,c,d,e,f,g){function a(){c("WAWebUserPrefsStore").set(d("WAWebUserPrefsKeys").UserPrefs.LabelAssociationsLidTableMigrationComplete,!0)}function b(){return c("WAWebUserPrefsStore").get(d("WAWebUserPrefsKeys").UserPrefs.LabelAssociationsLidTableMigrationComplete)===!0}g.setLabelAssociationsMigrationAsComplete=a;g.isLabelAssociationsMigrationComplete=b}),98);
__d("WAWebDBLabelAssociationDatabaseApi",["WAWebLidMigrationDbUtils","WAWebSchemaLabelAssociation","WAWebUserPrefsLabelAssociationsLidMigration","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()?[].concat(yield l(a),a):a;yield d("WAWebSchemaLabelAssociation").getLabelAssociationTable().bulkRemove(a)});return h.apply(this,arguments)}function c(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()?yield n(a):a;yield d("WAWebSchemaLabelAssociation").getLabelAssociationTable().bulkCreateOrReplace(a)});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaLabelAssociation").getLabelAssociationTable().anyOf(["labelId"],a));return d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()?r(a):a});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()?yield p(a):a;a=(yield d("WAWebSchemaLabelAssociation").getLabelAssociationTable().anyOf(["associationId","type"],a.map(function(a){var b=a.associationId;a=a.type;return[b,a]})));return d("WAWebUserPrefsLabelAssociationsLidMigration").isLabelAssociationsMigrationComplete()?r(a):a});return k.apply(this,arguments)}function l(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set(a.filter(function(a){return d("WAWebSchemaLabelAssociation").getAssociationTypeFromPrimaryKey(a)===d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid}).map(d("WAWebSchemaLabelAssociation").getAssociationIdFromPrimaryKey)),c=(yield d("WAWebLidMigrationDbUtils").findAccountLidsForPnChatIds(Array.from(b)));return a.map(function(a){var b=c.get(d("WAWebSchemaLabelAssociation").getAssociationIdFromPrimaryKey(a));return b==null?a:d("WAWebSchemaLabelAssociation").replaceAssociationIdInPrimaryKey(a,b)})});return m.apply(this,arguments)}function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(d("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey);a=(yield l(a));return a.map(d("WAWebSchemaLabelAssociation").createLabelAssociationRowFromPrimaryKey)});return o.apply(this,arguments)}function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return d("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey({associationId:a.associationId,type:a.type,labelId:"1"})});a=(yield l(a));return a.map(function(a){return{associationId:d("WAWebSchemaLabelAssociation").getAssociationIdFromPrimaryKey(a),type:d("WAWebSchemaLabelAssociation").getAssociationTypeFromPrimaryKey(a)}})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Set(a.filter(function(a){return a.type===d("WAWebSchemaLabelAssociation").LabelAssociationType.Jid}).map(function(a){return a.associationId})),c=(yield d("WAWebLidMigrationDbUtils").findChatIdsForAccountLids(Array.from(b)));return a.map(function(a){var b;return babelHelpers["extends"]({},a,{associationId:(b=c.get(a.associationId))!=null?b:a.associationId})})});return s.apply(this,arguments)}g.removeLabelAssociations=a;g.addOrEditLabelAssociations=c;g.queryLabelAssociationsForLabelIds=e;g.queryLocalLabelAssociations=f}),98);
__d("WAWebDBQueryAndRemoveLocalLabelAssociation",["WAWebDBLabelAssociationDatabaseApi","WAWebSchemaLabelAssociation","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebDBLabelAssociationDatabaseApi").queryLocalLabelAssociations(a));yield d("WAWebDBLabelAssociationDatabaseApi").removeLabelAssociations(a.map(d("WAWebSchemaLabelAssociation").createLabelAssociationPrimaryKey))});return h.apply(this,arguments)}g.queryAndRemoveLocalLabelAssociation=a}),98);
__d("WAWebParseLocationMessageProto",["WALongInt","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function h(a,b){var c;c=((c=a.name)!=null?c:"")||((c=a.address)!=null?c:"");a.name!=null&&a.name!==""&&a.address!=null&&a.address!==""&&(c=a.name+"\n"+a.address);var e=a.degreesLatitude!==void 0?a.degreesLatitude:void 0,f=a.degreesLongitude!==void 0?a.degreesLongitude:void 0;b=babelHelpers["extends"]({},b,{type:d("WAWebMsgType").MSG_TYPE.LOCATION,kind:d("WAWebMsgType").MsgKind.Location,loc:c,lat:e,lng:f,body:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail)||"",clientUrl:a.url});return{msgData:b,contextInfo:a.contextInfo}}function i(a,b,c){var e;c&&(e={finalLat:c.degreesLatitude,finalLng:c.degreesLongitude,finalThumbnail:d("WAWebE2EProtoParserApi").decodeBytes(c.jpegThumbnail)||"",finalAccuracy:c.accuracyInMeters,finalSpeed:c.speedInMps,finalDegrees:c.degreesClockwiseFromMagneticNorth,finalTimeOffset:c.timeOffset});c=babelHelpers["extends"]({},b,e,{type:d("WAWebMsgType").MSG_TYPE.LOCATION,kind:d("WAWebMsgType").MsgKind.LocationLive,isLive:!0,lat:a.degreesLatitude,lng:a.degreesLongitude,body:d("WAWebE2EProtoParserApi").decodeBytes(a.jpegThumbnail)||"",accuracy:a.accuracyInMeters,speed:a.speedInMps,degrees:a.degreesClockwiseFromMagneticNorth,comment:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a.caption),sequence:d("WALongInt").maybeNumberOrThrowIfTooLarge(a.sequenceNumber)});return{msgData:c,contextInfo:a.contextInfo}}function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.finalLocation;var d=b.locationMessage;b=b.liveLocationMessage;var e=null;d!=null&&(e=h(d,c));b!=null&&(e=i(b,c,a));return e}g["default"]=a}),98);
__d("WAWebMmSignalSharingExpirationWindowUtils",["$InternalEnum","WATimeUtils","WAWebBackendApi","WAWebMmSignalSharingContextInfo","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingLoggingEvents","WAWebMmSignalSharingTos"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({DISCLOSED_TOKEN:"data_sharing_encrypted_token_disclosed",UNDISCLOSED_TOKEN:"data_sharing_encrypted_token_undisclosed"});function a(a,b){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;b&&(d("WAWebMmSignalSharingContextInfo").existsMmSignalSharingContextInfoDisclosureFlag(b)&&(a.showMmDisclosure=d("WAWebMmSignalSharingContextInfo").getMmSignalSharingContextInfoDisclosureFlag(b),d("WAWebBackendApi").frontendFireAndForget("updateMmSignalSharingExpirationWindow",{id:a.id.remote,msg:a,contextInfo:b}),d("WAWebMmSignalSharingContextInfo").existsMmSignalSharingURlTrackingMapElements(b)&&(a.urlTrackingMapElements=d("WAWebMmSignalSharingContextInfo").getMmSignalSharingURlTrackingMapElements(b)),void d("WAWebMmSignalSharingLoggingEvents").logMmSignalSharingUpdateExpirationWindowEvent({msg:a,contextInfo:b})))}function c(a){return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?!1:d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted()&&j(a)}function e(a,b,c){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return null;b=babelHelpers["extends"]({unixTime:d("WATimeUtils").unixTime()+d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingCollectionWindow(),messageId:b.id},i(c));return d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingOptimizedDeliveryMultipleCollectionWindowsEnabled()?k(a,b):[b]}function i(a){var b,c={disclosedToken:void 0,undisclosedToken:void 0};if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return c;a=a==null||(b=a.dataSharingContext)==null?void 0:b.parameters;return a!=null?n(a,c):c}function j(a){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return!1;a=a==null?void 0:a[a.length-1];return a!=null&&a.unixTime>d("WATimeUtils").unixTime()}function k(a,b){var c=d("WATimeUtils").unixTime(),e=d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingOptimizedDeliverySignalCollectionConfig(),f=e.consented_collection_window_in_hours;e=e.non_consented_collection_window_in_hours;a=(a=a.mmSignalSharingExpirationWindow)!=null?a:[];for(var g of a!=null?a:[])l(g,f,e,c);return a.filter(function(a){var b=a.disclosedToken;a=a.undisclosedToken;return b!=null||a!=null}).concat(b)}function l(a,b,c,d){m(a,b,d)&&(a.disclosedToken=void 0),m(a,c,d)&&(a.undisclosedToken=void 0)}function m(a,b,c){return a.unixTime+b*3600<c}function n(a,b){var c=d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingOptimizedDeliveryTokensStorageConfig(),e=c.store_consented_token_enabled,f=c.store_non_consented_token_enabled;return a.reduce(function(a,b){return{disclosedToken:e&&b.key===h.DISCLOSED_TOKEN?b.stringData:a.disclosedToken,undisclosedToken:f&&b.key===h.UNDISCLOSED_TOKEN?b.stringData:a.undisclosedToken}},b)}g.updateMmSignalSharingExpirationWindow=a;g.isMmSignalSharingUserDisclosedInCollectionWindow=c;g.getMmSignalSharingExpirationWindow=e;g.getMmSignalSharingExpirationTokens=i;g.isMmSignalSharingExpirationWindowActive=j}),98);
__d("WAWebBlockContants",[],(function(a,b,c,d,e,f){a=Object.freeze({OneToOneOldSpamBannerBlock:"1_1_old_spam_banner_block",OneToOneSpamBannerBlock:"1_1_spam_banner_block",AccountInfo:"account_info",AccountInfoReport:"account_info_report",BizOldSpamBannerBlock:"biz_old_spam_banner_block",BizSpamBannerBlock:"biz_spam_banner_block",BlockHeaderChat:"block_header_chat",CallLog:"call_log",Chat:"chat",ChatListBlock:"chat_list_block",ChatListContextMenuBlock:"chat_list_context_menu_block",ChatListNoInsubBlock:"chat_list_noinsub_block",NotificationBlock:"notification_block",OverflowMenuBlock:"overflow_menu_block",OverflowMenuReport:"overflow_menu_report",Profile:"profile",TriggeredBlock:"triggered_block",BlockList:"block_list",MediaViewer:"media_viewer",MessageMenu:"message_menu",OneToOneChatSpamBannerReport:"1_1_spam_banner_report",StatusPostReport:"status_post_report",ChatFmxCardBlock:"chat_fmx_card_block",ChatFmxCardBlockSuspicious:"chat_fmx_card_block_suspicious",ChatFmxCardSafetyToolsBlock:"chat_fmx_card_safety_tools_block",ChatFmxCardSafetyToolsBlockSuspicious:"chat_fmx_card_safety_tools_block_suspicious",ChatFmxCardSafetyToolsReport:"chat_fmx_card_safety_tools_report",ChatFmxCardSafetyToolsReportSuspicious:"chat_fmx_card_safety_tools_report_suspicious",OneToOneBlockedChatComposer:"one_to_one_blocked_chat_composer"});b=Object.freeze({NoLongerNeeded:"no_longer_needed",NoSignUp:"no_sign_up",OffensiveMessages:"offensive_messages",Spam:"spam",Other:"other"});c=Object.freeze({False:"false",True:"true",None:"none"});Object.freeze({CatalogLink:"catalog_link",ClickToChatLink:"click_to_chat_link",Ctwa:"ctwa",MessageShortLink:"message_short_link",ProductLink:"product_link",QrCode:"qr_code"});f.BlockEntryPoint=a;f.BizOptOutReason=b;f.BizOptOutFirstMessage=c}),66);
__d("WAWebWamEnumDisclosureEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({CTA_URL_CLICK:0,BODY_URL_CLICK:1,BODY_URL_LONG_PRESS:2,DISCLOSURE_INFO_CLICK:3,OPEN_CHAT_WITH_UNREAD_MM:4});f.DISCLOSURE_EVENT_TYPE=a}),66);
__d("WAWebWamEnumDisclosureInteraction",[],(function(a,b,c,d,e,f){a=Object.freeze({CONTINUE:0,CANCEL:1,DISMISSED:2,LEARN_MORE:3});f.DISCLOSURE_INTERACTION=a}),66);
__d("WAWebWamEnumDisclosureSource",[],(function(a,b,c,d,e,f){a=Object.freeze({BLOCKING:0,NON_BLOCKING:1,INFO:2});f.DISCLOSURE_SOURCE=a}),66);
__d("WAWebWamEnumDisclosureSuppressionReason",[],(function(a,b,c,d,e,f){a=Object.freeze({COOLDOWN_FROM_CTWA:0,COOLDOWN_FROM_MM:1,DISCLOSED:2,OPT_OUT_TOS2016:3,NO_SHOW_MM_DISCLOSURE_FLAG:4,NOT_FROM_CAPI:5,NOT_MARKETING_MESSAGE:6,ABPROP_DISABLED:7,OPT_OUT_TOS2021:8,BODY_LINK_DISCLOSURE_AB_PROP_DISABLED:9,ANOTHER_DIALOG_DISPLAYED:10,EVENT_TYPE_AB_PROP_DISABLED:11});f.DISCLOSURE_SUPPRESSION_REASON=a}),66);
__d("WAWebWamEnumDisclosureSurface",[],(function(a,b,c,d,e,f){a=Object.freeze({BIZ_PROFILE_SCREEN:0,CHAT_THREAD:1});f.DISCLOSURE_SURFACE=a}),66);
__d("WAWebWamEnumOnePdSignalNotSharedReason",[],(function(a,b,c,d,e,f){a=Object.freeze({VALUE_NOT_AVAILABLE:0,WINDOW_EXPIRED:1,TOKEN_EXPIRED:2,SIGNAL_NOT_ALLOWLISTED:3,INVALID_URL:4,DISCLOSURE_ABPROP_DISABLED:5,USER_UNDISCLOSED_OR_NOT_ELIGIBLE_FOR_DISCLOSURE:6});f.ONE_PD_SIGNAL_NOT_SHARED_REASON=a}),66);
__d("WAWebWamEnumSignalCanceledReason",[],(function(a,b,c,d,e,f){a=Object.freeze({COMPANION_DEVICE:0,DISCLOSURE_DISMISSED:1,INVALID_ORIGINAL_URL:2});f.SIGNAL_CANCELED_REASON=a}),66);
__d("WAWebWamEnumSignalOrigin",[],(function(a,b,c,d,e,f){a=Object.freeze({CTA_URL_CLICK:0,BODY_URL_CLICK:1,BODY_URL_LONG_PRESS:2});f.SIGNAL_ORIGIN=a}),66);
__d("WAWebWamEnumSignalSharingStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({ONE_PD:0,SP:1,NOT_SHARED:2});f.SIGNAL_SHARING_STATUS=a}),66);
__d("WAWebWamEnumSignalSurface",[],(function(a,b,c,d,e,f){a=Object.freeze({BIZ_PROFILE_SCREEN:0,CHAT_THREAD:1,CHAT_LIST:2,OTHER:3});f.SIGNAL_SURFACE=a}),66);
__d("WAWebWamEnumSignalType",[],(function(a,b,c,d,e,f){a=Object.freeze({MM_CLICK:0,USER_BLOCK:1,USER_REPORT:2,FIRST_CUSTOMER_MESSAGE:3,FIRST_CUSTOMER_MESSAGE_CONTINUATION:4,FIRST_BIZ_REPLY:5,FIRST_BIZ_REPLY_CONTINUATION:6,SECOND_CUSTOMER_MESSAGE:7,SECOND_CUSTOMER_MESSAGE_CONTINUATION:8,SECOND_BIZ_REPLY:9,SECOND_BIZ_REPLY_CONTINUATION:10,THIRD_CUSTOMER_MESSAGE:11,THIRD_CUSTOMER_MESSAGE_CONTINUATION:12,THIRD_BIZ_REPLY:13,USER_INTERESTED:14,USER_NOT_INTERESTED:15,USER_STOP_OFFERS:16,USER_BLOCK_REASON_NO_LONGER_NEEDED:17,USER_BLOCK_REASON_NO_SIGN_UP:18,USER_BLOCK_REASON_SPAM:19,USER_BLOCK_REASON_OFFENSIVE_MESSAGES:20,USER_BLOCK_REASON_OTP_DID_NOT_REQUEST:21,USER_BLOCK_REASON_OTHER:22,USER_MUTE:23});f.SIGNAL_TYPE=a}),66);
__d("WAWebWamEnumSpSignalNotSharedReason",[],(function(a,b,c,d,e,f){a=Object.freeze({VALUE_NOT_AVAILABLE:0,WINDOW_EXPIRED:1,TOKEN_EXPIRED:2,SIGNAL_NOT_ALLOWLISTED:3,INVALID_URL:4});f.SP_SIGNAL_NOT_SHARED_REASON=a}),66);
__d("WAWebMmSignalSharingLoggingEvents",["WAWebBlockContants","WAWebHandleMsgTypes.flow","WAWebMmSignalSharingExpirationWindowUtils","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingLoggingUtils","WAWebMmSignalSharingModelUtils","WAWebMmSignalSharingTos","WAWebSchemaChat","WAWebWamEnumBlockEntryPoint","WAWebWamEnumDisclosureEventType","WAWebWamEnumDisclosureInteraction","WAWebWamEnumDisclosureSource","WAWebWamEnumDisclosureSuppressionReason","WAWebWamEnumDisclosureSurface","WAWebWamEnumMmSignalType","WAWebWamEnumOnePdSignalNotSharedReason","WAWebWamEnumSignalCanceledReason","WAWebWamEnumSignalOrigin","WAWebWamEnumSignalSharingStatus","WAWebWamEnumSignalSurface","WAWebWamEnumSignalType","WAWebWamEnumSpSignalNotSharedReason","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h={type:d("WAWebWamEnumSignalType").SIGNAL_TYPE.MM_CLICK,surface:d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.CHAT_THREAD},i={1:{fromUser:function(a){return[a.FIRST_CUSTOMER_MESSAGE,a.FIRST_CUSTOMER_MESSAGE_CONTINUATION]},fromBusiness:function(a){return[a.FIRST_BIZ_REPLY,a.FIRST_BIZ_REPLY_CONTINUATION]}},2:{fromUser:function(a){return[a.SECOND_CUSTOMER_MESSAGE,a.SECOND_CUSTOMER_MESSAGE_CONTINUATION]},fromBusiness:function(a){return[a.SECOND_BIZ_REPLY,a.SECOND_BIZ_REPLY_CONTINUATION]}},3:{fromUser:function(a){return[a.THIRD_CUSTOMER_MESSAGE,a.THIRD_CUSTOMER_MESSAGE_CONTINUATION]},fromBusiness:function(a){return[a.THIRD_BIZ_REPLY]}}};function a(a){var b=a.eventType,c=a.linkTypeIndex,e=a.msg,f=a.chat;a=a.hasShownDisclosure;a=a===void 0?!1:a;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;c=(c=d("WAWebMmSignalSharingModelUtils").getMMSignalSharingUrls(b,e.unsafe(),c))!=null?c:{};var g=b===d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.BODY_URL_CLICK?d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN.BODY_URL_CLICK:d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN.CTA_URL_CLICK,i=d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted();c.consentedUrl!=null&&d("WAWebMmSignalSharingExpirationWindowUtils").isMmSignalSharingUserDisclosedInCollectionWindow(f.mmSignalSharingExpirationWindow)?void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:f,msg:e,linkOptions:c,signal:babelHelpers["extends"]({},h,{sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.ONE_PD,origin:g})}):c.unconsentedUrl!=null?void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:f,msg:e,linkOptions:c,signal:babelHelpers["extends"]({},h,{onePdNotSharedReason:d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE,sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.SP,origin:g})}):c.originalUrl!=null&&void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:f,msg:e,linkOptions:c,signal:babelHelpers["extends"]({},h,{onePdNotSharedReason:d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE,spNotSharedReason:d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE,sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.NOT_SHARED,origin:g})});(c.consentedUrl!=null||c.unconsentedUrl!=null)&&void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingDisclosureStateEvent({chat:f,msg:e,signal:{disclosureEventType:b,disclosureSurface:d("WAWebWamEnumDisclosureSurface").DISCLOSURE_SURFACE.CHAT_THREAD,disclosureInteraction:i&&a?d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION.CONTINUE:void 0,disclosureSource:i&&a?d("WAWebWamEnumDisclosureSource").DISCLOSURE_SOURCE.NON_BLOCKING:void 0,disclosureSuppressionReason:w({eventType:b,msg:e,isDisclosureTosAccepted:i,hasShownDisclosure:a}),mmHasDisclosedUrl:d("WAWebMmSignalSharingModelUtils").existsMmSignalSharingConsentedUrl(e),mmHasShowDisclosureFlag:e.showMmDisclosure===!0,userBecameDisclosed:i&&a}})}function c(a){var b=a.eventType,c=a.chat,e=a.msg;a=a.isExplicitCancel;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;var f=d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted();void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:c,msg:e,signal:babelHelpers["extends"]({},h,{canceledReason:d("WAWebWamEnumSignalCanceledReason").SIGNAL_CANCELED_REASON.DISCLOSURE_DISMISSED,origin:b===d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.BODY_URL_CLICK?d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN.BODY_URL_CLICK:d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN.CTA_URL_CLICK,sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.NOT_SHARED})});void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingDisclosureStateEvent({chat:c,msg:e,signal:{disclosureEventType:b,disclosureInteraction:a?d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION.CANCEL:d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION.DISMISSED,disclosureSource:d("WAWebWamEnumDisclosureSource").DISCLOSURE_SOURCE.NON_BLOCKING,disclosureSurface:d("WAWebWamEnumDisclosureSurface").DISCLOSURE_SURFACE.CHAT_THREAD,mmHasDisclosedUrl:d("WAWebMmSignalSharingModelUtils").existsMmSignalSharingConsentedUrl(e),mmHasShowDisclosureFlag:e.showMmDisclosure===!0,userBecameDisclosed:f}})}function e(a){var b=a.eventType;a=a.chat;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingDisclosureStateEvent({chat:a,signal:{disclosureEventType:b,disclosureInteraction:d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION.LEARN_MORE,disclosureSource:d("WAWebWamEnumDisclosureSource").DISCLOSURE_SOURCE.INFO,disclosureSurface:d("WAWebWamEnumDisclosureSurface").DISCLOSURE_SURFACE.BIZ_PROFILE_SCREEN}})}function f(a){var b=a.chat;a=a.spamFlow;l({chat:b,type:d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_REPORT,surface:a==="account_info_report"?d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.BIZ_PROFILE_SCREEN:d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.CHAT_THREAD})}function j(a){var b=a.chat,c=a.reason;a=a.blockEntryPointMetric;l({chat:b,type:q(c),surface:a===d("WAWebWamEnumBlockEntryPoint").BLOCK_ENTRY_POINT.PROFILE?d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.BIZ_PROFILE_SCREEN:d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.CHAT_THREAD})}function k(a){a=a.chat;l({chat:a,type:d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_STOP_OFFERS,surface:d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.BIZ_PROFILE_SCREEN})}function l(a){var b,c=a.chat,e=a.msg,f=a.type;a=a.surface;a=a===void 0?d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.BIZ_PROFILE_SCREEN:a;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;c&&((b=c.contact)==null||(b=b.privacyMode)==null?void 0:b.hostStorage)===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&(d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted()?d("WAWebMmSignalSharingExpirationWindowUtils").isMmSignalSharingUserDisclosedInCollectionWindow(c.mmSignalSharingExpirationWindow)?void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:c,msg:e,signal:{type:f,surface:a,sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.ONE_PD}}):void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:c,msg:e,signal:{type:f,surface:a,sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.SP,onePdNotSharedReason:d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.TOKEN_EXPIRED}}):void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:c,msg:e,signal:{type:f,surface:a,spNotSharedReason:d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE}}))}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.msg;a=a.contextInfo;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;var c=(yield d("WAWebSchemaChat").getChatTable().get(b.id.remote.toString()));if(c!=null){a=d("WAWebMmSignalSharingExpirationWindowUtils").getMmSignalSharingExpirationTokens(a);d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingCollectionWindowStateEvent({chatWID:c.id,msg:b,signal:{mmHasDisclosedUrl:d("WAWebMmSignalSharingModelUtils").existsMmSignalSharingConsentedUrl(b),mmHasShowDisclosureFlag:b.showMmDisclosure===!0,mmHasDisclosedToken:!!(a!=null&&a.disclosedToken)}})}});return n.apply(this,arguments)}function o(a){var b=a.chat;a=a.blockEntryPointMetric;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingBlockAndReportEntryPointsAllowlist().includes(a)&&z({chat:b,mmSignalType:d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK})}function p(a){var b=a.chat,c=a.reason;a=a.blockEntryPointMetric;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled()||!d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingBlockAndReportEntryPointsAllowlist().includes(a))return;z({chat:b,mmSignalType:r(c)})}function q(a){var b;if(a==null)return d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK;b=(b={},b[d("WAWebBlockContants").BizOptOutReason.NoLongerNeeded]=d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK_REASON_NO_LONGER_NEEDED,b[d("WAWebBlockContants").BizOptOutReason.NoSignUp]=d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK_REASON_NO_SIGN_UP,b[d("WAWebBlockContants").BizOptOutReason.OffensiveMessages]=d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK_REASON_OFFENSIVE_MESSAGES,b[d("WAWebBlockContants").BizOptOutReason.Spam]=d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK_REASON_SPAM,b[d("WAWebBlockContants").BizOptOutReason.Other]=d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK_REASON_OTHER,b);return b[a]}function r(a){var b;if(a==null)return d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_BLOCK;b=(b={},b[d("WAWebBlockContants").BizOptOutReason.NoLongerNeeded]=d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK_REASON_NO_LONGER_NEEDED,b[d("WAWebBlockContants").BizOptOutReason.NoSignUp]=d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK_REASON_NO_SIGN_UP,b[d("WAWebBlockContants").BizOptOutReason.OffensiveMessages]=d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK_REASON_OFFENSIVE_MESSAGES,b[d("WAWebBlockContants").BizOptOutReason.Spam]=d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK_REASON_SPAM,b[d("WAWebBlockContants").BizOptOutReason.Other]=d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_BLOCK_REASON_OTHER,b);return b[a]}function s(a){var b=a.chat;a=a.blockEntryPointMetric;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled()||!d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingBlockAndReportEntryPointsAllowlist().includes(a))return;z({chat:b,mmSignalType:d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_REPORT})}function t(a){var b=a.chat;a=a.msg;z({chat:b,mmSignalType:d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_INTERESTED});l({chat:b,msg:a,type:d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_INTERESTED})}function u(a){var b=a.chat;a=a.msg;z({chat:b,mmSignalType:d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE.USER_NOT_INTERESTED});l({chat:b,msg:a,type:d("WAWebWamEnumSignalType").SIGNAL_TYPE.USER_NOT_INTERESTED})}function v(a){var b,c=a.chat;a=a.newMsg;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled()||((b=c.contact)==null||(b=b.privacyMode)==null?void 0:b.hostStorage)!==d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook)return;b=a.id.fromMe;var e=d("WAWebMmSignalSharingModelUtils").getMmSignalSharingNewMessageParams({chat:c,fromMe:b});if(e){var f=e.messageOriginGroups;e=e.isContinuation;var g=x(f,e,b,d("WAWebWamEnumSignalType").SIGNAL_TYPE);f=x(f,e,b,d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE);f!=null&&z({chat:c,mmSignalType:f});if(g!=null){e=d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted();void d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingVerificationEvent({chat:c,msg:a,signal:babelHelpers["extends"]({type:g,surface:d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE.CHAT_THREAD},e?{sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.ONE_PD}:{sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.NOT_SHARED,onePdNotSharedReason:d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.USER_UNDISCLOSED_OR_NOT_ELIGIBLE_FOR_DISCLOSURE,spNotSharedReason:d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE})})}}}function w(a){var b=a.eventType,c=a.isDisclosureTosAccepted,e=a.msg;a=a.hasShownDisclosure;if((e==null?void 0:e.showMmDisclosure)!==!0)return d("WAWebWamEnumDisclosureSuppressionReason").DISCLOSURE_SUPPRESSION_REASON.NO_SHOW_MM_DISCLOSURE_FLAG;if(b===d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.BODY_URL_CLICK&&!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureForMarketingMessageBodyLinksEnabled())return d("WAWebWamEnumDisclosureSuppressionReason").DISCLOSURE_SUPPRESSION_REASON.BODY_LINK_DISCLOSURE_AB_PROP_DISABLED;if(c&&a!==!0)return d("WAWebWamEnumDisclosureSuppressionReason").DISCLOSURE_SUPPRESSION_REASON.DISCLOSED}function x(a,b,c,d){a=i[String(a)];return a?y(a,b,c,d):null}function y(a,b,c,d){c=c?a.fromUser:a.fromBusiness;return b?(a=c(d))==null?void 0:a[1]:(b=c(d))==null?void 0:b[0]}function z(a){var b=a.chat,c=a.mmSignalType;a=a.deepConversationParams;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled()||!b)return;a=d("WAWebMmSignalSharingModelUtils").getMMSignalSharingData({chat:b,mmSignalType:c,deepConversationParams:a});b&&a!=null&&d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted()&&d("WAWebMmSignalSharingLoggingUtils").logMmSignalSharingEvent({chat:b,signal:{mmSignalType:c,mmSignalData:a}})}g.logMmSignalSharingLinkClickEvent=a;g.logMmSignalSharingDisclosureCancelEvent=c;g.logMmSignalSharingDisclosureLearnMoreEvent=e;g.logMmSignalSharingReportVerificationEvent=f;g.logMmSignalSharingBlockVerificationEvent=j;g.logMmSignalSharingUserStopOffersVerificationEvent=k;g.logMmSignalSharingUpdateExpirationWindowEvent=m;g.logMmSignalSharingUserBlockEvent=o;g.logMmSignalSharingUserBlockWithReasonEvent=p;g.logMmSignalSharingUserReportEvent=s;g.logMmSignalSharingUserInterestedEvent=t;g.logMmSignalSharingUserNotInterestedEvent=u;g.logMmSignalSharingNewMessageEvent=v}),98);
__d("WAWebMmCollectionWindowStateEventWamEvent",["WAWebWamCodegenUtils"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmCollectionWindowStateEvent:[6744,{businessLidOrJid:[1,a.TYPES.STRING],entSourceSubplatform:[7,a.TYPES.STRING],isUserDisclosed:[8,a.TYPES.BOOLEAN],mmDisclosureFlags:[6,a.TYPES.INTEGER],mmHasDisclosedToken:[2,a.TYPES.BOOLEAN],mmHasDisclosedUrl:[3,a.TYPES.BOOLEAN],mmHasShowDisclosureFlag:[4,a.TYPES.BOOLEAN],templateId:[5,a.TYPES.STRING]},[1,1,1],"private",113760892]},{MmCollectionWindowStateEvent:[]});g.MmCollectionWindowStateEventWamEvent=b}),98);
__d("WAWebMmDisclosureStateEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisclosureEventType","WAWebWamEnumDisclosureInteraction","WAWebWamEnumDisclosureSource","WAWebWamEnumDisclosureSuppressionReason","WAWebWamEnumDisclosureSurface"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmDisclosureStateEvent:[6552,{businessLidOrJid:[1,a.TYPES.STRING],deltaTimeReceived:[15,a.TYPES.INTEGER],disclosureEventType:[3,d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE],disclosureInteraction:[4,d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION],disclosureSource:[5,d("WAWebWamEnumDisclosureSource").DISCLOSURE_SOURCE],disclosureSuppressionReason:[6,d("WAWebWamEnumDisclosureSuppressionReason").DISCLOSURE_SUPPRESSION_REASON],disclosureSurface:[7,d("WAWebWamEnumDisclosureSurface").DISCLOSURE_SURFACE],entSourceSubplatform:[16,a.TYPES.STRING],isCompanionDevice:[14,a.TYPES.BOOLEAN],isNetworkAvailable:[18,a.TYPES.BOOLEAN],isUserDisclosed:[8,a.TYPES.BOOLEAN],mmHasDisclosedUrl:[9,a.TYPES.BOOLEAN],mmHasShowDisclosureFlag:[10,a.TYPES.BOOLEAN],templateId:[11,a.TYPES.STRING],userBecameDisclosed:[13,a.TYPES.BOOLEAN]},[1,1,1],"private",113760892]},{MmDisclosureStateEvent:[]});g.MmDisclosureStateEventWamEvent=b}),98);
__d("WAWebMmDisclosureStateFsEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumDisclosureEventType","WAWebWamEnumDisclosureInteraction","WAWebWamEnumDisclosureSource","WAWebWamEnumDisclosureSuppressionReason","WAWebWamEnumDisclosureSurface"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmDisclosureStateFsEvent:[6796,{disclosureEventType:[1,d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE],disclosureInteraction:[2,d("WAWebWamEnumDisclosureInteraction").DISCLOSURE_INTERACTION],disclosureSource:[3,d("WAWebWamEnumDisclosureSource").DISCLOSURE_SOURCE],disclosureSuppressionReason:[4,d("WAWebWamEnumDisclosureSuppressionReason").DISCLOSURE_SUPPRESSION_REASON],disclosureSurface:[5,d("WAWebWamEnumDisclosureSurface").DISCLOSURE_SURFACE],isCompanionDevice:[6,a.TYPES.BOOLEAN],isUserDisclosed:[7,a.TYPES.BOOLEAN],mmHasDisclosedUrl:[8,a.TYPES.BOOLEAN],mmHasShowDisclosureFlag:[9,a.TYPES.BOOLEAN],threadIdHmac:[10,a.TYPES.STRING],userBecameDisclosed:[11,a.TYPES.BOOLEAN]},[1,1,1],"regular"]},{MmDisclosureStateFsEvent:[]});g.MmDisclosureStateFsEventWamEvent=b}),98);
__d("WAWebWamEnumSignalMessageState",[],(function(a,b,c,d,e,f){a=Object.freeze({TRUNCATED:0,EXPANDED:1,ORIGINAL:2});f.SIGNAL_MESSAGE_STATE=a}),66);
__d("WAWebWamEnumSignalMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({NFM:0,HSM:1});f.SIGNAL_MESSAGE_TYPE=a}),66);
__d("WAWebMmSignalSharingVerificationEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOnePdSignalNotSharedReason","WAWebWamEnumSignalCanceledReason","WAWebWamEnumSignalMessageState","WAWebWamEnumSignalMessageType","WAWebWamEnumSignalOrigin","WAWebWamEnumSignalSharingStatus","WAWebWamEnumSignalSurface","WAWebWamEnumSignalType","WAWebWamEnumSpSignalNotSharedReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmSignalSharingVerificationEvent:[6554,{businessLidOrJid:[1,a.TYPES.STRING],collectionWindowId:[3,a.TYPES.STRING],deltaTimeReceived:[18,a.TYPES.INTEGER],entSourceSubplatform:[17,a.TYPES.STRING],isCompanionDevice:[16,a.TYPES.BOOLEAN],isNetworkAvailable:[20,a.TYPES.BOOLEAN],isUserDisclosed:[4,a.TYPES.BOOLEAN],onePdSignalNotSharedReason:[5,d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON],signalCanceledReason:[6,d("WAWebWamEnumSignalCanceledReason").SIGNAL_CANCELED_REASON],signalMessageState:[7,d("WAWebWamEnumSignalMessageState").SIGNAL_MESSAGE_STATE],signalMessageType:[8,d("WAWebWamEnumSignalMessageType").SIGNAL_MESSAGE_TYPE],signalOrigin:[9,d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN],signalSharingStatus:[10,d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS],signalSurface:[11,d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE],signalType:[12,d("WAWebWamEnumSignalType").SIGNAL_TYPE],spSignalNotSharedReason:[13,d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON],templateId:[14,a.TYPES.STRING]},[1,1,1],"private",113760892]},{MmSignalSharingVerificationEvent:[]});g.MmSignalSharingVerificationEventWamEvent=b}),98);
__d("WAWebMmSignalSharingVerificationFsEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOnePdSignalNotSharedReason","WAWebWamEnumSignalCanceledReason","WAWebWamEnumSignalMessageState","WAWebWamEnumSignalMessageType","WAWebWamEnumSignalOrigin","WAWebWamEnumSignalSharingStatus","WAWebWamEnumSignalSurface","WAWebWamEnumSignalType","WAWebWamEnumSpSignalNotSharedReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmSignalSharingVerificationFsEvent:[6798,{isCompanionDevice:[1,a.TYPES.BOOLEAN],isUserDisclosed:[2,a.TYPES.BOOLEAN],onePdSignalNotSharedReason:[3,d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON],signalCanceledReason:[4,d("WAWebWamEnumSignalCanceledReason").SIGNAL_CANCELED_REASON],signalMessageState:[5,d("WAWebWamEnumSignalMessageState").SIGNAL_MESSAGE_STATE],signalMessageType:[6,d("WAWebWamEnumSignalMessageType").SIGNAL_MESSAGE_TYPE],signalOrigin:[7,d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN],signalSharingStatus:[8,d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS],signalSurface:[9,d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE],signalType:[10,d("WAWebWamEnumSignalType").SIGNAL_TYPE],spSignalNotSharedReason:[11,d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON],threadIdHmac:[12,a.TYPES.STRING]},[1,1,1],"regular"]},{MmSignalSharingVerificationFsEvent:[]});g.MmSignalSharingVerificationFsEventWamEvent=b}),98);
__d("WAWebMmSignalSharingVerificationWithSignalDataEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOnePdSignalNotSharedReason","WAWebWamEnumSignalCanceledReason","WAWebWamEnumSignalMessageState","WAWebWamEnumSignalMessageType","WAWebWamEnumSignalOrigin","WAWebWamEnumSignalSharingStatus","WAWebWamEnumSignalSurface","WAWebWamEnumSignalType","WAWebWamEnumSpSignalNotSharedReason"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({MmSignalSharingVerificationWithSignalDataEvent:[6856,{entSourceSubplatform:[1,a.TYPES.STRING],isCompanionDevice:[2,a.TYPES.BOOLEAN],isNetworkAvailable:[16,a.TYPES.BOOLEAN],isUserDisclosed:[3,a.TYPES.BOOLEAN],isUserMatched:[4,a.TYPES.BOOLEAN],mmSignalData:[5,a.TYPES.STRING],onePdSignalNotSharedReason:[6,d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON],signalCanceledReason:[7,d("WAWebWamEnumSignalCanceledReason").SIGNAL_CANCELED_REASON],signalMessageState:[8,d("WAWebWamEnumSignalMessageState").SIGNAL_MESSAGE_STATE],signalMessageType:[9,d("WAWebWamEnumSignalMessageType").SIGNAL_MESSAGE_TYPE],signalOrigin:[10,d("WAWebWamEnumSignalOrigin").SIGNAL_ORIGIN],signalSharingStatus:[11,d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS],signalSurface:[12,d("WAWebWamEnumSignalSurface").SIGNAL_SURFACE],signalType:[13,d("WAWebWamEnumSignalType").SIGNAL_TYPE],spSignalNotSharedReason:[14,d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON]},[1,1,1],"private",0]},{MmSignalSharingVerificationWithSignalDataEvent:[]});g.MmSignalSharingVerificationWithSignalDataEventWamEvent=b}),98);
__d("WAWebMmSignalWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMmSignalType"],(function(a,b,c,d,e,f,g){a=d("WAWebWamCodegenUtils").defineEvents({MmSignal:[5572,{disclosed:[4,d("WAWebWamCodegenUtils").TYPES.BOOLEAN],mmSignalData:[1,d("WAWebWamCodegenUtils").TYPES.STRING],mmSignalType:[2,d("WAWebWamEnumMmSignalType").MM_SIGNAL_TYPE]},[1,1,1],"private",0]},{MmSignal:[]});g.MmSignalWamEvent=a}),98);
__d("WAWebMmSignalSharingLoggingUtils",["WALogger","WAWebChatThreadLogging","WAWebLidMigrationUtils","WAWebMmCollectionWindowStateEventWamEvent","WAWebMmDisclosureStateEventWamEvent","WAWebMmDisclosureStateFsEventWamEvent","WAWebMmSignalSharingExpirationWindowUtils","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingModelUtils","WAWebMmSignalSharingTos","WAWebMmSignalSharingVerificationEventWamEvent","WAWebMmSignalSharingVerificationFsEventWamEvent","WAWebMmSignalSharingVerificationWithSignalDataEventWamEvent","WAWebMmSignalWamEvent","WAWebMsgType","WAWebNetworkStatus","WAWebWamEnumOnePdSignalNotSharedReason","WAWebWamEnumSignalMessageType","WAWebWamEnumSignalSharingStatus","WAWebWamEnumSpSignalNotSharedReason","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chat,e=a.msg,f=a.linkOptions;a=a.signal;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;var g=d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingOptimizedDeliverySignalCollectionConfig(),h=g.consented_types_allowlist;g=g.non_consented_types_allowlist;var i=d("WAWebMmSignalSharingModelUtils").getMmSignalSharingExpirationWindowItem({chat:b}),j=d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted();h=h.includes(a.type)||g.includes(a.type);g=babelHelpers["extends"]({isCompanionDevice:!0,isUserDisclosed:j,onePdSignalNotSharedReason:m(b,a.onePdNotSharedReason,j,h),signalCanceledReason:a.canceledReason,signalMessageState:a.messageState,signalOrigin:a.origin,signalSharingStatus:h?a.sharingStatus:d("WAWebWamEnumSignalSharingStatus").SIGNAL_SHARING_STATUS.NOT_SHARED,signalSurface:a.surface,signalType:a.type,spSignalNotSharedReason:h?a.spNotSharedReason:d("WAWebWamEnumSpSignalNotSharedReason").SP_SIGNAL_NOT_SHARED_REASON.VALUE_NOT_AVAILABLE},e&&{signalMessageType:(e==null?void 0:e.type)===d("WAWebMsgType").MSG_TYPE.HSM?d("WAWebWamEnumSignalMessageType").SIGNAL_MESSAGE_TYPE.HSM:d("WAWebWamEnumSignalMessageType").SIGNAL_MESSAGE_TYPE.NFM});h=new(d("WAWebMmSignalSharingVerificationEventWamEvent").MmSignalSharingVerificationEventWamEvent)(babelHelpers["extends"]({},g,{businessLidOrJid:l(b.id.toString()),collectionWindowId:b.mmSignalSharingExpirationWindow!=null?btoa(String((j=b.mmSignalSharingExpirationWindow)!=null?j:"")):void 0},(e==null?void 0:e.templateId)!=null?{templateId:e.templateId}:{}));j=new(d("WAWebMmSignalSharingVerificationFsEventWamEvent").MmSignalSharingVerificationFsEventWamEvent)(babelHelpers["extends"]({},g,{threadIdHmac:(yield d("WAWebChatThreadLogging").getChatThreadIDHMAC(b.id.toString()))||""}));g=new(d("WAWebMmSignalSharingVerificationWithSignalDataEventWamEvent").MmSignalSharingVerificationWithSignalDataEventWamEvent)(babelHelpers["extends"]({},g,{isNetworkAvailable:c("WAWebNetworkStatus").online,mmSignalData:d("WAWebMmSignalSharingModelUtils").getMMSignalSharingData({chat:b,mmSignalType:a.type,deepConversationParams:{isNewMessagefromMe:e==null?void 0:e.id.fromMe}}),isUserMatched:(i==null?void 0:i.disclosedToken)!=null||(f==null?void 0:f.consentedUrl)!=null}));h.commit();j.commit();g.commit()});return i.apply(this,arguments)}function e(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chat,c=a.msg;a=a.signal;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;a={disclosureEventType:a.disclosureEventType,disclosureInteraction:a.disclosureInteraction,disclosureSource:a.disclosureSource,disclosureSuppressionReason:a.disclosureSuppressionReason,disclosureSurface:a.disclosureSurface,isCompanionDevice:!0,isUserDisclosed:d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted(),mmHasDisclosedUrl:a.mmHasDisclosedUrl,mmHasShowDisclosureFlag:a.mmHasShowDisclosureFlag,userBecameDisclosed:a.userBecameDisclosed};c=new(d("WAWebMmDisclosureStateEventWamEvent").MmDisclosureStateEventWamEvent)(babelHelpers["extends"]({},a,{businessLidOrJid:l(b.id.toString())},(c==null?void 0:c.templateId)!=null?{templateId:c.templateId}:{}));a=new(d("WAWebMmDisclosureStateFsEventWamEvent").MmDisclosureStateFsEventWamEvent)(babelHelpers["extends"]({},a,{threadIdHmac:(yield d("WAWebChatThreadLogging").getChatThreadIDHMAC(b.id.toString()))||""}));c.commit();a.commit()});return j.apply(this,arguments)}function f(a){var b=a.chatWID,c=a.msg;a=a.signal;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;b=new(d("WAWebMmCollectionWindowStateEventWamEvent").MmCollectionWindowStateEventWamEvent)(babelHelpers["extends"]({businessLidOrJid:l(b),isUserDisclosed:d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted(),mmDisclosureFlags:a.mmDisclosureFlags,mmHasDisclosedToken:a.mmHasDisclosedToken,mmHasDisclosedUrl:a.mmHasDisclosedUrl,mmHasShowDisclosureFlag:a.mmHasShowDisclosureFlag},(c==null?void 0:c.templateId)!=null?{templateId:c.templateId}:{}));b.commit()}function k(a){a=a.signal;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingCollectionEnabled())return;a=new(d("WAWebMmSignalWamEvent").MmSignalWamEvent)({mmSignalData:a.mmSignalData,mmSignalType:a.mmSignalType,disclosed:d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted()});a.commit()}function l(a){if(!c("WAWebWid").isRegularUserNoImply(a)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["wa:mmSignalSharing failed to determine chat ID type (chatID: ",")"])),a);return""}a=d("WAWebWidFactory").createUserWidOrThrow(a);var b=d("WAWebLidMigrationUtils").toPn(a),e=d("WAWebLidMigrationUtils").toLid(a);return d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingVerificationSystemLidEnabled()&&e?e.toString():b?b.toJid():a.toString()}function m(a,b,c,e){if(!c)return d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.USER_UNDISCLOSED_OR_NOT_ELIGIBLE_FOR_DISCLOSURE;if(!e)return d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.SIGNAL_NOT_ALLOWLISTED;return!d("WAWebMmSignalSharingExpirationWindowUtils").isMmSignalSharingUserDisclosedInCollectionWindow(a.mmSignalSharingExpirationWindow)?d("WAWebWamEnumOnePdSignalNotSharedReason").ONE_PD_SIGNAL_NOT_SHARED_REASON.WINDOW_EXPIRED:b}g.logMmSignalSharingVerificationEvent=a;g.logMmSignalSharingDisclosureStateEvent=e;g.logMmSignalSharingCollectionWindowStateEvent=f;g.logMmSignalSharingEvent=k}),98);
__d("WAWebMmSignalSharingModelUtils",["Promise","WAWebHandleMsgTypes.flow","WAWebMmSignalSharingExpirationWindowUtils","WAWebMmSignalSharingGatingUtils","WAWebMmSignalSharingTos","WAWebMsgGetters","WAWebMsgType","WAWebWamEnumDisclosureEventType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?!1:((a=a.contact)==null||(a=a.privacyMode)==null?void 0:a.hostStorage)===d("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook&&d("WAWebMsgGetters").getIsMarketingTemplateTag(b)}function a(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return(h||(h=b("Promise"))).resolve(!1);if(!i(a,c)||c.showMmDisclosure!==!0||e===d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.BODY_URL_CLICK&&!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureForMarketingMessageBodyLinksEnabled()||d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted())return(h||(h=b("Promise"))).resolve(!1);yield d("WAWebMmSignalSharingTos").refreshTos();return d("WAWebMmSignalSharingTos").isMmSignalSharingDisclosureTosAccepted()===!1});return j.apply(this,arguments)}function c(a){var b=a.chat,c=a.msg,e=a.btnIndex,f=a.isMmSignalSharingDisclosureTosAccepted;a=a.defaultUrl;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return a;if(i(b,c)&&f){c=(f=s(c,e))!=null?f:{};e=c.consentedUrl;f=c.unconsentedUrl;c=c.originalUrl;return q(b,e,f,c,a)}return a}function e(a){var b=a.chat,c=a.msg,e=a.isMmSignalSharingDisclosureTosAccepted;a=a.defaultUrl;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return{link:a,index:0};if(i(b,c)&&e){e=0;for(c of(c=c.urlTrackingMapElements)!=null?c:[]){var f=c.consentedUsersUrl,g=c.unconsentedUsersUrl,h=c.originalUrl;if(r(h)===r(a))return{link:q(b,f,g,h,a),index:e};e++}}return{link:a,index:void 0}}function f(a,b,c){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;switch(a){case d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.CTA_URL_CLICK:return s(b,c);case d("WAWebWamEnumDisclosureEventType").DISCLOSURE_EVENT_TYPE.BODY_URL_CLICK:return t(b,c);default:return null}}function k(a){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return!1;for(var b=0;b<((c=(c=a.interactivePayload)==null||(c=c.buttons)==null?void 0:c.length)!=null?c:0);b++){var c;c=(c=s(a,b))!=null?c:{};c=c.consentedUrl;if(c!=null)return!0}for(c=0;c<((b=(b=a.urlTrackingMapElements)==null?void 0:b.length)!=null?b:0);c++){b=(b=t(a,c))!=null?b:{};b=b.consentedUrl;if(b!=null)return!0}return!1}function l(a){var b,c=a.chat;a=a.fromMe;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return null;b=new Map((b=c.mmSignalSharingExpirationWindow)==null?void 0:b.map(function(a){return[a.messageId.id,a]}));c=c.msgs.getModelsArray().filter(function(a){return[d("WAWebMsgType").MSG_TYPE.CHAT,d("WAWebMsgType").MSG_TYPE.INTERACTIVE].includes(a.type)});var e,f=0;for(var g=c.length-1;g>=0;g--){var h;c[g].type===d("WAWebMsgType").MSG_TYPE.CHAT&&c[g].id.fromMe===a&&!p(c,g)&&f++;e=b.get(c[g].id.id);if(((h=e)==null?void 0:h.disclosedToken)!=null)break}return{mmSignalSharingExpirationWindowItem:e,messageOriginGroups:f,isContinuation:p(c,c.length-1)}}function m(a){var b=a.chat,c=a.mmSignalType;a=a.deepConversationParams;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;b=n({chat:b,deepConversationParams:a});a=d("WAWebMmSignalSharingGatingUtils").getMmSignalSharingOptimizedDeliverySignalCollectionConfig();var e=a.consented_types_allowlist;a=a.non_consented_types_allowlist;if(b){return(e=o(b==null?void 0:b.disclosedToken,c,e))!=null?e:o(b==null?void 0:b.undisclosedToken,c,a)}}function n(a){var b=a.chat;a=a.deepConversationParams;if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;if(a){a=l({chat:b,fromMe:a.isNewMessagefromMe});a=a!=null?a:{};a=a.mmSignalSharingExpirationWindowItem;return a}return(a=b.mmSignalSharingExpirationWindow)==null?void 0:a[b.mmSignalSharingExpirationWindow.length-1]}function o(a,b,c){return b!=null&&c.includes(b)?a:void 0}function p(a,b){return a.length>1&&a[b].type===d("WAWebMsgType").MSG_TYPE.CHAT&&a[b-1].type===d("WAWebMsgType").MSG_TYPE.CHAT&&a[b].id.fromMe===a[b-1].id.fromMe}function q(a,b,c,e,f){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return null;if(d("WAWebMmSignalSharingExpirationWindowUtils").isMmSignalSharingUserDisclosedInCollectionWindow(a.mmSignalSharingExpirationWindow)){return(b=(a=b!=null?b:c)!=null?a:e)!=null?b:f}return(a=c!=null?c:e)!=null?a:f}function r(a){return a==null?"":a.replace(/\/$/,"")}function s(a,b){if(b!=null){b=(a=(a=a.interactivePayload)==null||(a=a.buttons)==null?void 0:a[b])!=null?a:{};a=b.buttonParamsJson;if(a!=null){b=JSON.parse(a);a=b.url;var c=b.consented_users_url;b=b.unconsented_users_url;return{originalUrl:a,consentedUrl:c,unconsentedUrl:b}}}}function t(a,b){if(b!=null){b=(a=(a=a.urlTrackingMapElements)==null?void 0:a[b])!=null?a:{};a=b.consentedUsersUrl;var c=b.unconsentedUsersUrl;b=b.originalUrl;return{consentedUrl:a,unconsentedUrl:c,originalUrl:b}}}g.isDisclosureEnabledForMm=i;g.showDisclosureModalForMm=a;g.getCTALinkForMmSignalSharing=c;g.getBodyLinkForMmSignalSharing=e;g.getMMSignalSharingUrls=f;g.existsMmSignalSharingConsentedUrl=k;g.getMmSignalSharingNewMessageParams=l;g.getMMSignalSharingData=m;g.getMmSignalSharingExpirationWindowItem=n}),98);
__d("WAWebMmSignalSharingTos",["WATimeUtils","WAWebMmSignalSharingGatingUtils","WAWebTos","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h="20231028";function i(){return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?"":h}function a(){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;d("WAWebTos").TosManager.setState(i(),"ACCEPTED",d("WATimeUtils").unixTime())}function c(){return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?!1:d("WAWebTos").TosManager.getState(i())==="ACCEPTED"}function e(){return!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled()?!1:d("WAWebTos").TosManager.getState(d("WAWebTos").TOS_3_ID)==="ACCEPTED"}function f(){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("WAWebMmSignalSharingGatingUtils").isMmSignalSharingDisclosureEnabled())return;yield d("WAWebTos").TosManager.run({singleRun:!0})});return j.apply(this,arguments)}g.getMmSignalSharingDisclosureTosId=i;g.acceptMmSignalSharingDisclosureTos=a;g.isMmSignalSharingDisclosureTosAccepted=c;g.is2021TosAccepted=e;g.refreshTos=f}),98);
__d("WAWebMemberLabel.flow",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.castToMemberLabeString=a}),66);
__d("WAWebMemberLabelJob",["WAJobOrchestratorTypes","WAWebModelStorageUtils","WAWebOrchestratorNonPersistedJob","WAWebSchemaMemberLabel","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return a!=null&&a.lastEditTimestamp>b.lastEditTimestamp}function a(a){var c=a.chatId,e=a.member;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getMemberLabel",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaMemberLabel").getMemberLabelTable().get(c));return a==null?void 0:a.memberLabelMap.get(e)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function c(a){var c=a.chatId,e=a.member;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteMemberLabel",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebModelStorageUtils").getStorage().lock(["member-label"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null)return!1;b.memberLabelMap["delete"](e);if(b.memberLabelMap.size===0){yield a.remove(c);return!0}b={memberLabelMap:b.memberLabelMap};yield a.merge(c,b);return!0});return function(b){return a.apply(this,arguments)}}())}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function e(a){var c=a.chatId,e=a.member,f=a.memberLabel;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("createOrUpdateMemberLabel",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebModelStorageUtils").getStorage().lock(["member-label"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null){var d={chatId:c,memberLabelMap:new Map([[e,f]])};yield a.create(d);return!0}d=b.memberLabelMap.get(e);if(h(d,f))return!1;d={memberLabelMap:b.memberLabelMap.set(e,f)};yield a.merge(c,d);return!0});return function(b){return a.apply(this,arguments)}}())}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function f(a){var c=a.chatId;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getMemberLabelsForGroups",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebSchemaMemberLabel").getMemberLabelTable().get(c));return a==null?void 0:a.memberLabelMap}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function i(a){var c=a.chatId;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteAllLabelsForGroup",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebModelStorageUtils").getStorage().lock(["member-label"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(!b)return[];b=Array.from(b.memberLabelMap.keys());yield a.remove(c);return b});return function(b){return a.apply(this,arguments)}}())}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}function j(a){var c=a.chatId,e=a.members;return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("deleteMemberLabels",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebModelStorageUtils").getStorage().lock(["member-label"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.get(c));if(b==null)return[];var d=e.filter(function(a){return b.memberLabelMap["delete"](a)});b.memberLabelMap.size===0?yield a.remove(c):yield a.merge(c,{memberLabelMap:b.memberLabelMap});return d});return function(b){return a.apply(this,arguments)}}())}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.getMemberLabel=a;g.deleteMemberLabel=c;g.createOrUpdateMemberLabel=e;g.getMemberLabelsForGroups=f;g.deleteAllMemberLabelsForGroup=i;g.deleteMemberLabelsForGroup=j}),98);
__d("WAWebHandleMemberLabelChange",["WALogger","WATimeUtils","WAWebBackendApi","WAWebLidMigrationUtils","WAWebMemberLabel.flow","WAWebMemberLabelJob","WAWebWidToJid","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function a(a){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.memberLabel;a=a.baseMessage;var c=a.id.remote;a=a.id.participant;if(!c.isGroup()){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[handleMemberLabelChange]: chat is not a group"]))).sendLogs("Failed to handle member label change");return}if(a==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[handleMemberLabelChange]: member is null"]))).sendLogs("Failed to handle member label change");return}a=d("WAWebLidMigrationUtils").toUserLid(a);if(!a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[handleMemberLabelChange]: could not convert member id to lid"]))).sendLogs("Failed to handle member label change");return}var e=b.labelTimestamp;if(e==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[handleMemberLabelChange]: timestamp is null"]))).sendLogs("Failed to handle member label change");return}b=(b=b.label)!=null?b:"";c={chatId:d("WAWebWidToJid").widToGroupJid(c),member:d("WAWebWidToJid").userLidtoLidUserJid(a),memberLabel:{label:d("WAWebMemberLabel.flow").castToMemberLabeString(String(b)),lastEditTimestamp:d("WATimeUtils").castToUnixTime(Number(e))}};a=(yield d("WAWebMemberLabelJob").createOrUpdateMemberLabel(c));if(!a)return;d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[handleMemberLabelChange]: member label updated successfully"])));yield d("WAWebBackendApi").frontendSendAndReceive("updateMemberLabelCollection",{updates:[{type:"UPSERT",data:c}]})});return m.apply(this,arguments)}g.handleMemberLabelChange=a}),98);
__d("WAWebMemberLabelGating",["WAWebABProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("member_name_tag_db_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("member_name_tag_receiver_enabled")}g.isMemberLabelInfraEnabled=a;g.isMemberLabelReceiverEnabled=b}),98);
__d("WAWebParseProtocolMemberLabelMessageProto",["WAWebHandleMemberLabelChange","WAWebMemberLabelGating","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return null;var c=b.type;b=b.memberLabel;if(c!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.GROUP_MEMBER_LABEL_CHANGE||b==null)return null;if(!d("WAWebMemberLabelGating").isMemberLabelInfraEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"member_label"}),contextInfo:null};void d("WAWebHandleMemberLabelChange").handleMemberLabelChange({memberLabel:b,baseMessage:a});return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"member_label"}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebAssociationProtoUtils",["WANullthrows","WAWebAssociationProcessor","WAWebE2EProtoUtils","WAWebLidMigrationUtils","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationValidation","WAWebNewsletterIsNewsletterMsg","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason","WAWebWid","err"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.STICKER_ANNOTATION]);function i(a){a=d("WAWebMessageAssociation.flow").MessageAssociationType.cast(d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.getName(a));return a!=null?a:d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN}function j(a){switch(a){case d("WAWebMessageAssociation.flow").MessageAssociationType.UNKNOWN:throw c("err")("Invalid outgoing association type");case d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_ALBUM:return d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.MEDIA_ALBUM;case d("WAWebMessageAssociation.flow").MessageAssociationType.BOT_PLUGIN:return d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.BOT_PLUGIN;case d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL:return d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.MEDIA_POLL}}function a(a,b){return a==null||b==null?void 0:{messageAssociation:{associationType:j(a),parentMessageKey:d("WAWebE2EProtoUtils").msgKeyToProtobuf(b)}}}function k(a,b,e){var f=c("WAWebNewsletterIsNewsletterMsg")({from:b.from,to:b.to});return e==="history"&&!f?d("WAWebE2EProtoUtils").protobufToMsgKey(a):d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(a,b)}function b(a,b,e){b=k(a.parentMessageKey,b,e);e=i(a.associationType);a=d("WAWebAssociationProcessor").getAssociationProcessorByAssociationType(e);if(a==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.UNSUPPORTED_ASSOCIATION_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{associationParentMsgKey:c("WANullthrows")(b),associationType:e,viewMode:a.viewMode}}function e(a,b,e){b=b==null?void 0:b.messageAssociation;if(b!=null&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){if(e==="history_quoted"||e==="quoted")return null;var f=b.parentMessageKey;b=b.associationType;if(b===d("WAWebProtobufsE2E.pb").MessageAssociation$AssociationType.STATUS_NOTIFICATION)return null;if(f==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISSING_PARENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISSING_ASSOCIATION_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==="history")return{associationType:b,parentMessageKey:f};e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(f,a);if(e==null)throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.INVALID_PARENT_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=e.fromMe===a.id.fromMe&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(e.remote,a.id.remote))&&c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(e.participant,a.id.participant));if(!e&&!h.has(b))throw new(d("WAWebMessageAssociationValidation").MessageAssociationValidationError)(d("WAWebMessageAssociationValidation").MessageAssociationValidationErrorCode.MISMATCH_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.ERROR_PARENT_CHILD_SENDER_JID_MISMATCH);return{associationType:b,parentMessageKey:f}}return null}g.convertAssociationTypeFromProtoToClientSupportedAssociationType=i;g.convertAssociationTypeFromClientToProtoSupportedAssociationType=j;g.getValidatedOutgoingMessageAssociationContextInfo=a;g.getValidatedAssociationFieldsFromProto=b;g.validateMessageAssociationInMessageContextInfo=e}),98);
__d("WAWebProcessMessageAssociationMessages",["WALogger","WAWebAddonProcessMsgsUtils","WAWebAddonSortUtils","WAWebAssociationProcessor","WAWebAssociationProcessorConstants","WAWebMessageAssociationGatingUtils","WAWebMessageAssociationValidation","WAWebViewMode.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return;a=a;a=j(a,b);b=a.orphans;a=a.nonOrphansFromCache;return l(b,a)}function c(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a.length===0||!d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled())return;var c=(yield d("WAWebAddonProcessMsgsUtils").queryParentMsgs(a)),e=c[0];c=c[1];c=d("WAWebAddonSortUtils").collectValidAndOrphans(c,e);e=c.nonOrphans;c=c.orphans;a=e.length+c.length===a.length;if(!a)throw new(d("WAWebMessageAssociationValidation").MessageAssociationInfraError)(d("WAWebMessageAssociationValidation").MessageAssociationInfraErrorCode.MESSAGE_ASSOCIATIONS_MISMATCH);a=k(c,b);c=a.orphans;b=a.nonOrphansFromCache;return l(c,[].concat(e,b))});return i.apply(this,arguments)}function j(a,b){var c=[],d=[];a.forEach(function(a){b.has(a.parentMsgKey.toString())?c.push(a):d.push(a)});return{orphans:c,nonOrphansFromCache:d}}function k(a,b){var c=[],d=[];a.forEach(function(a){b.has(a.parentMsgKey.toString())?d.push(a):c.push(a)});return{orphans:c,nonOrphansFromCache:d}}function l(a,b){var c=[],e=[];a.forEach(function(a){var b=d("WAWebAssociationProcessor").getAssociationProcessor(a);b||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["classifyAssociatedMsgs: processor not found for ",""])),a.id.toString());(b==null?void 0:b.processorType)===d("WAWebAssociationProcessorConstants").AssociationProcessorType.WithDetachedMessages?e.push(a):c.push(a)});a=e.map(function(a){return babelHelpers["extends"]({},a,{viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE})});b=[].concat(b,a);var f=new Map();b.forEach(function(a){f.set(a.id.toString(),a)});return{orphanAssociatedMsgs:c,validAssociatedMsgs:f,detachedAssociatedMsgs:a}}g.classifyAssociatedMsgsFromHistorySyncUsingMissingParentsCache=a;g.classifyAssociatedMsgsUsingExistingParentsCache=c;g.collectOrphansFromMissingParentsCache=j;g.collectOrphansFromExistingParentsMessagesCache=k;g.classifyAssociatedOrphansNonOrphans=l}),98);
__d("WAWebMessageEditValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_PROTOCOL_KEY:"missing_protocol_key",MISSING_EDITED_MESSAGE:"missing_edited_message"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="MessageEditValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.MessageEditValidationErrorCode=a;g.MessageEditValidationError=c}),98);
__d("WAWebParseHistorySyncProtocolMessageEditProto",["WALogger","WALongInt","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMessageEditGatingUtils","WAWebMessageEditValidationError","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||(b==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return;if(a!=="history"&&a!=="history_quoted")return;try{if(!d("WAWebMessageEditGatingUtils").receiveTextEditEnabled())return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"message_edit",futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_edit"}),contextInfo:null};c=babelHelpers["extends"]({},c,{latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:c.id});var e=b.editedMessage;if(e==null)throw new(d("WAWebMessageEditValidationError").MessageEditValidationError)(d("WAWebMessageEditValidationError").MessageEditValidationErrorCode.MISSING_EDITED_MESSAGE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=b.key;if(b==null)throw new(d("WAWebMessageEditValidationError").MessageEditValidationError)(d("WAWebMessageEditValidationError").MessageEditValidationErrorCode.MISSING_PROTOCOL_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);Object.assign(c,d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:e,message:c,msgContext:a}));c.id=d("WAWebE2EProtoUtils").protobufToMsgKey(b,c.author);return{msgData:c,contextInfo:null}}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseHistorySyncEditedMessageProto: error:",", stack: ",""])),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("parseHistorySyncEditedMessageProto: EditParseError");throw a}}g["default"]=a}),98);
__d("WAWebParseProtocolMessageEditProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebFutureproofingEdit","WAWebMessageEditGatingUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.protocolMessage;if(b==null||(b==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.MESSAGE_EDIT)return;if(a!=="relay"&&a!=="outgoing")return;try{var e;e=(e=(e=i(c,b,a))!=null?e:j(c,b))!=null?e:k(c,b,a);return!e?null:e}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseProtocolMessageEditProto: error:",", stack: ",""])),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("parseProtocolMessageEditProto: EditParseError");throw a}}function i(a,b,e){var f;f=(f=(f=b.editedMessage)==null||(f=f.groupMentionedMessage)==null?void 0:f.message)!=null?f:b.editedMessage;var g=Boolean(f==null?void 0:f.conversation)||Boolean(f==null?void 0:f.extendedTextMessage);if(!g)return null;if(!d("WAWebMessageEditGatingUtils").receiveTextEditEnabled())return{msgData:d("WAWebFutureproofingEdit").futureproofEdit(a),contextInfo:null};g=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a);f=babelHelpers["extends"]({},d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:c("WANullthrows")(f),message:a,msgContext:e}),{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:d("WAWebMsgType").MSG_TYPE.CHAT,latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:a.id,protocolMessageKey:g});return{msgData:f,contextInfo:null}}function j(a,b){var c;c=(c=(c=b.editedMessage)==null||(c=c.groupMentionedMessage)==null?void 0:c.message)!=null?c:b.editedMessage;var e,f,g;if(c!=null&&c.imageMessage)e=d("WAWebMsgType").MSG_TYPE.IMAGE,f=c.imageMessage.caption,g=c.imageMessage.contextInfo;else if(c!=null&&c.videoMessage)e=d("WAWebMsgType").MSG_TYPE.VIDEO,f=c.videoMessage.caption,g=c.videoMessage.contextInfo;else if(c!=null&&c.documentMessage)e=d("WAWebMsgType").MSG_TYPE.DOCUMENT,f=c.documentMessage.caption,g=c.documentMessage.contextInfo;else if(c!=null&&c.documentWithCaptionMessage){var h;e=d("WAWebMsgType").MSG_TYPE.DOCUMENT;f=(h=c.documentWithCaptionMessage)==null||(h=h.message)==null||(h=h.documentMessage)==null?void 0:h.caption;g=(h=c.documentWithCaptionMessage)==null||(h=h.message)==null||(h=h.documentMessage)==null?void 0:h.contextInfo}if(!e||f===""||f==null)return null;if(!d("WAWebMessageEditGatingUtils").receiveCaptionEditEnabled())return{msgData:d("WAWebFutureproofingEdit").futureproofEdit(a),contextInfo:null};c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:e,caption:f,latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:a.id,protocolMessageKey:d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a)});return{msgData:c,contextInfo:g}}function k(a,b,e){var f;f=(f=b.editedMessage)==null?void 0:f.richResponseMessage;if(!f)return null;f=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a);e=babelHelpers["extends"]({},d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:c("WANullthrows")(b.editedMessage),message:a,msgContext:e}),{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:d("WAWebMsgType").MSG_TYPE.RICH_RESPONSE,latestEditSenderTimestampMs:d("WALongInt").maybeNumberOrThrowIfTooLarge(b.timestampMs),latestEditMsgKey:a.id,protocolMessageKey:f});return{msgData:e,contextInfo:null}}g["default"]=a}),98);
__d("WAWebParseProtocolMessageHistoryBundleProto",["WALogger","WAWebE2EProtoParserApi","WAWebGroupHistoryGating","WAWebGroupHistoryMsgData.flow","WAWebMessageHistoryValidation","WAWebMessageHistoryValidationError","WAWebMmsMediaTypes","WAWebMsgType","WAWebProtobufsWeb.pb","WAWebUserPrefsMeUser","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.messageHistoryBundle;if(b==null)return null;d("WAWebMessageHistoryValidation").validateMessageHistoryBundle(b);if(!d("WAWebGroupHistoryGating").isGroupHistoryReceiverEnabled()){var c;return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PROTOCOL,futureproofSubtype:"message_history_bundle"}),contextInfo:(c=b.contextInfo)!=null?c:null}}c=(c=b.messageHistoryMetadata)==null?void 0:c.historyReceivers.some(function(a){return d("WAWebUserPrefsMeUser").isMeAccount(d("WAWebWidFactory").createWid(a))});if(c===!0||d("WAWebUserPrefsMeUser").isMeAccount(a.from)){c=i(b);c=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE,kind:"messageHistoryBundle",subtype:"message_history_bundle",groupHistoryBundleMetadata:b.messageHistoryMetadata?babelHelpers["extends"]({},b.messageHistoryMetadata,{processState:j(a.groupHistoryBundleInfo)}):null,directPath:c==null?void 0:c.directPath,encFilehash:c==null?void 0:c.encFilehash,filehash:c==null?void 0:c.filehash,mediaKey:c==null?void 0:c.mediaKey});return{msgData:c,contextInfo:(c=b.contextInfo)!=null?c:null}}return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"message_history_bundle"}),contextInfo:(c=b.contextInfo)!=null?c:null}}function i(a){var b=a.directPath,c=a.fileEncSha256,e=a.fileSha256;a=a.mediaKey;try{e=d("WAWebE2EProtoParserApi").decodeBytes(e);if(e==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_FILE_SHA256,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebMessageHistoryValidationError").MessageHistoryValidationError)(d("WAWebMessageHistoryValidationError").MessageHistoryValidationErrorCode.MISSING_DIRECT_PATH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{directPath:b,encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(c),filehash:e,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(a),type:d("WAWebMmsMediaTypes").MEDIA_TYPES.GROUP_HISTORY,signal:new AbortController().signal,userDownloadAttemptCount:0}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[GroupHistory] Failed to download message history bundle"]))).devConsole(a).sendLogs("group-history-failed-to-download-bundle")}}function j(a){return function(a){if(a===d("WAWebProtobufsWeb.pb").GroupHistoryBundleInfo$ProcessState.NOT_INJECTED)return d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.NONE;if(a===d("WAWebProtobufsWeb.pb").GroupHistoryBundleInfo$ProcessState.INJECTED)return d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.INJECTED;if(a===d("WAWebProtobufsWeb.pb").GroupHistoryBundleInfo$ProcessState.INJECTED_PARTIAL)return d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.INJECTED_PARTIAL;return a===d("WAWebProtobufsWeb.pb").GroupHistoryBundleInfo$ProcessState.INJECTION_FAILED?d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.FAILED:d("WAWebGroupHistoryMsgData.flow").MessageHistoryBundleProcessState.NONE}(a==null?void 0:a.processState)}g["default"]=a}),98);
__d("WAWebMusicParsingUtils",["WABase64","WALogger","WAWebCountriesUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){a=Array.from(new Uint8Array(a)).map(function(a){return String.fromCharCode(a)});var b=new Set(),c=new Set();for(var e=0;e<a.length-1;e+=2){var f=(""+a[e]+a[e+1]).toUpperCase(),g=d("WAWebCountriesUtils").asISOCountryCode(f);g!=null?b.add(g):c.add(f)}c.size>0&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[music] invalid country codes"]))).devConsole(c).sendLogs("music-invalid-country-codes");return b}function a(a){var b=a.musicContentMediaId,c=a.songId,e=a.author,f=a.title,g=a.artworkDirectPath,h=a.artworkSha256,j=a.artworkEncSha256,k=a.artistAttribution,l=a.countryBlocklist,m=a.isExplicit;a=a.artworkMediaKey;return b==null||c==null||e==null||f==null?null:{musicContentMediaId:b,songId:c,author:e,title:f,artworkDirectPath:g,artworkSha256:h!=null?d("WABase64").encodeB64(h):void 0,artworkEncSha256:j!=null?d("WABase64").encodeB64(j):void 0,artworkMediaKey:a!=null?d("WABase64").encodeB64(a):void 0,isExplicit:Boolean(m),artistAttribution:k,countryBlocklist:l!=null?i(l):new Set()}}g.mapToCountryCode=i;g.toMusicMetadata=a}),98);
__d("WAWebDBStoreNewsletterEncryptedMsgs",["WALogger","WAPromiseMap","WAWebDBStoreMessage","WAWebDBStoreMessageAssociations","WAWebDBStoreMsgsUtils","WAWebMessageAssociationGatingUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebNewsletterDBUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["message","chat","message-association"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f=e[0];e[1];e[2];var g=(yield d("WAWebDBStoreMsgsUtils").getLastRowId(f));e=(yield d("WAPromiseMap").promiseMap(a,function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f=a[0];a=a[1];e=(e=f.serverId)!=null?e:yield d("WAWebNewsletterDBUtils").getTemporaryServerId(f.to);if(e==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][storage] serverId is missing from message"]))).tags("newsletter").devConsole(f).sendLogs("newsletter-missing-serverId");return null}var i=c("WAWebMsgKey").fromString(f.id),j=d("WAWebDBStoreMessage").isPendingUnreadReceipt(i,f);f=d("WAWebDBStoreMessage").addMsgMetadataToMsgRow({msg:f,chatId:i.remote.toString(),hasLink:a,inChatMsgId:e,rowId:g+b+1,pendingReadReceipt:j});delete f.serverId;return f});return function(b,c){return a.apply(this,arguments)}}())).filter(Boolean);try{d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&(yield d("WAWebDBStoreMessageAssociations").bulkStoreMessageAssociations(e)),yield f.bulkCreateWith_ALREADY_ENCRYPTED_RECORDS_ONLY(e)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[newsletter-store] Failed to store messages"]))).tags("newsletter").devConsole(a)}});return function(a){return e.apply(this,arguments)}}())}g.storeEncryptedNewsletterMessages=a}),98);
__d("WAWebNewsletterDBConstants",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({Subscriber:0,Admin:1,Guest:2,Owner:3});f.NewsletterDBMembership=a}),66);
__d("WAWebNewsletterDBUtils",["WATimeUtils","WAWebApiChat","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebDBMsgUtils","WAWebJidToWid","WAWebMsgKey","WAWebMsgType","WAWebNewsletterDBConstants","WAWebSchemaMessage","WAWebSchemaNewsletterMetadata","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(yield d("WAWebApiChat").getChatRecord(d("WAWebJidToWid").newsletterJidToWid(a)))!=null});return h.apply(this,arguments)}function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaNewsletterMetadata").getNewsletterMetadataTable().get(a));return a==null||a.membershipType===d("WAWebNewsletterDBConstants").NewsletterDBMembership.Guest});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield i(a));return!a});return k.apply(this,arguments)}var l=Number.MAX_SAFE_INTEGER-1e4;function f(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=d("WAWebDBMessageUtils").craftInternalId(b,a);a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],[b]));b=a[0];return b==null?null:d("WAWebDBMessageSerialization").messageFromDbRow(b)});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new Map(),e=new Map(a.map(function(a){return[d("WAWebDBMessageUtils").craftInternalId(b,a),a]}));a=(yield d("WAWebSchemaMessage").getMessageTable().anyOf(["internalId"],Array.from(e.keys())));a.forEach(function(a){if(a.internalId==null)return;var b=e.get(a.internalId);if(b==null)return;c.set(b,d("WAWebDBMessageSerialization").messageFromDbRow(a))});return c});return o.apply(this,arguments)}function p(a,b){b=b instanceof c("WAWebWid")?b:d("WAWebWidFactory").createWid(b);return new(c("WAWebMsgKey"))({remote:b,fromMe:!0,id:a.toString(10)})}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebDBMessageUtils").craftInternalId(a.toJid(),l);a=d("WAWebDBMessageUtils").endOfChat(a);b=(yield d("WAWebSchemaMessage").getMessageTable().between(["internalId"],b,a,{lowerInclusive:!0,upperInclusive:!1,limit:1,reverse:!0}));if(b.length===0)return l;if(b[0].internalId==null)return l;a=d("WAWebDBMessageUtils").getInChatMsgId(b[0].internalId);return Math.min(a+1,Number.MAX_SAFE_INTEGER)});return r.apply(this,arguments)}function s(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaMessage").getMessageTable().bulkGet(a.map(String)));a=a.filter(Boolean).map(function(a){return{id:a.id,viewed:!0}});yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(a)});return t.apply(this,arguments)}function u(a,b,c){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("WAWebDBMsgUtils").getMsgsByChatId(b));var e=d("WATimeUtils").unixTime();b=b.filter(function(a){return a.type===d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE}).map(function(a){return d("WAWebDBMessageSerialization").messageFromDbRow(a)});return b.filter(function(b){if(!b.from.equals(c))return!1;b=(b=b.newsletterAdminInviteInfo)!=null?b:{};var d=b.newsletterId;b=b.inviteExpiration;return d==null||b==null?!1:e<b&&a.equals(d)})});return v.apply(this,arguments)}g.doesNewsletterExistInStorage=a;g.isPreviewNewsletter=i;g.isSubscribedNewsletter=e;g.TEMPORARY_SERVER_ID_LOWER_BOUND=l;g.getMessageByServerId=f;g.bulkGetMessagesByServerIds=n;g.craftNewsletterMsgKeyFromServerId=p;g.getTemporaryServerId=q;g.updateMsgViewReceipt=s;g.getUnexpiredNewsletterAdminInviteMessageRecordsFromChat=u}),98);
__d("WAWebNewsletterLogExposureJob",["WAJobOrchestratorTypes","WAWebMexLogNewsletterExposureJob","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("logNewsletterExposure",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){return d("WAWebMexLogNewsletterExposureJob").mexLogNewsletterExposure(a,c)}),{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}).waitUntilCompleted()}g.logNewsletterExposure=a}),98);
__d("WAWebNewsletterAdminInviteMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_NEWSLETTER_JID:"newsletter_admin_invite_missing_newsletter_jid",MISSING_NEWSLETTER_NAME:"newsletter_admin_invite_missing_newsletter_name",MISSING_INVITE_EXPIRATION:"newsletter_admin_invite_missing_invite_expiration",INVALID_NEWSLETTER_JID:"newsletter_admin_invite_invalid_newsletter_jid"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="NewsletterAdminInviteMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.NewsletterAdminInviteMessageValidationErrorCode=a;g.NewsletterAdminInviteMessageValidationError=c}),98);
__d("WAWebParseNewsletterAdminInviteMessageProto",["WATimeUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebNewsletterAdminInviteMessageValidationError","WAWebNewsletterGatingUtils","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.newsletterAdminInviteMessage;if(b==null)return;if(!d("WAWebNewsletterGatingUtils").isNewsletterCreationEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE}),contextInfo:b.contextInfo};var c=b.caption,e=b.inviteExpiration,f=b.newsletterJid,g=b.newsletterName;b=b.contextInfo;if(f==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.MISSING_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=d("WAWebE2EProtoUtils").strictDecodeJid(f);if(f==null)throw new(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationError)(d("WAWebNewsletterAdminInviteMessageValidationError").NewsletterAdminInviteMessageValidationErrorCode.INVALID_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_ADMIN_INVITE,kind:d("WAWebMsgType").MsgKind.NewsletterAdminInvite,newsletterAdminInviteInfo:{newsletterId:d("WAWebWidFactory").asNewsletterWidOrThrow(f),newsletterName:g,inviteExpiration:d("WATimeUtils").castLongIntToUnixTime(e),inviteMessage:c!=null?c:"",pictureThumbnail:null}}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebNewsletterFollowerInviteMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_NEWSLETTER_JID:"newsletter_follower_invite_missing_newsletter_jid",MISSING_NEWSLETTER_NAME:"newsletter_follower_invite_missing_newsletter_name",INVALID_NEWSLETTER_JID:"newsletter_follower_invite_invalid_newsletter_jid"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="NewsletterFollowerInviteMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.NewsletterFollowerInviteMessageValidationErrorCode=a;g.NewsletterFollowerInviteMessageValidationError=c}),98);
__d("WAWebParseNewsletterFollowerInviteMessageProto",["WAArrayBufferUtils","WAWebE2EProtoUtils","WAWebMsgType","WAWebNewsletterFollowerInviteMessageValidationError","WAWebNewsletterGatingUtils","WAWebWamEnumE2eFailureReason","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.newsletterFollowerInviteMessageV2;b=b;if(b==null)return;if(!d("WAWebNewsletterGatingUtils").isChannelInviteContactsToFollowConsumerEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_FOLLOWER_INVITE}),contextInfo:b.contextInfo};var c=b.caption,e=b.newsletterJid,f=b.newsletterName,g=b.contextInfo;b=b.jpegThumbnail;if(e==null)throw new(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationError)(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationErrorCode.MISSING_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationError)(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationErrorCode.MISSING_NEWSLETTER_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=d("WAWebE2EProtoUtils").strictDecodeJid(e);if(e==null)throw new(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationError)(d("WAWebNewsletterFollowerInviteMessageValidationError").NewsletterFollowerInviteMessageValidationErrorCode.INVALID_NEWSLETTER_JID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_FOLLOWER_INVITE,kind:d("WAWebMsgType").MsgKind.NewsletterFollowerInvite,newsletterFollowerInviteInfo:{newsletterId:d("WAWebWidFactory").asNewsletterWidOrThrow(e),newsletterName:f,inviteMessage:c!=null?c:"",pictureThumbnail:b?d("WAArrayBufferUtils").arrayBufferToString(b):null}}),contextInfo:g}}g["default"]=a}),98);
__d("WAWebMusicGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WAWebABProps").getABPropConfigValue("wabba_receiver_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("wabba_save_to_camera_roll_enabled")}function c(){return d("WAWebABProps").getABPropConfigValue("channels_music_receiver_enabled")}g.isStatusMusicReceiverEnabled=a;g.isStatusMusicSaveToDiskEnabled=b;g.isStatusMusicReceiverEnabledForNewsletter=c}),98);
__d("WAWebNewsletterFutureProofUtils",["WAWebABProps","WAWebMsgGetters","WAWebMsgType","WAWebMusicGatingUtils","WAWebNewsletterGatingUtils","WAWebPollCreationUtils","WAWebPollsGatingUtils","WAWebQuestionsGatingUtils"],(function(a,b,c,d,e,f,g){var h=new Map([[1,(b=d("WAWebMsgType")).MSG_TYPE.CHAT],[2,b.MSG_TYPE.IMAGE],[3,b.MSG_TYPE.VIDEO],[4,b.MSG_TYPE.AUDIO],[5,b.MSG_TYPE.PTT],[6,b.MSG_TYPE.LOCATION],[7,b.MSG_TYPE.VCARD],[8,b.MSG_TYPE.DOCUMENT],[11,b.MSG_TYPE.MULTI_VCARD],[12,b.MSG_TYPE.REACTION],[13,b.MSG_TYPE.POLL_CREATION],[14,b.MSG_TYPE.POLL_UPDATE],[15,b.MSG_TYPE.STICKER],[16,b.MSG_TYPE.POLL_RESULT_SNAPSHOT],[17,b.MSG_TYPE.STICKER_PACK]]);function i(){return d("WAWebABProps").getABPropConfigValue("channel_supported_message_types").split(",").map(function(a){return Number.parseInt(a.trim(),10)}).filter(Number.isSafeInteger).reduce(function(a,b){b=h.get(b);b!=null&&a.add(b);return a},new Set())}function j(a){var b=i().has(a);switch(a){case d("WAWebMsgType").MSG_TYPE.PTT:return d("WAWebNewsletterGatingUtils").isNewsletterPTTReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.PTV:return d("WAWebNewsletterGatingUtils").isNewsletterPTVReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.POLL_CREATION:case d("WAWebMsgType").MSG_TYPE.POLL_UPDATE:return d("WAWebNewsletterGatingUtils").isNewsletterPollsReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT:return d("WAWebPollsGatingUtils").isPollResultSnapshotReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.AUDIO:return d("WAWebNewsletterGatingUtils").isNewsletterAudioFileReceivingEnabled();case d("WAWebMsgType").MSG_TYPE.ALBUM:return d("WAWebNewsletterGatingUtils").isNewsletterAlbumsV2ReceiverEnabled();case d("WAWebMsgType").MSG_TYPE.NEWSLETTER_FOLLOWER_INVITE:return d("WAWebNewsletterGatingUtils").isChannelInviteContactsToFollowConsumerEnabled();default:return b}}function a(a){var b=a.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN?a.futureproofType:a.type;if(b==null)return{supported:!1};if(!j(b))return{supported:!1};if(d("WAWebMsgGetters").getIsReply(a)&&!d("WAWebNewsletterGatingUtils").isNewsletterReceivingAdminRepliesEnabled())return{supported:!1};if(d("WAWebMsgGetters").getIsQuestion(a)&&!d("WAWebQuestionsGatingUtils").isQuestionReceiverEnabledForMsg(a))return{supported:!1};if(d("WAWebMsgGetters").getIsQuestionReply(a)&&!d("WAWebQuestionsGatingUtils").isQuestionReplyReceiverEnabledForMsg(a))return{supported:!1};if(d("WAWebMsgGetters").getPollType(a)===d("WAWebPollCreationUtils").PollType.QUIZ&&!d("WAWebNewsletterGatingUtils").isNewsletterQuizReceiverEnabled())return{supported:!1};return d("WAWebMsgGetters").isNewsletterMsgWithMusic(a)&&!d("WAWebMusicGatingUtils").isStatusMusicReceiverEnabledForNewsletter()?{supported:!1,reason:"phone_only_feature"}:{supported:!0}}g.isMsgTypeSupported=j;g.isMsgSupported=a}),98);
__d("WAWebParseForwardedNewsletterMessageInfo",["WALogger","WAWebChatEntryPoint","WAWebE2EProtoUtils","WAWebProtobufsE2E.pb","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(a){var b=a.newsletterJid,c=a.newsletterName;a=a.serverMessageId;b=d("WAWebE2EProtoUtils").strictDecodeJid(b);return{newsletterId:b!=null?d("WAWebWidFactory").asNewsletterWidOrThrow(b):void 0,newsletterName:c,serverMessageId:a}}function b(a){var b,c=a==null||(b=a.newsletter)==null?void 0:b.contentType;if(c==null){var e;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Did not receive content type from newsletter annotation"]))).tags("newsletter-logging").devConsole(a).sendLogs("Missing content type in newsletter annotation");return(a==null||(e=a.newsletter)==null?void 0:e.serverMessageId)==null?d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCard:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterPostLinkCard}return c===d("WAWebProtobufsE2E.pb").ContextInfo$ForwardedNewsletterMessageInfo$ContentType.LINK_CARD?a.shouldSkipConfirmation===!0?d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCardButton:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterLinkCard:d("WAWebChatEntryPoint").ChatEntryPoint.NewsletterPostLinkCard}g.parseForwardedNewsletterMessageInfo=a;g.getChatEntryPointFromNewsletterLinkAnnotation=b}),98);
__d("WAWebGetEnumValuesFromConfig",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.config,c=a.enumCastFunction,d=new Set();return b.split(",").map(function(a){return Number.parseInt(a.trim(),10)}).filter(Number.isSafeInteger).map(function(a){if(d.has(a))return null;d.add(a);return c(a)}).filter(Boolean)}f.getEnumValuesFromConfig=a}),66);
__d("WAWebNewsletterDirectoryCategoryUtils",["$InternalEnum","WALogger","WAWebGetEnumValuesFromConfig"],(function(a,b,c,d,e,f,g){var h,i=b("$InternalEnum")({Business:1,Entertainment:2,Lifestyle:3,News:4,Organizations:5,People:6,Sports:7,SpecialEvents:8,SpecialEvents2:9,SpecialEvents3:10,SpecialEvents4:11,SpecialEvents5:12});function a(a){switch(a){case i.Business:return"BUSINESS";case i.Entertainment:return"ENTERTAINMENT";case i.Lifestyle:return"LIFESTYLE";case i.News:return"NEWS";case i.Organizations:return"ORGANIZATIONS";case i.People:return"PEOPLE";case i.Sports:return"SPORTS";case i.SpecialEvents:return"SPECIAL_EVENTS";case i.SpecialEvents2:return"SPECIAL_EVENTS_2";case i.SpecialEvents3:return"SPECIAL_EVENTS_3";case i.SpecialEvents4:return"SPECIAL_EVENTS_4";case i.SpecialEvents5:return"SPECIAL_EVENTS_5"}}function c(a){switch(a){case"BUSINESS":return{type:i.Business,name:"Business"};case"ENTERTAINMENT":return{type:i.Entertainment,name:"Entertainment"};case"LIFESTYLE":return{type:i.Lifestyle,name:"Lifestyle"};case"NEWS":return{type:i.News,name:"News & Information"};case"ORGANIZATIONS":return{type:i.Organizations,name:"Organizations"};case"PEOPLE":return{type:i.People,name:"People"};case"SPORTS":return{type:i.Sports,name:"Sports"};case"SPECIAL_EVENTS":return{type:i.SpecialEvents,name:"Special Events"};case"SPECIAL_EVENTS_2":return{type:i.SpecialEvents2,name:"Special Events 2"};case"SPECIAL_EVENTS_3":return{type:i.SpecialEvents3,name:"Special Events 3"};case"SPECIAL_EVENTS_4":return{type:i.SpecialEvents4,name:"Special Events 4"};case"SPECIAL_EVENTS_5":return{type:i.SpecialEvents5,name:"Special Events 5"};case"EXPLORE":case"EXPLORE_MORE":return void 0}}function e(a){switch(a){case"BUSINESS":return i.Business;case"ENTERTAINMENT":return i.Entertainment;case"LIFESTYLE":return i.Lifestyle;case"NEWS":return i.News;case"ORGANIZATIONS":return i.Organizations;case"PEOPLE":return i.People;case"SPORTS":return i.Sports;case"SPECIAL_EVENTS":return i.SpecialEvents;case"SPECIAL_EVENTS_2":return i.SpecialEvents2;case"SPECIAL_EVENTS_3":return i.SpecialEvents3;case"SPECIAL_EVENTS_4":return i.SpecialEvents4;case"SPECIAL_EVENTS_5":return i.SpecialEvents5;default:a;d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected category: ",""])),a).tags("newsletter-directory-category").sendLogs("Unexpected newsletter directory category");return i.Business}}function f(a){switch(a){case i.Business:return"BUSINESS";case i.Entertainment:return"ENTERTAINMENT";case i.Lifestyle:return"LIFESTYLE";case i.News:return"NEWS";case i.Organizations:return"ORGANIZATIONS";case i.People:return"PEOPLE";case i.Sports:return"SPORTS";case i.SpecialEvents:return"SPECIAL_EVENTS";case i.SpecialEvents2:return"SPECIAL_EVENTS_2";case i.SpecialEvents3:return"SPECIAL_EVENTS_3";case i.SpecialEvents4:return"SPECIAL_EVENTS_4";case i.SpecialEvents5:return"SPECIAL_EVENTS_5"}}function j(a){return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return i.cast(a)}})}g.NewsletterDirectoryCategoryType=i;g.getNewsletterSectionFromCategoryType=a;g.getNewsletterCategoryFromSection=c;g.getNewsletterDirectoryCategoryTypeFromValue=e;g.getCategoryValueFromEnum=f;g.getNewsletterDirectoryCategoryTypesFromConfig=j}),98);
__d("WAWebWamEnumChannelDirectoryPillSelected",[],(function(a,b,c,d,e,f){a=Object.freeze({RECOMMENDED:1,TRENDING:2,FEATURED:3,NEW:4,POPULAR:5});f.CHANNEL_DIRECTORY_PILL_SELECTED=a}),66);
__d("WAWebNewsletterDirectoryFilterUtils",["$InternalEnum","WAWebWamEnumChannelDirectoryPillSelected"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Featured:"FEATURED",New:"NEW",Popular:"POPULAR",Recommended:"RECOMMENDED",Trending:"TRENDING"}),i=b("$InternalEnum")({Recommended:1,Trending:2,Featured:3,New:4,Popular:5,Country:6});function a(a){switch(a){case i.Recommended:case i.Country:return h.Recommended;case i.Trending:return h.Trending;case i.Featured:return h.Featured;case i.New:return h.New;case i.Popular:return h.Popular}}function c(a){switch(a){case h.Recommended:return i.Recommended;case h.Trending:return i.Trending;case h.Featured:return i.Featured;case h.New:return i.New;case h.Popular:return i.Popular}}function e(a){if(a==null)return void 0;switch(a){case h.Recommended:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.RECOMMENDED;case h.New:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.NEW;case h.Popular:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.POPULAR;case h.Trending:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.TRENDING;case h.Featured:return d("WAWebWamEnumChannelDirectoryPillSelected").CHANNEL_DIRECTORY_PILL_SELECTED.FEATURED}}g.NewsletterDirectoryListView=h;g.NewsletterDirectoryFilterType=i;g.getNewsletterDirectoryListViewFromFilter=a;g.getNewsletterDirectoryFilterFromListView=c;g.getNewsletterSelectedPill=e}),98);
__d("WAWebNewsletterMembershipUtil",["WAWebCommonNewsletterEnums"],(function(a,b,c,d,e,f,g){function a(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber}function b(a){return h(a)||i(a)}function h(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner}function i(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin}function c(a){return(a==null?void 0:a.membershipType)===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest}g.iAmSubscriber=a;g.iAmAdminOrOwner=b;g.iAmOwner=h;g.iAmAdmin=i;g.iAmGuest=c}),98);
__d("WAWebPtvGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("ptv_receiving_enabled")}function b(){return d("WAWebABProps").getABPropConfigValue("ptv_autoplay_enabled")}function c(){var a=d("WAWebABProps").getABPropConfigValue("ptv_autoplay_loop_limit");return a===0?Infinity:a}function e(){return d("WAWebABProps").getABPropConfigValue("ptv_max_duration_seconds")}g.isPtvReceivingEnabled=a;g.isPtvAutoplayEnabled=b;g.getPtvAutoplayLoopLimit=c;g.getPtvMaxDurationSeconds=e}),98);
__d("WAWebNewsletterGatingUtils",["$InternalEnum","WAWebABProps","WAWebCommonNewsletterEnums","WAWebGetEnumValuesFromConfig","WAWebLogNewsletterExposureAction","WAWebMobilePlatforms","WAWebMsgType","WAWebNewsletterDirectoryCategoryUtils","WAWebNewsletterDirectoryFilterUtils","WAWebNewsletterFutureProofUtils","WAWebNewsletterMembershipUtil","WAWebPrimaryFeatures","WAWebPtvGatingUtils","WAWebStateUtils","gkx"],(function(a,b,c,d,e,f,g){var h=b("$InternalEnum")({Disabled:0,NeedsUpgrade:1,Enabled:2}),i=b("$InternalEnum")({Disabled:0,NeedsUpgrade:1,Enabled:2,AvailableOnPhone:3}),j=b("$InternalEnum")({Disabled:0,EnabledAdminsOnly:1,EnabledAdminsAndFollowers:2,EnabledEveryone:3});function k(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("newsletter")||c("gkx")("26256")}function a(){var a=h.cast(d("WAWebABProps").getABPropConfigValue("channels_enabled"));if(a==null)return i.Disabled;if(!k())return i.Disabled;switch(a){case h.Disabled:return i.AvailableOnPhone;case h.Enabled:return i.Enabled;case h.NeedsUpgrade:return i.NeedsUpgrade}}function l(){return d("WAWebABProps").getABPropConfigValue("channels_enabled")===i.Enabled}function m(a){return l()&&d("WAWebABProps").getABPropConfigValue(a)===!0}var n=5e3;function e(){return n}function f(){return m("dsa_information_for_eu_only_enabled")}function o(){return m("dsa_channels_report_unlawful_content_enabled")}function p(){return m("channel_osa_reporting_enabled")}function q(){return m("channels_uk_osa_enabled")}function r(){return m("dsa_21_channel_reporting_enabled")}function s(){return(d("WAWebABProps").getABPropConfigValue("channels_question_admin_enabled")||d("WAWebABProps").getABPropConfigValue("channels_question_follower_enabled"))&&m("channels_questions_integrity_m1_enabled")}function t(a){var b=!1;if(a==null)return!1;switch(a){case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner:case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")>=j.EnabledAdminsOnly;break;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Subscriber:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")>=j.EnabledAdminsAndFollowers;break;case d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Guest:b=d("WAWebABProps").getABPropConfigValue("channel_view_counts_enabled")===j.EnabledEveryone;break}return l()&&b}function u(){return m("channels_send_view_receipt_enabled")}function v(){return l()&&d("WAWebABProps").getABPropConfigValue("channels_creation_enabled")===i.Enabled}function w(a){return((a=a.newsletterMetadata)==null?void 0:a.reactionCodesSetting)===d("WAWebCommonNewsletterEnums").NewsletterReactionCodesSetting.All&&y()}function x(){return m("channel_reactions_enabled")&&d("WAWebNewsletterFutureProofUtils").isMsgTypeSupported(d("WAWebMsgType").MSG_TYPE.REACTION)}function y(){return m("channel_reactions_settings_enabled")}function z(a,b){return x()&&!b&&d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a==null?void 0:a.newsletterMetadata)&&d("WAWebABProps").getABPropConfigValue("channel_reactions_sender_list_enabled")}function A(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_tos_notice_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_tos_notice_id")}function B(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_creation_tos_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_creation_tos_id")}function C(){return d("WAWebMobilePlatforms").isSMB()?d("WAWebABProps").getABPropConfigValue("newsletter_admin_invite_tos_id_smb_web"):d("WAWebABProps").getABPropConfigValue("newsletter_admin_invite_tos_id")}function D(){return d("WAWebABProps").getABPropConfigValue("newsletter_creation_nux_id")}function E(){return!1}function F(){return l()&&d("WAWebABProps").getABPropConfigValue("channels_directory_enabled")===h.Enabled}function G(){return d("WAWebABProps").getABPropConfigValue("channels_directory_page_size")}function H(){return d("WAWebABProps").getABPropConfigValue("channels_directory_search_debounce_ms")}function I(){var a=d("WAWebABProps").getABPropConfigValue("channels_directory_v2_filter_types");return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return d("WAWebNewsletterDirectoryFilterUtils").NewsletterDirectoryFilterType.cast(a)}})}function J(){return m("channels_filter_out_subscribed_in_directory_null_state")}function K(){return d("WAWebABProps").getABPropConfigValue("channels_directory_v2_cache_refresh_interval_ms")}function L(){return m("channels_directory_categories_enabled")}function M(){return d("WAWebABProps").getABPropConfigValue("directory_categories_newsletters_per_category_limit")}function N(){return d("WAWebABProps").getABPropConfigValue("channels_directory_categories_cache_refresh_interval_ms")}function O(){var a=d("WAWebABProps").getABPropConfigValue("channels_directory_category_types");return d("WAWebGetEnumValuesFromConfig").getEnumValuesFromConfig({config:a,enumCastFunction:function(a){return d("WAWebNewsletterDirectoryCategoryUtils").NewsletterDirectoryCategoryType.cast(a)}})}function P(){return d("WAWebABProps").getABPropConfigValue("directory_categories_display_newsletters_per_category_limit")}function aa(){return L()&&m("channels_directory_categories_logging_enabled")}function ba(){return d("WAWebABProps").getABPropConfigValue("recommended_channels_background_refresh")}function ca(){return d("WAWebABProps").getABPropConfigValue("channels_followers_list_cache_refresh_milliseconds")}function da(){return m("channel_forward_to_chat_enabled")}function ea(){return m("channels_forward_logging_v2_enabled")}function fa(){return m("channel_to_channel_forwarding_logging_enabled")}function ga(){return m("channel_forward_to_chat_v2_message_navigation_enabled")}function ha(a){return a.isNewsletter()?ia():ja()}function ia(){return m("channels_forward_to_channel_enabled")}function ja(){return m("channels_forward_from_chat_to_channel_enabled")}function ka(){return m("channel_forward_bottom_button_enabled")}function la(){return m("channels_message_edit_enabled")}function ma(){return m("channels_hide_news_url_preview")}function na(){return d("WAWebABProps").getABPropConfigValue("channels_max_messages_batch_pull")}function oa(){return d("WAWebABProps").getABPropConfigValue("channel_pull_message_updates_threshold_seconds")}function pa(){return m("channels_recommended_v3_ui_enabled")}function qa(){return d("WAWebABProps").getABPropConfigValue("channels_recommended_v3_ui_limit")}function ra(){return m("channels_share_link_logging_enabled")}function sa(a){return a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner||a===d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin}function ta(){return m("channels_send_album_enabled")}function ua(){return m("channels_inbox_filters_web_enabled")}function va(){return m("channels_proactive_message_gap_handling_enabled")}function Q(){return m("channels_ptt_receiver_enabled")}function wa(){return Q()&&d("WAWebABProps").getABPropConfigValue("channels_ptt_sender_enabled")}function xa(){return m("channels_ptt_logging_enabled")}function ya(){return R()&&d("WAWebABProps").getABPropConfigValue("channels_ptv_forwarding_enabled")}function R(){return d("WAWebPtvGatingUtils").isPtvReceivingEnabled()&&m("channels_ptv_receiving_enabled")}function za(){return m("channels_poll_creation_enabled")}function Aa(){return m("channels_poll_receive_enabled")}function Ba(a){return!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a==null?void 0:a.newsletterMetadata)?!1:S()}function S(){return m("channels_poll_voter_list_enabled")}function Ca(){return m("channel_poll_forwarding_enabled")}function Da(){return m("channel_photo_poll_sender_enabled")}function Ea(){return m("channel_photo_poll_receiver_enabled")}function Fa(){return m("channels_quiz_receiving_enabled")}function Ga(){return m("channels_quiz_sending_enabled")}function Ha(){return m("channels_poll_single_option_control_enable")}function Ia(){return m("channels_non_basic_stickers_enabled")}function Ja(){return m("channels_sticker_forwarded_attribution_ui_enabled")}function Ka(){return m("channels_sticker_pack_forwarded_attribution_ui_enabled")}function La(){return m("channels_sticker_pack_rendering")}function Ma(){return m("channel_sticker_pack_forwarding")}function Na(){return d("WAWebABProps").getABPropConfigValue("channels_multi_admin_max_admin_count")}function Oa(){return m("channels_audio_files_receiver_enabled")}function Pa(){return m("channels_audio_files_sender_enabled")}function Qa(){return m("channels_audio_files_sender_waveform_enabled")}function Ra(){return m("channels_audio_files_display_waveform_enabled")}function Sa(){return m("channels_status_updates_consumption_enabled")}function Ta(){return m("channels_admin_reply_enabled")}function Ua(){return m("channels_admin_reply_receiver_enabled")}function Va(){return m("similar_channels_in_thread_on_follow_enabled")}function Wa(){return m("similar_channels_in_channel_details_enabled")}function Xa(){return d("WAWebABProps").getABPropConfigValue("similar_channels_max_limit")}function Ya(){return d("WAWebABProps").getABPropConfigValue("similar_channels_min_limit")}function T(){return m("channels_qpl_logging")}function Za(){return m("channels_reactions_bottomsheet_tap_to_react_enabled")}function $a(a){a=d("WAWebStateUtils").unproxy(a);return(a=a.newsletterMetadata)!=null&&a.isSuspendedOrTerminated?!1:m("channels_updates_tab_swipe_actions_enabled")}function ab(a){if(a==null)return!1;if(a.isSuspendedOrTerminated)return!1;if(!c("gkx")("26258")&&d("WAWebABProps").getABPropConfigValue("channels_admin_insights_gizmos_enabled"))return!0;if(!d("WAWebNewsletterMembershipUtil").iAmAdminOrOwner(a))return!1;if(m("channels_producer_insights_enabled"))return!0;U()&&void d("WAWebLogNewsletterExposureAction").logNewsletterExposureAction(a,d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights);return a.capabilities.has(d("WAWebCommonNewsletterEnums").NewsletterCapability.Insights)&&d("WAWebABProps").getABPropConfigValue("channels_capabilities_enabled")}function bb(a){a=a.newsletterMetadata;if(a==null)return!1;U()&&void d("WAWebLogNewsletterExposureAction").logNewsletterExposureAction(a,d("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls);return a.capabilities.has(d("WAWebCommonNewsletterEnums").NewsletterCapability.PhotoPolls)&&d("WAWebABProps").getABPropConfigValue("channels_capabilities_enabled")}function cb(a){a=a.newsletterMetadata;if(a==null)return!1;U()&&void d("WAWebLogNewsletterExposureAction").logNewsletterExposureAction(a,d("WAWebCommonNewsletterEnums").NewsletterCapability.QUESTIONS);return a.capabilities.has(d("WAWebCommonNewsletterEnums").NewsletterCapability.QUESTIONS)&&d("WAWebABProps").getABPropConfigValue("channels_capabilities_enabled")}function db(a){if(a==null)return!1;a=d("WAWebStateUtils").unproxy(a);a=a.size;return a>=d("WAWebABProps").getABPropConfigValue("channels_producer_insights_min_followers")}function eb(){return d("WAWebABProps").getABPropConfigValue("channels_producer_insights_hide_deltas")}function U(){return m("channels_fetch_and_log_capabilities")}function V(){return d("WAWebABProps").getABPropConfigValue("whatsapp_vpv_logging_enabled")}function W(){return m("channels_vpv_logging_enabled")}function fb(){return V()&&W()}function X(){return m("channels_view_counts_vpv_logging_enabled")}function gb(){return V()&&X()}function Y(a){return m(a)}function hb(){return Y("wamo_sub_process_message_kill_switch")}function ib(){return Y("wamo_sub_messages_supported")}function Z(){return Y("wamo_sub_consumer_enabled_v2")}function $(){return Y("wamo_sub_admin_enabled_v2")}function jb(){return Z()||$()}function kb(){return Y("wamo_sub_logging_enabled_v2")}function lb(){return m("channel_album_v2_receiving_enabled")}function mb(){return d("WAWebABProps").getABPropConfigValue("snapl_newsletter_logging_media_id_placeholder_string")}function nb(){return m("newsletters_video_playback_wabba_logging_enabled")}function ob(){return m("channels_video_play_logging_enabled")}function pb(){return d("WAWebABProps").getABPropConfigValue("channels_quick_forwarding_button_mode")===1}function qb(){return T()&&m("channels_open_qpl_improvements_enabled")}function rb(){return m("channels_open_qpl_user_rid_logging_enabled")}function sb(){return m("channels_is_multi_admin_lid_migration_enabled")}function tb(){return m("newsletter_rcat_field_generating_enabled")}function ub(){return d("WAWebABProps").getABPropConfigValue("channels_creation_entrypoint_in_updates_tab_enabled")===1}function vb(){return d("WAWebABProps").getABPropConfigValue("channels_creation_entrypoint_in_directory_enabled")}function wb(){return m("channels_invite_contacts_to_follow_consumer_enabled")}function xb(){return m("channels_invite_contacts_to_follow_producer_enabled")}function yb(){return m("channel_enforcement_logging_enabled")}g.NewsletterCompanionGating=i;g.isNewsletterEnabledOnPrimary=k;g.getNewsletterDeeplinkGating=a;g.isNewsletterEnabled=l;g.getMaxSubscriberNumber=e;g.isDSAEUOnlyNoticeEnabled=f;g.isNewsletterReportUnlawfulContentEnabled=o;g.isNewsletterAusOSAReportingEnabled=p;g.isNewsletterUKOSAReportingEnabled=q;g.isDSA21ChannelReportingEnabled=r;g.isNewsletterIntegrityQuestionsM1Enabled=s;g.isNewsletterViewCountEnabled=t;g.isNewsletterViewCountSendEnabled=u;g.isNewsletterCreationEnabled=v;g.shouldShowAllReactionsForNewsletter=w;g.isNewsletterReactionEnabled=x;g.isNewsletterReactionSettingsEnabled=y;g.isNewsletterReactionSenderListEnabled=z;g.getNewsletterConsumerTos=A;g.getNewsletterProducerTos=B;g.getNewsletterAdminInviteTos=C;g.getNewsletterProducerNux=D;g.shouldHideProducerNewsletterDisclosure=E;g.isNewsletterDirectoryEnabled=F;g.getNewsletterDirectoryPageSize=G;g.getNewsletterDirectorySearchDebounce=H;g.getNewsletterDirectoryV2FilterTypes=I;g.isFilteringOutSubscribedNewslettersFromDirectoryListEnabled=J;g.getNewsletterDirectoryPageRefreshInterval=K;g.isNewsletterDirectoryCategoriesEnabled=L;g.getNewslettersPerDirectoryCategoryLimit=M;g.getNewsletterDirectoryCategoriesPreviewRefreshIntervalMs=N;g.getNewsletterDirectoryCategoryTypes=O;g.getDisplayNewsletterPerCategoryLimit=P;g.isDirectoryCategoriesLoggingEnabled=aa;g.getRecommendedNewslettersRefreshInterval=ba;g.getNewsletterSubscriberListCacheRefreshMs=ca;g.isNewsletterMessageForwardSendingEnabled=da;g.isNewsletterMessageForwardLoggingEnabled=ea;g.isNewsletterForwardToChannelLoggingEnabled=fa;g.isNavigationToForwardedNewsletterMessageEnabled=ga;g.isForwardToNewsletterEnabled=ha;g.isNewsletterForwardBottomButtonEnabled=ka;g.isNewsletterMessageEditingEnabled=la;g.isNewsletterHideNewsUrlPreviewEnabled=ma;g.getMaxMsgCountFromServer=na;g.getPullMessageUpdatesThresholdSeconds=oa;g.isRecommendedUnitV3Enabled=pa;g.getRecommendedUnitRowCount=qa;g.isNewsletterLinkShareLoggingEnabled=ra;g.isNewsletterAdminContextCardEnabled=sa;g.isNewsletterMediaAlbumUploadEnabled=ta;g.isNewsletterInboxFiltersEnabled=ua;g.isProactiveGapFillingEnabled=va;g.isNewsletterPTTReceivingEnabled=Q;g.isNewsletterPTTSendingEnabled=wa;g.isNewsletterPTTLoggingEnabled=xa;g.isNewsletterPTVForwardingEnabled=ya;g.isNewsletterPTVReceivingEnabled=R;g.isNewsletterPollsCreationEnabled=za;g.isNewsletterPollsReceivingEnabled=Aa;g.isNewsletterPollsVotersEnabledForChat=Ba;g.isNewsletterPollsVotersEnabled=S;g.isNewsletterPollForwardingEnabled=Ca;g.isNewsletterPhotoPollSenderEnabled=Da;g.isNewsletterPhotoPollsReceiverEnabled=Ea;g.isNewsletterQuizReceiverEnabled=Fa;g.isNewsletterQuizSenderEnabled=Ga;g.isNewsletterPollsSingleOptionEnabled=Ha;g.isNewsletterSendingNonBasicStickersEnabled=Ia;g.isStickerForwardedAttributionEnabled=Ja;g.isStickerPackForwardedAttributionEnabled=Ka;g.isStickerPackMsgTypeRenderingEnabled=La;g.isStickerPackMsgTypeForwardingEnabled=Ma;g.getMaxNumberOfAdmins=Na;g.isNewsletterAudioFileReceivingEnabled=Oa;g.isNewsletterAudioFileSendingEnabled=Pa;g.isAudioFileWaveformSenderEnabled=Qa;g.isAudioFileWaveformDisplayInNewslettersEnabled=Ra;g.isNewsletterLinksOnStatusConsumptionEnabled=Sa;g.isNewsletterSendingAdminRepliesEnabled=Ta;g.isNewsletterReceivingAdminRepliesEnabled=Ua;g.isSimilarNewsletterInThreadEnabled=Va;g.isSimilarNewsletterInInfoDrawersEnabled=Wa;g.getSimilarNewslettersMaxFetchLimit=Xa;g.getSimilarNewslettersMinDisplayLimit=Ya;g.isNewsletterQPLLoggingEnabled=T;g.isNewsletterQuickReactionsEnabled=Za;g.isNewsletterContextMenuEnabled=$a;g.isNewsletterProducerInsightsEnabled=ab;g.isNewsletterPhotoPollCapabilityEnabled=bb;g.isNewsletterQuestionsCapabilityEnabled=cb;g.canFetchProducerInsights=db;g.shouldHideProducerInsightsDeltas=eb;g.shouldFetchAndLogCapabilities=U;g.isVPVLoggingEnabled=V;g.isNewsletterVPVLoggingEnabled=W;g.isNewsletterDiscoveryVisibilityLoggingEnabled=fb;g.isChannelsViewCountsVPVLoggingEnabled=X;g.isNewsletterVPVMessageVisibilityLoggingEnabled=gb;g.isWamoSubMessagesProcessingEnabled=hb;g.isWamoSubMessagesSupported=ib;g.isWamoSubConsumerExperienceEnabled=Z;g.isWamoSubCreatorExperienceSupported=$;g.isWamoSubExperienceEnabled=jb;g.isWamoSubLoggingEnabled=kb;g.isNewsletterAlbumsV2ReceiverEnabled=lb;g.getNewsletterLoggingMediaID=mb;g.isNewsletterVideoPlaybackLoggingEnabled=nb;g.isNewsletterVideoPlayLoggingEnabled=ob;g.isNewsletterQuickForwardingEnabled=pb;g.isNewsletterOpenQPLImprovementsEnabled=qb;g.isNewsletterOpenQPLUserRidLoggingEnabled=rb;g.isNewsletterMultiAdminLidMigrationEnabled=sb;g.isRCATFieldGenerationEnabled=tb;g.isChannelCreationFromUpdatesTabEnabled=ub;g.getChannelCreationFromDirectoryMode=vb;g.isChannelInviteContactsToFollowConsumerEnabled=wb;g.isChannelInviteContactsToFollowProducerEnabled=xb;g.isChannelEnforcementLoggingEnabled=yb}),98);
__d("WAWebNewsletterErrors",["WACustomError"],(function(a,b,c,d,e,f,g){b=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}((a=d("WACustomError")).customError("UnexpectedNonNewsletterJidError"));c=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("UnexpectedNonNewsletterJidError"));e=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("MissingNewsletterServerIdError"));f=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("NewsletterMediaUploadError"));d=function(a){function b(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(b,a);return b}(a.customError("UnexpectedNewsletterQuotedParticipantMismatchError"));g.UnexpectedNonNewsletterJidError=b;g.UnexpectedNonNewsletterChatError=c;g.MissingNewsletterServerIdError=e;g.NewsletterMediaUploadError=f;g.UnexpectedNewsletterQuotedParticipantMismatchError=d}),98);
__d("WAWebNewsletterValidationUtils",["WAJids","WALogger","WAWebNewsletterErrors"],(function(a,b,c,d,e,f,g){var h;function a(a){i(a);return d("WAJids").toNewsletterJid(a)}function i(a){var b=d("WAJids").validateNewsletterJid(a)!=null;if(!b){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose([""," is not a valid newsletter JID"])),a);throw new(d("WAWebNewsletterErrors").UnexpectedNonNewsletterJidError)()}}g.toNewsletterJidOrThrow=a;g.validateNewsletterJidOrThrow=i}),98);
__d("WAWebLogNewsletterExposureAction",["WALogger","WAWebNewsletterLogExposureJob","WAWebNewsletterValidationUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var c=d("WAWebNewsletterValidationUtils").toNewsletterJidOrThrow(a.id.toJid());return d("WAWebNewsletterLogExposureJob").logNewsletterExposure(c,b)}catch(c){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][logNewsletterExposureAction] failed to log exposure"]))).tags("newsletter").devConsole(c,a.id,b).sendLogs("log-newsletter-exposure-failed")}});return i.apply(this,arguments)}g.logNewsletterExposureAction=a}),98);
__d("WAWebDBProcessPaymentMessages",["WAWebDBMsgUtils","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgType","WAWebProtobufsWeb.pb","WAWebSchemaMessage","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=[],e=[],f=i(a),g=j(a.filter(function(a){return a.subtype==="payment_action_request_declined"||a.subtype==="payment_transaction_request_cancelled"}));return d("WAWebModelStorageUtils").getStorage().lock(["message"],function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b[0];b=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(f.concat(g)));var h=new Map();b.forEach(function(a){a!=null&&h.set(a.id.toString(),a)});a.forEach(function(a){var b;b=(b=a.paymentRequestMessageKey)==null?void 0:b.toString();var f=h.get(b||"");if(f==null&&a.paymentRequestMessageKey!=null){var g=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.paymentRequestMessageKey);if(g!=null){b=g.toString();f=h.get((g=(g=d("WAWebLidMigrationUtils").getAlternateMsgKey(g))==null?void 0:g.toString())!=null?g:"")}}if(f&&b!=null)if(a.subtype==="send"&&a.paymentTxnStatus!=null)c.push({id:b,paymentTxnStatus:a.paymentTxnStatus});else{g=f.from.isGroup()?f.author:f.from;var i=d("WAWebUserPrefsMeUser").isMeAccount(f.paymentMessageReceiverJid);i=i?g:f.paymentMessageReceiverJid;a.subtype==="payment_action_request_declined"?c.push({id:b,paymentStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$Status.REJECTED,paymentTxnStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_REJECTED}):a.subtype==="payment_transaction_request_cancelled"&&c.push({id:b,paymentStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$Status.CANCELLED,paymentTxnStatus:d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_CANCELED});c.push({id:a.id.toString(),type:d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,templateParams:[i||"",f.paymentCurrency||"",String(f.paymentAmount1000)]})}else h.get(a.id.toString())&&!a.isMdHistoryMsg&&e.push(a.id.toString())});yield d("WAWebSchemaMessage").getMessageTable().bulkRemove(e);yield d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c);return c});return function(a){return h.apply(this,arguments)}}())});return h.apply(this,arguments)}function i(a){return a.flatMap(function(a){return[a.paymentRequestMessageKey?a.paymentRequestMessageKey.toString():null,a.paymentRequestMessageKey?(a=(a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.paymentRequestMessageKey))==null?void 0:a.toString())!=null?a:null:null]}).filter(Boolean)}function j(a){return a.flatMap(function(a){return[a.id.toString(),(a=(a=d("WAWebLidMigrationUtils").getAlternateMsgKey(a.id))==null?void 0:a.toString())!=null?a:null]}).filter(Boolean)}g.processPaymentMessages=a;g.mapOriginalAndAltPaymentRequestMessageKey=i;g.mapOriginalAndAltMsgId=j}),98);
__d("WAWebParseCancelPaymentMessageProto",["WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.cancelPaymentRequestMessage;if(b==null)return;b=b.key;if(b==null)return;b=h(b,a);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"payment_transaction_request_cancelled",paymentRequestMessageKey:b}),contextInfo:null}}function h(a,b){if(!a)throw c("err")("parseProtocolMessageProto: no message key is defined for cancel payment request message");var e=a.id;if(!e)throw c("err")("parseProtocolMessageProto: no message id is defined for cancel payment request message");var f=void 0;if(b.id.remote.isGroup()){f=b.id.participant;if(b.id.fromMe)f=d("WAWebE2EProtoUtils").decodeJid(b.from);else if(!((a=d("WAWebE2EProtoUtils").decodeJid(a.participant))!=null&&a.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())))return null}a=new(c("WAWebMsgKey"))({id:e,fromMe:b.id.fromMe,remote:b.id.remote,participant:f});return a}g["default"]=a}),98);
__d("WAWebParseDeclinePaymentMessageProto",["WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.declinePaymentRequestMessage;if(b==null)return;b=h(b.key,a);return{msgData:babelHelpers["extends"]({},a,{type:"unknown",kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"payment_action_request_declined",paymentRequestMessageKey:b}),contextInfo:null}}function h(a,b){if(!a)throw c("err")("parseProtocolMessageProto: no message key is defined for decline payment request message");var e=a.id;if(!e)throw c("err")("parseProtocolMessageProto: no message id is defined for decline payment request message");var f;if(b.id.remote.isGroup()){var g;if(b.id.fromMe||(g=d("WAWebE2EProtoUtils").decodeJid(a.participant))!=null&&g.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())||b.subtype==="send")f=d("WAWebE2EProtoUtils").decodeJid(a.participant);else return null}g=new(c("WAWebMsgKey"))({fromMe:!b.id.fromMe,remote:b.id.remote,id:e,participant:f});return g}g["default"]=a}),98);
__d("WAWebParseRequestPaymentMessageProto",["WALogger","WALongInt","WANullthrows","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsWeb.pb","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h;function a(a){var b,e=a.messageProtobuf,f=a.baseMessage,g=a.paymentInfo;a=a.msgContext;e=e.requestPaymentMessage;if(e==null)return;b=(b=e.noteMessage)==null||(b=b.extendedTextMessage)==null?void 0:b.contextInfo;if(Boolean(g==null?void 0:g.futureproofed)||d("WAWebE2EProtoUtils").hasUnsupportedCurrency(g)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseRequestPaymentMessageProto: does not support novi transactions"])));return{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"phone_only_feature"}),contextInfo:b}}var i=e.noteMessage,j=(i==null?void 0:i.extendedTextMessage)!=null||(i==null?void 0:i.conversation)!=null||(i==null?void 0:i.stickerMessage)!=null;i=i&&j?d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:i,message:{},msgContext:a}):void 0;a=g!=null?d("WAWebE2EProtoUtils").parseMsgPaymentInfo(g):{};if(e.amount==null)e.currencyCodeIso4217!=null&&a.paymentCurrency==null&&(a.paymentCurrency=e.currencyCodeIso4217),e.amount1000!=null&&a.paymentAmount1000==null&&(a.paymentAmount1000=d("WALongInt").numberOrThrowIfTooLarge(e.amount1000));else{e.amount.currencyCode!=null&&a.paymentCurrency==null&&(a.paymentCurrency=e.amount.currencyCode);if(e.amount.value!=null&&a.paymentAmount1000==null){g=e.amount;var k=g.offset==null||g.offset===0?1e3:g.offset;a.paymentAmount1000=parseFloat(g.value)*1e3/k}}if(e.requestFrom!=null&&(a==null?void 0:a.paymentMessageReceiverJid)==null){g=d("WAWebE2EProtoUtils").decodeJid(e.requestFrom);g!=null&&(typeof g!=="string"?a.paymentMessageReceiverJid=g:c("WAWebWid").isWid(g)&&(a.paymentMessageReceiverJid=d("WAWebWidFactory").createWid(g)))}((a==null?void 0:a.paymentStatus)==null||(a==null?void 0:a.paymentTxnStatus)==null)&&d("WAWebE2EProtoUtils").isEitherSenderOrReceiverOfPaymentMessage(f.id,c("WANullthrows")(a.paymentMessageReceiverJid))&&(a.paymentStatus=d("WAWebProtobufsWeb.pb").PaymentInfo$Status.WAITING,a.paymentTxnStatus=d("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_INIT);e.expiryTimestamp!=null&&(a==null?void 0:a.paymentExpiryTimestamp)==null&&(a.paymentExpiryTimestamp=d("WALongInt").numberOrThrowIfTooLarge(e.expiryTimestamp));return!j?{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"futureproof"},a),contextInfo:b}:{msgData:babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"request"},a,{paymentNoteMsg:i}),contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseSendPaymentMessageProto",["WALogger","WAWebE2EProtoParser","WAWebE2EProtoUtils","WAWebMsgKey","WAWebMsgType","WAWebUserPrefsMeUser","err"],(function(a,b,c,d,e,f,g){var h,i;function a(a){var b,c=a.messageProtobuf,e=a.baseMessage,f=a.paymentInfo;a=a.msgContext;c=c.sendPaymentMessage;if(c==null)return;b=(b=c.noteMessage)==null||(b=b.extendedTextMessage)==null?void 0:b.contextInfo;if((f==null?void 0:f.futureproofed)===!0||d("WAWebE2EProtoUtils").hasUnsupportedCurrency(f)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseSendPaymentMessageProto: does not support novi transactions"])));return{msgData:babelHelpers["extends"]({},e,{type:"unknown",kind:d("WAWebMsgType").MsgKind.Unknown,subtype:"phone_only_feature"}),contextInfo:b}}var g=c.noteMessage;c=c.requestMessageKey;var i=(g==null?void 0:g.extendedTextMessage)!=null||(g==null?void 0:g.conversation)!=null||(g==null?void 0:g.stickerMessage)!=null,k=i?"send":"futureproof";g=g&&i?d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:g,message:{},msgContext:a}):void 0;a=f!=null?d("WAWebE2EProtoUtils").parseMsgPaymentInfo(f):null;f=c?j(c,e.id,k):null;return!i?{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"futureproof"},a,{paymentRequestMessageKey:f}),contextInfo:b}:{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PAYMENT,kind:d("WAWebMsgType").MsgKind.Payment,subtype:"send"},a,{paymentRequestMessageKey:f,paymentNoteMsg:g}),contextInfo:b}}function j(a,b,e){if(!a)throw c("err")("getPaymentRequestMessageKey: no message key is defined");var f=a.id;if(!f)throw c("err")("getPaymentRequestMessageKey: no key id is defined");if(!b){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["getPaymentRequestMessageKey: no message id is defined"])));return null}var g;if(b.remote.isGroup()){var h;if(b.fromMe||(h=d("WAWebE2EProtoUtils").decodeJid(a.participant))!=null&&h.equals(d("WAWebUserPrefsMeUser").getMePnUserOrThrow())||e==="send")g=d("WAWebE2EProtoUtils").decodeJid(a.participant);else return null}h=new(c("WAWebMsgKey"))({fromMe:!b.fromMe,remote:b.remote,id:f,participant:g});return h}g["default"]=a}),98);
__d("WAWebPinAddonMessageProcessor",["Promise","WAArrayGroupBy","WANullthrows","WATimeUtils","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBProcessMessage","WAWebMsgGetters","WAWebMsgType","WAWebPinMessageProcessor","WAWebPinMsgGatingUtils","WAWebPinMsgParseWebMsgInfoPinInChat","WAWebPinsDbSerialization","WAWebProtobufsE2E.pb","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i=60*d("WATimeUtils").DAY_SECONDS;a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessor({isEnabled:function(){return d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled()},convert:{fromHistorySyncMsg:function(a){a=d("WAWebPinMsgParseWebMsgInfoPinInChat").parseWebMsgInfoPinInChat(a.webMsgInfo,a.parsedWebMsgInfo);a=a.map(function(a){return d("WAWebPinsDbSerialization").deserializePinInChatMsgData(d("WAWebPinsDbSerialization").serializePinInChat(a))});return(h||(h=b("Promise"))).resolve(a)}},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.add;yield d("WAWebBackendApi").frontendSendAndReceive("updatePinCollection",{msgs:b,removeMsgs:a.remove})});function c(b){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.processMode,e=b.parents;return a.filter(function(a){var b;b=(b=a.pinExpiryDuration)!=null?b:0;if(c!==d("WAWebAddonConstants").AddonProcessMode.HistorySync){a=e.getForAddon(a);if(a.type===d("WAWebMsgType").MSG_TYPE.EVENT_CREATION)return!0}return b<=i})});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){e=e.processMode;if(e===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;e=d("WAArrayGroupBy").groupBy(a,function(a){return a.id.remote.toString()});a=[d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()}))].concat(e.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a[0];a=a[1];var f=d("WAWebWidFactory").createWid(e);e=(yield (h||(h=b("Promise"))).all(a.map(function(a){var b=d("WAWebMsgGetters").getT(a);if(a.pinMessageType!==d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.PIN_FOR_ALL||b==null||d("WAWebMsgGetters").getIsFailed(a))return;return d("WAWebPinMessageProcessor").genSystemMessage(f,b,c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}).filter(Boolean)));a=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:f,msgObjs:e,meta:{add:"after",isHistory:!1},processMessagesOrigin:"pinMessage"}));a&&(yield d("WAWebDBProcessMessage").storeMessages(e,f))});return function(b){return a.apply(this,arguments)}}()));yield (h||(h=b("Promise"))).all(a)});function e(b,c){return a.apply(this,arguments)}return e}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});e=a;g["default"]=e}),98);
__d("WAWebPinMsgConstants",["$InternalEnum","WATimeUtils","err"],(function(a,b,c,d,e,f,g){f={INVALID:0,PIN:1,UNPIN:2};var h=b("$InternalEnum").Mirrored(["FiveSeconds","FifteenSeconds","OneMinute","OneDay","SevenDays","ThirtyDays"]);b=h.SevenDays;function a(a){switch(a){case h.FiveSeconds:return 5;case h.FifteenSeconds:return 15;case h.OneMinute:return d("WATimeUtils").MINUTE_SECONDS;case h.OneDay:return d("WATimeUtils").DAY_SECONDS;case h.SevenDays:return 7*d("WATimeUtils").DAY_SECONDS;case h.ThirtyDays:return 30*d("WATimeUtils").DAY_SECONDS}}function e(a){switch(a){case 5:return h.FiveSeconds;case 15:return h.FifteenSeconds;case d("WATimeUtils").MINUTE_SECONDS:return h.OneMinute;case d("WATimeUtils").DAY_SECONDS:return h.OneDay;case 7*d("WATimeUtils").DAY_SECONDS:return h.SevenDays;case 30*d("WATimeUtils").DAY_SECONDS:return h.ThirtyDays;default:throw c("err")("Unexpeded pin expiry duration")}}g.PIN_STATE=f;g.PinExpiryDurationOption=h;g.DEFAULT_PIN_EXPIRY_DURATION_OPTION=b;g.getPinExpiryDuration=a;g.getPinExpiryOption=e}),98);
__d("WAWebDBCRUDOperationsPinInChat",["WAWebModelStorageUtils","WAWebPinInChatSchema","WAWebPinMsgConstants","WAWebPinMsgGatingUtils","WAWebPinsDbSerialization","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,c){var e=new Map();c.forEach(function(a){var b=a.parentMsgKey;b=b;var c=e.get(b);(!c||(c==null?void 0:c.senderTimestampMs)<=a.senderTimestampMs)&&e.set(b,a)});return d("WAWebModelStorageUtils").getStorage().lock(["pinned-messages"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=(yield b.anyOf(["chatId"],[a.toString()]));c.forEach(function(a){var b=a.parentMsgKey,c=e.get(b);c&&(c.senderTimestampMs<=a.senderTimestampMs&&e["delete"](b))});var f=new Map(c.map(function(a){return[a.parentMsgKey,a]}));e.forEach(function(a,b){f.set(b,a)});c=Array.from(f.values());c=c.filter(function(a){return a.pinType===d("WAWebPinMsgConstants").PIN_STATE.PIN}).sort(function(a,b){return b.senderTimestampMs-a.senderTimestampMs}).slice(d("WAWebPinMsgGatingUtils").getMaxPins());c.forEach(function(a){e.set(a.parentMsgKey,babelHelpers["extends"]({},a,{pinType:d("WAWebPinMsgConstants").PIN_STATE.UNPIN}))});c=Array.from(e.values());yield b.bulkCreateOrReplace(c);return c});return function(a){return c.apply(this,arguments)}}())}function c(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebPinInChatSchema").getTable().get(a.toString()));return a==null?null:d("WAWebPinsDbSerialization").deserializePinInChat(a)});return h.apply(this,arguments)}g.createOrUpdatePinInChat=a;g.getPinInChatByParentKey=c}),98);
__d("WAWebPinMessageProcessor",["Promise","WANullthrows","WAWebBackendApi","WAWebDBCRUDOperationsPinInChat","WAWebDBMarkFutureproofMessagesReparsed","WAWebDBMsgUtils","WAWebDBProcessMessage","WAWebDBStoreMessageOrphans","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPinsDbSerialization","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function i(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.map(function(a){return a.pinParentKey}).filter(Boolean).map(function(a){return a.toString()});a=(yield d("WAWebDBMsgUtils").getMsgsByMsgKey(a));a=new Map(a.map(function(a){return[a.id.toString(),a]}));return a});return j.apply(this,arguments)}function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("WAWebDBStoreMessageOrphans").storeMessageOrphans(a,function(a){return c("WANullthrows")(a.pinParentKey)})});return l.apply(this,arguments)}function a(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=(yield i(e)),g=[],j=[];for(e of e){var l=f.get(c("WANullthrows")(e.pinParentKey).toString());!l?g.push(e):j.push(e)}yield (h||(h=b("Promise"))).all([b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(g.length===0)return;yield k(g);yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(g.map(function(a){return a.id.toString()}))})(),b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(j.length===0)return;var e=(yield d("WAWebBackendApi").frontendSendAndReceive("updatePinCollection",{msgs:j,removeMsgs:[]}));e&&(yield d("WAWebDBCRUDOperationsPinInChat").createOrUpdatePinInChat(a,e.map(function(a){return d("WAWebPinsDbSerialization").serializePinInChat(a)})),yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(e.map(function(a){return a.msgKey.toString()})));e=(yield (h||(h=b("Promise"))).all(j.map(function(b){return b.pinMessageType===d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.PIN_FOR_ALL?n(a,c("WANullthrows")(b.t),c("WANullthrows")(d("WAWebMsgGetters").getSender(b))):null}).filter(Boolean)));var f=(yield d("WAWebBackendApi").frontendSendAndReceive("processMultipleMessages",{chatId:a,msgObjs:e,meta:{add:"after",isHistory:!1},processMessagesOrigin:"pinMessage"}));f&&(yield d("WAWebDBProcessMessage").storeMessages(e,a))})()])});return m.apply(this,arguments)}function n(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=d("WAWebUserPrefsMeUser").getMePnUserOrThrow(),g=d("WAWebUserPrefsMeUser").isMeAccount(e);return{id:new(c("WAWebMsgKey"))({id:yield c("WAWebMsgKey").newId(),fromMe:g,remote:a,participant:e}),author:e,from:a,to:f,recipients:[],t:b,type:d("WAWebMsgType").MSG_TYPE.PINNED_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinnedMessage,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,templateParams:[e]}});return o.apply(this,arguments)}g.processPinMessages=a;g.genSystemMessage=n}),98);
__d("WAWebPinsDbSerialization",["WANullthrows","WAWebAddonConstants","WAWebAddonProcessMsgsUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return babelHelpers["extends"]({},a,{msgKey:a.msgKey.toString(),parentMsgKey:a.parentMsgKey.toString(),chatId:a.chatId.toString(),sender:a.sender.toString()})}function b(a){return babelHelpers["extends"]({},a,{msgKey:c("WAWebMsgKey").fromString(a.msgKey),parentMsgKey:c("WAWebMsgKey").fromString(a.parentMsgKey),chatId:d("WAWebWidFactory").asChatWid(d("WAWebWidFactory").createWid(a.chatId)),sender:d("WAWebWidFactory").createUserWidOrThrow(a.sender)})}function e(a){var b=d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))).toString();return{msgKey:a.id.toString(),ack:a.ack,t:a.t,read:a.read,parentMsgKey:a.pinParentKey.toString(),senderTimestampMs:a.pinSenderTimestampMs,chatId:a.id.remote.toString(),sender:b,pinType:a.pinMessageType,pinExpiryDuration:a.pinExpiryDuration}}function h(a){var b=a.id,c=a.ack,e=a.t,f=a.read;return{base:{msgKey:b.toString(),ack:c,t:e,read:f,targetMsgKey:d("WAWebAddonProcessMsgsUtils").getParentMsgKey(a).toString()},addonProps:{pinSenderTimestampMs:a.pinSenderTimestampMs,pinMessageType:a.pinMessageType,pinExpiryDuration:a.pinExpiryDuration}}}function f(a){var b=h(a),c=b.base;b=b.addonProps;return babelHelpers["extends"]({},c,{rowType:d("WAWebAddonConstants").AddonMinimizedType.PinInChat,arbitraryIndex:a.id.remote.toString(),addonProps:b})}function i(a){var b=c("WAWebMsgKey").fromString(a.msgKey),e=a.addonProps;return babelHelpers["extends"]({id:b},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,ack:a.ack,t:a.t,read:a.read,pinParentKey:c("WAWebMsgKey").fromString(a.targetMsgKey),pinSenderTimestampMs:e.pinSenderTimestampMs,pinMessageType:(b=d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.cast(e.pinMessageType))!=null?b:d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.UNKNOWN_TYPE,pinExpiryDuration:e.pinExpiryDuration})}function j(a){var b=c("WAWebMsgKey").fromString(a.msgKey);b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon);var e=b.from,f=b.to;b=b.author;return{id:c("WAWebMsgKey").fromString(a.msgKey),from:e,to:f,author:b,type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,ack:a.ack,t:a.t,read:a.read,pinSenderTimestampMs:a.senderTimestampMs,pinParentKey:c("WAWebMsgKey").fromString(a.parentMsgKey),pinMessageType:(e=d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.cast(a.pinType))!=null?e:d("WAWebProtobufsE2E.pb").Message$PinInChatMessage$Type.UNKNOWN_TYPE,pinExpiryDuration:a.pinExpiryDuration}}g.serializePinInChat=a;g.deserializePinInChat=b;g.serializePinInChatMsgData=e;g.pinInChatMsgDatIntoUnifiedAddonRow=f;g.unifiedAddonRowIntoPinInChatMsgData=i;g.deserializePinInChatMsgData=j}),98);
__d("WAWebPinMsgParseWebMsgInfoPinInChat",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h,i;function a(a,b){var e=[];try{if(a==null||a.pinInChat==null)return e;if(b==null||b.pinInChat==null)return e;a=b.pinInChat;var f=a.key,g=a.type,j=a.senderTimestampMs,k=a.serverTimestampMs;a=a.messageAddOnContextInfo;f=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(c("WANullthrows")(f)));var l=f.msgKey;f=f.sender;if(f==null)d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoPinInChat: pinInChat sender should be a wid."])));else{e.push({msgKey:l,parentMsgKey:b.id,chatId:d("WAWebWidFactory").asChatWid(l.remote),senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(c("WANullthrows")(j)),t:(b=d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(k))!=null?b:void 0,pinType:c("WANullthrows")(g),sender:f,pinExpiryDuration:a==null?void 0:a.messageAddOnDurationInSecs})}}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoPinInChat failed with error "," and stack ",""])),a==null?void 0:a.name,a==null?void 0:a.stack)}return e}g.parseWebMsgInfoPinInChat=a}),98);
__d("WAWebPinInChatValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_PIN_IN_CHAT_EXPIRY_DURATION:"pin_in_chat_invalid_expiry_duration",INVALID_PIN_IN_CHAT_MSG_REMOTE:"pin_in_chat_invalid_msg_remote",MISSING_PARENT_MSG_KEY:"pin_in_chat_missing_parent_msg_key",MISSING_TYPE:"pin_in_chat_missing_type",MISSING_SENDER_TIMESTAMP:"pin_in_chat_missing_timestamp",INVALID_EDIT_ATTR:"invalid_edit_attr"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="PinInChatValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.PinInChatValidationErrorCode=a;g.PinInChatValidationError=c}),98);
__d("WAWebParsePinMessageProto",["WALongInt","WAWebAck","WAWebE2EProtoUtils","WAWebLidMigrationUtils","WAWebMsgType","WAWebPinInChatValidationError","WAWebPinMsgGatingUtils","WAWebWamEnumE2eFailureReason","WAWebWid"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage,f=a.editAttr;a=a.msgContext;var g=b.pinInChatMessage;if(g==null)return;if(!d("WAWebPinMsgGatingUtils").isPinnedMessagesM1ReceiverEnabled())return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE}),contextInfo:null};if(a==="relay"&&f!==d("WAWebAck").EDIT_ATTR.PIN_IN_CHAT)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.INVALID_EDIT_ATTR,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(g.key,e);if(a==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_PARENT_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(!c("WAWebWid").equals.apply(c("WAWebWid"),d("WAWebLidMigrationUtils").toCommonAddressingMode(a.remote,e.id.remote))&&!a.remote.isBroadcast())throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.INVALID_PIN_IN_CHAT_MSG_REMOTE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=(f=b.messageContextInfo)==null?void 0:f.messageAddOnDurationInSecs;if(b!=null&&b<0)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.INVALID_PIN_IN_CHAT_EXPIRY_DURATION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=g.type;if(f==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_TYPE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);g=d("WALongInt").maybeNumberOrThrowIfTooLarge(g.senderTimestampMs);if(g==null)throw new(d("WAWebPinInChatValidationError").PinInChatValidationError)(d("WAWebPinInChatValidationError").PinInChatValidationErrorCode.MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PIN_MESSAGE,kind:d("WAWebMsgType").MsgKind.PinInChat,pinParentKey:a,pinMessageType:f,pinSenderTimestampMs:g,pinExpiryDuration:b});return{msgData:e,contextInfo:null}}g["default"]=a}),98);
__d("WAWebPnhCagIncognito",["WAWebLidMigrationUtils","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.participants.iAmAdmin();a=a.participants.toArray();var c=[],e=[];if(b)for(b of a)c.push(b.id),e.push(d("WAWebLidMigrationUtils").toLid(d("WAWebWidFactory").asUserWidOrThrow(b.id)));else for(b of a)b.id.isLid()?c.push(b.id):e.push(d("WAWebLidMigrationUtils").toLid(d("WAWebWidFactory").asUserWidOrThrow(b.id)));return[].concat(c,e).filter(Boolean)}function b(a,b){var c=[];if(a){for(a of b)c.push(a.id),a.lid&&c.push(a.lid);return c}for(a of b)a.id.isLid()?c.push(a.id):a.lid&&c.push(a.lid);return c}g.augmentedCagGroupMetadataParticipantList=a;g.augmentedCagGroupParticipantList=b}),98);
__d("WAWebPollVoteAddonMessageProcessor",["Promise","WALogger","WAWebABProps","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebAddonInfraError","WAWebAddonLogUtils","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebMsgType","WAWebPollVoteEncryptMsgData","WAWebPollsExtractVotes","WAWebPollsParseWebMsgInfoPollUpdates","WAWebPollsVoteDataUtils","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return d("WAWebABProps").getABPropConfigValue("unified_poll_vote_addon_infra_enabled")},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebPollsParseWebMsgInfoPollUpdates").parseWebMsgInfoPollUpdates(a).then(function(a){return a.map(d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData)})});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.PollVoteEncrypted?a:d("WAWebPollVoteEncryptMsgData").encryptPollVoteMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.PollVoteDecrypted?a:d("WAWebPollsExtractVotes").extractVote(a,b).then(d("WAWebPollsVoteDataUtils").voteDataToPollVoteMsgData)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return d("WAWebBackendApi").frontendSendAndReceive("upsertVotesModelCollection",{votes:a.add.map(d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData),votesToRemove:a.remove,restoredFromDb:b===d("WAWebAddonConstants").AddonProcessMode.Hydration||b===d("WAWebAddonConstants").AddonProcessMode.HistorySync})});function c(b,c){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=c.parents;var e=[],f=[];for(a of a)if(a.addonEncrypted){var g=c.getForAddon(a);if(g==null)throw new(d("WAWebAddonInfraError").AddonInfraError)(d("WAWebAddonInfraError").AddonInfraErrorCode.MissingParentMsg);f.push(l.convert.toDualDecryptedMsgData(a,g));d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[pollVoteMsgProcessor] Decrypting poll vote message"]))).sendLogs("unexpected encrypted poll vote",{sampling:.01})}else e.push(a);if(f.length!==0){g=(yield (k||(k=b("Promise"))).allSettled(f));for(c of g)c.status==="fulfilled"&&c.value.kind===d("WAWebMsgType").MsgKind.PollVoteDecrypted?e.push(c.value):d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt poll vote message: ",""])),c.reason);d("WAWebAddonLogUtils").hasSettledWithError(g)&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[pollVoteMsgProcessor] Failed to decrypt poll vote message"]))).tags("messagings","addons").sendLogs("poll-vote-decryption-error",{sampling:.01})}return e});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(d("WAWebPollsVoteDataUtils").pollVoteMsgDataToVoteData(a),!1)}));if(b===d("WAWebAddonConstants").AddonProcessMode.HistorySync)return;b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()});a=l;g["default"]=a}),98);
__d("WAWebPollsCreateOptionLocalIdMap",["Promise","WAHex","WANullthrows","WAWebPollOptionHashUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield j(a)),c=d("WAHex").toHex(new Uint8Array(b));return{hash:b,hexHash:c,localId:a.localId}});return function(b){return a.apply(this,arguments)}}())));var e=new Map(),f=new Map();for(a of a){var g=a.hash,i=a.hexHash,k=a.localId;e.set(i,k);f.set(k,g)}return{getLocalIdForHexHash:function(a){return c("WANullthrows")(e.get(a))},getLocalIdForHash:function(a){return c("WANullthrows")(e.get(d("WAHex").toHex(new Uint8Array(a))))},getHashForLocalId:function(a){return c("WANullthrows")(f.get(a))},includesHashes:function(a){return a.every(function(a){return e.has(d("WAHex").toHex(new Uint8Array(a)))})}}});return i.apply(this,arguments)}function j(a){return d("WAWebPollOptionHashUtils").getHashBufferForString(a.name)}g.createOptionLocalIdMap=a}),98);
__d("WAWebPollsProtobufConversion",["WALongInt","WANullthrows","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(b));a=a.selectedOptionLocalIds.map(b.getHashForLocalId);return{selectedOptions:a.length===0?null:a}});return h.apply(this,arguments)}function e(a){var b=a.voteProtobuf,e=a.pollVoteMsgKey,f=a.parentMsgKey,g=a.sender,h=a.senderTimestampMs,i=a.t,j=a.optionLocalIdMap,k=a.ack;a=a.read;return{msgKey:e,parentMsgKey:c("WANullthrows")(f),selectedOptionLocalIds:b.selectedOptions.map(j.getLocalIdForHash),senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(h),t:d("WALongInt").maybeNumberOrThrowIfTooLarge(i),sender:g,ack:k,read:a}}g.protobufFromVote=a;g.voteFromProtobuf=e}),98);
__d("WAWebPollVoteEncryptMsgData",["WANullthrows","WAWebAck","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebPollsProtobufConversion","WAWebPollsVoteEncryption","WAWebViewMode.flow","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e,f,g=(f=c("WANullthrows"))((e=d("WAWebMsgGetters")).getPollOptions(b)),h=f(e.getMessageSecret(b),"Poll creation missing message secret"),i=f(e.getOriginalSender(b)),j=self.crypto.getRandomValues(new Uint8Array(12));g=(yield d("WAWebPollsVoteEncryption").encryptVote({encodedProtobuf:yield d("WAWebPollsProtobufConversion").protobufFromVote(a,g),iv:j,messageSecret:h,pollCreationOriginalSender:i,stanzaId:b.id.id,voteSender:d("WAWebWidFactory").asUserWidOrThrow(f(e.getSender(a))),isOneOnOne:e.getRemote(b).isUser()}));h=g.encPayload;return babelHelpers["extends"]({id:a.id,type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteEncrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"poll_vote",addonEncrypted:!0,t:Math.floor(a.senderTimestampMs/1e3)},d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.id,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),{isNewMsg:!0,local:!0,ack:(i=a.ack)!=null?i:d("WAWebAck").ACK.CLOCK,pollUpdateParentKey:b.id,encPollVote:{encPayload:h,encIv:j.buffer},senderTimestampMs:a.senderTimestampMs})});return h.apply(this,arguments)}g.encryptPollVoteMsgData=a}),98);
__d("WAWebDBPollsGetParentMessages",["WANullthrows","WAWebAddonProcessMsgsUtils","WAWebMsgType","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebAddonProcessMsgsUtils").queryAddonParentMsgs(a,null));var b=a[0];a=a[1];var c=new Map(),e=[];for(a of a){var f=b.get(i(a));f==null||f.type===d("WAWebMsgType").MSG_TYPE.UNKNOWN?e.push(a):c.set(a,f)}return{pollUpdateMsgsToParentMsgs:c,orphans:e}});return h.apply(this,arguments)}function i(a){return c("WANullthrows")(a.pollUpdateParentKey).toString()}g.getParentMessages=a}),98);
__d("WAWebDBPollsUpsertVotes",["WAWebApiContact","WAWebMaxPerGroup","WAWebModelStorageUtils","WAWebPollsDbSerialization","WAWebPollsGetVoteKey","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=d("WAWebMaxPerGroup").maxPerGroup(a,function(a){return a.senderTimestampMs},d("WAWebPollsGetVoteKey").getVoteKey);return d("WAWebModelStorageUtils").getStorage().lock(["poll-votes"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=(yield a.anyOf(["parentMsgKey","sender"],h(c))),e=new Map();for(b of b)e.set(d("WAWebPollsGetVoteKey").getVoteKey(b),b);b=[];var f=[],g=[];for(var i of c){var j=e.get(d("WAWebPollsGetVoteKey").getVoteKey(i));if(j!=null){if(j.senderTimestampMs>i.senderTimestampMs){b.push(d("WAWebPollsDbSerialization").voteFromDbRow(j));continue}String(i.sender)!==String(j.sender)&&g.push(j)}var k=i.selectedOptionLocalIds.length===0;j=(j=j==null?void 0:j.read)!=null?j:!1;k=!k&&j&&i.read!==j?babelHelpers["extends"]({},i,{read:!0}):i;b.push(k);f.push(d("WAWebPollsDbSerialization").dbRowFromVote(k))}g.length>0&&(yield a.bulkRemove(f.map(function(a){return[a.parentMsgKey,a.sender]})));f.length>0&&(yield a.bulkCreateOrReplace(f));return b});return function(b){return a.apply(this,arguments)}}())}function h(a){var b=[];for(a of a){var c=a.parentMsgKey,e=a.sender;b.push([c.toString(),e.toString()]);e=d("WAWebApiContact").getAlternateUserWid(e);e!=null&&b.push([c.toString(),e.toString()])}return b}g.upsertVotesDb=a}),98);
__d("WAWebPollsParseWebMsgInfoPollUpdates",["WALogger","WALongInt","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebMsgType","WAWebPollsCreateOptionLocalIdMap","WAWebPollsProtobufConversion","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.webMsgInfo,e=a.parsedWebMsgInfo,f=a.isFromCag;try{if(b==null||b.pollUpdates==null)return[];if(e==null||e.type!==d("WAWebMsgType").MSG_TYPE.POLL_CREATION)return[];var g=e,j=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(g.pollOptions));return b.pollUpdates.map(function(a){try{var b,e=(b=c("WANullthrows"))(a.pollUpdateMessageKey),i=b(a.vote);e=b(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(e,f));var k=e.msgKey;e=e.sender;return d("WAWebPollsProtobufConversion").voteFromProtobuf({voteProtobuf:i,pollVoteMsgKey:k,parentMsgKey:g.id,sender:e,senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(b(a.senderTimestampMs)),t:d("WAWebAddOnParseWebMsgInfo").getAddonServerTimestamp(a.serverTimestampMs),optionLocalIdMap:j,ack:null,read:a.unread!==!0})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[history sync] Failed to parse pollUpdate with error ",""])),a).devConsole(a).sendLogs("parseWebMsgInfoPollUpdates-vote-parse-error");return null}}).filter(Boolean)}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoPollUpdates failed with error "," and stack ",""])),a==null?void 0:a.name,a==null?void 0:a.stack).sendLogs("parseWebMsgInfoPollUpdates-error");return[]}});return j.apply(this,arguments)}g.parseWebMsgInfoPollUpdates=a}),98);
__d("WAWebPollsValidationError",["$InternalEnum","WACustomError","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){c=(a=b("$InternalEnum"))({INVALID_MESSAGE_SECRET:"poll_creation_invalid_message_secret",INVALID_NAME:"poll_creation_invalid_name",INVALID_OPTIONS_COUNT:"poll_creation_invalid_options_count",INVALID_OPTION:"poll_creation_invalid_option",INVALID_SELECTABLE_OPTIONS_COUNT:"poll_creation_invalid_selectable_options_count",MISSING_MESSAGE_SECRET:"poll_creation_missing_message_secret",MISSING_NAME:"poll_creation_missing_name",MISSING_OPTIONS:"poll_creation_missing_options",MISSING_SELECTABLE_OPTIONS_COUNT:"poll_creation_missing_selectable_options_count",DUPLICATE_OPTIONS:"poll_creation_duplicate_options"});e=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="PollCreationValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);f=a({INVALID_VOTE_ENC_IV:"poll_update_invalid_vote_enc_iv",MISSING_POLL_MESSAGE_KEY:"poll_update_missing_poll_message_key",MISSING_SENDER_TIMESTAMP:"poll_update_missing_sender_timestamp",MISSING_UPDATE:"poll_update_missing_update",MISSING_VOTE_ENC_IV:"poll_update_missing_vote_enc_iv",MISSING_VOTE_ENC_PAYLOAD:"poll_update_missing_vote_enc_payload",MESSAGE_STANZA_INVALID:"poll_update_message_stanza_invalid"});b=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="PollUpdateValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);var h=a({INVALID_MESSAGE_SECRET:"poll_vote_invalid_message_secret",INVALID_OPTION:"poll_vote_invalid_option",INVALID_OPTIONS_COUNT:"poll_vote_invalid_options_count",OPTION_NOT_FOUND:"poll_vote_option_not_found"}),i=function(a){function b(b){var c;c=a.call(this,b)||this;c.code=b;return c}babelHelpers.inheritsLoose(b,a);return b}(d("WACustomError").customError("PollVoteValidationError"));a=a({INVALID_NAME:"poll_result_snapshot_invalid_name",INVALID_POLL_VOTES_SNAPSHOTS_COUNT:"poll_result_snapshot_invalid_poll_votes_snapshots_count",INVALID_OPTIONS_COUNT:"poll_result_snapshot_invalid_options_count",INVALID_OPTION:"poll_result_snapshot_invalid_option",INVALID_OPTION_VOTE_COUNT:"poll_result_snapshot_invalid_option_vote_count",MISSING_NAME:"poll_result_snapshot_missing_name",MISSING_POLL_VOTES:"poll_result_snapshot_missing_poll_votes",MISSING_OPTION:"poll_result_snapshot_missing_option",MISSING_OPTIONS:"poll_result_snapshot_missing_options",MISSING_OPTION_VOTE_COUNT:"poll_result_snapshot_missing_option_vote_count",DUPLICATE_OPTIONS:"poll_result_snapshot_duplicate_options"});d=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="PollResultSnapshotValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.PollCreationValidationErrorCode=c;g.PollCreationValidationError=e;g.PollUpdateValidationErrorCode=f;g.PollUpdateValidationError=b;g.PollVoteValidationErrorCode=h;g.PollVoteValidationError=i;g.PollResultSnapshotValidationErrorCode=a;g.PollResultSnapshotValidationError=d}),98);
__d("WAWebPollsExtractVotes",["Promise","WALogger","WANullthrows","WAWebAddonEncryptionError","WAWebMsgGetters","WAWebMsgType","WAWebPollsCreateOptionLocalIdMap","WAWebPollsProtobufConversion","WAWebPollsValidationError","WAWebPollsVoteEncryption","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield (j||(j=b("Promise"))).allSettled(Array.from(a.entries()).map(function(a){var b=a[0];a=a[1];return l(b,a)})));return a.map(function(a){switch(a.status){case"fulfilled":return a.value;case"rejected":a=a.reason;if(a instanceof d("WAWebPollsValidationError").PollVoteValidationError){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Poll vote extraction failed: ",""])),a.code).sendLogs(a.code);return}d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Poll vote extraction failed: ","\n",""],["Poll vote extraction failed: ","\\n",""])),a.message,a.stack).sendLogs("poll-vote-extraction-unknown-error")}}).filter(Boolean)});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.PollVoteEncrypted,b),f=c("WANullthrows")(b.pollSelectableOptionsCount),g=c("WANullthrows")(b.pollOptions),h=c("WANullthrows")(a.encPollVote),i=d("WAWebWidFactory").asUserWidOrThrow(d("WAWebMsgGetters").getSender(a));h=(yield d("WAWebPollsVoteEncryption").decryptVote({encryptedVote:h.encPayload,iv:h.encIv,messageSecret:e,stanzaId:b.id.id,pollCreationOriginalSender:d("WAWebMsgGetters").getOriginalSender(b),voteSender:i,isOneOnOne:d("WAWebMsgGetters").getRemote(b).isUser()}));e=h.selectedOptions.length;if(e>g.length||f!==0&&e>f)throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.INVALID_OPTIONS_COUNT);if(h.selectedOptions.some(function(a){return a.byteLength!==32}))throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.INVALID_OPTION);b=(yield d("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(g));if(!b.includesHashes(h.selectedOptions))throw new(d("WAWebPollsValidationError").PollVoteValidationError)(d("WAWebPollsValidationError").PollVoteValidationErrorCode.OPTION_NOT_FOUND);return d("WAWebPollsProtobufConversion").voteFromProtobuf({voteProtobuf:h,pollVoteMsgKey:a.id,parentMsgKey:a.pollUpdateParentKey,sender:i,senderTimestampMs:a.senderTimestampMs,t:c("WANullthrows")(a.t),optionLocalIdMap:b,ack:a.ack,read:d("WAWebUserPrefsMeUser").isMeAccount(i)})});return m.apply(this,arguments)}g.extractVotes=a;g.extractVote=l}),98);
__d("WAWebParsePollResultSnapshotMessageProto",["WALongInt","WAWebMsgType","WAWebPollsGatingUtils","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.pollResultSnapshotMessage;if(b==null)return;if(!d("WAWebPollsGatingUtils").isPollResultSnapshotReceivingEnabled())return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT}),contextInfo:b.contextInfo};var e=b.name,f=b.pollVotes;b=b.contextInfo;if(e==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e.length===0||e.length>d("WAWebPollsGatingUtils").getMaxPollNameLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==="quoted"||a==="history_quoted"){a=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT,kind:d("WAWebMsgType").MsgKind.PollResultSnapshot,pollName:e,pollVotesSnapshot:null});return{msgData:a,contextInfo:b}}if(f==null||f.length===0)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_POLL_VOTES,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var g=new Set();a=f.map(function(a){var b=a.optionName;a=a.optionVoteCount;if(b==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b.length===0||b.length>d("WAWebPollsGatingUtils").getMaxPollOptionLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.MISSING_OPTION_VOTE_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);a=d("WALongInt").maybeNumber(a);if(a==null)throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_OPTION_VOTE_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g.has(b))throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.DUPLICATE_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var c=g.size;g.add(b);return{option:{localId:c,name:b},optionVoteCount:a}}).filter(Boolean);if(a.length<2||a.length>d("WAWebPollsGatingUtils").getMaxPollOptionCount())throw new(d("WAWebPollsValidationError").PollResultSnapshotValidationError)(d("WAWebPollsValidationError").PollResultSnapshotValidationErrorCode.INVALID_POLL_VOTES_SNAPSHOTS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);f=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.POLL_RESULT_SNAPSHOT,kind:d("WAWebMsgType").MsgKind.PollResultSnapshot,pollName:e,pollVotesSnapshot:{pollVotes:a}});return{msgData:f,contextInfo:b}}g["default"]=a}),98);
__d("WAWebPollsParsePollCreationMessageProto",["WANullthrows","WAWebMessageSecretErrorsWamEvent","WAWebMsgType","WAWebNewsletterIsNewsletterMsg","WAWebPollCreationUtils","WAWebPollOptionHashUtils","WAWebPollsGatingUtils","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason","WAWebWamEnumMessageSecretAllowedType","WAWebWamEnumMessageSecretErrorType","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;var f=b.pollCreationMessage,g=b.pollCreationMessageV2,h=b.pollCreationMessageV3,i=b.pollCreationMessageV5;f=(f=(f=f!=null?f:g)!=null?f:h)!=null?f:i;i=c("WAWebNewsletterIsNewsletterMsg")({from:e.from,to:e.to});i=!i;if(f==null)return null;if(f===g&&!d("WAWebPollsGatingUtils").isPollsReceivingEnabledInCags())return null;if(f===h&&!d("WAWebPollsGatingUtils").isSingleOptionPollsReceivingEnabled())return null;g=f.name;h=f.options;var j=f.selectableOptionsCount,k=f.contextInfo,l=f.correctAnswer,m=d("WAWebPollCreationUtils").getPollContentTypeFromE2EValue(f.pollContentType);f=d("WAWebPollCreationUtils").getPollTypeFromE2EValue(f.pollType);var n=m===d("WAWebPollCreationUtils").PollContentType.IMAGE;if(n&&!d("WAWebPollsGatingUtils").isPhotoPollReceiverEnabled(e))return{msgData:babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.POLL_CREATION}),contextInfo:k};if(g==null)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(g.length===0||g.length>d("WAWebPollsGatingUtils").getMaxPollNameLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_NAME,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(a==="quoted"||a==="history_quoted"){a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.POLL_CREATION,kind:d("WAWebMsgType").MsgKind.PollCreation,pollName:g,pollOptions:null,pollSelectableOptionsCount:null,pollContentType:m,pollType:f});return{msgData:a,contextInfo:k}}b=(a=b.messageContextInfo)==null?void 0:a.messageSecret;if(i&&b==null){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL,messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.MISSING_MESSAGE_SECRET}).commit();throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MISSING_MESSAGE_SECRET)}if(i&&(b==null?void 0:b.byteLength)!==32){new(d("WAWebMessageSecretErrorsWamEvent").MessageSecretErrorsWamEvent)({messageSecretAllowedList:d("WAWebWamEnumMessageSecretAllowedType").MESSAGE_SECRET_ALLOWED_TYPE.MESSAGE_POLL,messageSecretError:d("WAWebWamEnumMessageSecretErrorType").MESSAGE_SECRET_ERROR_TYPE.WRONG_LENGTH}).commit();throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_MESSAGE_SECRET,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.MESSAGE_SECRET_INVALID)}if(h.length===0)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(j==null)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.MISSING_SELECTABLE_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);var o=new Set(),p=new Set(),q;a=h.map(function(a){var b=a.optionName;a=a.optionHash;if(b==null||b.length===0||b.length>d("WAWebPollsGatingUtils").getMaxPollOptionLengthForIncomingMessages())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(o.has(b))throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.DUPLICATE_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(n){if(c("isStringNullOrEmpty")(a))throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_OPTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(p.has(a))throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.DUPLICATE_OPTIONS,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);p.add(a)}var e=o.size;o.add(b);(l==null?void 0:l.optionName)===b&&(q=e);return n?{name:b,hash:d("WAWebPollOptionHashUtils").createOptionHashHexFromString(c("WANullthrows")(a)),localId:e}:{name:b,localId:e}}).filter(Boolean);if(a.length<2||a.length>d("WAWebPollsGatingUtils").getMaxPollOptionCount())throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(j<0||j>a.length)throw new(d("WAWebPollsValidationError").PollCreationValidationError)(d("WAWebPollsValidationError").PollCreationValidationErrorCode.INVALID_SELECTABLE_OPTIONS_COUNT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);i=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.POLL_CREATION,kind:d("WAWebMsgType").MsgKind.PollCreation,pollName:g,pollOptions:a,pollSelectableOptionsCount:j,pollContentType:m,pollType:f,correctOptionIndex:q});return{msgData:i,contextInfo:k}}g["default"]=a}),98);
__d("WAWebPollsParsePollVoteMessageProto",["WALongInt","WAWebE2EProtoUtils","WAWebMsgType","WAWebPollsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.pollUpdateMessage;if(!b)return null;var c=b.$$unknownFieldCount;c=c===void 0?0:c;var e=b.vote,f=b.senderTimestampMs;b=b.pollCreationMessageKey;if(c>0)return null;if(b==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_POLL_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);c=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,a);if(c==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_POLL_MESSAGE_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(f==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_SENDER_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_UPDATE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=e.encPayload;e=e.encIv;if(b==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_VOTE_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e==null)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.MISSING_VOTE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(e.byteLength!==12)throw new(d("WAWebPollsValidationError").PollUpdateValidationError)(d("WAWebPollsValidationError").PollUpdateValidationErrorCode.INVALID_VOTE_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteEncrypted,subtype:"poll_vote",addonEncrypted:!0,pollUpdateParentKey:c,encPollVote:{encPayload:b,encIv:e},senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(f)}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebPollsGetVoteKey",["WAWebLidMigrationUtils","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.parentMsgKey;a=a.sender;a=d("WAWebWidFactory").createWidFromWidLike(a);return String(b)+"|"+String(d("WAWebLidMigrationUtils").toLid(a))+"|"+String(d("WAWebLidMigrationUtils").toPn(a))}g.getVoteKey=a}),98);
__d("WAWebPollsVoteDataUtils",["WANullthrows","WAWebMsgGetters","WAWebMsgKeyUtils","WAWebMsgType","WAWebUserPrefsMeUser","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(a.msgKey,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),c=b.from,e=b.to;b=b.author;return{id:a.msgKey,to:e,from:c,author:b,type:d("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:d("WAWebMsgType").MsgKind.PollVoteDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,pollUpdateParentKey:a.parentMsgKey,selectedOptionLocalIds:a.selectedOptionLocalIds,senderTimestampMs:a.senderTimestampMs,t:(e=a.t)!=null?e:void 0,ack:(c=a.ack)!=null?c:void 0,read:(b=a.read)!=null?b:!1}}function b(a){return{msgKey:a.id,parentMsgKey:a.pollUpdateParentKey,selectedOptionLocalIds:a.selectedOptionLocalIds,senderTimestampMs:a.senderTimestampMs,t:a.t,sender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a))),ack:d("WAWebMsgGetters").getAck(a),read:d("WAWebUserPrefsMeUser").isMeAccount(a.from)||a.read}}g.voteDataToPollVoteMsgData=a;g.pollVoteMsgDataToVoteData=b}),98);
__d("WAWebPollsVoteEncryption",["WAWebAddonEncryption","WAWebApiContact","WAWebLidMigrationUtils","WAWebMsgType","WAWebPollsVoteEncryptionInternal","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebPollsVoteEncryptionInternal").decryptVoteInternal(a)["catch"](function(b){if(a.isOneOnOne){var c=h(a.pollCreationOriginalSender,a.voteSender),e=c.alignedPollCreator,f=c.alignedVoteSender;if(e!=null&&f!=null)return d("WAWebPollsVoteEncryptionInternal").decryptVoteInternal(babelHelpers["extends"]({},a,{pollCreationOriginalSender:e,voteSender:f}))["catch"](function(b){var c=d("WAWebApiContact").getAlternateUserWid(e),g=d("WAWebApiContact").getAlternateUserWid(f);if(c!=null&&g!=null)return d("WAWebPollsVoteEncryptionInternal").decryptVoteInternal(babelHelpers["extends"]({},a,{pollCreationOriginalSender:c,voteSender:g}));throw b})}throw b})}function b(a){var b={type:d("WAWebMsgType").MsgKind.PollVoteDecrypted,encode:a.encodedProtobuf};if(a.isOneOnOne){var c=h(a.pollCreationOriginalSender,a.voteSender),e=c.alignedPollCreator;c=c.alignedVoteSender;e!=null&&c!=null&&(a.pollCreationOriginalSender=e,a.voteSender=c)}return d("WAWebAddonEncryption").encryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.pollCreationOriginalSender,addOnSender:a.voteSender})}function h(a,b){a=d("WAWebLidMigrationUtils").toCommonAddressingMode(a,b);b=a[0];a=a[1];return{alignedVoteSender:a!=null?d("WAWebWidFactory").asUserWidOrThrow(a):null,alignedPollCreator:b!=null?d("WAWebWidFactory").asUserWidOrThrow(b):null}}g.decryptVote=a;g.encryptVote=b}),98);
__d("WAWebPollsVoteEncryptionInternal",["WAWebAddonEncryption","WAWebMsgType","WAWebProtobufsE2E.pb","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={type:d("WAWebMsgType").MsgKind.PollVoteEncrypted,encryptedAddOn:a.encryptedVote};b=(yield d("WAWebAddonEncryption").decryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.pollCreationOriginalSender,addOnSender:a.voteSender}));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$PollVoteMessageSpec,b)});return h.apply(this,arguments)}g.decryptVoteInternal=a}),98);
__d("WAWebPollsGatingUtils",["WAWebABProps","WAWebChatGetters","WAWebMobilePlatforms","WAWebNewsletterGatingUtils","WAWebNewsletterIsNewsletterMsg","WAWebPrimaryFeatures","WAWebWid"],(function(a,b,c,d,e,f,g){function h(){if(d("WAWebMobilePlatforms").isSMB()&&!d("WAWebABProps").getABPropConfigValue("parent_group_view_enabled_for_smb_on_web"))return!1;return!d("WAWebPrimaryFeatures").primaryFeatureEnabled("poll_creation_cag")?!1:d("WAWebABProps").getABPropConfigValue("poll_creation_cag_enabled")}function a(){return h()?!0:d("WAWebABProps").getABPropConfigValue("poll_receiving_cag_enabled")}function b(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_name_length"),500)}function e(){return 5e3}function f(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_option_length"),255)}function i(){return 2500}function j(){return Math.min(d("WAWebABProps").getABPropConfigValue("poll_option_count"),20)}function k(){return d("WAWebABProps").getABPropConfigValue("poll_result_details_view_enabled")}function l(){return d("WAWebABProps").getABPropConfigValue("polls_fast_follow_enabled")}function m(){return l()}function n(){return l()}function o(){return d("WAWebABProps").getABPropConfigValue("polls_single_option_control_enabled")}function p(a){return c("WAWebWid").isNewsletter(a)===!0?d("WAWebNewsletterGatingUtils").isNewsletterPollsSingleOptionEnabled():o()||d("WAWebABProps").getABPropConfigValue("polls_single_option_sender_control_enabled")}function q(a){return p(a)||d("WAWebABProps").getABPropConfigValue("polls_single_option_receiver_control_enabled")}function r(){return d("WAWebABProps").getABPropConfigValue("polls_notification_enabled")}function s(){return d("WAWebABProps").getABPropConfigValue("poll_result_snapshot_message_receiver_enabled")}function t(){return d("WAWebABProps").getABPropConfigValue("poll_result_snapshot_polltype_envelope_enabled")}function u(a){if(!d("WAWebChatGetters").getIsNewsletter(a))return!1;if(d("WAWebNewsletterGatingUtils").isNewsletterPhotoPollSenderEnabled())return!0;return d("WAWebNewsletterGatingUtils").isNewsletterPhotoPollCapabilityEnabled(a)?!0:!1}function v(a){return c("WAWebNewsletterIsNewsletterMsg")({from:a.from,to:a.to})&&d("WAWebNewsletterGatingUtils").isNewsletterPhotoPollsReceiverEnabled()}g.isPollsCreationEnabledInCags=h;g.isPollsReceivingEnabledInCags=a;g.getMaxPollNameLength=b;g.getMaxPollNameLengthForIncomingMessages=e;g.getMaxPollOptionLength=f;g.getMaxPollOptionLengthForIncomingMessages=i;g.getMaxPollOptionCount=j;g.isPollResultDetailsViewEnabled=k;g.arePollsFastFollowsEnabled=l;g.isPrefillPollQuestionEnabled=m;g.isPollsCancellationPromptEnabled=n;g.isSingleOptionPollsSendingEnabled=p;g.isSingleOptionPollsReceivingEnabled=q;g.arePollsNotificationsEnabled=r;g.isPollResultSnapshotReceivingEnabled=s;g.isPollResultSnapshotPollTypeEnvelopeEnabled=t;g.isPhotoPollSenderEnabled=u;g.isPhotoPollReceiverEnabled=v}),98);
__d("WAWebSetUserDisclosureStageJob",["WAJobOrchestratorTypes","WAWebOrchestratorNonPersistedJob","WAWebSetUserDisclosureStageQueryJob"],(function(a,b,c,d,e,f,g){function a(a,b){return d("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("setUserDisclosureStage",function(){return d("WAWebSetUserDisclosureStageQueryJob").SetUserDisclosureStageQueryJob(a,b)},{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}g.setUserDisclosureStage=a}),98);
__d("WASmaxInUserNoticeSetResultResponseClientError",["WAResultOrError","WASmaxInUserNoticeIQErrorBadRequestMixin","WASmaxInUserNoticeIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInUserNoticeIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(c.value);if(!c.success)return c;a=d("WASmaxInUserNoticeIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorBadRequestMixin:c.value},a.value))}g.parseSetResultResponseClientError=a}),98);
__d("WASmaxInUserNoticeSetResultResponseServerError",["WAResultOrError","WASmaxInUserNoticeIQErrorInternalServerErrorMixin","WASmaxInUserNoticeIQErrorResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;c=d("WASmaxInUserNoticeIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(c.value);if(!c.success)return c;a=d("WASmaxInUserNoticeIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorIQErrorInternalServerErrorMixin:c.value},a.value))}g.parseSetResultResponseServerError=a}),98);
__d("WASmaxInUserNoticeSetResultResponseSuccess",["WAResultOrError","WASmaxInUserNoticeIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"trackable");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",1,void 0);if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"result",0,1e3);return!a.success?a:d("WAResultOrError").makeResult({id:b.value,result:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").optionalChildWithTag(a,"trackable",h);if(!c.success)return c;a=d("WASmaxInUserNoticeIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{trackable:c.value}))}g.parseSetResultResponseSuccessTrackable=h;g.parseSetResultResponseSuccess=a}),98);
__d("WASmaxOutUserNoticeBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutUserNoticeSetResultRequest",["WASmaxJsx","WASmaxOutUserNoticeBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.trackableId;a=a.trackableResult;b=d("WASmaxOutUserNoticeBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"tos"},d("WASmaxJsx").smax("trackable",{id:d("WAWap").INT(b),result:d("WAWap").INT(a)})));return b}g.makeSetResultRequest=a}),98);
__d("WAWebSetUserDisclosureStageQueryJob",["Promise","WAComms","WASmaxInUserNoticeSetResultResponseClientError","WASmaxInUserNoticeSetResultResponseServerError","WASmaxInUserNoticeSetResultResponseSuccess","WASmaxOutUserNoticeSetResultRequest","WATimeUtils","WAWebBackendErrors","WAWebTos","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i={5:"ACCEPTED",155:"ACCEPTED","-1":"UNKNOWN"};function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e={trackableId:a,trackableResult:c};e=(yield d("WASmaxOutUserNoticeSetResultRequest").makeSetResultRequest(e));var f=(yield d("WAComms").sendSmaxStanza(e)),g=(yield d("WASmaxInUserNoticeSetResultResponseSuccess").parseSetResultResponseSuccess(f,e));if(g.success){g=d("WATimeUtils").unixTime();c=i[c];d("WAWebTos").TosManager.setState(a.toString(),c,g);return(h||(h=b("Promise"))).resolve(!0)}a=(yield d("WASmaxInUserNoticeSetResultResponseClientError").parseSetResultResponseClientError(f,e));if(a.success){c=a.value.errorIQErrorBadRequestMixin;g=c.code;a=c.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(g),a)}c=(yield d("WASmaxInUserNoticeSetResultResponseServerError").parseSetResultResponseServerError(f,e));if(c.success){g=c.value.errorIQErrorInternalServerErrorMixin;a=g.code;f=g.text;throw new(d("WAWebBackendErrors").ServerStatusCodeError)(Number(a),f)}return(h||(h=b("Promise"))).resolve(!1)});return j.apply(this,arguments)}g.SetUserDisclosureStageQueryJob=a}),98);
__d("WAWebWamEnumNoticeTriggeredBy",[],(function(a,b,c,d,e,f){a=Object.freeze({AUTO_START:0,BANNER:1,DEEP_LINK:2,JUST_IN_TIME:3});f.NOTICE_TRIGGERED_BY=a}),66);
__d("WAWebWamEnumNoticeType",[],(function(a,b,c,d,e,f){a=Object.freeze({LEGACY_USER_NOTICE:0,BADGED_USER_NOTICE:1,PDFN_DISCLOSURE:2});f.NOTICE_TYPE=a}),66);
__d("WAWebWamEnumUserNoticeEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({TRIGGERED:0,BANNER_APPEAR:1,BANNER_SELECT:2,MODAL_APPEAR:3,MODAL_DISMISS:4,MODAL_LINK_FOLLOW:5,MODAL_ACCEPT:6,BLOCKING_MODAL_APPEAR:7,BLOCKING_MODAL_LINK_FOLLOW:8,BLOCKING_MODAL_ACCEPT:9,BANNER_DISMISS:10,EDUCATION_1_APPEAR:11,EDUCATION_1_DISMISS:12,EDUCATION_1_CONTINUE:13,MODAL_BACK:14,BLOCKING_MODAL_BACK:15,STARTED:100,PDFN_SHOWN_0:105,BADGE_APPEARED_NEXT_TO_SETTINGS:110,PDFN_SHOWN_1:111,PDFN_SHOWN_2:112,PDFN_SHOWN_3:113,PDFN_SHOWN_4:114,PDFN_SHOWN_5:115,PDFN_SHOWN_6:116,PDFN_SHOWN_7:117,PDFN_SHOWN_8:118,PDFN_SHOWN_9:119,BADGE_APPEARED_NEXT_TO_HELP:120,BADGE_SHOWN_IN_HELP:130,PDFN_DISMISSED:145,BADGE_EXPIRED:150,PDFN_OK:155,PDFN_SOFT_OPT_IN:160,PDFN_SOFT_OPT_OUT:162,PDFN_DENIED:165,BADGE_SELECTED:170,PDFN_ACCEPTED:175,PDFN_FAILED_TO_DOWNLOAD:400,PDFN_PARTIAL_DOWNLOAD:410,PDFN_ERROR_MISMATCHED_TEMPLATE:420,PDFN_ERROR_UNKNOWN:499,FINAL_END:999,PDFN_0_SECONDARY_BTN_CLICKED:1014,PDFN_1_SECONDARY_BTN_CLICKED:1015,PDFN_2_SECONDARY_BTN_CLICKED:1016,PDFN_3_SECONDARY_BTN_CLICKED:1017,PDFN_4_SECONDARY_BTN_CLICKED:1018,PDFN_5_SECONDARY_BTN_CLICKED:1019,PDFN_6_SECONDARY_BTN_CLICKED:1020,PDFN_7_SECONDARY_BTN_CLICKED:1021,PDFN_8_SECONDARY_BTN_CLICKED:1022,PDFN_9_SECONDARY_BTN_CLICKED:1023});f.USER_NOTICE_EVENT=a}),66);
__d("WAWebUserNoticeWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumNoticeTriggeredBy","WAWebWamEnumNoticeType","WAWebWamEnumUserNoticeEvent"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({UserNotice:[2472,{noticeTriggeredBy:[5,d("WAWebWamEnumNoticeTriggeredBy").NOTICE_TRIGGERED_BY],noticeType:[4,d("WAWebWamEnumNoticeType").NOTICE_TYPE],tsMs:[6,a.TYPES.TIMER],userNoticeContentVersion:[2,a.TYPES.INTEGER],userNoticeEvent:[3,d("WAWebWamEnumUserNoticeEvent").USER_NOTICE_EVENT],userNoticeId:[1,a.TYPES.INTEGER]},[1,1,1],"regular"]},{UserNotice:[]});g.UserNoticeWamEvent=b}),98);
__d("WAWebPDFNLogging",["WAWebPDFNTypes","WAWebUserNoticeWamEvent","WAWebWamEnumUserNoticeEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.noticeId,c=a.noticeContentVersion,e=a.noticeEvent;a=a.noticeType;b=new(d("WAWebUserNoticeWamEvent").UserNoticeWamEvent)({userNoticeId:b,userNoticeContentVersion:c,userNoticeEvent:e,noticeType:a});b.commit()}function b(a){switch(a){case d("WAWebPDFNTypes").DISCLOSURE_STAGE.ACCEPTED:return d("WAWebWamEnumUserNoticeEvent").USER_NOTICE_EVENT.PDFN_ACCEPTED;case d("WAWebPDFNTypes").DISCLOSURE_STAGE.OK:return d("WAWebWamEnumUserNoticeEvent").USER_NOTICE_EVENT.PDFN_OK}}g.logUserNoticeEvent=a;g.getNoticeEventFromDisclosureStage=b}),98);
__d("WAWebSetUserDisclosureStageAction",["WAWebPDFNLogging","WAWebSetUserDisclosureStageJob","WAWebWamEnumNoticeType","WAWebWamEnumUserNoticeEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){try{var e=(yield d("WAWebSetUserDisclosureStageJob").setUserDisclosureStage(a,b));e&&d("WAWebPDFNLogging").logUserNoticeEvent({noticeId:a,noticeEvent:d("WAWebPDFNLogging").getNoticeEventFromDisclosureStage(b),noticeContentVersion:c==null?void 0:c.disclosureContentVersion,noticeType:d("WAWebWamEnumNoticeType").NOTICE_TYPE.PDFN_DISCLOSURE});return e}catch(b){d("WAWebPDFNLogging").logUserNoticeEvent({noticeId:a,noticeContentVersion:c==null?void 0:c.disclosureContentVersion,noticeEvent:d("WAWebWamEnumUserNoticeEvent").USER_NOTICE_EVENT.PDFN_ERROR_UNKNOWN,noticeType:d("WAWebWamEnumNoticeType").NOTICE_TYPE.PDFN_DISCLOSURE});throw b}});return h.apply(this,arguments)}g.updateUserDisclosureStateAction=a}),98);
__d("WAWebParseOrderMessageProto",["WALongInt","WAWebE2EProtoParserApi","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.orderMessage;if(b==null)return;var c=b.thumbnail,e=b.message,f=b.orderId,g=b.itemCount,h=b.status,i=b.surface,j=b.sellerJid,k=b.orderTitle,l=b.token,m=b.totalAmount1000,n=b.totalCurrencyCode,o=b.contextInfo;b=b.catalogType;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.ORDER,kind:d("WAWebMsgType").MsgKind.Order,thumbnail:d("WAWebE2EProtoParserApi").decodeBytes(c),message:e||"",orderId:f,itemCount:g||0,status:h,surface:i,sellerJid:j,orderTitle:k||"",token:l||"",totalAmount1000:d("WALongInt").numberOrThrowIfTooLarge(m!=null?m:0),totalCurrencyCode:n,catalogType:b,body:""});return{msgData:a,contextInfo:o}}g["default"]=a}),98);
__d("WAWebParseProductMessageProto",["WALongInt","WAWebMsgType","WAWebParseImageMessageProto"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;b=b.productMessage;if(b==null)return;var f=b.product,g=b.businessOwnerJid,h=b.body,i=b.footer;b=b.contextInfo;if(f==null)return;var j=f.productImage,k=f.productId,l=f.currencyCode,m=f.priceAmount1000,n=f.salePriceAmount1000,o=f.retailerId,p=f.url,q=f.productImageCount,r=f.title;f=f.description;var s;if(j!=null){j=c("WAWebParseImageMessageProto")({messageProtobuf:{imageMessage:j},baseMessage:e,msgContext:a});if(j!=null){a=j.msgData;s={deprecatedMms3Url:a.deprecatedMms3Url,directPath:a.directPath,staticUrl:a.staticUrl,mimetype:a.mimetype,filehash:a.filehash,encFilehash:a.encFilehash,size:a.size,height:a.height,width:a.width,mediaKey:a.mediaKey,mediaKeyTimestamp:a.mediaKeyTimestamp,body:a.body,interactiveAnnotations:a.interactiveAnnotations,scanLengths:a.scanLengths,scansSidecar:a.scansSidecar,isViewOnce:a.isViewOnce,thumbnailDirectPath:a.thumbnailDirectPath,thumbnailSha256:a.thumbnailSha256,thumbnailEncSha256:a.thumbnailEncSha256}}}j=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PRODUCT,kind:d("WAWebMsgType").MsgKind.Product,businessOwnerJid:g,productId:k,currencyCode:l,priceAmount1000:d("WALongInt").numberOrThrowIfTooLarge(m!=null?m:0)||void 0,salePriceAmount1000:d("WALongInt").numberOrThrowIfTooLarge(n!=null?n:0)||void 0,retailerId:o,url:p,productImageCount:q,title:r,description:f,caption:h,footer:i},s);return{msgData:j,contextInfo:b}}g["default"]=a}),98);
__d("WAWebParseProtocolEphemeralSettingMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.protocolMessage;if(b==null)return;if(b.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING)return;var c;b.disappearingMode!=null&&(c=d("WAWebE2EProtoUtils").protoToDisappearingMode(a,b.disappearingMode));a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"ephemeral_setting",ephemeralDuration:b.ephemeralExpiration,disappearingModeTrigger:(a=c)==null?void 0:a.disappearingModeTrigger,disappearingModeInitiatedByMe:(b=c)==null?void 0:b.initiatedByMe});return{msgData:a,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebParseProtocolHistorySyncNotificationMessageProto",["WAWebE2EProtoParserApi","WAWebMsgType","WAWebProtobufsE2E.pb"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;c=c.protocolMessage;if(c==null)return;if(a!=="relay")return;if(c.type!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.HISTORY_SYNC_NOTIFICATION)return;a=c.historySyncNotification;if(a==null)return;var f={directPath:a.directPath,encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(a.fileEncSha256),filehash:d("WAWebE2EProtoParserApi").decodeBytes(a.fileSha256),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(a.mediaKey),type:"md-msg-hist"};e=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.Protocol,subtype:"history_sync_notification",historySyncMetaData:{historySyncNotification:a,downloadOptions:f,progress:(c==null||(b=c.historySyncNotification)==null?void 0:b.progress)||0}});return{msgData:e,contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebParseProtocolLimitSharingMessageProto",["WAWebLimitSharingProtoUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=d("WAWebLimitSharingProtoUtils").getLimitSharingEnvelopeFromProtobuf(b);if((b==null?void 0:b.type)!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.LIMIT_SHARING||!(b!=null&&b.limitSharing))return;b=d("WAWebLimitSharingProtoUtils").getLimitSharingFromEnvelope(b.limitSharing,d("WAWebWidFactory").createWid(a.from.toString()));return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,subtype:"limit_sharing_system_message",kind:"protocol",limitSharing:b}),contextInfo:void 0}}g["default"]=a}),98);
__d("WAWebGenerateAudioOrPttReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebPttParseAudioMessageProto",["WALongInt","WATimeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.audioMessage;if(b==null)return;var e=b.ptt;if(e===!0)return;e=b.contextInfo;var f=b.directPath,g=b.mimetype,h=b.seconds,i=b.mediaKeyTimestamp,j=b.streamingSidecar,k=b.waveform,l=b.backgroundArgb,m=b.viewOnce;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.AUDIO);var n=a.mediaKey,o=a.fileSha256,p=a.fileEncSha256,q=a.fileLength;a=a.url;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.AUDIO,kind:d("WAWebMsgType").MsgKind.Audio,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:f,mimetype:g,filehash:d("WAWebE2EProtoParserApi").decodeBytes(o),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(p),size:q,duration:""+(h||0),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:i!=null?d("WALongInt").numberOrThrowIfTooLarge(i):d("WATimeUtils").unixTime(),streamingSidecar:j,waveform:k&&d("WAWebAudioMessageProtoUtils").validateWaveform(k)?new Uint8Array(k):void 0,backgroundColor:l,isViewOnce:m===!0});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(c,b);d("WAWebAudioMessageProtoUtils").validateRequiredAudioProperties(c,b);return{msgData:c,contextInfo:e}}g["default"]=a}),98);
__d("WAWebPttParsePttMessageProto",["WALongInt","WATimeUtils","WAWebAudioMessageProtoUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage;a=a.msgContext;b=b.audioMessage;if(b==null)return;var e=b.ptt;if(e!==!0)return;e=b.contextInfo;var f=b.directPath,g=b.mimetype,h=b.seconds,i=b.mediaKeyTimestamp,j=b.streamingSidecar,k=b.waveform,l=b.backgroundArgb,m=b.viewOnce;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,a,d("WAWebMsgType").MSG_TYPE.PTT);var n=a.mediaKey,o=a.fileSha256,p=a.fileEncSha256,q=a.fileLength;a=a.url;c=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.PTT,kind:d("WAWebMsgType").MsgKind.Ptt,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),directPath:f,mimetype:g,filehash:d("WAWebE2EProtoParserApi").decodeBytes(o),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(p),size:q,duration:""+(h||0),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:i!=null?d("WALongInt").numberOrThrowIfTooLarge(i):d("WATimeUtils").unixTime(),streamingSidecar:j,waveform:k&&d("WAWebAudioMessageProtoUtils").validateWaveform(k)?new Uint8Array(k):void 0,backgroundColor:l,isViewOnce:m===!0});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(c,b);d("WAWebAudioMessageProtoUtils").validateRequiredAudioProperties(c,b);return{msgData:c,contextInfo:e}}g["default"]=a}),98);
__d("WAWebGeneratePtvReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebPtvParsePtvMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMsgType","WAWebPtvGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.ptvMessage;if(b==null)return;if(!d("WAWebPtvGatingUtils").isPtvReceivingEnabled())return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.PTV}),contextInfo:b==null?void 0:b.contextInfo};var c=b.url,e=b.directPath,f=b.staticUrl,g=b.mimetype,h=b.caption,i=b.fileSha256,j=b.fileEncSha256,k=b.fileLength,l=b.height,m=b.width,n=b.mediaKey,o=b.mediaKeyTimestamp,p=b.jpegThumbnail,q=b.annotations,r=b.viewOnce,s=b.thumbnailDirectPath,t=b.thumbnailSha256,u=b.thumbnailEncSha256,v=b.contextInfo,w=b.gifPlayback,x=b.gifAttribution,y=b.accessibilityLabel,z=b.seconds,A=b.streamingSidecar;a=babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.PTV,kind:d("WAWebMsgType").MsgKind.Ptv,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(c),directPath:e,staticUrl:f||"",mimetype:g,caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(h),filehash:d("WAWebE2EProtoParserApi").decodeBytes(i),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(j),size:d("WALongInt").numberOrThrowIfTooLarge(k||0),height:l,width:m,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(n),mediaKeyTimestamp:o!=null?d("WALongInt").numberOrThrowIfTooLarge(o):d("WATimeUtils").unixTime(),duration:""+(z||0),body:d("WAWebE2EProtoParserApi").decodeBytes(p)||"",interactiveAnnotations:q,isViewOnce:r===!0,thumbnailDirectPath:s,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(t),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(u),isGif:w,gifAttribution:x,accessibilityLabel:y,streamingSidecar:A});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(a,b);return{msgData:a,contextInfo:v}}g["default"]=a}),98);
__d("WAWebQuestionValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({MISSING_QUOTED_QUESTION:"missing_quoted_question",MISSING_QUOTED_RESPONSE:"missing_quoted_response",EMPTY_RESPONSE_TEXT:"empty_response_text",MISSING_QUESTION_SERVER_ID:"missing_question_server_id"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="QuestionReplyValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.QuestionReplyValidationErrorCode=a;g.QuestionReplyValidationError=c}),98);
__d("WAWebQuestionsProtoUtils",["WALogger","WAWebE2EProtoParser","WAWebMsgKey","WAWebMsgType","WAWebQuestionValidationError","WAWebQuestionsGatingUtils","WAWebViewMode.flow","WAWebWamEnumE2eFailureReason","WAWebWidFactory","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){var b,e=a.questionReplyQuotedMessage;a=a.message;if(((b=e.quotedQuestion)==null||(b=b.questionMessage)==null?void 0:b.message)==null)throw new(d("WAWebQuestionValidationError").QuestionReplyValidationError)(d("WAWebQuestionValidationError").QuestionReplyValidationErrorCode.MISSING_QUOTED_QUESTION,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);b=d("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:e.quotedQuestion.questionMessage.message,msgContext:"quoted",message:a});a=(a=e.quotedResponse)==null?void 0:a.questionResponseMessage;var f=j(a==null?void 0:a.key);if(!a||!f)throw new(d("WAWebQuestionValidationError").QuestionReplyValidationError)(d("WAWebQuestionValidationError").QuestionReplyValidationErrorCode.MISSING_QUOTED_RESPONSE,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(c("isStringNullOrEmpty")(a.text))throw new(d("WAWebQuestionValidationError").QuestionReplyValidationError)(d("WAWebQuestionValidationError").QuestionReplyValidationErrorCode.EMPTY_RESPONSE_TEXT,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);e=e.serverQuestionId;if(e==null)throw new(d("WAWebQuestionValidationError").QuestionReplyValidationError)(d("WAWebQuestionValidationError").QuestionReplyValidationErrorCode.MISSING_QUESTION_SERVER_ID,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{quotedQuestion:b,questionServerId:e,quotedResponse:{id:f,type:d("WAWebMsgType").MSG_TYPE.NEWSLETTER_QUESTION_RESPONSE,kind:d("WAWebMsgType").MsgKind.NewsletterQuestionResponse,body:a.text,from:b.from,to:b.to,parentMsgKey:b.id,parentServerId:e,questionResponseInfo:{},viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE}}}function j(a){var b;if((a==null?void 0:a.id)==null||a.remoteJid==null)return;return new(c("WAWebMsgKey"))({id:a.id,fromMe:(b=a.fromMe)!=null?b:!1,remote:d("WAWebWidFactory").createWid(a.remoteJid)})}function a(a,b){if(!b)return;try{a.questionReplyQuotedMessage=i({questionReplyQuotedMessage:b,message:{from:a.from,to:a.to,id:babelHelpers["extends"]({},a.id,{id:a.id.id+"_quoted_question"}),type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,count:null}})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[questions][replies] Invalid question reply quoted message"]))).tags("questions","replies").devConsole(a).sendLogs("questions-invalid-question-reply-quoted-msg")}}function b(a){var b,c;b=((b=a.contextInfo)==null?void 0:b.isQuestion)===!0&&!d("WAWebQuestionsGatingUtils").isQuestionReceiverEnabledForMsg(a.msgData);c=((c=a.contextInfo)==null?void 0:c.questionReplyQuotedMessage)!=null&&!d("WAWebQuestionsGatingUtils").isQuestionReplyReceiverEnabledForMsg(a.msgData);return b||c}g.getValidatedQuestionReplyQuotedMessage=i;g.maybeAddQuestionReplyQuotedMessage=a;g.shouldFutureProofQuestionMessage=b}),98);
__d("WAWebQuestions.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Question","Reply","Response"]);c=b("$InternalEnum").Mirrored(["ALL","CONTACTS","REPLIED"]);f.QuestionType=a;f.ResponsesFilterType=c}),66);
__d("WAWebQuestionsGatingUtils",["$InternalEnum","WAWebABProps","WAWebCommonNewsletterEnums","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebQuestions.flow"],(function(a,b,c,d,e,f,g){var h,i=new Map([[22,(h=d("WAWebMsgType")).MSG_TYPE.CHAT],[23,h.MSG_TYPE.IMAGE],[24,h.MSG_TYPE.VIDEO]]),j=new Map([[25,h.MSG_TYPE.CHAT],[26,h.MSG_TYPE.IMAGE],[27,h.MSG_TYPE.VIDEO]]),k=new Set([h.MSG_TYPE.VIDEO,h.MSG_TYPE.IMAGE]),l=b("$InternalEnum").Mirrored(["Send","Receive","Forward"]);function a(a){return o(a)&&m(d("WAWebQuestions.flow").QuestionType.Question,l.Send).has(d("WAWebMsgType").MSG_TYPE.CHAT)}function c(a,b){return o(a)&&m(d("WAWebQuestions.flow").QuestionType.Question,l.Send).has(b)}function e(a){return p(a)&&m(d("WAWebQuestions.flow").QuestionType.Question,l.Receive).has(a.type)}function m(a,b){var c=a===d("WAWebQuestions.flow").QuestionType.Question?i:j;return d("WAWebABProps").getABPropConfigValue(y(a,b)).split(",").map(function(a){return Number.parseInt(a.trim(),10)}).filter(function(a){return Number.isSafeInteger(a)}).reduce(function(a,b){b=c.get(b);b!=null&&a.add(b);return a},new Set())}function n(a){return!o(a)?new Set():m(d("WAWebQuestions.flow").QuestionType.Question,l.Send).intersection(k)}function o(a){var b;b=(b=a.newsletterMetadata)==null?void 0:b.membershipType;if(b==null||![d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Admin,d("WAWebCommonNewsletterEnums").NewsletterMembershipType.Owner].includes(b))return!1;return d("WAWebNewsletterGatingUtils").isNewsletterQuestionsCapabilityEnabled(a)?!0:d("WAWebABProps").getABPropConfigValue("channels_question_admin_enabled")}function p(a){return d("WAWebMsgGetters").getIsNewsletterMsg(a)&&d("WAWebABProps").getABPropConfigValue("channels_question_follower_enabled")}function f(a){return p(a)&&m(d("WAWebQuestions.flow").QuestionType.Reply,l.Receive).has(a.type)}function q(a,b){return o(a)&&m(d("WAWebQuestions.flow").QuestionType.Reply,l.Send).has(b)}function r(a){return q(a,d("WAWebMsgType").MSG_TYPE.CHAT)}function s(a){return!o(a)?new Set():m(d("WAWebQuestions.flow").QuestionType.Reply,l.Send).intersection(k)}function t(){return d("WAWebABProps").getABPropConfigValue("channels_question_response_rate_limit_max_count_in_client_ui")}function u(a,b){if(a===d("WAWebQuestions.flow").QuestionType.Question)return n(b);return a===d("WAWebQuestions.flow").QuestionType.Reply?s(b):new Set()}function v(){return d("WAWebABProps").getABPropConfigValue("channels_question_fetch_responses_page_size")}function w(a){return p(a)&&m(d("WAWebQuestions.flow").QuestionType.Question,l.Forward).has(a.type)}function x(a){return p(a)&&m(d("WAWebQuestions.flow").QuestionType.Reply,l.Forward).has(a.type)}function y(a,b){return a===d("WAWebQuestions.flow").QuestionType.Question?b===l.Send?"channels_question_sender_message_types_m1_enabled":b===l.Receive?"channels_question_receiver_message_types_m1_enabled":b===l.Forward?"channels_question_forward_message_types_chat_m1_enabled":function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+b)}():b===l.Send?"channels_question_reply_sender_message_types_m1_enabled":b===l.Receive?"channels_question_reply_receiver_message_types_m1_enabled":b===l.Forward?"channels_reply_forward_message_types_chat_m1_enabled":function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+b)}()}g.isQuestionSenderEnabled=a;g.isQuestionSenderEnabledForMsgType=c;g.isQuestionReceiverEnabledForMsg=e;g.getEnabledQuestionAttachmentTypes=n;g.isQuestionsFeatureEnabledForAdmins=o;g.isQuestionsFeatureEnabledForFollowers=p;g.isQuestionReplyReceiverEnabledForMsg=f;g.isQuestionReplySenderEnabledForMsgType=q;g.isQuestionReplySenderEnabled=r;g.getEnabledQuestionReplyAttachmentTypes=s;g.getResponsesRateLimitMaxCount=t;g.getEnabledAttachmentTypesForQuestionType=u;g.getQuestionResponsesPageSize=v;g.isQuestionForwardingEnabledForMsg=w;g.isQuestionReplyForwardingEnabledForMsg=x}),98);
__d("WAWebReactAddonMessageProcessorUtils",["WANullthrows","WAWebAddonDBTable","WAWebApiContact","WAWebCastToReactionMsg","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebSchemaReactions","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a){return[a.reactionParentKey,c("WANullthrows")(d("WAWebMsgGetters").getSender(a))]}function i(a){return h(a).map(function(a){return a.toString()}).join("-")}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=new Map();a=a.map(h);a=(yield d("WAWebAddonDBTable").addonDBTable.bulkGetByParentAndSender(d("WAWebMsgType").MSG_TYPE.REACTION,a));for(a of a){var c=d("WAWebCastToReactionMsg").assertReactionMsgData(a),e=i(c);b.set(e,c.reactionTimestamp)}return function(a){a=i(a);return b.get(a)}});return j.apply(this,arguments)}function e(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.map(h),e=[];for(b of b){var f=b[0],g=b[1];g=g.isUser()?d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(g)):void 0;g&&e.push([f.toString(),g.toString()])}var i=function(a,b){return a.toString()+"_"+b.toString()};f=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","senderUserJid"],e));var j=new Set();f.filter(Boolean).forEach(function(b){b=[b.parentMsgKey,b.senderUserJid];var a=b[0];b=b[1];j.add(i(c("WAWebMsgKey").from(a),d("WAWebWidFactory").createUserWidOrThrow(b)))});return a.map(function(b){var c=h(b),a=c[0];c=c[1];c=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(c));if(c==null)return b;if(!j.has(i(a,c)))return b;a=b.author;c=b.from;if(a!=null&&a.isRegularUser()){var e=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(a));e!=null&&(a=e)}if(b.from.isRegularUser()){e=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").asUserWidOrThrow(b.from));e&&(c=e)}return babelHelpers["extends"]({},b,{from:c,author:a})})});return k.apply(this,arguments)}g.createGetReactionTimestamp=a;g.overrideExistingReactions=e}),98);
__d("WAWebReactionGatingUtils",["WAWebABProps"],(function(a,b,c,d,e,f,g){function a(){return d("WAWebABProps").getABPropConfigValue("web_reaction_notification_via_add_on_api")}g.isReactionNotificationAddOnApiEnabled=a}),98);
__d("WAWebReactionAddonMessageProcessor",["Promise","WALogger","WAWebAddonConstants","WAWebAddonCreateMsgProcessor","WAWebBackendApi","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebLidStatusMigrationKeyUtils","WAWebMsgType","WAWebReactAddonMessageProcessorUtils","WAWebReactionDataUtils","WAWebReactionEncryptMsgData","WAWebReactionGatingUtils","WAWebReactionsEncryption","WAWebReactionsParseWebMsgInfoReaction","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k;function l(a){return!new Set([d("WAWebAddonConstants").AddonProcessMode.HistorySync,d("WAWebAddonConstants").AddonProcessMode.Hydration]).has(a)}var m=function(a){return babelHelpers["extends"]({},a,{reactionParentKey:d("WAWebLidStatusMigrationKeyUtils").matKeyConvert(a.reactionParentKey)})};a=d("WAWebAddonCreateMsgProcessor").createAddonMsgProcessorDualEncrypted({isEnabled:function(){return!0},convert:{fromHistorySyncMsg:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return d("WAWebReactionsParseWebMsgInfoReaction").parseWebMsgInfoReaction(a.webMsgInfo,a.parsedWebMsgInfo).map(function(a){return d("WAWebReactionDataUtils").reactionRowToReactionMsgData(d("WAWebReactionDataUtils").webMsgInfoReactionTypeToReactionsRow(a))})});function c(b){return a.apply(this,arguments)}return c}(),toDualEncryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted?a:d("WAWebReactionEncryptMsgData").encryptReactionMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}(),toDualDecryptedMsgData:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted?a:d("WAWebReactionsEncryption").decryptReactionMsgData(a,b)});function c(b,c){return a.apply(this,arguments)}return c}()},updateCollection:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){yield d("WAWebBackendApi").frontendSendAndReceive("updateReactionCollection",{msgs:a.add.map(m),removeReactions:a.remove.map(d("WAWebLidStatusMigrationKeyUtils").matKeyConvert),allowNotifications:l(b)})});function c(b,c){return a.apply(this,arguments)}return c}(),beforeUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=c.parents,f=[];c=[];for(a of a)a.kind===d("WAWebMsgType").MsgKind.ReactionEncrypted?c.push(a):a.kind===d("WAWebMsgType").MsgKind.ReactionDecrypted&&f.push(a);yield (k||(k=b("Promise"))).allSettled(c.map(function(a){return d("WAWebReactionsEncryption").decryptReactionMsgData(a,e.getForAddon(a))})).then(function(a){for(var b of a)b.status==="fulfilled"&&b.value!=null?f.push(b.value):d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Cannot decrypt reaction: ",""])),b.reason);a.some(function(a){return a.status==="rejected"})&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed decrypted enc reactions"]))).tags("messaging","addons").sendLogs("decrypt-enc-reaction-failed",{sampling:.01})});a=f;try{a=(yield d("WAWebReactAddonMessageProcessorUtils").overrideExistingReactions(f))}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to override existing reactions: ",""])),a).sendLogs("override-existing-reactions-failed")}var g=(yield d("WAWebReactAddonMessageProcessorUtils").createGetReactionTimestamp(a));c=a.filter(function(a){var b=g(a);return b==null||b<a.reactionTimestamp});return c});function c(b,c){return a.apply(this,arguments)}return c}(),afterUpsert:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;yield d("WAWebShouldUpdateLastAddOnPreview").filterAndUpdateChatPreviews(a.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(d("WAWebReactionDataUtils").reactionMsgDataToReactionRow(a))}));b===d("WAWebAddonConstants").AddonProcessMode.OnlineReceive&&(yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a.map(function(a){return a.id.toString()})))});function c(b,c){return a.apply(this,arguments)}return c}(),manageNotifications:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=b.processMode;if(!l(b)||!d("WAWebReactionGatingUtils").isReactionNotificationAddOnApiEnabled())return;d("WAWebBackendApi").frontendFireAndForget("handleReactionNotification",{reactions:a.add.map(m)})});function c(b,c){return a.apply(this,arguments)}return c}()});c=a;g["default"]=c}),98);
__d("WAWebReactionEncryptMsgData",["WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebBackendApi","WAWebMsgGetters","WAWebMsgType","WAWebProcessBaseMsgInfo","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("WAWebBackendApi").frontendSendAndReceive("getGroupMetadata",{groupWid:a.id.remote}));if(e!=null&&e.isCag){var f;e=self.crypto.getRandomValues(new Uint8Array(12));var g={type:(f=d("WAWebMsgType")).MsgKind.ReactionDecrypted,encode:{text:a.reactionText,senderTimestampMs:a.reactionTimestamp}},h=d("WAWebAddonEncryptionError").getValidatedMessageSecret(f.MsgKind.ReactionDecrypted,b);g=(yield d("WAWebAddonEncryption").encryptAddOn(g,{messageSecret:h,iv:e,stanzaId:b.id.id,originalMessageSender:c("WANullthrows")(d("WAWebMsgGetters").getOriginalSender(b)),addOnSender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))}));h=g.encPayload;return babelHelpers["extends"]({},d("WAWebProcessBaseMsgInfo").msgDataToBaseMsgInfo(a),{type:f.MSG_TYPE.REACTION_ENC,kind:f.MsgKind.ReactionEncrypted,targetMessageKey:b.id,encPayload:h,encIv:e.buffer})}return a});return h.apply(this,arguments)}g.encryptReactionMsgData=a}),98);
__d("WAWebReactionEncMessageValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_ENC_IV:"enc_reaction_invalid_iv",INVALID_ENC_PAYLOAD:"enc_reaction_invalid_payload",MISSING_TARGET_MSG_KEY:"enc_reaction_missing_target_msg_key",MISSING_MESSAGE_SECRET:"enc_reaction_missing_message_secret",MISSING_SENDER:"enc_reaction_missing_sender",MISSING_PARENT_MESSAGE:"enc_reaction_missing_parent_message",MISSING_PARENT_MESSAGE_SENDER:"enc_reaction_missing_parent_message_sender",DECRYPTION_FAILED:"enc_reaction_decryption_failed"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="ReactionEncMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.ReactionEncValidationErrorCode=a;g.ReactionEncMessageValidationError=c}),98);
__d("WAWebReactionsValidationError",["$InternalEnum","WAWebHandleMsgError"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({INVALID_REACTION_TEXT_LENGTH:"reaction_invalid_text_length",MISSING_PARENT_MSG_KEY:"reaction_missing_parent_msg_key",MISSING_TIMESTAMP:"reaction_missing_timestamp"});c=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="ReactionValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);g.ReactionValidationErrorCode=a;g.ReactionValidationError=c}),98);
__d("WAWebReactionsEncryption",["WALongInt","WANullthrows","WAWebAddonEncryption","WAWebAddonEncryptionError","WAWebE2EProtoUtils","WAWebMsgGetters","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebReactionEncMessageValidationError","WAWebReactionsBEUtils","WAWebReactionsValidationError","WAWebWamEnumE2eFailureReason","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b={type:d("WAWebMsgType").MsgKind.ReactionEncrypted,encryptedAddOn:a.encryptedReaction};b=(yield d("WAWebAddonEncryption").decryptAddOn(b,{messageSecret:a.messageSecret,iv:a.iv,stanzaId:a.stanzaId,originalMessageSender:a.originalMessageSender,addOnSender:a.reactionSender}));return d("decodeProtobuf").decodeProtobuf(d("WAWebProtobufsE2E.pb").Message$ReactionMessageSpec,b)});return i.apply(this,arguments)}function a(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=a.targetMessageKey,f=a.encIv,g=a.encPayload,i=d("WAWebAddonEncryptionError").getValidatedMessageSecret(d("WAWebMsgType").MsgKind.ReactionEncrypted,b),j=d("WAWebMsgGetters").getOriginalSender(b);if(j==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.MISSING_PARENT_MESSAGE_SENDER,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);g={encryptedReaction:g,messageSecret:i,iv:f,stanzaId:b.id.id,originalMessageSender:j,reactionSender:d("WAWebWidFactory").asUserWidOrThrow(c("WANullthrows")(d("WAWebMsgGetters").getSender(a)))};var k;try{k=(yield h(g))}catch(a){throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.DECRYPTION_FAILED,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE)}f=(i=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(k.text))!=null?i:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT;b=k.senderTimestampMs;if(b==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,reactionParentKey:e,reactionText:f,reactionTimestamp:d("WALongInt").numberOrThrowIfTooLarge(b),encPayload:void 0,encIv:void 0,read:!1})});return j.apply(this,arguments)}g.parseEncReaction=h;g.decryptReactionMsgData=a}),98);
__d("WAWebDBCreateOrUpdateReactions",["WAWebApiContact","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){var c=new Map();a.forEach(function(a){d("WAWebUserPrefsMeUser").isSerializedWidMe(a.senderUserJid)&&(a.read=!0);var b=h(a),e=c.get(b);e?e.timestamp<=a.timestamp&&c.set(b,a):c.set(b,a)});return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a[0];var b=[],e=[];Array.from(c.values()).forEach(function(a){e.push([a.parentMsgKey,a.senderUserJid]);var b=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").createUserWidOrThrow(a.senderUserJid));b!=null&&e.push([a.parentMsgKey,b.toString()])});var f=(yield a.anyOf(["parentMsgKey","senderUserJid"],e));f.forEach(function(a){var d=h(a),e=c.get(d);e&&(e.timestamp<=a.timestamp?c["delete"](d):e.senderUserJid!==a.senderUserJid&&b.push([a.parentMsgKey,a.senderUserJid]))});b.length>0&&(yield a.bulkRemove(b));yield a.bulkCreateOrReplace(Array.from(c.values()));return Array.from(c.values())});return function(b){return a.apply(this,arguments)}}())}function h(a){var b=d("WAWebWidFactory").createUserWidOrThrow(a.senderUserJid),c=String(d("WAWebLidMigrationUtils").toPn(b));b=String(d("WAWebLidMigrationUtils").toLid(b));return a.parentMsgKey+","+c+","+b}g.createOrUpdateReactions=a}),98);
__d("WAWebDBGetReactions",["WAWebApiContact","WAWebEmoji","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgKey","WAWebParseMsgKeyString","WAWebReactionsBEUtils","WAWebSchemaReactions","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("WAWebSchemaReactions").getReactionsTable().equals(["parentMsgKey"],a));var b={reactions:[],reactionByMe:null},e=new Map();a.forEach(function(a){var f=a.reactionText,g=a.orphan;if(f!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&g!==1){g=d("WAWebEmoji").EmojiUtil.getEmojiAggregate(f);f=(f=e.get(g))!=null?f:[];e.set(g,[].concat(f,[a]));g=c("WAWebParseMsgKeyString")(a.msgKey);g.fromMe&&(b.reactionByMe=a)}});var f=b.reactionByMe?d("WAWebEmoji").EmojiUtil.getEmojiAggregate(b.reactionByMe.reactionText):"";e.forEach(function(a,c){var d=!1;c===f&&(d=!0);b.reactions.push({aggregateEmoji:c,senders:a,hasReactionByMe:d})});return b});return h.apply(this,arguments)}function e(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=new Map();yield d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];b=(yield b.anyOf(["parentMsgKey"],a));b.forEach(function(a){var b=a.reactionText,e=a.orphan;if(b!==d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT&&e!==1){e=(b=c.get(a.parentMsgKey))!=null?b:[];e.push(a);c.set(a.parentMsgKey,e)}})});return function(a){return e.apply(this,arguments)}}());return c});return i.apply(this,arguments)}function f(a){return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(b){b=b[0];return b.anyOf(["parentMsgKey"],a)})}function j(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e,f=a.parentMsgKey;a=a.senderUserJid;var g=[];b=(b=d("WAWebLidMigrationUtils").getAlternateMsgKey(c("WAWebMsgKey").from(f)))==null?void 0:b.toString();e=(e=d("WAWebApiContact").getAlternateUserWid(d("WAWebWidFactory").createUserWidOrThrow(a)))==null?void 0:e.toString();f=[f,b].filter(Boolean);b=[a,e].filter(Boolean);for(a of f)for(e of b)g.push([a,e]);f=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","senderUserJid"],g,{limit:1}));return f[0]});return k.apply(this,arguments)}g.getReactions=a;g.getFilteredReactionsFromParentMsgs=e;g.getAllReactionsFromParentMsgs=f;g.existsReactionAddressingModeInsensitive=j}),98);
__d("WAWebDBProcessReactionsMsgs",["WAWebApiChat","WAWebBackendApi","WAWebDBCreateOrUpdateReactions","WAWebDBMarkFutureproofMessagesReparsed","WAWebLastAddOnDBSerialization","WAWebReactionsBEUtils","WAWebShouldUpdateLastAddOnPreview","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.length>0){var b=(yield d("WAWebReactionsBEUtils").createReactionsRowFromMsg(a));b=(yield d("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions(b));d("WAWebReactionsBEUtils").updateHasReactionFromParent(b);a=a.map(function(a){return a.id.toString()});yield d("WAWebDBMarkFutureproofMessagesReparsed").markFutureproofMessagesReparsed(a);a=(yield d("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates(b.map(function(a){return d("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(a)})));yield d("WAWebApiChat").bulkUpdateChatLastAddOnPreview(a);d("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:a})}});return h.apply(this,arguments)}g.processReactionMsgs=a}),98);
__d("WAWebReactionsParseWebMsgInfoReaction",["WALogger","WANullthrows","WAWebAddOnParseWebMsgInfo","WAWebE2EProtoUtils","WAWebWid","WAWebWidFactory"],(function(a,b,c,d,e,f,g){var h,i,j;function a(a,b){var e=[];try{if(a==null||a.reactions==null)return e;if(b==null||b.reactions==null)return e;b.reactions.forEach(function(a){var f=a.key,g=a.senderTimestampMs,j=a.text;a=a.unread;j=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j!=null?j:"");f=c("WANullthrows")(d("WAWebAddOnParseWebMsgInfo").buildAddonMsgKey(f));var k=f.msgKey;f=f.sender;f==null||!(f instanceof c("WAWebWid"))?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoReaction: reaction sender should be a wid."]))):j==null?d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseWebMsgInfoReaction:convertToTextWithoutSpecialEmojis reaction text is null."]))):e.push({id:k,reactionTimestamp:g,reactionText:j,reactionParentKey:b.id,sender:d("WAWebWidFactory").createWid(f.toString()),unread:k.fromMe?!1:a===!0})})}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[history sync] parseWebMsgInfoReaction failed with error "," and stack ",""])),a==null?void 0:a.name,a==null?void 0:a.stack)}return e}g.parseWebMsgInfoReaction=a}),98);
__d("WAWebDBChangeOrphanStateReactions",["WAWebModelStorageUtils","WAWebSchemaReactions","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebModelStorageUtils").getStorage().lock(["reactions"],function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=b[0];var c=a.map(function(a){return[a,1]});c=(yield d("WAWebSchemaReactions").getReactionsTable().anyOf(["parentMsgKey","orphan"],c));c.forEach(function(a){a.orphan=0,a.orphanReason=void 0});yield b.bulkCreateOrReplace(c);return c});return function(a){return c.apply(this,arguments)}}())}g.changeOrphanStateReactions=a}),98);
__d("WAWebCheckUpdateOrphanReactions",["WALogger","WAWebAddonProcessMsgs","WAWebDBChangeOrphanStateReactions","WAWebReactionDataUtils","WAWebStoreOrphans","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=(yield d("WAWebDBChangeOrphanStateReactions").changeOrphanStateReactions(a));d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Updating reaction orphans"]))).tags("checkUpdateForOrphanReactions");a=(yield d("WAWebAddonProcessMsgs").processMsgsAndGetOrphans(a.map(function(a){return d("WAWebReactionDataUtils").reactionRowToReactionMsgData(a)})));a=a.orphans;yield d("WAWebStoreOrphans").storeOrphans(a)}catch(a){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["checkUpdateForOrphanReactions: error ",""])),a)}});return j.apply(this,arguments)}g.checkUpdateForOrphanReactions=a}),98);
__d("WAWebReactionsParseReactionEncMessageProto",["WAWebE2EProtoUtils","WAWebMsgType","WAWebReactionEncMessageValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.encReactionMessage;if(b==null)return;var c=b.encIv,e=b.encPayload;b=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.targetMessageKey,a);if(b==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.MISSING_TARGET_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);if(c==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.INVALID_ENC_IV,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);if(e==null)throw new(d("WAWebReactionEncMessageValidationError").ReactionEncMessageValidationError)(d("WAWebReactionEncMessageValidationError").ReactionEncValidationErrorCode.INVALID_ENC_PAYLOAD,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION_ENC,kind:d("WAWebMsgType").MsgKind.ReactionEncrypted,encIv:c,encPayload:e,targetMessageKey:b}),contextInfo:null}}g["default"]=a}),98);
__d("WAWebReactionsParseReactionMessageProto",["WALongInt","WAWebConstantsDeprecated","WAWebE2EProtoUtils","WAWebMsgType","WAWebReactionsBEUtils","WAWebReactionsValidationError","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf;a=a.baseMessage;b=b.reactionMessage;if(b==null)return;var c=h(b),e=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b.key,a);b=d("WALongInt").maybeNumberOrThrowIfTooLarge(b.senderTimestampMs);if(e==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_PARENT_MSG_KEY,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);if(b==null)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.MISSING_TIMESTAMP,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);return{msgData:babelHelpers["extends"]({},a,{type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,reactionParentKey:e,reactionText:c,reactionTimestamp:b,read:!1}),contextInfo:null}}function h(a){a=a.text;if(a!=null&&a.length>c("WAWebConstantsDeprecated").REACTION_CONTENT_MAX_LENGTH)throw new(d("WAWebReactionsValidationError").ReactionValidationError)(d("WAWebReactionsValidationError").ReactionValidationErrorCode.INVALID_REACTION_TEXT_LENGTH,d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_REACTION_TEXT);return(a=d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(a))!=null?a:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT}g["default"]=a}),98);
__d("WAWebReactionDataUtils",["WANullthrows","WAWebMsgGetters","WAWebMsgKey","WAWebMsgKeyUtils","WAWebMsgType","WAWebReactionsBEUtils","WAWebViewMode.flow","WAWebWidFactory"],(function(a,b,c,d,e,f,g){function a(a){var b=c("WAWebMsgKey").fromString(a.msgKey),e=d("WAWebMsgKeyUtils").msgKeyToTargetInfo(b,d("WAWebMsgKeyUtils").TranslateMsgKeyType.Addon),f=e.from,g=e.to;e=e.author;return{id:b,to:g,from:f,author:e,type:d("WAWebMsgType").MSG_TYPE.REACTION,kind:d("WAWebMsgType").MsgKind.ReactionDecrypted,viewMode:d("WAWebViewMode.flow").ViewModeType.VISIBLE,reactionParentKey:c("WAWebMsgKey").fromString(a.parentMsgKey),reactionText:a.reactionText,reactionTimestamp:a.timestamp,t:(b=a.t)!=null?b:void 0,ack:(g=a.ack)!=null?g:void 0,read:(f=a.read)!=null?f:!1}}function b(a){var b;return{msgKey:a.id.toString(),parentMsgKey:a.reactionParentKey.toString(),senderUserJid:c("WANullthrows")(d("WAWebMsgGetters").getSender(a)).toString(),reactionText:a.reactionText,timestamp:a.reactionTimestamp,t:d("WAWebMsgGetters").getT(a),ack:(b=d("WAWebMsgGetters").getAck(a))!=null?b:void 0,orphan:0,read:a.read}}function e(a){var b=a.id,c=a.reactionTimestamp,e=a.reactionText,f=a.reactionParentKey,g=a.sender;a=a.unread;g=d("WAWebWidFactory").asUserWidOrThrow(g);var h=0;return{msgKey:b.toString(),parentMsgKey:f.toString(),senderUserJid:g.toString(),reactionText:e!=null?e:d("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT,timestamp:c,orphan:h,read:!a}}g.reactionRowToReactionMsgData=a;g.reactionMsgDataToReactionRow=b;g.webMsgInfoReactionTypeToReactionsRow=e}),98);
__d("WAWebReactionsBEUtils",["WALogger","WALongInt","WANullthrows","WAWebAddonQueryUtils","WAWebBotGenTypingIndicatorMsg","WAWebDBGetReactions","WAWebMessageAssociation.flow","WAWebMessageAssociationConstants","WAWebMsgType","WAWebSchemaMessage","WAWebWidFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j="",k=new Set([(f=d("WAWebMsgType")).MSG_TYPE.CIPHERTEXT,f.MSG_TYPE.REVOKED,f.MSG_TYPE.DEBUG,f.MSG_TYPE.DEBUG_PLACEHOLDER,f.MSG_TYPE.GP2,f.MSG_TYPE.NOTIFICATION,f.MSG_TYPE.NEWSLETTER_NOTIFICATION,f.MSG_TYPE.NOTIFICATION_TEMPLATE,f.MSG_TYPE.E2E_NOTIFICATION]),l=new Set([d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL]);function m(a){var b=a.type,c=a.subtype,e=a.futureproofType;a=a.associationType;if(b===d("WAWebMsgType").MSG_TYPE.UNKNOWN)return e!=null&&d("WAWebMessageAssociationConstants").orphanIneligibleFutureproofTypes.has(e);return k.has(b)||a!=null&&l.has(a)||b===d("WAWebMsgType").MSG_TYPE.CHAT&&c===d("WAWebBotGenTypingIndicatorMsg").BOT_TYPING_PLACEHOLDER_MSG_SUBTYPE?!1:!0}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],e=[];a.forEach(function(a){a&&e.push(a.reactionParentKey)});var f=(yield d("WAWebAddonQueryUtils").getParentMsgsByMsgKey(e));a.forEach(function(a){var e;e=(e=a.author)!=null?e:a.from;if(!e||!a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["createReactionsRowFromMsg: sender or reactionMsg are null"])));return}var g=f.get(a.reactionParentKey.toString());if(g&&!m(g)){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["createReactionsRowFromMsg: reactions not allowed for this message type ",""])),g.type);return}e=d("WAWebWidFactory").asUserWidOrThrow(e);e={msgKey:a.id.toString(),parentMsgKey:(g=g==null?void 0:g.id.toString())!=null?g:a.reactionParentKey.toString(),senderUserJid:e.toString(),reactionText:(g=a.reactionText)!=null?g:j,timestamp:a.reactionTimestamp,orphan:0,orphanReason:void 0,read:!1,t:c("WANullthrows")(d("WALongInt").maybeNumberOrThrowIfTooLarge(a.t))};b.push(e)});return b});return n.apply(this,arguments)}function e(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=[];a.forEach(function(a){var d=a.parentMsgKey,e=a.orphan;a=a.reactionText;if(e!==1)if(a!==j){e={id:d,hasReaction:!0};c.push(e)}else b.push(d)});var e=(yield d("WAWebDBGetReactions").getFilteredReactionsFromParentMsgs(b));b.forEach(function(a){var b=e.get(a);b=b&&b.length>0||!1;a={id:a,hasReaction:b};c.push(a)});return d("WAWebSchemaMessage").getMessageTable().bulkCreateOrMerge(c)});return o.apply(this,arguments)}g.REVOKED_REACTION_TEXT=j;g.canHaveReactions=m;g.createReactionsRowFromMsg=a;g.updateHasReactionFromParent=e}),98);
__d("WAWebParseProtocolAdminRevokeMessageProto",["WAWebAck","WAWebProtocolRevokeMessageUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;if(e!==d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE)return;return d("WAWebProtocolRevokeMessageUtils").parseProtocolRevokeMessageProto({messageProtobuf:b,baseMessage:c,editAttr:e,msgContext:f,msgMeta:a})}g["default"]=a}),98);
__d("WAWebParseProtocolSenderRevokeMessageProto",["WAWebAck","WAWebProtocolRevokeMessageUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;if(e!==d("WAWebAck").EDIT_ATTR.SENDER_REVOKE)return;return d("WAWebProtocolRevokeMessageUtils").parseProtocolRevokeMessageProto({messageProtobuf:b,baseMessage:c,editAttr:e,msgContext:f,msgMeta:a})}g["default"]=a}),98);
__d("WAWebProtocolRevokeMessageUtils",["WALogger","WAWebAck","WAWebE2EProtoUtils","WAWebHandleMsgError","WAWebHandleMsgMetaUtils","WAWebMsgType","WAWebProtobufsE2E.pb","WAWebWamEnumE2eFailureReason"],(function(a,b,c,d,e,f,g){var h,i,j,k=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="ProtocolRevokeMessageValidationError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(d("WAWebHandleMsgError").MessageValidationError);function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.editAttr,f=a.msgContext;a=a.msgMeta;b=b.protocolMessage;if(b==null)return;var g=b.type;b=b.key;if(f!=="relay"&&g!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.EPHEMERAL_SETTING)return;if(g!==d("WAWebProtobufsE2E.pb").Message$ProtocolMessage$Type.REVOKE)return;(f=c.author)!=null&&f.isLid()&&d("WAWebHandleMsgMetaUtils").isCommentMsgMeta(a)?(d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["found comment revoke"]))),f=d("WAWebE2EProtoUtils").translateAddonMessageKeyToLocalReference(b,c)):f=d("WAWebE2EProtoUtils").translateRegularMessageKeyToLocalReference(b,c);if(f==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["missing a revoke message key "," (",") for "," from "," for ",""])),b==null?void 0:b.id,Boolean(b),c.id,c.author,g);throw new k("protocol_revoke_missing_key",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER)}if(e===d("WAWebAck").EDIT_ATTR.ADMIN_REVOKE)a="admin_revoke";else if(e===d("WAWebAck").EDIT_ATTR.SENDER_REVOKE)a="sender_revoke";else throw new k("protocol_revoke_missing_edit_attr",d("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_PROTOCOL_BUFFER);try{return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:d("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:a,protocolMessageKey:f}),contextInfo:null}}catch(a){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["parseProtocolRevokeMessageProto: error:",", stack: ",""])),a==null?void 0:a.name,a==null?void 0:a.stack).tags("messaging").sendLogs("ProtocolRevokeParseError");throw a}}g.ProtocolRevokeMessageValidationError=k;g.parseProtocolRevokeMessageProto=a}),98);
__d("WAWebGenerateImageReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebGenerateVideoReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WAWebParseImageMessageProto",["WALongInt","WATimeUtils","WAWebAssociationProtoUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaMessageGetValidatedProperties","WAWebMessageAssociation.flow","WAWebMessageAssociationGatingUtils","WAWebMsgType","WAWebPollsGatingUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.msgContext,f=a.messageAssociation;a=a.msgMeta;b=b.imageMessage;if(b==null)return;var g=b.directPath,h=b.staticUrl,i=b.mimetype,j=b.caption,k=b.height,l=b.width,m=b.mediaKeyTimestamp,n=b.jpegThumbnail,o=b.scanLengths,p=b.scansSidecar,q=b.viewOnce,r=b.thumbnailDirectPath,s=b.thumbnailSha256,t=b.thumbnailEncSha256,u=b.contextInfo,v=b.annotations,w=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,e,d("WAWebMsgType").MSG_TYPE.IMAGE),x=w.mediaKey,y=w.fileSha256,z=w.fileEncSha256,A=w.fileLength;w=w.url;w=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.IMAGE,kind:d("WAWebMsgType").MsgKind.Image,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(w),directPath:g||"",staticUrl:h||"",mimetype:i||"",caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j),filehash:d("WAWebE2EProtoParserApi").decodeBytes(y),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(z),size:A,height:k||0,width:l||0,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(x),mediaKeyTimestamp:m!=null?d("WALongInt").numberOrThrowIfTooLarge(m):d("WATimeUtils").unixTime(),body:d("WAWebE2EProtoParserApi").decodeBytes(n)||"",interactiveAnnotations:v,scanLengths:o,scansSidecar:p,isViewOnce:q===!0,thumbnailDirectPath:r,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(s),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(t),statusMentioned:a==null?void 0:a.statusMentioned});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(w,b);if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){g=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(f,c,e);h=g.associationParentMsgKey;i=g.associationType;j=g.viewMode;if(i===d("WAWebMessageAssociation.flow").MessageAssociationType.MEDIA_POLL&&!d("WAWebPollsGatingUtils").isPhotoPollReceiverEnabled(c))return{msgData:babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.UNKNOWN,kind:d("WAWebMsgType").MsgKind.Unknown,futureproofType:d("WAWebMsgType").MSG_TYPE.IMAGE}),contextInfo:u};y=babelHelpers["extends"]({},w,{kind:"associatedImage",parentMsgKey:h,associationType:i,viewMode:j});return{msgData:y,contextInfo:u}}return{msgData:w,contextInfo:u}}g["default"]=a}),98);
__d("WAWebParseVideoMessageProto",["WALongInt","WATimeUtils","WAWebAssociationProtoUtils","WAWebE2EProtoParserApi","WAWebE2EProtoUtils","WAWebMediaMessageGetValidatedProperties","WAWebMessageAssociationGatingUtils","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b=a.messageProtobuf,c=a.baseMessage,e=a.msgContext,f=a.messageAssociation;a=a.msgMeta;b=b.videoMessage;if(b==null)return;var g=b.directPath,h=b.staticUrl,i=b.mimetype,j=b.caption,k=b.height,l=b.width,m=b.mediaKeyTimestamp,n=b.jpegThumbnail,o=b.viewOnce,p=b.thumbnailDirectPath,q=b.thumbnailSha256,r=b.thumbnailEncSha256,s=b.contextInfo,t=b.gifPlayback,u=b.gifAttribution,v=b.accessibilityLabel,w=b.seconds,x=b.streamingSidecar,y=b.annotations,z=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(b,c,e,d("WAWebMsgType").MSG_TYPE.VIDEO),A=z.mediaKey,B=z.fileSha256,C=z.fileEncSha256,D=z.fileLength;z=z.url;z=babelHelpers["extends"]({},c,{type:d("WAWebMsgType").MSG_TYPE.VIDEO,kind:d("WAWebMsgType").MsgKind.Video,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(z),directPath:g,staticUrl:h||"",mimetype:i,caption:d("WAWebE2EProtoUtils").convertToTextWithoutSpecialEmojis(j),filehash:d("WAWebE2EProtoParserApi").decodeBytes(B),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(C),size:D,height:k,width:l,mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(A),mediaKeyTimestamp:m!=null?d("WALongInt").numberOrThrowIfTooLarge(m):d("WATimeUtils").unixTime(),duration:""+(w||0),body:d("WAWebE2EProtoParserApi").decodeBytes(n)||"",interactiveAnnotations:y,isViewOnce:o===!0,thumbnailDirectPath:p,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(q),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(r),isGif:t,gifAttribution:u,accessibilityLabel:v,streamingSidecar:x,statusMentioned:a==null?void 0:a.statusMentioned});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(z,b);if(f&&d("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()){g=d("WAWebAssociationProtoUtils").getValidatedAssociationFieldsFromProto(f,c,e);h=g.associationParentMsgKey;i=g.associationType;j=g.viewMode;B=babelHelpers["extends"]({},z,{kind:"associatedVideo",parentMsgKey:h,associationType:i,viewMode:j});return{msgData:B,contextInfo:s}}return{msgData:z,contextInfo:s}}g["default"]=a}),98);
__d("WAWebParseStickerPackMessageProto",["WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.messageProtobuf,e=a.baseMessage;a=a.msgContext;c=c.stickerPackMessage;if(c==null)return null;var f=c.caption;a=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(c,e,a,d("WAWebMsgType").MSG_TYPE.STICKER_PACK);var g=a.mediaKey,h=a.fileSha256,i=a.fileEncSha256;a=a.url;var j=[];(b=c.stickers)==null||b.forEach(function(a){j.push({fileName:a.fileName,emojis:a.emojis,isLottie:a.isLottie,mimetype:a.mimetype,isAnimated:a.isAnimated,accessibilityLabel:a.accessibilityLabel})});a=babelHelpers["extends"]({},e,{type:d("WAWebMsgType").MSG_TYPE.STICKER_PACK,kind:d("WAWebMsgType").MsgKind.StickerPack,caption:f,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(a),description:c.packDescription,isCaptionByUser:f!=null,filename:c.name,filehash:d("WAWebE2EProtoParserApi").decodeBytes(h),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(i),mediaKey:d("WAWebE2EProtoParserApi").decodeBytes(g),directPath:c.directPath,stickerPackId:c.stickerPackId,thumbnailDirectPath:c.thumbnailDirectPath,thumbnailSha256:d("WAWebE2EProtoParserApi").decodeBytes(c.thumbnailSha256),thumbnailEncSha256:d("WAWebE2EProtoParserApi").decodeBytes(c.thumbnailEncSha256),mediaKeyTimestamp:c.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(c.mediaKeyTimestamp):d("WATimeUtils").unixTime(),stickers:j,stickerPackPublisher:c.publisher,stickerPackSize:d("WALongInt").numberOrThrowIfTooLarge((b=c.stickerPackSize)!=null?b:0),trayIconFileName:c.trayIconFileName,size:d("WALongInt").numberOrThrowIfTooLarge((e=c.fileLength)!=null?e:0)});return{msgData:a,contextInfo:null}}g["default"]=a}),98);
__d("WAWebGenerateStickerReportingTokenContent",["WAWebReportingTokenUtils"],(function(a,b,c,d,e,f,g){function a(a){return d("WAWebReportingTokenUtils").getMediaReportingTokenContent(a)}g["default"]=a}),98);
__d("WABase64Sanitize",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){if(a==null)return null;var b=a.replace(/\s+$/,"");a!==b&&Math.random()<1e-5&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["base64 sanitized due to extra whitespace"]))).sendLogs("media-key-sanitize");return b}g["default"]=a}),98);
__d("WAWebStickersParseStickerMessageProto",["WABase64Sanitize","WALongInt","WATimeUtils","WAWebE2EProtoParserApi","WAWebMediaMessageGetValidatedProperties","WAWebMsgType"],(function(a,b,c,d,e,f,g){function a(a){var b,e=a.messageProtobuf,f=a.baseMessage;a=a.msgContext;var g=e==null?void 0:e.lottieStickerMessage;g=g==null||(b=g.message)==null?void 0:b.stickerMessage;e=e==null?void 0:e.stickerMessage;g!=null&&(e=g);if(e==null)return;g=d("WAWebMediaMessageGetValidatedProperties").getValidatedMediaMessageProperties(e,f,a,d("WAWebMsgType").MSG_TYPE.STICKER);a=g.mediaKey;var h=g.fileSha256,i=g.fileEncSha256;g=g.url;f=babelHelpers["extends"]({},f,{type:d("WAWebMsgType").MSG_TYPE.STICKER,kind:d("WAWebMsgType").MsgKind.Sticker,deprecatedMms3Url:d("WAWebE2EProtoParserApi").decodeUrl(g),directPath:e.directPath||"",mimetype:e.mimetype||"",filehash:d("WAWebE2EProtoParserApi").decodeBytes(h),encFilehash:d("WAWebE2EProtoParserApi").decodeBytes(i),mediaKey:c("WABase64Sanitize")(d("WAWebE2EProtoParserApi").decodeBytes(a)),mediaKeyTimestamp:e.mediaKeyTimestamp!=null?d("WALongInt").numberOrThrowIfTooLarge(e.mediaKeyTimestamp):d("WATimeUtils").unixTime(),height:e.height||0,width:e.width||0,firstFrameLength:e.firstFrameLength,firstFrameSidecar:e.firstFrameSidecar,isAnimated:e.isAnimated,isLottie:e.isLottie,stickerSentTs:d("WALongInt").maybeNumberOrThrowIfTooLarge(e.stickerSentTs),isAvatar:e.isAvatar});d("WAWebE2EProtoParserApi").validateRequiredMediaProperties(f,e);return{msgData:f,contextInfo:e.contextInfo}}g["default"]=a}),98);
__d("WAWebThreadId",["WAWebMsgKey","WAWebThreadUtils","err"],(function(a,b,c,d,e,f,g){a=function(){function a(a){this.type=a.type,this.key=a.key,this._serialized=this.type+"_"+this.key.toString()}var b=a.prototype;b.toString=function(){return this._serialized};b.equals=function(b){return b instanceof a&&this.toString()===b.toString()};a.from=function(a){a=a.split("_");if(a.length<2)throw c("err")("ThreadId.from error: invalid string format");var b=a[0];a=a.slice(1,a.length).join("_");b=d("WAWebThreadUtils").getThreadTypeFromString(b);return d("WAWebThreadUtils").getThreadIDfromType(c("WAWebMsgKey").from(a),b)};a.fromMessage=function(a,b){a=a instanceof c("WAWebMsgKey")?a:c("WAWebMsgKey").from(a);return d("WAWebThreadUtils").getThreadIDfromType(a,b)};return a}();g["default"]=a}),98);
__d("WAWebThreadUtils",["WAWebMsgKey","WAWebProtobufsE2E.pb","WAWebThreadId","err"],(function(a,b,c,d,e,f,g){var h={AiThread:"aiThread",ViewAllReplies:"viewAllReplies"},i={Unknown:"unknown",Default:"default",Incognito:"incognito"};function a(a){switch(a){case i.Unknown:return i.Unknown;case i.Default:return i.Default;case i.Incognito:return i.Incognito;default:throw c("err")("getAiThreadTypeFromString error: invalid AI thread type")}}function b(a){switch(a){case h.AiThread:return h.AiThread;case h.ViewAllReplies:return h.ViewAllReplies;default:throw c("err")("getThreadTypeFromString error: invalid thread type")}}function e(a,b){switch(b){case h.AiThread:return new(c("WAWebThreadId"))({type:b,key:c("WAWebMsgKey").from(a)});case h.ViewAllReplies:return new(c("WAWebThreadId"))({type:b,key:c("WAWebMsgKey").from(a)});default:throw c("err")("getThreadIDfromType error: invalid thread type")}}function f(a){switch(a){case d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.AI_THREAD:return h.AiThread;case d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.VIEW_REPLIES:return h.ViewAllReplies;case d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.UNKNOWN:throw c("err")("getThreadsTypeFromE2EValue error: UNKNOWN thread type")}}function j(a){switch(a){case h.AiThread:return d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.AI_THREAD;case h.ViewAllReplies:return d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.VIEW_REPLIES}}function k(a,b){$$gen$m0:{if(b===i.Default){return{title:a,aiThreadType:i.Default};break $$gen$m0}if(b===i.Incognito){return{title:a,aiThreadType:i.Incognito};break $$gen$m0}if(b===i.Unknown){throw c("err")("getAiThreadInfoFromType error: Unknown AI thread type");break $$gen$m0}throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+b)}}g.ThreadType=h;g.AiThreadType=i;g.getAiThreadTypeFromString=a;g.getThreadTypeFromString=b;g.getThreadIDfromType=e;g.getThreadsTypeFromE2EValue=f;g.getThreadsTypeAsE2EValue=j;g.getAiThreadInfoFromType=k}),98);
__d("WAWebAiThreadTypeUtils",["WAWebProtobufsAICommon.pb","WAWebThreadUtils"],(function(a,b,c,d,e,f,g){function a(a){return a==null?d("WAWebThreadUtils").AiThreadType.Unknown:a===d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.DEFAULT?d("WAWebThreadUtils").AiThreadType.Default:a===d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.INCOGNITO?d("WAWebThreadUtils").AiThreadType.Incognito:a===d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.UNKNOWN?d("WAWebThreadUtils").AiThreadType.Unknown:function(){throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+a)}()}function b(a){$$gen$m0:{if(a===d("WAWebThreadUtils").AiThreadType.Default){return d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.DEFAULT;break $$gen$m0}if(a===d("WAWebThreadUtils").AiThreadType.Incognito){return d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.INCOGNITO;break $$gen$m0}if(a===d("WAWebThreadUtils").AiThreadType.Unknown){return d("WAWebProtobufsAICommon.pb").AIThreadInfo$AIThreadClientInfo$AIThreadType.UNKNOWN;break $$gen$m0}throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+a)}}g.getAiThreadTypeFromProto=a;g.getProtoTypeFromAiThreadType=b}),98);
__d("WAWebThreadsMetadataProtoUtils",["WALogger","WAWebAiThreadTypeUtils","WAWebBotGating","WAWebE2EProtoUtils","WAWebProtobufsE2E.pb","WAWebThreadUtils","err"],(function(a,b,c,d,e,f,g){var h,i;function j(a){if(a.threadKey==null||!d("WAWebBotGating").isAiChatThreadsInfraEnabled())return null;a=d("WAWebE2EProtoUtils").protobufToMsgKey(a.threadKey);return d("WAWebThreadUtils").getThreadIDfromType(a,d("WAWebThreadUtils").ThreadType.AiThread)}function k(a){var b=a.clientInfo;a=a.serverInfo;if(b==null||b.type==null)return null;if(a==null)return null;a=a.title;if(a==null)return null;b=d("WAWebAiThreadTypeUtils").getAiThreadTypeFromProto(b.type);return d("WAWebThreadUtils").getAiThreadInfoFromType(a,b)}function a(a,b){var e;if((b==null?void 0:b.threadId)!=null){var f=[],g=new Set();for(var l of b.threadId){var m=l.threadType;if(m!=null){if(g.has(m)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseThreadsMetadataProto: Duplicate threadType detected. threadType: ",""])),m).sendLogs("parse-threads-metadata-duplicate-thread-type");throw c("err")("Duplicate ThreadType")}var n=null;$$gen$m0:{if(m===d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.VIEW_REPLIES)break $$gen$m0;if(m===d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.AI_THREAD){n=j(l);break $$gen$m0}if(m===d("WAWebProtobufsE2E.pb").ThreadID$ThreadType.UNKNOWN){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseThreadsMetadataProto: Unknown threadType detected. threadType: ",""])),m);continue;break $$gen$m0}throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+m)}n!=null&&(f.push(n),g.add(m))}}a.threadIds=f}if((b==null||(e=b.botMetadata)==null?void 0:e.botThreadInfo)!=null){n=k(b.botMetadata.botThreadInfo);n!=null&&(a.aiThreadInfo=n)}}g.parseThreadsMetadataProto=a}),98);
__d("WACcToIso",[],(function(a,b,c,d,e,f){a=[];a[34]="ES";a[49]="DE";a[52]="MX";a[44]="GB";a[966]="SA";a[39]="IT";a[93]="AF";a[355]="AL";a[213]="DZ";a[376]="AD";a[244]="AO";a[54]="AR";a[374]="AM";a[297]="AW";a[61]="AU";a[43]="AT";a[994]="AZ";a[973]="BH";a[880]="BD";a[375]="BY";a[32]="BE";a[501]="BZ";a[229]="BJ";a[975]="BT";a[591]="BO";a[387]="BA";a[267]="BW";a[55]="BR";a[246]="IO";a[673]="BN";a[359]="BG";a[226]="BF";a[257]="BI";a[225]="CI";a[855]="KH";a[237]="CM";a[238]="CV";a[236]="CF";a[235]="TD";a[56]="CL";a[86]="CN";a[57]="CO";a[269]="KM";a[242]="CG";a[243]="CD";a[682]="CK";a[506]="CR";a[385]="HR";a[53]="CU";a[599]="CW";a[357]="CY";a[420]="CZ";a[45]="DK";a[253]="DJ";a[593]="EC";a[20]="EG";a[503]="SV";a[240]="GQ";a[291]="ER";a[372]="EE";a[251]="ET";a[298]="FO";a[679]="FJ";a[358]="FI";a[33]="FR";a[594]="GF";a[689]="PF";a[241]="GA";a[220]="GM";a[995]="GE";a[233]="GH";a[350]="GI";a[30]="GR";a[299]="GL";a[590]="GP";a[502]="GT";a[224]="GN";a[245]="GW";a[592]="GY";a[509]="HT";a[504]="HN";a[852]="HK";a[36]="HU";a[354]="IS";a[91]="IN";a[62]="ID";a[98]="IR";a[964]="IQ";a[353]="IE";a[972]="IL";a[81]="JP";a[962]="JO";a[254]="KE";a[965]="KW";a[996]="KG";a[856]="LA";a[371]="LV";a[961]="LB";a[266]="LS";a[231]="LR";a[218]="LY";a[423]="LI";a[370]="LT";a[352]="LU";a[853]="MO";a[389]="MK";a[261]="MG";a[265]="MW";a[60]="MY";a[960]="MV";a[223]="ML";a[356]="MT";a[692]="MH";a[596]="MQ";a[222]="MR";a[230]="MU";a[691]="FM";a[373]="MD";a[377]="MC";a[976]="MN";a[382]="ME";a[212]="MA";a[258]="MZ";a[95]="MM";a[264]="NA";a[674]="NR";a[977]="NP";a[31]="NL";a[687]="NC";a[64]="NZ";a[505]="NI";a[227]="NE";a[234]="NG";a[683]="NU";a[672]="NF";a[850]="KP";a[47]="NO";a[968]="OM";a[92]="PK";a[680]="PW";a[970]="PS";a[507]="PA";a[675]="PG";a[595]="PY";a[51]="PE";a[63]="PH";a[48]="PL";a[351]="PT";a[974]="QA";a[40]="RO";a[7]="RU";a[250]="RW";a[262]="RE";a[508]="PM";a[685]="WS";a[378]="SM";a[221]="SN";a[381]="RS";a[248]="SC";a[232]="SL";a[65]="SG";a[421]="SK";a[386]="SI";a[677]="SB";a[252]="SO";a[27]="ZA";a[82]="KR";a[211]="SS";a[94]="LK";a[249]="SD";a[597]="SR";a[268]="SZ";a[46]="SE";a[41]="CH";a[963]="SY";a[239]="ST";a[886]="TW";a[992]="TJ";a[255]="TZ";a[66]="TH";a[670]="TL";a[228]="TG";a[676]="TO";a[216]="TN";a[90]="TR";a[993]="TM";a[256]="UG";a[380]="UA";a[971]="AE";a[1]="US";a[598]="UY";a[998]="UZ";a[678]="VU";a[58]="VE";a[84]="VN";a[681]="WF";a[967]="YE";a[260]="ZM";a[263]="ZW";a[383]="XK";b=a;f["default"]=b}),66);
__d("WAWebCountryCodeUtils",["WACcToIso","WALogger","WAPhoneFindCC","WAWebCountriesUtils","WAWebLidMigrationUtils","WAWebMexUsersGetCountryCode","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){var h;function i(a){a=d("WAPhoneFindCC").findCC(a);a=parseInt(a,10);a=c("WACcToIso")[a];return c("nullthrows")(a)}function j(a){a=(a=d("WAWebLidMigrationUtils").toPn(a))==null?void 0:a.user;if(a!=null)try{return d("WAWebCountriesUtils").asISOCountryCode(i(a))}catch(a){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["failed to get country code from pn, error: ",""])),a).sendLogs("failed-to-get-country-code-from-pn",{sampling:.01})}return null}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=j(a);return b!=null?b:d("WAWebMexUsersGetCountryCode").getMexUserCountryCode(a)});return k.apply(this,arguments)}g.pnToCountryCodeString=i;g.getCountryCodeFromPn=j;g.getUsernameCountryCodeFromPnOrServer=a}),98);
__d("WAWebBizUpdateVerifiedInfoAction",["WAWebApiVerifiedBusinessName","WAWebBackendApi","WAWebHandlePrivacyModeUpdateMsgAction","WAWebQueryExistsJob","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.name,e=b.level,f=b.isApi,g=b.isSmb,h=b.serial;b=b.privacyMode;b!=null&&(yield d("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(a,b,{bypassVerifiedNameUpdate:!0}));d("WAWebBackendApi").frontendFireAndForget("updateContactWithVerifiedName",{contactId:a,verifiedNameInfo:{id:a,name:c,level:e,isApi:f,isSmb:g,privacyMode:b}});yield d("WAWebApiVerifiedBusinessName").createOrUpdateVerifiedBusinessNameLidAware(a,{level:e,serial:h,name:c,isApi:f,isSmb:g,privacyMode:b?{actualActors:b.actualActors,hostStorage:b.hostStorage,privacyModeTs:b.privacyModeTs}:null})});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("WAWebQueryExistsJob").queryWidExists(a));if(b==null)return;b=b.bizInfo;b&&(yield h(a,b.verifiedName))});return j.apply(this,arguments)}g.updateVerifiedInfo=h;g.queryAndUpdateContactPropertiesOnNewChat=a}),98);
__d("WAWebHandlePrivacyModeUpdateMsgAction",["Promise","WAWebApiChat","WAWebApiVerifiedBusinessName","WAWebBackendApi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f;e===void 0&&(e={});if(!a.isUserNotPSA()||a.isCAPISupportAccount())return;var g=(yield j(a,e.chat));if(g==null)return;if(g.isBusiness===!1)return;if(g.privacyMode==null&&c==null)return;if(g.privacyMode!=null&&c!=null&&g.privacyMode.privacyModeTs>=c.privacyModeTs)return;var i=e;i=i.bypassVerifiedNameUpdate;i=i===void 0?!1:i;f={isBusiness:(f=g.isBusiness)!=null?f:!1,privacyMode:g.privacyMode};g={isBusiness:!0,privacyMode:c};a.isUser()&&d("WAWebBackendApi").frontendFireAndForget("updateBusinessInfo",{contactId:a,businessInfo:{isBusiness:!0,isEnterprise:!0,privacyMode:c}});yield (h||(h=b("Promise"))).all([i?null:d("WAWebApiVerifiedBusinessName").createOrUpdateVerifiedBusinessNameLidAware(a,{isApi:!0,isSmb:!1,privacyMode:c?{actualActors:c.actualActors,hostStorage:c.hostStorage,privacyModeTs:c.privacyModeTs}:null},d("WAWebApiVerifiedBusinessName").VerifiedBusinessNameUpdateType.Merge),d("WAWebBackendApi").frontendFireAndForget("generateAndUpdatePrivacySystemMessages",{wid:a,previousState:f,currentState:g,shouldRunMATonWid:e.shouldRunMATonWid})])});return i.apply(this,arguments)}function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c!=null){var e=c.contact.isBusiness;return{isBusiness:e,privacyMode:e?c.contact.privacyMode:null}}e=(yield (h||(h=b("Promise"))).all([d("WAWebApiChat").getChatRecord(a),d("WAWebApiVerifiedBusinessName").getVerifiedBusinessNameRecordLidAware(a)]));c=e[0];a=e[1];if(c==null)return null;return a==null?{isBusiness:null}:{isBusiness:!0,privacyMode:a.privacyMode==null?null:d("WAWebApiVerifiedBusinessName").convertPrivacyModeFromStorageType(a.privacyMode)}});return k.apply(this,arguments)}g.handlePrivacyModeTransition=a;g.getChatInfo=j}),98);
__d("WAWebPrimaryFeaturesModel",["WAWebBaseModel"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,e=new Array(c),f=0;f<c;f++)e[f]=arguments[f];return(b=a.call.apply(a,[this].concat(e))||this,b.features=d("WAWebBaseModel").prop(),b.ddmSettings=d("WAWebBaseModel").prop(!1),b.clearAndDeleteChatSync=d("WAWebBaseModel").prop(!1),b.viewOnceSpReceiver=d("WAWebBaseModel").prop(!1),b.recentSticker=d("WAWebBaseModel").prop(!1),b.favoriteSticker=d("WAWebBaseModel").prop(!1),b.linkPreview=d("WAWebBaseModel").prop(!1),b.hqLinkPreview=d("WAWebBaseModel").prop(!1),b.pollCreationInCags=d("WAWebBaseModel").prop(!1),b.newsletter=d("WAWebBaseModel").prop(!1),b.externalWebBetaOptIn=d("WAWebBaseModel").prop(!1),b.historySyncOnDemand=d("WAWebBaseModel").prop(!1),b.extendedHistorySyncOnDemand=d("WAWebBaseModel").prop(!1),b.webLinkPreviewNseSupport=d("WAWebBaseModel").prop(!1),b.messagePlaceholderResendNseSupport=d("WAWebBaseModel").prop(!1),b.isPrimaryBetaBuild=d("WAWebBaseModel").prop(!1),b.primaryCampaignIdInHistorySyncSupport=d("WAWebBaseModel").prop(!1),b.contactManagement=d("WAWebBaseModel").prop(!1),b.paymentInfoSyncSupport=d("WAWebBaseModel").prop(!1),b.customPaymentMethodsSyncSupport=d("WAWebBaseModel").prop(!1),b.merchantPaymentPartnerSyncSupport=d("WAWebBaseModel").prop(!1),b.paymentTosSyncSupport=d("WAWebBaseModel").prop(!1),b.companionLidContactChangeEnabled=d("WAWebBaseModel").prop(!1),b.isContactsBackupOn=d("WAWebBaseModel").prop(!1),b.primaryHasAddressbookPermission=d("WAWebBaseModel").prop(!1),b.primaryHasAgreedToNativeContactsNux=d("WAWebBaseModel").prop(!1),b.isAccountIntegrityStatePending=d("WAWebBaseModel").prop(!1),b.isAccountIntegrityStateTimelock=d("WAWebBaseModel").prop(!1),b.isGalaxyFlowCompanionSyncSupported=d("WAWebBaseModel").prop(!1),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.setPrimaryFeatures=function(a){this.features=a;a=new Set(a);this.ddmSettings=a.has("ddm_settings");this.clearAndDeleteChatSync=a.has("clear_and_delete_chat_sync");this.viewOnceSpReceiver=a.has("vo_sp_receiver");this.recentSticker=a.has("recent_sticker");this.favoriteSticker=a.has("favorite_sticker");this.linkPreview=a.has("link_preview");this.hqLinkPreview=a.has("link_preview_hq_thumbnail");this.pollCreationInCags=a.has("poll_creation_cag");this.newsletter=a.has("newsletter");this.externalWebBetaOptIn=a.has("external_web_beta_opt_in");this.historySyncOnDemand=a.has("history_sync_on_demand");this.extendedHistorySyncOnDemand=a.has("is_extended_history_sync_on_demand_enabled");this.webLinkPreviewNseSupport=a.has("web_link_preview_nse_support");this.messagePlaceholderResendNseSupport=a.has("message_placeholder_resend_nse_support");this.isPrimaryBetaBuild=a.has("is_primary_beta_build");this.primaryCampaignIdInHistorySyncSupport=a.has("primary_campaign_id_in_history_sync_support");this.contactManagement=a.has("contact_management");this.paymentInfoSyncSupport=a.has("payment_info_sync_support");this.customPaymentMethodsSyncSupport=a.has("custom_payment_methods_sync_support");this.isContactsBackupOn=a.has("is_contacts_backup_on");this.primaryHasAddressbookPermission=a.has("primary_has_addressbook_permission");this.primaryHasAgreedToNativeContactsNux=a.has("primary_has_agreed_to_native_contacts_nux");this.isAccountIntegrityStatePending=a.has("is_account_integrity_state_pending");this.isAccountIntegrityStateTimelock=a.has("is_account_integrity_state_timelock");this.merchantPaymentPartnerSyncSupport=a.has("merchant_payment_partner_sync_support");this.paymentTosSyncSupport=a.has("payment_tos_sync_support");this.isGalaxyFlowCompanionSyncSupported=a.has("is_galaxy_flow_companion_sync_supported");this.companionLidContactChangeEnabled=a.has("companion_lid_contact_change_enabled")};return b}(d("WAWebBaseModel").BaseModel);a.Proxy="primaryFeatures";b=d("WAWebBaseModel").defineModel(a);c=new b({id:"1"});g.PrimaryFeatures=c}),98);
__d("WAWebComposeBoxActions",["WAWebEventEmitter","WAWebStateUtils"],(function(a,b,c,d,e,f,g){a=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.$ComposeBoxActionsImpl$p_1=!1,b.$ComposeBoxActionsImpl$p_2=!1,babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.focus=function(a){a=d("WAWebStateUtils").unproxy(a);a?this.trigger("focus_"+a.id.toString()):this.trigger("focus")};c.send=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("send_"+a.id.toString())};c.paste=function(a,b,c){if(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("paste_"+a.id.toString(),b,c)}else this.trigger("paste",b,c)};c.sendPaste=function(a,b){a=d("WAWebStateUtils").unproxy(a);this.trigger("send_paste_"+a.id.toString(),b)};c.pasteFiles=function(a,b){a=d("WAWebStateUtils").unproxy(a);this.trigger("paste_files_"+a.id.toString(),b)};c.toggleQuickReplies=function(){this.trigger("toggle_quick_replies")};c.addMsgSendingLogAttributes=function(a,b){this.trigger("add_sending_log_attributes_"+a.id.toString(),b)};c.setCtwaContextLinkData=function(a,b){this.trigger("set_ctwa_context_link_data_"+a.id.toString(),b)};c.setTextContent=function(a,b){this.trigger("set_text_content_"+a.id.toString(),b)};c.setIsFocus=function(a){this.$ComposeBoxActionsImpl$p_1=a};c.setHasText=function(a){this.$ComposeBoxActionsImpl$p_2=a};c.isFocused=function(){return this.$ComposeBoxActionsImpl$p_1};c.hasText=function(){return this.$ComposeBoxActionsImpl$p_2};return b}(c("WAWebEventEmitter"));b=new a();g.ComposeBoxActions=b}),98);
__d("WAWebDocumentFlushed",["Promise","WAAbortError","once"],(function(a,b,c,d,e,f,g){var h,i=[],j=c("once")(function(){return new AbortController().signal});function k(){while(i.length>0){var a=i.shift();a()}}function l(){var a,b=window.requestAnimationFrame(function(){a=self.setTimeout(function(){k()},0)});return function(){window.cancelAnimationFrame(b),self.clearTimeout(a)}}function a(a){var c=(a=a==null?void 0:a.signal)!=null?a:j();return new(h||(h=b("Promise")))(function(a,b){if(c.aborted){b(new(d("WAAbortError").AbortError)());return}var e;function f(){c.removeEventListener("abort",h);var a=i.indexOf(g);a!==-1&&i.splice(a,1);i.length===0&&e!=null&&(e(),e=null)}function g(){f(),a()}function h(){f(),b(new(d("WAAbortError").AbortError)())}i.push(g);c.addEventListener("abort",h);i.length===1&&(e=l())})}e=function(){k();return(h||(h=b("Promise"))).resolve()};g.documentFlushed=a;g.resolveAllForTestingOnly=e}),98);
__d("WAWebMain.scss",["cx"],(function(a,b,c,d,e,f,g,h){a={"-viewport-width-stop-xl":"1300px;","-viewport-width-stop-l":"1024px;","-viewport-width-stop-m":"900px;",paneThree:"_aig-",app:"_aigs",skipGlobalPaneStyles:"_as6h",paneOne:"_aigw",skipPaneWidthStyles:"_asu3",paneThreeWithNavBarExpanded:"_as5a"};b=a;g["default"]=b}),98);
__d("WAWebStylePropertiesDeprecated",[],(function(a,b,c,d,e,f){function g(a,b){return a[b]}function a(a,b){return parseInt(g(a,b),10)}function b(a,b){return parseFloat(g(a,b))}f.getIntFromStylesProp=a;f.getFloatFromStylesProp=b}),66);
__d("WAWebDrawerManager",["Promise","WAWebEventEmitter","WAWebMain.scss","WAWebStylePropertiesDeprecated"],(function(a,b,c,d,e,f,g){var h,i=d("WAWebStylePropertiesDeprecated").getIntFromStylesProp(c("WAWebMain.scss"),"-viewport-width-stop-xl");a=function(a){function c(){return a.apply(this,arguments)||this}babelHelpers.inheritsLoose(c,a);var d=c.prototype;d.setDrawerContext=function(a,b){this.trigger("update_context_"+a,b)};d.openDrawerRight=function(a,b){this.trigger("open_drawer_right",a,b)};d.openDrawerMid=function(a,b){this.trigger("open_drawer_mid",a,b)};d.openDrawerLeft=function(a,b){this.trigger("open_drawer_left",a,b)};d.existsDrawerRight=function(a){this.trigger("exists_drawer_right",a)};d.existsDrawerMid=function(a){this.trigger("exists_drawer_mid",a)};d.existsDrawerLeft=function(a){this.trigger("exists_drawer_left",a)};d.closeDrawerRight=function(){this.trigger("close_drawer_right")};d.closeDrawerMid=function(){this.trigger("close_drawer_mid")};d.closeDrawerLeft=function(){this.trigger("close_drawer_left")};d.focusDrawerLeft=function(){this.trigger("focus_drawer_left")};d.focusDrawerMid=function(){this.trigger("focus_drawer_mid")};d.focusDrawerRight=function(){this.trigger("focus_drawer_right")};d.isDrawerRightOverlappingCoversationPanel=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.existsDrawerRight(function(a){b(a&&window.matchMedia("(max-width: "+i+"px)").matches)})})};return c}(c("WAWebEventEmitter"));e=new a();g.DrawerManager=e}),98);
__d("WAWebWamEnumSurfaceType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT:1,CHATLIST:2,GALLERY:3,COMMUNITY_HOME:4,COMMUNITY_TAB:5,COMMUNITY_NAV:6,COMMUNITY_NAV_SHEET:7,COMMUNITY_SETTINGS:8,GROUP_INFO:9,NOTIFICATION:10,EXPRESSIONS_EMOJI:11,INVITE_NON_WA_CONTACT:12,CHAT_INFO_PAGE:13,NOTES_PROMPT:14,CHAT_THREAD:15,SEARCH_FILTER:16,TOOL_LIST_ITEM:17,GEN_AI_AGENT_NUX_SCREEN:18,GEN_AI_AGENT_NUX_TOS_SCREEN:19,GEN_AI_AGENT_NUX_BIZ_INFO_SCREEN:20,GEN_AI_AGENT_NUX_AUTHENTICATION_SCREEN:21,GEN_AI_MORE_BIZ_INFO_SCREEN:22,GEN_AI_AUTOMATIC_REPLIES_SCREEN:23,GEN_AI_COMMON_QUESTIONS_SCREEN:24,GEN_AI_READY_SCREEN:25,OVERFLOW_MENU:26,BROADCAST_LIST_LANDING_PAGE:27,BANNER_FROM_EXISTING_BCL:28,BANNER_FROM_NEW_BCL:29,COMPOSER:30,CONFIRM_EXIT_NOTE_DIALOGUE:31,VERIFY_EMAIL:32,EMAIL_VERIFICATION_CODE_SEND_ERROR_PROMPT:33,INCORRECT_EMAIL_VERIFICATION_CODE_PROMPT:34,EMAIL_CODE_VERIFICATION_ERROR_PROMPT:35,EMAIL_VERIFICATION:36,NOT_MY_EMAIL_PROMPT:37,REMOVE_EMAIL_ERROR_PROMPT:38,REMOVE_EMAIL:39,STICKER_TRAY_IN_CHAT:40,STICKER_SEARCH_CHAT:41,BUSINESS_HOME_PAGE:42,BROADCAST_LIST_AUDIENCE_PAGE:43,GEN_AI_WEB_ONBOARDING_EDUCATION:44,GEN_AI_WEB_ONBOARDING_QR_CODE:45,GEN_AI_WEB_ONBOARDING_SUCCESS:46,GEN_AI_SETTINGS_HOME_SCREEN:47,GEN_AI_SETTINGS_ADDITIONAL_BIZ_INFO_SCREEN:48,GEN_AI_SETTINGS_ADDITIONAL_BIZ_INFO_EDIT_SCREEN:49,GEN_AI_SETTINGS_BIZ_INFO_SCREEN:50,GEN_AI_SETTINGS_BIZ_INFO_EDIT_SCREEN:51,GEN_AI_SETTINGS_AUTO_REPLY_SCREEN:52,GEN_AI_SETTINGS_ATUO_REPLY_TYPE_EDIT_SCREEN:53,GEN_AI_SETTINGS_AUTO_REPLY_TIME_EDIT_SCREEN:54,GEN_AI_SETTINGS_FAQ_SCREEN:55,GEN_AI_SETTINGS_FAQ_EDIT_INFO_SCREEN:56,GEN_AI_SETTINGS_ADD_NEW_CONTACT_SCREEN:57,GEN_AI_SETTINGS_ADD_NEW_BUSINESS_INFO:58,GEN_AI_SETTINGS_DISCONNECT:59,ACCOUNT_SETTINGS:60,CREATE_BIZ_PROFILE:61,CREATE_PASS_KEY:62,ADD_EMAIL:63,VERIFY_NEW_EMAIL:64,INITIALIZING_ACCOUNT:65,GEN_AI_SETTINGS_DYI:66,GEN_AI_SETTINGS_LEAD_GEN_QUESTIONS:67,CATALOG_MANAGER:68,CATALOG_SETTINGS:69,FB_ACCOUNT_CONFIRMATION_BOTTOM_SHEET:70,CONNECT_CATALOG_SELECTION:71,REPLACE_CATALOG_CONFIRMATION_PROMPT:72,FB_LOGIN_BOTTOM_SHEET:73,CONNECTED_CATALOG_DETAILS_BOTTOM_SHEET:74,CONFIRM_DISCONNECT_CATALOG_BOTTOM_SHEET:75,GIF_EXPRESSIONS_TRAY:76,BUSINESS_PROFILE_DESCRIPTION_GENAI_LOADING:77,BUSINESS_PROFILE_DESCRIPTION_GENAI:78,SELECT_BIZ_CATEGORY:79,SEARCH_BIZ_CATEGORY_BOTTOM_SHEET:80,ADD_BIZ_HOURS:81,SELECT_BIZ_HOURS_BOTTOM_SHEET:82,ADD_PROFILE_PHOTO:83,ADD_BIZ_DISCOVERY_INFO:84,ADD_BIZ_DESCRIPTION:85,GEN_AI_WEB_ONBOARDING_AUTHENTICATION:86,GEN_AI_COACHING:87,PRODUCT_DETAILS:88,ORIGIN_COUNTRY:89,IMPORTER_INFO:90,IMPORTER_COUNTRY:91,EDIT_BIZ_PROFILE:92,GEN_AI_LEARNING_SUMMARY:93,GEN_AI_KNOWLEDGE_EDIT:94,ADD_ITEM:95,EDIT_ITEM:96,GEN_AI_AI_HUB_CHECKLIST:97,GEN_AI_AI_HUB_CHAT:98,GEN_AI_AI_HUB_HOME:99,GEN_AI_AI_HUB_ADD_BUSINESS_INFO:100,GEN_AI_AI_HUB_ADD_PRODUCT_INFO:101,GEN_AI_AI_HUB_ADD_PURCHASING_INFO:102,GEN_AI_AGENT_EDIT_FIELD_BOTTOM_SHEET:103,GEN_AI_AI_HUB_KNOWLEDGE_REPO:104,CONNECT_CATALOG_NUX_BOTTOM_SHEET:105,GENAI_AGENT_AUTO_REPLY_CONFIRMATION_DIALOG:106,GENAI_AGENT_AUTO_REPLY_ERROR_DIALOG:107,FB_WEB_LOGIN:108,GENAI_AGENT_COACHING_INDICATOR_BOTTOMSHEET:109,WATCH_LEARNING_VIDEO:110,GEN_AI_BESTSELLERS:111,GEN_AI_AI_HUB_KNOWLEDGE_RESOURCE:112,GEN_AI_AI_HUB_SAMPLE_RESPONSE_SELECTION:113,GEN_AI_AI_HUB_SAMPLE_RESPONSE_MANUAL:114,DIRECT_MIGRATION_AVAILABILITY:115,ACCESS_CONTACT_AND_MEDIA_PROMPT:116,ACCESS_CONTACT_PROMPT:117,ACCESS_AUDIO_MEDIA_PROMPT:118,ACCESS_VISUAL_MEDIA_PROMPT:119,NOT_ENOUGH_SPACE_WARNING:120,VERIFY_OTP:121,DIRECT_MIGRATION_IN_PROGRESS:122,DIRECT_MIGRATION_FAILED:123,ACCOUNT_BACKUP_CHECK:124,ACCESS_BACKUP_PERMISSION_PROMPT:125,RESTORE_OR_TRANFER_CHAT:126,ENTER_PHONE_NUMBER:127,CHECK_USERNAME_AND_PIN:128,CHECK_USERNAME:129,ONBOARDING_USERNAME_UPDATE_TOAST:130,ONBOARDING_USERNAME_PIN_REMOVE_TOAST:131,LABEL_LIST:132,LABEL_DETAILS:133,LABEL_APPLICATION:134,GEN_AI_AGENT_HANDOFF_LIST_CONFIG:135,DOCUMENTS_PICKER:136,DOCUMENTS_PREVIEW:137,GEN_AI_AGENT_CONTROL_LEARNING_BOTTOM_SHEET:138,CHAT_THREAD_CAPPING_NACK_DETAILS:139,CHAT_THREAD_CAPPING_ALERT_CARD:140,MESSAGE_CAPPING_NUX:141,MESSAGE_CAPPING_USAGE_STATS:142,ADVANCED_TOOLS_BOTTOM_SHEET:143,GENAI_AGENT_CHAT_HISTORY_EXPORT:144,GENAI_AGENT_CHAT_HISTORY_EXPORT_NUX:145,BB_HOME:146,BB_THREAD:147,BB_NUX:148,BB_CREDIT_INFO:149,BL_MOVED_TO_BB_BANNER:150,BB_CAMPAIGN_DRAFT:151,BB_ADD_BUTTON_BOTTOM_SHEET:152,BB_WEBSITE_INFO:153,BB_CUSTOM_REPLY_INFO:154,BB_CALL_INFO:155,BB_CATALOG_INFO:156,BB_REVIEW:157,BB_SCHEDULE:158,BB_MV_UPSELL_BOTTOM_SHEET:159,BB_PERM_BANNED:160,BB_TEMP_BANNED:161,BB_BAN_WARNING:162,BB_RECIPIENT_PICKER:163,CHAT_SETTINGS:164,MESSAGE_CAPPING_NUX_FOOTER_UPSELL:165,CHAT_THREAD_CAPPED_COMPOSE_BLOCKER:166,MV_NEW_MESSAGE_CAPPING_EDUCATION:167,MESSAGE_CAPPING_OTE_WITH_REASON_SELECTION:168,LIST_SETTINGS:169,CHAT_LIST_FILTER:170,CHAT_HEADER:171,CHAT_LONG_PRESS_OPTIONS:172,CONTACT_INFO:173,CATALOG_COLLECTION_LIST:174,CATALOG_COLLECTION_REORDER:175,CATALOG_COLLECTION_NAME_BOTTOM_SHEET:176,CATALOG_ADD_COLLECTION_ITEMS:177,CATALOG_COLLECTION_DETAIL:178,CATALOG_COLLECTION_ITEMS_REORDER:179,CATALOG_DELETE_COLLECTION_DIALOG:180,CATALOG_UPDATE_COLLECTION:181,GENAI_AGENT_AI_REPLIES:182,GENAI_AGENT_AI_REPLIES_CONFIRMATION_DIALOG:183,GENAI_AGENT_AI_REPLIES_CHATS:184,GENAI_AGENT_AI_REPLIES_SCHEDULE:185,GEN_AI_PRODUCT_INFO_EDIT:186,GEN_AI_SETTINGS_INCOMPLETE:187,SETTINGS_TAB:188,LIST_DETAILS_SCREEN:189});f.SURFACE_TYPE=a}),66);
__d("WAWebWamEnumWebcRuntimeEnvCode",[],(function(a,b,c,d,e,f){a=Object.freeze({MAIN:1,WEB_WORKER:2,SERVICE_WORKER:3});f.WEBC_RUNTIME_ENV_CODE=a}),66);
__d("WAWebWebcMemoryStatWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcRuntimeEnvCode","WAWebWamEnumWebcScenarioType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({WebcMemoryStat:[1188,{appContext:[26,a.TYPES.STRING],appContextBitfield:[27,a.TYPES.INTEGER],chatCollectionSize:[17,a.TYPES.INTEGER],chatDbSize:[18,a.TYPES.INTEGER],contactCollectionSize:[19,a.TYPES.INTEGER],contactDbSize:[20,a.TYPES.INTEGER],isForeground:[13,a.TYPES.BOOLEAN],jsHeapSizeLimit:[9,a.TYPES.INTEGER],messageCollectionSize:[24,a.TYPES.INTEGER],messageDbSize:[25,a.TYPES.INTEGER],peakUsedJsHeapSize:[14,a.TYPES.INTEGER],scenario:[15,d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE],totalJsHeapSize:[10,a.TYPES.INTEGER],uptime:[6,a.TYPES.NUMBER],usedJsHeapSize:[11,a.TYPES.INTEGER],usedJsHeapSizeDelta:[16,a.TYPES.INTEGER],webcRuntimeEnv:[23,d("WAWebWamEnumWebcRuntimeEnvCode").WEBC_RUNTIME_ENV_CODE]},[1,1,10],"regular"]},{WebcMemoryStat:[]});g.WebcMemoryStatWamEvent=b}),98);
__d("WAWebWamMemoryStat",["Promise","WALogger","WANullthrows","WAShiftTimer","WAWebAppTracker","WAWebBackendApi","WAWebEnvironment","WAWebLidAwareContactsDB","WAWebRuntimeEnvironmentUtils","WAWebSchemaChat","WAWebSchemaMessage","WAWebWamEnumWebcScenarioType","WAWebWebcMemoryStatWamEvent","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){var h,i,j,k,l,m=self.performance.now(),n=!1,o=100,p=0;function q(){var a;a=(a=self.performance)==null?void 0:a.memory;if(!a)return;v=Math.max(v,a.usedJSHeapSize);w+=a.usedJSHeapSize;x++;return{uptime:Math.round((self.performance.now()-m)/1e3),jsHeapSizeLimit:Math.round(a.jsHeapSizeLimit/1e3/1e3),totalJsHeapSize:Math.round(a.totalJSHeapSize/1e3/1e3),usedJsHeapSize:Math.round(a.usedJSHeapSize/1e3/1e3)}}function a(){var a=q();return!a?(l||(l=b("Promise"))).resolve():(l||(l=b("Promise"))).resolve([{label:"Main Window",memory:a.usedJsHeapSize,uptime:a.uptime}])}var r=5e3,s=60,t=2*1024,u=d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE,v=0,w=0,x=0,y;function e(a){try{var b;if(d("WAWebRuntimeEnvironmentUtils").isWorker()||((b=self.performance)==null?void 0:b.memory)==null)return;if(a!==u){if(u!==d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE){(b=y)==null||b.cancel();y=null;void D();m=self.performance.now()}u=a;C()}y==null&&B()}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[MemoryStat] failed to set new scenario: ",""])),a).sendLogs("set-memory-stat-scenario-failed",{sampling:.01})}}var z=null;function f(a){z!=null&&!z.equals(a)&&A(),z=a}function A(){if(d("WAWebRuntimeEnvironmentUtils").isWorker())return;var a=q();if(a==null)return;void I().then(function(b){var c;c=new(d("WAWebWebcMemoryStatWamEvent").WebcMemoryStatWamEvent)(babelHelpers["extends"]({},a,{scenario:d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.CHAT_NAVIGATION,peakUsedJsHeapSize:Math.round(v/1e3/1e3),usedJsHeapSize:Math.round(w/x/1e3/1e3),isForeground:((c=self.document)==null?void 0:c.visibilityState)==="visible"},b,F));d("WAWebAppTracker").attachWAMAppContext(c);c.commit()})}function B(){y=new(d("WAShiftTimer").ShiftTimer)(function(){var a=q();a!=null&&(Math.abs(a.usedJsHeapSize-p)>o&&(p=a.usedJsHeapSize,d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MemoryStat] js heap size: ","Gb"])),(a.usedJsHeapSize/1024).toFixed(2))));u===d("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE&&x!==0&&x%s===0&&(void D(),C());B()}),y.onOrAfter(r)}function C(){v=0,w=0,x=0}function D(){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a,e=(yield (l||(l=b("Promise"))).all([I(),G()])),f=e[0];e=e[1];var g=c("WANullthrows")(q()),h=Math.round(w/x/1e3/1e3);a=new(d("WAWebWebcMemoryStatWamEvent").WebcMemoryStatWamEvent)(babelHelpers["extends"]({},g,{scenario:u,peakUsedJsHeapSize:Math.round(v/1e3/1e3),usedJsHeapSize:h,isForeground:((a=self.document)==null?void 0:a.visibilityState)==="visible"},f,e));d("WAWebAppTracker").attachWAMAppContext(a);a.commit();f=(h/1024).toFixed(2);e=(g.usedJsHeapSize/1024).toFixed(2);a="average: "+f+"Gb, current: "+e+"Gb";if(!n&&h>t){n=!0;g=t/1024;d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[MemoryStat] memory usage exceeded ","Gb: ",""])),g,a).sendLogs("memory-usage-exceeded-"+g+"gb",{sampling:c("WAWebEnvironment").isWindows?1:.001})}else d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[MemoryStat] memory usage: ",""])),a)});return E.apply(this,arguments)}var F=null;function G(){return H.apply(this,arguments)}function H(){H=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (l||(l=b("Promise"))).all([d("WAWebSchemaChat").getChatTable().count(),c("WAWebLidAwareContactsDB").count(),d("WAWebSchemaMessage").getMessageTable().count()])),e=a[0],f=a[1];a=a[2];F={chatDbSize:K(e),contactDbSize:K(f),messageDbSize:K(a)};return F});return H.apply(this,arguments)}function I(){return J.apply(this,arguments)}function J(){J=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("WAWebBackendApi").frontendSendAndReceive("getCollectionSizes"));return{chatCollectionSize:K(a.chat),contactCollectionSize:K(a.contact),messageCollectionSize:K(a.message)}});return J.apply(this,arguments)}function K(a){return a>1e3?Math.round(a/100)*100:Math.round(a/10)*10}g.getMemoryTableRows=a;g.setCurrentMemoryScenario=e;g.uploadMemoryIfChatWasOpened=f;g.uploadMemoryInfoOnChatClose=A;g.roundIntForMetrics=K}),98);
__d("WAWebCmd",["invariant","$InternalEnum","Promise","WAAbortError","WALogger","WAPromiseDelays","WAWebAppTracker","WAWebChatEntryPoint","WAWebComposeBoxActions","WAWebCurrentUser","WAWebDocumentFlushed","WAWebDrawerManager","WAWebEventEmitter","WAWebMsgTunnelBridge","WAWebPageLoadLogging","WAWebStateUtils","WAWebWamMemoryStat","asyncToGeneratorRuntime","err","gkx","lodash"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t;a=b("$InternalEnum").Mirrored(["Sender","Admin"]);e="app_state_sync_completed";var u=400;f=function(a){function e(){var b;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=a.call.apply(a,[this].concat(f))||this,b.isMainLoaded=!1,b.uiBusy=0,b.isMainStreamReadyMd=!1,b.isOfflineDeliveryEnd=!1,b.$CmdImpl$p_3=c("lodash").debounce(function(){b.uiBusy&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["cmd:clearUIBusy uibusy timeout"]))),b.uiBusy=0,b.$CmdImpl$p_4())},1e3,{maxWait:5e3}),b.$CmdImpl$p_4=w(function(){b.uiBusy===0||h(0,75716,b.uiBusy);if(b.uiBusy!==0)return;b.$CmdImpl$p_3.cancel();b.trigger("ui_idle")}),babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(e,a);var f=e.prototype;f.mainLoaded=function(){this.isMainLoaded=!0,this.trigger("main_loaded")};f.initialLoadReady=function(){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Cmd: initialLoadReady"]))),this.trigger("initial_load_ready")};f.logSocketSummary=function(){this.trigger("log_socket_summary")};f.muteAllReactions=function(a,b,c){this.trigger("mute_all_reactions",a,b,c)};f.muteChat=function(a,b,c,e){this.trigger("mute_chat",d("WAWebStateUtils").unproxy(a),b,c,e)};f.muteChatMultiselect=function(a,b,c){this.trigger("mute_chat_multiselect",a,b,c)};f.muteChatFromEntryPoint=function(a,b,c,e){this.trigger("mute_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c,e)};f.assignChat=function(a,b){this.trigger("assign_chat",d("WAWebStateUtils").unproxy(a),b)};f.deleteOrExitChat=function(a,b){this.trigger("delete_or_exit_chat",d("WAWebStateUtils").unproxy(a),b)};f.deleteOrExitChatFromEntryPoint=function(a,b,c){this.trigger("delete_or_exit_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c)};f.clearChat=function(a,b){this.trigger("clear_chat",d("WAWebStateUtils").unproxy(a),b)};f.clearSelectedChats=function(a,b){this.trigger("clear_selected_chats",a.map(function(a){return d("WAWebStateUtils").unproxy(a)}),b)};f.archiveChat=function(a,b,c){c===void 0&&(c=!0),this.trigger("archive_chat",d("WAWebStateUtils").unproxy(a),b,c)};f.archiveChatFromEntryPoint=function(a,b,c,e){e===void 0&&(e=!0),this.trigger("archive_chat_from_entrypoint",d("WAWebStateUtils").unproxy(a),b,c,e)};f.pinChat=function(a,b){this.trigger("pin_chat",d("WAWebStateUtils").unproxy(a),b)};f.favoriteChat=function(a,b,c){this.trigger("favorite_chat",d("WAWebStateUtils").unproxy(a),b,c)};f.markChatUnread=function(a,b){this.trigger("mark_chat_unread",d("WAWebStateUtils").unproxy(a),b)};f.msgInfoDrawer=function(a){this.trigger("msg_info_drawer",d("WAWebStateUtils").unproxy(a))};f.chatSearch=function(a){this.trigger("chat_search",d("WAWebStateUtils").unproxy(a))};f.scrollChatHeight=function(a){this.trigger("scroll_chat_by_height",a)};f.ctwaAdPreviewDrawer=function(a,b,c){this.trigger("ctwa_ad_preview_drawer",d("WAWebStateUtils").unproxy(a),b,c)};f.galaxyFlowDrawer=function(a){var b=a.chat,c=a.messageData,d=a.msg;a=a.onClose;this.trigger("galaxy_flows_drawer",b,c,d,a)};f.chatInfoDrawer=function(a,b){this.trigger("chat_info_drawer",d("WAWebStateUtils").unproxy(a),b==null?void 0:b.showFullGroupDescription,b==null?void 0:b.scrollToParticipantList,b==null?void 0:b.sourceGroupChatOrNewsletter,b==null?void 0:b.focusNewsletterDescriptionOnMount,b==null?void 0:b.focusGroupSubjectOnMount,b==null?void 0:b.focusGroupDescriptionOnMount)};f.openCurrentChatInfo=function(){this.trigger("open_current_chat_info")};f.blockCurrentChat=function(){this.trigger("block_current_chat")};f.clearCurrentChatConversationHistory=function(){this.trigger("clear_current_chat_conversation_history")};f.exitCurrentGroup=function(){this.trigger("exit_current_group")};f.replyCurrentMessage=function(){this.trigger("reply_current_message")};f.replyCurrentMessagePrivate=function(){this.trigger("reply_current_message_private")};f.forwardCurrentMessage=function(){this.trigger("forward_current_message")};f.starCurrentMessage=function(){this.trigger("star_current_message")};f.startPttRecording=function(){this.trigger("start_ptt_recording")};f.pausePttRecording=function(){this.trigger("pause_ptt_recording")};f.sendPttRecording=function(){v.trigger("send_ptt_recording")};f.editGroupDescription=function(){this.trigger("edit_group_description")};f.attachMediaDrawer=function(a){var b=d("WAWebStateUtils").unproxy(a.chat),c=function(c){c.length>0&&d("WAWebComposeBoxActions").ComposeBoxActions.setTextContent(b,c.join("\n\n")),a.onCancel==null||a.onCancel()};if(b.id.isBot())return;c=babelHelpers["extends"]({},a,{chat:b,onCancel:c});this.trigger("attach_media_drawer",c)};f.attachProduct=function(a){this.trigger("attach_product",a)};f.verificationDrawer=function(a){this.trigger("verification_drawer",a)};f.mediaViewerModal=function(a){var b=a.msg,c=a.getZoomNode,d=a.currentTime,e=a.highlightedMsgIds,f=a.shouldShowNumberText;a=a.shouldShowAllMedia;this.trigger("media_viewer_modal",{msg:b,getZoomNode:c,currentTime:d,highlightedMsgIds:e,shouldShowNumberText:f,shouldShowAllMedia:a})};f.openMediaViewerForAlbumMedia=function(a){this.trigger("open_media_viewer_for_album_media",a)};f.productImageViewerModal=function(a,b){this.trigger("product_image_viewer_modal",a,b)};f.ephemeralDrawer=function(a,b,c){this.trigger("ephemeral_drawer",a,b,c)};f.openCommunityHome=function(a,b){this.trigger("open_community_home",a,b)};f.openCommunityTabbedInfo=function(a,b,c,d){this.trigger("open_community_tabbed_info",a,b,c,d)};f.openCommunityPendingGroupsDrawer=function(a){this.trigger("open_community_pending_groups_drawer",a)};f.openCommunityHomeManageGroups=function(a){this.trigger("open_community_home_manage_groups",a)};f.openCommunitySettingsDrawer=function(a){this.trigger("open_community_settings_drawer",a)};f.openCommunitySubgroupJoinModal=function(a,b){this.trigger("open_subgroup_join_modal",a,b)};f.openProfile=function(a){this.trigger("open_profile",a)};f.communityAddNewGroup=function(a,b,c){this.trigger("open_community_add_new_group",a,b,c)};f.openCreatedNewsletter=function(a){this.trigger("open_created_newsletter",a)};f.openNewsletterProfile=function(a,b){this.trigger("open_newsletter_profile",a,b)};f.editNewsletterDescription=function(){this.trigger("edit_newsletter_description")};f.openEventInfoDrawer=function(a,b,c,d){this.trigger("open_event_info_drawer",a,b,c,d)};f.sendStarMsgs=function(a,b,c,e){this.trigger("send_star_msgs",d("WAWebStateUtils").unproxy(a),b,c,e)};f.sendUnstarMsgs=function(a,b,c,e){this.trigger("send_unstar_msgs",d("WAWebStateUtils").unproxy(a),b,c,e)};f.sendDeleteMsgs=function(a,b,c,e,f,g){this.trigger("send_delete_msgs",d("WAWebStateUtils").unproxy(a),b,c,e,f,g)};f.sendRevokeMsgs=function(a,b,c){this.trigger("send_revoke_msgs",d("WAWebStateUtils").unproxy(a),b,c)};f.$CmdImpl$p_1=function(a,c,e){var f=this;e===void 0&&(e=d("WAWebChatEntryPoint").ChatEntryPoint.Unknown);var g=d("WAWebStateUtils").unproxy(a);g.chatEntryPoint=e;d("WAWebMsgTunnelBridge").msgSyncTunnelBridge.setActiveChat(g.id);d("WAWebWamMemoryStat").uploadMemoryIfChatWasOpened(g.id);return new(t||(t=b("Promise")))(function(a){f.trigger("open_chat",g,c,e,function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){(yield d("WAWebDrawerManager").DrawerManager.isDrawerRightOverlappingCoversationPanel())&&d("WAWebDrawerManager").DrawerManager.closeDrawerRight(),a(b)});return function(a){return c.apply(this,arguments)}}())})["catch"](function(a){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Unexpected openChat error: ",""])),String(a));throw a})};f.openChatAt=function(a){var c=this,e=a.chat,f=a.msgContext,g=a.chatEntryPoint,h=a.onSuccess;a=d("WAWebStateUtils").unproxy(e);if(!f)return this.openChatBottom(a,g);this.setUiBusy(!0);e=this.$CmdImpl$p_1(a,f,g).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var d,e,g=f.enableAnimation!=null?f.enableAnimation:!0;if(a)if(a.wasVisible)d=function(){return c.$CmdImpl$p_2({pos:"offset",offset:a.offset})},e=function(){return c.$CmdImpl$p_2({pos:"center",animate:g,duration:u,easing:[.7,0,.3,1]})};else{d=function(){return c.$CmdImpl$p_2({pos:a.alignAt,scrollIfNeeded:!0})};switch(a.alignAt){case"top":case"bottom":e=function(){return c.$CmdImpl$p_2({pos:"center",animate:g,duration:u,easing:[.88,.64,.13,.99]})};break;case"center":default:e=function(){return(t||(t=b("Promise"))).resolve()}}}else d=function(){return c.$CmdImpl$p_2({pos:"center"})},e=function(){return(t||(t=b("Promise"))).resolve()};yield d();return e()});return function(b){return a.apply(this,arguments)}}()).then(function(){var a;if((f==null||(a=f.msg)==null?void 0:a.botPluginReferenceIndex)!=null){var b,d=f==null||(b=f.msg)==null?void 0:b.botResponseTargetId;d!=null&&c.botTogglePluginSearchDetailsToggle(d,!0)}(f==null?void 0:f.highlightMsg)===!0&&c.flashFocusedMsg(f.highlightMentionMsg)}).then(function(){if(h){var a=h.mediaMsgToOpenInMediaViewer,b=h.onScrollToQuotedCarouselCard;a&&void d("WAPromiseDelays").delayMs(500).then(function(){v.openMediaViewerForAlbumMedia(d("WAWebStateUtils").unproxy(a)),b==null||b()})}return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));e["finally"](function(){c.setUiBusy(!1)});return e};f.openChatFromUnread=function(a,e){var f=this;a=d("WAWebStateUtils").unproxy(a);if(!c("gkx")("26258")){window.chat=a;var g=a.unreadMsgAnchor&&a.unreadMsgAnchor.id.toString()||"No unreadMsgAnchor found";d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["openChatFromUnread with chat unreadMsgAnchor: ",",  chat unreadCount:  ",""])),g,a.unreadCount)}var h;a.unreadMsgAnchor&&(h={collection:a.unreadMsgAnchor.msgChunk,promise:(t||(t=b("Promise"))).resolve(),msg:a.unreadMsgAnchor,isUnreadDivider:a.shouldShowUnreadDivider()});if(h||a.unreadCount>0){this.setUiBusy(!0);g=this.$CmdImpl$p_1(a,h,e).then(function(){return f.$CmdImpl$p_2({pos:"top",offset:-120})}).then(function(){return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));g["finally"](function(){f.setUiBusy(!1)});return g}return this.openChatBottom(a,e)};f.openChatBottom=function(a,b){var c=this;a=d("WAWebStateUtils").unproxy(a);d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["openChatBottom"])));a.id.isLid()&&d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["openChatBottom. entry point: ",""])),b);this.setUiBusy(!0);var e;a.msgs.length>0&&(e={collection:a.msgs,msg:a.msgs.last(),isUnreadDivider:!1});a=this.$CmdImpl$p_1(a,e,b).then(function(){return c.scrollChatToBottom()}).then(function(){return!0})["catch"](d("WAAbortError").catchAbort(function(){return!1}));a["finally"](function(){c.setUiBusy(!1)});return a};f.$CmdImpl$p_2=function(a){var c=this;return new(t||(t=b("Promise")))(function(b){c.trigger("scroll_to_focused_msg",b,a)})["catch"](function(a){d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Unexpected_scrollToFocusedMsg error: ",""])),String(a))})};f.scrollChatToBottom=function(){var a=this;return new(t||(t=b("Promise")))(function(b){a.trigger("scroll_chat_to_bottom",b)})["catch"](function(a){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Unexpected scrollChatToBottom error: ",""])),String(a))})};f.scrollToActiveChat=function(){this.trigger("scroll_to_active_chat")};f.scrollChatListToTop=function(){this.trigger("scroll_chat_list_to_top")};f.flashFocusedMsg=function(a){var b=this;self.setTimeout(function(){b.trigger("flash_focused_msg"),a&&b.trigger("flash_mention_msg")},0)};f.setActiveNavBarItem=function(a){this.trigger("set_active_nav_bar",a)};f.setActiveFilter=function(a,b,c){this.trigger("set_active_filter",a,b,c)};f.updateChatlistSelection=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("update_chatlist_selection",a)};f.closeChat=function(a){a=d("WAWebStateUtils").unproxy(a);this.trigger("close_chat",a);d("WAWebWamMemoryStat").uploadMemoryInfoOnChatClose();d("WAWebMsgTunnelBridge").msgSyncTunnelBridge.resetActiveChat(a.id)};f.closeActiveChat=function(){this.trigger("close_active_chat")};f.focusNextChat=function(a){this.trigger("focus_next_chat",a)};f.focusPrevChat=function(a){this.trigger("focus_prev_chat",a)};f.focusChatSearch=function(){this.trigger("focus_chat_search")};f.closeStatusViewer=function(){this.trigger("close_status_viewer")};f.openComposeBoxExpressionPanel=function(a){this.trigger("open_compose_box_panel",a)};f.openAttachmentDropdown=function(){this.trigger("open_attachment_dropdown")};f.openCaptureMedia=function(a){this.trigger("open_capture_media",a)};f.closeExpressionPanels=function(){this.trigger("close_expression_panels")};f.logout=function(){if(!c("gkx")("26258"))try{throw c("err")("Non Error - CMD logout, thrown only for getting logout stack trace")}catch(a){a instanceof Error&&d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["CMD.logout debug: \n ",""],["CMD.logout debug: \\n ",""])),a.stack).verbose()}d("WAWebAppTracker").AppTracker.mark(d("WAWebAppTracker").AppTrackerType.Logout);this.trigger("logout")};f.openContextMenu=function(a,b){this.trigger("open_context_menu",a,b)};f.closeContextMenu=function(a){this.trigger("close_context_menu",a)};f.openTooltip=function(a,b){this.trigger("open_tooltip",a,b)};f.closeTooltip=function(a){this.trigger("close_tooltip",a)};f.alertNewMsg=function(a){this.trigger("alert_new_msg",a)};f.newMediaMsg=function(a){this.trigger("new_media_msg",a)};f.alertCall=function(a,b,c,d,e){this.trigger("alert_call",{wid:a,msgId:b,isVideo:c,isGroup:d,isSilenced:e})};f.cancelCall=function(a){this.trigger("cancel_call",a)};f.windowError=function(a){d("WAWebCurrentUser").isEmployee()&&this.trigger("window_error",a)};f.onPanesWillChange=function(a){this.trigger("panes_will_change",a)};f.onPanesDidChange=function(a){this.trigger("panes_did_change",a)};f.reactionChangeLastMessage=function(){this.trigger("reaction_changed_last_msg")};f.openGroupsV4InviteRequestFlow=function(a,b,c,d){this.trigger("open_groups_v4_invite_request_flow",a,b,c,d)};f.toggleLidDebugBadge=function(){this.trigger("toggle_lid_debug_badge")};f.openCommandPalette=function(){this.trigger("open_command_palette")};f.closeCommandPalette=function(){this.trigger("close_command_palette")};f.setUiBusy=function(a){var b=this.uiBusy||0;a?(++b,this.$CmdImpl$p_3(),this.$CmdImpl$p_4.cancel()):b&&--b;this.uiBusy=b;b===0&&(this.$CmdImpl$p_3.cancel(),this.$CmdImpl$p_4())};f.windowMouseDown=function(a){this.trigger("window_mousedown",a)};f.windowClick=function(a){this.trigger("window_click",a)};f.midnight=function(){this.trigger("midnight")};f.serverUpdatedClientExpiration=function(){this.trigger("serverUpdatedClientExpiration")};f.scrollMessages=function(){this.trigger("scroll_messages")};f.getConversationHeaderOffset=function(a){this.trigger("get_conversation_header_offset",a)};f.floaterEscapeOverlap=function(a,b){this.trigger("floater_escape_overlap",a,b)};f.refreshMessages=function(){this.trigger("refresh_messages")};f.storageInitializationError=function(){this.trigger("storage_initialization_error")};f.editGroupSubject=function(){this.trigger("edit_group_subject")};f.endFlow=function(){this.trigger("end_flow")};f.refreshQR=function(){this.trigger("md_refresh_qr")};f.setSocketState=function(a){this.trigger("set_socket_state",a)};f.socketStreamDisconnected=function(){this.trigger("socket_stream_disconnected")};f.openSocketStream=function(){this.trigger("open_socket_stream")};f.reconnectSocket=function(){this.trigger("reconnect_socket")};f.openLongLinkModal=function(){this.trigger("open_long_link_modal")};f.closeLongLinkModal=function(a){a===void 0&&(a=!1),this.trigger("close_long_link_modal",a)};f.openLockScreenModal=function(){this.trigger("open_lock_screen_modal")};f.correctPasscodeLockScreen=function(a){this.trigger("correct_passcode_lock_screen",a)};f.incorrectPasscodeLockScreen=function(){this.trigger("incorrect_passcode_lock_screen")};f.offlineDeliveryEnd=function(){this.isOfflineDeliveryEnd=!0,this.trigger("offline_delivery_end")};f.resetOfflineDeliveryState=function(){this.isOfflineDeliveryEnd=!1,this.trigger("offline_delivery_state_reset")};f.readyForProcessOffline=function(){d("WALogger").LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Cmd: offline_process_ready"]))),this.trigger("offline_process_ready")};f.readyForMainStreamMode=function(){d("WAWebPageLoadLogging").addPageLoadQplPoint("main_stream_mode_ready"),this.isMainStreamReadyMd=!0,this.trigger("main_stream_mode_ready")};f.onInitialChatHistorySynced=function(){this.trigger("on_initial_chat_synced")};f.onRecentChatHistorySynced=function(){this.trigger("on_recent_chat_history_synced")};f.onFullChatHistorySynced=function(){this.trigger("on_full_chat_history_synced")};f.onHistorySyncChunkProcessed=function(a){this.trigger("new_history_sync_chunk_processed",a)};f.handleOfflineProgressUpdate=function(){this.trigger("offline_progress_update")};f.criticalSyncDone=function(){this.trigger("on_critical_sync_done")};f.onTemporaryBan=function(a){this.trigger("account_temporarily_banned",a)};f.onStartingLogout=function(){this.trigger("starting_logout")};f.unexpectedLogoutModal=function(a){this.trigger("unexpected_logout_modal",a)};f.showServiceUnavailableError=function(){this.trigger("service_unavailable_503")};f.merchantDetailsDrawer=function(a){this.trigger("merchant_details_drawer",a)};f.showMerchantDetailsEntityTypePopup=function(a,b){this.trigger("show_merchant_details_entity_type_popup",a,b)};f.showCountrySelector=function(a,b,c,d,e,f,g){this.trigger("show_country_selector_popup",a,b,c,d,e,f,g)};f.toggleStickerMaker=function(){this.trigger("toggle_sticker_maker")};f.onAccountSyncForPrivacy=function(a){this.trigger("account_sync_for_privacy",a)};f.updateStatusPrivacySettings=function(a){this.trigger("update_status_privacy_settings",a)};f.openStickerPack=function(a){this.trigger("open_sticker_pack",a)};f.onStatusViewerOpen=function(){this.trigger("status_viewer_open")};f.onStatusPostingFlow=function(){this.trigger("status_posting_flow")};f.triggerStorageAlert=function(){c("gkx")("26258")||this.trigger("handle_low_storage_butter_bar")};f.triggerBugReportV2=function(){d("WAWebCurrentUser").isEmployee()&&this.trigger("trigger_bugreport_v2")};f.onAbPropsUpdate=function(a){this.trigger("on_ab_props_update",a)};f.abPropsLoaded=function(){this.trigger("ab_props_loaded")};f.onNotificationPermissionChange=function(){this.trigger("on_notification_permission_change")};f.onBrigadingStateChange=function(a){this.trigger("on_brigading_state_change",a)};f.playNextPtv=function(a){this.trigger("sequential_ptv_playback",a)};f.groupNotificationContextCardRendered=function(a){this.trigger("group_notification_context_card_rendered",a)};f.botTogglePluginSearchDetailsToggle=function(a,b){if(a==null){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Cmd: botTogglePluginSearchDetailsToggle called w/ null target id."])));return}this.trigger("bot_toggle_plugin_search_details_for_target_id_"+a,b)};f.rerenderApp=function(){this.trigger("rerender_app")};f.toggleAiRepliesStatus=function(a){this.trigger("toggle_ai_replies_status",a)};f.chatListVisibilityChange=function(a){this.trigger("chat_list_visibility_change",a)};f.limitSharingDrawer=function(a){this.trigger("limit_sharing_drawer",a)};f.reachoutTimelockStateChange=function(){this.trigger("reachout_timelock_state_change")};f.newChatMessageCappingStateChange=function(){this.trigger("new_chat_message_capping_state_change")};f.typingIndicatorVisibilityChange=function(a){this.trigger("typing_indicator_visibility_change",a)};return e}(c("WAWebEventEmitter"));var v=new f();function w(a){var b,c=function(){if(b)return;b=new AbortController();var c=b,e=c.signal;d("WAWebDocumentFlushed").documentFlushed({signal:e}).then(function(){if(e.aborted)return;b=null;a()},function(a){if(a instanceof Error&&a.name===d("WAAbortError").ABORT_ERROR)return;throw a})};c.cancel=function(){if(!b)return;b.abort();b=null};return c}g.Revoke=a;g.APP_STATE_SYNC_COMPLETED=e;g.CmdImpl=f;g.Cmd=v}),98);
__d("WAWebContactManagementGating",["WAWebABProps","WAWebPrimaryFeatures"],(function(a,b,c,d,e,f,g){function a(){return h()&&i()}function h(){return d("WAWebPrimaryFeatures").primaryFeatureEnabled("companion_contact_change_enabled")}function i(){return d("WAWebABProps").getABPropConfigValue("native_contact_companion_change_enabled")}function b(){var a=Number.parseInt(d("WAWebABProps").getABPropConfigValue("native_contact_companion_nux_learn_more_article_id"),10);Number.isNaN(a)&&(a=1191526044909364);return a}g.contactManagementEnabled=a;g.getNativeContactLearnMoreArticleId=b}),98);
__d("WAWebFaqUrl",["WAWebBizGatingUtils","WAWebContactManagementGating","WAWebL10N","WAWebMarketingMessagesUserFeedbackGatingUtils"],(function(a,b,c,d,e,f,g){var h="https://faq.whatsapp.com",i="web";function j(a){return h+"/"+a+"?lang="+c("WAWebL10N").getNormalizedLocale()}function a(){return h+"/"+i+"?lang="+c("WAWebL10N").getNormalizedLocale()}function b(){return j(2138577903196467)}function e(){return j(6480469855345352)}function f(){return j(643460927283235)}function k(){return j(852892549070029)}function l(){return j(3398056720476987)}function m(){return j(835452491239734)}function n(){return j(1524220618005378)}function o(){return j(820124435853543)}function p(){return j(820124435853543)}function q(){return j(1148840052398648)}function r(){return j(1293093778117781)}function s(){return j(1053543185312573)}function t(){return j(1110600769849613)}function u(){return j(677428350267326)}function v(){return j(819881299156447)}function w(){return j(531205362155587)}function x(){return j(2322556321235831)}function y(){return j(1130443730921732)}function z(){return j(807378207138241)}function A(){return j(1370476507114859)}function B(){return j(393169153028916)}function C(){return j(806293963922749)}function D(){return j(794517045178057)}function E(){return j(3872729742954601)}function F(){return j(1074237659908080)}function G(){return j(673193694148537)}function H(){return j(728928448599090)}function I(){return j(1077018839582332)}function J(){return j(676672070766141)}function K(){return j(854037192262196)}function L(a,b){a=j(854037192262196)+"&cms_platform="+a;return b!=null?a+"&helpref="+b:a}function M(){return j(846698564598022)}function N(){return j(1184376605821468)}function O(){return j(570221114584995)}function P(){return j(366296225670044)}function Q(){return j(625069579217642)}function R(){return j(812356880201038)}function S(){return j(2234976186844686)}function T(){return j(1317564962315842)}function U(){return j(832060577920049)}function V(){return j(821275555582352)}function W(){return j(498814665492149)}function X(){return j(1874151452788882)}function Y(){return j(2917597651792702)}function Z(){return j(626403979060997)}function $(){return j(831150864932965)}function aa(){return j(138730494968892)}function ba(){return j(6614640168569481)}function ca(){return j(1549633222110625)}function da(){return j(231869526393268)}function ea(){return j(671443411431514)}function fa(){return j(1318001139066835)}function ga(){return j(245599461477281)}function ha(){return j(682987820062997)}function ia(){return j(1446688872845683)}function ja(){return j(652713330395407)}function ka(){return j(205306122327447)}function la(){return j(919039336073667)}function ma(){return j(673193694148537)}function na(){return j(1313491802751163)}function oa(){return j(422435220869520)}function pa(){return j(1726618467788240)}function qa(){return j(653480766448040)}function ra(){return j(526463418847093)}function sa(){return j(1262764931172994)}function ta(){return"https://www.facebook.com/privacy/policy"}function ua(){return"https://www.facebook.com/privacy/genai"}function va(){return"https://www.facebook.com/policies/other-policies/bm-ais-terms"}function wa(){return"https://www.facebook.com/legal/ai-terms"}function xa(){return"https://www.whatsapp.com/legal/brazil-privacy-notice/why-and-how-we-process-data"}function ya(){return"https://www.facebook.com/privacy/genai"}function za(){return"https://www.facebook.com/help/contact/2503286619871400"}function Aa(){return j(1111412106858632)}function Ba(){return j(6485307734928964)}function Ca(){var a=d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiRowEnabled()||d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiIndiaEnabled()||d("WAWebBizGatingUtils").isUpdatedConsumerDisclosureUiBrazilEnabled();return j(a?6485307734928964:1270536656989145)}function Da(){return j(332114409462050)}function Ea(){return j(306908962283012)}function Fa(){return j(785493319976156)}function Ga(){return j(704225315054890)}function Ha(){return j(3872729742954601)}function Ia(){return j(434854355461483)}function Ja(){return j(1083092416402722)}function Ka(){return j(360977646301595)}function La(){return j(684323127185056)}function Ma(){return j(1520500555178162)}function Na(){return j(414631957536067)}function Oa(){return j(445453537819972)}function Pa(){return j(764072925284841)}function Qa(){return j(515115256843064)}function Ra(){return j(d("WAWebContactManagementGating").getNativeContactLearnMoreArticleId())}function Sa(){return j(3379690015658337)}function Ta(){return j(2127363544304650)}function Ua(){return j(1889908094810167)}function Va(){return j(1791149784551042)}function Wa(){return!d("WAWebMarketingMessagesUserFeedbackGatingUtils").isMMMessageLevelFeedbackNotInterestedMenuEnabled()?j(849628780369041):j(1027276182478056)}function Xa(){return j(1072622197196723)}function Ya(){return j(471097579286138)}function Za(){return j(925016942750794)}function $a(){return j(3440358352849077)}function ab(){return j(2286952358121083)}function bb(){return j(1142481766359885)}function cb(){return"https://www.whatsapp.com/usephone"}function db(){return"https://business.whatsapp.com/policy#policies_for_whatsapp_commerce_features"}function eb(){return j(717472490411581)}function fb(){return"https://business.whatsapp.com/policy?lang="+c("WAWebL10N").getNormalizedLocale()}function gb(){return"https://business.whatsapp.com/?lang="+c("WAWebL10N").getNormalizedLocale()}function hb(){return j(361005896189245)}function ib(){return j(1057141349534704)}function jb(){return j(1130839532138259)}function kb(){return j(813462751272572)}function lb(){return j(829033686455542)}function mb(){return j(1191884799374310)}g.FAQ_BASE_URL=h;g.PLATFORM=i;g.getFullUrl=j;g.getFaqUrl=a;g.getDeleteAccountUrl=b;g.getNewsletterActivityInforUrl=e;g.getBusinessFaqUrl=f;g.getCannotConnectFaqUrl=k;g.getCiphertextFaqUrl=l;g.getFanoutPlaceholderFaqUrl=m;g.getCodeChangeFaqUrl=n;g.getMDCodeChangeFaqUrl=o;g.getE2EFaqUrl=p;g.getE2EEnterpriseFaqUrl=q;g.getWAChatFaqUrl=r;g.getFrequentlyForwardedFaqUrl=s;g.getMembershipApprovalModeFaqUrl=t;g.getNonVerifiedTransitionFaqUrl=u;g.getNotificationChromeFaqUrl=v;g.getNotificationEdgeFaqUrl=w;g.getNotificationFirefoxFaqUrl=x;g.getNotificationOperaFaqUrl=y;g.getNotificationSafariFaqUrl=z;g.getRevokeFaqUrl=A;g.getSuspiciousLinkFaqUrl=B;g.getUnverifiedTransitionFaqUrl=C;g.getVerifiedHighFaqUrl=D;g.getBlueFaqUrl=E;g.getVerifiedLowUnknownFaqUrl=F;g.getEphemeralFaqUrl=G;g.getKICFaqUrl=H;g.getViewOnceFaqUrl=I;g.getSupportChatFaqUrl=J;g.getSupportChatSafetyFaqUrl=K;g.getSupportChatSafetyFaqUrlWithPlatform=L;g.getDefenseModeFaqUrl=M;g.getCatalogCartOnOffFaqUrl=N;g.getCommunityHomeNuxUrl=O;g.getExitCommunityUrl=P;g.getCommunityCreatorPrivacyUrl=Q;g.getCommunityMemberPrivacyUrl=R;g.getCommunityBecomingOwnerUrl=S;g.getLinkDeviceFaqUrl=T;g.getJioMartPostcodeChangeLearnMoreLink=U;g.getDBErrorFaqUrl=V;g.getHowToExitAndDeleteGroupsFaq=W;g.getRemoveFromCommunityFaqUrl=X;g.getViewOnceScreenshotProtectionUrl=Y;g.getPhoneNumberHidingFaqUrl=Z;g.getCagPhoneNumberHidingFaqUrl=$;g.getControlsWhenMessagingBusinessFaqUrl=aa;g.getMessageEditFaqUrl=ba;g.getNewsletterUpdateEditFaqUrl=ca;g.getAboutCommunitiesFaqUrl=da;g.getNewsletterPrivacyLegacyFaqUrl=ea;g.getNewsletterPrivacyMultiAdminFaqUrl=fa;g.getNewsletterGuidelinesFaqUrl=ga;g.getNewsletterGeosuspendFaqUrl=ha;g.getNewsletterMetricsEstimatedFaqUrl=ia;g.getNewsletterMetricsUnavailableFaqUrl=ja;g.getMemberAddedGroupsUrl=ka;g.getReportToAdminFaqUrl=la;g.getOrderEphemeralExemptionUrl=ma;g.getSafetyToolsFaqUrl=na;g.getSearchTheWebFaqUrl=oa;g.getScreenLockLearnMoreUrl=pa;g.getMessageHistoryOnLinkedDevicesFAQUrl=qa;g.getRequestAccountInfoFAQUrl=ra;g.getIndiaEcommerceComplianceFaqUrl=sa;g.getBotPrivacyPolicyUrl=ta;g.getPrivacyPolicyGenaiUrl=ua;g.getBMBotTermsUrl=va;g.getBotTermsUrl=wa;g.getWhatsappPrivacyPolicyBrazilUrl=xa;g.getWhatsappBrazilBizBotRightsUrl=ya;g.getWhatsappBrazilBizBotObjectUrl=za;g.getBotLearnMoreUrl=Aa;g.getBizBot1pLearnMoreUrl=Ba;g.getBizBotTosLearnMoreUrl=Ca;g.getBizBot3pLearnMoreUrl=Da;g.getBizBot3pDataSharingUrl=Ea;g.getConsumerTransparencyHCAUrl=Fa;g.getAvatarFaqUrl=Ga;g.getWhatsAppBusinessPremiumFaqUrl=Ha;g.getSharingBusinessInfoForAdsFaqUrl=Ia;g.getSagaFaqUrl=Ja;g.getNewsletterAdminInviteFaqUrlV2=Ka;g.getReportUnlawfulContentWebFaqUrl=La;g.getCoexHostedFaqUrl=Ma;g.getBlockingReportingFaqUrl=Na;g.getDisableLinkPreviewsFaqUrl=Oa;g.getChatLockSecretCodeFaqUrl=Pa;g.getAccountTakeOverFaqUrl=Qa;g.getNativeContactLearnMoreFaqUrl=Ra;g.getAntiBrigadingFaqUrl=Sa;g.getEventsLearnMoreFaqUrl=Ta;g.getCommunityGroupsVisibilityFaqUrl=Ua;g.getBizQuickRepliesFaqUrl=Va;g.marketingMessageFeedbackLearnMoreURL=Wa;g.marketingMessageUserControlsStopLearnMoreURL=Xa;g.marketingMessageUserControlsResumeLearnMoreURL=Ya;g.sharingCustomerRelatedActivityLearnMoreURL=Za;g.getNewsletterReportLearnMoreUrl=$a;g.getSeeExamplesOfScamsUrl=ab;g.getHowToReport=bb;g.getWhatsappUsePhoneFallbackUrl=cb;g.getWhatsappBusinessCommercePolicyUrl=db;g.getRestrictedAccountLearnMoreUrl=eb;g.getWhatsAppBusinessPolicyUrl=fb;g.getWhatsAppBusinessHomeUrl=gb;g.getMessagingBestPracticeUrl=hb;g.getSMBLinkedCatalogUrl=ib;g.getGuestFAQUrl=jb;g.getSMBIndividualNewChatMessageCappingHCAUrl=kb;g.getConsumerIndividualNewChatMessageCappingHCAUrl=lb;g.getNewsletterQuestionResponsePrivacyBannerFAQUrl=mb}),98);